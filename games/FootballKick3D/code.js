!function (t) {
    var e = {};
    function i(n) {
        if (e[n]) return e[n].exports;
        var r = e[n] = {
            i: n,
            l: !1,
            exports: {}
        };
        return t[n].call(r.exports, r, r.exports, i), r.l = !0, r.exports;
    }
    i.m = t, i.c = e, i.d = function (t, e, n) {
        i.o(t, e) || Object.defineProperty(t, e, {
            enumerable: !0,
            get: n
        });
    }, i.r = function (t) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(t, "__esModule", {
            value: !0
        });
    }, i.t = function (t, e) {
        if (1 & e && (t = i(t)), 8 & e) return t;
        if (4 & e && "object" == typeof t && t && t.__esModule) return t;
        var n = Object.create(null);
        if (i.r(n), Object.defineProperty(n, "default", {
            enumerable: !0,
            value: t
        }), 2 & e && "string" != typeof t) for (var r in t) i.d(n, r, function (e) {
            return t[e];
        }.bind(null, r));
        return n;
    }, i.n = function (t) {
        var e = t && t.__esModule ? function () {
            return t.default;
        } : function () {
            return t;
        };
        return i.d(e, "a", e), e;
    }, i.o = function (t, e) {
        return Object.prototype.hasOwnProperty.call(t, e);
    }, i.p = "", i(i.s = 1);
}([function (t, e) {
    var i;
    i = function () {
        return this;
    }();
    try {
        i = i || new Function("return this")();
    } catch (t) {
        "object" == typeof window && (i = window);
    }
    t.exports = i;
}, function (t, e, i) {
    window.screenOrientation = "portrait", i(2), i(3), i(4), i(5), i(6), i(7), i(8),
        i(9), i(10);
}, function (t, e, i) {
    var n = window.Laya = function (t, e) {
        var i = {
            __internals: [],
            __packages: {},
            __classmap: {
                Object: Object,
                Function: Function,
                Array: Array,
                String: String
            },
            __sysClass: {
                object: "Object",
                array: "Array",
                string: "String",
                dictionary: "Dictionary"
            },
            __propun: {
                writable: !0,
                enumerable: !1,
                configurable: !0
            },
            __presubstr: String.prototype.substr,
            __substr: function (t, e) {
                return 1 == arguments.length ? i.__presubstr.call(this, t) : i.__presubstr.call(this, t, e > 0 ? e : this.length + e);
            },
            __init: function (t) {
                t.forEach(function (t) {
                    t.__init$ && t.__init$();
                });
            },
            __isClass: function (t) {
                return t && (t.__isclass || t == Object || t == String || t == Array);
            },
            __newvec: function (t, e) {
                var i = [];
                i.length = t;
                for (var n = 0; n < t; n++) i[n] = e;
                return i;
            },
            __extend: function (t, e) {
                for (var n in e) if (e.hasOwnProperty(n)) {
                    var r = Object.getOwnPropertyDescriptor(e, n), a = r.get, s = r.set;
                    a || s ? a && s ? Object.defineProperty(t, n, r) : (a && Object.defineProperty(t, n, a),
                        s && Object.defineProperty(t, n, s)) : t[n] = e[n];
                }
                function o() {
                    i.un(this, "constructor", t);
                }
                o.prototype = e.prototype, t.prototype = new o(), i.un(t.prototype, "__imps", i.__copy({}, e.prototype.__imps));
            },
            __copy: function (t, e) {
                if (!e) return null;
                for (var i in t = t || {}, e) t[i] = e[i];
                return t;
            },
            __package: function (e, n) {
                if (!i.__packages[e]) {
                    i.__packages[e] = !0;
                    var r = t, a = e.split(".");
                    if (a.length > 1) for (var s = 0, o = a.length - 1; s < o; s++) {
                        var l = r[a[s]];
                        r = l || (r[a[s]] = {});
                    }
                    r[a[a.length - 1]] || (r[a[a.length - 1]] = n || {});
                }
            },
            __hasOwnProperty: function (t, e) {
                return e = e || this, Object.hasOwnProperty.call(e, t) || function t(e, i) {
                    if (Object.hasOwnProperty.call(i.prototype, e)) return !0;
                    var n = i.prototype.__super;
                    return null == n ? null : t(e, n);
                }(t, e.__class);
            },
            __typeof: function (t, e) {
                if (!t || !e) return !1;
                if (e === String) return "string" == typeof t;
                if (e === Number) return "number" == typeof t;
                if (e.__interface__) e = e.__interface__; else if ("string" != typeof e) return t instanceof e;
                return t.__imps && t.__imps[e] || t.__class == e;
            },
            __as: function (t, e) {
                return this.__typeof(t, e) ? t : null;
            },
            __int: function (t) {
                return t ? parseInt(t) : 0;
            },
            interface: function (e, n) {
                i.__package(e, {});
                var r = i.__internals, a = r[e] = r[e] || {
                    self: e
                };
                if (n) {
                    var s = n.split(",");
                    a.extend = [];
                    for (var o = 0; o < s.length; o++) {
                        var l = s[o];
                        r[l] = r[l] || {
                            self: l
                        }, a.extend.push(r[l]);
                    }
                }
                var h = t, u = e.split(".");
                for (o = 0; o < u.length - 1; o++) h = h[u[o]];
                h[u[u.length - 1]] = {
                    __interface__: e
                };
            },
            class: function (e, n, r, a) {
                if (r && i.__extend(e, r), n) if (i.__package(n, e), i.__classmap[n] = e, n.indexOf(".") > 0) {
                    if (0 == n.indexOf("laya.")) {
                        var s = n.split(".");
                        a = a || s[s.length - 1], i[a] && console.log("Warning!,this class[" + a + "] already exist:", i[a]),
                            i[a] = e;
                    }
                } else "Main" == n ? t.Main = e : (i[n] && console.log("Error!,this class[" + n + "] already exist:", i[n]),
                    i[n] = e);
                var o = i.un, l = e.prototype;
                o(l, "hasOwnProperty", i.__hasOwnProperty), o(l, "__class", e), o(l, "__super", r),
                    o(l, "__className", n), o(e, "__super", r), o(e, "__className", n), o(e, "__isclass", !0),
                    o(e, "super", function (t) {
                        this.__super.call(t);
                    });
            },
            imps: function (t, e) {
                if (!e) return null;
                var n = t.__imps || i.un(t, "__imps", {});
                function r(t) {
                    var e, a;
                    if ((e = i.__internals[t]) && (n[t] = !0, a = e.extend)) for (var s = 0; s < a.length; s++) r(a[s].self);
                }
                for (var a in e) r(a);
            },
            superSet: function (t, e, i, n) {
                var r = t.prototype["_$set_" + i];
                r && r.call(e, n);
            },
            superGet: function (t, e, i) {
                var n = t.prototype["_$get_" + i];
                return n ? n.call(e) : null;
            },
            getset: function (t, e, n, r, a) {
                t ? (r && (e["_$GET_" + n] = r), a && (e["_$SET_" + n] = a)) : (r && i.un(e, "_$get_" + n, r),
                    a && i.un(e, "_$set_" + n, a)), r && a ? Object.defineProperty(e, n, {
                        get: r,
                        set: a,
                        enumerable: !1,
                        configurable: !0
                    }) : (r && Object.defineProperty(e, n, {
                        get: r,
                        enumerable: !1,
                        configurable: !0
                    }), a && Object.defineProperty(e, n, {
                        set: a,
                        enumerable: !1,
                        configurable: !0
                    }));
            },
            static: function (t, e) {
                for (var i = 0, n = e.length; i < n; i += 2) if ("length" == e[i]) t.length = e[i + 1].call(t); else {
                    function r() {
                        var n = e[i], r = e[i + 1];
                        Object.defineProperty(t, n, {
                            get: function () {
                                return delete this[n], this[n] = r.call(this);
                            },
                            set: function (t) {
                                delete this[n], this[n] = t;
                            },
                            enumerable: !0,
                            configurable: !0
                        });
                    }
                    r();
                }
            },
            un: function (t, e, n) {
                return n || (n = t[e]), i.__propun.value = n, Object.defineProperty(t, e, i.__propun),
                    n;
            },
            uns: function (t, e) {
                e.forEach(function (e) {
                    i.un(t, e);
                });
            }
        };
        return t.console = t.console || {
            log: function () { }
        }, t.trace = t.console.log, Error.prototype.throwError = function () {
            throw arguments;
        }, Object.defineProperty(Array.prototype, "fixed", {
            enumerable: !1
        }), i;
    }(window, document);
    !function (t, e, i) {
        i.un, i.uns, i.static, i.class, i.getset, i.__newvec;
    }(window, document, n), function (t, e, i) {
        i.un, i.uns;
        var n = i.static, r = i.class, a = i.getset;
        i.__newvec;
        i.interface("laya.filters.IFilter"), i.interface("laya.resource.IDispose"), i.interface("laya.resource.IDestroy"),
            i.interface("laya.webgl.submit.ISubmit"), i.interface("laya.resource.ICreateResource"),
            i.interface("laya.webgl.canvas.save.ISaveData"), i.interface("laya.resource.ISingletonElement");
        a(1, i, "alertGlobalError", null, function (t) {
            var e = 0;
            Ot.window.onerror = t ? function (t, i, n, r, a) {
                e++ < 5 && a && alert("出错啦，请把此信息截图给研发商\n" + t + "\n" + a.stack);
            } : null;
        }), i.init = function (e, n, r) {
            for (var a = [], s = 2, o = arguments.length; s < o; s++) a.push(arguments[s]);
            if (!i._isinit) {
                i._isinit = !0, ArrayBuffer.prototype.slice || (ArrayBuffer.prototype.slice = i._arrayBufferSlice),
                    Ot.__init__(), i.systemTimer = new $(!1), i.startTimer = new $(!1), i.physicsTimer = new $(!1),
                    i.updateTimer = new $(!1), i.lateTimer = new $(!1), i.timer = new $(!1), i.loader = new Fe(),
                    xt.__init__(), Ct.inner_enable(), s = 0;
                for (var l = a.length; s < l; s++) a[s] && a[s].enable && a[s].enable();
                return At.isConchApp && ue.enableNative(), Q.beginCheck(), i._currentStage = i.stage = new si(),
                    Z.rootPath = Z._basePath = i._getUrlPath(), i.render = new At(0, 0), i.stage.size(e, n),
                    t.stage = i.stage, M.__init__(), gt.__init__(), w.instance.__init__(i.stage, At.canvas),
                    hi.__init__(), ve.autoStopMusic = !0, At.canvas;
            }
        }, i._getUrlPath = function () {
            var t = Ot.window.location, e = t.pathname;
            return e = ":" == e.charAt(2) ? e.substring(1) : e, Z.getPath("file:" == t.protocol ? e : t.protocol + "//" + t.host + t.pathname);
        }, i._arrayBufferSlice = function (t, e) {
            var i = new Uint8Array(this, t, e - t), n = new Uint8Array(i.length);
            return n.set(i), n.buffer;
        }, i._runScript = function (t) {
            return Ot.window[i._evcode](t);
        }, i.enableDebugPanel = function (t) {
            if (void 0 === t && (t = "libs/laya.debugtool.js"), i.DebugPanel) i.DebugPanel.enable(); else {
                var e = Ot.createElement("script");
                e.onload = function () {
                    i.DebugPanel.enable();
                }, e.src = t, Ot.document.body.appendChild(e);
            }
        }, i.stage = null, i.systemTimer = null, i.startTimer = null, i.physicsTimer = null,
            i.updateTimer = null, i.lateTimer = null, i.timer = null, i.loader = null, i.version = "2.1.0beta",
            i.render = null, i._currentStage = null, i._isinit = !1, i.isWXOpenDataContext = !1,
            i.isWXPosMsg = !1, n(i, ["_evcode", function () {
                return this._evcode = "eval";
            }]);
        var s = function () {
            function t() { }
            return r(t, "laya.renders.LayaGLQuickRunner"), t.__init__ = function () {
                t.map[515] = t.alpha_transform_drawLayaGL, t.map[513] = t.alpha_drawLayaGL, t.map[514] = t.transform_drawLayaGL,
                    t.map[8194] = t.transform_drawNodes, t.map[259] = t.alpha_transform_drawTexture,
                    t.map[257] = t.alpha_drawTexture, t.map[258] = t.transform_drawTexture, t.map[8704] = t.drawLayaGL_drawNodes;
            }, t.transform_drawTexture = function (e, i, n, r) {
                e._style;
                var a = e.texture;
                i.saveTransform(t.curMat), i.transformByMatrix(e.transform, n, r), i.drawTexture(a, -e.pivotX, -e.pivotY, e._width || a.width, e._height || a.height),
                    i.restoreTransform(t.curMat);
            }, t.alpha_drawTexture = function (t, e, i, n) {
                var r, a = t._style, s = t.texture;
                if ((r = a.alpha) > .01 || t._needRepaint()) {
                    var o = e.globalAlpha;
                    e.globalAlpha *= r, e.drawTexture(s, i - a.pivotX + s.offsetX, n - a.pivotY + s.offsetY, t._width || s.width, t._height || s.height),
                        e.globalAlpha = o;
                }
            }, t.alpha_transform_drawTexture = function (e, i, n, r) {
                var a, s = e._style, o = e.texture;
                if ((a = s.alpha) > .01 || e._needRepaint()) {
                    var l = i.globalAlpha;
                    i.globalAlpha *= a, i.saveTransform(t.curMat), i.transformByMatrix(e.transform, n, r),
                        i.drawTexture(o, -s.pivotX + o.offsetX, -s.pivotY + o.offsetY, e._width || o.width, e._height || o.height),
                        i.restoreTransform(t.curMat), i.globalAlpha = l;
                }
            }, t.alpha_transform_drawLayaGL = function (e, i, n, r) {
                var a, s = e._style;
                if ((a = s.alpha) > .01 || e._needRepaint()) {
                    var o = i.globalAlpha;
                    i.globalAlpha *= a, i.saveTransform(t.curMat), i.transformByMatrix(e.transform, n, r),
                        e._graphics && e._graphics._render(e, i, -s.pivotX, -s.pivotY), i.restoreTransform(t.curMat),
                        i.globalAlpha = o;
                }
            }, t.alpha_drawLayaGL = function (t, e, i, n) {
                var r, a = t._style;
                if ((r = a.alpha) > .01 || t._needRepaint()) {
                    var s = e.globalAlpha;
                    e.globalAlpha *= r, t._graphics && t._graphics._render(t, e, i - a.pivotX, n - a.pivotY),
                        e.globalAlpha = s;
                }
            }, t.transform_drawLayaGL = function (e, i, n, r) {
                var a = e._style;
                i.saveTransform(t.curMat), i.transformByMatrix(e.transform, n, r), e._graphics && e._graphics._render(e, i, -a.pivotX, -a.pivotY),
                    i.restoreTransform(t.curMat);
            }, t.transform_drawNodes = function (e, i, n, r) {
                var a = e._getBit(256) && i.drawCallOptimize(!0), s = e._style;
                i.saveTransform(t.curMat), i.transformByMatrix(e.transform, n, r), n = -s.pivotX,
                    r = -s.pivotY;
                var o, l = e._children, h = l.length;
                if (s.viewport) {
                    var u = s.viewport, c = u.x, d = u.y, _ = u.right, f = u.bottom, p = NaN, m = NaN;
                    for (g = 0; g < h; ++g) (o = l[g])._visible && (p = o._x) < _ && p + o.width > c && (m = o._y) < f && m + o.height > d && o.render(i, n, r);
                } else for (var g = 0; g < h; ++g) (o = l[g])._visible && o.render(i, n, r);
                i.restoreTransform(t.curMat), a && i.drawCallOptimize(!1);
            }, t.drawLayaGL_drawNodes = function (t, e, i, n) {
                var r = t._getBit(256) && e.drawCallOptimize(!0), a = t._style;
                i -= a.pivotX, n -= a.pivotY, t._graphics && t._graphics._render(t, e, i, n);
                var s, o = t._children, l = o.length;
                if (a.viewport) {
                    var h = a.viewport, u = h.x, c = h.y, d = h.right, _ = h.bottom, f = NaN, p = NaN;
                    for (m = 0; m < l; ++m) (s = o[m])._visible && (f = s._x) < d && f + s.width > u && (p = s._y) < _ && p + s.height > c && s.render(e, i, n);
                } else for (var m = 0; m < l; ++m) (s = o[m])._visible && s.render(e, i, n);
                r && e.drawCallOptimize(!1);
            }, t.map = {}, n(t, ["curMat", function () {
                return this.curMat = new at();
            }]), t;
        }(), o = function () {
            function t(e) {
                if (this.arrColor = [], null == e) return this.strColor = "#00000000", this.numColor = 0,
                    void (this.arrColor = [0, 0, 0, 0]);
                var i = 0, n = 0, r = 0;
                if ("string" == typeof e) if (e.indexOf("rgba(") >= 0 || e.indexOf("rgb(") >= 0) {
                    var a, s, o = e;
                    for (a = o.indexOf("("), s = o.indexOf(")"), o = o.substring(a + 1, s), this.arrColor = o.split(","),
                        n = this.arrColor.length, i = 0; i < n; i++) this.arrColor[i] = parseFloat(this.arrColor[i]),
                            i < 3 && (this.arrColor[i] = Math.round(this.arrColor[i]));
                    r = 4 == this.arrColor.length ? 256 * (256 * (256 * this.arrColor[0] + this.arrColor[1]) + this.arrColor[2]) + Math.round(255 * this.arrColor[3]) : 256 * (256 * this.arrColor[0] + this.arrColor[1]) + this.arrColor[2],
                        this.strColor = e;
                } else {
                    if (this.strColor = e, "#" === e.charAt(0) && (e = e.substr(1)), 3 === (n = e.length) || 4 === n) {
                        var l = "";
                        for (i = 0; i < n; i++) l += e[i] + e[i];
                        e = l;
                    }
                    r = parseInt(e, 16);
                } else r = e, this.strColor = ie.toHexColor(r);
                this.strColor.indexOf("rgba") >= 0 || 9 === this.strColor.length ? (this.arrColor = [((4278190080 & r) >>> 24) / 255, ((16711680 & r) >> 16) / 255, ((65280 & r) >> 8) / 255, (255 & r) / 255],
                    this.numColor = (4278190080 & r) >>> 24 | (16711680 & r) >> 8 | (65280 & r) << 8 | (255 & r) << 24) : (this.arrColor = [((16711680 & r) >> 16) / 255, ((65280 & r) >> 8) / 255, (255 & r) / 255, 1],
                        this.numColor = 4278190080 | (16711680 & r) >> 16 | 65280 & r | (255 & r) << 16),
                    this.arrColor.__id = ++t._COLODID;
            }
            return r(t, "laya.utils.ColorUtils"), t._initDefault = function () {
                for (var e in t._DEFAULT = {}, t._COLOR_MAP) t._SAVE[e] = t._DEFAULT[e] = new t(t._COLOR_MAP[e]);
                return t._DEFAULT;
            }, t._initSaveMap = function () {
                for (var e in t._SAVE_SIZE = 0, t._SAVE = {}, t._DEFAULT) t._SAVE[e] = t._DEFAULT[e];
            }, t.create = function (e) {
                var i = e + "", n = t._SAVE[i];
                return null != n ? n : (t._SAVE_SIZE < 1e3 && t._initSaveMap(), t._SAVE[i] = new t(e));
            }, t._SAVE = {}, t._SAVE_SIZE = 0, t._COLOR_MAP = {
                purple: "#800080",
                orange: "#ffa500",
                white: "#FFFFFF",
                red: "#FF0000",
                green: "#00FF00",
                blue: "#0000FF",
                black: "#000000",
                yellow: "#FFFF00",
                gray: "#808080"
            }, t._DEFAULT = t._initDefault(), t._COLODID = 1, t;
        }(), l = function () {
            function t() { }
            r(t, "laya.webgl.canvas.save.SaveBase");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.canvas.save.ISaveData": !0
            }), e.isSaveMark = function () {
                return !1;
            }, e.restore = function (e) {
                this._dataObj[this._valueName] = this._value, t.POOL[t.POOL._length++] = this, this._newSubmit && (e._curSubmit = h.RENDERBASE);
            }, t._createArray = function () {
                var t = [];
                return t._length = 0, t;
            }, t._init = function () {
                var e = t._namemap = {};
                return e[1] = "ALPHA", e[2] = "fillStyle", e[8] = "font", e[256] = "lineWidth",
                    e[512] = "strokeStyle", e[8192] = "_mergeID", e[1024] = e[2048] = e[4096] = [],
                    e[16384] = "textBaseline", e[32768] = "textAlign", e[65536] = "_nBlendType", e[1048576] = "shader",
                    e[2097152] = "filters", e[8388608] = "_colorFiler", e;
            }, t.save = function (e, i, n, r) {
                if ((e._saveMark._saveuse & i) !== i) {
                    e._saveMark._saveuse |= i;
                    var a = t.POOL, s = a._length > 0 ? a[--a._length] : new t();
                    s._value = n[s._valueName = t._namemap[i]], s._dataObj = n, s._newSubmit = r;
                    var o = e._save;
                    o[o._length++] = s;
                }
            }, t.POOL = laya.webgl.canvas.save.SaveBase._createArray(), t._namemap = t._init(),
                t;
        }(), h = function () {
            function t(e) {
                this.clipInfoID = -1, this._mesh = null, this._blendFn = null, this._id = 0, this._renderType = 0,
                    this._parent = null, this._startIdx = 0, this._numEle = 0, this._ref = 1, this.shaderValue = null,
                    this._key = new k(), void 0 === e && (e = 1e4), this._renderType = e, this._id = ++t.ID;
            }
            r(t, "laya.webgl.submit.Submit");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.submit.ISubmit": !0
            }), e.getID = function () {
                return this._id;
            }, e.releaseRender = function () {
                t.RENDERBASE != this && --this._ref < 1 && (t.POOL[t._poolSize++] = this, this.shaderValue.release(),
                    this.shaderValue = null, this._mesh = null, this._parent && (this._parent.releaseRender(),
                        this._parent = null));
            }, e.getRenderType = function () {
                return this._renderType;
            }, e.renderSubmit = function () {
                if (0 === this._numEle || !this._mesh || 0 == this._numEle) return 1;
                var t = this.shaderValue.textureHost;
                if (t) {
                    var e = t._getSource();
                    if (!e) return 1;
                    this.shaderValue.texture = e;
                }
                var i = Ct.mainContext;
                return this._mesh.useMesh(i), this.shaderValue.upload(), de.activeBlendFunction !== this._blendFn && (nt.setBlend(i, !0),
                    this._blendFn(i), de.activeBlendFunction = this._blendFn), i.drawElements(4, this._numEle, 5123, this._startIdx),
                    b.renderBatches++, b.trianglesFaces += this._numEle / 3, 1;
            }, e._cloneInit = function (t, e, i, n) {
                t._ref = 1, t._mesh = i, t._id = this._id, t._key.copyFrom(this._key), t._parent = this,
                    t._blendFn = this._blendFn, t._renderType = this._renderType, t._startIdx = n * dt.BYTES_PIDX,
                    t._numEle = this._numEle, t.shaderValue = this.shaderValue, this.shaderValue.ref++,
                    this._ref++;
            }, e.clone = function (t, e, i) {
                return null;
            }, e.reUse = function (t, e) {
                return 0;
            }, e.toString = function () {
                return "ibindex:" + this._startIdx + " num:" + this._numEle + " key=" + this._key;
            }, t.__init__ = function () {
                var e = t.RENDERBASE = new t(-1);
                e.shaderValue = new H(0, 0), e.shaderValue.ALPHA = 1, e._ref = 4294967295;
            }, t.create = function (e, i, n) {
                var r = t._poolSize ? t.POOL[--t._poolSize] : new t();
                r._ref = 1, r._mesh = i, r._key.clear(), r._startIdx = i.indexNum * dt.BYTES_PIDX,
                    r._numEle = 0;
                var a = e._nBlendType;
                r._blendFn = e._targets ? de.targetFns[a] : de.fns[a], r.shaderValue = n, r.shaderValue.setValue(e._shader2D);
                var s = e._shader2D.filters;
                return s && r.shaderValue.setFilters(s), r;
            }, t.createShape = function (e, i, n, r) {
                var a = t._poolSize ? t.POOL[--t._poolSize] : new t();
                a._mesh = i, a._numEle = n, a._startIdx = 2 * i.indexNum, a._ref = 1, a.shaderValue = r,
                    a.shaderValue.setValue(e._shader2D);
                var s = e._nBlendType;
                return a._key.blendShader = s, a._blendFn = e._targets ? de.targetFns[s] : de.fns[s],
                    a;
            }, t.TYPE_2D = 1e4, t.TYPE_CANVAS = 10003, t.TYPE_CMDSETRT = 10004, t.TYPE_CUSTOM = 10005,
                t.TYPE_BLURRT = 10006, t.TYPE_CMDDESTORYPRERT = 10007, t.TYPE_DISABLESTENCIL = 10008,
                t.TYPE_OTHERIBVB = 10009, t.TYPE_PRIMITIVE = 10010, t.TYPE_RT = 10011, t.TYPE_BLUR_RT = 10012,
                t.TYPE_TARGET = 10013, t.TYPE_CHANGE_VALUE = 10014, t.TYPE_SHAPE = 10015, t.TYPE_TEXTURE = 10016,
                t.TYPE_FILLTEXTURE = 10017, t.KEY_ONCE = -1, t.KEY_FILLRECT = 1, t.KEY_DRAWTEXTURE = 2,
                t.KEY_VG = 3, t.KEY_TRIANGLES = 4, t.RENDERBASE = null, t.ID = 1, t.preRender = null,
                t._poolSize = 0, t.POOL = [], t;
        }(), u = function () {
            function t() { }
            r(t, "laya.display.cmd.FillTextureCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.texture = null, this.offset = null, this.other = null, V.recover("FillTextureCmd", this);
            }, e.run = function (t, e, i) {
                t.fillTexture(this.texture, this.x + e, this.y + i, this.width, this.height, this.type, this.offset, this.other);
            }, a(0, e, "cmdID", function () {
                return "FillTexture";
            }), t.create = function (e, i, n, r, a, s, o, l) {
                var h = V.getItemByClass("FillTextureCmd", t);
                return h.texture = e, h.x = i, h.y = n, h.width = r, h.height = a, h.type = s, h.offset = o,
                    h.other = l, h;
            }, t.ID = "FillTexture", t;
        }(), c = function () {
            function t() {
                this._glRender = null;
            }
            r(t, "laya.filters.Filter");
            var e = t.prototype;
            return i.imps(e, {
                "laya.filters.IFilter": !0
            }), a(0, e, "type", function () {
                return -1;
            }), t.BLUR = 16, t.COLOR = 32, t.GLOW = 8, t._filter = function (t, e, i, n) {
                var r = e, a = this._next;
                if (a) {
                    var s = t.filters, o = s.length;
                    if (1 == o && 32 == s[0].type) return e.save(), e.setColorFilter(s[0]), a._fun.call(a, t, e, i, n),
                        void e.restore();
                    var l, h = H.create(1, 0), u = jt.TEMP, c = r._curMat, d = at.create();
                    c.copyTo(d);
                    var _ = 0, f = 0, p = null, m = t._cacheStyle.filterCache || null;
                    if (m && 0 == t.getRepaint()) {
                        if ((t._cacheStyle.hasGlowFilter || !1) && (_ = 50, f = 25), (l = t.getBounds()).width <= 0 || l.height <= 0) return;
                        l.width += _, l.height += _, u.x = l.x * d.a + l.y * d.c, u.y = l.y * d.d + l.x * d.b,
                            l.x = u.x, l.y = u.y, u.x = l.width * d.a + l.height * d.c, u.y = l.height * d.d + l.width * d.b,
                            l.width = u.x, l.height = u.y;
                    } else {
                        t._isHaveGlowFilter() && (_ = 50, f = 25), (l = new mt()).copyFrom(t.getSelfBounds()),
                            l.x += t.x, l.y += t.y, l.x -= t.pivotX + 4, l.y -= t.pivotY + 4;
                        var g = l.x, y = l.y;
                        if (l.width += _ + 8, l.height += _ + 8, u.x = l.x * d.a + l.y * d.c, u.y = l.y * d.d + l.x * d.b,
                            l.x = u.x, l.y = u.y, u.x = l.width * d.a + l.height * d.c, u.y = l.height * d.d + l.width * d.b,
                            l.width = u.x, l.height = u.y, l.width <= 0 || l.height <= 0) return;
                        m && ee.releaseRT(m), p = ee.getRT(l.width, l.height);
                        var v = m = ee.getRT(l.width, l.height);
                        t._getCacheStyle().filterCache = m, r.pushRT(), r.useRT(p);
                        var S = t.x - g + f, T = t.y - y + f;
                        a._fun.call(a, t, e, S, T), r.useRT(v);
                        for (var E = 0; E < o; E++) {
                            0 != E && (r.useRT(p), r.drawTarget(v, 0, 0, l.width, l.height, at.TEMP.identity(), h, null, de.TOINT.overlay),
                                r.useRT(v));
                            var C = s[E];
                            switch (C.type) {
                                case 16:
                                case 8:
                                    C._glRender && C._glRender.render(p, e, l.width, l.height, C);
                                    break;

                                case 32:
                                    r.setColorFilter(C), r.drawTarget(p, 0, 0, l.width, l.height, at.EMPTY.identity(), H.create(1, 0)),
                                        r.setColorFilter(null);
                            }
                        }
                        r.popRT();
                    }
                    if (i = i - f - t.x, n = n - f - t.y, u.setTo(i, n), d.transformPoint(u), i = u.x + l.x,
                        n = u.y + l.y, r._drawRenderTexture(m, i, n, l.width, l.height, at.TEMP.identity(), 1, _i.defuv),
                        p) {
                        var x = K.create([p], function (t) {
                            t.destroy();
                        }, this);
                        p = null, e.addRenderObject(x);
                    }
                    d.destroy();
                }
            }, t;
        }(), d = (function () {
            function t() { }
            r(t, "laya.utils.Log"), t.enable = function () {
                t._logdiv || (t._logdiv = Ot.createElement("div"), t._logdiv.style.cssText = "border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;",
                    Ot.document.body.appendChild(t._logdiv), t._btn = Ot.createElement("button"), t._btn.innerText = "Hide",
                    t._btn.style.cssText = "z-index:1000001;position: absolute;left:10px;top:10px;",
                    t._btn.onclick = t.toggle, Ot.document.body.appendChild(t._btn));
            }, t.toggle = function () {
                var e = t._logdiv.style;
                "" === e.display ? (t._btn.innerText = "Show", e.display = "none") : (t._btn.innerText = "Hide",
                    e.display = "");
            }, t.print = function (e) {
                t._logdiv && (t._count >= t.maxCount && t.clear(), t._count++, t._logdiv.innerText += e + "\n",
                    t.autoScrollToBottom && t._logdiv.scrollHeight - t._logdiv.scrollTop - t._logdiv.clientHeight < 50 && (t._logdiv.scrollTop = t._logdiv.scrollHeight));
            }, t.clear = function () {
                t._logdiv.innerText = "", t._count = 0;
            }, t._logdiv = null, t._btn = null, t._count = 0, t.maxCount = 50, t.autoScrollToBottom = !0;
        }(), function () {
            function t() {
                this.preOvers = [], this.preDowns = [], this.preRightDowns = [], this.enable = !0,
                    this._lastClickTime = 0, this._event = new C();
            }
            r(t, "laya.events.TouchManager");
            var e = t.prototype;
            return e._clearTempArrs = function () {
                t._oldArr.length = 0, t._newArr.length = 0, t._tEleArr.length = 0;
            }, e.getTouchFromArr = function (t, e) {
                var i, n, r = 0;
                for (i = e.length, r = 0; r < i; r++) if ((n = e[r]).id == t) return n;
                return null;
            }, e.removeTouchFromArr = function (t, e) {
                var i = 0;
                for (i = e.length - 1; i >= 0; i--) e[i].id == t && e.splice(i, 1);
            }, e.createTouchO = function (t, e) {
                var i;
                return (i = V.getItem("TouchData") || {}).id = e, i.tar = t, i;
            }, e.onMouseDown = function (e, i, n) {
                var r, a, s, o;
                (void 0 === n && (n = !1), this.enable) && (r = this.getTouchFromArr(i, this.preOvers),
                    s = this.getEles(e, null, t._tEleArr), r ? r.tar = e : (a = this.createTouchO(e, i),
                        this.preOvers.push(a)), Ot.onMobile && this.sendEvents(s, "mouseover"), o = n ? this.preDowns : this.preRightDowns,
                    (r = this.getTouchFromArr(i, o)) ? r.tar = e : (a = this.createTouchO(e, i), o.push(a)),
                    this.sendEvents(s, n ? "mousedown" : "rightmousedown"), this._clearTempArrs());
            }, e.sendEvents = function (t, e) {
                var i, n, r, a = 0;
                for (i = t.length, this._event._stoped = !1, n = t[0], a = 0; a < i; a++) {
                    if ((r = t[a]).destroyed) return;
                    if (r.event(e, this._event.setTo(e, r, n)), this._event._stoped) break;
                }
            }, e.getEles = function (t, e, i) {
                for (i ? i.length = 0 : i = []; t && t != e;) i.push(t), t = t.parent;
                return i;
            }, e.checkMouseOutAndOverOfMove = function (e, i, n) {
                if (void 0 === n && (n = 0), i != e) {
                    var r, a, s = 0, o = 0;
                    if (i.contains(e)) a = this.getEles(e, i, t._tEleArr), this.sendEvents(a, "mouseover"); else if (e.contains(i)) a = this.getEles(i, e, t._tEleArr),
                        this.sendEvents(a, "mouseout"); else {
                        var l, h;
                        (a = t._tEleArr).length = 0, l = this.getEles(i, null, t._oldArr), h = this.getEles(e, null, t._newArr),
                            o = l.length;
                        var u = 0;
                        for (s = 0; s < o; s++) {
                            if (r = l[s], (u = h.indexOf(r)) >= 0) {
                                h.splice(u, h.length - u);
                                break;
                            }
                            a.push(r);
                        }
                        a.length > 0 && this.sendEvents(a, "mouseout"), h.length > 0 && this.sendEvents(h, "mouseover");
                    }
                }
            }, e.onMouseMove = function (e, i) {
                var n, r;
                this.enable && ((n = this.getTouchFromArr(i, this.preOvers)) ? (this.checkMouseOutAndOverOfMove(e, n.tar),
                    n.tar = e, r = this.getEles(e, null, t._tEleArr)) : (r = this.getEles(e, null, t._tEleArr),
                        this.sendEvents(r, "mouseover"), this.preOvers.push(this.createTouchO(e, i))), this.sendEvents(r, "mousemove"),
                    this._clearTempArrs());
            }, e.getLastOvers = function () {
                return t._tEleArr.length = 0, this.preOvers.length > 0 && this.preOvers[0].tar ? this.getEles(this.preOvers[0].tar, null, t._tEleArr) : (t._tEleArr.push(i.stage),
                    t._tEleArr);
            }, e.stageMouseOut = function () {
                var t;
                t = this.getLastOvers(), this.preOvers.length = 0, this.sendEvents(t, "mouseout");
            }, e.onMouseUp = function (e, i, n) {
                if (void 0 === n && (n = !1), this.enable) {
                    var r, a, s, o, l, h, u = 0, c = 0, d = Ot.onMobile;
                    if (a = this.getEles(e, null, t._tEleArr), this.sendEvents(a, n ? "mouseup" : "rightmouseup"),
                        h = n ? this.preDowns : this.preRightDowns, r = this.getTouchFromArr(i, h)) {
                        var _, f = Ot.now();
                        if (_ = f - this._lastClickTime < 300, this._lastClickTime = f, e == r.tar) l = a; else for (s = this.getEles(r.tar, null, t._oldArr),
                            (l = t._newArr).length = 0, c = s.length, u = 0; u < c; u++) o = s[u], a.indexOf(o) >= 0 && l.push(o);
                        l.length > 0 && this.sendEvents(l, n ? "click" : "rightclick"), n && _ && this.sendEvents(l, "doubleclick"),
                            this.removeTouchFromArr(i, h), r.tar = null, V.recover("TouchData", r);
                    } else;
                    (r = this.getTouchFromArr(i, this.preOvers)) && d && ((l = this.getEles(r.tar, null, l)) && l.length > 0 && this.sendEvents(l, "mouseout"),
                        this.removeTouchFromArr(i, this.preOvers), r.tar = null, V.recover("TouchData", r)),
                        this._clearTempArrs();
                }
            }, t._oldArr = [], t._newArr = [], t._tEleArr = [], n(t, ["I", function () {
                return this.I = new t();
            }]), t;
        }()), _ = function () {
            function t() {
                this._mesh = null, this._startIdx = 0, this._numEle = 0, this.shaderValue = null,
                    this.blendType = 0, this._ref = 1, this.srcRT = null, this._key = new k();
            }
            r(t, "laya.webgl.submit.SubmitTarget");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.submit.ISubmit": !0
            }), e.renderSubmit = function () {
                var t = Ct.mainContext;
                this._mesh.useMesh(t);
                var e = this.srcRT;
                return e && (this.shaderValue.texture = e._getSource(), this.shaderValue.upload(),
                    this.blend(), b.renderBatches++, b.trianglesFaces += this._numEle / 3, Ct.mainContext.drawElements(4, this._numEle, 5123, this._startIdx)),
                    1;
            }, e.blend = function () {
                if (de.activeBlendFunction !== de.fns[this.blendType]) {
                    var t = Ct.mainContext;
                    t.enable(3042), de.fns[this.blendType](t), de.activeBlendFunction = de.fns[this.blendType];
                }
            }, e.getRenderType = function () {
                return 0;
            }, e.releaseRender = function () {
                if (--this._ref < 1) {
                    var e = t.POOL;
                    e[e._length++] = this;
                }
            }, e.reUse = function (t, e) {
                return this._startIdx = e, this._ref++, e;
            }, t.create = function (e, i, n, r) {
                var a = t.POOL._length ? t.POOL[--t.POOL._length] : new t();
                if (a._mesh = i, a.srcRT = r, a._startIdx = i.indexNum * dt.BYTES_PIDX, a._ref = 1,
                    a._key.clear(), a._numEle = 0, a.blendType = e._nBlendType, a._key.blendShader = a.blendType,
                    a.shaderValue = n, a.shaderValue.setValue(e._shader2D), e._colorFiler) {
                    var s = e._colorFiler;
                    n.defines.add(s.type), n.colorMat = s._mat, n.colorAlpha = s._alpha;
                }
                return a;
            }, t.POOL = [], t.__init$ = function () {
                t.POOL._length = 0;
            }, t;
        }(), f = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawImageCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.texture._removeReference(), this.texture = null, V.recover("DrawImageCmd", this);
            }, e.run = function (t, e, i) {
                t.drawTexture(this.texture, this.x + e, this.y + i, this.width, this.height);
            }, a(0, e, "cmdID", function () {
                return "DrawImage";
            }), t.create = function (e, i, n, r, a) {
                var s = V.getItemByClass("DrawImageCmd", t);
                return s.texture = e, e._addReference(), s.x = i, s.y = n, s.width = r, s.height = a,
                    s;
            }, t.ID = "DrawImage", t;
        }(), p = function () {
            function t() {
                this._id = ie.getGID(), this._resetComp();
            }
            r(t, "laya.components.Component");
            var e = t.prototype;
            return i.imps(e, {
                "laya.resource.ISingletonElement": !0,
                "laya.resource.IDestroy": !0
            }), e._isScript = function () {
                return !1;
            }, e._resetComp = function () {
                this._indexInList = -1, this._enabled = !0, this._awaked = !1, this.owner = null;
            }, e._getIndexInList = function () {
                return this._indexInList;
            }, e._setIndexInList = function (t) {
                this._indexInList = t;
            }, e._onAdded = function () { }, e._onAwake = function () { }, e._onEnable = function () { },
                e._onDisable = function () { }, e._onEnableInScene = function () { }, e._onDisableInScene = function () { },
                e._onDestroy = function () { }, e.onReset = function () { }, e._parse = function (t) { },
                e._cloneTo = function (t) { }, e._setActive = function (t) {
                    t ? (this._awaked || (this._awaked = !0, this._onAwake()), this._enabled && this._onEnable()) : this._enabled && this._onDisable();
                }, e._setActiveInScene = function (t) {
                    t ? this._onEnableInScene() : this._onDisableInScene();
                }, e.destroy = function () {
                    this.owner && this.owner._destroyComponent(this);
                }, e._destroy = function () {
                    this.owner.activeInHierarchy && this._enabled && (this._setActive(!1), this._isScript() && this.onDisable()),
                        this.owner._scene && this._setActiveInScene(!1), this._onDestroy(), this._destroyed = !0,
                        this.onReset !== laya.components.Component.prototype.onReset ? (this.onReset(),
                            this._resetComp(), V.recoverByClass(this)) : this._resetComp();
                }, a(0, e, "id", function () {
                    return this._id;
                }), a(0, e, "enabled", function () {
                    return this._enabled;
                }, function (t) {
                    this._enabled = t, this.owner && (t ? this.owner.activeInHierarchy && this._onEnable() : this.owner.activeInHierarchy && this._onDisable());
                }), a(0, e, "isSingleton", function () {
                    return !0;
                }), a(0, e, "destroyed", function () {
                    return this._destroyed;
                }), t;
        }(), m = function () {
            var t;
            function e() {
                this._$0__events = null;
            }
            r(e, "laya.events.EventDispatcher");
            var i = e.prototype;
            return i.hasListener = function (t) {
                return !!(this._$0__events && this._$0__events[t]);
            }, i.event = function (t, e) {
                if (!this._$0__events || !this._$0__events[t]) return !1;
                var i = this._$0__events[t];
                if (i.run) i.once && delete this._$0__events[t], null != e ? i.runWith(e) : i.run(); else {
                    for (var n = 0, r = i.length; n < r; n++) {
                        var a = i[n];
                        a && (null != e ? a.runWith(e) : a.run()), a && !a.once || (i.splice(n, 1), n--,
                            r--);
                    }
                    0 === i.length && this._$0__events && delete this._$0__events[t];
                }
                return !0;
            }, i.on = function (t, e, i, n) {
                return this._createListener(t, e, i, n, !1);
            }, i.once = function (t, e, i, n) {
                return this._createListener(t, e, i, n, !0);
            }, i._createListener = function (e, i, n, r, a, s) {
                void 0 === s && (s = !0), s && this.off(e, i, n, a);
                var o = t.create(i || this, n, r, a);
                this._$0__events || (this._$0__events = {});
                var l = this._$0__events;
                return l[e] ? l[e].run ? l[e] = [l[e], o] : l[e].push(o) : l[e] = o, this;
            }, i.off = function (t, e, i, n) {
                if (void 0 === n && (n = !1), !this._$0__events || !this._$0__events[t]) return this;
                var r = this._$0__events[t];
                if (null != r) if (r.run) e && r.caller !== e || null != i && r.method !== i || n && !r.once || (delete this._$0__events[t],
                    r.recover()); else {
                    for (var a = 0, s = 0, o = r.length; s < o; s++) {
                        var l = r[s];
                        l ? !l || e && l.caller !== e || null != i && l.method !== i || n && !l.once || (a++,
                            r[s] = null, l.recover()) : a++;
                    }
                    a === o && delete this._$0__events[t];
                }
                return this;
            }, i.offAll = function (t) {
                var e = this._$0__events;
                if (!e) return this;
                if (t) this._recoverHandlers(e[t]), delete e[t]; else {
                    for (var i in e) this._recoverHandlers(e[i]);
                    this._$0__events = null;
                }
                return this;
            }, i.offAllCaller = function (t) {
                if (t && this._$0__events) for (var e in this._$0__events) this.off(e, t, null);
                return this;
            }, i._recoverHandlers = function (t) {
                if (t) if (t.run) t.recover(); else for (var e = t.length - 1; e > -1; e--) t[e] && (t[e].recover(),
                    t[e] = null);
            }, i.isMouseEvent = function (t) {
                return e.MOUSE_EVENTS[t] || !1;
            }, e.MOUSE_EVENTS = {
                rightmousedown: !0,
                rightmouseup: !0,
                rightclick: !0,
                mousedown: !0,
                mouseup: !0,
                mousemove: !0,
                mouseover: !0,
                mouseout: !0,
                click: !0,
                doubleclick: !0
            }, e.__init$ = function () {
                Object.defineProperty(laya.events.EventDispatcher.prototype, "_events", {
                    enumerable: !1,
                    writable: !0
                }), t = function (t) {
                    function e(t, i, n, r) {
                        e.__super.call(this, t, i, n, r);
                    }
                    return r(e, "", t), e.prototype.recover = function () {
                        this._id > 0 && (this._id = 0, e._pool.push(this.clear()));
                    }, e.create = function (t, i, n, r) {
                        return void 0 === r && (r = !0), e._pool.length ? e._pool.pop().setTo(t, i, n, r) : new e(t, i, n, r);
                    }, e._pool = [], e;
                }(g);
            }, e;
        }(), g = function () {
            function t(t, e, i, n) {
                this.once = !1, this._id = 0, void 0 === n && (n = !1), this.setTo(t, e, i, n);
            }
            r(t, "laya.utils.Handler");
            var e = t.prototype;
            return e.setTo = function (e, i, n, r) {
                return this._id = t._gid++, this.caller = e, this.method = i, this.args = n, this.once = r,
                    this;
            }, e.run = function () {
                if (null == this.method) return null;
                var t = this._id, e = this.method.apply(this.caller, this.args);
                return this._id === t && this.once && this.recover(), e;
            }, e.runWith = function (t) {
                if (null == this.method) return null;
                var e = this._id;
                if (null == t) var i = this.method.apply(this.caller, this.args); else i = this.args || t.unshift ? this.args ? this.method.apply(this.caller, this.args.concat(t)) : this.method.apply(this.caller, t) : this.method.call(this.caller, t);
                return this._id === e && this.once && this.recover(), i;
            }, e.clear = function () {
                return this.caller = null, this.method = null, this.args = null, this;
            }, e.recover = function () {
                this._id > 0 && (this._id = 0, t._pool.push(this.clear()));
            }, t.create = function (e, i, n, r) {
                return void 0 === r && (r = !0), t._pool.length ? t._pool.pop().setTo(e, i, n, r) : new t(e, i, n, r);
            }, t._pool = [], t._gid = 1, t;
        }(), y = function () {
            function t() {
                this.ib = null, this.vb = null;
                Ct.mainContext;
                this.ib = Qe.create(35048), this.vb = ti.create(8);
            }
            r(t, "laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");
            var e = t.prototype;
            return e.addSkinMesh = function (t) {
                t.getData2(this.vb, this.ib, this.vb._byteLength / 32);
            }, e.reset = function () {
                this.vb.clear(), this.ib.clear();
            }, t.getInstance = function () {
                return t.instance = t.instance || new t();
            }, t.instance = null, t;
        }(), v = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawTrianglesCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.texture = null, this.vertices = null, this.uvs = null, this.indices = null,
                    this.color = null;
                this.matrix = null, V.recover("DrawTrianglesCmd", this);
            }, e.run = function (t, e, i) {
                t.drawTriangles(this.texture, this.x + e, this.y + i, this.vertices, this.uvs, this.indices, this.matrix, this.alpha, this.color, this.blendMode);
            }, a(0, e, "cmdID", function () {
                return "DrawTriangles";
            }), t.create = function (e, i, n, r, a, s, l, h, u, c) {
                var d = V.getItemByClass("DrawTrianglesCmd", t);
                if (d.texture = e, d.x = i, d.y = n, d.vertices = r, d.uvs = a, d.indices = s, d.matrix = l,
                    d.alpha = h, u) {
                    d.color = new Te();
                    var _ = o.create(u).arrColor;
                    d.color.color(255 * _[0], 255 * _[1], 255 * _[2], 255 * _[3]);
                }
                return d.blendMode = c, d;
            }, t.ID = "DrawTriangles", t;
        }(), S = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawPieCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.fillColor = null, this.lineColor = null, V.recover("DrawPieCmd", this);
            }, e.run = function (t, e, i) {
                t._drawPie(this.x + e, this.y + i, this.radius, this._startAngle, this._endAngle, this.fillColor, this.lineColor, this.lineWidth, this.vid);
            }, a(0, e, "startAngle", function () {
                return 180 * this._startAngle / Math.PI;
            }, function (t) {
                this._startAngle = t * Math.PI / 180;
            }), a(0, e, "cmdID", function () {
                return "DrawPie";
            }), a(0, e, "endAngle", function () {
                return 180 * this._endAngle / Math.PI;
            }, function (t) {
                this._endAngle = t * Math.PI / 180;
            }), t.create = function (e, i, n, r, a, s, o, l, h) {
                var u = V.getItemByClass("DrawPieCmd", t);
                return u.x = e, u.y = i, u.radius = n, u._startAngle = r, u._endAngle = a, u.fillColor = s,
                    u.lineColor = o, u.lineWidth = l, u.vid = h, u;
            }, t.ID = "DrawPie", t;
        }(), T = function () {
            function t() {
                this.id = NaN, this.save = [], this.toUpperCase = null, this.changed = !1, this._text = null,
                    this.width = -1, this.pageChars = [], this.startID = 0, this.startIDStroke = 0,
                    this.lastGCCnt = 0, this.splitRender = !1;
            }
            r(t, "laya.utils.WordText");
            var e = t.prototype;
            return e.setText = function (t) {
                this.changed = !0, this._text = t, this.width = -1, this.cleanCache();
            }, e.toString = function () {
                return this._text;
            }, e.charCodeAt = function (t) {
                return this._text ? this._text.charCodeAt(t) : NaN;
            }, e.charAt = function (t) {
                return this._text ? this._text.charAt(t) : null;
            }, e.cleanCache = function () {
                this.pageChars.forEach(function (t) {
                    var e = t.tex;
                    t.words;
                    1 == t.words.length && e && e.ri && e.destroy();
                }), this.pageChars = [], this.startID = 0;
            }, a(0, e, "length", function () {
                return this._text ? this._text.length : 0;
            }), t;
        }(), E = function () {
            function t(t, e, i) {
                this._stride = 0, this.vertNum = 0, this.indexNum = 0, this._applied = !1, this._vb = null,
                    this._ib = null, this._vao = null, this._attribInfo = null, this._quadNum = 0, this.canReuse = !1,
                    this._stride = t, this._vb = new ti(t, 35048), e ? this._vb._resizeBuffer(e, !1) : ae.webGL2D_MeshAllocMaxMem && this._vb._resizeBuffer(65536 * t, !1),
                    this._ib = new Qe(), i && this._ib._resizeBuffer(i, !1);
            }
            r(t, "laya.webgl.utils.Mesh2D");
            var e = t.prototype;
            return e.cloneWithNewVB = function () {
                var e = new t(this._stride, 0, 0);
                return e._ib = this._ib, e._quadNum = this._quadNum, e._attribInfo = this._attribInfo,
                    e;
            }, e.cloneWithNewVBIB = function () {
                var e = new t(this._stride, 0, 0);
                return e._attribInfo = this._attribInfo, e;
            }, e.getVBW = function () {
                return this._vb.setNeedUpload(), this._vb;
            }, e.getVBR = function () {
                return this._vb;
            }, e.getIBR = function () {
                return this._ib;
            }, e.getIBW = function () {
                return this._ib.setNeedUpload(), this._ib;
            }, e.createQuadIB = function (t) {
                this._quadNum = t, this._ib._resizeBuffer(6 * t * 2, !1), this._ib.byteLength = this._ib.bufferLength;
                for (var e = this._ib.getUint16Array(), i = 0, n = 0, r = 0; r < t; r++) e[i++] = n,
                    e[i++] = n + 2, e[i++] = n + 1, e[i++] = n, e[i++] = n + 3, e[i++] = n + 2, n += 4;
                this._ib.setNeedUpload();
            }, e.setAttributes = function (t) {
                if (this._attribInfo = t, this._attribInfo.length % 3 != 0) throw "Mesh2D setAttributes error!";
            }, e.configVAO = function (t) {
                if (!this._applied) {
                    this._applied = !0, this._vao || (this._vao = new ze()), this._vao.bind(), this._vb._bindForVAO(),
                        this._ib.setNeedUpload(), this._ib._bind_uploadForVAO();
                    for (var e = this._attribInfo.length / 3, i = 0, n = 0; n < e; n++) {
                        var r = this._attribInfo[i + 1], a = this._attribInfo[i], s = this._attribInfo[i + 2];
                        t.enableVertexAttribArray(n), t.vertexAttribPointer(n, r, a, !1, this._stride, s),
                            i += 3;
                    }
                    this._vao.unBind();
                }
            }, e.useMesh = function (t) {
                this._applied || this.configVAO(t), this._vao.bind(), this._vb.bind(), this._ib._bind_upload() || this._ib.bind(),
                    this._vb._bind_upload() || this._vb.bind();
            }, e.getEleNum = function () {
                return this._ib.getBuffer().byteLength / 2;
            }, e.releaseMesh = function () { }, e.destroy = function () { }, e.clearVB = function () {
                this._vb.clear();
            }, t._gvaoid = 0, t;
        }(), C = function () {
            function t() { }
            r(t, "laya.events.Event");
            var e = t.prototype;
            return e.setTo = function (t, e, i) {
                return this.type = t, this.currentTarget = e, this.target = i, this;
            }, e.stopPropagation = function () {
                this._stoped = !0;
            }, a(0, e, "stageY", function () {
                return i.stage.mouseY;
            }), a(0, e, "charCode", function () {
                return this.nativeEvent.charCode;
            }), a(0, e, "touches", function () {
                if (!this.nativeEvent) return null;
                var t = this.nativeEvent.touches;
                if (t) for (var e = i.stage, n = 0, r = t.length; n < r; n++) {
                    var a = t[n], s = jt.TEMP;
                    s.setTo(a.clientX, a.clientY), e._canvasTransform.invertTransformPoint(s), e.transform.invertTransformPoint(s),
                        a.stageX = s.x, a.stageY = s.y;
                }
                return t;
            }), a(0, e, "keyLocation", function () {
                return this.nativeEvent.location || this.nativeEvent.keyLocation;
            }), a(0, e, "ctrlKey", function () {
                return this.nativeEvent.ctrlKey;
            }), a(0, e, "altKey", function () {
                return this.nativeEvent.altKey;
            }), a(0, e, "shiftKey", function () {
                return this.nativeEvent.shiftKey;
            }), a(0, e, "stageX", function () {
                return i.stage.mouseX;
            }), t.EMPTY = new t(), t.MOUSE_DOWN = "mousedown", t.MOUSE_UP = "mouseup", t.CLICK = "click",
                t.RIGHT_MOUSE_DOWN = "rightmousedown", t.RIGHT_MOUSE_UP = "rightmouseup", t.RIGHT_CLICK = "rightclick",
                t.MOUSE_MOVE = "mousemove", t.MOUSE_OVER = "mouseover", t.MOUSE_OUT = "mouseout",
                t.MOUSE_WHEEL = "mousewheel", t.ROLL_OVER = "mouseover", t.ROLL_OUT = "mouseout",
                t.DOUBLE_CLICK = "doubleclick", t.CHANGE = "change", t.CHANGED = "changed", t.RESIZE = "resize",
                t.ADDED = "added", t.REMOVED = "removed", t.DISPLAY = "display", t.UNDISPLAY = "undisplay",
                t.ERROR = "error", t.COMPLETE = "complete", t.LOADED = "loaded", t.READY = "ready",
                t.PROGRESS = "progress", t.INPUT = "input", t.RENDER = "render", t.OPEN = "open",
                t.MESSAGE = "message", t.CLOSE = "close", t.KEY_DOWN = "keydown", t.KEY_PRESS = "keypress",
                t.KEY_UP = "keyup", t.FRAME = "enterframe", t.DRAG_START = "dragstart", t.DRAG_MOVE = "dragmove",
                t.DRAG_END = "dragend", t.ENTER = "enter", t.SELECT = "select", t.BLUR = "blur",
                t.FOCUS = "focus", t.VISIBILITY_CHANGE = "visibilitychange", t.FOCUS_CHANGE = "focuschange",
                t.PLAYED = "played", t.PAUSED = "paused", t.STOPPED = "stopped", t.START = "start",
                t.END = "end", t.COMPONENT_ADDED = "componentadded", t.COMPONENT_REMOVED = "componentremoved",
                t.RELEASED = "released", t.LINK = "link", t.LABEL = "label", t.FULL_SCREEN_CHANGE = "fullscreenchange",
                t.DEVICE_LOST = "devicelost", t.TRANSFORM_CHANGED = "transformchanged", t.ANIMATION_CHANGED = "animationchanged",
                t.TRAIL_FILTER_CHANGE = "trailfilterchange", t.TRIGGER_ENTER = "triggerenter", t.TRIGGER_STAY = "triggerstay",
                t.TRIGGER_EXIT = "triggerexit", t;
        }(), x = function () {
            function t() {
                this.fontSizeInfo = {}, this.charRender = null, this.mapFont = {}, this.fontID = 0,
                    this.mapColor = [], this.colorID = 0, this.fontScaleX = 1, this.fontScaleY = 1,
                    this._curStrPos = 0, this.bmpData32 = null, this.lastFont = null, this.fontSizeW = 0,
                    this.fontSizeH = 0, this.fontSizeOffX = 0, this.fontSizeOffY = 0, this.renderPerChar = !0,
                    this.textureMem = 0, this.fontStr = null, this.textAtlases = [], this.isoTextures = [],
                    this.tmpAtlasPos = new jt();
                var e = !1, n = i.MiniAdpter;
                n && n.systemInfo && n.systemInfo.system && (e = "ios 10.1.1" === n.systemInfo.system.toLowerCase()),
                    Ot.onMiniGame && !e && (t.isWan1Wan = !0), Ot.onLimixiu && (t.isWan1Wan = !0), this.charRender = At.isConchApp ? new Xe() : new We(t.atlasWidth, t.atlasWidth, t.scaleFontWithCtx, !t.isWan1Wan, !1),
                    t.textRenderInst = this, i.textRender = this, t.atlasWidth2 = t.atlasWidth * t.atlasWidth;
            }
            r(t, "laya.webgl.text.TextRender");
            var e = t.prototype;
            return e.setFont = function (e) {
                if (this.lastFont != e) {
                    this.lastFont = e;
                    var i = this.getFontSizeInfo(e._family), n = i >> 24, r = i >> 16 & 255, a = i >> 8 & 255, s = 255 & i, o = e._size / t.standardFontSize;
                    this.fontSizeOffX = Math.ceil(n * o), this.fontSizeOffY = Math.ceil(r * o), this.fontSizeW = Math.ceil(a * o),
                        this.fontSizeH = Math.ceil(s * o), e._font.indexOf("italic") >= 0 ? this.fontStr = e._font.replace("italic", "") : this.fontStr = e._font;
                }
            }, e.getNextChar = function (t) {
                var e = t.length, i = this._curStrPos;
                if (i >= e) return null;
                for (var n = i, r = 0; n < e; n++) {
                    var a = t.charCodeAt(n);
                    if (a >>> 11 == 27) {
                        if (1 == r) break;
                        r = 1, n++;
                    } else if (65038 === a || 65039 === a); else if (8205 == a) r = 2; else if (0 == r) r = 1; else if (1 == r) break;
                }
                return this._curStrPos = n, t.substring(i, n);
            }, e.filltext = function (t, e, i, n, r, a, s, o, l, h) {
                if (void 0 === h && (h = 0), !(e.length <= 0)) {
                    var u = fe.Parse(r), c = 0;
                    switch (l) {
                        case "center":
                            c = ut.ENUM_TEXTALIGN_CENTER;
                            break;

                        case "right":
                            c = ut.ENUM_TEXTALIGN_RIGHT;
                    }
                    this._fast_filltext(t, e, null, i, n, u, a, s, o, c, h);
                }
            }, e.fillWords = function (t, e, i, n, r, a, s, o) {
                if (e && !(e.length <= 0)) {
                    var l = fe.Parse(r);
                    this._fast_filltext(t, null, e, i, n, l, a, s, o, 0, 0);
                }
            }, e._fast_filltext = function (e, i, n, r, a, s, o, l, h, u, c) {
                if (void 0 === c && (c = 0), !(i && i.length < 1 || n && n.length < 1)) {
                    if (h < 0 && (h = 0), this.setFont(s), this.fontScaleX = this.fontScaleY = 1, !At.isConchApp && t.scaleFontWithCtx) {
                        var d = 1, _ = 1;
                        if (At.isConchApp ? (d = e._curMat.getScaleX(), _ = e._curMat.getScaleY()) : (d = e.getMatScaleX(),
                            _ = e.getMatScaleY()), d < 1e-4 || _ < .1) return;
                        d > 1 && (this.fontScaleX = d), _ > 1 && (this.fontScaleY = _);
                    }
                    s._italic && (e._italicDeg = 13);
                    var f = i, p = !n && i instanceof laya.utils.WordText, m = i, g = !!n, y = p ? f.pageChars : [], v = 0;
                    switch (p ? (m = f._text, (v = f.width) < 0 && (v = f.width = this.charRender.getWidth(this.fontStr, m))) : v = m ? this.charRender.getWidth(this.fontStr, m) : 0,
                    u) {
                        case ut.ENUM_TEXTALIGN_CENTER:
                            r -= v / 2;
                            break;

                        case ut.ENUM_TEXTALIGN_RIGHT:
                            r -= v;
                    }
                    f && y && this.hasFreedText(y) && (y = f.pageChars = []);
                    var S = null, T = (p || t.forceWholeRender, this.renderPerChar = !p || t.forceSplitRender || g || p && f.splitRender);
                    if (!y || y.length < 1) if (T) {
                        var E, C = 0, x = 0;
                        for (this._curStrPos = 0; ;) {
                            if (g) {
                                var b = n[this._curStrPos++];
                                b ? (E = b.char, C = b.x, x = b.y) : E = null;
                            } else E = this.getNextChar(m);
                            if (!E) break;
                            if (!(S = this.getCharRenderInfo(E, s, o, l, h, !1))) break;
                            if (S.isSpace); else {
                                var I = y[S.tex.id];
                                if (I) I = I.words; else {
                                    var w = {
                                        texgen: S.tex.genID,
                                        tex: S.tex,
                                        words: []
                                    };
                                    y[S.tex.id] = w, I = w.words;
                                }
                                At.isConchApp ? I.push({
                                    ri: S,
                                    x: C,
                                    y: x,
                                    w: S.bmpWidth / this.fontScaleX,
                                    h: S.bmpHeight / this.fontScaleY
                                }) : I.push({
                                    ri: S,
                                    x: C + 1 / this.fontScaleX,
                                    y: x,
                                    w: (S.bmpWidth - 2) / this.fontScaleX,
                                    h: (S.bmpHeight - 1) / this.fontScaleY
                                }), C += S.width;
                            }
                        }
                    } else {
                        var A = t.noAtlas || v * this.fontScaleX > t.atlasWidth;
                        S = this.getCharRenderInfo(m, s, o, l, h, A), At.isConchApp ? y[0] = {
                            texgen: S.tex.genID,
                            tex: S.tex,
                            words: [{
                                ri: S,
                                x: 0,
                                y: 0,
                                w: S.bmpWidth / this.fontScaleX,
                                h: S.bmpHeight / this.fontScaleY
                            }]
                        } : y[0] = {
                            texgen: S.tex.genID,
                            tex: S.tex,
                            words: [{
                                ri: S,
                                x: 1 / this.fontScaleX,
                                y: 0 / this.fontScaleY,
                                w: (S.bmpWidth - 2) / this.fontScaleX,
                                h: (S.bmpHeight - 1) / this.fontScaleY
                            }]
                        };
                    }
                    this._drawResortedWords(e, r, a, y), e._italicDeg = 0;
                }
            }, e._drawResortedWords = function (t, e, i, n) {
                for (var r = t._charSubmitCache && t._charSubmitCache._enbale, a = t._curMat, s = n.length, o = 0; o < s; o++) {
                    var l = n[o];
                    if (l) {
                        var h = l.words, u = h.length;
                        if (!(u <= 0)) for (var c = n[o].tex, d = 0; d < u; d++) {
                            var _ = h[d], f = _.ri;
                            f.isSpace || (f.touch(), t.drawTexAlign = !0, At.isConchApp ? t._drawTextureM(c.texture, e + _.x - f.orix, i + _.y - f.oriy, _.w, _.h, null, 1, f.uv) : t._inner_drawTexture(c.texture, c.texture.bitmap.id, e + _.x - f.orix, i + _.y - f.oriy, _.w, _.h, a, f.uv, 1, r),
                                t.touches && t.touches.push(f));
                        }
                    }
                }
            }, e.hasFreedText = function (t) {
                for (var e = t.length, i = 0; i < e; i++) {
                    var n = t[i];
                    if (n) {
                        var r = n.tex;
                        if (r.__destroyed || r.genID != n.texgen) return !0;
                    }
                }
                return !1;
            }, e.getCharRenderInfo = function (e, i, n, r, a, s) {
                void 0 === s && (s = !1);
                var o = this.mapFont[i._family];
                null == o && (this.mapFont[i._family] = o = this.fontID++);
                var l = e + "_" + o + "_" + i._size + "_" + n;
                a > 0 && (l += "_" + r + a), i._bold && (l += "P"), 1 == this.fontScaleX && 1 == this.fontScaleY || (l += (20 * this.fontScaleX | 0) + "_" + (20 * this.fontScaleY | 0));
                var h = 0, u = this.textAtlases.length, c = null, d = null;
                if (!s) for (h = 0; h < u; h++) if (c = (d = this.textAtlases[h]).charMaps[l]) return c.touch(),
                    c;
                c = new _t(), this.charRender.scale(this.fontScaleX, this.fontScaleY), c.char = e,
                    c.height = i._size;
                var _ = i._size / 3 | 0, f = null, p = Math.ceil(this.charRender.getWidth(this.fontStr, e) * this.fontScaleX);
                if (p > this.charRender.canvasWidth && (this.charRender.canvasWidth = Math.min(2048, p + 2 * _)),
                    s) {
                    f = this.charRender.getCharBmp(e, this.fontStr, a, n, r, c, _, _, _, _, null);
                    var m = Ze.getTextTexture(f.width, f.height);
                    m.addChar(f, 0, 0, c.uv), c.tex = m, c.orix = _, c.oriy = _, m.ri = c, this.isoTextures.push(m);
                } else {
                    var g = e.length, y = 1 * a, v = Math.ceil((this.fontSizeW + 2 * y) * this.fontScaleX), S = Math.ceil((this.fontSizeH + 2 * y) * this.fontScaleY);
                    t.imgdtRect[0] = (_ - this.fontSizeOffX - y) * this.fontScaleX | 0, t.imgdtRect[1] = (_ - this.fontSizeOffY - y) * this.fontScaleY | 0,
                        this.renderPerChar || 1 == g ? (t.imgdtRect[2] = Math.max(p, v), t.imgdtRect[3] = Math.max(p, S)) : (t.imgdtRect[2] = -1,
                            t.imgdtRect[3] = S), f = this.charRender.getCharBmp(e, this.fontStr, a, n, r, c, _, _, _, _, t.imgdtRect),
                        d = this.addBmpData(f, c), t.isWan1Wan ? (c.orix = _, c.oriy = _) : (c.orix = this.fontSizeOffX + y,
                            c.oriy = this.fontSizeOffY + y), d.charMaps[l] = c;
                }
                return c;
            }, e.addBmpData = function (t, e) {
                for (var i = t.width, n = t.height, r = this.textAtlases.length, a = null, s = !1, o = 0; o < r && !(s = (a = this.textAtlases[o]).getAEmpty(i, n, this.tmpAtlasPos)); o++);
                if (!s) {
                    if (a = new kt(), this.textAtlases.push(a), !(s = a.getAEmpty(i, n, this.tmpAtlasPos))) throw "err1";
                    this.cleanAtlases();
                }
                return s && (a.texture.addChar(t, this.tmpAtlasPos.x, this.tmpAtlasPos.y, e.uv),
                    e.tex = a.texture), a;
            }, e.GC = function () {
                for (var e = 0, i = this.textAtlases.length, n = t.destroyAtlasDt, r = 0, a = b.loopCount, s = -1, o = 0, l = null, h = null; e < i; e++) {
                    if (l = (h = this.textAtlases[e]).texture) {
                        l.curUsedCovRate, r += l.curUsedCovRateAtlas;
                        var u = h.usedRate - l.curUsedCovRateAtlas;
                        o < u && (o = u, s = e);
                    }
                    a - h.texture.lastTouchTm > n && (t.showLog && console.log(h.texture.id), h.destroy(),
                        this.textAtlases[e] = this.textAtlases[i - 1], i--, e--, s = -1);
                }
                for (this.textAtlases.length = i, i = this.isoTextures.length, e = 0; e < i; e++) a - (l = this.isoTextures[e]).lastTouchTm > t.destroyUnusedTextureDt && (l.ri.deleted = !0,
                    l.ri.tex = null, l.destroy(), this.isoTextures[e] = this.isoTextures[i - 1], i--,
                    e--);
                this.isoTextures.length = i;
                var c = this.textAtlases.length > 1 && this.textAtlases.length - r >= 2;
                (t.atlasWidth * t.atlasWidth * 4 * this.textAtlases.length > t.cleanMem || c || t.simClean) && (t.simClean = !1,
                    t.showLog && console.log("清理使用率低的贴图。总使用率:", r, ":", this.textAtlases.length, "最差贴图:" + s),
                    s >= 0 && ((h = this.textAtlases[s]).destroy(), this.textAtlases[s] = this.textAtlases[this.textAtlases.length - 1],
                        this.textAtlases.length = this.textAtlases.length - 1)), Ze.clean();
            }, e.cleanAtlases = function () { }, e.getCharBmp = function (t) { }, e.checkBmpLine = function (t, e, i, n) {
                this.bmpData32.buffer != t.data.buffer && (this.bmpData32 = new Uint32Array(t.data.buffer));
                for (var r = t.width * e + i, a = i; a < n; a++) if (0 != this.bmpData32[r++]) return !0;
                return !1;
            }, e.updateBbx = function (t, e, i) {
                void 0 === i && (i = !1);
                var n = t.width, r = t.height, a = 0, s = e[1], o = 0, l = s;
                if (this.checkBmpLine(t, s, 0, n)) for (; ;) {
                    if ((l = (s + o) / 2 | 0) + 1 >= s) {
                        e[1] = l;
                        break;
                    }
                    this.checkBmpLine(t, l, 0, n) ? s = l : o = l;
                }
                if (e[3] > r) e[3] = r; else if (l = s = e[3], o = r, this.checkBmpLine(t, s, 0, n)) for (; ;) {
                    if ((l = (s + o) / 2 | 0) - 1 <= s) {
                        e[3] = l;
                        break;
                    }
                    this.checkBmpLine(t, l, 0, n) ? s = l : o = l;
                }
                if (!i) {
                    var h = e[0], u = n * e[1];
                    for (l = e[1]; l < e[3]; l++) {
                        for (a = 0; a < h; a++) if (0 != this.bmpData32[u + a]) {
                            h = a;
                            break;
                        }
                        u += n;
                    }
                    e[0] = h;
                    var c = e[2];
                    for (u = n * e[1], l = e[1]; l < e[3]; l++) {
                        for (a = c; a < n; a++) if (0 != this.bmpData32[u + a]) {
                            c = a;
                            break;
                        }
                        u += n;
                    }
                    e[2] = c;
                }
            }, e.getFontSizeInfo = function (e) {
                var i = this.fontSizeInfo[e];
                if (null != i) return i;
                var n = "bold " + t.standardFontSize + "px " + e;
                if (t.isWan1Wan) {
                    this.fontSizeW = 1.5 * this.charRender.getWidth(n, "有"), this.fontSizeH = 1.5 * t.standardFontSize;
                    var r = this.fontSizeW << 8 | this.fontSizeH;
                    return this.fontSizeInfo[e] = r, r;
                }
                t.pixelBBX[0] = t.standardFontSize / 2, t.pixelBBX[1] = t.standardFontSize / 2,
                    t.pixelBBX[2] = t.standardFontSize, t.pixelBBX[3] = t.standardFontSize;
                var a = 16, s = 16;
                this.charRender.scale(1, 1), t.tmpRI.height = t.standardFontSize;
                var o = this.charRender.getCharBmp("g", n, 0, "red", null, t.tmpRI, a, s, 16, 16);
                At.isConchApp && (o.data = new Uint8ClampedArray(o.data)), this.bmpData32 = new Uint32Array(o.data.buffer),
                    this.updateBbx(o, t.pixelBBX, !1), o = this.charRender.getCharBmp("有", n, 0, "red", null, t.tmpRI, s, s, 16, 16),
                    At.isConchApp && (o.data = new Uint8ClampedArray(o.data)), this.bmpData32 = new Uint32Array(o.data.buffer),
                    t.pixelBBX[2] < a + t.tmpRI.width && (t.pixelBBX[2] = a + t.tmpRI.width), this.updateBbx(o, t.pixelBBX, !1),
                    At.isConchApp && (a = 0, s = 0);
                var l = Math.max(a - t.pixelBBX[0], 0) << 24 | Math.max(s - t.pixelBBX[1], 0) << 16 | t.pixelBBX[2] - t.pixelBBX[0] << 8 | t.pixelBBX[3] - t.pixelBBX[1] + 1;
                return this.fontSizeInfo[e] = l, l;
            }, e.printDbgInfo = function () {
                for (var e in console.log("图集个数:" + this.textAtlases.length + ",每个图集大小:" + t.atlasWidth + "x" + t.atlasWidth, " 用canvas:", t.isWan1Wan),
                    console.log("图集占用空间:" + t.atlasWidth * t.atlasWidth * 4 / 1024 / 1024 * this.textAtlases.length + "M"),
                    console.log("缓存用到的字体:"), this.mapFont) {
                    var i = this.getFontSizeInfo(e), n = i >> 24, r = i >> 16 & 255, a = i >> 8 & 255, s = 255 & i;
                    console.log("    " + e, " off:", n, r, " size:", a, s);
                }
                var o = 0;
                console.log("缓存数据:");
                var l = 0, h = 0;
                this.textAtlases.forEach(function (e) {
                    var i = e.texture.id, n = b.loopCount - e.texture.lastTouchTm, r = n > 0 ? n + "帧以前" : "当前帧";
                    for (var a in l += e.texture.curUsedCovRate, h += e.texture.curUsedCovRateAtlas,
                        console.log("--图集(id:" + i + ",当前使用率:" + (1e3 * e.texture.curUsedCovRate | 0) + "‰", "当前图集使用率:", (100 * e.texture.curUsedCovRateAtlas | 0) + "%", "图集使用率:", 100 * e.usedRate | 0, "%, 使用于:" + r + ")--:"),
                        e.charMaps) {
                        var s = e.charMaps[a];
                        console.log("     off:", s.orix, s.oriy, " bmp宽高:", s.bmpWidth, s.bmpHeight, "无效:", s.deleted, "touchdt:", b.loopCount - s.touchTick, "位置:", s.uv[0] * t.atlasWidth | 0, s.uv[1] * t.atlasWidth | 0, "字符:", s.char, "key:", a),
                            o++;
                    }
                }), console.log("独立贴图文字(" + this.isoTextures.length + "个):"), this.isoTextures.forEach(function (t) {
                    console.log("    size:", t._texW, t._texH, "touch间隔:", b.loopCount - t.lastTouchTm, "char:", t.ri.char);
                }), console.log("总缓存:", o, "总使用率:", l, "总当前图集使用率:", h);
            }, e.showAtlas = function (e, n, r, a, s, o) {
                if (!this.textAtlases[e]) return console.log("没有这个图集"), null;
                var l = new Ye(), h = this.textAtlases[e].texture, u = {
                    width: t.atlasWidth,
                    height: t.atlasWidth,
                    sourceWidth: t.atlasWidth,
                    sourceHeight: t.atlasWidth,
                    offsetX: 0,
                    offsetY: 0,
                    getIsReady: function () {
                        return !0;
                    },
                    _addReference: function () { },
                    _removeReference: function () { },
                    _getSource: function () {
                        return h._getSource();
                    },
                    bitmap: {
                        id: h.id
                    },
                    _uv: Me.DEF_UV
                };
                return l.size = function (t, e) {
                    return this.width = t, this.height = e, l.graphics.clear(), l.graphics.drawRect(0, 0, l.width, l.height, n),
                        l.graphics.drawTexture(u, 0, 0, l.width, l.height), this;
                }, l.graphics.drawRect(0, 0, s, o, n), l.graphics.drawTexture(u, 0, 0, s, o), l.pos(r, a),
                    i.stage.addChild(l), l;
            }, e.filltext_native = function (t, e, i, n, r, a, s, o, l, h, u) {
                if (void 0 === u && (u = 0), !(e && e.length <= 0 || i && i.length < 1)) {
                    var c = fe.Parse(a), d = 0;
                    switch (h) {
                        case "center":
                            d = ut.ENUM_TEXTALIGN_CENTER;
                            break;

                        case "right":
                            d = ut.ENUM_TEXTALIGN_RIGHT;
                    }
                    return this._fast_filltext(t, e, i, n, r, c, s, o, l, d, u);
                }
            }, t.useOldCharBook = !1, t.atlasWidth = 2048, t.noAtlas = !1, t.forceSplitRender = !1,
                t.forceWholeRender = !1, t.scaleFontWithCtx = !0, t.standardFontSize = 32, t.destroyAtlasDt = 10,
                t.checkCleanTextureDt = 2e3, t.destroyUnusedTextureDt = 3e3, t.cleanMem = 104857600,
                t.isWan1Wan = !1, t.showLog = !1, t.debugUV = !1, t.atlasWidth2 = 4194304, t.textRenderInst = null,
                t.simClean = !1, n(t, ["tmpRI", function () {
                    return this.tmpRI = new _t();
                }, "pixelBBX", function () {
                    return this.pixelBBX = [0, 0, 0, 0];
                }, "imgdtRect", function () {
                    return this.imgdtRect = [0, 0, 0, 0];
                }]), t;
        }(), b = function () {
            function t() { }
            return r(t, "laya.utils.Stat"), a(1, t, "onclick", null, function (e) {
                t._sp && t._sp.on("click", t._sp, e), t._canvas && (t._canvas.source.onclick = e,
                    t._canvas.source.style.pointerEvents = "");
            }), t.show = function (e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = 0), Ot.onMiniGame || Ot.onLimixiu || At.isConchApp || Ot.onBDMiniGame || Ot.onKGMiniGame || Ot.onQGMiniGame || (t._useCanvas = !0),
                    t._show = !0, t._fpsData.length = 60, t._view[0] = {
                        title: "FPS(Canvas)",
                        value: "_fpsStr",
                        color: "yellow",
                        units: "int"
                    }, t._view[1] = {
                        title: "Sprite",
                        value: "_spriteStr",
                        color: "white",
                        units: "int"
                    }, t._view[2] = {
                        title: "RenderBatches",
                        value: "renderBatches",
                        color: "white",
                        units: "int"
                    }, t._view[3] = {
                        title: "SavedRenderBatches",
                        value: "savedRenderBatches",
                        color: "white",
                        units: "int"
                    }, t._view[4] = {
                        title: "CPUMemory",
                        value: "cpuMemory",
                        color: "yellow",
                        units: "M"
                    }, t._view[5] = {
                        title: "GPUMemory",
                        value: "gpuMemory",
                        color: "yellow",
                        units: "M"
                    }, t._view[6] = {
                        title: "Shader",
                        value: "shaderCall",
                        color: "white",
                        units: "int"
                    }, At.is3DMode ? (t._view[0].title = "FPS(3D)", t._view[7] = {
                        title: "TriFaces",
                        value: "trianglesFaces",
                        color: "white",
                        units: "int"
                    }, t._view[8] = {
                        title: "FrustumCulling",
                        value: "frustumCulling",
                        color: "white",
                        units: "int"
                    }, t._view[9] = {
                        title: "OctreeNodeCulling",
                        value: "octreeNodeCulling",
                        color: "white",
                        units: "int"
                    }) : (t._view[0].title = "FPS(WebGL)", t._view[7] = {
                        title: "Canvas",
                        value: "_canvasStr",
                        color: "white",
                        units: "int"
                    }), t._useCanvas ? t.createUIPre(e, i) : t.createUI(e, i), t.enable();
            }, t.createUIPre = function (e, i) {
                var n = Ot.pixelRatio;
                t._width = 180 * n, t._vx = 120 * n, t._height = n * (12 * t._view.length + 3 * n) + 4,
                    t._fontSize = 12 * n;
                for (var r = 0; r < t._view.length; r++) t._view[r].x = 4, t._view[r].y = r * t._fontSize + 2 * n;
                t._canvas || (t._canvas = new ai(!0), t._canvas.size(t._width, t._height), t._ctx = t._canvas.getContext("2d"),
                    t._ctx.textBaseline = "top", t._ctx.font = t._fontSize + "px Arial", t._canvas.source.style.cssText = "pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:" + e + "px;top:" + i + "px;width:" + t._width / n + "px;height:" + t._height / n + "px;"),
                    Ot.onKGMiniGame || Ot.container.appendChild(t._canvas.source), t._first = !0, t.loop(),
                    t._first = !1;
            }, t.createUI = function (e, i) {
                var n = t._sp, r = Ot.pixelRatio;
                n || (n = new Ye(), t._leftText = new ei(), t._leftText.pos(5, 5), t._leftText.color = "#ffffff",
                    n.addChild(t._leftText), t._txt = new ei(), t._txt.pos(80 * r, 5), t._txt.color = "#ffffff",
                    n.addChild(t._txt), t._sp = n), n.pos(e, i);
                for (var a = "", s = 0; s < t._view.length; s++) {
                    a += t._view[s].title + "\n";
                }
                t._leftText.text = a;
                var o = 138 * r, l = r * (12 * t._view.length + 3 * r) + 4;
                t._txt.fontSize = t._fontSize * r, t._leftText.fontSize = t._fontSize * r, n.size(o, l),
                    n.graphics.clear(), n.graphics.alpha(.5), n.graphics.drawRect(0, 0, o, l, "#999999"),
                    n.graphics.alpha(2), t.loop();
            }, t.enable = function () {
                i.systemTimer.frameLoop(1, t, t.loop);
            }, t.hide = function () {
                t._show = !1, i.systemTimer.clear(t, t.loop), t._canvas && Ot.removeElement(t._canvas.source);
            }, t.clear = function () {
                t.trianglesFaces = t.renderBatches = t.savedRenderBatches = t.shaderCall = t.spriteRenderUseCacheCount = t.frustumCulling = t.octreeNodeCulling = t.canvasNormal = t.canvasBitmap = t.canvasReCache = 0;
            }, t.loop = function () {
                t._count++;
                var e = Ot.now();
                if (!(e - t._timer < 1e3)) {
                    var i = t._count;
                    if (t.FPS = Math.round(1e3 * i / (e - t._timer)), t._show) {
                        t.trianglesFaces = Math.round(t.trianglesFaces / i), t._useCanvas ? t.renderBatches = Math.round(t.renderBatches / i) : t.renderBatches = Math.round(t.renderBatches / i) - 1,
                            t.savedRenderBatches = Math.round(t.savedRenderBatches / i), t.shaderCall = Math.round(t.shaderCall / i),
                            t.spriteRenderUseCacheCount = Math.round(t.spriteRenderUseCacheCount / i), t.canvasNormal = Math.round(t.canvasNormal / i),
                            t.canvasBitmap = Math.round(t.canvasBitmap / i), t.canvasReCache = Math.ceil(t.canvasReCache / i),
                            t.frustumCulling = Math.round(t.frustumCulling / i), t.octreeNodeCulling = Math.round(t.octreeNodeCulling / i);
                        var n = t.FPS > 0 ? Math.floor(1e3 / t.FPS).toString() : " ";
                        t._fpsStr = t.FPS + (t.renderSlow ? " slow" : "") + " " + n, t._useCanvas ? t._spriteStr = t.spriteCount - 1 + (t.spriteRenderUseCacheCount ? "/" + t.spriteRenderUseCacheCount : "") : t._spriteStr = t.spriteCount - 4 + (t.spriteRenderUseCacheCount ? "/" + t.spriteRenderUseCacheCount : ""),
                            t._canvasStr = t.canvasReCache + "/" + t.canvasNormal + "/" + t.canvasBitmap, t.cpuMemory = Ie.cpuMemory,
                            t.gpuMemory = Ie.gpuMemory, t._useCanvas ? t.renderInfoPre() : t.renderInfo(), t.clear();
                    }
                    t._count = 0, t._timer = e;
                }
            }, t.renderInfoPre = function () {
                var e, i, n = 0;
                if (t._canvas) {
                    var r = t._ctx;
                    for (r.clearRect(t._first ? 0 : t._vx, 0, t._width, t._height), n = 0; n < t._view.length; n++) e = t._view[n],
                        t._first && (r.fillStyle = "white", r.fillText(e.title, e.x, e.y)), r.fillStyle = e.color,
                        i = t[e.value], "M" == e.units && (i = Math.floor(i / 1048576 * 100) / 100 + " M"),
                        r.fillText(i + "", e.x + t._vx, e.y);
                }
            }, t.renderInfo = function () {
                for (var e = "", i = 0; i < t._view.length; i++) {
                    var n = t._view[i], r = t[n.value];
                    "M" == n.units && (r = Math.floor(r / 1048576 * 100) / 100 + " M"), "K" == n.units && (r = Math.floor(r / 1024 * 100) / 100 + " K"),
                        e += r + "\n";
                }
                t._txt.text = e;
            }, t.FPS = 0, t.loopCount = 0, t.shaderCall = 0, t.renderBatches = 0, t.savedRenderBatches = 0,
                t.trianglesFaces = 0, t.spriteCount = 0, t.spriteRenderUseCacheCount = 0, t.frustumCulling = 0,
                t.octreeNodeCulling = 0, t.canvasNormal = 0, t.canvasBitmap = 0, t.canvasReCache = 0,
                t.renderSlow = !1, t.gpuMemory = 0, t.cpuMemory = 0, t._fpsStr = null, t._canvasStr = null,
                t._spriteStr = null, t._fpsData = [], t._timer = 0, t._count = 0, t._view = [],
                t._fontSize = 12, t._txt = null, t._leftText = null, t._sp = null, t._titleSp = null,
                t._bgSp = null, t._show = !1, t._useCanvas = !1, t._canvas = null, t._ctx = null,
                t._first = !1, t._vx = NaN, t._width = 0, t._height = 100, t;
        }(), I = function () {
            var t;
            function e() {
                this._lastOriX = 0, this._lastOriY = 0, this.paths = [], this._curPath = null;
            }
            r(e, "laya.webgl.canvas.Path");
            var i = e.prototype;
            return i.beginPath = function (e) {
                this.paths.length = 1, this._curPath = this.paths[0] = new t(), this._curPath.convex = e;
            }, i.closePath = function () {
                this._curPath.loop = !0;
            }, i.newPath = function () {
                this._curPath = new t(), this.paths.push(this._curPath);
            }, i.addPoint = function (t, e) {
                this._curPath.path.push(t, e);
            }, i.push = function (e, i) {
                this._curPath ? this._curPath.path.length > 0 && (this._curPath = new t(), this.paths.push(this._curPath)) : (this._curPath = new t(),
                    this.paths.push(this._curPath));
                var n = this._curPath;
                n.path = e.slice(), n.convex = i;
            }, i.reset = function () {
                this.paths.length = 0;
            }, e.__init$ = function () {
                t = function () {
                    function t() {
                        this.path = [], this.loop = !1, this.convex = !1;
                    }
                    return r(t, ""), t;
                }();
            }, e;
        }(), w = function () {
            function t() {
                this.mouseX = 0, this.mouseY = 0, this.disableMouseEvent = !1, this.mouseDownTime = 0,
                    this.mouseMoveAccuracy = 2, this._stage = null, this._captureSp = null, this._captureExlusiveMode = !1,
                    this._hitCaputreSp = !1, this._target = null, this._lastMoveTimer = 0, this._isLeftMouse = !1,
                    this._touchIDs = {}, this._id = 1, this._tTouchID = 0, this._event = new C(), this._captureChain = [],
                    this._matrix = new at(), this._point = new jt(), this._rect = new mt(), this._prePoint = new jt(),
                    this._curTouchID = NaN;
            }
            r(t, "laya.events.MouseManager");
            var e = t.prototype;
            return e.__init__ = function (e, i) {
                var n = this;
                this._stage = e;
                var r = this;
                i.oncontextmenu = function (e) {
                    if (t.enabled) return !1;
                }, i.addEventListener("mousedown", function (e) {
                    t.enabled && (Ot.onIE || e.preventDefault(), r.mouseDownTime = Ot.now(), n.runEvent(e));
                }), i.addEventListener("mouseup", function (e) {
                    t.enabled && (e.preventDefault(), r.mouseDownTime = -Ot.now(), n.runEvent(e));
                }, !0), i.addEventListener("mousemove", function (e) {
                    if (t.enabled) {
                        e.preventDefault();
                        var i = Ot.now();
                        if (i - r._lastMoveTimer < 10) return;
                        r._lastMoveTimer = i, n.runEvent(e);
                    }
                }, !0), i.addEventListener("mouseout", function (e) {
                    t.enabled && n.runEvent(e);
                }), i.addEventListener("mouseover", function (e) {
                    t.enabled && n.runEvent(e);
                }), i.addEventListener("touchstart", function (e) {
                    t.enabled && (t._isFirstTouch || hi.isInputting || e.preventDefault(), r.mouseDownTime = Ot.now(),
                        n.runEvent(e));
                }), i.addEventListener("touchend", function (e) {
                    t.enabled ? (t._isFirstTouch || hi.isInputting || e.preventDefault(), t._isFirstTouch = !1,
                        r.mouseDownTime = -Ot.now(), n.runEvent(e)) : n._curTouchID = NaN;
                }, !0), i.addEventListener("touchmove", function (e) {
                    t.enabled && (e.preventDefault(), n.runEvent(e));
                }, !0), i.addEventListener("touchcancel", function (e) {
                    t.enabled ? (e.preventDefault(), n.runEvent(e)) : n._curTouchID = NaN;
                }, !0), i.addEventListener("mousewheel", function (e) {
                    t.enabled && n.runEvent(e);
                }), i.addEventListener("DOMMouseScroll", function (e) {
                    t.enabled && n.runEvent(e);
                });
            }, e.initEvent = function (t, e) {
                var i;
                this._event._stoped = !1, this._event.nativeEvent = e || t, this._target = null,
                    this._point.setTo(t.pageX || t.clientX, t.pageY || t.clientY), this._stage._canvasTransform && (this._stage._canvasTransform.invertTransformPoint(this._point),
                        this.mouseX = this._point.x, this.mouseY = this._point.y), this._event.touchId = t.identifier || 0,
                    this._tTouchID = this._event.touchId, (i = d.I._event)._stoped = !1, i.nativeEvent = this._event.nativeEvent,
                    i.touchId = this._event.touchId;
            }, e.checkMouseWheel = function (t) {
                this._event.delta = t.wheelDelta ? .025 * t.wheelDelta : -t.detail;
                for (var e = d.I.getLastOvers(), i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    r.event("mousewheel", this._event.setTo("mousewheel", r, this._target));
                }
            }, e.onMouseMove = function (t) {
                d.I.onMouseMove(t, this._tTouchID);
            }, e.onMouseDown = function (t) {
                if (hi.isInputting && i.stage.focus && i.stage.focus.focus && !i.stage.focus.contains(this._target)) {
                    var e = i.stage.focus._tf || i.stage.focus, n = t._tf || t;
                    n instanceof laya.display.Input && n.multiline == e.multiline ? e._focusOut() : e.focus = !1;
                }
                d.I.onMouseDown(t, this._tTouchID, this._isLeftMouse);
            }, e.onMouseUp = function (t) {
                d.I.onMouseUp(t, this._tTouchID, this._isLeftMouse);
            }, e.check = function (t, e, i, n) {
                this._point.setTo(e, i), t.fromParentPoint(this._point), e = this._point.x, i = this._point.y;
                var r = t._style.scrollRect;
                if (r && (this._rect.setTo(r.x, r.y, r.width, r.height), !this._rect.contains(e, i))) return !1;
                if (!this.disableMouseEvent) {
                    if (t.hitTestPrior && !t.mouseThrough && !this.hitTest(t, e, i)) return !1;
                    for (var a = t._children.length - 1; a > -1; a--) {
                        var s = t._children[a];
                        if (!s.destroyed && s._mouseState > 1 && s._visible && this.check(s, e, i, n)) return !0;
                    }
                    for (a = t._extUIChild.length - 1; a >= 0; a--) {
                        var o = t._extUIChild[a];
                        if (!o.destroyed && o._mouseState > 1 && o._visible && this.check(o, e, i, n)) return !0;
                    }
                }
                var l = !(!t.hitTestPrior || t.mouseThrough || this.disableMouseEvent) || this.hitTest(t, e, i);
                return l ? (this._target = t, n.call(this, t), this._target == this._hitCaputreSp && (this._hitCaputreSp = !0)) : n === this.onMouseUp && t === this._stage && (this._target = this._stage,
                    n.call(this, this._target)), l;
            }, e.hitTest = function (t, e, i) {
                var n = !1;
                t.scrollRect && (e -= t._style.scrollRect.x, i -= t._style.scrollRect.y);
                var r = t._style.hitArea;
                return r && r._hit ? r.contains(e, i) : ((t.width > 0 && t.height > 0 || t.mouseThrough || r) && (n = t.mouseThrough ? t.getGraphicBounds().contains(e, i) : (r || this._rect.setTo(0, 0, t.width, t.height)).contains(e, i)),
                    n);
            }, e._checkAllBaseUI = function (t, e, i) {
                var n = this.handleExclusiveCapture(this.mouseX, this.mouseY, i);
                return !!n || (n = this.check(this._stage, this.mouseX, this.mouseY, i), this.handleCapture(this.mouseX, this.mouseY, i) || n);
            }, e.check3DUI = function (t, e, i) {
                for (var n = this._stage._3dUI, r = 0, a = !1; r < n.length; r++) {
                    var s = n[r];
                    this._stage._curUIBase = s, !s.destroyed && s._mouseState > 1 && s._visible && (a = a || this.check(s, this.mouseX, this.mouseY, i));
                }
                return this._stage._curUIBase = this._stage, a;
            }, e.handleExclusiveCapture = function (t, e, i) {
                if (this._captureExlusiveMode && this._captureSp && this._captureChain.length > 0) {
                    var n;
                    this._point.setTo(t, e);
                    for (var r = 0; r < this._captureChain.length; r++) (n = this._captureChain[r]).fromParentPoint(this._point);
                    return this._target = n, i.call(this, n), !0;
                }
                return !1;
            }, e.handleCapture = function (t, e, i) {
                if (!this._hitCaputreSp && this._captureSp && this._captureChain.length > 0) {
                    var n;
                    this._point.setTo(t, e);
                    for (var r = 0; r < this._captureChain.length; r++) (n = this._captureChain[r]).fromParentPoint(this._point);
                    return this._target = n, i.call(this, n), !0;
                }
                return !1;
            }, e.runEvent = function (e) {
                var i, n = 0, r = 0;
                switch ("mousemove" !== e.type && (this._prePoint.x = this._prePoint.y = -1e6),
                e.type) {
                    case "mousedown":
                        this._touchIDs[0] = this._id++, t._isTouchRespond ? t._isTouchRespond = !1 : (this._isLeftMouse = 0 === e.button,
                            this.initEvent(e), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown));
                        break;

                    case "mouseup":
                        this._isLeftMouse = 0 === e.button, this.initEvent(e), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp);
                        break;

                    case "mousemove":
                        Math.abs(this._prePoint.x - e.clientX) + Math.abs(this._prePoint.y - e.clientY) >= this.mouseMoveAccuracy && (this._prePoint.x = e.clientX,
                            this._prePoint.y = e.clientY, this.initEvent(e), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove));
                        break;

                    case "touchstart":
                        t._isTouchRespond = !0, this._isLeftMouse = !0;
                        var a = e.changedTouches;
                        for (n = 0, r = a.length; n < r; n++) i = a[n], (t.multiTouchEnabled || isNaN(this._curTouchID)) && (this._curTouchID = i.identifier,
                            this._id % 200 == 0 && (this._touchIDs = {}), this._touchIDs[i.identifier] = this._id++,
                            this.initEvent(i, e), this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseDown));
                        break;

                    case "touchend":
                    case "touchcancel":
                        t._isTouchRespond = !0, this._isLeftMouse = !0;
                        var s = e.changedTouches;
                        for (n = 0, r = s.length; n < r; n++) if (i = s[n], t.multiTouchEnabled || i.identifier == this._curTouchID) {
                            this._curTouchID = NaN, this.initEvent(i, e);
                            this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseUp) || this.onMouseUp(null);
                        }
                        break;

                    case "touchmove":
                        var o = e.changedTouches;
                        for (n = 0, r = o.length; n < r; n++) i = o[n], (t.multiTouchEnabled || i.identifier == this._curTouchID) && (this.initEvent(i, e),
                            this._checkAllBaseUI(this.mouseX, this.mouseY, this.onMouseMove));
                        break;

                    case "wheel":
                    case "mousewheel":
                    case "DOMMouseScroll":
                        this.checkMouseWheel(e);
                        break;

                    case "mouseout":
                        d.I.stageMouseOut();
                        break;

                    case "mouseover":
                        this._stage.event("mouseover", this._event.setTo("mouseover", this._stage, this._stage));
                }
            }, e.setCapture = function (t, e) {
                void 0 === e && (e = !1), this._captureSp = t, this._captureExlusiveMode = e, this._captureChain.length = 0,
                    this._captureChain.push(t);
                for (var n = t; n != i.stage && n != i.stage._curUIBase && (n = n.parent);) this._captureChain.splice(0, 0, n);
            }, e.releaseCapture = function () {
                console.log("release capture"), this._captureSp = null;
            }, t.enabled = !0, t.multiTouchEnabled = !0, t._isTouchRespond = !1, t._isFirstTouch = !0,
                n(t, ["instance", function () {
                    return this.instance = new t();
                }]), t;
        }(), A = function () {
            function t() {
                this.useDic = {}, this.shapeDic = {}, this.shapeLineDic = {}, this._id = 0, this._checkKey = !1,
                    this._freeIdArray = [], Q.regCacheByFunction(ie.bind(this.startDispose, this), ie.bind(this.getCacheList, this));
            }
            r(t, "laya.utils.VectorGraphManager");
            var e = t.prototype;
            return e.getId = function () {
                return this._id++;
            }, e.addShape = function (t, e) {
                this.shapeDic[t] = e, this.useDic[t] || (this.useDic[t] = !0);
            }, e.addLine = function (t, e) {
                this.shapeLineDic[t] = e, this.shapeLineDic[t] || (this.shapeLineDic[t] = !0);
            }, e.getShape = function (t) {
                this._checkKey && null != this.useDic[t] && (this.useDic[t] = !0);
            }, e.deleteShape = function (t) {
                this.shapeDic[t] && (this.shapeDic[t] = null, delete this.shapeDic[t]), this.shapeLineDic[t] && (this.shapeLineDic[t] = null,
                    delete this.shapeLineDic[t]), null != this.useDic[t] && delete this.useDic[t];
            }, e.getCacheList = function () {
                var t, e = [];
                for (t in this.shapeDic) e.push(this.shapeDic[t]);
                for (t in this.shapeLineDic) e.push(this.shapeLineDic[t]);
                return e;
            }, e.startDispose = function (t) {
                var e;
                for (e in this.useDic) this.useDic[e] = !1;
                this._checkKey = !0;
            }, e.endDispose = function () {
                if (this._checkKey) {
                    var t;
                    for (t in this.useDic) this.useDic[t] || this.deleteShape(t);
                    this._checkKey = !1;
                }
            }, t.getInstance = function () {
                return t.instance = t.instance || new t();
            }, t.instance = null, t;
        }(), R = function () {
            function t() { }
            return r(t, "laya.maths.MathUtil"), t.subtractVector3 = function (t, e, i) {
                i[0] = t[0] - e[0], i[1] = t[1] - e[1], i[2] = t[2] - e[2];
            }, t.lerp = function (t, e, i) {
                return t * (1 - i) + e * i;
            }, t.scaleVector3 = function (t, e, i) {
                i[0] = t[0] * e, i[1] = t[1] * e, i[2] = t[2] * e;
            }, t.lerpVector3 = function (t, e, i, n) {
                var r = t[0], a = t[1], s = t[2];
                n[0] = r + i * (e[0] - r), n[1] = a + i * (e[1] - a), n[2] = s + i * (e[2] - s);
            }, t.lerpVector4 = function (t, e, i, n) {
                var r = t[0], a = t[1], s = t[2], o = t[3];
                n[0] = r + i * (e[0] - r), n[1] = a + i * (e[1] - a), n[2] = s + i * (e[2] - s),
                    n[3] = o + i * (e[3] - o);
            }, t.slerpQuaternionArray = function (t, e, i, n, r, a, s) {
                var o, l, h, u, c, d = t[e + 0], _ = t[e + 1], f = t[e + 2], p = t[e + 3], m = i[n + 0], g = i[n + 1], y = i[n + 2], v = i[n + 3];
                return (l = d * m + _ * g + f * y + p * v) < 0 && (l = -l, m = -m, g = -g, y = -y,
                    v = -v), 1 - l > 1e-6 ? (o = Math.acos(l), h = Math.sin(o), u = Math.sin((1 - r) * o) / h,
                        c = Math.sin(r * o) / h) : (u = 1 - r, c = r), a[s + 0] = u * d + c * m, a[s + 1] = u * _ + c * g,
                    a[s + 2] = u * f + c * y, a[s + 3] = u * p + c * v, a;
            }, t.getRotation = function (t, e, i, n) {
                return Math.atan2(n - e, i - t) / Math.PI * 180;
            }, t.sortBigFirst = function (t, e) {
                return t == e ? 0 : e > t ? 1 : -1;
            }, t.sortSmallFirst = function (t, e) {
                return t == e ? 0 : e > t ? -1 : 1;
            }, t.sortNumBigFirst = function (t, e) {
                return parseFloat(e) - parseFloat(t);
            }, t.sortNumSmallFirst = function (t, e) {
                return parseFloat(t) - parseFloat(e);
            }, t.sortByKey = function (e, i, n) {
                var r;
                return void 0 === i && (i = !1), void 0 === n && (n = !0), r = i ? n ? t.sortNumBigFirst : t.sortBigFirst : n ? t.sortNumSmallFirst : t.sortSmallFirst,
                    function (t, i) {
                        return r(t[e], i[e]);
                    };
            }, t;
        }(), M = function () {
            function t(e, i) {
                if (s.map[e]) return this._fun = s.map[e], void (this._next = t.NORENDER);
                switch (this._next = i || t.NORENDER, e) {
                    case 0:
                        return void (this._fun = this._no);

                    case 1:
                        return void (this._fun = this._alpha);

                    case 2:
                        return void (this._fun = this._transform);

                    case 4:
                        return void (this._fun = this._blend);

                    case 8:
                        return void (this._fun = this._canvas);

                    case 32:
                        return void (this._fun = this._mask);

                    case 64:
                        return void (this._fun = this._clip);

                    case 128:
                        return void (this._fun = this._style);

                    case 512:
                        return void (this._fun = this._graphics);

                    case 8192:
                        return void (this._fun = this._children);

                    case 2048:
                        return void (this._fun = this._custom);

                    case 256:
                        return void (this._fun = this._texture);

                    case 16:
                        return void (this._fun = c._filter);

                    case 69905:
                        return void (this._fun = t._initRenderFun);
                }
                this.onCreate(e);
            }
            r(t, "laya.renders.RenderSprite");
            var e = t.prototype;
            return e.onCreate = function (t) { }, e._style = function (t, e, i, n) {
                var r = t._style;
                null != r.render && r.render(t, e, i, n);
                var a = this._next;
                a._fun.call(a, t, e, i, n);
            }, e._no = function (t, e, i, n) { }, e._custom = function (t, e, i, n) {
                t.customRender(e, i, n), this._next._fun.call(this._next, t, e, i - t.pivotX, n - t.pivotY);
            }, e._clip = function (e, i, n, r) {
                var a = this._next;
                if (a != t.NORENDER) {
                    var s = e._style.scrollRect;
                    i.save(), i.clipRect(n, r, s.width, s.height), a._fun.call(a, e, i, n - s.x, r - s.y),
                        i.restore();
                }
            }, e._texture = function (e, i, n, r) {
                var a = e.texture;
                a._getSource() && i.drawTexture(a, n - e.pivotX + a.offsetX, r - e.pivotY + a.offsetY, e._width || a.width, e._height || a.height);
                var s = this._next;
                s != t.NORENDER && s._fun.call(s, e, i, n, r);
            }, e._graphics = function (e, i, n, r) {
                var a = e._style, s = e._graphics;
                s && s._render(e, i, n - a.pivotX, r - a.pivotY);
                var o = this._next;
                o != t.NORENDER && o._fun.call(o, e, i, n, r);
            }, e._image = function (t, e, i, n) {
                var r = t._style;
                e.drawTexture2(i, n, r.pivotX, r.pivotY, t.transform, t._graphics._one);
            }, e._image2 = function (t, e, i, n) {
                var r = t._style;
                e.drawTexture2(i, n, r.pivotX, r.pivotY, t.transform, t._graphics._one);
            }, e._alpha = function (t, e, i, n) {
                var r;
                if ((r = t._style.alpha) > .01 || t._needRepaint()) {
                    var a = e.globalAlpha;
                    e.globalAlpha *= r;
                    var s = this._next;
                    s._fun.call(s, t, e, i, n), e.globalAlpha = a;
                }
            }, e._transform = function (e, i, n, r) {
                var a = e.transform, s = this._next;
                e._style;
                a && s != t.NORENDER ? (i.save(), i.transform(a.a, a.b, a.c, a.d, a.tx + n, a.ty + r),
                    s._fun.call(s, e, i, 0, 0), i.restore()) : s != t.NORENDER && s._fun.call(s, e, i, n, r);
            }, e._children = function (t, e, i, n) {
                var r, a = t._style, s = t._children, o = s.length;
                i -= t.pivotX, n -= t.pivotY;
                var l = t._getBit(256) && e.drawCallOptimize(!0);
                if (a.viewport) {
                    var h = a.viewport, u = h.x, c = h.y, d = h.right, _ = h.bottom, f = NaN, p = NaN;
                    for (m = 0; m < o; ++m) (r = s[m])._visible && (f = r._x) < d && f + r.width > u && (p = r._y) < _ && p + r.height > c && r.render(e, i, n);
                } else for (var m = 0; m < o; ++m) (r = s[m])._visible && r.render(e, i, n);
                l && e.drawCallOptimize(!1);
            }, e._canvas = function (t, e, n, r) {
                var a = t._cacheStyle, s = this._next;
                if (a.enableCanvasRender) {
                    "bitmap" === a.cacheAs ? b.canvasBitmap++ : b.canvasNormal++;
                    var o = !1, l = !1;
                    if (a.canvas) {
                        var h = a.canvas, u = (h.context, h.touches);
                        if (u) for (var c = 0; c < u.length; c++) if (u[c].deleted) {
                            l = !0;
                            break;
                        }
                        o = h.isCacheValid && !h.isCacheValid();
                    }
                    if (t._needRepaint() || !a.canvas || l || o || i.stage.isGlobalRepaint()) if ("normal" === a.cacheAs) {
                        if (e._targets) return void s._fun.call(s, t, e, n, r);
                        this._canvas_webgl_normal_repaint(t, e);
                    } else this._canvas_repaint(t, e, n, r);
                    var d = a.cacheRect;
                    e.drawCanvas(a.canvas, n + d.x, r + d.y, d.width, d.height);
                } else s._fun.call(s, t, e, n, r);
            }, e._canvas_repaint = function (t, e, i, n) {
                var r, a, s, o, l, h, u, c, d, _ = t._cacheStyle, f = this._next, p = _.canvas, m = _.cacheAs;
                if (u = (d = _._calculateCacheRect(t, m, i, n)).x, c = d.y, l = (o = _.cacheRect).width * u,
                    h = o.height * c, a = o.x, s = o.y, "bitmap" === m && (l > 2048 || h > 2048)) return console.warn("cache bitmap size larger than 2048,cache ignored"),
                        _.releaseContext(), void f._fun.call(f, t, e, i, n);
                if (p || (_.createContext(), p = _.canvas), (r = p.context).sprite = t, (p.width != l || p.height != h) && p.size(l, h),
                    "bitmap" === m ? r.asBitmap = !0 : "normal" === m && (r.asBitmap = !1), r.clear(),
                    1 != u || 1 != c) {
                    var g = r;
                    g.save(), g.scale(u, c), f._fun.call(f, t, r, -a, -s), g.restore(), t._applyFilters();
                } else g = r, f._fun.call(f, t, r, -a, -s), t._applyFilters();
                _.staticCache && (_.reCache = !1), b.canvasReCache++;
            }, e._canvas_webgl_normal_repaint = function (t, e) {
                var n = t._cacheStyle, r = this._next, a = n.canvas, s = n.cacheAs;
                n._calculateCacheRect(t, s, 0, 0);
                a || (a = n.canvas = new i.WebGLCacheAsNormalCanvas(e, t));
                var o = a.context;
                a.startRec(), r._fun.call(r, t, o, t.pivotX, t.pivotY), t._applyFilters(), b.canvasReCache++,
                    a.endRec();
            }, e._blend = function (t, e, i, n) {
                var r = t._style, a = this._next;
                r.blendMode ? (e.save(), e.globalCompositeOperation = r.blendMode, a._fun.call(a, t, e, i, n),
                    e.restore()) : a._fun.call(a, t, e, i, n);
            }, e._mask = function (e, i, n, r) {
                var a = this._next, s = e.mask, o = i;
                if (s) {
                    o.save();
                    var l = o.globalCompositeOperation, h = new mt();
                    if (h.copyFrom(s.getBounds()), h.width = Math.round(h.width), h.height = Math.round(h.height),
                        h.x = Math.round(h.x), h.y = Math.round(h.y), h.width > 0 && h.height > 0) {
                        var u = h.width, c = h.height, d = ee.getRT(u, c);
                        o.breakNextMerge(), o.pushRT(), o.addRenderObject(K.create([o, d, u, c], t.tmpTarget, this)),
                            s.render(o, -h.x, -h.y), o.breakNextMerge(), o.popRT(), o.save(), o.clipRect(n + h.x - e.getStyle().pivotX, r + h.y - e.getStyle().pivotY, u, c),
                            a._fun.call(a, e, o, n, r), o.restore(), l = o.globalCompositeOperation, o.addRenderObject(K.create(["mask"], t.setBlendMode, this));
                        var _ = H.create(1, 0), f = Me.INV_UV;
                        o.drawTarget(d, n + h.x - e.getStyle().pivotX, r + h.y - e.getStyle().pivotY, u, c, at.TEMP.identity(), _, f, 6),
                            o.addRenderObject(K.create([d], t.recycleTarget, this)), o.addRenderObject(K.create([l], t.setBlendMode, this));
                    }
                    o.restore();
                } else a._fun.call(a, e, i, n, r);
            }, t.__init__ = function () {
                s.__init__();
                var e, i, n = 0;
                for (i = new t(69905, null), e = t.renders.length = 16384, n = 0; n < e; n++) t.renders[n] = i;
                t.renders[0] = new t(0, null);
            }, t._initRenderFun = function (e, i, n, r) {
                var a = e._renderType;
                (t.renders[a] = t._getTypeRender(a))._fun(e, i, n, r);
            }, t._getTypeRender = function (e) {
                if (s.map[e]) return new t(e, null);
                for (var i = null, n = 8192; n > 0;) n & e && (i = new t(n, i)), n >>= 1;
                return i;
            }, t.tmpTarget = function (t, e, i, n) {
                e.start(), e.clear(0, 0, 0, 0);
            }, t.recycleTarget = function (t) {
                ee.releaseRT(t);
            }, t.setBlendMode = function (t) {
                var e = Ct.mainContext;
                de.targetFns[de.TOINT[t]](e);
            }, t.INIT = 69905, t.renders = [], t.NORENDER = new t(0, null), n(t, ["tempUV", function () {
                return this.tempUV = new Array(8);
            }]), t;
        }(), D = (function () {
            function t() { }
            r(t, "laya.events.Keyboard"), t.NUMBER_0 = 48, t.NUMBER_1 = 49, t.NUMBER_2 = 50,
                t.NUMBER_3 = 51, t.NUMBER_4 = 52, t.NUMBER_5 = 53, t.NUMBER_6 = 54, t.NUMBER_7 = 55,
                t.NUMBER_8 = 56, t.NUMBER_9 = 57, t.A = 65, t.B = 66, t.C = 67, t.D = 68, t.E = 69,
                t.F = 70, t.G = 71, t.H = 72, t.I = 73, t.J = 74, t.K = 75, t.L = 76, t.M = 77,
                t.N = 78, t.O = 79, t.P = 80, t.Q = 81, t.R = 82, t.S = 83, t.T = 84, t.U = 85,
                t.V = 86, t.W = 87, t.X = 88, t.Y = 89, t.Z = 90, t.F1 = 112, t.F2 = 113, t.F3 = 114,
                t.F4 = 115, t.F5 = 116, t.F6 = 117, t.F7 = 118, t.F8 = 119, t.F9 = 120, t.F10 = 121,
                t.F11 = 122, t.F12 = 123, t.F13 = 124, t.F14 = 125, t.F15 = 126, t.NUMPAD = 21,
                t.NUMPAD_0 = 96, t.NUMPAD_1 = 97, t.NUMPAD_2 = 98, t.NUMPAD_3 = 99, t.NUMPAD_4 = 100,
                t.NUMPAD_5 = 101, t.NUMPAD_6 = 102, t.NUMPAD_7 = 103, t.NUMPAD_8 = 104, t.NUMPAD_9 = 105,
                t.NUMPAD_ADD = 107, t.NUMPAD_DECIMAL = 110, t.NUMPAD_DIVIDE = 111, t.NUMPAD_ENTER = 108,
                t.NUMPAD_MULTIPLY = 106, t.NUMPAD_SUBTRACT = 109, t.SEMICOLON = 186, t.EQUAL = 187,
                t.COMMA = 188, t.MINUS = 189, t.PERIOD = 190, t.SLASH = 191, t.BACKQUOTE = 192,
                t.LEFTBRACKET = 219, t.BACKSLASH = 220, t.RIGHTBRACKET = 221, t.QUOTE = 222, t.ALTERNATE = 18,
                t.BACKSPACE = 8, t.CAPS_LOCK = 20, t.COMMAND = 15, t.CONTROL = 17, t.DELETE = 46,
                t.ENTER = 13, t.ESCAPE = 27, t.PAGE_UP = 33, t.PAGE_DOWN = 34, t.END = 35, t.HOME = 36,
                t.LEFT = 37, t.UP = 38, t.RIGHT = 39, t.DOWN = 40, t.SHIFT = 16, t.SPACE = 32, t.TAB = 9,
                t.INSERT = 45;
        }(), function () {
            function t() { }
            r(t, "laya.display.cmd.RestoreCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("RestoreCmd", this);
            }, e.run = function (t, e, i) {
                t.restore();
            }, a(0, e, "cmdID", function () {
                return "Restore";
            }), t.create = function () {
                return V.getItemByClass("RestoreCmd", t);
            }, t.ID = "Restore", t;
        }()), O = function () {
            function t(t, e, i) {
                this._value = 0, this._name2int = t, this._int2name = e, this._int2nameMap = i;
            }
            r(t, "laya.webgl.shader.ShaderDefinesBase");
            var e = t.prototype;
            return e.add = function (t) {
                return "string" == typeof t && (t = this._name2int[t]), this._value |= t, this._value;
            }, e.addInt = function (t) {
                return this._value |= t, this._value;
            }, e.remove = function (t) {
                return "string" == typeof t && (t = this._name2int[t]), this._value &= ~t, this._value;
            }, e.isDefine = function (t) {
                return (this._value & t) === t;
            }, e.getValue = function () {
                return this._value;
            }, e.setValue = function (t) {
                this._value = t;
            }, e.toNameDic = function () {
                var e = this._int2nameMap[this._value];
                return e || t._toText(this._value, this._int2name, this._int2nameMap);
            }, t._reg = function (t, e, i, n) {
                i[t] = e, n[e] = t;
            }, t._toText = function (t, e, i) {
                var n = i[t];
                if (n) return n;
                for (var r = {}, a = 1, s = 0; s < 32 && !((a = 1 << s) > t); s++) if (t & a) {
                    var o = e[a];
                    o && (r[o] = "");
                }
                return i[t] = r, r;
            }, t._toInt = function (t, e) {
                for (var i = t.split("."), n = 0, r = 0, a = i.length; r < a; r++) {
                    var s = e[i[r]];
                    if (!s) throw new Error("Defines to int err:" + t + "/" + i[r]);
                    n |= s;
                }
                return n;
            }, t;
        }(), L = function () {
            function t() {
                this._texture = null, this._fontCharDic = {}, this._fontWidthMap = {}, this._complete = null,
                    this._path = null, this._maxWidth = 0, this._spaceWidth = 10, this._padding = null,
                    this.fontSize = 12, this.autoScaleSize = !1, this.letterSpacing = 0;
            }
            r(t, "laya.display.BitmapFont");
            var e = t.prototype;
            return e.loadFont = function (t, e) {
                this._path = t, this._complete = e, t && -1 !== t.indexOf(".fnt") ? i.loader.load([{
                    url: t,
                    type: "xml"
                }, {
                    url: t.replace(".fnt", ".png"),
                    type: "image"
                }], g.create(this, this._onLoaded)) : console.log('Bitmap font configuration information must be a ".fnt" file');
            }, e._onLoaded = function () {
                this.parseFont(Oe.getRes(this._path), Oe.getRes(this._path.replace(".fnt", ".png"))),
                    this._complete && this._complete.run();
            }, e.parseFont = function (t, e) {
                if (null != t && null != e) {
                    this._texture = e;
                    var i = t.getElementsByTagName("info");
                    if (!i[0].getAttributeNode) return this.parseFont2(t, e);
                    this.fontSize = parseInt(i[0].getAttributeNode("size").nodeValue);
                    var n, r = i[0].getAttributeNode("padding").nodeValue.split(",");
                    this._padding = [parseInt(r[0]), parseInt(r[1]), parseInt(r[2]), parseInt(r[3])],
                        n = t.getElementsByTagName("char");
                    var a = 0;
                    for (a = 0; a < n.length; a++) {
                        var s = n[a], o = parseInt(s.getAttributeNode("id").nodeValue), l = parseInt(s.getAttributeNode("xoffset").nodeValue) / 1, h = parseInt(s.getAttributeNode("yoffset").nodeValue) / 1, u = parseInt(s.getAttributeNode("xadvance").nodeValue) / 1, c = new mt();
                        c.x = parseInt(s.getAttributeNode("x").nodeValue), c.y = parseInt(s.getAttributeNode("y").nodeValue),
                            c.width = parseInt(s.getAttributeNode("width").nodeValue), c.height = parseInt(s.getAttributeNode("height").nodeValue);
                        var d = Me.create(e, c.x, c.y, c.width, c.height, l, h);
                        this._maxWidth = Math.max(this._maxWidth, u + this.letterSpacing), this._fontCharDic[o] = d,
                            this._fontWidthMap[o] = u;
                    }
                }
            }, e.parseFont2 = function (t, e) {
                if (null != t && null != e) {
                    this._texture = e;
                    var i = t.getElementsByTagName("info");
                    this.fontSize = parseInt(i[0].attributes.size.nodeValue);
                    var n = i[0].attributes.padding.nodeValue.split(",");
                    this._padding = [parseInt(n[0]), parseInt(n[1]), parseInt(n[2]), parseInt(n[3])];
                    var r = t.getElementsByTagName("char"), a = 0;
                    for (a = 0; a < r.length; a++) {
                        var s = r[a].attributes, o = parseInt(s.id.nodeValue), l = parseInt(s.xoffset.nodeValue) / 1, h = parseInt(s.yoffset.nodeValue) / 1, u = parseInt(s.xadvance.nodeValue) / 1, c = new mt();
                        c.x = parseInt(s.x.nodeValue), c.y = parseInt(s.y.nodeValue), c.width = parseInt(s.width.nodeValue),
                            c.height = parseInt(s.height.nodeValue);
                        var d = Me.create(e, c.x, c.y, c.width, c.height, l, h);
                        this._maxWidth = Math.max(this._maxWidth, u + this.letterSpacing), this._fontCharDic[o] = d,
                            this._fontWidthMap[o] = u;
                    }
                }
            }, e.getCharTexture = function (t) {
                return this._fontCharDic[t.charCodeAt(0)];
            }, e.destroy = function () {
                if (this._texture) {
                    for (var t in this._fontCharDic) {
                        var e = this._fontCharDic[t];
                        e && e.destroy();
                    }
                    this._texture.destroy(), this._fontCharDic = null, this._fontWidthMap = null, this._texture = null,
                        this._complete = null, this._padding = null;
                }
            }, e.setSpaceWidth = function (t) {
                this._spaceWidth = t;
            }, e.getCharWidth = function (t) {
                var e = t.charCodeAt(0);
                return this._fontWidthMap[e] ? this._fontWidthMap[e] + this.letterSpacing : " " === t ? this._spaceWidth + this.letterSpacing : 0;
            }, e.getTextWidth = function (t) {
                for (var e = 0, i = 0, n = t.length; i < n; i++) e += this.getCharWidth(t.charAt(i));
                return e;
            }, e.getMaxWidth = function () {
                return this._maxWidth;
            }, e.getMaxHeight = function () {
                return this.fontSize;
            }, e._drawText = function (t, e, i, n, r, a) {
                var s, o = this.getTextWidth(t), l = 0;
                "center" === r && (l = (a - o) / 2), "right" === r && (l = a - o);
                for (var h = 0, u = 0, c = t.length; u < c; u++) (s = this.getCharTexture(t.charAt(u))) && (e.graphics.drawImage(s, i + h + l, n),
                    h += this.getCharWidth(t.charAt(u)));
            }, t;
        }(), P = function () {
            function t() { }
            r(t, "laya.display.cmd.ClipRectCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("ClipRectCmd", this);
            }, e.run = function (t, e, i) {
                t.clipRect(this.x + e, this.y + i, this.width, this.height);
            }, a(0, e, "cmdID", function () {
                return "ClipRect";
            }), t.create = function (e, i, n, r) {
                var a = V.getItemByClass("ClipRectCmd", t);
                return a.x = e, a.y = i, a.width = n, a.height = r, a;
            }, t.ID = "ClipRect", t;
        }(), N = function () {
            function t() {
                this.ALPHA = 1, this.shaderType = 0, this.defines = new Re(), this.fillStyle = It.DEFAULT,
                    this.strokeStyle = It.DEFAULT;
            }
            return r(t, "laya.webgl.shader.d2.Shader2D"), t.prototype.destroy = function () {
                this.defines = null, this.filters = null;
            }, t.__init__ = function () {
                var t, e;
                t = "/*\n\ttexture和fillrect使用的。\n*/\nattribute vec4 posuv;\nattribute vec4 attribColor;\nattribute vec4 attribFlags;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\nvarying vec2 cliped;\nuniform vec2 size;\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\n#ifdef MVP3D\n\tuniform mat4 u_MvpMatrix;\n#endif\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\n\nvoid main() {\n\n\tvec4 pos = vec4(posuv.xy,0.,1.);\n#ifdef WORLDMAT\n\tpos=mmat*pos;\n#endif\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\n#ifdef MVP3D\n\tgl_Position=u_MvpMatrix*pos1;\n#else\n\tgl_Position=pos1;\n#endif\n\tv_texcoordAlpha.xy = posuv.zw;\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\n\tv_color = attribColor/255.0;\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\n\t\n\tv_useTex = attribFlags.r/255.0;\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\t\n\tvec2 clpos = clipMatPos.xy;\n\t#ifdef WORLDMAT\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\n\t\tif(clipOff[0]>0.0){\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\n\t\t\tclpos.y+=mmat[3].y;\t//ty\n\t\t}\n\t#endif\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n\n}",
                    e = "/*\n\ttexture和fillrect使用的。\n*/\n#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_texcoordAlpha;\nvarying vec4 v_color;\nvarying float v_useTex;\nuniform sampler2D texture;\nvarying vec2 cliped;\n\n#ifdef BLUR_FILTER\nuniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}\n#endif\n\n#ifdef COLOR_FILTER\nuniform vec4 colorAlpha;\nuniform mat4 colorMat;\n#endif\n\n#ifdef GLOW_FILTER\nuniform vec4 u_color;\nuniform vec4 u_blurInfo1;\nuniform vec4 u_blurInfo2;\n#endif\n\n#ifdef COLOR_ADD\nuniform vec4 colorAdd;\n#endif\n\n#ifdef FILLTEXTURE\t\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\n#endif\nvoid main() {\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n\t\n#ifdef FILLTEXTURE\t\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\n#else\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\n#endif\n\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\n   color.a*=v_color.w;\n   //color.rgb*=v_color.w;\n   color.rgb*=v_color.rgb;\n   gl_FragColor=color;\n   \n   #ifdef COLOR_ADD\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\n\tgl_FragColor.xyz *= colorAdd.a;\n   #endif\n   \n   #ifdef BLUR_FILTER\n\tgl_FragColor =   blur();\n\tgl_FragColor.w*=v_color.w;   \n   #endif\n   \n   #ifdef COLOR_FILTER\n\tmat4 alphaMat =colorMat;\n\n\talphaMat[0][3] *= gl_FragColor.a;\n\talphaMat[1][3] *= gl_FragColor.a;\n\talphaMat[2][3] *= gl_FragColor.a;\n\n\tgl_FragColor = gl_FragColor * alphaMat;\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n   #endif\n   \n   #ifdef GLOW_FILTER\n\tconst float c_IterationTime = 10.0;\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\n\tvec2 vec2Off = vec2(0.0,0.0);\n\tfloat floatOff = c_IterationTime/2.0;\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\n\t\t}\n\t}\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\n\tgl_FragColor.rgb *= gl_FragColor.a;   \n   #endif\n   \n}",
                    ni.preCompile2D(0, 1, t, e, null), t = "attribute vec4 position;\nattribute vec4 attribColor;\n//attribute vec4 clipDir;\n//attribute vec2 clipRect;\nuniform vec4 clipMatDir;\nuniform vec2 clipMatPos;\n#ifdef WORLDMAT\n\tuniform mat4 mmat;\n#endif\nuniform mat4 u_mmat2;\n//uniform vec2 u_pos;\nuniform vec2 size;\nvarying vec4 color;\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\n//vec4 clip=vec4(100.,30.,300.,600.);\nvarying vec2 cliped;\nvoid main(){\n\t\n#ifdef WORLDMAT\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n#else\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n#endif\t\n\tfloat clipw = length(clipMatDir.xy);\n\tfloat cliph = length(clipMatDir.zw);\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\n\tif(clipw>20000. && cliph>20000.)\n\t\tcliped = vec2(0.5,0.5);\n\telse {\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\n\t}\n  //pos2d.x = dot(clippos,dirx);\n  color=attribColor/255.;\n}",
                    e = "precision mediump float;\n//precision mediump float;\nvarying vec4 color;\n//uniform float alpha;\nvarying vec2 cliped;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=color.a;\n\tif(cliped.x<0.) discard;\n\tif(cliped.x>1.) discard;\n\tif(cliped.y<0.) discard;\n\tif(cliped.y>1.) discard;\n}",
                    ni.preCompile2D(0, 4, t, e, null), t = "attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",
                    e = "precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",
                    ni.preCompile2D(0, 512, t, e, null);
            }, t;
        }(), B = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawPolyCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.points = null, this.fillColor = null, this.lineColor = null, V.recover("DrawPolyCmd", this);
            }, e.run = function (t, e, i) {
                t._drawPoly(this.x + e, this.y + i, this.points, this.fillColor, this.lineColor, this.lineWidth, this.isConvexPolygon, this.vid);
            }, a(0, e, "cmdID", function () {
                return "DrawPoly";
            }), t.create = function (e, i, n, r, a, s, o, l) {
                var h = V.getItemByClass("DrawPolyCmd", t);
                return h.x = e, h.y = i, h.points = n, h.fillColor = r, h.lineColor = a, h.lineWidth = s,
                    h.isConvexPolygon = o, h.vid = l, h;
            }, t.ID = "DrawPoly", t;
        }(), F = function () {
            function t() {
                this.fontName = null, this.complete = null, this.err = null, this._fontTxt = null,
                    this._url = null, this._div = null, this._txtWidth = NaN, this._http = null;
            }
            r(t, "laya.net.TTFLoader");
            var e = t.prototype;
            return e.load = function (t) {
                this._url = t;
                var e = t.split(".ttf")[0].split("/");
                this.fontName = e[e.length - 1], At.isConchApp ? this._loadConch() : Ot.window.FontFace ? this._loadWithFontFace() : this._loadWithCSS();
            }, e._loadConch = function () {
                this._http = new De(), this._http.on("error", this, this._onErr), this._http.on("complete", this, this._onHttpLoaded),
                    this._http.send(this._url, null, "get", "arraybuffer");
            }, e._onHttpLoaded = function (t) {
                Ot.window.conchTextCanvas.setFontFaceFromBuffer(this.fontName, t), this._clearHttp(),
                    this._complete();
            }, e._clearHttp = function () {
                this._http && (this._http.off("error", this, this._onErr), this._http.off("complete", this, this._onHttpLoaded),
                    this._http = null);
            }, e._onErr = function () {
                this._clearHttp(), this.err && (this.err.runWith("fail:" + this._url), this.err = null);
            }, e._complete = function () {
                i.systemTimer.clear(this, this._complete), i.systemTimer.clear(this, this._checkComplete),
                    this._div && this._div.parentNode && (this._div.parentNode.removeChild(this._div),
                        this._div = null), this.complete && (this.complete.runWith(this), this.complete = null);
            }, e._checkComplete = function () {
                ue.measureText("LayaTTFFont", this._fontTxt).width != this._txtWidth && this._complete();
            }, e._loadWithFontFace = function () {
                var t = new Ot.window.FontFace(this.fontName, "url('" + this._url + "')");
                Ot.window.document.fonts.add(t);
                var e = this;
                t.loaded.then(function () {
                    e._complete();
                }), t.load();
            }, e._createDiv = function () {
                this._div = Ot.createElement("div"), this._div.innerHTML = "laya";
                var t = this._div.style;
                t.fontFamily = this.fontName, t.position = "absolute", t.left = "-100px", t.top = "-100px",
                    Ot.document.body.appendChild(this._div);
            }, e._loadWithCSS = function () {
                var t = this, e = Ot.createElement("style");
                e.type = "text/css", Ot.document.body.appendChild(e), e.textContent = "@font-face { font-family:'" + this.fontName + "'; src:url('" + this._url + "');}",
                    this._fontTxt = "40px " + this.fontName, this._txtWidth = ue.measureText("LayaTTFFont", this._fontTxt).width;
                var n = this;
                e.onload = function () {
                    i.systemTimer.once(1e4, n, t._complete);
                }, i.systemTimer.loop(20, this, this._checkComplete), this._createDiv();
            }, t._testString = "LayaTTFFont", t;
        }(), k = function () {
            function t() {
                this.blendShader = 0, this.submitType = 0, this.other = 0, this.clear();
            }
            r(t, "laya.webgl.submit.SubmitKey");
            var e = t.prototype;
            return e.clear = function () {
                this.submitType = -1, this.blendShader = this.other = 0;
            }, e.copyFrom = function (t) {
                this.other = t.other, this.blendShader = t.blendShader, this.submitType = t.submitType;
            }, e.copyFrom2 = function (t, e, i) {
                this.other = i, this.submitType = e;
            }, e.equal3_2 = function (t, e, i) {
                return this.submitType === e && this.other === i && this.blendShader === t.blendShader;
            }, e.equal4_2 = function (t, e, i) {
                return this.submitType === e && this.other === i && this.blendShader === t.blendShader;
            }, e.equal_3 = function (t) {
                return this.submitType === t.submitType && this.blendShader === t.blendShader;
            }, e.equal = function (t) {
                return this.other === t.other && this.submitType === t.submitType && this.blendShader === t.blendShader;
            }, t;
        }(), V = (function () {
            function t() {
                this._graphicsCmdEncoder = null, this._index = 0, this._paramData = null, this.texture = null,
                    this.x = NaN, this.y = NaN, this.width = NaN, this.height = NaN;
            }
            r(t, "laya.display.cmd.DrawCanvasCmd");
            var e = t.prototype;
            e.recover = function () {
                this._graphicsCmdEncoder = null, V.recover("DrawCanvasCmd", this);
            }, a(0, e, "cmdID", function () {
                return "DrawCanvasCmd";
            }), t.create = function (t, e, i, n, r) {
                return null;
            }, t.ID = "DrawCanvasCmd", t._DRAW_IMAGE_CMD_ENCODER_ = null, t._PARAM_TEXTURE_POS_ = 2,
                t._PARAM_VB_POS_ = 5;
        }(), function () {
            function t() { }
            return r(t, "laya.utils.Pool"), t.getPoolBySign = function (e) {
                return t._poolDic[e] || (t._poolDic[e] = []);
            }, t.clearBySign = function (e) {
                t._poolDic[e] && (t._poolDic[e].length = 0);
            }, t.recover = function (e, i) {
                i.__InPool || (i.__InPool = !0, t.getPoolBySign(e).push(i));
            }, t.recoverByClass = function (e) {
                if (e) {
                    var i = e.__className || e.constructor._$gid;
                    i && t.recover(i, e);
                }
            }, t._getClassSign = function (t) {
                var e = t.__className || t._$gid;
                return e || (t._$gid = e = ie.getGID() + ""), e;
            }, t.createByClass = function (e) {
                return t.getItemByClass(t._getClassSign(e), e);
            }, t.getItemByClass = function (e, i) {
                if (!t._poolDic[e]) return new i();
                var n = t.getPoolBySign(e);
                if (n.length) {
                    var r = n.pop();
                    r.__InPool = !1;
                } else r = new i();
                return r;
            }, t.getItemByCreateFun = function (e, i, n) {
                var r = t.getPoolBySign(e), a = r.length ? r.pop() : i.call(n);
                return a.__InPool = !1, a;
            }, t.getItem = function (e) {
                var i = t.getPoolBySign(e), n = i.length ? i.pop() : null;
                return n && (n.__InPool = !1), n;
            }, t.POOLSIGN = "__InPool", t._poolDic = {}, t;
        }()), U = function () {
            function t(t) {
                this.script = null, this.codes = {}, this.funs = {}, this.curUseID = -1, this.funnames = "",
                    this.script = t;
                for (var e = 0, i = 0, n = 0; !((e = t.indexOf("#begin", e)) < 0);) {
                    for (n = e + 5; !((n = t.indexOf("#end", n)) < 0) && "i" === t.charAt(n + 4);) n += 5;
                    if (n < 0) throw "add include err,no #end:" + t;
                    i = t.indexOf("\n", e);
                    var r = pe.splitToWords(t.substr(e, i - e), null);
                    "code" == r[1] ? this.codes[r[2]] = t.substr(i + 1, n - i - 1) : "function" == r[1] && (i = t.indexOf("function", e),
                        i += "function".length, this.funs[r[3]] = t.substr(i + 1, n - i - 1), this.funnames += r[3] + ";"),
                        e = n + 1;
                }
            }
            r(t, "laya.webgl.utils.InlcudeFile");
            var e = t.prototype;
            return e.getWith = function (t) {
                var e = t ? this.codes[t] : this.script;
                if (!e) throw "get with error:" + t;
                return e;
            }, e.getFunsScript = function (t) {
                var e = "";
                for (var i in this.funs) t.indexOf(i + ";") >= 0 && (e += this.funs[i]);
                return e;
            }, t;
        }(), G = (function () {
            function t() { }
            r(t, "laya.display.SpriteConst"), t.ALPHA = 1, t.TRANSFORM = 2, t.BLEND = 4, t.CANVAS = 8,
                t.FILTERS = 16, t.MASK = 32, t.CLIP = 64, t.STYLE = 128, t.TEXTURE = 256, t.GRAPHICS = 512,
                t.LAYAGL3D = 1024, t.CUSTOM = 2048, t.ONECHILD = 4096, t.CHILDS = 8192, t.REPAINT_NONE = 0,
                t.REPAINT_NODE = 1, t.REPAINT_CACHE = 2, t.REPAINT_ALL = 3;
        }(), function () {
            function t() {
                this._glBuffer = null, this._buffer = null, this._bufferType = 0, this._bufferUsage = 0,
                    this._byteLength = 0, this._glBuffer = Dt.instance.createBuffer();
            }
            r(t, "laya.webgl.utils.Buffer");
            var e = t.prototype;
            return e._bindForVAO = function () { }, e.bind = function () {
                return !1;
            }, e.destroy = function () {
                this._glBuffer && (Dt.instance.deleteBuffer(this._glBuffer), this._glBuffer = null);
            }, a(0, e, "bufferUsage", function () {
                return this._bufferUsage;
            }), t._bindedVertexBuffer = null, t._bindedIndexBuffer = null, t;
        }()), z = function () {
            function t() {
                this.colorFlt = null;
            }
            r(t, "laya.display.cmd.DrawTextureCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.texture._removeReference(), this.texture = null, this.matrix = null,
                    this.colorFlt = null;
                V.recover("DrawTextureCmd", this);
            }, e.run = function (t, e, i) {
                t.drawTextureWithTransform(this.texture, this.x, this.y, this.width, this.height, this.matrix, e, i, this.alpha, this.blendMode, this.colorFlt);
            }, a(0, e, "cmdID", function () {
                return "DrawTexture";
            }), t.create = function (e, i, n, r, a, s, o, l, h) {
                var u = V.getItemByClass("DrawTextureCmd", t);
                return u.texture = e, e._addReference(), u.x = i, u.y = n, u.width = r, u.height = a,
                    u.matrix = s, u.alpha = o, u.color = l, u.blendMode = h, l && (u.colorFlt = new Te(),
                        u.colorFlt.setColor(l)), u;
            }, t.ID = "DrawTexture", t;
        }(), H = function () {
            function t(e, i) {
                this.size = [0, 0], this.alpha = 1, this.ALPHA = 1, this.subID = 0, this.ref = 1,
                    this._cacheID = 0, this.clipMatDir = [99999999, 0, 0, 99999999], this.clipMatPos = [0, 0],
                    this.clipOff = [0, 0], this.defines = new Re(), this.mainID = e, this.subID = i,
                    this.textureHost = null, this.texture = null, this.color = null, this.colorAdd = null,
                    this.u_mmat2 = null, this._cacheID = e | i, this._inClassCache = t._cache[this._cacheID],
                    e > 0 && !this._inClassCache && (this._inClassCache = t._cache[this._cacheID] = [],
                        this._inClassCache._length = 0), this.clear();
            }
            r(t, "laya.webgl.shader.d2.value.Value2D");
            var e = t.prototype;
            return e.setValue = function (t) { }, e._ShaderWithCompile = function () {
                return ni.withCompile2D(0, this.mainID, this.defines.toNameDic(), this.mainID | this.defines._value, ui.create, this._attribLocation);
            }, e.upload = function () {
                var t = ft;
                ft.worldMatrix4 === ft.TEMPMAT4_ARRAY || this.defines.addInt(128), this.mmat = t.worldMatrix4,
                    ft.matWVP && (this.defines.addInt(2048), this.u_MvpMatrix = ft.matWVP.elements);
                var e = ni.sharders[this.mainID | this.defines._value] || this._ShaderWithCompile();
                e._shaderValueWidth !== t.width || e._shaderValueHeight !== t.height ? (this.size[0] = t.width,
                    this.size[1] = t.height, e._shaderValueWidth = t.width, e._shaderValueHeight = t.height,
                    e.upload(this, null)) : e.upload(this, e._params2dQuick2 || e._make2dQuick2());
            }, e.setFilters = function (t) {
                if (this.filters = t, t) for (var e, i = t.length, n = 0; n < i; n++) (e = t[n]) && (this.defines.add(e.type),
                    e.action.setValue(this));
            }, e.clear = function () {
                this.defines._value = this.subID + (Ct.shaderHighPrecision ? 1024 : 0), this.clipOff[0] = 0;
            }, e.release = function () {
                --this.ref < 1 && (this._inClassCache && (this._inClassCache[this._inClassCache._length++] = this),
                    this.clear(), this.filters = null, this.ref = 1, this.clipOff[0] = 0);
            }, t._initone = function (e, i) {
                t._typeClass[e] = i, t._cache[e] = [], t._cache[e]._length = 0;
            }, t.__init__ = function () {
                t._initone(4, He), t._initone(512, je), t._initone(1, Be), t._initone(9, Be);
            }, t.create = function (e, i) {
                var n = t._cache[e | i];
                return n._length ? n[--n._length] : new t._typeClass[e | i](i);
            }, t._cache = [], t._typeClass = [], t.TEMPMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                t;
        }(), j = function () {
            function t() { }
            return r(t, "laya.maths.GrahamScan"), t.multiply = function (t, e, i) {
                return (t.x - i.x) * (e.y - i.y) - (e.x - i.x) * (t.y - i.y);
            }, t.dis = function (t, e) {
                return (t.x - e.x) * (t.x - e.x) + (t.y - e.y) * (t.y - e.y);
            }, t._getPoints = function (e, i, n) {
                for (void 0 === i && (i = !1), t._mPointList || (t._mPointList = []); t._mPointList.length < e;) t._mPointList.push(new jt());
                return n || (n = []), n.length = 0, i ? t.getFrom(n, t._mPointList, e) : t.getFromR(n, t._mPointList, e),
                    n;
            }, t.getFrom = function (t, e, i) {
                var n = 0;
                for (n = 0; n < i; n++) t.push(e[n]);
                return t;
            }, t.getFromR = function (t, e, i) {
                var n = 0;
                for (n = 0; n < i; n++) t.push(e.pop());
                return t;
            }, t.pListToPointList = function (e, i) {
                void 0 === i && (i = !1);
                var n = 0, r = e.length / 2, a = t._getPoints(r, i, t._tempPointList);
                for (n = 0; n < r; n++) a[n].setTo(e[n + n], e[n + n + 1]);
                return a;
            }, t.pointListToPlist = function (e) {
                var i, n = 0, r = e.length, a = t._temPList;
                for (a.length = 0, n = 0; n < r; n++) i = e[n], a.push(i.x, i.y);
                return a;
            }, t.scanPList = function (e) {
                return ie.copyArray(e, t.pointListToPlist(t.scan(t.pListToPointList(e, !0))));
            }, t.scan = function (e) {
                var i, n, r, a = 0, s = 0, o = 0, l = e.length, h = {};
                for ((n = t._temArr).length = 0, a = (l = e.length) - 1; a >= 0; a--) r = (i = e[a]).x + "_" + i.y,
                    h.hasOwnProperty(r) || (h[r] = !0, n.push(i));
                for (l = n.length, ie.copyArray(e, n), a = 1; a < l; a++) (e[a].y < e[o].y || e[a].y == e[o].y && e[a].x < e[o].x) && (o = a);
                for (i = e[0], e[0] = e[o], e[o] = i, a = 1; a < l - 1; a++) {
                    for (o = a, s = a + 1; s < l; s++) (t.multiply(e[s], e[o], e[0]) > 0 || 0 == t.multiply(e[s], e[o], e[0]) && t.dis(e[0], e[s]) < t.dis(e[0], e[o])) && (o = s);
                    i = e[a], e[a] = e[o], e[o] = i;
                }
                if ((n = t._temArr).length = 0, e.length < 3) return ie.copyArray(n, e);
                for (n.push(e[0], e[1], e[2]), a = 3; a < l; a++) {
                    for (; n.length >= 2 && t.multiply(e[a], n[n.length - 1], n[n.length - 2]) >= 0;) n.pop();
                    e[a] && n.push(e[a]);
                }
                return n;
            }, t._mPointList = null, t._tempPointList = [], t._temPList = [], t._temArr = [],
                t;
        }(), W = function () {
            function t() {
                this._saveuse = 0;
            }
            r(t, "laya.webgl.canvas.save.SaveMark");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.canvas.save.ISaveData": !0
            }), e.isSaveMark = function () {
                return !0;
            }, e.restore = function (e) {
                e._saveMark = this._preSaveMark, t.POOL[t.POOL._length++] = this;
            }, t.Create = function (e) {
                var i = t.POOL, n = i._length > 0 ? i[--i._length] : new t();
                return n._saveuse = 0, n._preSaveMark = e._saveMark, e._saveMark = n, n;
            }, t.POOL = l._createArray(), t;
        }(), X = function () {
            function t() {
                this.gid = 0, this.repeat = 1, this._count = 0;
            }
            r(t, "laya.utils.Tween");
            var e = t.prototype;
            return e.to = function (t, e, i, n, r, a, s) {
                return void 0 === a && (a = 0), void 0 === s && (s = !1), this._create(t, e, i, n, r, a, s, !0, !1, !0);
            }, e.from = function (t, e, i, n, r, a, s) {
                return void 0 === a && (a = 0), void 0 === s && (s = !1), this._create(t, e, i, n, r, a, s, !1, !1, !0);
            }, e._create = function (e, n, r, a, s, o, l, h, u, c) {
                if (!e) throw new Error("Tween:target is null");
                this._target = e, this._duration = r, this._ease = a || n.ease || t.easeNone, this._complete = s || n.complete,
                    this._delay = o, this._props = [], this._usedTimer = 0, this._startTimer = Ot.now(),
                    this._usedPool = u, this._delayParam = null, this.update = n.update;
                var d = e.$_GID || (e.$_GID = ie.getGID());
                return t.tweenMap[d] ? (l && t.clearTween(e), t.tweenMap[d].push(this)) : t.tweenMap[d] = [this],
                    c ? o <= 0 ? this.firstStart(e, n, h) : (this._delayParam = [e, n, h], i.timer.once(o, this, this.firstStart, this._delayParam)) : this._initProps(e, n, h),
                    this;
            }, e.firstStart = function (t, e, i) {
                this._delayParam = null, t.destroyed ? this.clear() : (this._initProps(t, e, i),
                    this._beginLoop());
            }, e._initProps = function (t, e, i) {
                for (var n in e) if ("number" == typeof t[n]) {
                    var r = i ? t[n] : e[n], a = i ? e[n] : t[n];
                    this._props.push([n, r, a - r]), i || (t[n] = r);
                }
            }, e._beginLoop = function () {
                i.timer.frameLoop(1, this, this._doEase);
            }, e._doEase = function () {
                this._updateEase(Ot.now());
            }, e._updateEase = function (e) {
                var i = this._target;
                if (i) {
                    if (i.destroyed) return t.clearTween(i);
                    var n = this._usedTimer = e - this._startTimer - this._delay;
                    if (!(n < 0)) {
                        if (n >= this._duration) return this.complete();
                        for (var r = n > 0 ? this._ease(n, 0, 1, this._duration) : 0, a = this._props, s = 0, o = a.length; s < o; s++) {
                            var l = a[s];
                            i[l[0]] = l[1] + r * l[2];
                        }
                        this.update && this.update.run();
                    }
                }
            }, e.complete = function () {
                if (this._target) {
                    i.timer.runTimer(this, this.firstStart);
                    for (var t = this._target, e = this._props, n = this._complete, r = 0, a = e.length; r < a; r++) {
                        var s = e[r];
                        t[s[0]] = s[1] + s[2];
                    }
                    this.update && this.update.run(), this._count++, 0 != this.repeat && this._count >= this.repeat ? (this.clear(),
                        n && n.run()) : this.restart();
                }
            }, e.pause = function () {
                i.timer.clear(this, this._beginLoop), i.timer.clear(this, this._doEase), i.timer.clear(this, this.firstStart);
                var t;
                (t = Ot.now() - this._startTimer - this._delay) < 0 && (this._usedTimer = t);
            }, e.setStartTime = function (t) {
                this._startTimer = t;
            }, e.clear = function () {
                this._target && (this._remove(), this._clear());
            }, e._clear = function () {
                this.pause(), i.timer.clear(this, this.firstStart), this._complete = null, this._target = null,
                    this._ease = null, this._props = null, this._delayParam = null, this._usedPool && (this.update = null,
                        V.recover("tween", this));
            }, e.recover = function () {
                this._usedPool = !0, this._clear();
            }, e._remove = function () {
                var e = t.tweenMap[this._target.$_GID];
                if (e) for (var i = 0, n = e.length; i < n; i++) if (e[i] === this) {
                    e.splice(i, 1);
                    break;
                }
            }, e.restart = function () {
                if (this.pause(), this._usedTimer = 0, this._startTimer = Ot.now(), this._delayParam) i.timer.once(this._delay, this, this.firstStart, this._delayParam); else {
                    for (var t = this._props, e = 0, n = t.length; e < n; e++) {
                        var r = t[e];
                        this._target[r[0]] = r[1];
                    }
                    i.timer.once(this._delay, this, this._beginLoop);
                }
            }, e.resume = function () {
                this._usedTimer >= this._duration || (this._startTimer = Ot.now() - this._usedTimer - this._delay,
                    this._delayParam ? this._usedTimer < 0 ? i.timer.once(-this._usedTimer, this, this.firstStart, this._delayParam) : this.firstStart.apply(this, this._delayParam) : this._beginLoop());
            }, a(0, e, "progress", null, function (t) {
                var e = t * this._duration;
                this._startTimer = Ot.now() - this._delay - e;
            }), t.to = function (e, i, n, r, a, s, o, l) {
                return void 0 === s && (s = 0), void 0 === o && (o = !1), void 0 === l && (l = !0),
                    V.getItemByClass("tween", t)._create(e, i, n, r, a, s, o, !0, l, !0);
            }, t.from = function (e, i, n, r, a, s, o, l) {
                return void 0 === s && (s = 0), void 0 === o && (o = !1), void 0 === l && (l = !0),
                    V.getItemByClass("tween", t)._create(e, i, n, r, a, s, o, !1, l, !0);
            }, t.clearAll = function (e) {
                if (e && e.$_GID) {
                    var i = t.tweenMap[e.$_GID];
                    if (i) {
                        for (var n = 0, r = i.length; n < r; n++) i[n]._clear();
                        i.length = 0;
                    }
                }
            }, t.clear = function (t) {
                t.clear();
            }, t.clearTween = function (e) {
                t.clearAll(e);
            }, t.easeNone = function (t, e, i, n) {
                return i * t / n + e;
            }, t.tweenMap = [], t;
        }(), Y = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawRectCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.fillColor = null, this.lineColor = null, V.recover("DrawRectCmd", this);
            }, e.run = function (t, e, i) {
                t.drawRect(this.x + e, this.y + i, this.width, this.height, this.fillColor, this.lineColor, this.lineWidth);
            }, a(0, e, "cmdID", function () {
                return "DrawRect";
            }), t.create = function (e, i, n, r, a, s, o) {
                var l = V.getItemByClass("DrawRectCmd", t);
                return l.x = e, l.y = i, l.width = n, l.height = r, l.fillColor = a, l.lineColor = s,
                    l.lineWidth = o, l;
            }, t.ID = "DrawRect", t;
        }(), q = function () {
            function t(t, e, i) {
                this.i = null, this.x = null, this.y = null, this.prev = null, this.next = null,
                    this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = null, this.i = t,
                    this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, this.prevZ = null,
                    this.nextZ = null, this.steiner = !1;
            }
            return r(t, "laya.webgl.shapes.EarcutNode"), t;
        }(), K = function () {
            function t() {
                this.fun = null, this._this = null, this.args = null, this._ref = 1, this._key = new k();
            }
            r(t, "laya.webgl.submit.SubmitCMD");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.submit.ISubmit": !0
            }), e.renderSubmit = function () {
                return this.fun.apply(this._this, this.args), 1;
            }, e.getRenderType = function () {
                return 0;
            }, e.reUse = function (t, e) {
                return this._ref++, e;
            }, e.releaseRender = function () {
                if (--this._ref < 1) {
                    var e = t.POOL;
                    e[e._length++] = this;
                }
            }, e.clone = function (t, e, i) {
                return null;
            }, t.create = function (e, i, n) {
                var r = t.POOL._length ? t.POOL[--t.POOL._length] : new t();
                return r.fun = i, r.args = e, r._this = n, r._ref = 1, r._key.clear(), r;
            }, t.POOL = [], t.__init$ = function () {
                t.POOL._length = 0;
            }, t;
        }(), Z = function () {
            function t(e) {
                this._url = null, this._path = null, this._url = t.formatURL(e), this._path = t.getPath(e);
            }
            r(t, "laya.net.URL");
            var e = t.prototype;
            return a(0, e, "path", function () {
                return this._path;
            }), a(0, e, "url", function () {
                return this._url;
            }), a(1, t, "basePath", function () {
                return t._basePath;
            }, function (e) {
                t._basePath = i._getUrlPath(), t._basePath = t.formatURL(e);
            }), t.formatURL = function (e) {
                if (!e) return "null path";
                if (e.indexOf(":") > 0) return e;
                if (null != t.customFormat && (e = t.customFormat(e)), e.indexOf(":") > 0) return e;
                var i = e.charAt(0);
                if ("." === i) return t._formatRelativePath(t._basePath + e);
                if ("~" === i) return t.rootPath + e.substring(1);
                if ("d" === i) {
                    if (0 === e.indexOf("data:image")) return e;
                } else if ("/" === i) return e;
                return t._basePath + e;
            }, t._formatRelativePath = function (t) {
                for (var e = t.split("/"), i = 0, n = e.length; i < n; i++) ".." == e[i] && (e.splice(i - 1, 2),
                    i -= 2);
                return e.join("/");
            }, t.getPath = function (t) {
                var e = t.lastIndexOf("/");
                return e > 0 ? t.substr(0, e + 1) : "";
            }, t.getFileName = function (t) {
                var e = t.lastIndexOf("/");
                return e > 0 ? t.substr(e + 1) : t;
            }, t.getAdptedFilePath = function (e) {
                if (!t.exportSceneToJson || !e) return e;
                var i, n, r = 0;
                for (i = t._adpteTypeList.length, r = 0; r < i; r++) n = t._adpteTypeList[r], e = e.replace(n[0], n[1]);
                return e;
            }, t.version = {}, t.exportSceneToJson = !1, t._basePath = "", t.rootPath = "",
                t.customFormat = function (e) {
                    var i = t.version[e];
                    return !At.isConchApp && i && (e += "?v=" + i), e;
                }, n(t, ["_adpteTypeList", function () {
                    return this._adpteTypeList = [[".scene3d", ".json"], [".scene", ".json"], [".taa", ".json"], [".prefab", ".json"]];
                }]), t;
        }(), Q = function () {
            function t() { }
            return r(t, "laya.utils.CacheManger"), t.regCacheByFunction = function (e, i) {
                var n;
                t.unRegCacheByFunction(e, i), n = {
                    tryDispose: e,
                    getCacheList: i
                }, t._cacheList.push(n);
            }, t.unRegCacheByFunction = function (e, i) {
                var n, r = 0;
                for (n = t._cacheList.length, r = 0; r < n; r++) if (t._cacheList[r].tryDispose == e && t._cacheList[r].getCacheList == i) return void t._cacheList.splice(r, 1);
            }, t.forceDispose = function () {
                var e = 0, i = t._cacheList.length;
                for (e = 0; e < i; e++) t._cacheList[e].tryDispose(!0);
            }, t.beginCheck = function (e) {
                void 0 === e && (e = 15e3), i.systemTimer.loop(e, null, t._checkLoop);
            }, t.stopCheck = function () {
                i.systemTimer.clear(null, t._checkLoop);
            }, t._checkLoop = function () {
                var e = t._cacheList;
                if (!(e.length < 1)) {
                    var i, n = Ot.now(), r = 0;
                    for (i = r = e.length; r > 0 && (t._index++, t._index = t._index % i, e[t._index].tryDispose(!1),
                        !(Ot.now() - n > t.loopTimeLimit));) r--;
                }
            }, t.loopTimeLimit = 2, t._cacheList = [], t._index = 0, t;
        }(), J = function () {
            function t() {
                this.reset();
            }
            r(t, "laya.display.css.SpriteStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.scaleX = this.scaleY = 1, this.skewX = this.skewY = 0, this.pivotX = this.pivotY = this.rotation = 0,
                    this.alpha = 1, this.scrollRect && this.scrollRect.recover(), this.scrollRect = null,
                    this.viewport && this.viewport.recover(), this.viewport = null, this.hitArea = null,
                    this.dragging = null, this.blendMode = null, this;
            }, e.recover = function () {
                this !== t.EMPTY && V.recover("SpriteStyle", this.reset());
            }, t.create = function () {
                return V.getItemByClass("SpriteStyle", t);
            }, t.EMPTY = new t(), t;
        }(), $ = (function () {
            function t(t, e) {
                this.submitStartPos = 0, this.submitEndPos = 0, this.context = null, this.touches = [],
                    this.submits = [], this.sprite = null, this._mesh = null, this._pathMesh = null,
                    this._triangleMesh = null, this.meshlist = [], this._oldMesh = null, this._oldPathMesh = null,
                    this._oldTriMesh = null, this._oldMeshList = null, this.oldTx = 0, this.oldTy = 0,
                    this.cachedClipInfo = new at(), this.invMat = new at(), this.context = t, this.sprite = e,
                    t._globalClipMatrix.copyTo(this.cachedClipInfo);
            }
            r(t, "laya.webgl.canvas.WebGLCacheAsNormalCanvas");
            var e = t.prototype;
            e.startRec = function () {
                this.context._charSubmitCache._enbale && (this.context._charSubmitCache.enable(!1, this.context),
                    this.context._charSubmitCache.enable(!0, this.context)), this.context._incache = !0,
                    this.touches.length = 0, this.context.touches = this.touches, this.context._globalClipMatrix.copyTo(this.cachedClipInfo),
                    this.submits.length = 0, this.submitStartPos = this.context._submits._length;
                for (var t = 0, e = this.meshlist.length; t < e; t++) {
                    var i = this.meshlist[t];
                    i.canReuse ? i.releaseMesh() : i.destroy();
                }
                this.meshlist.length = 0, this._mesh = Pe.getAMesh(!1), this._pathMesh = we.getAMesh(!1),
                    this._triangleMesh = ke.getAMesh(!1), this.meshlist.push(this._mesh), this.meshlist.push(this._pathMesh),
                    this.meshlist.push(this._triangleMesh), this.context._curSubmit = h.RENDERBASE,
                    this._oldMesh = this.context._mesh, this._oldPathMesh = this.context._pathMesh,
                    this._oldTriMesh = this.context._triangleMesh, this._oldMeshList = this.context.meshlist,
                    this.context._mesh = this._mesh, this.context._pathMesh = this._pathMesh, this.context._triangleMesh = this._triangleMesh,
                    this.context.meshlist = this.meshlist, this.oldTx = this.context._curMat.tx, this.oldTy = this.context._curMat.ty,
                    this.context._curMat.tx = 0, this.context._curMat.ty = 0, this.context._curMat.copyTo(this.invMat),
                    this.invMat.invert();
            }, e.endRec = function () {
                this.context._charSubmitCache._enbale && (this.context._charSubmitCache.enable(!1, this.context),
                    this.context._charSubmitCache.enable(!0, this.context));
                var t = this.context._submits;
                this.submitEndPos = t._length;
                for (var e = this.submitEndPos - this.submitStartPos, i = 0; i < e; i++) this.submits.push(t[this.submitStartPos + i]);
                t._length -= e, this.context._mesh = this._oldMesh, this.context._pathMesh = this._oldPathMesh,
                    this.context._triangleMesh = this._oldTriMesh, this.context.meshlist = this._oldMeshList,
                    this.context._curSubmit = h.RENDERBASE, this.context._curMat.tx = this.oldTx, this.context._curMat.ty = this.oldTy,
                    this.context.touches = null, this.context._incache = !1;
            }, e.isCacheValid = function () {
                var t = this.context._globalClipMatrix;
                return t.a == this.cachedClipInfo.a && t.b == this.cachedClipInfo.b && t.c == this.cachedClipInfo.c && t.d == this.cachedClipInfo.d && t.tx == this.cachedClipInfo.tx && t.ty == this.cachedClipInfo.ty;
            }, e.flushsubmit = function () {
                var t = h.RENDERBASE;
                this.submits.forEach(function (e) {
                    e != h.RENDERBASE && (h.preRender = t, t = e, e.renderSubmit());
                });
            }, e.releaseMem = function () { }, n(t, ["matI", function () {
                return this.matI = new at();
            }]);
        }(), function () {
            var t;
            function e(t) {
                this.scale = 1, this.currFrame = 0, this._delta = 0, this._map = [], this._handlers = [],
                    this._temp = [], this._count = 0, this.currTimer = Ot.now(), this._lastTimer = Ot.now(),
                    void 0 === t && (t = !0), t && i.systemTimer && i.systemTimer.frameLoop(1, this, this._update);
            }
            r(e, "laya.utils.Timer");
            var n = e.prototype;
            return n._update = function () {
                if (this.scale <= 0) this._lastTimer = Ot.now(); else {
                    var t = this.currFrame = this.currFrame + this.scale, e = Ot.now();
                    this._delta = (e - this._lastTimer) * this.scale;
                    var i = this.currTimer = this.currTimer + this._delta;
                    this._lastTimer = e;
                    var n = this._handlers;
                    this._count = 0;
                    for (var r = 0, a = n.length; r < a; r++) {
                        var s = n[r];
                        if (null !== s.method) {
                            var o = s.userFrame ? t : i;
                            if (o >= s.exeTime) if (s.repeat) if (s.jumpFrame) for (; o >= s.exeTime;) s.exeTime += s.delay,
                                s.run(!1); else s.exeTime += s.delay, s.run(!1), o > s.exeTime && (s.exeTime += Math.ceil((o - s.exeTime) / s.delay) * s.delay); else s.run(!0);
                        } else this._count++;
                    }
                    (this._count > 30 || t % 200 == 0) && this._clearHandlers();
                }
            }, n._clearHandlers = function () {
                for (var t = this._handlers, e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    null !== n.method ? this._temp.push(n) : this._recoverHandler(n);
                }
                this._handlers = this._temp, t.length = 0, this._temp = t;
            }, n._recoverHandler = function (t) {
                this._map[t.key] == t && (this._map[t.key] = null), t.clear(), e._pool.push(t);
            }, n._create = function (i, n, r, a, s, o, l) {
                if (!r) return s.apply(a, o), null;
                if (l) {
                    var h = this._getHandler(a, s);
                    if (h) return h.repeat = n, h.userFrame = i, h.delay = r, h.caller = a, h.method = s,
                        h.args = o, h.exeTime = r + (i ? this.currFrame : this.currTimer + Ot.now() - this._lastTimer),
                        h;
                }
                return (h = e._pool.length > 0 ? e._pool.pop() : new t()).repeat = n, h.userFrame = i,
                    h.delay = r, h.caller = a, h.method = s, h.args = o, h.exeTime = r + (i ? this.currFrame : this.currTimer + Ot.now() - this._lastTimer),
                    this._indexHandler(h), this._handlers.push(h), h;
            }, n._indexHandler = function (t) {
                var i = t.caller, n = t.method, r = i ? i.$_GID || (i.$_GID = ie.getGID()) : 0, a = n.$_TID || (n.$_TID = 1e5 * e._mid++);
                t.key = r + a, this._map[t.key] = t;
            }, n.once = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!1, !1, t, e, i, n, r);
            }, n.loop = function (t, e, i, n, r, a) {
                void 0 === r && (r = !0), void 0 === a && (a = !1);
                var s = this._create(!1, !0, t, e, i, n, r);
                s && (s.jumpFrame = a);
            }, n.frameOnce = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!0, !1, t, e, i, n, r);
            }, n.frameLoop = function (t, e, i, n, r) {
                void 0 === r && (r = !0), this._create(!0, !0, t, e, i, n, r);
            }, n.toString = function () {
                return " handlers:" + this._handlers.length + " pool:" + e._pool.length;
            }, n.clear = function (t, e) {
                var i = this._getHandler(t, e);
                i && (this._map[i.key] = null, i.key = 0, i.clear());
            }, n.clearAll = function (t) {
                if (t) for (var e = 0, i = this._handlers.length; e < i; e++) {
                    var n = this._handlers[e];
                    n.caller === t && (this._map[n.key] = null, n.key = 0, n.clear());
                }
            }, n._getHandler = function (t, i) {
                var n = t ? t.$_GID || (t.$_GID = ie.getGID()) : 0, r = i.$_TID || (i.$_TID = 1e5 * e._mid++);
                return this._map[n + r];
            }, n.callLater = function (t, e, i) {
                Kt.I.callLater(t, e, i);
            }, n.runCallLater = function (t, e) {
                Kt.I.runCallLater(t, e);
            }, n.runTimer = function (t, e) {
                var i = this._getHandler(t, e);
                i && null != i.method && (this._map[i.key] = null, i.run(!0));
            }, n.pause = function () {
                this.scale = 0;
            }, n.resume = function () {
                this.scale = 1;
            }, a(0, n, "delta", function () {
                return this._delta;
            }), e._pool = [], e._mid = 1, e.__init$ = function () {
                t = function () {
                    function t() {
                        this.key = 0, this.repeat = !1, this.delay = 0, this.userFrame = !1, this.exeTime = 0,
                            this.caller = null, this.method = null, this.args = null, this.jumpFrame = !1;
                    }
                    r(t, "");
                    var e = t.prototype;
                    return e.clear = function () {
                        this.caller = null, this.method = null, this.args = null;
                    }, e.run = function (t) {
                        var e = this.caller;
                        if (e && e.destroyed) return this.clear();
                        var i = this.method, n = this.args;
                        t && this.clear(), null != i && (n ? i.apply(e, n) : i.call(e));
                    }, t;
                }();
            }, e;
        }()), tt = function () {
            function t() {
                this.reset();
            }
            r(t, "laya.display.css.CacheStyle");
            var e = t.prototype;
            return e.needBitmapCache = function () {
                return this.cacheForFilters || !!this.mask;
            }, e.needEnableCanvasRender = function () {
                return "none" != this.userSetCache || this.cacheForFilters || !!this.mask;
            }, e.releaseContext = function () {
                this.canvas && this.canvas.size && (V.recover("CacheCanvas", this.canvas), this.canvas.size(0, 0),
                    this.canvas.width = 0, this.canvas.height = 0), this.canvas = null;
            }, e.createContext = function () {
                if (!this.canvas) {
                    this.canvas = V.getItem("CacheCanvas") || new ai(!1);
                    var t = this.canvas.context;
                    t || (t = this.canvas.getContext("2d"));
                }
            }, e.releaseFilterCache = function () {
                var t = this.filterCache;
                t && (t.destroy(), t.recycle(), this.filterCache = null);
            }, e.recover = function () {
                this !== t.EMPTY && V.recover("SpriteCache", this.reset());
            }, e.reset = function () {
                return this.releaseContext(), this.releaseFilterCache(), this.cacheAs = "none",
                    this.enableCanvasRender = !1, this.userSetCache = "none", this.cacheForFilters = !1,
                    this.staticCache = !1, this.reCache = !0, this.mask = null, this.maskParent = null,
                    this.filterCache = null, this.filters = null, this.hasGlowFilter = !1, this.cacheRect && this.cacheRect.recover(),
                    this.cacheRect = null, this;
            }, e._calculateCacheRect = function (e, i, n, r) {
                var a, s = e._cacheStyle;
                if (s.cacheRect || (s.cacheRect = mt.create()), "bitmap" === i ? ((a = e.getSelfBounds()).width = a.width + 32,
                    a.height = a.height + 32, a.x = a.x - e.pivotX, a.y = a.y - e.pivotY, a.x = a.x - 16,
                    a.y = a.y - 16, a.x = Math.floor(a.x + n) - n, a.y = Math.floor(a.y + r) - r, a.width = Math.floor(a.width),
                    a.height = Math.floor(a.height), s.cacheRect.copyFrom(a)) : s.cacheRect.setTo(-e._style.pivotX, -e._style.pivotY, 1, 1),
                    a = s.cacheRect, e._style.scrollRect) {
                    var o = e._style.scrollRect;
                    a.x -= o.x, a.y -= o.y;
                }
                return t._scaleInfo.setTo(1, 1), t._scaleInfo;
            }, t.create = function () {
                return V.getItemByClass("SpriteCache", t);
            }, t.EMPTY = new t(), t.CANVAS_EXTEND_EDGE = 16, n(t, ["_scaleInfo", function () {
                return this._scaleInfo = new jt();
            }]), t;
        }(), et = function () {
            function t() {
                this._mat = new at();
            }
            r(t, "laya.webgl.canvas.save.SaveTranslate");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.canvas.save.ISaveData": !0
            }), e.isSaveMark = function () {
                return !1;
            }, e.restore = function (e) {
                this._mat.copyTo(e._curMat), t.POOL[t.POOL._length++] = this;
            }, t.save = function (e) {
                var i = t.POOL, n = i._length > 0 ? i[--i._length] : new t();
                e._curMat.copyTo(n._mat);
                var r = e._save;
                r[r._length++] = n;
            }, t.POOL = l._createArray(), t;
        }(), it = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawLineCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("DrawLineCmd", this);
            }, e.run = function (t, e, i) {
                t._drawLine(e, i, this.fromX, this.fromY, this.toX, this.toY, this.lineColor, this.lineWidth, this.vid);
            }, a(0, e, "cmdID", function () {
                return "DrawLine";
            }), t.create = function (e, i, n, r, a, s, o) {
                var l = V.getItemByClass("DrawLineCmd", t);
                return l.fromX = e, l.fromY = i, l.toX = n, l.toY = r, l.lineColor = a, l.lineWidth = s,
                    l.vid = o, l;
            }, t.ID = "DrawLine", t;
        }(), nt = function () {
            function e() { }
            r(e, "laya.webgl.WebGLContext");
            var i = e.prototype;
            return i.getContextAttributes = function () {
                return null;
            }, i.isContextLost = function () { }, i.getSupportedExtensions = function () {
                return null;
            }, i.getExtension = function (t) {
                return null;
            }, i.activeTexture = function (t) { }, i.attachShader = function (t, e) { }, i.bindAttribLocation = function (t, e, i) { },
                i.bindBuffer = function (t, e) { }, i.bindFramebuffer = function (t, e) { }, i.bindRenderbuffer = function (t, e) { },
                i.bindTexture = function (t, e) { }, i.useTexture = function (t) { }, i.blendColor = function (t, e, i, n) { },
                i.blendEquation = function (t) { }, i.blendEquationSeparate = function (t, e) { }, i.blendFunc = function (t, e) { },
                i.blendFuncSeparate = function (t, e, i, n) { }, i.bufferData = function (t, e, i) { },
                i.bufferSubData = function (t, e, i) { }, i.checkFramebufferStatus = function (t) {
                    return null;
                }, i.clear = function (t) { }, i.clearColor = function (t, e, i, n) { }, i.clearDepth = function (t) { },
                i.clearStencil = function (t) { }, i.colorMask = function (t, e, i, n) { }, i.compileShader = function (t) { },
                i.copyTexImage2D = function (t, e, i, n, r, a, s, o) { }, i.copyTexSubImage2D = function (t, e, i, n, r, a, s, o) { },
                i.createBuffer = function () { }, i.createFramebuffer = function () { }, i.createProgram = function () { },
                i.createRenderbuffer = function () { }, i.createShader = function (t) { }, i.createTexture = function () {
                    return null;
                }, i.cullFace = function (t) { }, i.deleteBuffer = function (t) { }, i.deleteFramebuffer = function (t) { },
                i.deleteProgram = function (t) { }, i.deleteRenderbuffer = function (t) { }, i.deleteShader = function (t) { },
                i.deleteTexture = function (t) { }, i.depthFunc = function (t) { }, i.depthMask = function (t) { },
                i.depthRange = function (t, e) { }, i.detachShader = function (t, e) { }, i.disable = function (t) { },
                i.disableVertexAttribArray = function (t) { }, i.drawArrays = function (t, e, i) { },
                i.drawElements = function (t, e, i, n) { }, i.enable = function (t) { }, i.enableVertexAttribArray = function (t) { },
                i.finish = function () { }, i.flush = function () { }, i.framebufferRenderbuffer = function (t, e, i, n) { },
                i.framebufferTexture2D = function (t, e, i, n, r) { }, i.frontFace = function (t) {
                    return null;
                }, i.generateMipmap = function (t) {
                    return null;
                }, i.getActiveAttrib = function (t, e) {
                    return null;
                }, i.getActiveUniform = function (t, e) {
                    return null;
                }, i.getAttribLocation = function (t, e) {
                    return 0;
                }, i.getParameter = function (t) {
                    return null;
                }, i.getBufferParameter = function (t, e) {
                    return null;
                }, i.getError = function () {
                    return null;
                }, i.getFramebufferAttachmentParameter = function (t, e, i) { }, i.getProgramParameter = function (t, e) {
                    return 0;
                }, i.getProgramInfoLog = function (t) {
                    return null;
                }, i.getRenderbufferParameter = function (t, e) {
                    return null;
                }, i.getShaderPrecisionFormat = function (t) {
                    return null;
                }, i.getShaderParameter = function (t, e) { }, i.getShaderInfoLog = function (t) {
                    return null;
                }, i.getShaderSource = function (t) {
                    return null;
                }, i.getTexParameter = function (t, e) { }, i.getUniform = function (t, e) { }, i.getUniformLocation = function (t, e) {
                    return null;
                }, i.getVertexAttrib = function (t, e) {
                    return null;
                }, i.getVertexAttribOffset = function (t, e) {
                    return null;
                }, i.hint = function (t, e) { }, i.isBuffer = function (t) { }, i.isEnabled = function (t) { },
                i.isFramebuffer = function (t) { }, i.isProgram = function (t) { }, i.isRenderbuffer = function (t) { },
                i.isShader = function (t) { }, i.isTexture = function (t) { }, i.lineWidth = function (t) { },
                i.linkProgram = function (t) { }, i.pixelStorei = function (t, e) { }, i.polygonOffset = function (t, e) { },
                i.readPixels = function (t, e, i, n, r, a, s) { }, i.renderbufferStorage = function (t, e, i, n) { },
                i.sampleCoverage = function (t, e) { }, i.scissor = function (t, e, i, n) { }, i.shaderSource = function (t, e) { },
                i.stencilFunc = function (t, e, i) { }, i.stencilFuncSeparate = function (t, e, i, n) { },
                i.stencilMask = function (t) { }, i.stencilMaskSeparate = function (t, e) { }, i.stencilOp = function (t, e, i) { },
                i.stencilOpSeparate = function (t, e, i, n) { }, i.texImage2D = function (t) { }, i.texParameterf = function (t, e, i) { },
                i.texParameteri = function (t, e, i) { }, i.texSubImage2D = function (t) { }, i.uniform1f = function (t, e) { },
                i.uniform1fv = function (t, e) { }, i.uniform1i = function (t, e) { }, i.uniform1iv = function (t, e) { },
                i.uniform2f = function (t, e, i) { }, i.uniform2fv = function (t, e) { }, i.uniform2i = function (t, e, i) { },
                i.uniform2iv = function (t, e) { }, i.uniform3f = function (t, e, i, n) { }, i.uniform3fv = function (t, e) { },
                i.uniform3i = function (t, e, i, n) { }, i.uniform3iv = function (t, e) { }, i.uniform4f = function (t, e, i, n, r) { },
                i.uniform4fv = function (t, e) { }, i.uniform4i = function (t, e, i, n, r) { }, i.uniform4iv = function (t, e) { },
                i.uniformMatrix2fv = function (t, e, i) { }, i.uniformMatrix3fv = function (t, e, i) { },
                i.uniformMatrix4fv = function (t, e, i) { }, i.useProgram = function (t) { }, i.validateProgram = function (t) { },
                i.vertexAttrib1f = function (t, e) { }, i.vertexAttrib1fv = function (t, e) { }, i.vertexAttrib2f = function (t, e, i) { },
                i.vertexAttrib2fv = function (t, e) { }, i.vertexAttrib3f = function (t, e, i, n) { },
                i.vertexAttrib3fv = function (t, e) { }, i.vertexAttrib4f = function (t, e, i, n, r) { },
                i.vertexAttrib4fv = function (t, e) { }, i.vertexAttribPointer = function (t, e, i, n, r, a) { },
                i.viewport = function (t, e, i, n) { }, i.configureBackBuffer = function (t, e, i, n, r) {
                    void 0 === n && (n = !0), void 0 === r && (r = !1);
                }, i.compressedTexImage2D = function (t) { }, i.createVertexArray = function () {
                    throw "not implemented";
                }, i.bindVertexArray = function (t) {
                    throw "not implemented";
                }, i.deleteVertexArray = function (t) {
                    throw "not implemented";
                }, i.isVertexArray = function (t) {
                    throw "not implemented";
                }, e._forceSupportVAOPlatform = function () {
                    return Ot.onMiniGame && Ot.onIOS || Ot.onBDMiniGame || Ot.onQGMiniGame;
                }, e.__init__ = function (i) {
                    if (laya.webgl.WebGLContext._checkExtensions(i), !Ct._isWebGL2 && !At.isConchApp) {
                        t._setupVertexArrayObject && (e._forceSupportVAOPlatform() ? t._forceSetupVertexArrayObject(i) : t._setupVertexArrayObject(i));
                        var n = (i.rawgl || i).getExtension("OES_vertex_array_object");
                        if (n) {
                            var r = i;
                            r.createVertexArray = function () {
                                return n.createVertexArrayOES();
                            }, r.bindVertexArray = function (t) {
                                n.bindVertexArrayOES(t);
                            }, r.deleteVertexArray = function (t) {
                                n.deleteVertexArrayOES(t);
                            }, r.isVertexArray = function (t) {
                                n.isVertexArrayOES(t);
                            };
                        }
                    }
                }, e._getExtension = function (t, i) {
                    var n = e._extentionVendorPrefixes;
                    for (var r in n) {
                        var a = t.getExtension(n[r] + i);
                        if (a) return a;
                    }
                    return null;
                }, e._checkExtensions = function (t) {
                    e._extTextureFilterAnisotropic = e._getExtension(t, "EXT_texture_filter_anisotropic"),
                        e._compressedTextureS3tc = e._getExtension(t, "WEBGL_compressed_texture_s3tc"),
                        e._compressedTexturePvrtc = e._getExtension(t, "WEBGL_compressed_texture_pvrtc"),
                        e._compressedTextureEtc1 = e._getExtension(t, "WEBGL_compressed_texture_etc1"),
                        e._forceSupportVAOPlatform() || (e._angleInstancedArrays = e._getExtension(t, "ANGLE_instanced_arrays"));
                }, e.__init_native = function () {
                    if (At.supportWebGLPlusRendering) {
                        var t = e;
                        t.activeTexture = t.activeTextureForNative, t.bindTexture = t.bindTextureForNative;
                    }
                }, e.useProgram = function (t, i) {
                    return e._useProgram !== i && (t.useProgram(i), e._useProgram = i, !0);
                }, e.setDepthTest = function (t, i) {
                    i !== e._depthTest && (e._depthTest = i, i ? t.enable(2929) : t.disable(2929));
                }, e.setDepthMask = function (t, i) {
                    i !== e._depthMask && (e._depthMask = i, t.depthMask(i));
                }, e.setDepthFunc = function (t, i) {
                    i !== e._depthFunc && (e._depthFunc = i, t.depthFunc(i));
                }, e.setBlend = function (t, i) {
                    i !== e._blend && (e._blend = i, i ? t.enable(3042) : t.disable(3042));
                }, e.setBlendFunc = function (t, i, n) {
                    (i !== e._sFactor || n !== e._dFactor) && (e._sFactor = e._srcAlpha = i, e._dFactor = e._dstAlpha = n,
                        t.blendFunc(i, n));
                }, e.setBlendFuncSeperate = function (t, i, n, r, a) {
                    i === e._sFactor && n === e._dFactor && r === e._srcAlpha && a === e._dstAlpha || (e._sFactor = i,
                        e._dFactor = n, e._srcAlpha = r, e._dstAlpha = a, t.blendFuncSeparate(i, n, r, a));
                }, e.setCullFace = function (t, i) {
                    i !== e._cullFace && (e._cullFace = i, i ? t.enable(2884) : t.disable(2884));
                }, e.setFrontFace = function (t, i) {
                    i !== e._frontFace && (e._frontFace = i, t.frontFace(i));
                }, e.activeTexture = function (t, i) {
                    e._activedTextureID !== i && (t.activeTexture(i), e._activedTextureID = i);
                }, e.bindTexture = function (t, i, n) {
                    e._activeTextures[e._activedTextureID - 33984] !== n && (t.bindTexture(i, n), e._activeTextures[e._activedTextureID - 33984] = n);
                }, e.useProgramForNative = function (t, e) {
                    return t.useProgram(e), !0;
                }, e.setDepthTestForNative = function (t, e) {
                    e ? t.enable(2929) : t.disable(2929);
                }, e.setDepthMaskForNative = function (t, e) {
                    t.depthMask(e);
                }, e.setDepthFuncForNative = function (t, e) {
                    t.depthFunc(e);
                }, e.setBlendForNative = function (t, e) {
                    e ? t.enable(3042) : t.disable(3042);
                }, e.setBlendFuncForNative = function (t, e, i) {
                    t.blendFunc(e, i);
                }, e.setCullFaceForNative = function (t, e) {
                    e ? t.enable(2884) : t.disable(2884);
                }, e.setFrontFaceForNative = function (t, e) {
                    t.frontFace(e);
                }, e.activeTextureForNative = function (t, e) {
                    t.activeTexture(e);
                }, e.bindTextureForNative = function (t, e, i) {
                    t.bindTexture(e, i);
                }, e.bindVertexArrayForNative = function (t, e) {
                    t.bindVertexArray(e);
                }, e.DEPTH_BUFFER_BIT = 256, e.STENCIL_BUFFER_BIT = 1024, e.COLOR_BUFFER_BIT = 16384,
                e.POINTS = 0, e.LINES = 1, e.LINE_LOOP = 2, e.LINE_STRIP = 3, e.TRIANGLES = 4, e.TRIANGLE_STRIP = 5,
                e.TRIANGLE_FAN = 6, e.ZERO = 0, e.ONE = 1, e.SRC_COLOR = 768, e.ONE_MINUS_SRC_COLOR = 769,
                e.SRC_ALPHA = 770, e.ONE_MINUS_SRC_ALPHA = 771, e.DST_ALPHA = 772, e.ONE_MINUS_DST_ALPHA = 773,
                e.DST_COLOR = 774, e.ONE_MINUS_DST_COLOR = 775, e.SRC_ALPHA_SATURATE = 776, e.FUNC_ADD = 32774,
                e.BLEND_EQUATION = 32777, e.BLEND_EQUATION_RGB = 32777, e.BLEND_EQUATION_ALPHA = 34877,
                e.FUNC_SUBTRACT = 32778, e.FUNC_REVERSE_SUBTRACT = 32779, e.BLEND_DST_RGB = 32968,
                e.BLEND_SRC_RGB = 32969, e.BLEND_DST_ALPHA = 32970, e.BLEND_SRC_ALPHA = 32971, e.CONSTANT_COLOR = 32769,
                e.ONE_MINUS_CONSTANT_COLOR = 32770, e.CONSTANT_ALPHA = 32771, e.ONE_MINUS_CONSTANT_ALPHA = 32772,
                e.BLEND_COLOR = 32773, e.ARRAY_BUFFER = 34962, e.ELEMENT_ARRAY_BUFFER = 34963, e.ARRAY_BUFFER_BINDING = 34964,
                e.ELEMENT_ARRAY_BUFFER_BINDING = 34965, e.STREAM_DRAW = 35040, e.STATIC_DRAW = 35044,
                e.DYNAMIC_DRAW = 35048, e.BUFFER_SIZE = 34660, e.BUFFER_USAGE = 34661, e.CURRENT_VERTEX_ATTRIB = 34342,
                e.FRONT = 1028, e.BACK = 1029, e.CULL_FACE = 2884, e.FRONT_AND_BACK = 1032, e.BLEND = 3042,
                e.DITHER = 3024, e.STENCIL_TEST = 2960, e.DEPTH_TEST = 2929, e.SCISSOR_TEST = 3089,
                e.POLYGON_OFFSET_FILL = 32823, e.SAMPLE_ALPHA_TO_COVERAGE = 32926, e.SAMPLE_COVERAGE = 32928,
                e.NO_ERROR = 0, e.INVALID_ENUM = 1280, e.INVALID_VALUE = 1281, e.INVALID_OPERATION = 1282,
                e.OUT_OF_MEMORY = 1285, e.CW = 2304, e.CCW = 2305, e.LINE_WIDTH = 2849, e.ALIASED_POINT_SIZE_RANGE = 33901,
                e.ALIASED_LINE_WIDTH_RANGE = 33902, e.CULL_FACE_MODE = 2885, e.FRONT_FACE = 2886,
                e.DEPTH_RANGE = 2928, e.DEPTH_WRITEMASK = 2930, e.DEPTH_CLEAR_VALUE = 2931, e.DEPTH_FUNC = 2932,
                e.STENCIL_CLEAR_VALUE = 2961, e.STENCIL_FUNC = 2962, e.STENCIL_FAIL = 2964, e.STENCIL_PASS_DEPTH_FAIL = 2965,
                e.STENCIL_PASS_DEPTH_PASS = 2966, e.STENCIL_REF = 2967, e.STENCIL_VALUE_MASK = 2963,
                e.STENCIL_WRITEMASK = 2968, e.STENCIL_BACK_FUNC = 34816, e.STENCIL_BACK_FAIL = 34817,
                e.STENCIL_BACK_PASS_DEPTH_FAIL = 34818, e.STENCIL_BACK_PASS_DEPTH_PASS = 34819,
                e.STENCIL_BACK_REF = 36003, e.STENCIL_BACK_VALUE_MASK = 36004, e.STENCIL_BACK_WRITEMASK = 36005,
                e.VIEWPORT = 2978, e.SCISSOR_BOX = 3088, e.COLOR_CLEAR_VALUE = 3106, e.COLOR_WRITEMASK = 3107,
                e.UNPACK_ALIGNMENT = 3317, e.PACK_ALIGNMENT = 3333, e.MAX_TEXTURE_SIZE = 3379, e.MAX_VIEWPORT_DIMS = 3386,
                e.SUBPIXEL_BITS = 3408, e.RED_BITS = 3410, e.GREEN_BITS = 3411, e.BLUE_BITS = 3412,
                e.ALPHA_BITS = 3413, e.DEPTH_BITS = 3414, e.STENCIL_BITS = 3415, e.POLYGON_OFFSET_UNITS = 10752,
                e.POLYGON_OFFSET_FACTOR = 32824, e.TEXTURE_BINDING_2D = 32873, e.SAMPLE_BUFFERS = 32936,
                e.SAMPLES = 32937, e.SAMPLE_COVERAGE_VALUE = 32938, e.SAMPLE_COVERAGE_INVERT = 32939,
                e.NUM_COMPRESSED_TEXTURE_FORMATS = 34466, e.COMPRESSED_TEXTURE_FORMATS = 34467,
                e.DONT_CARE = 4352, e.FASTEST = 4353, e.NICEST = 4354, e.GENERATE_MIPMAP_HINT = 33170,
                e.BYTE = 5120, e.UNSIGNED_BYTE = 5121, e.SHORT = 5122, e.UNSIGNED_SHORT = 5123,
                e.INT = 5124, e.UNSIGNED_INT = 5125, e.FLOAT = 5126, e.DEPTH_COMPONENT = 6402, e.ALPHA = 6406,
                e.RGB = 6407, e.RGBA = 6408, e.LUMINANCE = 6409, e.LUMINANCE_ALPHA = 6410, e.UNSIGNED_SHORT_4_4_4_4 = 32819,
                e.UNSIGNED_SHORT_5_5_5_1 = 32820, e.UNSIGNED_SHORT_5_6_5 = 33635, e.FRAGMENT_SHADER = 35632,
                e.VERTEX_SHADER = 35633, e.MAX_VERTEX_ATTRIBS = 34921, e.MAX_VERTEX_UNIFORM_VECTORS = 36347,
                e.MAX_VARYING_VECTORS = 36348, e.MAX_COMBINED_TEXTURE_IMAGE_UNITS = 35661, e.MAX_VERTEX_TEXTURE_IMAGE_UNITS = 35660,
                e.MAX_TEXTURE_IMAGE_UNITS = 34930, e.MAX_FRAGMENT_UNIFORM_VECTORS = 36349, e.SHADER_TYPE = 35663,
                e.DELETE_STATUS = 35712, e.LINK_STATUS = 35714, e.VALIDATE_STATUS = 35715, e.ATTACHED_SHADERS = 35717,
                e.ACTIVE_UNIFORMS = 35718, e.ACTIVE_ATTRIBUTES = 35721, e.SHADING_LANGUAGE_VERSION = 35724,
                e.CURRENT_PROGRAM = 35725, e.NEVER = 512, e.LESS = 513, e.EQUAL = 514, e.LEQUAL = 515,
                e.GREATER = 516, e.NOTEQUAL = 517, e.GEQUAL = 518, e.ALWAYS = 519, e.KEEP = 7680,
                e.REPLACE = 7681, e.INCR = 7682, e.DECR = 7683, e.INVERT = 5386, e.INCR_WRAP = 34055,
                e.DECR_WRAP = 34056, e.VENDOR = 7936, e.RENDERER = 7937, e.VERSION = 7938, e.NEAREST = 9728,
                e.LINEAR = 9729, e.NEAREST_MIPMAP_NEAREST = 9984, e.LINEAR_MIPMAP_NEAREST = 9985,
                e.NEAREST_MIPMAP_LINEAR = 9986, e.LINEAR_MIPMAP_LINEAR = 9987, e.TEXTURE_MAG_FILTER = 10240,
                e.TEXTURE_MIN_FILTER = 10241, e.TEXTURE_WRAP_S = 10242, e.TEXTURE_WRAP_T = 10243,
                e.TEXTURE_2D = 3553, e.TEXTURE_3D = 32879, e.TEXTURE = 5890, e.TEXTURE_CUBE_MAP = 34067,
                e.TEXTURE_BINDING_CUBE_MAP = 34068, e.TEXTURE_CUBE_MAP_POSITIVE_X = 34069, e.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070,
                e.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071, e.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072, e.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073,
                e.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074, e.MAX_CUBE_MAP_TEXTURE_SIZE = 34076, e.TEXTURE0 = 33984,
                e.TEXTURE1 = 33985, e.TEXTURE2 = 33986, e.TEXTURE3 = 33987, e.TEXTURE4 = 33988,
                e.TEXTURE5 = 33989, e.TEXTURE6 = 33990, e.TEXTURE7 = 33991, e.TEXTURE8 = 33992,
                e.TEXTURE9 = 33993, e.TEXTURE10 = 33994, e.TEXTURE11 = 33995, e.TEXTURE12 = 33996,
                e.TEXTURE13 = 33997, e.TEXTURE14 = 33998, e.TEXTURE15 = 33999, e.TEXTURE16 = 34e3,
                e.TEXTURE17 = 34001, e.TEXTURE18 = 34002, e.TEXTURE19 = 34003, e.TEXTURE20 = 34004,
                e.TEXTURE21 = 34005, e.TEXTURE22 = 34006, e.TEXTURE23 = 34007, e.TEXTURE24 = 34008,
                e.TEXTURE25 = 34009, e.TEXTURE26 = 34010, e.TEXTURE27 = 34011, e.TEXTURE28 = 34012,
                e.TEXTURE29 = 34013, e.TEXTURE30 = 34014, e.TEXTURE31 = 34015, e.ACTIVE_TEXTURE = 34016,
                e.REPEAT = 10497, e.CLAMP_TO_EDGE = 33071, e.MIRRORED_REPEAT = 33648, e.FLOAT_VEC2 = 35664,
                e.FLOAT_VEC3 = 35665, e.FLOAT_VEC4 = 35666, e.INT_VEC2 = 35667, e.INT_VEC3 = 35668,
                e.INT_VEC4 = 35669, e.BOOL = 35670, e.BOOL_VEC2 = 35671, e.BOOL_VEC3 = 35672, e.BOOL_VEC4 = 35673,
                e.FLOAT_MAT2 = 35674, e.FLOAT_MAT3 = 35675, e.FLOAT_MAT4 = 35676, e.SAMPLER_2D = 35678,
                e.SAMPLER_CUBE = 35680, e.VERTEX_ATTRIB_ARRAY_ENABLED = 34338, e.VERTEX_ATTRIB_ARRAY_SIZE = 34339,
                e.VERTEX_ATTRIB_ARRAY_STRIDE = 34340, e.VERTEX_ATTRIB_ARRAY_TYPE = 34341, e.VERTEX_ATTRIB_ARRAY_NORMALIZED = 34922,
                e.VERTEX_ATTRIB_ARRAY_POINTER = 34373, e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING = 34975,
                e.COMPILE_STATUS = 35713, e.LOW_FLOAT = 36336, e.MEDIUM_FLOAT = 36337, e.HIGH_FLOAT = 36338,
                e.LOW_INT = 36339, e.MEDIUM_INT = 36340, e.HIGH_INT = 36341, e.FRAMEBUFFER = 36160,
                e.RENDERBUFFER = 36161, e.RGBA4 = 32854, e.RGB5_A1 = 32855, e.RGB565 = 36194, e.DEPTH_COMPONENT16 = 33189,
                e.STENCIL_INDEX = 6401, e.STENCIL_INDEX8 = 36168, e.DEPTH_STENCIL = 34041, e.RENDERBUFFER_WIDTH = 36162,
                e.RENDERBUFFER_HEIGHT = 36163, e.RENDERBUFFER_INTERNAL_FORMAT = 36164, e.RENDERBUFFER_RED_SIZE = 36176,
                e.RENDERBUFFER_GREEN_SIZE = 36177, e.RENDERBUFFER_BLUE_SIZE = 36178, e.RENDERBUFFER_ALPHA_SIZE = 36179,
                e.RENDERBUFFER_DEPTH_SIZE = 36180, e.RENDERBUFFER_STENCIL_SIZE = 36181, e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE = 36048,
                e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME = 36049, e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL = 36050,
                e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE = 36051, e.COLOR_ATTACHMENT0 = 36064,
                e.DEPTH_ATTACHMENT = 36096, e.STENCIL_ATTACHMENT = 36128, e.DEPTH_STENCIL_ATTACHMENT = 33306,
                e.NONE = 0, e.FRAMEBUFFER_COMPLETE = 36053, e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT = 36054,
                e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT = 36055, e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS = 36057,
                e.FRAMEBUFFER_UNSUPPORTED = 36061, e.FRAMEBUFFER_BINDING = 36006, e.RENDERBUFFER_BINDING = 36007,
                e.MAX_RENDERBUFFER_SIZE = 34024, e.INVALID_FRAMEBUFFER_OPERATION = 1286, e.UNPACK_FLIP_Y_WEBGL = 37440,
                e.UNPACK_PREMULTIPLY_ALPHA_WEBGL = 37441, e.CONTEXT_LOST_WEBGL = 37442, e.UNPACK_COLORSPACE_CONVERSION_WEBGL = 37443,
                e.BROWSER_DEFAULT_WEBGL = 37444, e._extTextureFilterAnisotropic = null, e._compressedTextureS3tc = null,
                e._compressedTexturePvrtc = null, e._compressedTextureEtc1 = null, e._angleInstancedArrays = null,
                e._glTextureIDs = [33984, 33985, 33986, 33987, 33988, 33989, 33990, 33991], e._useProgram = null,
                e._depthTest = !0, e._depthMask = !0, e._blend = !1, e._cullFace = !1, e._activedTextureID = 33984,
                n(e, ["_extentionVendorPrefixes", function () {
                    return this._extentionVendorPrefixes = ["", "WEBKIT_", "MOZ_"];
                }, "_activeTextures", function () {
                    return this._activeTextures = new Array(8);
                }, "_depthFunc", function () {
                    return this._depthFunc = 513;
                }, "_sFactor", function () {
                    return this._sFactor = 1;
                }, "_dFactor", function () {
                    return this._dFactor = 0;
                }, "_srcAlpha", function () {
                    return this._srcAlpha = 1;
                }, "_dstAlpha", function () {
                    return this._dstAlpha = 0;
                }, "_frontFace", function () {
                    return this._frontFace = 2305;
                }]), e;
        }(), rt = (function () {
            function t() { }
            r(t, "laya.net.ResourceVersion"), t.enable = function (e, n, r) {
                void 0 === r && (r = 2), laya.net.ResourceVersion.type = r, i.loader.load(e, g.create(null, t.onManifestLoaded, [n]), null, "json"),
                    Z.customFormat = t.addVersionPrefix;
            }, t.onManifestLoaded = function (e, i) {
                t.manifest = i, e.run(), i || console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");
            }, t.addVersionPrefix = function (e) {
                return e = Z.getAdptedFilePath(e), t.manifest && t.manifest[e] ? 2 == t.type ? t.manifest[e] : t.manifest[e] + "/" + e : e;
            }, t.FOLDER_VERSION = 1, t.FILENAME_VERSION = 2, t.manifest = null, t.type = 1;
        }(), function () {
            function t() { }
            r(t, "laya.display.cmd.FillWordsCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.words = null, V.recover("FillWordsCmd", this);
            }, e.run = function (t, e, i) {
                t.fillWords(this.words, this.x + e, this.y + i, this.font, this.color);
            }, a(0, e, "cmdID", function () {
                return "FillWords";
            }), t.create = function (e, i, n, r, a) {
                var s = V.getItemByClass("FillWordsCmd", t);
                return s.words = e, s.x = i, s.y = n, s.font = r, s.color = a, s;
            }, t.ID = "FillWords", t;
        }()), at = function () {
            function t(e, i, n, r, a, s, o) {
                if (this._bTransform = !1, void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0),
                    void 0 === r && (r = 1), void 0 === a && (a = 0), void 0 === s && (s = 0), void 0 === o && (o = 0),
                    null != t._createFun) return t._createFun(e, i, n, r, a, s, o);
                this.a = e, this.b = i, this.c = n, this.d = r, this.tx = a, this.ty = s, this._checkTransform();
            }
            r(t, "laya.maths.Matrix");
            var e = t.prototype;
            return e.identity = function () {
                return this.a = this.d = 1, this.b = this.tx = this.ty = this.c = 0, this._bTransform = !1,
                    this;
            }, e._checkTransform = function () {
                return this._bTransform = 1 !== this.a || 0 !== this.b || 0 !== this.c || 1 !== this.d;
            }, e.setTranslate = function (t, e) {
                return this.tx = t, this.ty = e, this;
            }, e.translate = function (t, e) {
                return this.tx += t, this.ty += e, this;
            }, e.scale = function (t, e) {
                return this.a *= t, this.d *= e, this.c *= t, this.b *= e, this.tx *= t, this.ty *= e,
                    this._bTransform = !0, this;
            }, e.rotate = function (t) {
                var e = Math.cos(t), i = Math.sin(t), n = this.a, r = this.c, a = this.tx;
                return this.a = n * e - this.b * i, this.b = n * i + this.b * e, this.c = r * e - this.d * i,
                    this.d = r * i + this.d * e, this.tx = a * e - this.ty * i, this.ty = a * i + this.ty * e,
                    this._bTransform = !0, this;
            }, e.skew = function (t, e) {
                var i = Math.tan(t), n = Math.tan(e), r = this.a, a = this.b;
                return this.a += n * this.c, this.b += n * this.d, this.c += i * r, this.d += i * a,
                    this;
            }, e.invertTransformPoint = function (t) {
                var e = this.a, i = this.b, n = this.c, r = this.d, a = this.tx, s = e * r - i * n, o = r / s, l = -i / s, h = -n / s, u = e / s, c = (n * this.ty - r * a) / s, d = -(e * this.ty - i * a) / s;
                return t.setTo(o * t.x + h * t.y + c, l * t.x + u * t.y + d);
            }, e.transformPoint = function (t) {
                return t.setTo(this.a * t.x + this.c * t.y + this.tx, this.b * t.x + this.d * t.y + this.ty);
            }, e.transformPointN = function (t) {
                return t.setTo(this.a * t.x + this.c * t.y, this.b * t.x + this.d * t.y);
            }, e.getScaleX = function () {
                return 0 === this.b ? this.a : Math.sqrt(this.a * this.a + this.b * this.b);
            }, e.getScaleY = function () {
                return 0 === this.c ? this.d : Math.sqrt(this.c * this.c + this.d * this.d);
            }, e.invert = function () {
                var t = this.a, e = this.b, i = this.c, n = this.d, r = this.tx, a = t * n - e * i;
                return this.a = n / a, this.b = -e / a, this.c = -i / a, this.d = t / a, this.tx = (i * this.ty - n * r) / a,
                    this.ty = -(t * this.ty - e * r) / a, this;
            }, e.setTo = function (t, e, i, n, r, a) {
                return this.a = t, this.b = e, this.c = i, this.d = n, this.tx = r, this.ty = a,
                    this;
            }, e.concat = function (t) {
                var e = this.a, i = this.c, n = this.tx;
                return this.a = e * t.a + this.b * t.c, this.b = e * t.b + this.b * t.d, this.c = i * t.a + this.d * t.c,
                    this.d = i * t.b + this.d * t.d, this.tx = n * t.a + this.ty * t.c + t.tx, this.ty = n * t.b + this.ty * t.d + t.ty,
                    this;
            }, e.scaleEx = function (t, e) {
                var i = this.a, n = this.b, r = this.c, a = this.d;
                0 !== n || 0 !== r ? (this.a = t * i, this.b = t * n, this.c = e * r, this.d = e * a) : (this.a = t * i,
                    this.b = 0 * a, this.c = 0 * i, this.d = e * a), this._bTransform = !0;
            }, e.rotateEx = function (t) {
                var e = Math.cos(t), i = Math.sin(t), n = this.a, r = this.b, a = this.c, s = this.d;
                0 !== r || 0 !== a ? (this.a = e * n + i * a, this.b = e * r + i * s, this.c = -i * n + e * a,
                    this.d = -i * r + e * s) : (this.a = e * n, this.b = i * s, this.c = -i * n, this.d = e * s),
                    this._bTransform = !0;
            }, e.clone = function () {
                var e = t.create();
                return e.a = this.a, e.b = this.b, e.c = this.c, e.d = this.d, e.tx = this.tx, e.ty = this.ty,
                    e._bTransform = this._bTransform, e;
            }, e.copyTo = function (t) {
                return t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty,
                    t._bTransform = this._bTransform, t;
            }, e.toString = function () {
                return this.a + "," + this.b + "," + this.c + "," + this.d + "," + this.tx + "," + this.ty;
            }, e.destroy = function () {
                this.recover();
            }, e.recover = function () {
                V.recover("Matrix", this.identity());
            }, t.mul = function (t, e, i) {
                var n = t.a, r = t.b, a = t.c, s = t.d, o = t.tx, l = t.ty, h = e.a, u = e.b, c = e.c, d = e.d, _ = e.tx, f = e.ty;
                return 0 !== u || 0 !== c ? (i.a = n * h + r * c, i.b = n * u + r * d, i.c = a * h + s * c,
                    i.d = a * u + s * d, i.tx = h * o + c * l + _, i.ty = u * o + d * l + f) : (i.a = n * h,
                        i.b = r * d, i.c = a * h, i.d = s * d, i.tx = h * o + _, i.ty = d * l + f), i;
            }, t.mul16 = function (t, e, i) {
                var n = t.a, r = t.b, a = t.c, s = t.d, o = t.tx, l = t.ty, h = e.a, u = e.b, c = e.c, d = e.d, _ = e.tx, f = e.ty;
                return 0 !== u || 0 !== c ? (i[0] = n * h + r * c, i[1] = n * u + r * d, i[4] = a * h + s * c,
                    i[5] = a * u + s * d, i[12] = h * o + c * l + _, i[13] = u * o + d * l + f) : (i[0] = n * h,
                        i[1] = r * d, i[4] = a * h, i[5] = s * d, i[12] = h * o + _, i[13] = d * l + f),
                    i;
            }, t.create = function () {
                return V.getItemByClass("Matrix", t);
            }, t.EMPTY = new t(), t.TEMP = new t(), t._createFun = null, t;
        }(), st = function () {
            function t(t, e, i, n) {
                this.id = 0, this.name = null, this.color = 0, this.scale = 1, this.datapos = 0,
                    this.datas = new Array(oi.DATANUM), this.id = t, this.color = e, this.name = i,
                    this.scale = n;
            }
            return r(t, "laya.utils.PerfData"), t.prototype.addData = function (t) {
                this.datas[this.datapos] = t, this.datapos++, this.datapos %= oi.DATANUM;
            }, t;
        }(), ot = function () {
            function t() { }
            r(t, "laya.display.cmd.TransformCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.matrix = null, V.recover("TransformCmd", this);
            }, e.run = function (t, e, i) {
                t._transform(this.matrix, this.pivotX + e, this.pivotY + i);
            }, a(0, e, "cmdID", function () {
                return "Transform";
            }), t.create = function (e, i, n) {
                var r = V.getItemByClass("TransformCmd", t);
                return r.matrix = e, r.pivotX = i, r.pivotY = n, r;
            }, t.ID = "Transform", t;
        }(), lt = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawTexturesCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.texture._removeReference(), this.texture = null, this.pos = null, V.recover("DrawTexturesCmd", this);
            }, e.run = function (t, e, i) {
                t.drawTextures(this.texture, this.pos, e, i);
            }, a(0, e, "cmdID", function () {
                return "DrawTextures";
            }), t.create = function (e, i) {
                var n = V.getItemByClass("DrawTexturesCmd", t);
                return n.texture = e, e._addReference(), n.pos = i, n;
            }, t.ID = "DrawTextures", t;
        }(), ht = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawCircleCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.fillColor = null, this.lineColor = null, V.recover("DrawCircleCmd", this);
            }, e.run = function (t, e, i) {
                t._drawCircle(this.x + e, this.y + i, this.radius, this.fillColor, this.lineColor, this.lineWidth, this.vid);
            }, a(0, e, "cmdID", function () {
                return "DrawCircle";
            }), t.create = function (e, i, n, r, a, s, o) {
                var l = V.getItemByClass("DrawCircleCmd", t);
                return l.x = e, l.y = i, l.radius = n, l.fillColor = r, l.lineColor = a, l.lineWidth = s,
                    l.vid = o, l;
            }, t.ID = "DrawCircle", t;
        }(), ut = function () {
            var t;
            function e() {
                if (this._drawTriUseAbsMatrix = !1, this._id = ++e._COUNT, this._other = null, this._renderNextSubmitIndex = 0,
                    this._path = null, this._drawCount = 1, this._renderCount = 0, this._isConvexCmd = !0,
                    this._submits = null, this._curSubmit = null, this._mesh = null, this._pathMesh = null,
                    this._triangleMesh = null, this.meshlist = [], this._clipInCache = !1, this._clipInfoID = 0,
                    this._curMat = null, this._lastMatScaleX = 1, this._lastMatScaleY = 1, this._lastMat_a = 1,
                    this._lastMat_b = 0, this._lastMat_c = 0, this._lastMat_d = 1, this._nBlendType = 0,
                    this._save = null, this._targets = null, this._charSubmitCache = null, this._saveMark = null,
                    this.sprite = null, this._italicDeg = 0, this._lastTex = null, this._fillColor = 0,
                    this._flushCnt = 0, this.defTexture = null, this._colorFiler = null, this.drawTexAlign = !1,
                    this._incache = !1, this.isMain = !1, this._tmpMatrix = new at(), this._drawTexToDrawTri_Vert = new Float32Array(8),
                    this._drawTexToDrawTri_Index = new Uint16Array([0, 1, 2, 0, 2, 3]), this._tempUV = new Float32Array(8),
                    this._width = 99999999, this._height = 99999999, this._submitKey = new k(), this._transedPoints = new Array(8),
                    this._temp4Points = new Array(8), this._clipRect = e.MAXCLIPRECT, this._globalClipMatrix = new at(99999999, 0, 0, 99999999, 0, 0),
                    this._shader2D = new N(), e._contextcount++, !this.defTexture) {
                    var t = new di(2, 2);
                    t.setPixels(new Uint8Array(16)), t.lock = !0, this.defTexture = new Me(t);
                }
                this._lastTex = this.defTexture, this.clear();
            }
            r(e, "laya.resource.Context");
            var s = e.prototype;
            return s.drawImage = function (t) { }, s.getImageData = function (t) { }, s.measureText = function (t) {
                return null;
            }, s.setTransform = function (t) { }, s.$transform = function (t, e, i, n, r, a) { },
                s.clearRect = function (t, e, i, n) { }, s._drawRect = function (t, e, i, n, r) {
                    b.renderBatches++, r && (this.fillStyle = r), this.fillRect(t, e, i, n);
                }, s.drawTexture2 = function (t, e, i, n, r, a) { }, s.transformByMatrix = function (t, e, i) {
                    this.transform(t.a, t.b, t.c, t.d, t.tx + e, t.ty + i);
                }, s.saveTransform = function (t) {
                    this.save();
                }, s.restoreTransform = function (t) {
                    this.restore();
                }, s.drawRect = function (t, e, i, n, r, a, s) {
                    null != r && (this.fillStyle = r, this.fillRect(t, e, i, n)), null != a && (this.strokeStyle = a,
                        this.lineWidth = s, this.strokeRect(t, e, i, n));
                }, s.alpha = function (t) {
                    this.globalAlpha *= t;
                }, s._transform = function (t, e, i) {
                    this.translate(e, i), this.transform(t.a, t.b, t.c, t.d, t.tx, t.ty), this.translate(-e, -i);
                }, s._rotate = function (t, e, i) {
                    this.translate(e, i), this.rotate(t), this.translate(-e, -i);
                }, s._scale = function (t, e, i, n) {
                    this.translate(i, n), this.scale(t, e), this.translate(-i, -n);
                }, s._drawLine = function (t, e, i, n, r, a, s, o, l) {
                    this.beginPath(), this.strokeStyle = s, this.lineWidth = o, this.moveTo(t + i, e + n),
                        this.lineTo(t + r, e + a), this.stroke();
                }, s._drawLines = function (t, e, i, n, r, a) {
                    this.beginPath(), this.strokeStyle = n, this.lineWidth = r;
                    i.length;
                    this.addPath(i.slice(), !1, !1, t, e), this.stroke();
                }, s.drawCurves = function (t, e, i, n, r) {
                    this.beginPath(), this.strokeStyle = n, this.lineWidth = r, this.moveTo(t + i[0], e + i[1]);
                    for (var a = 2, s = i.length; a < s;) this.quadraticCurveTo(t + i[a++], e + i[a++], t + i[a++], e + i[a++]);
                    this.stroke();
                }, s._fillAndStroke = function (t, e, i, n) {
                    void 0 === n && (n = !1), null != t && (this.fillStyle = t, this.fill()), null != e && i > 0 && (this.strokeStyle = e,
                        this.lineWidth = i, this.stroke());
                }, s._drawCircle = function (t, i, n, r, a, s, o) {
                    b.renderBatches++, this.beginPath(!0), this.arc(t, i, n, 0, e.PI2), this.closePath(),
                        this._fillAndStroke(r, a, s);
                }, s._drawPie = function (t, e, i, n, r, a, s, o, l) {
                    this.beginPath(), this.moveTo(t, e), this.arc(t, e, i, n, r), this.closePath(),
                        this._fillAndStroke(a, s, o);
                }, s._drawPoly = function (t, e, i, n, r, a, s, o) {
                    i.length;
                    this.beginPath(), this.addPath(i.slice(), !0, s, t, e), this.closePath(), this._fillAndStroke(n, r, a, s);
                }, s._drawPath = function (t, e, i, n, r) {
                    this.beginPath();
                    for (var a = 0, s = i.length; a < s; a++) {
                        var o = i[a];
                        switch (o[0]) {
                            case "moveTo":
                                this.moveTo(t + o[1], e + o[2]);
                                break;

                            case "lineTo":
                                this.lineTo(t + o[1], e + o[2]);
                                break;

                            case "arcTo":
                                this.arcTo(t + o[1], e + o[2], t + o[3], e + o[4], o[5]);
                                break;

                            case "closePath":
                                this.closePath();
                        }
                    }
                    null != n && (this.fillStyle = n.fillStyle, this.fill()), null != r && (this.strokeStyle = r.strokeStyle,
                        this.lineWidth = r.lineWidth || 1, this.lineJoin = r.lineJoin, this.lineCap = r.lineCap,
                        this.miterLimit = r.miterLimit, this.stroke());
                }, s.clearBG = function (t, e, i, n) {
                    var r = Ct.mainContext;
                    r.clearColor(t, e, i, n), r.clear(16384);
                }, s._getSubmits = function () {
                    return this._submits;
                }, s._releaseMem = function (t) {
                    if (void 0 === t && (t = !1), this._submits) {
                        this._curMat.destroy(), this._curMat = null, this._shader2D.destroy(), this._shader2D = null,
                            this._charSubmitCache.clear();
                        for (var e = 0, i = this._submits._length; e < i; e++) this._submits[e].releaseRender();
                        this._submits.length = 0, this._submits._length = 0, this._submits = null, this._curSubmit = null,
                            this._path = null, this._save = null;
                        var n;
                        for (e = 0, n = this.meshlist.length; e < n; e++) {
                            this.meshlist[e].destroy();
                        }
                        this.meshlist.length = 0, this.sprite = null, t || (this._targets && this._targets.destroy(),
                            this._targets = null);
                    }
                }, s.destroy = function (t) {
                    void 0 === t && (t = !1), --e._contextcount, this.sprite = null, this._releaseMem(t),
                        this._charSubmitCache.destroy(), this._mesh.destroy(), t || (this._targets && this._targets.destroy(),
                            this._targets = null);
                }, s.clear = function () {
                    this._submits || (this._other = t.DEFAULT, this._curMat = at.create(), this._charSubmitCache = new re(),
                        this._mesh = Pe.getAMesh(this.isMain), this.meshlist.push(this._mesh), this._pathMesh = we.getAMesh(this.isMain),
                        this.meshlist.push(this._pathMesh), this._triangleMesh = ke.getAMesh(this.isMain),
                        this.meshlist.push(this._triangleMesh), this._submits = [], this._save = [W.Create(this)],
                        this._save.length = 10, this._shader2D = new N()), this._submitKey.clear(), this._mesh.clearVB(),
                        this._renderCount++, this._drawCount = 1, this._other = t.DEFAULT, this._other.lineWidth = this._shader2D.ALPHA = 1,
                        this._nBlendType = 0, this._clipRect = e.MAXCLIPRECT, this._curSubmit = h.RENDERBASE,
                        h.RENDERBASE._ref = 16777215, h.RENDERBASE._numEle = 0, this._shader2D.fillStyle = this._shader2D.strokeStyle = It.DEFAULT;
                    for (var i = 0, n = this._submits._length; i < n; i++) this._submits[i].releaseRender();
                    this._submits._length = 0, this._curMat.identity(), this._other.clear(), this._saveMark = this._save[0],
                        this._save._length = 1;
                }, s.size = function (t, e) {
                    this._width == t && this._height == e || (this._width = t, this._height = e, this._targets && (this._targets.destroy(),
                        this._targets = new _i(t, e, 1, -1)), At._context == this && (Ct.mainContext.viewport(0, 0, t, e),
                            ft.width = t, ft.height = e)), 0 === t && 0 === e && this._releaseMem();
                }, s.getMatScaleX = function () {
                    return this._lastMat_a == this._curMat.a && this._lastMat_b == this._curMat.b || (this._lastMatScaleX = this._curMat.getScaleX(),
                        this._lastMat_a = this._curMat.a, this._lastMat_b = this._curMat.b), this._lastMatScaleX;
                }, s.getMatScaleY = function () {
                    return this._lastMat_c == this._curMat.c && this._lastMat_d == this._curMat.d || (this._lastMatScaleY = this._curMat.getScaleY(),
                        this._lastMat_c = this._curMat.c, this._lastMat_d = this._curMat.d), this._lastMatScaleY;
                }, s.setFillColor = function (t) {
                    this._fillColor = t;
                }, s.getFillColor = function () {
                    return this._fillColor;
                }, s.translate = function (t, e) {
                    0 === t && 0 === e || (et.save(this), this._curMat._bTransform ? (Lt.save(this),
                        this._curMat.tx += t * this._curMat.a + e * this._curMat.c, this._curMat.ty += t * this._curMat.b + e * this._curMat.d) : (this._curMat.tx = t,
                            this._curMat.ty = e));
                }, s.save = function () {
                    this._save[this._save._length++] = W.Create(this);
                }, s.restore = function () {
                    var t = this._save._length, e = this._nBlendType;
                    if (!(t < 1)) {
                        for (var i = t - 1; i >= 0; i--) {
                            var n = this._save[i];
                            if (n.restore(this), n.isSaveMark()) return void (this._save._length = i);
                        }
                        e != this._nBlendType && (this._curSubmit = h.RENDERBASE);
                    }
                }, s.fillText = function (t, e, i, n, r, a) {
                    this._fillText(t, null, e, i, n, r, null, 0, null);
                }, s._fillText = function (t, i, n, r, a, s, o, l, h, u) {
                    void 0 === u && (u = 0), t ? e._textRender.filltext(this, t, n, r, a, s, o, l, h, u) : i && e._textRender.fillWords(this, i, n, r, a, s, o, l);
                }, s._fast_filltext = function (t, i, n, r, a, s, o, l, h) {
                    void 0 === h && (h = 0), e._textRender._fast_filltext(this, t, null, i, n, r, a, s, o, l, h);
                }, s.fillWords = function (t, e, i, n, r) {
                    this._fillText(null, t, e, i, n, r, null, -1, null, 0);
                }, s.fillBorderWords = function (t, e, i, n, r, a, s) {
                    this._fillBorderText(null, t, e, i, n, r, a, s, null);
                }, s.drawText = function (t, e, i, n, r, a) {
                    this._fillText(t, null, e, i, n, o.create(r).strColor, null, -1, a);
                }, s.strokeWord = function (t, e, i, n, r, a, s) {
                    this._fillText(t, null, e, i, n, null, o.create(r).strColor, a || 1, s);
                }, s.fillBorderText = function (t, e, i, n, r, a, s, l) {
                    this._fillBorderText(t, null, e, i, n, o.create(r).strColor, o.create(a).strColor, s, l);
                }, s._fillBorderText = function (t, e, i, n, r, a, s, o, l) {
                    this._fillText(t, e, i, n, r, a, s, o || 1, l);
                }, s._fillRect = function (t, e, i, n, r) {
                    var a = this._curSubmit, s = a && 2 === a._key.submitType && a._key.blendShader === this._nBlendType;
                    this._mesh.vertNum + 4 > 65535 && (this._mesh = Pe.getAMesh(this.isMain), this.meshlist.push(this._mesh),
                        s = !1), s && (s = s && this.isSameClipInfo(a)), this.transformQuad(t, e, i, n, 0, this._curMat, this._transedPoints),
                        this.clipedOff(this._transedPoints) || (this._mesh.addQuad(this._transedPoints, Me.NO_UV, r, !1),
                            s || (a = this._curSubmit = Se.create(this, this._mesh, H.create(1, 0)), this._submits[this._submits._length++] = a,
                                this._copyClipInfo(a, this._globalClipMatrix), a.shaderValue.textureHost = this._lastTex,
                                a._key.other = this._lastTex && this._lastTex.bitmap ? this._lastTex.bitmap.id : -1,
                                a._renderType = 10016), this._curSubmit._numEle += 6, this._mesh.indexNum += 6,
                            this._mesh.vertNum += 4);
                }, s.fillRect = function (t, e, i, n, r) {
                    var a = r ? It.create(r) : this._shader2D.fillStyle, s = this.mixRGBandAlpha(a.toInt());
                    this._fillRect(t, e, i, n, s);
                }, s.fillTexture = function (t, e, n, r, a, s, o, l) {
                    t._getSource() ? this._fillTexture(t, t.width, t.height, t.uvrect, e, n, r, a, s, o.x, o.y) : this.sprite && i.systemTimer.callLater(this, this._repaintSprite);
                }, s._fillTexture = function (t, e, i, n, r, a, s, o, l, h, u) {
                    var c = this._curSubmit;
                    this._mesh.vertNum + 4 > 65535 && (this._mesh = Pe.getAMesh(this.isMain), this.meshlist.push(this._mesh));
                    var d = !0, _ = !0;
                    switch (l) {
                        case "repeat":
                            break;

                        case "repeat-x":
                            _ = !1;
                            break;

                        case "repeat-y":
                            d = !1;
                            break;

                        case "no-repeat":
                            d = _ = !1;
                    }
                    var f = this._temp4Points, p = 0, m = 0, g = 0, y = 0, v = 0, S = 0;
                    if (h < 0 ? (g = r, p = -h % e / e) : g = r + h, u < 0 ? (y = a, m = -u % i / i) : y = a + u,
                        v = r + s, S = a + o, !d && (v = Math.min(v, r + h + e)), !_ && (S = Math.min(S, a + u + i)),
                        !(v < r || S < a || g > v || y > S)) {
                        var T = (v - r - h) / e, E = (S - a - u) / i;
                        if (this.transformQuad(g, y, v - g, S - y, 0, this._curMat, this._transedPoints),
                            f[0] = p, f[1] = m, f[2] = T, f[3] = m, f[4] = T, f[5] = E, f[6] = p, f[7] = E,
                            !this.clipedOff(this._transedPoints)) {
                            var C = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA);
                            this._mesh.addQuad(this._transedPoints, f, C, !0);
                            var x = H.create(1, 0);
                            x.defines.add(256), x.u_TexRange = n, c = this._curSubmit = Se.create(this, this._mesh, x),
                                this._submits[this._submits._length++] = c, this._copyClipInfo(c, this._globalClipMatrix),
                                c.shaderValue.textureHost = t, c._renderType = 10016, this._curSubmit._numEle += 6,
                                this._mesh.indexNum += 6, this._mesh.vertNum += 4;
                        }
                        this.breakNextMerge();
                    }
                }, s.setColorFilter = function (t) {
                    l.save(this, 8388608, this, !0), this._colorFiler = t, this._curSubmit = h.RENDERBASE;
                }, s.drawTexture = function (t, e, i, n, r) {
                    this._drawTextureM(t, e, i, n, r, null, 1, null);
                }, s.drawTextures = function (t, e, n, r) {
                    if (t._getSource()) for (var a = e.length / 2, s = 0, o = t.bitmap.id, l = 0; l < a; l++) this._inner_drawTexture(t, o, e[s++] + n, e[s++] + r, 0, 0, null, null, 1, !1); else this.sprite && i.systemTimer.callLater(this, this._repaintSprite);
                }, s._drawTextureAddSubmit = function (t, e) {
                    var i = null;
                    i = Se.create(this, this._mesh, H.create(1, 0)), this._submits[this._submits._length++] = i,
                        i.shaderValue.textureHost = e, i._key.other = t, i._renderType = 10016, this._curSubmit = i;
                }, s._drawTextureM = function (t, e, i, n, r, a, s, o) {
                    var l = this.sprite;
                    return !!t._getSource(function () {
                        l && l.repaint();
                    }) && this._inner_drawTexture(t, t.bitmap.id, e, i, n, r, a, o, s, !1);
                }, s._drawRenderTexture = function (t, e, i, n, r, a, s, o) {
                    return this._inner_drawTexture(t, -1, e, i, n, r, a, o, 1, !1);
                }, s.submitDebugger = function () {
                    this._submits[this._submits._length++] = K.create([], function () { }, this);
                }, s._copyClipInfo = function (t, e) {
                    var i = t.shaderValue.clipMatDir;
                    i[0] = e.a, i[1] = e.b, i[2] = e.c, i[3] = e.d;
                    var n = t.shaderValue.clipMatPos;
                    n[0] = e.tx, n[1] = e.ty, t.clipInfoID = this._clipInfoID, this._clipInCache && (t.shaderValue.clipOff[0] = 1);
                }, s.isSameClipInfo = function (t) {
                    return t.clipInfoID === this._clipInfoID;
                }, s._useNewTex2DSubmit = function (t, e) {
                    this._mesh.vertNum + e > 65535 && (this._mesh = Pe.getAMesh(this.isMain), this.meshlist.push(this._mesh));
                    var i = Se.create(this, this._mesh, H.create(1, 0));
                    this._submits[this._submits._length++] = this._curSubmit = i, i.shaderValue.textureHost = t,
                        this._copyClipInfo(i, this._globalClipMatrix);
                }, s._drawTexRect = function (t, e, i, n, r) {
                    this.transformQuad(t, e, i, n, this._italicDeg, this._curMat, this._transedPoints);
                    var a = this._transedPoints;
                    a[0] = a[0] + .5 | 0, a[1] = a[1] + .5 | 0, a[2] = a[2] + .5 | 0, a[3] = a[3] + .5 | 0,
                        a[4] = a[4] + .5 | 0, a[5] = a[5] + .5 | 0, a[6] = a[6] + .5 | 0, a[7] = a[7] + .5 | 0,
                        this.clipedOff(this._transedPoints) || (this._mesh.addQuad(this._transedPoints, r, this._fillColor, !0),
                            this._curSubmit._numEle += 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4);
                }, s.drawCallOptimize = function (t) {
                    return this._charSubmitCache.enable(t, this), t;
                }, s._inner_drawTexture = function (t, e, i, n, r, a, s, o, l, h) {
                    var u = this._curSubmit._key;
                    if (o = o || t._uv, 4 === u.submitType && u.other === e) {
                        var c = this._drawTexToDrawTri_Vert;
                        c[0] = i, c[1] = n, c[2] = i + r, c[3] = n, c[4] = i + r, c[5] = n + a, c[6] = i,
                            c[7] = n + a, this._drawTriUseAbsMatrix = !0;
                        var d = this._tempUV;
                        return d[0] = o[0], d[1] = o[1], d[2] = o[2], d[3] = o[3], d[4] = o[4], d[5] = o[5],
                            d[6] = o[6], d[7] = o[7], this.drawTriangles(t, 0, 0, c, d, this._drawTexToDrawTri_Index, s, l, null, null),
                            this._drawTriUseAbsMatrix = !1, !0;
                    }
                    var _ = this._mesh, f = this._curSubmit, p = h ? this._charSubmitCache.getPos() : this._transedPoints;
                    if (this.transformQuad(i, n, r || t.width, a || t.height, this._italicDeg, s || this._curMat, p),
                        this.drawTexAlign) {
                        var m = Math.round;
                        p[0] = m(p[0]), p[1] = m(p[1]), p[2] = m(p[2]), p[3] = m(p[3]), p[4] = m(p[4]),
                            p[5] = m(p[5]), p[6] = m(p[6]), p[7] = m(p[7]), this.drawTexAlign = !1;
                    }
                    var g = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA * l);
                    if (h) return this._charSubmitCache.add(this, t, e, p, o, g), !0;
                    this._drawCount++;
                    var y = e >= 0 && 2 === u.submitType && u.other === e;
                    return y && (y = y && this.isSameClipInfo(f)), this._lastTex = t, _.vertNum + 4 > 65535 && (_ = this._mesh = Pe.getAMesh(this.isMain),
                        this.meshlist.push(_), y = !1), _.addQuad(p, o, g, !0), y || (this._submits[this._submits._length++] = this._curSubmit = f = Se.create(this, _, H.create(1, 0)),
                            f.shaderValue.textureHost = t, f._key.other = e, this._copyClipInfo(f, this._globalClipMatrix)),
                        f._numEle += 6, _.indexNum += 6, _.vertNum += 4, !0;
                }, s.transform4Points = function (t, e, i) {
                    var n = e.tx, r = e.ty, a = e.a, s = e.b, o = e.c, l = e.d, h = t[0], u = t[1], c = t[2], d = t[3], _ = t[4], f = t[5], p = t[6], m = t[7];
                    e._bTransform ? (i[0] = h * a + u * o + n, i[1] = h * s + u * l + r, i[2] = c * a + d * o + n,
                        i[3] = c * s + d * l + r, i[4] = _ * a + f * o + n, i[5] = _ * s + f * l + r, i[6] = p * a + m * o + n,
                        i[7] = p * s + m * l + r) : (i[0] = h + n, i[1] = u + r, i[2] = c + n, i[3] = d + r,
                            i[4] = _ + n, i[5] = f + r, i[6] = p + n, i[7] = m + r);
                }, s.clipedOff = function (t) {
                    return this._clipRect.width <= 0 || this._clipRect.height <= 0;
                }, s.transformQuad = function (t, e, i, n, r, a, s) {
                    var o = 0;
                    0 != r && (o = Math.tan(r * Math.PI / 180) * n);
                    var l = t + i, h = e + n, u = a.tx, c = a.ty, d = a.a, _ = a.b, f = a.c, p = a.d, m = t + o, g = e, y = l + o, v = e, S = l, T = h, E = t, C = h;
                    a._bTransform ? (s[0] = m * d + g * f + u, s[1] = m * _ + g * p + c, s[2] = y * d + v * f + u,
                        s[3] = y * _ + v * p + c, s[4] = S * d + T * f + u, s[5] = S * _ + T * p + c, s[6] = E * d + C * f + u,
                        s[7] = E * _ + C * p + c) : (s[0] = m + u, s[1] = g + c, s[2] = y + u, s[3] = v + c,
                            s[4] = S + u, s[5] = T + c, s[6] = E + u, s[7] = C + c);
                }, s.pushRT = function () {
                    this.addRenderObject(K.create(null, _i.pushRT, this));
                }, s.popRT = function () {
                    this.addRenderObject(K.create(null, _i.popRT, this)), this.breakNextMerge();
                }, s.useRT = function (t) {
                    this.addRenderObject(K.create([t], function (t) {
                        if (!t) throw "error useRT";
                        t.start(), t.clear(0, 0, 0, 0);
                    }, this)), this.breakNextMerge();
                }, s.RTRestore = function (t) {
                    this.addRenderObject(K.create([t], function (t) {
                        t.restore();
                    }, this)), this.breakNextMerge();
                }, s.breakNextMerge = function () {
                    this._curSubmit = h.RENDERBASE;
                }, s._repaintSprite = function () {
                    this.sprite && this.sprite.repaint();
                }, s.drawTextureWithTransform = function (t, e, i, n, r, a, s, o, l, h, u) {
                    var c = null, d = this._curMat;
                    h && (c = this.globalCompositeOperation, this.globalCompositeOperation = h);
                    var _ = this._colorFiler;
                    if (u && this.setColorFilter(u), !a) return this._drawTextureM(t, e + s, i + o, n, r, d, l, null),
                        h && (this.globalCompositeOperation = c), void (u && this.setColorFilter(_));
                    var f = this._tmpMatrix;
                    f.a = a.a, f.b = a.b, f.c = a.c, f.d = a.d, f.tx = a.tx + s, f.ty = a.ty + o, f._bTransform = a._bTransform,
                        a && d._bTransform ? (at.mul(f, d, f), (a = f)._bTransform = !0) : (f.tx += d.tx,
                            f.ty += d.ty, a = f), this._drawTextureM(t, e, i, n, r, a, l, null), h && (this.globalCompositeOperation = c),
                        u && this.setColorFilter(_);
                }, s._flushToTarget = function (t, e) {
                    ft.worldScissorTest = !1, Ct.mainContext.disable(3089);
                    var i = ft.worldAlpha, n = ft.worldMatrix4, r = ft.worldMatrix;
                    ft.worldShaderDefines;
                    ft.worldMatrix = at.EMPTY, ft.restoreTempArray(), ft.worldMatrix4 = ft.TEMPMAT4_ARRAY,
                        ft.worldAlpha = 1, qe.activeShader = null, e.start(), t._submits._length > 0 && e.clear(0, 0, 0, 0),
                        t._curSubmit = h.RENDERBASE, t.flush(), t.clear(), e.restore(), t._curSubmit = h.RENDERBASE,
                        qe.activeShader = null, ft.worldAlpha = i, ft.worldMatrix4 = n, ft.worldMatrix = r;
                }, s.drawCanvas = function (t, e, i, n, r) {
                    if (t) {
                        var a, s = t.context;
                        if (s._targets) s._submits._length > 0 && (a = K.create([s, s._targets], this._flushToTarget, this),
                            this._submits[this._submits._length++] = a), this._drawRenderTexture(s._targets, e, i, n, r, null, 1, _i.flipyuv),
                            this._curSubmit = h.RENDERBASE; else {
                            var o = t;
                            o.touches && o.touches.forEach(function (t) {
                                t.touch();
                            }), a = Ee.create(t, this._shader2D.ALPHA, this._shader2D.filters), this._submits[this._submits._length++] = a,
                                a._key.clear();
                            var l = a._matrix;
                            this._curMat.copyTo(l);
                            var u = l.tx, c = l.ty;
                            l.tx = l.ty = 0, l.transformPoint(jt.TEMP.setTo(e, i)), l.translate(jt.TEMP.x + u, jt.TEMP.y + c),
                                at.mul(o.invMat, l, l), this._curSubmit = h.RENDERBASE;
                        }
                    }
                }, s.drawTarget = function (t, e, i, n, r, a, s, o, l) {
                    void 0 === l && (l = -1), this._drawCount++;
                    if (this._mesh.vertNum + 4 > 65535 && (this._mesh = Pe.getAMesh(this.isMain), this.meshlist.push(this._mesh)),
                        this.transformQuad(e, i, n, r, 0, a || this._curMat, this._transedPoints), !this.clipedOff(this._transedPoints)) {
                        this._mesh.addQuad(this._transedPoints, o || Me.DEF_UV, 4294967295, !0);
                        var u = this._curSubmit = _.create(this, this._mesh, s, t);
                        return u.blendType = -1 == l ? this._nBlendType : l, this._copyClipInfo(u, this._globalClipMatrix),
                            u._numEle = 6, this._mesh.indexNum += 6, this._mesh.vertNum += 4, this._submits[this._submits._length++] = u,
                            this._curSubmit = h.RENDERBASE, !0;
                    }
                    return this._curSubmit = h.RENDERBASE, !1;
                }, s.drawTriangles = function (t, e, n, r, a, s, o, l, u, c) {
                    if (t._getSource()) {
                        this._drawCount++;
                        var d = this._tmpMatrix, _ = this._triangleMesh, f = null, p = !1;
                        u && (f = this._colorFiler, this._colorFiler = u, this._curSubmit = h.RENDERBASE,
                            p = f != u);
                        var m = t.bitmap, g = this._curSubmit._key, y = 4 === g.submitType && g.other === m.id && g.blendShader == this._nBlendType;
                        if (_.vertNum + r.length / 2 > 65535 && (_ = this._triangleMesh = ke.getAMesh(this.isMain),
                            this.meshlist.push(_), y = !1), !y) {
                            var v = this._curSubmit = Se.create(this, _, H.create(1, 0));
                            v.shaderValue.textureHost = t, v._renderType = 10016, v._key.submitType = 4, v._key.other = m.id,
                                this._copyClipInfo(v, this._globalClipMatrix), this._submits[this._submits._length++] = v;
                        }
                        var S = this._mixRGBandAlpha(4294967295, this._shader2D.ALPHA * l);
                        this._drawTriUseAbsMatrix ? _.addData(r, a, s, o, S) : (o ? (d.a = o.a, d.b = o.b,
                            d.c = o.c, d.d = o.d, d.tx = o.tx + e, d.ty = o.ty + n) : (d.a = 1, d.b = 0, d.c = 0,
                                d.d = 1, d.tx = e, d.ty = n), at.mul(d, this._curMat, d), _.addData(r, a, s, d, S)),
                            this._curSubmit._numEle += s.length, p && (this._colorFiler = f, this._curSubmit = h.RENDERBASE);
                    } else this.sprite && i.systemTimer.callLater(this, this._repaintSprite);
                }, s.transform = function (t, e, i, n, r, a) {
                    Lt.save(this), at.mul(at.TEMP.setTo(t, e, i, n, r, a), this._curMat, this._curMat),
                        this._curMat._checkTransform();
                }, s._transformByMatrix = function (t, e, i) {
                    t.setTranslate(e, i), at.mul(t, this._curMat, this._curMat), t.setTranslate(0, 0),
                        this._curMat._bTransform = !0;
                }, s.setTransformByMatrix = function (t) {
                    t.copyTo(this._curMat);
                }, s.rotate = function (t) {
                    Lt.save(this), this._curMat.rotateEx(t);
                }, s.scale = function (t, e) {
                    Lt.save(this), this._curMat.scaleEx(t, e);
                }, s.clipRect = function (t, i, n, r) {
                    le.save(this), this._clipRect == e.MAXCLIPRECT ? this._clipRect = new mt(t, i, n, r) : (this._clipRect.width = n,
                        this._clipRect.height = r, this._clipRect.x = t, this._clipRect.y = i), e._clipID_Gen++,
                        e._clipID_Gen %= 1e4, this._clipInfoID = e._clipID_Gen;
                    var a = this._globalClipMatrix, s = a.tx, o = a.ty, l = s + a.a, h = o + a.d;
                    if (this._clipRect.width >= 99999999 ? (a.a = a.d = 99999999, a.b = a.c = a.tx = a.ty = 0) : (this._curMat._bTransform ? (a.tx = this._clipRect.x * this._curMat.a + this._clipRect.y * this._curMat.c + this._curMat.tx,
                        a.ty = this._clipRect.x * this._curMat.b + this._clipRect.y * this._curMat.d + this._curMat.ty,
                        a.a = this._clipRect.width * this._curMat.a, a.b = this._clipRect.width * this._curMat.b,
                        a.c = this._clipRect.height * this._curMat.c, a.d = this._clipRect.height * this._curMat.d) : (a.tx = this._clipRect.x + this._curMat.tx,
                            a.ty = this._clipRect.y + this._curMat.ty, a.a = this._clipRect.width, a.b = a.c = 0,
                            a.d = this._clipRect.height), this._incache && (this._clipInCache = !0)), a.a > 0 && a.d > 0) {
                        var u = a.tx + a.a, c = a.ty + a.d;
                        u <= s || c <= o || a.tx >= l || a.ty >= h ? (a.a = -.1, a.d = -.1) : (a.tx < s && (a.a -= s - a.tx,
                            a.tx = s), u > l && (a.a -= u - l), a.ty < o && (a.d -= o - a.ty, a.ty = o), c > h && (a.d -= c - h),
                            a.a <= 0 && (a.a = -.1), a.d <= 0 && (a.d = -.1));
                    }
                }, s.drawMesh = function (t, e, i, n, r, a, s, o, l) {
                    void 0 === l && (l = 0);
                }, s.addRenderObject = function (t) {
                    this._submits[this._submits._length++] = t;
                }, s.submitElement = function (t, e) {
                    At._context;
                    var i = this._submits, n = i._length;
                    e < 0 && (e = i._length);
                    for (var r = h.RENDERBASE; t < e;) this._renderNextSubmitIndex = t + 1, i[t] !== h.RENDERBASE ? (h.preRender = r,
                        t += (r = i[t]).renderSubmit()) : t++;
                    return n;
                }, s.flush = function () {
                    var t = this.submitElement(0, this._submits._length);
                    this._path && this._path.reset(), y.instance && y.getInstance().reset(), this._curSubmit = h.RENDERBASE;
                    for (var e = 0, i = this.meshlist.length; e < i; e++) {
                        var n = this.meshlist[e];
                        n.canReuse ? n.releaseMesh() : n.destroy();
                    }
                    return this.meshlist.length = 0, this._mesh = Pe.getAMesh(this.isMain), this._pathMesh = we.getAMesh(this.isMain),
                        this._triangleMesh = ke.getAMesh(this.isMain), this.meshlist.push(this._mesh, this._pathMesh, this._triangleMesh),
                        this._flushCnt++, this._flushCnt % 60 == 0 && At._context == this && x.textRenderInst && x.textRenderInst.GC(),
                        t;
                }, s.beginPath = function (t) {
                    void 0 === t && (t = !1), this._getPath().beginPath(t);
                }, s.closePath = function () {
                    this._path.closePath();
                }, s.addPath = function (t, e, i, n, r) {
                    for (var a = 0, s = 0, o = t.length / 2; s < o; s++) {
                        var l = t[a] + n, h = t[a + 1] + r;
                        t[a] = l, t[a + 1] = h, a += 2;
                    }
                    this._getPath().push(t, i);
                }, s.fill = function () {
                    var t = this._curMat, e = this._getPath(), i = this._curSubmit, n = 3 === i._key.submitType && i._key.blendShader === this._nBlendType;
                    n && (n = n && this.isSameClipInfo(i)), n || (this._curSubmit = this.addVGSubmit(this._pathMesh));
                    for (var r, a = this.mixRGBandAlpha(this.fillStyle.toInt()), s = 0, o = 0, l = e.paths.length; o < l; o++) {
                        var h = e.paths[o], u = h.path.length / 2;
                        if (!(u < 3 || 3 == u && !h.convex)) {
                            var c = h.path.concat(), d = 0, _ = 0, f = 0, p = NaN, m = NaN;
                            if (t._bTransform) for (d = 0; d < u; d++) f = (_ = d << 1) + 1, p = c[_], m = c[f],
                                c[_] = t.a * p + t.c * m + t.tx, c[f] = t.b * p + t.d * m + t.ty; else for (d = 0; d < u; d++) f = (_ = d << 1) + 1,
                                    p = c[_], m = c[f], c[_] = p + t.tx, c[f] = m + t.ty;
                            this._pathMesh.vertNum + u > 65535 && (this._curSubmit._numEle += s, s = 0, this._pathMesh = we.getAMesh(this.isMain),
                                this._curSubmit = this.addVGSubmit(this._pathMesh));
                            var g = this._pathMesh.vertNum;
                            if (h.convex) {
                                var y = u - 2;
                                r = new Array(3 * y);
                                for (var v = 0, S = 0; S < y; S++) r[v++] = g, r[v++] = S + 1 + g, r[v++] = S + 2 + g;
                            } else if (r = Gt.earcut(c, null, 2), g > 0) for (var T = 0; T < r.length; T++) r[T] += g;
                            this._pathMesh.addVertAndIBToMesh(this, c, a, r), s += r.length;
                        }
                    }
                    this._curSubmit._numEle += s;
                }, s.addVGSubmit = function (t) {
                    var e = h.createShape(this, t, 0, H.create(4, 0));
                    return e._key.submitType = 3, this._submits[this._submits._length++] = e, this._copyClipInfo(e, this._globalClipMatrix),
                        e;
                }, s.stroke = function () {
                    if (this.lineWidth > 0) {
                        var t = this.mixRGBandAlpha(this.strokeStyle._color.numColor), e = this._getPath(), i = this._curSubmit, n = 3 === i._key.submitType && i._key.blendShader === this._nBlendType;
                        n && (n = n && this.isSameClipInfo(i)), n || (this._curSubmit = this.addVGSubmit(this._pathMesh));
                        for (var r = 0, a = 0, s = e.paths.length; a < s; a++) {
                            var o = e.paths[a];
                            if (!(o.path.length <= 0)) {
                                var l = [], h = [], u = 2 * o.path.length;
                                if (!(u < 2)) {
                                    this._pathMesh.vertNum + u > 65535 && (this._curSubmit._numEle += r, r = 0, this._pathMesh = we.getAMesh(this.isMain),
                                        this.meshlist.push(this._pathMesh), this._curSubmit = this.addVGSubmit(this._pathMesh)),
                                        Wt.createLine2(o.path, l, this.lineWidth, this._pathMesh.vertNum, h, o.loop);
                                    var c = h.length / 2, d = this._curMat, _ = 0, f = 0, p = 0, m = NaN, g = NaN;
                                    if (d._bTransform) for (_ = 0; _ < c; _++) p = (f = _ << 1) + 1, m = h[f], g = h[p],
                                        h[f] = d.a * m + d.c * g + d.tx, h[p] = d.b * m + d.d * g + d.ty; else for (_ = 0; _ < c; _++) p = (f = _ << 1) + 1,
                                            m = h[f], g = h[p], h[f] = m + d.tx, h[p] = g + d.ty;
                                    this._pathMesh.addVertAndIBToMesh(this, h, t, l), r += l.length;
                                }
                            }
                        }
                        this._curSubmit._numEle += r;
                    }
                }, s.moveTo = function (t, e) {
                    var i = this._getPath();
                    i.newPath(), i._lastOriX = t, i._lastOriY = e, i.addPoint(t, e);
                }, s.lineTo = function (t, e) {
                    var i = this._getPath();
                    Math.abs(t - i._lastOriX) < .001 && Math.abs(e - i._lastOriY) < .001 || (i._lastOriX = t,
                        i._lastOriY = e, i.addPoint(t, e));
                }, s.arcTo = function (t, i, n, r, a) {
                    var s = 0, o = 0, l = 0, h = this._path._lastOriX - t, u = this._path._lastOriY - i, c = Math.sqrt(h * h + u * u);
                    if (!(c <= 1e-6)) {
                        var d = h / c, _ = u / c, f = n - t, p = r - i, m = f * f + p * p, g = Math.sqrt(m);
                        if (!(g <= 1e-6)) {
                            var y = f / g, v = p / g, S = d + y, T = _ + v, E = Math.sqrt(S * S + T * T);
                            if (!(E <= 1e-6)) {
                                var C = S / E, x = T / E, b = Math.acos(C * d + x * _), I = Math.PI / 2 - b, w = (c = a / Math.tan(I)) * d + t, A = c * _ + i, R = Math.sqrt(c * c + a * a), M = t + C * R, D = i + x * R, O = 0, L = 0;
                                if (d * v - _ * y >= 0) {
                                    var P = 2 * I / e.SEGNUM;
                                    O = Math.sin(P), L = Math.cos(P);
                                } else P = 2 * -I / e.SEGNUM, O = Math.sin(P), L = Math.cos(P);
                                var N = this._path._lastOriX, B = this._path._lastOriY, F = w, k = A;
                                (Math.abs(F - this._path._lastOriX) > .1 || Math.abs(k - this._path._lastOriY) > .1) && (o = F,
                                    l = k, N = F, B = k, this._path.addPoint(o, l));
                                var V = w - M, U = A - D;
                                for (s = 0; s < e.SEGNUM; s++) {
                                    var G = V * L + U * O, z = -V * O + U * L;
                                    o = G + M, l = z + D, (Math.abs(N - o) > .1 || Math.abs(B - l) > .1) && (this._path.addPoint(o, l),
                                        N = o, B = l), V = G, U = z;
                                }
                            }
                        }
                    }
                }, s.arc = function (t, e, i, n, r, a, s) {
                    void 0 === a && (a = !1), void 0 === s && (s = !0);
                    var o, l, h = 0, u = 0, c = 0, d = 0, _ = 0, f = 0, p = 0;
                    if (u = r - n, a) if (Math.abs(u) >= 2 * Math.PI) u = 2 * -Math.PI; else for (; u > 0;) u -= 2 * Math.PI; else if (Math.abs(u) >= 2 * Math.PI) u = 2 * Math.PI; else for (; u < 0;) u += 2 * Math.PI;
                    var m = this.getMatScaleX(), g = this.getMatScaleY(), y = i * (m > g ? m : g), v = 2 * Math.PI * y;
                    o = u / (l = 0 | Math.max(v / 10, 10)) / 2, c = Math.abs(4 / 3 * (1 - Math.cos(o)) / Math.sin(o)),
                        a && (c = -c);
                    var S = this._getPath();
                    for (p = 0; p <= l; p++) h = n + u * (p / l), d = Math.cos(h), f = e + Math.sin(h) * i,
                        (_ = t + d * i) == this._path._lastOriX && f == this._path._lastOriY || S.addPoint(_, f);
                    d = Math.cos(r), f = e + Math.sin(r) * i, (_ = t + d * i) == this._path._lastOriX && f == this._path._lastOriY || S.addPoint(_, f);
                }, s.quadraticCurveTo = function (t, e, i, n) {
                    for (var r = Bt.I.getBezierPoints([this._path._lastOriX, this._path._lastOriY, t, e, i, n], 30, 2), a = 0, s = r.length / 2; a < s; a++) this.lineTo(r[2 * a], r[2 * a + 1]);
                    this.lineTo(i, n);
                }, s.mixRGBandAlpha = function (t) {
                    return this._mixRGBandAlpha(t, this._shader2D.ALPHA);
                }, s._mixRGBandAlpha = function (t, e) {
                    if (e >= 1) return t;
                    var i = (4278190080 & t) >>> 24;
                    return 0 != i ? i *= e : i = 255 * e, 16777215 & t | i << 24;
                }, s.strokeRect = function (t, e, i, n, r) {
                    if (this.lineWidth > 0) {
                        var a = this.mixRGBandAlpha(this.strokeStyle._color.numColor), s = this.lineWidth / 2;
                        this._fillRect(t - s, e - s, i + this.lineWidth, this.lineWidth, a), this._fillRect(t - s, e - s + n, i + this.lineWidth, this.lineWidth, a),
                            this._fillRect(t - s, e + s, this.lineWidth, n - this.lineWidth, a), this._fillRect(t - s + i, e + s, this.lineWidth, n - this.lineWidth, a);
                    }
                }, s.clip = function () { }, s.drawParticle = function (t, e, i) {
                    i.x = t, i.y = e, this._submits[this._submits._length++] = i;
                }, s._getPath = function () {
                    return this._path || (this._path = new I());
                }, s._fillTexture_h = function (t, i, n, r, a, s, o, l) {
                    for (var h = s, u = Math.floor(l / r), c = l % r, d = 0; d < u; d++) this._inner_drawTexture(t, i, h, o, r, a, this._curMat, n, 1, !1),
                        h += r;
                    if (c > 0) {
                        var _ = n[2] - n[0], f = n[0] + _ * (c / r), p = e.tmpuv1;
                        p[0] = n[0], p[1] = n[1], p[2] = f, p[3] = n[3], p[4] = f, p[5] = n[5], p[6] = n[6],
                            p[7] = n[7], this._inner_drawTexture(t, i, h, o, c, a, this._curMat, p, 1, !1);
                    }
                }, s._fillTexture_v = function (t, i, n, r, a, s, o, l) {
                    for (var h = o, u = Math.floor(l / a), c = l % a, d = 0; d < u; d++) this._inner_drawTexture(t, i, s, h, r, a, this._curMat, n, 1, !1),
                        h += a;
                    if (c > 0) {
                        var _ = n[7] - n[1], f = n[1] + _ * (c / a), p = e.tmpuv1;
                        p[0] = n[0], p[1] = n[1], p[2] = n[2], p[3] = n[3], p[4] = n[4], p[5] = f, p[6] = n[6],
                            p[7] = f, this._inner_drawTexture(t, i, s, h, r, c, this._curMat, p, 1, !1);
                    }
                }, s.drawTextureWithSizeGrid = function (t, i, n, r, a, s, o, l) {
                    if (t._getSource()) {
                        i += o, n += l;
                        var h = t.uv, u = t.bitmap.width, c = t.bitmap.height, d = s[0], _ = s[3], f = d / c, p = _ / u, m = s[1], g = s[2], y = m / u, v = g / c, S = s[4], T = !1;
                        if (r == u && (_ = m = 0), a == c && (d = g = 0), _ + m > r) {
                            var E = r;
                            T = !0, r = _ + m, this.save(), this.clipRect(0 + i, 0 + n, E, a);
                        }
                        var C = t.bitmap.id, x = this._curMat, b = this._tempUV, I = h[0], w = h[1], A = h[4], R = h[5], M = I, D = w, O = A, L = R;
                        if (_ && d && (O = I + p, L = w + f, b[0] = I, b[1] = w, b[2] = O, b[3] = w, b[4] = O,
                            b[5] = L, b[6] = I, b[7] = L, this._inner_drawTexture(t, C, i, n, _, d, x, b, 1, !1)),
                            m && d && (M = A - y, D = w, O = A, L = w + f, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, this._inner_drawTexture(t, C, r - m + i, 0 + n, m, d, x, b, 1, !1)),
                            _ && g && (M = I, D = R - v, O = I + p, L = R, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, this._inner_drawTexture(t, C, 0 + i, a - g + n, _, g, x, b, 1, !1)),
                            m && g && (M = A - y, D = R - v, O = A, L = R, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, this._inner_drawTexture(t, C, r - m + i, a - g + n, m, g, x, b, 1, !1)),
                            d && (M = I + p, D = w, O = A - y, L = w + f, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, S ? this._fillTexture_h(t, C, b, t.width - _ - m, d, _ + i, n, r - _ - m) : this._inner_drawTexture(t, C, _ + i, n, r - _ - m, d, x, b, 1, !1)),
                            g && (M = I + p, D = R - v, O = A - y, L = R, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, S ? this._fillTexture_h(t, C, b, t.width - _ - m, g, _ + i, a - g + n, r - _ - m) : this._inner_drawTexture(t, C, _ + i, a - g + n, r - _ - m, g, x, b, 1, !1)),
                            _ && (M = I, D = w + f, O = I + p, L = R - v, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, S ? this._fillTexture_v(t, C, b, _, t.height - d - g, i, d + n, a - d - g) : this._inner_drawTexture(t, C, i, d + n, _, a - d - g, x, b, 1, !1)),
                            m && (M = A - y, D = w + f, O = A, L = R - v, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                                b[4] = O, b[5] = L, b[6] = M, b[7] = L, S ? this._fillTexture_v(t, C, b, m, t.height - d - g, r - m + i, d + n, a - d - g) : this._inner_drawTexture(t, C, r - m + i, d + n, m, a - d - g, x, b, 1, !1)),
                            M = I + p, D = w + f, O = A - y, L = R - v, b[0] = M, b[1] = D, b[2] = O, b[3] = D,
                            b[4] = O, b[5] = L, b[6] = M, b[7] = L, S) {
                            var P = e.tmpUVRect;
                            P[0] = M, P[1] = D, P[2] = O - M, P[3] = L - D, this._fillTexture(t, t.width - _ - m, t.height - d - g, P, _ + i, d + n, r - _ - m, a - d - g, "repeat", 0, 0);
                        } else this._inner_drawTexture(t, C, _ + i, d + n, r - _ - m, a - d - g, x, b, 1, !1);
                        T && this.restore();
                    }
                }, a(0, s, "textAlign", function () {
                    return this._other.textAlign;
                }, function (t) {
                    this._other.textAlign === t || (this._other = this._other.make(), l.save(this, 32768, this._other, !1),
                        this._other.textAlign = t);
                }), a(0, s, "lineJoin", function () {
                    return null;
                }, function (t) { }), a(0, s, "fillStyle", function () {
                    return this._shader2D.fillStyle;
                }, function (t) {
                    this._shader2D.fillStyle.equal(t) || (l.save(this, 2, this._shader2D, !1), this._shader2D.fillStyle = It.create(t),
                        this._submitKey.other = -this._shader2D.fillStyle.toInt());
                }), a(0, s, "lineCap", function () {
                    return null;
                }, function (t) { }), a(0, s, "miterLimit", function () {
                    return null;
                }, function (t) { }), a(0, s, "strokeStyle", function () {
                    return this._shader2D.strokeStyle;
                }, function (t) {
                    this._shader2D.strokeStyle.equal(t) || (l.save(this, 512, this._shader2D, !1), this._shader2D.strokeStyle = It.create(t),
                        this._submitKey.other = -this._shader2D.strokeStyle.toInt());
                }), a(0, s, "globalCompositeOperation", function () {
                    return de.NAMES[this._nBlendType];
                }, function (t) {
                    var e = de.TOINT[t];
                    null == e || this._nBlendType === e || (l.save(this, 65536, this, !0), this._curSubmit = h.RENDERBASE,
                        this._nBlendType = e);
                }), a(0, s, "globalAlpha", function () {
                    return this._shader2D.ALPHA;
                }, function (t) {
                    (t = Math.floor(1e3 * t) / 1e3) != this._shader2D.ALPHA && (l.save(this, 1, this._shader2D, !1),
                        this._shader2D.ALPHA = t);
                }), a(0, s, "asBitmap", null, function (t) {
                    if (t) {
                        if (this._targets || (this._targets = new _i(this._width, this._height, 1, -1)),
                            !this._width || !this._height) throw Error("asBitmap no size!");
                    } else this._targets && this._targets.destroy(), this._targets = null;
                }), a(0, s, "textBaseline", function () {
                    return this._other.textBaseline;
                }, function (t) {
                    this._other.textBaseline === t || (this._other = this._other.make(), l.save(this, 16384, this._other, !1),
                        this._other.textBaseline = t);
                }), a(0, s, "lineWidth", function () {
                    return this._other.lineWidth;
                }, function (t) {
                    this._other.lineWidth === t || (this._other = this._other.make(), l.save(this, 256, this._other, !1),
                        this._other.lineWidth = t);
                }), a(0, s, "font", null, function (t) {
                    this._other = this._other.make(), l.save(this, 8, this._other, !1);
                }), a(0, s, "canvas", function () {
                    return this._canvas;
                }), e.__init__ = function () {
                    e.MAXCLIPRECT = new mt(0, 0, 99999999, 99999999), t.DEFAULT = new t();
                }, e.set2DRenderConfig = function () {
                    var t = Dt.instance;
                    nt.setBlend(t, !0), nt.setBlendFunc(t, 1, 771), nt.setDepthTest(t, !1), nt.setCullFace(t, !1),
                        nt.setDepthMask(t, !0), nt.setFrontFace(t, 2305), t.viewport(0, 0, ft.width, ft.height);
                }, e.ENUM_TEXTALIGN_DEFAULT = 0, e.ENUM_TEXTALIGN_CENTER = 1, e.ENUM_TEXTALIGN_RIGHT = 2,
                e._SUBMITVBSIZE = 32e3, e._MAXSIZE = 99999999, e._MAXVERTNUM = 65535, e.MAXCLIPRECT = null,
                e._COUNT = 0, e.SEGNUM = 32, e._contextcount = 0, e.PI2 = 2 * Math.PI, e._clipID_Gen = 0,
                n(e, ["_textRender", function () {
                    return this._textRender = new x();
                }, "tmpuv1", function () {
                    return this.tmpuv1 = [0, 0, 0, 0, 0, 0, 0, 0];
                }, "tmpUV", function () {
                    return this.tmpUV = [0, 0, 0, 0, 0, 0, 0, 0];
                }, "tmpUVRect", function () {
                    return this.tmpUVRect = [0, 0, 0, 0];
                }]), e.__init$ = function () {
                    t = function () {
                        function t() {
                            this.lineWidth = 1, this.textAlign = null, this.textBaseline = null;
                        }
                        r(t, "");
                        var e = t.prototype;
                        return e.clear = function () {
                            this.lineWidth = 1, this.textAlign = this.textBaseline = null;
                        }, e.make = function () {
                            return this === t.DEFAULT ? new t() : this;
                        }, t.DEFAULT = null, t;
                    }();
                }, e;
        }(), ct = function () {
            function t() { }
            r(t, "laya.filters.BlurFilterGLRender");
            var e = t.prototype;
            return e.render = function (t, e, i, n, r) {
                var a = H.create(1, 0);
                this.setShaderInfo(a, r, t.width, t.height), e.drawTarget(t, 0, 0, i, n, at.EMPTY.identity(), a);
            }, e.setShaderInfo = function (e, i, n, r) {
                e.defines.add(16);
                var a = e;
                t.blurinfo[0] = n, t.blurinfo[1] = r, a.blurInfo = t.blurinfo;
                var s = i.strength / 3, o = s * s;
                i.strength_sig2_2sig2_gauss1[0] = i.strength, i.strength_sig2_2sig2_gauss1[1] = o,
                    i.strength_sig2_2sig2_gauss1[2] = 2 * o, i.strength_sig2_2sig2_gauss1[3] = 1 / (2 * Math.PI * o),
                    a.strength_sig2_2sig2_gauss1 = i.strength_sig2_2sig2_gauss1;
            }, n(t, ["blurinfo", function () {
                return this.blurinfo = new Array(2);
            }]), t;
        }(), dt = function () {
            function t() { }
            return r(t, "laya.webgl.utils.CONST3D2D"), t.BYTES_PE = 4, t.BYTES_PIDX = 2, t.defaultMatrix4 = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                t.defaultMinusYMatrix4 = [1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], t.uniformMatrix3 = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0],
                t._TMPARRAY = [], t._OFFSETX = 0, t._OFFSETY = 0, t;
        }(), _t = function () {
            function t() {
                this.char = "", this.tex = null, this.deleted = !1, this.pos = 0, this.width = 0,
                    this.height = 0, this.bmpWidth = 0, this.bmpHeight = 0, this.orix = 0, this.oriy = 0,
                    this.touchTick = 0, this.isSpace = !1, this.uv = new Array(8);
            }
            return r(t, "laya.webgl.text.CharRenderInfo"), t.prototype.touch = function () {
                var t = b.loopCount;
                this.touchTick != t && this.tex.touchRect(this, t), this.touchTick = t;
            }, t;
        }(), ft = (function () {
            function t() {
                this._renderType = 0, this._repaint = 0, this._x = NaN, this._y = NaN;
            }
            r(t, "laya.layagl.QuickTestTool");
            var e = t.prototype;
            e.render = function (e, i, n) {
                t._addType(this._renderType), t.showRenderTypeInfo(this._renderType), M.renders[this._renderType]._fun(this, e, i + this._x, n + this._y),
                    this._repaint = 0;
            }, e._stageRender = function (e, n, r) {
                t._countStart(), t._PreStageRender.call(i.stage, e, n, r), t._countEnd();
            }, t.getMCDName = function (e) {
                return t._typeToNameDic[e];
            }, t.showRenderTypeInfo = function (e, i) {
                if (void 0 === i && (i = !1), i || !t.showedDic[e]) {
                    if (t.showedDic[e] = !0, !t._rendertypeToStrDic[e]) {
                        var n = [], r = 0;
                        for (r = 1; r <= e;) r & e && n.push(t.getMCDName(r & e)), r <<= 1;
                        t._rendertypeToStrDic[e] = n.join(",");
                    }
                    console.log("cmd:", t._rendertypeToStrDic[e]);
                }
            }, t.__init__ = function () {
                t._typeToNameDic[1] = "ALPHA", t._typeToNameDic[2] = "TRANSFORM", t._typeToNameDic[256] = "TEXTURE",
                    t._typeToNameDic[512] = "GRAPHICS", t._typeToNameDic[4096] = "ONECHILD", t._typeToNameDic[8192] = "CHILDS",
                    t._typeToNameDic[3] = "TRANSFORM|ALPHA", t._typeToNameDic[8] = "CANVAS", t._typeToNameDic[4] = "BLEND",
                    t._typeToNameDic[16] = "FILTERS", t._typeToNameDic[32] = "MASK", t._typeToNameDic[64] = "CLIP",
                    t._typeToNameDic[1024] = "LAYAGL3D";
            }, t._countStart = function () {
                var e;
                for (e in t._countDic) t._countDic[e] = 0;
            }, t._countEnd = function () {
                t._i++, t._i > 60 && (t.showCountInfo(), t._i = 0);
            }, t._addType = function (e) {
                t._countDic[e] ? t._countDic[e] += 1 : t._countDic[e] = 1;
            }, t.showCountInfo = function () {
                var e;
                for (e in console.log("==================="), t._countDic) console.log("count:" + t._countDic[e]),
                    t.showRenderTypeInfo(e, !0);
            }, t.enableQuickTest = function () {
                t.__init__(), Ye.prototype.render = t.prototype.render, t._PreStageRender = si.prototype.render,
                    si.prototype.render = t.prototype._stageRender;
            }, t.showedDic = {}, t._rendertypeToStrDic = {}, t._typeToNameDic = {}, t._PreStageRender = null,
                t._countDic = {}, t._i = 0;
        }(), function () {
            function t() { }
            return r(t, "laya.webgl.utils.RenderState2D"), t.mat2MatArray = function (e, i) {
                var n = e, r = i;
                return r[0] = n.a, r[1] = n.b, r[2] = t.EMPTYMAT4_ARRAY[2], r[3] = t.EMPTYMAT4_ARRAY[3],
                    r[4] = n.c, r[5] = n.d, r[6] = t.EMPTYMAT4_ARRAY[6], r[7] = t.EMPTYMAT4_ARRAY[7],
                    r[8] = t.EMPTYMAT4_ARRAY[8], r[9] = t.EMPTYMAT4_ARRAY[9], r[10] = t.EMPTYMAT4_ARRAY[10],
                    r[11] = t.EMPTYMAT4_ARRAY[11], r[12] = n.tx, r[13] = n.ty, r[14] = t.EMPTYMAT4_ARRAY[14],
                    r[15] = t.EMPTYMAT4_ARRAY[15], i;
            }, t.restoreTempArray = function () {
                t.TEMPMAT4_ARRAY[0] = 1, t.TEMPMAT4_ARRAY[1] = 0, t.TEMPMAT4_ARRAY[4] = 0, t.TEMPMAT4_ARRAY[5] = 1,
                    t.TEMPMAT4_ARRAY[12] = 0, t.TEMPMAT4_ARRAY[13] = 0;
            }, t.clear = function () {
                t.worldScissorTest = !1, t.worldAlpha = 1;
            }, t._MAXSIZE = 99999999, t.EMPTYMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],
                t.TEMPMAT4_ARRAY = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], t.worldMatrix4 = t.TEMPMAT4_ARRAY,
                t.matWVP = null, t.worldAlpha = 1, t.worldScissorTest = !1, t.worldShaderDefines = null,
                t.worldFilters = null, t.width = 0, t.height = 0, n(t, ["worldMatrix", function () {
                    return this.worldMatrix = new at();
                }]), t;
        }()), pt = function () {
            var t, e;
            function a() { }
            return r(a, "laya.utils.SceneUtils"), a.getBindFun = function (t) {
                var e = a._funMap.get(t);
                if (null == e) {
                    var n = '"' + t + '"', r = "(function(data){if(data==null)return;with(data){try{\nreturn " + (n = n.replace(/^"\${|}"$/g, "").replace(/\${/g, '"+').replace(/}/g, '+"')) + "\n}catch(e){}}})";
                    e = i._runScript(r), a._funMap.set(t, e);
                }
                return e;
            }, a.createByData = function (t, i) {
                var n = e.create();
                if ((t = a.createComp(i, t, t, null, n))._setBit(8, !0), t.hasOwnProperty("_idMap") && (t._idMap = n._idMap),
                    i.animations) {
                    var r, s, o = [], l = i.animations, h = 0, u = l.length;
                    for (h = 0; h < u; h++) {
                        switch (r = new ci(), s = l[h], r._setUp(n._idMap, s), t[s.name] = r, r._setControlNode(t),
                        s.action) {
                            case 1:
                                r.play(0, !1);
                                break;

                            case 2:
                                r.play(0, !0);
                        }
                        o.push(r);
                    }
                    t._aniList = o;
                }
                return "Scene" === t._$componentType && t._width > 0 && null == i.props.hitTestPrior && !t.mouseThrough && (t.hitTestPrior = !0),
                    n.beginLoad(t), t;
            }, a.createInitTool = function () {
                return e.create();
            }, a.createComp = function (t, e, n, r, s) {
                if ("Scene3D" == t.type || "Sprite3D" == t.type) {
                    var o = [], l = i.Utils3D._createSceneByJsonForMaker(t, o, s);
                    return "Sprite3D" == t.type ? i.StaticBatchManager.combine(l, o) : i.StaticBatchManager.combine(null, o),
                        l;
                }
                if (!(e = e || a.getCompInstance(t))) return t.props && t.props.runtime ? console.warn("runtime not found:" + t.props.runtime) : console.warn("can not create:" + t.type),
                    null;
                var h = t.child;
                if (h) for (var u = "List" == e._$componentType, c = 0, d = h.length; c < d; c++) {
                    var _ = h[c];
                    if (!e.hasOwnProperty("itemRender") || "render" != _.props.name && "render" !== _.props.renderType) if ("Graphic" == _.type) Rt._addGraphicsToSprite(_, e); else if (Rt._isDrawType(_.type)) Rt._addGraphicToSprite(_, e, !0); else {
                        if (u) {
                            var f = [], p = a.createComp(_, null, n, f, s);
                            f.length && (p._$bindData = f);
                        } else p = a.createComp(_, null, n, r, s);
                        "Script" == _.type ? p instanceof laya.components.Component ? e._addComponentInstance(p) : "owner" in p ? p.owner = e : "target" in p && (p.target = e) : "mask" == _.props.renderType || "mask" == _.props.name ? e.mask = p : p instanceof laya.display.Node && e.addChild(p);
                    } else e.itemRender = _;
                }
                var m = t.props;
                for (var g in m) {
                    var y = m[g];
                    "string" == typeof y && (y.indexOf("@node:") >= 0 || y.indexOf("@Prefab:") >= 0) ? s && s.addNodeRef(e, g, y) : a.setCompValue(e, g, y, n, r);
                }
                return e._afterInited && e._afterInited(), t.compId && s && s._idMap && (s._idMap[t.compId] = e),
                    e;
            }, a.setCompValue = function (e, i, n, r, s) {
                if ("string" == typeof n && n.indexOf("${") > -1) {
                    if (a._sheet || (a._sheet = Rt.getClass("laya.data.Table")), !a._sheet) return void console.warn("Can not find class Sheet");
                    if (s) s.push(e, i, n); else if (r) {
                        -1 == n.indexOf("].") && (n = n.replace(".", "[0]."));
                        var o, l, h = new t(e, i, n);
                        h.exe(r);
                        for (var u = n.replace(/\[.*?\]\./g, "."); null != (o = a._parseWatchData.exec(u));) {
                            for (var c = o[1]; null != (l = a._parseKeyWord.exec(c));) {
                                var d = l[0], _ = r._watchMap[d] || (r._watchMap[d] = []);
                                _.push(h), a._sheet.I.notifer.on(d, r, r.changeData, [d]);
                            }
                            (_ = r._watchMap[c] || (r._watchMap[c] = [])).push(h), a._sheet.I.notifer.on(c, r, r.changeData, [c]);
                        }
                    }
                } else "var" === i && r ? r[n] = e : e[i] = "true" === n || "false" !== n && n;
            }, a.getCompInstance = function (t) {
                if ("UIView" == t.type && t.props && t.props.pageData) return a.createByData(null, t.props.pageData);
                var e = t.props && t.props.runtime || t.type, i = Rt.getClass(e);
                if (!i) throw "Can not find class " + e;
                if ("Script" === t.type && i.prototype._doAwake) {
                    var n = V.createByClass(i);
                    return n._destroyed = !1, n;
                }
                return t.props && t.props.hasOwnProperty("renderType") && "instance" == t.props.renderType ? (i.instance || (i.instance = new i()),
                    i.instance) : new i();
            }, a._sheet = null, n(a, ["_funMap", function () {
                return this._funMap = new xt();
            }, "_parseWatchData", function () {
                return this._parseWatchData = /\${(.*?)}/g;
            }, "_parseKeyWord", function () {
                return this._parseKeyWord = /[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;
            }]), a.__init$ = function () {
                t = function () {
                    function t(t, e, i) {
                        this.comp = null, this.prop = null, this.value = null, this.comp = t, this.prop = e,
                            this.value = i;
                    }
                    return r(t, ""), t.prototype.exe = function (t) {
                        var e = a.getBindFun(this.value);
                        this.comp[this.prop] = e.call(this, t);
                    }, t;
                }(), e = function () {
                    function t() {
                        this._nodeRefList = null, this._initList = null, this._loadList = null, this._idMap = null,
                            this._scene = null;
                    }
                    r(t, "");
                    var e = t.prototype;
                    return e.reset = function () {
                        this._nodeRefList = null, this._initList = null, this._idMap = null, this._loadList = null,
                            this._scene = null;
                    }, e.recover = function () {
                        this.reset(), V.recover("InitTool", this);
                    }, e.addLoadRes = function (t, e) {
                        this._loadList || (this._loadList = []), e ? this._loadList.push({
                            url: t,
                            type: e
                        }) : this._loadList.push(t);
                    }, e.addNodeRef = function (t, e, i) {
                        this._nodeRefList || (this._nodeRefList = []), this._nodeRefList.push([t, e, i]),
                            i.indexOf("@Prefab:") >= 0 && this.addLoadRes(i.replace("@Prefab:", ""), "prefab");
                    }, e.setNodeRef = function () {
                        if (this._nodeRefList) if (this._idMap) {
                            var t, e, i = 0;
                            for (t = this._nodeRefList.length, i = 0; i < t; i++) (e = this._nodeRefList[i])[0][e[1]] = this.getReferData(e[2]);
                            this._nodeRefList = null;
                        } else this._nodeRefList = null;
                    }, e.getReferData = function (t) {
                        if (t.indexOf("@Prefab:") >= 0) return Oe.getRes(t.replace("@Prefab:", ""));
                        if (t.indexOf("@arr:") >= 0) {
                            var e, i, n, r = 0;
                            for (i = (e = (t = t.replace("@arr:", "")).split(",")).length, r = 0; r < i; r++) n = e[r],
                                e[r] = n ? this._idMap[n.replace("@node:", "")] : null;
                            return e;
                        }
                        return this._idMap[t.replace("@node:", "")];
                    }, e.addInitItem = function (t) {
                        this._initList || (this._initList = []), this._initList.push(t);
                    }, e.doInits = function () {
                        this._initList && (this._initList = null);
                    }, e.finish = function () {
                        this.setNodeRef(), this.doInits(), this._scene._setBit(8, !1), this._scene.parent && this._scene.parent.activeInHierarchy && this._scene.active && this._scene._processActive(),
                            this._scene.event("onViewCreated"), this.recover();
                    }, e.beginLoad = function (t) {
                        this._scene = t, !this._loadList || this._loadList.length < 1 ? this.finish() : i.loader.load(this._loadList, g.create(this, this.finish));
                    }, t.create = function () {
                        var e = V.getItemByClass("InitTool", t);
                        return e._idMap = [], e;
                    }, t;
                }();
            }, a;
        }(), mt = function () {
            function t(t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0),
                    this.x = t, this.y = e, this.width = i, this.height = n;
            }
            r(t, "laya.maths.Rectangle");
            var e = t.prototype;
            return e.setTo = function (t, e, i, n) {
                return this.x = t, this.y = e, this.width = i, this.height = n, this;
            }, e.reset = function () {
                return this.x = this.y = this.width = this.height = 0, this;
            }, e.recover = function () {
                this != t.TEMP && this != t.EMPTY ? V.recover("Rectangle", this.reset()) : console.log("recover Temp or Empty:", this);
            }, e.copyFrom = function (t) {
                return this.x = t.x, this.y = t.y, this.width = t.width, this.height = t.height,
                    this;
            }, e.contains = function (t, e) {
                return !(this.width <= 0 || this.height <= 0) && (t >= this.x && t < this.right && e >= this.y && e < this.bottom);
            }, e.intersects = function (t) {
                return !(t.x > this.x + this.width || t.x + t.width < this.x || t.y > this.y + this.height || t.y + t.height < this.y);
            }, e.intersection = function (e, i) {
                return this.intersects(e) ? (i || (i = new t()), i.x = Math.max(this.x, e.x), i.y = Math.max(this.y, e.y),
                    i.width = Math.min(this.right, e.right) - i.x, i.height = Math.min(this.bottom, e.bottom) - i.y,
                    i) : null;
            }, e.union = function (e, i) {
                return i || (i = new t()), this.clone(i), e.width <= 0 || e.height <= 0 ? i : (i.addPoint(e.x, e.y),
                    i.addPoint(e.right, e.bottom), this);
            }, e.clone = function (e) {
                return e || (e = new t()), e.x = this.x, e.y = this.y, e.width = this.width, e.height = this.height,
                    e;
            }, e.toString = function () {
                return this.x + "," + this.y + "," + this.width + "," + this.height;
            }, e.equals = function (t) {
                return !(!t || t.x !== this.x || t.y !== this.y || t.width !== this.width || t.height !== this.height);
            }, e.addPoint = function (t, e) {
                return this.x > t && (this.width += this.x - t, this.x = t), this.y > e && (this.height += this.y - e,
                    this.y = e), this.width < t - this.x && (this.width = t - this.x), this.height < e - this.y && (this.height = e - this.y),
                    this;
            }, e._getBoundPoints = function () {
                var e = t._temB;
                return e.length = 0, 0 == this.width || 0 == this.height || e.push(this.x, this.y, this.x + this.width, this.y, this.x, this.y + this.height, this.x + this.width, this.y + this.height),
                    e;
            }, e.isEmpty = function () {
                return this.width <= 0 || this.height <= 0;
            }, a(0, e, "right", function () {
                return this.x + this.width;
            }), a(0, e, "bottom", function () {
                return this.y + this.height;
            }), t.create = function () {
                return V.getItemByClass("Rectangle", t);
            }, t._getBoundPointS = function (e, i, n, r) {
                var a = t._temA;
                return a.length = 0, 0 == n || 0 == r || a.push(e, i, e + n, i, e, i + r, e + n, i + r),
                    a;
            }, t._getWrapRec = function (e, i) {
                if (!e || e.length < 1) return i ? i.setTo(0, 0, 0, 0) : t.TEMP.setTo(0, 0, 0, 0);
                i = i || laya.maths.Rectangle.create();
                var n, r, a, s, o, l = e.length, h = jt.TEMP;
                for (a = o = -(r = s = 99999), n = 0; n < l; n += 2) h.x = e[n], h.y = e[n + 1],
                    r = r < h.x ? r : h.x, s = s < h.y ? s : h.y, a = a > h.x ? a : h.x, o = o > h.y ? o : h.y;
                return i.setTo(r, s, a - r, o - s);
            }, t.EMPTY = new t(), t.TEMP = new t(), t._temB = [], t._temA = [], t;
        }(), gt = function () {
            function t() { }
            return r(t, "laya.events.KeyBoardManager"), t.__init__ = function () {
                t._addEvent("keydown"), t._addEvent("keypress"), t._addEvent("keyup");
            }, t._addEvent = function (t) {
                Ot.document.addEventListener(t, function (e) {
                    laya.events.KeyBoardManager._dispatch(e, t);
                }, !0);
            }, t._dispatch = function (e, n) {
                if (t.enabled) {
                    t._event._stoped = !1, t._event.nativeEvent = e, t._event.keyCode = e.keyCode || e.which || e.charCode,
                        "keydown" === n ? t._pressKeys[t._event.keyCode] = !0 : "keyup" === n && (t._pressKeys[t._event.keyCode] = null);
                    for (var r = i.stage.focus && null != i.stage.focus.event && i.stage.focus.displayedInStage ? i.stage.focus : i.stage, a = r; a;) a.event(n, t._event.setTo(n, a, r)),
                        a = a.parent;
                }
            }, t.hasKeyDown = function (e) {
                return t._pressKeys[e];
            }, t._pressKeys = {}, t.enabled = !0, n(t, ["_event", function () {
                return this._event = new C();
            }]), t;
        }(), yt = function () {
            function t() { }
            return r(t, "laya.layagl.LayaGLRunner"), t.uploadShaderUniforms = function (t, e, i, n) {
                for (var r = i._data, a = e.getArrayData(), s = 0, o = 0, l = a.length; o < l; o++) {
                    var h = a[o];
                    if (n || -1 !== h.textureID) {
                        var u = r[h.dataOffset];
                        null != u && (s += h.fun.call(h.caller, h, u));
                    }
                }
                return s;
            }, t.uploadCustomUniform = function (t, e, i, n) {
                var r = 0, a = e[i];
                return a && null != n && (r += a.fun.call(a.caller, a, n)), r;
            }, t.uploadShaderUniformsForNative = function (t, e, i) {
                var n = 0;
                i._runtimeCopyValues.length > 0 && (n = 1);
                var r = i._data;
                return t.uploadShaderUniforms(e, r, n);
            }, t;
        }(), vt = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawPathCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.paths = null, this.brush = null, this.pen = null, V.recover("DrawPathCmd", this);
            }, e.run = function (t, e, i) {
                t._drawPath(this.x + e, this.y + i, this.paths, this.brush, this.pen);
            }, a(0, e, "cmdID", function () {
                return "DrawPath";
            }), t.create = function (e, i, n, r, a) {
                var s = V.getItemByClass("DrawPathCmd", t);
                return s.x = e, s.y = i, s.paths = n, s.brush = r, s.pen = a, s;
            }, t.ID = "DrawPath", t;
        }(), St = function () {
            function t() {
                this._nativeVertexArrayObject = null, this._bindedIndexBuffer = null, this._nativeVertexArrayObject = Dt.instance.createVertexArray();
            }
            r(t, "laya.webgl.BufferStateBase");
            var e = t.prototype;
            return e.bind = function () {
                t._curBindedBufferState !== this && (Dt.instance.bindVertexArray(this._nativeVertexArrayObject),
                    t._curBindedBufferState = this);
            }, e.unBind = function () {
                if (t._curBindedBufferState !== this) throw "BufferState: must call bind() function first.";
                Dt.instance.bindVertexArray(null), t._curBindedBufferState = null;
            }, e.bindForNative = function () {
                Dt.instance.bindVertexArray(this._nativeVertexArrayObject), t._curBindedBufferState = this;
            }, e.unBindForNative = function () {
                Dt.instance.bindVertexArray(null), t._curBindedBufferState = null;
            }, e.destroy = function () {
                Dt.instance.deleteVertexArray(this._nativeVertexArrayObject);
            }, t._curBindedBufferState = null, t;
        }(), Tt = function () {
            function t() { }
            r(t, "laya.display.cmd.SaveCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("SaveCmd", this);
            }, e.run = function (t, e, i) {
                t.save();
            }, a(0, e, "cmdID", function () {
                return "Save";
            }), t.create = function () {
                return V.getItemByClass("SaveCmd", t);
            }, t.ID = "Save", t;
        }(), Et = function () {
            var e;
            function i() { }
            return r(i, "laya.net.LocalStorage"), i.__init__ = function () {
                return i._baseClass || (i._baseClass = e, e.init()), i.items = i._baseClass.items,
                    i.support = i._baseClass.support, i.support;
            }, i.setItem = function (t, e) {
                i._baseClass.setItem(t, e);
            }, i.getItem = function (t) {
                return i._baseClass.getItem(t);
            }, i.setJSON = function (t, e) {
                i._baseClass.setJSON(t, e);
            }, i.getJSON = function (t) {
                return i._baseClass.getJSON(t);
            }, i.removeItem = function (t) {
                i._baseClass.removeItem(t);
            }, i.clear = function () {
                i._baseClass.clear();
            }, i._baseClass = null, i.items = null, i.support = !1, i.__init$ = function () {
                e = function () {
                    function e() { }
                    return r(e, ""), e.init = function () {
                        try {
                            e.support = !0, e.items = t.localStorage, e.setItem("laya", "1"), e.removeItem("laya");
                        } catch (t) {
                            e.support = !1;
                        }
                        e.support || console.log("LocalStorage is not supprot or browser is private mode.");
                    }, e.setItem = function (t, i) {
                        try {
                            e.support && e.items.setItem(t, i);
                        } catch (t) {
                            console.warn("set localStorage failed", t);
                        }
                    }, e.getItem = function (t) {
                        return e.support ? e.items.getItem(t) : null;
                    }, e.setJSON = function (t, i) {
                        try {
                            e.support && e.items.setItem(t, JSON.stringify(i));
                        } catch (t) {
                            console.warn("set localStorage failed", t);
                        }
                    }, e.getJSON = function (t) {
                        return JSON.parse(e.support ? e.items.getItem(t) : null);
                    }, e.removeItem = function (t) {
                        e.support && e.items.removeItem(t);
                    }, e.clear = function () {
                        e.support && e.items.clear();
                    }, e.items = null, e.support = !1, e;
                }();
            }, i;
        }(), Ct = function () {
            function e() { }
            return r(e, "laya.webgl.WebGL"), e._uint8ArraySlice = function () {
                for (var t = this.length, e = new Uint8Array(this.length), i = 0; i < t; i++) e[i] = this[i];
                return e;
            }, e._float32ArraySlice = function () {
                for (var t = this.length, e = new Float32Array(this.length), i = 0; i < t; i++) e[i] = this[i];
                return e;
            }, e._uint16ArraySlice = function (t) {
                var e, i = arguments, n = this, r = 0, a = 0;
                if (0 === i.length) for (r = n.length, e = new Uint16Array(r), a = 0; a < r; a++) e[a] = n[a]; else if (2 === i.length) {
                    var s = i[0], o = i[1];
                    if (o > s) for (r = o - s, e = new Uint16Array(r), a = s; a < o; a++) e[a - s] = n[a]; else e = new Uint16Array(0);
                }
                return e;
            }, e._nativeRender_enable = function () {
                e.isNativeRender_enable || (e.isNativeRender_enable = !0, nt.__init_native(), ni.prototype.uploadTexture2D = function (t) {
                    var e = nt;
                    e.bindTexture(laya.webgl.WebGL.mainContext, e.TEXTURE_2D, t);
                }, ft.width = Ot.window.innerWidth, ft.height = Ot.window.innerHeight, ue.measureText = function (e, i) {
                    return t.conchTextCanvas.font = i, t.conchTextCanvas.measureText(e);
                }, ue.enableNative = function () {
                    At.supportWebGLPlusRendering && (yt.uploadShaderUniforms = yt.uploadShaderUniformsForNative,
                        Pt = t.GLCommandEncoder, Dt = t.LayaGLContext);
                    var e = si;
                    e.prototype.render = e.prototype.renderToNative;
                }, ue.clear = function (t) {
                    ut.set2DRenderConfig();
                    var e = o.create(t).arrColor, i = Dt.instance;
                    e && i.clearColor(e[0], e[1], e[2], e[3]), i.clear(17664), ft.clear();
                }, ue.drawToCanvas = ue.drawToTexture = function (t, e, i, n, r, a) {
                    r -= t.x, a -= t.y, r |= 0, a |= 0, i |= 0, n |= 0;
                    var s = new ai(!1), o = s.getContext("2d");
                    return s.size(i, n), o.asBitmap = !0, o._targets.start(), M.renders[e]._fun(t, o, r, a),
                        o.flush(), o._targets.end(), o._targets.restore(), s;
                }, _i.prototype._uv = _i.flipyuv, Object.defineProperty(_i.prototype, "uv", {
                    get: function () {
                        return this._uv;
                    },
                    set: function (t) {
                        this._uv = t;
                    }
                }), ai.prototype.getTexture = function () {
                    return this._texture || (this._texture = this.context._targets, this._texture.uv = _i.flipyuv,
                        this._texture.bitmap = this._texture), this._texture;
                });
            }, e.enable = function () {
                return !0;
            }, e.inner_enable = function () {
                return Float32Array.prototype.slice || (Float32Array.prototype.slice = e._float32ArraySlice),
                    Uint16Array.prototype.slice || (Uint16Array.prototype.slice = e._uint16ArraySlice),
                    Uint8Array.prototype.slice || (Uint8Array.prototype.slice = e._uint8ArraySlice),
                    At.isConchApp && e._nativeRender_enable(), !0;
            }, e.onStageResize = function (t, i) {
                null != e.mainContext && (e.mainContext.viewport(0, 0, t, i), ft.width = t, ft.height = i);
            }, e.mainContext = null, e.shaderHighPrecision = !1, e._isWebGL2 = !1, e.isNativeRender_enable = !1,
                e;
        }(), xt = function () {
            function t() {
                this._obj = null, this._obj = t.supportWeakMap ? new Ot.window.WeakMap() : {}, t.supportWeakMap || t._maps.push(this);
            }
            r(t, "laya.utils.WeakObject");
            var e = t.prototype;
            return e.set = function (e, i) {
                if (null != e) if (t.supportWeakMap) {
                    var n = e;
                    "string" != typeof e && "number" != typeof e || (n = t._keys[e]) || (n = t._keys[e] = {
                        k: e
                    }), this._obj.set(n, i);
                } else "string" == typeof e || "number" == typeof e ? this._obj[e] = i : (e.$_GID || (e.$_GID = ie.getGID()),
                    this._obj[e.$_GID] = i);
            }, e.get = function (e) {
                if (null == e) return null;
                if (t.supportWeakMap) {
                    var i = "string" == typeof e || "number" == typeof e ? t._keys[e] : e;
                    return i ? this._obj.get(i) : null;
                }
                return "string" == typeof e || "number" == typeof e ? this._obj[e] : this._obj[e.$_GID];
            }, e.del = function (e) {
                if (null != e) if (t.supportWeakMap) {
                    var i = "string" == typeof e || "number" == typeof e ? t._keys[e] : e;
                    if (!i) return;
                    this._obj.delete(i);
                } else "string" == typeof e || "number" == typeof e ? delete this._obj[e] : delete this._obj[this._obj.$_GID];
            }, e.has = function (e) {
                if (null == e) return !1;
                if (t.supportWeakMap) {
                    var i = "string" == typeof e || "number" == typeof e ? t._keys[e] : e;
                    return this._obj.has(i);
                }
                return "string" == typeof e || "number" == typeof e ? null != this._obj[e] : null != this._obj[this._obj.$_GID];
            }, t.__init__ = function () {
                t.supportWeakMap = null != Ot.window.WeakMap, t.supportWeakMap || i.systemTimer.loop(t.delInterval, null, t.clearCache);
            }, t.clearCache = function () {
                for (var e = 0, i = t._maps.length; e < i; e++) {
                    t._maps[e]._obj = {};
                }
            }, t.supportWeakMap = !1, t.delInterval = 6e5, t._keys = {}, t._maps = [], n(t, ["I", function () {
                return this.I = new t();
            }]), t;
        }(), bt = function () {
            function t() { }
            r(t, "laya.display.css.BoundsStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.bounds && this.bounds.recover(), this.userBounds && this.userBounds.recover(),
                    this.bounds = null, this.userBounds = null, this.temBM = null, this;
            }, e.recover = function () {
                V.recover("BoundsStyle", this.reset());
            }, t.create = function () {
                return V.getItemByClass("BoundsStyle", t);
            }, t;
        }(), It = function () {
            function t(t) {
                this._color = null, this.setValue(t);
            }
            r(t, "laya.webgl.canvas.DrawStyle");
            var e = t.prototype;
            return e.setValue = function (t) {
                this._color = t ? t instanceof laya.utils.ColorUtils ? t : o.create(t) : o.create("#000000");
            }, e.reset = function () {
                this._color = o.create("#000000");
            }, e.toInt = function () {
                return this._color.numColor;
            }, e.equal = function (t) {
                return "string" == typeof t ? this._color.strColor === t : t instanceof laya.utils.ColorUtils && this._color.numColor === t.numColor;
            }, e.toColorStr = function () {
                return this._color.strColor;
            }, t.create = function (e) {
                if (e) {
                    var i = e instanceof laya.utils.ColorUtils ? e : o.create(e);
                    return i._drawStyle || (i._drawStyle = new t(e));
                }
                return t.DEFAULT;
            }, n(t, ["DEFAULT", function () {
                return this.DEFAULT = new t("#000000");
            }]), t;
        }(), wt = function () {
            function t() { }
            return r(t, "laya.system.System"), t.changeDefinition = function (t, e) {
                i[t] = e;
                var n = t + "=classObj";
                i._runScript(n);
            }, t.__init__ = function () { }, t;
        }(), At = (function () {
            function t() { }
            r(t, "laya.display.cmd.DrawParticleCmd");
            var e = t.prototype;
            e.recover = function () {
                this._templ = null, V.recover("DrawParticleCmd", this);
            }, e.run = function (t, e, i) {
                t.drawParticle(e, i, this._templ);
            }, a(0, e, "cmdID", function () {
                return "DrawParticleCmd";
            }), t.create = function (e) {
                var i = V.getItemByClass("DrawParticleCmd", t);
                return i._templ = e, i;
            }, t.ID = "DrawParticleCmd";
        }(), function () {
            function e(t, n) {
                this._timeId = 0, e._mainCanvas.source.id = "layaCanvas", e._mainCanvas.source.width = t,
                    e._mainCanvas.source.height = n, laya.renders.Render.isConchApp ? Ot.document.body.appendChild(e._mainCanvas.source) : Ot.onKGMiniGame || Ot.container.appendChild(e._mainCanvas.source),
                    this.initRender(e._mainCanvas, t, n), Ot.window.requestAnimationFrame(function t(e) {
                        i.stage._loop(), Ot.window.requestAnimationFrame(t);
                    }), i.stage.on("visibilitychange", this, this._onVisibilitychange);
            }
            r(e, "laya.renders.Render");
            var n = e.prototype;
            return n._onVisibilitychange = function () {
                i.stage.isVisibility ? 0 != this._timeId && Ot.window.clearInterval(this._timeId) : this._timeId = Ot.window.setInterval(this._enterFrame, 1e3);
            }, n.initRender = function (t, e, i) {
                var n = Dt.instance = Ct.mainContext = function (t) {
                    var e, i = ["webgl2", "webgl", "experimental-webgl", "webkit-3d", "moz-webgl"];
                    ae.useWebGL2 || i.shift();
                    for (var n = 0; n < i.length; n++) {
                        try {
                            e = t.getContext(i[n], {
                                stencil: ae.isStencil,
                                alpha: ae.isAlpha,
                                antialias: ae.isAntialias,
                                premultipliedAlpha: ae.premultipliedAlpha,
                                preserveDrawingBuffer: ae.preserveDrawingBuffer
                            });
                        } catch (t) { }
                        if (e) return "webgl2" === i[n] && (Ct._isWebGL2 = !0), new Dt(), e;
                    }
                    return null;
                }(laya.renders.Render._mainCanvas.source);
                if (!n) return !1;
                t.size(e, i), nt.__init__(n), ut.__init__(), h.__init__();
                var r = new ut();
                r.isMain = !0, laya.renders.Render._context = r, t._setContext(r), Ct.shaderHighPrecision = !1;
                try {
                    n.getShaderPrecisionFormat(35632, 36338).precision ? Ct.shaderHighPrecision = !0 : Ct.shaderHighPrecision = !1;
                } catch (t) { }
                return Dt.instance = n, wt.__init__(), Re.__init__(), H.__init__(), N.__init__(),
                    Le.__int__(n), de._init_(n), !0;
            }, n._enterFrame = function (t) {
                i.stage._loop();
            }, a(1, e, "context", function () {
                return e._context;
            }), a(1, e, "canvas", function () {
                return e._mainCanvas.source;
            }), e._context = null, e._mainCanvas = null, e.supportWebGLPlusCulling = !1, e.supportWebGLPlusAnimation = !1,
                e.supportWebGLPlusRendering = !1, e.isConchApp = !1, e.is3DMode = !1, e.__init$ = function () {
                    e.isConchApp = null != t.conch, e.isConchApp && (e.supportWebGLPlusCulling = !0,
                        e.supportWebGLPlusAnimation = !0, e.supportWebGLPlusRendering = !0);
                }, e;
        }()), Rt = function () {
            function t() { }
            return r(t, "laya.utils.ClassUtils"), t.regClass = function (e, i) {
                t._classMap[e] = i;
            }, t.regShortClassName = function (e) {
                for (var i = 0; i < e.length; i++) {
                    var n = e[i], r = n.name;
                    t._classMap[r] = n;
                }
            }, t.getRegClass = function (e) {
                return t._classMap[e];
            }, t.getClass = function (e) {
                var n = t._classMap[e] || e;
                return "string" == typeof n ? i.__classmap[n] || i[e] : n;
            }, t.getInstance = function (e) {
                var i = t.getClass(e);
                return i ? new i() : (console.warn("[error] Undefined class:", e), null);
            }, t.createByJson = function (e, i, n, r, a) {
                "string" == typeof e && (e = JSON.parse(e));
                var s = e.props;
                if (!i && !(i = a ? a.runWith(e) : t.getInstance(s.runtime || e.type))) return null;
                var o = e.child;
                if (o) for (var l = 0, h = o.length; l < h; l++) {
                    var u = o[l];
                    if ("render" !== u.props.name && "render" !== u.props.renderType || !i._$set_itemRender) if ("Graphic" == u.type) t._addGraphicsToSprite(u, i); else if (t._isDrawType(u.type)) t._addGraphicToSprite(u, i, !0); else {
                        var c = t.createByJson(u, null, n, r, a);
                        "Script" === u.type ? c.hasOwnProperty("owner") ? c.owner = i : c.hasOwnProperty("target") && (c.target = i) : "mask" == u.props.renderType ? i.mask = c : i.addChild(c);
                    } else i.itemRender = u;
                }
                if (s) for (var d in s) {
                    var _ = s[d];
                    "var" === d && n ? n[_] = i : _ instanceof Array && "function" == typeof i[d] ? i[d].apply(i, _) : i[d] = _;
                }
                return r && e.customProps && r.runWith([i, e]), i.created && i.created(), i;
            }, t._addGraphicsToSprite = function (e, i) {
                var n = e.child;
                if (n && !(n.length < 1)) {
                    var r = t._getGraphicsFromSprite(e, i), a = 0, s = 0;
                    e.props && (a = t._getObjVar(e.props, "x", 0), s = t._getObjVar(e.props, "y", 0)),
                        0 != a && 0 != s && r.translate(a, s);
                    var o, l = 0;
                    for (o = n.length, l = 0; l < o; l++) t._addGraphicToGraphics(n[l], r);
                    0 != a && 0 != s && r.translate(-a, -s);
                }
            }, t._addGraphicToSprite = function (e, i, n) {
                void 0 === n && (n = !1);
                var r = n ? t._getGraphicsFromSprite(e, i) : i.graphics;
                t._addGraphicToGraphics(e, r);
            }, t._getGraphicsFromSprite = function (t, e) {
                if (!t || !t.props) return e.graphics;
                var i = t.props.renderType;
                if ("hit" === i || "unHit" === i) {
                    var n = e._style.hitArea || (e.hitArea = new ye());
                    n[i] || (n[i] = new Zt());
                    var r = n[i];
                }
                return r || (r = e.graphics), r;
            }, t._getTransformData = function (e) {
                var i;
                (e.hasOwnProperty("pivotX") || e.hasOwnProperty("pivotY")) && (i = i || new at()).translate(-t._getObjVar(e, "pivotX", 0), -t._getObjVar(e, "pivotY", 0));
                var n = t._getObjVar(e, "scaleX", 1), r = t._getObjVar(e, "scaleY", 1), a = t._getObjVar(e, "rotation", 0);
                t._getObjVar(e, "skewX", 0), t._getObjVar(e, "skewY", 0);
                return 1 == n && 1 == r && 0 == a || ((i = i || new at()).scale(n, r), i.rotate(.0174532922222222 * a)),
                    i;
            }, t._addGraphicToGraphics = function (e, i) {
                var n, r;
                if ((n = e.props) && (r = t.DrawTypeDic[e.type])) {
                    var a = i, s = t._getParams(n, r[1], r[2], r[3]), o = t._tM;
                    (o || 1 != t._alpha) && (a.save(), o && a.transform(o), 1 != t._alpha && a.alpha(t._alpha)),
                        a[r[0]].apply(a, s), (o || 1 != t._alpha) && a.restore();
                }
            }, t._adptLineData = function (t) {
                return t[2] = parseFloat(t[0]) + parseFloat(t[2]), t[3] = parseFloat(t[1]) + parseFloat(t[3]),
                    t;
            }, t._adptTextureData = function (t) {
                return t[0] = Oe.getRes(t[0]), t;
            }, t._adptLinesData = function (e) {
                return e[2] = t._getPointListByStr(e[2]), e;
            }, t._isDrawType = function (e) {
                return "Image" !== e && t.DrawTypeDic.hasOwnProperty(e);
            }, t._getParams = function (e, i, n, r) {
                void 0 === n && (n = 0);
                var a = t._temParam;
                a.length = i.length;
                var s, o, l = 0;
                for (s = i.length, l = 0; l < s; l++) a[l] = t._getObjVar(e, i[l][0], i[l][1]);
                return t._alpha = t._getObjVar(e, "alpha", 1), (o = t._getTransformData(e)) ? (n || (n = 0),
                    o.translate(a[n], a[n + 1]), a[n] = a[n + 1] = 0, t._tM = o) : t._tM = null, r && t[r] && (a = t[r](a)),
                    a;
            }, t._getPointListByStr = function (t) {
                var e, i = t.split(","), n = 0;
                for (e = i.length, n = 0; n < e; n++) i[n] = parseFloat(i[n]);
                return i;
            }, t._getObjVar = function (t, e, i) {
                return t.hasOwnProperty(e) ? t[e] : i;
            }, t._temParam = [], t._classMap = {
                Sprite: Ye,
                Scene: li,
                Text: ei,
                Animation: "laya.display.Animation",
                Skeleton: "laya.ani.bone.Skeleton",
                Particle2D: "laya.particle.Particle2D",
                div: "laya.html.dom.HTMLDivParser",
                p: "laya.html.dom.HTMLElement",
                img: "laya.html.dom.HTMLImageElement",
                span: "laya.html.dom.HTMLElement",
                br: "laya.html.dom.HTMLBrElement",
                style: "laya.html.dom.HTMLStyleElement",
                font: "laya.html.dom.HTMLElement",
                a: "laya.html.dom.HTMLElement",
                "#text": "laya.html.dom.HTMLElement",
                link: "laya.html.dom.HTMLLinkElement"
            }, t._tM = null, t._alpha = NaN, n(t, ["DrawTypeDic", function () {
                return this.DrawTypeDic = {
                    Rect: ["drawRect", [["x", 0], ["y", 0], ["width", 0], ["height", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Circle: ["drawCircle", [["x", 0], ["y", 0], ["radius", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Pie: ["drawPie", [["x", 0], ["y", 0], ["radius", 0], ["startAngle", 0], ["endAngle", 0], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]]],
                    Image: ["drawTexture", [["x", 0], ["y", 0], ["width", 0], ["height", 0]]],
                    Texture: ["drawTexture", [["skin", null], ["x", 0], ["y", 0], ["width", 0], ["height", 0]], 1, "_adptTextureData"],
                    FillTexture: ["fillTexture", [["skin", null], ["x", 0], ["y", 0], ["width", 0], ["height", 0], ["repeat", null]], 1, "_adptTextureData"],
                    FillText: ["fillText", [["text", ""], ["x", 0], ["y", 0], ["font", null], ["color", null], ["textAlign", null]], 1],
                    Line: ["drawLine", [["x", 0], ["y", 0], ["toX", 0], ["toY", 0], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLineData"],
                    Lines: ["drawLines", [["x", 0], ["y", 0], ["points", ""], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLinesData"],
                    Curves: ["drawCurves", [["x", 0], ["y", 0], ["points", ""], ["lineColor", null], ["lineWidth", 0]], 0, "_adptLinesData"],
                    Poly: ["drawPoly", [["x", 0], ["y", 0], ["points", ""], ["fillColor", null], ["lineColor", null], ["lineWidth", 1]], 0, "_adptLinesData"]
                };
            }]), t;
        }(), Mt = function () {
            function t() {
                this._cacheBoundsType = !1;
            }
            r(t, "laya.display.GraphicsBounds");
            var e = t.prototype;
            return e.destroy = function () {
                this._graphics = null, this._cacheBoundsType = !1, this._temp && (this._temp.length = 0),
                    this._rstBoundPoints && (this._rstBoundPoints.length = 0), this._bounds && this._bounds.recover(),
                    this._bounds = null, V.recover("GraphicsBounds", this);
            }, e.reset = function () {
                this._temp && (this._temp.length = 0);
            }, e.getBounds = function (t) {
                return void 0 === t && (t = !1), (!this._bounds || !this._temp || this._temp.length < 1 || t != this._cacheBoundsType) && (this._bounds = mt._getWrapRec(this.getBoundPoints(t), this._bounds)),
                    this._cacheBoundsType = t, this._bounds;
            }, e.getBoundPoints = function (t) {
                return void 0 === t && (t = !1), (!this._temp || this._temp.length < 1 || t != this._cacheBoundsType) && (this._temp = this._getCmdPoints(t)),
                    this._cacheBoundsType = t, this._rstBoundPoints = ie.copyArray(this._rstBoundPoints, this._temp);
            }, e._getCmdPoints = function (e) {
                void 0 === e && (e = !1);
                At._context;
                var i, n = this._graphics.cmds;
                if ((i = this._temp || (this._temp = [])).length = 0, n || null == this._graphics._one || (t._tempCmds.length = 0,
                    t._tempCmds.push(this._graphics._one), n = t._tempCmds), !n) return i;
                var r = t._tempMatrixArrays;
                r.length = 0;
                var a = t._initMatrix;
                a.identity();
                for (var s, o, l = t._tempMatrix, h = 0, u = n.length; h < u; h++) switch ((s = n[h]).cmdID) {
                    case "Alpha":
                        r.push(a), a = a.clone();
                        break;

                    case "Restore":
                        a = r.pop();
                        break;

                    case "Scale":
                        l.identity(), l.translate(-s.pivotX, -s.pivotY), l.scale(s.scaleX, s.scaleY), l.translate(s.pivotX, s.pivotY),
                            this._switchMatrix(a, l);
                        break;

                    case "Rotate":
                        l.identity(), l.translate(-s.pivotX, -s.pivotY), l.rotate(s.angle), l.translate(s.pivotX, s.pivotY),
                            this._switchMatrix(a, l);
                        break;

                    case "Translate":
                        l.identity(), l.translate(s.tx, s.ty), this._switchMatrix(a, l);
                        break;

                    case "Transform":
                        l.identity(), l.translate(-s.pivotX, -s.pivotY), l.concat(s.matrix), l.translate(s.pivotX, s.pivotY),
                            this._switchMatrix(a, l);
                        break;

                    case "DrawImage":
                    case "FillTexture":
                        t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), a);
                        break;

                    case "DrawTexture":
                        a.copyTo(l), s.matrix && l.concat(s.matrix), t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), l);
                        break;

                    case "DrawImage":
                        if (o = s.texture, e) s.width && s.height ? t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), a) : t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, o.width, o.height), a); else {
                            var c = (s.width || o.sourceWidth) / o.width, d = (s.height || o.sourceHeight) / o.height, _ = c * o.sourceWidth, f = d * o.sourceHeight, p = o.offsetX > 0 ? o.offsetX : 0, m = o.offsetY > 0 ? o.offsetY : 0;
                            p *= c, m *= d, t._addPointArrToRst(i, mt._getBoundPointS(s.x - p, s.y - m, _, f), a);
                        }
                        break;

                    case "FillTexture":
                        s.width && s.height ? t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), a) : (o = s.texture,
                            t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, o.width, o.height), a));
                        break;

                    case "DrawTexture":
                        var g;
                        s.matrix ? (a.copyTo(l), l.concat(s.matrix), g = l) : g = a, e ? s.width && s.height ? t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), g) : (o = s.texture,
                            t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, o.width, o.height), g)) : (o = s.texture,
                                c = (s.width || o.sourceWidth) / o.width, d = (s.height || o.sourceHeight) / o.height,
                                _ = c * o.sourceWidth, f = d * o.sourceHeight, p = o.offsetX > 0 ? o.offsetX : 0,
                                m = o.offsetY > 0 ? o.offsetY : 0, p *= c, m *= d, t._addPointArrToRst(i, mt._getBoundPointS(s.x - p, s.y - m, _, f), g));
                        break;

                    case "DrawRect":
                        t._addPointArrToRst(i, mt._getBoundPointS(s.x, s.y, s.width, s.height), a);
                        break;

                    case "DrawCircle":
                        t._addPointArrToRst(i, mt._getBoundPointS(s.x - s.radius, s.y - s.radius, s.radius + s.radius, s.radius + s.radius), a);
                        break;

                    case "DrawLine":
                        t._tempPoints.length = 0;
                        var y;
                        y = .5 * s.lineWidth, s.fromX == s.toX ? t._tempPoints.push(s.fromX + y, s.fromY, s.toX + y, s.toY, s.fromX - y, s.fromY, s.toX - y, s.toY) : s.fromY == s.toY ? t._tempPoints.push(s.fromX, s.fromY + y, s.toX, s.toY + y, s.fromX, s.fromY - y, s.toX, s.toY - y) : t._tempPoints.push(s.fromX, s.fromY, s.toX, s.toY),
                            t._addPointArrToRst(i, t._tempPoints, a);
                        break;

                    case "DrawCurves":
                        t._addPointArrToRst(i, Bt.I.getBezierPoints(s.points), a, s.x, s.y);
                        break;

                    case "DrawLines":
                    case "DrawPoly":
                        t._addPointArrToRst(i, s.points, a, s.x, s.y);
                        break;

                    case "DrawPath":
                        t._addPointArrToRst(i, this._getPathPoints(s.paths), a, s.x, s.y);
                        break;

                    case "DrawPie":
                        t._addPointArrToRst(i, this._getPiePoints(s.x, s.y, s.radius, s.startAngle, s.endAngle), a);
                }
                return i.length > 200 ? i = ie.copyArray(i, mt._getWrapRec(i)._getBoundPoints()) : i.length > 8 && (i = j.scanPList(i)),
                    i;
            }, e._switchMatrix = function (t, e) {
                e.concat(t), e.copyTo(t);
            }, e._getPiePoints = function (e, i, n, r, a) {
                var s = t._tempPoints;
                t._tempPoints.length = 0;
                var o = Math.PI / 180, l = a - r;
                if (l >= 360 || l <= -360) return s.push(e - n, i - n), s.push(e + n, i - n), s.push(e + n, i + n),
                    s.push(e - n, i + n), s;
                s.push(e, i);
                var h = l % 360;
                h < 0 && (h += 360);
                var u = r + h, c = r * o, d = u * o;
                s.push(e + n * Math.cos(c), i + n * Math.sin(c)), s.push(e + n * Math.cos(d), i + n * Math.sin(d));
                for (var _ = 90 * Math.ceil(r / 90), f = 90 * Math.floor(u / 90), p = _; p <= f; p += 90) {
                    var m = p * o;
                    s.push(e + n * Math.cos(m), i + n * Math.sin(m));
                }
                return s;
            }, e._getPathPoints = function (e) {
                var i, n, r = 0, a = t._tempPoints;
                for (a.length = 0, i = e.length, r = 0; r < i; r++) (n = e[r]).length > 1 && (a.push(n[1], n[2]),
                    n.length > 3 && a.push(n[3], n[4]));
                return a;
            }, t.create = function () {
                return V.getItemByClass("GraphicsBounds", t);
            }, t._addPointArrToRst = function (e, i, n, r, a) {
                void 0 === r && (r = 0), void 0 === a && (a = 0);
                var s, o = 0;
                for (s = i.length, o = 0; o < s; o += 2) t._addPointToRst(e, i[o] + r, i[o + 1] + a, n);
            }, t._addPointToRst = function (t, e, i, n) {
                var r = jt.TEMP;
                r.setTo(e || 0, i || 0), n.transformPoint(r), t.push(r.x, r.y);
            }, t._tempPoints = [], t._tempMatrixArrays = [], t._tempCmds = [], n(t, ["_tempMatrix", function () {
                return this._tempMatrix = new at();
            }, "_initMatrix", function () {
                return this._initMatrix = new at();
            }]), t;
        }(), Dt = function () {
            function t() { }
            r(t, "laya.layagl.LayaGL");
            var e = t.prototype;
            return e.createCommandEncoder = function (t, e, i) {
                return void 0 === t && (t = 128), void 0 === e && (e = 64), void 0 === i && (i = !1),
                    new Pt(this, t, e, i);
            }, e.beginCommandEncoding = function (t) { }, e.endCommandEncoding = function () { },
                e.matrix4x4Multiply = function (t, e, i) { }, e.evaluateClipDatasRealTime = function (t, e, i, n) { },
                t.getFrameCount = function () {
                    return 0;
                }, t.syncBufferToRenderThread = function (t, e) {
                    void 0 === e && (e = 0);
                }, t.createArrayBufferRef = function (t, e, i) { }, t.createArrayBufferRefs = function (t, e, i, n) { },
                t.EXECUTE_JS_THREAD_BUFFER = 0, t.EXECUTE_RENDER_THREAD_BUFFER = 1, t.EXECUTE_COPY_TO_RENDER = 2,
                t.EXECUTE_COPY_TO_RENDER3D = 3, t.ARRAY_BUFFER_TYPE_DATA = 0, t.ARRAY_BUFFER_TYPE_CMD = 1,
                t.ARRAY_BUFFER_REF_REFERENCE = 0, t.ARRAY_BUFFER_REF_COPY = 1, t.UPLOAD_SHADER_UNIFORM_TYPE_ID = 0,
                t.UPLOAD_SHADER_UNIFORM_TYPE_DATA = 1, t.instance = null, t;
        }(), Ot = function () {
            function e() { }
            return r(e, "laya.utils.Browser"), a(1, e, "pixelRatio", function () {
                if (e._pixelRatio < 0) if (e.__init__(), e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)") > -1) e._pixelRatio = 2; else {
                    var t = e.context, i = t.backingStorePixelRatio || t.webkitBackingStorePixelRatio || t.mozBackingStorePixelRatio || t.msBackingStorePixelRatio || t.oBackingStorePixelRatio || t.backingStorePixelRatio || 1;
                    e._pixelRatio = (e._window.devicePixelRatio || 1) / i, e._pixelRatio < 1 && (e._pixelRatio = 1);
                }
                return e._pixelRatio;
            }), a(1, e, "height", function () {
                return e.__init__(), (i.stage && i.stage.canvasRotation ? e.clientWidth : e.clientHeight) * e.pixelRatio;
            }), a(1, e, "clientWidth", function () {
                return e.__init__(), e._window.innerWidth || e._document.body.clientWidth;
            }), a(1, e, "window", function () {
                return e._window || e.__init__();
            }), a(1, e, "clientHeight", function () {
                return e.__init__(), e._window.innerHeight || e._document.body.clientHeight || e._document.documentElement.clientHeight;
            }), a(1, e, "width", function () {
                return e.__init__(), (i.stage && i.stage.canvasRotation ? e.clientHeight : e.clientWidth) * e.pixelRatio;
            }), a(1, e, "container", function () {
                return e._container || (e.__init__(), e._container = e.createElement("div"), e._container.id = "layaContainer",
                    e._document.body.appendChild(e._container)), e._container;
            }, function (t) {
                e._container = t;
            }), a(1, e, "document", function () {
                return e.__init__(), e._document;
            }), e.__init__ = function () {
                if (e._window) return e._window;
                var n = e._window = t, r = e._document = n.document, a = e.userAgent = n.navigator.userAgent, s = n._layalibs;
                if (s) {
                    s.sort(function (t, e) {
                        return t.i - e.i;
                    });
                    for (var o = 0; o < s.length; o++) s[o].f(n, r, i);
                }
                a.indexOf("MiniGame") > -1 && e.window.hasOwnProperty("wx") && (i.MiniAdpter ? i.MiniAdpter.enable() : console.log("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),
                    a.indexOf("SwanGame") > -1 && (i.BMiniAdapter ? i.BMiniAdapter.enable() : console.log("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),
                    "function" == typeof getApp && (i.KGMiniAdapter ? i.KGMiniAdapter.enable() : console.log("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),
                    a.indexOf("OPPO") > -1 && a.indexOf("MiniGame") > -1 && (i.QGMiniAdapter ? i.QGMiniAdapter.enable() : console.log("请先添加OPPO小游戏适配库")),
                    n.trace = console.log, n.requestAnimationFrame = n.requestAnimationFrame || n.webkitRequestAnimationFrame || n.mozRequestAnimationFrame || n.oRequestAnimationFrame || n.msRequestAnimationFrame || function (t) {
                        return n.setTimeout(t, 1e3 / 60);
                    };
                var l = r.body.style;
                l.margin = 0, l.overflow = "hidden", l["-webkit-user-select"] = "none", l["-webkit-tap-highlight-color"] = "rgba(200,200,200,0)";
                for (var h = r.getElementsByTagName("meta"), u = 0, c = !1, d = "width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"; u < h.length;) {
                    var _ = h[u];
                    if ("viewport" == _.name) {
                        _.content = d, c = !0;
                        break;
                    }
                    u++;
                }
                c || ((_ = r.createElement("meta")).name = "viewport", _.content = d, r.getElementsByTagName("head")[0].appendChild(_)),
                    e.onMobile = !!t.isConchApp || a.indexOf("Mobile") > -1, e.onIOS = !!a.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),
                    e.onIPhone = a.indexOf("iPhone") > -1, e.onMac = a.indexOf("Mac OS X") > -1, e.onIPad = a.indexOf("iPad") > -1,
                    e.onAndroid = a.indexOf("Android") > -1 || a.indexOf("Adr") > -1, e.onWP = a.indexOf("Windows Phone") > -1,
                    e.onQQBrowser = a.indexOf("QQBrowser") > -1, e.onMQQBrowser = a.indexOf("MQQBrowser") > -1 || a.indexOf("Mobile") > -1 && a.indexOf("QQ") > -1,
                    e.onIE = !!n.ActiveXObject || "ActiveXObject" in n, e.onWeiXin = a.indexOf("MicroMessenger") > -1,
                    e.onSafari = a.indexOf("Safari") > -1, e.onPC = !e.onMobile, e.onMiniGame = a.indexOf("MiniGame") > -1,
                    e.onBDMiniGame = a.indexOf("SwanGame") > -1, a.indexOf("OPPO") > -1 && a.indexOf("MiniGame") > -1 && (e.onQGMiniGame = !0,
                        e.onMiniGame = !1), e.onLimixiu = a.indexOf("limixiu") > -1, e.onKGMiniGame = a.indexOf("QuickGame") > -1,
                    e.supportLocalStorage = Et.__init__(), e.supportWebAudio = ve.__init__(), At._mainCanvas = new ai(!0);
                var f = At._mainCanvas.source.style;
                f.position = "absolute", f.top = f.left = "0px", f.background = "#000000", e.canvas = new ai(!0),
                    e.context = e.canvas.getContext("2d");
                var p = new ai(!0);
                laya.utils.Browser.onQGMiniGame && (p = At._mainCanvas);
                var m = ["webgl", "experimental-webgl", "webkit-3d", "moz-webgl"], g = null;
                for (u = 0; u < m.length; u++) {
                    try {
                        g = p.source.getContext(m[u]);
                    } catch (t) { }
                    if (g) {
                        e._supportWebGL = !0;
                        break;
                    }
                }
                return n;
            }, e.createElement = function (t) {
                return e.__init__(), e._document.createElement(t);
            }, e.getElementById = function (t) {
                return e.__init__(), e._document.getElementById(t);
            }, e.removeElement = function (t) {
                t && t.parentNode && t.parentNode.removeChild(t);
            }, e.now = function () {
                return Date.now();
            }, e.userAgent = null, e.onMobile = !1, e.onIOS = !1, e.onMac = !1, e.onIPhone = !1,
                e.onIPad = !1, e.onAndroid = !1, e.onWP = !1, e.onQQBrowser = !1, e.onMQQBrowser = !1,
                e.onSafari = !1, e.onIE = !1, e.onWeiXin = !1, e.onPC = !1, e.onMiniGame = !1, e.onBDMiniGame = !1,
                e.onKGMiniGame = !1, e.onQGMiniGame = !1, e.onLimixiu = !1, e.onFirefox = !1, e.onEdge = !1,
                e.supportWebAudio = !1, e.supportLocalStorage = !1, e.canvas = null, e.context = null,
                e._window = null, e._document = null, e._container = null, e._pixelRatio = -1, e._supportWebGL = !1,
                e;
        }(), Lt = function () {
            function t() {
                this._matrix = new at();
            }
            r(t, "laya.webgl.canvas.save.SaveTransform");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.canvas.save.ISaveData": !0
            }), e.isSaveMark = function () {
                return !1;
            }, e.restore = function (e) {
                e._curMat = this._savematrix, t.POOL[t.POOL._length++] = this;
            }, t.save = function (e) {
                var i = e._saveMark;
                if (2048 != (2048 & i._saveuse)) {
                    i._saveuse |= 2048;
                    var n = t.POOL, r = n._length > 0 ? n[--n._length] : new t();
                    r._savematrix = e._curMat, e._curMat = e._curMat.copyTo(r._matrix);
                    var a = e._save;
                    a[a._length++] = r;
                }
            }, t.POOL = l._createArray(), t;
        }(), Pt = function () {
            function t(t, e, i, n) {
                this._idata = [];
            }
            r(t, "laya.layagl.CommandEncoder");
            var e = t.prototype;
            return e.getArrayData = function () {
                return this._idata;
            }, e.getPtrID = function () {
                return 0;
            }, e.beginEncoding = function () { }, e.endEncoding = function () { }, e.clearEncoding = function () {
                this._idata.length = 0;
            }, e.getCount = function () {
                return this._idata.length;
            }, e.add_ShaderValue = function (t) {
                this._idata.push(t);
            }, e.addShaderUniform = function (t) {
                this.add_ShaderValue(t);
            }, t;
        }(), Nt = function () {
            function t() { }
            r(t, "laya.display.cmd.FillBorderTextCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("FillBorderTextCmd", this);
            }, e.run = function (t, e, i) {
                t.fillBorderText(this.text, this.x + e, this.y + i, this.font, this.fillColor, this.borderColor, this.lineWidth, this.textAlign);
            }, a(0, e, "cmdID", function () {
                return "FillBorderText";
            }), t.create = function (e, i, n, r, a, s, o, l) {
                var h = V.getItemByClass("FillBorderTextCmd", t);
                return h.text = e, h.x = i, h.y = n, h.font = r, h.fillColor = a, h.borderColor = s,
                    h.lineWidth = o, h.textAlign = l, h;
            }, t.ID = "FillBorderText", t;
        }(), Bt = function () {
            function t() {
                this._controlPoints = [new jt(), new jt(), new jt()], this._calFun = this.getPoint2;
            }
            r(t, "laya.maths.Bezier");
            var e = t.prototype;
            return e._switchPoint = function (t, e) {
                var i = this._controlPoints.shift();
                i.setTo(t, e), this._controlPoints.push(i);
            }, e.getPoint2 = function (t, e) {
                var i = this._controlPoints[0], n = this._controlPoints[1], r = this._controlPoints[2], a = Math.pow(1 - t, 2) * i.x + 2 * t * (1 - t) * n.x + Math.pow(t, 2) * r.x, s = Math.pow(1 - t, 2) * i.y + 2 * t * (1 - t) * n.y + Math.pow(t, 2) * r.y;
                e.push(a, s);
            }, e.getPoint3 = function (t, e) {
                var i = this._controlPoints[0], n = this._controlPoints[1], r = this._controlPoints[2], a = this._controlPoints[3], s = Math.pow(1 - t, 3) * i.x + 3 * n.x * t * (1 - t) * (1 - t) + 3 * r.x * t * t * (1 - t) + a.x * Math.pow(t, 3), o = Math.pow(1 - t, 3) * i.y + 3 * n.y * t * (1 - t) * (1 - t) + 3 * r.y * t * t * (1 - t) + a.y * Math.pow(t, 3);
                e.push(s, o);
            }, e.insertPoints = function (t, e) {
                var i, n = NaN;
                for (i = 1 / (t = t > 0 ? t : 5), n = 0; n <= 1; n += i) this._calFun(n, e);
            }, e.getBezierPoints = function (t, e, i) {
                void 0 === e && (e = 5), void 0 === i && (i = 2);
                var n, r = 0;
                if ((n = t.length) < 2 * (i + 1)) return [];
                var a = [];
                switch (i) {
                    case 2:
                        this._calFun = this.getPoint2;
                        break;

                    case 3:
                        this._calFun = this.getPoint3;
                        break;

                    default:
                        return [];
                }
                for (; this._controlPoints.length <= i;) this._controlPoints.push(jt.create());
                for (r = 0; r < 2 * i; r += 2) this._switchPoint(t[r], t[r + 1]);
                for (r = 2 * i; r < n; r += 2) this._switchPoint(t[r], t[r + 1]), r / 2 % i == 0 && this.insertPoints(e, a);
                return a;
            }, n(t, ["I", function () {
                return this.I = new t();
            }]), t;
        }(), Ft = function () {
            function t() { }
            r(t, "laya.display.cmd.Draw9GridTexture");
            var e = t.prototype;
            return e.recover = function () {
                this.texture._removeReference(), V.recover("Draw9GridTexture", this);
            }, e.run = function (t, e, i) {
                t.drawTextureWithSizeGrid(this.texture, this.x, this.y, this.width, this.height, this.sizeGrid, e, i);
            }, a(0, e, "cmdID", function () {
                return "Draw9GridTexture";
            }), t.create = function (e, i, n, r, a, s) {
                var o = V.getItemByClass("Draw9GridTexture", t);
                return o.texture = e, e._addReference(), o.x = i, o.y = n, o.width = r, o.height = a,
                    o.sizeGrid = s, o;
            }, t.ID = "Draw9GridTexture", t;
        }(), kt = function () {
            function t() {
                this.texWidth = 1024, this.texHeight = 1024, this.atlasgrid = null, this.protectDist = 1,
                    this.texture = null, this.charMaps = {}, this.texHeight = this.texWidth = x.atlasWidth,
                    this.texture = Ze.getTextTexture(this.texWidth, this.texHeight), this.texWidth / t.atlasGridW > 256 && (t.atlasGridW = Math.ceil(this.texWidth / 256)),
                    this.atlasgrid = new Qt(this.texWidth / t.atlasGridW, this.texHeight / t.atlasGridW, this.texture.id);
            }
            r(t, "laya.webgl.text.TextAtlas");
            var e = t.prototype;
            return e.setProtecteDist = function (t) {
                this.protectDist = t;
            }, e.getAEmpty = function (e, i, n) {
                var r = this.atlasgrid.addRect(1, Math.ceil(e / t.atlasGridW), Math.ceil(i / t.atlasGridW), n);
                return r && (n.x *= t.atlasGridW, n.y *= t.atlasGridW), r;
            }, e.destroy = function () {
                for (var t in this.charMaps) {
                    this.charMaps[t].deleted = !0;
                }
                this.texture.discard();
            }, e.printDebugInfo = function () { }, a(0, e, "usedRate", function () {
                return this.atlasgrid._used;
            }), t.atlasGridW = 16, t;
        }(), Vt = function () {
            function t() {
                this._strsToID = {}, this._idToStrs = [], this._length = 0;
            }
            r(t, "laya.utils.StringKey");
            var e = t.prototype;
            return e.add = function (t) {
                var e = this._strsToID[t];
                return null != e ? e : (this._idToStrs[this._length] = t, this._strsToID[t] = this._length++);
            }, e.getID = function (t) {
                var e = this._strsToID[t];
                return null == e ? -1 : e;
            }, e.getName = function (t) {
                var e = this._idToStrs[t];
                return null == e ? void 0 : e;
            }, t;
        }(), Ut = function () {
            function t() {
                this.ratio = .92, this.maxOffset = 60, this._dragging = !1, this._clickOnly = !0;
            }
            r(t, "laya.utils.Dragging");
            var e = t.prototype;
            return e.start = function (t, e, n, r, a, s, o, l) {
                void 0 === l && (l = .92), this.clearTimer(), this.target = t, this.area = e, this.hasInertia = n,
                    this.elasticDistance = e ? r : 0, this.elasticBackTime = a, this.data = s, this._disableMouseEvent = o,
                    this.ratio = l, this._parent = t.parent, this._clickOnly = !0, this._dragging = !0,
                    this._elasticRateX = this._elasticRateY = 1, this._lastX = this._parent.mouseX,
                    this._lastY = this._parent.mouseY, i.stage.on("mouseup", this, this.onStageMouseUp),
                    i.stage.on("mouseout", this, this.onStageMouseUp), i.systemTimer.frameLoop(1, this, this.loop);
            }, e.clearTimer = function () {
                i.systemTimer.clear(this, this.loop), i.systemTimer.clear(this, this.tweenMove),
                    this._tween && (this._tween.recover(), this._tween = null);
            }, e.stop = function () {
                this._dragging && (w.instance.disableMouseEvent = !1, i.stage.off("mouseup", this, this.onStageMouseUp),
                    i.stage.off("mouseout", this, this.onStageMouseUp), this._dragging = !1, this.target && this.area && this.backToArea(),
                    this.clear());
            }, e.loop = function () {
                var t = this._parent.getMousePoint(), e = t.x, n = t.y, r = e - this._lastX, a = n - this._lastY;
                if (this._clickOnly) {
                    if (!(Math.abs(r * i.stage._canvasTransform.getScaleX()) > 1 || Math.abs(a * i.stage._canvasTransform.getScaleY()) > 1)) return;
                    this._clickOnly = !1, this._offsets || (this._offsets = []), this._offsets.length = 0,
                        this.target.event("dragstart", this.data), w.instance.disableMouseEvent = this._disableMouseEvent;
                } else this._offsets.push(r, a);
                0 === r && 0 === a || (this._lastX = e, this._lastY = n, this.target.x += r * this._elasticRateX,
                    this.target.y += a * this._elasticRateY, this.area && this.checkArea(), this.target.event("dragmove", this.data));
            }, e.checkArea = function () {
                if (this.elasticDistance <= 0) this.backToArea(); else {
                    if (this.target._x < this.area.x) var t = this.area.x - this.target._x; else t = this.target._x > this.area.x + this.area.width ? this.target._x - this.area.x - this.area.width : 0;
                    if (this._elasticRateX = Math.max(0, 1 - t / this.elasticDistance), this.target._y < this.area.y) var e = this.area.y - this.target.y; else e = this.target._y > this.area.y + this.area.height ? this.target._y - this.area.y - this.area.height : 0;
                    this._elasticRateY = Math.max(0, 1 - e / this.elasticDistance);
                }
            }, e.backToArea = function () {
                this.target.x = Math.min(Math.max(this.target._x, this.area.x), this.area.x + this.area.width),
                    this.target.y = Math.min(Math.max(this.target._y, this.area.y), this.area.y + this.area.height);
            }, e.onStageMouseUp = function (t) {
                if (w.instance.disableMouseEvent = !1, i.stage.off("mouseup", this, this.onStageMouseUp),
                    i.stage.off("mouseout", this, this.onStageMouseUp), i.systemTimer.clear(this, this.loop),
                    !this._clickOnly && this.target) if (this.hasInertia) {
                        this._offsets.length < 1 && this._offsets.push(this._parent.mouseX - this._lastX, this._parent.mouseY - this._lastY),
                            this._offsetX = this._offsetY = 0;
                        for (var e = this._offsets.length, n = Math.min(e, 6), r = this._offsets.length - n, a = e - 1; a > r; a--) this._offsetY += this._offsets[a--],
                            this._offsetX += this._offsets[a];
                        this._offsetX = this._offsetX / n * 2, this._offsetY = this._offsetY / n * 2, Math.abs(this._offsetX) > this.maxOffset && (this._offsetX = this._offsetX > 0 ? this.maxOffset : -this.maxOffset),
                            Math.abs(this._offsetY) > this.maxOffset && (this._offsetY = this._offsetY > 0 ? this.maxOffset : -this.maxOffset),
                            i.systemTimer.frameLoop(1, this, this.tweenMove);
                    } else this.elasticDistance > 0 ? this.checkElastic() : this.clear();
            }, e.checkElastic = function () {
                var t = NaN, e = NaN;
                if (this.target.x < this.area.x ? t = this.area.x : this.target._x > this.area.x + this.area.width && (t = this.area.x + this.area.width),
                    this.target.y < this.area.y ? e = this.area.y : this.target._y > this.area.y + this.area.height && (e = this.area.y + this.area.height),
                    isNaN(t) && isNaN(e)) this.clear(); else {
                    var i = {};
                    isNaN(t) || (i.x = t), isNaN(e) || (i.y = e), this._tween = X.to(this.target, i, this.elasticBackTime, te.sineOut, g.create(this, this.clear), 0, !1, !1);
                }
            }, e.tweenMove = function () {
                this._offsetX *= this.ratio * this._elasticRateX, this._offsetY *= this.ratio * this._elasticRateY,
                    this.target.x += this._offsetX, this.target.y += this._offsetY, this.area && this.checkArea(),
                    this.target.event("dragmove", this.data), (Math.abs(this._offsetX) < 1 && Math.abs(this._offsetY) < 1 || this._elasticRateX < .5 || this._elasticRateY < .5) && (i.systemTimer.clear(this, this.tweenMove),
                        this.elasticDistance > 0 ? this.checkElastic() : this.clear());
            }, e.clear = function () {
                if (this.target) {
                    this.clearTimer();
                    var t = this.target;
                    this.target = null, this._parent = null, t.event("dragend", this.data);
                }
            }, t;
        }(), Gt = function () {
            function t() { }
            return r(t, "laya.webgl.shapes.Earcut"), t.earcut = function (e, i, n) {
                n = n || 2;
                var r, a, s, o, l, h, u, c = i && i.length, d = c ? i[0] * n : e.length, _ = t.linkedList(e, 0, d, n, !0), f = [];
                if (!_) return f;
                if (c && (_ = t.eliminateHoles(e, i, _, n)), e.length > 80 * n) {
                    r = s = e[0], a = o = e[1];
                    for (var p = n; p < d; p += n) (l = e[p]) < r && (r = l), (h = e[p + 1]) < a && (a = h),
                        l > s && (s = l), h > o && (o = h);
                    u = 0 !== (u = Math.max(s - r, o - a)) ? 1 / u : 0;
                }
                return t.earcutLinked(_, f, n, r, a, u), f;
            }, t.linkedList = function (e, i, n, r, a) {
                var s, o;
                if (a === t.signedArea(e, i, n, r) > 0) for (s = i; s < n; s += r) o = t.insertNode(s, e[s], e[s + 1], o); else for (s = n - r; s >= i; s -= r) o = t.insertNode(s, e[s], e[s + 1], o);
                return o && t.equals(o, o.next) && (t.removeNode(o), o = o.next), o;
            }, t.filterPoints = function (e, i) {
                if (!e) return e;
                i || (i = e);
                var n, r = e;
                do {
                    if (n = !1, r.steiner || !t.equals(r, r.next) && 0 !== t.area(r.prev, r, r.next)) r = r.next; else {
                        if (t.removeNode(r), (r = i = r.prev) === r.next) break;
                        n = !0;
                    }
                } while (n || r !== i);
                return i;
            }, t.earcutLinked = function (e, i, n, r, a, s, o) {
                if (e) {
                    !o && s && t.indexCurve(e, r, a, s);
                    for (var l, h, u = e; e.prev !== e.next;) if (l = e.prev, h = e.next, s ? t.isEarHashed(e, r, a, s) : t.isEar(e)) i.push(l.i / n),
                        i.push(e.i / n), i.push(h.i / n), t.removeNode(e), e = h.next, u = h.next; else if ((e = h) === u) {
                            o ? 1 === o ? (e = t.cureLocalIntersections(e, i, n), t.earcutLinked(e, i, n, r, a, s, 2)) : 2 === o && t.splitEarcut(e, i, n, r, a, s) : t.earcutLinked(t.filterPoints(e, null), i, n, r, a, s, 1);
                            break;
                        }
                }
            }, t.isEar = function (e) {
                var i = e.prev, n = e, r = e.next;
                if (t.area(i, n, r) >= 0) return !1;
                for (var a = e.next.next; a !== e.prev;) {
                    if (t.pointInTriangle(i.x, i.y, n.x, n.y, r.x, r.y, a.x, a.y) && t.area(a.prev, a, a.next) >= 0) return !1;
                    a = a.next;
                }
                return !0;
            }, t.isEarHashed = function (e, i, n, r) {
                var a = e.prev, s = e, o = e.next;
                if (t.area(a, s, o) >= 0) return !1;
                for (var l = a.x < s.x ? a.x < o.x ? a.x : o.x : s.x < o.x ? s.x : o.x, h = a.y < s.y ? a.y < o.y ? a.y : o.y : s.y < o.y ? s.y : o.y, u = a.x > s.x ? a.x > o.x ? a.x : o.x : s.x > o.x ? s.x : o.x, c = a.y > s.y ? a.y > o.y ? a.y : o.y : s.y > o.y ? s.y : o.y, d = t.zOrder(l, h, i, n, r), _ = t.zOrder(u, c, i, n, r), f = e.nextZ; f && f.z <= _;) {
                    if (f !== e.prev && f !== e.next && t.pointInTriangle(a.x, a.y, s.x, s.y, o.x, o.y, f.x, f.y) && t.area(f.prev, f, f.next) >= 0) return !1;
                    f = f.nextZ;
                }
                for (f = e.prevZ; f && f.z >= d;) {
                    if (f !== e.prev && f !== e.next && t.pointInTriangle(a.x, a.y, s.x, s.y, o.x, o.y, f.x, f.y) && t.area(f.prev, f, f.next) >= 0) return !1;
                    f = f.prevZ;
                }
                return !0;
            }, t.cureLocalIntersections = function (e, i, n) {
                var r = e;
                do {
                    var a = r.prev, s = r.next.next;
                    !t.equals(a, s) && t.intersects(a, r, r.next, s) && t.locallyInside(a, s) && t.locallyInside(s, a) && (i.push(a.i / n),
                        i.push(r.i / n), i.push(s.i / n), t.removeNode(r), t.removeNode(r.next), r = e = s),
                        r = r.next;
                } while (r !== e);
                return r;
            }, t.splitEarcut = function (e, i, n, r, a, s) {
                var o = e;
                do {
                    for (var l = o.next.next; l !== o.prev;) {
                        if (o.i !== l.i && t.isValidDiagonal(o, l)) {
                            var h = t.splitPolygon(o, l);
                            return o = t.filterPoints(o, o.next), h = t.filterPoints(h, h.next), t.earcutLinked(o, i, n, r, a, s),
                                void t.earcutLinked(h, i, n, r, a, s);
                        }
                        l = l.next;
                    }
                    o = o.next;
                } while (o !== e);
            }, t.eliminateHoles = function (e, i, n, r) {
                var a, s, o, l, h, u = [];
                for (a = 0, s = i.length; a < s; a++) o = i[a] * r, l = a < s - 1 ? i[a + 1] * r : e.length,
                    (h = t.linkedList(e, o, l, r, !1)) === h.next && (h.steiner = !0), u.push(t.getLeftmost(h));
                for (u.sort(t.compareX), a = 0; a < u.length; a++) t.eliminateHole(u[a], n), n = t.filterPoints(n, n.next);
                return n;
            }, t.compareX = function (t, e) {
                return t.x - e.x;
            }, t.eliminateHole = function (e, i) {
                if (i = t.findHoleBridge(e, i)) {
                    var n = t.splitPolygon(i, e);
                    t.filterPoints(n, n.next);
                }
            }, t.findHoleBridge = function (e, i) {
                var n, r = i, a = e.x, s = e.y, o = -1 / 0;
                do {
                    if (s <= r.y && s >= r.next.y && r.next.y !== r.y) {
                        var l = r.x + (s - r.y) * (r.next.x - r.x) / (r.next.y - r.y);
                        if (l <= a && l > o) {
                            if (o = l, l === a) {
                                if (s === r.y) return r;
                                if (s === r.next.y) return r.next;
                            }
                            n = r.x < r.next.x ? r : r.next;
                        }
                    }
                    r = r.next;
                } while (r !== i);
                if (!n) return null;
                if (a === o) return n.prev;
                var h, u = n, c = n.x, d = n.y, _ = 1 / 0;
                for (r = n.next; r !== u;) a >= r.x && r.x >= c && a !== r.x && t.pointInTriangle(s < d ? a : o, s, c, d, s < d ? o : a, s, r.x, r.y) && ((h = Math.abs(s - r.y) / (a - r.x)) < _ || h === _ && r.x > n.x) && t.locallyInside(r, e) && (n = r,
                    _ = h), r = r.next;
                return n;
            }, t.indexCurve = function (e, i, n, r) {
                var a = e;
                do {
                    null === a.z && (a.z = t.zOrder(a.x, a.y, i, n, r)), a.prevZ = a.prev, a.nextZ = a.next,
                        a = a.next;
                } while (a !== e);
                a.prevZ.nextZ = null, a.prevZ = null, t.sortLinked(a);
            }, t.sortLinked = function (t) {
                var e, i, n, r, a, s, o, l, h = 1;
                do {
                    for (i = t, t = null, a = null, s = 0; i;) {
                        for (s++, n = i, o = 0, e = 0; e < h && (o++, n = n.nextZ); e++);
                        for (l = h; o > 0 || l > 0 && n;) 0 !== o && (0 === l || !n || i.z <= n.z) ? (r = i,
                            i = i.nextZ, o--) : (r = n, n = n.nextZ, l--), a ? a.nextZ = r : t = r, r.prevZ = a,
                            a = r;
                        i = n;
                    }
                    a.nextZ = null, h *= 2;
                } while (s > 1);
                return t;
            }, t.zOrder = function (t, e, i, n, r) {
                return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) * r) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) * r) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
            }, t.getLeftmost = function (t) {
                var e = t, i = t;
                do {
                    e.x < i.x && (i = e), e = e.next;
                } while (e !== t);
                return i;
            }, t.pointInTriangle = function (t, e, i, n, r, a, s, o) {
                return (r - s) * (e - o) - (t - s) * (a - o) >= 0 && (t - s) * (n - o) - (i - s) * (e - o) >= 0 && (i - s) * (a - o) - (r - s) * (n - o) >= 0;
            }, t.isValidDiagonal = function (e, i) {
                return e.next.i !== i.i && e.prev.i !== i.i && !t.intersectsPolygon(e, i) && t.locallyInside(e, i) && t.locallyInside(i, e) && t.middleInside(e, i);
            }, t.area = function (t, e, i) {
                return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y);
            }, t.equals = function (t, e) {
                return t.x === e.x && t.y === e.y;
            }, t.intersects = function (e, i, n, r) {
                return !!(t.equals(e, i) && t.equals(n, r) || t.equals(e, r) && t.equals(n, i)) || t.area(e, i, n) > 0 != t.area(e, i, r) > 0 && t.area(n, r, e) > 0 != t.area(n, r, i) > 0;
            }, t.intersectsPolygon = function (e, i) {
                var n = e;
                do {
                    if (n.i !== e.i && n.next.i !== e.i && n.i !== i.i && n.next.i !== i.i && t.intersects(n, n.next, e, i)) return !0;
                    n = n.next;
                } while (n !== e);
                return !1;
            }, t.locallyInside = function (e, i) {
                return t.area(e.prev, e, e.next) < 0 ? t.area(e, i, e.next) >= 0 && t.area(e, e.prev, i) >= 0 : t.area(e, i, e.prev) < 0 || t.area(e, e.next, i) < 0;
            }, t.middleInside = function (t, e) {
                var i = t, n = !1, r = (t.x + e.x) / 2, a = (t.y + e.y) / 2;
                do {
                    i.y > a != i.next.y > a && i.next.y !== i.y && r < (i.next.x - i.x) * (a - i.y) / (i.next.y - i.y) + i.x && (n = !n),
                        i = i.next;
                } while (i !== t);
                return n;
            }, t.splitPolygon = function (t, e) {
                var i = new q(t.i, t.x, t.y), n = new q(e.i, e.x, e.y), r = t.next, a = e.prev;
                return t.next = e, e.prev = t, i.next = r, r.prev = i, n.next = i, i.prev = n, a.next = n,
                    n.prev = a, n;
            }, t.insertNode = function (t, e, i, n) {
                var r = new q(t, e, i);
                return n ? (r.next = n.next, r.prev = n, n.next.prev = r, n.next = r) : (r.prev = r,
                    r.next = r), r;
            }, t.removeNode = function (t) {
                t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ),
                    t.nextZ && (t.nextZ.prevZ = t.prevZ);
            }, t.signedArea = function (t, e, i, n) {
                for (var r = 0, a = e, s = i - n; a < i; a += n) r += (t[s] - t[a]) * (t[a + 1] + t[s + 1]),
                    s = a;
                return r;
            }, t;
        }(), zt = function () {
            function t(t) {
                this.childs = [], this.text = "", this.parent = null, this.name = null, this.noCompile = !1,
                    this.includefiles = null, this.condition = null, this.conditionType = 0, this.useFuns = "",
                    this.z = 0, this.src = null, this.includefiles = t;
            }
            r(t, "laya.webgl.utils.ShaderNode");
            var e = t.prototype;
            return e.setParent = function (t) {
                t.childs.push(this), this.z = t.z + 1, this.parent = t;
            }, e.setCondition = function (t, e) {
                t && (this.conditionType = e, t = t.replace(/(\s*$)/g, ""), this.condition = function () {
                    return this[t];
                }, this.condition.__condition = t);
            }, e.toscript = function (e, i) {
                return this._toscript(e, i, ++t.__id);
            }, e._toscript = function (t, e, i) {
                if (this.childs.length < 1 && !this.text) return e;
                e.length;
                if (this.condition) {
                    var n = !!this.condition.call(t);
                    if (2 === this.conditionType && (n = !n), !n) return e;
                }
                if (this.text && e.push(this.text), this.childs.length > 0 && this.childs.forEach(function (n, r, a) {
                    n._toscript(t, e, i);
                }), this.includefiles.length > 0 && this.useFuns.length > 0) for (var r, a = 0, s = this.includefiles.length; a < s; a++) this.includefiles[a].curUseID != i && (r = this.includefiles[a].file.getFunsScript(this.useFuns)).length > 0 && (this.includefiles[a].curUseID = i,
                    e[0] = r + e[0]);
                return e;
            }, t.__id = 1, t;
        }(), Ht = function () {
            function t() { }
            r(t, "laya.display.cmd.TranslateCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("TranslateCmd", this);
            }, e.run = function (t, e, i) {
                t.translate(this.tx, this.ty);
            }, a(0, e, "cmdID", function () {
                return "Translate";
            }), t.create = function (e, i) {
                var n = V.getItemByClass("TranslateCmd", t);
                return n.tx = e, n.ty = i, n;
            }, t.ID = "Translate", t;
        }(), jt = function () {
            function t(t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t, this.y = e;
            }
            r(t, "laya.maths.Point");
            var e = t.prototype;
            return e.setTo = function (t, e) {
                return this.x = t, this.y = e, this;
            }, e.reset = function () {
                return this.x = this.y = 0, this;
            }, e.recover = function () {
                V.recover("Point", this.reset());
            }, e.distance = function (t, e) {
                return Math.sqrt((this.x - t) * (this.x - t) + (this.y - e) * (this.y - e));
            }, e.toString = function () {
                return this.x + "," + this.y;
            }, e.normalize = function () {
                var t = Math.sqrt(this.x * this.x + this.y * this.y);
                if (t > 0) {
                    var e = 1 / t;
                    this.x *= e, this.y *= e;
                }
            }, e.copy = function (t) {
                return this.setTo(t.x, t.y);
            }, t.create = function () {
                return V.getItemByClass("Point", t);
            }, t.TEMP = new t(), t.EMPTY = new t(), t;
        }(), Wt = (function () {
            function t() { }
            r(t, "laya.Const"), t.NOT_ACTIVE = 1, t.ACTIVE_INHIERARCHY = 2, t.AWAKED = 4, t.NOT_READY = 8,
                t.DISPLAY = 16, t.HAS_ZORDER = 32, t.HAS_MOUSE = 64, t.DISPLAYED_INSTAGE = 128,
                t.DRAWCALL_OPTIMIZE = 256;
        }(), function () {
            function t() { }
            return r(t, "laya.webgl.shapes.BasePoly"), t.createLine2 = function (e, i, n, r, a, s) {
                if (e.length < 4) return null;
                var o = t.tempData.length > e.length + 2 ? t.tempData : new Array(e.length + 2);
                o[0] = e[0], o[1] = e[1];
                var l = 2, h = 0, u = e.length;
                for (h = 2; h < u; h += 2) Math.abs(e[h] - e[h - 2]) + Math.abs(e[h + 1] - e[h - 1]) > .01 && (o[l++] = e[h],
                    o[l++] = e[h + 1]);
                s && Math.abs(e[0] - o[l - 2]) + Math.abs(e[1] - o[l - 1]) > .01 && (o[l++] = e[0],
                    o[l++] = e[1]);
                var c = a;
                u = l / 2;
                var d, _, f, p, m, g, y, v, S, T, E, C, x, b, I, w, A, R, M, D, O = n / 2;
                f = o[0], p = o[1], T = f - (m = o[2]);
                S = (S = -(p - (g = o[3]))) / (D = Math.sqrt(S * S + T * T)) * O, T = T / D * O;
                for (c.push(f - S, p - T, f + S, p + T), h = 1; h < u - 1; h++) f = o[2 * (h - 1)],
                    p = o[2 * (h - 1) + 1], m = o[2 * h], g = o[2 * h + 1], y = o[2 * (h + 1)], v = o[2 * (h + 1) + 1],
                    T = f - m, C = m - y, I = (-(S = (S = -(p - g)) / (D = Math.sqrt(S * S + T * T)) * O) + f) * (-(T = T / D * O) + g) - (-S + m) * (-T + p),
                    R = (-(E = (E = -(g - v)) / (D = Math.sqrt(E * E + C * C)) * O) + y) * (-(C = C / D * O) + g) - (-E + m) * (-C + v),
                    M = (x = -T + p - (-T + g)) * (A = -E + m - (-E + y)) - (w = -C + v - (-C + g)) * (b = -S + m - (-S + f)),
                    Math.abs(M) < .1 ? (M += 10.1, c.push(m - S, g - T, m + S, g + T)) : (((d = (b * R - A * I) / M) - m) * (d - m) + ((_ = (w * I - x * R) / M) - g) + (_ - g),
                        c.push(d, _, m - (d - m), g - (_ - g)));
                for (f = o[l - 4], p = o[l - 3], T = f - (m = o[l - 2]), S = (S = -(p - (g = o[l - 1]))) / (D = Math.sqrt(S * S + T * T)) * O,
                    T = T / D * O, c.push(m - S, g - T, m + S, g + T), h = 1; h < u; h++) i.push(r + 2 * (h - 1), r + 2 * (h - 1) + 1, r + 2 * h + 1, r + 2 * h + 1, r + 2 * h, r + 2 * (h - 1));
                return c;
            }, t.createLineTriangle = function (t, e, i, n, r, a, s) {
                var o = t.slice(), l = o.length, h = o[0], u = o[1], c = o[2], d = (o[2], 0), _ = 0, f = 0, p = 0, m = l / 2;
                if (!(m <= 1) && 2 != m) {
                    for (var g = new Array(4 * m), y = 0, v = 0, S = 0; S < m - 1; S++) h = o[v++],
                        u = o[v++], c = o[v++], p = o[v++] - u, 0 != (f = c - h) && 0 != p && (d = Math.sqrt(f * f + p * p)) > .001 && (g[_ = 4 * y] = h,
                            g[_ + 1] = u, g[_ + 2] = f / d, g[_ + 3] = p / d, y++);
                    for (n ? (h = o[l - 2], u = o[l - 1], c = o[0], p = o[1] - u, 0 != (f = c - h) && 0 != p && (d = Math.sqrt(f * f + p * p)) > .001 && (g[_ = 4 * y] = h,
                        g[_ + 1] = u, g[_ + 2] = f / d, g[_ + 3] = p / d, y++)) : (g[_ = 4 * y] = h, g[_ + 1] = u,
                            g[_ + 2] = f / d, g[_ + 3] = p / d, y++), v = 0, S = 0; S < m; S++) {
                        h = o[v], u = o[v + 1], c = o[v + 2], o[v + 3];
                        o[v + 4], o[v + 5];
                    }
                }
            }, n(t, ["tempData", function () {
                return this.tempData = new Array(256);
            }]), t;
        }()), Xt = function () {
            function t() { }
            r(t, "laya.display.cmd.ScaleCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("ScaleCmd", this);
            }, e.run = function (t, e, i) {
                t._scale(this.scaleX, this.scaleY, this.pivotX + e, this.pivotY + i);
            }, a(0, e, "cmdID", function () {
                return "Scale";
            }), t.create = function (e, i, n, r) {
                var a = V.getItemByClass("ScaleCmd", t);
                return a.scaleX = e, a.scaleY = i, a.pivotX = n, a.pivotY = r, a;
            }, t.ID = "Scale", t;
        }(), Yt = function () {
            function t() { }
            r(t, "laya.display.cmd.AlphaCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("AlphaCmd", this);
            }, e.run = function (t, e, i) {
                t.alpha(this.alpha);
            }, a(0, e, "cmdID", function () {
                return "Alpha";
            }), t.create = function (e) {
                var i = V.getItemByClass("AlphaCmd", t);
                return i.alpha = e, i;
            }, t.ID = "Alpha", t;
        }(), qt = function () {
            function t(t) {
                this._xd_ = !0, this._allocated_ = 8, this._pos_ = 0, this._length = 0, t ? (this._u8d_ = new Uint8Array(t),
                    this._d_ = new DataView(this._u8d_.buffer), this._length = this._d_.byteLength) : this._resizeBuffer(this._allocated_);
            }
            r(t, "laya.utils.Byte");
            var e = t.prototype;
            return e._resizeBuffer = function (t) {
                try {
                    var e = new Uint8Array(t);
                    null != this._u8d_ && (this._u8d_.length <= t ? e.set(this._u8d_) : e.set(this._u8d_.subarray(0, t))),
                        this._u8d_ = e, this._d_ = new DataView(e.buffer);
                } catch (e) {
                    throw "Invalid typed array length:" + t;
                }
            }, e.getString = function () {
                return this.readString();
            }, e.readString = function () {
                return this._rUTF(this.getUint16());
            }, e.getFloat32Array = function (t, e) {
                return this.readFloat32Array(t, e);
            }, e.readFloat32Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Float32Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n;
            }, e.getUint8Array = function (t, e) {
                return this.readUint8Array(t, e);
            }, e.readUint8Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Uint8Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n;
            }, e.getInt16Array = function (t, e) {
                return this.readInt16Array(t, e);
            }, e.readInt16Array = function (t, e) {
                var i = t + e;
                i = i > this._length ? this._length : i;
                var n = new Int16Array(this._d_.buffer.slice(t, i));
                return this._pos_ = i, n;
            }, e.getFloat32 = function () {
                return this.readFloat32();
            }, e.readFloat32 = function () {
                if (this._pos_ + 4 > this._length) throw "getFloat32 error - Out of bounds";
                var t = this._d_.getFloat32(this._pos_, this._xd_);
                return this._pos_ += 4, t;
            }, e.getFloat64 = function () {
                return this.readFloat64();
            }, e.readFloat64 = function () {
                if (this._pos_ + 8 > this._length) throw "getFloat64 error - Out of bounds";
                var t = this._d_.getFloat64(this._pos_, this._xd_);
                return this._pos_ += 8, t;
            }, e.writeFloat32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setFloat32(this._pos_, t, this._xd_),
                    this._pos_ += 4;
            }, e.writeFloat64 = function (t) {
                this._ensureWrite(this._pos_ + 8), this._d_.setFloat64(this._pos_, t, this._xd_),
                    this._pos_ += 8;
            }, e.getInt32 = function () {
                return this.readInt32();
            }, e.readInt32 = function () {
                if (this._pos_ + 4 > this._length) throw "getInt32 error - Out of bounds";
                var t = this._d_.getInt32(this._pos_, this._xd_);
                return this._pos_ += 4, t;
            }, e.getUint32 = function () {
                return this.readUint32();
            }, e.readUint32 = function () {
                if (this._pos_ + 4 > this._length) throw "getUint32 error - Out of bounds";
                var t = this._d_.getUint32(this._pos_, this._xd_);
                return this._pos_ += 4, t;
            }, e.writeInt32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setInt32(this._pos_, t, this._xd_),
                    this._pos_ += 4;
            }, e.writeUint32 = function (t) {
                this._ensureWrite(this._pos_ + 4), this._d_.setUint32(this._pos_, t, this._xd_),
                    this._pos_ += 4;
            }, e.getInt16 = function () {
                return this.readInt16();
            }, e.readInt16 = function () {
                if (this._pos_ + 2 > this._length) throw "getInt16 error - Out of bounds";
                var t = this._d_.getInt16(this._pos_, this._xd_);
                return this._pos_ += 2, t;
            }, e.getUint16 = function () {
                return this.readUint16();
            }, e.readUint16 = function () {
                if (this._pos_ + 2 > this._length) throw "getUint16 error - Out of bounds";
                var t = this._d_.getUint16(this._pos_, this._xd_);
                return this._pos_ += 2, t;
            }, e.writeUint16 = function (t) {
                this._ensureWrite(this._pos_ + 2), this._d_.setUint16(this._pos_, t, this._xd_),
                    this._pos_ += 2;
            }, e.writeInt16 = function (t) {
                this._ensureWrite(this._pos_ + 2), this._d_.setInt16(this._pos_, t, this._xd_),
                    this._pos_ += 2;
            }, e.getUint8 = function () {
                return this.readUint8();
            }, e.readUint8 = function () {
                if (this._pos_ + 1 > this._length) throw "getUint8 error - Out of bounds";
                return this._u8d_[this._pos_++];
            }, e.writeUint8 = function (t) {
                this._ensureWrite(this._pos_ + 1), this._d_.setUint8(this._pos_, t), this._pos_++;
            }, e._getUInt8 = function (t) {
                return this._readUInt8(t);
            }, e._readUInt8 = function (t) {
                return this._d_.getUint8(t);
            }, e._getUint16 = function (t) {
                return this._readUint16(t);
            }, e._readUint16 = function (t) {
                return this._d_.getUint16(t, this._xd_);
            }, e._getMatrix = function () {
                return this._readMatrix();
            }, e._readMatrix = function () {
                return new at(this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32(), this.getFloat32());
            }, e._rUTF = function (t) {
                var e = this._pos_ + t, i = 0, n = 0, r = 0, a = String.fromCharCode, s = this._u8d_, o = [], l = 0;
                for (o.length = 1e3; this._pos_ < e;) (i = s[this._pos_++]) < 128 ? 0 != i && (o[l++] = a(i)) : i < 224 ? o[l++] = a((63 & i) << 6 | 127 & s[this._pos_++]) : i < 240 ? (n = s[this._pos_++],
                    o[l++] = a((31 & i) << 12 | (127 & n) << 6 | 127 & s[this._pos_++])) : (n = s[this._pos_++],
                        r = s[this._pos_++], o[l++] = a((15 & i) << 18 | (127 & n) << 12 | r << 6 & 127 | 127 & s[this._pos_++]));
                return o.length = l, o.join("");
            }, e.getCustomString = function (t) {
                return this.readCustomString(t);
            }, e.readCustomString = function (t) {
                for (var e = "", i = 0, n = 0, r = String.fromCharCode, a = this._u8d_; t > 0;) if ((n = a[this._pos_]) < 128) e += r(n),
                    this._pos_++, t--; else for (i = n - 128, this._pos_++, t -= i; i > 0;) n = a[this._pos_++],
                        e += r(a[this._pos_++] << 8 | n), i--;
                return e;
            }, e.clear = function () {
                this._pos_ = 0, this.length = 0;
            }, e.__getBuffer = function () {
                return this._d_.buffer;
            }, e.writeUTFBytes = function (t) {
                for (var e = 0, i = (t += "").length; e < i; e++) {
                    var n = t.charCodeAt(e);
                    n <= 127 ? this.writeByte(n) : n <= 2047 ? (this._ensureWrite(this._pos_ + 2), this._u8d_.set([192 | n >> 6, 128 | 63 & n], this._pos_),
                        this._pos_ += 2) : n <= 65535 ? (this._ensureWrite(this._pos_ + 3), this._u8d_.set([224 | n >> 12, 128 | n >> 6 & 63, 128 | 63 & n], this._pos_),
                            this._pos_ += 3) : (this._ensureWrite(this._pos_ + 4), this._u8d_.set([240 | n >> 18, 128 | n >> 12 & 63, 128 | n >> 6 & 63, 128 | 63 & n], this._pos_),
                                this._pos_ += 4);
                }
            }, e.writeUTFString = function (t) {
                var e = this.pos;
                this.writeUint16(1), this.writeUTFBytes(t);
                var i = this.pos - e - 2;
                this._d_.setUint16(e, i, this._xd_);
            }, e.readUTFString = function () {
                return this.readUTFBytes(this.getUint16());
            }, e.getUTFString = function () {
                return this.readUTFString();
            }, e.readUTFBytes = function (t) {
                if (void 0 === t && (t = -1), 0 === t) return "";
                var e = this.bytesAvailable;
                if (t > e) throw "readUTFBytes error - Out of bounds";
                return t = t > 0 ? t : e, this._rUTF(t);
            }, e.getUTFBytes = function (t) {
                return void 0 === t && (t = -1), this.readUTFBytes(t);
            }, e.writeByte = function (t) {
                this._ensureWrite(this._pos_ + 1), this._d_.setInt8(this._pos_, t), this._pos_ += 1;
            }, e.readByte = function () {
                if (this._pos_ + 1 > this._length) throw "readByte error - Out of bounds";
                return this._d_.getInt8(this._pos_++);
            }, e.getByte = function () {
                return this.readByte();
            }, e._ensureWrite = function (t) {
                this._length < t && (this._length = t), this._allocated_ < t && (this.length = t);
            }, e.writeArrayBuffer = function (t, e, i) {
                if (void 0 === e && (e = 0), void 0 === i && (i = 0), e < 0 || i < 0) throw "writeArrayBuffer error - Out of bounds";
                0 == i && (i = t.byteLength - e), this._ensureWrite(this._pos_ + i);
                var n = new Uint8Array(t);
                this._u8d_.set(n.subarray(e, e + i), this._pos_), this._pos_ += i;
            }, e.readArrayBuffer = function (t) {
                var e;
                return e = this._u8d_.buffer.slice(this._pos_, this._pos_ + t), this._pos_ = this._pos_ + t,
                    e;
            }, a(0, e, "buffer", function () {
                var t = this._d_.buffer;
                return t.byteLength === this._length ? t : t.slice(0, this._length);
            }), a(0, e, "endian", function () {
                return this._xd_ ? "littleEndian" : "bigEndian";
            }, function (t) {
                this._xd_ = "littleEndian" === t;
            }), a(0, e, "length", function () {
                return this._length;
            }, function (t) {
                this._allocated_ < t ? this._resizeBuffer(this._allocated_ = Math.floor(Math.max(t, 2 * this._allocated_))) : this._allocated_ > t && this._resizeBuffer(this._allocated_ = t),
                    this._length = t;
            }), a(0, e, "pos", function () {
                return this._pos_;
            }, function (t) {
                this._pos_ = t;
            }), a(0, e, "bytesAvailable", function () {
                return this._length - this._pos_;
            }), t.getSystemEndian = function () {
                if (!t._sysEndian) {
                    var e = new ArrayBuffer(2);
                    new DataView(e).setInt16(0, 256, !0), t._sysEndian = 256 === new Int16Array(e)[0] ? "littleEndian" : "bigEndian";
                }
                return t._sysEndian;
            }, t.BIG_ENDIAN = "bigEndian", t.LITTLE_ENDIAN = "littleEndian", t._sysEndian = null,
                t;
        }(), Kt = function () {
            var t;
            function e() {
                this._pool = [], this._map = [], this._laters = [];
            }
            r(e, "laya.utils.CallLater");
            var i = e.prototype;
            return i._update = function () {
                var t = this._laters, e = t.length;
                if (e > 0) {
                    for (var i = 0, n = e - 1; i <= n; i++) {
                        var r = t[i];
                        this._map[r.key] = null, null !== r.method && (r.run(), r.clear()), this._pool.push(r),
                            i === n && (n = t.length - 1);
                    }
                    t.length = 0;
                }
            }, i._getHandler = function (t, e) {
                var i = t ? t.$_GID || (t.$_GID = ie.getGID()) : 0, n = e.$_TID || (e.$_TID = 1e5 * $._mid++);
                return this._map[i + n];
            }, i.callLater = function (e, i, n) {
                if (null == this._getHandler(e, i)) {
                    if (this._pool.length) var r = this._pool.pop(); else r = new t();
                    r.caller = e, r.method = i, r.args = n;
                    var a = e ? e.$_GID : 0, s = i.$_TID;
                    r.key = a + s, this._map[r.key] = r, this._laters.push(r);
                }
            }, i.runCallLater = function (t, e) {
                var i = this._getHandler(t, e);
                i && null != i.method && (this._map[i.key] = null, i.run(), i.clear());
            }, e.I = new e(), e.__init$ = function () {
                t = function () {
                    function t() {
                        this.key = 0, this.caller = null, this.method = null, this.args = null;
                    }
                    r(t, "");
                    var e = t.prototype;
                    return e.clear = function () {
                        this.caller = null, this.method = null, this.args = null;
                    }, e.run = function () {
                        var t = this.caller;
                        if (t && t.destroyed) return this.clear();
                        var e = this.method, i = this.args;
                        null != e && (i ? e.apply(t, i) : e.call(t));
                    }, t;
                }();
            }, e;
        }(), Zt = function () {
            function t() {
                this._sp = null, this._one = null, this._cmds = null, this._vectorgraphArray = null,
                    this._graphicBounds = null, this.autoDestroy = !1, this._render = this._renderEmpty,
                    this._createData();
            }
            r(t, "laya.display.Graphics");
            var e = t.prototype;
            return e._createData = function () { }, e._clearData = function () { }, e._destroyData = function () { },
                e.destroy = function () {
                    this.clear(!0), this._graphicBounds && this._graphicBounds.destroy(), this._graphicBounds = null,
                        this._vectorgraphArray = null, this._sp && (this._sp._renderType = 0, this._sp._setRenderType(0),
                            this._sp = null), this._destroyData();
                }, e.clear = function (t) {
                    if (void 0 === t && (t = !0), t) {
                        var e = this._one;
                        if (this._cmds) {
                            var i = 0, n = this._cmds.length;
                            for (i = 0; i < n; i++) (e = this._cmds[i]).recover();
                            this._cmds.length = 0;
                        } else e && e.recover();
                    } else this._cmds = null;
                    if (this._one = null, this._render = this._renderEmpty, this._clearData(), this._sp && (this._sp._renderType &= -513,
                        this._sp._setRenderType(this._sp._renderType)), this._repaint(), this._vectorgraphArray) {
                        for (i = 0, n = this._vectorgraphArray.length; i < n; i++) A.getInstance().deleteShape(this._vectorgraphArray[i]);
                        this._vectorgraphArray.length = 0;
                    }
                }, e._clearBoundsCache = function () {
                    this._graphicBounds && this._graphicBounds.reset();
                }, e._initGraphicBounds = function () {
                    this._graphicBounds || (this._graphicBounds = Mt.create(), this._graphicBounds._graphics = this);
                }, e._repaint = function () {
                    this._clearBoundsCache(), this._sp && this._sp.repaint();
                }, e._isOnlyOne = function () {
                    return !this._cmds || 0 === this._cmds.length;
                }, e.getBounds = function (t) {
                    return void 0 === t && (t = !1), this._initGraphicBounds(), this._graphicBounds.getBounds(t);
                }, e.getBoundPoints = function (t) {
                    return void 0 === t && (t = !1), this._initGraphicBounds(), this._graphicBounds.getBoundPoints(t);
                }, e.drawImage = function (t, e, i, n, r) {
                    if (void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0),
                        !t) return null;
                    if (n || (n = t.sourceWidth), r || (r = t.sourceHeight), t.getIsReady()) {
                        var a = n / t.sourceWidth, s = r / t.sourceHeight;
                        if (n = t.width * a, r = t.height * s, n <= 0 || r <= 0) return null;
                        e += t.offsetX * a, i += t.offsetY * s;
                    }
                    this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType));
                    var o = f.create.call(this, t, e, i, n, r);
                    return null == this._one ? (this._one = o, this._render = this._renderOneImg) : this._saveToCmd(null, o),
                        this._repaint(), o;
                }, e.drawTexture = function (t, e, i, n, r, a, s, o, l) {
                    if (void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0),
                        void 0 === s && (s = 1), !t || s < .01) return null;
                    if (!t.getIsReady()) return null;
                    if (n || (n = t.sourceWidth), r || (r = t.sourceHeight), t.getIsReady()) {
                        var h = n / t.sourceWidth, u = r / t.sourceHeight;
                        if (n = t.width * h, r = t.height * u, n <= 0 || r <= 0) return null;
                        e += t.offsetX * h, i += t.offsetY * u;
                    }
                    this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType));
                    var c = z.create.call(this, t, e, i, n, r, a, s, o, l);
                    return this._repaint(), this._saveToCmd(null, c);
                }, e.drawTextures = function (t, e) {
                    return t ? this._saveToCmd(At._context.drawTextures, lt.create.call(this, t, e)) : null;
                }, e.drawTriangles = function (t, e, i, n, r, a, s, o, l, h) {
                    return void 0 === o && (o = 1), this._saveToCmd(At._context.drawTriangles, v.create.call(this, t, e, i, n, r, a, s, o, l, h));
                }, e.fillTexture = function (t, e, i, n, r, a, s) {
                    return void 0 === n && (n = 0), void 0 === r && (r = 0), void 0 === a && (a = "repeat"),
                        t && t.getIsReady() ? this._saveToCmd(At._context._fillTexture, u.create.call(this, t, e, i, n, r, a, s || jt.EMPTY, {})) : null;
                }, e._saveToCmd = function (t, e) {
                    return this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType)),
                        null == this._one ? (this._one = e, this._render = this._renderOne) : (this._render = this._renderAll,
                            0 === (this._cmds || (this._cmds = [])).length && this._cmds.push(this._one), this._cmds.push(e)),
                        this._repaint(), e;
                }, e.clipRect = function (t, e, i, n) {
                    return this._saveToCmd(At._context.clipRect, P.create.call(this, t, e, i, n));
                }, e.fillText = function (t, e, i, n, r, a) {
                    return this._saveToCmd(At._context.fillText, oe.create.call(this, t, e, i, n || ei.defaultFontStr(), r, a));
                }, e.fillBorderText = function (t, e, i, n, r, a, s, o) {
                    return this._saveToCmd(At._context.fillBorderText, Nt.create.call(this, t, e, i, n || ei.defaultFontStr(), r, a, s, o));
                }, e.fillWords = function (t, e, i, n, r) {
                    return this._saveToCmd(At._context.fillWords, rt.create.call(this, t, e, i, n || ei.defaultFontStr(), r));
                }, e.fillBorderWords = function (t, e, i, n, r, a, s) {
                    return this._saveToCmd(At._context.fillBorderWords, ge.create.call(this, t, e, i, n || ei.defaultFontStr(), r, a, s));
                }, e.strokeText = function (t, e, i, n, r, a, s) {
                    return this._saveToCmd(At._context.fillBorderText, Jt.create.call(this, t, e, i, n || ei.defaultFontStr(), null, r, a, s));
                }, e.alpha = function (t) {
                    return this._saveToCmd(At._context.alpha, Yt.create.call(this, t));
                }, e.transform = function (t, e, i) {
                    return void 0 === e && (e = 0), void 0 === i && (i = 0), this._saveToCmd(At._context._transform, ot.create.call(this, t, e, i));
                }, e.rotate = function (t, e, i) {
                    return void 0 === e && (e = 0), void 0 === i && (i = 0), this._saveToCmd(At._context._rotate, _e.create.call(this, t, e, i));
                }, e.scale = function (t, e, i, n) {
                    return void 0 === i && (i = 0), void 0 === n && (n = 0), this._saveToCmd(At._context._scale, Xt.create.call(this, t, e, i, n));
                }, e.translate = function (t, e) {
                    return this._saveToCmd(At._context.translate, Ht.create.call(this, t, e));
                }, e.save = function () {
                    return this._saveToCmd(At._context._save, Tt.create.call(this));
                }, e.restore = function () {
                    return this._saveToCmd(At._context.restore, D.create.call(this));
                }, e.replaceText = function (t) {
                    this._repaint();
                    var e = this._cmds;
                    if (e) {
                        for (var i = e.length - 1; i > -1; i--) if (this._isTextCmd(e[i])) return e[i].text = t,
                            !0;
                    } else if (this._one && this._isTextCmd(this._one)) return this._one.text = t, !0;
                    return !1;
                }, e._isTextCmd = function (t) {
                    var e = t.cmdID;
                    return "FillText" == e || "StrokeText" == e || "FillBorderText" == e;
                }, e.replaceTextColor = function (t) {
                    this._repaint();
                    var e = this._cmds;
                    if (e) for (var i = e.length - 1; i > -1; i--) this._isTextCmd(e[i]) && this._setTextCmdColor(e[i], t); else this._one && this._isTextCmd(this._one) && this._setTextCmdColor(this._one, t);
                }, e._setTextCmdColor = function (t, e) {
                    switch (t.cmdID) {
                        case "FillText":
                        case "StrokeText":
                            t.color = e;
                            break;

                        case "FillBorderText":
                        case "FillBorderWords":
                        case "FillBorderText":
                            t.fillColor = e;
                    }
                }, e.loadImage = function (t, e, i, n, r, a) {
                    void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0);
                    var s = Oe.getRes(t);
                    s ? s.getIsReady() ? this.drawImage(s, e, i, n, r) : s.once("ready", this, this.drawImage, [s, e, i, n, r]) : ((s = new Me()).load(t),
                        Oe.cacheRes(t, s), s.once("ready", this, this.drawImage, [s, e, i, n, r])), null != a && (s.getIsReady() ? a.call(this._sp) : s.on("ready", this._sp, a));
                }, e._renderEmpty = function (t, e, i, n) { }, e._renderAll = function (t, e, i, n) {
                    for (var r = this._cmds, a = 0, s = r.length; a < s; a++) r[a].run(e, i, n);
                }, e._renderOne = function (t, e, i, n) {
                    e.sprite = t, this._one.run(e, i, n);
                }, e._renderOneImg = function (t, e, i, n) {
                    e.sprite = t, this._one.run(e, i, n);
                }, e.drawLine = function (t, e, i, n, r, a) {
                    void 0 === a && (a = 1);
                    var s = a < 1 || a % 2 == 0 ? 0 : .5;
                    return this._saveToCmd(At._context._drawLine, it.create.call(this, t + s, e + s, i + s, n + s, r, a, 0));
                }, e.drawLines = function (t, e, i, n, r) {
                    if (void 0 === r && (r = 1), !i || i.length < 4) return null;
                    var a = r < 1 || r % 2 == 0 ? 0 : .5;
                    return this._saveToCmd(At._context._drawLines, ne.create.call(this, t + a, e + a, i, n, r, 0));
                }, e.drawCurves = function (t, e, i, n, r) {
                    return void 0 === r && (r = 1), this._saveToCmd(At._context.drawCurves, se.create.call(this, t, e, i, n, r));
                }, e.drawRect = function (t, e, i, n, r, a, s) {
                    void 0 === s && (s = 1);
                    var o = s >= 1 && a ? s / 2 : 0, l = a ? s : 0;
                    return this._saveToCmd(At._context.drawRect, Y.create.call(this, t + o, e + o, i - l, n - l, r, a, s));
                }, e.drawCircle = function (t, e, i, n, r, a) {
                    void 0 === a && (a = 1);
                    var s = a >= 1 && r ? a / 2 : 0;
                    return this._saveToCmd(At._context._drawCircle, ht.create.call(this, t, e, i - s, n, r, a, 0));
                }, e.drawPie = function (t, e, i, n, r, a, s, o) {
                    void 0 === o && (o = 1);
                    var l = o >= 1 && s ? o / 2 : 0, h = s ? o : 0;
                    return this._saveToCmd(At._context._drawPie, S.create.call(this, t + l, e + l, i - h, ie.toRadian(n), ie.toRadian(r), a, s, o, 0));
                }, e.drawPoly = function (t, e, i, n, r, a) {
                    void 0 === a && (a = 1);
                    var s = !1;
                    s = !(i.length > 6);
                    var o = a >= 1 && r ? a % 2 == 0 ? 0 : .5 : 0;
                    return this._saveToCmd(At._context._drawPoly, B.create.call(this, t + o, e + o, i, n, r, a, s, 0));
                }, e.drawPath = function (t, e, i, n, r) {
                    return this._saveToCmd(At._context._drawPath, vt.create.call(this, t, e, i, n, r));
                }, e.draw9Grid = function (t, e, i, n, r, a) {
                    void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0),
                        this._saveToCmd(null, Ft.create(t, e, i, n, r, a));
                }, a(0, e, "cmds", function () {
                    return this._cmds;
                }, function (t) {
                    this._sp && (this._sp._renderType |= 512, this._sp._setRenderType(this._sp._renderType)),
                        this._cmds = t, this._render = this._renderAll, this._repaint();
                }), t;
        }(), Qt = (function () {
            function t() {
                this.reset();
            }
            r(t, "laya.utils.HTMLChar");
            var e = t.prototype;
            e.setData = function (e, i, n, r) {
                return this.char = e, this.charNum = e.charCodeAt(0), this.x = this.y = 0, this.width = i,
                    this.height = n, this.style = r, this.isWord = !t._isWordRegExp.test(e), this;
            }, e.reset = function () {
                return this.x = this.y = this.width = this.height = 0, this.isWord = !1, this.char = null,
                    this.charNum = 0, this.style = null, this;
            }, e.recover = function () {
                V.recover("HTMLChar", this.reset());
            }, e._isChar = function () {
                return !0;
            }, e._getCSSStyle = function () {
                return this.style;
            }, t.create = function () {
                return V.getItemByClass("HTMLChar", t);
            }, t._isWordRegExp = new RegExp("[\\w.]", "");
        }(), function () {
            function t(t, e, i) {
                this.atlasID = 0, this._width = 0, this._height = 0, this._texCount = 0, this._rowInfo = null,
                    this._cells = null, this._used = 0, void 0 === t && (t = 0), void 0 === e && (e = 0),
                    void 0 === i && (i = 0), this._cells = null, this._rowInfo = null, this.atlasID = i,
                    this._init(t, e);
            }
            r(t, "laya.webgl.text.AtlasGrid");
            var e = t.prototype;
            return e.addRect = function (t, e, i, n) {
                return !!this._get(e, i, n) && (this._fill(n.x, n.y, e, i, t), this._texCount++,
                    !0);
            }, e._release = function () {
                this._cells = null, this._rowInfo = null;
            }, e._init = function (t, e) {
                return this._width = t, this._height = e, this._release(), 0 != this._width && (this._cells = new Uint8Array(this._width * this._height * 3),
                    this._rowInfo = new Uint8Array(this._height), this._used = 0, this._clear(), !0);
            }, e._get = function (t, e, i) {
                if (t > this._width || e > this._height) return !1;
                for (var n = -1, r = -1, a = this._width, s = this._height, o = this._cells, l = 0; l < s; l++) if (!(this._rowInfo[l] < t)) for (var h = 0; h < a;) {
                    var u = 3 * (l * a + h);
                    if (0 != o[u] || o[u + 1] < t || o[u + 2] < e) h += o[u + 1]; else {
                        n = h, r = l;
                        for (var c = 0; c < t; c++) if (o[3 * c + u + 2] < e) {
                            n = -1;
                            break;
                        }
                        if (!(n < 0)) return i.x = n, i.y = r, !0;
                        h += o[u + 1];
                    }
                }
                return !1;
            }, e._fill = function (t, e, i, n, r) {
                var a = this._width, s = this._height;
                this._check(t + i <= a && e + n <= s);
                for (var o = e; o < n + e; ++o) {
                    this._check(this._rowInfo[o] >= i), this._rowInfo[o] -= i;
                    for (var l = 0; l < i; l++) {
                        var h = 3 * (t + o * a + l);
                        this._check(0 == this._cells[h]), this._cells[h] = r, this._cells[h + 1] = i, this._cells[h + 2] = n;
                    }
                }
                if (t > 0) for (o = 0; o < n; ++o) {
                    var u = 0;
                    for (l = t - 1; l >= 0 && 0 == this._cells[3 * ((e + o) * a + l)]; --l, ++u);
                    for (l = u; l > 0; --l) this._cells[3 * ((e + o) * a + t - l) + 1] = l, this._check(l > 0);
                }
                if (e > 0) for (l = t; l < t + i; ++l) {
                    for (u = 0, o = e - 1; o >= 0 && 0 == this._cells[3 * (l + o * a)]; --o, u++);
                    for (o = u; o > 0; --o) this._cells[3 * (l + (e - o) * a) + 2] = o, this._check(o > 0);
                }
                this._used += i * n / (this._width * this._height);
            }, e._check = function (t) {
                0 == t && console.log("xtexMerger 错误啦");
            }, e._clear = function () {
                this._texCount = 0;
                for (var t = 0; t < this._height; t++) this._rowInfo[t] = this._width;
                for (var e = 0; e < this._height; e++) for (var i = 0; i < this._width; i++) {
                    var n = 3 * (e * this._width + i);
                    this._cells[n] = 0, this._cells[n + 1] = this._width - i, this._cells[n + 2] = this._width - e;
                }
            }, t;
        }()), Jt = function () {
            function t() { }
            r(t, "laya.display.cmd.StrokeTextCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("StrokeTextCmd", this);
            }, e.run = function (t, e, i) {
                t.strokeWord(this.text, this.x + e, this.y + i, this.font, this.color, this.lineWidth, this.textAlign);
            }, a(0, e, "cmdID", function () {
                return "StrokeText";
            }), t.create = function (e, i, n, r, a, s, o) {
                var l = V.getItemByClass("StrokeTextCmd", t);
                return l.text = e, l.x = i, l.y = n, l.font = r, l.color = a, l.lineWidth = s, l.textAlign = o,
                    l;
            }, t.ID = "StrokeText", t;
        }(), $t = function () {
            function t() { }
            r(t, "laya.webgl.text.ICharRender");
            var e = t.prototype;
            return e.getWidth = function (t, e) {
                return 0;
            }, e.scale = function (t, e) { }, e.getCharBmp = function (t, e, i, n, r, a, s, o, l, h, u) {
                return null;
            }, a(0, e, "canvasWidth", function () {
                return 0;
            }, function (t) { }), t;
        }(), te = function () {
            function t() { }
            return r(t, "laya.utils.Ease"), t.linearNone = function (t, e, i, n) {
                return i * t / n + e;
            }, t.linearIn = function (t, e, i, n) {
                return i * t / n + e;
            }, t.linearInOut = function (t, e, i, n) {
                return i * t / n + e;
            }, t.linearOut = function (t, e, i, n) {
                return i * t / n + e;
            }, t.bounceIn = function (e, i, n, r) {
                return n - t.bounceOut(r - e, 0, n, r) + i;
            }, t.bounceInOut = function (e, i, n, r) {
                return e < .5 * r ? .5 * t.bounceIn(2 * e, 0, n, r) + i : .5 * t.bounceOut(2 * e - r, 0, n, r) + .5 * n + i;
            }, t.bounceOut = function (t, e, i, n) {
                return (t /= n) < 1 / 2.75 ? i * (7.5625 * t * t) + e : t < 2 / 2.75 ? i * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + e : t < 2.5 / 2.75 ? i * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + e : i * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + e;
            }, t.backIn = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), i * (t /= n) * t * ((r + 1) * t - r) + e;
            }, t.backInOut = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), (t /= .5 * n) < 1 ? .5 * i * (t * t * ((1 + (r *= 1.525)) * t - r)) + e : i / 2 * ((t -= 2) * t * ((1 + (r *= 1.525)) * t + r) + 2) + e;
            }, t.backOut = function (t, e, i, n, r) {
                return void 0 === r && (r = 1.70158), i * ((t = t / n - 1) * t * ((r + 1) * t + r) + 1) + e;
            }, t.elasticIn = function (e, i, n, r, a, s) {
                var o;
                return void 0 === a && (a = 0), void 0 === s && (s = 0), 0 == e ? i : 1 == (e /= r) ? i + n : (s || (s = .3 * r),
                    !a || n > 0 && a < n || n < 0 && a < -n ? (a = n, o = s / 4) : o = s / t.PI2 * Math.asin(n / a),
                    -a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * r - o) * t.PI2 / s) + i);
            }, t.elasticInOut = function (e, i, n, r, a, s) {
                var o;
                return void 0 === a && (a = 0), void 0 === s && (s = 0), 0 == e ? i : 2 == (e /= .5 * r) ? i + n : (s || (s = r * (.3 * 1.5)),
                    !a || n > 0 && a < n || n < 0 && a < -n ? (a = n, o = s / 4) : o = s / t.PI2 * Math.asin(n / a),
                    e < 1 ? a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * r - o) * t.PI2 / s) * -.5 + i : a * Math.pow(2, -10 * (e -= 1)) * Math.sin((e * r - o) * t.PI2 / s) * .5 + n + i);
            }, t.elasticOut = function (e, i, n, r, a, s) {
                var o;
                return void 0 === a && (a = 0), void 0 === s && (s = 0), 0 == e ? i : 1 == (e /= r) ? i + n : (s || (s = .3 * r),
                    !a || n > 0 && a < n || n < 0 && a < -n ? (a = n, o = s / 4) : o = s / t.PI2 * Math.asin(n / a),
                    a * Math.pow(2, -10 * e) * Math.sin((e * r - o) * t.PI2 / s) + n + i);
            }, t.strongIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t * t + e;
            }, t.strongInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t * t + e : .5 * i * ((t -= 2) * t * t * t * t + 2) + e;
            }, t.strongOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t * t * t + 1) + e;
            }, t.sineInOut = function (t, e, i, n) {
                return .5 * -i * (Math.cos(Math.PI * t / n) - 1) + e;
            }, t.sineIn = function (e, i, n, r) {
                return -n * Math.cos(e / r * t.HALF_PI) + n + i;
            }, t.sineOut = function (e, i, n, r) {
                return n * Math.sin(e / r * t.HALF_PI) + i;
            }, t.quintIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t * t + e;
            }, t.quintInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t * t + e : .5 * i * ((t -= 2) * t * t * t * t + 2) + e;
            }, t.quintOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t * t * t + 1) + e;
            }, t.quartIn = function (t, e, i, n) {
                return i * (t /= n) * t * t * t + e;
            }, t.quartInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t * t + e : .5 * -i * ((t -= 2) * t * t * t - 2) + e;
            }, t.quartOut = function (t, e, i, n) {
                return -i * ((t = t / n - 1) * t * t * t - 1) + e;
            }, t.cubicIn = function (t, e, i, n) {
                return i * (t /= n) * t * t + e;
            }, t.cubicInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t * t + e : .5 * i * ((t -= 2) * t * t + 2) + e;
            }, t.cubicOut = function (t, e, i, n) {
                return i * ((t = t / n - 1) * t * t + 1) + e;
            }, t.quadIn = function (t, e, i, n) {
                return i * (t /= n) * t + e;
            }, t.quadInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * i * t * t + e : .5 * -i * (--t * (t - 2) - 1) + e;
            }, t.quadOut = function (t, e, i, n) {
                return -i * (t /= n) * (t - 2) + e;
            }, t.expoIn = function (t, e, i, n) {
                return 0 == t ? e : i * Math.pow(2, 10 * (t / n - 1)) + e - .001 * i;
            }, t.expoInOut = function (t, e, i, n) {
                return 0 == t ? e : t == n ? e + i : (t /= .5 * n) < 1 ? .5 * i * Math.pow(2, 10 * (t - 1)) + e : .5 * i * (2 - Math.pow(2, -10 * --t)) + e;
            }, t.expoOut = function (t, e, i, n) {
                return t == n ? e + i : i * (1 - Math.pow(2, -10 * t / n)) + e;
            }, t.circIn = function (t, e, i, n) {
                return -i * (Math.sqrt(1 - (t /= n) * t) - 1) + e;
            }, t.circInOut = function (t, e, i, n) {
                return (t /= .5 * n) < 1 ? .5 * -i * (Math.sqrt(1 - t * t) - 1) + e : .5 * i * (Math.sqrt(1 - (t -= 2) * t) + 1) + e;
            }, t.circOut = function (t, e, i, n) {
                return i * Math.sqrt(1 - (t = t / n - 1) * t) + e;
            }, t.HALF_PI = .5 * Math.PI, t.PI2 = 2 * Math.PI, t;
        }(), ee = (function () {
            function t() {
                this.sign = null, this.maxCount = 1e3;
            }
            r(t, "laya.utils.PoolCache");
            var e = t.prototype;
            e.getCacheList = function () {
                return V.getPoolBySign(this.sign);
            }, e.tryDispose = function (t) {
                var e;
                (e = V.getPoolBySign(this.sign)).length > this.maxCount && e.splice(this.maxCount, e.length - this.maxCount);
            }, t.addPoolCacheManager = function (e, i) {
                var n;
                void 0 === i && (i = 100), (n = new t()).sign = e, n.maxCount = i, Q.regCacheByFunction(ie.bind(n.tryDispose, n), ie.bind(n.getCacheList, n));
            };
        }(), function () {
            function t() { }
            r(t, "laya.webgl.utils.MatirxArray"), t.ArrayMul = function (e, i, n) {
                if (e) if (i) for (var r = NaN, a = NaN, s = NaN, o = NaN, l = 0; l < 4; l++) r = e[l],
                    a = e[l + 4], s = e[l + 8], o = e[l + 12], n[l] = r * i[0] + a * i[1] + s * i[2] + o * i[3],
                    n[l + 4] = r * i[4] + a * i[5] + s * i[6] + o * i[7], n[l + 8] = r * i[8] + a * i[9] + s * i[10] + o * i[11],
                    n[l + 12] = r * i[12] + a * i[13] + s * i[14] + o * i[15]; else t.copyArray(e, n); else t.copyArray(i, n);
            }, t.copyArray = function (t, e) {
                if (t && e) for (var i = 0; i < t.length; i++) e[i] = t[i];
            };
        }(), function () {
            function t() { }
            r(t, "laya.utils.Mouse"), a(1, t, "cursor", function () {
                return t._style.cursor;
            }, function (e) {
                t._style.cursor = e;
            }), t.hide = function () {
                "none" != t.cursor && (t._preCursor = t.cursor, t.cursor = "none");
            }, t.show = function () {
                "none" == t.cursor && (t._preCursor ? t.cursor = t._preCursor : t.cursor = "auto");
            }, t._preCursor = null, n(t, ["_style", function () {
                return this._style = Ot.document.body.style;
            }]);
        }(), function () {
            function t() { }
            return r(t, "laya.webgl.VertexArrayObject"), t;
        }()(function () {
            var e = {};
            function i(i, n) {
                var r;
                e[i] = !0, void 0 !== n && (r = n, t.console && t.console.log && t.console.log(r));
            }
            var n = function t(e) {
                var i = e.gl;
                this.ext = e, this.isAlive = !0, this.hasBeenBound = !1, this.elementArrayBuffer = null,
                    this.attribs = new Array(e.maxVertexAttribs);
                for (var n = 0; n < this.attribs.length; n++) {
                    var r = new t.VertexAttrib(i);
                    this.attribs[n] = r;
                }
                this.maxAttrib = 0;
            };
            (n.VertexAttrib = function (t) {
                this.enabled = !1, this.buffer = null, this.size = 4, this.type = t.FLOAT, this.normalized = !1,
                    this.stride = 16, this.offset = 0, this.cached = "", this.recache();
            }).prototype.recache = function () {
                this.cached = [this.size, this.type, this.normalized, this.stride, this.offset].join(":");
            };
            var r = function (i) {
                var n = this;
                this.gl = i, function (t) {
                    var i = t.getError;
                    t.getError = function () {
                        do {
                            (n = i.apply(t)) != t.NO_ERROR && (e[n] = !0);
                        } while (n != t.NO_ERROR);
                        for (var n in e) if (e[n]) return delete e[n], parseInt(n);
                        return t.NO_ERROR;
                    };
                }(i);
                var r = this.original = {
                    getParameter: i.getParameter,
                    enableVertexAttribArray: i.enableVertexAttribArray,
                    disableVertexAttribArray: i.disableVertexAttribArray,
                    bindBuffer: i.bindBuffer,
                    getVertexAttrib: i.getVertexAttrib,
                    vertexAttribPointer: i.vertexAttribPointer
                };
                i.getParameter = function (t) {
                    return t == n.VERTEX_ARRAY_BINDING_OES ? n.currentVertexArrayObject == n.defaultVertexArrayObject ? null : n.currentVertexArrayObject : r.getParameter.apply(this, arguments);
                }, i.enableVertexAttribArray = function (t) {
                    var e = n.currentVertexArrayObject;
                    e.maxAttrib = Math.max(e.maxAttrib, t);
                    var i = e.attribs[t];
                    return i.enabled = !0, r.enableVertexAttribArray.apply(this, arguments);
                }, i.disableVertexAttribArray = function (t) {
                    var e = n.currentVertexArrayObject;
                    e.maxAttrib = Math.max(e.maxAttrib, t);
                    var i = e.attribs[t];
                    return i.enabled = !1, r.disableVertexAttribArray.apply(this, arguments);
                }, i.bindBuffer = function (t, e) {
                    switch (t) {
                        case i.ARRAY_BUFFER:
                            n.currentArrayBuffer = e;
                            break;

                        case i.ELEMENT_ARRAY_BUFFER:
                            n.currentVertexArrayObject.elementArrayBuffer = e;
                    }
                    return r.bindBuffer.apply(this, arguments);
                }, i.getVertexAttrib = function (t, e) {
                    var a = n.currentVertexArrayObject, s = a.attribs[t];
                    switch (e) {
                        case i.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:
                            return s.buffer;

                        case i.VERTEX_ATTRIB_ARRAY_ENABLED:
                            return s.enabled;

                        case i.VERTEX_ATTRIB_ARRAY_SIZE:
                            return s.size;

                        case i.VERTEX_ATTRIB_ARRAY_STRIDE:
                            return s.stride;

                        case i.VERTEX_ATTRIB_ARRAY_TYPE:
                            return s.type;

                        case i.VERTEX_ATTRIB_ARRAY_NORMALIZED:
                            return s.normalized;

                        default:
                            return r.getVertexAttrib.apply(this, arguments);
                    }
                }, i.vertexAttribPointer = function (t, e, i, a, s, o) {
                    var l = n.currentVertexArrayObject;
                    l.maxAttrib = Math.max(l.maxAttrib, t);
                    var h = l.attribs[t];
                    return h.buffer = n.currentArrayBuffer, h.size = e, h.type = i, h.normalized = a,
                        h.stride = s, h.offset = o, h.recache(), r.vertexAttribPointer.apply(this, arguments);
                }, i.instrumentExtension && i.instrumentExtension(this, "OES_vertex_array_object"),
                    i.canvas && i.canvas.addEventListener && i.canvas.addEventListener("webglcontextrestored", function () {
                        var e;
                        e = "OESVertexArrayObject emulation library context restored", t.console && t.console.log && t.console.log(e),
                            n.reset_();
                    }, !0), this.reset_();
            };
            r.prototype.VERTEX_ARRAY_BINDING_OES = 34229, r.prototype.reset_ = function () {
                if (void 0 !== this.vertexArrayObjects) for (var t = 0; t < this.vertexArrayObjects.length; ++t) this.vertexArrayObjects.isAlive = !1;
                var e = this.gl;
                this.maxVertexAttribs = e.getParameter(e.MAX_VERTEX_ATTRIBS), this.defaultVertexArrayObject = new n(this),
                    this.currentVertexArrayObject = null, this.currentArrayBuffer = null, this.vertexArrayObjects = [this.defaultVertexArrayObject],
                    this.bindVertexArrayOES(null);
            }, r.prototype.createVertexArrayOES = function () {
                var t = new n(this);
                return this.vertexArrayObjects.push(t), t;
            }, r.prototype.deleteVertexArrayOES = function (t) {
                t.isAlive = !1, this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t), 1),
                    this.currentVertexArrayObject == t && this.bindVertexArrayOES(null);
            }, r.prototype.isVertexArrayOES = function (t) {
                return !!(t && t instanceof n && t.hasBeenBound && t.ext == this);
            }, r.prototype.bindVertexArrayOES = function (t) {
                var e = this.gl;
                if (!t || t.isAlive) {
                    var n = this.original, r = this.currentVertexArrayObject;
                    this.currentVertexArrayObject = t || this.defaultVertexArrayObject, this.currentVertexArrayObject.hasBeenBound = !0;
                    var a = this.currentVertexArrayObject;
                    if (r != a) {
                        r && a.elementArrayBuffer == r.elementArrayBuffer || n.bindBuffer.call(e, e.ELEMENT_ARRAY_BUFFER, a.elementArrayBuffer);
                        for (var s = this.currentArrayBuffer, o = Math.max(r ? r.maxAttrib : 0, a.maxAttrib), l = 0; l <= o; l++) {
                            var h = a.attribs[l], u = r ? r.attribs[l] : null;
                            if (r && h.enabled == u.enabled || (h.enabled ? n.enableVertexAttribArray.call(e, l) : n.disableVertexAttribArray.call(e, l)),
                                h.enabled) {
                                var c = !1;
                                r && h.buffer == u.buffer || (s != h.buffer && (n.bindBuffer.call(e, e.ARRAY_BUFFER, h.buffer),
                                    s = h.buffer), c = !0), (c || h.cached != u.cached) && n.vertexAttribPointer.call(e, l, h.size, h.type, h.normalized, h.stride, h.offset);
                            }
                        }
                        this.currentArrayBuffer != s && n.bindBuffer.call(e, e.ARRAY_BUFFER, this.currentArrayBuffer);
                    }
                } else i(e.INVALID_OPERATION, "bindVertexArrayOES: attempt to bind deleted arrayObject");
            }, t._setupVertexArrayObject = function (t) {
                var e = t.getSupportedExtensions;
                t.getSupportedExtensions = function () {
                    var t = e.call(this) || [];
                    return t.indexOf("OES_vertex_array_object") < 0 && t.push("OES_vertex_array_object"),
                        t;
                };
                var i = t.getExtension;
                t.getExtension = function (t) {
                    var e = i.call(this, t);
                    return e || ("OES_vertex_array_object" !== t ? null : (this.__OESVertexArrayObject || (console.log("Setup OES_vertex_array_object polyfill"),
                        this.__OESVertexArrayObject = new r(this)), this.__OESVertexArrayObject));
                };
            }, t._forceSetupVertexArrayObject = function (t) {
                var e = t.getSupportedExtensions;
                t.getSupportedExtensions = function () {
                    var t = e.call(this) || [];
                    return t.indexOf("OES_vertex_array_object") < 0 && t.push("OES_vertex_array_object"),
                        t;
                };
                var i = t.getExtension;
                t.getExtension = function (t) {
                    if ("OES_vertex_array_object" === t) return this.__OESVertexArrayObject || (console.log("Setup OES_vertex_array_object polyfill"),
                        this.__OESVertexArrayObject = new r(this)), this.__OESVertexArrayObject;
                    var e = i.call(this, t);
                    return e || null;
                };
            };
        }()), function () {
            function t() { }
            return r(t, "laya.resource.WebGLRTMgr"), t.getRT = function (e, i) {
                i |= 0, (e |= 0) >= 1e4 && console.log("getRT error! w too big");
                var n, r = 1e4 * i + e, a = t.dict[r];
                return a && a.length > 0 ? ((n = a.pop())._mgrKey = r, n) : ((n = new _i(e, i, 1, -1))._mgrKey = r,
                    n);
            }, t.releaseRT = function (e) {
                if (!(e._mgrKey <= 0)) {
                    var i = t.dict[e._mgrKey];
                    !i && (i = [], t.dict[e._mgrKey] = i), e._mgrKey = 0, i.push(e);
                }
            }, t.dict = {}, t;
        }()), ie = function () {
            function e() { }
            return r(e, "laya.utils.Utils"), e.toRadian = function (t) {
                return t * e._pi2;
            }, e.toAngle = function (t) {
                return t * e._pi;
            }, e.toHexColor = function (t) {
                if (t < 0 || isNaN(t)) return null;
                for (var e = t.toString(16); e.length < 6;) e = "0" + e;
                return "#" + e;
            }, e.getGID = function () {
                return e._gid++;
            }, e.concatArray = function (t, e) {
                if (!e) return t;
                if (!t) return e;
                var i = 0, n = e.length;
                for (i = 0; i < n; i++) t.push(e[i]);
                return t;
            }, e.clearArray = function (t) {
                return t ? (t.length = 0, t) : t;
            }, e.copyArray = function (t, e) {
                if (t || (t = []), !e) return t;
                t.length = e.length;
                var i = 0, n = e.length;
                for (i = 0; i < n; i++) t[i] = e[i];
                return t;
            }, e.getGlobalRecByPoints = function (t, e, i, n, r) {
                var a, s;
                a = jt.create().setTo(e, i), a = t.localToGlobal(a), s = jt.create().setTo(n, r),
                    s = t.localToGlobal(s);
                var o = mt._getWrapRec([a.x, a.y, s.x, s.y]);
                return a.recover(), s.recover(), o;
            }, e.getGlobalPosAndScale = function (t) {
                return e.getGlobalRecByPoints(t, 0, 0, 1, 1);
            }, e.bind = function (t, e) {
                return t.bind(e);
            }, e.measureText = function (t, e) {
                return ue.measureText(t, e);
            }, e.updateOrder = function (t) {
                if (!t || t.length < 2) return !1;
                for (var e, i = 1, n = 0, r = t.length, a = NaN; i < r;) {
                    for (e = t[n = i], a = t[n]._zOrder; --n > -1 && t[n]._zOrder > a;) t[n + 1] = t[n];
                    t[n + 1] = e, i++;
                }
                return !0;
            }, e.transPointList = function (t, e, i) {
                var n = 0, r = t.length;
                for (n = 0; n < r; n += 2) t[n] += e, t[n + 1] += i;
            }, e.parseInt = function (t, e) {
                void 0 === e && (e = 0);
                var i = Ot.window.parseInt(t, e);
                return isNaN(i) ? 0 : i;
            }, e.getFileExtension = function (t) {
                e._extReg.lastIndex = t.lastIndexOf(".");
                var i = e._extReg.exec(t);
                return i && i.length > 1 ? i[1].toLowerCase() : null;
            }, e.getTransformRelativeToWindow = function (t, e, n) {
                var r = i.stage, a = laya.utils.Utils.getGlobalPosAndScale(t), s = r._canvasTransform.clone(), o = s.tx, l = s.ty;
                s.rotate(-Math.PI / 180 * i.stage.canvasDegree), s.scale(i.stage.clientScaleX, i.stage.clientScaleY);
                var h = i.stage.canvasDegree % 180 != 0, u = NaN, c = NaN;
                h ? (u = n + a.y, c = e + a.x, u *= s.d, c *= s.a, 90 == i.stage.canvasDegree ? (u = o - u,
                    c += l) : (u += o, c = l - c)) : (u = e + a.x, c = n + a.y, u *= s.a, c *= s.d,
                        u += o, c += l), c += i.stage._safariOffsetY;
                var d = NaN, _ = NaN;
                return h ? (d = s.d * a.height, _ = s.a * a.width) : (d = s.a * a.width, _ = s.d * a.height),
                {
                    x: u,
                    y: c,
                    scaleX: d,
                    scaleY: _
                };
            }, e.fitDOMElementInArea = function (t, n, r, a, s, o) {
                t._fitLayaAirInitialized || (t._fitLayaAirInitialized = !0, t.style.transformOrigin = t.style.webKittransformOrigin = "left top",
                    t.style.position = "absolute");
                var l = e.getTransformRelativeToWindow(n, r, a);
                t.style.transform = t.style.webkitTransform = "scale(" + l.scaleX + "," + l.scaleY + ") rotate(" + i.stage.canvasDegree + "deg)",
                    t.style.width = s + "px", t.style.height = o + "px", t.style.left = l.x + "px",
                    t.style.top = l.y + "px";
            }, e.isOkTextureList = function (t) {
                if (!t) return !1;
                var e, i = 0, n = t.length;
                for (i = 0; i < n; i++) if (!(e = t[i]) || !e._getSource()) return !1;
                return !0;
            }, e.isOKCmdList = function (t) {
                if (!t) return !1;
                var e = 0, i = t.length;
                for (e = 0; e < i; e++) t[e];
                return !0;
            }, e.getQueryString = function (e) {
                if (Ot.onMiniGame) return null;
                if (!t.location || !t.location.search) return null;
                var i = new RegExp("(^|&)" + e + "=([^&]*)(&|$)"), n = t.location.search.substr(1).match(i);
                return null != n ? unescape(n[2]) : null;
            }, e._gid = 1, e._pi = 180 / Math.PI, e._pi2 = Math.PI / 180, e._extReg = /\.(\w+)\??/g,
                e.parseXMLFromString = function (t) {
                    var e;
                    if (t = t.replace(/>\s+</g, "><"), (e = new DOMParser().parseFromString(t, "text/xml")).firstChild.textContent.indexOf("This page contains the following errors") > -1) throw new Error(e.firstChild.firstChild.textContent);
                    return e;
                }, e;
        }(), ne = (function () {
            function t() { }
            r(t, "laya.webgl.text.ArabicReshaper");
            var e = t.prototype;
            e.characterMapContains = function (e) {
                for (var i = 0; i < t.charsMap.length; ++i) if (t.charsMap[i][0] === e) return !0;
                return !1;
            }, e.getCharRep = function (e) {
                for (var i = 0; i < t.charsMap.length; ++i) if (t.charsMap[i][0] === e) return t.charsMap[i];
                return !1;
            }, e.getCombCharRep = function (e, i) {
                for (var n = 0; n < t.combCharsMap.length; ++n) if (t.combCharsMap[n][0][0] === e && t.combCharsMap[n][0][1] === i) return t.combCharsMap[n];
                return !1;
            }, e.isTransparent = function (e) {
                for (var i = 0; i < t.transChars.length; ++i) if (t.transChars[i] === e) return !0;
                return !1;
            }, e.getOriginalCharsFromCode = function (e) {
                var i = 0;
                for (i = 0; i < t.charsMap.length; ++i) if (t.charsMap[i].indexOf(e) > -1) return String.fromCharCode(t.charsMap[i][0]);
                for (i = 0; i < t.combCharsMap.length; ++i) if (t.combCharsMap[i].indexOf(e) > -1) return String.fromCharCode(t.combCharsMap[i][0][0]) + String.fromCharCode(t.combCharsMap[i][0][1]);
                return String.fromCharCode(e);
            }, e.convertArabic = function (t) {
                for (var e, i, n = "", r = 0; r < t.length; ++r) {
                    var a = t.charCodeAt(r);
                    if (this.characterMapContains(a)) {
                        for (var s = null, o = null, l = r - 1, h = r + 1; l >= 0 && this.isTransparent(t.charCodeAt(l)); --l);
                        for ((!(e = !!(s = l >= 0 ? t.charCodeAt(l) : null) && this.getCharRep(s)) || null == e[2] && null == e[3]) && (s = null); h < t.length && this.isTransparent(t.charCodeAt(h)); ++h);
                        if ((!(e = !!(o = h < t.length ? t.charCodeAt(h) : null) && this.getCharRep(o)) || null == e[3] && null == e[4]) && (o = null),
                            1604 === a && null != o && (1570 === o || 1571 === o || 1573 === o || 1575 === o)) {
                            i = this.getCombCharRep(a, o), n += null != s ? String.fromCharCode(i[4]) : String.fromCharCode(i[1]),
                                ++r;
                            continue;
                        }
                        if (e = this.getCharRep(a), null != s && null != o && null != e[3]) {
                            n += String.fromCharCode(e[3]);
                            continue;
                        }
                        if (null != s && null != e[4]) {
                            n += String.fromCharCode(e[4]);
                            continue;
                        }
                        if (null != o && null != e[2]) {
                            n += String.fromCharCode(e[2]);
                            continue;
                        }
                        n += String.fromCharCode(e[1]);
                    } else n += String.fromCharCode(a);
                }
                return n;
            }, e.convertArabicBack = function (t) {
                var e = "", i = 0, n = 0;
                for (n = 0; n < t.length; ++n) i = t.charCodeAt(n), e += this.getOriginalCharsFromCode(i);
                return e;
            }, n(t, ["charsMap", function () {
                return this.charsMap = [[1569, 65152, null, null, null], [1570, 65153, null, null, 65154], [1571, 65155, null, null, 65156], [1572, 65157, null, null, 65158], [1573, 65159, null, null, 65160], [1574, 65161, 65163, 65164, 65162], [1575, 65165, null, null, 65166], [1576, 65167, 65169, 65170, 65168], [1577, 65171, null, null, 65172], [1578, 65173, 65175, 65176, 65174], [1579, 65177, 65179, 65180, 65178], [1580, 65181, 65183, 65184, 65182], [1581, 65185, 65187, 65188, 65186], [1582, 65189, 65191, 65192, 65190], [1583, 65193, null, null, 65194], [1584, 65195, null, null, 65196], [1585, 65197, null, null, 65198], [1586, 65199, null, null, 65200], [1587, 65201, 65203, 65204, 65202], [1588, 65205, 65207, 65208, 65206], [1589, 65209, 65211, 65212, 65210], [1590, 65213, 65215, 65216, 65214], [1591, 65217, 65219, 65220, 65218], [1592, 65221, 65223, 65224, 65222], [1593, 65225, 65227, 65228, 65226], [1594, 65229, 65231, 65232, 65230], [1600, 1600, 1600, 1600, 1600], [1601, 65233, 65235, 65236, 65234], [1602, 65237, 65239, 65240, 65238], [1603, 65241, 65243, 65244, 65242], [1604, 65245, 65247, 65248, 65246], [1605, 65249, 65251, 65252, 65250], [1606, 65253, 65255, 65256, 65254], [1607, 65257, 65259, 65260, 65258], [1608, 65261, null, null, 65262], [1609, 65263, null, null, 65264], [1610, 65265, 65267, 65268, 65266], [1662, 64342, 64344, 64345, 64343], [1740, 64508, 64510, 64511, 64509], [1670, 64378, 64380, 64381, 64379], [1705, 64398, 64400, 64401, 64399], [1711, 64402, 64404, 64405, 64403], [1688, 64394, null, null, 64395]];
            }, "combCharsMap", function () {
                return this.combCharsMap = [[[1604, 1570], 65269, null, null, 65270], [[1604, 1571], 65271, null, null, 65272], [[1604, 1573], 65273, null, null, 65274], [[1604, 1575], 65275, null, null, 65276]];
            }, "transChars", function () {
                return this.transChars = [1552, 1554, 1555, 1556, 1557, 1611, 1612, 1613, 1614, 1615, 1616, 1617, 1618, 1619, 1620, 1621, 1622, 1623, 1624, 1648, 1750, 1751, 1752, 1753, 1754, 1755, 1756, 1759, 1760, 1761, 1762, 1763, 1764, 1767, 1768, 1770, 1771, 1772, 1773];
            }]);
        }(), function () {
            function t() { }
            r(t, "laya.display.cmd.DrawLinesCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.points = null, this.lineColor = null, V.recover("DrawLinesCmd", this);
            }, e.run = function (t, e, i) {
                t._drawLines(this.x + e, this.y + i, this.points, this.lineColor, this.lineWidth, this.vid);
            }, a(0, e, "cmdID", function () {
                return "DrawLines";
            }), t.create = function (e, i, n, r, a, s) {
                var o = V.getItemByClass("DrawLinesCmd", t);
                return o.x = e, o.y = i, o.points = n, o.lineColor = r, o.lineWidth = a, o.vid = s,
                    o;
            }, t.ID = "DrawLines", t;
        }()), re = function () {
            function t() {
                this._data = [], this._ndata = 0, this._tex = null, this._imgId = 0, this._clipid = -1,
                    this._enbale = !1, this._colorFiler = null, this._clipMatrix = new at();
            }
            r(t, "laya.webgl.text.CharSubmitCache");
            var e = t.prototype;
            return e.clear = function () {
                this._tex = null, this._imgId = -1, this._ndata = 0, this._enbale = !1, this._colorFiler = null;
            }, e.destroy = function () {
                this.clear(), this._data.length = 0, this._data = null;
            }, e.add = function (t, e, i, n, r, a) {
                this._ndata > 0 && (this._tex != e || this._imgId != i || this._clipid >= 0 && this._clipid != t._clipInfoID) && this.submit(t),
                    this._clipid = t._clipInfoID, t._globalClipMatrix.copyTo(this._clipMatrix), this._tex = e,
                    this._imgId = i, this._colorFiler = t._colorFiler, this._data[this._ndata] = n,
                    this._data[this._ndata + 1] = r, this._data[this._ndata + 2] = a, this._ndata += 3;
            }, e.getPos = function () {
                return 0 == t.__nPosPool ? new Array(8) : t.__posPool[--t.__nPosPool];
            }, e.enable = function (t, e) {
                t !== this._enbale && (this._enbale = t, this._enbale || this.submit(e));
            }, e.submit = function (e) {
                var i = this._ndata;
                if (i) {
                    var n = e._mesh, r = e._colorFiler;
                    e._colorFiler = this._colorFiler;
                    var a = Se.create(e, n, H.create(1, 0));
                    e._submits[e._submits._length++] = e._curSubmit = a, a.shaderValue.textureHost = this._tex,
                        a._key.other = this._imgId, e._colorFiler = r, e._copyClipInfo(a, this._clipMatrix),
                        a.clipInfoID = this._clipid;
                    for (var s = 0; s < i; s += 3) n.addQuad(this._data[s], this._data[s + 1], this._data[s + 2], !0),
                        t.__posPool[t.__nPosPool++] = this._data[s];
                    i /= 3, a._numEle += 6 * i, n.indexNum += 6 * i, n.vertNum += 4 * i, e._drawCount += i,
                        this._ndata = 0, b.loopCount % 100 == 0 && (this._data.length = 0);
                }
            }, t.__posPool = [], t.__nPosPool = 0, t;
        }(), ae = function () {
            function t() { }
            return r(t, "Config"), t.animationInterval = 50, t.isAntialias = !1, t.isAlpha = !1,
                t.premultipliedAlpha = !0, t.isStencil = !0, t.preserveDrawingBuffer = !1, t.webGL2D_MeshAllocMaxMem = !0,
                t.is2DPixelArtGame = !1, t.useWebGL2 = !1, t.useRetinalCanvas = !0, t;
        }(), se = function () {
            function t() { }
            r(t, "laya.display.cmd.DrawCurvesCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.points = null, this.lineColor = null, V.recover("DrawCurvesCmd", this);
            }, e.run = function (t, e, i) {
                t.drawCurves(this.x + e, this.y + i, this.points, this.lineColor, this.lineWidth);
            }, a(0, e, "cmdID", function () {
                return "DrawCurves";
            }), t.create = function (e, i, n, r, a) {
                var s = V.getItemByClass("DrawCurvesCmd", t);
                return s.x = e, s.y = i, s.points = n, s.lineColor = r, s.lineWidth = a, s;
            }, t.ID = "DrawCurves", t;
        }(), oe = function () {
            function t() {
                this._textIsWorldText = !1, this._fontColor = 4294967295, this._strokeColor = 0,
                    this._nTexAlign = 0, this._fontObj = t._defFontObj;
            }
            r(t, "laya.display.cmd.FillTextCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("FillTextCmd", this);
            }, e.run = function (t, e, n) {
                i.stage.isGlobalRepaint() && this._textIsWorldText && this._text.cleanCache(), this._textIsWorldText ? t._fast_filltext(this._text, this.x + e, this.y + n, this._fontObj, this._color, null, 0, this._nTexAlign, 0) : t.drawText(this._text, this.x + e, this.y + n, this._font, this._color, this._textAlign);
            }, a(0, e, "text", function () {
                return this._text;
            }, function (t) {
                this._text = t, this._textIsWorldText = t instanceof laya.utils.WordText, this._textIsWorldText && this._text.cleanCache();
            }), a(0, e, "cmdID", function () {
                return "FillText";
            }), a(0, e, "color", function () {
                return this._color;
            }, function (t) {
                this._color = t, this._fontColor = o.create(t).numColor, this._textIsWorldText && this._text.cleanCache();
            }), a(0, e, "font", function () {
                return this._font;
            }, function (t) {
                this._font = t, this._fontObj = fe.Parse(t), this._textIsWorldText && this._text.cleanCache();
            }), a(0, e, "textAlign", function () {
                return this._textAlign;
            }, function (t) {
                switch (this._textAlign = t, t) {
                    case "center":
                        this._nTexAlign = ut.ENUM_TEXTALIGN_CENTER;
                        break;

                    case "right":
                        this._nTexAlign = ut.ENUM_TEXTALIGN_RIGHT;
                        break;

                    default:
                        this._nTexAlign = ut.ENUM_TEXTALIGN_DEFAULT;
                }
                this._textIsWorldText && this._text.cleanCache();
            }), t.create = function (e, i, n, r, a, s) {
                var o = V.getItemByClass("FillTextCmd", t);
                return o.text = e, o._textIsWorldText = e instanceof laya.utils.WordText, o.x = i,
                    o.y = n, o.font = r, o.color = a, o.textAlign = s, o;
            }, t.ID = "FillText", n(t, ["_defFontObj", function () {
                return this._defFontObj = new fe(null);
            }]), t;
        }(), le = (function () {
            function t() { }
            r(t, "laya.webgl.shader.ShaderValue");
        }(), function () {
            function t() { }
            r(t, "laya.events.KeyLocation"), t.STANDARD = 0, t.LEFT = 1, t.RIGHT = 2, t.NUM_PAD = 3;
        }(), function () {
            function t() {
                this._clipInfoID = -1, this.incache = !1, this._globalClipMatrix = new at(), this._clipRect = new mt();
            }
            r(t, "laya.webgl.canvas.save.SaveClipRect");
            var e = t.prototype;
            return i.imps(e, {
                "laya.webgl.canvas.save.ISaveData": !0
            }), e.isSaveMark = function () {
                return !1;
            }, e.restore = function (e) {
                this._globalClipMatrix.copyTo(e._globalClipMatrix), this._clipRect.clone(e._clipRect),
                    e._clipInfoID = this._clipInfoID, t.POOL[t.POOL._length++] = this, e._clipInCache = this.incache;
            }, t.save = function (e) {
                if (131072 != (131072 & e._saveMark._saveuse)) {
                    e._saveMark._saveuse |= 131072;
                    var i = t.POOL, n = i._length > 0 ? i[--i._length] : new t();
                    e._globalClipMatrix.copyTo(n._globalClipMatrix), e._clipRect.clone(n._clipRect),
                        n._clipInfoID = e._clipInfoID, n.incache = e._clipInCache;
                    var r = e._save;
                    r[r._length++] = n;
                }
            }, t.POOL = l._createArray(), t;
        }()), he = function () {
            function t() { }
            r(t, "laya.filters.GlowFilterGLRender");
            var e = t.prototype;
            return e.setShaderInfo = function (t, e, i, n) {
                t.defines.add(n.type);
                var r = t;
                r.u_blurInfo1 = n._sv_blurInfo1;
                var a = n._sv_blurInfo2;
                a[0] = e, a[1] = i, r.u_blurInfo2 = a, r.u_color = n.getColor();
            }, e.render = function (t, e, i, n, r) {
                var a = i, s = n, o = H.create(1, 0);
                this.setShaderInfo(o, a, s, r);
                var l = H.create(1, 0), h = at.TEMP.identity();
                e.drawTarget(t, 0, 0, a, s, h, o), e.drawTarget(t, 0, 0, a, s, h, l);
            }, t;
        }(), ue = function () {
            function t() { }
            return r(t, "laya.utils.RunDriver"), t.createShaderCondition = function (t) {
                var e = "(function() {return " + t + ";})";
                return i._runScript(e);
            }, t.fontMap = [], t.measureText = function (e, i) {
                var n = t.hanzi.test(e);
                if (n && t.fontMap[i]) return t.fontMap[i];
                var r = Ot.context;
                r.font = i;
                var a = r.measureText(e);
                return n && (t.fontMap[i] = a), a;
            }, t.drawToCanvas = function (t, e, i, n, r, a) {
                r -= t.x, a -= t.y, r |= 0, a |= 0, i |= 0, n |= 0;
                var s = new ut();
                s.size(i, n), s.asBitmap = !0, s._targets.start(), M.renders[e]._fun(t, s, r, a),
                    s.flush(), s._targets.end(), s._targets.restore();
                var o = s._targets.getData(0, 0, i, n);
                s.destroy();
                for (var l = new ImageData(i, n), h = 4 * i, u = (new Uint8Array(h), l.data), c = n - 1, d = c * h, _ = 0; c >= 0; c--) u.set(o.subarray(_, _ + h), d),
                    d -= h, _ += h;
                var f = new ai(!0);
                return f.size(i, n), f.getContext("2d").putImageData(l, 0, 0), f;
            }, t.drawToTexture = function (t, e, i, n, r, a) {
                r -= t.x, a -= t.y, r |= 0, a |= 0, i |= 0, n |= 0;
                var s = new ut();
                s.size(i, n), s.asBitmap = !0, s._targets.start(), M.renders[e]._fun(t, s, r, a),
                    s.flush(), s._targets.end(), s._targets.restore();
                var o = new Me(s._targets, Me.INV_UV);
                return s.destroy(!0), o;
            }, t.changeWebGLSize = function (t, e) {
                Ct.onStageResize(t, e);
            }, t.clear = function (t) {
                ut.set2DRenderConfig(), ft.worldScissorTest && Ct.mainContext.disable(3089);
                var e = At.context, n = 0 == e._submits._length || ae.preserveDrawingBuffer ? o.create(t).arrColor : i.stage._wgColor;
                n ? e.clearBG(n[0], n[1], n[2], n[3]) : e.clearBG(0, 0, 0, 0), ft.clear();
            }, t.enableNative = null, n(t, ["hanzi", function () {
                return this.hanzi = new RegExp("^[一-龥]$");
            }]), t;
        }(), ce = function () {
            function t() { }
            return r(t, "laya.net.AtlasInfoManager"), t.enable = function (e, n) {
                i.loader.load(e, g.create(null, t._onInfoLoaded, [n]), null, "json");
            }, t._onInfoLoaded = function (e, i) {
                var n, r, a, s = 0, o = 0;
                for (n in i) for (r = (a = i[n])[0], o = (a = a[1]).length, s = 0; s < o; s++) t._fileLoadDic[r + a[s]] = n;
                e && e.run();
            }, t.getFileLoadPath = function (e) {
                return t._fileLoadDic[e] || e;
            }, t._fileLoadDic = {}, t;
        }(), de = function () {
            function t() { }
            return r(t, "laya.webgl.canvas.BlendMode"), t._init_ = function (e) {
                t.fns = [t.BlendNormal, t.BlendAdd, t.BlendMultiply, t.BlendScreen, t.BlendOverlay, t.BlendLight, t.BlendMask, t.BlendDestinationOut],
                    t.targetFns = [t.BlendNormalTarget, t.BlendAddTarget, t.BlendMultiplyTarget, t.BlendScreenTarget, t.BlendOverlayTarget, t.BlendLightTarget, t.BlendMask, t.BlendDestinationOut];
            }, t.BlendNormal = function (t) {
                nt.setBlendFunc(t, 1, 771);
            }, t.BlendAdd = function (t) {
                nt.setBlendFunc(t, 1, 772);
            }, t.BlendMultiply = function (t) {
                nt.setBlendFunc(t, 774, 771);
            }, t.BlendScreen = function (t) {
                nt.setBlendFunc(t, 1, 1);
            }, t.BlendOverlay = function (t) {
                nt.setBlendFunc(t, 1, 769);
            }, t.BlendLight = function (t) {
                nt.setBlendFunc(t, 1, 1);
            }, t.BlendNormalTarget = function (t) {
                nt.setBlendFunc(t, 1, 771);
            }, t.BlendAddTarget = function (t) {
                nt.setBlendFunc(t, 1, 772);
            }, t.BlendMultiplyTarget = function (t) {
                nt.setBlendFunc(t, 774, 771);
            }, t.BlendScreenTarget = function (t) {
                nt.setBlendFunc(t, 1, 1);
            }, t.BlendOverlayTarget = function (t) {
                nt.setBlendFunc(t, 1, 769);
            }, t.BlendLightTarget = function (t) {
                nt.setBlendFunc(t, 1, 1);
            }, t.BlendMask = function (t) {
                nt.setBlendFunc(t, 0, 770);
            }, t.BlendDestinationOut = function (t) {
                nt.setBlendFunc(t, 0, 0);
            }, t.activeBlendFunction = null, t.NAMES = ["normal", "add", "multiply", "screen", "overlay", "light", "mask", "destination-out"],
                t.TOINT = {
                    normal: 0,
                    add: 1,
                    multiply: 2,
                    screen: 3,
                    overlay: 4,
                    light: 5,
                    mask: 6,
                    "destination-out": 7,
                    lighter: 1
                }, t.NORMAL = "normal", t.ADD = "add", t.MULTIPLY = "multiply", t.SCREEN = "screen",
                t.OVERLAY = "overlay", t.LIGHT = "light", t.MASK = "mask", t.DESTINATIONOUT = "destination-out",
                t.LIGHTER = "lighter", t.fns = [], t.targetFns = [], t;
        }(), _e = function () {
            function t() { }
            r(t, "laya.display.cmd.RotateCmd");
            var e = t.prototype;
            return e.recover = function () {
                V.recover("RotateCmd", this);
            }, e.run = function (t, e, i) {
                t._rotate(this.angle, this.pivotX + e, this.pivotY + i);
            }, a(0, e, "cmdID", function () {
                return "Rotate";
            }), t.create = function (e, i, n) {
                var r = V.getItemByClass("RotateCmd", t);
                return r.angle = e, r.pivotX = i, r.pivotY = n, r;
            }, t.ID = "Rotate", t;
        }(), fe = function () {
            function t(e) {
                this._font = "14px Arial", this._family = "Arial", this._size = 14, this._italic = !1,
                    this._bold = !1, this._id = t._gfontID++, this.setFont(e || this._font);
            }
            return r(t, "laya.utils.FontInfo"), t.prototype.setFont = function (t) {
                this._font = t;
                var e = t.split(" "), i = e.length;
                if (i < 2) 1 == i && e[0].indexOf("px") > 0 && (this._size = parseInt(e[0])); else {
                    for (var n = -1, r = 0; r < i; r++) if (e[r].indexOf("px") > 0 || e[r].indexOf("pt") > 0) {
                        n = r, this._size = parseInt(e[r]), this._size <= 0 && (console.log("font parse error:" + t),
                            this._size = 14);
                        break;
                    }
                    var a = n + 1, s = e[a];
                    for (a++; a < i; a++) s += " " + e[a];
                    this._family = s.split(",")[0], this._italic = e.indexOf("italic") >= 0, this._bold = e.indexOf("bold") >= 0;
                }
            }, t.Parse = function (e) {
                if (e === t._lastFont) return t._lastFontInfo;
                var i = t._cache[e];
                return i || (i = t._cache[e] = new t(e)), t._lastFont = e, t._lastFontInfo = i,
                    i;
            }, t.EMPTY = new t(null), t._cache = {}, t._gfontID = 0, t._lastFont = "", t._lastFontInfo = null,
                t;
        }(), pe = function () {
            function t(t, e, i, n) {
                this._clearCR = new RegExp("\r", "g");
                var r = this;
                function a(t) {
                    t = t.replace(r._clearCR, "");
                    var e = [], i = new zt(e);
                    return r._compileToTree(i, t.split("\n"), 0, e, n), i;
                }
                var s = Ot.now();
                this._VS = a(t), this._PS = a(e), this._nameMap = i, Ot.now() - s > 2 && console.log("ShaderCompile use time:" + (Ot.now() - s) + "  size:" + t.length + "/" + e.length);
            }
            r(t, "laya.webgl.utils.ShaderCompile");
            var e = t.prototype;
            return e._compileToTree = function (e, i, n, r, a) {
                var s, o, l, h, u, c, d, _ = 0, f = 0, p = 0, m = 0;
                for (f = n; f < i.length; f++) if (!((l = i[f]).length < 1) && 0 !== (_ = l.indexOf("//"))) {
                    if (_ >= 0 && (l = l.substr(0, _)), s = d || new zt(r), d = null, s.text = l, s.noCompile = !0,
                        (_ = l.indexOf("#")) >= 0) {
                        for (h = "#", m = _ + 1, p = l.length; m < p; m++) {
                            var g = l.charAt(m);
                            if (" " === g || "\t" === g || "?" === g) break;
                            h += g;
                        }
                        switch (s.name = h, h) {
                            case "#ifdef":
                            case "#ifndef":
                                if (s.src = l, s.noCompile = null != l.match(/[!&|()=<>]/), s.noCompile ? console.log("function():Boolean{return " + l.substr(_ + s.name.length) + "}") : (c = l.replace(/^\s*/, "").split(/\s+/),
                                    s.setCondition(c[1], "#ifdef" === h ? 1 : 2), s.text = "//" + s.text), s.setParent(e),
                                    e = s, a) for (c = l.substr(m).split(t._splitToWordExps3), m = 0; m < c.length; m++) (l = c[m]).length && (a[l] = !0);
                                continue;

                            case "#if":
                                if (s.src = l, s.noCompile = !0, s.setParent(e), e = s, a) for (c = l.substr(m).split(t._splitToWordExps3),
                                    m = 0; m < c.length; m++) (l = c[m]).length && "defined" != l && (a[l] = !0);
                                continue;

                            case "#else":
                                s.src = l, o = (e = e.parent).childs[e.childs.length - 1], s.noCompile = o.noCompile,
                                    s.noCompile || (s.condition = o.condition, s.conditionType = 1 == o.conditionType ? 2 : 1,
                                        s.text = "//" + s.text + " " + o.text + " " + s.conditionType), s.setParent(e),
                                    e = s;
                                continue;

                            case "#endif":
                                o = (e = e.parent).childs[e.childs.length - 1], s.noCompile = o.noCompile, s.noCompile || (s.text = "//" + s.text),
                                    s.setParent(e);
                                continue;

                            case "#include":
                                c = t.splitToWords(l, null);
                                var y = t.includes[c[1]];
                                if (!y) throw "ShaderCompile error no this include file:" + c[1];
                                if ((_ = c[0].indexOf("?")) < 0) {
                                    s.setParent(e), l = y.getWith("with" == c[2] ? c[3] : null), this._compileToTree(s, l.split("\n"), 0, r, a),
                                        s.text = "";
                                    continue;
                                }
                                s.setCondition(c[0].substr(_ + 1), 1), s.text = y.getWith("with" == c[2] ? c[3] : null);
                                break;

                            case "#import":
                                u = (c = t.splitToWords(l, null))[1], r.push({
                                    node: s,
                                    file: t.includes[u],
                                    ofs: s.text.length
                                });
                                continue;
                        }
                    } else {
                        if ((o = e.childs[e.childs.length - 1]) && !o.name) {
                            r.length > 0 && t.splitToWords(l, o), d = s, o.text += "\n" + l;
                            continue;
                        }
                        r.length > 0 && t.splitToWords(l, s);
                    }
                    s.setParent(e);
                }
            }, e.createShader = function (t, e, i, n) {
                var r = {}, a = "";
                if (t) for (var s in t) a += "#define " + s + "\n", r[s] = !0;
                var o = this._VS.toscript(r, []), l = this._PS.toscript(r, []);
                return (i || ni.create)(a + o.join("\n"), a + l.join("\n"), e, this._nameMap, n);
            }, t._parseOne = function (e, i, n, r, a, s) {
                var o = {
                    type: t.shaderParamsMap[n[r + 1]],
                    name: n[r + 2],
                    size: isNaN(parseInt(n[r + 3])) ? 1 : parseInt(n[r + 3])
                };
                return s && ("attribute" == a ? e.push(o) : i.push(o)), ":" == n[r + 3] && (o.type = n[r + 4],
                    r += 2), r += 2;
            }, t.addInclude = function (e, i) {
                if (!i || 0 === i.length) throw new Error("add shader include file err:" + e);
                if (t.includes[e]) throw new Error("add shader include file err, has add:" + e);
                t.includes[e] = new U(i);
            }, t.preGetParams = function (e, i) {
                var n = [e, i], r = {}, a = [], s = [], o = {}, l = [];
                r.attributes = a, r.uniforms = s, r.defines = o;
                for (var h = 0, u = 0, c = 0; c < 2; c++) {
                    n[c] = n[c].replace(t._removeAnnotation, "");
                    var d, _ = n[c].match(t._reg);
                    for (h = 0, u = _.length; h < u; h++) {
                        var f = _[h];
                        if ("attribute" == f || "uniform" == f) h = t._parseOne(a, s, _, h, f, !0); else {
                            if ("#define" == f) {
                                l[f = _[++h]] = 1;
                                continue;
                            }
                            if ("#ifdef" == f) {
                                o[d = _[++h]] = o[d] || [];
                                for (h++; h < u; h++) if ("attribute" == (f = _[h]) || "uniform" == f) h = t._parseOne(a, s, _, h, f, l[d]); else if ("#else" == f) for (h++; h < u; h++) if ("attribute" == (f = _[h]) || "uniform" == f) h = t._parseOne(a, s, _, h, f, !l[d]); else if ("#endif" == f) break;
                            }
                        }
                    }
                }
                return r;
            }, t.splitToWords = function (t, e) {
                for (var i, n, r = [], a = -1, s = 0, o = t.length; s < o; s++) if (i = t.charAt(s),
                    " \t=+-*/&%!<>()'\",;".indexOf(i) >= 0) {
                    if (a >= 0 && s - a > 1 && (n = t.substr(a, s - a), r.push(n)), '"' == i || "'" == i) {
                        var l = t.indexOf(i, s + 1);
                        if (l < 0) throw "Sharder err:" + t;
                        r.push(t.substr(s + 1, l - s - 1)), s = l, a = -1;
                        continue;
                    }
                    "(" == i && e && r.length > 0 && (n = r[r.length - 1] + ";", "vec4;main;".indexOf(n) < 0 && (e.useFuns += n)),
                        a = -1;
                } else a < 0 && (a = s);
                return a < o && o - a > 1 && (n = t.substr(a, o - a), r.push(n)), r;
            }, t.IFDEF_NO = 0, t.IFDEF_YES = 1, t.IFDEF_ELSE = 2, t.IFDEF_PARENT = 3, t._removeAnnotation = new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)", "g"),
                t._reg = new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])", "g"),
                t._splitToWordExps = new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])", "g"),
                t.includes = {}, n(t, ["shaderParamsMap", function () {
                    return this.shaderParamsMap = {
                        float: 5126,
                        int: 5124,
                        bool: 35670,
                        vec2: 35664,
                        vec3: 35665,
                        vec4: 35666,
                        ivec2: 35667,
                        ivec3: 35668,
                        ivec4: 35669,
                        bvec2: 35671,
                        bvec3: 35672,
                        bvec4: 35673,
                        mat2: 35674,
                        mat3: 35675,
                        mat4: 35676,
                        sampler2D: 35678,
                        samplerCube: 35680
                    };
                }, "_splitToWordExps3", function () {
                    return this._splitToWordExps3 = new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]", "g");
                }]), t;
        }(), me = function () {
            function t() {
                this.json = null;
            }
            return r(t, "laya.components.Prefab"), t.prototype.create = function () {
                return this.json ? pt.createByData(null, this.json) : null;
            }, t;
        }(), ge = function () {
            function t() { }
            r(t, "laya.display.cmd.FillBorderWordsCmd");
            var e = t.prototype;
            return e.recover = function () {
                this.words = null, V.recover("FillBorderWordsCmd", this);
            }, e.run = function (t, e, i) {
                t.fillBorderWords(this.words, this.x + e, this.y + i, this.font, this.fillColor, this.borderColor, this.lineWidth);
            }, a(0, e, "cmdID", function () {
                return "FillBorderWords";
            }), t.create = function (e, i, n, r, a, s, o) {
                var l = V.getItemByClass("FillBorderWordsCmd", t);
                return l.words = e, l.x = i, l.y = n, l.font = r, l.fillColor = a, l.borderColor = s,
                    l.lineWidth = o, l;
            }, t.ID = "FillBorderWords", t;
        }(), ye = function () {
            function t() {
                this._hit = null, this._unHit = null;
            }
            r(t, "laya.utils.HitArea");
            var e = t.prototype;
            return e.contains = function (e, i) {
                return !!t._isHitGraphic(e, i, this.hit) && !t._isHitGraphic(e, i, this.unHit);
            }, a(0, e, "hit", function () {
                return this._hit || (this._hit = new Zt()), this._hit;
            }, function (t) {
                this._hit = t;
            }), a(0, e, "unHit", function () {
                return this._unHit || (this._unHit = new Zt()), this._unHit;
            }, function (t) {
                this._unHit = t;
            }), t._isHitGraphic = function (e, i, n) {
                if (!n) return !1;
                var r = n.cmds;
                if (!r && n._one && ((r = t._cmds).length = 1, r[0] = n._one), !r) return !1;
                var a, s, o = 0;
                for (a = r.length, o = 0; o < a; o++) if (s = r[o]) {
                    switch (s.cmdID) {
                        case "Translate":
                            e -= s.tx, i -= s.ty;
                    }
                    if (t._isHitCmd(e, i, s)) return !0;
                }
                return !1;
            }, t._isHitCmd = function (e, i, n) {
                if (!n) return !1;
                var r = !1;
                switch (n.cmdID) {
                    case "DrawRect":
                        t._rect.setTo(n.x, n.y, n.width, n.height), r = t._rect.contains(e, i);
                        break;

                    case "DrawCircle":
                        r = (e -= n.x) * e + (i -= n.y) * i < n.radius * n.radius;
                        break;

                    case "DrawPoly":
                        e -= n.x, i -= n.y, r = t._ptInPolygon(e, i, n.points);
                }
                return r;
            }, t._ptInPolygon = function (e, i, n) {
                var r = t._ptPoint;
                r.setTo(e, i);
                var a, s = 0, o = NaN, l = NaN, h = NaN, u = NaN;
                a = n.length;
                for (var c = 0; c < a; c += 2) {
                    if (o = n[c], l = n[c + 1], h = n[(c + 2) % a], l != (u = n[(c + 3) % a])) if (!(r.y < Math.min(l, u))) if (!(r.y >= Math.max(l, u))) (r.y - l) * (h - o) / (u - l) + o > r.x && s++;
                }
                return s % 2 == 1;
            }, t._cmds = [], n(t, ["_rect", function () {
                return this._rect = new mt();
            }, "_ptPoint", function () {
                return this._ptPoint = new jt();
            }]), t;
        }(), ve = function () {
            function t() { }
            return r(t, "laya.media.SoundManager"), a(1, t, "useAudioMusic", function () {
                return t._useAudioMusic;
            }, function (e) {
                t._useAudioMusic = e, t._musicClass = e ? Ce : null;
            }), a(1, t, "autoStopMusic", function () {
                return t._autoStopMusic;
            }, function (e) {
                i.stage.off("blur", null, t._stageOnBlur), i.stage.off("focus", null, t._stageOnFocus),
                    i.stage.off("visibilitychange", null, t._visibilityChange), t._autoStopMusic = e,
                    e && (i.stage.on("blur", null, t._stageOnBlur), i.stage.on("focus", null, t._stageOnFocus),
                        i.stage.on("visibilitychange", null, t._visibilityChange));
            }), a(1, t, "muted", function () {
                return t._muted;
            }, function (e) {
                e != t._muted && (e && t.stopAllSound(), t.musicMuted = e, t._muted = e);
            }), a(1, t, "musicMuted", function () {
                return t._musicMuted;
            }, function (e) {
                e != t._musicMuted && (e ? (t._bgMusic && t._musicChannel && !t._musicChannel.isStopped ? At.isConchApp ? t._musicChannel._audio && (t._musicChannel._audio.muted = !0) : t._musicChannel.pause() : t._musicChannel = null,
                    t._musicMuted = e) : (t._musicMuted = e, t._bgMusic && t._musicChannel && (At.isConchApp ? t._musicChannel._audio && (t._musicChannel._audio.muted = !1) : t._musicChannel.resume())));
            }), a(1, t, "soundMuted", function () {
                return t._soundMuted;
            }, function (e) {
                t._soundMuted = e;
            }), t.__init__ = function () {
                var e = Ot.window, i = !!(e.AudioContext || e.webkitAudioContext || e.mozAudioContext);
                return i && Ne.initWebAudio(), t._soundClass = i ? Ne : Ce, Ce._initMusicAudio(),
                    t._musicClass = Ce, i;
            }, t.addChannel = function (e) {
                t._channels.indexOf(e) >= 0 || t._channels.push(e);
            }, t.removeChannel = function (e) {
                var i = 0;
                for (i = t._channels.length - 1; i >= 0; i--) t._channels[i] == e && t._channels.splice(i, 1);
            }, t.disposeSoundLater = function (e) {
                t._lastSoundUsedTimeDic[e] = Ot.now(), t._isCheckingDispose || (t._isCheckingDispose = !0,
                    i.timer.loop(5e3, null, t._checkDisposeSound));
            }, t._checkDisposeSound = function () {
                var e, n = Ot.now(), r = !1;
                for (e in t._lastSoundUsedTimeDic) n - t._lastSoundUsedTimeDic[e] > 3e4 ? (delete t._lastSoundUsedTimeDic[e],
                    t.disposeSoundIfNotUsed(e)) : r = !0;
                r || (t._isCheckingDispose = !1, i.timer.clear(null, t._checkDisposeSound));
            }, t.disposeSoundIfNotUsed = function (e) {
                var i = 0;
                for (i = t._channels.length - 1; i >= 0; i--) if (t._channels[i].url == e) return;
                t.destroySound(e);
            }, t._visibilityChange = function () {
                i.stage.isVisibility ? t._stageOnFocus() : t._stageOnBlur();
            }, t._stageOnBlur = function () {
                t._isActive = !1, t._musicChannel && (t._musicChannel.isStopped || (t._blurPaused = !0,
                    t._musicChannel.pause())), t.stopAllSound(), i.stage.once("mousedown", null, t._stageOnFocus);
            }, t._recoverWebAudio = function () {
                Ne.ctx && "running" != Ne.ctx.state && Ne.ctx.resume && Ne.ctx.resume();
            }, t._stageOnFocus = function () {
                t._isActive = !0, t._recoverWebAudio(), i.stage.off("mousedown", null, t._stageOnFocus),
                    t._blurPaused && t._musicChannel && t._musicChannel.isStopped && (t._blurPaused = !1,
                        t._musicChannel.resume());
            }, t.playSound = function (e, n, r, a, s) {

                if (Laya.LocalStorage.getItem("soundsound") == 0
                    || Laya.LocalStorage.getItem("soundsound") == null) {
                    if (void 0 === n && (n = 1), void 0 === s && (s = 0), !t._isActive || !e) return null;
                    if (t._muted) return null;
                    if (t._recoverWebAudio(), (e = Z.formatURL(e)) == t._bgMusic) {
                        if (t._musicMuted) return null;
                    } else {
                        if (At.isConchApp) {
                            var o = ie.getFileExtension(e);
                            if ("wav" != o && "ogg" != o) return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),
                                null;
                        }
                        if (t._soundMuted) return null;
                    }
                    var l, h;
                    return Ot.onMiniGame || Ot.onBDMiniGame || (l = i.loader.getRes(e)), a || (a = t._soundClass),
                        l || ((l = new a()).load(e), Ot.onMiniGame || Ot.onBDMiniGame || Oe.cacheRes(e, l)),
                        (h = l.play(s, n)) ? (h.url = e, h.volume = e == t._bgMusic ? t.musicVolume : t.soundVolume,
                            h.completeHandler = r, h) : null;
                }




            },



                t.destroySound = function (t) {
                    var e = i.loader.getRes(t);
                    e && (Oe.clearRes(t), e.dispose());
                }, t.playMusic = function (e, i, n, r) {
                    return void 0 === i && (i = 0), void 0 === r && (r = 0), e = Z.formatURL(e), t._bgMusic = e,
                        t._musicChannel && t._musicChannel.stop(), t._musicChannel = t.playSound(e, i, n, t._musicClass, r);
                }, t.stopSound = function (e) {
                    e = Z.formatURL(e);
                    var i, n = 0;
                    for (n = t._channels.length - 1; n >= 0; n--) (i = t._channels[n]).url == e && i.stop();
                }, t.stopAll = function () {
                    t._bgMusic = null;
                    var e = 0;
                    for (e = t._channels.length - 1; e >= 0; e--) t._channels[e].stop();
                }, t.stopAllSound = function () {
                    var e, i = 0;
                    for (i = t._channels.length - 1; i >= 0; i--) (e = t._channels[i]).url != t._bgMusic && e.stop();
                }, t.stopMusic = function () {
                    t._musicChannel && t._musicChannel.stop(), t._bgMusic = null;
                }, t.setSoundVolume = function (e, i) {
                    if (i) i = Z.formatURL(i), t._setVolume(i, e); else {
                        t.soundVolume = e;
                        var n, r = 0;
                        for (r = t._channels.length - 1; r >= 0; r--) (n = t._channels[r]).url != t._bgMusic && (n.volume = e);
                    }
                }, t.setMusicVolume = function (e) {
                    t.musicVolume = e, t._setVolume(t._bgMusic, e);
                }, t._setVolume = function (e, i) {
                    e = Z.formatURL(e);
                    var n, r = 0;
                    for (r = t._channels.length - 1; r >= 0; r--) (n = t._channels[r]).url == e && (n.volume = i);
                }, t.musicVolume = 1, t.soundVolume = 1, t.playbackRate = 1, t._useAudioMusic = !0,
                t._muted = !1, t._soundMuted = !1, t._musicMuted = !1, t._bgMusic = null, t._musicChannel = null,
                t._channels = [], t._autoStopMusic = !1, t._blurPaused = !1, t._isActive = !0, t._soundClass = null,
                t._musicClass = null, t._lastSoundUsedTimeDic = {}, t._isCheckingDispose = !1, t.autoReleaseSound = !0,
                t;
        }(), Se = function (t) {
            function e(t) {
                void 0 === t && (t = 1e4), e.__super.call(this, t);
            }
            r(e, "laya.webgl.submit.SubmitTexture", t);
            var i = e.prototype;
            return i.clone = function (t, i, n) {
                var r = e._poolSize ? e.POOL[--e._poolSize] : new e();
                return this._cloneInit(r, t, i, n), r;
            }, i.releaseRender = function () {
                --this._ref < 1 && (e.POOL[e._poolSize++] = this, this.shaderValue.release(), this._mesh = null,
                    this._parent && (this._parent.releaseRender(), this._parent = null));
            }, i.renderSubmit = function () {
                if (0 === this._numEle) return 1;
                var t = this.shaderValue.textureHost;
                if (t) {
                    var e = t ? t._getSource() : null;
                    if (!e) return 1;
                }
                var i = Ct.mainContext;
                this._mesh.useMesh(i);
                var n = h.preRender, r = h.preRender._key;
                return 0 === this._key.blendShader && this._key.submitType === r.submitType && this._key.blendShader === r.blendShader && qe.activeShader && h.preRender.clipInfoID == this.clipInfoID && n.shaderValue.defines._value === this.shaderValue.defines._value && 0 == (this.shaderValue.defines._value & Re.NOOPTMASK) ? qe.activeShader.uploadTexture2D(e) : (de.activeBlendFunction !== this._blendFn && (nt.setBlend(i, !0),
                    this._blendFn(i), de.activeBlendFunction = this._blendFn), this.shaderValue.texture = e,
                    this.shaderValue.upload()), i.drawElements(4, this._numEle, 5123, this._startIdx),
                    b.renderBatches++, b.trianglesFaces += this._numEle / 3, 1;
            }, e.create = function (t, i, n) {
                var r = e._poolSize ? e.POOL[--e._poolSize] : new e(10016);
                r._mesh = i, r._key.clear(), r._key.submitType = 2, r._ref = 1, r._startIdx = i.indexNum * dt.BYTES_PIDX,
                    r._numEle = 0;
                var a = t._nBlendType;
                if (r._key.blendShader = a, r._blendFn = t._targets ? de.targetFns[a] : de.fns[a],
                    r.shaderValue = n, t._colorFiler) {
                    var s = t._colorFiler;
                    n.defines.add(s.type), n.colorMat = s._mat, n.colorAlpha = s._alpha;
                }
                return r;
            }, e._poolSize = 0, e.POOL = [], e;
        }(h), Te = function (t) {
            function e(t) {
                e.__super.call(this), t || (t = this._copyMatrix(e.IDENTITY_MATRIX)), this._mat = new Float32Array(16),
                    this._alpha = new Float32Array(4), this.setByMatrix(t);
            }
            r(e, "laya.filters.ColorFilter", t);
            var s = e.prototype;
            return i.imps(s, {
                "laya.filters.IFilter": !0
            }), s.gray = function () {
                return this.setByMatrix(e.GRAY_MATRIX);
            }, s.color = function (t, e, i, n) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0),
                    void 0 === n && (n = 1), this.setByMatrix([1, 0, 0, 0, t, 0, 1, 0, 0, e, 0, 0, 1, 0, i, 0, 0, 0, 1, n]);
            }, s.setColor = function (t) {
                var e = o.create(t).arrColor, i = [0, 0, 0, 0, 256 * e[0], 0, 0, 0, 0, 256 * e[1], 0, 0, 0, 0, 256 * e[2], 0, 0, 0, 1, 0];
                return this.setByMatrix(i);
            }, s.setByMatrix = function (t) {
                this._matrix != t && this._copyMatrix(t);
                for (var e = 0, i = 0, n = 0; n < 20; n++) n % 5 != 4 ? this._mat[e++] = t[n] : this._alpha[i++] = t[n];
                return this;
            }, s.adjustColor = function (t, e, i, n) {
                return this.adjustHue(n), this.adjustContrast(e), this.adjustBrightness(t), this.adjustSaturation(i),
                    this;
            }, s.adjustBrightness = function (t) {
                return 0 == (t = this._clampValue(t, 100)) || isNaN(t) ? this : this._multiplyMatrix([1, 0, 0, 0, t, 0, 1, 0, 0, t, 0, 0, 1, 0, t, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);
            }, s.adjustContrast = function (t) {
                if (0 == (t = this._clampValue(t, 100)) || isNaN(t)) return this;
                var i = NaN, n = (i = t < 0 ? 127 + t / 100 * 127 : 127 * (i = 0 == (i = t % 1) ? e.DELTA_INDEX[t] : e.DELTA_INDEX[t << 0] * (1 - i) + e.DELTA_INDEX[1 + (t << 0)] * i) + 127) / 127, r = .5 * (127 - i);
                return this._multiplyMatrix([n, 0, 0, 0, r, 0, n, 0, 0, r, 0, 0, n, 0, r, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);
            }, s.adjustSaturation = function (t) {
                if (0 == (t = this._clampValue(t, 100)) || isNaN(t)) return this;
                var e = 1 + (t > 0 ? 3 * t / 100 : t / 100), i = 1 - e, n = .3086 * i, r = .6094 * i, a = .082 * i;
                return this._multiplyMatrix([n + e, r, a, 0, 0, n, r + e, a, 0, 0, n, r, a + e, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);
            }, s.adjustHue = function (t) {
                if (0 == (t = this._clampValue(t, 180) / 180 * Math.PI) || isNaN(t)) return this;
                var e = Math.cos(t), i = Math.sin(t), n = .213, r = .715, a = .072;
                return this._multiplyMatrix([n + e * (1 - n) + i * -n, r + e * -r + i * -r, a + e * -a + i * (1 - a), 0, 0, n + e * -n + .143 * i, r + e * (1 - r) + .14 * i, a + e * -a + -.283 * i, 0, 0, n + e * -n + -.787 * i, r + e * -r + i * r, a + e * (1 - a) + i * a, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);
            }, s.reset = function () {
                return this.setByMatrix(this._copyMatrix(e.IDENTITY_MATRIX));
            }, s._multiplyMatrix = function (t) {
                var e = [];
                this._matrix = this._fixMatrix(this._matrix);
                for (var i = 0; i < 5; i++) {
                    for (var n = 0; n < 5; n++) e[n] = this._matrix[n + 5 * i];
                    for (n = 0; n < 5; n++) {
                        for (var r = 0, a = 0; a < 5; a++) r += t[n + 5 * a] * e[a];
                        this._matrix[n + 5 * i] = r;
                    }
                }
                return this.setByMatrix(this._matrix);
            }, s._clampValue = function (t, e) {
                return Math.min(e, Math.max(-e, t));
            }, s._fixMatrix = function (t) {
                return null == t ? e.IDENTITY_MATRIX : (t.length < 25 ? t = t.slice(0, t.length).concat(e.IDENTITY_MATRIX.slice(t.length, 25)) : t.length > 25 && (t = t.slice(0, 25)),
                    t);
            }, s._copyMatrix = function (t) {
                this._matrix || (this._matrix = []);
                for (var e = 0; e < 25; e++) this._matrix[e] = t[e];
                return this._matrix;
            }, a(0, s, "type", function () {
                return 32;
            }), e.LENGTH = 25, n(e, ["DELTA_INDEX", function () {
                return this.DELTA_INDEX = [0, .01, .02, .04, .05, .06, .07, .08, .1, .11, .12, .14, .15, .16, .17, .18, .2, .21, .22, .24, .25, .27, .28, .3, .32, .34, .36, .38, .4, .42, .44, .46, .48, .5, .53, .56, .59, .62, .65, .68, .71, .74, .77, .8, .83, .86, .89, .92, .95, .98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10];
            }, "GRAY_MATRIX", function () {
                return this.GRAY_MATRIX = [.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0];
            }, "IDENTITY_MATRIX", function () {
                return this.IDENTITY_MATRIX = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];
            }]), e;
        }(c), Ee = function (t) {
            function e() {
                this._matrix = new at(), this._matrix4 = dt.defaultMatrix4.concat(), e.__super.call(this, 1e4),
                    this.shaderValue = new H(0, 0);
            }
            r(e, "laya.webgl.submit.SubmitCanvas", t);
            var i = e.prototype;
            return i.renderSubmit = function () {
                var t = ft.worldAlpha, e = ft.worldMatrix4, i = ft.worldMatrix, n = ft.worldFilters, r = ft.worldShaderDefines, a = this.shaderValue, s = this._matrix, o = this._matrix4, l = at.TEMP;
                return at.mul(s, i, l), o[0] = l.a, o[1] = l.b, o[4] = l.c, o[5] = l.d, o[12] = l.tx,
                    o[13] = l.ty, ft.worldMatrix = l.clone(), ft.worldMatrix4 = o, ft.worldAlpha = ft.worldAlpha * a.alpha,
                    a.filters && a.filters.length && (ft.worldFilters = a.filters, ft.worldShaderDefines = a.defines),
                    this.canv.flushsubmit(), ft.worldAlpha = t, ft.worldMatrix4 = e, ft.worldMatrix.destroy(),
                    ft.worldMatrix = i, ft.worldFilters = n, ft.worldShaderDefines = r, 1;
            }, i.releaseRender = function () {
                if (--this._ref < 1) {
                    var t = e.POOL;
                    this._mesh = null, t[t._length++] = this;
                }
            }, i.clone = function (t, e, i) {
                return null;
            }, i.getRenderType = function () {
                return 10003;
            }, e.create = function (t, i, n) {
                var r = e.POOL._length ? e.POOL[--e.POOL._length] : new e();
                r.canv = t, r._ref = 1, r._numEle = 0;
                var a = r.shaderValue;
                return a.alpha = i, a.defines.setValue(0), n && n.length && a.setFilters(n), r;
            }, e.POOL = [], e.__init$ = function () {
                e.POOL._length = 0;
            }, e;
        }(h), Ce = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.components.Script", t);
            var n = e.prototype;
            n._onAwake = function () {
                this.onAwake(), this.onStart !== laya.components.Script.prototype.onStart && i.startTimer.callLater(this, this.onStart);
            }, n._onEnable = function () {
                var t = laya.components.Script.prototype;
                this.onTriggerEnter !== t.onTriggerEnter && this.owner.on("triggerenter", this, this.onTriggerEnter),
                    this.onTriggerStay !== t.onTriggerStay && this.owner.on("triggerstay", this, this.onTriggerStay),
                    this.onTriggerExit !== t.onTriggerExit && this.owner.on("triggerexit", this, this.onTriggerExit),
                    this.onMouseDown !== t.onMouseDown && this.owner.on("mousedown", this, this.onMouseDown),
                    this.onMouseUp !== t.onMouseUp && this.owner.on("mouseup", this, this.onMouseUp),
                    this.onClick !== t.onClick && this.owner.on("click", this, this.onClick), this.onStageMouseDown !== t.onStageMouseDown && i.stage.on("mousedown", this, this.onStageMouseDown),
                    this.onStageMouseUp !== t.onStageMouseUp && i.stage.on("mouseup", this, this.onStageMouseUp),
                    this.onStageClick !== t.onStageClick && i.stage.on("click", this, this.onStageClick),
                    this.onStageMouseMove !== t.onStageMouseMove && i.stage.on("mousemove", this, this.onStageMouseMove),
                    this.onDoubleClick !== t.onDoubleClick && this.owner.on("doubleclick", this, this.onDoubleClick),
                    this.onRightClick !== t.onRightClick && this.owner.on("rightclick", this, this.onRightClick),
                    this.onMouseMove !== t.onMouseMove && this.owner.on("mousemove", this, this.onMouseMove),
                    this.onMouseOver !== t.onMouseOver && this.owner.on("mouseover", this, this.onMouseOver),
                    this.onMouseOut !== t.onMouseOut && this.owner.on("mouseout", this, this.onMouseOut),
                    this.onKeyDown !== t.onKeyDown && i.stage.on("keydown", this, this.onKeyDown), this.onKeyPress !== t.onKeyPress && i.stage.on("keypress", this, this.onKeyPress),
                    this.onKeyUp !== t.onKeyUp && i.stage.on("keyup", this, this.onKeyUp), this.onUpdate !== t.onUpdate && i.updateTimer.frameLoop(1, this, this.onUpdate),
                    this.onLateUpdate !== t.onLateUpdate && i.lateTimer.frameLoop(1, this, this.onLateUpdate),
                    this.onPreRender !== t.onPreRender && i.lateTimer.frameLoop(1, this, this.onPreRender);
            }, n._onDisable = function () {
                this.owner.offAllCaller(this), i.stage.offAllCaller(this), i.startTimer.clearAll(this),
                    i.updateTimer.clearAll(this), i.lateTimer.clearAll(this);
            }, n._isScript = function () {
                return !0;
            }, n._onDestroy = function () {
                this.onDestroy();
            }, n.onAwake = function () { }, n.onEnable = function () { }, n.onStart = function () { },
                n.onTriggerEnter = function (t, e, i) { }, n.onTriggerStay = function (t, e, i) { },
                n.onTriggerExit = function (t, e, i) { }, n.onMouseDown = function (t) { }, n.onMouseUp = function (t) { },
                n.onClick = function (t) { }, n.onStageMouseDown = function (t) { }, n.onStageMouseUp = function (t) { },
                n.onStageClick = function (t) { }, n.onStageMouseMove = function (t) { }, n.onDoubleClick = function (t) { },
                n.onRightClick = function (t) { }, n.onMouseMove = function (t) { }, n.onMouseOver = function (t) { },
                n.onMouseOut = function (t) { }, n.onKeyDown = function (t) { }, n.onKeyPress = function (t) { },
                n.onKeyUp = function (t) { }, n.onUpdate = function () { }, n.onLateUpdate = function () { },
                n.onPreRender = function () { }, n.onPostRender = function () { }, n.onDisable = function () { },
                n.onDestroy = function () { }, a(0, n, "isSingleton", function () {
                    return !1;
                });
        }(p), function (t) {
            function e() {
                this.url = null, this.audio = null, this.loaded = !1, e.__super.call(this);
            }
            r(e, "laya.media.h5audio.AudioSound", t);
            var i = e.prototype;
            return i.dispose = function () {
                var t = e._audioCache[this.url];
                V.clearBySign("audio:" + this.url), t && (At.isConchApp || (t.src = ""), delete e._audioCache[this.url]);
            }, i.load = function (t) {
                var i;
                if (t = Z.formatURL(t), this.url = t, t == ve._bgMusic ? (e._initMusicAudio(), (i = e._musicAudio).src != t && (e._audioCache[i.src] = null,
                    i = null)) : i = e._audioCache[t], i && i.readyState >= 2) this.event("complete"); else {
                    i || (t == ve._bgMusic ? (e._initMusicAudio(), i = e._musicAudio) : i = Ot.createElement("audio"),
                        e._audioCache[t] = i, i.src = t), i.addEventListener("canplaythrough", r), i.addEventListener("error", a);
                    var n = this;
                    this.audio = i, i.load ? i.load() : a();
                }
                function r() {
                    s(), n.loaded = !0, n.event("complete");
                }
                function a() {
                    i.load = null, s(), n.event("error");
                }
                function s() {
                    i.removeEventListener("canplaythrough", r), i.removeEventListener("error", a);
                }
            }, i.play = function (t, i) {
                if (void 0 === t && (t = 0), void 0 === i && (i = 0), !this.url) return null;
                var n, r;
                if (!(n = this.url == ve._bgMusic ? e._musicAudio : e._audioCache[this.url])) return null;
                r = V.getItem("audio:" + this.url), At.isConchApp ? r || ((r = Ot.createElement("audio")).src = this.url) : this.url == ve._bgMusic ? (e._initMusicAudio(),
                    (r = e._musicAudio).src = this.url) : r = r || n.cloneNode(!0);
                var a = new $e(r);
                return a.url = this.url, a.loops = i, a.startTime = t, a.play(), ve.addChannel(a),
                    a;
            }, a(0, i, "duration", function () {
                var t;
                return (t = e._audioCache[this.url]) ? t.duration : 0;
            }), e._initMusicAudio = function () {
                e._musicAudio || (e._musicAudio || (e._musicAudio = Ot.createElement("audio")),
                    At.isConchApp || Ot.document.addEventListener("mousedown", e._makeMusicOK));
            }, e._makeMusicOK = function () {
                Ot.document.removeEventListener("mousedown", e._makeMusicOK), e._musicAudio.src ? e._musicAudio.play() : (e._musicAudio.src = "",
                    e._musicAudio.load());
            }, e._audioCache = {}, e._musicAudio = null, e;
        }(m)), xe = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.media.Sound", t);
            var i = e.prototype;
            i.load = function (t) { }, i.play = function (t, e) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), null;
            }, i.dispose = function () { }, a(0, i, "duration", function () {
                return 0;
            });
        }(m), function (t) {
            function e(t) {
                e.__super.call(this, 116, 4 * t * 116, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshParticle2D._fixattriInfo),
                    this.createQuadIB(t), this._quadNum = t;
            }
            r(e, "laya.webgl.utils.MeshParticle2D", t);
            var i = e.prototype;
            i.setMaxParticleNum = function (t) {
                this._vb._resizeBuffer(4 * t * 116, !1), this.createQuadIB(t);
            }, i.releaseMesh = function () {
                this._vb.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshParticle2D._POOL.push(this);
            }, i.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._vb.deleteBuffer();
            }, e.getAMesh = function (t) {
                if (laya.webgl.utils.MeshParticle2D._POOL.length) {
                    var i = laya.webgl.utils.MeshParticle2D._POOL.pop();
                    return i.setMaxParticleNum(t), i;
                }
                return new e(t);
            }, e.const_stride = 116, e._POOL = [], n(e, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5126, 3, 16, 5126, 3, 28, 5126, 4, 40, 5126, 4, 56, 5126, 3, 72, 5126, 2, 84, 5126, 4, 92, 5126, 1, 108, 5126, 1, 112];
            }]);
        }(E), function (t) {
            function e() {
                this._bits = 0, this._parent = null, this.name = "", this.destroyed = !1, this._conchData = null,
                    this._components = null, this._activeChangeScripts = null, this._scene = null, e.__super.call(this),
                    this._children = e.ARRAY_EMPTY, this._extUIChild = e.ARRAY_EMPTY, this.createGLBuffer();
            }
            r(e, "laya.display.Node", t);
            var n = e.prototype;
            return n.createGLBuffer = function () { }, n._setBit = function (t, e) {
                16 === t && (this._getBit(t) != e && this._updateDisplayedInstage());
                e ? this._bits |= t : this._bits &= ~t;
            }, n._getBit = function (t) {
                return 0 != (this._bits & t);
            }, n._setUpNoticeChain = function () {
                this._getBit(16) && this._setBitUp(16);
            }, n._setBitUp = function (t) {
                var e = this;
                for (e._setBit(t, !0), e = e._parent; e;) {
                    if (e._getBit(t)) return;
                    e._setBit(t, !0), e = e._parent;
                }
            }, n.on = function (t, e, i, n) {
                return "display" !== t && "undisplay" !== t || this._getBit(16) || this._setBitUp(16),
                    this._createListener(t, e, i, n, !1);
            }, n.once = function (t, e, i, n) {
                return "display" !== t && "undisplay" !== t || this._getBit(16) || this._setBitUp(16),
                    this._createListener(t, e, i, n, !0);
            }, n.destroy = function (t) {
                void 0 === t && (t = !0), this.destroyed = !0, this._destroyAllComponent(), this._parent && this._parent.removeChild(this),
                    this._children && (t ? this.destroyChildren() : this.removeChildren()), this.onDestroy(),
                    this._children = null, this.offAll();
            }, n.onDestroy = function () { }, n.destroyChildren = function () {
                if (this._children) for (var t = 0, e = this._children.length; t < e; t++) this._children[0].destroy(!0);
            }, n.addChild = function (t) {
                if (!t || this.destroyed || t === this) return t;
                if (t._zOrder && this._setBit(32, !0), t._parent === this) {
                    var i = this.getChildIndex(t);
                    i !== this._children.length - 1 && (this._children.splice(i, 1), this._children.push(t),
                        this._childChanged());
                } else t._parent && t._parent.removeChild(t), this._children === e.ARRAY_EMPTY && (this._children = []),
                    this._children.push(t), t._setParent(this), this._childChanged();
                return t;
            }, n.addInputChild = function (t) {
                if (this._extUIChild == e.ARRAY_EMPTY) this._extUIChild = [t]; else {
                    if (this._extUIChild.indexOf(t) >= 0) return null;
                    this._extUIChild.push(t);
                }
                return null;
            }, n.removeInputChild = function (t) {
                var e = this._extUIChild.indexOf(t);
                e >= 0 && this._extUIChild.splice(e, 1);
            }, n.addChildren = function (t) {
                for (var e = arguments, i = 0, n = e.length; i < n;) this.addChild(e[i++]);
            }, n.addChildAt = function (t, i) {
                if (!t || this.destroyed || t === this) return t;
                if (t._zOrder && this._setBit(32, !0), i >= 0 && i <= this._children.length) {
                    if (t._parent === this) {
                        var n = this.getChildIndex(t);
                        this._children.splice(n, 1), this._children.splice(i, 0, t), this._childChanged();
                    } else t._parent && t._parent.removeChild(t), this._children === e.ARRAY_EMPTY && (this._children = []),
                        this._children.splice(i, 0, t), t._setParent(this);
                    return t;
                }
                throw new Error("appendChildAt:The index is out of bounds");
            }, n.getChildIndex = function (t) {
                return this._children.indexOf(t);
            }, n.getChildByName = function (t) {
                var e = this._children;
                if (e) for (var i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    if (r.name === t) return r;
                }
                return null;
            }, n.getChildAt = function (t) {
                return this._children[t] || null;
            }, n.setChildIndex = function (t, e) {
                var i = this._children;
                if (e < 0 || e >= i.length) throw new Error("setChildIndex:The index is out of bounds.");
                var n = this.getChildIndex(t);
                if (n < 0) throw new Error("setChildIndex:node is must child of this object.");
                return i.splice(n, 1), i.splice(e, 0, t), this._childChanged(), t;
            }, n._childChanged = function (t) { }, n.removeChild = function (t) {
                if (!this._children) return t;
                var e = this._children.indexOf(t);
                return this.removeChildAt(e);
            }, n.removeSelf = function () {
                return this._parent && this._parent.removeChild(this), this;
            }, n.removeChildByName = function (t) {
                var e = this.getChildByName(t);
                return e && this.removeChild(e), e;
            }, n.removeChildAt = function (t) {
                var e = this.getChildAt(t);
                return e && (this._children.splice(t, 1), e._setParent(null)), e;
            }, n.removeChildren = function (t, i) {
                if (void 0 === t && (t = 0), void 0 === i && (i = 2147483647), this._children && this._children.length > 0) {
                    var n = this._children;
                    if (0 === t && i >= n.length - 1) {
                        var r = n;
                        this._children = e.ARRAY_EMPTY;
                    } else r = n.splice(t, i - t);
                    for (var a = 0, s = r.length; a < s; a++) r[a]._setParent(null);
                }
                return this;
            }, n.replaceChild = function (t, e) {
                var i = this._children.indexOf(e);
                return i > -1 ? (this._children.splice(i, 1, t), e._setParent(null), t._setParent(this),
                    t) : null;
            }, n._setParent = function (t) {
                this._parent !== t && (t ? (this._parent = t, this._onAdded(), this.event("added"),
                    this._getBit(16) && (this._setUpNoticeChain(), t.displayedInStage && this._displayChild(this, !0)),
                    t._childChanged(this)) : (this._onRemoved(), this.event("removed"), this._parent._childChanged(),
                        this._getBit(16) && this._displayChild(this, !1), this._parent = t));
            }, n._updateDisplayedInstage = function () {
                var t;
                t = this;
                for (var e = i.stage, n = !1; t;) {
                    if (t._getBit(16)) {
                        n = t._getBit(128);
                        break;
                    }
                    if (t === e || t._getBit(128)) {
                        n = !0;
                        break;
                    }
                    t = t._parent;
                }
                this._setBit(128, n);
            }, n._setDisplay = function (t) {
                this._getBit(128) !== t && (this._setBit(128, t), t ? this.event("display") : this.event("undisplay"));
            }, n._displayChild = function (t, e) {
                var i = t._children;
                if (i) for (var n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    a._getBit(16) && (a._children.length > 0 ? this._displayChild(a, e) : a._setDisplay(e));
                }
                t._setDisplay(e);
            }, n.contains = function (t) {
                if (t === this) return !0;
                for (; t;) {
                    if (t._parent === this) return !0;
                    t = t._parent;
                }
                return !1;
            }, n.timerLoop = function (t, e, n, r, a, s) {
                void 0 === a && (a = !0), void 0 === s && (s = !1), (this.scene ? this.scene.timer : i.timer).loop(t, e, n, r, a, s);
            }, n.timerOnce = function (t, e, n, r, a) {
                void 0 === a && (a = !0), (this.scene ? this.scene.timer : i.timer)._create(!1, !1, t, e, n, r, a);
            }, n.frameLoop = function (t, e, n, r, a) {
                void 0 === a && (a = !0), (this.scene ? this.scene.timer : i.timer)._create(!0, !0, t, e, n, r, a);
            }, n.frameOnce = function (t, e, n, r, a) {
                void 0 === a && (a = !0), (this.scene ? this.scene.timer : i.timer)._create(!0, !1, t, e, n, r, a);
            }, n.clearTimer = function (t, e) {
                (this.scene ? this.scene.timer : i.timer).clear(t, e);
            }, n.callLater = function (t, e) {
                (this.scene ? this.scene.timer : i.timer).callLater(this, t, e);
            }, n.runCallLater = function (t) {
                (this.scene ? this.scene.timer : i.timer).runCallLater(this, t);
            }, n._onActive = function () {
                b.spriteCount++;
            }, n._onInActive = function () {
                b.spriteCount--;
            }, n._onActiveInScene = function () { }, n._onInActiveInScene = function () { }, n._parse = function (t, e) { },
                n._setBelongScene = function (t) {
                    if (!this._scene) {
                        if (this._scene = t, this._components) for (var e = 0, i = this._components.length; e < i; e++) this._components[e]._setActiveInScene(!0);
                        for (this._onActiveInScene(), e = 0, i = this._children.length; e < i; e++) this._children[e]._setBelongScene(t);
                    }
                }, n._setUnBelongScene = function () {
                    if (this._scene !== this) {
                        if (this._onInActiveInScene(), this._components) for (var t = 0, e = this._components.length; t < e; t++) this._components[t]._setActiveInScene(!1);
                        for (this._scene = null, t = 0, e = this._children.length; t < e; t++) this._children[t]._setUnBelongScene();
                    }
                }, n.onAwake = function () { }, n.onEnable = function () { }, n._processActive = function () {
                    this._activeChangeScripts || (this._activeChangeScripts = []), this._activeHierarchy(this._activeChangeScripts),
                        this._activeScripts();
                }, n._activeHierarchy = function (t) {
                    if (this._setBit(2, !0), this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                        var n = this._components[e];
                        n._setActive(!0), n._isScript() && n._enabled && t.push(n);
                    }
                    for (this._onActive(), e = 0, i = this._children.length; e < i; e++) {
                        var r = this._children[e];
                        !r._getBit(1) && r._activeHierarchy(t);
                    }
                    this._getBit(4) || (this._setBit(4, !0), this.onAwake()), this.onEnable();
                }, n._activeScripts = function () {
                    for (var t = 0, e = this._activeChangeScripts.length; t < e; t++) this._activeChangeScripts[t].onEnable();
                    this._activeChangeScripts.length = 0;
                }, n._processInActive = function () {
                    this._activeChangeScripts || (this._activeChangeScripts = []), this._inActiveHierarchy(this._activeChangeScripts),
                        this._inActiveScripts();
                }, n._inActiveHierarchy = function (t) {
                    if (this._onInActive(), this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                        var n = this._components[e];
                        n._setActive(!1), n._isScript() && n._enabled && t.push(n);
                    }
                    for (this._setBit(2, !1), e = 0, i = this._children.length; e < i; e++) {
                        var r = this._children[e];
                        r && !r._getBit(1) && r._inActiveHierarchy(t);
                    }
                    this.onDisable();
                }, n._inActiveScripts = function () {
                    for (var t = 0, e = this._activeChangeScripts.length; t < e; t++) this._activeChangeScripts[t].onDisable();
                    this._activeChangeScripts.length = 0;
                }, n.onDisable = function () { }, n._onAdded = function () {
                    if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw "Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";
                    var t = this._parent.scene;
                    t && this._setBelongScene(t), this._parent.activeInHierarchy && this.active && this._processActive();
                }, n._onRemoved = function () {
                    if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw "Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";
                    this._parent.activeInHierarchy && this.active && this._processInActive(), this._parent.scene && this._setUnBelongScene();
                }, n._addComponentInstance = function (t) {
                    this._components = this._components || [], this._components.push(t), t.owner = this,
                        t._onAdded(), this.activeInHierarchy && (t._setActive(!0), t._isScript() && t._enabled && t.onEnable()),
                        this._scene && t._setActiveInScene(!0);
                }, n._destroyComponent = function (t) {
                    if (this._components) for (var e = 0, i = this._components.length; e < i; e++) {
                        var n = this._components[e];
                        if (n === t) {
                            n._destroy(), this._components.splice(e, 1);
                            break;
                        }
                    }
                }, n._destroyAllComponent = function () {
                    if (this._components) {
                        for (var t = 0, e = this._components.length; t < e; t++) {
                            this._components[t]._destroy();
                        }
                        this._components.length = 0;
                    }
                }, n._cloneTo = function (t, e, i) {
                    var n = t;
                    if (this._components) for (var r = 0, a = this._components.length; r < a; r++) {
                        var s = n.addComponent(this._components[r].constructor);
                        this._components[r]._cloneTo(s);
                    }
                }, n.addComponentIntance = function (t) {
                    if (t.owner) throw "Node:the component has belong to other node.";
                    if (t.isSingleton && this.getComponent(t.constructor)) throw "Node:the component is singleton,can't add the second one.";
                    return this._addComponentInstance(t), t;
                }, n.addComponent = function (t) {
                    var e = V.createByClass(t);
                    if (e._destroyed = !1, e.isSingleton && this.getComponent(t)) throw "无法实例" + t + "组件，" + t + "组件已存在！";
                    return this._addComponentInstance(e), e;
                }, n.getComponent = function (t) {
                    if (this._components) for (var e = 0, n = this._components.length; e < n; e++) {
                        var r = this._components[e];
                        if (i.__typeof(r, t)) return r;
                    }
                    return null;
                }, n.getComponents = function (t) {
                    var e;
                    if (this._components) for (var n = 0, r = this._components.length; n < r; n++) {
                        var a = this._components[n];
                        i.__typeof(a, t) && (e = e || []).push(a);
                    }
                    return e;
                }, a(0, n, "numChildren", function () {
                    return this._children.length;
                }), a(0, n, "parent", function () {
                    return this._parent;
                }), a(0, n, "activeInHierarchy", function () {
                    return this._getBit(2);
                }), a(0, n, "active", function () {
                    return !this._getBit(8) && !this._getBit(1);
                }, function (t) {
                    if (t = !!t, !this._getBit(1) !== t) {
                        if (this._activeChangeScripts && 0 !== this._activeChangeScripts.length) throw t ? "Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event." : "Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";
                        this._setBit(1, !t), this._parent && this._parent.activeInHierarchy && (t ? this._processActive() : this._processInActive());
                    }
                }), a(0, n, "displayedInStage", function () {
                    return this._getBit(16) || this._setBitUp(16), this._getBit(128);
                }), a(0, n, "scene", function () {
                    return this._scene;
                }), a(0, n, "timer", function () {
                    return this.scene ? this.scene.timer : i.timer;
                }), e.ARRAY_EMPTY = [], e;
        }(m)), be = function (t) {
            function e() {
                this.url = null, this.loops = 0, this.startTime = NaN, this.isStopped = !1, this.completeHandler = null,
                    e.__super.call(this);
            }
            r(e, "laya.media.SoundChannel", t);
            var i = e.prototype;
            return i.play = function () { }, i.stop = function () {
                this.completeHandler && this.completeHandler.run();
            }, i.pause = function () { }, i.resume = function () { }, i.__runComplete = function (t) {
                t && t.run();
            }, a(0, i, "volume", function () {
                return 1;
            }, function (t) { }), a(0, i, "position", function () {
                return 0;
            }), a(0, i, "duration", function () {
                return 0;
            }), e;
        }(m), Ie = function (t) {
            function e() {
                this._id = 0, this._url = null, this._cpuMemory = 0, this._gpuMemory = 0, this._destroyed = !1,
                    this._referenceCount = 0, this.lock = !1, this.name = null, e.__super.call(this),
                    this._id = ++e._uniqueIDCounter, this._destroyed = !1, this._referenceCount = 0,
                    e._idResourcesMap[this.id] = this, this.lock = !1;
            }
            r(e, "laya.resource.Resource", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.resource.ICreateResource": !0,
                "laya.resource.IDestroy": !0
            }), n._setCPUMemory = function (t) {
                var i = t - this._cpuMemory;
                this._cpuMemory = t, e._addCPUMemory(i);
            }, n._setGPUMemory = function (t) {
                var i = t - this._gpuMemory;
                this._gpuMemory = t, e._addGPUMemory(i);
            }, n._setCreateURL = function (t) {
                var i;
                (t = Z.formatURL(t), this._url !== t) && (this._url && ((i = e._urlResourcesMap[this._url]).splice(i.indexOf(this), 1),
                    0 === i.length && delete e._urlResourcesMap[this._url]), t && ((i = e._urlResourcesMap[t]) || (e._urlResourcesMap[t] = i = []),
                        i.push(this)), this._url = t);
            }, n._addReference = function (t) {
                void 0 === t && (t = 1), this._referenceCount += t;
            }, n._removeReference = function (t) {
                void 0 === t && (t = 1), this._referenceCount -= t;
            }, n._clearReference = function () {
                this._referenceCount = 0;
            }, n._recoverResource = function () { }, n._disposeResource = function () { }, n._activeResource = function () { },
                n.destroy = function () {
                    var t;
                    this._destroyed || (this._destroyed = !0, this.lock = !1, this._disposeResource(),
                        delete e._idResourcesMap[this.id], this._url && ((t = e._urlResourcesMap[this._url]) && (t.splice(t.indexOf(this), 1),
                            0 === t.length && delete e._urlResourcesMap[this._url]), Oe.getRes(this._url) == this && delete Oe.loadedMap[this._url]));
                }, a(0, n, "id", function () {
                    return this._id;
                }), a(0, n, "gpuMemory", function () {
                    return this._gpuMemory;
                }), a(0, n, "url", function () {
                    return this._url;
                }), a(0, n, "cpuMemory", function () {
                    return this._cpuMemory;
                }), a(0, n, "destroyed", function () {
                    return this._destroyed;
                }), a(0, n, "referenceCount", function () {
                    return this._referenceCount;
                }), a(1, e, "cpuMemory", function () {
                    return this._cpuMemory;
                }, laya.events.EventDispatcher._$SET_cpuMemory), a(1, e, "gpuMemory", function () {
                    return this._gpuMemory;
                }, laya.events.EventDispatcher._$SET_gpuMemory), e._addCPUMemory = function (t) {
                    this._cpuMemory += t;
                }, e._addGPUMemory = function (t) {
                    this._gpuMemory += t;
                }, e._addMemory = function (t, e) {
                    this._cpuMemory += t, this._gpuMemory += e;
                }, e.getResourceByID = function (t) {
                    return e._idResourcesMap[t];
                }, e.getResourceByURL = function (t, i) {
                    return void 0 === i && (i = 0), e._urlResourcesMap[t][i];
                }, e.destroyUnusedResources = function () {
                    for (var t in e._idResourcesMap) {
                        var i = e._idResourcesMap[t];
                        i.lock || 0 !== i._referenceCount || i.destroy();
                    }
                }, e._uniqueIDCounter = 0, e._idResourcesMap = {}, e._urlResourcesMap = {}, e._cpuMemory = 0,
                e._gpuMemory = 0, e;
        }(m), we = function (t) {
            function e() {
                e.__super.call(this, 12, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshVG._fixattriInfo);
            }
            r(e, "laya.webgl.utils.MeshVG", t);
            var i = e.prototype;
            return i.addVertAndIBToMesh = function (t, e, i, n) {
                for (var r = this._vb.needSize(e.length / 2 * 12) >> 2, a = this._vb._floatArray32 || this._vb.getFloat32Array(), s = this._vb._uint32Array, o = 0, l = e.length / 2, h = 0; h < l; h++) a[r++] = e[o],
                    a[r++] = e[o + 1], o += 2, s[r++] = i;
                this._vb.setNeedUpload(), this._ib.append(new Uint16Array(n)), this._ib.setNeedUpload(),
                    this.vertNum += l, this.indexNum += n.length;
            }, i.releaseMesh = function () {
                this._vb.setByteLength(0), this._ib.setByteLength(0), this.vertNum = 0, this.indexNum = 0,
                    laya.webgl.utils.MeshVG._POOL.push(this);
            }, i.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._ib.disposeResource(), this._vb.deleteBuffer();
            }, e.getAMesh = function (t) {
                var i;
                return i = laya.webgl.utils.MeshVG._POOL.length ? laya.webgl.utils.MeshVG._POOL.pop() : new e(),
                    t && i._vb._resizeBuffer(786432, !1), i;
            }, e.const_stride = 12, e._POOL = [], n(e, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 2, 0, 5121, 4, 8];
            }]), e;
        }(E), Ae = function (t) {
            var e;
            function n() {
                this._labelDic = null, this._tweenDic = {}, this._tweenDataList = [], this._endTweenDataList = null,
                    this._currTime = 0, this._lastTime = 0, this._startTime = 0, this._index = 0, this._gidIndex = 0,
                    this._firstTweenDic = {}, this._startTimeSort = !1, this._endTimeSort = !1, this._loopKey = !1,
                    this.scale = 1, this._frameRate = 60, this._frameIndex = 0, this._total = 0, n.__super.call(this);
            }
            r(n, "laya.utils.TimeLine", t);
            var s = n.prototype;
            return s.to = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), this._create(t, e, i, n, r, !0);
            }, s.from = function (t, e, i, n, r) {
                return void 0 === r && (r = 0), this._create(t, e, i, n, r, !1);
            }, s._create = function (t, i, n, r, a, s) {
                var o = V.getItemByClass("tweenData", e);
                return o.isTo = s, o.type = 0, o.target = t, o.duration = n, o.data = i, o.startTime = this._startTime + a,
                    o.endTime = o.startTime + o.duration, o.ease = r, this._startTime = Math.max(o.endTime, this._startTime),
                    this._tweenDataList.push(o), this._startTimeSort = !0, this._endTimeSort = !0, this;
            }, s.addLabel = function (t, i) {
                var n = V.getItemByClass("tweenData", e);
                return n.type = 1, n.data = t, n.endTime = n.startTime = this._startTime + i, this._labelDic || (this._labelDic = {}),
                    this._labelDic[t] = n, this._tweenDataList.push(n), this;
            }, s.removeLabel = function (t) {
                if (this._labelDic && this._labelDic[t]) {
                    var e = this._labelDic[t];
                    if (e) {
                        var i = this._tweenDataList.indexOf(e);
                        i > -1 && this._tweenDataList.splice(i, 1);
                    }
                    delete this._labelDic[t];
                }
            }, s.gotoTime = function (t) {
                if (null != this._tweenDataList && 0 != this._tweenDataList.length) {
                    var e, i, n, r;
                    for (var a in this._firstTweenDic) if (i = this._firstTweenDic[a]) for (var s in i) i.diyTarget.hasOwnProperty(s) && (i.diyTarget[s] = i[s]);
                    for (a in this._tweenDic) (e = this._tweenDic[a]).clear(), delete this._tweenDic[a];
                    if (this._index = 0, this._gidIndex = 0, this._currTime = t, this._lastTime = Ot.now(),
                        null == this._endTweenDataList || this._endTimeSort) {
                        this._endTimeSort = !1, this._endTweenDataList = n = this._tweenDataList.concat(),
                            n.sort(function (t, e) {
                                return t.endTime > e.endTime ? 1 : t.endTime < e.endTime ? -1 : 0;
                            });
                    } else n = this._endTweenDataList;
                    for (var o = 0, l = n.length; o < l; o++) if (0 == (r = n[o]).type) {
                        if (!(t >= r.endTime)) break;
                        this._index = Math.max(this._index, o + 1);
                        var h = r.data;
                        if (r.isTo) for (var u in h) r.target[u] = h[u];
                    }
                    for (o = 0, l = this._tweenDataList.length; o < l; o++) 0 == (r = this._tweenDataList[o]).type && t >= r.startTime && t < r.endTime && (this._index = Math.max(this._index, o + 1),
                        this._gidIndex++, (e = V.getItemByClass("tween", X))._create(r.target, r.data, r.duration, r.ease, g.create(this, this._animComplete, [this._gidIndex]), 0, !1, r.isTo, !0, !1),
                        e.setStartTime(this._currTime - (t - r.startTime)), e._updateEase(this._currTime),
                        e.gid = this._gidIndex, this._tweenDic[this._gidIndex] = e);
                }
            }, s.gotoLabel = function (t) {
                if (null != this._labelDic) {
                    var e = this._labelDic[t];
                    e && this.gotoTime(e.startTime);
                }
            }, s.pause = function () {
                i.timer.clear(this, this._update);
            }, s.resume = function () {
                this.play(this._currTime, this._loopKey);
            }, s.play = function (t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = !1), this._tweenDataList) {
                    if (this._startTimeSort) {
                        this._startTimeSort = !1, this._tweenDataList.sort(function (t, e) {
                            return t.startTime > e.startTime ? 1 : t.startTime < e.startTime ? -1 : 0;
                        });
                        for (var n = 0, r = this._tweenDataList.length; n < r; n++) {
                            var a = this._tweenDataList[n];
                            if (null != a && 0 == a.type) {
                                var s = a.target, o = s.$_GID || (s.$_GID = ie.getGID()), l = null;
                                for (var h in null == this._firstTweenDic[o] ? ((l = {}).diyTarget = s, this._firstTweenDic[o] = l) : l = this._firstTweenDic[o],
                                    a.data) null == l[h] && (l[h] = s[h]);
                            }
                        }
                    }
                    "string" == typeof t ? this.gotoLabel(t) : this.gotoTime(t), this._loopKey = e,
                        this._lastTime = Ot.now(), i.timer.frameLoop(1, this, this._update);
                }
            }, s._update = function () {
                if (this._currTime >= this._startTime) {
                    if (!this._loopKey) {
                        for (var t in this._tweenDic) (e = this._tweenDic[t]).complete();
                        return this._complete(), void this.pause();
                    }
                    if (this._complete(), !this._tweenDataList) return;
                    this.gotoTime(0);
                }
                var e, i = Ot.now(), n = i - this._lastTime, r = this._currTime += n * this.scale;
                for (t in this._lastTime = i, this._tweenDic) (e = this._tweenDic[t])._updateEase(r);
                if (0 != this._tweenDataList.length && this._index < this._tweenDataList.length) {
                    var a = this._tweenDataList[this._index];
                    r >= a.startTime && (this._index++, 0 == a.type ? (this._gidIndex++, (e = V.getItemByClass("tween", X))._create(a.target, a.data, a.duration, a.ease, g.create(this, this._animComplete, [this._gidIndex]), 0, !1, a.isTo, !0, !1),
                        e.setStartTime(r), e.gid = this._gidIndex, this._tweenDic[this._gidIndex] = e, e._updateEase(r)) : this.event("label", a.data));
                }
            }, s._animComplete = function (t) {
                this._tweenDic[t] && delete this._tweenDic[t];
            }, s._complete = function () {
                this.event("complete");
            }, s.reset = function () {
                var t;
                if (this._labelDic) for (t in this._labelDic) delete this._labelDic[t];
                for (t in this._tweenDic) this._tweenDic[t].clear(), delete this._tweenDic[t];
                for (t in this._firstTweenDic) delete this._firstTweenDic[t];
                if (this._endTweenDataList = null, this._tweenDataList && this._tweenDataList.length) {
                    var e, n = 0;
                    for (e = this._tweenDataList.length, n = 0; n < e; n++) this._tweenDataList[n] && this._tweenDataList[n].destroy();
                }
                this._tweenDataList.length = 0, this._currTime = 0, this._lastTime = 0, this._startTime = 0,
                    this._index = 0, this._gidIndex = 0, this.scale = 1, i.timer.clear(this, this._update);
            }, s.destroy = function () {
                this.reset(), this._labelDic = null, this._tweenDic = null, this._tweenDataList = null,
                    this._firstTweenDic = null;
            }, a(0, s, "index", function () {
                return this._frameIndex;
            }, function (t) {
                this._frameIndex = t, this.gotoTime(this._frameIndex / this._frameRate * 1e3);
            }), a(0, s, "total", function () {
                return this._total = Math.floor(this._startTime / 1e3 * this._frameRate), this._total;
            }), n.to = function (t, e, i, r, a) {
                return void 0 === a && (a = 0), new n().to(t, e, i, r, a);
            }, n.from = function (t, e, i, r, a) {
                return void 0 === a && (a = 0), new n().from(t, e, i, r, a);
            }, n.__init$ = function () {
                e = function () {
                    function t() {
                        this.type = 0, this.isTo = !0, this.startTime = NaN, this.endTime = NaN, this.target = null,
                            this.duration = NaN, this.ease = null, this.data = null;
                    }
                    return r(t, ""), t.prototype.destroy = function () {
                        this.target = null, this.ease = null, this.data = null, this.isTo = !0, this.type = 0,
                            V.recover("tweenData", this);
                    }, t;
                }();
            }, n;
        }(m), Re = function (t) {
            function e() {
                e.__super.call(this, e.__name2int, e.__int2name, e.__int2nameMap);
            }
            return r(e, "laya.webgl.shader.d2.ShaderDefines2D", t), e.__init__ = function () {
                e.reg("TEXTURE2D", 1), e.reg("PRIMITIVE", 4), e.reg("GLOW_FILTER", 8), e.reg("BLUR_FILTER", 16),
                    e.reg("COLOR_FILTER", 32), e.reg("COLOR_ADD", 64), e.reg("WORLDMAT", 128), e.reg("FILLTEXTURE", 256),
                    e.reg("FSHIGHPRECISION", 1024), e.reg("MVP3D", 2048);
            }, e.reg = function (t, i) {
                O._reg(t, i, e.__name2int, e.__int2name);
            }, e.toText = function (t, e, i) {
                return O._toText(t, e, i);
            }, e.toInt = function (t) {
                return O._toInt(t, e.__name2int);
            }, e.TEXTURE2D = 1, e.PRIMITIVE = 4, e.FILTERGLOW = 8, e.FILTERBLUR = 16, e.FILTERCOLOR = 32,
                e.COLORADD = 64, e.WORLDMAT = 128, e.FILLTEXTURE = 256, e.SKINMESH = 512, e.SHADERDEFINE_FSHIGHPRECISION = 1024,
                e.MVP3D = 2048, e.NOOPTMASK = 312, e.__name2int = {}, e.__int2name = [], e.__int2nameMap = [],
                e;
        }(O), Me = function (t) {
            function e(t, i, n, r) {
                this.uvrect = [0, 0, 1, 1], this._destroyed = !1, this._referenceCount = 0, this.$_GID = 0,
                    this.offsetX = 0, this.offsetY = 0, this._w = 0, this._h = 0, this.sourceWidth = 0,
                    this.sourceHeight = 0, this.url = null, this.scaleRate = 1, e.__super.call(this),
                    void 0 === n && (n = 0), void 0 === r && (r = 0), this.setTo(t, i, n, r);
            }
            r(e, "laya.resource.Texture", t);
            var n = e.prototype;
            return n._addReference = function () {
                this._bitmap && this._bitmap._addReference(), this._referenceCount++;
            }, n._removeReference = function () {
                this._bitmap && this._bitmap._removeReference(), this._referenceCount--;
            }, n._getSource = function (t) {
                return this._destroyed || !this._bitmap ? null : (this.recoverBitmap(t), this._bitmap.destroyed ? null : this.bitmap._getSource());
            }, n._onLoaded = function (t, i) {
                if (i) if (i == this); else if (i instanceof laya.resource.Texture) {
                    var n = i;
                    e._create(i, 0, 0, n.width, n.height, 0, 0, n.sourceWidth, n.sourceHeight, this);
                } else this.bitmap = i, this.sourceWidth = this._w = i.width, this.sourceHeight = this._h = i.height; else;
                t && t.run(), this.event("ready", this);
            }, n.getIsReady = function () {
                return !this._destroyed && !!this._bitmap;
            }, n.setTo = function (t, i, n, r) {
                void 0 === n && (n = 0), void 0 === r && (r = 0), this.bitmap = t, this.sourceWidth = n,
                    this.sourceHeight = r, t && (this._w = t.width, this._h = t.height, this.sourceWidth = this.sourceWidth || t.width,
                        this.sourceHeight = this.sourceHeight || t.height), this.uv = i || e.DEF_UV;
            }, n.load = function (t, e) {
                this._destroyed || i.loader.load(t, g.create(this, this._onLoaded, [e]), null, "htmlimage", 1, !1, null, !0);
            }, n.getTexturePixels = function (t, e, i, n) {
                var r = 0, a = 0, s = 0, o = this.bitmap, l = o.width, h = o.height;
                if (t + i > l && (i -= t + i - l), e + n > h && (n -= e + n - h), i <= 0 || n <= 0) return null;
                var u = 4 * i, c = null;
                try {
                    c = o.getPixels();
                } catch (t) { }
                if (c) {
                    if (0 == t && 0 == e && i == l && n == h) return c;
                    var d = new Uint8Array(i * n * 4);
                    for (r = 4 * t, a = (e + n - 1) * (u = 4 * l) + 4 * t, s = n - 1; s >= 0; s--) d.set(v.slice(a, a + 4 * i), r),
                        r += u, a -= u;
                    return d;
                }
                var _ = new ut();
                _.size(i, n), _.asBitmap = !0;
                var f = null;
                if (0 != t || 0 != e || i != l || n != h) {
                    var p = (f = f.concat())[0], m = f[1], g = (f[2] - p) / l, y = (f[7] - m) / h;
                    f = [p + t * g, m + e * y, p + (t + i) * g, m + e * y, p + (t + i) * g, m + (e + n) * y, p + t * g, m + (e + n) * y];
                }
                _._drawTextureM(this, 0, 0, i, n, null, 1, f), _._targets.start(), _.flush(), _._targets.end(),
                    _._targets.restore();
                var v = _._targets.getData(0, 0, i, n);
                for (_.destroy(), d = new Uint8Array(i * n * 4), r = 0, a = (n - 1) * u, s = n - 1; s >= 0; s--) d.set(v.slice(a, a + u), r),
                    r += u, a -= u;
                return d;
            }, n.getPixels = function (t, e, i, n) {
                return At.isConchApp ? this._nativeObj.getImageData(t, e, i, n) : this.getTexturePixels(t, e, i, n);
            }, n.recoverBitmap = function (t) {
                var e = this, n = this._bitmap.url;
                this._destroyed || this._bitmap && !this._bitmap.destroyed || !n || i.loader.load(n, g.create(this, function (i) {
                    e.bitmap = i, t && t();
                }), null, "htmlimage", 1, !1, null, !0);
            }, n.disposeBitmap = function () {
                !this._destroyed && this._bitmap && this._bitmap.destroy();
            }, n.destroy = function (t) {
                if (void 0 === t && (t = !1), !this._destroyed) {
                    this._destroyed = !0;
                    var e = this._bitmap;
                    e && (e._removeReference(this._referenceCount), (0 === e.referenceCount || t) && e.destroy(),
                        e = null), this.url && this === i.loader.getRes(this.url) && i.loader.clearRes(this.url);
                }
            }, a(0, n, "height", function () {
                return this._h ? this._h : this.bitmap ? this.uv && this.uv !== e.DEF_UV ? (this.uv[5] - this.uv[1]) * this.bitmap.height : this.bitmap.height : 0;
            }, function (t) {
                this._h = t, this.sourceHeight || (this.sourceHeight = t);
            }), a(0, n, "uv", function () {
                return this._uv;
            }, function (t) {
                this.uvrect[0] = Math.min(t[0], t[2], t[4], t[6]), this.uvrect[1] = Math.min(t[1], t[3], t[5], t[7]),
                    this.uvrect[2] = Math.max(t[0], t[2], t[4], t[6]) - this.uvrect[0], this.uvrect[3] = Math.max(t[1], t[3], t[5], t[7]) - this.uvrect[1],
                    this._uv = t;
            }), a(0, n, "width", function () {
                return this._w ? this._w : this.bitmap ? this.uv && this.uv !== e.DEF_UV ? (this.uv[2] - this.uv[0]) * this.bitmap.width : this.bitmap.width : 0;
            }, function (t) {
                this._w = t, this.sourceWidth || (this.sourceWidth = t);
            }), a(0, n, "bitmap", function () {
                return this._bitmap;
            }, function (t) {
                this._bitmap && this._bitmap._removeReference && this._bitmap._removeReference(this._referenceCount),
                    this._bitmap = t, t && t._addReference && t._addReference(this._referenceCount);
            }), a(0, n, "destroyed", function () {
                return this._destroyed;
            }), e.moveUV = function (t, e, i) {
                for (var n = 0; n < 8; n += 2) i[n] += t, i[n + 1] += e;
                return i;
            }, e.create = function (t, i, n, r, a, s, o, l, h) {
                return void 0 === s && (s = 0), void 0 === o && (o = 0), void 0 === l && (l = 0),
                    void 0 === h && (h = 0), e._create(t, i, n, r, a, s, o, l, h);
            }, e._create = function (t, i, n, r, a, s, o, l, h, u) {
                void 0 === s && (s = 0), void 0 === o && (o = 0), void 0 === l && (l = 0), void 0 === h && (h = 0);
                var c, d = t instanceof laya.resource.Texture, _ = d ? t.uv : e.DEF_UV, f = d ? t.bitmap : t;
                f.width && i + r > f.width && (r = f.width - i), f.height && n + a > f.height && (a = f.height - n),
                    u ? (c = u).setTo(f, null, l || r, h || a) : c = new e(f, null, l || r, h || a),
                    c.width = r, c.height = a, c.offsetX = s, c.offsetY = o;
                var p = 1 / f.width, m = 1 / f.height;
                i *= p, n *= m, r *= p, a *= m;
                var g = c.uv[0], y = c.uv[1], v = c.uv[4], S = c.uv[5], T = v - g, E = S - y, C = e.moveUV(_[0], _[1], [i, n, i + r, n, i + r, n + a, i, n + a]);
                c.uv = new Float32Array([g + C[0] * T, y + C[1] * E, v - (1 - C[2]) * T, y + C[3] * E, v - (1 - C[4]) * T, S - (1 - C[5]) * E, g + C[6] * T, S - (1 - C[7]) * E]);
                var x = f.scaleRate;
                return x && 1 != x ? (c.sourceWidth /= x, c.sourceHeight /= x, c.width /= x, c.height /= x,
                    c.scaleRate = x) : c.scaleRate = 1, c;
            }, e.createFromTexture = function (t, i, n, r, a) {
                var s = t.scaleRate;
                1 != s && (i *= s, n *= s, r *= s, a *= s);
                var o = mt.TEMP.setTo(i - t.offsetX, n - t.offsetY, r, a), l = o.intersection(e._rect1.setTo(0, 0, t.width, t.height), e._rect2);
                return l ? e.create(t, l.x, l.y, l.width, l.height, l.x - o.x, l.y - o.y, r, a) : null;
            }, e.DEF_UV = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), e.NO_UV = new Float32Array([0, 0, 0, 0, 0, 0, 0, 0]),
                e.INV_UV = new Float32Array([0, 1, 1, 1, 1, 0, 0, 0]), e._rect1 = new mt(), e._rect2 = new mt(),
                e;
        }(m), De = function (t) {
            function e() {
                this._responseType = null, this._data = null, this._url = null, e.__super.call(this),
                    this._http = new Ot.window.XMLHttpRequest();
            }
            r(e, "laya.net.HttpRequest", t);
            var i = e.prototype;
            return i.send = function (t, e, i, n, r) {
                void 0 === i && (i = "get"), void 0 === n && (n = "text"), this._responseType = n,
                    this._data = null, this._url = t;
                var a = this, s = this._http;
                if (t = Z.getAdptedFilePath(t), s.open(i, t, !0), r) for (var o = 0; o < r.length; o++) s.setRequestHeader(r[o++], r[o]); else At.isConchApp || (e && "string" != typeof e ? s.setRequestHeader("Content-Type", "application/json") : s.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"));
                s.responseType = "arraybuffer" !== n ? "text" : "arraybuffer", s.onerror = function (t) {
                    a._onError(t);
                }, s.onabort = function (t) {
                    a._onAbort(t);
                }, s.onprogress = function (t) {
                    a._onProgress(t);
                }, s.onload = function (t) {
                    a._onLoad(t);
                }, s.send(e);
            }, i._onProgress = function (t) {
                t && t.lengthComputable && this.event("progress", t.loaded / t.total);
            }, i._onAbort = function (t) {
                this.error("Request was aborted by user");
            }, i._onError = function (t) {
                this.error("Request failed Status:" + this._http.status + " text:" + this._http.statusText);
            }, i._onLoad = function (t) {
                var e = this._http, i = void 0 !== e.status ? e.status : 200;
                200 === i || 204 === i || 0 === i ? this.complete() : this.error("[" + e.status + "]" + e.statusText + ":" + e.responseURL);
            }, i.error = function (t) {
                this.clear(), console.warn(this.url, t), this.event("error", t);
            }, i.complete = function () {
                this.clear();
                var t = !0;
                try {
                    "json" === this._responseType ? this._data = JSON.parse(this._http.responseText) : "xml" === this._responseType ? this._data = ie.parseXMLFromString(this._http.responseText) : this._data = this._http.response || this._http.responseText;
                } catch (e) {
                    t = !1, this.error(e.message);
                }
                t && this.event("complete", this._data instanceof Array ? [this._data] : this._data);
            }, i.clear = function () {
                var t = this._http;
                t.onerror = t.onabort = t.onprogress = t.onload = null;
            }, a(0, i, "url", function () {
                return this._url;
            }), a(0, i, "http", function () {
                return this._http;
            }), a(0, i, "data", function () {
                return this._data;
            }), e;
        }(m), Oe = function (e) {
            function n() {
                this._data = null, this._url = null, this._type = null, this._cache = !1, this._http = null,
                    this._useWorkerLoader = !1, this._customParse = !1, this._constructParams = null,
                    this._propertyParams = null, this._createCache = !1, n.__super.call(this);
            }
            r(n, "laya.net.Loader", e);
            var s = n.prototype;
            return s.load = function (e, i, r, a, s, o) {
                if (void 0 === r && (r = !0), void 0 === s && (s = !1), void 0 === o && (o = !1),
                    e) {
                    if (n.setGroup(e, "666"), this._url = e, 0 === e.indexOf("data:image") ? i = "image" : e = Z.formatURL(e),
                        this._type = i || (i = n.getTypeFromUrl(this._url)), this._cache = r, this._useWorkerLoader = o,
                        this._data = null, o && Ge.enableWorkerLoader(), !s && n.loadedMap[e]) return this._data = n.loadedMap[e],
                            this.event("progress", 1), void this.event("complete", this._data);
                    if (a && n.setGroup(e, a), null != n.parserMap[i]) return this._customParse = !0,
                        void (n.parserMap[i] instanceof laya.utils.Handler ? n.parserMap[i].runWith(this) : n.parserMap[i].call(null, this));
                    var l, h = Z.customFormat(this._url), u = t.__data && t.__data[h];
                    if (u) {
                        if (console.log("url:" + e.substr(0, 100), "inner"), n.preLoadedMap[e] && this.onLoaded(n.preLoadedMap[e]),
                            "string" != typeof u) return this.onLoaded(u);
                        var c = parseInt(u.substr(0, 1)), d = u.substr(1);
                        if (0 === c) e = d; else {
                            if (1 === c) {
                                var _ = t.__decode && t.__decode.decode && t.__decode.decode(d), f = new Uint8Array(_);
                                return this.onLoaded(f);
                            }
                            if (2 === c) return this.onLoaded(d);
                        }
                    }
                    if ("image" === i || "htmlimage" === i || "nativeimage" === i) return this._loadImage(e);
                    if ("sound" === i) return this._loadSound(e);
                    if ("ttf" === i) return this._loadTTF(e);
                    switch (i) {
                        case "atlas":
                        case "prefab":
                        case "plf":
                            l = "json";
                            break;

                        case "font":
                            l = "xml";
                            break;

                        case "plfb":
                            l = "arraybuffer";
                            break;

                        default:
                            l = i;
                    }
                    n.preLoadedMap[e] ? this.onLoaded(n.preLoadedMap[e]) : (this._http || (this._http = new De(),
                        this._http.on("progress", this, this.onProgress), this._http.on("error", this, this.onError),
                        this._http.on("complete", this, this.onLoaded)), this._http.send(e, null, "get", l));
                } else this.onLoaded(null);
            }, s._loadTTF = function (t) {
                t = Z.formatURL(t);
                var e = new F();
                e.complete = g.create(this, this.onLoaded), e.load(t);
            }, s._loadImage = function (t) {
                t = Z.formatURL(t);
                var e, i = this;
                function r() {
                    var i = e;
                    i && (i.onload = null, i.onerror = null, delete n._imgCache[t]);
                }
                var a = function () {
                    r(), i.event("error", "Load image failed");
                };
                if ("nativeimage" === this._type) {
                    var s = function () {
                        r(), i.onLoaded(e);
                    };
                    (e = new Ot.window.Image()).crossOrigin = "", e.onload = s, e.onerror = a, e.src = t,
                        n._imgCache[t] = e;
                } else {
                    var o = ie.getFileExtension(t);
                    if ("ktx" === o || "pvr" === o) {
                        var l;
                        s = function (n) {
                            var a = 0;
                            switch (o) {
                                case "ktx":
                                    a = 5;
                                    break;

                                case "pvr":
                                    a = 12;
                            }
                            (e = new di(0, 0, a, !1, !1)).wrapModeU = 1, e.wrapModeV = 1, e.setCompressData(n),
                                e._setCreateURL(t), r(), i.onLoaded(e);
                        }, (l = new De()).on("error", null, a), l.on("complete", null, s), l.send(t, null, "get", "arraybuffer");
                    } else {
                        var h = new Ot.window.Image();
                        s = function () {
                            var e = new di(h.width, h.height, 1, !1, !1);
                            e.wrapModeU = 1, e.wrapModeV = 1, e.loadImageSource(h, !0), e._setCreateURL(t),
                                r(), i.onLoaded(e);
                        }, h.crossOrigin = "", h.onload = s, h.onerror = a, h.src = t, n._imgCache[t] = h;
                    }
                }
            }, s._loadSound = function (t) {
                var e = new ve._soundClass(), i = this;
                function n() {
                    e.offAll();
                }
                e.on("complete", this, function () {
                    n(), i.onLoaded(e);
                }), e.on("error", this, function () {
                    n(), e.dispose(), i.event("error", "Load sound failed");
                }), e.load(t);
            }, s.onProgress = function (t) {
                "atlas" === this._type ? this.event("progress", .3 * t) : this.event("progress", t);
            }, s.onError = function (t) {
                this.event("error", t);
            }, s.onLoaded = function (t) {
                var e = this._type;
                if ("plfb" == e) this.parsePLFBData(t), this.complete(t); else if ("plf" == e) this.parsePLFData(t),
                    this.complete(t); else if ("image" === e) {
                        var i = new Me(t);
                        i.url = this._url, this.complete(i);
                    } else if ("sound" === e || "htmlimage" === e || "nativeimage" === e) this.complete(t); else if ("atlas" === e) {
                        if (!t.url && !t._setContext) {
                            if (!this._data) {
                                if (this._data = t, t.meta && t.meta.image) {
                                    var r, a = t.meta.image.split(","), s = this._url.indexOf("/") >= 0 ? "/" : "\\", o = this._url.lastIndexOf(s), l = o >= 0 ? this._url.substr(0, o + 1) : "";
                                    Ot.onAndroid && t.meta.compressTextureAndroid && (r = ".ktx"), Ot.onIOS && t.meta.compressTextureIOS && (r = ".pvr");
                                    for (var h = 0, u = a.length; h < u; h++) a[h] = r ? l + a[h].replace(".png", r) : l + a[h];
                                } else a = [this._url.replace(".json", ".png")];
                                a.reverse(), t.toLoads = a, t.pics = [];
                            }
                            return this.event("progress", .3 + 1 / a.length * .6), this._loadImage(a.pop());
                        }
                        if (this._data.pics.push(t), this._data.toLoads.length > 0) return this.event("progress", .3 + 1 / this._data.toLoads.length * .6),
                            this._loadImage(this._data.toLoads.pop());
                        var c = this._data.frames, d = this._url.split("?")[0], _ = this._data.meta && this._data.meta.prefix ? this._data.meta.prefix : d.substring(0, d.lastIndexOf(".")) + "/", f = this._data.pics, p = Z.formatURL(this._url), m = n.atlasMap[p] || (n.atlasMap[p] = []);
                        m.dir = _;
                        var g = 1;
                        if (this._data.meta && this._data.meta.scale && 1 != this._data.meta.scale) for (var y in g = parseFloat(this._data.meta.scale),
                            c) {
                            var v, S = c[y], T = f[S.frame.idx ? S.frame.idx : 0], E = Z.formatURL(_ + y);
                            T.scaleRate = g, v = Me._create(T, S.frame.x, S.frame.y, S.frame.w, S.frame.h, S.spriteSourceSize.x, S.spriteSourceSize.y, S.sourceSize.w, S.sourceSize.h, laya.net.Loader.getRes(E)),
                                n.cacheRes(E, v), v.url = E, m.push(E);
                        } else for (y in c) T = f[(S = c[y]).frame.idx ? S.frame.idx : 0], E = Z.formatURL(_ + y),
                            v = Me._create(T, S.frame.x, S.frame.y, S.frame.w, S.frame.h, S.spriteSourceSize.x, S.spriteSourceSize.y, S.sourceSize.w, S.sourceSize.h, laya.net.Loader.getRes(E)),
                            n.cacheRes(E, v), v.url = E, m.push(E);
                        delete this._data.pics, this.complete(this._data);
                    } else if ("font" === e) {
                        if (!t._source) return this._data = t, this.event("progress", .5), this._loadImage(this._url.replace(".fnt", ".png"));
                        var C = new L();
                        C.parseFont(this._data, new Me(t));
                        var x = this._url.split(".fnt")[0].split("/"), b = x[x.length - 1];
                        ei.registerBitmapFont(b, C), this._data = C, this.complete(this._data);
                    } else if ("prefab" === e) {
                        var I = new me();
                        I.json = t, this.complete(I);
                    } else this.complete(t);
            }, s.parsePLFData = function (t) {
                var e, i, r;
                for (e in t) switch (r = t[e], e) {
                    case "json":
                    case "text":
                        for (i in r) n.preLoadedMap[Z.formatURL(i)] = r[i];
                        break;

                    default:
                        for (i in r) n.preLoadedMap[Z.formatURL(i)] = r[i];
                }
            }, s.parsePLFBData = function (t) {
                var e, i, n = 0;
                for (i = (e = new qt(t)).getInt32(), n = 0; n < i; n++) this.parseOnePLFBFile(e);
            }, s.parseOnePLFBFile = function (t) {
                var e, i, r;
                i = t.getUTFString(), e = t.getInt32(), r = t.readArrayBuffer(e), n.preLoadedMap[Z.formatURL(i)] = r;
            }, s.complete = function (t) {
                this._data = t, this._customParse ? this.event("loaded", t instanceof Array ? [t] : t) : (n._loaders.push(this),
                    n._isWorking || n.checkNext());
            }, s.endLoad = function (t) {
                t && (this._data = t), this._cache && n.cacheRes(this._url, this._data), this.event("progress", 1),
                    this.event("complete", this.data instanceof Array ? [this.data] : this.data);
            }, a(0, s, "url", function () {
                return this._url;
            }), a(0, s, "data", function () {
                return this._data;
            }), a(0, s, "cache", function () {
                return this._cache;
            }), a(0, s, "type", function () {
                return this._type;
            }), n.getTypeFromUrl = function (t) {
                var e = ie.getFileExtension(t);
                return e ? n.typeMap[e] : (console.warn("Not recognize the resources suffix", t),
                    "text");
            }, n.checkNext = function () {
                n._isWorking = !0;
                for (var t = Ot.now(); n._startIndex < n._loaders.length;) if (Ot.now(), n._loaders[n._startIndex].endLoad(),
                    n._startIndex++, Ot.now() - t > n.maxTimeOut) return console.warn("loader callback cost a long time:" + (Ot.now() - t) + " url=" + n._loaders[n._startIndex - 1].url),
                        void i.systemTimer.frameOnce(1, null, n.checkNext);
                n._loaders.length = 0, n._startIndex = 0, n._isWorking = !1;
            }, n.clearRes = function (t) {
                t = Z.formatURL(t);
                var e = n.getAtlas(t);
                if (e) {
                    for (var i = 0, r = e.length; i < r; i++) {
                        var a = e[i], s = n.getRes(a);
                        delete n.loadedMap[a], s && s.destroy();
                    }
                    e.length = 0, delete n.atlasMap[t], delete n.loadedMap[t];
                } else {
                    var o = n.loadedMap[t];
                    o && (delete n.loadedMap[t], o instanceof laya.resource.Texture && o.bitmap && o.destroy());
                }
            }, n.clearTextureRes = function (t) {
                t = Z.formatURL(t);
                var e = laya.net.Loader.getAtlas(t), i = e && e.length > 0 ? laya.net.Loader.getRes(e[0]) : laya.net.Loader.getRes(t);
                i instanceof laya.resource.Texture && i.disposeBitmap();
            }, n.getRes = function (t) {
                return n.loadedMap[Z.formatURL(t)];
            }, n.getAtlas = function (t) {
                return n.atlasMap[Z.formatURL(t)];
            }, n.cacheRes = function (t, e) {
                t = Z.formatURL(t), null != n.loadedMap[t] ? console.warn("Resources already exist,is repeated loading:", t) : n.loadedMap[t] = e;
            }, n.setGroup = function (t, e) {
                n.groupMap[e] || (n.groupMap[e] = []), n.groupMap[e].push(t);
            }, n.clearResByGroup = function (t) {
                if (n.groupMap[t]) {
                    var e = n.groupMap[t], i = 0, r = e.length;
                    for (i = 0; i < r; i++) n.clearRes(e[i]);
                    e.length = 0;
                }
            }, n.TEXT = "text", n.JSON = "json", n.PREFAB = "prefab", n.XML = "xml", n.BUFFER = "arraybuffer",
                n.IMAGE = "image", n.SOUND = "sound", n.ATLAS = "atlas", n.FONT = "font", n.TTF = "ttf",
                n.PLF = "plf", n.PLFB = "plfb", n.HIERARCHY = "HIERARCHY", n.MESH = "MESH", n.MATERIAL = "MATERIAL",
                n.TEXTURE2D = "TEXTURE2D", n.TEXTURECUBE = "TEXTURECUBE", n.ANIMATIONCLIP = "ANIMATIONCLIP",
                n.AVATAR = "AVATAR", n.TERRAINHEIGHTDATA = "TERRAINHEIGHTDATA", n.TERRAINRES = "TERRAIN",
                n.typeMap = {
                    ttf: "ttf",
                    png: "image",
                    jpg: "image",
                    jpeg: "image",
                    ktx: "image",
                    pvr: "image",
                    txt: "text",
                    json: "json",
                    prefab: "prefab",
                    xml: "xml",
                    als: "atlas",
                    atlas: "atlas",
                    mp3: "sound",
                    ogg: "sound",
                    wav: "sound",
                    part: "json",
                    fnt: "font",
                    plf: "plf",
                    plfb: "plfb",
                    scene: "json",
                    ani: "json",
                    sk: "arraybuffer"
                }, n.parserMap = {}, n.maxTimeOut = 100, n.groupMap = {}, n.loadedMap = {}, n.atlasMap = {},
                n.preLoadedMap = {}, n._imgCache = {}, n._loaders = [], n._isWorking = !1, n._startIndex = 0,
                n;
        }(m), Le = (function (t) {
            function e(t) {
                this.strength = NaN, this.strength_sig2_2sig2_gauss1 = [], this.strength_sig2_native = null,
                    this.renderFunc = null, e.__super.call(this), void 0 === t && (t = 4), this.strength = t,
                    this._glRender = new ct();
            }
            r(e, "laya.filters.BlurFilter", t);
            var i = e.prototype;
            i.getStrenth_sig2_2sig2_native = function () {
                this.strength_sig2_native || (this.strength_sig2_native = new Float32Array(4));
                var t = this.strength / 3, e = t * t;
                return this.strength_sig2_native[0] = this.strength, this.strength_sig2_native[1] = e,
                    this.strength_sig2_native[2] = 2 * e, this.strength_sig2_native[3] = 1 / (2 * Math.PI * e),
                    this.strength_sig2_native;
            }, a(0, i, "type", function () {
                return 16;
            });
        }(c), function (t) {
            function e() {
                this._maxsize = 0, this._upload = !0, this._uploadSize = 0, this._bufferSize = 0,
                    this._u8Array = null, e.__super.call(this);
            }
            r(e, "laya.webgl.utils.Buffer2D", t);
            var i = e.prototype;
            return i.setByteLength = function (t) {
                this._byteLength !== t && (t <= this._bufferSize || this._resizeBuffer(2 * t + 256, !0),
                    this._byteLength = t);
            }, i.needSize = function (t) {
                var e = this._byteLength;
                if (t) {
                    var i = this._byteLength + t;
                    i <= this._bufferSize || this._resizeBuffer(i << 1, !0), this._byteLength = i;
                }
                return e;
            }, i._bufferData = function () {
                this._maxsize = Math.max(this._maxsize, this._byteLength), b.loopCount % 30 == 0 && (this._buffer.byteLength > this._maxsize + 64 && (this._buffer = this._buffer.slice(0, this._maxsize + 64),
                    this._bufferSize = this._buffer.byteLength, this._checkArrayUse()), this._maxsize = this._byteLength),
                    this._uploadSize < this._buffer.byteLength && (this._uploadSize = this._buffer.byteLength,
                        Dt.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage)),
                    Dt.instance.bufferSubData(this._bufferType, 0, new Uint8Array(this._buffer, 0, this._byteLength));
            }, i._bufferSubData = function (t, e, i) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this._maxsize = Math.max(this._maxsize, this._byteLength),
                    b.loopCount % 30 == 0 && (this._buffer.byteLength > this._maxsize + 64 && (this._buffer = this._buffer.slice(0, this._maxsize + 64),
                        this._bufferSize = this._buffer.byteLength, this._checkArrayUse()), this._maxsize = this._byteLength),
                    this._uploadSize < this._buffer.byteLength && (this._uploadSize = this._buffer.byteLength,
                        Dt.instance.bufferData(this._bufferType, this._uploadSize, this._bufferUsage)),
                    e || i) {
                    var n = this._buffer.slice(e, i);
                    Dt.instance.bufferSubData(this._bufferType, t, n);
                } else Dt.instance.bufferSubData(this._bufferType, t, this._buffer);
            }, i._checkArrayUse = function () { }, i._bind_uploadForVAO = function () {
                return !!this._upload && (this._upload = !1, this._bindForVAO(), this._bufferData(),
                    !0);
            }, i._bind_upload = function () {
                return !!this._upload && (this._upload = !1, this.bind(), this._bufferData(), !0);
            }, i._bind_subUpload = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0),
                    !!this._upload && (this._upload = !1, this.bind(), this._bufferSubData(t, e, i),
                        !0);
            }, i._resizeBuffer = function (t, e) {
                var i = this._buffer;
                if (t <= i.byteLength) return this;
                var n = this._u8Array;
                if (e && i && i.byteLength > 0) {
                    var r = new ArrayBuffer(t), a = n && n.buffer == i ? n : new Uint8Array(i);
                    (n = this._u8Array = new Uint8Array(r)).set(a, 0), i = this._buffer = r;
                } else i = this._buffer = new ArrayBuffer(t), this._u8Array = null;
                return this._checkArrayUse(), this._upload = !0, this._bufferSize = i.byteLength,
                    this;
            }, i.append = function (t) {
                this._upload = !0;
                var e, i;
                e = t.byteLength, t instanceof Uint8Array ? (this._resizeBuffer(this._byteLength + e, !0),
                    i = new Uint8Array(this._buffer, this._byteLength)) : t instanceof Uint16Array ? (this._resizeBuffer(this._byteLength + e, !0),
                        i = new Uint16Array(this._buffer, this._byteLength)) : t instanceof Float32Array && (this._resizeBuffer(this._byteLength + e, !0),
                            i = new Float32Array(this._buffer, this._byteLength)), i.set(t, 0), this._byteLength += e,
                    this._checkArrayUse();
            }, i.appendU16Array = function (t, e) {
                this._resizeBuffer(this._byteLength + 2 * e, !0);
                var i = new Uint16Array(this._buffer, this._byteLength, e);
                if (6 == e) i[0] = t[0], i[1] = t[1], i[2] = t[2], i[3] = t[3], i[4] = t[4], i[5] = t[5]; else if (e >= 100) i.set(new Uint16Array(t.buffer, 0, e)); else for (var n = 0; n < e; n++) i[n] = t[n];
                this._byteLength += 2 * e, this._checkArrayUse();
            }, i.appendEx = function (t, e) {
                this._upload = !0;
                var i;
                i = t.byteLength, this._resizeBuffer(this._byteLength + i, !0), new e(this._buffer, this._byteLength).set(t, 0),
                    this._byteLength += i, this._checkArrayUse();
            }, i.appendEx2 = function (t, e, i, n) {
                void 0 === n && (n = 1), this._upload = !0;
                var r, a;
                r = i * n, this._resizeBuffer(this._byteLength + r, !0), a = new e(this._buffer, this._byteLength);
                var s = 0;
                for (s = 0; s < i; s++) a[s] = t[s];
                this._byteLength += r, this._checkArrayUse();
            }, i.getBuffer = function () {
                return this._buffer;
            }, i.setNeedUpload = function () {
                this._upload = !0;
            }, i.getNeedUpload = function () {
                return this._upload;
            }, i.upload = function () {
                var t = this._bind_upload();
                return Dt.instance.bindBuffer(this._bufferType, null), 34962 == this._bufferType && (G._bindedVertexBuffer = null),
                    34963 == this._bufferType && (G._bindedIndexBuffer = null), qe.activeShader = null,
                    t;
            }, i.subUpload = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0);
                var n = this._bind_subUpload();
                return Dt.instance.bindBuffer(this._bufferType, null), 34962 == this._bufferType && (G._bindedVertexBuffer = null),
                    34963 == this._bufferType && (G._bindedIndexBuffer = null), qe.activeShader = null,
                    n;
            }, i._disposeResource = function () {
                this._upload = !0, this._uploadSize = 0;
            }, i.clear = function () {
                this._byteLength = 0, this._upload = !0;
            }, a(0, i, "bufferLength", function () {
                return this._buffer.byteLength;
            }), a(0, i, "byteLength", null, function (t) {
                this.setByteLength(t);
            }), e.__int__ = function (t) { }, e.FLOAT32 = 4, e.SHORT = 2, e;
        }(G)), Pe = (function (t) {
            function e(t, i, n, r) {
                this._sv_blurInfo2 = [0, 0, 1, 0], this._color = null, this._color_native = null,
                    this._blurInof1_native = null, this._blurInof2_native = null, e.__super.call(this),
                    this._elements = new Float32Array(9), this._sv_blurInfo1 = new Array(4), void 0 === i && (i = 4),
                    void 0 === n && (n = 6), void 0 === r && (r = 6), this._color = new o(t), this.blur = Math.min(i, 20),
                    this.offX = n, this.offY = r, this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = this.blur,
                    this._sv_blurInfo1[2] = n, this._sv_blurInfo1[3] = -r, this._glRender = new he();
            }
            r(e, "laya.filters.GlowFilter", t);
            var i = e.prototype;
            i.getColor = function () {
                return this._color.arrColor;
            }, i.getColorNative = function () {
                this._color_native || (this._color_native = new Float32Array(4));
                var t = this.getColor();
                return this._color_native[0] = t[0], this._color_native[1] = t[1], this._color_native[2] = t[2],
                    this._color_native[3] = t[3], this._color_native;
            }, i.getBlurInfo1Native = function () {
                return this._blurInof1_native || (this._blurInof1_native = new Float32Array(4)),
                    this._blurInof1_native[0] = this._blurInof1_native[1] = this.blur, this._blurInof1_native[2] = this.offX,
                    this._blurInof1_native[3] = this.offY, this._blurInof1_native;
            }, i.getBlurInfo2Native = function () {
                return this._blurInof2_native || (this._blurInof2_native = new Float32Array(4)),
                    this._blurInof2_native[2] = 1, this._blurInof2_native;
            }, a(0, i, "type", function () {
                return 8;
            }), a(0, i, "offY", function () {
                return this._elements[6];
            }, function (t) {
                this._elements[6] = t, this._sv_blurInfo1[3] = -t;
            }), a(0, i, "offX", function () {
                return this._elements[5];
            }, function (t) {
                this._elements[5] = t, this._sv_blurInfo1[2] = t;
            }), a(0, i, "blur", function () {
                return this._elements[4];
            }, function (t) {
                this._elements[4] = t, this._sv_blurInfo1[0] = this._sv_blurInfo1[1] = t;
            });
        }(c), function (t) {
            function e() {
                e.__super.call(this, 24, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshQuadTexture._fixattriInfo),
                    laya.webgl.utils.MeshQuadTexture._fixib ? (this._ib = laya.webgl.utils.MeshQuadTexture._fixib,
                        this._quadNum = e._maxIB) : (this.createQuadIB(e._maxIB), laya.webgl.utils.MeshQuadTexture._fixib = this._ib);
            }
            r(e, "laya.webgl.utils.MeshQuadTexture", t);
            var i = e.prototype;
            return i.releaseMesh = function () {
                this._vb.setByteLength(0), this.vertNum = 0, this.indexNum = 0, laya.webgl.utils.MeshQuadTexture._POOL.push(this);
            }, i.destroy = function () {
                this._vb.destroy(), this._vb.deleteBuffer();
            }, i.addQuad = function (t, e, i, n) {
                var r = this._vb, a = r._byteLength >> 2;
                r.setByteLength(a + 24 << 2);
                var s = r._floatArray32 || r.getFloat32Array(), o = r._uint32Array, l = a, h = n ? 255 : 0;
                s[l++] = t[0], s[l++] = t[1], s[l++] = e[0], s[l++] = e[1], o[l++] = i, o[l++] = h,
                    s[l++] = t[2], s[l++] = t[3], s[l++] = e[2], s[l++] = e[3], o[l++] = i, o[l++] = h,
                    s[l++] = t[4], s[l++] = t[5], s[l++] = e[4], s[l++] = e[5], o[l++] = i, o[l++] = h,
                    s[l++] = t[6], s[l++] = t[7], s[l++] = e[6], s[l++] = e[7], o[l++] = i, o[l++] = h,
                    r._upload = !0;
            }, e.getAMesh = function (t) {
                var i = null;
                return i = laya.webgl.utils.MeshQuadTexture._POOL.length ? laya.webgl.utils.MeshQuadTexture._POOL.pop() : new e(),
                    t && i._vb._resizeBuffer(1572864, !1), i;
            }, e.const_stride = 24, e._fixib = null, e._maxIB = 16384, e._POOL = [], n(e, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5121, 4, 16, 5121, 4, 20];
            }]), e;
        }(E)), Ne = function (t) {
            function e() {
                this.url = null, this.loaded = !1, this.data = null, this.audioBuffer = null, this.__toPlays = null,
                    this._disposed = !1, e.__super.call(this);
            }
            r(e, "laya.media.webaudio.WebAudioSound", t);
            var i = e.prototype;
            return i.load = function (t) {
                var i = this;
                if (t = Z.formatURL(t), this.url = t, this.audioBuffer = e._dataCache[t], this.audioBuffer) this._loaded(this.audioBuffer); else if (e.e.on("loaded:" + t, this, this._loaded),
                    e.e.on("err:" + t, this, this._err), !e.__loadingSound[t]) {
                    e.__loadingSound[t] = !0;
                    var n = new Ot.window.XMLHttpRequest();
                    n.open("GET", t, !0), n.responseType = "arraybuffer", n.onload = function () {
                        i._disposed ? i._removeLoadEvents() : (i.data = n.response, e.buffs.push({
                            buffer: i.data,
                            url: i.url
                        }), e.decode());
                    }, n.onerror = function (t) {
                        i._err();
                    }, n.send();
                }
            }, i._err = function () {
                this._removeLoadEvents(), e.__loadingSound[this.url] = !1, this.event("error");
            }, i._loaded = function (t) {
                this._removeLoadEvents(), this._disposed || (this.audioBuffer = t, e._dataCache[this.url] = this.audioBuffer,
                    this.loaded = !0, this.event("complete"));
            }, i._removeLoadEvents = function () {
                e.e.off("loaded:" + this.url, this, this._loaded), e.e.off("err:" + this.url, this, this._err);
            }, i.__playAfterLoaded = function () {
                if (this.__toPlays) {
                    var t, e, i, n = 0;
                    for (t = (e = this.__toPlays).length, n = 0; n < t; n++) (i = e[n])[2] && !i[2].isStopped && this.play(i[0], i[1], i[2]);
                    this.__toPlays.length = 0;
                }
            }, i.play = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), i = i || new Je(), this.audioBuffer || this.url && (this.__toPlays || (this.__toPlays = []),
                    this.__toPlays.push([t, e, i]), this.once("complete", this, this.__playAfterLoaded),
                    this.load(this.url)), i.url = this.url, i.loops = e, i.audioBuffer = this.audioBuffer,
                    i.startTime = t, i.play(), ve.addChannel(i), i;
            }, i.dispose = function () {
                this._disposed = !0, delete e._dataCache[this.url], delete e.__loadingSound[this.url],
                    this.audioBuffer = null, this.data = null, this.__toPlays = [];
            }, a(0, i, "duration", function () {
                return this.audioBuffer ? this.audioBuffer.duration : 0;
            }), e.decode = function () {
                e.buffs.length <= 0 || e.isDecoding || (e.isDecoding = !0, e.tInfo = e.buffs.shift(),
                    e.ctx.decodeAudioData(e.tInfo.buffer, e._done, e._fail));
            }, e._done = function (t) {
                e.e.event("loaded:" + e.tInfo.url, t), e.isDecoding = !1, e.decode();
            }, e._fail = function () {
                e.e.event("err:" + e.tInfo.url, null), e.isDecoding = !1, e.decode();
            }, e._playEmptySound = function () {
                if (null != e.ctx) {
                    var t = e.ctx.createBufferSource();
                    t.buffer = e._miniBuffer, t.connect(e.ctx.destination), t.start(0, 0, 0);
                }
            }, e._unlock = function () {
                e._unlocked || (e._playEmptySound(), "running" == e.ctx.state && (Ot.document.removeEventListener("mousedown", e._unlock, !0),
                    Ot.document.removeEventListener("touchend", e._unlock, !0), Ot.document.removeEventListener("touchstart", e._unlock, !0),
                    e._unlocked = !0));
            }, e.initWebAudio = function () {
                "running" != e.ctx.state && (e._unlock(), Ot.document.addEventListener("mousedown", e._unlock, !0),
                    Ot.document.addEventListener("touchend", e._unlock, !0), Ot.document.addEventListener("touchstart", e._unlock, !0));
            }, e._dataCache = {}, e.buffs = [], e.isDecoding = !1, e._unlocked = !1, e.tInfo = null,
                e.__loadingSound = {}, n(e, ["window", function () {
                    return this.window = Ot.window;
                }, "webAudioEnabled", function () {
                    return this.webAudioEnabled = e.window.AudioContext || e.window.webkitAudioContext || e.window.mozAudioContext;
                }, "ctx", function () {
                    return this.ctx = e.webAudioEnabled ? new (e.window.AudioContext || e.window.webkitAudioContext || e.window.mozAudioContext)() : void 0;
                }, "_miniBuffer", function () {
                    return this._miniBuffer = e.ctx.createBuffer(1, 1, 22050);
                }, "e", function () {
                    return this.e = new m();
                }]), e;
        }(m), Be = (function (t) {
            function e(t, i, n, r) {
                this._endian = null, this._socket = null, this._connected = !1, this._addInputPosition = 0,
                    this._input = null, this._output = null, this.disableInput = !1, this._byteClass = null,
                    this.protocols = [], e.__super.call(this), void 0 === i && (i = 0), this._byteClass = n || qt,
                    this.protocols = r, this.endian = "bigEndian", t && i > 0 && i < 65535 && this.connect(t, i);
            }
            r(e, "laya.net.Socket", t);
            var i = e.prototype;
            i.connect = function (t, e) {
                var i = "ws://" + t + ":" + e;
                this.connectByUrl(i);
            }, i.connectByUrl = function (t) {
                var e = this;
                null != this._socket && this.close(), this._socket && this.cleanSocket(), this.protocols && 0 != this.protocols.length ? this._socket = new Ot.window.WebSocket(t, this.protocols) : this._socket = new Ot.window.WebSocket(t),
                    this._socket.binaryType = "arraybuffer", this._output = new this._byteClass(), this._output.endian = this.endian,
                    this._input = new this._byteClass(), this._input.endian = this.endian, this._addInputPosition = 0,
                    this._socket.onopen = function (t) {
                        e._onOpen(t);
                    }, this._socket.onmessage = function (t) {
                        e._onMessage(t);
                    }, this._socket.onclose = function (t) {
                        e._onClose(t);
                    }, this._socket.onerror = function (t) {
                        e._onError(t);
                    };
            }, i.cleanSocket = function () {
                this.close(), this._connected = !1, this._socket.onopen = null, this._socket.onmessage = null,
                    this._socket.onclose = null, this._socket.onerror = null, this._socket = null;
            }, i.close = function () {
                if (null != this._socket) try {
                    this._socket.close();
                } catch (t) { }
            }, i._onOpen = function (t) {
                this._connected = !0, this.event("open", t);
            }, i._onMessage = function (t) {
                if (t && t.data) {
                    var e = t.data;
                    if (this.disableInput && e) this.event("message", e); else {
                        this._input.length > 0 && this._input.bytesAvailable < 1 && (this._input.clear(),
                            this._addInputPosition = 0);
                        var i = this._input.pos;
                        !this._addInputPosition && (this._addInputPosition = 0), this._input.pos = this._addInputPosition,
                            e && ("string" == typeof e ? this._input.writeUTFBytes(e) : this._input.writeArrayBuffer(e),
                                this._addInputPosition = this._input.pos, this._input.pos = i), this.event("message", e);
                    }
                }
            }, i._onClose = function (t) {
                this._connected = !1, this.event("close", t);
            }, i._onError = function (t) {
                this.event("error", t);
            }, i.send = function (t) {
                this._socket.send(t);
            }, i.flush = function () {
                if (this._output && this._output.length > 0) {
                    var t;
                    try {
                        this._socket && this._socket.send(this._output.__getBuffer().slice(0, this._output.length));
                    } catch (e) {
                        t = e;
                    }
                    this._output.endian = this.endian, this._output.clear(), t && this.event("error", t);
                }
            }, a(0, i, "input", function () {
                return this._input;
            }), a(0, i, "output", function () {
                return this._output;
            }), a(0, i, "connected", function () {
                return this._connected;
            }), a(0, i, "endian", function () {
                return this._endian;
            }, function (t) {
                this._endian = t, null != this._input && (this._input.endian = t), null != this._output && (this._output.endian = t);
            }), e.LITTLE_ENDIAN = "littleEndian", e.BIG_ENDIAN = "bigEndian";
        }(m), function (t) {
            function e(t) {
                this.u_colorMatrix = null, this.strength = 0, this.blurInfo = null, this.colorMat = null,
                    this.colorAlpha = null, void 0 === t && (t = 0), e.__super.call(this, 1, t), this._attribLocation = ["posuv", 0, "attribColor", 1, "attribFlags", 2];
            }
            return r(e, "laya.webgl.shader.d2.value.TextureSV", t), e.prototype.clear = function () {
                this.texture = null, this.shader = null, this.defines._value = this.subID + (Ct.shaderHighPrecision ? 1024 : 0);
            }, e;
        }(H)), Fe = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.components.CommonScript", t);
            var i = e.prototype;
            i.onAwake = function () { }, i.onEnable = function () { }, i.onStart = function () { },
                i.onUpdate = function () { }, i.onLateUpdate = function () { }, i.onDisable = function () { },
                i.onDestroy = function () { }, a(0, i, "isSingleton", function () {
                    return !1;
                });
        }(p), function (t) {
            var e;
            function a() {
                this.retryNum = 1, this.retryDelay = 0, this.maxLoader = 5, this._loaders = [],
                    this._loaderCount = 0, this._resInfos = [], this._infoPool = [], this._maxPriority = 5,
                    this._failRes = {}, this._statInfo = {
                        count: 1,
                        loaded: 1
                    }, a.__super.call(this);
                for (var t = 0; t < this._maxPriority; t++) this._resInfos[t] = [];
            }
            r(a, "laya.net.LoaderManager", t);
            var s = a.prototype;
            return s.getProgress = function () {
                return this._statInfo.loaded / this._statInfo.count;
            }, s.resetProgress = function () {
                this._statInfo.count = this._statInfo.loaded = 1;
            }, s.create = function (t, e, i, n, r, a, s, o) {
                void 0 === s && (s = 1), void 0 === o && (o = !0), this._create(t, !0, e, i, n, r, a, s, o);
            }, s._create = function (t, e, i, n, r, a, s, o, l) {
                if (void 0 === o && (o = 1), void 0 === l && (l = !0), t instanceof Array) {
                    var h = !0, u = t, c = u.length, d = 0;
                    if (n) var _ = g.create(n.caller, n.method, n.args, !1);
                    for (var f = 0; f < c; f++) {
                        var p = u[f];
                        "string" == typeof p && (p = u[f] = {
                            url: p
                        }), p.progress = 0;
                    }
                    for (f = 0; f < c; f++) {
                        p = u[f];
                        var m = n ? g.create(null, S, [p], !1) : null, y = n || i ? g.create(null, v, [p]) : null;
                        this._createOne(p.url, e, y, m, p.type || r, p.constructParams || a, p.propertyParams || s, p.priority || o, l);
                    }
                    function v(t, e) {
                        d++, t.progress = 1, e || (h = !1), d === c && i && i.runWith(h);
                    }
                    function S(t, e) {
                        t.progress = e;
                        for (var i = 0, n = 0; n < c; n++) {
                            i += u[n].progress;
                        }
                        var r = i / c;
                        _.runWith(r);
                    }
                } else this._createOne(t, e, i, n, r, a, s, o, l);
            }, s._createOne = function (t, e, n, r, s, o, l, h, u) {
                void 0 === h && (h = 1), void 0 === u && (u = !0);
                var c = this.getRes(t);
                if (c) !e && c instanceof laya.resource.Resource && c._addReference(), r && r.runWith(1),
                    n && n.runWith(c); else {
                    var d = ie.getFileExtension(t);
                    if (s || (s = a.createMap[d] ? a.createMap[d][0] : null), !s) return void this.load(t, n, r, s, h, u);
                    if (!Oe.parserMap[s]) return void this.load(t, n, r, s, h, u);
                    this._createLoad(t, g.create(null, function (r) {
                        r && (!e && r instanceof laya.resource.Resource && r._addReference(), r._setCreateURL && r._setCreateURL(t));
                        n && n.runWith(r), i.loader.event(t);
                    }), r, s, o, l, h, u, !0);
                }
            }, s.load = function (t, n, r, s, o, l, h, u, c) {
                var d = this;
                if (void 0 === o && (o = 1), void 0 === l && (l = !0), void 0 === u && (u = !1),
                    void 0 === c && (c = !1), t instanceof Array) return this._loadAssets(t, n, r, s, o, l, h);
                var _ = Oe.getRes(t);
                if (u || null == _) {
                    var f;
                    f = t, (t = ce.getFileLoadPath(t)) != f && "nativeimage" !== s ? s = "atlas" : f = null;
                    var p = a._resMap[t];
                    p ? (n && (f ? n && p._createListener("complete", this, this._resInfoLoaded, [f, n], !1, !1) : n && p._createListener("complete", n.caller, n.method, n.args, !1, !1)),
                        r && p._createListener("progress", r.caller, r.method, r.args, !1, !1)) : ((p = this._infoPool.length ? this._infoPool.pop() : new e()).url = t,
                            p.type = s, p.cache = l, p.group = h, p.ignoreCache = u, p.useWorkerLoader = c,
                            p.originalUrl = f, n && p.on("complete", n.caller, n.method, n.args), r && p.on("progress", r.caller, r.method, r.args),
                            a._resMap[t] = p, o = o < this._maxPriority ? o : this._maxPriority - 1, this._resInfos[o].push(p),
                            this._statInfo.count++, this.event("progress", this.getProgress()), this._next());
                } else i.systemTimer.frameOnce(1, null, function () {
                    r && r.runWith(1), n && n.runWith(_ instanceof Array ? [_] : _), d._loaderCount || d.event("complete");
                });
                return this;
            }, s._resInfoLoaded = function (t, e) {
                e.runWith(Oe.getRes(t));
            }, s._createLoad = function (t, n, r, s, o, l, h, u, c) {
                var d = this;
                if (void 0 === h && (h = 1), void 0 === u && (u = !0), void 0 === c && (c = !1),
                    t instanceof Array) return this._loadAssets(t, n, r, s, h, u);
                var _ = Oe.getRes(t);
                if (null != _) i.systemTimer.frameOnce(1, null, function () {
                    r && r.runWith(1), n && n.runWith(_), d._loaderCount || d.event("complete");
                }); else {
                    var f = a._resMap[t];
                    f ? (n && f._createListener("complete", n.caller, n.method, n.args, !1, !1), r && f._createListener("progress", r.caller, r.method, r.args, !1, !1)) : ((f = this._infoPool.length ? this._infoPool.pop() : new e()).url = t,
                        f.type = s, f.cache = !1, f.ignoreCache = c, f.originalUrl = null, f.createCache = u,
                        f.createConstructParams = o, f.createPropertyParams = l, n && f.on("complete", n.caller, n.method, n.args),
                        r && f.on("progress", r.caller, r.method, r.args), a._resMap[t] = f, h = h < this._maxPriority ? h : this._maxPriority - 1,
                        this._resInfos[h].push(f), this._statInfo.count++, this.event("progress", this.getProgress()),
                        this._next());
                }
                return this;
            }, s._next = function () {
                if (!(this._loaderCount >= this.maxLoader)) {
                    for (var t = 0; t < this._maxPriority; t++) for (var e = this._resInfos[t]; e.length > 0;) {
                        var i = e.shift();
                        if (i) return this._doLoad(i);
                    }
                    this._loaderCount || this.event("complete");
                }
            }, s._doLoad = function (t) {
                this._loaderCount++;
                var e = this._loaders.length ? this._loaders.pop() : new Oe();
                e.on("complete", null, n), e.on("progress", null, function (e) {
                    t.event("progress", e);
                }), e.on("error", null, function (t) {
                    n(null);
                });
                var i = this;
                function n(n) {
                    e.offAll(), e._data = null, e._customParse = !1, i._loaders.push(e), i._endLoad(t, n instanceof Array ? [n] : n),
                        i._loaderCount--, i._next();
                }
                e._constructParams = t.createConstructParams, e._propertyParams = t.createPropertyParams,
                    e._createCache = t.createCache, e.load(t.url, t.type, t.cache, t.group, t.ignoreCache, t.useWorkerLoader);
            }, s._endLoad = function (t, e) {
                var n = t.url;
                if (null == e) {
                    var r = this._failRes[n] || 0;
                    if (r < this.retryNum) return console.warn("[warn]Retry to load:", n), this._failRes[n] = r + 1,
                        void i.systemTimer.once(this.retryDelay, this, this._addReTry, [t], !1);
                    Oe.clearRes(n), console.warn("[error]Failed to load:", n), this.event("error", n);
                }
                this._failRes[n] && (this._failRes[n] = 0), delete a._resMap[n], t.originalUrl && (e = Oe.getRes(t.originalUrl)),
                    t.event("complete", e), t.offAll(), this._infoPool.push(t), this._statInfo.loaded++,
                    this.event("progress", this.getProgress());
            }, s._addReTry = function (t) {
                this._resInfos[this._maxPriority - 1].push(t), this._next();
            }, s.clearRes = function (t) {
                Oe.clearRes(t);
            }, s.clearTextureRes = function (t) {
                Oe.clearTextureRes(t);
            }, s.getRes = function (t) {
                return Oe.getRes(t);
            }, s.cacheRes = function (t, e) {
                Oe.cacheRes(t, e);
            }, s.setGroup = function (t, e) {
                Oe.setGroup(t, e);
            }, s.clearResByGroup = function (t) {
                Oe.clearResByGroup(t);
            }, s.clearUnLoaded = function () {
                for (var t = 0; t < this._maxPriority; t++) {
                    for (var e = this._resInfos[t], i = e.length - 1; i > -1; i--) {
                        var n = e[i];
                        n && (n.offAll(), this._infoPool.push(n));
                    }
                    e.length = 0;
                }
                this._loaderCount = 0, a._resMap = {};
            }, s.cancelLoadByUrls = function (t) {
                if (t) for (var e = 0, i = t.length; e < i; e++) this.cancelLoadByUrl(t[e]);
            }, s.cancelLoadByUrl = function (t) {
                for (var e = 0; e < this._maxPriority; e++) for (var i = this._resInfos[e], n = i.length - 1; n > -1; n--) {
                    var r = i[n];
                    r && r.url === t && (i[n] = null, r.offAll(), this._infoPool.push(r));
                }
                a._resMap[t] && delete a._resMap[t];
            }, s._loadAssets = function (t, e, i, n, r, a, s) {
                void 0 === r && (r = 1), void 0 === a && (a = !0);
                for (var o = t.length, l = 0, h = 0, u = [], c = !0, d = 0; d < o; d++) {
                    var _ = t[d];
                    "string" == typeof _ && (_ = {
                        url: _,
                        type: n,
                        size: 1,
                        priority: r
                    }), _.size || (_.size = 1), _.progress = 0, h += _.size, u.push(_);
                    var f = i ? g.create(null, y, [_], !1) : null, p = e || i ? g.create(null, m, [_]) : null;
                    this.load(_.url, p, f, _.type, _.priority || 1, a, _.group || s, !1, _.useWorkerLoader);
                }
                function m(t, i) {
                    l++, t.progress = 1, i || (c = !1), l === o && e && e.runWith(c);
                }
                function y(t, e) {
                    if (null != i) {
                        t.progress = e;
                        for (var n = 0, r = 0; r < u.length; r++) {
                            var a = u[r];
                            n += a.size * a.progress;
                        }
                        var s = n / h;
                        i.runWith(s);
                    }
                }
                return this;
            }, s.decodeBitmaps = function (t) {
                var e, i = 0, n = t.length;
                for (e = At._context, i = 0; i < n; i++) {
                    var r, a;
                    if (r = Oe.getAtlas(t[i])) this._decodeTexture(r[0], e); else (a = this.getRes(t[i])) && a instanceof laya.resource.Texture && this._decodeTexture(a, e);
                }
            }, s._decodeTexture = function (t, e) {
                var n = t.bitmap;
                if (t && n) {
                    var r = n.source || n.image;
                    if (r && i.__typeof(r, Ot.window.HTMLImageElement)) {
                        e.drawImage(r, 0, 0, 1, 1);
                        e.getImageData(0, 0, 1, 1);
                    }
                }
            }, a.cacheRes = function (t, e) {
                Oe.cacheRes(t, e);
            }, a._resMap = {}, n(a, ["createMap", function () {
                return this.createMap = {
                    atlas: [null, "atlas"]
                };
            }]), a.__init$ = function () {
                e = function (t) {
                    function e() {
                        this.url = null, this.type = null, this.cache = !1, this.group = null, this.ignoreCache = !1,
                            this.useWorkerLoader = !1, this.originalUrl = null, this.createCache = !1, this.createConstructParams = null,
                            this.createPropertyParams = null, e.__super.call(this);
                    }
                    return r(e, "", t), e;
                }(m);
            }, a;
        }(m)), ke = function (t) {
            function e() {
                e.__super.call(this, 24, 4, 4), this.canReuse = !0, this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo);
            }
            r(e, "laya.webgl.utils.MeshTexture", t);
            var i = e.prototype;
            return i.addData = function (t, e, i, n, r) {
                var a = this._vb, s = this._ib, o = t.length >> 1, l = a.needSize(24 * o) >> 2, h = a._floatArray32 || a.getFloat32Array(), u = a._uint32Array, c = 0, d = n.a, _ = n.b, f = n.c, p = n.d, m = n.tx, g = n.ty, y = 0;
                for (y = 0; y < o; y++) {
                    var v = t[c], S = t[c + 1];
                    h[l] = v * d + S * f + m, h[l + 1] = v * _ + S * p + g, h[l + 2] = e[c], h[l + 3] = e[c + 1],
                        u[l + 4] = r, u[l + 5] = 255, l += 6, c += 2;
                }
                a.setNeedUpload();
                var T = this.vertNum, E = i.length, C = s.needSize(i.byteLength), x = s.getUint16Array(), b = C >> 1;
                if (T > 0) {
                    var I = b + E, w = 0;
                    for (y = b; y < I; y++, w++) x[y] = i[w] + T;
                } else x.set(i, b);
                s.setNeedUpload(), this.vertNum += o, this.indexNum += i.length;
            }, i.releaseMesh = function () {
                this._vb.setByteLength(0), this._ib.setByteLength(0), this.vertNum = 0, this.indexNum = 0,
                    laya.webgl.utils.MeshTexture._POOL.push(this);
            }, i.destroy = function () {
                this._ib.destroy(), this._vb.destroy(), this._ib.disposeResource(), this._vb.deleteBuffer();
            }, e.getAMesh = function (t) {
                var i;
                return i = laya.webgl.utils.MeshTexture._POOL.length ? laya.webgl.utils.MeshTexture._POOL.pop() : new e(),
                    t && i._vb._resizeBuffer(1572864, !1), i;
            }, e.const_stride = 24, e._POOL = [], n(e, ["_fixattriInfo", function () {
                return this._fixattriInfo = [5126, 4, 0, 5121, 4, 16, 5121, 4, 20];
            }]), e;
        }(E), Ve = function (t) {
            function e() {
                this.totalCount = 0, this._completeHandler = null, this._toLoadList = null, this._isLoading = !1,
                    this._curUrl = null, e.__super.call(this), this._completeHandler = new g(this, this.onOneLoadComplete),
                    this.reset();
            }
            r(e, "laya.net.SceneLoader", t);
            var s = e.prototype;
            return s.reset = function () {
                this._toLoadList = [], this._isLoading = !1, this.totalCount = 0;
            }, s.load = function (t, e, i) {
                if (void 0 === e && (e = !1), void 0 === i && (i = !0), t instanceof Array) {
                    var n, r = 0;
                    for (n = t.length, r = 0; r < n; r++) this._addToLoadList(t[r], e);
                } else this._addToLoadList(t, e);
                i && this._checkNext();
            }, s._addToLoadList = function (t, e) {
                void 0 === e && (e = !1), this._toLoadList.indexOf(t) >= 0 || Oe.getRes(t) || (e ? this._toLoadList.push({
                    url: t
                }) : this._toLoadList.push(t), this.totalCount++);
            }, s._checkNext = function () {
                if (!this._isLoading) {
                    if (0 == this._toLoadList.length) return void this.event("complete");
                    var t;
                    "string" == typeof (t = this._toLoadList.pop()) ? this.loadOne(t) : this.loadOne(t.url, !0);
                }
            }, s.loadOne = function (t, n) {
                void 0 === n && (n = !1), this._curUrl = t;
                var r = ie.getFileExtension(this._curUrl);
                n ? i.loader.create(t, this._completeHandler) : e.LoadableExtensions[r] ? i.loader.load(t, this._completeHandler, null, e.LoadableExtensions[r]) : t != ce.getFileLoadPath(t) || e.No3dLoadTypes[r] || !Fe.createMap[r] ? i.loader.load(t, this._completeHandler) : i.loader.create(t, this._completeHandler);
            }, s.onOneLoadComplete = function () {
                this._isLoading = !1, Oe.getRes(this._curUrl) || console.log("Fail to load:", this._curUrl);
                var t, i = ie.getFileExtension(this._curUrl);
                e.LoadableExtensions[i] && ((t = Oe.getRes(this._curUrl)) && t instanceof laya.components.Prefab && (t = t.json),
                    t && (t.loadList && this.load(t.loadList, !1, !1), t.loadList3D && this.load(t.loadList3D, !0, !1)));
                "sk" == i && this.load(this._curUrl.replace(".sk", ".png"), !1, !1), this.event("progress", this.getProgress()),
                    this._checkNext();
            }, s.getProgress = function () {
                return this.loadedCount / this.totalCount;
            }, a(0, s, "loadedCount", function () {
                return this.totalCount - this.leftCount;
            }), a(0, s, "leftCount", function () {
                return this._isLoading ? this._toLoadList.length + 1 : this._toLoadList.length;
            }), n(e, ["LoadableExtensions", function () {
                return this.LoadableExtensions = {
                    scene: "json",
                    scene3d: "json",
                    ani: "json",
                    ui: "json",
                    prefab: "prefab"
                };
            }, "No3dLoadTypes", function () {
                return this.No3dLoadTypes = {
                    png: !0,
                    jpg: !0,
                    txt: !0
                };
            }]), e;
        }(m), Ue = function (t) {
            function e() {
                this.italic = !1, e.__super.call(this);
            }
            r(e, "laya.display.css.TextStyle", t);
            var i = e.prototype;
            return i.reset = function () {
                return t.prototype.reset.call(this), this.italic = !1, this.align = "left", this.wordWrap = !1,
                    this.leading = 0, this.padding = [0, 0, 0, 0], this.bgColor = null, this.borderColor = null,
                    this.asPassword = !1, this.stroke = 0, this.strokeColor = "#000000", this.bold = !1,
                    this.underline = !1, this.underlineColor = null, this.currBitmapFont = null, this;
            }, i.recover = function () {
                this !== e.EMPTY && V.recover("TextStyle", this.reset());
            }, i.render = function (t, e, i, n) {
                (this.bgColor || this.borderColor) && e.drawRect(i, n, t.width, t.height, this.bgColor, this.borderColor, 1);
            }, e.create = function () {
                return V.getItemByClass("TextStyle", e);
            }, e.EMPTY = new e(), e;
        }(J), Ge = function (t) {
            function e() {
                this.worker = null, this._useWorkerLoader = !1, e.__super.call(this);
                var t = this;
                this.worker = new Worker(e.workerPath), this.worker.onmessage = function (e) {
                    t.workerMessage(e.data);
                };
            }
            r(e, "laya.net.WorkerLoader", t);
            var i = e.prototype;
            return i.workerMessage = function (t) {
                if (t) switch (t.type) {
                    case "Image":
                        this.imageLoaded(t);
                        break;

                    case "Disable":
                        e.enable = !1;
                }
            }, i.imageLoaded = function (t) {
                if (t.dataType && "imageBitmap" == t.dataType) {
                    var e = new ai(!0), i = e.source.getContext("2d");
                    switch (t.dataType) {
                        case "imageBitmap":
                            var n = t.imageBitmap;
                            e.size(n.width, n.height), i.drawImage(n, 0, 0);
                    }
                    console.log("load:", t.url), e._setGPUMemory(0);
                    var r = new di();
                    r.loadImageSource(e.source), this.event(t.url, r);
                } else this.event(t.url, null);
            }, i.loadImage = function (t) {
                this.worker.postMessage(t);
            }, i._loadImage = function (t) {
                var i = this;
                if (this._useWorkerLoader && e._enable) {
                    t = Z.formatURL(t);
                    var n = function (r) {
                        laya.net.WorkerLoader.I.off(t, i, n), r ? i.onLoaded(r) : e._preLoadFun.call(i, t);
                    };
                    laya.net.WorkerLoader.I.on(t, i, n), laya.net.WorkerLoader.I.loadImage(t);
                } else e._preLoadFun.call(i, t);
            }, a(1, e, "enable", function () {
                return e._enable;
            }, function (t) {
                e._enable != t && (e._enable = t, t && null == e._preLoadFun && (e._enable = e.__init__()));
            }), e.__init__ = function () {
                return null == e._preLoadFun && (!!Worker && (e._preLoadFun = Oe.prototype._loadImage,
                    Oe.prototype._loadImage = e.prototype._loadImage, e.I || (e.I = new e()), !0));
            }, e.workerSupported = function () {
                return !!Worker;
            }, e.enableWorkerLoader = function () {
                e._tryEnabled || (e.enable = !0, e._tryEnabled = !0);
            }, e.I = null, e.workerPath = "libs/workerloader.js", e._preLoadFun = null, e._enable = !1,
                e._tryEnabled = !1, e;
        }(m), ze = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.webgl.BufferState2D", t), e;
        }(St), He = function (t) {
            function e(t) {
                e.__super.call(this, 4, 0), this._attribLocation = ["position", 0, "attribColor", 1];
            }
            return r(e, "laya.webgl.shader.d2.value.PrimitiveSV", t), e;
        }(H), je = function (t) {
            function e(t) {
                this.texcoord = null, this.position = null, this.offsetX = 300, this.offsetY = 0,
                    e.__super.call(this, 512, 0);
                var i = 8 * dt.BYTES_PE;
                this.position = [2, 5126, !1, i, 0], this.texcoord = [2, 5126, !1, i, 2 * dt.BYTES_PE],
                    this.color = [4, 5126, !1, i, 4 * dt.BYTES_PE];
            }
            return r(e, "laya.webgl.shader.d2.skinAnishader.SkinSV", t), e;
        }(H), We = function (i) {
            function n(i, r, a, s, o) {
                this.ctx = null, this.lastScaleX = 1, this.lastScaleY = 1, this.needResetScale = !1,
                    this.maxTexW = 0, this.maxTexH = 0, this.scaleFontSize = !0, this.showDbgInfo = !1,
                    this.supportImageData = !0, n.__super.call(this), void 0 === a && (a = !0), void 0 === s && (s = !0),
                    void 0 === o && (o = !1), this.maxTexW = i, this.maxTexH = r, this.scaleFontSize = a,
                    this.supportImageData = s, this.showDbgInfo = o, n.canvas || (n.canvas = t.document.createElement("canvas"),
                        n.canvas.width = 1024, n.canvas.height = 512, n.canvas.style.left = "-10000px",
                        n.canvas.style.position = "absolute", e.body.appendChild(n.canvas), this.ctx = n.canvas.getContext("2d"));
            }
            r(n, "laya.webgl.text.CharRender_Canvas", i);
            var s = n.prototype;
            return s.getWidth = function (t, e) {
                return this.ctx ? (this.ctx._lastFont != t && (this.ctx.font = t, this.ctx._lastFont = t),
                    this.ctx.measureText(e).width) : 0;
            }, s.scale = function (t, e) {
                if (!this.supportImageData) return this.lastScaleX = t, void (this.lastScaleY = e);
                this.lastScaleX == t && this.lastScaleY == e || (this.ctx.setTransform(t, 0, 0, e, 0, 0),
                    this.lastScaleX = t, this.lastScaleY = e);
            }, s.getCharBmp = function (t, e, i, n, r, a, s, o, l, h, u) {
                if (!this.supportImageData) return this.getCharCanvas(t, e, i, n, r, a, s, o, l, h);
                var c = this.ctx;
                c.font != e && (c.font = e, c._lastFont = e), a.width = c.measureText(t).width;
                var d = a.width * this.lastScaleX, _ = a.height * this.lastScaleY;
                d += (s + l) * this.lastScaleX, _ += (o + h) * this.lastScaleY, d = Math.ceil(d),
                    _ = Math.ceil(_);
                var f = (d = Math.min(d, laya.webgl.text.CharRender_Canvas.canvas.width)) + 2 * i + 1, p = (_ = Math.min(_, laya.webgl.text.CharRender_Canvas.canvas.height)) + 2 * i + 1;
                u && (f = Math.max(f, u[0] + u[2] + 1), p = Math.max(p, u[1] + u[3] + 1)), c.clearRect(0, 0, f, p),
                    c.save(), c.textBaseline = "top", i > 0 && (c.strokeStyle = r, c.lineWidth = i,
                        c.strokeText(t, s, o)), c.fillStyle = n, c.fillText(t, s, o), this.showDbgInfo && (c.strokeStyle = "#ff0000",
                            c.strokeRect(0, 0, d, _), c.strokeStyle = "#00ff00", c.strokeRect(s, o, a.width, a.height)),
                    u && -1 == u[2] && (u[2] = Math.ceil((a.width + 2 * i) * this.lastScaleX));
                var m = u ? c.getImageData(u[0], u[1], u[2], u[3]) : c.getImageData(0, 0, d, _);
                return c.restore(), a.bmpWidth = m.width, a.bmpHeight = m.height, m;
            }, s.getCharCanvas = function (t, e, i, r, a, s, o, l, h, u) {
                var c = this.ctx;
                c.font != e && (c.font = e, c._lastFont = e), s.width = c.measureText(t).width;
                var d = s.width * this.lastScaleX, _ = s.height * this.lastScaleY;
                return d += (o + h) * this.lastScaleX, _ += (l + u) * this.lastScaleY + 1, d = Math.min(d, this.maxTexW),
                    _ = Math.min(_, this.maxTexH), n.canvas.width = Math.min(d + 1, this.maxTexW), n.canvas.height = Math.min(_ + 1, this.maxTexH),
                    c.font = e, c.clearRect(0, 0, d + 1 + i, _ + 1 + i), c.setTransform(1, 0, 0, 1, 0, 0),
                    c.save(), this.scaleFontSize && c.scale(this.lastScaleX, this.lastScaleY), c.translate(o, l),
                    c.textAlign = "left", c.textBaseline = "top", i > 0 ? (c.strokeStyle = a, c.fillStyle = r,
                        c.lineWidth = i, c.fillAndStrokeText ? c.fillAndStrokeText(t, 0, 0) : (c.strokeText(t, 0, 0),
                            c.fillText(t, 0, 0))) : (c.fillStyle = r, c.fillText(t, 0, 0)), this.showDbgInfo && (c.strokeStyle = "#ff0000",
                                c.strokeRect(0, 0, d, _), c.strokeStyle = "#00ff00", c.strokeRect(0, 0, s.width, s.height)),
                    c.restore(), s.bmpWidth = n.canvas.width, s.bmpHeight = n.canvas.height, n.canvas;
            }, a(0, s, "canvasWidth", function () {
                return n.canvas.width;
            }, function (t) {
                n.canvas.width != t && (n.canvas.width = t, t > 2048 && console.warn("画文字设置的宽度太大，超过2048了"),
                    this.ctx.setTransform(1, 0, 0, 1, 0, 0), this.ctx.scale(this.lastScaleX, this.lastScaleY));
            }), n.canvas = null, n;
        }($t), Xe = function (e) {
            function i() {
                this.lastFont = "", i.__super.call(this);
            }
            r(i, "laya.webgl.text.CharRender_Native", e);
            var n = i.prototype;
            return n.getWidth = function (e, i) {
                return t.conchTextCanvas ? (t.conchTextCanvas.font = e, this.lastFont = e, t.conchTextCanvas.measureText(i).width) : 0;
            }, n.scale = function (t, e) { }, n.getCharBmp = function (e, i, n, r, a, s, l, h, u, c, d) {
                if (!t.conchTextCanvas) return null;
                t.conchTextCanvas.font = i, this.lastFont = i;
                s.width = t.conchTextCanvas.measureText(e).width, s.height;
                var _ = o.create(a).numColor, f = o.create(r).numColor, p = t.conchTextCanvas.getTextBitmapData(e, f, n > 2 ? 2 : n, _);
                return s.bmpWidth = p.width, s.bmpHeight = p.height, p;
            }, i;
        }($t), Ye = function (t) {
            function e() {
                this._x = 0, this._y = 0, this._width = 0, this._height = 0, this._visible = !0,
                    this._mouseState = 0, this._zOrder = 0, this._renderType = 0, this._transform = null,
                    this._tfChanged = !1, this._texture = null, this._boundStyle = null, this._graphics = null,
                    this.mouseThrough = !1, this.autoSize = !1, this.hitTestPrior = !1, e.__super.call(this),
                    this._repaint = 0, this._style = J.EMPTY, this._cacheStyle = tt.EMPTY;
            }
            r(e, "laya.display.Sprite", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._style && this._style.recover(),
                    this._cacheStyle && this._cacheStyle.recover(), this._boundStyle && this._boundStyle.recover(),
                    this._style = null, this._cacheStyle = null, this._boundStyle = null, this._transform = null,
                    this._graphics && this._graphics.autoDestroy && this._graphics.destroy(), this._graphics = null,
                    this.texture = null;
            }, n.updateZOrder = function () {
                ie.updateOrder(this._children) && this.repaint();
            }, n._getBoundsStyle = function () {
                return this._boundStyle || (this._boundStyle = bt.create()), this._boundStyle;
            }, n._setCustomRender = function () { }, n._setCacheAs = function (t) { }, n._checkCanvasEnable = function () {
                var t = this._cacheStyle.needEnableCanvasRender();
                this._getCacheStyle().enableCanvasRender = t, t ? (this._cacheStyle.needBitmapCache() ? this._cacheStyle.cacheAs = "bitmap" : this._cacheStyle.cacheAs = this._cacheStyle.userSetCache,
                    this._cacheStyle.reCache = !0, this._renderType |= 8) : (this._cacheStyle.cacheAs = "none",
                        this._cacheStyle.releaseContext(), this._renderType &= -9), this._setCacheAs(this._cacheStyle.cacheAs),
                    this._setRenderType(this._renderType);
            }, n.reCache = function () {
                this._cacheStyle.reCache = !0, this._repaint |= 2;
            }, n.getRepaint = function () {
                return this._repaint;
            }, n._setX = function (t) {
                this._x = t;
            }, n._setY = function (t) {
                this._y = t;
            }, n._setWidth = function (t, e) { }, n._setHeight = function (t, e) { }, n.setSelfBounds = function (t) {
                this._getBoundsStyle().userBounds = t;
            }, n.getBounds = function () {
                return this._getBoundsStyle().bounds = mt._getWrapRec(this._boundPointsToParent());
            }, n.getSelfBounds = function () {
                return this._boundStyle && this._boundStyle.userBounds ? this._boundStyle.userBounds : this._graphics || 0 !== this._children.length || this._texture ? this._getBoundsStyle().bounds = mt._getWrapRec(this._getBoundPointsM(!1)) : mt.TEMP.setTo(0, 0, 0, 0);
            }, n._boundPointsToParent = function (t) {
                void 0 === t && (t = !1);
                var e = 0, i = 0;
                this._style && (e = this.pivotX, i = this.pivotY, t = t || 0 !== this._style.rotation,
                    this._style.scrollRect && (e += this._style.scrollRect.x, i += this._style.scrollRect.y));
                var n = this._getBoundPointsM(t);
                if (!n || n.length < 1) return n;
                if (8 != n.length && (n = t ? j.scanPList(n) : mt._getWrapRec(n, mt.TEMP)._getBoundPoints()),
                    !this.transform) return ie.transPointList(n, this._x - e, this._y - i), n;
                var r = jt.TEMP, a = 0, s = n.length;
                for (a = 0; a < s; a += 2) r.x = n[a], r.y = n[a + 1], this.toParentPoint(r), n[a] = r.x,
                    n[a + 1] = r.y;
                return n;
            }, n.getGraphicBounds = function (t) {
                return void 0 === t && (t = !1), this._graphics ? this._graphics.getBounds(t) : mt.TEMP.setTo(0, 0, 0, 0);
            }, n._getBoundPointsM = function (t) {
                if (void 0 === t && (t = !1), this._boundStyle && this._boundStyle.userBounds) return this._boundStyle.userBounds._getBoundPoints();
                if (this._boundStyle || this._getBoundsStyle(), this._boundStyle.temBM || (this._boundStyle.temBM = []),
                    this._style.scrollRect) {
                    var e = ie.clearArray(this._boundStyle.temBM), i = mt.TEMP;
                    return i.copyFrom(this._style.scrollRect), ie.concatArray(e, i._getBoundPoints()),
                        e;
                }
                var n, r, a, s;
                this._graphics ? n = this._graphics.getBoundPoints() : (n = ie.clearArray(this._boundStyle.temBM),
                    this._texture && ((i = mt.TEMP).setTo(0, 0, this.width || this._texture.width, this.height || this._texture.height),
                        ie.concatArray(n, i._getBoundPoints())));
                for (var o = 0, l = (s = this._children).length; o < l; o++) (r = s[o]) instanceof laya.display.Sprite && !0 === r._visible && (a = r._boundPointsToParent(t)) && (n = n ? ie.concatArray(n, a) : a);
                return n;
            }, n._getCacheStyle = function () {
                return this._cacheStyle === tt.EMPTY && (this._cacheStyle = tt.create()), this._cacheStyle;
            }, n.getStyle = function () {
                return this._style === J.EMPTY && (this._style = J.create()), this._style;
            }, n.setStyle = function (t) {
                this._style = t;
            }, n._setScaleX = function (t) {
                this._style.scaleX = t;
            }, n._setScaleY = function (t) {
                this._style.scaleY = t;
            }, n._setRotation = function (t) {
                this._style.rotation = t;
            }, n._setSkewX = function (t) {
                this._style.skewX = t;
            }, n._setSkewY = function (t) {
                this._style.skewY = t;
            }, n._createTransform = function () {
                return at.create();
            }, n._adjustTransform = function () {
                this._tfChanged = !1;
                var t = this._style, e = t.scaleX, i = t.scaleY, n = t.skewX, r = t.skewY, a = t.rotation, s = this._transform || (this._transform = this._createTransform());
                if (a || 1 !== e || 1 !== i || 0 !== n || 0 !== r) {
                    s._bTransform = !0;
                    var o = .0174532922222222 * (a - n), l = .0174532922222222 * (a + r), h = Math.cos(l), u = Math.sin(l), c = Math.sin(o), d = Math.cos(o);
                    s.a = e * h, s.b = e * u, s.c = -i * c, s.d = i * d, s.tx = s.ty = 0;
                } else s.identity(), this._renderType &= -3, this._setRenderType(this._renderType);
                return s;
            }, n._setTransform = function (t) { }, n._setPivotX = function (t) {
                this.getStyle().pivotX = t;
            }, n._getPivotX = function () {
                return this._style.pivotX;
            }, n._setPivotY = function (t) {
                this.getStyle().pivotY = t;
            }, n._getPivotY = function () {
                return this._style.pivotY;
            }, n._setAlpha = function (t) {
                this._style.alpha !== t && (this.getStyle().alpha = t, 1 !== t ? this._renderType |= 1 : this._renderType &= -2,
                    this._setRenderType(this._renderType), this.parentRepaint());
            }, n._getAlpha = function () {
                return this._style.alpha;
            }, n._setBlendMode = function (t) { }, n._setGraphics = function (t) { }, n._setGraphicsCallBack = function () { },
                n._setScrollRect = function (t) { }, n.pos = function (t, e, i) {
                    if (void 0 === i && (i = !1), this._x !== t || this._y !== e) {
                        if (this.destroyed) return this;
                        if (i) {
                            this._setX(t), this._setY(e), this.parentRepaint(2);
                            var n = this._cacheStyle.maskParent;
                            n && n.repaint(2);
                        } else this.x = t, this.y = e;
                    }
                    return this;
                }, n.pivot = function (t, e) {
                    return this.pivotX = t, this.pivotY = e, this;
                }, n.size = function (t, e) {
                    return this.width = t, this.height = e, this;
                }, n.scale = function (t, e, i) {
                    void 0 === i && (i = !1);
                    var n = this.getStyle();
                    if (n.scaleX != t || n.scaleY != e) {
                        if (this.destroyed) return this;
                        i ? (this._setScaleX(t), this._setScaleY(e), this._setTranformChange()) : (this.scaleX = t,
                            this.scaleY = e);
                    }
                    return this;
                }, n.skew = function (t, e) {
                    return this.skewX = t, this.skewY = e, this;
                }, n.render = function (t, e, i) {
                    M.renders[this._renderType]._fun(this, t, e + this._x, i + this._y), this._repaint = 0;
                }, n.drawToCanvas = function (t, e, i, n) {
                    return ue.drawToCanvas(this, this._renderType, t, e, i, n);
                }, n.drawToTexture = function (t, e, i, n) {
                    return ue.drawToTexture(this, this._renderType, t, e, i, n);
                }, n.customRender = function (t, e, i) {
                    this._repaint = 3;
                }, n._applyFilters = function () { }, n._setColorFilter = function (t) { }, n._isHaveGlowFilter = function () {
                    var t, e = 0;
                    if (this.filters) for (e = 0; e < this.filters.length; e++) if (8 == this.filters[e].type) return !0;
                    for (e = 0, t = this._children.length; e < t; e++) if (this._children[e]._isHaveGlowFilter()) return !0;
                    return !1;
                }, n.localToGlobal = function (t, e, n) {
                    void 0 === e && (e = !1), !0 === e && (t = new jt(t.x, t.y));
                    var r = this;
                    for (n = n || i.stage; r && !r.destroyed && r != n;) t = r.toParentPoint(t), r = r.parent;
                    return t;
                }, n.globalToLocal = function (t, e, n) {
                    void 0 === e && (e = !1), e && (t = new jt(t.x, t.y));
                    var r = this, a = [];
                    for (n = n || i.stage; r && !r.destroyed && r != n;) a.push(r), r = r.parent;
                    for (var s = a.length - 1; s >= 0;) t = (r = a[s]).fromParentPoint(t), s--;
                    return t;
                }, n.toParentPoint = function (t) {
                    if (!t) return t;
                    t.x -= this.pivotX, t.y -= this.pivotY, this.transform && this._transform.transformPoint(t),
                        t.x += this._x, t.y += this._y;
                    var e = this._style.scrollRect;
                    return e && (t.x -= e.x, t.y -= e.y), t;
                }, n.fromParentPoint = function (t) {
                    if (!t) return t;
                    t.x -= this._x, t.y -= this._y;
                    var e = this._style.scrollRect;
                    return e && (t.x += e.x, t.y += e.y), this.transform && this._transform.invertTransformPoint(t),
                        t.x += this.pivotX, t.y += this.pivotY, t;
                }, n.fromStagePoint = function (t) {
                    return t;
                }, n.on = function (e, i, n, r) {
                    return 1 !== this._mouseState && this.isMouseEvent(e) ? (this.mouseEnabled = !0,
                        this._setBit(64, !0), this._parent && this._$2__onDisplay(), this._createListener(e, i, n, r, !1)) : t.prototype.on.call(this, e, i, n, r);
                }, n.once = function (e, i, n, r) {
                    return 1 !== this._mouseState && this.isMouseEvent(e) ? (this.mouseEnabled = !0,
                        this._setBit(64, !0), this._parent && this._$2__onDisplay(), this._createListener(e, i, n, r, !0)) : t.prototype.once.call(this, e, i, n, r);
                }, n._$2__onDisplay = function () {
                    if (1 !== this._mouseState) {
                        var t = this;
                        for (t = t.parent; t && 1 !== t._mouseState && !t._getBit(64);) t.mouseEnabled = !0,
                            t._setBit(64, !0), t = t.parent;
                    }
                }, n._setParent = function (e) {
                    t.prototype._setParent.call(this, e), e && this._getBit(64) && this._$2__onDisplay();
                }, n.loadImage = function (t, e) {
                    var i = this;
                    if (null == t) this.texture = null, r(); else {
                        var n = Oe.getRes(t);
                        n || ((n = new Me()).load(t), Oe.cacheRes(t, n)), this.texture = n, n.getIsReady() ? r() : n.once("ready", null, r);
                    }
                    function r() {
                        i.repaint(3), e && e.run();
                    }
                    return this;
                }, n.repaint = function (t) {
                    void 0 === t && (t = 2), this._repaint & t || (this._repaint |= t, this.parentRepaint(t)),
                        this._cacheStyle && this._cacheStyle.maskParent && this._cacheStyle.maskParent.repaint(t);
                }, n._needRepaint = function () {
                    return 2 & this._repaint && this._cacheStyle.enableCanvasRender && this._cacheStyle.reCache;
                }, n._childChanged = function (t) {
                    this._children.length ? this._renderType |= 8192 : this._renderType &= -8193, this._setRenderType(this._renderType),
                        t && this._getBit(32) && i.systemTimer.callLater(this, this.updateZOrder), this.repaint(3);
                }, n.parentRepaint = function (t) {
                    void 0 === t && (t = 2);
                    var e = this._parent;
                    !e || e._repaint & t || (e._repaint |= t, e.parentRepaint(t));
                }, n._setMask = function (t) { }, n.startDrag = function (t, e, i, n, r, a, s) {
                    void 0 === e && (e = !1), void 0 === i && (i = 0), void 0 === n && (n = 300), void 0 === a && (a = !1),
                        void 0 === s && (s = .92), this._style.dragging || (this.getStyle().dragging = new Ut()),
                        this._style.dragging.start(this, t, e, i, n, r, a, s);
                }, n.stopDrag = function () {
                    this._style.dragging && this._style.dragging.stop();
                }, n._setDisplay = function (e) {
                    e || this._cacheStyle && (this._cacheStyle.releaseContext(), this._cacheStyle.releaseFilterCache(),
                        this._cacheStyle.hasGlowFilter && (this._cacheStyle.hasGlowFilter = !1)), t.prototype._setDisplay.call(this, e);
                }, n.hitTestPoint = function (t, e) {
                    var i = this.globalToLocal(jt.TEMP.setTo(t, e));
                    return t = i.x, e = i.y, (this._style.hitArea ? this._style.hitArea : this._width > 0 && this._height > 0 ? mt.TEMP.setTo(0, 0, this._width, this._height) : this.getSelfBounds()).contains(t, e);
                }, n.getMousePoint = function () {
                    return this.globalToLocal(jt.TEMP.setTo(i.stage.mouseX, i.stage.mouseY));
                }, n._setTexture = function (t) { }, n._setRenderType = function (t) { }, n._setTranformChange = function () {
                    this._tfChanged = !0, this._renderType |= 2, this.parentRepaint(2);
                }, n._setBgStyleColor = function (t, e, i, n, r) { }, n._setBorderStyleColor = function (t, e, i, n, r, a) { },
                n.captureMouseEvent = function (t) {
                    w.instance.setCapture(this, t);
                }, n.releaseMouseEvent = function () {
                    w.instance.releaseCapture();
                }, a(0, n, "customRenderEnable", null, function (t) {
                    t && (this._renderType |= 2048, this._setRenderType(this._renderType), this._setCustomRender());
                }), a(0, n, "cacheAs", function () {
                    return this._cacheStyle.cacheAs;
                }, function (t) {
                    t !== this._cacheStyle.userSetCache && (this.mask && "normal" === t || (this._setCacheAs(t),
                        this._getCacheStyle().userSetCache = t, this._checkCanvasEnable(), this.repaint()));
                }), a(0, n, "globalScaleY", function () {
                    for (var t = 1, e = this; e && e !== i.stage;) t *= e.scaleY, e = e.parent;
                    return t;
                }), a(0, n, "hitArea", function () {
                    return this._style.hitArea;
                }, function (t) {
                    this.getStyle().hitArea = t;
                }), a(0, n, "staticCache", function () {
                    return this._cacheStyle.staticCache;
                }, function (t) {
                    this._getCacheStyle().staticCache = t, t || this.reCache();
                }), a(0, n, "displayWidth", function () {
                    return this.width * this.scaleX;
                }), a(0, n, "zOrder", function () {
                    return this._zOrder;
                }, function (t) {
                    this._zOrder != t && (this._zOrder = t, this._parent && (t && this._parent._setBit(32, !0),
                        i.systemTimer.callLater(this._parent, this.updateZOrder)));
                }), a(0, n, "rotation", function () {
                    return this._style.rotation;
                }, function (t) {
                    this.getStyle().rotation !== t && (this._setRotation(t), this._setTranformChange());
                }), a(0, n, "width", function () {
                    return this.autoSize ? this.texture ? this.texture.width : this._graphics || 0 !== this._children.length ? this.getSelfBounds().width : 0 : this._width || (this.texture ? this.texture.width : 0);
                }, function (t) {
                    this._width !== t && (this._width = t, this._setWidth(this.texture, t), this._setTranformChange());
                }), a(0, n, "x", function () {
                    return this._x;
                }, function (t) {
                    if (!this.destroyed && this._x !== t) {
                        this._setX(t), this.parentRepaint(2);
                        var e = this._cacheStyle.maskParent;
                        e && e.repaint(2);
                    }
                }), a(0, n, "drawCallOptimize", function () {
                    return this._getBit(256);
                }, function (t) {
                    this._setBit(256, t);
                }), a(0, n, "texture", function () {
                    return this._texture;
                }, function (t) {
                    "string" == typeof t ? this.loadImage(t) : this._texture != t && (this._texture && this._texture._removeReference(),
                        this._texture = t, t && t._addReference(), this._setTexture(t), this._setWidth(this._texture, this.width),
                        this._setHeight(this._texture, this.height), t ? this._renderType |= 256 : this._renderType &= -257,
                        this._setRenderType(this._renderType), this.repaint());
                }), a(0, n, "globalRotation", function () {
                    for (var t = 0, e = this; e && e !== i.stage;) t += e.rotation, e = e.parent;
                    return t;
                }), a(0, n, "y", function () {
                    return this._y;
                }, function (t) {
                    if (!this.destroyed && this._y !== t) {
                        this._setY(t), this.parentRepaint(2);
                        var e = this._cacheStyle.maskParent;
                        e && e.repaint(2);
                    }
                }), a(0, n, "displayHeight", function () {
                    return this.height * this.scaleY;
                }), a(0, n, "height", function () {
                    return this.autoSize ? this.texture ? this.texture.height : this._graphics || 0 !== this._children.length ? this.getSelfBounds().height : 0 : this._height || (this.texture ? this.texture.height : 0);
                }, function (t) {
                    this._height !== t && (this._height = t, this._setHeight(this.texture, t), this._setTranformChange());
                }), a(0, n, "blendMode", function () {
                    return this._style.blendMode;
                }, function (t) {
                    this._setBlendMode(t), this.getStyle().blendMode = t, t && "source-over" != t ? this._renderType |= 4 : this._renderType &= -5,
                        this._setRenderType(this._renderType), this.parentRepaint();
                }), a(0, n, "scaleX", function () {
                    return this._style.scaleX;
                }, function (t) {
                    this.getStyle().scaleX !== t && (this._setScaleX(t), this._setTranformChange());
                }), a(0, n, "scaleY", function () {
                    return this._style.scaleY;
                }, function (t) {
                    this.getStyle().scaleY !== t && (this._setScaleY(t), this._setTranformChange());
                }), a(0, n, "stage", function () {
                    return i.stage;
                }), a(0, n, "skewX", function () {
                    return this._style.skewX;
                }, function (t) {
                    this.getStyle().skewX !== t && (this._setSkewX(t), this._setTranformChange());
                }), a(0, n, "scrollRect", function () {
                    return this._style.scrollRect;
                }, function (t) {
                    this.getStyle().scrollRect = t, this._setScrollRect(t), this.repaint(), t ? this._renderType |= 64 : this._renderType &= -65,
                        this._setRenderType(this._renderType);
                }), a(0, n, "skewY", function () {
                    return this._style.skewY;
                }, function (t) {
                    this.getStyle().skewY !== t && (this._setSkewY(t), this._setTranformChange());
                }), a(0, n, "transform", function () {
                    return this._tfChanged ? this._adjustTransform() : this._transform;
                }, function (t) {
                    this._tfChanged = !1;
                    var e = this._transform || (this._transform = this._createTransform());
                    t.copyTo(e), this._setTransform(e), t && (this._x = e.tx, this._y = e.ty, e.tx = e.ty = 0),
                        t ? this._renderType |= 2 : this._renderType &= -3, this._setRenderType(this._renderType),
                        this.parentRepaint();
                }), a(0, n, "pivotX", function () {
                    return this._getPivotX();
                }, function (t) {
                    this._setPivotX(t), this.repaint();
                }), a(0, n, "pivotY", function () {
                    return this._getPivotY();
                }, function (t) {
                    this._setPivotY(t), this.repaint();
                }), a(0, n, "alpha", function () {
                    return this._getAlpha();
                }, function (t) {
                    t = t < 0 ? 0 : t > 1 ? 1 : t, this._setAlpha(t);
                }), a(0, n, "visible", function () {
                    return this._visible;
                }, function (t) {
                    this._visible !== t && (this._visible = t, this.parentRepaint(3));
                }), a(0, n, "graphics", function () {
                    return this._graphics || (this.graphics = new Zt(), this._graphics.autoDestroy = !0),
                        this._graphics;
                }, function (t) {
                    this._graphics && (this._graphics._sp = null), this._graphics = t, t ? (this._setGraphics(t),
                        this._renderType |= 512, t._sp = this) : this._renderType &= -513, this._setRenderType(this._renderType),
                        this.repaint();
                }), a(0, n, "filters", function () {
                    return this._cacheStyle.filters;
                }, function (t) {
                    t && 0 === t.length && (t = null), this._cacheStyle.filters != t && (this._getCacheStyle().filters = t ? t.slice() : null,
                        t && t.length ? (this._setColorFilter(t[0]), this._renderType |= 16) : (this._setColorFilter(null),
                            this._renderType &= -17), this._setRenderType(this._renderType), t && t.length > 0 ? (this._getBit(16) || this._setBitUp(16),
                                1 == t.length && t[0] instanceof laya.filters.ColorFilter || (this._getCacheStyle().cacheForFilters = !0,
                                    this._checkCanvasEnable())) : this._cacheStyle.cacheForFilters && (this._cacheStyle.cacheForFilters = !1,
                                        this._checkCanvasEnable()), this._getCacheStyle().hasGlowFilter = this._isHaveGlowFilter(),
                        this.repaint());
                }), a(0, n, "mask", function () {
                    return this._cacheStyle.mask;
                }, function (t) {
                    t && this.mask && this.mask._cacheStyle.maskParent || (this._getCacheStyle().mask = t,
                        this._setMask(t), this._checkCanvasEnable(), t ? t._getCacheStyle().maskParent = this : this.mask && (this.mask._getCacheStyle().maskParent = null),
                        this._renderType |= 32, this._setRenderType(this._renderType), this.parentRepaint(3));
                }), a(0, n, "mouseEnabled", function () {
                    return this._mouseState > 1;
                }, function (t) {
                    this._mouseState = t ? 2 : 1;
                }), a(0, n, "globalScaleX", function () {
                    for (var t = 1, e = this; e && e !== i.stage;) t *= e.scaleX, e = e.parent;
                    return t;
                }), a(0, n, "mouseX", function () {
                    return this.getMousePoint().x;
                }), a(0, n, "mouseY", function () {
                    return this.getMousePoint().y;
                }), a(0, n, "viewport", function () {
                    return this._style.viewport;
                }, function (t) {
                    var e;
                    "string" == typeof t && ((e = t.split(",")).length > 3 && (t = new mt(parseFloat(e[0]), parseFloat(e[1]), parseFloat(e[2]), parseFloat(e[3]))));
                    this.getStyle().viewport = t;
                }), e.fromImage = function (t) {
                    return new e().loadImage(t);
                }, e;
        }(xe), qe = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.webgl.shader.BaseShader", t), e.activeShader = null, e.bindShader = null,
                e;
        }(Ie), Ke = function (t) {
            function e() {
                e.__super.call(this), this._width = -1, this._height = -1;
            }
            r(e, "laya.resource.Bitmap", t);
            var i = e.prototype;
            return i._getSource = function () {
                throw "Bitmap: must override it.";
            }, a(0, i, "width", function () {
                return this._width;
            }), a(0, i, "height", function () {
                return this._height;
            }), e;
        }(Ie), Ze = function (t) {
            function e(t, i) {
                this._source = null, this._texW = 0, this._texH = 0, this.__destroyed = !1, this._discardTm = 0,
                    this.genID = 0, this.bitmap = {
                        id: 0,
                        _glTexture: null
                    }, this.curUsedCovRate = 0, this.curUsedCovRateAtlas = 0, this.lastTouchTm = 0,
                    this.ri = null, e.__super.call(this), this._texW = t || x.atlasWidth, this._texH = i || x.atlasWidth,
                    this.bitmap.id = this.id, this.lock = !0;
            }
            r(e, "laya.webgl.text.TextTexture", t);
            var s = e.prototype;
            return s.recreateResource = function () {
                if (!this._source) {
                    var t = At.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext, e = this._source = t.createTexture();
                    this.bitmap._glTexture = e, nt.bindTexture(t, 3553, e), t.texImage2D(3553, 0, 6408, this._texW, this._texH, 0, 6408, 5121, null),
                        t.texParameteri(3553, 10241, 9729), t.texParameteri(3553, 10240, 9729), t.texParameteri(3553, 10242, 33071),
                        t.texParameteri(3553, 10243, 33071), x.debugUV && this.fillWhite();
                }
            }, s.addChar = function (t, e, i, n) {
                if (x.isWan1Wan) return this.addCharCanvas(t, e, i, n);
                !this._source && this.recreateResource();
                var r = At.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                nt.bindTexture(r, 3553, this._source), !At.isConchApp && r.pixelStorei(37441, !0);
                var a = t.data;
                t.data instanceof Uint8ClampedArray && (a = new Uint8Array(a.buffer)), r.texSubImage2D(3553, 0, e, i, t.width, t.height, 6408, 5121, a),
                    !At.isConchApp && r.pixelStorei(37441, !1);
                var s = NaN, o = NaN, l = NaN, h = NaN;
                return At.isConchApp ? (s = e / this._texW, o = i / this._texH, l = (e + t.width) / this._texW,
                    h = (i + t.height) / this._texH) : (s = (e + 1) / this._texW, o = i / this._texH,
                        l = (e + t.width - 1) / this._texW, h = (i + t.height - 1) / this._texH), (n = n || new Array(8))[0] = s,
                    n[1] = o, n[2] = l, n[3] = o, n[4] = l, n[5] = h, n[6] = s, n[7] = h, n;
            }, s.addCharCanvas = function (t, e, i, n) {
                !this._source && this.recreateResource();
                var r = At.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                nt.bindTexture(r, 3553, this._source), !At.isConchApp && r.pixelStorei(37441, !0),
                    r.texSubImage2D(3553, 0, e, i, 6408, 5121, t), !At.isConchApp && r.pixelStorei(37441, !1);
                var a = NaN, s = NaN, o = NaN, l = NaN;
                return At.isConchApp ? (a = e / this._texW, s = i / this._texH, o = (e + t.width) / this._texW,
                    l = (i + t.height) / this._texH) : (a = (e + 1) / this._texW, s = (i + 1) / this._texH,
                        o = (e + t.width - 1) / this._texW, l = (i + t.height - 1) / this._texH), (n = n || new Array(8))[0] = a,
                    n[1] = s, n[2] = o, n[3] = s, n[4] = o, n[5] = l, n[6] = a, n[7] = l, n;
            }, s.fillWhite = function () {
                !this._source && this.recreateResource();
                var t = At.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext, e = new Uint8Array(this._texW * this._texH * 4);
                e.fill(255), t.texSubImage2D(3553, 0, 0, 0, this._texW, this._texH, 6408, 5121, e);
            }, s.discard = function () {
                this._texW == x.atlasWidth && this._texH == x.atlasWidth ? (this.genID++, e.poolLen >= e.pool.length && (e.pool = e.pool.concat(new Array(10))),
                    this._discardTm = i.stage.getFrameTm(), e.pool[e.poolLen++] = this) : this.destroy();
            }, s.destroy = function () {
                this.__destroyed = !0;
                var t = At.isConchApp ? Dt.instance.getDefaultCommandEncoder() : Ct.mainContext;
                this._source && t.deleteTexture(this._source), this._source = null;
            }, s.touchRect = function (t, e) {
                this.lastTouchTm != e && (this.curUsedCovRate = 0, this.curUsedCovRateAtlas = 0,
                    this.lastTouchTm = e);
                var i = x.atlasWidth * x.atlasWidth, n = kt.atlasGridW * kt.atlasGridW;
                this.curUsedCovRate += t.bmpWidth * t.bmpHeight / i, this.curUsedCovRateAtlas += Math.ceil(t.bmpWidth / kt.atlasGridW) * Math.ceil(t.bmpHeight / kt.atlasGridW) / (i / n);
            }, s._getSource = function () {
                return this._source;
            }, s.drawOnScreen = function (t, e) { }, a(0, s, "texture", function () {
                return this;
            }), e.getTextTexture = function (t, i) {
                if (t != x.atlasWidth || t != x.atlasWidth) return new e(t, i);
                if (e.poolLen > 0) {
                    var n = e.pool[--e.poolLen];
                    return e.poolLen > 0 && e.clean(), n;
                }
                return new e(t, i);
            }, e.clean = function () {
                var t = i.stage.getFrameTm();
                if (0 === e.cleanTm && (e.cleanTm = t), t - e.cleanTm >= x.checkCleanTextureDt) {
                    for (var n = 0; n < e.poolLen; n++) {
                        var r = e.pool[n];
                        t - r._discardTm >= x.destroyUnusedTextureDt && (r.destroy(), e.pool[n] = e.pool[e.poolLen - 1],
                            e.poolLen--, n--);
                    }
                    e.cleanTm = t;
                }
            }, e.poolLen = 0, e.cleanTm = 0, n(e, ["pool", function () {
                return this.pool = new Array(10);
            }]), e;
        }(Ie), Qe = function (t) {
            function e(t) {
                this._uint16Array = null, void 0 === t && (t = 35044), e.__super.call(this), this._bufferUsage = t,
                    this._bufferType = 34963, this._buffer = new ArrayBuffer(8);
            }
            r(e, "laya.webgl.utils.IndexBuffer2D", t);
            var i = e.prototype;
            return i._checkArrayUse = function () {
                this._uint16Array && (this._uint16Array = new Uint16Array(this._buffer));
            }, i.getUint16Array = function () {
                return this._uint16Array || (this._uint16Array = new Uint16Array(this._buffer));
            }, i._bindForVAO = function () {
                Dt.instance.bindBuffer(34963, this._glBuffer);
            }, i.bind = function () {
                return G._bindedIndexBuffer !== this._glBuffer && (Dt.instance.bindBuffer(34963, this._glBuffer),
                    G._bindedIndexBuffer = this._glBuffer, !0);
            }, i.destory = function () {
                this._uint16Array = null, this._buffer = null;
            }, i.disposeResource = function () {
                this._disposeResource();
            }, e.create = function (t) {
                return void 0 === t && (t = 35044), new e(t);
            }, e;
        }(Le), Je = function (t) {
            function e() {
                this.audioBuffer = null, this.gain = null, this.bufferSource = null, this._currentTime = 0,
                    this._volume = 1, this._startTime = 0, this._pauseTime = 0, this._onPlayEnd = null,
                    this.context = Ne.ctx, e.__super.call(this), this._onPlayEnd = ie.bind(this.__onPlayEnd, this),
                    this.context.createGain ? this.gain = this.context.createGain() : this.gain = this.context.createGainNode();
            }
            r(e, "laya.media.webaudio.WebAudioSoundChannel", t);
            var n = e.prototype;
            return n.play = function () {
                if (ve.addChannel(this), this.isStopped = !1, this._clearBufferSource(), this.audioBuffer) {
                    var t = this.context, e = this.gain, i = t.createBufferSource();
                    this.bufferSource = i, i.buffer = this.audioBuffer, i.connect(e), e && e.disconnect(),
                        e.connect(t.destination), i.onended = this._onPlayEnd, this.startTime >= this.duration && (this.startTime = 0),
                        this._startTime = Ot.now(), this.gain.gain.setTargetAtTime ? this.gain.gain.setTargetAtTime(this._volume, this.context.currentTime, .001) : this.gain.gain.value = this._volume,
                        0 == this.loops && (i.loop = !0), i.playbackRate.setTargetAtTime ? i.playbackRate.setTargetAtTime(ve.playbackRate, this.context.currentTime, .001) : i.playbackRate.value = ve.playbackRate,
                        i.start(0, this.startTime), this._currentTime = 0;
                }
            }, n.__onPlayEnd = function () {
                if (1 == this.loops) return this.completeHandler && (i.timer.once(10, this, this.__runComplete, [this.completeHandler], !1),
                    this.completeHandler = null), this.stop(), void this.event("complete");
                this.loops > 0 && this.loops--, this.startTime = 0, this.play();
            }, n._clearBufferSource = function () {
                if (this.bufferSource) {
                    var t = this.bufferSource;
                    t.stop ? t.stop(0) : t.noteOff(0), t.disconnect(0), t.onended = null, e._tryCleanFailed || this._tryClearBuffer(t),
                        this.bufferSource = null;
                }
            }, n._tryClearBuffer = function (t) {
                if (Ot.onMac) try {
                    t.buffer = Ne._miniBuffer;
                } catch (t) {
                    e._tryCleanFailed = !0;
                } else try {
                    t.buffer = null;
                } catch (t) {
                    e._tryCleanFailed = !0;
                }
            }, n.stop = function () {
                t.prototype.stop.call(this), this._clearBufferSource(), this.audioBuffer = null,
                    this.gain && this.gain.disconnect(), this.isStopped = !0, ve.removeChannel(this),
                    this.completeHandler = null, ve.autoReleaseSound && ve.disposeSoundLater(this.url);
            }, n.pause = function () {
                this.isStopped || (this._pauseTime = this.position), this._clearBufferSource(),
                    this.gain && this.gain.disconnect(), this.isStopped = !0, ve.removeChannel(this),
                    ve.autoReleaseSound && ve.disposeSoundLater(this.url);
            }, n.resume = function () {
                this.startTime = this._pauseTime, this.play();
            }, a(0, n, "position", function () {
                return this.bufferSource ? (Ot.now() - this._startTime) / 1e3 + this.startTime : 0;
            }), a(0, n, "duration", function () {
                return this.audioBuffer ? this.audioBuffer.duration : 0;
            }), a(0, n, "volume", function () {
                return this._volume;
            }, function (t) {
                this._volume = t, this.isStopped || (this.gain.gain.setTargetAtTime ? this.gain.gain.setTargetAtTime(t, this.context.currentTime, .001) : this.gain.gain.value = t);
            }), e._tryCleanFailed = !1, e.SetTargetDelay = .001, e;
        }(be), $e = function (t) {
            function e(t) {
                this._audio = null, this._onEnd = null, this._resumePlay = null, e.__super.call(this),
                    this._onEnd = ie.bind(this.__onEnd, this), this._resumePlay = ie.bind(this.__resumePlay, this),
                    t.addEventListener("ended", this._onEnd), this._audio = t;
            }
            r(e, "laya.media.h5audio.AudioSoundChannel", t);
            var n = e.prototype;
            return n.__onEnd = function () {
                if (1 == this.loops) return this.completeHandler && (i.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], !1),
                    this.completeHandler = null), this.stop(), void this.event("complete");
                this.loops > 0 && this.loops--, this.startTime = 0, this.play();
            }, n.__resumePlay = function () {
                if (this._audio && this._audio.removeEventListener("canplay", this._resumePlay),
                    !this.isStopped) try {
                        this._audio.currentTime = this.startTime, Ot.container.appendChild(this._audio),
                            this._audio.play();
                    } catch (t) {
                        this.event("error");
                    }
            }, n.play = function () {
                this.isStopped = !1;
                try {
                    this._audio.playbackRate = ve.playbackRate, this._audio.currentTime = this.startTime;
                } catch (t) {
                    return void this._audio.addEventListener("canplay", this._resumePlay);
                }
                ve.addChannel(this), Ot.container.appendChild(this._audio), "play" in this._audio && this._audio.play();
            }, n.stop = function () {
                t.prototype.stop.call(this), this.isStopped = !0, ve.removeChannel(this), this.completeHandler = null,
                    this._audio && ("pause" in this._audio && At.isConchApp && this._audio.stop(), this._audio.pause(),
                        this._audio.removeEventListener("ended", this._onEnd), this._audio.removeEventListener("canplay", this._resumePlay),
                        Ot.onIE || this._audio != Ce._musicAudio && V.recover("audio:" + this.url, this._audio),
                        Ot.removeElement(this._audio), this._audio = null);
            }, n.pause = function () {
                this.isStopped = !0, ve.removeChannel(this), "pause" in this._audio && this._audio.pause();
            }, n.resume = function () {
                this._audio && (this.isStopped = !1, ve.addChannel(this), "play" in this._audio && this._audio.play());
            }, a(0, n, "position", function () {
                return this._audio ? this._audio.currentTime : 0;
            }), a(0, n, "duration", function () {
                return this._audio ? this._audio.duration : 0;
            }), a(0, n, "volume", function () {
                return this._audio ? this._audio.volume : 1;
            }, function (t) {
                this._audio && (this._audio.volume = t);
            }), e;
        }(be), ti = function (t) {
            function e(t, i) {
                this._floatArray32 = null, this._uint32Array = null, this._vertexStride = 0, e.__super.call(this),
                    this._vertexStride = t, this._bufferUsage = i, this._bufferType = 34962, this._buffer = new ArrayBuffer(8),
                    this._floatArray32 = new Float32Array(this._buffer), this._uint32Array = new Uint32Array(this._buffer);
            }
            r(e, "laya.webgl.utils.VertexBuffer2D", t);
            var i = e.prototype;
            return i.getFloat32Array = function () {
                return this._floatArray32;
            }, i.appendArray = function (t) {
                var e = this._byteLength >> 2;
                this.setByteLength(this._byteLength + 4 * t.length), this.getFloat32Array().set(t, e),
                    this._upload = !0;
            }, i._checkArrayUse = function () {
                this._floatArray32 && (this._floatArray32 = new Float32Array(this._buffer)), this._uint32Array && (this._uint32Array = new Uint32Array(this._buffer));
            }, i.deleteBuffer = function () {
                this._disposeResource();
            }, i._bindForVAO = function () {
                Dt.instance.bindBuffer(34962, this._glBuffer);
            }, i.bind = function () {
                return G._bindedVertexBuffer !== this._glBuffer && (Dt.instance.bindBuffer(34962, this._glBuffer),
                    G._bindedVertexBuffer = this._glBuffer, !0);
            }, i.destroy = function () {
                laya.webgl.utils.Buffer.prototype.destroy.call(this), this._byteLength = 0, this._upload = !0,
                    this._buffer = null, this._floatArray32 = null;
            }, a(0, i, "vertexStride", function () {
                return this._vertexStride;
            }), e.create = function (t, i) {
                return void 0 === i && (i = 35048), new e(t, i);
            }, e;
        }(Le), ei = function (e) {
            function s() {
                this._clipPoint = null, this._text = null, this._isChanged = !1, this._textWidth = 0,
                    this._textHeight = 0, this._lines = [], this._lineWidths = [], this._startX = 0,
                    this._startY = 0, this._words = null, this._charSize = {}, this._valign = "top",
                    this._color = "#000000", this._singleCharRender = !1, s.__super.call(this), this._fontSize = s.defaultFontSize,
                    this._font = s.defaultFont, this.overflow = "visible", this._style = Ue.EMPTY;
            }
            r(s, "laya.display.Text", e);
            var o = s.prototype;
            return o.getStyle = function () {
                return this._style === Ue.EMPTY && (this._style = Ue.create()), this._style;
            }, o._getTextStyle = function () {
                return this._style === Ue.EMPTY && (this._style = Ue.create()), this._style;
            }, o.destroy = function (t) {
                void 0 === t && (t = !0), e.prototype.destroy.call(this, t), this._clipPoint = null,
                    this._lines = null, this._lineWidths = null, this._words && this._words.forEach(function (t) {
                        t.cleanCache();
                    }), this._words = null, this._charSize = null;
            }, o._getBoundPointsM = function (t) {
                void 0 === t && (t = !1);
                var e = mt.TEMP;
                return e.setTo(0, 0, this.width, this.height), e._getBoundPoints();
            }, o.getGraphicBounds = function (t) {
                void 0 === t && (t = !1);
                var e = mt.TEMP;
                return e.setTo(0, 0, this.width, this.height), e;
            }, o._getCSSStyle = function () {
                return this._style;
            }, o.lang = function (t, e, i, n, r, a, o, l, h, u, c) {
                if (t = s.langPacks && s.langPacks[t] ? s.langPacks[t] : t, arguments.length < 2) this._text = t; else {
                    for (var d = 0, _ = arguments.length; d < _; d++) t = t.replace("{" + d + "}", arguments[d + 1]);
                    this._text = t;
                }
            }, o._getContextFont = function () {
                return (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + (Ot.onIPhone && laya.display.Text.fontFamilyMap[this.font] || this.font);
            }, o._isPassWordMode = function () {
                var t = this._style.asPassword;
                return "prompt" in this && this.prompt == this._text && (t = !1), t;
            }, o._getPassWordTxt = function (t) {
                var e;
                e = "";
                for (var i = t.length; i > 0; i--) e += "●";
                return e;
            }, o._renderText = function () {
                var t = this.padding, e = this._lines.length;
                "visible" != this.overflow && (e = Math.min(e, Math.floor((this.height - t[0] - t[2]) / (this.leading + this._charSize.height)) + 1));
                var i = this.scrollY / (this._charSize.height + this.leading) | 0, n = this.graphics;
                n.clear(!0);
                var r = this._getContextFont();
                Ot.context.font = r;
                var a = t[3], s = "left", o = this._lines, l = this.leading + this._charSize.height, h = this._style.currBitmapFont;
                h && (l = this.leading + h.getMaxHeight());
                var u = t[0];
                if (!h && this._width > 0 && this._textWidth <= this._width && ("right" == this.align ? (s = "right",
                    a = this._width - t[1]) : "center" == this.align && (s = "center", a = .5 * this._width + t[3] - t[1])),
                    this._height > 0) {
                    var c = this._textHeight > this._height ? "top" : this.valign;
                    "middle" === c ? u = .5 * (this._height - e * l) + t[0] - t[2] : "bottom" === c && (u = this._height - e * l - t[2]);
                }
                var d = this._style;
                if (h && h.autoScaleSize) var _ = h.fontSize / this.fontSize;
                if (this._clipPoint) {
                    if (n.save(), h && h.autoScaleSize) {
                        var f = 0, p = 0;
                        f = this._width ? this._width - t[3] - t[1] : this._textWidth, p = this._height ? this._height - t[0] - t[2] : this._textHeight,
                            f *= _, p *= _, n.clipRect(t[3], t[0], f, p);
                    } else n.clipRect(t[3], t[0], this._width ? this._width - t[3] - t[1] : this._textWidth, this._height ? this._height - t[0] - t[2] : this._textHeight);
                    this.repaint();
                }
                var m = d.asPassword;
                "prompt" in this && this.prompt == this._text && (m = !1);
                for (var g = 0, y = 0, v = Math.min(this._lines.length, e + i) || 1, S = i; S < v; S++) {
                    var E, C = o[S];
                    if (m) {
                        var x = C.length;
                        C = "";
                        for (var b = x; b > 0; b--) C += "●";
                    }
                    if (null == C && (C = ""), g = a - (this._clipPoint ? this._clipPoint.x : 0), y = u + l * S - (this._clipPoint ? this._clipPoint.y : 0),
                        this.underline && this._drawUnderline(s, g, y, S), h) {
                        var I = this.width;
                        h.autoScaleSize && (I = this.width * _), h._drawText(C, this, g, y, this.align, I);
                    } else this._words || (this._words = []), this._words.length > S - i ? E = this._words[S - i] : (E = new T(),
                        this._words.push(E)), E.setText(C), E.splitRender = this._singleCharRender, d.stroke ? n.fillBorderText(E, g, y, r, this.color, d.strokeColor, d.stroke, s) : n.fillText(E, g, y, r, this.color, s);
                }
                if (h && h.autoScaleSize) {
                    var w = 1 / _;
                    this.scale(w, w);
                }
                this._clipPoint && n.restore(), this._startX = a, this._startY = u;
            }, o._drawUnderline = function (t, e, i, n) {
                var r = this._lineWidths[n];
                switch (t) {
                    case "center":
                        e -= r / 2;
                        break;

                    case "right":
                        e -= r;
                }
                i += this._charSize.height, this._graphics.drawLine(e, i, e + r, i, this.underlineColor || this.color, 1);
            }, o.typeset = function () {
                if (this._isChanged = !1, !this._text) return this._clipPoint = null, this._textWidth = this._textHeight = 0,
                    void this.graphics.clear(!0);
                At.isConchApp ? t.conchTextCanvas.font = this._getContextFont() : Ot.context.font = this._getContextFont(),
                    this._lines.length = 0, this._lineWidths.length = 0, this._isPassWordMode() ? this._parseLines(this._getPassWordTxt(this._text)) : this._parseLines(this._text),
                    this._evalTextSize(), this._checkEnabledViewportOrNot() ? this._clipPoint || (this._clipPoint = new jt(0, 0)) : this._clipPoint = null,
                    this._renderText();
            }, o._evalTextSize = function () {
                var t, e = NaN;
                t = Math.max.apply(this, this._lineWidths), e = this._style.currBitmapFont ? this._lines.length * (this._style.currBitmapFont.getMaxHeight() + this.leading) + this.padding[0] + this.padding[2] : this._lines.length * (this._charSize.height + this.leading) + this.padding[0] + this.padding[2],
                    t == this._textWidth && e == this._textHeight || (this._textWidth = t, this._textHeight = e);
            }, o._checkEnabledViewportOrNot = function () {
                return "scroll" == this.overflow && (this._width > 0 && this._textWidth > this._width || this._height > 0 && this._textHeight > this._height);
            }, o.changeText = function (t) {
                this._text !== t && (this.lang(t + ""), this._graphics && this._graphics.replaceText(this._text) || this.typeset());
            }, o._parseLines = function (e) {
                var i = this.wordWrap || "hidden" == this.overflow;
                if (i) var n = this._getWordWrapWidth();
                var r = this._style.currBitmapFont;
                if (r) this._charSize.width = r.getMaxWidth(), this._charSize.height = r.getMaxHeight(); else {
                    var a = null;
                    (a = At.isConchApp ? t.conchTextCanvas.measureText(this._testWord) : Ot.context.measureText(s._testWord)) || (a = {
                        width: 100
                    }), this._charSize.width = a.width, this._charSize.height = a.height || this.fontSize;
                }
                for (var o = e.replace(/\r\n/g, "\n").split("\n"), l = 0, h = o.length; l < h; l++) {
                    var u = o[l];
                    i ? this._parseLine(u, n) : (this._lineWidths.push(this._getTextWidth(u)), this._lines.push(u));
                }
            }, o._parseLine = function (t, e) {
                Ot.context;
                var i, n = this._lines, r = 0, a = NaN, s = NaN, o = 0;
                if ((a = this._getTextWidth(t)) <= e) return n.push(t), void this._lineWidths.push(a);
                a = this._charSize.width, 0 == (r = Math.floor(e / a)) && (r = 1), s = a = this._getTextWidth(t.substring(0, r));
                for (var l = r, h = t.length; l < h; l++) if ((s += a = this._getTextWidth(t.charAt(l))) > e) if (this.wordWrap) {
                    var u = t.substring(o, l);
                    if (u.charCodeAt(u.length - 1) < 255 && (i = /(?:\w|-)+$/.exec(u)) && (l = i.index + o,
                        0 == i.index ? l += u.length : u = t.substring(o, l)), n.push(u), this._lineWidths.push(s - a),
                        o = l, !(l + r < h)) {
                        n.push(t.substring(o, h)), this._lineWidths.push(this._getTextWidth(n[n.length - 1])),
                            o = -1;
                        break;
                    }
                    l += r, s = a = this._getTextWidth(t.substring(o, l)), l--;
                } else if ("hidden" == this.overflow) return n.push(t.substring(0, l)), void this._lineWidths.push(this._getTextWidth(n[n.length - 1]));
                this.wordWrap && -1 != o && (n.push(t.substring(o, h)), this._lineWidths.push(this._getTextWidth(n[n.length - 1])));
            }, o._getTextWidth = function (e) {
                var i = this._style.currBitmapFont;
                return i ? i.getTextWidth(e) : At.isConchApp ? t.conchTextCanvas.measureText(e).width : Ot.context.measureText(e).width;
            }, o._getWordWrapWidth = function () {
                var t = this.padding, e = NaN, i = this._style.currBitmapFont;
                return (e = i && i.autoScaleSize ? this._width * (i.fontSize / this.fontSize) : this._width) <= 0 && (e = this.wordWrap ? 100 : Ot.width),
                    e <= 0 && (e = 100), e - t[3] - t[1];
            }, o.getCharPoint = function (t, e) {
                this._isChanged && i.systemTimer.runCallLater(this, this.typeset);
                for (var n = 0, r = this._lines, a = 0, s = 0, o = r.length; s < o; s++) {
                    if (t < (n += r[s].length)) {
                        var l = s;
                        break;
                    }
                    a = n;
                }
                var h = (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + this.font;
                Ot.context.font = h;
                var u = this._getTextWidth(this._text.substring(a, t));
                return (e || new jt()).setTo(this._startX + u - (this._clipPoint ? this._clipPoint.x : 0), this._startY + l * (this._charSize.height + this.leading) - (this._clipPoint ? this._clipPoint.y : 0));
            }, a(0, o, "width", function () {
                return this._width ? this._width : this.textWidth + this.padding[1] + this.padding[3];
            }, function (t) {
                t != this._width && (i.superSet(Ye, this, "width", t), this.isChanged = !0, this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1));
            }), a(0, o, "textWidth", function () {
                return this._isChanged && i.systemTimer.runCallLater(this, this.typeset), this._textWidth;
            }), a(0, o, "height", function () {
                return this._height ? this._height : this.textHeight;
            }, function (t) {
                t != this._height && (i.superSet(Ye, this, "height", t), this.isChanged = !0, this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1));
            }), a(0, o, "textHeight", function () {
                return this._isChanged && i.systemTimer.runCallLater(this, this.typeset), this._textHeight;
            }), a(0, o, "padding", function () {
                return this._style.padding;
            }, function (t) {
                if ("string" == typeof t) {
                    var e, i, n = 0;
                    for (i = (e = t.split(",")).length; e.length < 4;) e.push(0);
                    for (n = 0; n < i; n++) e[n] = parseFloat(e[n]) || 0;
                    t = e;
                }
                this._getTextStyle().padding = t, this.isChanged = !0;
            }), a(0, o, "bold", function () {
                return this._style.bold;
            }, function (t) {
                this._getTextStyle().bold = t, this.isChanged = !0;
            }), a(0, o, "text", function () {
                return this._text || "";
            }, function (t) {
                this._text !== t && (this.lang(t + ""), this.isChanged = !0, this.event("change"),
                    this.borderColor && this._setBorderStyleColor(0, 0, this.width, this.height, this.borderColor, 1));
            }), a(0, o, "color", function () {
                return this._color;
            }, function (t) {
                this._color != t && (this._color = t, !this._isChanged && this._graphics ? this._graphics.replaceTextColor(this.color) : this.isChanged = !0);
            }), a(0, o, "font", function () {
                return this._font;
            }, function (t) {
                this._style.currBitmapFont && (this._getTextStyle().currBitmapFont = null, this.scale(1, 1)),
                    s._bitmapFonts && s._bitmapFonts[t] && (this._getTextStyle().currBitmapFont = s._bitmapFonts[t]),
                    this._font = t, this.isChanged = !0;
            }), a(0, o, "fontSize", function () {
                return this._fontSize;
            }, function (t) {
                this._fontSize != t && (this._fontSize = t, this.isChanged = !0);
            }), a(0, o, "italic", function () {
                return this._style.italic;
            }, function (t) {
                this._getTextStyle().italic = t, this.isChanged = !0;
            }), a(0, o, "align", function () {
                return this._style.align;
            }, function (t) {
                this._getTextStyle().align = t, this.isChanged = !0;
            }), a(0, o, "valign", function () {
                return this._valign;
            }, function (t) {
                this._valign = t, this.isChanged = !0;
            }), a(0, o, "wordWrap", function () {
                return this._style.wordWrap;
            }, function (t) {
                this._getTextStyle().wordWrap = t, this.isChanged = !0;
            }), a(0, o, "singleCharRender", function () {
                return this._singleCharRender;
            }, function (t) {
                this._singleCharRender = t;
            }), a(0, o, "leading", function () {
                return this._style.leading;
            }, function (t) {
                this._getTextStyle().leading = t, this.isChanged = !0;
            }), a(0, o, "bgColor", function () {
                return this._style.bgColor;
            }, function (t) {
                this._getTextStyle().bgColor = t, this._renderType |= 128, this._setBgStyleColor(0, 0, this.width, this.height, t),
                    this._setRenderType(this._renderType), this.isChanged = !0;
            }), a(0, o, "borderColor", function () {
                return this._style.borderColor;
            }, function (t) {
                this._getTextStyle().borderColor = t, this._renderType |= 128, this._setBorderStyleColor(0, 0, this.width, this.height, t, 1),
                    this._setRenderType(this._renderType), this.isChanged = !0;
            }), a(0, o, "stroke", function () {
                return this._style.stroke;
            }, function (t) {
                this._getTextStyle().stroke = t, this.isChanged = !0;
            }), a(0, o, "strokeColor", function () {
                return this._style.strokeColor;
            }, function (t) {
                this._getTextStyle().strokeColor = t, this.isChanged = !0;
            }), a(0, o, "isChanged", null, function (t) {
                this._isChanged !== t && (this._isChanged = t, t && i.systemTimer.callLater(this, this.typeset));
            }), a(0, o, "scrollX", function () {
                return this._clipPoint ? this._clipPoint.x : 0;
            }, function (t) {
                if (!("scroll" != this.overflow || this.textWidth < this._width) && this._clipPoint) {
                    t = t < this.padding[3] ? this.padding[3] : t;
                    var e = this._textWidth - this._width;
                    t = t > e ? e : t, this._clipPoint.x = t, this._renderText();
                }
            }), a(0, o, "scrollY", function () {
                return this._clipPoint ? this._clipPoint.y : 0;
            }, function (t) {
                if (!("scroll" != this.overflow || this.textHeight < this._height) && this._clipPoint) {
                    t = t < this.padding[0] ? this.padding[0] : t;
                    var e = this._textHeight - this._height;
                    t = t > e ? e : t, this._clipPoint.y = t, this._renderText();
                }
            }), a(0, o, "maxScrollX", function () {
                return this.textWidth < this._width ? 0 : this._textWidth - this._width;
            }), a(0, o, "maxScrollY", function () {
                return this.textHeight < this._height ? 0 : this._textHeight - this._height;
            }), a(0, o, "lines", function () {
                return this._isChanged && this.typeset(), this._lines;
            }), a(0, o, "underlineColor", function () {
                return this._style.underlineColor;
            }, function (t) {
                this._getTextStyle().underlineColor = t, this._isChanged || this._renderText();
            }), a(0, o, "underline", function () {
                return this._style.underline;
            }, function (t) {
                this._getTextStyle().underline = t;
            }), s.defaultFontStr = function () {
                return s.defaultFontSize + "px " + s.defaultFont;
            }, s.registerBitmapFont = function (t, e) {
                s._bitmapFonts || (s._bitmapFonts = {}), s._bitmapFonts[t] = e;
            }, s.unregisterBitmapFont = function (t, e) {
                if (void 0 === e && (e = !0), s._bitmapFonts && s._bitmapFonts[t]) {
                    var i = s._bitmapFonts[t];
                    e && i.destroy(), delete s._bitmapFonts[t];
                }
            }, s.VISIBLE = "visible", s.SCROLL = "scroll", s.HIDDEN = "hidden", s.defaultFontSize = 12,
                s.defaultFont = "Arial", s.langPacks = null, s.isComplexText = !1, s._testWord = "游",
                s._bitmapFonts = null, s.CharacterCache = !0, s.RightToLeft = !1, n(s, ["fontFamilyMap", function () {
                    return this.fontFamilyMap = {
                        "报隶": "报隶-简",
                        "黑体": "黑体-简",
                        "楷体": "楷体-简",
                        "兰亭黑": "兰亭黑-简",
                        "隶变": "隶变-简",
                        "凌慧体": "凌慧体-简",
                        "翩翩体": "翩翩体-简",
                        "苹方": "苹方-简",
                        "手札体": "手札体-简",
                        "宋体": "宋体-简",
                        "娃娃体": "娃娃体-简",
                        "魏碑": "魏碑-简",
                        "行楷": "行楷-简",
                        "雅痞": "雅痞-简",
                        "圆体": "圆体-简"
                    };
                }]), s;
        }(Ye), ii = function (t) {
            function e() {
                this.loop = !1, this.wrapMode = 0, this._index = 0, this._count = 0, this._isPlaying = !1,
                    this._labels = null, this._isReverse = !1, this._frameRateChanged = !1, this._actionName = null,
                    this._controlNode = null, e.__super.call(this), this._interval = ae.animationInterval,
                    this._setBitUp(16);
            }
            r(e, "laya.display.AnimationBase", t);
            var i = e.prototype;
            return i.play = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = !0), void 0 === i && (i = ""), this._isPlaying = !0,
                    this._actionName = i, this.index = "string" == typeof t ? this._getFrameByLabel(t) : t,
                    this.loop = e, this._isReverse = 1 === this.wrapMode, 0 == this.index && this._isReverse && (this.index = this.count - 1),
                    this.interval > 0 && this.timerLoop(this.interval, this, this._frameLoop, null, !0, !0);
            }, i._getFrameByLabel = function (t) {
                for (var e = 0; e < this._count; e++) {
                    var i = this._labels[e];
                    if (i && i.indexOf(t) > -1) return e;
                }
                return 0;
            }, i._frameLoop = function () {
                if (this._isReverse) {
                    if (this._index--, this._index < 0) {
                        if (!this.loop) return this._index = 0, this.stop(), void this.event("complete");
                        2 == this.wrapMode ? (this._index = this._count > 0 ? 1 : 0, this._isReverse = !1) : this._index = this._count - 1,
                            this.event("complete");
                    }
                } else if (this._index++, this._index >= this._count) {
                    if (!this.loop) return this._index--, this.stop(), void this.event("complete");
                    2 == this.wrapMode ? (this._index = this._count - 2 >= 0 ? this._count - 2 : 0,
                        this._isReverse = !0) : this._index = 0, this.event("complete");
                }
                this.index = this._index;
            }, i._setControlNode = function (t) {
                this._controlNode && (this._controlNode.off("display", this, this._resumePlay),
                    this._controlNode.off("undisplay", this, this._resumePlay)), this._controlNode = t,
                    t && t != this && (t.on("display", this, this._resumePlay), t.on("undisplay", this, this._resumePlay));
            }, i._setDisplay = function (e) {
                t.prototype._setDisplay.call(this, e), this._resumePlay();
            }, i._resumePlay = function () {
                this._isPlaying && (this._controlNode.displayedInStage ? this.play(this._index, this.loop, this._actionName) : this.clearTimer(this, this._frameLoop));
            }, i.stop = function () {
                this._isPlaying = !1, this.clearTimer(this, this._frameLoop);
            }, i.addLabel = function (t, e) {
                this._labels || (this._labels = {}), this._labels[e] || (this._labels[e] = []),
                    this._labels[e].push(t);
            }, i.removeLabel = function (t) {
                if (t) {
                    if (this._labels) for (var e in this._labels) this._removeLabelFromList(this._labels[e], t);
                } else this._labels = null;
            }, i._removeLabelFromList = function (t, e) {
                if (t) for (var i = t.length - 1; i >= 0; i--) t[i] == e && t.splice(i, 1);
            }, i.gotoAndStop = function (t) {
                this.index = "string" == typeof t ? this._getFrameByLabel(t) : t, this.stop();
            }, i._displayToIndex = function (t) { }, i.clear = function () {
                return this.stop(), this._labels = null, this;
            }, a(0, i, "interval", function () {
                return this._interval;
            }, function (t) {
                this._interval != t && (this._frameRateChanged = !0, this._interval = t, this._isPlaying && t > 0 && this.timerLoop(t, this, this._frameLoop, null, !0, !0));
            }), a(0, i, "isPlaying", function () {
                return this._isPlaying;
            }), a(0, i, "index", function () {
                return this._index;
            }, function (t) {
                if (this._index = t, this._displayToIndex(t), this._labels && this._labels[t]) for (var e = this._labels[t], i = 0, n = e.length; i < n; i++) this.event("label", e[i]);
            }), a(0, i, "count", function () {
                return this._count;
            }), e.WRAP_POSITIVE = 0, e.WRAP_REVERSE = 1, e.WRAP_PINGPONG = 2, e;
        }(Ye), ni = function (t) {
            function e(t, i, n, r, a) {
                if (this._attribInfo = null, this.customCompile = !1, this._curActTexIndex = 0,
                    this.tag = {}, this._program = null, this._params = null, this._paramsMap = {},
                    e.__super.call(this), !t || !i) throw "Shader Error";
                this._attribInfo = a, this._id = ++e._count, this._vs = t, this._ps = i, this._nameMap = r || {},
                    null != n && (e.sharders[n] = this), this.recreateResource(), this.lock = !0;
            }
            r(e, "laya.webgl.shader.Shader", t);
            var i = e.prototype;
            return i.recreateResource = function () {
                this._compile(), this._setGPUMemory(0);
            }, i._disposeResource = function () {
                Ct.mainContext.deleteShader(this._vshader), Ct.mainContext.deleteShader(this._pshader),
                    Ct.mainContext.deleteProgram(this._program), this._vshader = this._pshader = this._program = null,
                    this._params = null, this._paramsMap = {}, this._setGPUMemory(0), this._curActTexIndex = 0;
            }, i._compile = function () {
                if (this._vs && this._ps && !this._params) {
                    var t;
                    this._reCompile = !0, this._params = [], this.customCompile && (t = pe.preGetParams(this._vs, this._ps));
                    var i = Ct.mainContext;
                    this._program = i.createProgram(), this._vshader = e._createShader(i, this._vs, 35633),
                        this._pshader = e._createShader(i, this._ps, 35632), i.attachShader(this._program, this._vshader),
                        i.attachShader(this._program, this._pshader);
                    var n, r, a = 0, s = this._attribInfo ? this._attribInfo.length : 0;
                    for (a = 0; a < s; a += 2) i.bindAttribLocation(this._program, this._attribInfo[a + 1], this._attribInfo[a]);
                    if (i.linkProgram(this._program), !this.customCompile && !i.getProgramParameter(this._program, 35714)) throw i.getProgramInfoLog(this._program);
                    var o = this.customCompile ? t.uniforms.length : i.getProgramParameter(this._program, 35718);
                    for (a = 0; a < o; a++) {
                        var l = this.customCompile ? t.uniforms[a] : i.getActiveUniform(this._program, a);
                        (n = {
                            vartype: "uniform",
                            glfun: null,
                            ivartype: 1,
                            location: i.getUniformLocation(this._program, l.name),
                            name: l.name,
                            type: l.type,
                            isArray: !1,
                            isSame: !1,
                            preValue: null,
                            indexOfParams: 0
                        }).name.indexOf("[0]") > 0 && (n.name = n.name.substr(0, n.name.length - 3), n.isArray = !0,
                            n.location = i.getUniformLocation(this._program, n.name)), this._params.push(n);
                    }
                    for (a = 0, r = this._params.length; a < r; a++) switch ((n = this._params[a]).indexOfParams = a,
                        n.index = 1, n.value = [n.location, null], n.codename = n.name, n.name = this._nameMap[n.codename] ? this._nameMap[n.codename] : n.codename,
                        this._paramsMap[n.name] = n, n._this = this, n.uploadedValue = [], n.type) {
                            case 5124:
                                n.fun = n.isArray ? this._uniform1iv : this._uniform1i;
                                break;

                            case 5126:
                                n.fun = n.isArray ? this._uniform1fv : this._uniform1f;
                                break;

                            case 35664:
                                n.fun = n.isArray ? this._uniform_vec2v : this._uniform_vec2;
                                break;

                            case 35665:
                                n.fun = n.isArray ? this._uniform_vec3v : this._uniform_vec3;
                                break;

                            case 35666:
                                n.fun = n.isArray ? this._uniform_vec4v : this._uniform_vec4;
                                break;

                            case 35678:
                                n.fun = this._uniform_sampler2D;
                                break;

                            case 35680:
                                n.fun = this._uniform_samplerCube;
                                break;

                            case 35676:
                                n.glfun = i.uniformMatrix4fv, n.fun = this._uniformMatrix4fv;
                                break;

                            case 35670:
                                n.fun = this._uniform1i;
                                break;

                            case 35674:
                            case 35675:
                            default:
                                throw new Error("compile shader err!");
                        }
                }
            }, i.getUniform = function (t) {
                return this._paramsMap[t];
            }, i._uniform1f = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (Ct.mainContext.uniform1f(t.location, i[0] = e), 1) : 0;
            }, i._uniform1fv = function (t, e) {
                if (e.length < 4) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform1fv(t.location, e),
                        i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0;
                }
                return Ct.mainContext.uniform1fv(t.location, e), 1;
            }, i._uniform_vec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] ? (Ct.mainContext.uniform2f(t.location, i[0] = e[0], i[1] = e[1]),
                    1) : 0;
            }, i._uniform_vec2v = function (t, e) {
                if (e.length < 2) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform2fv(t.location, e),
                        i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0;
                }
                return Ct.mainContext.uniform2fv(t.location, e), 1;
            }, i._uniform_vec3 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] ? (Ct.mainContext.uniform3f(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2]),
                    1) : 0;
            }, i._uniform_vec3v = function (t, e) {
                return Ct.mainContext.uniform3fv(t.location, e), 1;
            }, i._uniform_vec4 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform4f(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3]),
                    1) : 0;
            }, i._uniform_vec4v = function (t, e) {
                return Ct.mainContext.uniform4fv(t.location, e), 1;
            }, i._uniformMatrix2fv = function (t, e) {
                return Ct.mainContext.uniformMatrix2fv(t.location, !1, e), 1;
            }, i._uniformMatrix3fv = function (t, e) {
                return Ct.mainContext.uniformMatrix3fv(t.location, !1, e), 1;
            }, i._uniformMatrix4fv = function (t, e) {
                return Ct.mainContext.uniformMatrix4fv(t.location, !1, e), 1;
            }, i._uniform1i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (Ct.mainContext.uniform1i(t.location, i[0] = e), 1) : 0;
            }, i._uniform1iv = function (t, e) {
                return Ct.mainContext.uniform1iv(t.location, e), 1;
            }, i._uniform_ivec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] ? (Ct.mainContext.uniform2i(t.location, i[0] = e[0], i[1] = e[1]),
                    1) : 0;
            }, i._uniform_ivec2v = function (t, e) {
                return Ct.mainContext.uniform2iv(t.location, e), 1;
            }, i._uniform_vec3i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] ? (Ct.mainContext.uniform3i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2]),
                    1) : 0;
            }, i._uniform_vec3vi = function (t, e) {
                return Ct.mainContext.uniform3iv(t.location, e), 1;
            }, i._uniform_vec4i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (Ct.mainContext.uniform4i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3]),
                    1) : 0;
            }, i._uniform_vec4vi = function (t, e) {
                return Ct.mainContext.uniform4iv(t.location, e), 1;
            }, i._uniform_sampler2D = function (t, e) {
                var i = Ct.mainContext, n = t.uploadedValue;
                return null == n[0] ? (n[0] = this._curActTexIndex, i.uniform1i(t.location, this._curActTexIndex),
                    nt.activeTexture(i, 33984 + this._curActTexIndex), nt.bindTexture(i, 3553, e), this._curActTexIndex++,
                    1) : (nt.activeTexture(i, 33984 + n[0]), nt.bindTexture(i, 3553, e), 0);
            }, i._uniform_samplerCube = function (t, e) {
                var i = Ct.mainContext, n = t.uploadedValue;
                return null == n[0] ? (n[0] = this._curActTexIndex, i.uniform1i(t.location, this._curActTexIndex),
                    nt.activeTexture(i, 33984 + this._curActTexIndex), nt.bindTexture(i, 34067, e),
                    this._curActTexIndex++, 1) : (nt.activeTexture(i, 33984 + n[0]), nt.bindTexture(i, 34067, e),
                        0);
            }, i._noSetValue = function (t) {
                console.log("no....:" + t.name);
            }, i.uploadOne = function (t, e) {
                nt.useProgram(Ct.mainContext, this._program);
                var i = this._paramsMap[t];
                i.fun.call(this, i, e);
            }, i.uploadTexture2D = function (t) {
                var e = nt;
                e._activeTextures[0] !== t && (e.bindTexture(Ct.mainContext, e.TEXTURE_2D, t), e._activeTextures[0] = t);
            }, i.upload = function (t, e) {
                qe.activeShader = qe.bindShader = this;
                var i = Ct.mainContext;
                nt.useProgram(i, this._program), this._reCompile ? (e = this._params, this._reCompile = !1) : e = e || this._params;
                for (var n, r, a = e.length, s = 0, o = 0; o < a; o++) null !== (r = t[(n = e[o]).name]) && (s += n.fun.call(this, n, r));
                b.shaderCall += s;
            }, i.uploadArray = function (t, e, i) {
                qe.activeShader = this, qe.bindShader = this, nt.useProgram(Ct.mainContext, this._program);
                this._params;
                for (var n, r, a = 0, s = e - 2; s >= 0; s -= 2) (r = this._paramsMap[t[s]]) && null != (n = t[s + 1]) && (i && i[r.name] && i[r.name].bind(),
                    a += r.fun.call(this, r, n));
                b.shaderCall += a;
            }, i.getParams = function () {
                return this._params;
            }, i.setAttributesLocation = function (t) {
                this._attribInfo = t;
            }, e.getShader = function (t) {
                return e.sharders[t];
            }, e.create = function (t, i, n, r, a) {
                return new e(t, i, n, r, a);
            }, e.withCompile = function (t, i, n, r) {
                if (n && e.sharders[n]) return e.sharders[n];
                var a = e._preCompileShader[2e-4 * t];
                if (!a) throw new Error("withCompile shader err!" + t);
                return a.createShader(i, n, r, null);
            }, e.withCompile2D = function (t, i, n, r, a, s) {
                if (r && e.sharders[r]) return e.sharders[r];
                var o = e._preCompileShader[2e-4 * t + i];
                if (!o) throw new Error("withCompile shader err!" + t + " " + i);
                return o.createShader(n, r, a, s);
            }, e.addInclude = function (t, e) {
                pe.addInclude(t, e);
            }, e.preCompile = function (t, i, n, r) {
                var a = 2e-4 * t;
                e._preCompileShader[a] = new pe(i, n, r);
            }, e.preCompile2D = function (t, i, n, r, a) {
                var s = 2e-4 * t + i;
                e._preCompileShader[s] = new pe(n, r, a);
            }, e._createShader = function (t, e, i) {
                var n = t.createShader(i);
                return t.shaderSource(n, e), t.compileShader(n), t.getShaderParameter(n, 35713) ? n : (console.log(t.getShaderInfoLog(n)),
                    null);
            }, e._count = 0, e._preCompileShader = {}, e.SHADERNAME2ID = 2e-4, e.sharders = new Array(32),
                n(e, ["nameKey", function () {
                    return this.nameKey = new Vt();
                }]), e;
        }(qe), ri = (function (t) {
            function e() {
                this.url = null, this._channel = null, this._tar = null, this._playEvents = null,
                    this._stopEvents = null, e.__super.call(this), this.visible = !1, this.on("added", this, this._onParentChange),
                    this.on("removed", this, this._onParentChange);
            }
            r(e, "laya.media.SoundNode", t);
            var i = e.prototype;
            i._onParentChange = function () {
                this.target = this.parent;
            }, i.play = function (t, e) {
                void 0 === t && (t = 1), isNaN(t) && (t = 1), this.url && (this.stop(), this._channel = ve.playSound(this.url, t, e));
            }, i.stop = function () {
                this._channel && !this._channel.isStopped && this._channel.stop(), this._channel = null;
            }, i._setPlayAction = function (t, e, i, n) {
                void 0 === n && (n = !0), this[i] && t && (n ? t.on(e, this, this[i]) : t.off(e, this, this[i]));
            }, i._setPlayActions = function (t, e, i, n) {
                if (void 0 === n && (n = !0), t && e) {
                    var r, a = e.split(","), s = 0;
                    for (r = a.length, s = 0; s < r; s++) this._setPlayAction(t, a[s], i, n);
                }
            }, a(0, i, "playEvent", null, function (t) {
                this._playEvents = t, t && this._tar && this._setPlayActions(this._tar, t, "play");
            }), a(0, i, "target", null, function (t) {
                this._tar && (this._setPlayActions(this._tar, this._playEvents, "play", !1), this._setPlayActions(this._tar, this._stopEvents, "stop", !1)),
                    this._tar = t, this._tar && (this._setPlayActions(this._tar, this._playEvents, "play", !0),
                        this._setPlayActions(this._tar, this._stopEvents, "stop", !0));
            }), a(0, i, "stopEvent", null, function (t) {
                this._stopEvents = t, t && this._tar && this._setPlayActions(this._tar, t, "stop");
            });
        }(Ye), function (t) {
            function e(t, i) {
                e.__super.call(this), this._wrapModeU = 0, this._wrapModeV = 0, this._filterMode = 1,
                    this._readyed = !1, this._width = -1, this._height = -1, this._format = t, this._mipmap = i,
                    this._anisoLevel = 1, this._glTexture = Dt.instance.createTexture();
            }
            r(e, "laya.resource.BaseTexture", t);
            var i = e.prototype;
            return i._isPot = function (t) {
                return 0 == (t & t - 1);
            }, i._getGLFormat = function () {
                var t = 0;
                switch (this._format) {
                    case 0:
                        t = 6407;
                        break;

                    case 1:
                        t = 6408;
                        break;

                    case 2:
                        t = 6406;
                        break;

                    case 3:
                        if (!nt._compressedTextureS3tc) throw "BaseTexture: not support DXT1 format.";
                        t = nt._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;
                        break;

                    case 4:
                        if (!nt._compressedTextureS3tc) throw "BaseTexture: not support DXT5 format.";
                        t = nt._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;
                        break;

                    case 5:
                        if (!nt._compressedTextureEtc1) throw "BaseTexture: not support ETC1RGB format.";
                        t = nt._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;
                        break;

                    case 9:
                        if (!nt._compressedTexturePvrtc) throw "BaseTexture: not support PVRTCRGB_2BPPV format.";
                        t = nt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
                        break;

                    case 10:
                        if (!nt._compressedTexturePvrtc) throw "BaseTexture: not support PVRTCRGBA_2BPPV format.";
                        t = nt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;
                        break;

                    case 11:
                        if (!nt._compressedTexturePvrtc) throw "BaseTexture: not support PVRTCRGB_4BPPV format.";
                        t = nt._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
                        break;

                    case 12:
                        if (!nt._compressedTexturePvrtc) throw "BaseTexture: not support PVRTCRGBA_4BPPV format.";
                        t = nt._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
                        break;

                    default:
                        throw "BaseTexture: unknown texture format.";
                }
                return t;
            }, i._setFilterMode = function (t) {
                var e = Dt.instance;
                switch (nt.bindTexture(e, this._glTextureType, this._glTexture), t) {
                    case 0:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9984) : e.texParameteri(this._glTextureType, 10241, 9728),
                            e.texParameteri(this._glTextureType, 10240, 9728);
                        break;

                    case 1:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9985) : e.texParameteri(this._glTextureType, 10241, 9729),
                            e.texParameteri(this._glTextureType, 10240, 9729);
                        break;

                    case 2:
                        this._mipmap ? e.texParameteri(this._glTextureType, 10241, 9987) : e.texParameteri(this._glTextureType, 10241, 9729),
                            e.texParameteri(this._glTextureType, 10240, 9729);
                        break;

                    default:
                        throw new Error("BaseTexture:unknown filterMode value.");
                }
            }, i._setWarpMode = function (t, e) {
                var i = Dt.instance;
                if (nt.bindTexture(i, this._glTextureType, this._glTexture), this._isPot(this._width) && this._isPot(this._height)) switch (e) {
                    case 0:
                        i.texParameteri(this._glTextureType, t, 10497);
                        break;

                    case 1:
                        i.texParameteri(this._glTextureType, t, 33071);
                } else i.texParameteri(this._glTextureType, t, 33071);
            }, i._setAnisotropy = function (t) {
                var e = nt._extTextureFilterAnisotropic;
                if (e && !Ot.onLimixiu) {
                    t = Math.max(t, 1);
                    var i = Dt.instance;
                    nt.bindTexture(i, this._glTextureType, this._glTexture), t = Math.min(i.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT), t),
                        i.texParameterf(this._glTextureType, e.TEXTURE_MAX_ANISOTROPY_EXT, t);
                }
            }, i._disposeResource = function () {
                this._glTexture && (Dt.instance.deleteTexture(this._glTexture), this._glTexture = null,
                    this._setGPUMemory(0));
            }, i._getSource = function () {
                return this._readyed ? this._glTexture : null;
            }, i.generateMipmap = function () {
                this._isPot(this.width) && this._isPot(this.height) && Dt.instance.generateMipmap(this._glTextureType);
            }, a(0, i, "wrapModeU", function () {
                return this._wrapModeU;
            }, function (t) {
                this._wrapModeU !== t && (this._wrapModeU = t, -1 !== this._width && this._setWarpMode(10242, t));
            }), a(0, i, "mipmap", function () {
                return this._mipmap;
            }), a(0, i, "format", function () {
                return this._format;
            }), a(0, i, "wrapModeV", function () {
                return this._wrapModeV;
            }, function (t) {
                this._wrapModeV !== t && (this._wrapModeV = t, -1 !== this._height && this._setWarpMode(10243, t));
            }), a(0, i, "defaulteTexture", function () {
                throw "BaseTexture:must override it.";
            }), a(0, i, "filterMode", function () {
                return this._filterMode;
            }, function (t) {
                t !== this._filterMode && (this._filterMode = t, -1 !== this._width && -1 !== this._height && this._setFilterMode(t));
            }), a(0, i, "anisoLevel", function () {
                return this._anisoLevel;
            }, function (t) {
                t !== this._anisoLevel && (this._anisoLevel = Math.max(1, Math.min(16, t)), -1 !== this._width && -1 !== this._height && this._setAnisotropy(t));
            }), e.WARPMODE_REPEAT = 0, e.WARPMODE_CLAMP = 1, e.FILTERMODE_POINT = 0, e.FILTERMODE_BILINEAR = 1,
                e.FILTERMODE_TRILINEAR = 2, e.FORMAT_R8G8B8 = 0, e.FORMAT_R8G8B8A8 = 1, e.FORMAT_ALPHA8 = 2,
                e.FORMAT_DXT1 = 3, e.FORMAT_DXT5 = 4, e.FORMAT_ETC1RGB = 5, e.FORMAT_PVRTCRGB_2BPPV = 9,
                e.FORMAT_PVRTCRGBA_2BPPV = 10, e.FORMAT_PVRTCRGB_4BPPV = 11, e.FORMAT_PVRTCRGBA_4BPPV = 12,
                e.FORMAT_DEPTH_16 = 0, e.FORMAT_STENCIL_8 = 1, e.FORMAT_DEPTHSTENCIL_16_8 = 2, e.FORMAT_DEPTHSTENCIL_NONE = 3,
                e;
        }(Ke)), ai = function (t) {
            function e(t) {
                e.__super.call(this), void 0 === t && (t = !1), this._source = t ? Ot.createElement("canvas") : this,
                    this.lock = !0;
            }
            r(e, "laya.resource.HTMLCanvas", t);
            var i = e.prototype;
            return i._getSource = function () {
                return this._source;
            }, i.clear = function () {
                this._ctx && this._ctx.clear && this._ctx.clear(), this._texture && (this._texture.destroy(),
                    this._texture = null);
            }, i.destroy = function () {
                laya.resource.Resource.prototype.destroy.call(this), this._setCPUMemory(0), this._ctx && this._ctx.destroy(),
                    this._ctx = null;
            }, i.release = function () { }, i._setContext = function (t) {
                this._ctx = t;
            }, i.getContext = function (t, e) {
                return this.context;
            }, i.getMemSize = function () {
                return 0;
            }, i.size = function (t, e) {
                (this._width != t || this._height != e || this._source && (this._source.width != t || this._source.height != e)) && (this._width = t,
                    this._height = e, this._setCPUMemory(t * e * 4), this._ctx && this._ctx.size && this._ctx.size(t, e),
                    this._source && (this._source.height = e, this._source.width = t), this._texture && (this._texture.destroy(),
                        this._texture = null));
            }, i.getTexture = function () {
                if (!this._texture) {
                    var t = new di();
                    t.loadImageSource(this.source), this._texture = new Me(t);
                }
                return this._texture;
            }, i.toBase64 = function (t, e) {
                if (this._source) {
                    if (At.isConchApp) {
                        if (2 == conchConfig.threadMode) throw "native 2 thread mode use toBase64Async";
                        var i = this._ctx._targets.sourceWidth, n = this._ctx._targets.sourceHeight, r = this._ctx._targets.getData(0, 0, i, n);
                        return conchToBase64FlipY ? conchToBase64FlipY(t, e, r.buffer, i, n) : conchToBase64(t, e, r.buffer, i, n);
                    }
                    return this._source.toDataURL(t, e);
                }
                return null;
            }, i.toBase64Async = function (t, e, i) {
                var n = this._ctx._targets.sourceWidth, r = this._ctx._targets.sourceHeight;
                this._ctx._targets.getDataAsync(0, 0, n, r, function (a) {
                    var s = conchToBase64FlipY ? conchToBase64FlipY(t, e, a.buffer, n, r) : conchToBase64(t, e, a.buffer, n, r);
                    i(s);
                });
            }, a(0, i, "source", function () {
                return this._source;
            }), a(0, i, "context", function () {
                return this._ctx || (this._source == this ? this._ctx = new ut() : this._ctx = this._source.getContext(At.isConchApp ? "layagl" : "2d"),
                    this._ctx._canvas = this), this._ctx;
            }), e;
        }(Ke), si = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.resource.HTMLImage", t), e.create = function (t, e, i) {
                var n = new di(t, e, i, !1, !1);
                return n.wrapModeU = 1, n.wrapModeV = 1, n;
            };
        }(Ke), function (e) {
            function s() {
                this.focus = null, this._frameRate = "fast", this.designWidth = 0, this.designHeight = 0,
                    this.canvasRotation = !1, this.canvasDegree = 0, this.renderingEnabled = !0, this.screenAdaptationEnabled = !0,
                    this._screenMode = "none", this._scaleMode = "showall", this._alignV = "middle", this._alignH = "center",
                    this._bgColor = "black", this._mouseMoveTime = 0, this._renderCount = 0, this._safariOffsetY = 0,
                    this._frameStartTime = 0, this._isFocused = !1, this._isVisibility = !1, this._wgColor = [0, 0, 0, 1],
                    this._scene3Ds = [], this._globalRepaintSet = !1, this._globalRepaintGet = !1, this._curUIBase = null,
                    this.useRetinalCanvas = !0, s.__super.call(this), this.offset = new jt(), this._canvasTransform = new at(),
                    this._previousOrientation = Ot.window.orientation, this._3dUI = [];
                var t = this;
                this.transform = this._createTransform(), this.mouseEnabled = !0, this.hitTestPrior = !0,
                    this.autoSize = !1, this._setBit(128, !0), this._setBit(2, !0), this._isFocused = !0,
                    this._isVisibility = !0, this.useRetinalCanvas = ae.useRetinalCanvas;
                var e = Ot.window, i = this;
                e.addEventListener("focus", function () {
                    t._isFocused = !0, i.event("focus"), i.event("focuschange");
                }), e.addEventListener("blur", function () {
                    t._isFocused = !1, i.event("blur"), i.event("focuschange"), i._isInputting() && (hi.inputElement.target.focus = !1);
                });
                var n = "visibilityState", r = "visibilitychange", a = e.document;
                void 0 !== a.hidden ? (r = "visibilitychange", n = "visibilityState") : void 0 !== a.mozHidden ? (r = "mozvisibilitychange",
                    n = "mozVisibilityState") : void 0 !== a.msHidden ? (r = "msvisibilitychange", n = "msVisibilityState") : void 0 !== a.webkitHidden && (r = "webkitvisibilitychange",
                        n = "webkitVisibilityState"), e.document.addEventListener(r, function () {
                            "hidden" == Ot.document[n] ? (t._isVisibility = !1, i._isInputting() && (hi.inputElement.target.focus = !1)) : t._isVisibility = !0;
                            t.renderingEnabled = t._isVisibility, i.event("visibilitychange");
                        }), e.addEventListener("resize", function () {
                            var e = Ot.window.orientation;
                            null != e && e != t._previousOrientation && i._isInputting() && (hi.inputElement.target.focus = !1),
                                t._previousOrientation = e, i._isInputting() || (Ot.onSafari && (i._safariOffsetY = (Ot.window.__innerHeight || Ot.document.body.clientHeight || Ot.document.documentElement.clientHeight) - Ot.window.innerHeight),
                                    i._resetCanvas());
                        }), e.addEventListener("orientationchange", function (t) {
                            i._resetCanvas();
                        }), this.on("mousemove", this, this._onmouseMove), Ot.onMobile && this.on("mousedown", this, this._onmouseMove);
            }
            r(s, "laya.display.Stage", e);
            var l = s.prototype;
            return l._isInputting = function () {
                return Ot.onMobile && hi.isInputting;
            }, l._changeCanvasSize = function () {
                this.setScreenSize(Ot.clientWidth * Ot.pixelRatio, Ot.clientHeight * Ot.pixelRatio);
            }, l._resetCanvas = function () {
                this.screenAdaptationEnabled && this._changeCanvasSize();
            }, l.setScreenSize = function (t, e) {
                var i = !1;
                if ("none" !== this._screenMode && (i = (t / e < 1 ? "vertical" : "horizontal") !== this._screenMode)) {
                    var n = e;
                    e = t, t = n;
                }
                this.canvasRotation = i;
                var r = At._mainCanvas, a = r.source.style, s = this._canvasTransform.identity(), o = this._scaleMode, l = t / this.designWidth, h = e / this.designHeight, u = this.useRetinalCanvas ? t : this.designWidth, c = this.useRetinalCanvas ? e : this.designHeight, d = t, _ = e, f = Ot.pixelRatio;
                switch (this._width = this.designWidth, this._height = this.designHeight, o) {
                    case "noscale":
                        l = h = 1, d = this.designWidth, _ = this.designHeight;
                        break;

                    case "showall":
                        l = h = Math.min(l, h),
                            u = d = Math.round(this.designWidth * l),
                            c = _ = Math.round(this.designHeight * h);
                        break;

                    case "noborder":
                        l = h = Math.max(l, h), d = Math.round(this.designWidth * l), _ = Math.round(this.designHeight * h);
                        break;

                    case "full":
                        l = h = 1, this._width = u = t, this._height = c = e;
                        break;

                    case "fixedwidth":
                        h = l, this._height = c = Math.round(e / l);
                        break;

                    case "fixedheight":
                        l = h, this._width = u = Math.round(t / h);
                        break;

                    case "fixedauto":
                        t / e < this.designWidth / this.designHeight ? (h = l, this._height = c = Math.round(e / l)) : (l = h,
                            this._width = u = Math.round(t / h));
                }
                this.useRetinalCanvas && (u = t, c = e), l *= this.scaleX, h *= this.scaleY, 1 === l && 1 === h ? this.transform.identity() : (this.transform.a = this._formatData(l / (d / u)),
                    this.transform.d = this._formatData(h / (_ / c))), r.size(u, c), ue.changeWebGLSize(u, c),
                    s.scale(d / u / f, _ / c / f), "left" === this._alignH ? this.offset.x = 0 : "right" === this._alignH ? this.offset.x = t - d : this.offset.x = .5 * (t - d) / f,
                    "top" === this._alignV ? this.offset.y = 0 : "bottom" === this._alignV ? this.offset.y = e - _ : this.offset.y = .5 * (e - _) / f,
                    this.offset.x = Math.round(this.offset.x), this.offset.y = Math.round(this.offset.y),
                    s.translate(this.offset.x, this.offset.y), this._safariOffsetY && s.translate(0, this._safariOffsetY),
                    this.canvasDegree = 0, i && ("horizontal" === this._screenMode ? (s.rotate(Math.PI / 2),
                        s.translate(e / f, 0), this.canvasDegree = 90) : (s.rotate(-Math.PI / 2), s.translate(0, t / f),
                            this.canvasDegree = -90)), s.a = this._formatData(s.a), s.d = this._formatData(s.d),
                    s.tx = this._formatData(s.tx), s.ty = this._formatData(s.ty), this.transform = this.transform,
                    a.transformOrigin = a.webkitTransformOrigin = a.msTransformOrigin = a.mozTransformOrigin = a.oTransformOrigin = "0px 0px 0px",
                    a.transform = a.webkitTransform = a.msTransform = a.mozTransform = a.oTransform = "matrix(" + s.toString() + ")",
                    this._safariOffsetY && s.translate(0, -this._safariOffsetY), s.translate(parseInt(a.left) || 0, parseInt(a.top) || 0),
                    this.visible = !0, this._repaint |= 2, this.event("resize");
            }, l._formatData = function (t) {
                return Math.abs(t) < 1e-6 ? 0 : Math.abs(1 - t) < .001 ? t > 0 ? 1 : -1 : t;
            }, l.getMousePoint = function () {
                return jt.TEMP.setTo(this.mouseX, this.mouseY);
            }, l.repaint = function (t) {
                void 0 === t && (t = 2), this._repaint |= t;
            }, l.parentRepaint = function (t) {
                void 0 === t && (t = 2);
            }, l._loop = function () {
                return this._globalRepaintGet = this._globalRepaintSet, this._globalRepaintSet = !1,
                    this.render(At._context, 0, 0), !0;
            }, l.getFrameTm = function () {
                return this._frameStartTime;
            }, l._onmouseMove = function (t) {
                this._mouseMoveTime = Ot.now();
            }, l.getTimeFromFrameStart = function () {
                return Ot.now() - this._frameStartTime;
            }, l.render = function (t, i, n) {
                if (s._dbgSprite.graphics.clear(), "sleep" === this._frameRate) {
                    var r = Ot.now();
                    if (!(r - this._frameStartTime >= 1e3)) return;
                    this._frameStartTime = r;
                } else {
                    if (!this._visible) return this._renderCount++, void (this._renderCount % 5 == 0 && (Kt.I._update(),
                        b.loopCount++, this._updateTimers()));
                    this._frameStartTime = Ot.now();
                }
                this._renderCount++;
                var a = "slow" !== ("mouse" === this._frameRate ? this._frameStartTime - this._mouseMoveTime < 2e3 ? "fast" : "slow" : this._frameRate), o = this._renderCount % 2 == 0;
                if (b.renderSlow = !a, (a || o) && (Kt.I._update(), b.loopCount++, this.renderingEnabled)) {
                    for (var l = 0, h = this._scene3Ds.length; l < h; l++) this._scene3Ds[l]._update();
                    t.clear(), e.prototype.render.call(this, t, i, n), b._show && b._sp && b._sp.render(t, i, n);
                }
                s._dbgSprite.render(t, 0, 0), !a && o || (this.renderingEnabled && (ue.clear(this._bgColor),
                    t.flush(), A.instance && A.getInstance().endDispose()), this._updateTimers());
            }, l.renderToNative = function (t, i, n) {
                if (this._renderCount++, this._visible) {
                    if (Kt.I._update(), b.loopCount++, this.renderingEnabled) {
                        for (var r = 0, a = this._scene3Ds.length; r < a; r++) this._scene3Ds[r]._update();
                        t.clear(), e.prototype.render.call(this, t, i, n), b._show && b._sp && b._sp.render(t, i, n);
                    }
                    this.renderingEnabled && (ue.clear(this._bgColor), t.flush(), A.instance && A.getInstance().endDispose()),
                        this._updateTimers();
                } else this._renderCount % 5 == 0 && (Kt.I._update(), b.loopCount++, this._updateTimers());
            }, l._updateTimers = function () {
                i.systemTimer._update(), i.startTimer._update(), i.physicsTimer._update(), i.updateTimer._update(),
                    i.lateTimer._update(), i.timer._update();
            }, l._requestFullscreen = function () {
                var t = Ot.document.documentElement;
                t.requestFullscreen ? t.requestFullscreen() : t.mozRequestFullScreen ? t.mozRequestFullScreen() : t.webkitRequestFullscreen ? t.webkitRequestFullscreen() : t.msRequestFullscreen && t.msRequestFullscreen();
            }, l._fullScreenChanged = function () {
                i.stage.event("fullscreenchange");
            }, l.exitFullscreen = function () {
                var t = Ot.document;
                t.exitFullscreen ? t.exitFullscreen() : t.mozCancelFullScreen ? t.mozCancelFullScreen() : t.webkitExitFullscreen && t.webkitExitFullscreen();
            }, l.isGlobalRepaint = function () {
                return this._globalRepaintGet;
            }, l.setGlobalRepaint = function () {
                this._globalRepaintSet = !0;
            }, l.add3DUI = function (t) {
                var e = t.rootView;
                this._3dUI.indexOf(e) >= 0 || this._3dUI.push(e);
            }, l.remove3DUI = function (t) {
                var e = t.rootView, i = this._3dUI.indexOf(e);
                return i >= 0 && (this._3dUI.splice(i, 1), !0);
            }, a(0, l, "clientScaleY", function () {
                return this._transform ? this._transform.getScaleY() : 1;
            }), a(0, l, "width", e.prototype._$get_width, function (t) {
                this.designWidth = t, i.superSet(Ye, this, "width", t), i.systemTimer.callLater(this, this._changeCanvasSize);
            }), a(0, l, "isFocused", function () {
                return this._isFocused;
            }), a(0, l, "alignH", function () {
                return this._alignH;
            }, function (t) {
                this._alignH = t, i.systemTimer.callLater(this, this._changeCanvasSize);
            }), a(0, l, "height", e.prototype._$get_height, function (t) {
                this.designHeight = t, i.superSet(Ye, this, "height", t), i.systemTimer.callLater(this, this._changeCanvasSize);
            }), a(0, l, "transform", function () {
                return this._tfChanged && this._adjustTransform(), this._transform = this._transform || this._createTransform();
            }, e.prototype._$set_transform), a(0, l, "isVisibility", function () {
                return this._isVisibility;
            }), a(0, l, "scaleMode", function () {
                return this._scaleMode;
            }, function (t) {
                this._scaleMode = t, i.systemTimer.callLater(this, this._changeCanvasSize);
            }), a(0, l, "alignV", function () {
                return this._alignV;
            }, function (t) {
                this._alignV = t, i.systemTimer.callLater(this, this._changeCanvasSize);
            }), a(0, l, "bgColor", function () {
                return this._bgColor;
            }, function (t) {
                this._bgColor = t, this._wgColor = t ? o.create(t).arrColor : null, Ot.onLimixiu ? this._wgColor = o.create(t).arrColor : At.canvas.style.background = t || "none";
            }), a(0, l, "mouseX", function () {
                return Math.round(w.instance.mouseX / this.clientScaleX);
            }), a(0, l, "mouseY", function () {
                return Math.round(w.instance.mouseY / this.clientScaleY);
            }), a(0, l, "clientScaleX", function () {
                return this._transform ? this._transform.getScaleX() : 1;
            }), a(0, l, "screenMode", function () {
                return this._screenMode;
            }, function (t) {
                this._screenMode = t;
            }), a(0, l, "visible", e.prototype._$get_visible, function (t) {
                this.visible !== t && (i.superSet(Ye, this, "visible", t), At._mainCanvas.source.style.visibility = t ? "visible" : "hidden");
            }), a(0, l, "fullScreenEnabled", null, function (t) {
                var e = Ot.document, i = At.canvas;
                t ? (i.addEventListener("mousedown", this._requestFullscreen), i.addEventListener("touchstart", this._requestFullscreen),
                    e.addEventListener("fullscreenchange", this._fullScreenChanged), e.addEventListener("mozfullscreenchange", this._fullScreenChanged),
                    e.addEventListener("webkitfullscreenchange", this._fullScreenChanged), e.addEventListener("msfullscreenchange", this._fullScreenChanged)) : (i.removeEventListener("mousedown", this._requestFullscreen),
                        i.removeEventListener("touchstart", this._requestFullscreen), e.removeEventListener("fullscreenchange", this._fullScreenChanged),
                        e.removeEventListener("mozfullscreenchange", this._fullScreenChanged), e.removeEventListener("webkitfullscreenchange", this._fullScreenChanged),
                        e.removeEventListener("msfullscreenchange", this._fullScreenChanged));
            }), a(0, l, "frameRate", function () {
                return At.isConchApp ? this._frameRateNative : this._frameRate;
            }, function (e) {
                if (At.isConchApp) {
                    switch (e) {
                        case "fast":
                            t.conch.config.setLimitFPS(60);
                            break;

                        case "mouse":
                            t.conch.config.setMouseFrame(2e3);
                            break;

                        case "slow":
                            t.conch.config.setSlowFrame(!0);
                            break;

                        case "sleep":
                            t.conch.config.setLimitFPS(1);
                    }
                    this._frameRateNative = e;
                } else this._frameRate = e;
            }), s.SCALE_NOSCALE = "noscale", s.SCALE_EXACTFIT = "exactfit", s.SCALE_SHOWALL = "showall",
                s.SCALE_NOBORDER = "noborder", s.SCALE_FULL = "full", s.SCALE_FIXED_WIDTH = "fixedwidth",
                s.SCALE_FIXED_HEIGHT = "fixedheight", s.SCALE_FIXED_AUTO = "fixedauto", s.ALIGN_LEFT = "left",
                s.ALIGN_RIGHT = "right", s.ALIGN_CENTER = "center", s.ALIGN_TOP = "top", s.ALIGN_MIDDLE = "middle",
                s.ALIGN_BOTTOM = "bottom", s.SCREEN_NONE = "none", s.SCREEN_HORIZONTAL = "horizontal",
                s.SCREEN_VERTICAL = "vertical", s.FRAME_FAST = "fast", s.FRAME_SLOW = "slow", s.FRAME_MOUSE = "mouse",
                s.FRAME_SLEEP = "sleep", n(s, ["_dbgSprite", function () {
                    return this._dbgSprite = new Ye();
                }]), s;
        }(Ye)), oi = function (t) {
            function e() {
                this.datas = [], this.hud_width = 800, this.hud_height = 200, this.gMinV = 0, this.gMaxV = 100,
                    this.textSpace = 40, this._now = null, this.sttm = 0, e.__super.call(this), this.xdata = new Array(e.DATANUM),
                    this.ydata = new Array(e.DATANUM), e.inst = this, this._renderType |= 2048, this._setRenderType(this._renderType),
                    this._setCustomRender(), this.addDataDef(0, 16777215, "frame", 1), this.addDataDef(1, 65280, "update", 1),
                    this.addDataDef(2, 16711680, "flush", 1), this._now = performance ? performance.now.bind(performance) : Date.now;
            }
            r(e, "laya.utils.PerfHUD", t);
            var i = e.prototype;
            return i.now = function () {
                return this._now();
            }, i.start = function () {
                this.sttm = this._now();
            }, i.end = function (t) {
                var e = this._now() - this.sttm;
                this.updateValue(t, e);
            }, i.config = function (t, e) {
                this.hud_width = t, this.hud_height = e;
            }, i.addDataDef = function (t, e, i, n) {
                this.datas[t] = new st(t, e, i, n);
            }, i.updateValue = function (t, e) {
                this.datas[t].addData(e);
            }, i.v2y = function (t) {
                this._y, this.hud_height, this.gMinV, this.gMaxV;
                return this._y + this.hud_height * (1 - (t - this.gMinV) / this.gMaxV);
            }, i.drawHLine = function (t, e, i, n) {
                var r = this._x, a = (this._x, this.hud_width, this.v2y(e));
                t.fillText(n, r, a - 6, null, "green", null), r += this.textSpace, t.fillStyle = i,
                    t.fillRect(r, a, this._x + this.hud_width, 1, null);
            }, i.customRender = function (t, i, n) {
                var r = performance.now();
                e._lastTm <= 0 && (e._lastTm = r), this.updateValue(0, r - e._lastTm), e._lastTm = r,
                    t.save(), t.fillRect(this._x, this._y, this.hud_width, this.hud_height + 4, "#000000cc"),
                    t.globalAlpha = .9, this.drawHLine(t, 0, "green", "    0"), this.drawHLine(t, 10, "green", "  10"),
                    this.drawHLine(t, 16.667, "red", " "), this.drawHLine(t, 20, "green", "50|20"),
                    this.drawHLine(t, 33.334, "yellow", ""), this.drawHLine(t, 16.667 * 3, "yellow", ""),
                    this.drawHLine(t, 66.668, "yellow", ""), this.drawHLine(t, 50, "green", "20|50"),
                    this.drawHLine(t, 100, "green", "10|100");
                for (var a = 0, s = this.datas.length; a < s; a++) {
                    var o = this.datas[a];
                    if (o) {
                        var l = o.datas.length, h = (this.hud_width - this.textSpace) / l, u = o.datapos, c = this._x + this.textSpace;
                        t.fillStyle = o.color;
                        for (var d = l; u < d; u++) {
                            var _ = this.v2y(o.datas[u] * o.scale);
                            t.fillRect(c, _, h, this.hud_height + this._y - _, null), c += h;
                        }
                        for (u = 0; u < o.datapos; u++) _ = this.v2y(o.datas[u] * o.scale), t.fillRect(c, _, h, this.hud_height + this._y - _, null),
                            c += h;
                    }
                }
                t.restore();
            }, e._lastTm = 0, e._now = 0, e.DATANUM = 300, e.inst = null, e.drawTexTm = 0, e;
        }(Ye), li = function (t) {
            function e() {
                this.autoDestroyAtClosed = !1, this.url = null, this._timer = null, this._viewCreated = !1,
                    this._idMap = null, this._$componentType = "Scene", e.__super.call(this), this._setBit(8, !0),
                    e.unDestroyedScenes.push(this), this._scene = this, this.createChildren();
            }
            r(e, "laya.display.Scene", t);
            var n = e.prototype;
            return n.createChildren = function () { }, n.loadScene = function (t) {
                var e = t.indexOf(".") > -1 ? t : t + ".scene", n = i.loader.getRes(e);
                if (n) this.createView(n); else {
                    i.loader.resetProgress();
                    var r = new Ve();
                    r.on("complete", this, this._onSceneLoaded, [e]), r.load(e);
                }
            }, n._onSceneLoaded = function (t) {
                this.createView(Oe.getRes(t));
            }, n.createView = function (t) {
                t && !this._viewCreated && (this._viewCreated = !0, pt.createByData(this, t));
            }, n.getNodeByID = function (t) {
                return this._idMap ? this._idMap[t] : null;
            }, n.open = function (t, i) {
                void 0 === t && (t = !0), t && e.closeAll(), e.root.addChild(this), this.onOpened(i);
            }, n.onOpened = function (t) { }, n.close = function (t) {
                this.onClosed(t), this.autoDestroyAtClosed ? this.destroy() : this.removeSelf();
            }, n.onClosed = function (t) { }, n.destroy = function (e) {
                void 0 === e && (e = !0), this._idMap = null, t.prototype.destroy.call(this, e);
                for (var i = laya.display.Scene.unDestroyedScenes, n = i.length - 1; n > -1; n--) if (i[n] === this) return void i.splice(n, 1);
            }, n._sizeChanged = function () {
                this.event("resize");
            }, a(0, n, "scaleX", t.prototype._$get_scaleX, function (t) {
                i.superGet(Ye, this, "scaleX") != t && (i.superSet(Ye, this, "scaleX", t), this.event("resize"));
            }), a(0, n, "scaleY", t.prototype._$get_scaleY, function (t) {
                i.superGet(Ye, this, "scaleY") != t && (i.superSet(Ye, this, "scaleY", t), this.event("resize"));
            }), a(0, n, "width", function () {
                if (this._width) return this._width;
                for (var t = 0, e = this.numChildren - 1; e > -1; e--) {
                    var i = this.getChildAt(e);
                    i._visible && (t = Math.max(i._x + i.width * i.scaleX, t));
                }
                return t;
            }, function (t) {
                i.superGet(Ye, this, "width") != t && (i.superSet(Ye, this, "width", t), this.callLater(this._sizeChanged));
            }), a(0, n, "timer", function () {
                return this._timer || i.timer;
            }, function (t) {
                this._timer = t;
            }), a(0, n, "height", function () {
                if (this._height) return this._height;
                for (var t = 0, e = this.numChildren - 1; e > -1; e--) {
                    var i = this.getChildAt(e);
                    i._visible && (t = Math.max(i._y + i.height * i.scaleY, t));
                }
                return t;
            }, function (t) {
                i.superGet(Ye, this, "height") != t && (i.superSet(Ye, this, "height", t), this.callLater(this._sizeChanged));
            }), a(1, e, "root", function () {
                if (!e._root) {
                    function t() {
                        e._root.size(i.stage.width, i.stage.height), e._root.event("resize");
                    }
                    e._root = i.stage.addChild(new Ye()), e._root.name = "root", i.stage.on("resize", null, t),
                        t();
                }
                return e._root;
            }, laya.display.Sprite._$SET_root), e.load = function (t, n, r) {
                i.loader.resetProgress();
                var a = new Ve();
                function s(t) {
                    e._loadPage && e._loadPage.event("progress", t), r && r.runWith(t);
                }
                a.on("progress", null, s), a.once("complete", null, function () {
                    a.off("progress", null, s);
                    var i = Oe.getRes(t);
                    if (!i) throw "Can not find scene:" + t;
                    if (!i.props) throw "Scene data is error:" + t;
                    var r = i.props.runtime ? i.props.runtime : i.type, o = Rt.getClass(r);
                    if ("instance" == i.props.renderType) var l = o.instance || (o.instance = new o()); else l = new o();
                    if (!(l && l instanceof laya.display.Node)) throw "Can not find scene:" + r;
                    l.url = t, l._getBit(8) ? (l.on("onViewCreated", null, function () {
                        n && n.runWith(l);
                    }), l.createView(i)) : n && n.runWith(l), e.hideLoadingPage();
                }), a.load(t);
            }, e.open = function (t, i, n, r, a) {
                if (void 0 === i && (i = !0), n instanceof laya.utils.Handler) {
                    var s = r;
                    r = n, n = s;
                }
                e.showLoadingPage(), e.load(t, g.create(null, this._onSceneLoaded, [i, r, n]), a);
            }, e._onSceneLoaded = function (t, e, i, n) {
                n.open(t, i), e && e.runWith(n);
            }, e.close = function (t, e) {
                void 0 === e && (e = "");
                for (var i = !1, n = laya.display.Scene.unDestroyedScenes, r = 0, a = n.length; r < a; r++) {
                    var s = n[r];
                    s && s.parent && s.url === t && s.name == e && (s.close(), i = !0);
                }
                return i;
            }, e.closeAll = function () {
                for (var t = laya.display.Scene.root, e = 0, i = t.numChildren; e < i; e++) {
                    var n = t.getChildAt(0);
                    n instanceof laya.display.Scene ? n.close() : n.removeSelf();
                }
            }, e.destroy = function (t, e) {
                void 0 === e && (e = "");
                for (var i = !1, n = laya.display.Scene.unDestroyedScenes, r = 0, a = n.length; r < a; r++) {
                    var s = n[r];
                    s.url === t && s.name == e && (s.destroy(), i = !0);
                }
                return i;
            }, e.gc = function () {
                Ie.destroyUnusedResources();
            }, e.setLoadingPage = function (t) {
                e._loadPage != t && (e._loadPage = t);
            }, e.showLoadingPage = function (t, n) {
                void 0 === n && (n = 500), e._loadPage && (i.systemTimer.clear(null, e._showLoading),
                    i.systemTimer.clear(null, e._hideLoading), i.systemTimer.once(n, null, e._showLoading, [t], !1));
            }, e._showLoading = function (t) {
                i.stage.addChild(e._loadPage), e._loadPage.onOpened(t);
            }, e._hideLoading = function () {
                e._loadPage.close();
            }, e.hideLoadingPage = function (t) {
                void 0 === t && (t = 500), e._loadPage && (i.systemTimer.clear(null, e._showLoading),
                    i.systemTimer.clear(null, e._hideLoading), i.systemTimer.once(t, null, e._hideLoading));
            }, e.unDestroyedScenes = [], e._root = null, e._loadPage = null, e;
        }(Ye), hi = function (t) {
            function e() {
                this._focus = !1, this._multiline = !1, this._editable = !0, this._restrictPattern = null,
                    this._type = "text", this._prompt = "", this._promptColor = "#A9A9A9", this._originColor = "#000000",
                    this._content = "", e.__super.call(this), this._maxChars = 1e5, this._width = 100,
                    this._height = 20, this.multiline = !1, this.overflow = "scroll", this.on("mousedown", this, this._onMouseDown),
                    this.on("undisplay", this, this._onUnDisplay);
            }
            r(e, "laya.display.Input", t);
            var s = e.prototype;
            return s.setSelection = function (t, e) {
                this.focus = !0, laya.display.Input.inputElement.selectionStart = t, laya.display.Input.inputElement.selectionEnd = e;
            }, s._onUnDisplay = function (t) {
                this.focus = !1;
            }, s._onMouseDown = function (t) {
                this.focus = !0;
            }, s._syncInputTransform = function () {
                var t = this.nativeInput, n = ie.getTransformRelativeToWindow(this, this.padding[3], this.padding[0]), r = this._width - this.padding[1] - this.padding[3], a = this._height - this.padding[0] - this.padding[2];
                At.isConchApp ? (t.setScale(n.scaleX, n.scaleY), t.setSize(r, a), t.setPos(n.x, n.y)) : (e.inputContainer.style.transform = e.inputContainer.style.webkitTransform = "scale(" + n.scaleX + "," + n.scaleY + ") rotate(" + i.stage.canvasDegree + "deg)",
                    t.style.width = r + "px", t.style.height = a + "px", e.inputContainer.style.left = n.x + "px",
                    e.inputContainer.style.top = n.y + "px");
            }, s.select = function () {
                this.nativeInput.select();
            }, s._setInputMethod = function () {
                e.input.parentElement && e.inputContainer.removeChild(e.input), e.area.parentElement && e.inputContainer.removeChild(e.area),
                    e.inputElement = this._multiline ? e.area : e.input, e.inputContainer.appendChild(e.inputElement),
                    ei.RightToLeft && (e.inputElement.style.direction = "rtl");
            }, s._focusIn = function () {
                laya.display.Input.isInputting = !0;
                var t = this.nativeInput;
                this._focus = !0;
                var e = t.style;
                e.whiteSpace = this.wordWrap ? "pre-wrap" : "nowrap", this._setPromptColor(), t.readOnly = !this._editable,
                    At.isConchApp && (t.setType(this._type), t.setForbidEdit(!this._editable)), t.maxLength = this._maxChars;
                this.padding;
                if (t.type = this._type, t.value = this._content, t.placeholder = this._prompt,
                    i.stage.off("keydown", this, this._onKeyDown), i.stage.on("keydown", this, this._onKeyDown),
                    i.stage.focus = this, this.event("focus"), Ot.onPC && t.focus(), !(Ot.onMiniGame || Ot.onBDMiniGame || Ot.onQGMiniGame || Ot.onKGMiniGame)) {
                    this._text;
                    this._text = null;
                }
                this.typeset(), t.setColor(this._originColor), t.setFontSize(this.fontSize), t.setFontFace(Ot.onIPhone && ei.fontFamilyMap[this.font] || this.font),
                    At.isConchApp && t.setMultiAble && t.setMultiAble(this._multiline), e.lineHeight = this.leading + this.fontSize + "px",
                    e.fontStyle = this.italic ? "italic" : "normal", e.fontWeight = this.bold ? "bold" : "normal",
                    e.textAlign = this.align, e.padding = "0 0", this._syncInputTransform(), !At.isConchApp && Ot.onPC && i.systemTimer.frameLoop(1, this, this._syncInputTransform);
            }, s._setPromptColor = function () {
                e.promptStyleDOM = Ot.getElementById("promptStyle"), e.promptStyleDOM || (e.promptStyleDOM = Ot.createElement("style"),
                    e.promptStyleDOM.setAttribute("id", "promptStyle"), Ot.document.head.appendChild(e.promptStyleDOM)),
                    e.promptStyleDOM.innerText = "input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:" + this._promptColor + "}input:-moz-placeholder, textarea:-moz-placeholder {color:" + this._promptColor + "}input::-moz-placeholder, textarea::-moz-placeholder {color:" + this._promptColor + "}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:" + this._promptColor + "}";
            }, s._focusOut = function () {
                laya.display.Input.isInputting = !1, this._focus = !1, this._text = null, this._content = this.nativeInput.value,
                    this._content ? (i.superSet(ei, this, "text", this._content), i.superSet(ei, this, "color", this._originColor)) : (i.superSet(ei, this, "text", this._prompt),
                        i.superSet(ei, this, "color", this._promptColor)), i.stage.off("keydown", this, this._onKeyDown),
                    i.stage.focus = null, this.event("blur"), this.event("change"), At.isConchApp && this.nativeInput.blur(),
                    Ot.onPC && i.systemTimer.clear(this, this._syncInputTransform);
            }, s._onKeyDown = function (t) {
                13 === t.keyCode && (Ot.onMobile && !this._multiline && (this.focus = !1), this.event("enter"));
            }, s.changeText = function (e) {
                this._content = e, this._focus ? (this.nativeInput.value = e || "", this.event("change")) : t.prototype.changeText.call(this, e);
            }, a(0, s, "color", t.prototype._$get_color, function (t) {
                this._focus && this.nativeInput.setColor(t), i.superSet(ei, this, "color", this._content ? t : this._promptColor),
                    this._originColor = t;
            }), a(0, s, "multiline", function () {
                return this._multiline;
            }, function (t) {
                this._multiline = t, this.valign = t ? "top" : "middle";
            }), a(0, s, "maxChars", function () {
                return this._maxChars;
            }, function (t) {
                t <= 0 && (t = 1e5), this._maxChars = t;
            }), a(0, s, "text", function () {
                return this._focus ? this.nativeInput.value : this._content || "";
            }, function (t) {
                i.superSet(ei, this, "color", this._originColor), t += "", this._focus ? (this.nativeInput.value = t || "",
                    this.event("change")) : (this._multiline || (t = t.replace(/\r?\n/g, "")), this._content = t,
                        t ? i.superSet(ei, this, "text", t) : (i.superSet(ei, this, "text", this._prompt),
                            i.superSet(ei, this, "color", this.promptColor)));
            }), a(0, s, "nativeInput", function () {
                return this._multiline ? e.area : e.input;
            }), a(0, s, "focus", function () {
                return this._focus;
            }, function (t) {
                var i = this.nativeInput;
                this._focus !== t && (t ? (i.target ? i.target._focusOut() : this._setInputMethod(),
                    i.target = this, this._focusIn()) : (i.target = null, this._focusOut(), Ot.document.body.scrollTop = 0,
                        i.blur(), At.isConchApp ? i.setPos(-1e4, -1e4) : e.inputContainer.contains(i) && e.inputContainer.removeChild(i)));
            }), a(0, s, "editable", function () {
                return this._editable;
            }, function (t) {
                this._editable = t, At.isConchApp && e.input.setForbidEdit(!t);
            }), a(0, s, "bgColor", t.prototype._$get_bgColor, function (t) {
                i.superSet(ei, this, "bgColor", t), At.isConchApp && this.nativeInput.setBgColor(t);
            }), a(0, s, "restrict", function () {
                return this._restrictPattern ? this._restrictPattern.source : "";
            }, function (t) {
                t ? ((t = "[^" + t + "]").indexOf("^^") > -1 && (t = t.replace("^^", "")), this._restrictPattern = new RegExp(t, "g")) : this._restrictPattern = null;
            }), a(0, s, "prompt", function () {
                return this._prompt;
            }, function (t) {
                !this._text && t && i.superSet(ei, this, "color", this._promptColor), this.promptColor = this._promptColor,
                    this._text ? i.superSet(ei, this, "text", this._text == this._prompt ? t : this._text) : i.superSet(ei, this, "text", t),
                    this._prompt = ei.langPacks && ei.langPacks[t] ? ei.langPacks[t] : t;
            }), a(0, s, "promptColor", function () {
                return this._promptColor;
            }, function (t) {
                this._promptColor = t, this._content || i.superSet(ei, this, "color", t);
            }), a(0, s, "type", function () {
                return this._type;
            }, function (t) {
                this._getTextStyle().asPassword = "password" === t, this._type = t;
            }), e.__init__ = function () {
                if (e._createInputElement(), Ot.onMobile) {
                    var t = !1;
                    (Ot.onMiniGame || Ot.onBDMiniGame || Ot.onQGMiniGame || Ot.onKGMiniGame) && (t = !0),
                        At.canvas.addEventListener(e.IOS_IFRAME ? t ? "touchend" : "click" : "touchend", e._popupInputMethod);
                }
            }, e._popupInputMethod = function (t) {
                laya.display.Input.isInputting && laya.display.Input.inputElement.focus();
            }, e._createInputElement = function () {
                e._initInput(e.area = Ot.createElement("textarea")), e._initInput(e.input = Ot.createElement("input")),
                    e.inputContainer = Ot.createElement("div"), e.inputContainer.style.position = "absolute",
                    e.inputContainer.style.zIndex = 1e5, Ot.container.appendChild(e.inputContainer),
                    e.inputContainer.setPos = function (t, i) {
                        e.inputContainer.style.left = t + "px", e.inputContainer.style.top = i + "px";
                    };
            }, e._initInput = function (t) {
                var i = t.style;
                i.cssText = "position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",
                    i.resize = "none", i.backgroundColor = "transparent", i.border = "none", i.outline = "none",
                    i.zIndex = 1, t.addEventListener("input", e._processInputting), t.addEventListener("mousemove", e._stopEvent),
                    t.addEventListener("mousedown", e._stopEvent), t.addEventListener("touchmove", e._stopEvent),
                    t.setFontFace = function (e) {
                        t.style.fontFamily = e;
                    }, At.isConchApp || (t.setColor = function (e) {
                        t.style.color = e;
                    }, t.setFontSize = function (e) {
                        t.style.fontSize = e + "px";
                    });
            }, e._processInputting = function (t) {
                var e = laya.display.Input.inputElement.target;
                if (e) {
                    var i = laya.display.Input.inputElement.value;
                    e._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""), e._restrictPattern.test(i) && (i = i.replace(e._restrictPattern, ""),
                        laya.display.Input.inputElement.value = i)), e._text = i, e.event("input");
                }
            }, e._stopEvent = function (t) {
                "touchmove" == t.type && t.preventDefault(), t.stopPropagation && t.stopPropagation();
            }, e.TYPE_TEXT = "text", e.TYPE_PASSWORD = "password", e.TYPE_EMAIL = "email", e.TYPE_URL = "url",
                e.TYPE_NUMBER = "number", e.TYPE_RANGE = "range", e.TYPE_DATE = "date", e.TYPE_MONTH = "month",
                e.TYPE_WEEK = "week", e.TYPE_TIME = "time", e.TYPE_DATE_TIME = "datetime", e.TYPE_DATE_TIME_LOCAL = "datetime-local",
                e.TYPE_SEARCH = "search", e.input = null, e.area = null, e.inputElement = null,
                e.inputContainer = null, e.confirmButton = null, e.promptStyleDOM = null, e.inputHeight = 45,
                e.isInputting = !1, e.stageMatrix = null, n(e, ["IOS_IFRAME", function () {
                    return this.IOS_IFRAME = Ot.onIOS && Ot.window.top != Ot.window.self;
                }]), e;
        }(ei), ui = (function (t) {
            function e() {
                this._frames = null, this._url = null, e.__super.call(this), this._setControlNode(this);
            }
            r(e, "laya.display.Animation", t);
            var n = e.prototype;
            n.destroy = function (t) {
                void 0 === t && (t = !0), this.stop(), laya.display.Sprite.prototype.destroy.call(this, t),
                    this._frames = null, this._labels = null;
            }, n.play = function (e, i, n) {
                void 0 === e && (e = 0), void 0 === i && (i = !0), void 0 === n && (n = ""), n && this._setFramesFromCache(n, !0),
                    t.prototype.play.call(this, e, i, n);
            }, n._setFramesFromCache = function (t, i) {
                if (void 0 === i && (i = !1), this._url && (t = this._url + "#" + t), t && e.framesMap[t]) {
                    var n = e.framesMap[t];
                    return n instanceof Array ? (this._frames = e.framesMap[t], this._count = this._frames.length) : (n.nodeRoot && (e.framesMap[t] = fi.parseAnimationByData(n),
                        n = e.framesMap[t]), this._frames = n.frames, this._count = this._frames.length,
                        this._frameRateChanged || (this._interval = n.interval), this._labels = this._copyLabels(n.labels)),
                        !0;
                }
                return i && console.log("ani not found:", t), !1;
            }, n._copyLabels = function (t) {
                if (!t) return null;
                var e, i;
                for (i in e = {}, t) e[i] = ie.copyArray([], t[i]);
                return e;
            }, n._frameLoop = function () {
                this._visible && this._style.alpha > .01 && this._frames && t.prototype._frameLoop.call(this);
            }, n._displayToIndex = function (t) {
                this._frames && (this.graphics = this._frames[t]);
            }, n.clear = function () {
                return t.prototype.clear.call(this), this.stop(), this.graphics = null, this._frames = null,
                    this._labels = null, this;
            }, n.loadImages = function (t, i) {
                return void 0 === i && (i = ""), this._url = "", this._setFramesFromCache(i) || (this.frames = e.framesMap[i] ? e.framesMap[i] : e.createFrames(t, i)),
                    this;
            }, n.loadAtlas = function (t, n, r) {
                void 0 === r && (r = ""), this._url = "";
                var a = this;
                if (!a._setFramesFromCache(r)) {
                    function s(i) {
                        t === i && (a.frames = e.framesMap[r] ? e.framesMap[r] : e.createFrames(t, r), n && n.run());
                    }
                    Oe.getAtlas(t) ? s(t) : i.loader.load(t, g.create(null, s, [t]), null, "atlas");
                }
                return this;
            }, n.loadAnimation = function (t, e, n) {
                this._url = t;
                return this._actionName || (this._actionName = ""), this._setFramesFromCache(this._actionName) ? (this._setFramesFromCache(this._actionName, !0),
                    this.index = 0, e && e.run()) : !n || Oe.getAtlas(n) ? this._loadAnimationData(t, e, n) : i.loader.load(n, g.create(this, this._loadAnimationData, [t, e, n]), null, "atlas"),
                    this;
            }, n._loadAnimationData = function (t, n, r) {
                var a = this;
                if (!r || Oe.getAtlas(r)) {
                    var s = this;
                    Oe.getRes(t) ? o(t) : i.loader.load(t, g.create(null, o, [t]), null, "json");
                } else console.warn("atlas load fail:" + r);
                function o(i) {
                    if (Oe.getRes(i)) {
                        if (t === i) {
                            var r;
                            if (e.framesMap[t + "#"]) s._setFramesFromCache(a._actionName, !0), a.index = 0,
                                a._resumePlay(); else {
                                var o = fi.parseAnimationData(Oe.getRes(t));
                                if (!o) return;
                                var l, h = o.animationList, u = 0, c = h.length;
                                for (u = 0; u < c; u++) r = h[u], e.framesMap[t + "#" + r.name] = r, l || (l = r);
                                l && (e.framesMap[t + "#"] = l, s._setFramesFromCache(a._actionName, !0), a.index = 0),
                                    a._resumePlay();
                            }
                            n && n.run();
                        }
                        Oe.clearRes(t);
                    } else e.framesMap[t + "#"] && (s._setFramesFromCache(a._actionName, !0), a.index = 0,
                        a._resumePlay(), n && n.run());
                }
            }, a(0, n, "frames", function () {
                return this._frames;
            }, function (t) {
                this._frames = t, t && (this._count = t.length, this._actionName && this._setFramesFromCache(this._actionName, !0),
                    this.index = this._index);
            }), a(0, n, "autoPlay", null, function (t) {
                t ? this.play() : this.stop();
            }), a(0, n, "source", null, function (t) {
                t.indexOf(".ani") > -1 ? this.loadAnimation(t) : t.indexOf(".json") > -1 || t.indexOf("als") > -1 || t.indexOf("atlas") > -1 ? this.loadAtlas(t) : this.loadImages(t.split(","));
            }), a(0, n, "autoAnimation", null, function (t) {
                this.play(0, !0, t);
            }), e.createFrames = function (t, i) {
                var n;
                if ("string" == typeof t) {
                    var r = Oe.getAtlas(t);
                    if (r && r.length) {
                        n = [];
                        for (var a = 0, s = r.length; a < s; a++) {
                            var o = new Zt();
                            o.drawImage(Oe.getRes(r[a]), 0, 0), n.push(o);
                        }
                    }
                } else if (t instanceof Array) for (n = [], a = 0, s = t.length; a < s; a++) (o = new Zt()).loadImage(t[a], 0, 0),
                    n.push(o);
                return i && (e.framesMap[i] = n), n;
            }, e.clearCache = function (t) {
                var i, n = e.framesMap, r = t + "#";
                for (i in n) i !== t && 0 !== i.indexOf(r) || delete e.framesMap[i];
            }, e.framesMap = {};
        }(ii), function (t) {
            function e(t, i, n, r, a) {
                this._params2dQuick2 = null, this._shaderValueWidth = 0, this._shaderValueHeight = 0,
                    e.__super.call(this, t, i, n, r, a);
            }
            r(e, "laya.webgl.shader.d2.Shader2X", t);
            var i = e.prototype;
            return i._disposeResource = function () {
                t.prototype._disposeResource.call(this), this._params2dQuick2 = null;
            }, i.upload2dQuick2 = function (t) {
                this.upload(t, this._params2dQuick2 || this._make2dQuick2());
            }, i._make2dQuick2 = function () {
                if (!this._params2dQuick2) {
                    this._params2dQuick2 = [];
                    for (var t, e = this._params, i = 0, n = e.length; i < n; i++) "size" !== (t = e[i]).name && this._params2dQuick2.push(t);
                }
                return this._params2dQuick2;
            }, e.create = function (t, i, n, r, a) {
                return new e(t, i, n, r, a);
            }, e;
        }(ni)), ci = function (t) {
            function e() {
                this._targetDic = null, this._animationData = null, this._usedFrames = null, e.__super.call(this),
                    null === e._sortIndexFun && (e._sortIndexFun = R.sortByKey("index", !1, !0));
            }
            r(e, "laya.display.FrameAnimation", t);
            var i = e.prototype;
            return i._setUp = function (t, e) {
                this._targetDic = t, this._animationData = e, this.interval = 1e3 / e.frameRate,
                    e.parsed ? (this._count = e.count, this._labels = e.labels, this._usedFrames = e.animationNewFrames) : (this._usedFrames = [],
                        this._calculateDatas(), e.parsed = !0, e.labels = this._labels, e.count = this._count,
                        e.animationNewFrames = this._usedFrames);
            }, i.clear = function () {
                return t.prototype.clear.call(this), this._targetDic = null, this._animationData = null,
                    this;
            }, i._displayToIndex = function (t) {
                if (this._animationData) {
                    t < 0 && (t = 0), t > this._count && (t = this._count);
                    var e = this._animationData.nodes, i = 0, n = e.length;
                    for (i = 0; i < n; i++) this._displayNodeToFrame(e[i], t);
                }
            }, i._displayNodeToFrame = function (t, e, i) {
                i || (i = this._targetDic);
                var n = i[t.target];
                if (n) {
                    var r, a, s, o = t.frames, l = t.keys, h = 0, u = l.length;
                    for (h = 0; h < u; h++) s = (a = o[r = l[h]]).length > e ? a[e] : a[a.length - 1],
                        n[r] = s;
                    var c, d = t.funkeys;
                    if (0 != (u = d.length)) for (h = 0; h < u; h++) void 0 !== (c = o[r = d[h]])[e] && n[r] && n[r].apply(n, c[e]);
                }
            }, i._calculateDatas = function () {
                if (this._animationData) {
                    var t, e = this._animationData.nodes, i = 0, n = e.length;
                    for (this._count = 0, i = 0; i < n; i++) t = e[i], this._calculateKeyFrames(t);
                    this._count += 1;
                }
            }, i._calculateKeyFrames = function (t) {
                var i, n, r = t.keyframes, a = t.target;
                for (i in t.frames || (t.frames = {}), t.keys ? t.keys.length = 0 : t.keys = [],
                    t.funkeys ? t.funkeys.length = 0 : t.funkeys = [], t.initValues || (t.initValues = {}),
                    r) {
                    var s = -1 != i.indexOf("()");
                    if (n = r[i], s && (i = i.substr(0, i.length - 2)), t.frames[i] || (t.frames[i] = []),
                        s) {
                        t.funkeys.push(i);
                        for (var o = t.frames[i], l = 0; l < n.length; l++) {
                            var h = n[l];
                            o[h.index] = h.value, h.index > this._count && (this._count = h.index);
                        }
                    } else this._targetDic && this._targetDic[a] && (t.initValues[i] = this._targetDic[a][i]),
                        n.sort(e._sortIndexFun), t.keys.push(i), this._calculateNodePropFrames(n, t.frames[i], i, a);
                }
            }, i.resetNodes = function () {
                if (this._targetDic && this._animationData) {
                    var t, e, i = this._animationData.nodes, n = 0, r = i.length;
                    for (n = 0; n < r; n++) if (e = (t = i[n]).initValues) {
                        var a, s = this._targetDic[t.target];
                        if (s) for (a in e) s[a] = e[a];
                    }
                }
            }, i._calculateNodePropFrames = function (t, e, i, n) {
                var r = 0, a = t.length - 1;
                for (e.length = t[a].index + 1, r = 0; r < a; r++) this._dealKeyFrame(t[r]), this._calculateFrameValues(t[r], t[r + 1], e);
                0 == a && (e[0] = t[0].value, this._usedFrames && (this._usedFrames[t[0].index] = !0)),
                    this._dealKeyFrame(t[r]);
            }, i._dealKeyFrame = function (t) {
                t.label && "" != t.label && this.addLabel(t.label, t.index);
            }, i._calculateFrameValues = function (t, e, i) {
                var n, r = 0, a = t.index, s = e.index, o = t.value, l = e.value - t.value, h = s - a, u = this._usedFrames;
                if (s > this._count && (this._count = s), t.tween) for (null == (n = te[t.tweenMethod]) && (n = te.linearNone),
                    r = a; r < s; r++) i[r] = n(r - a, o, l, h), u && (u[r] = !0); else for (r = a; r < s; r++) i[r] = o;
                u && (u[t.index] = !0, u[e.index] = !0), i[e.index] = e.value;
            }, e._sortIndexFun = null, e;
        }(ii), di = function (t) {
            function e(t, i, n, r, a) {
                if (void 0 === t && (t = 0), void 0 === i && (i = 0), void 0 === n && (n = 1), void 0 === r && (r = !0),
                    void 0 === a && (a = !1), e.__super.call(this, n, r), this._glTextureType = 3553,
                    this._width = t, this._height = i, this._canRead = a, this._setWarpMode(10242, this._wrapModeU),
                    this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode),
                    this._setAnisotropy(this._anisoLevel), this._mipmap) {
                    this._mipmapCount = Math.max(Math.ceil(Math.log2(t)) + 1, Math.ceil(Math.log2(2)) + 1);
                    for (var s = 0; s < this._mipmapCount; s++) this._setPixels(null, s, Math.max(t >> s, 1), Math.max(i >> s, 1));
                    this._setGPUMemory(t * i * 4 * (1 + 1 / 3));
                } else this._mipmapCount = 1, this._setGPUMemory(t * i * 4);
            }
            r(e, "laya.resource.Texture2D", t);
            var n = e.prototype;
            return n._getFormatByteCount = function () {
                switch (this._format) {
                    case 0:
                        return 3;

                    case 1:
                        return 4;

                    case 2:
                        return 1;

                    default:
                        throw "Texture2D: unknown format.";
                }
            }, n._setPixels = function (t, e, i, n) {
                var r = Dt.instance, a = this._glTextureType, s = this._getGLFormat();
                nt.bindTexture(r, a, this._glTexture), 0 === this.format ? (r.pixelStorei(3317, 1),
                    r.texImage2D(a, e, s, i, n, 0, s, 5121, t), r.pixelStorei(3317, 4)) : r.texImage2D(a, e, s, i, n, 0, s, 5121, t);
            }, n._calcualatesCompressedDataSize = function (t, e, i) {
                switch (t) {
                    case 3:
                    case 5:
                        return (e + 3 >> 2) * (i + 3 >> 2) * 8;

                    case 4:
                        return (e + 3 >> 2) * (i + 3 >> 2) * 16;

                    case 11:
                    case 12:
                        return Math.floor((Math.max(e, 8) * Math.max(i, 8) * 4 + 7) / 8);

                    case 9:
                    case 10:
                        return Math.floor((Math.max(e, 16) * Math.max(i, 8) * 2 + 7) / 8);

                    default:
                        return 0;
                }
            }, n._pharseDDS = function (t) {
                var e = new Int32Array(t, 0, 31);
                if (542327876 != e[0]) throw "Invalid magic number in DDS header";
                if (!(4 & e[20])) throw "Unsupported format, must contain a FourCC code";
                var i = e[21];
                switch (this._format) {
                    case 3:
                        if (827611204 !== i) throw "the FourCC code is not same with texture format.";
                        break;

                    case 4:
                        if (894720068 !== i) throw "the FourCC code is not same with texture format.";
                        break;

                    default:
                        throw "unknown texture format.";
                }
                var n = 1;
                if (131072 & e[2]) {
                    if (n = Math.max(1, e[7]), !this._mipmap) throw "the mipmap is not same with Texture2D.";
                } else if (this._mipmap) throw "the mipmap is not same with Texture2D.";
                var r = e[4], a = e[3];
                this._width = r, this._height = a;
                var s = e[1] + 4;
                this._upLoadCompressedTexImage2D(t, r, a, n, s, 0);
            }, n._pharseKTX = function (t) {
                var e = new Uint8Array(t, 0, 12);
                if (171 != e[0] || 75 != e[1] || 84 != e[2] || 88 != e[3] || 32 != e[4] || 49 != e[5] || 49 != e[6] || 187 != e[7] || 13 != e[8] || 10 != e[9] || 26 != e[10] || 10 != e[11]) throw "Invalid fileIdentifier in KTX header";
                var i = new Int32Array(e.buffer, e.length, 13);
                switch (i[4]) {
                    case nt._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:
                        this._format = 5;
                        break;

                    default:
                        throw "unknown texture format.";
                }
                var n = i[11], r = i[6], a = i[7];
                this._width = r, this._height = a;
                var s = 64 + i[12];
                this._upLoadCompressedTexImage2D(t, r, a, n, s, 4);
            }, n._pharsePVR = function (t) {
                var e = new Int32Array(t, 0, 13);
                if (55727696 != e[0]) throw "Invalid magic number in PVR header";
                switch (e[2]) {
                    case 0:
                        this._format = 9;
                        break;

                    case 2:
                        this._format = 11;
                        break;

                    case 1:
                        this._format = 10;
                        break;

                    case 3:
                        this._format = 12;
                        break;

                    default:
                        throw "Texture2D:unknown PVR format.";
                }
                var i = e[11], n = e[7], r = e[6];
                this._width = n, this._height = r;
                var a = e[12] + 52;
                this._upLoadCompressedTexImage2D(t, n, r, i, a, 0);
            }, n._upLoadCompressedTexImage2D = function (t, e, i, n, r, a) {
                var s = Dt.instance, o = this._glTextureType;
                nt.bindTexture(s, o, this._glTexture);
                for (var l = this._getGLFormat(), h = r, u = 0; u < n; u++) {
                    h += a;
                    var c = this._calcualatesCompressedDataSize(this._format, e, i), d = new Uint8Array(t, h, c);
                    s.compressedTexImage2D(o, u, l, e, i, 0, d), e = Math.max(e >> 1, 1), i = Math.max(i >> 1, 1),
                        h += c;
                }
                var _ = h;
                this._setGPUMemory(_), this._readyed = !0, this._activeResource();
            }, n.loadImageSource = function (t, e) {
                void 0 === e && (e = !1);
                var i = t.width, n = t.height;
                this._width = i, this._height = n, this._isPot(i) && this._isPot(n) || (this._mipmap = !1),
                    this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV),
                    this._setFilterMode(this._filterMode);
                var r = Dt.instance;
                nt.bindTexture(r, this._glTextureType, this._glTexture);
                var a = this._getGLFormat();
                At.isConchApp ? (t instanceof laya.resource.HTMLCanvas || t.setPremultiplyAlpha(e),
                    r.texImage2D(this._glTextureType, 0, 6408, 6408, 5121, t)) : (e && r.pixelStorei(37441, !0),
                        r.texImage2D(this._glTextureType, 0, a, a, 5121, t), e && r.pixelStorei(37441, !1)),
                    this._mipmap ? (r.generateMipmap(this._glTextureType), this._setGPUMemory(i * n * 4 * (1 + 1 / 3))) : this._setGPUMemory(i * n * 4),
                    this._canRead && (At.isConchApp ? this._pixels = new Uint8Array(t._nativeObj.getImageData(0, 0, i, n)) : (Ot.canvas.size(i, n),
                        Ot.canvas.clear(), Ot.context.drawImage(t, 0, 0, i, n), this._pixels = new Uint8Array(Ot.context.getImageData(0, 0, i, n).data.buffer))),
                    this._readyed = !0, this._activeResource();
            }, n.setPixels = function (t, e) {
                if (void 0 === e && (e = 0), !t) throw "Texture2D:pixels can't be null.";
                var i = Math.max(this._width >> e, 1), n = Math.max(this._height >> e, 1), r = i * n * this._getFormatByteCount();
                if (t.length < r) throw "Texture2D:pixels length should at least " + r + ".";
                this._setPixels(t, e, i, n), this._canRead && (this._pixels = t), this._readyed = !0,
                    this._activeResource();
            }, n.setSubPixels = function (t, e, i, n, r, a) {
                if (void 0 === a && (a = 0), !r) throw "Texture2D:pixels can't be null.";
                var s = Dt.instance, o = this._glTextureType;
                nt.bindTexture(s, o, this._glTexture);
                var l = this._getGLFormat();
                0 === this._format ? (s.pixelStorei(3317, 1), s.texSubImage2D(o, a, t, e, i, n, l, 5121, r),
                    s.pixelStorei(3317, 4)) : s.texSubImage2D(o, a, t, e, i, n, l, 5121, r), this._readyed = !0,
                    this._activeResource();
            }, n.setCompressData = function (t) {
                switch (this._format) {
                    case 3:
                    case 4:
                        this._pharseDDS(t);
                        break;

                    case 5:
                        this._pharseKTX(t);
                        break;

                    case 9:
                    case 10:
                    case 11:
                    case 12:
                        this._pharsePVR(t);
                        break;

                    default:
                        throw "Texture2D:unkonwn format.";
                }
            }, n._recoverResource = function () { }, n.getPixels = function () {
                if (this._canRead) return this._pixels;
                throw new Error("Texture2D: must set texture canRead is true.");
            }, a(0, n, "mipmapCount", function () {
                return this._mipmapCount;
            }), a(0, n, "defaulteTexture", function () {
                return laya.resource.Texture2D.grayTexture;
            }), e.__init__ = function () {
                var t = new Uint8Array(3);
                t[0] = 128, t[1] = 128, t[2] = 128, e.grayTexture = new e(1, 1, 0, !1, !1), e.grayTexture.setPixels(t),
                    e.grayTexture.lock = !0, t[0] = 255, t[1] = 255, t[2] = 255, e.whiteTexture = new e(1, 1, 0, !1, !1),
                    e.whiteTexture.setPixels(t), e.whiteTexture.lock = !0, t[0] = 0, t[1] = 0, t[2] = 0,
                    e.blackTexture = new e(1, 1, 0, !1, !1), e.blackTexture.setPixels(t), e.blackTexture.lock = !0;
            }, e._parse = function (t, i, n) {
                var r = n ? new e(n[0], n[1], n[2], n[3], n[4]) : new e(0, 0);
                switch (i && (r.wrapModeU = i.wrapModeU, r.wrapModeV = i.wrapModeV, r.filterMode = i.filterMode,
                    r.anisoLevel = i.anisoLevel), r._format) {
                    case 0:
                    case 1:
                        r.loadImageSource(t);
                        break;

                    case 3:
                    case 4:
                    case 5:
                    case 9:
                    case 10:
                    case 11:
                    case 12:
                        r.setCompressData(t);
                        break;

                    default:
                        throw "Texture2D:unkonwn format.";
                }
                return r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "TEXTURE2D");
            }, e.grayTexture = null, e.whiteTexture = null, e.blackTexture = null, e;
        }(ri), _i = function (t) {
            function e(t, i, n, r) {
                this._mgrKey = 0, void 0 === n && (n = 0), void 0 === r && (r = 0), e.__super.call(this, n, !1),
                    this._glTextureType = 3553, this._width = t, this._height = i, this._depthStencilFormat = r,
                    this._create(t, i), this.lock = !0;
            }
            r(e, "laya.resource.RenderTexture2D", t);
            var i = e.prototype;
            return i.getIsReady = function () {
                return !0;
            }, i._create = function (t, e) {
                var i = Dt.instance;
                this._frameBuffer = i.createFramebuffer(), nt.bindTexture(i, this._glTextureType, this._glTexture);
                var n = this._getGLFormat();
                if (i.texImage2D(this._glTextureType, 0, n, t, e, 0, n, 5121, null), this._setGPUMemory(t * e * 4),
                    i.bindFramebuffer(36160, this._frameBuffer), i.framebufferTexture2D(36160, 36064, 3553, this._glTexture, 0),
                    3 !== this._depthStencilFormat) switch (this._depthStencilBuffer = i.createRenderbuffer(),
                    i.bindRenderbuffer(36161, this._depthStencilBuffer), this._depthStencilFormat) {
                        case 0:
                            i.renderbufferStorage(36161, 33189, t, e), i.framebufferRenderbuffer(36160, 36096, 36161, this._depthStencilBuffer);
                            break;

                        case 1:
                            i.renderbufferStorage(36161, 36168, t, e), i.framebufferRenderbuffer(36160, 36128, 36161, this._depthStencilBuffer);
                            break;

                        case 2:
                            i.renderbufferStorage(36161, 34041, t, e), i.framebufferRenderbuffer(36160, 33306, 36161, this._depthStencilBuffer);
                    }
                i.bindFramebuffer(36160, null), i.bindRenderbuffer(36161, null), this._setWarpMode(10242, this._wrapModeU),
                    this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode),
                    this._setAnisotropy(this._anisoLevel), this._readyed = !0, this._activeResource();
            }, i.generateMipmap = function () {
                this._isPot(this.width) && this._isPot(this.height) ? (this._mipmap = !0, Dt.instance.generateMipmap(this._glTextureType),
                    this._setFilterMode(this._filterMode), this._setGPUMemory(this.width * this.height * 4 * (1 + 1 / 3))) : (this._mipmap = !1,
                        this._setGPUMemory(this.width * this.height * 4));
            }, i.start = function () {
                var t = Dt.instance;
                Dt.instance.bindFramebuffer(36160, this._frameBuffer), this._lastRT = e._currentActive,
                    e._currentActive = this, this._readyed = !0, t.viewport(0, 0, this._width, this._height),
                    this._lastWidth = ft.width, this._lastHeight = ft.height, ft.width = this._width,
                    ft.height = this._height, qe.activeShader = null;
            }, i.end = function () {
                Dt.instance.bindFramebuffer(36160, null), e._currentActive = null, this._readyed = !0;
            }, i.restore = function () {
                var t = Dt.instance;
                this._lastRT != e._currentActive && (Dt.instance.bindFramebuffer(36160, this._lastRT ? this._lastRT._frameBuffer : null),
                    e._currentActive = this._lastRT), this._readyed = !0, t.viewport(0, 0, this._lastWidth, this._lastHeight),
                    ft.width = this._lastWidth, ft.height = this._lastHeight, qe.activeShader = null;
            }, i.clear = function (t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1);
                var r = Dt.instance;
                r.clearColor(t, e, i, n);
                var a = 16384;
                switch (this._depthStencilFormat) {
                    case 33189:
                        a |= 256;
                        break;

                    case 36168:
                        a |= 1024;
                        break;

                    case 34041:
                        a |= 256, a |= 1024;
                }
                r.clear(a);
            }, i.getData = function (t, e, i, n) {
                if (At.isConchApp && 2 == conchConfig.threadMode) throw "native 2 thread mode use getDataAsync";
                var r = Dt.instance;
                if (r.bindFramebuffer(36160, this._frameBuffer), !(36053 === r.checkFramebufferStatus(36160))) return r.bindFramebuffer(36160, null),
                    null;
                var a = new Uint8Array(this._width * this._height * 4), s = this._getGLFormat();
                return r.readPixels(t, e, i, n, s, 5121, a), r.bindFramebuffer(36160, null), a;
            }, i.getDataAsync = function (t, e, i, n, r) {
                var a = Dt.instance;
                a.bindFramebuffer(36160, this._frameBuffer), a.readPixelsAsync(t, e, i, n, 6408, 5121, function (t) {
                    r(new Uint8Array(t));
                }), a.bindFramebuffer(36160, null);
            }, i.recycle = function () { }, i._disposeResource = function () {
                if (this._frameBuffer) {
                    var t = Dt.instance;
                    t.deleteTexture(this._glTexture), t.deleteFramebuffer(this._frameBuffer), t.deleteRenderbuffer(this._depthStencilBuffer),
                        this._glTexture = null, this._frameBuffer = null, this._depthStencilBuffer = null,
                        this._setGPUMemory(0);
                }
            }, a(0, i, "depthStencilFormat", function () {
                return this._depthStencilFormat;
            }), a(0, i, "defaulteTexture", function () {
                return di.grayTexture;
            }), a(0, i, "sourceWidth", function () {
                return this._width;
            }), a(0, i, "sourceHeight", function () {
                return this._height;
            }), a(0, i, "offsetX", function () {
                return 0;
            }), a(0, i, "offsetY", function () {
                return 0;
            }), a(1, e, "currentActive", function () {
                return e._currentActive;
            }, laya.resource.BaseTexture._$SET_currentActive), e.pushRT = function () {
                e.rtStack.push({
                    rt: e._currentActive,
                    w: ft.width,
                    h: ft.height
                });
            }, e.popRT = function () {
                var t = Dt.instance, i = e.rtStack.pop();
                i && (e._currentActive != i.rt && (Dt.instance.bindFramebuffer(36160, i.rt ? i.rt._frameBuffer : null),
                    e._currentActive = i.rt), t.viewport(0, 0, i.w, i.h), ft.width = i.w, ft.height = i.h);
            }, e._currentActive = null, e.rtStack = [], n(e, ["defuv", function () {
                return this.defuv = [0, 0, 1, 0, 1, 1, 0, 1];
            }, "flipyuv", function () {
                return this.flipyuv = [0, 1, 1, 1, 1, 0, 0, 0];
            }]), e;
        }(ri), fi = function (t) {
            var e;
            function i() {
                this.animationList = null, this.animationDic = null, this._nodeList = null, this._nodeDefaultProps = null,
                    this._gList = null, this._nodeIDAniDic = {}, this._rootNode = null, this._nodeGDic = null,
                    i.__super.call(this);
            }
            r(i, "laya.utils.GraphicAnimation", t);
            var a = i.prototype;
            return a._parseNodeList = function (t) {
                this._nodeList || (this._nodeList = []), this._nodeDefaultProps[t.compId] = t.props,
                    t.compId && this._nodeList.push(t.compId);
                var e = t.child;
                if (e) {
                    var i = 0, n = e.length;
                    for (i = 0; i < n; i++) this._parseNodeList(e[i]);
                }
            }, a._calGraphicData = function (t) {
                var e;
                if (this._setUp(null, t), this._createGraphicData(), this._nodeIDAniDic) for (e in this._nodeIDAniDic) this._nodeIDAniDic[e] = null;
            }, a._createGraphicData = function () {
                var t, e = [], i = 0, n = this.count, r = this._usedFrames;
                for (r || (r = []), i = 0; i < n; i++) !r[i] && t || (t = this._createFrameGraphic(i)),
                    e.push(t);
                this._gList = e;
            }, a._createFrameGraphic = function (t) {
                var e = new Zt();
                return i._rootMatrix || (i._rootMatrix = new at()), this._updateNodeGraphic(this._rootNode, t, i._rootMatrix, e),
                    e;
            }, a._updateNodeGraphic = function (t, e, i, n, r) {
                var a, s, o;
                void 0 === r && (r = 1), (a = this._nodeGDic[t.compId] = this._getNodeGraphicData(t.compId, e, this._nodeGDic[t.compId])).resultTransform || (a.resultTransform = new at()),
                    s = a.resultTransform, at.mul(a.transform, i, s);
                var l = a.alpha * r;
                if (!(l < .01)) {
                    a.skin && (o = this._getTextureByUrl(a.skin)) && (s._checkTransform() ? (n.drawTexture(o, 0, 0, a.width, a.height, s, l),
                        a.resultTransform = null) : n.drawTexture(o, s.tx, s.ty, a.width, a.height, null, l));
                    var h = t.child;
                    if (h) {
                        var u, c = 0;
                        for (u = h.length, c = 0; c < u; c++) this._updateNodeGraphic(h[c], e, s, n, l);
                    }
                }
            }, a._updateNoChilds = function (t, e) {
                if (t.skin) {
                    var i = this._getTextureByUrl(t.skin);
                    if (i) {
                        var n = t.transform;
                        n._checkTransform();
                        !n._bTransform ? e.drawTexture(i, n.tx, n.ty, t.width, t.height, null, t.alpha) : e.drawTexture(i, 0, 0, t.width, t.height, n.clone(), t.alpha);
                    }
                }
            }, a._updateNodeGraphic2 = function (t, e, i) {
                var n;
                if (n = this._nodeGDic[t.compId] = this._getNodeGraphicData(t.compId, e, this._nodeGDic[t.compId]),
                    t.child) {
                    var r = n.transform;
                    r._checkTransform();
                    var a, s;
                    s = (a = !r._bTransform) && (0 != r.tx || 0 != r.ty);
                    var o;
                    (o = r._bTransform || 1 != n.alpha) && i.save(), 1 != n.alpha && i.alpha(n.alpha),
                        a ? s && i.translate(r.tx, r.ty) : i.transform(r.clone());
                    var l, h = t.child;
                    if (n.skin && (l = this._getTextureByUrl(n.skin)) && i.drawImage(l, 0, 0, n.width, n.height),
                        h) {
                        var u, c = 0;
                        for (u = h.length, c = 0; c < u; c++) this._updateNodeGraphic2(h[c], e, i);
                    }
                    o ? i.restore() : a ? s && i.translate(-r.tx, -r.ty) : i.transform(r.clone().invert());
                } else this._updateNoChilds(n, i);
            }, a._calculateKeyFrames = function (e) {
                t.prototype._calculateKeyFrames.call(this, e), this._nodeIDAniDic[e.target] = e;
            }, a.getNodeDataByID = function (t) {
                return this._nodeIDAniDic[t];
            }, a._getParams = function (t, e, n, r) {
                var a = i._temParam;
                a.length = e.length;
                var s = 0, o = e.length;
                for (s = 0; s < o; s++) a[s] = this._getObjVar(t, e[s][0], n, e[s][1], r);
                return a;
            }, a._getObjVar = function (t, e, i, n, r) {
                if (t.hasOwnProperty(e)) {
                    var a = t[e];
                    return i >= a.length && (i = a.length - 1), t[e][i];
                }
                return r.hasOwnProperty(e) ? r[e] : n;
            }, a._getNodeGraphicData = function (t, n, r) {
                r || (r = new e()), r.transform ? r.transform.identity() : r.transform = new at();
                var a = this.getNodeDataByID(t);
                if (!a) return r;
                var s, o = a.frames, l = this._getParams(o, i._drawTextureCmd, n, this._nodeDefaultProps[t]), h = l[0], u = NaN, c = NaN, d = l[5], _ = l[6], f = l[13], p = l[14], m = l[7], g = l[8], y = l[9], v = l[11], S = l[12];
                u = l[3], c = l[4], 0 != u && 0 != c || (h = null), -1 == u && (u = 0), -1 == c && (c = 0),
                    r.skin = h, r.width = u, r.height = c, h && ((s = this._getTextureByUrl(h)) ? (u || (u = s.sourceWidth),
                        c || (c = s.sourceHeight)) : console.warn("lost skin:", h, ",you may load pics first")),
                    r.alpha = l[10];
                var T = r.transform;
                0 != f && (d = f * u), 0 != p && (_ = p * c), 0 == d && 0 == _ || T.translate(-d, -_);
                var E = null;
                if (y || 1 !== m || 1 !== g || v || S) {
                    (E = i._tempMt).identity(), E._bTransform = !0;
                    var C = .0174532922222222 * (y - v), x = .0174532922222222 * (y + S), b = Math.cos(x), I = Math.sin(x), w = Math.sin(C), A = Math.cos(C);
                    E.a = m * b, E.b = m * I, E.c = -g * w, E.d = g * A, E.tx = E.ty = 0;
                }
                return E && (T = at.mul(T, E, T)), T.translate(l[1], l[2]), r;
            }, a._getTextureByUrl = function (t) {
                return Oe.getRes(t);
            }, a.setAniData = function (t, e) {
                if (t.animations) {
                    this._nodeDefaultProps = {}, this._nodeGDic = {}, this._nodeList && (this._nodeList.length = 0),
                        this._rootNode = t, this._parseNodeList(t);
                    var n, r = {}, a = [], s = t.animations, o = 0, l = s.length;
                    for (o = 0; o < l; o++) if (n = s[o], this._labels = null, (!e || e == n.name) && n) {
                        try {
                            this._calGraphicData(n);
                        } catch (t) {
                            console.warn("parse animation fail:" + n.name + ",empty animation created"), this._gList = [];
                        }
                        var h = {};
                        h.interval = 1e3 / n.frameRate, h.frames = this._gList, h.labels = this._labels,
                            h.name = n.name, a.push(h), r[n.name] = h;
                    }
                    this.animationList = a, this.animationDic = r;
                }
                i._temParam.length = 0;
            }, a.parseByData = function (t) {
                var e, i;
                e = t.nodeRoot, i = t.aniO, delete t.nodeRoot, delete t.aniO, this._nodeDefaultProps = {},
                    this._nodeGDic = {}, this._nodeList && (this._nodeList.length = 0), this._rootNode = e,
                    this._parseNodeList(e), this._labels = null;
                try {
                    this._calGraphicData(i);
                } catch (t) {
                    console.warn("parse animation fail:" + i.name + ",empty animation created"), this._gList = [];
                }
                var n = t;
                return n.interval = 1e3 / i.frameRate, n.frames = this._gList, n.labels = this._labels,
                    n.name = i.name, n;
            }, a.setUpAniData = function (t) {
                if (t.animations) {
                    var e, i = {}, n = [], r = t.animations, a = 0, s = r.length;
                    for (a = 0; a < s; a++) if (e = r[a]) {
                        var o = {};
                        o.name = e.name, o.aniO = e, o.nodeRoot = t, n.push(o), i[e.name] = o;
                    }
                    this.animationList = n, this.animationDic = i;
                }
            }, a._clear = function () {
                this.animationList = null, this.animationDic = null, this._gList = null, this._nodeGDic = null;
            }, i.parseAnimationByData = function (t) {
                var e;
                return i._I || (i._I = new i()), e = i._I.parseByData(t), i._I._clear(), e;
            }, i.parseAnimationData = function (t) {
                var e;
                return i._I || (i._I = new i()), i._I.setUpAniData(t), (e = {}).animationList = i._I.animationList,
                    e.animationDic = i._I.animationDic, i._I._clear(), e;
            }, i._temParam = [], i._I = null, i._rootMatrix = null, n(i, ["_drawTextureCmd", function () {
                return this._drawTextureCmd = [["skin", null], ["x", 0], ["y", 0], ["width", -1], ["height", -1], ["pivotX", 0], ["pivotY", 0], ["scaleX", 1], ["scaleY", 1], ["rotation", 0], ["alpha", 1], ["skewX", 0], ["skewY", 0], ["anchorX", 0], ["anchorY", 0]];
            }, "_tempMt", function () {
                return this._tempMt = new at();
            }]), i.__init$ = function () {
                e = function () {
                    function t() {
                        this.skin = null, this.transform = null, this.resultTransform = null, this.width = NaN,
                            this.height = NaN, this.alpha = 1;
                    }
                    return r(t, ""), t;
                }();
            }, i;
        }(ci);
        !function (t) {
            function e() {
                this._target = null, this._playEvent = null, this._initData = {}, this._aniKeys = null,
                    this._effectClass = null, e.__super.call(this);
            }
            r(e, "laya.display.EffectAnimation", t);
            var i = e.prototype;
            i._onOtherBegin = function (t) {
                t !== this && this.stop();
            }, i._addEvent = function () {
                this._target && this._playEvent && (this._setControlNode(this._target), this._target.on(this._playEvent, this, this._onPlayAction));
            }, i._onPlayAction = function () {
                this.play(0, !1);
            }, i.play = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = !0), void 0 === i && (i = ""), this._target && (this._target.event("effectbegin", [this]),
                    this._recordInitData(), laya.display.AnimationBase.prototype.play.call(this, t, e, i));
            }, i._recordInitData = function () {
                if (this._aniKeys) {
                    var t, e, i = 0;
                    for (t = this._aniKeys.length, i = 0; i < t; i++) e = this._aniKeys[i], this._initData[e] = this._target[e];
                }
            }, i._displayToIndex = function (t) {
                if (this._animationData) {
                    t < 0 && (t = 0), t > this._count && (t = this._count);
                    var e = this._animationData.nodes, i = 0, n = e.length;
                    for (n = n > 1 ? 1 : n, i = 0; i < n; i++) this._displayNodeToFrame(e[i], t);
                }
            }, i._displayNodeToFrame = function (t, e, i) {
                if (this._target) {
                    var n, r, a, s, o, l, h, u = this._target, c = t.frames, d = t.keys, _ = 0, f = d.length, p = t.secondFrames, m = 0;
                    for (_ = 0; _ < f; _++) r = c[n = d[_]], -1 == (m = p[n]) ? a = this._initData[n] : e < m ? (l = (o = t.keyframes[n])[0]).tween ? (null == (s = te[l.tweenMethod]) && (s = te.linearNone),
                        h = o[1], a = s(e, this._initData[n], h.value - this._initData[n], h.index)) : a = this._initData[n] : a = r.length > e ? r[e] : r[r.length - 1],
                        u[n] = a;
                }
            }, i._calculateKeyFrames = function (e) {
                t.prototype._calculateKeyFrames.call(this, e);
                var i, n, r = e.keyframes, a = (e.target, {});
                for (i in e.secondFrames = a, r) (n = r[i]).length <= 1 ? a[i] = -1 : a[i] = n[1].index;
            }, a(0, i, "target", function () {
                return this._target;
            }, function (t) {
                this._target && this._target.off("effectbegin", this, this._onOtherBegin), this._target = t,
                    this._target && this._target.on("effectbegin", this, this._onOtherBegin), this._addEvent();
            }), a(0, i, "playEvent", null, function (t) {
                this._playEvent = t, t && this._addEvent();
            }), a(0, i, "effectData", null, function (t) {
                if (t) {
                    var e = t.animations;
                    if (e && e[0]) {
                        var i = e[0];
                        this._setUp({}, i), i.nodes && i.nodes[0] && (this._aniKeys = i.nodes[0].keys);
                    }
                }
            }), a(0, i, "effectClass", null, function (t) {
                if (this._effectClass = Rt.getClass(t), this._effectClass) {
                    var e = this._effectClass.uiView;
                    if (e) {
                        var i = e.animations;
                        if (i && i[0]) {
                            var n = i[0];
                            this._setUp({}, n), n.nodes && n.nodes[0] && (this._aniKeys = n.nodes[0].keys);
                        }
                    }
                }
            }), e.EFFECT_BEGIN = "effectbegin";
        }(ci);
        i.__init([m, ut, Fe, I, fi, pt, At, K, $, Kt, Et, Ee, _, Ae]);
    }(window, document, n), function (t, e, i) {
        i.un, i.uns, i.static;
        var n = i.class;
        i.getset, i.__newvec;
        new (function () {
            function t() { }
            return n(t, "LayaMain"), t;
        }())();
    }(window, document, n);
}, function (t, e) {
    !function (t, e, i) {
        i.un, i.uns;
        var n = i.static, r = i.class, a = i.getset, s = (i.__newvec, laya.display.Animation), o = laya.utils.Browser, l = laya.utils.ClassUtils, h = laya.filters.ColorFilter, u = laya.components.Component, c = (laya.Const,
            laya.utils.Ease), d = laya.events.Event, _ = laya.display.Graphics, f = laya.utils.Handler, p = laya.net.HttpRequest, m = laya.display.Input, g = laya.net.Loader, y = laya.net.LocalStorage, v = laya.maths.Matrix, S = (laya.display.Node,
                laya.maths.Point), T = laya.maths.Rectangle, E = (laya.renders.Render, laya.display.Scene), C = laya.utils.SceneUtils, x = laya.display.Sprite, b = (laya.display.Stage,
                    laya.display.Text), I = laya.resource.Texture, w = laya.utils.TimeLine, A = laya.utils.Tween, R = laya.utils.Utils, M = laya.utils.WeakObject;
        i.interface("laya.ui.IBox"), i.interface("laya.ui.IItem"), i.interface("laya.ui.ISelect"),
            i.interface("laya.ui.IRender");
        var D = function () {
            function t() { }
            return r(t, "UIConfig"), t.touchScrollEnable = !0, t.mouseWheelEnable = !0, t.showButtons = !0,
                t.popupBgColor = "#000000", t.popupBgAlpha = .5, t.closeDialogOnSide = !0, t;
        }(), O = function () {
            function t() { }
            return r(t, "laya.ui.Styles"), t.labelColor = "#000000", t.buttonStateNum = 3, t.scrollBarMinNum = 15,
                t.scrollBarDelayTime = 500, n(t, ["defaultSizeGrid", function () {
                    return this.defaultSizeGrid = [4, 4, 4, 4, 0];
                }, "labelPadding", function () {
                    return this.labelPadding = [2, 2, 2, 2];
                }, "inputLabelPadding", function () {
                    return this.inputLabelPadding = [1, 1, 1, 3];
                }, "buttonLabelColors", function () {
                    return this.buttonLabelColors = ["#32556b", "#32cc6b", "#ff0000", "#C0C0C0"];
                }, "comboBoxItemColors", function () {
                    return this.comboBoxItemColors = ["#5e95b6", "#ffffff", "#000000", "#8fa4b1", "#ffffff"];
                }]), t;
        }(), L = function () {
            function t() { }
            return r(t, "laya.ui.UIUtils"), t.fillArray = function (t, e, i) {
                var n = t.concat();
                if (e) for (var r = e.split(","), a = 0, s = Math.min(n.length, r.length); a < s; a++) {
                    var o = r[a];
                    n[a] = "true" == o || "false" != o && o, null != i && (n[a] = i(o));
                }
                return n;
            }, t.toColor = function (t) {
                return R.toHexColor(t);
            }, t.gray = function (e, i) {
                void 0 === i && (i = !0), i ? t.addFilter(e, t.grayFilter) : t.clearFilter(e, h);
            }, t.addFilter = function (t, e) {
                var i = t.filters || [];
                i.push(e), t.filters = i;
            }, t.clearFilter = function (t, e) {
                var n = t.filters;
                if (null != n && n.length > 0) {
                    for (var r = n.length - 1; r > -1; r--) {
                        var a = n[r];
                        i.__typeof(a, e) && n.splice(r, 1);
                    }
                    t.filters = n;
                }
            }, t._getReplaceStr = function (e) {
                return t.escapeSequence[e];
            }, t.adptString = function (e) {
                return e.replace(/\\(\w)/g, t._getReplaceStr);
            }, t.getBindFun = function (e) {
                var n = t._funMap.get(e);
                if (null == n) {
                    var r = '"' + e + '"', a = "(function(data){if(data==null)return;with(data){try{\nreturn " + (r = r.replace(/^"\${|}"$/g, "").replace(/\${/g, '"+').replace(/}/g, '+"')) + "\n}catch(e){}}})";
                    n = i._runScript(a), t._funMap.set(e, n);
                }
                return n;
            }, n(t, ["grayFilter", function () {
                return this.grayFilter = new h([.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0]);
            }, "escapeSequence", function () {
                return this.escapeSequence = {
                    "\\n": "\n",
                    "\\t": "\t"
                };
            }, "_funMap", function () {
                return this._funMap = new M();
            }]), t;
        }(), P = function (t) {
            function e() {
                e.__super.call(this), this._top = NaN, this._bottom = NaN, this._left = NaN, this._right = NaN,
                    this._centerX = NaN, this._centerY = NaN;
            }
            r(e, "laya.ui.Widget", t);
            var i = e.prototype;
            return i.onReset = function () {
                this._top = this._bottom = this._left = this._right = this._centerX = this._centerY = NaN;
            }, i._onEnable = function () {
                this.owner.parent ? this._onAdded() : this.owner.once("added", this, this._onAdded);
            }, i._onDisable = function () {
                this.owner.off("added", this, this._onAdded), this.owner.parent && this.owner.parent.off("resize", this, this._onParentResize);
            }, i._onAdded = function () {
                this.owner.parent && this.owner.parent.on("resize", this, this._onParentResize),
                    this.resetLayoutX(), this.resetLayoutY();
            }, i._onParentResize = function () {
                (this.resetLayoutX() || this.resetLayoutY()) && this.owner.event("resize");
            }, i.resetLayoutX = function () {
                var t = this.owner;
                if (!t) return !1;
                var e = t.parent;
                if (e) if (isNaN(this.centerX)) {
                    if (isNaN(this.left)) isNaN(this.right) || (t.x = Math.round(e.width - t.displayWidth - this.right + t.pivotX * t.scaleX)); else if (t.x = Math.round(this.left + t.pivotX * t.scaleX),
                        !isNaN(this.right)) {
                        var i = (e._width - this.left - this.right) / (t.scaleX || .01);
                        if (i != t.width) return t.width = i, !0;
                    }
                } else t.x = Math.round(.5 * (e.width - t.displayWidth) + this.centerX + t.pivotX * t.scaleX);
                return !1;
            }, i.resetLayoutY = function () {
                var t = this.owner;
                if (!t) return !1;
                var e = t.parent;
                if (e) if (isNaN(this.centerY)) {
                    if (isNaN(this.top)) isNaN(this.bottom) || (t.y = Math.round(e.height - t.displayHeight - this.bottom + t.pivotY * t.scaleY)); else if (t.y = Math.round(this.top + t.pivotY * t.scaleY),
                        !isNaN(this.bottom)) {
                        var i = (e._height - this.top - this.bottom) / (t.scaleY || .01);
                        if (i != t.height) return t.height = i, !0;
                    }
                } else t.y = Math.round(.5 * (e.height - t.displayHeight) + this.centerY + t.pivotY * t.scaleY);
                return !1;
            }, i.resetLayout = function () {
                this.owner && (this.resetLayoutX(), this.resetLayoutY());
            }, a(0, i, "centerX", function () {
                return this._centerX;
            }, function (t) {
                this._centerX != t && (this._centerX = t, this.resetLayoutX());
            }), a(0, i, "top", function () {
                return this._top;
            }, function (t) {
                this._top != t && (this._top = t, this.resetLayoutY());
            }), a(0, i, "bottom", function () {
                return this._bottom;
            }, function (t) {
                this._bottom != t && (this._bottom = t, this.resetLayoutY());
            }), a(0, i, "left", function () {
                return this._left;
            }, function (t) {
                this._left != t && (this._left = t, this.resetLayoutX());
            }), a(0, i, "right", function () {
                return this._right;
            }, function (t) {
                this._right != t && (this._right = t, this.resetLayoutX());
            }), a(0, i, "centerY", function () {
                return this._centerY;
            }, function (t) {
                this._centerY != t && (this._centerY = t, this.resetLayoutY());
            }), n(e, ["EMPTY", function () {
                return this.EMPTY = new e();
            }]), e;
        }(u), N = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.ui.UIEvent", t), e.SHOW_TIP = "showtip", e.HIDE_TIP = "hidetip";
        }(d), function (t) {
            function e() {
                this.autoCacheCmd = !0, this._width = 0, this._height = 0, this._source = null,
                    this._sizeGrid = null, this._isChanged = !1, this._offset = null, e.__super.call(this);
            }
            r(e, "laya.ui.AutoBitmap", t);
            var n = e.prototype;
            return n.destroy = function () {
                t.prototype.destroy.call(this), this._source = null, this._sizeGrid = null, this._offset = null;
            }, n._setChanged = function () {
                this._isChanged || (this._isChanged = !0, i.timer.callLater(this, this.changeSource));
            }, n.changeSource = function () {
                this._isChanged = !1;
                var t = this._source;
                if (t && t.bitmap) {
                    var i = this.width, n = this.height, r = this._sizeGrid, a = t.sourceWidth, s = t.sourceHeight;
                    if (!r || a === i && s === n) this.clear(), this.drawTexture(t, this._offset ? this._offset[0] : 0, this._offset ? this._offset[1] : 0, i, n); else {
                        this.clear();
                        var o = r[0], l = r[1], h = r[2], u = r[3], c = r[4], d = !1;
                        if (i == a && (u = l = 0), n == s && (o = h = 0), u + l > i) {
                            var _ = i;
                            d = !0, i = u + l, this.save(), this.clipRect(0, 0, _, n);
                        }
                        u && o && this.drawImage(e.getTexture(t, 0, 0, u, o), 0, 0, u, o), l && o && this.drawImage(e.getTexture(t, a - l, 0, l, o), i - l, 0, l, o),
                            u && h && this.drawImage(e.getTexture(t, 0, s - h, u, h), 0, n - h, u, h), l && h && this.drawImage(e.getTexture(t, a - l, s - h, l, h), i - l, n - h, l, h),
                            o && this.drawBitmap(c, e.getTexture(t, u, 0, a - u - l, o), u, 0, i - u - l, o),
                            h && this.drawBitmap(c, e.getTexture(t, u, s - h, a - u - l, h), u, n - h, i - u - l, h),
                            u && this.drawBitmap(c, e.getTexture(t, 0, o, u, s - o - h), 0, o, u, n - o - h),
                            l && this.drawBitmap(c, e.getTexture(t, a - l, o, l, s - o - h), i - l, o, l, n - o - h),
                            this.drawBitmap(c, e.getTexture(t, u, o, a - u - l, s - o - h), u, o, i - u - l, n - o - h),
                            d && this.restore();
                    }
                    this._repaint();
                }
            }, n.drawBitmap = function (t, e, i, n, r, a) {
                void 0 === r && (r = 0), void 0 === a && (a = 0), r < .1 || a < .1 || (!t || e.width == r && e.height == a ? this.drawImage(e, i, n, r, a) : this.fillTexture(e, i, n, r, a));
            }, a(0, n, "sizeGrid", function () {
                return this._sizeGrid;
            }, function (t) {
                this._sizeGrid = t, this._setChanged();
            }), a(0, n, "width", function () {
                return this._width ? this._width : this._source ? this._source.sourceWidth : 0;
            }, function (t) {
                this._width != t && (this._width = t, this._setChanged());
            }), a(0, n, "height", function () {
                return this._height ? this._height : this._source ? this._source.sourceHeight : 0;
            }, function (t) {
                this._height != t && (this._height = t, this._setChanged());
            }), a(0, n, "source", function () {
                return this._source;
            }, function (t) {
                t ? (this._source = t, this._setChanged()) : (this._source = null, this.clear());
            }), e.getTexture = function (t, e, i, n, r) {
                var a;
                return n <= 0 && (n = 1), r <= 0 && (r = 1), t.$_GID || (t.$_GID = R.getGID()),
                    a && a._getSource() || (a = I.createFromTexture(t, e, i, n, r)), a;
            }, e;
        }(_)), B = function (t) {
            function e() {
                this._dataSource = null, this._toolTip = null, this._tag = null, this._disabled = !1,
                    this._gray = !1, e.__super.call(this), this._anchorX = NaN, this._anchorY = NaN,
                    this._widget = P.EMPTY, this.preinitialize(), this.createChildren(), this.initialize();
            }
            r(e, "laya.ui.UIComponent", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._dataSource = null,
                    this._tag = null, this._toolTip = null;
            }, n.preinitialize = function () { }, n.createChildren = function () { }, n.initialize = function () { },
                n.measureWidth = function () {
                    var t = 0;
                    this.commitMeasure();
                    for (var e = this.numChildren - 1; e > -1; e--) {
                        var i = this.getChildAt(e);
                        i._visible && (t = Math.max(i._x + i.width * i.scaleX, t));
                    }
                    return t;
                }, n.commitMeasure = function () { }, n.measureHeight = function () {
                    var t = 0;
                    this.commitMeasure();
                    for (var e = this.numChildren - 1; e > -1; e--) {
                        var i = this.getChildAt(e);
                        i._visible && (t = Math.max(i._y + i.height * i.scaleY, t));
                    }
                    return t;
                }, n._sizeChanged = function () {
                    isNaN(this._anchorX) || (this.pivotX = this.anchorX * this.width), isNaN(this._anchorY) || (this.pivotY = this.anchorY * this.height),
                        this.event("resize"), this._widget !== P.EMPTY && this._widget.resetLayout();
                }, n.onMouseOver = function (t) {
                    i.stage.event("showtip", this._toolTip);
                }, n.onMouseOut = function (t) {
                    i.stage.event("hidetip", this._toolTip);
                }, n._getWidget = function () {
                    return this._widget === P.EMPTY && (this._widget = this.addComponent(P)), this._widget;
                }, n.onCompResize = function () {
                    this._sizeChanged();
                }, n._childChanged = function (e) {
                    this.callLater(this._sizeChanged), t.prototype._childChanged.call(this, e);
                }, a(0, n, "centerY", function () {
                    return this._widget.centerY;
                }, function (t) {
                    t != this._widget.centerY && (this._getWidget().centerY = t);
                }), a(0, n, "width", function () {
                    return this._width ? this._width : this.measureWidth();
                }, function (t) {
                    i.superGet(x, this, "width") != t && (i.superSet(x, this, "width", t), this.callLater(this._sizeChanged));
                }), a(0, n, "bottom", function () {
                    return this._widget.bottom;
                }, function (t) {
                    t != this._widget.bottom && (this._getWidget().bottom = t);
                }), a(0, n, "height", function () {
                    return this._height ? this._height : this.measureHeight();
                }, function (t) {
                    i.superGet(x, this, "height") != t && (i.superSet(x, this, "height", t), this.callLater(this._sizeChanged));
                }), a(0, n, "left", function () {
                    return this._widget.left;
                }, function (t) {
                    t != this._widget.left && (this._getWidget().left = t);
                }), a(0, n, "dataSource", function () {
                    return this._dataSource;
                }, function (t) {
                    for (var e in this._dataSource = t, this._dataSource) this.hasOwnProperty(e) && "function" != typeof this[e] && (this[e] = this._dataSource[e]);
                }), a(0, n, "centerX", function () {
                    return this._widget.centerX;
                }, function (t) {
                    t != this._widget.centerX && (this._getWidget().centerX = t);
                }), a(0, n, "top", function () {
                    return this._widget.top;
                }, function (t) {
                    t != this._widget.top && (this._getWidget().top = t);
                }), a(0, n, "right", function () {
                    return this._widget.right;
                }, function (t) {
                    t != this._widget.right && (this._getWidget().right = t);
                }), a(0, n, "tag", function () {
                    return this._tag;
                }, function (t) {
                    this._tag = t;
                }), a(0, n, "toolTip", function () {
                    return this._toolTip;
                }, function (t) {
                    this._toolTip != t && (this._toolTip = t, null != t ? (this.on("mouseover", this, this.onMouseOver),
                        this.on("mouseout", this, this.onMouseOut)) : (this.off("mouseover", this, this.onMouseOver),
                            this.off("mouseout", this, this.onMouseOut)));
                }), a(0, n, "gray", function () {
                    return this._gray;
                }, function (t) {
                    t !== this._gray && (this._gray = t, L.gray(this, t));
                }), a(0, n, "disabled", function () {
                    return this._disabled;
                }, function (t) {
                    t !== this._disabled && (this.gray = this._disabled = t, this.mouseEnabled = !t);
                }), a(0, n, "scaleX", t.prototype._$get_scaleX, function (t) {
                    i.superGet(x, this, "scaleX") != t && (i.superSet(x, this, "scaleX", t), this.event("resize"));
                }), a(0, n, "scaleY", t.prototype._$get_scaleY, function (t) {
                    i.superGet(x, this, "scaleY") != t && (i.superSet(x, this, "scaleY", t), this.event("resize"));
                }), a(0, n, "anchorX", function () {
                    return this._anchorX;
                }, function (t) {
                    this._anchorX != t && (this._anchorX = t, this.callLater(this._sizeChanged));
                }), a(0, n, "anchorY", function () {
                    return this._anchorY;
                }, function (t) {
                    this._anchorY != t && (this._anchorY = t, this.callLater(this._sizeChanged));
                }), e;
        }(x), F = function (t) {
            function e() {
                this.lockLayer = null, this.popupEffect = function (t) {
                    t.scale(1, 1), t._effectTween = A.from(t, {
                        x: i.stage.width / 2,
                        y: i.stage.height / 2,
                        scaleX: 0,
                        scaleY: 0
                    }, 300, c.backOut, f.create(this, this.doOpen, [t]), 0, !1, !1);
                }, this.closeEffect = function (t) {
                    t._effectTween = A.to(t, {
                        x: i.stage.width / 2,
                        y: i.stage.height / 2,
                        scaleX: 0,
                        scaleY: 0
                    }, 300, c.strongOut, f.create(this, this.doClose, [t]), 0, !1, !1);
                }, e.__super.call(this), this.maskLayer = new x(), this.popupEffectHandler = new f(this, this.popupEffect),
                    this.closeEffectHandler = new f(this, this.closeEffect), this.mouseEnabled = this.maskLayer.mouseEnabled = !0,
                    this.zOrder = 1e3, i.stage.addChild(this), i.stage.on("resize", this, this._onResize),
                    D.closeDialogOnSide && this.maskLayer.on("click", this, this._closeOnSide), this._onResize(null);
            }
            r(e, "laya.ui.DialogManager", t);
            var n = e.prototype;
            return n._closeOnSide = function () {
                var t = this.getChildAt(this.numChildren - 1);
                t instanceof laya.ui.Dialog && t.close();
            }, n.setLockView = function (t) {
                this.lockLayer || (this.lockLayer = new V(), this.lockLayer.mouseEnabled = !0, this.lockLayer.size(i.stage.width, i.stage.height)),
                    this.lockLayer.removeChildren(), t && (t.centerX = t.centerY = 0, this.lockLayer.addChild(t));
            }, n._onResize = function (t) {
                var e = this.maskLayer.width = i.stage.width, n = this.maskLayer.height = i.stage.height;
                this.lockLayer && this.lockLayer.size(e, n), this.maskLayer.graphics.clear(!0),
                    this.maskLayer.graphics.drawRect(0, 0, e, n, D.popupBgColor), this.maskLayer.alpha = D.popupBgAlpha;
                for (var r = this.numChildren - 1; r > -1; r--) {
                    var a = this.getChildAt(r);
                    a.isPopupCenter && this._centerDialog(a);
                }
            }, n._centerDialog = function (t) {
                t.x = Math.round((i.stage.width - t.width >> 1) + t.pivotX), t.y = Math.round((i.stage.height - t.height >> 1) + t.pivotY);
            }, n.open = function (t, e, n) {
                void 0 === e && (e = !1), void 0 === n && (n = !1), e && this._closeAll(), this._clearDialogEffect(t),
                    t.isPopupCenter && this._centerDialog(t), this.addChild(t), (t.isModal || this._getBit(32)) && i.timer.callLater(this, this._checkMask),
                    n && null != t.popupEffect ? t.popupEffect.runWith(t) : this.doOpen(t), this.event("open");
            }, n._clearDialogEffect = function (t) {
                t._effectTween && (A.clear(t._effectTween), t._effectTween = null);
            }, n.doOpen = function (t) {
                t.onOpened(t._param);
            }, n.lock = function (t) {
                this.lockLayer && (t ? this.addChild(this.lockLayer) : this.lockLayer.removeSelf());
            }, n.close = function (t) {
                this._clearDialogEffect(t), t.isShowEffect && null != t.closeEffect ? t.closeEffect.runWith([t]) : this.doClose(t),
                    this.event("close");
            }, n.doClose = function (t) {
                t.removeSelf(), t.isModal && this._checkMask(), t.closeHandler && t.closeHandler.runWith(t.closeType),
                    t.onClosed(t.closeType), t.autoDestroyAtClosed && t.destroy();
            }, n.closeAll = function () {
                this._closeAll(), this.event("close");
            }, n._closeAll = function () {
                for (var t = this.numChildren - 1; t > -1; t--) {
                    var e = this.getChildAt(t);
                    e && null != e.close && this.doClose(e);
                }
            }, n.getDialogsByGroup = function (t) {
                for (var e = [], i = this.numChildren - 1; i > -1; i--) {
                    var n = this.getChildAt(i);
                    n && n.group === t && e.push(n);
                }
                return e;
            }, n.closeByGroup = function (t) {
                for (var e = [], i = this.numChildren - 1; i > -1; i--) {
                    var n = this.getChildAt(i);
                    n && n.group === t && (n.close(), e.push(n));
                }
                return e;
            }, n._checkMask = function () {
                this.maskLayer.removeSelf();
                for (var t = this.numChildren - 1; t > -1; t--) {
                    var e = this.getChildAt(t);
                    if (e && e.isModal) return void this.addChildAt(this.maskLayer, t);
                }
            }, e;
        }(x), k = function (t) {
            function e() {
                this._watchMap = {}, this._widget = null, this._dataSource = null, this._anchorX = NaN,
                    this._anchorY = NaN, this._widget = P.EMPTY, e.__super.call(this);
            }
            r(e, "laya.ui.View", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), this._watchMap = null, t.prototype.destroy.call(this, e);
            }, n.changeData = function (t) {
                var e = this._watchMap[t];
                if (e) for (var i = 0, n = e.length; i < n; i++) {
                    e[i].exe(this);
                }
            }, n._sizeChanged = function () {
                isNaN(this._anchorX) || (this.pivotX = this.anchorX * this.width), isNaN(this._anchorY) || (this.pivotY = this.anchorY * this.height),
                    this.event("resize");
            }, n._getWidget = function () {
                return this._widget === P.EMPTY && (this._widget = this.addComponent(P)), this._widget;
            }, n.loadUI = function (t) {
                var i = e.uiMap[t];
                e.uiMap && this.createView(i);
            }, a(0, n, "anchorX", function () {
                return this._anchorX;
            }, function (t) {
                this._anchorX != t && (this._anchorX = t, this.callLater(this._sizeChanged));
            }), a(0, n, "centerX", function () {
                return this._widget.centerX;
            }, function (t) {
                t != this._widget.centerX && (this._getWidget().centerX = t);
            }), a(0, n, "top", function () {
                return this._widget.top;
            }, function (t) {
                t != this._widget.top && (this._getWidget().top = t);
            }), a(0, n, "bottom", function () {
                return this._widget.bottom;
            }, function (t) {
                t != this._widget.bottom && (this._getWidget().bottom = t);
            }), a(0, n, "dataSource", function () {
                return this._dataSource;
            }, function (t) {
                for (var e in this._dataSource = t, t) {
                    var i = this.getChildByName(e);
                    i instanceof laya.ui.UIComponent ? i.dataSource = t[e] : this.hasOwnProperty(e) && "function" != typeof this[e] && (this[e] = t[e]);
                }
            }), a(0, n, "left", function () {
                return this._widget.left;
            }, function (t) {
                t != this._widget.left && (this._getWidget().left = t);
            }), a(0, n, "right", function () {
                return this._widget.right;
            }, function (t) {
                t != this._widget.right && (this._getWidget().right = t);
            }), a(0, n, "anchorY", function () {
                return this._anchorY;
            }, function (t) {
                this._anchorY != t && (this._anchorY = t, this.callLater(this._sizeChanged));
            }), a(0, n, "centerY", function () {
                return this._widget.centerY;
            }, function (t) {
                t != this._widget.centerY && (this._getWidget().centerY = t);
            }), e.regComponent = function (t, e) {
                l.regClass(t, e);
            }, e.regViewRuntime = function (t, e) {
                l.regClass(t, e);
            }, e.regUI = function (t, e) {
                i.loader.cacheRes(t, e);
            }, e.uiMap = {}, e.__init$ = function () {
                l.regShortClassName([Q, U, pt, W, V, at, U, tt, j, H, B, ut, ct, G, z, nt, it, X, st, _t, Y, q, mt, rt, e, Z, lt, ht, et, dt, ft, x, s, b, ot]);
            }, e;
        }(E), V = (function (e) {
            function n() {
                this._$4__texture = null, n.__super.call(this), this._width = this._height = 200;
                var t = new I();
                if (!i.Texture2D) throw new Error("WXOpenDataViewer:webgl not found!");
                t.bitmap = new i.Texture2D(), this.texture = t;
            }
            r(n, "laya.ui.WXOpenDataViewer", e);
            var s = n.prototype;
            s.onEnable = function () {
                this.postMsg({
                    type: "display",
                    rate: i.stage.frameRate
                }), t.wx && t.sharedCanvas && i.timer.frameLoop(1, this, this._onLoop);
            }, s.onDisable = function () {
                this.postMsg({
                    type: "undisplay"
                }), i.timer.clear(this, this._onLoop);
            }, s._onLoop = function () {
                this.texture.bitmap.loadImageSource(t.sharedCanvas);
            }, s._postMsg = function () {
                var t = new v();
                t.translate(this.x, this.y);
                var e = i.stage;
                t.scale(e._canvasTransform.getScaleX() * this.globalScaleX * e.transform.getScaleX(), e._canvasTransform.getScaleY() * this.globalScaleY * e.transform.getScaleY()),
                    this.postMsg({
                        type: "changeMatrix",
                        a: t.a,
                        b: t.b,
                        c: t.c,
                        d: t.d,
                        tx: t.tx,
                        ty: t.ty,
                        w: this.width,
                        h: this.height
                    });
            }, s.postMsg = function (e) {
                t.wx && t.wx.getOpenDataContext && t.wx.getOpenDataContext().postMessage(e);
            }, a(0, s, "x", e.prototype._$get_x, function (t) {
                i.superSet(B, this, "x", t), this.callLater(this._postMsg);
            }), a(0, s, "width", e.prototype._$get_width, function (e) {
                i.superSet(B, this, "width", e), t.sharedCanvas && (t.sharedCanvas.width = e), this.callLater(this._postMsg);
            }), a(0, s, "height", e.prototype._$get_height, function (e) {
                i.superSet(B, this, "height", e), t.sharedCanvas && (t.sharedCanvas.height = e),
                    this.callLater(this._postMsg);
            }), a(0, s, "y", e.prototype._$get_y, function (t) {
                i.superSet(B, this, "y", t), this.callLater(this._postMsg);
            });
        }(B), function (t) {
            function e() {
                this._bgColor = null, e.__super.call(this);
            }
            r(e, "laya.ui.Box", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.ui.IBox": !0
            }), n._onResize = function (t) {
                this.graphics.clear(), this.graphics.drawRect(0, 0, this.width, this.height, this._bgColor);
            }, a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                for (var e in this._dataSource = t, t) {
                    var i = this.getChildByName(e);
                    i ? i.dataSource = t[e] : this.hasOwnProperty(e) && "function" != typeof this[e] && (this[e] = t[e]);
                }
            }), a(0, n, "bgColor", function () {
                return this._bgColor;
            }, function (t) {
                this._bgColor = t, t ? (this._onResize(null), this.on("resize", this, this._onResize)) : (this.graphics.clear(),
                    this.off("resize", this, this._onResize));
            }), e;
        }(B)), U = function (t) {
            function e(t, i) {
                this.toggle = !1, this._bitmap = null, this._text = null, this._strokeColors = null,
                    this._state = 0, this._selected = !1, this._skin = null, this._autoSize = !0, this._sources = null,
                    this._clickHandler = null, this._stateChanged = !1, e.__super.call(this), this._labelColors = O.buttonLabelColors,
                    this._stateNum = O.buttonStateNum, void 0 === i && (i = ""), this.skin = t, this.label = i;
            }
            r(e, "laya.ui.Button", t);
            var s = e.prototype;
            return i.imps(s, {
                "laya.ui.ISelect": !0
            }), s.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._bitmap && this._bitmap.destroy(),
                    this._text && this._text.destroy(e), this._bitmap = null, this._text = null, this._clickHandler = null,
                    this._labelColors = this._sources = this._strokeColors = null;
            }, s.createChildren = function () {
                this.graphics = this._bitmap = new N();
            }, s.createText = function () {
                this._text || (this._text = new b(), this._text.overflow = "hidden", this._text.align = "center",
                    this._text.valign = "middle", this._text.width = this._width, this._text.height = this._height);
            }, s.initialize = function () {
                1 !== this._mouseState && (this.mouseEnabled = !0, this._setBit(64, !0)), this._createListener("mouseover", this, this.onMouse, null, !1, !1),
                    this._createListener("mouseout", this, this.onMouse, null, !1, !1), this._createListener("mousedown", this, this.onMouse, null, !1, !1),
                    this._createListener("mouseup", this, this.onMouse, null, !1, !1), this._createListener("click", this, this.onMouse, null, !1, !1);
            }, s.onMouse = function (t) {
                if (!1 !== this.toggle || !this._selected) return "click" === t.type ? (this.toggle && (this.selected = !this._selected),
                    void (this._clickHandler && this._clickHandler.run())) : void (!this._selected && (this.state = e.stateMap[t.type]));
            }, s._skinLoaded = function () {
                this.callLater(this.changeClips), this._setStateChanged(), this._sizeChanged(),
                    this.event("loaded");
            }, s.changeClips = function () {
                var t = g.getRes(this._skin);
                if (t) {
                    var e = t.sourceWidth, i = t.sourceHeight / this._stateNum;
                    t.$_GID || (t.$_GID = R.getGID());
                    var n = t.$_GID + "-" + this._stateNum, r = M.I.get(n);
                    if (R.isOkTextureList(r) || (r = null), r) this._sources = r; else {
                        if (this._sources = [], 1 === this._stateNum) this._sources.push(t); else for (var a = 0; a < this._stateNum; a++) this._sources.push(I.createFromTexture(t, 0, i * a, e, i));
                        M.I.set(n, this._sources);
                    }
                    this._autoSize ? (this._bitmap.width = this._width || e, this._bitmap.height = this._height || i,
                        this._text && (this._text.width = this._bitmap.width, this._text.height = this._bitmap.height)) : this._text && (this._text.x = e);
                } else console.log("lose skin", this._skin);
            }, s.measureWidth = function () {
                return this.runCallLater(this.changeClips), this._autoSize ? this._bitmap.width : (this.runCallLater(this.changeState),
                    this._bitmap.width + (this._text ? this._text.width : 0));
            }, s.measureHeight = function () {
                return this.runCallLater(this.changeClips), this._text ? Math.max(this._bitmap.height, this._text.height) : this._bitmap.height;
            }, s.changeState = function () {
                this._stateChanged = !1, this.runCallLater(this.changeClips);
                var t = this._state < this._stateNum ? this._state : this._stateNum - 1;
                this._sources && (this._bitmap.source = this._sources[t]), this.label && (this._text.color = this._labelColors[t],
                    this._strokeColors && (this._text.strokeColor = this._strokeColors[t]));
            }, s._setStateChanged = function () {
                this._stateChanged || (this._stateChanged = !0, this.callLater(this.changeState));
            }, a(0, s, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, t ? g.getRes(t) ? this._skinLoaded() : i.loader.load(this._skin, f.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded());
            }), a(0, s, "labelPadding", function () {
                return this.createText(), this._text.padding.join(",");
            }, function (t) {
                this.createText(), this._text.padding = L.fillArray(O.labelPadding, t, Number);
            }), a(0, s, "state", function () {
                return this._state;
            }, function (t) {
                this._state != t && (this._state = t, this._setStateChanged());
            }), a(0, s, "text", function () {
                return this.createText(), this._text;
            }), a(0, s, "stateNum", function () {
                return this._stateNum;
            }, function (t) {
                "string" == typeof t && (t = parseInt(t)), this._stateNum != t && (this._stateNum = t < 1 ? 1 : t > 3 ? 3 : t,
                    this.callLater(this.changeClips));
            }), a(0, s, "label", function () {
                return this._text ? this._text.text : null;
            }, function (t) {
                (this._text || t) && (this.createText(), this._text.text != t && (t && !this._text.parent && this.addChild(this._text),
                    this._text.text = (t + "").replace(/\\n/g, "\n"), this._setStateChanged()));
            }), a(0, s, "labelSize", function () {
                return this.createText(), this._text.fontSize;
            }, function (t) {
                this.createText(), this._text.fontSize = t;
            }), a(0, s, "selected", function () {
                return this._selected;
            }, function (t) {
                this._selected != t && (this._selected = t, this.state = this._selected ? 2 : 0,
                    this.event("change"));
            }), a(0, s, "strokeColors", function () {
                return this._strokeColors ? this._strokeColors.join(",") : "";
            }, function (t) {
                this._strokeColors = L.fillArray(O.buttonLabelColors, t, String), this._setStateChanged();
            }), a(0, s, "labelColors", function () {
                return this._labelColors.join(",");
            }, function (t) {
                this._labelColors = L.fillArray(O.buttonLabelColors, t, String), this._setStateChanged();
            }), a(0, s, "labelStroke", function () {
                return this.createText(), this._text.stroke;
            }, function (t) {
                this.createText(), this._text.stroke = t;
            }), a(0, s, "labelStrokeColor", function () {
                return this.createText(), this._text.strokeColor;
            }, function (t) {
                this.createText(), this._text.strokeColor = t;
            }), a(0, s, "labelBold", function () {
                return this.createText(), this._text.bold;
            }, function (t) {
                this.createText(), this._text.bold = t;
            }), a(0, s, "labelFont", function () {
                return this.createText(), this._text.font;
            }, function (t) {
                this.createText(), this._text.font = t;
            }), a(0, s, "labelAlign", function () {
                return this.createText(), this._text.align;
            }, function (t) {
                this.createText(), this._text.align = t;
            }), a(0, s, "clickHandler", function () {
                return this._clickHandler;
            }, function (t) {
                this._clickHandler = t;
            }), a(0, s, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null;
            }, function (t) {
                this._bitmap.sizeGrid = L.fillArray(O.defaultSizeGrid, t, Number);
            }), a(0, s, "width", t.prototype._$get_width, function (t) {
                i.superSet(B, this, "width", t), this._autoSize && (this._bitmap.width = t, this._text && (this._text.width = t));
            }), a(0, s, "height", t.prototype._$get_height, function (t) {
                i.superSet(B, this, "height", t), this._autoSize && (this._bitmap.height = t, this._text && (this._text.height = t));
            }), a(0, s, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t || "string" == typeof t ? this.label = t + "" : i.superSet(B, this, "dataSource", t);
            }), a(0, s, "iconOffset", function () {
                return this._bitmap._offset ? this._bitmap._offset.join(",") : null;
            }, function (t) {
                this._bitmap._offset = t ? L.fillArray([1, 1], t, Number) : [];
            }), n(e, ["stateMap", function () {
                return this.stateMap = {
                    mouseup: 0,
                    mouseover: 1,
                    mousedown: 2,
                    mouseout: 0
                };
            }]), e;
        }(B), G = function (t) {
            function e(t) {
                this._bitmap = null, this._skin = null, this._group = null, e.__super.call(this),
                    this.skin = t;
            }
            r(e, "laya.ui.Image", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, !0), this._bitmap && this._bitmap.destroy(),
                    this._bitmap = null;
            }, n.dispose = function () {
                this.destroy(!0), i.loader.clearRes(this._skin);
            }, n.createChildren = function () {
                this.graphics = this._bitmap = new N(), this._bitmap.autoCacheCmd = !1;
            }, n.setSource = function (t, e) {
                t === this._skin && e && (this.source = e, this.onCompResize());
            }, n.measureWidth = function () {
                return this._bitmap.width;
            }, n.measureHeight = function () {
                return this._bitmap.height;
            }, a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "string" == typeof t ? this.skin = t : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "source", function () {
                return this._bitmap.source;
            }, function (t) {
                this._bitmap && (this._bitmap.source = t, this.event("loaded"), this.repaint());
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                if (this._skin != t) if (this._skin = t, t) {
                    var e = g.getRes(t);
                    e ? (this.source = e, this.onCompResize()) : i.loader.load(this._skin, f.create(this, this.setSource, [this._skin]), null, "image", 1, !0, this._group);
                } else this.source = null;
            }), a(0, n, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null;
            }, function (t) {
                this._bitmap.sizeGrid = L.fillArray(O.defaultSizeGrid, t, Number);
            }), a(0, n, "group", function () {
                return this._group;
            }, function (t) {
                t && this._skin && g.setGroup(this._skin, t), this._group = t;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(B, this, "width", t), this._bitmap.width = 0 == t ? 1e-7 : t;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(B, this, "height", t), this._bitmap.height = 0 == t ? 1e-7 : t;
            }), e;
        }(B), z = function (t) {
            function e(t) {
                this._tf = null, e.__super.call(this), void 0 === t && (t = ""), this.text = t;
            }
            r(e, "laya.ui.Label", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._tf = null;
            }, n.createChildren = function () {
                this.addChild(this._tf = new b());
            }, n.changeText = function (t) {
                this._tf.changeText(t);
            }, n.measureWidth = function () {
                return this._tf.width;
            }, n.measureHeight = function () {
                return this._tf.height;
            }, a(0, n, "padding", function () {
                return this._tf.padding.join(",");
            }, function (t) {
                this._tf.padding = L.fillArray(O.labelPadding, t, Number);
            }), a(0, n, "bold", function () {
                return this._tf.bold;
            }, function (t) {
                this._tf.bold = t;
            }), a(0, n, "align", function () {
                return this._tf.align;
            }, function (t) {
                this._tf.align = t;
            }), a(0, n, "text", function () {
                return this._tf.text;
            }, function (t) {
                this._tf.text != t && (t && (t = L.adptString(t + "")), this._tf.text = t, this.event("change"),
                    this._width && this._height || this.onCompResize());
            }), a(0, n, "italic", function () {
                return this._tf.italic;
            }, function (t) {
                this._tf.italic = t;
            }), a(0, n, "wordWrap", function () {
                return this._tf.wordWrap;
            }, function (t) {
                this._tf.wordWrap = t;
            }), a(0, n, "font", function () {
                return this._tf.font;
            }, function (t) {
                this._tf.font = t;
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t || "string" == typeof t ? this.text = t + "" : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "color", function () {
                return this._tf.color;
            }, function (t) {
                this._tf.color = t;
            }), a(0, n, "valign", function () {
                return this._tf.valign;
            }, function (t) {
                this._tf.valign = t;
            }), a(0, n, "leading", function () {
                return this._tf.leading;
            }, function (t) {
                this._tf.leading = t;
            }), a(0, n, "fontSize", function () {
                return this._tf.fontSize;
            }, function (t) {
                this._tf.fontSize = t;
            }), a(0, n, "bgColor", function () {
                return this._tf.bgColor;
            }, function (t) {
                this._tf.bgColor = t;
            }), a(0, n, "borderColor", function () {
                return this._tf.borderColor;
            }, function (t) {
                this._tf.borderColor = t;
            }), a(0, n, "stroke", function () {
                return this._tf.stroke;
            }, function (t) {
                this._tf.stroke = t;
            }), a(0, n, "strokeColor", function () {
                return this._tf.strokeColor;
            }, function (t) {
                this._tf.strokeColor = t;
            }), a(0, n, "textField", function () {
                return this._tf;
            }), a(0, n, "width", function () {
                return this._width || this._tf.text ? i.superGet(B, this, "width") : 0;
            }, function (t) {
                i.superSet(B, this, "width", t), this._tf.width = t;
            }), a(0, n, "height", function () {
                return this._height || this._tf.text ? i.superGet(B, this, "height") : 0;
            }, function (t) {
                i.superSet(B, this, "height", t), this._tf.height = t;
            }), a(0, n, "overflow", function () {
                return this._tf.overflow;
            }, function (t) {
                this._tf.overflow = t;
            }), a(0, n, "underline", function () {
                return this._tf.underline;
            }, function (t) {
                this._tf.underline = t;
            }), a(0, n, "underlineColor", function () {
                return this._tf.underlineColor;
            }, function (t) {
                this._tf.underlineColor = t;
            }), e;
        }(B), H = function (t) {
            function e(t, i) {
                this._visibleNum = 6, this._button = null, this._list = null, this._isOpen = !1,
                    this._itemSize = 12, this._labels = [], this._selectedIndex = -1, this._selectHandler = null,
                    this._itemHeight = NaN, this._listHeight = NaN, this._listChanged = !1, this._itemChanged = !1,
                    this._scrollBarSkin = null, this._isCustomList = !1, this.itemRender = null, e.__super.call(this),
                    this._itemColors = O.comboBoxItemColors, this.skin = t, this.labels = i;
            }
            r(e, "laya.ui.ComboBox", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._button && this._button.destroy(e),
                    this._list && this._list.destroy(e), this._button = null, this._list = null, this._itemColors = null,
                    this._labels = null, this._selectHandler = null;
            }, n.createChildren = function () {
                this.addChild(this._button = new U()), this._button.text.align = "left", this._button.labelPadding = "0,0,0,5",
                    this._button.on("mousedown", this, this.onButtonMouseDown);
            }, n._createList = function () {
                this._list = new nt(), this._scrollBarSkin && (this._list.vScrollBarSkin = this._scrollBarSkin),
                    this._setListEvent(this._list);
            }, n._setListEvent = function (t) {
                this._list.selectEnable = !0, this._list.on("mousedown", this, this.onListDown),
                    this._list.mouseHandler = f.create(this, this.onlistItemMouse, null, !1), this._list.scrollBar && this._list.scrollBar.on("mousedown", this, this.onScrollBarDown);
            }, n.onListDown = function (t) {
                t.stopPropagation();
            }, n.onScrollBarDown = function (t) {
                t.stopPropagation();
            }, n.onButtonMouseDown = function (t) {
                this.callLater(this.switchTo, [!this._isOpen]);
            }, n.measureWidth = function () {
                return this._button.width;
            }, n.measureHeight = function () {
                return this._button.height;
            }, n.changeList = function () {
                this._listChanged = !1;
                var t = this.width - 2, e = this._itemColors[2];
                this._itemHeight = this._itemSize + 6, this._list.itemRender = this.itemRender || {
                    type: "Box",
                    child: [{
                        type: "Label",
                        props: {
                            name: "label",
                            x: 1,
                            padding: "3,3,3,3",
                            width: t,
                            height: this._itemHeight,
                            fontSize: this._itemSize,
                            color: e
                        }
                    }]
                }, this._list.repeatY = this._visibleNum, this._list.refresh();
            }, n.onlistItemMouse = function (t, e) {
                var i = t.type;
                if ("mouseover" === i || "mouseout" === i) {
                    if (this._isCustomList) return;
                    var n = this._list.getCell(e);
                    if (!n) return;
                    var r = n.getChildByName("label");
                    r && ("mouseover" === i ? (r.bgColor = this._itemColors[0], r.color = this._itemColors[1]) : (r.bgColor = null,
                        r.color = this._itemColors[2]));
                } else "click" === i && (this.selectedIndex = e, this.isOpen = !1);
            }, n.switchTo = function (t) {
                this.isOpen = t;
            }, n.changeOpen = function () {
                this.isOpen = !this._isOpen;
            }, n.changeItem = function () {
                if (this._itemChanged = !1, this._listHeight = this._labels.length > 0 ? Math.min(this._visibleNum, this._labels.length) * this._itemHeight : this._itemHeight,
                    !this._isCustomList) {
                    var t = this._list.graphics;
                    t.clear(!0), t.drawRect(0, 0, this.width - 1, this._listHeight, this._itemColors[4], this._itemColors[3]);
                }
                var e = this._list.array || [];
                e.length = 0;
                for (var i = 0, n = this._labels.length; i < n; i++) e.push({
                    label: this._labels[i]
                });
                this._list.height = this._listHeight, this._list.array = e;
            }, n.changeSelected = function () {
                this._button.label = this.selectedLabel;
            }, n._onStageMouseWheel = function (t) {
                this._list && !this._list.contains(t.target) && this.removeList(null);
            }, n.removeList = function (t) {
                i.stage.off("mousedown", this, this.removeList), i.stage.off("mousewheel", this, this._onStageMouseWheel),
                    this.isOpen = !1;
            }, a(0, n, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                this._selectedIndex != t && (this._selectedIndex = t, this._labels.length > 0 ? this.changeSelected() : this.callLater(this.changeSelected),
                    this.event("change", [d.EMPTY.setTo("change", this, this)]), this._selectHandler && this._selectHandler.runWith(this._selectedIndex));
            }), a(0, n, "skin", function () {
                return this._button.skin;
            }, function (t) {
                this._button.skin != t && (this._button.skin = t, this._listChanged = !0);
            }), a(0, n, "visibleNum", function () {
                return this._visibleNum;
            }, function (t) {
                this._visibleNum = t, this._listChanged = !0;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(B, this, "width", t), this._button.width = this._width, this._itemChanged = !0,
                    this._listChanged = !0;
            }), a(0, n, "selectedLabel", function () {
                return this._selectedIndex > -1 && this._selectedIndex < this._labels.length ? this._labels[this._selectedIndex] : null;
            }, function (t) {
                this.selectedIndex = this._labels.indexOf(t);
            }), a(0, n, "labels", function () {
                return this._labels.join(",");
            }, function (t) {
                this._labels.length > 0 && (this.selectedIndex = -1), t ? this._labels = t.split(",") : this._labels.length = 0,
                    this._itemChanged = !0;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(B, this, "height", t), this._button.height = this._height;
            }), a(0, n, "selectHandler", function () {
                return this._selectHandler;
            }, function (t) {
                this._selectHandler = t;
            }), a(0, n, "labelBold", function () {
                return this._button.text.bold;
            }, function (t) {
                this._button.text.bold = t;
            }), a(0, n, "itemColors", function () {
                return String(this._itemColors);
            }, function (t) {
                this._itemColors = L.fillArray(this._itemColors, t, String), this._listChanged = !0;
            }), a(0, n, "itemSize", function () {
                return this._itemSize;
            }, function (t) {
                this._itemSize = t, this._listChanged = !0;
            }), a(0, n, "scrollBar", function () {
                return this.list.scrollBar;
            }), a(0, n, "isOpen", function () {
                return this._isOpen;
            }, function (t) {
                if (this._isOpen != t) if (this._isOpen = t, this._button.selected = this._isOpen,
                    this._isOpen) {
                    this._list || this._createList(), this._listChanged && !this._isCustomList && this.changeList(),
                        this._itemChanged && this.changeItem();
                    var e = this.localToGlobal(S.TEMP.setTo(0, 0)), n = e.y + this._button.height;
                    n = n + this._listHeight <= i.stage.height ? n : e.y - this._listHeight, this._list.pos(e.x, n),
                        this._list.zOrder = 1001, i._currentStage.addChild(this._list), i.stage.once("mousedown", this, this.removeList),
                        i.stage.on("mousewheel", this, this._onStageMouseWheel), this._list.selectedIndex = this._selectedIndex;
                } else this._list && this._list.removeSelf();
            }), a(0, n, "scrollBarSkin", function () {
                return this._scrollBarSkin;
            }, function (t) {
                this._scrollBarSkin = t;
            }), a(0, n, "sizeGrid", function () {
                return this._button.sizeGrid;
            }, function (t) {
                this._button.sizeGrid = t;
            }), a(0, n, "button", function () {
                return this._button;
            }), a(0, n, "list", function () {
                return this._list || this._createList(), this._list;
            }, function (t) {
                t && (t.removeSelf(), this._isCustomList = !0, this._list = t, this._setListEvent(t),
                    this._itemHeight = t.getCell(0).height + t.spaceY);
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.labels = t.join(",") : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "labelColors", function () {
                return this._button.labelColors;
            }, function (t) {
                this._button.labelColors != t && (this._button.labelColors = t);
            }), a(0, n, "labelPadding", function () {
                return this._button.text.padding.join(",");
            }, function (t) {
                this._button.text.padding = L.fillArray(O.labelPadding, t, Number);
            }), a(0, n, "labelSize", function () {
                return this._button.text.fontSize;
            }, function (t) {
                this._button.text.fontSize = t;
            }), a(0, n, "labelFont", function () {
                return this._button.text.font;
            }, function (t) {
                this._button.text.font = t;
            }), a(0, n, "stateNum", function () {
                return this._button.stateNum;
            }, function (t) {
                this._button.stateNum = t;
            }), e;
        }(B), j = (function (t) {
            function e() {
                this._tipBox = null, this._tipText = null, this._defaultTipHandler = null, e.__super.call(this),
                    this._tipBox = new B(), this._tipBox.addChild(this._tipText = new b()), this._tipText.x = this._tipText.y = 5,
                    this._tipText.color = e.tipTextColor, this._defaultTipHandler = this._showDefaultTip,
                    i.stage.on("showtip", this, this._onStageShowTip), i.stage.on("hidetip", this, this._onStageHideTip),
                    this.zOrder = 1100;
            }
            r(e, "laya.ui.TipManager", t);
            var n = e.prototype;
            n._onStageHideTip = function (t) {
                i.timer.clear(this, this._showTip), this.closeAll(), this.removeSelf();
            }, n._onStageShowTip = function (t) {
                i.timer.once(e.tipDelay, this, this._showTip, [t], !0);
            }, n._showTip = function (t) {
                if ("string" == typeof t) {
                    var e = String(t);
                    Boolean(e) && this._defaultTipHandler(e);
                } else t instanceof laya.utils.Handler ? t.run() : "function" == typeof t && t.apply();
                i.stage.on("mousemove", this, this._onStageMouseMove), i.stage.on("mousedown", this, this._onStageMouseDown),
                    this._onStageMouseMove(null);
            }, n._onStageMouseDown = function (t) {
                this.closeAll();
            }, n._onStageMouseMove = function (t) {
                this._showToStage(this, e.offsetX, e.offsetY);
            }, n._showToStage = function (t, e, n) {
                void 0 === e && (e = 0), void 0 === n && (n = 0);
                var r = t.getBounds();
                t.x = i.stage.mouseX + e, t.y = i.stage.mouseY + n, t._x + r.width > i.stage.width && (t.x -= r.width + e),
                    t._y + r.height > i.stage.height && (t.y -= r.height + n);
            }, n.closeAll = function () {
                i.timer.clear(this, this._showTip), i.stage.off("mousemove", this, this._onStageMouseMove),
                    i.stage.off("mousedown", this, this._onStageMouseDown), this.removeChildren();
            }, n.showDislayTip = function (t) {
                this.addChild(t), this._showToStage(this), i._currentStage.addChild(this);
            }, n._showDefaultTip = function (t) {
                this._tipText.text = t;
                var n = this._tipBox.graphics;
                n.clear(!0), n.drawRect(0, 0, this._tipText.width + 10, this._tipText.height + 10, e.tipBackColor),
                    this.addChild(this._tipBox), this._showToStage(this), i._currentStage.addChild(this);
            }, a(0, n, "defaultTipHandler", function () {
                return this._defaultTipHandler;
            }, function (t) {
                this._defaultTipHandler = t;
            }), e.offsetX = 10, e.offsetY = 15, e.tipTextColor = "#ffffff", e.tipBackColor = "#111111",
                e.tipDelay = 200;
        }(B), function (t) {
            function e(t, i, n) {
                this._sources = null, this._bitmap = null, this._skin = null, this._clipX = 1, this._clipY = 1,
                    this._clipWidth = 0, this._clipHeight = 0, this._autoPlay = !1, this._interval = 50,
                    this._complete = null, this._isPlaying = !1, this._index = 0, this._clipChanged = !1,
                    this._group = null, this._toIndex = -1, e.__super.call(this), void 0 === i && (i = 1),
                    void 0 === n && (n = 1), this._clipX = i, this._clipY = n, this.skin = t;
            }
            r(e, "laya.ui.Clip", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, !0), this._bitmap && this._bitmap.destroy(),
                    this._bitmap = null, this._sources = null;
            }, n.dispose = function () {
                this.destroy(!0), i.loader.clearRes(this._skin);
            }, n.createChildren = function () {
                this.graphics = this._bitmap = new N();
            }, n._onDisplay = function (t) {
                this._isPlaying ? this._getBit(128) ? this.play() : this.stop() : this._autoPlay && this.play();
            }, n._skinLoaded = function () {
                this._setClipChanged(), this._sizeChanged(), this.event("loaded");
            }, n.changeClip = function () {
                if (this._clipChanged = !1, this._skin) {
                    var t = g.getRes(this._skin);
                    t ? this.loadComplete(this._skin, t) : i.loader.load(this._skin, f.create(this, this.loadComplete, [this._skin]));
                }
            }, n.loadComplete = function (t, e) {
                if (t === this._skin && e) {
                    var i = this._clipWidth || Math.ceil(e.sourceWidth / this._clipX), n = this._clipHeight || Math.ceil(e.sourceHeight / this._clipY), r = this._skin + i + n, a = M.I.get(r);
                    if (R.isOkTextureList(a) || (a = null), a) this._sources = a; else {
                        this._sources = [];
                        for (var s = 0; s < this._clipY; s++) for (var o = 0; o < this._clipX; o++) this._sources.push(I.createFromTexture(e, i * o, n * s, i, n));
                        M.I.set(r, this._sources);
                    }
                    this.index = this._index, this.event("loaded"), this.onCompResize();
                }
            }, n.measureWidth = function () {
                return this.runCallLater(this.changeClip), this._bitmap.width;
            }, n.measureHeight = function () {
                return this.runCallLater(this.changeClip), this._bitmap.height;
            }, n.play = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), this._isPlaying = !0, this.index = t,
                    this._toIndex = e, this._index++, i.timer.loop(this.interval, this, this._loop),
                    this.on("display", this, this._onDisplay), this.on("undisplay", this, this._onDisplay);
            }, n._loop = function () {
                this._visible && this._sources && (this._index++, this._toIndex > -1 && this._index >= this._toIndex ? this.stop() : this._index >= this._sources.length && (this._index = 0),
                    this.index = this._index);
            }, n.stop = function () {
                this._isPlaying = !1, i.timer.clear(this, this._loop), this.event("complete");
            }, n._setClipChanged = function () {
                this._clipChanged || (this._clipChanged = !0, this.callLater(this.changeClip));
            }, a(0, n, "interval", function () {
                return this._interval;
            }, function (t) {
                this._interval != t && (this._interval = t, this._isPlaying && this.play());
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, t ? g.getRes(t) ? this._skinLoaded() : i.loader.load(this._skin, f.create(this, this._skinLoaded), null, "image", 1) : this._bitmap.source = null);
            }), a(0, n, "sources", function () {
                return this._sources;
            }, function (t) {
                this._sources = t, this.index = this._index, this.event("loaded");
            }), a(0, n, "clipX", function () {
                return this._clipX;
            }, function (t) {
                this._clipX = t || 1, this._setClipChanged();
            }), a(0, n, "clipY", function () {
                return this._clipY;
            }, function (t) {
                this._clipY = t || 1, this._setClipChanged();
            }), a(0, n, "total", function () {
                return this.runCallLater(this.changeClip), this._sources ? this._sources.length : 0;
            }), a(0, n, "clipWidth", function () {
                return this._clipWidth;
            }, function (t) {
                this._clipWidth = t, this._setClipChanged();
            }), a(0, n, "sizeGrid", function () {
                return this._bitmap.sizeGrid ? this._bitmap.sizeGrid.join(",") : null;
            }, function (t) {
                this._bitmap.sizeGrid = L.fillArray(O.defaultSizeGrid, t, Number);
            }), a(0, n, "group", function () {
                return this._group;
            }, function (t) {
                t && this._skin && g.setGroup(this._skin, t), this._group = t;
            }), a(0, n, "clipHeight", function () {
                return this._clipHeight;
            }, function (t) {
                this._clipHeight = t, this._setClipChanged();
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(B, this, "width", t), this._bitmap.width = t;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(B, this, "height", t), this._bitmap.height = t;
            }), a(0, n, "index", function () {
                return this._index;
            }, function (t) {
                this._index = t, this._bitmap && this._sources && (this._bitmap.source = this._sources[t]),
                    this.event("change");
            }), a(0, n, "autoPlay", function () {
                return this._autoPlay;
            }, function (t) {
                this._autoPlay != t && (this._autoPlay = t, t ? this.play() : this.stop());
            }), a(0, n, "isPlaying", function () {
                return this._isPlaying;
            }, function (t) {
                this._isPlaying = t;
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t && Math.floor(t) == t || "string" == typeof t ? this.index = parseInt(t) : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "bitmap", function () {
                return this._bitmap;
            }), e;
        }(B)), W = function (t) {
            function e() {
                this.changeHandler = null, this._gridSize = 11, this._bgColor = "#ffffff", this._borderColor = "#000000",
                    this._inputColor = "#000000", this._inputBgColor = "#efefef", this._colorPanel = null,
                    this._colorTiles = null, this._colorBlock = null, this._colorInput = null, this._colorButton = null,
                    this._colors = [], this._selectedColor = "#000000", this._panelChanged = !1, e.__super.call(this);
            }
            r(e, "laya.ui.ColorPicker", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._colorPanel && this._colorPanel.destroy(e),
                    this._colorButton && this._colorButton.destroy(e), this._colorPanel = null, this._colorTiles = null,
                    this._colorBlock = null, this._colorInput = null, this._colorButton = null, this._colors = null,
                    this.changeHandler = null;
            }, n.createChildren = function () {
                this.addChild(this._colorButton = new U()), this._colorPanel = new V(), this._colorPanel.size(230, 166),
                    this._colorPanel.addChild(this._colorTiles = new x()), this._colorPanel.addChild(this._colorBlock = new x()),
                    this._colorPanel.addChild(this._colorInput = new m());
            }, n.initialize = function () {
                this._colorButton.on("click", this, this.onColorButtonClick), this._colorBlock.pos(5, 5),
                    this._colorInput.pos(60, 5), this._colorInput.size(60, 20), this._colorInput.on("change", this, this.onColorInputChange),
                    this._colorInput.on("keydown", this, this.onColorFieldKeyDown), this._colorTiles.pos(5, 30),
                    this._colorTiles.on("mousemove", this, this.onColorTilesMouseMove), this._colorTiles.on("click", this, this.onColorTilesClick),
                    this._colorTiles.size(20 * this._gridSize, 12 * this._gridSize), this._colorPanel.on("mousedown", this, this.onPanelMouseDown),
                    this.bgColor = this._bgColor;
            }, n.onPanelMouseDown = function (t) {
                t.stopPropagation();
            }, n.changePanel = function () {
                this._panelChanged = !1;
                var t = this._colorPanel.graphics;
                t.clear(!0), t.drawRect(0, 0, 230, 166, this._bgColor, this._borderColor), this.drawBlock(this._selectedColor),
                    this._colorInput.borderColor = this._borderColor, this._colorInput.bgColor = this._inputBgColor,
                    this._colorInput.color = this._inputColor, (t = this._colorTiles.graphics).clear(!0);
                for (var e = [0, 3355443, 6710886, 10066329, 13421772, 16777215, 16711680, 65280, 255, 16776960, 65535, 16711935], i = 0; i < 12; i++) for (var n = 0; n < 20; n++) {
                    var r = 0;
                    r = 0 === n ? e[i] : 1 === n ? 0 : 51 * (((3 * i + n / 6) % 3 << 0) + 3 * (i / 6 << 0)) << 16 | n % 6 * 51 << 8 | (i << 0) % 6 * 51;
                    var a = L.toColor(r);
                    this._colors.push(a);
                    var s = n * this._gridSize, o = i * this._gridSize;
                    t.drawRect(s, o, this._gridSize, this._gridSize, a, "#000000");
                }
            }, n.onColorButtonClick = function (t) {
                this._colorPanel.parent ? this.close() : this.open();
            }, n.open = function () {
                var t = this.localToGlobal(new S()), e = t.x + this._colorPanel.width <= i.stage.width ? t.x : i.stage.width - this._colorPanel.width, n = t.y + this._colorButton.height;
                n = n + this._colorPanel.height <= i.stage.height ? n : t.y - this._colorPanel.height,
                    this._colorPanel.pos(e, n), this._colorPanel.zOrder = 1001, i._currentStage.addChild(this._colorPanel),
                    i.stage.on("mousedown", this, this.removeColorBox);
            }, n.close = function () {
                i.stage.off("mousedown", this, this.removeColorBox), this._colorPanel.removeSelf();
            }, n.removeColorBox = function (t) {
                this.close();
            }, n.onColorFieldKeyDown = function (t) {
                13 == t.keyCode && (this._colorInput.text ? this.selectedColor = this._colorInput.text : this.selectedColor = null,
                    this.close(), t.stopPropagation());
            }, n.onColorInputChange = function (t) {
                this._colorInput.text ? this.drawBlock(this._colorInput.text) : this.drawBlock("#FFFFFF");
            }, n.onColorTilesClick = function (t) {
                this.selectedColor = this.getColorByMouse(), this.close();
            }, n.onColorTilesMouseMove = function (t) {
                this._colorInput.focus = !1;
                var e = this.getColorByMouse();
                this._colorInput.text = e, this.drawBlock(e);
            }, n.getColorByMouse = function () {
                var t = this._colorTiles.getMousePoint(), e = Math.floor(t.x / this._gridSize), i = Math.floor(t.y / this._gridSize);
                return this._colors[20 * i + e];
            }, n.drawBlock = function (t) {
                var e = this._colorBlock.graphics;
                e.clear(!0);
                var i = t || "#ffffff";
                e.drawRect(0, 0, 50, 20, i, this._borderColor), t || e.drawLine(0, 0, 50, 20, "#ff0000");
            }, n.changeColor = function () {
                var t = this.graphics;
                t.clear(!0);
                var e = this._selectedColor || "#000000";
                t.drawRect(0, 0, this._colorButton.width, this._colorButton.height, e);
            }, n._setPanelChanged = function () {
                this._panelChanged || (this._panelChanged = !0, this.callLater(this.changePanel));
            }, a(0, n, "inputBgColor", function () {
                return this._inputBgColor;
            }, function (t) {
                this._inputBgColor = t, this._setPanelChanged();
            }), a(0, n, "selectedColor", function () {
                return this._selectedColor;
            }, function (t) {
                this._selectedColor != t && (this._selectedColor = this._colorInput.text = t, this.drawBlock(t),
                    this.changeColor(), this.changeHandler && this.changeHandler.runWith(this._selectedColor),
                    this.event("change", d.EMPTY.setTo("change", this, this)));
            }), a(0, n, "skin", function () {
                return this._colorButton.skin;
            }, function (t) {
                this._colorButton.once("loaded", this, this.changeColor), this._colorButton.skin = t;
            }), a(0, n, "bgColor", function () {
                return this._bgColor;
            }, function (t) {
                this._bgColor = t, this._setPanelChanged();
            }), a(0, n, "borderColor", function () {
                return this._borderColor;
            }, function (t) {
                this._borderColor = t, this._setPanelChanged();
            }), a(0, n, "inputColor", function () {
                return this._inputColor;
            }, function (t) {
                this._inputColor = t, this._setPanelChanged();
            }), e;
        }(B), X = function (t) {
            function e(t) {
                this.changeHandler = null, this._bg = null, this._bar = null, this._skin = null,
                    this._value = .5, e.__super.call(this), this.skin = t;
            }
            r(e, "laya.ui.ProgressBar", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._bg && this._bg.destroy(e),
                    this._bar && this._bar.destroy(e), this._bg = this._bar = null, this.changeHandler = null;
            }, n.createChildren = function () {
                this.addChild(this._bg = new G()), this.addChild(this._bar = new G()), this._bar._bitmap.autoCacheCmd = !1;
            }, n._skinLoaded = function () {
                this._bg.skin = this._skin, this._bar.skin = this._skin.replace(".png", "$bar.png"),
                    this.callLater(this.changeValue), this._sizeChanged(), this.event("loaded");
            }, n.measureWidth = function () {
                return this._bg.width;
            }, n.measureHeight = function () {
                return this._bg.height;
            }, n.changeValue = function () {
                if (this.sizeGrid) {
                    var t = this.sizeGrid.split(","), e = Number(t[3]), i = Number(t[1]), n = (this.width - e - i) * this._value;
                    this._bar.width = e + i + n, this._bar.visible = this._bar.width > e + i;
                } else this._bar.width = this.width * this._value;
            }, a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t || "string" == typeof t ? this.value = Number(t) : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !g.getRes(this._skin) ? i.loader.load(this._skin, f.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded());
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(B, this, "height", t), this._bg.height = this._height, this._bar.height = this._height;
            }), a(0, n, "bar", function () {
                return this._bar;
            }), a(0, n, "value", function () {
                return this._value;
            }, function (t) {
                this._value != t && (t = t > 1 ? 1 : t < 0 ? 0 : t, this._value = t, this.callLater(this.changeValue),
                    this.event("change"), this.changeHandler && this.changeHandler.runWith(t));
            }), a(0, n, "bg", function () {
                return this._bg;
            }), a(0, n, "sizeGrid", function () {
                return this._bg.sizeGrid;
            }, function (t) {
                this._bg.sizeGrid = this._bar.sizeGrid = t;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(B, this, "width", t), this._bg.width = this._width, this.callLater(this.changeValue);
            }), e;
        }(B), Y = function (t) {
            function e(t) {
                this.rollRatio = .97, this.changeHandler = null, this.scaleBar = !0, this.autoHide = !1,
                    this.elasticDistance = 0, this.elasticBackTime = 500, this.upButton = null, this.downButton = null,
                    this.slider = null, this._scrollSize = 1, this._skin = null, this._thumbPercent = 1,
                    this._target = null, this._lastPoint = null, this._lastOffset = 0, this._checkElastic = !1,
                    this._isElastic = !1, this._value = NaN, this._hide = !1, this._clickOnly = !0,
                    this._offsets = null, this.isLockedFun = null, this.triggerDownDragLimit = null,
                    this.triggerUpDragLimit = null, e.__super.call(this), this._showButtons = D.showButtons,
                    this._touchScrollEnable = D.touchScrollEnable, this._mouseWheelEnable = D.mouseWheelEnable,
                    this.skin = t, this.max = 1;
            }
            r(e, "laya.ui.ScrollBar", t);
            var n = e.prototype;
            return n.destroy = function (e) {
                void 0 === e && (e = !0), this.stopScroll(), this.target = null, t.prototype.destroy.call(this, e),
                    this.upButton && this.upButton.destroy(e), this.downButton && this.downButton.destroy(e),
                    this.slider && this.slider.destroy(e), this.upButton = this.downButton = null, this.slider = null,
                    this.changeHandler = null, this._offsets = null;
            }, n.createChildren = function () {
                this.addChild(this.slider = new q()), this.addChild(this.upButton = new U()), this.addChild(this.downButton = new U());
            }, n.initialize = function () {
                this.slider.showLabel = !1, this.slider.tick = 0, this.slider.on("change", this, this.onSliderChange),
                    this.slider.setSlider(0, 0, 0), this.upButton.on("mousedown", this, this.onButtonMouseDown),
                    this.downButton.on("mousedown", this, this.onButtonMouseDown);
            }, n.onSliderChange = function () {
                this._value != this.slider.value && (this.value = this.slider.value);
            }, n.onButtonMouseDown = function (t) {
                var e = t.currentTarget === this.upButton;
                this.slide(e), i.timer.once(O.scrollBarDelayTime, this, this.startLoop, [e]),
                    i.stage.once("mouseup", this, this.onStageMouseUp);
            }, n.startLoop = function (t) {
                i.timer.frameLoop(1, this, this.slide, [t]);
            }, n.slide = function (t) {
                t ? this.value -= this._scrollSize : this.value += this._scrollSize;
            }, n.onStageMouseUp = function (t) {
                i.timer.clear(this, this.startLoop), i.timer.clear(this, this.slide);
            }, n._skinLoaded = function () {
                this.slider.skin = this._skin, this.callLater(this.changeScrollBar), this._sizeChanged(),
                    this.event("loaded");
            }, n.changeScrollBar = function () {
                this.upButton.visible = this._showButtons, this.downButton.visible = this._showButtons,
                    this._showButtons && (this.upButton.skin = this._skin.replace(".png", "$up.png"),
                        this.downButton.skin = this._skin.replace(".png", "$down.png")), this.slider.isVertical ? this.slider.y = this._showButtons ? this.upButton.height : 0 : this.slider.x = this._showButtons ? this.upButton.width : 0,
                    this.resetPositions(), this.repaint();
            }, n._sizeChanged = function () {
                t.prototype._sizeChanged.call(this), this.repaint(), this.resetPositions(), this.event("change"),
                    this.changeHandler && this.changeHandler.runWith(this.value);
            }, n.resetPositions = function () {
                this.slider.isVertical ? this.slider.height = this.height - (this._showButtons ? this.upButton.height + this.downButton.height : 0) : this.slider.width = this.width - (this._showButtons ? this.upButton.width + this.downButton.width : 0),
                    this.resetButtonPosition();
            }, n.resetButtonPosition = function () {
                this.slider.isVertical ? this.downButton.y = this.slider._y + this.slider.height : this.downButton.x = this.slider._x + this.slider.width;
            }, n.measureWidth = function () {
                return this.slider.isVertical ? this.slider.width : 100;
            }, n.measureHeight = function () {
                return this.slider.isVertical ? 100 : this.slider.height;
            }, n.setScroll = function (t, e, i) {
                this.runCallLater(this._sizeChanged), this.slider.setSlider(t, e, i), this.slider.bar.visible = e > 0,
                    !this._hide && this.autoHide && (this.visible = !1);
            }, n.onTargetMouseWheel = function (t) {
                this.value -= t.delta * this._scrollSize, this.target = this._target;
            }, n.onTargetMouseDown = function (t) {
                this.isLockedFun && !this.isLockedFun(t) || (this.event("end"), this._clickOnly = !0,
                    this._lastOffset = 0, this._checkElastic = !1, this._lastPoint || (this._lastPoint = new S()),
                    this._lastPoint.setTo(i.stage.mouseX, i.stage.mouseY), i.timer.clear(this, this.tweenMove),
                    A.clearTween(this), i.stage.once("mouseup", this, this.onStageMouseUp2), i.stage.once("mouseout", this, this.onStageMouseUp2),
                    i.timer.frameLoop(1, this, this.loop));
            }, n.startDragForce = function () {
                this._clickOnly = !0, this._lastOffset = 0, this._checkElastic = !1, this._lastPoint || (this._lastPoint = new S()),
                    this._lastPoint.setTo(i.stage.mouseX, i.stage.mouseY), i.timer.clear(this, this.tweenMove),
                    A.clearTween(this), i.stage.once("mouseup", this, this.onStageMouseUp2), i.stage.once("mouseout", this, this.onStageMouseUp2),
                    i.timer.frameLoop(1, this, this.loop);
            }, n.cancelDragOp = function () {
                i.stage.off("mouseup", this, this.onStageMouseUp2), i.stage.off("mouseout", this, this.onStageMouseUp2),
                    i.timer.clear(this, this.tweenMove), i.timer.clear(this, this.loop), this._target.mouseEnabled = !0;
            }, n.checkTriggers = function (t) {
                return void 0 === t && (t = !1), this.value >= 0 && this.value - this._lastOffset <= 0 && this.triggerDownDragLimit && this.triggerDownDragLimit(t) ? (this.cancelDragOp(),
                    this.value = 0, !0) : !!(this.value <= this.max && this.value - this._lastOffset >= this.max && this.triggerUpDragLimit && this.triggerUpDragLimit(t)) && (this.cancelDragOp(),
                        this.value = this.max, !0);
            }, n.startTweenMoveForce = function (t) {
                this._lastOffset = t, i.timer.frameLoop(1, this, this.tweenMove, [200]);
            }, n.loop = function () {
                var t = i.stage.mouseY, e = i.stage.mouseX;
                if (this._lastOffset = this.isVertical ? t - this._lastPoint.y : e - this._lastPoint.x,
                    this._clickOnly) {
                    if (!(Math.abs(this._lastOffset * (this.isVertical ? i.stage._canvasTransform.getScaleY() : i.stage._canvasTransform.getScaleX())) > 1)) return;
                    if (this._clickOnly = !1, this.checkTriggers()) return;
                    this._offsets || (this._offsets = []), this._offsets.length = 0, this._target.mouseEnabled = !1,
                        !this.hide && this.autoHide && (this.alpha = 1, this.visible = !0), this.event("start");
                } else if (this.checkTriggers()) return;
                this._offsets.push(this._lastOffset), this._lastPoint.x = e, this._lastPoint.y = t,
                    0 !== this._lastOffset && (this._checkElastic || (this.elasticDistance > 0 ? this._checkElastic || 0 == this._lastOffset || (this._lastOffset > 0 && this._value <= this.min || this._lastOffset < 0 && this._value >= this.max ? (this._isElastic = !0,
                        this._checkElastic = !0) : this._isElastic = !1) : this._checkElastic = !0), this._isElastic ? this._value <= this.min ? this._lastOffset > 0 ? this.value -= this._lastOffset * Math.max(0, 1 - (this.min - this._value) / this.elasticDistance) : (this.value -= .5 * this._lastOffset,
                            this._value >= this.min && (this._checkElastic = !1)) : this._value >= this.max && (this._lastOffset < 0 ? this.value -= this._lastOffset * Math.max(0, 1 - (this._value - this.max) / this.elasticDistance) : (this.value -= .5 * this._lastOffset,
                                this._value <= this.max && (this._checkElastic = !1))) : this.value -= this._lastOffset);
            }, n.onStageMouseUp2 = function (t) {
                if (i.stage.off("mouseup", this, this.onStageMouseUp2), i.stage.off("mouseout", this, this.onStageMouseUp2),
                    i.timer.clear(this, this.loop), !(this._clickOnly && this._value >= this.min && this._value <= this.max)) if (this._target.mouseEnabled = !0,
                        this._isElastic) this._value < this.min ? A.to(this, {
                            value: this.min
                        }, this.elasticBackTime, c.sineOut, f.create(this, this.elasticOver)) : this._value > this.max && A.to(this, {
                            value: this.max
                        }, this.elasticBackTime, c.sineOut, f.create(this, this.elasticOver)); else {
                        if (!this._offsets) return;
                        this._offsets.length < 1 && (this._offsets[0] = this.isVertical ? i.stage.mouseY - this._lastPoint.y : i.stage.mouseX - this._lastPoint.x);
                        for (var e = 0, n = Math.min(this._offsets.length, 3), r = 0; r < n; r++) e += this._offsets[this._offsets.length - 1 - r];
                        if (this._lastOffset = e / n, (e = Math.abs(this._lastOffset)) < 2) return void this.event("end");
                        e > 250 && (this._lastOffset = this._lastOffset > 0 ? 250 : -250);
                        var a = Math.round(Math.abs(this.elasticDistance * (this._lastOffset / 150)));
                        i.timer.frameLoop(1, this, this.tweenMove, [a]);
                    }
            }, n.elasticOver = function () {
                this._isElastic = !1, !this.hide && this.autoHide && A.to(this, {
                    alpha: 0
                }, 500), this.event("end");
            }, n.tweenMove = function (t) {
                if (this._lastOffset *= this.rollRatio, !this.checkTriggers(!0)) {
                    var e = NaN;
                    if (t > 0 && (this._lastOffset > 0 && this.value <= this.min ? (this._isElastic = !0,
                        e = .5 * -(this.min - t - this.value), this._lastOffset > e && (this._lastOffset = e)) : this._lastOffset < 0 && this.value >= this.max && (this._isElastic = !0,
                            e = .5 * -(this.max + t - this.value), this._lastOffset < e && (this._lastOffset = e))),
                        this.value -= this._lastOffset, Math.abs(this._lastOffset) < .1) {
                        if (i.timer.clear(this, this.tweenMove), this._isElastic) return void (this._value < this.min ? A.to(this, {
                            value: this.min
                        }, this.elasticBackTime, c.sineOut, f.create(this, this.elasticOver)) : this._value > this.max ? A.to(this, {
                            value: this.max
                        }, this.elasticBackTime, c.sineOut, f.create(this, this.elasticOver)) : this.elasticOver());
                        this.event("end"), !this.hide && this.autoHide && A.to(this, {
                            alpha: 0
                        }, 500);
                    }
                }
            }, n.stopScroll = function () {
                this.onStageMouseUp2(null), i.timer.clear(this, this.tweenMove), A.clearTween(this);
            }, a(0, n, "thumbPercent", function () {
                return this._thumbPercent;
            }, function (t) {
                this.runCallLater(this.changeScrollBar), this.runCallLater(this._sizeChanged), t = t >= 1 ? .99 : t,
                    this._thumbPercent = t, this.scaleBar && (this.slider.isVertical ? this.slider.bar.height = Math.max(this.slider.height * t, O.scrollBarMinNum) : this.slider.bar.width = Math.max(this.slider.width * t, O.scrollBarMinNum));
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t || "string" == typeof t ? this.value = Number(t) : i.superSet(B, this, "dataSource", t);
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                " " != t && this._skin != t && (this._skin = t, this._skin && !g.getRes(this._skin) ? i.loader.load([this._skin, this._skin.replace(".png", "$up.png"), this._skin.replace(".png", "$down.png"), this._skin.replace(".png", "$bar.png")], f.create(this, this._skinLoaded)) : this._skinLoaded());
            }), a(0, n, "max", function () {
                return this.slider.max;
            }, function (t) {
                this.slider.max = t;
            }), a(0, n, "min", function () {
                return this.slider.min;
            }, function (t) {
                this.slider.min = t;
            }), a(0, n, "value", function () {
                return this._value;
            }, function (t) {
                t !== this._value && (this._value = t, this._isElastic || (this.slider._value != t && (this.slider._value = t,
                    this.slider.changeValue()), this._value = this.slider._value), this.event("change"),
                    this.changeHandler && this.changeHandler.runWith(this._value));
            }), a(0, n, "isVertical", function () {
                return this.slider.isVertical;
            }, function (t) {
                this.slider.isVertical = t;
            }), a(0, n, "sizeGrid", function () {
                return this.slider.sizeGrid;
            }, function (t) {
                this.slider.sizeGrid = t;
            }), a(0, n, "scrollSize", function () {
                return this._scrollSize;
            }, function (t) {
                this._scrollSize = t;
            }), a(0, n, "target", function () {
                return this._target;
            }, function (t) {
                this._target && (this._target.off("mousewheel", this, this.onTargetMouseWheel),
                    this._target.off("mousedown", this, this.onTargetMouseDown)), this._target = t,
                    t && (this._mouseWheelEnable && this._target.on("mousewheel", this, this.onTargetMouseWheel),
                        this._touchScrollEnable && this._target.on("mousedown", this, this.onTargetMouseDown));
            }), a(0, n, "hide", function () {
                return this._hide;
            }, function (t) {
                this._hide = t, this.visible = !t;
            }), a(0, n, "showButtons", function () {
                return this._showButtons;
            }, function (t) {
                this._showButtons = t, this.callLater(this.changeScrollBar);
            }), a(0, n, "touchScrollEnable", function () {
                return this._touchScrollEnable;
            }, function (t) {
                this._touchScrollEnable = t, this.target = this._target;
            }), a(0, n, "mouseWheelEnable", function () {
                return this._mouseWheelEnable;
            }, function (t) {
                this._mouseWheelEnable = t, this.target = this._target;
            }), a(0, n, "lastOffset", function () {
                return this._lastOffset;
            }), a(0, n, "tick", function () {
                return this.slider.tick;
            }, function (t) {
                this.slider.tick = t;
            }), e;
        }(B), q = function (t) {
            function e(t) {
                this.changeHandler = null, this.isVertical = !0, this.showLabel = !0, this._allowClickBack = !1,
                    this._max = 100, this._min = 0, this._tick = 1, this._value = 0, this._skin = null,
                    this._bg = null, this._progress = null, this._bar = null, this._tx = NaN, this._ty = NaN,
                    this._maxMove = NaN, this._globalSacle = null, e.__super.call(this), this.skin = t;
            }
            r(e, "laya.ui.Slider", t);
            var s = e.prototype;
            return s.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._bg && this._bg.destroy(e),
                    this._bar && this._bar.destroy(e), this._progress && this._progress.destroy(e),
                    this._bg = null, this._bar = null, this._progress = null, this.changeHandler = null;
            }, s.createChildren = function () {
                this.addChild(this._bg = new G()), this.addChild(this._bar = new U());
            }, s.initialize = function () {
                this._bar.on("mousedown", this, this.onBarMouseDown), this._bg.sizeGrid = this._bar.sizeGrid = "4,4,4,4,0",
                    this._progress && (this._progress.sizeGrid = this._bar.sizeGrid), this.allowClickBack = !0;
            }, s.onBarMouseDown = function (t) {
                this._globalSacle || (this._globalSacle = new S()), this._globalSacle.setTo(this.globalScaleX || .01, this.globalScaleY || .01),
                    this._maxMove = this.isVertical ? this.height - this._bar.height : this.width - this._bar.width,
                    this._tx = i.stage.mouseX, this._ty = i.stage.mouseY, i.stage.on("mousemove", this, this.mouseMove),
                    i.stage.once("mouseup", this, this.mouseUp), i.stage.once("mouseout", this, this.mouseUp),
                    this.showValueText();
            }, s.showValueText = function () {
                if (this.showLabel) {
                    var t = laya.ui.Slider.label;
                    this.addChild(t), t.textField.changeText(this._value + ""), this.isVertical ? (t.x = this._bar._x + 20,
                        t.y = .5 * (this._bar.height - t.height) + this._bar._y) : (t.y = this._bar._y - 20,
                            t.x = .5 * (this._bar.width - t.width) + this._bar._x);
                }
            }, s.hideValueText = function () {
                laya.ui.Slider.label && laya.ui.Slider.label.removeSelf();
            }, s.mouseUp = function (t) {
                i.stage.off("mousemove", this, this.mouseMove), i.stage.off("mouseup", this, this.mouseUp),
                    i.stage.off("mouseout", this, this.mouseUp), this.sendChangeEvent("changed"), this.hideValueText();
            }, s.mouseMove = function (t) {
                var e = this._value;
                if (this.isVertical ? (this._bar.y += (i.stage.mouseY - this._ty) / this._globalSacle.y,
                    this._bar._y > this._maxMove ? this._bar.y = this._maxMove : this._bar._y < 0 && (this._bar.y = 0),
                    this._value = this._bar._y / this._maxMove * (this._max - this._min) + this._min,
                    this._progress && (this._progress.height = this._bar._y + .5 * this._bar.height)) : (this._bar.x += (i.stage.mouseX - this._tx) / this._globalSacle.x,
                        this._bar._x > this._maxMove ? this._bar.x = this._maxMove : this._bar._x < 0 && (this._bar.x = 0),
                        this._value = this._bar._x / this._maxMove * (this._max - this._min) + this._min,
                        this._progress && (this._progress.width = this._bar._x + .5 * this._bar.width)),
                    this._tx = i.stage.mouseX, this._ty = i.stage.mouseY, 0 != this._tick) {
                    var n = Math.pow(10, (this._tick + "").length - 1);
                    this._value = Math.round(Math.round(this._value / this._tick) * this._tick * n) / n;
                }
                this._value != e && this.sendChangeEvent(), this.showValueText();
            }, s.sendChangeEvent = function (t) {
                void 0 === t && (t = "change"), this.event(t), this.changeHandler && this.changeHandler.runWith(this._value);
            }, s._skinLoaded = function () {
                this._bg.skin = this._skin, this._bar.skin = this._skin.replace(".png", "$bar.png");
                var t = this._skin.replace(".png", "$progress.png");
                g.getRes(t) && (this._progress || (this.addChild(this._progress = new G()), this._progress.sizeGrid = this._bar.sizeGrid,
                    this.setChildIndex(this._progress, 1)), this._progress.skin = t), this.setBarPoint(),
                    this.callLater(this.changeValue), this._sizeChanged(), this.event("loaded");
            }, s.setBarPoint = function () {
                this.isVertical ? this._bar.x = Math.round(.5 * (this._bg.width - this._bar.width)) : this._bar.y = Math.round(.5 * (this._bg.height - this._bar.height));
            }, s.measureWidth = function () {
                return Math.max(this._bg.width, this._bar.width);
            }, s.measureHeight = function () {
                return Math.max(this._bg.height, this._bar.height);
            }, s._sizeChanged = function () {
                t.prototype._sizeChanged.call(this), this.isVertical ? this._bg.height = this.height : this._bg.width = this.width,
                    this.setBarPoint(), this.changeValue();
            }, s.setSlider = function (t, e, i) {
                this._value = -1, this._min = t, this._max = e > t ? e : t, this.value = i < t ? t : i > e ? e : i;
            }, s.changeValue = function () {
                if (0 != this.tick) {
                    var t = Math.pow(10, (this._tick + "").length - 1);
                    this._value = Math.round(Math.round(this._value / this._tick) * this._tick * t) / t;
                }
                this._value = this._value > this._max ? this._max : this._value < this._min ? this._min : this._value;
                var e = this._max - this._min;
                0 === e && (e = 1), this.isVertical ? (this._bar.y = (this._value - this._min) / e * (this.height - this._bar.height),
                    this._progress && (this._progress.height = this._bar._y + .5 * this._bar.height)) : (this._bar.x = (this._value - this._min) / e * (this.width - this._bar.width),
                        this._progress && (this._progress.width = this._bar._x + .5 * this._bar.width));
            }, s.onBgMouseDown = function (t) {
                var e = this._bg.getMousePoint();
                this.isVertical ? this.value = e.y / (this.height - this._bar.height) * (this._max - this._min) + this._min : this.value = e.x / (this.width - this._bar.width) * (this._max - this._min) + this._min;
            }, a(0, s, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t || "string" == typeof t ? this.value = Number(t) : i.superSet(B, this, "dataSource", t);
            }), a(0, s, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !g.getRes(this._skin) ? i.loader.load([this._skin, this._skin.replace(".png", "$bar.png")], f.create(this, this._skinLoaded)) : this._skinLoaded());
            }), a(0, s, "tick", function () {
                return this._tick;
            }, function (t) {
                this._tick != t && (this._tick = t, this.callLater(this.changeValue));
            }), a(0, s, "sizeGrid", function () {
                return this._bg.sizeGrid;
            }, function (t) {
                this._bg.sizeGrid = t, this._bar.sizeGrid = t, this._progress && (this._progress.sizeGrid = this._bar.sizeGrid);
            }), a(0, s, "allowClickBack", function () {
                return this._allowClickBack;
            }, function (t) {
                this._allowClickBack != t && (this._allowClickBack = t, t ? this._bg.on("mousedown", this, this.onBgMouseDown) : this._bg.off("mousedown", this, this.onBgMouseDown));
            }), a(0, s, "max", function () {
                return this._max;
            }, function (t) {
                this._max != t && (this._max = t, this.callLater(this.changeValue));
            }), a(0, s, "min", function () {
                return this._min;
            }, function (t) {
                this._min != t && (this._min = t, this.callLater(this.changeValue));
            }), a(0, s, "bar", function () {
                return this._bar;
            }), a(0, s, "value", function () {
                return this._value;
            }, function (t) {
                if (this._value != t) {
                    var e = this._value;
                    this._value = t, this.changeValue(), this._value != e && this.sendChangeEvent();
                }
            }), n(e, ["label", function () {
                return this.label = new z();
            }]), e;
        }(B), K = function (t) {
            var a, s;
            function l(t) {
                this.gameStopHD = !1, this.iconImgTl = null, this._iconImage = null, this._moreBox = null,
                    this._gameBox = null, this.screenType = 0, this._moreGameDataUrl = "https://abc.layabox.com/public/more/gamelist2.json",
                    this._iconImageObj = null, this.clickCallBack = null, this.closeCallBack = null,
                    this.isShow = !1, this.dinfo = null, this.ErrorUrlHttps = "https://elastic.layabox.com/",
                    this.tongjiType = "bdm", void 0 === t && (t = 0), l.__super.call(this), this.screenType = t,
                    this.init();
            }
            r(l, "laya.ui.MoreGame", t);
            var h = l.prototype;
            return h.getLocalDateString = function (t) {
                void 0 === t && (t = 0);
                var e = this.getDateByTimestamp(t).toLocaleDateString();
                if (o.onLimixiu || o.onMiniGame) {
                    var i = new Date();
                    e = l.toLocaleDateString(i.getTime());
                }
                var n = new RegExp("/", "g");
                return e = e.replace(n, "-");
            }, h.getDateByTimestamp = function (t) {
                return void 0 === t && (t = 0), t && "" != t ? new Date(t) : new Date();
            }, h.reportError = function (t, i, n) {
                void 0 === i && (i = ""), n = n || {};
                var r = Date.now(), a = new Date(r + 0);
                n.date = a.toLocaleString(), n.etype = t, "error" != t && "statistics" != t && (t = "statistics"),
                    n.version = "V0.0.1", n.gameId = 10100, n.dinfo = this.dinfo, n.channel = -1e3,
                    n.msg = i, n["@timestamp"] = a.toISOString(), n.user = this.getUserId(), n.openid = this.getOpenId();
                var s = l.getDay(a);
                n.rdate = s, n.day = a.getDate() + "", n.hour = a.getHours() + "", n.minute = a.getMinutes() + "",
                    n.gameurl = e.baseURI, n.regTime = 0, "error" == t ? this.sendLog(n, this.tongjiType + "error-" + s.substring(0, 6) + "/" + t + "/", t) : this.sendLog(n, this.tongjiType + "-" + s.substring(0, 6) + "/" + t + "/", t);
            }, h.getUserId = function () {
                var t = parseInt(y.getItem("layauserid") + "") || -1;
                return -1 == t && (t = this.randRange(0, 1e9), y.setItem("layauserid", t + "")),
                    t;
            }, h.getOpenId = function () {
                var t = y.getItem("openid");
                if (null == t || "" == t) {
                    t = "";
                    for (var e = 0; e < 32; e++) {
                        var i = this.randRange(0, 62);
                        t += "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(i);
                    }
                    y.setItem("openid", t);
                }
                return t;
            }, h.sendLog = function (t, e, i) {
                var n = this, r = new p();
                r.on("error", this, function (t, e, i) {
                    i && -1 != i.indexOf("[404]") && new p().send(n.ErrorUrlHttps + "garbage/" + e + "/", JSON.stringify(t), "post", "text", ["Content-Type", "application/json"]);
                }, [t, i]), o.onBDMiniGame && (t.gameurl = ""), r.send(this.ErrorUrlHttps + e, JSON.stringify(t), "post", "text", ["Content-Type", "application/json"]);
            }, h.initEvent = function () {
                this.on("click", this, this.onIconClick);
            }, h.onStageResize = function () {
                var t = Math.min(i.stage.width / i.stage.designWidth, i.stage.height / i.stage.designHeight);
                i.stage.width < 720 && (t = .9), this._moreBox && this._moreBox.scale(t, t), this._gameBox && this._gameBox.scale(t, t);
            }, h.tada = function (t, e, i, n) {
                void 0 === i && (i = 1.1), void 0 === n && (n = 1);
                var r = new w();
                return r.reset(), r.to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: 3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: -3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: 3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: -3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: 3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: -3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: 3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: -3
                }, .1 * e).to(t, {
                    scaleX: i,
                    scaleY: i,
                    rotation: 3
                }, .1 * e).to(t, {
                    scaleX: n,
                    scaleY: n,
                    rotation: 0
                }, .1 * e), r.play(0), r;
            }, h.dispose = function () {
                this.removeEvent(), this.gameStopHD = !0, l._moreGameData = null, this._iconImageObj = null,
                    this.clickCallBack = null, this.closeCallBack = null, this.iconImgTl && (this.iconImgTl.offAll("complete"),
                        this.iconImgTl = null), this._moreBox && (this._moreBox.removeChildren(), this._moreBox = null),
                    this._gameBox && (this._gameBox.removeChildren(), this._gameBox = null), this._iconImage && (this._iconImage.removeSelf(),
                        this._iconImage = null);
            }, h.onSetIconType = function (t) {
                this.gameStopHD = !t, this.visible = t;
            }, h.checkIconImgHD = function () {
                this.iconImgTl ? this.iconImgTl.play(0) : this.iconImgTl = this.tada(this._iconImage, 1200, 1.1, .9),
                    this.iconImgTl.on("complete", this, this.onTlComplete);
            }, h.onTlComplete = function () {
                if (this.parent) {
                    if (this._iconImage.scale(.9, .9), this._iconImage.rotation = 0, this.gameStopHD && this.iconImgTl) return this.iconImgTl.offAll("complete"),
                        void (this.iconImgTl = null);
                    i.timer.once(1e3, this, this.onYanChiPlay);
                } else this.iconImgTl && (this.iconImgTl.offAll(), this.iconImgTl = null);
            }, h.onYanChiPlay = function () {
                this.parent && this.iconImgTl ? this.iconImgTl.play(0) : this.iconImgTl && (this.iconImgTl.offAll("complete"),
                    this.iconImgTl = null);
            }, h.removeEvent = function () {
                this.off("click", this, this.onIconClick);
            }, h.onIconClick = function () {
                this.isShow = !0, null != this.clickCallBack && this.clickCallBack.run();
                var t = y.getItem("currentTime"), e = this.getLocalDateString();
                t != e ? (y.setItem("currentTime", e), this.reportError(l._moreGameData.statid1)) : this.reportError(l._moreGameData.statid2),
                    this.onResLoaded();
            }, h.onResLoaded = function () {
                if (this._moreBox) this._moreBox.visible = !0; else {
                    this._moreBox = new V(), i.stage.addChild(this._moreBox), this._moreBox.zOrder = 99999,
                        this._moreBox.left = this._moreBox.right = this._moreBox.top = this._moreBox.bottom = 0;
                    var t = this.onCreateImage(l.onGetAtlasDanImgUrl("img_white_bg"), this._moreBox);
                    t.top = t.left = t.right = t.bottom = 0, t.sizeGrid = "1,1,1,1,1";
                    var e = this.onCreateImage(l.onGetAtlasDanImgUrl("hengfengexian"), this._moreBox);
                    e.left = e.right = 0, e.y = 132, e.alpha = .2;
                    var n = this.onCreateImage(l.onGetAtlasDanImgUrl("img_font_jingcai"), this._moreBox);
                    n.on("click", this, this.onJiantouImgClick), this.isQMP() && this.screenType ? n.pos(15, 70) : n.pos(15, 45);
                    var r = new nt();
                    this._moreBox.addChild(r), r.itemRender = a, r.selectEnable = !0, r.vScrollBarSkin = "",
                        r.scrollBar.autoHide = !0, r.scrollBar.elasticDistance = 250, r.renderHandler = new f(this, this.onGameListRender);
                    var s = l._moreGameData.marvellousGame.gameList, o = [];
                    o.push(s[0]), o.push(s[1]);
                    var h = this.RandomNumBoth(o.length, s.length - o.length, s.length);
                    if (!h) return void (this.visible = !1);
                    try {
                        for (var u = 0, c = h.length; u < c; u++) {
                            var d = h[u];
                            o.push(s[d]);
                        }
                        l._moreGameData.marvellousGame.gameList = [], l._moreGameData.marvellousGame.gameList = o,
                            r.array = l._moreGameData.marvellousGame.gameList;
                    } catch (t) {
                        r.array = l._moreGameData.marvellousGame.gameList;
                    }
                    this.screenType && (r.spaceY = 10, r.width = 690, this.isQMP() ? r.height = i.stage.height + 130 : r.height = 1139,
                        r.y = 139, r.centerX = 0), this.onStageResize();
                }
            }, h.RandomNumBoth = function (t, e, i) {
                for (var n = [], r = t; r < i; r++) n.push(r);
                var a = [], s = n.length;
                for (r = 0; r < s; r++) {
                    n.length;
                    var o = Math.floor(Math.random() * n.length);
                    if (a.push(n[o]), n.splice(o, 1), n.length <= s - e) return a;
                }
                return null;
            }, h.isQMP = function () {
                var t = !1, e = 0;
                if (e = "horizontal" == i.stage.screenMode ? o.height % 9 : o.width % 9, o.onAndroid && 0 == e) {
                    var n = 0;
                    n = "horizontal" == i.stage.screenMode ? o.width : o.height, -1 != [2280, 2160, 2244, 3120, 2248, 2340, 2310].indexOf(n) && (t = !0);
                }
                var r = /iPhone/gi.test(o.window.navigator.userAgent) && 375 == Math.min(o.clientHeight, o.clientWidth) && 812 == Math.max(o.clientHeight, o.clientWidth), a = 414 == Math.min(o.clientHeight, o.clientWidth) && 896 == Math.max(o.clientHeight, o.clientWidth);
                return !o.onMiniGame && !o.onBDMiniGame || o.onAndroid || !r && !a || (t = !0),
                    t;
            }, h.onDrawShapes = function (t, e, i, n) {
                void 0 === i && (i = 5), void 0 === n && (n = !1);
                var r = i;
                n && (r = 0);
                var a = new x();
                return a.graphics.drawPath(0, 0, [["moveTo", i, 0], ["lineTo", 105, 0], ["arcTo", t, 0, t, i, i], ["lineTo", t, e], ["arcTo", t, e + i, 105, e + i, r], ["lineTo", i, e + i], ["arcTo", 0, e + i, 0, e, r], ["lineTo", 0, i], ["arcTo", 0, 0, i, 0, i], ["closePath"]], {
                    fillStyle: "#ff0000"
                }), a;
            }, h.onCreateMaskImg = function (t, e) {
                var i = this.onCreateImage(l.onGetAtlasDanImgUrl("dayuan"), e), n = this.onCreateImage(t, i);
                n.pos(11, 10);
                var r = new x();
                return r.graphics.drawCircle(71, 74, 68, "#ff0000"), n.mask = r, i.scale(.7, .7),
                    i;
            }, h.onGameListRender = function (t, e) {
                var i = l._moreGameData.marvellousGame.gameList;
                if (!(e < 0 || e > i.length - 1)) {
                    var n = i[e];
                    t.init(n, this.screenType, new f(this, this.onItemClickCallBack));
                }
            }, h.onItemClickCallBack = function (t) {
                var e = this;
                if (swan.navigateToMiniProgram) {
                    var i = t.appKey, n = t.path, r = t.extendInfo;
                    swan.navigateToMiniProgram({
                        appKey: i,
                        path: n,
                        extraData: r,
                        success: function (t) { },
                        fail: function (t) { },
                        complete: function (i) {
                            e.reportError(t.statid);
                        }.bind(this)
                    });
                }
            }, h.onJiantouImgClick = function (t) {
                this.isShow = !1, this._moreBox && (this._moreBox.visible = !1), null != this.closeCallBack && this.closeCallBack.run();
            }, h.onCreateLabel = function (t, e, i, n, r, a, s) {
                void 0 === i && (i = 24), void 0 === n && (n = "#000000"), void 0 === r && (r = !1),
                    void 0 === a && (a = "center"), void 0 === s && (s = 10);
                var o = new z();
                return o.text = t, o.font = "Microsoft YaHei", o.fontSize = i, o.color = n, o.bold = !0,
                    o.leading = s, o.valign = "middle", o.align = a, o.wordWrap = r, e.addChild(o),
                    o;
            }, h.onCreateImage = function (t, e) {
                var i = new G();
                return i.skin = t, e.addChild(i), i;
            }, h.init = function () {
                var t = o.window.navigator.userAgent.indexOf("SwanGame") > -1;
                this.visible = !1, t && (this.dinfo = JSON.stringify(laya.bd.mini.BMiniAdapter.systemInfo),
                    this.onGetAdvsListData());
            }, h.randRange = function (t, e) {
                return Math.floor(Math.random() * (e - t + 1)) + t;
            }, h.onGetAdvsListData = function () {
                var t = this, e = this.randRange(1e4, 1e6), i = this._moreGameDataUrl + "?" + e;
                l._http.open("get", i, !0), l._http.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"),
                    l._http.responseType = "text", l._http.onerror = function (e) {
                        t._onError(e);
                    }, l._http.onload = function (e) {
                        t._onLoad(e);
                    }, l._http.send(null);
            }, h._onError = function (t) {
                this.error("Request failed Status:" + l._http.status + " text:" + l._http.statusText);
            }, h._onLoad = function (t) {
                var e = l._http, i = void 0 !== e.status ? e.status : 200;
                200 === i || 204 === i || 0 === i ? this.complete() : this.error("[" + e.status + "]" + e.statusText + ":" + e.responseURL);
            }, h.error = function (t) {
                this.event("error", t);
            }, h.complete = function () {
                try {
                    var t = l._http.response || l._http.responseText;
                    l._moreGameData = JSON.parse(t), this.initUI();
                } catch (t) {
                    !1, this.error(t.message);
                }
            }, h.initUI = function () {
                l._moreGameData.isOpen && this.screenType ? (this._iconImage || (this._iconImage = new G(),
                    this.addChild(this._iconImage)), this._iconImage.skin = l.onGetImgSkinUrl(l._moreGameData.icon),
                    this._iconImageObj && (this._iconImage.size(this._iconImageObj.width, this._iconImageObj.height),
                        this._iconImage.pivot(this._iconImageObj.width / 2, this._iconImageObj.height / 2),
                        this._iconImage.pos(this._iconImageObj.width / 2, this._iconImageObj.height / 2)),
                    this.visible = !0, this.initEvent(), this.gameStopHD = !1, this.checkIconImgHD()) : this.visible = !1;
            }, h.setIconSize = function (t, e) {
                this._iconImage && (this._iconImage.size(t, e), this._iconImage.pivot(t / 2, e / 2),
                    this._iconImage.pos(t / 2, e / 2)), this._iconImageObj = {
                        width: t,
                        height: e
                    };
            }, l.toLocaleDateString = function (t) {
                return l.getDateFormatStr(t, "/");
            }, l.getDateFormatStr = function (t, e) {
                void 0 === e && (e = "yynndd");
                var i = new Date(t), n = i.getFullYear(), r = i.getMonth() + 1, a = i.getDate(), s = i.getHours(), o = i.getMinutes(), l = i.getSeconds();
                switch (e) {
                    case "yynndd":
                        return n.toString() + "年" + r.toString() + "月" + a.toString() + "日";

                    case "/":
                        return n.toString() + "/" + r.toString() + "/" + a.toString();
                }
                return n.toString() + "年" + r.toString() + "月" + a.toString() + "日" + s.toString() + "时" + o.toString() + "分" + l.toString() + "秒";
            }, l.getDay = function (t) {
                var e = t.getMonth() + 1, i = t.getDate();
                return t.getFullYear() + "" + (e < 10 ? "0" + e : e) + (i < 10 ? "0" + i : i);
            }, l.onGetAtlasDanImgUrl = function (t) {
                return l._moreGameData.imgPath + l._moreGameData.atlas + t + ".png";
            }, l.onGetImgSkinUrl = function (t) {
                return l._moreGameData.imgPath + t;
            }, l.onGetIconImgSkinUrl = function (t) {
                return l._moreGameData.iconPath + t;
            }, l._moreGameData = null, n(l, ["_http", function () {
                return this._http = new o.window.XMLHttpRequest();
            }]), l.__init$ = function () {
                a = function (t) {
                    function e() {
                        this.titleLabel = null, this.gameListBox = null, e.__super.call(this);
                    }
                    r(e, "", t);
                    var i = e.prototype;
                    return i.init = function (t, e, i) {
                        if (this.titleLabel ? this.titleLabel.text = t.title : (this.titleLabel = this.onCreateLabel(t.title, this, 32, "#3d3939"),
                            this.titleLabel.pos(8, 0), this.titleLabel.size(162, 50)), this.gameListBox) for (n = 0,
                                r = this.gameListBox._children.length; n < r; n++) (a = this.gameListBox._children[n]).init(t.gameList[n], e, i); else {
                            this.gameListBox = new V(), this.addChild(this.gameListBox);
                            for (var n = 0, r = t.gameList.length; n < r; n++) {
                                var a = new s();
                                a.init(t.gameList[n], e, i), a.x = 0 + 175 * n, a.y = 65, this.gameListBox.addChild(a);
                            }
                        }
                        this.size(695, 340);
                    }, i.onCreateLabel = function (t, e, i, n, r) {
                        void 0 === i && (i = 26), void 0 === n && (n = "#000000"), void 0 === r && (r = !0);
                        var a = new z();
                        return a.text = t, a.font = "Microsoft YaHei", a.fontSize = i, a.color = n, a.bold = r,
                            a.leading = 10, a.valign = "middle", a.align = "center", a.overflow = "hidden",
                            e.addChild(a), a;
                    }, e;
                }(V), s = function (t) {
                    function e() {
                        this.kuangImg = null, this.iconNameLabel = null, this.iconImg = null, this.playImg = null,
                            this.itemData = null, this.callBackHandler = null, e.__super.call(this);
                    }
                    r(e, "", t);
                    var i = e.prototype;
                    return i.MoveGameItem = function () { }, i.initEvent = function () {
                        this.on("click", this, this.onItemClick);
                    }, i.onItemClick = function () {
                        null != this.callBackHandler && this.callBackHandler.runWith([this.itemData]);
                    }, i.init = function (t, e, i) {
                        if (this.itemData = t, this.callBackHandler = i, this.kuangImg ? this.kuangImg.skin = l.onGetAtlasDanImgUrl("dayuan") : this.kuangImg = this.onCreateImage(l.onGetAtlasDanImgUrl("dayuan"), this),
                            this.iconImg) this.iconImg.skin = l.onGetIconImgSkinUrl(t.icon); else {
                            this.iconImg = this.onCreateImage(l.onGetIconImgSkinUrl(t.icon), this);
                            var n = new x();
                            n.graphics.drawCircle(71, 74, 68, "#ff0000"), this.iconImg.mask = n, this.iconImg.pos(13, 10);
                        }
                        this.iconNameLabel ? this.iconNameLabel.text = t.name : (this.iconNameLabel = this.onCreateLabel(t.name, this, 28, "#3d3939"),
                            this.iconNameLabel.pos(7, 165)), this.playImg ? this.playImg.skin = l.onGetAtlasDanImgUrl("img_play") : (this.playImg = this.onCreateImage(l.onGetAtlasDanImgUrl("img_play"), this),
                                this.playImg.pos(12, 210)), this.size(165, 270), this.initEvent();
                    }, i.onCreateLabel = function (t, e, i, n, r) {
                        void 0 === i && (i = 24), void 0 === n && (n = "#000000"), void 0 === r && (r = !1);
                        var a = new z();
                        return a.text = t, a.font = "Microsoft YaHei", a.fontSize = i, a.color = n, a.bold = r,
                            a.leading = 10, a.valign = "middle", a.align = "center", a.size(152, 44), a.overflow = "hidden",
                            e.addChild(a), a;
                    }, i.onCreateImage = function (t, e) {
                        var i = new G();
                        return i.skin = t, e.addChild(i), i;
                    }, e;
                }(V);
            }, l;
        }(k), Z = function (t) {
            function e() {
                this.closeHandler = null, this.popupEffect = null, this.closeEffect = null, this.group = null,
                    this.isModal = !1, this.isShowEffect = !0, this.isPopupCenter = !0, this.closeType = null,
                    this._dragArea = null, this._param = null, this._effectTween = null, e.__super.call(this),
                    this.popupEffect = e.manager.popupEffectHandler, this.closeEffect = e.manager.closeEffectHandler,
                    this._dealDragArea(), this.on("click", this, this._onClick);
            }
            r(e, "laya.ui.Dialog", t);
            var n = e.prototype;
            return n._dealDragArea = function () {
                var t = this.getChildByName("drag");
                t && (this.dragArea = t._x + "," + t._y + "," + t.width + "," + t.height, t.removeSelf());
            }, n._onMouseDown = function (t) {
                var e = this.getMousePoint();
                this._dragArea.contains(e.x, e.y) ? this.startDrag() : this.stopDrag();
            }, n._onClick = function (t) {
                var e = t.target;
                if (e) switch (e.name) {
                    case "close":
                    case "cancel":
                    case "sure":
                    case "no":
                    case "ok":
                    case "yes":
                        return void this.close(e.name);
                }
            }, n.open = function (t, i) {
                void 0 === t && (t = !0), this._dealDragArea(), this._param = i, e.manager.open(this, t, this.isShowEffect),
                    e.manager.lock(!1);
            }, n.close = function (t) {
                this.closeType = t, e.manager.close(this);
            }, n.destroy = function (e) {
                void 0 === e && (e = !0), this.closeHandler = null, this.popupEffect = null, this.closeEffect = null,
                    this._dragArea = null, t.prototype.destroy.call(this, e);
            }, n.show = function (t, e) {
                void 0 === t && (t = !1), void 0 === e && (e = !0), this._open(!1, t, e);
            }, n.popup = function (t, e) {
                void 0 === t && (t = !1), void 0 === e && (e = !0), this._open(!0, t, e);
            }, n._open = function (t, i, n) {
                this.isModal = t, this.isShowEffect = n, e.manager.lock(!0), this.open(i);
            }, a(0, n, "dragArea", function () {
                return this._dragArea ? this._dragArea.toString() : null;
            }, function (t) {
                if (t) {
                    var e = L.fillArray([0, 0, 0, 0], t, Number);
                    this._dragArea = new T(e[0], e[1], e[2], e[3]), this.on("mousedown", this, this._onMouseDown);
                } else this._dragArea = null, this.off("mousedown", this, this._onMouseDown);
            }), a(0, n, "isPopup", function () {
                return null != this.parent;
            }), a(0, n, "zOrder", t.prototype._$get_zOrder, function (t) {
                i.superSet(k, this, "zOrder", t), e.manager._checkMask();
            }), a(1, e, "manager", function () {
                return e._manager = e._manager || new F();
            }, function (t) {
                e._manager = t;
            }), e.setLockView = function (t) {
                e.manager.setLockView(t);
            }, e.lock = function (t) {
                e.manager.lock(t);
            }, e.closeAll = function () {
                e.manager.closeAll();
            }, e.getDialogsByGroup = function (t) {
                return e.manager.getDialogsByGroup(t);
            }, e.closeByGroup = function (t) {
                return e.manager.closeByGroup(t);
            }, e.CLOSE = "close", e.CANCEL = "cancel", e.SURE = "sure", e.NO = "no", e.YES = "yes",
                e.OK = "ok", e._manager = null, e;
        }(k), Q = function (t) {
            function e() {
                this._items = null, this._selectedIndex = 0, e.__super.call(this), this._setIndexHandler = f.create(this, this.setIndex, null, !1);
            }
            r(e, "laya.ui.ViewStack", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.ui.IItem": !0
            }), n.setItems = function (t) {
                this.removeChildren();
                for (var e = 0, i = 0, n = t.length; i < n; i++) {
                    var r = t[i];
                    r && (r.name = "item" + e, this.addChild(r), e++);
                }
                this.initItems();
            }, n.addItem = function (t) {
                t.name = "item" + this._items.length, this.addChild(t), this.initItems();
            }, n._afterInited = function () {
                this.initItems();
            }, n.initItems = function () {
                this._items = [];
                for (var t = 0; t < 1e4; t++) {
                    var e = this.getChildByName("item" + t);
                    if (null == e) break;
                    this._items.push(e), e.visible = t == this._selectedIndex;
                }
            }, n.setSelect = function (t, e) {
                this._items && t > -1 && t < this._items.length && (this._items[t].visible = e);
            }, n.setIndex = function (t) {
                this.selectedIndex = t;
            }, a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                if (this._dataSource = t, "number" == typeof t && Math.floor(t) == t || "string" == typeof t) this.selectedIndex = parseInt(t); else for (var e in this._dataSource) this.hasOwnProperty(e) && (this[e] = this._dataSource[e]);
            }), a(0, n, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                this._selectedIndex != t && (this.setSelect(this._selectedIndex, !1), this._selectedIndex = t,
                    this.setSelect(this._selectedIndex, !0));
            }), a(0, n, "selection", function () {
                return this._selectedIndex > -1 && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] : null;
            }, function (t) {
                this.selectedIndex = this._items.indexOf(t);
            }), a(0, n, "items", function () {
                return this._items;
            }), a(0, n, "setIndexHandler", function () {
                return this._setIndexHandler;
            }, function (t) {
                this._setIndexHandler = t;
            }), e;
        }(V), J = function (t) {
            function e() {
                this._space = 0, this._align = "none", this._itemChanged = !1, e.__super.call(this);
            }
            r(e, "laya.ui.LayoutBox", t);
            var i = e.prototype;
            return i.addChild = function (t) {
                return t.on("resize", this, this.onResize), this._setItemChanged(), laya.display.Node.prototype.addChild.call(this, t);
            }, i.onResize = function (t) {
                this._setItemChanged();
            }, i.addChildAt = function (t, e) {
                return t.on("resize", this, this.onResize), this._setItemChanged(), laya.display.Node.prototype.addChildAt.call(this, t, e);
            }, i.removeChildAt = function (t) {
                return this.getChildAt(t).off("resize", this, this.onResize), this._setItemChanged(),
                    laya.display.Node.prototype.removeChildAt.call(this, t);
            }, i.refresh = function () {
                this._setItemChanged();
            }, i.changeItems = function () {
                this._itemChanged = !1;
            }, i.sortItem = function (t) {
                t && t.sort(function (t, e) {
                    return t.y - e.y;
                });
            }, i._setItemChanged = function () {
                this._itemChanged || (this._itemChanged = !0, this.callLater(this.changeItems));
            }, a(0, i, "space", function () {
                return this._space;
            }, function (t) {
                this._space = t, this._setItemChanged();
            }), a(0, i, "align", function () {
                return this._align;
            }, function (t) {
                this._align = t, this._setItemChanged();
            }), e;
        }(V), $ = function (t) {
            function e(t, i) {
                this.selectHandler = null, this._items = null, this._selectedIndex = -1, this._skin = null,
                    this._direction = "horizontal", this._space = 0, this._labels = null, this._labelColors = null,
                    this._labelFont = null, this._labelStrokeColor = null, this._strokeColors = null,
                    this._labelStroke = NaN, this._labelSize = 0, this._labelBold = !1, this._labelPadding = null,
                    this._labelAlign = null, this._stateNum = 0, this._labelChanged = !1, e.__super.call(this),
                    this.skin = i, this.labels = t;
            }
            r(e, "laya.ui.UIGroup", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.ui.IItem": !0
            }), n.preinitialize = function () {
                this.mouseEnabled = !0;
            }, n.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._items && (this._items.length = 0),
                    this._items = null, this.selectHandler = null;
            }, n.addItem = function (t, e) {
                void 0 === e && (e = !0);
                var i = t, n = this._items.length;
                if (i.name = "item" + n, this.addChild(i), this.initItems(), e && n > 0) {
                    var r = this._items[n - 1];
                    "horizontal" == this._direction ? i.x = r._x + r.width + this._space : i.y = r._y + r.height + this._space;
                } else e && (i.x = 0, i.y = 0);
                return n;
            }, n.delItem = function (t, e) {
                void 0 === e && (e = !0);
                var i = this._items.indexOf(t);
                if (-1 != i) {
                    var n = t;
                    this.removeChild(n);
                    for (var r = i + 1, a = this._items.length; r < a; r++) {
                        var s = this._items[r];
                        s.name = "item" + (r - 1), e && ("horizontal" == this._direction ? s.x -= n.width + this._space : s.y -= n.height + this._space);
                    }
                    if (this.initItems(), this._selectedIndex > -1) {
                        var o;
                        o = this._selectedIndex < this._items.length ? this._selectedIndex : this._selectedIndex - 1,
                            this._selectedIndex = -1, this.selectedIndex = o;
                    }
                }
            }, n._afterInited = function () {
                this.initItems();
            }, n.initItems = function () {
                this._items || (this._items = []), this._items.length = 0;
                for (var t = 0; t < 1e4; t++) {
                    var e = this.getChildByName("item" + t);
                    if (null == e) break;
                    this._items.push(e), e.selected = t === this._selectedIndex, e.clickHandler = f.create(this, this.itemClick, [t], !1);
                }
            }, n.itemClick = function (t) {
                this.selectedIndex = t;
            }, n.setSelect = function (t, e) {
                this._items && t > -1 && t < this._items.length && (this._items[t].selected = e);
            }, n._skinLoaded = function () {
                this._setLabelChanged(), this.event("loaded");
            }, n.createItem = function (t, e) {
                return null;
            }, n.changeLabels = function () {
                if (this._labelChanged = !1, this._items) for (var t = 0, e = 0, i = this._items.length; e < i; e++) {
                    var n = this._items[e];
                    this._skin && (n.skin = this._skin), this._labelColors && (n.labelColors = this._labelColors),
                        this._labelSize && (n.labelSize = this._labelSize), this._labelStroke && (n.labelStroke = this._labelStroke),
                        this._labelStrokeColor && (n.labelStrokeColor = this._labelStrokeColor), this._strokeColors && (n.strokeColors = this._strokeColors),
                        this._labelBold && (n.labelBold = this._labelBold), this._labelPadding && (n.labelPadding = this._labelPadding),
                        this._labelAlign && (n.labelAlign = this._labelAlign), this._stateNum && (n.stateNum = this._stateNum),
                        this._labelFont && (n.labelFont = this._labelFont), "horizontal" === this._direction ? (n.y = 0,
                            n.x = t, t += n.width + this._space) : (n.x = 0, n.y = t, t += n.height + this._space);
                }
                this._sizeChanged();
            }, n.commitMeasure = function () {
                this.runCallLater(this.changeLabels);
            }, n._setLabelChanged = function () {
                this._labelChanged || (this._labelChanged = !0, this.callLater(this.changeLabels));
            }, a(0, n, "labelStrokeColor", function () {
                return this._labelStrokeColor;
            }, function (t) {
                this._labelStrokeColor != t && (this._labelStrokeColor = t, this._setLabelChanged());
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !g.getRes(this._skin) ? i.loader.load(this._skin, f.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded());
            }), a(0, n, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                this._selectedIndex != t && (this.setSelect(this._selectedIndex, !1), this._selectedIndex = t,
                    this.setSelect(t, !0), this.event("change"), this.selectHandler && this.selectHandler.runWith(this._selectedIndex));
            }), a(0, n, "labels", function () {
                return this._labels;
            }, function (t) {
                if (this._labels != t) {
                    if (this._labels = t, this.removeChildren(), this._setLabelChanged(), this._labels) for (var e = this._labels.split(","), i = 0, n = e.length; i < n; i++) {
                        var r = this.createItem(this._skin, e[i]);
                        r.name = "item" + i, this.addChild(r);
                    }
                    this.initItems();
                }
            }), a(0, n, "strokeColors", function () {
                return this._strokeColors;
            }, function (t) {
                this._strokeColors != t && (this._strokeColors = t, this._setLabelChanged());
            }), a(0, n, "labelColors", function () {
                return this._labelColors;
            }, function (t) {
                this._labelColors != t && (this._labelColors = t, this._setLabelChanged());
            }), a(0, n, "labelStroke", function () {
                return this._labelStroke;
            }, function (t) {
                this._labelStroke != t && (this._labelStroke = t, this._setLabelChanged());
            }), a(0, n, "labelSize", function () {
                return this._labelSize;
            }, function (t) {
                this._labelSize != t && (this._labelSize = t, this._setLabelChanged());
            }), a(0, n, "stateNum", function () {
                return this._stateNum;
            }, function (t) {
                this._stateNum != t && (this._stateNum = t, this._setLabelChanged());
            }), a(0, n, "labelBold", function () {
                return this._labelBold;
            }, function (t) {
                this._labelBold != t && (this._labelBold = t, this._setLabelChanged());
            }), a(0, n, "labelFont", function () {
                return this._labelFont;
            }, function (t) {
                this._labelFont != t && (this._labelFont = t, this._setLabelChanged());
            }), a(0, n, "labelPadding", function () {
                return this._labelPadding;
            }, function (t) {
                this._labelPadding != t && (this._labelPadding = t, this._setLabelChanged());
            }), a(0, n, "direction", function () {
                return this._direction;
            }, function (t) {
                this._direction = t, this._setLabelChanged();
            }), a(0, n, "space", function () {
                return this._space;
            }, function (t) {
                this._space = t, this._setLabelChanged();
            }), a(0, n, "items", function () {
                return this._items;
            }), a(0, n, "selection", function () {
                return this._selectedIndex > -1 && this._selectedIndex < this._items.length ? this._items[this._selectedIndex] : null;
            }, function (t) {
                this.selectedIndex = this._items.indexOf(t);
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.labels = t.join(",") : i.superSet(V, this, "dataSource", t);
            }), e;
        }(V), tt = function (t) {
            function e(t, i) {
                void 0 === i && (i = ""), e.__super.call(this, t, i);
            }
            r(e, "laya.ui.CheckBox", t);
            var n = e.prototype;
            return n.preinitialize = function () {
                laya.ui.UIComponent.prototype.preinitialize.call(this), this.toggle = !0, this._autoSize = !1;
            }, n.initialize = function () {
                t.prototype.initialize.call(this), this.createText(), this._text.align = "left",
                    this._text.valign = "top", this._text.width = 0;
            }, a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "boolean" == typeof t ? this.selected = t : "string" == typeof t ? this.selected = "true" === t : i.superSet(U, this, "dataSource", t);
            }), e;
        }(U), et = function (t) {
            function e() {
                this._list = null, this._source = null, this._renderHandler = null, this._spaceLeft = 10,
                    this._spaceBottom = 0, this._keepStatus = !0, e.__super.call(this), this.width = this.height = 200;
            }
            r(e, "laya.ui.Tree", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.ui.IRender": !0
            }), n.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._list && this._list.destroy(t),
                    this._list = null, this._source = null, this._renderHandler = null;
            }, n.createChildren = function () {
                this.addChild(this._list = new nt()), this._list.renderHandler = f.create(this, this.renderItem, null, !1),
                    this._list.repeatX = 1, this._list.on("change", this, this.onListChange);
            }, n.onListChange = function (t) {
                this.event("change");
            }, n.getArray = function () {
                var t, e = [];
                for (var i in this._source) t = this._source[i], this.getParentOpenStatus(t) && (t.x = this._spaceLeft * this.getDepth(t),
                    e.push(t));
                return e;
            }, n.getDepth = function (t, e) {
                return void 0 === e && (e = 0), null == t.nodeParent ? e : this.getDepth(t.nodeParent, e + 1);
            }, n.getParentOpenStatus = function (t) {
                var e = t.nodeParent;
                return null == e || !!e.isOpen && (null == e.nodeParent || this.getParentOpenStatus(e));
            }, n.renderItem = function (t, e) {
                var i = t.dataSource;
                if (i) {
                    t.left = i.x;
                    var n = t.getChildByName("arrow");
                    n && (i.hasChild ? (n.visible = !0, n.index = i.isOpen ? 1 : 0, n.tag = e, n.off("click", this, this.onArrowClick),
                        n.on("click", this, this.onArrowClick)) : n.visible = !1);
                    var r = t.getChildByName("folder");
                    r && (2 == r.clipY ? r.index = i.isDirectory ? 0 : 1 : r.index = i.isDirectory ? i.isOpen ? 1 : 0 : 2),
                        this._renderHandler && this._renderHandler.runWith([t, e]);
                }
            }, n.onArrowClick = function (t) {
                var e = t.currentTarget.tag;
                this._list.array[e].isOpen = !this._list.array[e].isOpen, this.event("open"), this._list.array = this.getArray();
            }, n.setItemState = function (t, e) {
                this._list.array[t] && (this._list.array[t].isOpen = e, this._list.array = this.getArray());
            }, n.fresh = function () {
                this._list.array = this.getArray(), this.repaint();
            }, n.parseXml = function (t, e, i, n) {
                var r, a = t.childNodes, s = a.length;
                if (!n) {
                    r = {};
                    var o, l = t.attributes;
                    for (var h in l) {
                        var u = (o = l[h]).nodeName, c = o.nodeValue;
                        r[u] = "true" == c || "false" != c && c;
                    }
                    r.nodeParent = i, s > 0 && (r.isDirectory = !0), r.hasChild = s > 0, e.push(r);
                }
                for (var d = 0; d < s; d++) {
                    var _ = a[d];
                    this.parseXml(_, e, r, !1);
                }
            }, n.parseOpenStatus = function (t, e) {
                for (var i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    if (r.isDirectory) for (var a = 0, s = t.length; a < s; a++) {
                        var o = t[a];
                        if (o.isDirectory && this.isSameParent(o, r) && r.label == o.label) {
                            r.isOpen = o.isOpen;
                            break;
                        }
                    }
                }
            }, n.isSameParent = function (t, e) {
                return null == t.nodeParent && null == e.nodeParent || null != t.nodeParent && null != e.nodeParent && (t.nodeParent.label == e.nodeParent.label && this.isSameParent(t.nodeParent, e.nodeParent));
            }, n.filter = function (t) {
                if (Boolean(t)) {
                    var e = [];
                    this.getFilterSource(this._source, e, t), this._list.array = e;
                } else this._list.array = this.getArray();
            }, n.getFilterSource = function (t, e, i) {
                var n;
                for (var r in i = i.toLocaleLowerCase(), t) !(n = t[r]).isDirectory && String(n.label).toLowerCase().indexOf(i) > -1 && (n.x = 0,
                    e.push(n)), n.child && n.child.length > 0 && this.getFilterSource(n.child, e, i);
            }, a(0, n, "spaceBottom", function () {
                return this._list.spaceY;
            }, function (t) {
                this._list.spaceY = t;
            }), a(0, n, "keepStatus", function () {
                return this._keepStatus;
            }, function (t) {
                this._keepStatus = t;
            }), a(0, n, "itemRender", function () {
                return this._list.itemRender;
            }, function (t) {
                this._list.itemRender = t;
            }), a(0, n, "array", function () {
                return this._list.array;
            }, function (t) {
                this._keepStatus && this._list.array && t && this.parseOpenStatus(this._list.array, t),
                    this._source = t, this._list.array = this.getArray();
            }), a(0, n, "mouseHandler", function () {
                return this._list.mouseHandler;
            }, function (t) {
                this._list.mouseHandler = t;
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, i.superSet(V, this, "dataSource", t);
            }), a(0, n, "source", function () {
                return this._source;
            }), a(0, n, "scrollBar", function () {
                return this._list.scrollBar;
            }), a(0, n, "list", function () {
                return this._list;
            }), a(0, n, "scrollBarSkin", function () {
                return this._list.vScrollBarSkin;
            }, function (t) {
                this._list.vScrollBarSkin = t;
            }), a(0, n, "renderHandler", function () {
                return this._renderHandler;
            }, function (t) {
                this._renderHandler = t;
            }), a(0, n, "selectedIndex", function () {
                return this._list.selectedIndex;
            }, function (t) {
                this._list.selectedIndex = t;
            }), a(0, n, "spaceLeft", function () {
                return this._spaceLeft;
            }, function (t) {
                this._spaceLeft = t;
            }), a(0, n, "selectedItem", function () {
                return this._list.selectedItem;
            }, function (t) {
                this._list.selectedItem = t;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(V, this, "width", t), this._list.width = t;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(V, this, "height", t), this._list.height = t;
            }), a(0, n, "xml", null, function (t) {
                var e = [];
                this.parseXml(t.childNodes[0], e, null, !0), this.array = e;
            }), a(0, n, "selectedPath", function () {
                return this._list.selectedItem ? this._list.selectedItem.path : null;
            }), e;
        }(V), it = function (t) {
            function e() {
                this._content = null, this._vScrollBar = null, this._hScrollBar = null, this._scrollChanged = !1,
                    this._usedCache = null, this._elasticEnabled = !1, e.__super.call(this), this.width = this.height = 100;
            }
            r(e, "laya.ui.Panel", t);
            var n = e.prototype;
            return n.destroy = function (t) {
                void 0 === t && (t = !0), laya.ui.UIComponent.prototype.destroy.call(this, t), this._content && this._content.destroy(t),
                    this._vScrollBar && this._vScrollBar.destroy(t), this._hScrollBar && this._hScrollBar.destroy(t),
                    this._vScrollBar = null, this._hScrollBar = null, this._content = null;
            }, n.destroyChildren = function () {
                this._content.destroyChildren();
            }, n.createChildren = function () {
                laya.display.Node.prototype.addChild.call(this, this._content = new V());
            }, n.addChild = function (t) {
                return t.on("resize", this, this.onResize), this._setScrollChanged(), this._content.addChild(t);
            }, n.onResize = function () {
                this._setScrollChanged();
            }, n.addChildAt = function (t, e) {
                return t.on("resize", this, this.onResize), this._setScrollChanged(), this._content.addChildAt(t, e);
            }, n.removeChild = function (t) {
                return t.off("resize", this, this.onResize), this._setScrollChanged(), this._content.removeChild(t);
            }, n.removeChildAt = function (t) {
                return this.getChildAt(t).off("resize", this, this.onResize), this._setScrollChanged(),
                    this._content.removeChildAt(t);
            }, n.removeChildren = function (t, e) {
                return void 0 === t && (t = 0), void 0 === e && (e = 2147483647), this._content.removeChildren(t, e),
                    this._setScrollChanged(), this;
            }, n.getChildAt = function (t) {
                return this._content.getChildAt(t);
            }, n.getChildByName = function (t) {
                return this._content.getChildByName(t);
            }, n.getChildIndex = function (t) {
                return this._content.getChildIndex(t);
            }, n.changeScroll = function () {
                this._scrollChanged = !1;
                var t = this.contentWidth || 1, e = this.contentHeight || 1, i = this._vScrollBar, n = this._hScrollBar, r = i && e > this._height, a = n && t > this._width, s = r ? this._width - i.width : this._width, o = a ? this._height - n.height : this._height;
                i && (i.x = this._width - i.width, i.y = 0, i.height = this._height - (a ? n.height : 0),
                    i.scrollSize = Math.max(.033 * this._height, 1), i.thumbPercent = o / e, i.setScroll(0, e - o, i.value)),
                    n && (n.x = 0, n.y = this._height - n.height, n.width = this._width - (r ? i.width : 0),
                        n.scrollSize = Math.max(.033 * this._width, 1), n.thumbPercent = s / t, n.setScroll(0, t - s, n.value));
            }, n._sizeChanged = function () {
                laya.ui.UIComponent.prototype._sizeChanged.call(this), this.setContentSize(this._width, this._height);
            }, n.setContentSize = function (t, e) {
                var i = this._content;
                i.width = t, i.height = e, i._style.scrollRect || (i.scrollRect = T.create()), i._style.scrollRect.setTo(0, 0, t, e),
                    i.scrollRect = i.scrollRect;
            }, n.onScrollBarChange = function (t) {
                var e = this._content._style.scrollRect;
                if (e) {
                    var i = Math.round(t.value);
                    t.isVertical ? e.y = i : e.x = i, this._content.scrollRect = e;
                }
            }, n.scrollTo = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), this.vScrollBar && (this.vScrollBar.value = e),
                    this.hScrollBar && (this.hScrollBar.value = t);
            }, n.refresh = function () {
                this.changeScroll();
            }, n.onScrollStart = function () {
                this._usedCache || (this._usedCache = i.superGet(V, this, "cacheAs")), i.superSet(V, this, "cacheAs", "none"),
                    this._hScrollBar && this._hScrollBar.once("end", this, this.onScrollEnd), this._vScrollBar && this._vScrollBar.once("end", this, this.onScrollEnd);
            }, n.onScrollEnd = function () {
                i.superSet(V, this, "cacheAs", this._usedCache);
            }, n._setScrollChanged = function () {
                this._scrollChanged || (this._scrollChanged = !0, this.callLater(this.changeScroll));
            }, a(0, n, "numChildren", function () {
                return this._content.numChildren;
            }), a(0, n, "hScrollBarSkin", function () {
                return this._hScrollBar ? this._hScrollBar.skin : null;
            }, function (t) {
                null == this._hScrollBar && (laya.display.Node.prototype.addChild.call(this, this._hScrollBar = new ut()),
                    this._hScrollBar.on("change", this, this.onScrollBarChange, [this._hScrollBar]),
                    this._hScrollBar.target = this._content, this._hScrollBar.elasticDistance = this._elasticEnabled ? 200 : 0,
                    this._setScrollChanged()), this._hScrollBar.skin = t;
            }), a(0, n, "contentWidth", function () {
                for (var t = 0, e = this._content.numChildren - 1; e > -1; e--) {
                    var i = this._content.getChildAt(e);
                    t = Math.max(i._x + i.width * i.scaleX - i.pivotX, t);
                }
                return t;
            }), a(0, n, "contentHeight", function () {
                for (var t = 0, e = this._content.numChildren - 1; e > -1; e--) {
                    var i = this._content.getChildAt(e);
                    t = Math.max(i._y + i.height * i.scaleY - i.pivotY, t);
                }
                return t;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(V, this, "width", t), this._setScrollChanged();
            }), a(0, n, "hScrollBar", function () {
                return this._hScrollBar;
            }), a(0, n, "content", function () {
                return this._content;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(V, this, "height", t), this._setScrollChanged();
            }), a(0, n, "vScrollBarSkin", function () {
                return this._vScrollBar ? this._vScrollBar.skin : null;
            }, function (t) {
                null == this._vScrollBar && (laya.display.Node.prototype.addChild.call(this, this._vScrollBar = new lt()),
                    this._vScrollBar.on("change", this, this.onScrollBarChange, [this._vScrollBar]),
                    this._vScrollBar.target = this._content, this._vScrollBar.elasticDistance = this._elasticEnabled ? 200 : 0,
                    this._setScrollChanged()), this._vScrollBar.skin = t;
            }), a(0, n, "vScrollBar", function () {
                return this._vScrollBar;
            }), a(0, n, "cacheAs", t.prototype._$get_cacheAs, function (t) {
                i.superSet(V, this, "cacheAs", t), this._usedCache = null, "none" !== t ? (this._hScrollBar && this._hScrollBar.on("start", this, this.onScrollStart),
                    this._vScrollBar && this._vScrollBar.on("start", this, this.onScrollStart)) : (this._hScrollBar && this._hScrollBar.off("start", this, this.onScrollStart),
                        this._vScrollBar && this._vScrollBar.off("start", this, this.onScrollStart));
            }), a(0, n, "elasticEnabled", function () {
                return this._elasticEnabled;
            }, function (t) {
                this._elasticEnabled = t, this._vScrollBar && (this._vScrollBar.elasticDistance = t ? 200 : 0),
                    this._hScrollBar && (this._hScrollBar.elasticDistance = t ? 200 : 0);
            }), e;
        }(V), nt = function (t) {
            function e() {
                this.selectHandler = null, this.renderHandler = null, this.mouseHandler = null,
                    this.selectEnable = !1, this.totalPage = 0, this._$componentType = "List", this._content = null,
                    this._scrollBar = null, this._itemRender = null, this._repeatX = 0, this._repeatY = 0,
                    this._repeatX2 = 0, this._repeatY2 = 0, this._spaceX = 0, this._spaceY = 0, this._array = null,
                    this._startIndex = 0, this._selectedIndex = -1, this._page = 0, this._isVertical = !0,
                    this._cellSize = 20, this._cellOffset = 0, this._isMoved = !1, this.cacheContent = !1,
                    this._createdLine = 0, this._cellChanged = !1, this._usedCache = null, this._elasticEnabled = !1,
                    this._preLen = 0, e.__super.call(this), this._cells = [], this._offset = new S();
            }
            r(e, "laya.ui.List", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.ui.IRender": !0,
                "laya.ui.IItem": !0
            }), n.destroy = function (t) {
                void 0 === t && (t = !0), this._content && this._content.destroy(t), this._scrollBar && this._scrollBar.destroy(t),
                    laya.ui.UIComponent.prototype.destroy.call(this, t), this._content = null, this._scrollBar = null,
                    this._itemRender = null, this._cells = null, this._array = null, this.selectHandler = this.renderHandler = this.mouseHandler = null;
            }, n.createChildren = function () {
                this.addChild(this._content = new V());
            }, n.onScrollStart = function () {
                this._usedCache || (this._usedCache = i.superGet(V, this, "cacheAs")), i.superSet(V, this, "cacheAs", "none"),
                    this._scrollBar.once("end", this, this.onScrollEnd);
            }, n.onScrollEnd = function () {
                i.superSet(V, this, "cacheAs", this._usedCache);
            }, n._removePreScrollBar = function () {
                var t = this.removeChildByName("scrollBar");
                t && t.destroy(!0);
            }, n.changeCells = function () {
                if (this._cellChanged = !1, this._itemRender) {
                    this.scrollBar = this.getChildByName("scrollBar");
                    var t = this._getOneCell(), e = t.width + this._spaceX || 1, i = t.height + this._spaceY || 1;
                    this._width > 0 && (this._repeatX2 = this._isVertical ? Math.round(this._width / e) : Math.ceil(this._width / e)),
                        this._height > 0 && (this._repeatY2 = this._isVertical ? Math.ceil(this._height / i) : Math.round(this._height / i));
                    var n = this._width ? this._width : e * this.repeatX - this._spaceX, r = this._height ? this._height : i * this.repeatY - this._spaceY;
                    this._cellSize = this._isVertical ? i : e, this._cellOffset = this._isVertical ? i * Math.max(this._repeatY2, this._repeatY) - r - this._spaceY : e * Math.max(this._repeatX2, this._repeatX) - n - this._spaceX,
                        this._isVertical && this.vScrollBarSkin ? this._scrollBar.height = r : !this._isVertical && this.hScrollBarSkin && (this._scrollBar.width = n),
                        this.setContentSize(n, r);
                    var a = this._isVertical ? this.repeatX : this.repeatY, s = (this._isVertical ? this.repeatY : this.repeatX) + (this._scrollBar ? 1 : 0);
                    this._createItems(0, a, s), this._createdLine = s, this._array && (this.array = this._array,
                        this.runCallLater(this.renderItems));
                }
            }, n._getOneCell = function () {
                if (0 === this._cells.length) {
                    var t = this.createItem();
                    if (this._offset.setTo(t._x, t._y), this.cacheContent) return t;
                    this._cells.push(t);
                }
                return this._cells[0];
            }, n._createItems = function (t, e, i) {
                var n = this._content, r = this._getOneCell(), a = r.width + this._spaceX, s = r.height + this._spaceY;
                if (this.cacheContent) {
                    var o = new V();
                    o.cacheAs = "normal", o.pos((this._isVertical ? 0 : t) * a, (this._isVertical ? t : 0) * s),
                        this._content.addChild(o), n = o;
                } else {
                    for (var l = [], h = this._cells.length - 1; h > -1; h--) {
                        var u = this._cells[h];
                        u.removeSelf(), l.push(u);
                    }
                    this._cells.length = 0;
                }
                for (var c = t; c < i; c++) for (var d = 0; d < e; d++) (r = l && l.length ? l.pop() : this.createItem()).x = (this._isVertical ? d : c) * a - n._x,
                    r.y = (this._isVertical ? c : d) * s - n._y, r.name = "item" + (c * e + d), n.addChild(r),
                    this.addCell(r);
            }, n.createItem = function () {
                var t = [];
                if ("function" == typeof this._itemRender) var e = new this._itemRender(); else e = C.createComp(this._itemRender, null, null, t);
                if (0 == t.length && e._watchMap) {
                    var i = e._watchMap;
                    for (var n in i) for (var r = i[n], a = 0; a < r.length; a++) {
                        var s = r[a];
                        t.push(s.comp, s.prop, s.value);
                    }
                }
                return t.length && (e._$bindData = t), e;
            }, n.addCell = function (t) {
                t.on("click", this, this.onCellMouse), t.on("rightclick", this, this.onCellMouse),
                    t.on("mouseover", this, this.onCellMouse), t.on("mouseout", this, this.onCellMouse),
                    t.on("mousedown", this, this.onCellMouse), t.on("mouseup", this, this.onCellMouse),
                    this._cells.push(t);
            }, n._afterInited = function () {
                this.initItems();
            }, n.initItems = function () {
                if (!this._itemRender && null != this.getChildByName("item0")) {
                    this.repeatX = 1;
                    var t = 0;
                    t = 0;
                    for (var e = 0; e < 1e4; e++) {
                        var i = this.getChildByName("item" + e);
                        if (!i) break;
                        this.addCell(i), t++;
                    }
                    this.repeatY = t;
                }
            }, n.setContentSize = function (t, e) {
                this._content.width = t, this._content.height = e, (this._scrollBar || 0 != this._offset.x || 0 != this._offset.y) && (this._content._style.scrollRect || (this._content.scrollRect = T.create()),
                    this._content._style.scrollRect.setTo(-this._offset.x, -this._offset.y, t, e), this._content.scrollRect = this._content.scrollRect),
                    this.event("resize");
            }, n.onCellMouse = function (t) {
                "mousedown" === t.type && (this._isMoved = !1);
                var e = t.currentTarget, i = this._startIndex + this._cells.indexOf(e);
                i < 0 || ("click" === t.type || "rightclick" === t.type ? this.selectEnable && !this._isMoved ? this.selectedIndex = i : this.changeCellState(e, !0, 0) : "mouseover" !== t.type && "mouseout" !== t.type || this._selectedIndex === i || this.changeCellState(e, "mouseover" === t.type, 0),
                    this.mouseHandler && this.mouseHandler.runWith([t, i]));
            }, n.changeCellState = function (t, e, i) {
                var n = t.getChildByName("selectBox");
                n && (this.selectEnable = !0, n.visible = e, n.index = i);
            }, n._sizeChanged = function () {
                laya.ui.UIComponent.prototype._sizeChanged.call(this), this.setContentSize(this.width, this.height),
                    this._scrollBar && this.callLater(this.onScrollBarChange);
            }, n.onScrollBarChange = function (t) {
                this.runCallLater(this.changeCells);
                var e = this._scrollBar.value, i = this._isVertical ? this.repeatX : this.repeatY, n = this._isVertical ? this.repeatY : this.repeatX, r = Math.floor(e / this._cellSize);
                if (this.cacheContent) s = n + 1, this._createdLine - r < s && (this._createItems(this._createdLine, i, this._createdLine + s),
                    this.renderItems(this._createdLine * i, 0), this._createdLine += s); else {
                    var a = r * i, s = 0;
                    if (a > this._startIndex) {
                        s = a - this._startIndex;
                        var o = !0, l = this._startIndex + i * (n + 1);
                        this._isMoved = !0;
                    } else a < this._startIndex && (s = this._startIndex - a, o = !1, l = this._startIndex - 1,
                        this._isMoved = !0);
                    for (var h = 0; h < s; h++) {
                        if (o) {
                            var u = this._cells.shift();
                            this._cells[this._cells.length] = u;
                            var c = l + h;
                        } else u = this._cells.pop(), this._cells.unshift(u), c = l - h;
                        var d = Math.floor(c / i) * this._cellSize;
                        this._isVertical ? u.y = d : u.x = d, this.renderItem(u, c);
                    }
                    this._startIndex = a, this.changeSelectStatus();
                }
                var _ = this._content._style.scrollRect;
                this._isVertical ? (_.y = e - this._offset.y, _.x = -this._offset.x) : (_.y = -this._offset.y,
                    _.x = e - this._offset.x), this._content.scrollRect = _;
            }, n.posCell = function (t, e) {
                if (this._scrollBar) {
                    var i = this._isVertical ? this.repeatX : this.repeatY, n = (this._isVertical ? this.repeatY : this.repeatX,
                        Math.floor(e / i) * this._cellSize);
                    this._isVertical ? t._y = n : t.x = n;
                }
            }, n.changeSelectStatus = function () {
                for (var t = 0, e = this._cells.length; t < e; t++) this.changeCellState(this._cells[t], this._selectedIndex === this._startIndex + t, 1);
            }, n.renderItems = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = 0);
                for (var i = t, n = e || this._cells.length; i < n; i++) this.renderItem(this._cells[i], this._startIndex + i);
                this.changeSelectStatus();
            }, n.renderItem = function (t, e) {
                this._array && e >= 0 && e < this._array.length ? (t.visible = !0, t._$bindData ? (t._dataSource = this._array[e],
                    this._bindData(t, this._array[e])) : t.dataSource = this._array[e], this.cacheContent || this.posCell(t, e),
                    this.hasListener("render") && this.event("render", [t, e]), this.renderHandler && this.renderHandler.runWith([t, e])) : (t.visible = !1,
                        t.dataSource = null);
            }, n._bindData = function (t, e) {
                for (var i = t._$bindData, n = 0, r = i.length; n < r; n++) {
                    var a = i[n++], s = i[n++], o = i[n], l = L.getBindFun(o);
                    a[s] = l.call(this, e);
                }
            }, n.updateArray = function (t) {
                this._array = t;
                var e = 0;
                if (this._array && ((e = this._preLen - this._startIndex) >= 0 && this.renderItems(e),
                    this._preLen = this._array.length), this._scrollBar) {
                    var i = t.length, n = this._isVertical ? this.repeatX : this.repeatY, r = this._isVertical ? this.repeatY : this.repeatX, a = Math.ceil(i / n);
                    a >= r && (this._scrollBar.thumbPercent = r / a, this._scrollBar.slider._max = (a - r) * this._cellSize + this._cellOffset);
                }
            }, n.refresh = function () {
                this.array = this._array;
            }, n.getItem = function (t) {
                return t > -1 && t < this._array.length ? this._array[t] : null;
            }, n.changeItem = function (t, e) {
                t > -1 && t < this._array.length && (this._array[t] = e, t >= this._startIndex && t < this._startIndex + this._cells.length && this.renderItem(this.getCell(t), t));
            }, n.setItem = function (t, e) {
                this.changeItem(t, e);
            }, n.addItem = function (t) {
                this._array.push(t), this.array = this._array;
            }, n.addItemAt = function (t, e) {
                this._array.splice(e, 0, t), this.array = this._array;
            }, n.deleteItem = function (t) {
                this._array.splice(t, 1), this.array = this._array;
            }, n.getCell = function (t) {
                return this.runCallLater(this.changeCells), t > -1 && this._cells ? this._cells[(t - this._startIndex) % this._cells.length] : null;
            }, n.scrollTo = function (t) {
                if (this._scrollBar) {
                    var e = this._isVertical ? this.repeatX : this.repeatY;
                    this._scrollBar.value = Math.floor(t / e) * this._cellSize;
                } else this.startIndex = t;
            }, n.tweenTo = function (t, e, i) {
                if (void 0 === e && (e = 200), this._scrollBar) {
                    this._scrollBar.stopScroll();
                    var n = this._isVertical ? this.repeatX : this.repeatY;
                    A.to(this._scrollBar, {
                        value: Math.floor(t / n) * this._cellSize
                    }, e, null, i, 0, !0);
                } else this.startIndex = t, i && i.run();
            }, n._setCellChanged = function () {
                this._cellChanged || (this._cellChanged = !0, this.callLater(this.changeCells));
            }, n.commitMeasure = function () {
                this.runCallLater(this.changeCells);
            }, a(0, n, "cacheAs", t.prototype._$get_cacheAs, function (t) {
                i.superSet(V, this, "cacheAs", t), this._scrollBar && (this._usedCache = null, "none" !== t ? this._scrollBar.on("start", this, this.onScrollStart) : this._scrollBar.off("start", this, this.onScrollStart));
            }), a(0, n, "content", function () {
                return this._content;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                t != this._height && (i.superSet(V, this, "height", t), this._setCellChanged());
            }), a(0, n, "itemRender", function () {
                return this._itemRender;
            }, function (t) {
                if (this._itemRender != t) {
                    this._itemRender = t;
                    for (var e = this._cells.length - 1; e > -1; e--) this._cells[e].destroy();
                    this._cells.length = 0, this._setCellChanged();
                }
            }), a(0, n, "vScrollBarSkin", function () {
                return this._scrollBar ? this._scrollBar.skin : null;
            }, function (t) {
                this._removePreScrollBar();
                var e = new lt();
                e.name = "scrollBar", e.right = 0, e.skin = t, e.elasticDistance = this._elasticEnabled ? 200 : 0,
                    this.scrollBar = e, this.addChild(e), this._setCellChanged();
            }), a(0, n, "page", function () {
                return this._page;
            }, function (t) {
                this._page = t, this._array && (this._page = t > 0 ? t : 0, this._page = this._page < this.totalPage ? this._page : this.totalPage - 1,
                    this.startIndex = this._page * this.repeatX * this.repeatY);
            }), a(0, n, "hScrollBarSkin", function () {
                return this._scrollBar ? this._scrollBar.skin : null;
            }, function (t) {
                this._removePreScrollBar();
                var e = new ut();
                e.name = "scrollBar", e.bottom = 0, e.skin = t, e.elasticDistance = this._elasticEnabled ? 200 : 0,
                    this.scrollBar = e, this.addChild(e), this._setCellChanged();
            }), a(0, n, "repeatX", function () {
                return this._repeatX > 0 ? this._repeatX : this._repeatX2 > 0 ? this._repeatX2 : 1;
            }, function (t) {
                this._repeatX = t, this._setCellChanged();
            }), a(0, n, "scrollBar", function () {
                return this._scrollBar;
            }, function (t) {
                this._scrollBar != t && (this._scrollBar = t, t && (this._isVertical = this._scrollBar.isVertical,
                    this.addChild(this._scrollBar), this._scrollBar.on("change", this, this.onScrollBarChange)));
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                t != this._width && (i.superSet(V, this, "width", t), this._setCellChanged());
            }), a(0, n, "repeatY", function () {
                return this._repeatY > 0 ? this._repeatY : this._repeatY2 > 0 ? this._repeatY2 : 1;
            }, function (t) {
                this._repeatY = t, this._setCellChanged();
            }), a(0, n, "spaceX", function () {
                return this._spaceX;
            }, function (t) {
                this._spaceX = t, this._setCellChanged();
            }), a(0, n, "spaceY", function () {
                return this._spaceY;
            }, function (t) {
                this._spaceY = t, this._setCellChanged();
            }), a(0, n, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                this._selectedIndex != t && (this._selectedIndex = t, this.changeSelectStatus(),
                    this.event("change"), this.selectHandler && this.selectHandler.runWith(t), this.startIndex = this._startIndex);
            }), a(0, n, "selectedItem", function () {
                return -1 != this._selectedIndex ? this._array[this._selectedIndex] : null;
            }, function (t) {
                this.selectedIndex = this._array.indexOf(t);
            }), a(0, n, "length", function () {
                return this._array ? this._array.length : 0;
            }), a(0, n, "selection", function () {
                return this.getCell(this._selectedIndex);
            }, function (t) {
                this.selectedIndex = this._startIndex + this._cells.indexOf(t);
            }), a(0, n, "startIndex", function () {
                return this._startIndex;
            }, function (t) {
                this._startIndex = t > 0 ? t : 0, this.callLater(this.renderItems);
            }), a(0, n, "array", function () {
                return this._array;
            }, function (t) {
                this.runCallLater(this.changeCells), this._array = t || [], this._preLen = this._array.length;
                var e = this._array.length;
                if (this.totalPage = Math.ceil(e / (this.repeatX * this.repeatY)), this._selectedIndex = this._selectedIndex < e ? this._selectedIndex : e - 1,
                    this.startIndex = this._startIndex, this._scrollBar) {
                    this._scrollBar.stopScroll();
                    var i = this._isVertical ? this.repeatX : this.repeatY, n = this._isVertical ? this.repeatY : this.repeatX, r = Math.ceil(e / i);
                    (this._cellOffset > 0 ? this.totalPage + 1 : this.totalPage) > 1 && r >= n ? (this._scrollBar.scrollSize = this._cellSize,
                        this._scrollBar.thumbPercent = n / r, this._scrollBar.setScroll(0, (r - n) * this._cellSize + this._cellOffset, this._scrollBar.value),
                        this._scrollBar.target = this._content) : (this._scrollBar.setScroll(0, 0, 0), this._scrollBar.target = this._content);
                }
            }), a(0, n, "dataSource", t.prototype._$get_dataSource, function (t) {
                this._dataSource = t, "number" == typeof t && Math.floor(t) == t || "string" == typeof t ? this.selectedIndex = parseInt(t) : t instanceof Array ? this.array = t : i.superSet(V, this, "dataSource", t);
            }), a(0, n, "cells", function () {
                return this.runCallLater(this.changeCells), this._cells;
            }), a(0, n, "elasticEnabled", function () {
                return this._elasticEnabled;
            }, function (t) {
                this._elasticEnabled = t, this._scrollBar && (this._scrollBar.elasticDistance = t ? 200 : 0);
            }), e;
        }(V), rt = function (t) {
            function e(t) {
                this._bg = null, this._skin = null, e.__super.call(this), void 0 === t && (t = ""),
                    this.text = t, this.skin = this.skin;
            }
            r(e, "laya.ui.TextInput", t);
            var n = e.prototype;
            return n.preinitialize = function () {
                this.mouseEnabled = !0;
            }, n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._bg && this._bg.destroy(),
                    this._bg = null;
            }, n.createChildren = function () {
                this.addChild(this._tf = new m()), this._tf.padding = O.inputLabelPadding, this._tf.on("input", this, this._onInput),
                    this._tf.on("enter", this, this._onEnter), this._tf.on("blur", this, this._onBlur),
                    this._tf.on("focus", this, this._onFocus);
            }, n._onFocus = function () {
                this.event("focus", this);
            }, n._onBlur = function () {
                this.event("blur", this);
            }, n._onInput = function () {
                this.event("input", this);
            }, n._onEnter = function () {
                this.event("enter", this);
            }, n.initialize = function () {
                this.width = 128, this.height = 22;
            }, n._skinLoaded = function () {
                this._bg || (this.graphics = this._bg = new N()), this._bg.source = g.getRes(this._skin),
                    this._width && (this._bg.width = this._width), this._height && (this._bg.height = this._height),
                    this._sizeChanged(), this.event("loaded");
            }, n.select = function () {
                this._tf.select();
            }, n.setSelection = function (t, e) {
                this._tf.setSelection(t, e);
            }, a(0, n, "text", t.prototype._$get_text, function (t) {
                this._tf.text != t && (t += "", this._tf.text = t, this.event("change"));
            }), a(0, n, "bg", function () {
                return this._bg;
            }, function (t) {
                this.graphics = this._bg = t;
            }), a(0, n, "multiline", function () {
                return this._tf.multiline;
            }, function (t) {
                this._tf.multiline = t;
            }), a(0, n, "skin", function () {
                return this._skin;
            }, function (t) {
                this._skin != t && (this._skin = t, this._skin && !g.getRes(this._skin) ? i.loader.load(this._skin, f.create(this, this._skinLoaded), null, "image", 1) : this._skinLoaded());
            }), a(0, n, "sizeGrid", function () {
                return this._bg && this._bg.sizeGrid ? this._bg.sizeGrid.join(",") : null;
            }, function (t) {
                this._bg || (this.graphics = this._bg = new N()), this._bg.sizeGrid = L.fillArray(O.defaultSizeGrid, t, Number);
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(z, this, "width", t), this._bg && (this._bg.width = t);
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(z, this, "height", t), this._bg && (this._bg.height = t);
            }), a(0, n, "editable", function () {
                return this._tf.editable;
            }, function (t) {
                this._tf.editable = t;
            }), a(0, n, "restrict", function () {
                return this._tf.restrict;
            }, function (t) {
                this._tf.restrict = t;
            }), a(0, n, "prompt", function () {
                return this._tf.prompt;
            }, function (t) {
                this._tf.prompt = t;
            }), a(0, n, "promptColor", function () {
                return this._tf.promptColor;
            }, function (t) {
                this._tf.promptColor = t;
            }), a(0, n, "maxChars", function () {
                return this._tf.maxChars;
            }, function (t) {
                this._tf.maxChars = t;
            }), a(0, n, "focus", function () {
                return this._tf.focus;
            }, function (t) {
                this._tf.focus = t;
            }), a(0, n, "type", function () {
                return this._tf.type;
            }, function (t) {
                this._tf.type = t;
            }), e;
        }(z), at = function (t) {
            function e() {
                this._oldW = 0, this._oldH = 0, e.__super.call(this);
            }
            r(e, "laya.ui.ScaleBox", t);
            var n = e.prototype;
            return n.onEnable = function () {
                i.stage.on("resize", this, this.onResize), this.onResize();
            }, n.onDisable = function () {
                i.stage.off("resize", this, this.onResize);
            }, n.onResize = function () {
                if (this.width > 0 && this.height > 0) {
                    var t = Math.min(i.stage.width / this._oldW, i.stage.height / this._oldH);
                    i.superSet(V, this, "width", i.stage.width), i.superSet(V, this, "height", i.stage.height),
                        this.scale(t, t);
                }
            }, a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(V, this, "width", t), this._oldW = t;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(V, this, "height", t), this._oldH = t;
            }), e;
        }(V), st = function (t) {
            function e(t, i) {
                this._value = null, void 0 === i && (i = ""), e.__super.call(this, t, i);
            }
            r(e, "laya.ui.Radio", t);
            var i = e.prototype;
            return i.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._value = null;
            }, i.preinitialize = function () {
                laya.ui.UIComponent.prototype.preinitialize.call(this), this.toggle = !1, this._autoSize = !1;
            }, i.initialize = function () {
                t.prototype.initialize.call(this), this.createText(), this._text.align = "left",
                    this._text.valign = "top", this._text.width = 0, this.on("click", this, this.onClick);
            }, i.onClick = function (t) {
                this.selected = !0;
            }, a(0, i, "value", function () {
                return null != this._value ? this._value : this.label;
            }, function (t) {
                this._value = t;
            }), e;
        }(U), ot = function (t) {
            function e(t, i) {
                this._valueArr = null, this._indexMap = null, this._sheet = null, this._direction = "horizontal",
                    this._spaceX = 0, this._spaceY = 0, this._align = "left", this._wordsW = 0, this._wordsH = 0,
                    e.__super.call(this), t && (this.skin = t), i && (this.sheet = i);
            }
            r(e, "laya.ui.FontClip", t);
            var n = e.prototype;
            return n.createChildren = function () {
                this._bitmap = new N(), this.on("loaded", this, this._onClipLoaded);
            }, n._onClipLoaded = function () {
                this.callLater(this.changeValue);
            }, n.changeValue = function () {
                var t;
                if (this._sources && (this._valueArr && (this.graphics.clear(!0), t = this._sources[0]))) {
                    var e = "horizontal" === this._direction;
                    e ? (this._wordsW = this._valueArr.length * (t.sourceWidth + this.spaceX), this._wordsH = t.sourceHeight) : (this._wordsW = t.sourceWidth,
                        this._wordsH = (t.sourceHeight + this.spaceY) * this._valueArr.length);
                    var i = 0;
                    if (this._width) switch (this._align) {
                        case "center":
                            i = .5 * (this._width - this._wordsW);
                            break;

                        case "right":
                            i = this._width - this._wordsW;
                            break;

                        default:
                            i = 0;
                    }
                    for (var n = 0, r = this._valueArr.length; n < r; n++) {
                        var a = this._indexMap[this._valueArr.charAt(n)];
                        this.sources[a] && (t = this.sources[a], e ? this.graphics.drawImage(t, i + n * (t.sourceWidth + this.spaceX), 0, t.sourceWidth, t.sourceHeight) : this.graphics.drawImage(t, 0 + i, n * (t.sourceHeight + this.spaceY), t.sourceWidth, t.sourceHeight));
                    }
                    this._width || (this._widget.resetLayoutX(), this.callLater(this._sizeChanged)),
                        this._height || (this._widget.resetLayoutY(), this.callLater(this._sizeChanged));
                }
            }, n.measureWidth = function () {
                return this._wordsW;
            }, n.measureHeight = function () {
                return this._wordsH;
            }, n.destroy = function (e) {
                void 0 === e && (e = !0), this._valueArr = null, this._indexMap = null, this.graphics.clear(!0),
                    this.removeSelf(), this.off("loaded", this, this._onClipLoaded), t.prototype.destroy.call(this, e);
            }, a(0, n, "sheet", function () {
                return this._sheet;
            }, function (t) {
                t += "", this._sheet = t;
                var e = t.split(" ");
                this._clipX = String(e[0]).length, this.clipY = e.length, this._indexMap = {};
                for (var i = 0; i < this._clipY; i++) for (var n = e[i].split(""), r = 0, a = n.length; r < a; r++) this._indexMap[n[r]] = i * this._clipX + r;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(j, this, "height", t), this.callLater(this.changeValue);
            }), a(0, n, "direction", function () {
                return this._direction;
            }, function (t) {
                this._direction = t, this.callLater(this.changeValue);
            }), a(0, n, "value", function () {
                return this._valueArr ? this._valueArr : "";
            }, function (t) {
                t += "", this._valueArr = t, this.callLater(this.changeValue);
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(j, this, "width", t), this.callLater(this.changeValue);
            }), a(0, n, "spaceX", function () {
                return this._spaceX;
            }, function (t) {
                this._spaceX = t, "horizontal" === this._direction && this.callLater(this.changeValue);
            }), a(0, n, "spaceY", function () {
                return this._spaceY;
            }, function (t) {
                this._spaceY = t, "horizontal" !== this._direction && this.callLater(this.changeValue);
            }), a(0, n, "align", function () {
                return this._align;
            }, function (t) {
                this._align = t, this.callLater(this.changeValue);
            }), e;
        }(j), lt = (function (t) {
            function e(t) {
                this.advsListArr = [], this.resUrl = "https://unioncdn.layabox.com/config/iconlist.json",
                    this._data = [], this._resquestTime = 36e4, this._appid = null, this._playIndex = 0,
                    this._lunboTime = 5e3, e.__super.call(this), this._http = new o.window.XMLHttpRequest(),
                    this.skin = t, this.setLoadUrl(), this.init(), this.size(120, 120);
            }
            r(e, "laya.ui.AdvImage", t);
            var n = e.prototype;
            n.setLoadUrl = function () {
                o.onLimixiu && (this.resUrl = "https://abc.layabox.com/public/wyw/gconfig.json");
            }, n.init = function () {
                this.isSupportJump() ? ((o.onMiniGame || o.onBDMiniGame) && i.timer.loop(this._resquestTime, this, this.onGetAdvsListData),
                    this.onGetAdvsListData(), this.initEvent()) : this.visible = !1;
            }, n.initEvent = function () {
                this.on("click", this, this.onAdvsImgClick);
            }, n.onAdvsImgClick = function () {
                this.getCurrentAppidObj() && this.jumptoGame();
            }, n.revertAdvsData = function () {
                if (this.advsListArr[this._playIndex]) if (this.visible = !0, o.onLimixiu) {
                    this.visible = !0;
                    var t = this.advsListArr[this._playIndex];
                    t && (o.onLimixiu && GameStatusInfo.gameId == t.gameid ? this.onLunbo() : (this.skin = "https://abc.layabox.com/public/icon/" + t.iconUrl,
                        this.size(103, 126)));
                } else this.skin = this.advsListArr[this._playIndex];
            }, n.isSupportJump = function () {
                if (o.onMiniGame) return "function" == typeof wx.navigateToMiniProgram;
                if (o.onLimixiu) {
                    if (BK.QQ.skipGame) return !0;
                } else if (o.onBDMiniGame) return !0;
                return !1;
            }, n.jumptoGame = function () {
                var t = this, e = this.advsListArr[this._playIndex], i = parseInt(e.gameid), n = e.extendInfo;
                e.path;
                if (o.onLimixiu) {
                    if (!e.isLunBo && !e.isLunBo) {
                        var r = y.getJSON("gameObj");
                        r || (r = {}), r[e.gameid] || (r[e.gameid] = {}), r[e.gameid] = {
                            isclick: !0
                        }, y.setJSON("gameObj", r), this.advsListArr.splice(this._playIndex, 1);
                    }
                    BK.QQ.skipGame(i, n), this.updateAdvsInfo();
                } else o.onMiniGame ? this.isSupportJump() && wx.navigateToMiniProgram({
                    appId: this._appid,
                    path: "",
                    extraData: "",
                    envVersion: "release",
                    success: function () {
                        console.log("-------------跳转成功--------------");
                    },
                    fail: function () {
                        console.log("-------------跳转失败--------------");
                    },
                    complete: function () {
                        console.log("-------------跳转接口调用成功--------------"), t.updateAdvsInfo();
                    }.bind(this)
                }) : o.onBDMiniGame || (this.visible = !1);
            }, n.updateAdvsInfo = function () {
                this.visible = !1, this.onLunbo(), i.timer.loop(this._lunboTime, this, this.onLunbo);
            }, n.onLunbo = function () {
                this._playIndex >= this.advsListArr.length - 1 ? this._playIndex = 0 : this._playIndex += 1,
                    this.visible = !0, this.revertAdvsData();
            }, n.getCurrentAppidObj = function () {
                return this.advsListArr[this._playIndex];
            }, n.onGetAdvsListData = function () {
                var t = this, i = e.randRange(1e4, 1e6), n = this.resUrl + "?" + i;
                this._http.open("get", n, !0), this._http.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"),
                    this._http.responseType = "text", this._http.onerror = function (e) {
                        t._onError(e);
                    }, this._http.onload = function (e) {
                        t._onLoad(e);
                    }, this._http.send(null);
            }, n._onError = function (t) {
                this.error("Request failed Status:" + this._http.status + " text:" + this._http.statusText);
            }, n._onLoad = function (t) {
                var e = this._http, i = void 0 !== e.status ? e.status : 200;
                200 === i || 204 === i || 0 === i ? this.complete() : this.error("[" + e.status + "]" + e.statusText + ":" + e.responseURL);
            }, n.error = function (t) {
                this.event("error", t);
            }, n.complete = function () {
                try {
                    this._data = this._http.response || this._http.responseText, this._data = JSON.parse(this._data),
                        o.onLimixiu ? (this.advsListArr = this.getAdvsQArr(this._data), this.advsListArr.length ? (this.updateAdvsInfo(),
                            this.revertAdvsData()) : this.visible = !1) : (this.advsListArr = this._data.list,
                                this._appid = this._data.appid, this.updateAdvsInfo(), this.revertAdvsData());
                } catch (t) {
                    !1, this.error(t.message);
                }
            }, n.getAdvsQArr = function (t) {
                var e = [], i = y.getJSON("gameObj");
                for (var n in t) {
                    var r = t[n];
                    i && i[r.gameid] && !r.isQiangZhi || e.push(r);
                }
                return e;
            }, n.clear = function () {
                var t = this._http;
                t.onerror = t.onabort = t.onprogress = t.onload = null;
            }, n.destroy = function (e) {
                void 0 === e && (e = !0), i.timer.clear(this, this.onLunbo), t.prototype.destroy.call(this, !0),
                    this.clear(), i.timer.clear(this, this.onGetAdvsListData);
            }, e.randRange = function (t, e) {
                return Math.floor(Math.random() * (e - t + 1)) + t;
            };
        }(G), function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.ui.VScrollBar", t), e;
        }(Y)), ht = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.ui.VSlider", t), e;
        }(q), ut = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.ui.HScrollBar", t), e.prototype.initialize = function () {
                t.prototype.initialize.call(this), this.slider.isVertical = !1;
            }, e;
        }(Y), ct = function (t) {
            function e(t) {
                e.__super.call(this, t), this.isVertical = !1;
            }
            return r(e, "laya.ui.HSlider", t), e;
        }(q), dt = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.ui.HBox", t);
            var n = e.prototype;
            return n.sortItem = function (t) {
                t && t.sort(function (t, e) {
                    return t.x - e.x;
                });
            }, n.changeItems = function () {
                this._itemChanged = !1;
                for (var t = [], e = 0, i = 0, n = this.numChildren; i < n; i++) {
                    var r = this.getChildAt(i);
                    r && (t.push(r), e = this._height ? this._height : Math.max(e, r.height * r.scaleY));
                }
                this.sortItem(t);
                var a = 0;
                for (i = 0, n = t.length; i < n; i++) (r = t[i]).x = a, a += r.width * r.scaleX + this._space,
                    "top" == this._align ? r.y = 0 : "middle" == this._align ? r.y = .5 * (e - r.height * r.scaleY) : "bottom" == this._align && (r.y = e - r.height * r.scaleY);
                this._sizeChanged();
            }, a(0, n, "height", t.prototype._$get_height, function (t) {
                this._height != t && (i.superSet(J, this, "height", t), this.callLater(this.changeItems));
            }), e.NONE = "none", e.TOP = "top", e.MIDDLE = "middle", e.BOTTOM = "bottom", e;
        }(J), _t = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.ui.RadioGroup", t), e.prototype.createItem = function (t, e) {
                return new st(t, e);
            }, e;
        }($), ft = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.ui.VBox", t);
            var n = e.prototype;
            return n.changeItems = function () {
                this._itemChanged = !1;
                for (var t = [], e = 0, i = 0, n = this.numChildren; i < n; i++) {
                    var r = this.getChildAt(i);
                    r && (t.push(r), e = this._width ? this._width : Math.max(e, r.width * r.scaleX));
                }
                this.sortItem(t);
                var a = 0;
                for (i = 0, n = t.length; i < n; i++) (r = t[i]).y = a, a += r.height * r.scaleY + this._space,
                    "left" == this._align ? r.x = 0 : "center" == this._align ? r.x = .5 * (e - r.width * r.scaleX) : "right" == this._align && (r.x = e - r.width * r.scaleX);
                this._sizeChanged();
            }, a(0, n, "width", t.prototype._$get_width, function (t) {
                this._width != t && (i.superSet(J, this, "width", t), this.callLater(this.changeItems));
            }), e.NONE = "none", e.LEFT = "left", e.CENTER = "center", e.RIGHT = "right", e;
        }(J), pt = function (t) {
            function e(t) {
                this._vScrollBar = null, this._hScrollBar = null, void 0 === t && (t = ""), e.__super.call(this, t),
                    this.on("change", this, this._onTextChange);
            }
            r(e, "laya.ui.TextArea", t);
            var n = e.prototype;
            return n._onTextChange = function () {
                this.callLater(this.changeScroll);
            }, n.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._vScrollBar && this._vScrollBar.destroy(),
                    this._hScrollBar && this._hScrollBar.destroy(), this._vScrollBar = null, this._hScrollBar = null;
            }, n.initialize = function () {
                this.width = 180, this.height = 150, this._tf.wordWrap = !0, this.multiline = !0;
            }, n.onVBarChanged = function (t) {
                this._tf.scrollY != this._vScrollBar.value && (this._tf.scrollY = this._vScrollBar.value);
            }, n.onHBarChanged = function (t) {
                this._tf.scrollX != this._hScrollBar.value && (this._tf.scrollX = this._hScrollBar.value);
            }, n.changeScroll = function () {
                var t = this._vScrollBar && this._tf.maxScrollY > 0, e = this._hScrollBar && this._tf.maxScrollX > 0, i = t ? this._width - this._vScrollBar.width : this._width, n = e ? this._height - this._hScrollBar.height : this._height, r = this._tf.padding || O.labelPadding;
                this._tf.width = i, this._tf.height = n, this._vScrollBar && (this._vScrollBar.x = this._width - this._vScrollBar.width - r[2],
                    this._vScrollBar.y = r[1], this._vScrollBar.height = this._height - (e ? this._hScrollBar.height : 0) - r[1] - r[3],
                    this._vScrollBar.scrollSize = 1, this._vScrollBar.thumbPercent = n / Math.max(this._tf.textHeight, n),
                    this._vScrollBar.setScroll(1, this._tf.maxScrollY, this._tf.scrollY), this._vScrollBar.visible = t),
                    this._hScrollBar && (this._hScrollBar.x = r[0], this._hScrollBar.y = this._height - this._hScrollBar.height - r[3],
                        this._hScrollBar.width = this._width - (t ? this._vScrollBar.width : 0) - r[0] - r[2],
                        this._hScrollBar.scrollSize = Math.max(.033 * i, 1), this._hScrollBar.thumbPercent = i / Math.max(this._tf.textWidth, i),
                        this._hScrollBar.setScroll(0, this.maxScrollX, this.scrollX), this._hScrollBar.visible = e);
            }, n.scrollTo = function (t) {
                this.commitMeasure(), this._tf.scrollY = t;
            }, a(0, n, "scrollY", function () {
                return this._tf.scrollY;
            }), a(0, n, "width", t.prototype._$get_width, function (t) {
                i.superSet(rt, this, "width", t), this.callLater(this.changeScroll);
            }), a(0, n, "hScrollBar", function () {
                return this._hScrollBar;
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                i.superSet(rt, this, "height", t), this.callLater(this.changeScroll);
            }), a(0, n, "maxScrollX", function () {
                return this._tf.maxScrollX;
            }), a(0, n, "vScrollBarSkin", function () {
                return this._vScrollBar ? this._vScrollBar.skin : null;
            }, function (t) {
                null == this._vScrollBar && (this.addChild(this._vScrollBar = new lt()), this._vScrollBar.on("change", this, this.onVBarChanged),
                    this._vScrollBar.target = this._tf, this.callLater(this.changeScroll)), this._vScrollBar.skin = t;
            }), a(0, n, "hScrollBarSkin", function () {
                return this._hScrollBar ? this._hScrollBar.skin : null;
            }, function (t) {
                null == this._hScrollBar && (this.addChild(this._hScrollBar = new ut()), this._hScrollBar.on("change", this, this.onHBarChanged),
                    this._hScrollBar.mouseWheelEnable = !1, this._hScrollBar.target = this._tf, this.callLater(this.changeScroll)),
                    this._hScrollBar.skin = t;
            }), a(0, n, "vScrollBar", function () {
                return this._vScrollBar;
            }), a(0, n, "maxScrollY", function () {
                return this._tf.maxScrollY;
            }), a(0, n, "scrollX", function () {
                return this._tf.scrollX;
            }), e;
        }(rt), mt = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.ui.Tab", t), e.prototype.createItem = function (t, e) {
                return new U(t, e);
            }, e;
        }($);
        i.__init([K, k]);
    }(window, document, Laya);
}, function (t, e) {
    !function (t, e, i) {
        i.un, i.uns;
        var n = i.static, r = i.class, a = i.getset, s = i.__newvec, o = laya.resource.BaseTexture, l = laya.utils.Browser, h = laya.webgl.utils.Buffer, u = laya.webgl.BufferStateBase, c = laya.utils.Byte, d = laya.utils.ClassUtils, _ = laya.layagl.CommandEncoder, f = laya.components.Component, p = i.Config, m = laya.resource.Context, g = (laya.events.Event,
            laya.events.EventDispatcher), y = laya.utils.Handler, v = (laya.webgl.utils.InlcudeFile,
                laya.layagl.LayaGL), S = laya.layagl.LayaGLRunner, T = laya.net.Loader, E = laya.net.LoaderManager, C = laya.maths.MathUtil, x = laya.display.Node, b = laya.maths.Point, I = laya.renders.Render, w = (laya.resource.RenderTexture2D,
                    laya.resource.Resource), A = laya.utils.RunDriver, R = (laya.webgl.shader.Shader,
                        laya.webgl.utils.ShaderCompile), M = laya.webgl.utils.ShaderNode, D = laya.display.Sprite, O = laya.utils.Stat, L = laya.webgl.submit.Submit, P = laya.webgl.submit.SubmitKey, N = laya.resource.Texture2D, B = (laya.utils.Timer,
                            laya.net.URL), F = laya.webgl.WebGL, k = laya.webgl.WebGLContext;
        i.interface("laya.d3.core.IClone"), i.interface("laya.d3.graphics.IVertex"), i.interface("laya.d3.core.scene.IOctreeObject");
        var V = function () {
            function t(t, e, i, n, r) {
                var a;
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1),
                    (a = r || new Float32Array(4))[0] = t, a[1] = e, a[2] = i, a[3] = n, this.elements = a;
            }
            r(t, "laya.d3.math.Native.ConchQuaternion");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.scaling = function (t, e) {
                var i = e.elements, n = this.elements;
                i[0] = n[0] * t, i[1] = n[1] * t, i[2] = n[2] * t, i[3] = n[3] * t;
            }, e.normalize = function (e) {
                t._normalizeArray(this.elements, e.elements);
            }, e.length = function () {
                var t = this.elements, e = t[0], i = t[1], n = t[2], r = t[3];
                return Math.sqrt(e * e + i * i + n * n + r * r);
            }, e.rotateX = function (t, e) {
                var i = e.elements, n = this.elements;
                t *= .5;
                var r = n[0], a = n[1], s = n[2], o = n[3], l = Math.sin(t), h = Math.cos(t);
                i[0] = r * h + o * l, i[1] = a * h + s * l, i[2] = s * h - a * l, i[3] = o * h - r * l;
            }, e.rotateY = function (t, e) {
                var i = e.elements, n = this.elements;
                t *= .5;
                var r = n[0], a = n[1], s = n[2], o = n[3], l = Math.sin(t), h = Math.cos(t);
                i[0] = r * h - s * l, i[1] = a * h + o * l, i[2] = s * h + r * l, i[3] = o * h - a * l;
            }, e.rotateZ = function (t, e) {
                var i = e.elements, n = this.elements;
                t *= .5;
                var r = n[0], a = n[1], s = n[2], o = n[3], l = Math.sin(t), h = Math.cos(t);
                i[0] = r * h + a * l, i[1] = a * h - r * l, i[2] = s * h + o * l, i[3] = o * h - s * l;
            }, e.getYawPitchRoll = function (e) {
                G.transformQuat(G.ForwardRH, this, t.TEMPVector31), G.transformQuat(G.Up, this, t.TEMPVector32);
                var i = t.TEMPVector32.elements;
                t.angleTo(G.ZERO, t.TEMPVector31, t.TEMPVector33);
                var n = t.TEMPVector33.elements;
                n[0] == Math.PI / 2 ? (n[1] = t.arcTanAngle(i[2], i[0]), n[2] = 0) : n[0] == -Math.PI / 2 ? (n[1] = t.arcTanAngle(-i[2], -i[0]),
                    n[2] = 0) : (ze.createRotationY(-n[1], t.TEMPMatrix0), ze.createRotationX(-n[0], t.TEMPMatrix1),
                        G.transformCoordinate(t.TEMPVector32, t.TEMPMatrix0, t.TEMPVector32), G.transformCoordinate(t.TEMPVector32, t.TEMPMatrix1, t.TEMPVector32),
                        n[2] = t.arcTanAngle(i[1], -i[0])), n[1] <= -Math.PI && (n[1] = Math.PI), n[2] <= -Math.PI && (n[2] = Math.PI),
                    n[1] >= Math.PI && n[2] >= Math.PI && (n[1] = 0, n[2] = 0, n[0] = Math.PI - n[0]);
                var r = e.elements;
                r[0] = n[1], r[1] = n[0], r[2] = n[2];
            }, e.invert = function (t) {
                var e = t.elements, i = this.elements, n = i[0], r = i[1], a = i[2], s = i[3], o = n * n + r * r + a * a + s * s, l = o ? 1 / o : 0;
                e[0] = -n * l, e[1] = -r * l, e[2] = -a * l, e[3] = s * l;
            }, e.identity = function () {
                var t = this.elements;
                t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1],
                    this.elements[2] = t[e + 2], this.elements[3] = t[e + 3];
            }, e.cloneTo = function (t) {
                var e, i, n;
                if ((i = this.elements) !== (n = t.elements)) for (e = 0; e < 4; ++e) n[e] = i[e];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.equals = function (t) {
                var e = this.elements, i = t.elements;
                return nt.nearEqual(e[0], i[0]) && nt.nearEqual(e[1], i[1]) && nt.nearEqual(e[2], i[2]) && nt.nearEqual(e[3], i[3]);
            }, e.lengthSquared = function () {
                var t = this.elements[0], e = this.elements[1], i = this.elements[2], n = this.elements[3];
                return t * t + e * e + i * i + n * n;
            }, a(0, e, "x", function () {
                return this.elements[0];
            }, function (t) {
                this.elements[0] = t;
            }), a(0, e, "y", function () {
                return this.elements[1];
            }, function (t) {
                this.elements[1] = t;
            }), a(0, e, "z", function () {
                return this.elements[2];
            }, function (t) {
                this.elements[2] = t;
            }), a(0, e, "w", function () {
                return this.elements[3];
            }, function (t) {
                this.elements[3] = t;
            }), t._dotArray = function (t, e) {
                return t[0] * e[0] + t[1] * e[1] + t[2] * e[2] + t[3] * e[3];
            }, t._normalizeArray = function (t, e) {
                var i = t[0], n = t[1], r = t[2], a = t[3], s = i * i + n * n + r * r + a * a;
                s > 0 && (s = 1 / Math.sqrt(s), e[0] = i * s, e[1] = n * s, e[2] = r * s, e[3] = a * s);
            }, t._lerpArray = function (e, i, n, r) {
                var a = 1 - n;
                t._dotArray(e, i) >= 0 ? (r[0] = a * e[0] + n * i[0], r[1] = a * e[1] + n * i[1],
                    r[2] = a * e[2] + n * i[2], r[3] = a * e[3] + n * i[3]) : (r[0] = a * e[0] - n * i[0],
                        r[1] = a * e[1] - n * i[1], r[2] = a * e[2] - n * i[2], r[3] = a * e[3] - n * i[3]),
                    t._normalizeArray(r, r);
            }, t.createFromYawPitchRoll = function (t, e, i, n) {
                var r = .5 * i, a = .5 * e, s = .5 * t, o = Math.sin(r), l = Math.cos(r), h = Math.sin(a), u = Math.cos(a), c = Math.sin(s), d = Math.cos(s), _ = n.elements;
                _[0] = d * h * l + c * u * o, _[1] = c * u * l - d * h * o, _[2] = d * u * o - c * h * l,
                    _[3] = d * u * l + c * h * o;
            }, t.multiply = function (t, e, i) {
                var n = t.elements, r = e.elements, a = i.elements, s = n[0], o = n[1], l = n[2], h = n[3], u = r[0], c = r[1], d = r[2], _ = r[3], f = o * d - l * c, p = l * u - s * d, m = s * c - o * u, g = s * u + o * c + l * d;
                a[0] = s * _ + u * h + f, a[1] = o * _ + c * h + p, a[2] = l * _ + d * h + m, a[3] = h * _ - g;
            }, t.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : t > 0 ? Math.atan(e / t) : t < 0 ? e > 0 ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0;
            }, t.angleTo = function (e, i, n) {
                G.subtract(i, e, t.TEMPVector30), G.normalize(t.TEMPVector30, t.TEMPVector30), n.elements[0] = Math.asin(t.TEMPVector30.y),
                    n.elements[1] = t.arcTanAngle(-t.TEMPVector30.z, -t.TEMPVector30.x);
            }, t.createFromAxisAngle = function (t, e, i) {
                var n = i.elements, r = t.elements;
                e *= .5;
                var a = Math.sin(e);
                n[0] = a * r[0], n[1] = a * r[1], n[2] = a * r[2], n[3] = Math.cos(e);
            }, t.createFromMatrix3x3 = function (t, e) {
                var i, n = e.elements, r = t.elements, a = r[0] + r[4] + r[8];
                if (a > 0) i = Math.sqrt(a + 1), n[3] = .5 * i, i = .5 / i, n[0] = (r[5] - r[7]) * i,
                    n[1] = (r[6] - r[2]) * i, n[2] = (r[1] - r[3]) * i; else {
                    var s = 0;
                    r[4] > r[0] && (s = 1), r[8] > r[3 * s + s] && (s = 2);
                    var o = (s + 1) % 3, l = (s + 2) % 3;
                    i = Math.sqrt(r[3 * s + s] - r[3 * o + o] - r[3 * l + l] + 1), n[s] = .5 * i, i = .5 / i,
                        n[3] = (r[3 * o + l] - r[3 * l + o]) * i, n[o] = (r[3 * o + s] + r[3 * s + o]) * i,
                        n[l] = (r[3 * l + s] + r[3 * s + l]) * i;
                }
            }, t.createFromMatrix4x4 = function (t, e) {
                var i, n, r = t.elements, a = e.elements, s = r[0] + r[5] + r[10];
                s > 0 ? (i = Math.sqrt(s + 1), a[3] = .5 * i, i = .5 / i, a[0] = (r[6] - r[9]) * i,
                    a[1] = (r[8] - r[2]) * i, a[2] = (r[1] - r[4]) * i) : r[0] >= r[5] && r[0] >= r[10] ? (n = .5 / (i = Math.sqrt(1 + r[0] - r[5] - r[10])),
                        a[0] = .5 * i, a[1] = (r[1] + r[4]) * n, a[2] = (r[2] + r[8]) * n, a[3] = (r[6] - r[9]) * n) : r[5] > r[10] ? (n = .5 / (i = Math.sqrt(1 + r[5] - r[0] - r[10])),
                            a[0] = (r[4] + r[1]) * n, a[1] = .5 * i, a[2] = (r[9] + r[6]) * n, a[3] = (r[8] - r[2]) * n) : (n = .5 / (i = Math.sqrt(1 + r[10] - r[0] - r[5])),
                                a[0] = (r[8] + r[2]) * n, a[1] = (r[9] + r[6]) * n, a[2] = .5 * i, a[3] = (r[1] - r[4]) * n);
            }, t.slerp = function (t, e, i, n) {
                var r, a, s, o, l, h = t.elements, u = e.elements, c = n.elements, d = h[0], _ = h[1], f = h[2], p = h[3], m = u[0], g = u[1], y = u[2], v = u[3];
                return (a = d * m + _ * g + f * y + p * v) < 0 && (a = -a, m = -m, g = -g, y = -y,
                    v = -v), 1 - a > 1e-6 ? (r = Math.acos(a), s = Math.sin(r), o = Math.sin((1 - i) * r) / s,
                        l = Math.sin(i * r) / s) : (o = 1 - i, l = i), c[0] = o * d + l * m, c[1] = o * _ + l * g,
                    c[2] = o * f + l * y, c[3] = o * p + l * v, c;
            }, t.lerp = function (e, i, n, r) {
                t._lerpArray(e.elements, i.elements, n, r.elements);
            }, t.add = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] + a[0], n[1] = r[1] + a[1], n[2] = r[2] + a[2], n[3] = r[3] + a[3];
            }, t.dot = function (e, i) {
                return t._dotArray(e.elements, i.elements);
            }, t.rotationLookAt = function (e, i, n) {
                t.lookAt(G.ZERO, e, i, n);
            }, t.lookAt = function (e, i, n, r) {
                ke.lookAt(e, i, n, t._tempMatrix3x3), t.rotationMatrix(t._tempMatrix3x3, r);
            }, t.invert = function (t, e) {
                var i = t.elements, n = e.elements, r = t.lengthSquared();
                nt.isZero(r) || (r = 1 / r, n[0] = -i[0] * r, n[1] = -i[1] * r, n[2] = -i[2] * r,
                    n[3] = i[3] * r);
            }, t.rotationMatrix = function (t, e) {
                var i = t.elements, n = i[0], r = i[1], a = i[2], s = i[3], o = i[4], l = i[5], h = i[6], u = i[7], c = i[8], d = e.elements, _ = NaN, f = NaN, p = n + o + c;
                p > 0 ? (_ = Math.sqrt(p + 1), d[3] = .5 * _, _ = .5 / _, d[0] = (l - u) * _, d[1] = (h - a) * _,
                    d[2] = (r - s) * _) : n >= o && n >= c ? (f = .5 / (_ = Math.sqrt(1 + n - o - c)),
                        d[0] = .5 * _, d[1] = (r + s) * f, d[2] = (a + h) * f, d[3] = (l - u) * f) : o > c ? (f = .5 / (_ = Math.sqrt(1 + o - n - c)),
                            d[0] = (s + r) * f, d[1] = .5 * _, d[2] = (u + l) * f, d[3] = (h - a) * f) : (f = .5 / (_ = Math.sqrt(1 + c - n - o)),
                                d[0] = (h + a) * f, d[1] = (u + l) * f, d[2] = .5 * _, d[3] = (r - s) * f);
            }, t.DEFAULT = new t(), n(t, ["TEMPVector30", function () {
                return this.TEMPVector30 = new G();
            }, "TEMPVector31", function () {
                return this.TEMPVector31 = new G();
            }, "TEMPVector32", function () {
                return this.TEMPVector32 = new G();
            }, "TEMPVector33", function () {
                return this.TEMPVector33 = new G();
            }, "TEMPMatrix0", function () {
                return this.TEMPMatrix0 = new ze();
            }, "TEMPMatrix1", function () {
                return this.TEMPMatrix1 = new ze();
            }, "_tempMatrix3x3", function () {
                return this._tempMatrix3x3 = new ke();
            }, "NAN", function () {
                return this.NAN = new t(NaN, NaN, NaN, NaN);
            }]), t;
        }(), U = function () {
            function t(t, e, i, n) {
                this.elements = null, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0),
                    void 0 === n && (n = 0);
                var r = this.elements = new Float32Array(4);
                r[0] = t, r[1] = e, r[2] = i, r[3] = n;
            }
            r(t, "laya.d3.math.Native.ConchVector4");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1],
                    this.elements[2] = t[e + 2], this.elements[3] = t[e + 3];
            }, e.cloneTo = function (t) {
                var e = t.elements, i = this.elements;
                e[0] = i[0], e[1] = i[1], e[2] = i[2], e[3] = i[3];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);
            }, e.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
            }, a(0, e, "x", function () {
                return this.elements[0];
            }, function (t) {
                this.elements[0] = t;
            }), a(0, e, "y", function () {
                return this.elements[1];
            }, function (t) {
                this.elements[1] = t;
            }), a(0, e, "z", function () {
                return this.elements[2];
            }, function (t) {
                this.elements[2] = t;
            }), a(0, e, "w", function () {
                return this.elements[3];
            }, function (t) {
                this.elements[3] = t;
            }), t.lerp = function (t, e, i, n) {
                var r = n.elements, a = t.elements, s = e.elements, o = a[0], l = a[1], h = a[2], u = a[3];
                r[0] = o + i * (s[0] - o), r[1] = l + i * (s[1] - l), r[2] = h + i * (s[2] - h),
                    r[3] = u + i * (s[3] - u);
            }, t.transformByM4x4 = function (t, e, i) {
                var n = t.elements, r = n[0], a = n[1], s = n[2], o = n[3], l = e.elements, h = i.elements;
                h[0] = r * l[0] + a * l[4] + s * l[8] + o * l[12], h[1] = r * l[1] + a * l[5] + s * l[9] + o * l[13],
                    h[2] = r * l[2] + a * l[6] + s * l[10] + o * l[14], h[3] = r * l[3] + a * l[7] + s * l[11] + o * l[15];
            }, t.equals = function (t, e) {
                var i = t.elements, n = e.elements;
                return nt.nearEqual(Math.abs(i[0]), Math.abs(n[0])) && nt.nearEqual(Math.abs(i[1]), Math.abs(n[1])) && nt.nearEqual(Math.abs(i[2]), Math.abs(n[2])) && nt.nearEqual(Math.abs(i[3]), Math.abs(n[3]));
            }, t.normalize = function (t, e) {
                var i = t.elements, n = e.elements, r = t.length();
                r > 0 && (n[0] = i[0] * r, n[1] = i[1] * r, n[2] = i[2] * r, n[3] = i[3] * r);
            }, t.add = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] + a[0], n[1] = r[1] + a[1], n[2] = r[2] + a[2], n[3] = r[3] + a[3];
            }, t.subtract = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] - a[0], n[1] = r[1] - a[1], n[2] = r[2] - a[2], n[3] = r[3] - a[3];
            }, t.multiply = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] * a[0], n[1] = r[1] * a[1], n[2] = r[2] * a[2], n[3] = r[3] * a[3];
            }, t.scale = function (t, e, i) {
                var n = i.elements, r = t.elements;
                n[0] = r[0] * e, n[1] = r[1] * e, n[2] = r[2] * e, n[3] = r[3] * e;
            }, t.Clamp = function (t, e, i, n) {
                var r = t.elements, a = r[0], s = r[1], o = r[2], l = r[3], h = e.elements, u = h[0], c = h[1], d = h[2], _ = h[3], f = i.elements, p = f[0], m = f[1], g = f[2], y = f[3], v = n.elements;
                a = (a = a > p ? p : a) < u ? u : a, s = (s = s > m ? m : s) < c ? c : s, o = (o = o > g ? g : o) < d ? d : o,
                    l = (l = l > y ? y : l) < _ ? _ : l, v[0] = a, v[1] = s, v[2] = o, v[3] = l;
            }, t.distanceSquared = function (t, e) {
                var i = t.elements, n = e.elements, r = i[0] - n[0], a = i[1] - n[1], s = i[2] - n[2], o = i[3] - n[3];
                return r * r + a * a + s * s + o * o;
            }, t.distance = function (t, e) {
                var i = t.elements, n = e.elements, r = i[0] - n[0], a = i[1] - n[1], s = i[2] - n[2], o = i[3] - n[3];
                return Math.sqrt(r * r + a * a + s * s + o * o);
            }, t.dot = function (t, e) {
                var i = t.elements, n = e.elements;
                return i[0] * n[0] + i[1] * n[1] + i[2] * n[2] + i[3] * n[3];
            }, t.min = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = Math.min(r[0], a[0]), n[1] = Math.min(r[1], a[1]), n[2] = Math.min(r[2], a[2]),
                    n[3] = Math.min(r[3], a[3]);
            }, t.max = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = Math.max(r[0], a[0]), n[1] = Math.max(r[1], a[1]), n[2] = Math.max(r[2], a[2]),
                    n[3] = Math.max(r[3], a[3]);
            }, n(t, ["ZERO", function () {
                return this.ZERO = new t();
            }, "ONE", function () {
                return this.ONE = new t(1, 1, 1, 1);
            }, "UnitX", function () {
                return this.UnitX = new t(1, 0, 0, 0);
            }, "UnitY", function () {
                return this.UnitY = new t(0, 1, 0, 0);
            }, "UnitZ", function () {
                return this.UnitZ = new t(0, 0, 1, 0);
            }, "UnitW", function () {
                return this.UnitW = new t(0, 0, 0, 1);
            }]), t;
        }(), G = function () {
            function t(t, e, i, n) {
                var r;
                this.elements = null, void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0),
                    r = n || new Float32Array(3), this.elements = r, r[0] = t, r[1] = e, r[2] = i;
            }
            r(t, "laya.d3.math.Native.ConchVector3");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setValue = function (t, e, i) {
                this.elements[0] = t, this.elements[1] = e, this.elements[2] = i;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.elements[0] = t[e + 0], this.elements[1] = t[e + 1],
                    this.elements[2] = t[e + 2];
            }, e.cloneTo = function (t) {
                var e = t.elements, i = this.elements;
                e[0] = i[0], e[1] = i[1], e[2] = i[2];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.toDefault = function () {
                this.elements[0] = 0, this.elements[1] = 0, this.elements[2] = 0;
            }, a(0, e, "x", function () {
                return this.elements[0];
            }, function (t) {
                this.elements[0] = t;
            }), a(0, e, "y", function () {
                return this.elements[1];
            }, function (t) {
                this.elements[1] = t;
            }), a(0, e, "z", function () {
                return this.elements[2];
            }, function (t) {
                this.elements[2] = t;
            }), t.distanceSquared = function (t, e) {
                var i = t.elements, n = e.elements, r = i[0] - n[0], a = i[1] - n[1], s = i[2] - n[2];
                return r * r + a * a + s * s;
            }, t.distance = function (t, e) {
                var i = t.elements, n = e.elements, r = i[0] - n[0], a = i[1] - n[1], s = i[2] - n[2];
                return Math.sqrt(r * r + a * a + s * s);
            }, t.min = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = Math.min(r[0], a[0]), n[1] = Math.min(r[1], a[1]), n[2] = Math.min(r[2], a[2]);
            }, t.max = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = Math.max(r[0], a[0]), n[1] = Math.max(r[1], a[1]), n[2] = Math.max(r[2], a[2]);
            }, t.transformQuat = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements, s = r[0], o = r[1], l = r[2], h = a[0], u = a[1], c = a[2], d = a[3], _ = d * s + u * l - c * o, f = d * o + c * s - h * l, p = d * l + h * o - u * s, m = -h * s - u * o - c * l;
                n[0] = _ * d + m * -h + f * -c - p * -u, n[1] = f * d + m * -u + p * -h - _ * -c,
                    n[2] = p * d + m * -c + _ * -u - f * -h;
            }, t.scalarLength = function (t) {
                var e = t.elements, i = e[0], n = e[1], r = e[2];
                return Math.sqrt(i * i + n * n + r * r);
            }, t.scalarLengthSquared = function (t) {
                var e = t.elements, i = e[0], n = e[1], r = e[2];
                return i * i + n * n + r * r;
            }, t.normalize = function (t, e) {
                var i = t.elements, n = e.elements, r = i[0], a = i[1], s = i[2], o = r * r + a * a + s * s;
                o > 0 && (o = 1 / Math.sqrt(o), n[0] = i[0] * o, n[1] = i[1] * o, n[2] = i[2] * o);
            }, t.multiply = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] * a[0], n[1] = r[1] * a[1], n[2] = r[2] * a[2];
            }, t.scale = function (t, e, i) {
                var n = i.elements, r = t.elements;
                n[0] = r[0] * e, n[1] = r[1] * e, n[2] = r[2] * e;
            }, t.lerp = function (t, e, i, n) {
                var r = n.elements, a = t.elements, s = e.elements, o = a[0], l = a[1], h = a[2];
                r[0] = o + i * (s[0] - o), r[1] = l + i * (s[1] - l), r[2] = h + i * (s[2] - h);
            }, t.transformV3ToV3 = function (e, i, n) {
                var r = t._tempVector4;
                t.transformV3ToV4(e, i, r);
                var a = r.elements, s = n.elements;
                s[0] = a[0], s[1] = a[1], s[2] = a[2];
            }, t.transformV3ToV4 = function (t, e, i) {
                var n = t.elements, r = n[0], a = n[1], s = n[2], o = e.elements, l = i.elements;
                l[0] = r * o[0] + a * o[4] + s * o[8] + o[12], l[1] = r * o[1] + a * o[5] + s * o[9] + o[13],
                    l[2] = r * o[2] + a * o[6] + s * o[10] + o[14], l[3] = r * o[3] + a * o[7] + s * o[11] + o[15];
            }, t.TransformNormal = function (t, e, i) {
                var n = t.elements, r = n[0], a = n[1], s = n[2], o = e.elements, l = i.elements;
                l[0] = r * o[0] + a * o[4] + s * o[8], l[1] = r * o[1] + a * o[5] + s * o[9], l[2] = r * o[2] + a * o[6] + s * o[10];
            }, t.transformCoordinate = function (t, e, i) {
                var n = t.elements, r = n[0], a = n[1], s = n[2], o = e.elements, l = r * o[3] + a * o[7] + s * o[11] + o[15], h = i.elements;
                h[0] = r * o[0] + a * o[4] + s * o[8] + o[12] / l, h[1] = r * o[1] + a * o[5] + s * o[9] + o[13] / l,
                    h[2] = r * o[2] + a * o[6] + s * o[10] + o[14] / l;
            }, t.Clamp = function (t, e, i, n) {
                var r = t.elements, a = r[0], s = r[1], o = r[2], l = e.elements, h = l[0], u = l[1], c = l[2], d = i.elements, _ = d[0], f = d[1], p = d[2], m = n.elements;
                a = (a = a > _ ? _ : a) < h ? h : a, s = (s = s > f ? f : s) < u ? u : s, o = (o = o > p ? p : o) < c ? c : o,
                    m[0] = a, m[1] = s, m[2] = o;
            }, t.add = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] + a[0], n[1] = r[1] + a[1], n[2] = r[2] + a[2];
            }, t.subtract = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements;
                n[0] = r[0] - a[0], n[1] = r[1] - a[1], n[2] = r[2] - a[2];
            }, t.cross = function (t, e, i) {
                var n = t.elements, r = e.elements, a = i.elements, s = n[0], o = n[1], l = n[2], h = r[0], u = r[1], c = r[2];
                a[0] = o * c - l * u, a[1] = l * h - s * c, a[2] = s * u - o * h;
            }, t.dot = function (t, e) {
                var i = t.elements, n = e.elements;
                return i[0] * n[0] + i[1] * n[1] + i[2] * n[2];
            }, t.equals = function (t, e) {
                var i = t.elements, n = e.elements;
                return nt.nearEqual(i[0], n[0]) && nt.nearEqual(i[1], n[1]) && nt.nearEqual(i[2], n[2]);
            }, t.ZERO = new t(0, 0, 0), t.ONE = new t(1, 1, 1), t.NegativeUnitX = new t(-1, 0, 0),
                t.UnitX = new t(1, 0, 0), t.UnitY = new t(0, 1, 0), t.UnitZ = new t(0, 0, 1), t.ForwardRH = new t(0, 0, -1),
                t.ForwardLH = new t(0, 0, 1), t.Up = new t(0, 1, 0), t.NAN = new t(NaN, NaN, NaN),
                n(t, ["_tempVector4", function () {
                    return this._tempVector4 = new U();
                }]), t;
        }(), z = function () {
            function t(t) {
                this._color = null, this.enbale = !1, this._color = t;
            }
            r(t, "laya.d3.core.particleShuriKen.module.ColorOverLifetime");
            var e = t.prototype;
            return e.cloneTo = function (t) {
                var e = t;
                this._color.cloneTo(e._color), e.enbale = this.enbale;
            }, e.clone = function () {
                var t;
                switch (this._color.type) {
                    case 0:
                        t = rt.createByConstant(this._color.constant.clone());
                        break;

                    case 1:
                        t = rt.createByGradient(this._color.gradient.clone());
                        break;

                    case 2:
                        t = rt.createByRandomTwoConstant(this._color.constantMin.clone(), this._color.constantMax.clone());
                        break;

                    case 3:
                        t = rt.createByRandomTwoGradient(this._color.gradientMin.clone(), this._color.gradientMax.clone());
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e;
            }, a(0, e, "color", function () {
                return this._color;
            }), t;
        }(), H = function () {
            function t() {
                this.enable = !1, this.randomDirection = !1;
            }
            r(t, "laya.d3.core.particleShuriKen.module.shape.BaseShape");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e._getShapeBoundBox = function (t) {
                throw new Error("BaseShape: must override it.");
            }, e._getSpeedBoundBox = function (t) {
                throw new Error("BaseShape: must override it.");
            }, e.generatePositionAndDirection = function (t, e, i, n) {
                throw new Error("BaseShape: must override it.");
            }, e._calculateProceduralBounds = function (t, e, i) {
                this._getShapeBoundBox(t);
                var n = t.min, r = t.max;
                gt.multiply(n, e, n), gt.multiply(r, e, r);
                var a = new Ue(new gt(), new gt());
                this.randomDirection ? (a.min = new gt(-1, -1, -1), a.max = new gt(1, 1, 1)) : this._getSpeedBoundBox(a);
                var s = new Ue(new gt(), new gt()), o = s.min, l = s.max;
                gt.scale(a.min, i.y, o), gt.scale(a.max, i.y, l), gt.add(t.min, o, o), gt.add(t.max, l, l),
                    gt.min(t.min, o, t.min), gt.max(t.max, o, t.max);
                var h = new Ue(new gt(), new gt()), u = h.min, c = h.max;
                gt.scale(a.min, i.x, u), gt.scale(a.max, i.x, c), gt.min(h.min, c, o), gt.max(h.min, c, l),
                    gt.min(t.min, o, t.min), gt.max(t.max, o, t.max);
            }, e.cloneTo = function (t) {
                t.enable = this.enable;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t;
        }(), j = function () {
            function t() {
                this._attatched = !1, this._indexInCompound = -1, this._compoundParent = null, this._attatchedCollisionObject = null,
                    this._referenceCount = 0, this.needsCustomCollisionCallback = !1, this._scale = new gt(1, 1, 1),
                    this._centerMatrix = new ze(), this._localOffset = new gt(0, 0, 0), this._localRotation = new ht(0, 0, 0, 1);
            }
            r(t, "laya.d3.physics.shape.ColliderShape");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e._setScale = function (e) {
                this._compoundParent ? this.updateLocalTransformations() : (t._nativeScale.setValue(e.x, e.y, e.z),
                    this._nativeShape.setLocalScaling(t._nativeScale));
            }, e._addReference = function () {
                this._referenceCount++;
            }, e._removeReference = function () {
                this._referenceCount--;
            }, e.updateLocalTransformations = function () {
                if (this._compoundParent) {
                    var e = t._tempVector30;
                    gt.multiply(this.localOffset, this._scale, e), t._createAffineTransformation(e, this.localRotation, this._centerMatrix.elements);
                } else t._createAffineTransformation(this.localOffset, this.localRotation, this._centerMatrix.elements);
            }, e.cloneTo = function (t) {
                var e = t;
                this._localOffset.cloneTo(e.localOffset), this._localRotation.cloneTo(e.localRotation),
                    e.localOffset = e.localOffset, e.localRotation = e.localRotation;
            }, e.clone = function () {
                return null;
            }, e.destroy = function () {
                this._nativeShape && (W._physics3D.destroy(this._nativeShape), this._nativeShape = null);
            }, a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "localOffset", function () {
                return this._localOffset;
            }, function (t) {
                this._localOffset = t, this._compoundParent && this._compoundParent._updateChildTransform(this);
            }), a(0, e, "localRotation", function () {
                return this._localRotation;
            }, function (t) {
                this._localRotation = t, this._compoundParent && this._compoundParent._updateChildTransform(this);
            }), t._creatShape = function (t) {
                var e;
                switch (t.type) {
                    case "BoxColliderShape":
                        var i = t.size;
                        e = i ? new li(i[0], i[1], i[2]) : new li();
                        break;

                    case "SphereColliderShape":
                        e = new ti(t.radius);
                        break;

                    case "CapsuleColliderShape":
                        e = new ri(t.radius, t.height, t.orientation);
                        break;

                    case "MeshColliderShape":
                        var n = new Ci();
                        t.mesh && (n.mesh = T.getRes(t.mesh)), e = n;
                        break;

                    case "ConeColliderShape":
                        e = new Mi(t.radius, t.height, t.orientation);
                        break;

                    case "CylinderColliderShape":
                        e = new pi(t.radius, t.height, t.orientation);
                        break;

                    default:
                        throw "unknown shape type.";
                }
                if (t.center) {
                    var r = e.localOffset;
                    r.fromArray(t.center), e.localOffset = r;
                }
                return e;
            }, t._createAffineTransformation = function (t, e, i) {
                var n = e.x, r = e.y, a = e.z, s = e.w, o = n + n, l = r + r, h = a + a, u = n * o, c = n * l, d = n * h, _ = r * l, f = r * h, p = a * h, m = s * o, g = s * l, y = s * h;
                i[0] = 1 - (_ + p), i[1] = c + y, i[2] = d - g, i[3] = 0, i[4] = c - y, i[5] = 1 - (u + p),
                    i[6] = f + m, i[7] = 0, i[8] = d + g, i[9] = f - m, i[10] = 1 - (u + _), i[11] = 0,
                    i[12] = t.x, i[13] = t.y, i[14] = t.z, i[15] = 1;
            }, t.SHAPEORIENTATION_UPX = 0, t.SHAPEORIENTATION_UPY = 1, t.SHAPEORIENTATION_UPZ = 2,
                t.SHAPETYPES_BOX = 0, t.SHAPETYPES_SPHERE = 1, t.SHAPETYPES_CYLINDER = 2, t.SHAPETYPES_CAPSULE = 3,
                t.SHAPETYPES_CONVEXHULL = 4, t.SHAPETYPES_COMPOUND = 5, t.SHAPETYPES_STATICPLANE = 6,
                t.SHAPETYPES_CONE = 7, n(t, ["_tempVector30", function () {
                    return this._tempVector30 = new gt();
                }, "_nativeScale", function () {
                    return this._nativeScale = new W._physics3D.btVector3(1, 1, 1);
                }, "_nativeVector30", function () {
                    return this._nativeVector30 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativQuaternion0", function () {
                    return this._nativQuaternion0 = new W._physics3D.btQuaternion(0, 0, 0, 1);
                }, "_nativeTransform0", function () {
                    return this._nativeTransform0 = new W._physics3D.btTransform();
                }]), t;
        }(), W = function () {
            function e() { }
            return r(e, "Laya3D"), a(1, e, "enbalePhysics", function () {
                return e._enbalePhysics;
            }), e._cancelLoadByUrl = function (t) {
                i.loader.cancelLoadByUrl(t), e._innerFirstLevelLoaderManager.cancelLoadByUrl(t),
                    e._innerSecondLevelLoaderManager.cancelLoadByUrl(t), e._innerThirdLevelLoaderManager.cancelLoadByUrl(t),
                    e._innerFourthLevelLoaderManager.cancelLoadByUrl(t);
            }, e._changeWebGLSize = function (t, e) {
                F.onStageResize(t, e), J.clientWidth = t, J.clientHeight = e;
            }, e.__init__ = function (t, n, r) {
                if (p.isAntialias = r.isAntialias, p.isAlpha = r.isAlpha, p.premultipliedAlpha = r.premultipliedAlpha,
                    p.isStencil = r.isStencil, F.enable()) {
                    A.changeWebGLSize = e._changeWebGLSize, I.is3DMode = !0, i.init(t, n), I.supportWebGLPlusRendering || (v.instance = F.mainContext,
                        v.instance.createCommandEncoder = function (t, e, i) {
                            return void 0 === t && (t = 128), void 0 === e && (e = 64), void 0 === i && (i = !1),
                                new _(this, t, e, i);
                        }), e.enableNative3D(), Bi.__init__(), Qi.__init__(), yn.__init__(), xn.__init__(),
                        En.__init__(), Fi.__init__(), cn.__init__(), sn.__init__(), fn.__init__(), nn.__init__(),
                        Ji.__init__(), Tn.__init__(), en.__init__(), ln.__init__(), hn.__init__(), on.__init__(),
                        dn.__init__(), un.__init__(), zt.__init__(), rn.defaultMaterial.lock = !0, cn.defaultMaterial.lock = !0,
                        ln.defaultMaterial.lock = !0, sn.defaultMaterial.lock = !0, fn.defaultMaterial.lock = !0,
                        Ji.defaultMaterial.lock = !0, on.defaultMaterial.lock = !0, en.defaultMaterial.lock = !0,
                        nn.defaultMaterial.lock = !0, _n.defaultMaterial.lock = !0, hn.defaultMaterial.lock = !0,
                        N.__init__(), gn.__init__(), Ei.__init__(), Ri.__init__(), ki.__init__(), Ie.__init__(),
                        Ne.__init__(), Rt.__init__();
                    var a = E.createMap;
                    a.lh = ["HIERARCHY", Bi._parse], a.ls = ["HIERARCHY", Zi._parse], a.lm = ["MESH", Ui._parse],
                        a.lmat = ["MATERIAL", Fi._parse], a.ltc = ["TEXTURECUBE", gn._parse], a.jpg = ["TEXTURE2D", N._parse],
                        a.jpeg = ["TEXTURE2D", N._parse], a.bmp = ["TEXTURE2D", N._parse], a.gif = ["TEXTURE2D", N._parse],
                        a.png = ["TEXTURE2D", N._parse], a.dds = ["TEXTURE2D", N._parse], a.ktx = ["TEXTURE2D", N._parse],
                        a.pvr = ["TEXTURE2D", N._parse], a.lani = ["ANIMATIONCLIP", zi._parse], a.lav = ["AVATAR", Vi._parse],
                        a.thdata = ["TERRAINHEIGHTDATA", Gi._pharse];
                    var s = T.parserMap;
                    s.HIERARCHY = e._loadHierarchy, s.MESH = e._loadMesh, s.MATERIAL = e._loadMaterial,
                        s.TEXTURECUBE = e._loadTextureCube, s.TEXTURE2D = e._loadTexture2D, s.ANIMATIONCLIP = e._loadAnimationClip,
                        s.AVATAR = e._loadAvatar, e._innerFirstLevelLoaderManager.on("error", null, e._eventLoadManagerError),
                        e._innerSecondLevelLoaderManager.on("error", null, e._eventLoadManagerError), e._innerThirdLevelLoaderManager.on("error", null, e._eventLoadManagerError),
                        e._innerFourthLevelLoaderManager.on("error", null, e._eventLoadManagerError);
                } else alert("Laya3D init error,must support webGL!");
            }, e.enableNative3D = function () {
                if (I.isConchApp) {
                    v = t.LayaGLContext;
                    var e = ut, i = Hi, n = Vi, r = Ne, a = Yi;
                    if (I.supportWebGLPlusRendering && (e.prototype._initData = e.prototype._initDataForNative,
                        e.prototype.setBool = e.prototype.setBoolForNative, e.prototype.getBool = e.prototype.getBoolForNative,
                        e.prototype.setInt = e.prototype.setIntForNative, e.prototype.getInt = e.prototype.getIntForNative,
                        e.prototype.setNumber = e.prototype.setNumberForNative, e.prototype.getNumber = e.prototype.getNumberForNative,
                        e.prototype.setVector = e.prototype.setVectorForNative, e.prototype.getVector = e.prototype.getVectorForNative,
                        e.prototype.setVector2 = e.prototype.setVector2ForNative, e.prototype.getVector2 = e.prototype.getVector2ForNative,
                        e.prototype.setVector3 = e.prototype.setVector3ForNative, e.prototype.getVector3 = e.prototype.getVector3ForNative,
                        e.prototype.setQuaternion = e.prototype.setQuaternionForNative, e.prototype.getQuaternion = e.prototype.getQuaternionForNative,
                        e.prototype.setMatrix4x4 = e.prototype.setMatrix4x4ForNative, e.prototype.getMatrix4x4 = e.prototype.getMatrix4x4ForNative,
                        e.prototype.setBuffer = e.prototype.setBufferForNative, e.prototype.getBuffer = e.prototype.getBufferForNative,
                        e.prototype.setTexture = e.prototype.setTextureForNative, e.prototype.getTexture = e.prototype.getTextureForNative,
                        e.prototype.setAttribute = e.prototype.setAttributeForNative, e.prototype.getAttribute = e.prototype.getAttributeForNative,
                        e.prototype.cloneTo = e.prototype.cloneToForNative, e.prototype.getData = e.prototype.getDataForNative,
                        i.prototype._uniformMatrix2fv = i.prototype._uniformMatrix2fvForNative, i.prototype._uniformMatrix3fv = i.prototype._uniformMatrix3fvForNative,
                        i.prototype._uniformMatrix4fv = i.prototype._uniformMatrix4fvForNative, a.prototype._renderUpdateWithCamera = a.prototype._renderUpdateWithCameraForNative),
                        I.supportWebGLPlusCulling && (r.renderObjectCulling = Ne.renderObjectCullingNative),
                        I.supportWebGLPlusAnimation) {
                        n.prototype._cloneDatasToAnimator = n.prototype._cloneDatasToAnimatorNative, mi = t.conchFloatKeyframe,
                            Ai = t.conchFloatArrayKeyframe, Oi = t.conchFloatArrayKeyframe, Te = t.conchKeyframeNode,
                            Qt = t.conchKeyframeNodeList;
                        var s = zi;
                        s.prototype._evaluateClipDatasRealTime = s.prototype._evaluateClipDatasRealTimeForNative;
                    }
                }
                F.shaderHighPrecision = !1, v.instance.getShaderPrecisionFormat(35632, 36338).precision ? F.shaderHighPrecision = !0 : F.shaderHighPrecision = !1;
            }, e.formatRelativePath = function (t, e) {
                var i;
                if (i = t + e, "." === e.charAt(0)) {
                    for (var n = i.split("/"), r = 0, a = n.length; r < a; r++) if (".." == n[r]) {
                        var s = r - 1;
                        s > 0 && ".." !== n[s] && (n.splice(s, 2), r -= 2);
                    }
                    i = n.join("/");
                }
                return i;
            }, e._endLoad = function (t, e, i) {
                if (i) for (var n = 0, r = i.length; n < r; n++) {
                    var a = T.getRes(i[n]);
                    a && a._removeReference();
                }
                t.endLoad(e);
            }, e._eventLoadManagerError = function (t) {
                i.loader.event("error", t);
            }, e._addHierarchyInnerUrls = function (t, i, n, r, a, s, o, l) {
                var h = e.formatRelativePath(r, a);
                return n && (h += n), t.push({
                    url: h,
                    type: s,
                    constructParams: o,
                    propertyParams: l
                }), i.push(h), h;
            }, e._getSprite3DHierarchyInnerUrls = function (t, i, n, r, a, s, o, l) {
                var h = 0, u = 0, c = t.props;
                switch (t.type) {
                    case "Scene3D":
                        var d = c.lightmaps;
                        for (h = 0, u = d.length; h < u; h++) {
                            var _ = d[h];
                            _.path = e._addHierarchyInnerUrls(a, s, o, l, _.path, "TEXTURE2D", _.constructParams, _.propertyParams);
                        }
                        var f = c.reflectionTexture;
                        if (f && (c.reflectionTexture = e._addHierarchyInnerUrls(r, s, o, l, f, "TEXTURECUBE")),
                            c.sky) {
                            var p = c.sky.material;
                            p && (p.path = e._addHierarchyInnerUrls(n, s, o, l, p.path, "MATERIAL"));
                        }
                        break;

                    case "Camera":
                        var m = c.skyboxMaterial;
                        m && (m.path = e._addHierarchyInnerUrls(n, s, o, l, m.path, "MATERIAL"));
                        break;

                    case "TrailSprite3D":
                    case "MeshSprite3D":
                    case "SkinnedMeshSprite3D":
                        var g = c.meshPath;
                        g && (c.meshPath = e._addHierarchyInnerUrls(i, s, o, l, g, "MESH"));
                        var y = c.materials;
                        if (y) for (h = 0, u = y.length; h < u; h++) y[h].path = e._addHierarchyInnerUrls(n, s, o, l, y[h].path, "MATERIAL");
                        break;

                    case "ShuriKenParticle3D":
                        var v = c.meshPath;
                        v && (c.meshPath = e._addHierarchyInnerUrls(i, s, o, l, v, "MESH")), c.material.path = e._addHierarchyInnerUrls(n, s, o, l, c.material.path, "MATERIAL");
                        break;

                    case "Terrain":
                        e._addHierarchyInnerUrls(a, s, o, l, c.dataPath, "TERRAIN");
                }
                var S = t.components;
                if (S) for (var T = 0, E = S.length; T < E; T++) {
                    var C = S[T];
                    switch (C.type) {
                        case "Animator":
                            C.avatarPath;
                            var x = C.avatar;
                            x && (x.path = e._addHierarchyInnerUrls(a, s, o, l, x.path, "AVATAR"));
                            var b = C.clipPaths;
                            if (b) for (h = 0, u = b.length; h < u; h++) b[h] = e._addHierarchyInnerUrls(a, s, o, l, b[h], "ANIMATIONCLIP"); else {
                                var I = C.layers;
                                for (h = 0; h < I.length; h++) for (var w = I[h].states, A = 0, R = w.length; A < R; A++) {
                                    var M = w[A].clipPath;
                                    M && (w[A].clipPath = e._addHierarchyInnerUrls(a, s, o, l, M, "ANIMATIONCLIP"));
                                }
                            }
                            break;

                        case "PhysicsCollider":
                        case "Rigidbody3D":
                        case "CharacterController":
                            var D = C.shapes;
                            for (h = 0; h < D.length; h++) {
                                var O = D[h];
                                if ("MeshColliderShape" === O.type) {
                                    var L = O.mesh;
                                    L && (O.mesh = e._addHierarchyInnerUrls(i, s, o, l, L, "MESH"));
                                }
                            }
                    }
                }
                var P = t.child;
                for (h = 0, u = P.length; h < u; h++) e._getSprite3DHierarchyInnerUrls(P[h], i, n, r, a, s, o, l);
            }, e._loadHierarchy = function (t) {
                t.on("loaded", null, e._onHierarchylhLoaded, [t]), t.load(t.url, "json", !1, null, !0);
            }, e._onHierarchylhLoaded = function (t, i) {
                var n = t.url, r = Ht.getURLVerion(n), a = B.getPath(n), s = [], o = [], l = [], h = [], u = [];
                e._getSprite3DHierarchyInnerUrls(i.data, s, o, l, h, u, r, a);
                var c = s.length + o.length + h.length, d = c + 1, _ = 1 / d;
                if (e._onProcessChange(t, 0, _, 1), h.length > 0) {
                    var f = c / d, p = y.create(null, e._onProcessChange, [t, _, f], !1);
                    e._innerFourthLevelLoaderManager._create(h, !1, y.create(null, e._onHierarchyInnerForthLevResouLoaded, [t, p, i, u, s, o, l, _ + f * h.length, f]), p, null, null, null, 1, !0);
                } else e._onHierarchyInnerForthLevResouLoaded(t, null, i, u, s, o, l, _, f);
            }, e._onHierarchyInnerForthLevResouLoaded = function (t, i, n, r, a, s, o, l, h) {
                if (i && i.recover(), o.length > 0) {
                    var u = y.create(null, e._onProcessChange, [t, l, h], !1);
                    e._innerThirdLevelLoaderManager._create(o, !1, y.create(null, e._onHierarchyInnerThirdLevResouLoaded, [t, u, n, r, a, s, l + h * s.length, h]), i, null, null, null, 1, !0);
                } else e._onHierarchyInnerThirdLevResouLoaded(t, null, n, r, a, s, l, h);
            }, e._onHierarchyInnerThirdLevResouLoaded = function (t, i, n, r, a, s, o, l) {
                if (i && i.recover(), s.length > 0) {
                    var h = y.create(null, e._onProcessChange, [t, o, l], !1);
                    e._innerSecondLevelLoaderManager._create(s, !1, y.create(null, e._onHierarchyInnerSecondLevResouLoaded, [t, h, n, r, a, o + l * s.length, l]), i, null, null, null, 1, !0);
                } else e._onHierarchyInnerSecondLevResouLoaded(t, null, n, r, a, o, l);
            }, e._onHierarchyInnerSecondLevResouLoaded = function (t, i, n, r, a, s, o) {
                if (i && i.recover(), a.length > 0) {
                    var l = y.create(null, e._onProcessChange, [t, s, o], !1);
                    e._innerFirstLevelLoaderManager._create(a, !1, y.create(null, e._onHierarchyInnerFirstLevResouLoaded, [t, l, n, r]), i, null, null, null, 1, !0);
                } else e._onHierarchyInnerFirstLevResouLoaded(t, null, n, r);
            }, e._onHierarchyInnerFirstLevResouLoaded = function (t, i, n, r) {
                i && i.recover(), t._cache = t._createCache;
                var a = "Scene3D" === n.data.type ? Zi._parse(n, t._propertyParams, t._constructParams) : Bi._parse(n, t._propertyParams, t._constructParams);
                e._endLoad(t, a, r);
            }, e._loadMesh = function (t) {
                t.on("loaded", null, e._onMeshLmLoaded, [t]), t.load(t.url, "arraybuffer", !1, null, !0);
            }, e._onMeshLmLoaded = function (t, i) {
                t._cache = t._createCache;
                var n = Ui._parse(i, t._propertyParams, t._constructParams);
                e._endLoad(t, n);
            }, e._loadMaterial = function (t) {
                t.on("loaded", null, e._onMaterilLmatLoaded, [t]), t.load(t.url, "json", !1, null, !0);
            }, e._onMaterilLmatLoaded = function (t, i) {
                var n, r = t.url, a = Ht.getURLVerion(r), s = B.getPath(r), o = [], l = [];
                i.customProps;
                switch (i.version) {
                    case "LAYAMATERIAL:01":
                    case "LAYAMATERIAL:02":
                        var h = 0, u = 0, c = i.props.textures;
                        if (c) for (h = 0, u = c.length; h < u; h++) {
                            var d = c[h], _ = d.path;
                            _ && (n = e.formatRelativePath(s, _), a && (n += a), o.push({
                                url: n,
                                constructParams: d.constructParams,
                                propertyParams: d.propertyParams
                            }), l.push(n), d.path = n);
                        }
                        break;

                    default:
                        throw new Error("Laya3D:unkonwn version.");
                }
                var f = o.length, p = f + 1, m = 1 / p;
                if (e._onProcessChange(t, 0, m, 1), f > 0) {
                    var g = y.create(null, e._onProcessChange, [t, m, f / p], !1);
                    e._innerFourthLevelLoaderManager._create(o, !1, y.create(null, e._onMateialTexturesLoaded, [t, g, i, l]), g, null, null, null, 1, !0);
                } else e._onMateialTexturesLoaded(t, null, i, null);
            }, e._onMateialTexturesLoaded = function (t, i, n, r) {
                t._cache = t._createCache;
                var a = Fi._parse(n, t._propertyParams, t._constructParams);
                e._endLoad(t, a, r), i && i.recover();
            }, e._loadAvatar = function (t) {
                t.on("loaded", null, function (i) {
                    t._cache = t._createCache;
                    var n = Vi._parse(i, t._propertyParams, t._constructParams);
                    e._endLoad(t, n);
                }), t.load(t.url, "json", !1, null, !0);
            }, e._loadAnimationClip = function (t) {
                t.on("loaded", null, function (i) {
                    t._cache = t._createCache;
                    var n = zi._parse(i, t._propertyParams, t._constructParams);
                    e._endLoad(t, n);
                }), t.load(t.url, "arraybuffer", !1, null, !0);
            }, e._loadTexture2D = function (t) {
                var i, n = t.url, r = n.lastIndexOf(".") + 1, a = n.indexOf("?"), s = -1 == a ? n.length : a;
                switch (n.substr(r, s - r)) {
                    case "jpg":
                    case "jpeg":
                    case "bmp":
                    case "gif":
                    case "png":
                        i = "nativeimage";
                        break;

                    case "dds":
                    case "ktx":
                    case "pvr":
                        i = "arraybuffer";
                }
                t.on("loaded", null, function (i) {
                    t._cache = t._createCache;
                    var n = N._parse(i, t._propertyParams, t._constructParams);
                    e._endLoad(t, n);
                }), t.load(t.url, i, !1, null, !0);
            }, e._loadTextureCube = function (t) {
                t.on("loaded", null, e._onTextureCubeLtcLoaded, [t]), t.load(t.url, "json", !1, null, !0);
            }, e._onTextureCubeLtcLoaded = function (t, i) {
                var n = B.getPath(t.url), r = [e.formatRelativePath(n, i.front), e.formatRelativePath(n, i.back), e.formatRelativePath(n, i.left), e.formatRelativePath(n, i.right), e.formatRelativePath(n, i.up), e.formatRelativePath(n, i.down)];
                e._onProcessChange(t, 0, 1 / 7, 1);
                var a = y.create(null, e._onProcessChange, [t, 1 / 7, 6 / 7], !1);
                e._innerFourthLevelLoaderManager.load(r, y.create(null, e._onTextureCubeImagesLoaded, [t, r, a]), a, "nativeimage");
            }, e._onTextureCubeImagesLoaded = function (t, i, n) {
                for (var r = new Array(6), a = 0; a < 6; a++) r[a] = T.getRes(i[a]);
                t._cache = t._createCache;
                var s = gn._parse(r, t._propertyParams, t._constructParams);
                for (n.recover(), a = 0; a < 6; a++) T.clearRes(i[a]);
                e._endLoad(t, s);
            }, e._onProcessChange = function (t, e, i, n) {
                (n = e + n * i) < 1 && t.event("progress", n);
            }, e.init = function (i, n, r, a) {
                if (!e._isInit) {
                    e._isInit = !0, (r = r || ue._default).cloneTo(e._config), e._editerEnvironment = e._config._editerEnvironment;
                    var s = t.Physics3D;
                    null == s ? (e._enbalePhysics = !1, e.__init__(i, n, e._config), a && a.run()) : (e._enbalePhysics = !0,
                        s(1024 * e._config.defaultPhysicsMemory * 1024).then(function () {
                            e.__init__(i, n, e._config), a && a.run();
                        }));
                }
            }, e.HIERARCHY = "HIERARCHY", e.MESH = "MESH", e.MATERIAL = "MATERIAL", e.TEXTURE2D = "TEXTURE2D",
                e.TEXTURECUBE = "TEXTURECUBE", e.ANIMATIONCLIP = "ANIMATIONCLIP", e.AVATAR = "AVATAR",
                e.TERRAINHEIGHTDATA = "TERRAINHEIGHTDATA", e.TERRAINRES = "TERRAIN", e._isInit = !1,
                e._enbalePhysics = !1, e._editerEnvironment = !1, n(e, ["_innerFirstLevelLoaderManager", function () {
                    return this._innerFirstLevelLoaderManager = new E();
                }, "_innerSecondLevelLoaderManager", function () {
                    return this._innerSecondLevelLoaderManager = new E();
                }, "_innerThirdLevelLoaderManager", function () {
                    return this._innerThirdLevelLoaderManager = new E();
                }, "_innerFourthLevelLoaderManager", function () {
                    return this._innerFourthLevelLoaderManager = new E();
                }, "_physics3D", function () {
                    return this._physics3D = t.Physics3D;
                }, "_config", function () {
                    return this._config = new ue();
                }, "physicsSettings", function () {
                    return this.physicsSettings = new at();
                }]), e;
        }(), X = function () {
            function t() {
                this._type = 0, this._constant = 0, this._overTime = null, this._constantMin = 0,
                    this._constantMax = 0, this._overTimeMin = null, this._overTimeMax = null;
            }
            r(t, "laya.d3.core.particleShuriKen.module.FrameOverTime");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._constant = this._constant, this._overTime.cloneTo(e._overTime),
                    e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._overTimeMin.cloneTo(e._overTimeMin),
                    this._overTimeMax.cloneTo(e._overTimeMax);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "frameOverTimeData", function () {
                return this._overTime;
            }), a(0, e, "constant", function () {
                return this._constant;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "frameOverTimeDataMin", function () {
                return this._overTimeMin;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "frameOverTimeDataMax", function () {
                return this._overTimeMax;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), t.createByConstant = function (e) {
                var i = new t();
                return i._type = 0, i._constant = e, i;
            }, t.createByOverTime = function (e) {
                var i = new t();
                return i._type = 1, i._overTime = e, i;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 2, n._constantMin = e, n._constantMax = i, n;
            }, t.createByRandomTwoOverTime = function (e, i) {
                var n = new t();
                return n._type = 3, n._overTimeMin = e, n._overTimeMax = i, n;
            }, t;
        }(), Y = function () {
            function t() {
                this.cull = 0, this.blend = 0, this.srcBlend = 0, this.dstBlend = 0, this.srcBlendRGB = 0,
                    this.dstBlendRGB = 0, this.srcBlendAlpha = 0, this.dstBlendAlpha = 0, this.blendConstColor = null,
                    this.blendEquation = 0, this.blendEquationRGB = 0, this.blendEquationAlpha = 0,
                    this.depthTest = 0, this.depthWrite = !1, this.cull = 2, this.blend = 0, this.srcBlend = 1,
                    this.dstBlend = 0, this.srcBlendRGB = 1, this.dstBlendRGB = 0, this.srcBlendAlpha = 1,
                    this.dstBlendAlpha = 0, this.blendConstColor = new pt(1, 1, 1, 1), this.blendEquation = 0,
                    this.blendEquationRGB = 0, this.blendEquationAlpha = 0, this.depthTest = 515, this.depthWrite = !0;
            }
            r(t, "laya.d3.core.material.RenderState");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e.cull = this.cull, e.blend = this.blend, e.srcBlend = this.srcBlend, e.dstBlend = this.dstBlend,
                    e.srcBlendRGB = this.srcBlendRGB, e.dstBlendRGB = this.dstBlendRGB, e.srcBlendAlpha = this.srcBlendAlpha,
                    e.dstBlendAlpha = this.dstBlendAlpha, this.blendConstColor.cloneTo(e.blendConstColor),
                    e.blendEquation = this.blendEquation, e.blendEquationRGB = this.blendEquationRGB,
                    e.blendEquationAlpha = this.blendEquationAlpha, e.depthTest = this.depthTest, e.depthWrite = this.depthWrite;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t.CULL_NONE = 0, t.CULL_FRONT = 1, t.CULL_BACK = 2, t.BLEND_DISABLE = 0, t.BLEND_ENABLE_ALL = 1,
                t.BLEND_ENABLE_SEPERATE = 2, t.BLENDPARAM_ZERO = 0, t.BLENDPARAM_ONE = 1, t.BLENDPARAM_SRC_COLOR = 768,
                t.BLENDPARAM_ONE_MINUS_SRC_COLOR = 769, t.BLENDPARAM_DST_COLOR = 774, t.BLENDPARAM_ONE_MINUS_DST_COLOR = 775,
                t.BLENDPARAM_SRC_ALPHA = 770, t.BLENDPARAM_ONE_MINUS_SRC_ALPHA = 771, t.BLENDPARAM_DST_ALPHA = 772,
                t.BLENDPARAM_ONE_MINUS_DST_ALPHA = 773, t.BLENDPARAM_SRC_ALPHA_SATURATE = 776, t.BLENDEQUATION_ADD = 0,
                t.BLENDEQUATION_SUBTRACT = 1, t.BLENDEQUATION_REVERSE_SUBTRACT = 2, t.DEPTHTEST_OFF = 0,
                t.DEPTHTEST_NEVER = 512, t.DEPTHTEST_LESS = 513, t.DEPTHTEST_EQUAL = 514, t.DEPTHTEST_LEQUAL = 515,
                t.DEPTHTEST_GREATER = 516, t.DEPTHTEST_NOTEQUAL = 517, t.DEPTHTEST_GEQUAL = 518,
                t.DEPTHTEST_ALWAYS = 519, t;
        }(), q = function () {
            function t(t, e) {
                this.origin = null, this.direction = null, this.origin = t, this.direction = e;
            }
            return r(t, "laya.d3.math.Ray"), t;
        }(), K = function () {
            function t() {
                this._idCounter = 0, this.colliderA = null, this.colliderB = null, this.distance = 0,
                    this.normal = new gt(), this.positionOnA = new gt(), this.positionOnB = new gt(),
                    this._id = ++this._idCounter;
            }
            return r(t, "laya.d3.physics.ContactPoint"), t;
        }(), Z = function () {
            function t() {
                this._initBatchSprites = [], this._staticBatches = {}, this._batchRenderElementPoolIndex = 0,
                    this._batchRenderElementPool = [];
            }
            r(t, "laya.d3.graphics.StaticBatchManager");
            var e = t.prototype;
            return e._partition = function (t, e, i) {
                for (var n = t[Math.floor((i + e) / 2)]; e <= i;) {
                    for (; this._compare(t[e], n) < 0;) e++;
                    for (; this._compare(t[i], n) > 0;) i--;
                    if (e < i) {
                        var r = t[e];
                        t[e] = t[i], t[i] = r, e++, i--;
                    } else if (e === i) {
                        e++;
                        break;
                    }
                }
                return e;
            }, e._quickSort = function (t, e, i) {
                if (t.length > 1) {
                    var n = this._partition(t, e, i), r = n - 1;
                    e < r && this._quickSort(t, e, r), n < i && this._quickSort(t, n, i);
                }
            }, e._compare = function (t, e) {
                throw "StaticBatch:must override this function.";
            }, e._initStaticBatchs = function (t) {
                throw "StaticBatch:must override this function.";
            }, e._getBatchRenderElementFromPool = function () {
                throw "StaticBatch:must override this function.";
            }, e._addBatchSprite = function (t) {
                this._initBatchSprites.push(t);
            }, e._clear = function () {
                this._batchRenderElementPoolIndex = 0;
            }, e._garbageCollection = function () {
                throw "StaticBatchManager: must override it.";
            }, e.dispose = function () {
                this._staticBatches = null;
            }, t._registerManager = function (e) {
                t._managers.push(e);
            }, t._addToStaticBatchQueue = function (e, i) {
                e instanceof laya.d3.core.RenderableSprite3D && e.isStatic && i.push(e);
                for (var n = 0, r = e.numChildren; n < r; n++) t._addToStaticBatchQueue(e._children[n], i);
            }, t.combine = function (e, i) {
                i || (i = [], e && t._addToStaticBatchQueue(e, i));
                var n = i.length;
                if (n > 0) {
                    for (var r = 0; r < n; r++) {
                        var a = i[r];
                        a.isStatic && a._addToInitStaticBatchManager();
                    }
                    for (var s = 0, o = t._managers.length; s < o; s++) {
                        t._managers[s]._initStaticBatchs(e);
                    }
                }
            }, t._managers = [], t;
        }(), Q = function () {
            function t() { }
            r(t, "laya.d3.core.render.command.Command");
            var e = t.prototype;
            return e.run = function () { }, e.recover = function () { }, t;
        }(), J = function () {
            function t() { }
            return r(t, "laya.d3.core.render.RenderContext3D"), t.clientWidth = 0, t.clientHeight = 0,
                n(t, ["_instance", function () {
                    return this._instance = new t();
                }]), t;
        }(), $ = (function () {
            function t() { }
            r(t, "laya.d3.core.GradientMode"), t.Blend = 0, t.Fixed = 1;
        }(), function () {
            function t() {
                this.length = 0, this.elements = [];
            }
            return r(t, "laya.d3.component.SingletonList"), t.prototype._add = function (t) {
                this.length === this.elements.length ? this.elements.push(t) : this.elements[this.length] = t;
            }, t;
        }()), tt = function () {
            function t() {
                this._batchRenderElementPool = [];
            }
            r(t, "laya.d3.graphics.DynamicBatchManager");
            var e = t.prototype;
            return e._clear = function () {
                this._batchRenderElementPoolIndex = 0;
            }, e._getBatchRenderElementFromPool = function () {
                throw "StaticBatch:must override this function.";
            }, e.dispose = function () { }, t._registerManager = function (e) {
                t._managers.push(e);
            }, t._managers = [], t;
        }(), et = (function () {
            function t() {
                this._damping = NaN, this._impulseClamp = NaN, this._tau = NaN, this._pivotInA = new gt(),
                    this._pivotInB = new gt();
            }
            r(t, "laya.d3.physics.constraints.Point2PointConstraint");
            var e = t.prototype;
            a(0, e, "pivotInA", function () {
                return this._pivotInA;
            }, function (t) {
                this._pivotInA = t;
            }), a(0, e, "pivotInB", function () {
                return this._pivotInB;
            }, function (t) {
                this._pivotInB = t;
            }), a(0, e, "damping", function () {
                return this._damping;
            }, function (t) {
                this._damping = t;
            }), a(0, e, "impulseClamp", function () {
                return this._impulseClamp;
            }, function (t) {
                this._impulseClamp = t;
            }), a(0, e, "tau", function () {
                return this._tau;
            }, function (t) {
                this._tau = t;
            });
        }(), function () {
            function t() {
                this._destroyed = !1;
            }
            r(t, "laya.d3.core.GeometryElement");
            var e = t.prototype;
            return i.imps(e, {
                "laya.resource.IDestroy": !0
            }), e._getType = function () {
                throw "GeometryElement:must override it.";
            }, e._prepareRender = function (t) {
                return !0;
            }, e._render = function (t) {
                throw "GeometryElement:must override it.";
            }, e.destroy = function () {
                this._destroyed || (this._destroyed = !0);
            }, a(0, e, "destroyed", function () {
                return this._destroyed;
            }), t._typeCounter = 0, t;
        }()), it = function () {
            function t(t, e) {
                this._position = null, this._textureCoordinate0 = null, this._position = t, this._textureCoordinate0 = e;
            }
            r(t, "laya.d3.graphics.Vertex.VertexPositionTexture0");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.graphics.IVertex": !0
            }), a(0, e, "position", function () {
                return this._position;
            }), a(0, e, "textureCoordinate0", function () {
                return this._textureCoordinate0;
            }), a(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), a(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), n(t, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(20, [new Ut(0, "vector3", 0), new Ut(12, "vector2", 2)]);
            }]), t;
        }(), nt = function () {
            function t() { }
            return r(t, "laya.d3.math.MathUtils3D"), t.isZero = function (e) {
                return Math.abs(e) < t.zeroTolerance;
            }, t.nearEqual = function (e, i) {
                return !!t.isZero(e - i);
            }, t.fastInvSqrt = function (e) {
                return t.isZero(e) ? e : 1 / Math.sqrt(e);
            }, n(t, ["zeroTolerance", function () {
                return this.zeroTolerance = 1e-6;
            }, "MaxValue", function () {
                return this.MaxValue = 3.40282347e38;
            }, "MinValue", function () {
                return this.MinValue = -3.40282347e38;
            }]), t;
        }(), rt = function () {
            function t() {
                this._type = 0, this._constant = null, this._constantMin = null, this._constantMax = null,
                    this._gradient = null, this._gradientMin = null, this._gradientMax = null;
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientColor");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, this._constant.cloneTo(e._constant), this._constantMin.cloneTo(e._constantMin),
                    this._constantMax.cloneTo(e._constantMax), this._gradient.cloneTo(e._gradient),
                    this._gradientMin.cloneTo(e._gradientMin), this._gradientMax.cloneTo(e._gradientMax);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradient", function () {
                return this._gradient;
            }), a(0, e, "constant", function () {
                return this._constant;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "gradientMin", function () {
                return this._gradientMin;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "gradientMax", function () {
                return this._gradientMax;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), t.createByConstant = function (e) {
                var i = new t();
                return i._type = 0, i._constant = e, i;
            }, t.createByGradient = function (e) {
                var i = new t();
                return i._type = 1, i._gradient = e, i;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 2, n._constantMin = e, n._constantMax = i, n;
            }, t.createByRandomTwoGradient = function (e, i) {
                var n = new t();
                return n._type = 3, n._gradientMin = e, n._gradientMax = i, n;
            }, t;
        }(), at = (function () {
            function t(t, e) {
                this._width = 0, this._height = 0, this._width = t, this._height = e;
            }
            r(t, "laya.d3.utils.Size");
            var e = t.prototype;
            a(0, e, "width", function () {
                return -1 === this._width ? J.clientWidth : this._width;
            }), a(0, e, "height", function () {
                return -1 === this._height ? J.clientHeight : this._height;
            }), a(1, t, "fullScreen", function () {
                return new t(-1, -1);
            });
        }(), function () {
            function t() {
                this.flags = 0, this.maxSubSteps = 1, this.fixedTimeStep = 1 / 60;
            }
            return r(t, "laya.d3.physics.PhysicsSettings"), t;
        }()), st = function () {
            function t(t, e) {
                this.normal = null, this.distance = NaN, void 0 === e && (e = 0), this.normal = t,
                    this.distance = e;
            }
            return r(t, "laya.d3.math.Plane"), t.prototype.normalize = function () {
                var t = this.normal.x, e = this.normal.y, i = this.normal.z, n = 1 / Math.sqrt(t * t + e * e + i * i);
                this.normal.x = t * n, this.normal.y = e * n, this.normal.z = i * n, this.distance *= n;
            }, t.createPlaneBy3P = function (e, i, n) {
                var r = i.x - e.x, a = i.y - e.y, s = i.z - e.z, o = n.x - e.x, l = n.y - e.y, h = n.z - e.z, u = a * h - s * l, c = s * o - r * h, d = r * l - a * o, _ = 1 / Math.sqrt(u * u + c * c + d * d), f = u * _, p = c * _, m = d * _;
                t._TEMPVec3.x = f, t._TEMPVec3.y = p, t._TEMPVec3.z = m;
                var g = -(f * e.x + p * e.y + m * e.z);
                return new t(t._TEMPVec3, g);
            }, t.PlaneIntersectionType_Back = 0, t.PlaneIntersectionType_Front = 1, t.PlaneIntersectionType_Intersecting = 2,
                n(t, ["_TEMPVec3", function () {
                    return this._TEMPVec3 = new gt();
                }]), t;
        }(), ot = function () {
            function t() {
                this.ambientColor = null, this.diffuseColor = null, this.specularColor = null;
            }
            return r(t, "laya.d3.terrain.unit.MaterialInfo"), t;
        }(), lt = function () {
            function t(t, e) {
                this._mode = 0, this._maxColorRGBKeysCount = 0, this._maxColorAlphaKeysCount = 0,
                    this._colorRGBKeysCount = 0, this._colorAlphaKeysCount = 0, this._alphaElements = null,
                    this._rgbElements = null, this._maxColorRGBKeysCount = t, this._maxColorAlphaKeysCount = e,
                    this._rgbElements = new Float32Array(4 * t), this._alphaElements = new Float32Array(2 * e);
            }
            r(t, "laya.d3.core.Gradient");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.addColorRGB = function (t, e) {
                if (this._colorRGBKeysCount < this._maxColorRGBKeysCount) {
                    var i = 4 * this._colorRGBKeysCount;
                    this._rgbElements[i] = t, this._rgbElements[i + 1] = e.r, this._rgbElements[i + 2] = e.g,
                        this._rgbElements[i + 3] = e.b, this._colorRGBKeysCount++;
                } else console.warn("Gradient:warning:data count must lessEqual than " + this._maxColorRGBKeysCount);
            }, e.addColorAlpha = function (t, e) {
                if (this._colorAlphaKeysCount < this._maxColorAlphaKeysCount) {
                    var i = 2 * this._colorAlphaKeysCount;
                    this._alphaElements[i] = t, this._alphaElements[i + 1] = e, this._colorAlphaKeysCount++;
                } else console.warn("Gradient:warning:data count must lessEqual than " + this._maxColorAlphaKeysCount);
            }, e.updateColorRGB = function (t, e, i) {
                if (t < this._colorRGBKeysCount) {
                    var n = 4 * t;
                    this._rgbElements[n] = e, this._rgbElements[n + 1] = i.r, this._rgbElements[n + 2] = i.g,
                        this._rgbElements[n + 3] = i.b;
                } else console.warn("Gradient:warning:index must lessEqual than colorRGBKeysCount:" + this._colorRGBKeysCount);
            }, e.updateColorAlpha = function (t, e, i) {
                if (t < this._colorAlphaKeysCount) {
                    var n = 2 * t;
                    this._alphaElements[n] = e, this._alphaElements[n + 1] = i;
                } else console.warn("Gradient:warning:index must lessEqual than colorAlphaKeysCount:" + this._colorAlphaKeysCount);
            }, e.cloneTo = function (t) {
                var e = t, i = 0, n = 0;
                e._colorAlphaKeysCount = this._colorAlphaKeysCount;
                var r = e._alphaElements;
                for (r.length = this._alphaElements.length, i = 0, n = this._alphaElements.length; i < n; i++) r[i] = this._alphaElements[i];
                e._colorRGBKeysCount = this._colorRGBKeysCount;
                var a = e._rgbElements;
                for (a.length = this._rgbElements.length, i = 0, n = this._rgbElements.length; i < n; i++) a[i] = this._rgbElements[i];
            }, e.clone = function () {
                var e = new t(this._maxColorRGBKeysCount, this._maxColorAlphaKeysCount);
                return this.cloneTo(e), e;
            }, a(0, e, "colorRGBKeysCount", function () {
                return this._colorRGBKeysCount / 4;
            }), a(0, e, "mode", function () {
                return this._mode;
            }, function (t) {
                this._mode = t;
            }), a(0, e, "colorAlphaKeysCount", function () {
                return this._colorAlphaKeysCount / 2;
            }), a(0, e, "maxColorRGBKeysCount", function () {
                return this._maxColorRGBKeysCount;
            }), a(0, e, "maxColorAlphaKeysCount", function () {
                return this._maxColorAlphaKeysCount;
            }), t;
        }(), ht = function () {
            function t(t, e, i, n, r) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1),
                    this.x = t, this.y = e, this.z = i, this.w = n;
            }
            r(t, "laya.d3.math.Quaternion");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.scaling = function (t, e) {
                e.x = this.x * t, e.y = this.y * t, e.z = this.z * t, e.w = this.w * t;
            }, e.normalize = function (t) {
                var e = this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
                e > 0 && (e = 1 / Math.sqrt(e), t.x = this.x * e, t.y = this.y * e, t.z = this.z * e,
                    t.w = this.w * e);
            }, e.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);
            }, e.rotateX = function (t, e) {
                t *= .5;
                var i = Math.sin(t), n = Math.cos(t);
                e.x = this.x * n + this.w * i, e.y = this.y * n + this.z * i, e.z = this.z * n - this.y * i,
                    e.w = this.w * n - this.x * i;
            }, e.rotateY = function (t, e) {
                t *= .5;
                var i = Math.sin(t), n = Math.cos(t);
                e.x = this.x * n - this.z * i, e.y = this.y * n + this.w * i, e.z = this.z * n + this.x * i,
                    e.w = this.w * n - this.y * i;
            }, e.rotateZ = function (t, e) {
                t *= .5;
                var i = Math.sin(t), n = Math.cos(t);
                e.x = this.x * n + this.y * i, e.y = this.y * n - this.x * i, e.z = this.z * n + this.w * i,
                    e.w = this.w * n - this.z * i;
            }, e.getYawPitchRoll = function (e) {
                gt.transformQuat(gt._ForwardRH, this, t.TEMPVector31), gt.transformQuat(gt._Up, this, t.TEMPVector32);
                var i = t.TEMPVector32;
                t.angleTo(gt._ZERO, t.TEMPVector31, t.TEMPVector33);
                var n = t.TEMPVector33;
                n.x == Math.PI / 2 ? (n.y = t.arcTanAngle(i.z, i.x), n.z = 0) : n.x == -Math.PI / 2 ? (n.y = t.arcTanAngle(-i.z, -i.x),
                    n.z = 0) : (ze.createRotationY(-n.y, t.TEMPMatrix0), ze.createRotationX(-n.x, t.TEMPMatrix1),
                        gt.transformCoordinate(t.TEMPVector32, t.TEMPMatrix0, t.TEMPVector32), gt.transformCoordinate(t.TEMPVector32, t.TEMPMatrix1, t.TEMPVector32),
                        n.z = t.arcTanAngle(i.y, -i.x)), n.y <= -Math.PI && (n.y = Math.PI), n.z <= -Math.PI && (n.z = Math.PI),
                    n.y >= Math.PI && n.z >= Math.PI && (n.y = 0, n.z = 0, n.x = Math.PI - n.x);
                var r = e;
                r.x = n.y, r.y = n.x, r.z = n.z;
            }, e.invert = function (t) {
                var e = this.x, i = this.y, n = this.z, r = this.w, a = e * e + i * i + n * n + r * r, s = a ? 1 / a : 0;
                t.x = -e * s, t.y = -i * s, t.z = -n * s, t.w = r * s;
            }, e.identity = function () {
                this.x = 0, this.y = 0, this.z = 0, this.w = 1;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2],
                    this.w = t[e + 3];
            }, e.cloneTo = function (t) {
                this !== t && (t.x = this.x, t.y = this.y, t.z = this.z, t.w = this.w);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.equals = function (t) {
                return nt.nearEqual(this.x, t.x) && nt.nearEqual(this.y, t.y) && nt.nearEqual(this.z, t.z) && nt.nearEqual(this.w, t.w);
            }, e.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z,
                    this.elements[3] = this.w) : this.elements = new Float32Array([this.x, this.y, this.z, this.w]),
                    yt.rewriteNumProperty(this, "x", 0), yt.rewriteNumProperty(this, "y", 1), yt.rewriteNumProperty(this, "z", 2),
                    yt.rewriteNumProperty(this, "w", 3);
            }, t.createFromYawPitchRoll = function (t, e, i, n) {
                var r = .5 * i, a = .5 * e, s = .5 * t, o = Math.sin(r), l = Math.cos(r), h = Math.sin(a), u = Math.cos(a), c = Math.sin(s), d = Math.cos(s);
                n.x = d * h * l + c * u * o, n.y = c * u * l - d * h * o, n.z = d * u * o - c * h * l,
                    n.w = d * u * l + c * h * o;
            }, t.multiply = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = t.w, o = e.x, l = e.y, h = e.z, u = e.w, c = r * h - a * l, d = a * o - n * h, _ = n * l - r * o, f = n * o + r * l + a * h;
                i.x = n * u + o * s + c, i.y = r * u + l * s + d, i.z = a * u + h * s + _, i.w = s * u - f;
            }, t.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : t > 0 ? Math.atan(e / t) : t < 0 ? e > 0 ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0;
            }, t.angleTo = function (e, i, n) {
                gt.subtract(i, e, t.TEMPVector30), gt.normalize(t.TEMPVector30, t.TEMPVector30),
                    n.x = Math.asin(t.TEMPVector30.y), n.y = t.arcTanAngle(-t.TEMPVector30.z, -t.TEMPVector30.x);
            }, t.createFromAxisAngle = function (t, e, i) {
                e *= .5;
                var n = Math.sin(e);
                i.x = n * t.x, i.y = n * t.y, i.z = n * t.z, i.w = Math.cos(e);
            }, t.createFromMatrix4x4 = function (t, e) {
                var i, n, r = t.elements, a = r[0] + r[5] + r[10];
                a > 0 ? (i = Math.sqrt(a + 1), e.w = .5 * i, i = .5 / i, e.x = (r[6] - r[9]) * i,
                    e.y = (r[8] - r[2]) * i, e.z = (r[1] - r[4]) * i) : r[0] >= r[5] && r[0] >= r[10] ? (n = .5 / (i = Math.sqrt(1 + r[0] - r[5] - r[10])),
                        e.x = .5 * i, e.y = (r[1] + r[4]) * n, e.z = (r[2] + r[8]) * n, e.w = (r[6] - r[9]) * n) : r[5] > r[10] ? (n = .5 / (i = Math.sqrt(1 + r[5] - r[0] - r[10])),
                            e.x = (r[4] + r[1]) * n, e.y = .5 * i, e.z = (r[9] + r[6]) * n, e.w = (r[8] - r[2]) * n) : (n = .5 / (i = Math.sqrt(1 + r[10] - r[0] - r[5])),
                                e.x = (r[8] + r[2]) * n, e.y = (r[9] + r[6]) * n, e.z = .5 * i, e.w = (r[1] - r[4]) * n);
            }, t.slerp = function (t, e, i, n) {
                var r, a, s, o, l, h = t.x, u = t.y, c = t.z, d = t.w, _ = e.x, f = e.y, p = e.z, m = e.w;
                return (a = h * _ + u * f + c * p + d * m) < 0 && (a = -a, _ = -_, f = -f, p = -p,
                    m = -m), 1 - a > 1e-6 ? (r = Math.acos(a), s = Math.sin(r), o = Math.sin((1 - i) * r) / s,
                        l = Math.sin(i * r) / s) : (o = 1 - i, l = i), n.x = o * h + l * _, n.y = o * u + l * f,
                    n.z = o * c + l * p, n.w = o * d + l * m, n;
            }, t.lerp = function (e, i, n, r) {
                var a = 1 - n;
                t.dot(e, i) >= 0 ? (r.x = a * e.x + n * i.x, r.y = a * e.y + n * i.y, r.z = a * e.z + n * i.z,
                    r.w = a * e.w + n * i.w) : (r.x = a * e.x - n * i.x, r.y = a * e.y - n * i.y, r.z = a * e.z - n * i.z,
                        r.w = a * e.w - n * i.w), r.normalize(r);
            }, t.add = function (t, e, i) {
                i.x = t.x + e.x, i.y = t.y + e.y, i.z = t.z + e.z, i.w = t.w + e.w;
            }, t.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w;
            }, t.rotationLookAt = function (e, i, n) {
                t.lookAt(gt._ZERO, e, i, n);
            }, t.lookAt = function (e, i, n, r) {
                ke.lookAt(e, i, n, t._tempMatrix3x3), t.rotationMatrix(t._tempMatrix3x3, r);
            }, t.invert = function (t, e) {
                var i = t.lengthSquared();
                nt.isZero(i) || (i = 1 / i, e.x = -t.x * i, e.y = -t.y * i, e.z = -t.z * i, e.w = t.w * i);
            }, t.rotationMatrix = function (t, e) {
                var i = t.elements, n = i[0], r = i[1], a = i[2], s = i[3], o = i[4], l = i[5], h = i[6], u = i[7], c = i[8], d = NaN, _ = NaN, f = n + o + c;
                f > 0 ? (d = Math.sqrt(f + 1), e.w = .5 * d, d = .5 / d, e.x = (l - u) * d, e.y = (h - a) * d,
                    e.z = (r - s) * d) : n >= o && n >= c ? (_ = .5 / (d = Math.sqrt(1 + n - o - c)),
                        e.x = .5 * d, e.y = (r + s) * _, e.z = (a + h) * _, e.w = (l - u) * _) : o > c ? (_ = .5 / (d = Math.sqrt(1 + o - n - c)),
                            e.x = (s + r) * _, e.y = .5 * d, e.z = (u + l) * _, e.w = (h - a) * _) : (_ = .5 / (d = Math.sqrt(1 + c - n - o)),
                                e.x = (h + a) * _, e.y = (u + l) * _, e.z = .5 * d, e.w = (r - s) * _);
            }, t.DEFAULT = new t(), n(t, ["TEMPVector30", function () {
                return this.TEMPVector30 = new gt();
            }, "TEMPVector31", function () {
                return this.TEMPVector31 = new gt();
            }, "TEMPVector32", function () {
                return this.TEMPVector32 = new gt();
            }, "TEMPVector33", function () {
                return this.TEMPVector33 = new gt();
            }, "TEMPMatrix0", function () {
                return this.TEMPMatrix0 = new ze();
            }, "TEMPMatrix1", function () {
                return this.TEMPMatrix1 = new ze();
            }, "_tempMatrix3x3", function () {
                return this._tempMatrix3x3 = new ke();
            }, "NAN", function () {
                return this.NAN = new t(NaN, NaN, NaN, NaN);
            }]), t;
        }(), ut = function () {
            function t(t) {
                this._ownerResource = null, this._data = null, this._int32Data = null, this._float32Data = null,
                    this._nativeArray = null, this._frameCount = 0, this._runtimeCopyValues = [], this._ownerResource = t,
                    this._initData();
            }
            r(t, "laya.d3.shader.ShaderData");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e._initData = function () {
                this._data = new Object();
            }, e.getData = function () {
                return this._data;
            }, e.getBool = function (t) {
                return this._data[t];
            }, e.setBool = function (t, e) {
                this._data[t] = e;
            }, e.getInt = function (t) {
                return this._data[t];
            }, e.setInt = function (t, e) {
                this._data[t] = e;
            }, e.getNumber = function (t) {
                return this._data[t];
            }, e.setNumber = function (t, e) {
                this._data[t] = e;
            }, e.getVector2 = function (t) {
                return this._data[t];
            }, e.setVector2 = function (t, e) {
                this._data[t] = e;
            }, e.getVector3 = function (t) {
                return this._data[t];
            }, e.setVector3 = function (t, e) {
                this._data[t] = e;
            }, e.getVector = function (t) {
                return this._data[t];
            }, e.setVector = function (t, e) {
                this._data[t] = e;
            }, e.getQuaternion = function (t) {
                return this._data[t];
            }, e.setQuaternion = function (t, e) {
                this._data[t] = e;
            }, e.getMatrix4x4 = function (t) {
                return this._data[t];
            }, e.setMatrix4x4 = function (t, e) {
                this._data[t] = e;
            }, e.getBuffer = function (t) {
                return this._data[t];
            }, e.setBuffer = function (t, e) {
                this._data[t] = e;
            }, e.setTexture = function (t, e) {
                var i = this._data[t];
                this._data[t] = e, this._ownerResource && this._ownerResource.referenceCount > 0 && (i && i._removeReference(),
                    e && e._addReference());
            }, e.getTexture = function (t) {
                return this._data[t];
            }, e.setAttribute = function (t, e) {
                this._data[t] = e;
            }, e.getAttribute = function (t) {
                return this._data[t];
            }, e.getLength = function () {
                return this._data.length;
            }, e.setLength = function (t) {
                this._data.length = t;
            }, e.cloneTo = function (t) {
                var e = t._data;
                for (var i in this._data) {
                    var n = this._data[i];
                    if (null != n) if ("number" == typeof n) e[i] = n; else if ("number" == typeof n && Math.floor(n) == n) e[i] = n; else if ("boolean" == typeof n) e[i] = n; else if (n instanceof laya.d3.math.Vector2) {
                        var r = e[i] || (e[i] = new yt());
                        n.cloneTo(r), e[i] = r;
                    } else if (n instanceof laya.d3.math.Vector3) {
                        var a = e[i] || (e[i] = new gt());
                        n.cloneTo(a), e[i] = a;
                    } else if (n instanceof laya.d3.math.Vector4) {
                        var s = e[i] || (e[i] = new pt());
                        n.cloneTo(s), e[i] = s;
                    } else if (n instanceof laya.d3.math.Matrix4x4) {
                        var o = e[i] || (e[i] = new ze());
                        n.cloneTo(o), e[i] = o;
                    } else n instanceof laya.resource.BaseTexture && (e[i] = n);
                }
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.cloneToForNative = function (t) {
                var e = t;
                this._int32Data.length - e._int32Data.length > 0 && e.needRenewArrayBufferForNative(this._int32Data.length),
                    e._int32Data.set(this._int32Data, 0);
                var i = e._nativeArray, n = this._nativeArray.length;
                i.length = n;
                for (var r = 0; r < n; r++) {
                    var a = this._nativeArray[r];
                    if (a) if ("number" == typeof a) i[r] = a, e.setNumber(r, a); else if ("number" == typeof a && Math.floor(a) == a) i[r] = a,
                        e.setInt(r, a); else if ("boolean" == typeof a) i[r] = a, e.setBool(r, a); else if (a instanceof laya.d3.math.Vector2) {
                            var s = i[r] || (i[r] = new yt());
                            a.cloneTo(s), i[r] = s, e.setVector2(r, s);
                        } else if (a instanceof laya.d3.math.Vector3) {
                            var o = i[r] || (i[r] = new gt());
                            a.cloneTo(o), i[r] = o, e.setVector3(r, o);
                        } else if (a instanceof laya.d3.math.Vector4) {
                            var l = i[r] || (i[r] = new pt());
                            a.cloneTo(l), i[r] = l, e.setVector(r, l);
                        } else if (a instanceof laya.d3.math.Matrix4x4) {
                            var h = i[r] || (i[r] = new ze());
                            a.cloneTo(h), i[r] = h, e.setMatrix4x4(r, h);
                        } else a instanceof laya.resource.BaseTexture && (i[r] = a, e.setTexture(r, a));
                }
            }, e._initDataForNative = function () {
                this._frameCount = -1, this._runtimeCopyValues.length = 0, this._nativeArray = [],
                    this._data = new ArrayBuffer(32), this._int32Data = new Int32Array(this._data),
                    this._float32Data = new Float32Array(this._data), v.createArrayBufferRef(this._data, 0, !0);
            }, e.needRenewArrayBufferForNative = function (t) {
                if (t >= this._int32Data.length) {
                    var e = 4 * (t + 1), i = this._int32Data, n = this._data.conchRef, r = this._data._ptrID;
                    this._data = new ArrayBuffer(e), this._int32Data = new Int32Array(this._data), this._float32Data = new Float32Array(this._data),
                        this._data.conchRef = n, this._data._ptrID = r, i && this._int32Data.set(i, 0),
                        conch.updateArrayBufferRef(this._data._ptrID, n.isSyncToRender(), this._data);
                }
            }, e.getDataForNative = function () {
                return this._nativeArray;
            }, e.getIntForNative = function (t) {
                return this._int32Data[t];
            }, e.setIntForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._int32Data[t] = e, this._nativeArray[t] = e;
            }, e.getBoolForNative = function (t) {
                return 1 == this._int32Data[t];
            }, e.setBoolForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._int32Data[t] = e, this._nativeArray[t] = e;
            }, e.getNumberForNative = function (t) {
                return this._float32Data[t];
            }, e.setNumberForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._float32Data[t] = e, this._nativeArray[t] = e;
            }, e.getMatrix4x4ForNative = function (t) {
                return this._nativeArray[t];
            }, e.setMatrix4x4ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e;
                var i = this.setReferenceForNative(e.elements);
                this._int32Data[t] = i;
            }, e.getVectorForNative = function (t) {
                return this._nativeArray[t];
            }, e.setVectorForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e, e.elements || e.forNativeElement();
                var i = this.setReferenceForNative(e.elements);
                this._int32Data[t] = i;
            }, e.getVector2ForNative = function (t) {
                return this._nativeArray[t];
            }, e.setVector2ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e, e.elements || e.forNativeElement();
                var i = this.setReferenceForNative(e.elements);
                this._int32Data[t] = i;
            }, e.getVector3ForNative = function (t) {
                return this._nativeArray[t];
            }, e.setVector3ForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e, e.elements || e.forNativeElement();
                var i = this.setReferenceForNative(e.elements);
                this._int32Data[t] = i;
            }, e.getQuaternionForNative = function (t) {
                return this._nativeArray[t];
            }, e.setQuaternionForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e, e.elements || e.forNativeElement();
                var i = this.setReferenceForNative(e.elements);
                this._int32Data[t] = i;
            }, e.getBufferForNative = function (t) {
                return this._nativeArray[t];
            }, e.setBufferForNative = function (t, e) {
                this.needRenewArrayBufferForNative(t), this._nativeArray[t] = e;
                var i = this.setReferenceForNative(e);
                this._int32Data[t] = i;
            }, e.getAttributeForNative = function (t) {
                return this._nativeArray[t];
            }, e.setAttributeForNative = function (t, e) {
                this._nativeArray[t] = e, e._ptrID || v.createArrayBufferRef(e, 0, !0), v.syncBufferToRenderThread(e),
                    this._int32Data[t] = e._ptrID;
            }, e.getTextureForNative = function (t) {
                return this._nativeArray[t];
            }, e.setTextureForNative = function (t, e) {
                if (e) {
                    this.needRenewArrayBufferForNative(t);
                    var i = this._nativeArray[t];
                    this._nativeArray[t] = e, this._int32Data[t] = e._glTexture.id, this._ownerResource && this._ownerResource.referenceCount > 0 && (i && i._removeReference(),
                        e && e._addReference());
                }
            }, e.setReferenceForNative = function (e) {
                this.clearRuntimeCopyArray();
                var i = 0, n = 0;
                return t._SET_RUNTIME_VALUE_MODE_REFERENCE_ ? (v.createArrayBufferRefs(e, 0, !0, 0),
                    i = 0, n = e.getPtrID(i)) : (v.createArrayBufferRefs(e, 0, !0, 1), i = e.getRefNum() - 1,
                        n = e.getPtrID(i), this._runtimeCopyValues.push({
                            obj: e,
                            refID: i,
                            ptrID: n
                        })), v.syncBufferToRenderThread(e, i), n;
            }, e.clearRuntimeCopyArray = function () {
                var t = v.getFrameCount();
                if (this._frameCount != t) {
                    this._frameCount = t;
                    for (var e = 0, i = this._runtimeCopyValues.length; e < i; e++) {
                        this._runtimeCopyValues[e].obj.clearRefNum();
                    }
                    this._runtimeCopyValues.length = 0;
                }
            }, t.setRuntimeValueMode = function (e) {
                t._SET_RUNTIME_VALUE_MODE_REFERENCE_ = e;
            }, t._SET_RUNTIME_VALUE_MODE_REFERENCE_ = !0, t;
        }(), ct = function () {
            function t() {
                this._boundingSphere = null, this._boundingBox = null, this._sizeOfY = null, this._currentLODLevel = 0,
                    this._lastDistanceToEye = NaN, this._originalBoundingSphere = null, this._originalBoundingBox = null,
                    this._originalBoundingBoxCorners = null, this._bUseStrip = !1, this._gridSize = NaN,
                    this._beginGridX = 0, this._beginGridZ = 0, this._LODError = null, t.__init__(),
                    this._currentLODLevel = 0;
            }
            r(t, "laya.d3.terrain.TerrainLeaf");
            var e = t.prototype;
            return e.calcVertextNorml = function (e, i, n, r, a, s) {
                var o = 0, l = 0;
                l = -1 * t.getHeightFromTerrainHeightData(e - 1, i - 1, n, r, a), l += -1 * t.getHeightFromTerrainHeightData(e - 1, i, n, r, a),
                    l += -1 * t.getHeightFromTerrainHeightData(e - 1, i + 1, n, r, a), l += 1 * t.getHeightFromTerrainHeightData(e + 1, i - 1, n, r, a),
                    l += 1 * t.getHeightFromTerrainHeightData(e + 1, i, n, r, a), l += 1 * t.getHeightFromTerrainHeightData(e + 1, i + 1, n, r, a),
                    o = -1 * t.getHeightFromTerrainHeightData(e - 1, i - 1, n, r, a), o += -1 * t.getHeightFromTerrainHeightData(e, i - 1, n, r, a),
                    o += -1 * t.getHeightFromTerrainHeightData(e + 1, i - 1, n, r, a), o += 1 * t.getHeightFromTerrainHeightData(e - 1, i + 1, n, r, a),
                    o += 1 * t.getHeightFromTerrainHeightData(e, i + 1, n, r, a), o += 1 * t.getHeightFromTerrainHeightData(e + 1, i + 1, n, r, a),
                    s.x = -l, s.y = 6, s.z = -o, gt.normalize(s, s);
            }, e.calcVertextNormlUV = function (t, e, i, n, r) {
                r.x = t / i, r.y = e / n, r.z = e / n;
            }, e.calcVertextBuffer = function (e, i, n, r, a, s, o, l, h, u, c, d) {
                if (1 == d && !t.__ADAPT_MATRIX__) {
                    t.__ADAPT_MATRIX__ = new ze();
                    var _ = new ze();
                    ze.createRotationY(Math.PI, t.__ADAPT_MATRIX__), ze.createTranslate(new gt(0, 0, (c - 1) * a), _),
                        ze.multiply(_, t.__ADAPT_MATRIX__, t.__ADAPT_MATRIX__), t.__ADAPT_MATRIX_INV__ = new ze(),
                        t.__ADAPT_MATRIX__.invert(t.__ADAPT_MATRIX_INV__);
                }
                this._gridSize = a, this._beginGridX = e * t.CHUNK_GRID_NUM + n, this._beginGridZ = i * t.CHUNK_GRID_NUM + r;
                for (var f = o * l, p = 2147483647, m = -2147483648, g = new gt(), y = 0, v = t.LEAF_GRID_NUM + 1; y < v; y++) for (var S = 0, T = t.LEAF_GRID_NUM + 1; S < T; S++) t.__VECTOR3__.x = (this._beginGridX + S) * this._gridSize,
                    t.__VECTOR3__.z = (this._beginGridZ + y) * this._gridSize, t.__VECTOR3__.y = h[(this._beginGridZ + y) * u + (this._beginGridX + S)],
                    p = t.__VECTOR3__.y < p ? t.__VECTOR3__.y : p, m = t.__VECTOR3__.y > m ? t.__VECTOR3__.y : m,
                    t.__ADAPT_MATRIX__ && gt.transformV3ToV3(t.__VECTOR3__, t.__ADAPT_MATRIX__, t.__VECTOR3__),
                    s[f] = t.__VECTOR3__.x, s[++f] = t.__VECTOR3__.y, s[++f] = t.__VECTOR3__.z, f++,
                    this.calcVertextNormlUV(this._beginGridX + S, this._beginGridZ + y, u, c, g), s[f] = g.x,
                    s[++f] = g.y, s[++f] = g.z, s[++f] = (n + S) / t.CHUNK_GRID_NUM, s[++f] = (r + y) / t.CHUNK_GRID_NUM,
                    s[++f] = this._beginGridX + S, s[++f] = this._beginGridZ + y, f++;
                this._sizeOfY = new yt(p - 1, m + 1), this.calcLODErrors(h, u, c), this.calcOriginalBoudingBoxAndSphere();
            }, e.calcSkirtVertextBuffer = function (e, i, n, r, a, s, o, l, h, u, c) {
                this._gridSize = a, this._beginGridX = e * t.CHUNK_GRID_NUM + n, this._beginGridZ = i * t.CHUNK_GRID_NUM + r;
                var d = o * l, _ = 0, f = 0, p = t.LEAF_GRID_NUM + 1, m = new gt(), g = 0, y = 0;
                for (_ = 0; _ < 2; _++) for (f = 0; f < p; f++) t.__VECTOR3__.x = (this._beginGridX + f) * this._gridSize,
                    t.__VECTOR3__.y = 1 == _ ? h[this._beginGridZ * u + (this._beginGridX + f)] : -this._gridSize,
                    t.__VECTOR3__.z = (this._beginGridZ + 0) * this._gridSize, t.__ADAPT_MATRIX__ && gt.transformV3ToV3(t.__VECTOR3__, t.__ADAPT_MATRIX__, t.__VECTOR3__),
                    s[d] = t.__VECTOR3__.x, s[++d] = t.__VECTOR3__.y, s[++d] = t.__VECTOR3__.z, d++,
                    g = 0 == _ ? this._beginGridZ - 1 : this._beginGridZ, this.calcVertextNormlUV(this._beginGridX + f, g, u, c, m),
                    s[d] = m.x, s[++d] = m.y, s[++d] = m.z, s[++d] = (n + f) / t.CHUNK_GRID_NUM, s[++d] = (r + 0) / t.CHUNK_GRID_NUM,
                    s[++d] = this._beginGridX + f, s[++d] = g, d++;
                for (_ = 0; _ < 2; _++) for (f = 0; f < p; f++) t.__VECTOR3__.x = (this._beginGridX + f) * this._gridSize,
                    t.__VECTOR3__.y = 0 == _ ? h[(this._beginGridZ + t.LEAF_GRID_NUM) * u + (this._beginGridX + f)] : -this._gridSize,
                    t.__VECTOR3__.z = (this._beginGridZ + t.LEAF_GRID_NUM) * this._gridSize, t.__ADAPT_MATRIX__ && gt.transformV3ToV3(t.__VECTOR3__, t.__ADAPT_MATRIX__, t.__VECTOR3__),
                    s[d] = t.__VECTOR3__.x, s[++d] = t.__VECTOR3__.y, s[++d] = t.__VECTOR3__.z, d++,
                    g = 0 == _ ? this._beginGridZ + t.LEAF_GRID_NUM : this._beginGridZ + t.LEAF_GRID_NUM + 1,
                    this.calcVertextNormlUV(this._beginGridX + f, g, u, c, m), s[d] = m.x, s[++d] = m.y,
                    s[++d] = m.z, s[++d] = (n + f) / t.CHUNK_GRID_NUM, s[++d] = (r + t.LEAF_GRID_NUM) / t.CHUNK_GRID_NUM,
                    s[++d] = this._beginGridX + f, s[++d] = g, d++;
                for (_ = 0; _ < 2; _++) for (f = 0; f < p; f++) t.__VECTOR3__.x = (this._beginGridX + 0) * this._gridSize,
                    t.__VECTOR3__.y = 0 == _ ? h[(this._beginGridZ + f) * u + (this._beginGridX + 0)] : -this._gridSize,
                    t.__VECTOR3__.z = (this._beginGridZ + f) * this._gridSize, t.__ADAPT_MATRIX__ && gt.transformV3ToV3(t.__VECTOR3__, t.__ADAPT_MATRIX__, t.__VECTOR3__),
                    s[d] = t.__VECTOR3__.x, s[++d] = t.__VECTOR3__.y, s[++d] = t.__VECTOR3__.z, d++,
                    y = 0 == _ ? this._beginGridX : this._beginGridX - 1, this.calcVertextNormlUV(y, this._beginGridZ + f, u, c, m),
                    s[d] = m.x, s[++d] = m.y, s[++d] = m.z, s[++d] = (n + 0) / t.CHUNK_GRID_NUM, s[++d] = (r + f) / t.CHUNK_GRID_NUM,
                    s[++d] = y, s[++d] = this._beginGridZ + f, d++;
                for (_ = 0; _ < 2; _++) for (f = 0; f < p; f++) t.__VECTOR3__.x = (this._beginGridX + t.LEAF_GRID_NUM) * this._gridSize,
                    t.__VECTOR3__.y = 1 == _ ? h[(this._beginGridZ + f) * u + (this._beginGridX + t.LEAF_GRID_NUM)] : -this._gridSize,
                    t.__VECTOR3__.z = (this._beginGridZ + f) * this._gridSize, t.__ADAPT_MATRIX__ && gt.transformV3ToV3(t.__VECTOR3__, t.__ADAPT_MATRIX__, t.__VECTOR3__),
                    s[d] = t.__VECTOR3__.x, s[++d] = t.__VECTOR3__.y, s[++d] = t.__VECTOR3__.z, d++,
                    y = 0 == _ ? this._beginGridX + t.LEAF_GRID_NUM + 1 : this._beginGridX + t.LEAF_GRID_NUM,
                    this.calcVertextNormlUV(y, this._beginGridZ + f, u, c, m), s[d] = m.x, s[++d] = m.y,
                    s[++d] = m.z, s[++d] = (n + t.LEAF_GRID_NUM) / t.CHUNK_GRID_NUM, s[++d] = (r + f) / t.CHUNK_GRID_NUM,
                    s[++d] = y, s[++d] = this._beginGridZ + f, d++;
            }, e.calcOriginalBoudingBoxAndSphere = function () {
                var e = new gt(this._beginGridX * this._gridSize, this._sizeOfY.x, this._beginGridZ * this._gridSize), i = new gt((this._beginGridX + t.LEAF_GRID_NUM) * this._gridSize, this._sizeOfY.y, (this._beginGridZ + t.LEAF_GRID_NUM) * this._gridSize);
                t.__ADAPT_MATRIX__ && (gt.transformV3ToV3(e, t.__ADAPT_MATRIX__, e), gt.transformV3ToV3(i, t.__ADAPT_MATRIX__, i)),
                    this._originalBoundingBox = new Ue(e, i);
                var n = new gt();
                gt.subtract(i, e, n), gt.scale(n, .5, n);
                var r = new gt();
                gt.add(e, n, r), this._originalBoundingSphere = new wt(r, gt.scalarLength(n)), this._originalBoundingBoxCorners = s(8, null),
                    this._originalBoundingBox.getCorners(this._originalBoundingBoxCorners), this._boundingBox = new Ue(new gt(-.5, -.5, -.5), new gt(.5, .5, .5)),
                    this._boundingSphere = new wt(new gt(0, 0, 0), 1);
            }, e.calcLeafBoudingBox = function (t) {
                for (var e = 0; e < 8; e++) gt.transformCoordinate(this._originalBoundingBoxCorners[e], t, We._tempBoundBoxCorners[e]);
                Ue.createfromPoints(We._tempBoundBoxCorners, this._boundingBox);
            }, e.calcLeafBoudingSphere = function (t, e) {
                gt.transformCoordinate(this._originalBoundingSphere.center, t, this._boundingSphere.center),
                    this._boundingSphere.radius = this._originalBoundingSphere.radius * e;
            }, e.calcLODErrors = function (e, i, n) {
                this._LODError = new Float32Array(t._maxLODLevel + 1);
                for (var r = 1, a = 0, s = t._maxLODLevel + 1; a < s; a++) {
                    for (var o = 0, l = 0, h = t.LEAF_GRID_NUM; l < h; l += r) for (var u = 0, c = t.LEAF_GRID_NUM; u < c; u += r) for (var d = e[(this._beginGridZ + l) * i + (this._beginGridX + u)], _ = e[(this._beginGridZ + l) * i + (this._beginGridX + u) + r], f = e[(this._beginGridZ + l + r) * i + (this._beginGridX + u)], p = e[(this._beginGridZ + l + r) * i + (this._beginGridX + u) + r], m = 0; m < r; m++) for (var g = m / r, y = 0; y < r; y++) {
                        var v = y / r, S = e[(this._beginGridZ + l + m) * i + (this._beginGridX + u) + y], T = v + g <= 1 ? d + (_ - d) * v + (f - d) * g : p + (f - p) * (1 - v) + (_ - p) * (1 - g), E = Math.abs(T - S);
                        o = Math.max(o, E);
                    }
                    r *= 2, this._LODError[a] = o;
                }
            }, e.determineLod = function (e, i, n, r) {
                var a = gt.distance(e, this._boundingSphere.center), s = t._maxLODLevel;
                if (!r) {
                    if (this._lastDistanceToEye == a) return this._currentLODLevel;
                    this._lastDistanceToEye > a && (s = this._currentLODLevel);
                }
                for (var o = s; o >= 1; o--) if (tn.LOD_DISTANCE_FACTOR * this._LODError[o] / a * i < n) {
                    this._currentLODLevel = o;
                    break;
                }
                return this._lastDistanceToEye = a, this._currentLODLevel;
            }, t.__init__ = function () {
                if (!t._bInit) {
                    var e = t.CHUNK_GRID_NUM / t.LEAF_GRID_NUM * (t.CHUNK_GRID_NUM / t.LEAF_GRID_NUM);
                    t._planeLODIndex = s(e);
                    var i = 0, n = 0, r = 0, a = 0, o = 0, l = 0, h = null, u = null;
                    for (i = 0; i < e; i++) t._planeLODIndex[i] = new Array(t._maxLODLevel + 1);
                    for (i = 0, a = t._maxLODLevel + 1; i < a; i++) t._planeLODIndex[0][i] = t.calcPlaneLODIndex(i);
                    for (i = 1; i < e; i++) for (l = i * t.LEAF_PLANE_VERTEXT_COUNT, n = 0, o = t._maxLODLevel + 1; n < o; n++) {
                        for (h = t._planeLODIndex[0][n], u = new Uint16Array(h.length), r = 0; r < h.length; r++) u[r] = h[r] + l;
                        t._planeLODIndex[i][n] = u;
                    }
                    for (t._skirtLODIndex = s(e), i = 0; i < e; i++) t._skirtLODIndex[i] = new Array(t._maxLODLevel + 1);
                    for (i = 0, a = t._maxLODLevel + 1; i < a; i++) t._skirtLODIndex[0][i] = t.calcSkirtLODIndex(i);
                    for (i = 1; i < e; i++) for (l = i * t.LEAF_SKIRT_VERTEXT_COUNT, n = 0, o = t._maxLODLevel + 1; n < o; n++) {
                        for (h = t._skirtLODIndex[0][n], u = new Uint16Array(h.length), r = 0; r < h.length; r++) u[r] = h[r] + l;
                        t._skirtLODIndex[i][n] = u;
                    }
                    t._bInit = !0;
                }
            }, t.getPlaneLODIndex = function (e, i) {
                return t._planeLODIndex[e][i];
            }, t.getSkirtLODIndex = function (e, i) {
                return t._skirtLODIndex[e][i];
            }, t.calcPlaneLODIndex = function (e) {
                e > t._maxLODLevel && (e = t._maxLODLevel);
                var i = t.LEAF_GRID_NUM + 1, n = 0, r = null, a = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / Math.pow(2, e);
                r = new Uint16Array(a * a * 6);
                for (var s = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / a, o = 0; o < t.LEAF_GRID_NUM; o += s) for (var l = 0; l < t.LEAF_GRID_NUM; l += s) r[n] = (o + s) * i + l,
                    r[++n] = o * i + l, r[++n] = o * i + l + s, r[++n] = o * i + l + s, r[++n] = (o + s) * i + l + s,
                    r[++n] = (o + s) * i + l, n++;
                return r;
            }, t.calcSkirtLODIndex = function (e) {
                e > t._maxLODLevel && (e = t._maxLODLevel);
                var i = t.CHUNK_GRID_NUM / t.LEAF_GRID_NUM * (t.CHUNK_GRID_NUM / t.LEAF_GRID_NUM) * t.LEAF_PLANE_VERTEXT_COUNT, n = t.LEAF_GRID_NUM + 1, r = 0, a = null, s = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / Math.pow(2, e);
                a = new Uint16Array(4 * s * 6);
                for (var o = laya.d3.terrain.TerrainLeaf.LEAF_GRID_NUM / s, l = 0; l < 4; l++) {
                    for (var h = 0; h < t.LEAF_GRID_NUM; h += o) a[r] = i + n + h, a[++r] = i + h, a[++r] = i + h + o,
                        a[++r] = i + h + o, a[++r] = i + n + h + o, a[++r] = i + n + h, r++;
                    i += 2 * n;
                }
                return a;
            }, t.getHeightFromTerrainHeightData = function (t, e, i, n, r) {
                return i[(e = (e = e < 0 ? 0 : e) >= r ? r - 1 : e) * n + (t = (t = t < 0 ? 0 : t) >= n ? n - 1 : t)];
            }, t.CHUNK_GRID_NUM = 64, t.LEAF_GRID_NUM = 32, t.__ADAPT_MATRIX__ = null, t.__ADAPT_MATRIX_INV__ = null,
                t._planeLODIndex = null, t._skirtLODIndex = null, t._bInit = !1, n(t, ["LEAF_PLANE_VERTEXT_COUNT", function () {
                    return this.LEAF_PLANE_VERTEXT_COUNT = (t.LEAF_GRID_NUM + 1) * (t.LEAF_GRID_NUM + 1);
                }, "LEAF_SKIRT_VERTEXT_COUNT", function () {
                    return this.LEAF_SKIRT_VERTEXT_COUNT = 2 * (t.LEAF_GRID_NUM + 1) * 4;
                }, "LEAF_VERTEXT_COUNT", function () {
                    return this.LEAF_VERTEXT_COUNT = t.LEAF_PLANE_VERTEXT_COUNT + t.LEAF_SKIRT_VERTEXT_COUNT;
                }, "LEAF_PLANE_MAX_INDEX_COUNT", function () {
                    return this.LEAF_PLANE_MAX_INDEX_COUNT = t.LEAF_GRID_NUM * t.LEAF_GRID_NUM * 6;
                }, "LEAF_SKIRT_MAX_INDEX_COUNT", function () {
                    return this.LEAF_SKIRT_MAX_INDEX_COUNT = 4 * t.LEAF_GRID_NUM * 6;
                }, "LEAF_MAX_INDEX_COUNT", function () {
                    return this.LEAF_MAX_INDEX_COUNT = t.LEAF_PLANE_MAX_INDEX_COUNT + t.LEAF_SKIRT_MAX_INDEX_COUNT;
                }, "__VECTOR3__", function () {
                    return this.__VECTOR3__ = new gt();
                }, "_maxLODLevel", function () {
                    return this._maxLODLevel = Math.log2(t.LEAF_GRID_NUM);
                }]), t;
        }(), dt = function () {
            function t() { }
            return r(t, "laya.d3.graphics.Vertex.VertexShuriKenParticle"), t.PARTICLE_CORNERTEXTURECOORDINATE0 = 0,
                t.PARTICLE_POSITION0 = 1, t.PARTICLE_COLOR0 = 2, t.PARTICLE_TEXTURECOORDINATE0 = 3,
                t.PARTICLE_SHAPEPOSITIONSTARTLIFETIME = 4, t.PARTICLE_DIRECTIONTIME = 5, t.PARTICLE_STARTCOLOR0 = 6,
                t.PARTICLE_ENDCOLOR0 = 7, t.PARTICLE_STARTSIZE = 8, t.PARTICLE_STARTROTATION = 9,
                t.PARTICLE_STARTSPEED = 10, t.PARTICLE_RANDOM0 = 11, t.PARTICLE_RANDOM1 = 12, t.PARTICLE_SIMULATIONWORLDPOSTION = 13,
                t.PARTICLE_SIMULATIONWORLDROTATION = 14, t;
        }(), _t = function () {
            function t(t) {
                this._size = null, this.enbale = !1, this._size = t;
            }
            r(t, "laya.d3.core.particleShuriKen.module.SizeOverLifetime");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                this._size.cloneTo(e._size), e.enbale = this.enbale;
            }, e.clone = function () {
                var t;
                switch (this._size.type) {
                    case 0:
                        t = this._size.separateAxes ? ye.createByGradientSeparate(this._size.gradientX.clone(), this._size.gradientY.clone(), this._size.gradientZ.clone()) : ye.createByGradient(this._size.gradient.clone());
                        break;

                    case 1:
                        t = this._size.separateAxes ? ye.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(), this._size.constantMaxSeparate.clone()) : ye.createByRandomTwoConstant(this._size.constantMin, this._size.constantMax);
                        break;

                    case 2:
                        t = this._size.separateAxes ? ye.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(), this._size.gradientYMin.clone(), this._size.gradientZMin.clone(), this._size.gradientXMax.clone(), this._size.gradientYMax.clone(), this._size.gradientZMax.clone()) : ye.createByRandomTwoGradient(this._size.gradientMin.clone(), this._size.gradientMax.clone());
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e;
            }, a(0, e, "size", function () {
                return this._size;
            }), t;
        }(), ft = function () {
            function t() {
                this.time = NaN;
            }
            r(t, "laya.d3.core.Keyframe");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                t.time = this.time;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t;
        }(), pt = function () {
            function t(t, e, i, n) {
                this.x = NaN, this.y = NaN, this.z = NaN, this.w = NaN, void 0 === t && (t = 0),
                    void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), this.x = t,
                    this.y = e, this.z = i, this.w = n;
            }
            r(t, "laya.d3.math.Vector4");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setValue = function (t, e, i, n) {
                this.x = t, this.y = e, this.z = i, this.w = n;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2],
                    this.w = t[e + 3];
            }, e.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y, e.z = this.z, e.w = this.w;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.length = function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);
            }, e.lengthSquared = function () {
                return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z,
                    this.elements[3] = this.w) : this.elements = new Float32Array([this.x, this.y, this.z, this.w]),
                    yt.rewriteNumProperty(this, "x", 0), yt.rewriteNumProperty(this, "y", 1), yt.rewriteNumProperty(this, "z", 2),
                    yt.rewriteNumProperty(this, "w", 3);
            }, t.lerp = function (t, e, i, n) {
                var r = t.x, a = t.y, s = t.z, o = t.w;
                n.x = r + i * (e.x - r), n.y = a + i * (e.y - a), n.z = s + i * (e.z - s), n.w = o + i * (e.w - o);
            }, t.transformByM4x4 = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = t.w, o = e.elements;
                i.x = n * o[0] + r * o[4] + a * o[8] + s * o[12], i.y = n * o[1] + r * o[5] + a * o[9] + s * o[13],
                    i.z = n * o[2] + r * o[6] + a * o[10] + s * o[14], i.w = n * o[3] + r * o[7] + a * o[11] + s * o[15];
            }, t.equals = function (t, e) {
                return nt.nearEqual(Math.abs(t.x), Math.abs(e.x)) && nt.nearEqual(Math.abs(t.y), Math.abs(e.y)) && nt.nearEqual(Math.abs(t.z), Math.abs(e.z)) && nt.nearEqual(Math.abs(t.w), Math.abs(e.w));
            }, t.normalize = function (t, e) {
                var i = t.length();
                i > 0 && (e.x = t.x * i, e.y = t.y * i, e.z = t.z * i, e.w = t.w * i);
            }, t.add = function (t, e, i) {
                i.x = t.x + e.x, i.y = t.y + e.y, i.z = t.z + e.z, i.w = t.w + e.w;
            }, t.subtract = function (t, e, i) {
                i.x = t.x - e.x, i.y = t.y - e.y, i.z = t.z - e.z, i.w = t.w - e.w;
            }, t.multiply = function (t, e, i) {
                i.x = t.x * e.x, i.y = t.y * e.y, i.z = t.z * e.z, i.w = t.w * e.w;
            }, t.scale = function (t, e, i) {
                i.x = t.x * e, i.y = t.y * e, i.z = t.z * e, i.w = t.w * e;
            }, t.Clamp = function (t, e, i, n) {
                var r = t.x, a = t.y, s = t.z, o = t.w, l = e.x, h = e.y, u = e.z, c = e.w, d = i.x, _ = i.y, f = i.z, p = i.w;
                r = (r = r > d ? d : r) < l ? l : r, a = (a = a > _ ? _ : a) < h ? h : a, s = (s = s > f ? f : s) < u ? u : s,
                    o = (o = o > p ? p : o) < c ? c : o, n.x = r, n.y = a, n.z = s, n.w = o;
            }, t.distanceSquared = function (t, e) {
                var i = t.x - e.x, n = t.y - e.y, r = t.z - e.z, a = t.w - e.w;
                return i * i + n * n + r * r + a * a;
            }, t.distance = function (t, e) {
                var i = t.x - e.x, n = t.y - e.y, r = t.z - e.z, a = t.w - e.w;
                return Math.sqrt(i * i + n * n + r * r + a * a);
            }, t.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w;
            }, t.min = function (t, e, i) {
                i.x = Math.min(t.x, e.x), i.y = Math.min(t.y, e.y), i.z = Math.min(t.z, e.z), i.w = Math.min(t.w, e.w);
            }, t.max = function (t, e, i) {
                i.x = Math.max(t.x, e.x), i.y = Math.max(t.y, e.y), i.z = Math.max(t.z, e.z), i.w = Math.max(t.w, e.w);
            }, n(t, ["ZERO", function () {
                return this.ZERO = new t();
            }, "ONE", function () {
                return this.ONE = new t(1, 1, 1, 1);
            }, "UnitX", function () {
                return this.UnitX = new t(1, 0, 0, 0);
            }, "UnitY", function () {
                return this.UnitY = new t(0, 1, 0, 0);
            }, "UnitZ", function () {
                return this.UnitZ = new t(0, 0, 1, 0);
            }, "UnitW", function () {
                return this.UnitW = new t(0, 0, 0, 1);
            }]), t;
        }(), mt = function () {
            function t(t) {
                if (this._counter = 0, this.defines = {}, t) for (var e in this._counter = t._counter,
                    t.defines) this.defines[e] = t.defines[e];
            }
            return r(t, "laya.d3.shader.ShaderDefines"), t.prototype.registerDefine = function (t) {
                var e = Math.pow(2, this._counter++);
                return this.defines[e] = t, e;
            }, t;
        }(), gt = function () {
            function t(t, e, i, n) {
                this.x = NaN, this.y = NaN, this.z = NaN, void 0 === t && (t = 0), void 0 === e && (e = 0),
                    void 0 === i && (i = 0), this.x = t, this.y = e, this.z = i;
            }
            r(t, "laya.d3.math.Vector3");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setValue = function (t, e, i) {
                this.x = t, this.y = e, this.z = i;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1], this.z = t[e + 2];
            }, e.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y, e.z = this.z;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.toDefault = function () {
                this.x = 0, this.y = 0, this.z = 0;
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.x, this.elements[1] = this.y, this.elements[2] = this.z) : this.elements = new Float32Array([this.x, this.y, this.z]),
                    yt.rewriteNumProperty(this, "x", 0), yt.rewriteNumProperty(this, "y", 1), yt.rewriteNumProperty(this, "z", 2);
            }, t.distanceSquared = function (t, e) {
                var i = t.x - e.x, n = t.y - e.y, r = t.z - e.z;
                return i * i + n * n + r * r;
            }, t.distance = function (t, e) {
                var i = t.x - e.x, n = t.y - e.y, r = t.z - e.z;
                return Math.sqrt(i * i + n * n + r * r);
            }, t.min = function (t, e, i) {
                i.x = Math.min(t.x, e.x), i.y = Math.min(t.y, e.y), i.z = Math.min(t.z, e.z);
            }, t.max = function (t, e, i) {
                i.x = Math.max(t.x, e.x), i.y = Math.max(t.y, e.y), i.z = Math.max(t.z, e.z);
            }, t.transformQuat = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.x, o = e.y, l = e.z, h = e.w, u = h * n + o * a - l * r, c = h * r + l * n - s * a, d = h * a + s * r - o * n, _ = -s * n - o * r - l * a;
                i.x = u * h + _ * -s + c * -l - d * -o, i.y = c * h + _ * -o + d * -s - u * -l,
                    i.z = d * h + _ * -l + u * -o - c * -s;
            }, t.scalarLength = function (t) {
                var e = t.x, i = t.y, n = t.z;
                return Math.sqrt(e * e + i * i + n * n);
            }, t.scalarLengthSquared = function (t) {
                var e = t.x, i = t.y, n = t.z;
                return e * e + i * i + n * n;
            }, t.normalize = function (t, e) {
                var i = t.x, n = t.y, r = t.z, a = i * i + n * n + r * r;
                a > 0 && (a = 1 / Math.sqrt(a), e.x = t.x * a, e.y = t.y * a, e.z = t.z * a);
            }, t.multiply = function (t, e, i) {
                i.x = t.x * e.x, i.y = t.y * e.y, i.z = t.z * e.z;
            }, t.scale = function (t, e, i) {
                i.x = t.x * e, i.y = t.y * e, i.z = t.z * e;
            }, t.lerp = function (t, e, i, n) {
                var r = t.x, a = t.y, s = t.z;
                n.x = r + i * (e.x - r), n.y = a + i * (e.y - a), n.z = s + i * (e.z - s);
            }, t.transformV3ToV3 = function (e, i, n) {
                var r = t._tempVector4;
                t.transformV3ToV4(e, i, r), n.x = r.x, n.y = r.y, n.z = r.z;
            }, t.transformV3ToV4 = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.elements;
                i.x = n * s[0] + r * s[4] + a * s[8] + s[12], i.y = n * s[1] + r * s[5] + a * s[9] + s[13],
                    i.z = n * s[2] + r * s[6] + a * s[10] + s[14], i.w = n * s[3] + r * s[7] + a * s[11] + s[15];
            }, t.TransformNormal = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.elements;
                i.x = n * s[0] + r * s[4] + a * s[8], i.y = n * s[1] + r * s[5] + a * s[9], i.z = n * s[2] + r * s[6] + a * s[10];
            }, t.transformCoordinate = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.elements, o = n * s[3] + r * s[7] + a * s[11] + s[15];
                i.x = n * s[0] + r * s[4] + a * s[8] + s[12] / o, i.y = n * s[1] + r * s[5] + a * s[9] + s[13] / o,
                    i.z = n * s[2] + r * s[6] + a * s[10] + s[14] / o;
            }, t.Clamp = function (t, e, i, n) {
                var r = t.x, a = t.y, s = t.z, o = e.x, l = e.y, h = e.z, u = i.x, c = i.y, d = i.z;
                r = (r = r > u ? u : r) < o ? o : r, a = (a = a > c ? c : a) < l ? l : a, s = (s = s > d ? d : s) < h ? h : s,
                    n.x = r, n.y = a, n.z = s;
            }, t.add = function (t, e, i) {
                i.x = t.x + e.x, i.y = t.y + e.y, i.z = t.z + e.z;
            }, t.subtract = function (t, e, i) {
                i.x = t.x - e.x, i.y = t.y - e.y, i.z = t.z - e.z;
            }, t.cross = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.x, o = e.y, l = e.z;
                i.x = r * l - a * o, i.y = a * s - n * l, i.z = n * o - r * s;
            }, t.dot = function (t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z;
            }, t.equals = function (t, e) {
                return nt.nearEqual(t.x, e.x) && nt.nearEqual(t.y, e.y) && nt.nearEqual(t.z, e.z);
            }, t._ZERO = new t(0, 0, 0), t._ONE = new t(1, 1, 1), t._NegativeUnitX = new t(-1, 0, 0),
                t._UnitX = new t(1, 0, 0), t._UnitY = new t(0, 1, 0), t._UnitZ = new t(0, 0, 1),
                t._ForwardRH = new t(0, 0, -1), t._ForwardLH = new t(0, 0, 1), t._Up = new t(0, 1, 0),
                n(t, ["_tempVector4", function () {
                    return this._tempVector4 = new pt();
                }]), t;
        }(), yt = function () {
            function t(t, e) {
                this.x = NaN, this.y = NaN, void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t,
                    this.y = e;
            }
            r(t, "laya.d3.math.Vector2");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setValue = function (t, e) {
                this.x = t, this.y = e;
            }, e.fromArray = function (t, e) {
                void 0 === e && (e = 0), this.x = t[e + 0], this.y = t[e + 1];
            }, e.cloneTo = function (t) {
                var e = t;
                e.x = this.x, e.y = this.y;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.forNativeElement = function (e) {
                e ? (this.elements = e, this.elements[0] = this.x, this.elements[1] = this.y) : this.elements = new Float32Array([this.x, this.y]),
                    t.rewriteNumProperty(this, "x", 0), t.rewriteNumProperty(this, "y", 1);
            }, t.scale = function (t, e, i) {
                i.x = t.x * e, i.y = t.y * e;
            }, t.dot = function (t, e) {
                return t.x * e.x + t.y * e.y;
            }, t.normalize = function (t, e) {
                var i = t.x, n = t.y, r = i * i + n * n;
                r > 0 && (r = 1 / Math.sqrt(r), e.x = i * r, e.y = n * r);
            }, t.scalarLength = function (t) {
                var e = t.x, i = t.y;
                return Math.sqrt(e * e + i * i);
            }, t.rewriteNumProperty = function (t, e, i) {
                Object.defineProperty(t, e, {
                    get: function () {
                        return this.elements[i];
                    },
                    set: function (t) {
                        this.elements[i] = t;
                    }
                });
            }, n(t, ["ZERO", function () {
                return this.ZERO = new t(0, 0);
            }, "ONE", function () {
                return this.ONE = new t(1, 1);
            }]), t;
        }(), vt = function () {
            function t() { }
            r(t, "laya.d3.component.AnimatorPlayState");
            var e = t.prototype;
            return e._resetPlayState = function (t) {
                this._finish = !1, this._startPlayTime = t, this._elapsedTime = t, this._playEventIndex = 0,
                    this._lastIsFront = !0;
            }, e._cloneTo = function (t) {
                t._finish = this._finish, t._startPlayTime = this._startPlayTime, t._elapsedTime = this._elapsedTime,
                    t._playEventIndex = this._playEventIndex, t._lastIsFront = this._lastIsFront;
            }, a(0, e, "normalizedTime", function () {
                return this._normalizedTime;
            }), a(0, e, "duration", function () {
                return this._duration;
            }), t;
        }(), St = function () {
            function t(t) {
                this._velocity = null, this.enbale = !1, this.space = 0, this._velocity = t;
            }
            r(t, "laya.d3.core.particleShuriKen.module.VelocityOverLifetime");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                this._velocity.cloneTo(e._velocity), e.enbale = this.enbale, e.space = this.space;
            }, e.clone = function () {
                var t;
                switch (this._velocity.type) {
                    case 0:
                        t = Ee.createByConstant(this._velocity.constant.clone());
                        break;

                    case 1:
                        t = Ee.createByGradient(this._velocity.gradientX.clone(), this._velocity.gradientY.clone(), this._velocity.gradientZ.clone());
                        break;

                    case 2:
                        t = Ee.createByRandomTwoConstant(this._velocity.constantMin.clone(), this._velocity.constantMax.clone());
                        break;

                    case 3:
                        t = Ee.createByRandomTwoGradient(this._velocity.gradientXMin.clone(), this._velocity.gradientYMin.clone(), this._velocity.gradientZMin.clone(), this._velocity.gradientXMax.clone(), this._velocity.gradientYMax.clone(), this._velocity.gradientZMax.clone());
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e.space = this.space, e;
            }, a(0, e, "velocity", function () {
                return this._velocity;
            }), t;
        }(), Tt = function () {
            function t() { }
            return r(t, "laya.d3.loaders.MeshReader"), t.read = function (t, e, i) {
                var n = new c(t);
                n.pos = 0;
                var r = n.readUTFString();
                switch (r) {
                    case "LAYAMODEL:0301":
                    case "LAYAMODEL:0400":
                    case "LAYAMODEL:0401":
                        xt.parse(n, r, e, i);
                        break;

                    case "LAYAMODEL:05":
                    case "LAYAMODEL:COMPRESSION_05":
                        Et.parse(n, r, e, i);
                        break;

                    default:
                        throw new Error("MeshReader: unknown mesh version.");
                }
                e._setSubMeshes(i);
            }, t;
        }(), Et = (function () {
            function t() { }
            r(t, "laya.d3.core.scene.SceneManager");
        }(), function () {
            function t() { }
            r(t, "laya.d3.math.ContainmentType"), t.Disjoint = 0, t.Contains = 1, t.Intersects = 2;
        }(), function () {
            function t() { }
            return r(t, "laya.d3.loaders.LoadModelV05"), t.parse = function (e, i, n, r) {
                t._mesh = n, t._subMeshes = r, t._version = i, t._readData = e, t.READ_DATA(), t.READ_BLOCK(),
                    t.READ_STRINGS();
                for (var a = 0, s = t._BLOCK.count; a < s; a++) {
                    t._readData.pos = t._BLOCK.blockStarts[a];
                    var o = t._readData.getUint16(), l = t._strings[o], h = t["READ_" + l];
                    if (null == h) throw new Error("model file err,no this function:" + o + " " + l);
                    h.call(null);
                }
                t._mesh._bindPoseIndices = new Uint16Array(t._bindPoseIndices), t._bindPoseIndices.length = 0,
                    t._strings.length = 0, t._readData = null, t._version = null, t._mesh = null, t._subMeshes = null;
            }, t._readString = function () {
                return t._strings[t._readData.getUint16()];
            }, t.READ_DATA = function () {
                t._DATA.offset = t._readData.getUint32(), t._DATA.size = t._readData.getUint32();
            }, t.READ_BLOCK = function () {
                for (var e = t._BLOCK.count = t._readData.getUint16(), i = t._BLOCK.blockStarts = [], n = t._BLOCK.blockLengths = [], r = 0; r < e; r++) i.push(t._readData.getUint32()),
                    n.push(t._readData.getUint32());
            }, t.READ_STRINGS = function () {
                var e = t._readData.getUint32(), i = t._readData.getUint16(), n = t._readData.pos;
                t._readData.pos = e + t._DATA.offset;
                for (var r = 0; r < i; r++) t._strings[r] = t._readData.readUTFString();
                t._readData.pos = n;
            }, t.READ_MESH = function () {
                var e = 0, i = 0, n = (t._readString(), t._readData.__getBuffer()), r = t._readData.getInt16(), a = t._DATA.offset;
                for (e = 0; e < r; e++) {
                    var o = a + t._readData.getUint32(), l = t._readData.getUint32(), h = t._readString(), u = bt.getVertexDeclaration(h, !1), c = u.vertexStride, d = new ArrayBuffer(c * l), _ = new Float32Array(d), f = h.split(","), p = f.length;
                    switch (t._version) {
                        case "LAYAMODEL:05":
                            _ = new Float32Array(n.slice(o, o + l * c));
                            break;

                        case "LAYAMODEL:COMPRESSION_05":
                            var m = t._readData.pos;
                            _ = new Float32Array(d);
                            var g = new Uint8Array(d);
                            t._readData.pos = o;
                            for (var y = 0; y < l; y++) for (var v = 0, S = y * c, T = 0; T < p; T++) switch (f[T]) {
                                case "POSITION":
                                    _[v = S / 4] = Rt.convertToNumber(t._readData.getUint16()), _[v + 1] = Rt.convertToNumber(t._readData.getUint16()),
                                        _[v + 2] = Rt.convertToNumber(t._readData.getUint16()), S += 12;
                                    break;

                                case "NORMAL":
                                    _[v = S / 4] = t._readData.getUint8() / 127.5 - 1, _[v + 1] = t._readData.getUint8() / 127.5 - 1,
                                        _[v + 2] = t._readData.getUint8() / 127.5 - 1, S += 12;
                                    break;

                                case "COLOR":
                                    _[v = S / 4] = t._readData.getUint8() / 255, _[v + 1] = t._readData.getUint8() / 255,
                                        _[v + 2] = t._readData.getUint8() / 255, _[v + 3] = t._readData.getUint8() / 255,
                                        S += 16;
                                    break;

                                case "UV":
                                case "UV1":
                                    _[v = S / 4] = Rt.convertToNumber(t._readData.getUint16()), _[v + 1] = Rt.convertToNumber(t._readData.getUint16()),
                                        S += 8;
                                    break;

                                case "BLENDWEIGHT":
                                    _[v = S / 4] = t._readData.getUint8() / 255, _[v + 1] = t._readData.getUint8() / 255,
                                        _[v + 2] = t._readData.getUint8() / 255, _[v + 3] = t._readData.getUint8() / 255,
                                        S += 16;
                                    break;

                                case "BLENDINDICES":
                                    g[S] = t._readData.getUint8(), g[S + 1] = t._readData.getUint8(), g[S + 2] = t._readData.getUint8(),
                                        g[S + 3] = t._readData.getUint8(), S += 4;
                                    break;

                                case "TANGENT":
                                    _[v = S / 4] = t._readData.getUint8() / 127.5 - 1, _[v + 1] = t._readData.getUint8() / 127.5 - 1,
                                        _[v + 2] = t._readData.getUint8() / 127.5 - 1, _[v + 3] = t._readData.getUint8() / 127.5 - 1,
                                        S += 16;
                            }
                            t._readData.pos = m;
                    }
                    var E = new Ke(d.byteLength, 35044, !0);
                    E.vertexDeclaration = u, E.setData(_), t._mesh._vertexBuffers.push(E), t._mesh._vertexCount += E.vertexCount,
                        i += 4 * _.length;
                }
                var C = a + t._readData.getUint32(), x = t._readData.getUint32(), b = new Uint16Array(n.slice(C, C + x)), I = new Ze("ushort", x / 2, 35044, !0);
                I.setData(b), t._mesh._indexBuffer = I, t._mesh._setBuffer(t._mesh._vertexBuffers, I),
                    i += 2 * I.indexCount, t._mesh._setCPUMemory(i), t._mesh._setGPUMemory(i);
                var w = t._mesh._boneNames = [], A = t._readData.getUint16();
                for (w.length = A, e = 0; e < A; e++) w[e] = t._strings[t._readData.getUint16()];
                var R = t._readData.getUint32(), M = t._readData.getUint32(), D = new Float32Array(n.slice(a + R, a + R + M)), O = D.length, L = O / 16, P = t._mesh._inverseBindPosesBuffer = new ArrayBuffer(4 * O);
                for (t._mesh._inverseBindPoses = s(L), e = 0; e < O; e += 16) {
                    var N = new ze(D[e + 0], D[e + 1], D[e + 2], D[e + 3], D[e + 4], D[e + 5], D[e + 6], D[e + 7], D[e + 8], D[e + 9], D[e + 10], D[e + 11], D[e + 12], D[e + 13], D[e + 14], D[e + 15], new Float32Array(P, 4 * e, 16));
                    t._mesh._inverseBindPoses[e / 16] = N;
                }
                return !0;
            }, t.READ_SUBMESH = function () {
                var e = t._readData.__getBuffer(), i = new ai(t._mesh), n = t._readData.getInt16(), r = t._readData.getUint32(), a = t._readData.getUint32(), s = t._mesh._indexBuffer;
                i._indexBuffer = s, i._indexStart = r, i._indexCount = a, i._indices = new Uint16Array(s.getData().buffer, 2 * r, a);
                var o = t._mesh._vertexBuffers[n];
                i._vertexBuffer = o;
                var l = t._DATA.offset, h = i._subIndexBufferStart, u = i._subIndexBufferCount, c = i._boneIndicesList, d = t._readData.getUint16();
                h.length = d, u.length = d, c.length = d;
                for (var _ = t._mesh._skinDataPathMarks, f = t._bindPoseIndices, p = t._subMeshes.length, m = 0; m < d; m++) {
                    h[m] = t._readData.getUint32(), u[m] = t._readData.getUint32();
                    for (var g = t._readData.getUint32(), y = t._readData.getUint32(), v = c[m] = new Uint16Array(e.slice(l + g, l + g + y)), S = 0, T = v.length; S < T; S++) {
                        var E = v[S], C = f.indexOf(E);
                        -1 === C ? (v[S] = f.length, f.push(E), _.push([p, m, S])) : v[S] = C;
                    }
                }
                return t._subMeshes.push(i), !0;
            }, t._strings = [], t._readData = null, t._version = null, t._mesh = null, t._subMeshes = null,
                t._bindPoseIndices = [], n(t, ["_BLOCK", function () {
                    return this._BLOCK = {
                        count: 0
                    };
                }, "_DATA", function () {
                    return this._DATA = {
                        offset: 0,
                        size: 0
                    };
                }]), t;
        }()), Ct = function () {
            function t(t, e, i, n) {
                this.r = NaN, this.g = NaN, this.b = NaN, this.a = NaN, void 0 === t && (t = 1),
                    void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === n && (n = 1), this.r = t,
                    this.g = e, this.b = i, this.a = n;
            }
            r(t, "laya.d3.math.Color");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.toLinear = function (t) {
                t.r = Ht.gammaToLinearSpace(this.r), t.g = Ht.gammaToLinearSpace(this.g), t.b = Ht.gammaToLinearSpace(this.b);
            }, e.toGamma = function (t) {
                t.r = Ht.linearToGammaSpace(this.r), t.g = Ht.linearToGammaSpace(this.g), t.b = Ht.linearToGammaSpace(this.b);
            }, e.cloneTo = function (t) {
                var e = t;
                e.r = this.r, e.g = this.g, e.b = this.b, e.a = this.a;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.forNativeElement = function (t) {
                t ? (this.elements = t, this.elements[0] = this.r, this.elements[1] = this.g, this.elements[2] = this.b,
                    this.elements[3] = this.a) : this.elements = new Float32Array([this.r, this.g, this.b, this.a]),
                    yt.rewriteNumProperty(this, "r", 0), yt.rewriteNumProperty(this, "g", 1), yt.rewriteNumProperty(this, "b", 2),
                    yt.rewriteNumProperty(this, "a", 3);
            }, n(t, ["RED", function () {
                return this.RED = new t(1, 0, 0, 1);
            }, "GREEN", function () {
                return this.GREEN = new t(0, 1, 0, 1);
            }, "BLUE", function () {
                return this.BLUE = new t(0, 0, 1, 1);
            }, "CYAN", function () {
                return this.CYAN = new t(0, 1, 1, 1);
            }, "YELLOW", function () {
                return this.YELLOW = new t(1, .92, .016, 1);
            }, "MAGENTA", function () {
                return this.MAGENTA = new t(1, 0, 1, 1);
            }, "GRAY", function () {
                return this.GRAY = new t(.5, .5, .5, 1);
            }, "WHITE", function () {
                return this.WHITE = new t(1, 1, 1, 1);
            }, "BLACK", function () {
                return this.BLACK = new t(0, 0, 0, 1);
            }]), t;
        }(), xt = function () {
            function t() { }
            return r(t, "laya.d3.loaders.LoadModelV04"), t.parse = function (e, i, n, r) {
                t._mesh = n, t._subMeshes = r, t._version = i, t._readData = e, t.READ_DATA(), t.READ_BLOCK(),
                    t.READ_STRINGS();
                for (var a = 0, s = t._BLOCK.count; a < s; a++) {
                    t._readData.pos = t._BLOCK.blockStarts[a];
                    var o = t._readData.getUint16(), l = t._strings[o], h = t["READ_" + l];
                    if (null == h) throw new Error("model file err,no this function:" + o + " " + l);
                    h.call(null);
                }
                t._mesh._bindPoseIndices = new Uint16Array(t._bindPoseIndices), t._bindPoseIndices.length = 0,
                    t._strings.length = 0, t._readData = null, t._version = null, t._mesh = null, t._subMeshes = null;
            }, t._readString = function () {
                return t._strings[t._readData.getUint16()];
            }, t.READ_DATA = function () {
                t._DATA.offset = t._readData.getUint32(), t._DATA.size = t._readData.getUint32();
            }, t.READ_BLOCK = function () {
                for (var e = t._BLOCK.count = t._readData.getUint16(), i = t._BLOCK.blockStarts = [], n = t._BLOCK.blockLengths = [], r = 0; r < e; r++) i.push(t._readData.getUint32()),
                    n.push(t._readData.getUint32());
            }, t.READ_STRINGS = function () {
                var e = t._readData.getUint32(), i = t._readData.getUint16(), n = t._readData.pos;
                t._readData.pos = e + t._DATA.offset;
                for (var r = 0; r < i; r++) t._strings[r] = t._readData.readUTFString();
                t._readData.pos = n;
            }, t.READ_MESH = function () {
                t._readString();
                var e = t._readData.__getBuffer(), i = 0, n = 0, r = t._readData.getInt16(), a = t._DATA.offset;
                for (i = 0; i < r; i++) {
                    var o, l = a + t._readData.getUint32(), h = t._readData.getUint32(), u = new Float32Array(e.slice(l, l + h)), c = t._readString();
                    switch (t._version) {
                        case "LAYAMODEL:0301":
                        case "LAYAMODEL:0400":
                            o = bt.getVertexDeclaration(c);
                            break;

                        case "LAYAMODEL:0401":
                            o = bt.getVertexDeclaration(c, !1);
                            break;

                        default:
                            throw new Error("LoadModelV03: unknown version.");
                    }
                    if (!o) throw new Error("LoadModelV03: unknown vertexDeclaration.");
                    var d = new Ke(4 * u.length, 35044, !0);
                    d.vertexDeclaration = o, d.setData(u), t._mesh._vertexBuffers.push(d), t._mesh._vertexCount += d.vertexCount,
                        n += 4 * u.length;
                }
                var _ = a + t._readData.getUint32(), f = t._readData.getUint32(), p = new Uint16Array(e.slice(_, _ + f)), m = new Ze("ushort", f / 2, 35044, !0);
                m.setData(p), t._mesh._indexBuffer = m, n += 2 * m.indexCount, t._mesh._setBuffer(t._mesh._vertexBuffers, m),
                    t._mesh._setCPUMemory(n), t._mesh._setGPUMemory(n);
                var g = t._mesh._boneNames = [], y = t._readData.getUint16();
                for (g.length = y, i = 0; i < y; i++) g[i] = t._strings[t._readData.getUint16()];
                t._readData.pos += 8;
                var v = t._readData.getUint32(), S = t._readData.getUint32(), T = new Float32Array(e.slice(a + v, a + v + S)), E = T.length, C = E / 16, x = t._mesh._inverseBindPosesBuffer = new ArrayBuffer(4 * E);
                for (t._mesh._inverseBindPoses = s(C), i = 0; i < E; i += 16) {
                    var b = new ze(T[i + 0], T[i + 1], T[i + 2], T[i + 3], T[i + 4], T[i + 5], T[i + 6], T[i + 7], T[i + 8], T[i + 9], T[i + 10], T[i + 11], T[i + 12], T[i + 13], T[i + 14], T[i + 15], new Float32Array(x, 4 * i, 16));
                    t._mesh._inverseBindPoses[i / 16] = b;
                }
                return !0;
            }, t.READ_SUBMESH = function () {
                var e = t._readData.__getBuffer(), i = new ai(t._mesh), n = t._readData.getInt16();
                t._readData.getUint32(), t._readData.getUint32();
                var r = t._readData.getUint32(), a = t._readData.getUint32(), s = t._mesh._indexBuffer;
                i._indexBuffer = s, i._indexStart = r, i._indexCount = a, i._indices = new Uint16Array(s.getData().buffer, 2 * r, a);
                var o = t._mesh._vertexBuffers[n];
                i._vertexBuffer = o;
                var l = t._DATA.offset, h = i._subIndexBufferStart, u = i._subIndexBufferCount, c = i._boneIndicesList, d = t._readData.getUint16();
                h.length = d, u.length = d, c.length = d;
                for (var _ = t._mesh._skinDataPathMarks, f = t._bindPoseIndices, p = t._subMeshes.length, m = 0; m < d; m++) {
                    h[m] = t._readData.getUint32(), u[m] = t._readData.getUint32();
                    for (var g = t._readData.getUint32(), y = t._readData.getUint32(), v = c[m] = new Uint16Array(e.slice(l + g, l + g + y)), S = 0, T = v.length; S < T; S++) {
                        var E = v[S], C = f.indexOf(E);
                        -1 === C ? (v[S] = f.length, f.push(E), _.push([p, m, S])) : v[S] = C;
                    }
                }
                return t._subMeshes.push(i), !0;
            }, t._strings = [], t._readData = null, t._version = null, t._mesh = null, t._subMeshes = null,
                t._bindPoseIndices = [], n(t, ["_BLOCK", function () {
                    return this._BLOCK = {
                        count: 0
                    };
                }, "_DATA", function () {
                    return this._DATA = {
                        offset: 0,
                        size: 0
                    };
                }]), t;
        }(), bt = function () {
            function t() { }
            return r(t, "laya.d3.graphics.Vertex.VertexMesh"), t.getVertexDeclaration = function (e, i) {
                void 0 === i && (i = !0);
                var n = t._vertexDeclarationMap[e + (i ? "_0" : "_1")];
                if (!n) {
                    for (var r = e.split(","), a = 0, s = [], o = 0, l = r.length; o < l; o++) {
                        var h;
                        switch (r[o]) {
                            case "POSITION":
                                h = new Ut(a, "vector3", 0), a += 12;
                                break;

                            case "NORMAL":
                                h = new Ut(a, "vector3", 3), a += 12;
                                break;

                            case "COLOR":
                                h = new Ut(a, "vector4", 1), a += 16;
                                break;

                            case "UV":
                                h = new Ut(a, "vector2", 2), a += 8;
                                break;

                            case "UV1":
                                h = new Ut(a, "vector2", 7), a += 8;
                                break;

                            case "BLENDWEIGHT":
                                h = new Ut(a, "vector4", 6), a += 16;
                                break;

                            case "BLENDINDICES":
                                i ? (h = new Ut(a, "vector4", 5), a += 16) : (h = new Ut(a, "byte4", 5), a += 4);
                                break;

                            case "TANGENT":
                                h = new Ut(a, "vector4", 4), a += 16;
                                break;

                            default:
                                throw "VertexMesh: unknown vertex flag.";
                        }
                        s.push(h);
                    }
                    n = new fe(a, s), t._vertexDeclarationMap[e + (i ? "_0" : "_1")] = n;
                }
                return n;
            }, t.MESH_POSITION0 = 0, t.MESH_COLOR0 = 1, t.MESH_TEXTURECOORDINATE0 = 2, t.MESH_NORMAL0 = 3,
                t.MESH_TANGENT0 = 4, t.MESH_BLENDINDICES0 = 5, t.MESH_BLENDWEIGHT0 = 6, t.MESH_TEXTURECOORDINATE1 = 7,
                t.MESH_WORLDMATRIX_ROW0 = 8, t.MESH_WORLDMATRIX_ROW1 = 9, t.MESH_WORLDMATRIX_ROW2 = 10,
                t.MESH_WORLDMATRIX_ROW3 = 11, t.MESH_MVPMATRIX_ROW0 = 12, t.MESH_MVPMATRIX_ROW1 = 13,
                t.MESH_MVPMATRIX_ROW2 = 14, t.MESH_MVPMATRIX_ROW3 = 15, t._vertexDeclarationMap = {},
                n(t, ["instanceWorldMatrixDeclaration", function () {
                    return this.instanceWorldMatrixDeclaration = new fe(64, [new Ut(0, "vector4", 8), new Ut(16, "vector4", 9), new Ut(32, "vector4", 10), new Ut(48, "vector4", 11)]);
                }, "instanceMVPMatrixDeclaration", function () {
                    return this.instanceMVPMatrixDeclaration = new fe(64, [new Ut(0, "vector4", 12), new Ut(16, "vector4", 13), new Ut(32, "vector4", 14), new Ut(48, "vector4", 15)]);
                }]), t;
        }(), It = function () {
            function t() {
                this._destroyed = !1, this._emissionRate = 0, this._bursts = null, this.enbale = !1,
                    this._destroyed = !1, this.emissionRate = 10, this._bursts = [];
            }
            r(t, "laya.d3.core.particleShuriKen.module.Emission");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0,
                "laya.resource.IDestroy": !0
            }), e.destroy = function () {
                this._bursts = null, this._destroyed = !0;
            }, e.getBurstsCount = function () {
                return this._bursts.length;
            }, e.getBurstByIndex = function (t) {
                return this._bursts[t];
            }, e.addBurst = function (t) {
                var e = this._bursts.length;
                if (e > 0) for (var i = 0; i < e; i++) this._bursts[i].time > t.time && this._bursts.splice(i, 0, t);
                this._bursts.push(t);
            }, e.removeBurst = function (t) {
                var e = this._bursts.indexOf(t);
                -1 !== e && this._bursts.splice(e, 1);
            }, e.removeBurstByIndex = function (t) {
                this._bursts.splice(t, 1);
            }, e.clearBurst = function () {
                this._bursts.length = 0;
            }, e.cloneTo = function (t) {
                var e = t, i = e._bursts;
                i.length = this._bursts.length;
                for (var n = 0, r = this._bursts.length; n < r; n++) {
                    var a = i[n];
                    a ? this._bursts[n].cloneTo(a) : i[n] = this._bursts[n].clone();
                }
                e._emissionRate = this._emissionRate, e.enbale = this.enbale;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "destroyed", function () {
                return this._destroyed;
            }), a(0, e, "emissionRate", function () {
                return this._emissionRate;
            }, function (t) {
                if (t < 0) throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");
                this._emissionRate = t;
            }), t;
        }(), wt = function () {
            function t(t, e) {
                this.center = null, this.radius = NaN, this.center = t, this.radius = e;
            }
            r(t, "laya.d3.math.BoundSphere");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.toDefault = function () {
                this.center.toDefault(), this.radius = 0;
            }, e.intersectsRayDistance = function (t) {
                return Fe.intersectsRayAndSphereRD(t, this);
            }, e.intersectsRayPoint = function (t, e) {
                return Fe.intersectsRayAndSphereRP(t, this, e);
            }, e.cloneTo = function (t) {
                var e = t;
                this.center.cloneTo(e.center), e.radius = this.radius;
            }, e.clone = function () {
                var t = new this.constructor(new gt(), new gt());
                return this.cloneTo(t), t;
            }, t.createFromSubPoints = function (e, i, n, r) {
                if (null == e) throw new Error("points");
                if (i < 0 || i >= e.length) throw new Error("start" + i + "Must be in the range [0, " + (e.length - 1) + "]");
                if (n < 0 || i + n > e.length) throw new Error("count" + n + "Must be in the range <= " + e.length + "}");
                var a = i + n, s = t._tempVector3;
                s.x = 0, s.y = 0, s.z = 0;
                for (var o = i; o < a; ++o) gt.add(e[o], s, s);
                var l = r.center;
                gt.scale(s, 1 / n, l);
                var h = 0;
                for (o = i; o < a; ++o) {
                    var u = gt.distanceSquared(l, e[o]);
                    u > h && (h = u);
                }
                r.radius = Math.sqrt(h);
            }, t.createfromPoints = function (e, i) {
                if (null == e) throw new Error("points");
                t.createFromSubPoints(e, 0, e.length, i);
            }, n(t, ["_tempVector3", function () {
                return this._tempVector3 = new gt();
            }]), t;
        }(), At = function () {
            function t() {
                this.renderType = 0;
            }
            r(t, "laya.d3.core.render.RenderElement");
            var e = t.prototype;
            return e.setTransform = function (t) {
                this._transform = t;
            }, e.setGeometry = function (t) {
                this._geometry = t;
            }, e.addToOpaqueRenderQueue = function (t, e) {
                e.elements.push(this);
            }, e.addToTransparentRenderQueue = function (t, e) {
                e.elements.push(this), e.lastTransparentBatched = !1, e.lastTransparentRenderElement = this;
            }, e._render = function (t, e, i, n) {
                var r, a, s, o = wn._updateMark, l = t.scene, h = t.camera, u = this._transform, c = this._geometry;
                t.renderElement = this;
                var d = o !== this.render._updateMark || this.renderType !== this.render._updateRenderType;
                if (d && (this.render._renderUpdate(t, u), this.render._renderUpdateWithCamera(t, u),
                    this.render._updateMark = o, this.render._updateRenderType = this.renderType), c._prepareRender(t)) {
                    var _, f = this.material._shader.getSubShaderAt(0);
                    if (i) if (n) {
                        var p = f.getFlag(n);
                        if (!p) return;
                        for (var m = i._subShaders, g = 0, y = m.length; g < y; g++) {
                            var v = m[g];
                            if (p === v.getFlag(n)) {
                                _ = v._passes;
                                break;
                            }
                        }
                        if (!_) return;
                    } else _ = i.getSubShaderAt(0)._passes; else _ = f._passes;
                    for (var S = 0, T = _.length; S < T; S++) {
                        var E = t.shader = _[S].withCompile(l._defineDatas.value & ~this.material._disablePublicDefineDatas.value, this.render._defineDatas.value, this.material._defineDatas.value), C = E.bind(), x = o !== E._uploadMark, b = E._uploadScene !== l || x;
                        (b || C) && (E.uploadUniforms(E._sceneUniformParamsMap, l._shaderValues, b), E._uploadScene = l);
                        var I = E._uploadRender !== this.render || E._uploadRenderType !== this.renderType || x;
                        (I || C) && (E.uploadUniforms(E._spriteUniformParamsMap, this.render._shaderValues, I),
                            E._uploadRender = this.render, E._uploadRenderType = this.renderType);
                        var w = E._uploadCamera !== h || x;
                        (w || C) && (E.uploadUniforms(E._cameraUniformParamsMap, h._shaderValues, w), E._uploadCamera = h);
                        var A = E._uploadMaterial !== this.material || x;
                        (A || C) && (E.uploadUniforms(E._materialUniformParamsMap, this.material._shaderValues, A),
                            E._uploadMaterial = this.material);
                        var R = this.material._shaderValues;
                        r !== this.material || a !== E ? (E.uploadRenderStateBlendDepth(R), E.uploadRenderStateFrontFace(R, e, u),
                            r = this.material, a = E, s = this.render) : s !== this.render && (E.uploadRenderStateFrontFace(R, e, u),
                                s = this.render), c._render(t), E._uploadMark = o;
                    }
                }
                d && 0 !== this.renderType && this.render._revertBatchRenderUpdate(t), wn._updateMark++;
            }, e.destroy = function () {
                this._transform = null, this._geometry = null, this.material = null, this.render = null;
            }, t.RENDERTYPE_NORMAL = 0, t.RENDERTYPE_STATICBATCH = 1, t.RENDERTYPE_INSTANCEBATCH = 2,
                t.RENDERTYPE_VERTEXBATCH = 3, t;
        }(), Rt = function () {
            function t() { }
            return r(t, "laya.d3.math.HalfFloatUtils"), t.__init__ = function () {
                for (var e = 0; e < 256; ++e) {
                    var i = e - 127;
                    i < -27 ? (t._baseTable[0 | e] = 0, t._baseTable[256 | e] = 32768, t._shiftTable[0 | e] = 24,
                        t._shiftTable[256 | e] = 24) : i < -14 ? (t._baseTable[0 | e] = 1024 >> -i - 14,
                            t._baseTable[256 | e] = 1024 >> -i - 14 | 32768, t._shiftTable[0 | e] = -i - 1,
                            t._shiftTable[256 | e] = -i - 1) : i <= 15 ? (t._baseTable[0 | e] = i + 15 << 10,
                                t._baseTable[256 | e] = i + 15 << 10 | 32768, t._shiftTable[0 | e] = 13, t._shiftTable[256 | e] = 13) : i < 128 ? (t._baseTable[0 | e] = 31744,
                                    t._baseTable[256 | e] = 64512, t._shiftTable[0 | e] = 24, t._shiftTable[256 | e] = 24) : (t._baseTable[0 | e] = 31744,
                                        t._baseTable[256 | e] = 64512, t._shiftTable[0 | e] = 13, t._shiftTable[256 | e] = 13);
                }
                for (t._mantissaTable[0] = 0, e = 1; e < 1024; ++e) {
                    var n = e << 13;
                    for (i = 0; 0 == (8388608 & n);) i -= 8388608, n <<= 1;
                    n &= -8388609, i += 947912704, t._mantissaTable[e] = n | i;
                }
                for (e = 1024; e < 2048; ++e) t._mantissaTable[e] = 939524096 + (e - 1024 << 13);
                for (t._exponentTable[0] = 0, e = 1; e < 31; ++e) t._exponentTable[e] = e << 23;
                for (t._exponentTable[31] = 1199570944, t._exponentTable[32] = 2147483648, e = 33; e < 63; ++e) t._exponentTable[e] = 2147483648 + (e - 32 << 23);
                for (t._exponentTable[63] = 3347054592, t._offsetTable[0] = 0, e = 1; e < 64; ++e) t._offsetTable[e] = 32 === e ? 0 : 1024;
            }, t.roundToFloat16Bits = function (e) {
                t._floatView[0] = e;
                var i = t._uint32View[0], n = i >> 23 & 511;
                return t._baseTable[n] + ((8388607 & i) >> t._shiftTable[n]);
            }, t.convertToNumber = function (e) {
                var i = e >> 10;
                return t._uint32View[0] = t._mantissaTable[t._offsetTable[i] + (1023 & e)] + t._exponentTable[i],
                    t._floatView[0];
            }, n(t, ["_buffer", function () {
                return this._buffer = new ArrayBuffer(4);
            }, "_floatView", function () {
                return this._floatView = new Float32Array(t._buffer);
            }, "_uint32View", function () {
                return this._uint32View = new Uint32Array(t._buffer);
            }, "_baseTable", function () {
                return this._baseTable = new Uint32Array(512);
            }, "_shiftTable", function () {
                return this._shiftTable = new Uint32Array(512);
            }, "_mantissaTable", function () {
                return this._mantissaTable = new Uint32Array(2048);
            }, "_exponentTable", function () {
                return this._exponentTable = new Uint32Array(64);
            }, "_offsetTable", function () {
                return this._offsetTable = new Uint32Array(64);
            }]), t;
        }(), Mt = function () {
            function t() {
                this._vertexBuffer = null, this._indexBuffer = null, this._bufferState = null;
            }
            return r(t, "laya.d3.resource.models.SkyMesh"), t.prototype._render = function (t) { },
                t;
        }(), Dt = function () {
            function t(t, e) {
                this._frame = null, this._startFrame = null, this.tiles = null, this.type = 0, this.randomRow = !1,
                    this.rowIndex = 0, this.cycles = 0, this.enableUVChannels = 0, this.enable = !1,
                    this.tiles = new yt(1, 1), this.type = 0, this.randomRow = !0, this.rowIndex = 0,
                    this.cycles = 1, this.enableUVChannels = 1, this._frame = t, this._startFrame = e;
            }
            r(t, "laya.d3.core.particleShuriKen.module.TextureSheetAnimation");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                this.tiles.cloneTo(e.tiles), e.type = this.type, e.randomRow = this.randomRow, this._frame.cloneTo(e._frame),
                    this._startFrame.cloneTo(e._startFrame), e.cycles = this.cycles, e.enableUVChannels = this.enableUVChannels,
                    e.enable = this.enable;
            }, e.clone = function () {
                var t, e;
                switch (this._frame.type) {
                    case 0:
                        t = X.createByConstant(this._frame.constant);
                        break;

                    case 1:
                        t = X.createByOverTime(this._frame.frameOverTimeData.clone());
                        break;

                    case 2:
                        t = X.createByRandomTwoConstant(this._frame.constantMin, this._frame.constantMax);
                        break;

                    case 3:
                        t = X.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(), this._frame.frameOverTimeDataMax.clone());
                }
                switch (this._startFrame.type) {
                    case 0:
                        e = xe.createByConstant(this._startFrame.constant);
                        break;

                    case 1:
                        e = xe.createByRandomTwoConstant(this._startFrame.constantMin, this._startFrame.constantMax);
                }
                var i = new this.constructor(t, e);
                return this.tiles.cloneTo(i.tiles), i.type = this.type, i.randomRow = this.randomRow,
                    i.cycles = this.cycles, i.enableUVChannels = this.enableUVChannels, i.enable = this.enable,
                    i;
            }, a(0, e, "frame", function () {
                return this._frame;
            }), a(0, e, "startFrame", function () {
                return this._startFrame;
            }), t;
        }(), Ot = function () {
            function t() { }
            return r(t, "laya.d3.resource.TextureGenerator"), t.lightAttenTexture = function (t, e, i, n, r, a) {
                var s = t / i, o = 1 / (1 + 25 * s);
                s >= .64 && (s > 1 ? o = 0 : o *= 1 - (s - .64) / .36), a[r] = Math.floor(255 * o + .5);
            }, t.haloTexture = function (t, e, i, n, r, a) {
                var s = (t - (i >>= 1)) / i, o = (e - (n >>= 1)) / n, l = s * s + o * o;
                l > 1 && (l = 1), a[r] = Math.floor(255 * (1 - l) + .5);
            }, t._generateTexture2D = function (t, e, i, n) {
                var r = 0, a = 0;
                switch (t.format) {
                    case 0:
                        a = 3;
                        break;

                    case 1:
                        a = 4;
                        break;

                    case 2:
                        a = 1;
                        break;

                    default:
                        throw "GeneratedTexture._generateTexture: unkonw texture format.";
                }
                for (var s = new Uint8Array(e * i * a), o = 0; o < i; o++) for (var l = 0; l < e; l++) n(l, o, e, i, r, s),
                    r += a;
                t.setPixels(s);
            }, t;
        }(), Lt = function () {
            function t(t, e, i, n) {
                this._attributeMap = null, this._uniformMap = null, this._enableInstancing = !1,
                    this._subShaders = [], this._name = t, this._attributeMap = e, this._uniformMap = i,
                    this._enableInstancing = n;
            }
            r(t, "laya.d3.shader.Shader3D");
            var e = t.prototype;
            return e.addSubShader = function (t) {
                this._subShaders.push(t), t._owner = this;
            }, e.getSubShaderAt = function (t) {
                return this._subShaders[t];
            }, t.propertyNameToID = function (e) {
                if (null != t._propertyNameMap[e]) return t._propertyNameMap[e];
                var i = t._propertyNameCounter++;
                return t._propertyNameMap[e] = i, i;
            }, t.addInclude = function (t, e) {
                R.addInclude(t, e);
            }, t.registerPublicDefine = function (e) {
                var i = Math.pow(2, t._publicCounter++);
                return t._globleDefines[i] = e, i;
            }, t.compileShader = function (t, e, i, n, r, a) {
                var s = laya.d3.shader.Shader3D.find(t);
                if (s) {
                    var o = s.getSubShaderAt(e);
                    if (o) {
                        var l = o._passes[i];
                        l ? F.shaderHighPrecision ? l.withCompile(n, r, a) : l.withCompile(n - laya.d3.shader.Shader3D.SHADERDEFINE_HIGHPRECISION, r, a) : console.warn("Shader3D: unknown passIndex.");
                    } else console.warn("Shader3D: unknown subShaderIndex.");
                } else console.warn("Shader3D: unknown shader name.");
            }, t.add = function (e, i, n, r) {
                return void 0 === r && (r = !1), laya.d3.shader.Shader3D._preCompileShader[e] = new t(e, i, n, r);
            }, t.find = function (t) {
                return laya.d3.shader.Shader3D._preCompileShader[t];
            }, t.RENDER_STATE_CULL = 0, t.RENDER_STATE_BLEND = 1, t.RENDER_STATE_BLEND_SRC = 2,
                t.RENDER_STATE_BLEND_DST = 3, t.RENDER_STATE_BLEND_SRC_RGB = 4, t.RENDER_STATE_BLEND_DST_RGB = 5,
                t.RENDER_STATE_BLEND_SRC_ALPHA = 6, t.RENDER_STATE_BLEND_DST_ALPHA = 7, t.RENDER_STATE_BLEND_CONST_COLOR = 8,
                t.RENDER_STATE_BLEND_EQUATION = 9, t.RENDER_STATE_BLEND_EQUATION_RGB = 10, t.RENDER_STATE_BLEND_EQUATION_ALPHA = 11,
                t.RENDER_STATE_DEPTH_TEST = 12, t.RENDER_STATE_DEPTH_WRITE = 13, t.PERIOD_CUSTOM = 0,
                t.PERIOD_MATERIAL = 1, t.PERIOD_SPRITE = 2, t.PERIOD_CAMERA = 3, t.PERIOD_SCENE = 4,
                t.SHADERDEFINE_HIGHPRECISION = 0, t._propertyNameCounter = 0, t._propertyNameMap = {},
                t._publicCounter = 0, t._globleDefines = [], t._preCompileShader = {}, t.debugMode = !1,
                t;
        }(), Pt = function () {
            function t(t) {
                this._temp = new Uint32Array(1), this.seeds = new Uint32Array(4), this.seeds[0] = t,
                    this.seeds[1] = 1812433253 * this.seeds[0] + 1, this.seeds[2] = 1812433253 * this.seeds[1] + 1,
                    this.seeds[3] = 1812433253 * this.seeds[2] + 1;
            }
            r(t, "laya.d3.math.Rand");
            var e = t.prototype;
            return e.getUint = function () {
                return this._temp[0] = this.seeds[0] ^ this.seeds[0] << 11, this.seeds[0] = this.seeds[1],
                    this.seeds[1] = this.seeds[2], this.seeds[2] = this.seeds[3], this.seeds[3] = this.seeds[3] ^ this.seeds[3] >>> 19 ^ this._temp[0] ^ this._temp[0] >>> 8,
                    this.seeds[3];
            }, e.getFloat = function () {
                return this.getUint(), (8388607 & this.seeds[3]) * (1 / 8388607);
            }, e.getSignedFloat = function () {
                return 2 * this.getFloat() - 1;
            }, a(0, e, "seed", function () {
                return this.seeds[0];
            }, function (t) {
                this.seeds[0] = t, this.seeds[1] = 1812433253 * this.seeds[0] + 1, this.seeds[2] = 1812433253 * this.seeds[1] + 1,
                    this.seeds[3] = 1812433253 * this.seeds[2] + 1;
            }), t.getFloatFromInt = function (t) {
                return 1 / 8388607 * (8388607 & t);
            }, t.getByteFromInt = function (t) {
                return (8388607 & t) >>> 15;
            }, t;
        }(), Nt = function () {
            function t() {
                this._currentPSSM = -1, this._shadowMapCount = 3, this._maxDistance = 200, this._ratioOfDistance = 1 / this._shadowMapCount,
                    this._statesDirty = !0, this._shadowMapTextureSize = 1024, this._scene = null, this._PCFType = 0,
                    this._shaderValueLightVP = null, this._spiltDistance = new Array(4), this._globalParallelLightDir = new gt(0, -1, 0),
                    this._boundingSphere = new Array(4), this._boundingBox = new Array(4), this._frustumPos = new Array(16),
                    this._uniformDistance = new Array(4), this._logDistance = new Array(4), this._dimension = new Array(4),
                    this._tempLookAt3 = new gt(), this._tempLookAt4 = new pt(), this._tempValue = new pt(),
                    this._tempPos = new gt(), this._tempLightUp = new gt(), this._tempMin = new pt(),
                    this._tempMax = new pt(), this._tempMatrix44 = new ze(), this._splitFrustumCulling = new Le(ze.DEFAULT),
                    this._tempScaleMatrix44 = new ze(), this._shadowPCFOffset = new yt(1 / 1024, 1 / 1024),
                    this._shaderValueDistance = new pt(), this.cameras = [], this._shaderValueVPs = [];
                var t = 0;
                for (t = 0; t < this._spiltDistance.length; t++) this._spiltDistance[t] = 0;
                for (t = 0; t < this._dimension.length; t++) this._dimension[t] = new yt();
                for (t = 0; t < this._frustumPos.length; t++) this._frustumPos[t] = new gt();
                for (t = 0; t < this._boundingBox.length; t++) this._boundingBox[t] = new Ue(new gt(), new gt());
                for (t = 0; t < this._boundingSphere.length; t++) this._boundingSphere[t] = new wt(new gt(), 0);
                ze.createScaling(new gt(.5, .5, 1), this._tempScaleMatrix44), this._tempScaleMatrix44.elements[12] = .5,
                    this._tempScaleMatrix44.elements[13] = .5;
            }
            r(t, "laya.d3.shadowMap.ParallelSplitShadowMap");
            var e = t.prototype;
            return e.setInfo = function (t, e, i, n, r, a) {
                r > 3 && (this._shadowMapCount = 3), this._scene = t, this._maxDistance = e, this.shadowMapCount = r,
                    this._globalParallelLightDir = i, this._ratioOfDistance = 1 / this._shadowMapCount;
                for (var s = 0; s < this._spiltDistance.length; s++) this._spiltDistance[s] = 0;
                this._shadowMapTextureSize = n, this._shadowPCFOffset.x = 1 / this._shadowMapTextureSize,
                    this._shadowPCFOffset.y = 1 / this._shadowMapTextureSize, this.setPCFType(a), this._statesDirty = !0;
            }, e.setPCFType = function (t) {
                this._PCFType = t;
                var e = this._scene._defineDatas;
                switch (this._PCFType) {
                    case 0:
                        e.add(Zi.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Zi.SHADERDEFINE_SHADOW_PCF1), e.remove(Zi.SHADERDEFINE_SHADOW_PCF2),
                            e.remove(Zi.SHADERDEFINE_SHADOW_PCF3);
                        break;

                    case 1:
                        e.add(Zi.SHADERDEFINE_SHADOW_PCF1), e.remove(Zi.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Zi.SHADERDEFINE_SHADOW_PCF2),
                            e.remove(Zi.SHADERDEFINE_SHADOW_PCF3);
                        break;

                    case 2:
                        e.add(Zi.SHADERDEFINE_SHADOW_PCF2), e.remove(Zi.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Zi.SHADERDEFINE_SHADOW_PCF1),
                            e.remove(Zi.SHADERDEFINE_SHADOW_PCF3);
                        break;

                    case 3:
                        e.add(Zi.SHADERDEFINE_SHADOW_PCF3), e.remove(Zi.SHADERDEFINE_SHADOW_PCF_NO), e.remove(Zi.SHADERDEFINE_SHADOW_PCF1),
                            e.remove(Zi.SHADERDEFINE_SHADOW_PCF2);
                }
            }, e.getPCFType = function () {
                return this._PCFType;
            }, e.setFarDistance = function (t) {
                this._maxDistance != t && (this._maxDistance = t, this._statesDirty = !0);
            }, e.getFarDistance = function () {
                return this._maxDistance;
            }, e._beginSampler = function (t, e) {
                if (t < 0 || t > this._shadowMapCount) throw new Error("ParallelSplitShadowMap: beginSample invalid index");
                this._currentPSSM = t, this._update(e);
            }, e.endSampler = function (t) {
                this._currentPSSM = -1;
            }, e._calcAllLightCameraInfo = function (t) {
                if (1 === this._shadowMapCount) this._beginSampler(0, t), this.endSampler(t); else for (var e = 0, i = this._shadowMapCount + 1; e < i; e++) this._beginSampler(e, t),
                    this.endSampler(t);
            }, e._recalculate = function (t, e, i) {
                this._calcSplitDistance(t), this._calcBoundingBox(e, i), this._rebuildRenderInfo();
            }, e._update = function (t) {
                var e = t.nearPlane, i = t.fieldOfView, n = t.aspectRatio;
                (this._statesDirty || this.lastNearPlane !== e || this.lastFieldOfView !== i || this.lastAspectRatio !== n) && (this._recalculate(e, i, n),
                    this._uploadShaderValue(), this._statesDirty = !1, this.lastNearPlane = e, this.lastFieldOfView = i,
                    this.lastAspectRatio = n), this._calcLightViewProject(t);
            }, e._uploadShaderValue = function () {
                var t = this._scene._defineDatas;
                switch (this._shadowMapCount) {
                    case 1:
                        t.add(Zi.SHADERDEFINE_SHADOW_PSSM1), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM2), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM3);
                        break;

                    case 2:
                        t.add(Zi.SHADERDEFINE_SHADOW_PSSM2), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM1), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM3);
                        break;

                    case 3:
                        t.add(Zi.SHADERDEFINE_SHADOW_PSSM3), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM1), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM2);
                }
                var e = this._scene._shaderValues;
                switch (e.setVector(Zi.SHADOWDISTANCE, this._shaderValueDistance), e.setBuffer(Zi.SHADOWLIGHTVIEWPROJECT, this._shaderValueLightVP),
                e.setVector2(Zi.SHADOWMAPPCFOFFSET, this._shadowPCFOffset), this._shadowMapCount) {
                    case 3:
                        e.setTexture(Zi.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget), e.setTexture(Zi.SHADOWMAPTEXTURE2, this.cameras[2].renderTarget),
                            e.setTexture(Zi.SHADOWMAPTEXTURE3, this.cameras[3].renderTarget);
                        break;

                    case 2:
                        e.setTexture(Zi.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget), e.setTexture(Zi.SHADOWMAPTEXTURE2, this.cameras[2].renderTarget);
                        break;

                    case 1:
                        e.setTexture(Zi.SHADOWMAPTEXTURE1, this.cameras[1].renderTarget);
                }
            }, e._calcSplitDistance = function (t) {
                var e = this._maxDistance, i = 1 / this._shadowMapCount, n = 0;
                for (n = 0; n <= this._shadowMapCount; n++) this._uniformDistance[n] = t + (e - t) * n * i;
                var r = e / t;
                for (n = 0; n <= this._shadowMapCount; n++) {
                    var a = Math.pow(r, n * i);
                    this._logDistance[n] = t * a;
                }
                for (n = 0; n <= this._shadowMapCount; n++) this._spiltDistance[n] = this._uniformDistance[n] * this._ratioOfDistance + this._logDistance[n] * (1 - this._ratioOfDistance);
                this._shaderValueDistance.x = this._spiltDistance[1], this._shaderValueDistance.y = this._spiltDistance[2],
                    this._shaderValueDistance.z = this._spiltDistance[3], this._shaderValueDistance.w = 0;
            }, e._calcBoundingBox = function (t, e) {
                var i, n, r, a, s = 3.1415926 * t / 180, o = Math.tan(s / 2), l = NaN, h = NaN, u = NaN, c = 0;
                for (c = 0; c <= this._shadowMapCount; c++) {
                    h = (l = (u = this._spiltDistance[c]) * o) * e;
                    var d = this._frustumPos[4 * c + 0];
                    d.x = -h, d.y = -l, d.z = -u, (d = this._frustumPos[4 * c + 1]).x = h, d.y = -l,
                        d.z = -u, (d = this._frustumPos[4 * c + 2]).x = -h, d.y = l, d.z = -u, (d = this._frustumPos[4 * c + 3]).x = h,
                        d.y = l, d.z = -u, (d = this._dimension[c]).x = h, d.y = l;
                }
                for (c = 1; c <= this._shadowMapCount; c++) i = this._dimension[c], (n = this._boundingBox[c].min).x = -i.x,
                    n.y = -i.y, n.z = -this._spiltDistance[c], (r = this._boundingBox[c].max).x = i.x,
                    r.y = i.y, r.z = -this._spiltDistance[c - 1], (a = this._boundingSphere[c].center).x = .5 * (n.x + r.x),
                    a.y = .5 * (n.y + r.y), a.z = .5 * (n.z + r.z), this._boundingSphere[c].radius = .5 * Math.sqrt(Math.pow(r.x - n.x, 2) + Math.pow(r.y - n.y, 2) + Math.pow(r.z - n.z, 2));
                n = this._boundingBox[0].min, i = this._dimension[this._shadowMapCount], n.x = -i.x,
                    n.y = -i.y, n.z = -this._spiltDistance[this._shadowMapCount], (r = this._boundingBox[0].max).x = i.x,
                    r.y = i.y, r.z = -this._spiltDistance[0], (a = this._boundingSphere[0].center).x = .5 * (n.x + r.x),
                    a.y = .5 * (n.y + r.y), a.z = .5 * (n.z + r.z), this._boundingSphere[0].radius = .5 * Math.sqrt(Math.pow(r.x - n.x, 2) + Math.pow(r.y - n.y, 2) + Math.pow(r.z - n.z, 2));
            }, e.calcSplitFrustum = function (t) {
                this._currentPSSM > 0 ? ze.createPerspective(3.1416 * t.fieldOfView / 180, t.aspectRatio, this._spiltDistance[this._currentPSSM - 1], this._spiltDistance[this._currentPSSM], this._tempMatrix44) : ze.createPerspective(3.1416 * t.fieldOfView / 180, t.aspectRatio, this._spiltDistance[0], this._spiltDistance[this._shadowMapCount], this._tempMatrix44),
                    ze.multiply(this._tempMatrix44, t.viewMatrix, this._tempMatrix44), this._splitFrustumCulling.matrix = this._tempMatrix44;
            }, e._rebuildRenderInfo = function () {
                var t = this._shadowMapCount + 1, e = 0;
                for (this.cameras.length = t, e = 0; e < t; e++) {
                    if (!this.cameras[e]) {
                        var i = new wn();
                        i.name = "lightCamera" + e, i.clearColor = new pt(1, 1, 1, 1), this.cameras[e] = i;
                    }
                    var n = this.cameras[e].renderTarget;
                    null != n && n.width == this._shadowMapTextureSize && n.height == this._shadowMapTextureSize || (n && n.destroy(),
                        (n = new mn(this._shadowMapTextureSize, this._shadowMapTextureSize, 1, 0)).filterMode = 0,
                        this.cameras[e].renderTarget = n);
                }
            }, e._calcLightViewProject = function (e) {
                var i = this._boundingSphere[this._currentPSSM], n = e.transform.worldMatrix;
                i.radius;
                i.center.cloneTo(this._tempLookAt3), gt.transformV3ToV4(this._tempLookAt3, n, this._tempLookAt4);
                var r = this._tempLookAt3, a = this._tempLookAt4;
                r.x = a.x, r.y = a.y, r.z = a.z;
                var s = this._tempLightUp;
                e.transform.worldMatrix.getForward(t._tempVector30);
                var o = t._tempVector30;
                s.x = o.x, s.y = 1, s.z = o.z, gt.normalize(this._tempLightUp, this._tempLightUp),
                    gt.scale(this._globalParallelLightDir, 4 * i.radius, this._tempPos), gt.subtract(this._tempLookAt3, this._tempPos, this._tempPos);
                var l = this.cameras[this._currentPSSM];
                l.transform.position = this._tempPos, l.transform.lookAt(this._tempLookAt3, this._tempLightUp, !1);
                var h = this._tempMax, u = this._tempMin;
                h.x = h.y = h.z = -1e5, h.w = 1, u.x = u.y = u.z = 1e5, u.w = 1, ze.multiply(l.viewMatrix, n, this._tempMatrix44);
                var c = this._tempValue, d = [];
                d.length = 8, this._boundingBox[this._currentPSSM].getCorners(d);
                for (var _ = 0; _ < 8; _++) {
                    var f = d[_];
                    c.x = f.x, c.y = f.y, c.z = f.z, c.w = 1, pt.transformByM4x4(this._tempValue, this._tempMatrix44, this._tempValue),
                        u.x = c.x < u.x ? c.x : u.x, u.y = c.y < u.y ? c.y : u.y, u.z = c.z < u.z ? c.z : u.z,
                        h.x = c.x > h.x ? c.x : h.x, h.y = c.y > h.y ? c.y : h.y, h.z = c.z > h.z ? c.z : h.z;
                }
                pt.add(this._tempMax, this._tempMin, this._tempValue), c.x *= .5, c.y *= .5, c.z *= .5,
                    c.w = 1, pt.transformByM4x4(this._tempValue, l.transform.worldMatrix, this._tempValue);
                var p = Math.abs(-this._tempMax.z), m = p > this._maxDistance ? p : this._maxDistance;
                gt.scale(this._globalParallelLightDir, m, this._tempPos);
                var g = this._tempPos;
                g.x = c.x - g.x, g.y = c.y - g.y, g.z = c.z - g.z, l.transform.position = this._tempPos,
                    l.transform.lookAt(this._tempLookAt3, this._tempLightUp, !1), ze.createOrthoOffCenter(u.x, h.x, u.y, h.y, 1, m + .5 * (h.z - u.z), l.projectionMatrix);
                var y = l.projectionViewMatrix;
                t.multiplyMatrixOutFloat32Array(this._tempScaleMatrix44, y, this._shaderValueVPs[this._currentPSSM]),
                    this._scene._shaderValues.setBuffer(Zi.SHADOWLIGHTVIEWPROJECT, this._shaderValueLightVP);
            }, e.setShadowMapTextureSize = function (t) {
                t !== this._shadowMapTextureSize && (this._shadowMapTextureSize = t, this._shadowPCFOffset.x = 1 / this._shadowMapTextureSize,
                    this._shadowPCFOffset.y = 1 / this._shadowMapTextureSize, this._statesDirty = !0);
            }, e.disposeAllRenderTarget = function () {
                for (var t = 0, e = this._shadowMapCount + 1; t < e; t++) this.cameras[t].renderTarget && (this.cameras[t].renderTarget.destroy(),
                    this.cameras[t].renderTarget = null);
            }, a(0, e, "shadowMapCount", function () {
                return this._shadowMapCount;
            }, function (t) {
                if (t = (t = t > 0 ? t : 1) <= 3 ? t : 3, this._shadowMapCount != t) {
                    this._shadowMapCount = t, this._ratioOfDistance = 1 / this._shadowMapCount, this._statesDirty = !0,
                        this._shaderValueLightVP = new Float32Array(16 * t), this._shaderValueVPs.length = t;
                    for (var e = 0; e < t; e++) this._shaderValueVPs[e] = new Float32Array(this._shaderValueLightVP.buffer, 64 * e);
                }
            }), t.multiplyMatrixOutFloat32Array = function (t, e, i) {
                var n, r, a, s, o, l, h;
                for (r = t.elements, a = e.elements, n = 0; n < 4; n++) s = r[n], o = r[n + 4],
                    l = r[n + 8], h = r[n + 12], i[n] = s * a[0] + o * a[1] + l * a[2] + h * a[3], i[n + 4] = s * a[4] + o * a[5] + l * a[6] + h * a[7],
                    i[n + 8] = s * a[8] + o * a[9] + l * a[10] + h * a[11], i[n + 12] = s * a[12] + o * a[13] + l * a[14] + h * a[15];
            }, t.MAX_PSSM_COUNT = 3, n(t, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }]), t;
        }(), Bt = (function () {
            function t() { }
            r(t, "laya.d3.resource.models.PrimitiveMesh"), t._createMesh = function (t, e, i) {
                var n = new Ui(), r = new ai(n), a = new Ke(4 * e.length, 35044, !0);
                a.vertexDeclaration = t, a.setData(e), n._vertexBuffers.push(a), n._vertexCount += a.vertexCount;
                var o = new Ze("ushort", i.length, 35044, !0);
                o.setData(i), n._indexBuffer = o;
                var l = s(1, null);
                l[0] = a, n._setBuffer(l, o), r._vertexBuffer = a, r._indexBuffer = o, r._indexStart = 0,
                    r._indexCount = o.indexCount;
                var h = r._subIndexBufferStart, u = r._subIndexBufferCount, c = r._boneIndicesList;
                h.length = 1, u.length = 1, c.length = 1, h[0] = 0, u[0] = o.indexCount;
                var d = [];
                d.push(r), n._setSubMeshes(d);
                var _ = a._byteLength + o._byteLength;
                return n._setCPUMemory(_), n._setGPUMemory(_), n;
            }, t.createBox = function (e, i, n) {
                void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === n && (n = 1);
                var r = bt.getVertexDeclaration("POSITION,NORMAL,UV"), a = e / 2, s = i / 2, o = n / 2, l = new Float32Array([-a, s, -o, 0, 1, 0, 0, 0, a, s, -o, 0, 1, 0, 1, 0, a, s, o, 0, 1, 0, 1, 1, -a, s, o, 0, 1, 0, 0, 1, -a, -s, -o, 0, -1, 0, 0, 1, a, -s, -o, 0, -1, 0, 1, 1, a, -s, o, 0, -1, 0, 1, 0, -a, -s, o, 0, -1, 0, 0, 0, -a, s, -o, -1, 0, 0, 0, 0, -a, s, o, -1, 0, 0, 1, 0, -a, -s, o, -1, 0, 0, 1, 1, -a, -s, -o, -1, 0, 0, 0, 1, a, s, -o, 1, 0, 0, 1, 0, a, s, o, 1, 0, 0, 0, 0, a, -s, o, 1, 0, 0, 0, 1, a, -s, -o, 1, 0, 0, 1, 1, -a, s, o, 0, 0, 1, 0, 0, a, s, o, 0, 0, 1, 1, 0, a, -s, o, 0, 0, 1, 1, 1, -a, -s, o, 0, 0, 1, 0, 1, -a, s, -o, 0, 0, -1, 1, 0, a, s, -o, 0, 0, -1, 0, 0, a, -s, -o, 0, 0, -1, 0, 1, -a, -s, -o, 0, 0, -1, 1, 1]), h = new Uint16Array([0, 1, 2, 2, 3, 0, 4, 7, 6, 6, 5, 4, 8, 9, 10, 10, 11, 8, 12, 15, 14, 14, 13, 12, 16, 17, 18, 18, 19, 16, 20, 23, 22, 22, 21, 20]);
                return t._createMesh(r, l, h);
            }, t.createCapsule = function (e, i, n, r) {
                void 0 === e && (e = .5), void 0 === i && (i = 2), void 0 === n && (n = 16), void 0 === r && (r = 32);
                var a = (n + 1) * (r + 1) * 2 + 2 * (r + 1), s = 3 * n * (r + 1) * 2 * 2 + 2 * r * 3, o = bt.getVertexDeclaration("POSITION,NORMAL,UV"), l = o.vertexStride / 4, h = new Float32Array(a * l), u = new Uint16Array(s), c = Math.PI / 2 / n, d = 2 * Math.PI / r, _ = i / 2 - e, f = 0, p = 0, m = 0, g = 0, y = 0, v = 0, S = 0, T = 0;
                for (S = 0; S <= n; S++) for (T = 0; T <= r; T++) f = e * Math.cos(S * c) * Math.cos(T * d + Math.PI),
                    p = e * Math.sin(S * c), m = e * Math.cos(S * c) * Math.sin(T * d + Math.PI), h[g++] = f,
                    h[g++] = p + _, h[g++] = m, h[g++] = f, h[g++] = p, h[g++] = m, h[g++] = 1 - T / r,
                    h[g++] = (1 - S / n) * (Math.PI * e / 2 / (i + Math.PI * e)), S < n && (u[y++] = S * (r + 1) + T + (r + 1),
                        u[y++] = S * (r + 1) + T, u[y++] = S * (r + 1) + T + 1, u[y++] = S * (r + 1) + T + r,
                        u[y++] = S * (r + 1) + T, u[y++] = S * (r + 1) + T + (r + 1));
                for (v += (n + 1) * (r + 1), S = 0; S <= n; S++) for (T = 0; T <= r; T++) f = e * Math.cos(S * c) * Math.cos(T * d + Math.PI),
                    p = e * Math.sin(-S * c), m = e * Math.cos(S * c) * Math.sin(T * d + Math.PI), h[g++] = f,
                    h[g++] = p - _, h[g++] = m, h[g++] = f, h[g++] = p, h[g++] = m, h[g++] = 1 - T / r,
                    h[g++] = (S / n * (Math.PI * e / 2) + (i + Math.PI * e / 2)) / (i + Math.PI * e),
                    S < n && (u[y++] = v + S * (r + 1) + T, u[y++] = v + S * (r + 1) + T + (r + 1),
                        u[y++] = v + S * (r + 1) + T + 1, u[y++] = v + S * (r + 1) + T, u[y++] = v + S * (r + 1) + T + r,
                        u[y++] = v + S * (r + 1) + T + (r + 1));
                for (v += (n + 1) * (r + 1), T = 0; T <= r; T++) f = e * Math.cos(T * d + Math.PI),
                    p = _, m = e * Math.sin(T * d + Math.PI), h[g++] = f, h[g + 8 * (r + 1) - 1] = f,
                    h[g++] = p, h[g + 8 * (r + 1) - 1] = -p, h[g++] = m, h[g + 8 * (r + 1) - 1] = m,
                    h[g++] = f, h[g + 8 * (r + 1) - 1] = f, h[g++] = 0, h[g + 8 * (r + 1) - 1] = 0,
                    h[g++] = m, h[g + 8 * (r + 1) - 1] = m, h[g++] = 1 - 1 * T / r, h[g + 8 * (r + 1) - 1] = 1 - 1 * T / r,
                    h[g++] = Math.PI * e / 2 / (i + Math.PI * e), h[g + 8 * (r + 1) - 1] = (Math.PI * e / 2 + i) / (i + Math.PI * e);
                for (T = 0; T < r; T++) u[y++] = T + v + (r + 1), u[y++] = T + v + 1, u[y++] = T + v,
                    u[y++] = T + v + (r + 1), u[y++] = T + v + (r + 1) + 1, u[y++] = T + v + 1;
                return v += 2 * (r + 1), t._createMesh(o, h, u);
            }, t.createCone = function (e, i, n) {
                void 0 === e && (e = .5), void 0 === i && (i = 1), void 0 === n && (n = 32);
                for (var r = n + 1 + 1 + 2 * (n + 1), a = 6 * n + 3 * n, s = bt.getVertexDeclaration("POSITION,NORMAL,UV"), o = s.vertexStride / 4, l = new Float32Array(r * o), h = new Uint16Array(a), u = 2 * Math.PI / n, c = i / 2, d = 0, _ = 0, f = 0, p = 0, m = 0, g = new gt(), y = new gt(0, -1, 0), v = new gt(0, c, 0), S = new gt(), T = new gt(), E = new ht(), C = new gt(), x = NaN, b = 0, I = 0, w = 0; w <= n; w++) d = w * u,
                    f = Math.cos(d + Math.PI) * e, p = c, m = Math.sin(d + Math.PI) * e, l[b++] = 0,
                    l[b + 8 * (n + 1) - 1] = f, l[b++] = p, l[b + 8 * (n + 1) - 1] = -p, l[b++] = 0,
                    l[b + 8 * (n + 1) - 1] = m, g.x = f, g.y = 0, g.z = m, S.x = f, S.y = -p, S.z = m,
                    gt.subtract(S, v, T), gt.normalize(T, T), x = Math.acos(gt.dot(y, T)), gt.cross(y, T, C),
                    gt.normalize(C, C), ht.createFromAxisAngle(C, x, E), gt.normalize(g, g), gt.transformQuat(g, E, g),
                    gt.normalize(g, g), l[b++] = g.x, l[b + 8 * (n + 1) - 1] = g.x, l[b++] = g.y, l[b + 8 * (n + 1) - 1] = g.y,
                    l[b++] = g.z, l[b + 8 * (n + 1) - 1] = g.z, l[b++] = 1 - 1 * w / n, l[b + 8 * (n + 1) - 1] = 1 - 1 * w / n,
                    l[b++] = 0, l[b + 8 * (n + 1) - 1] = 1;
                b += 8 * (n + 1);
                for (var A = 0; A < n; A++) h[I++] = A + _ + (n + 1), h[I++] = A + _ + 1, h[I++] = A + _,
                    h[I++] = A + _ + (n + 1), h[I++] = A + _ + (n + 1) + 1, h[I++] = A + _ + 1;
                _ += 2 * (n + 1);
                for (var R = 0; R <= n; R++) 0 === R && (l[b++] = 0, l[b++] = -c, l[b++] = 0, l[b++] = 0,
                    l[b++] = -1, l[b++] = 0, l[b++] = .5, l[b++] = .5), d = R * u, f = Math.cos(d + Math.PI) * e,
                    p = -c, m = Math.sin(d + Math.PI) * e, l[b++] = f, l[b++] = p, l[b++] = m, l[b++] = 0,
                    l[b++] = -1, l[b++] = 0, l[b++] = .5 + .5 * Math.cos(d), l[b++] = .5 + .5 * Math.sin(d);
                for (var M = 0; M < n; M++) h[I++] = 0 + _, h[I++] = M + 2 + _, h[I++] = M + 1 + _;
                return _ += n + 1 + 1, t._createMesh(s, l, h);
            }, t.createCylinder = function (e, i, n) {
                void 0 === e && (e = .5), void 0 === i && (i = 2), void 0 === n && (n = 32);
                for (var r = n + 1 + 1 + 2 * (n + 1) + (n + 1 + 1), a = 3 * n + 6 * n + 3 * n, s = bt.getVertexDeclaration("POSITION,NORMAL,UV"), o = s.vertexStride / 4, l = new Float32Array(r * o), h = new Uint16Array(a), u = 2 * Math.PI / n, c = i / 2, d = 0, _ = 0, f = 0, p = 0, m = 0, g = 0, y = 0, v = 0; v <= n; v++) 0 === v && (l[g++] = 0,
                    l[g++] = c, l[g++] = 0, l[g++] = 0, l[g++] = 1, l[g++] = 0, l[g++] = .5, l[g++] = .5),
                    d = v * u, f = Math.cos(d) * e, p = c, m = Math.sin(d) * e, l[g++] = f, l[g++] = p,
                    l[g++] = m, l[g++] = 0, l[g++] = 1, l[g++] = 0, l[g++] = .5 + .5 * Math.cos(d),
                    l[g++] = .5 + .5 * Math.sin(d);
                for (var S = 0; S < n; S++) h[y++] = 0, h[y++] = S + 1, h[y++] = S + 2;
                _ += n + 1 + 1;
                for (var T = 0; T <= n; T++) d = T * u, f = Math.cos(d + Math.PI) * e, p = c, m = Math.sin(d + Math.PI) * e,
                    l[g++] = f, l[g + 8 * (n + 1) - 1] = f, l[g++] = p, l[g + 8 * (n + 1) - 1] = -p,
                    l[g++] = m, l[g + 8 * (n + 1) - 1] = m, l[g++] = f, l[g + 8 * (n + 1) - 1] = f,
                    l[g++] = 0, l[g + 8 * (n + 1) - 1] = 0, l[g++] = m, l[g + 8 * (n + 1) - 1] = m,
                    l[g++] = 1 - 1 * T / n, l[g + 8 * (n + 1) - 1] = 1 - 1 * T / n, l[g++] = 0, l[g + 8 * (n + 1) - 1] = 1;
                g += 8 * (n + 1);
                for (var E = 0; E < n; E++) h[y++] = E + _ + (n + 1), h[y++] = E + _ + 1, h[y++] = E + _,
                    h[y++] = E + _ + (n + 1), h[y++] = E + _ + (n + 1) + 1, h[y++] = E + _ + 1;
                _ += 2 * (n + 1);
                for (var C = 0; C <= n; C++) 0 === C && (l[g++] = 0, l[g++] = -c, l[g++] = 0, l[g++] = 0,
                    l[g++] = -1, l[g++] = 0, l[g++] = .5, l[g++] = .5), d = C * u, f = Math.cos(d + Math.PI) * e,
                    p = -c, m = Math.sin(d + Math.PI) * e, l[g++] = f, l[g++] = p, l[g++] = m, l[g++] = 0,
                    l[g++] = -1, l[g++] = 0, l[g++] = .5 + .5 * Math.cos(d), l[g++] = .5 + .5 * Math.sin(d);
                for (var x = 0; x < n; x++) h[y++] = 0 + _, h[y++] = x + 2 + _, h[y++] = x + 1 + _;
                return _ += n + 1 + 1, t._createMesh(s, l, h);
            }, t.createPlane = function (e, i, n, r) {
                void 0 === e && (e = 10), void 0 === i && (i = 10), void 0 === n && (n = 10), void 0 === r && (r = 10);
                for (var a = (n + 1) * (r + 1), s = new Uint16Array(n * r * 2 * 3), o = bt.getVertexDeclaration("POSITION,NORMAL,UV"), l = o.vertexStride / 4, h = new Float32Array(a * l), u = e / 2, c = i / 2, d = e / n, _ = i / r, f = 0, p = 0; p <= r; p++) for (var m = 0; m <= n; m++) h[f++] = m * d - u,
                    h[f++] = 0, h[f++] = p * _ - c, h[f++] = 0, h[f++] = 1, h[f++] = 0, h[f++] = 1 * m / n,
                    h[f++] = 1 * p / r;
                var g = 0;
                for (p = 0; p < r; p++) for (m = 0; m < n; m++) s[g++] = (p + 1) * (n + 1) + m,
                    s[g++] = p * (n + 1) + m, s[g++] = (p + 1) * (n + 1) + m + 1, s[g++] = p * (n + 1) + m,
                    s[g++] = p * (n + 1) + m + 1, s[g++] = (p + 1) * (n + 1) + m + 1;
                return t._createMesh(o, h, s);
            }, t.createQuad = function (e, i) {
                void 0 === e && (e = 1), void 0 === i && (i = 1);
                var n = bt.getVertexDeclaration("POSITION,NORMAL,UV"), r = (n.vertexStride, e / 2), a = i / 2, s = new Float32Array([-r, a, 0, 0, 0, 1, 0, 0, r, a, 0, 0, 0, 1, 1, 0, -r, -a, 0, 0, 0, 1, 0, 1, r, -a, 0, 0, 0, 1, 1, 1]), o = new Uint16Array([0, 1, 2, 3, 2, 1]);
                return t._createMesh(n, s, o);
            }, t.createSphere = function (e, i, n) {
                void 0 === e && (e = .5), void 0 === i && (i = 32), void 0 === n && (n = 32);
                var r = (i + 1) * (n + 1), a = 3 * i * (n + 1) * 2, s = new Uint16Array(a), o = bt.getVertexDeclaration("POSITION,NORMAL,UV"), l = o.vertexStride / 4, h = new Float32Array(r * l), u = Math.PI / i, c = 2 * Math.PI / n, d = 0;
                r = 0, a = 0;
                for (var _ = 0; _ < i + 1; _++) for (var f = Math.sin(_ * u), p = Math.cos(_ * u), m = 0; m < n + 1; m++) {
                    var g = f * Math.sin(m * c + 1 * Math.PI / 2), y = f * Math.cos(m * c + 1 * Math.PI / 2);
                    h[r + 0] = g * e, h[r + 1] = p * e, h[r + 2] = y * e, h[r + 3] = g, h[r + 4] = p,
                        h[r + 5] = y, h[r + 6] = m / n, h[r + 7] = _ / i, r += l, _ != i - 1 && (s[a++] = d + (n + 1),
                            s[a++] = d, s[a++] = d + 1, s[a++] = d + n, s[a++] = d, s[a++] = d + (n + 1), d++);
                }
                return t._createMesh(o, h, s);
            };
        }(), function () {
            function t() { }
            return r(t, "laya.d3.core.render.PostProcessEffect"), t.prototype.render = function (t) { },
                t;
        }()), Ft = function () {
            function t() { }
            return r(t, "laya.d3.animation.AnimationClipParser04"), t.READ_DATA = function () {
                t._DATA.offset = t._reader.getUint32(), t._DATA.size = t._reader.getUint32();
            }, t.READ_BLOCK = function () {
                for (var e = t._BLOCK.count = t._reader.getUint16(), i = t._BLOCK.blockStarts = [], n = t._BLOCK.blockLengths = [], r = 0; r < e; r++) i.push(t._reader.getUint32()),
                    n.push(t._reader.getUint32());
            }, t.READ_STRINGS = function () {
                var e = t._reader.getUint32(), i = t._reader.getUint16(), n = t._reader.pos;
                t._reader.pos = e + t._DATA.offset;
                for (var r = 0; r < i; r++) t._strings[r] = t._reader.readUTFString();
                t._reader.pos = n;
            }, t.parse = function (e, i, n) {
                t._animationClip = e, t._reader = i, t._version = n, t.READ_DATA(), t.READ_BLOCK(),
                    t.READ_STRINGS();
                for (var r = 0, a = t._BLOCK.count; r < a; r++) {
                    var s = i.getUint16(), o = t._strings[s], l = t["READ_" + o];
                    if (null == l) throw new Error("model file err,no this function:" + s + " " + o);
                    l.call(null);
                }
                t._version = null, t._reader = null, t._animationClip = null;
            }, t.READ_ANIMATIONS = function () {
                var e, i = 0, n = 0, r = t._reader, a = (r.__getBuffer(), []), s = r.getUint16();
                for (a.length = s, i = 0; i < s; i++) a[i] = r.getFloat32();
                var o = t._animationClip;
                o.name = t._strings[r.getUint16()];
                var l = o._duration = r.getFloat32();
                o.islooping = !!r.getByte(), o._frameRate = r.getInt16();
                var h = r.getInt16(), u = o._nodes;
                u.count = h;
                var c = o._nodesMap = {}, d = o._nodesDic = {};
                for (i = 0; i < h; i++) {
                    e = new Te(), u.setNodeByIndex(i, e), e._indexInList = i;
                    var _ = e.type = r.getUint8(), f = r.getUint16();
                    for (e._setOwnerPathCount(f), n = 0; n < f; n++) e._setOwnerPathByIndex(n, t._strings[r.getUint16()]);
                    var p = e._joinOwnerPath("/"), m = c[p];
                    m || (c[p] = m = []), m.push(e), e.propertyOwner = t._strings[r.getUint16()];
                    var g = r.getUint16();
                    for (e._setPropertyCount(g), n = 0; n < g; n++) e._setPropertyByIndex(n, t._strings[r.getUint16()]);
                    var y = p + "." + e.propertyOwner + "." + e._joinProperty(".");
                    d[y] = e, e.fullPath = y;
                    var v = r.getUint16();
                    e._setKeyframeCount(v);
                    switch (_) {
                        case 0:
                            break;

                        case 1:
                        case 3:
                        case 4:
                            e.data = I.supportWebGLPlusAnimation ? new G() : new gt();
                            break;

                        case 2:
                            e.data = I.supportWebGLPlusAnimation ? new V() : new ht();
                            break;

                        default:
                            throw "AnimationClipParser04:unknown type.";
                    }
                    switch (t._version) {
                        case "LAYAANIMATION:04":
                            for (n = 0; n < v; n++) switch (_) {
                                case 0:
                                    var S = new mi();
                                    e._setKeyframeByIndex(n, S), S.time = a[r.getUint16()], S.inTangent = r.getFloat32(),
                                        S.outTangent = r.getFloat32(), S.value = r.getFloat32();
                                    break;

                                case 1:
                                case 3:
                                case 4:
                                    var T = new Ai();
                                    if (e._setKeyframeByIndex(n, T), T.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                        for (var E = T.data = new Float32Array(9), C = 0; C < 3; C++) E[C] = r.getFloat32();
                                        for (C = 0; C < 3; C++) E[3 + C] = r.getFloat32();
                                        for (C = 0; C < 3; C++) E[6 + C] = r.getFloat32();
                                    } else {
                                        var x = T.inTangent, b = T.outTangent, w = T.value;
                                        x.x = r.getFloat32(), x.y = r.getFloat32(), x.z = r.getFloat32(), b.x = r.getFloat32(),
                                            b.y = r.getFloat32(), b.z = r.getFloat32(), w.x = r.getFloat32(), w.y = r.getFloat32(),
                                            w.z = r.getFloat32();
                                    }
                                    break;

                                case 2:
                                    var A = new Oi();
                                    if (e._setKeyframeByIndex(n, A), A.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                        for (E = A.data = new Float32Array(12), C = 0; C < 4; C++) E[C] = r.getFloat32();
                                        for (C = 0; C < 4; C++) E[4 + C] = r.getFloat32();
                                        for (C = 0; C < 4; C++) E[8 + C] = r.getFloat32();
                                    } else {
                                        var R = A.inTangent, M = A.outTangent, D = A.value;
                                        R.x = r.getFloat32(), R.y = r.getFloat32(), R.z = r.getFloat32(), R.w = r.getFloat32(),
                                            M.x = r.getFloat32(), M.y = r.getFloat32(), M.z = r.getFloat32(), M.w = r.getFloat32(),
                                            D.x = r.getFloat32(), D.y = r.getFloat32(), D.z = r.getFloat32(), D.w = r.getFloat32();
                                    }
                                    break;

                                default:
                                    throw "AnimationClipParser04:unknown type.";
                            }
                            break;

                        case "LAYAANIMATION:COMPRESSION_04":
                            for (n = 0; n < v; n++) switch (_) {
                                case 0:
                                    S = new mi(), e._setKeyframeByIndex(n, S), S.time = a[r.getUint16()], S.inTangent = Rt.convertToNumber(r.getUint16()),
                                        S.outTangent = Rt.convertToNumber(r.getUint16()), S.value = Rt.convertToNumber(r.getUint16());
                                    break;

                                case 1:
                                case 3:
                                case 4:
                                    if (T = new Ai(), e._setKeyframeByIndex(n, T), T.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                        for (E = T.data = new Float32Array(9), C = 0; C < 3; C++) E[C] = Rt.convertToNumber(r.getUint16());
                                        for (C = 0; C < 3; C++) E[3 + C] = Rt.convertToNumber(r.getUint16());
                                        for (C = 0; C < 3; C++) E[6 + C] = Rt.convertToNumber(r.getUint16());
                                    } else x = T.inTangent, b = T.outTangent, w = T.value, x.x = Rt.convertToNumber(r.getUint16()),
                                        x.y = Rt.convertToNumber(r.getUint16()), x.z = Rt.convertToNumber(r.getUint16()),
                                        b.x = Rt.convertToNumber(r.getUint16()), b.y = Rt.convertToNumber(r.getUint16()),
                                        b.z = Rt.convertToNumber(r.getUint16()), w.x = Rt.convertToNumber(r.getUint16()),
                                        w.y = Rt.convertToNumber(r.getUint16()), w.z = Rt.convertToNumber(r.getUint16());
                                    break;

                                case 2:
                                    if (A = new Oi(), e._setKeyframeByIndex(n, A), A.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                        for (E = A.data = new Float32Array(12), C = 0; C < 4; C++) E[C] = Rt.convertToNumber(r.getUint16());
                                        for (C = 0; C < 4; C++) E[4 + C] = Rt.convertToNumber(r.getUint16());
                                        for (C = 0; C < 4; C++) E[8 + C] = Rt.convertToNumber(r.getUint16());
                                    } else R = A.inTangent, M = A.outTangent, D = A.value, R.x = Rt.convertToNumber(r.getUint16()),
                                        R.y = Rt.convertToNumber(r.getUint16()), R.z = Rt.convertToNumber(r.getUint16()),
                                        R.w = Rt.convertToNumber(r.getUint16()), M.x = Rt.convertToNumber(r.getUint16()),
                                        M.y = Rt.convertToNumber(r.getUint16()), M.z = Rt.convertToNumber(r.getUint16()),
                                        M.w = Rt.convertToNumber(r.getUint16()), D.x = Rt.convertToNumber(r.getUint16()),
                                        D.y = Rt.convertToNumber(r.getUint16()), D.z = Rt.convertToNumber(r.getUint16()),
                                        D.w = Rt.convertToNumber(r.getUint16());
                                    break;

                                default:
                                    throw "AnimationClipParser04:unknown type.";
                            }
                    }
                }
                var O = r.getUint16();
                for (i = 0; i < O; i++) {
                    var L, P = new ne();
                    P.time = Math.min(l, r.getFloat32()), P.eventName = t._strings[r.getUint16()];
                    var N = r.getUint16();
                    for (N > 0 && (P.params = L = []), n = 0; n < N; n++) {
                        switch (r.getByte()) {
                            case 0:
                                L.push(!!r.getByte());
                                break;

                            case 1:
                                L.push(r.getInt32());
                                break;

                            case 2:
                                L.push(r.getFloat32());
                                break;

                            case 3:
                                L.push(t._strings[r.getUint16()]);
                                break;

                            default:
                                throw new Error("unknown type.");
                        }
                    }
                    o.addEvent(P);
                }
            }, t._animationClip = null, t._reader = null, t._strings = [], t._version = null,
                n(t, ["_BLOCK", function () {
                    return this._BLOCK = {
                        count: 0
                    };
                }, "_DATA", function () {
                    return this._DATA = {
                        offset: 0,
                        size: 0
                    };
                }]), t;
        }(), kt = function () {
            function t() { }
            return r(t, "laya.d3.animation.AnimationClipParser03"), t.READ_DATA = function () {
                t._DATA.offset = t._reader.getUint32(), t._DATA.size = t._reader.getUint32();
            }, t.READ_BLOCK = function () {
                for (var e = t._BLOCK.count = t._reader.getUint16(), i = t._BLOCK.blockStarts = [], n = t._BLOCK.blockLengths = [], r = 0; r < e; r++) i.push(t._reader.getUint32()),
                    n.push(t._reader.getUint32());
            }, t.READ_STRINGS = function () {
                var e = t._reader.getUint32(), i = t._reader.getUint16(), n = t._reader.pos;
                t._reader.pos = e + t._DATA.offset;
                for (var r = 0; r < i; r++) t._strings[r] = t._reader.readUTFString();
                t._reader.pos = n;
            }, t.parse = function (e, i) {
                t._animationClip = e, t._reader = i;
                i.__getBuffer();
                t.READ_DATA(), t.READ_BLOCK(), t.READ_STRINGS();
                for (var n = 0, r = t._BLOCK.count; n < r; n++) {
                    var a = i.getUint16(), s = t._strings[a], o = t["READ_" + s];
                    if (null == o) throw new Error("model file err,no this function:" + a + " " + s);
                    o.call(null);
                }
            }, t.READ_ANIMATIONS = function () {
                var e, i = 0, n = 0, r = t._reader, a = (r.__getBuffer(), []), s = r.getUint16();
                for (a.length = s, i = 0; i < s; i++) a[i] = r.getFloat32();
                var o = t._animationClip;
                o.name = t._strings[r.getUint16()];
                var l = o._duration = r.getFloat32();
                o.islooping = !!r.getByte(), o._frameRate = r.getInt16();
                var h = r.getInt16(), u = o._nodes;
                u.count = h;
                var c = o._nodesMap = {}, d = o._nodesDic = {};
                for (i = 0; i < h; i++) {
                    e = new Te(), u.setNodeByIndex(i, e), e._indexInList = i;
                    var _ = e.type = r.getUint8(), f = r.getUint16();
                    for (e._setOwnerPathCount(f), n = 0; n < f; n++) e._setOwnerPathByIndex(n, t._strings[r.getUint16()]);
                    var p = e._joinOwnerPath("/"), m = c[p];
                    m || (c[p] = m = []), m.push(e), e.propertyOwner = t._strings[r.getUint16()];
                    var g = r.getUint16();
                    for (e._setPropertyCount(g), n = 0; n < g; n++) e._setPropertyByIndex(n, t._strings[r.getUint16()]);
                    var y = p + "." + e.propertyOwner + "." + e._joinProperty(".");
                    d[y] = e, e.fullPath = y;
                    var v = r.getUint16();
                    e._setKeyframeCount(v);
                    switch (_) {
                        case 0:
                            break;

                        case 1:
                        case 3:
                        case 4:
                            e.data = I.supportWebGLPlusAnimation ? new G() : new gt();
                            break;

                        case 2:
                            e.data = I.supportWebGLPlusAnimation ? new V() : new ht();
                            break;

                        default:
                            throw "AnimationClipParser03:unknown type.";
                    }
                    for (n = 0; n < v; n++) switch (_) {
                        case 0:
                            var S = new mi();
                            e._setKeyframeByIndex(n, S), S.time = a[r.getUint16()], S.inTangent = r.getFloat32(),
                                S.outTangent = r.getFloat32(), S.value = r.getFloat32();
                            break;

                        case 1:
                        case 3:
                        case 4:
                            var T = new Ai();
                            if (e._setKeyframeByIndex(n, T), T.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                for (var E = T.data = new Float32Array(9), C = 0; C < 3; C++) E[C] = r.getFloat32();
                                for (C = 0; C < 3; C++) E[3 + C] = r.getFloat32();
                                for (C = 0; C < 3; C++) E[6 + C] = r.getFloat32();
                            } else {
                                var x = T.inTangent, b = T.outTangent, w = T.value;
                                x.x = r.getFloat32(), x.y = r.getFloat32(), x.z = r.getFloat32(), b.x = r.getFloat32(),
                                    b.y = r.getFloat32(), b.z = r.getFloat32(), w.x = r.getFloat32(), w.y = r.getFloat32(),
                                    w.z = r.getFloat32();
                            }
                            break;

                        case 2:
                            var A = new Oi();
                            if (e._setKeyframeByIndex(n, A), A.time = a[r.getUint16()], I.supportWebGLPlusAnimation) {
                                for (E = A.data = new Float32Array(12), C = 0; C < 4; C++) E[C] = r.getFloat32();
                                for (C = 0; C < 4; C++) E[4 + C] = r.getFloat32();
                                for (C = 0; C < 4; C++) E[8 + C] = r.getFloat32();
                            } else {
                                var R = A.inTangent, M = A.outTangent, D = A.value;
                                R.x = r.getFloat32(), R.y = r.getFloat32(), R.z = r.getFloat32(), R.w = r.getFloat32(),
                                    M.x = r.getFloat32(), M.y = r.getFloat32(), M.z = r.getFloat32(), M.w = r.getFloat32(),
                                    D.x = r.getFloat32(), D.y = r.getFloat32(), D.z = r.getFloat32(), D.w = r.getFloat32();
                            }
                            break;

                        default:
                            throw "AnimationClipParser03:unknown type.";
                    }
                }
                var O = r.getUint16();
                for (i = 0; i < O; i++) {
                    var L, P = new ne();
                    P.time = Math.min(l, r.getFloat32()), P.eventName = t._strings[r.getUint16()];
                    var N = r.getUint16();
                    for (N > 0 && (P.params = L = []), n = 0; n < N; n++) {
                        switch (r.getByte()) {
                            case 0:
                                L.push(!!r.getByte());
                                break;

                            case 1:
                                L.push(r.getInt32());
                                break;

                            case 2:
                                L.push(r.getFloat32());
                                break;

                            case 3:
                                L.push(t._strings[r.getUint16()]);
                                break;

                            default:
                                throw new Error("unknown type.");
                        }
                    }
                    o.addEvent(P);
                }
            }, t._animationClip = null, t._reader = null, t._strings = [], n(t, ["_BLOCK", function () {
                return this._BLOCK = {
                    count: 0
                };
            }, "_DATA", function () {
                return this._DATA = {
                    offset: 0,
                    size: 0
                };
            }]), t;
        }(), Vt = function () {
            function t() {
                this.value = 0;
            }
            r(t, "laya.d3.shader.DefineDatas");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.add = function (t) {
                this.value |= t;
            }, e.remove = function (t) {
                this.value &= ~t;
            }, e.has = function (t) {
                return (this.value & t) > 0;
            }, e.cloneTo = function (t) {
                t.value = this.value;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t;
        }(), Ut = function () {
            function t(t, e, i) {
                this.offset = 0, this.elementFormat = null, this.elementUsage = 0, this.offset = t,
                    this.elementFormat = e, this.elementUsage = i;
            }
            return r(t, "laya.d3.graphics.VertexElement"), t;
        }(), Gt = function () {
            function t(t, e, i, n) {
                this._datas = null, this._w = 0, this._h = 0, this._minHeight = NaN, this._maxHeight = NaN,
                    this._datas = [], this._w = t, this._h = e, this._minHeight = i, this._maxHeight = n;
            }
            r(t, "laya.d3.core.HeightMap");
            var e = t.prototype;
            return e._inBounds = function (t, e) {
                return t >= 0 && t < this._h && e >= 0 && e < this._w;
            }, e.getHeight = function (t, e) {
                return this._inBounds(t, e) ? this._datas[t][e] : NaN;
            }, a(0, e, "width", function () {
                return this._w;
            }), a(0, e, "height", function () {
                return this._h;
            }), a(0, e, "maxHeight", function () {
                return this._maxHeight;
            }), a(0, e, "minHeight", function () {
                return this._minHeight;
            }), t.creatFromMesh = function (e, i, n, r) {
                for (var a = [], s = [], o = e.subMeshCount, l = 0; l < o; l++) {
                    for (var h = e._getSubMesh(l), u = h._vertexBuffer, c = u.getData(), d = [], _ = 0; _ < c.length; _ += u.vertexDeclaration.vertexStride / 4) {
                        var f = new gt(c[_ + 0], c[_ + 1], c[_ + 2]);
                        d.push(f);
                    }
                    a.push(d);
                    var p = h._indexBuffer;
                    s.push(p.getData());
                }
                var m = e.bounds, g = m.getMin().x, y = m.getMin().z, v = m.getMax().x, S = m.getMax().z, T = m.getMin().y, E = m.getMax().y, C = v - g, x = S - y, b = r.x = C / (i - 1), I = r.y = x / (n - 1), w = new t(i, n, T, E), A = t._tempRay, R = A.direction;
                R.x = 0, R.y = -1, R.z = 0;
                var M = E + .1;
                A.origin.y = M;
                for (var D = 0; D < n; D++) {
                    var O = y + D * I;
                    w._datas[D] = [];
                    for (var L = 0; L < i; L++) {
                        var P = g + L * b, N = A.origin;
                        N.x = P, N.z = O;
                        var B = t._getPosition(A, a, s);
                        w._datas[D][L] = B === Number.MAX_VALUE ? NaN : M - B;
                    }
                }
                return w;
            }, t.createFromImage = function (e, i, n) {
                for (var r = e.width, a = e.height, s = new t(r, a, i, n), o = (n - i) / 254, l = e.getPixels(), h = 0, u = 0; u < a; u++) for (var c = s._datas[u] = [], d = 0; d < r; d++) {
                    var _ = l[h++], f = l[h++], p = l[h++], m = l[h++];
                    c[d] = 255 == _ && 255 == f && 255 == p && 255 == m ? NaN : (_ + f + p) / 3 * o + i;
                }
                return s;
            }, t._getPosition = function (t, e, i) {
                for (var n = Number.MAX_VALUE, r = 0; r < e.length; r++) for (var a = e[r], s = i[r], o = 0; o < s.length; o += 3) {
                    var l = a[s[o + 0]], h = a[s[o + 1]], u = a[s[o + 2]], c = ce.rayIntersectsTriangle(t, l, h, u);
                    !isNaN(c) && c < n && (n = c);
                }
                return n;
            }, n(t, ["_tempRay", function () {
                return this._tempRay = new q(new gt(), new gt());
            }]), t;
        }(), zt = function () {
            function t() { }
            return r(t, "laya.d3.shader.ShaderInit3D"), t.__init__ = function () {
                var e, i;
                t._rangeAttenTex = Ht._buildTexture2D(1024, 1, 2, Ot.lightAttenTexture), t._rangeAttenTex.wrapModeU = 1,
                    t._rangeAttenTex.wrapModeV = 1, t._rangeAttenTex.lock = !0, Lt.SHADERDEFINE_HIGHPRECISION = Lt.registerPublicDefine("HIGHPRECISION"),
                    Zi.SHADERDEFINE_FOG = Lt.registerPublicDefine("FOG"), Zi.SHADERDEFINE_DIRECTIONLIGHT = Lt.registerPublicDefine("DIRECTIONLIGHT"),
                    Zi.SHADERDEFINE_POINTLIGHT = Lt.registerPublicDefine("POINTLIGHT"), Zi.SHADERDEFINE_SPOTLIGHT = Lt.registerPublicDefine("SPOTLIGHT"),
                    Zi.SHADERDEFINE_CAST_SHADOW = Lt.registerPublicDefine("CASTSHADOW"), Zi.SHADERDEFINE_SHADOW_PSSM1 = Lt.registerPublicDefine("SHADOWMAP_PSSM1"),
                    Zi.SHADERDEFINE_SHADOW_PSSM2 = Lt.registerPublicDefine("SHADOWMAP_PSSM2"), Zi.SHADERDEFINE_SHADOW_PSSM3 = Lt.registerPublicDefine("SHADOWMAP_PSSM3"),
                    Zi.SHADERDEFINE_SHADOW_PCF_NO = Lt.registerPublicDefine("SHADOWMAP_PCF_NO"), Zi.SHADERDEFINE_SHADOW_PCF1 = Lt.registerPublicDefine("SHADOWMAP_PCF1"),
                    Zi.SHADERDEFINE_SHADOW_PCF2 = Lt.registerPublicDefine("SHADOWMAP_PCF2"), Zi.SHADERDEFINE_SHADOW_PCF3 = Lt.registerPublicDefine("SHADOWMAP_PCF3"),
                    Zi.SHADERDEFINE_REFLECTMAP = Lt.registerPublicDefine("REFLECTMAP"), Lt.addInclude("Lighting.glsl", "\nstruct DirectionLight {\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nstruct PointLight {\n\tvec3 Color;\n\tvec3 Position;\n\tfloat Range;\n};\n\nstruct SpotLight {\n\tvec3 Color;\n\tvec3 Position;\n\tvec3 Direction;\n\tfloat Spot;\n\tfloat Range;\n};\n\n// Laya中使用衰减纹理\nfloat LayaAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat fRatio = clamp(length(L) * invLightRadius,0.0,1.0);\n\tfRatio *= fRatio;\n\treturn 1.0 / (1.0 + 25.0 * fRatio)* clamp(4.0*(1.0 - fRatio),0.0,1.0); //fade to black as if 4 pixel texture\n}\n\n// Same as Just Cause 2 and Crysis 2 (you can read GPU Pro 1 book for more information)\nfloat BasicAttenuation(in vec3 L,in float invLightRadius) {\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = clamp(1.0 - dot(distance, distance),0.0,1.0); // Equals float attenuation = saturate(1.0f - dot(L, L) / (lightRadius *  lightRadius));\n\treturn attenuation * attenuation;\n}\n\n// Inspired on http://fools.slindev.com/viewtopic.php?f=11&t=21&view=unread#unread\nfloat NaturalAttenuation(in vec3 L,in float invLightRadius) {\n\tfloat attenuationFactor = 30.0;\n\tvec3 distance = L * invLightRadius;\n\tfloat attenuation = dot(distance, distance); // Equals float attenuation = dot(L, L) / (lightRadius *  lightRadius);\n\tattenuation = 1.0 / (attenuation * attenuationFactor + 1.0);\n\t// Second we move down the function therewith it reaches zero at abscissa 1:\n\tattenuationFactor = 1.0 / (attenuationFactor + 1.0); //attenuationFactor contains now the value we have to subtract\n\tattenuation = max(attenuation - attenuationFactor, 0.0); // The max fixes a bug.\n\t// Finally we expand the equation along the y-axis so that it starts with a function value of 1 again.\n\tattenuation /= 1.0 - attenuationFactor;\n\treturn attenuation;\n}\n\nvoid LayaAirBlinnPhongLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir,in vec3 lightColor, in vec3 lightVec,out vec3 diffuseColor,out vec3 specularColor) {\n\tmediump vec3 h = normalize(viewDir-lightVec);\n\tlowp float ln = max (0.0, dot (-lightVec,normal));\n\tfloat nh = max (0.0, dot (h,normal));\n\tdiffuseColor=lightColor * ln;\n\tspecularColor=lightColor *specColor*pow (nh, specColorIntensity*128.0) * gloss;\n}\n\nvoid LayaAirBlinnPhongDiectionLight (in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in DirectionLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec=normalize(light.Direction);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec,diffuseColor,specularColor);\n}\n\nvoid LayaAirBlinnPhongPointLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in PointLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range )\n\t//\treturn;\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,lightVec/length(lightVec),diffuseColor,specularColor);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range);\n\tdiffuseColor *= attenuate;\n\tspecularColor*= attenuate;\n}\n\nvoid LayaAirBlinnPhongSpotLight (in vec3 pos,in vec3 specColor,in float specColorIntensity,in vec3 normal,in vec3 gloss, in vec3 viewDir, in SpotLight light,out vec3 diffuseColor,out vec3 specularColor) {\n\tvec3 lightVec =  pos-light.Position;\n\t//if( length(lightVec) > light.Range)\n\t//\treturn;\n\n\tvec3 normalLightVec=lightVec/length(lightVec);\n\tLayaAirBlinnPhongLight(specColor,specColorIntensity,normal,gloss,viewDir,light.Color,normalLightVec,diffuseColor,specularColor);\n\tvec2 cosAngles=cos(vec2(light.Spot,light.Spot*0.5)*0.5);//ConeAttenuation\n\tfloat dl=dot(normalize(light.Direction),normalLightVec);\n\tdl*=smoothstep(cosAngles[0],cosAngles[1],dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range)*dl;\n\tdiffuseColor *=attenuate;\n\tspecularColor *=attenuate;\n}\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent,vec3 binormal) {\n\tvec3 normalT =vec3(2.0*normalMapSample.x - 1.0,1.0-2.0*normalMapSample.y,2.0*normalMapSample.z - 1.0);\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\nvec3 NormalSampleToWorldSpace1(vec4 normalMapSample, vec3 tangent, vec3 binormal, vec3 unitNormal) {\n\tvec3 normalT;\n\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\n\tvec3 T = normalize(tangent);\n\tvec3 B = normalize(binormal);\n\tvec3 N = normalize(unitNormal);\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN * normalize(normalT);\n\n\treturn bumpedNormal;\n}\n\nvec3 DecodeLightmap(vec4 color) {\n\treturn color.rgb*color.a*5.0;\n}\n\nvec2 TransformUV(vec2 texcoord,vec4 tilingOffset) {\n\tvec2 transTexcoord=vec2(texcoord.x,texcoord.y-1.0)*tilingOffset.xy+vec2(tilingOffset.z,-tilingOffset.w);\n\ttransTexcoord.y+=1.0;\n\treturn transTexcoord;\n}\n\nvec4 remapGLPositionZ(vec4 position) {\n\tposition.z=position.z * 2.0 - position.w;\n\treturn position;\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\n"),
                    Lt.addInclude("ShadowHelper.glsl", "uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),
                    Lt.addInclude("BRDF.glsl", "struct LayaGI\n{\n\tvec3 diffuse;\n\tvec3 specular;\n};\n\nvec4 LayaAirBRDF(in vec3 diffuseColor, in vec3 specularColor, in float oneMinusReflectivity, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat perceptualRoughness = SmoothnessToPerceptualRoughness(smoothness);\n\tvec3 halfDir = SafeNormalize(viewDir - lightDir);\n\t\n\tfloat nv = abs(dot(normal, viewDir));\n\t\n\tfloat nl = clamp(dot(normal,   -lightDir),  0.0, 1.0);\n\tfloat nh = clamp(dot(normal,     halfDir),  0.0, 1.0);\n\tfloat lv = clamp(dot(lightDir,   viewDir),  0.0, 1.0);\n\tfloat lh = clamp(dot(lightDir,  -halfDir),  0.0, 1.0);\n\t\n\tfloat diffuseTerm = DisneyDiffuse(nv, nl, lh, perceptualRoughness) * nl;\n\t\n\tfloat roughness = PerceptualRoughnessToRoughness(perceptualRoughness);\n\t\n\t//#if UNITY_BRDF_GGX\n\tfloat V = SmithJointGGXVisibilityTerm(nl, nv, roughness);\n\tfloat D = GGXTerm(nh, roughness);\n\t\n\tfloat specularTerm = V * D * PI;\n\t\n\tspecularTerm = sqrt(max(0.0001, specularTerm));\n\tspecularTerm = max(0.0, specularTerm * nl);\n\t\n\tfloat surfaceReduction = 1.0 - 0.28 * roughness * perceptualRoughness;\n\tfloat grazingTerm = clamp(smoothness + (1.0 - oneMinusReflectivity), 0.0, 1.0);\n\t\n\tvec4 color;\n\tcolor.rgb = diffuseColor * (gi.diffuse + lightColor * diffuseTerm) \n\t\t\t  + specularTerm * lightColor * FresnelTerm (specularColor, lh)\n\t\t\t  + surfaceReduction * gi.specular * FresnelLerp(specularColor, vec3(grazingTerm), nv);\n\t\n\treturn color;\n}"),
                    Lt.addInclude("PBRUtils.glsl", "struct DirectionLight\n{\n\tvec3 Color;\n\tvec3 Direction;\n};\n\nstruct PointLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tfloat Range;\n};\n\nstruct SpotLight\n{\n\tvec3 Color;\n\tvec3 Position;\n\tvec3 Direction;\n\tfloat SpotAngle;\n\tfloat Range;\n};\n\nvec3 UnpackScaleNormal(in vec2 uv0)\n{\n\t#ifdef NORMALTEXTURE\n\t\tvec3 normalT;\n\t\tvec4 normalMapSample = texture2D(u_NormalTexture, uv0);\n\t\tnormalT.x = 2.0 * normalMapSample.x - 1.0;\n\t\tnormalT.y = 1.0 - 2.0 * normalMapSample.y;\n\t\tnormalT.xy *= u_normalScale;\n\t\tnormalT.z = sqrt(1.0 - clamp(dot(normalT.xy, normalT.xy), 0.0, 1.0));\n\t\t\n\t\tvec3 T = normalize(v_Tangent);\n\t\tvec3 B = normalize(v_Binormal);\n\t\tvec3 N = normalize(v_Normal);\n\t\tmat3 TBN = mat3(T, B, N);\n\t\t\n\t\tvec3 bumpedNormal = TBN * normalize(normalT);\n\t\treturn bumpedNormal;\n\t#else\n\t\treturn normalize(v_Normal);\n\t#endif\n}\n\nvec4 DielectricSpecularColor = vec4(0.220916301, 0.220916301, 0.220916301, 1.0 - 0.220916301);\n\nfloat PI = 3.14159265359;\n\nvec3 FresnelTerm (in vec3 F0, in float cosA)\n{\n\treturn F0 + (vec3(1.0) - F0) * pow(1.0 - cosA, 5.0);\n}\n\nvec3 FresnelLerp (in vec3 F0, in vec3 F90, float cosA)\n{\n    float t = pow(1.0 - cosA, 5.0);\n    return mix(F0, F90, t);\n}\n\nfloat PerceptualRoughnessToRoughness(in float perceptualRoughness)\n{\n\treturn perceptualRoughness * perceptualRoughness;\n}\n\nfloat PerceptualRoughnessToSpecularPower(in float perceptualRoughness)\n{\n\tfloat m = PerceptualRoughnessToRoughness(perceptualRoughness);\n\tfloat sq = max(0.0001, m * m);\n\tfloat n = (2.0 / sq) - 2.0;\n\tn = max(n, 0.0001);\n\treturn n;\n}\n\nfloat RoughnessToPerceptualRoughness(in float roughness)\n{\n\treturn sqrt(roughness);\n}\n\nfloat SmoothnessToRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness) * (1.0 - smoothness);\n}\n\nfloat SmoothnessToPerceptualRoughness(in float smoothness)\n{\n\treturn (1.0 - smoothness);\n}\n\nvec3 SafeNormalize(in vec3 inVec)\n{\n\tfloat dp3 = max(0.001,dot(inVec,inVec));\n\treturn inVec * (1.0 / sqrt(dp3));\n}\n\nfloat DisneyDiffuse(in float NdotV, in float NdotL, in float LdotH, in float perceptualRoughness)\n{\n\tfloat fd90 = 0.5 + 2.0 * LdotH * LdotH * perceptualRoughness;\n\tfloat lightScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotL,5.0));\n\tfloat viewScatter\t= (1.0 + (fd90 - 1.0) * pow(1.0 - NdotV,5.0));\n\n\treturn lightScatter * viewScatter;\n}\n\nfloat SmithJointGGXVisibilityTerm (float NdotL, float NdotV, float roughness)\n{\n\tfloat a = roughness;\n\tfloat lambdaV = NdotL * (NdotV * (1.0 - a) + a);\n\tfloat lambdaL = NdotV * (NdotL * (1.0 - a) + a);\n\n\treturn 0.5 / (lambdaV + lambdaL + 0.00001);\n}\n\nfloat GGXTerm (float NdotH, float roughness)\n{\n\tfloat a2 = roughness * roughness;\n\tfloat d = (NdotH * a2 - NdotH) * NdotH + 1.0;\n\treturn 0.31830988618 * a2 / (d * d + 0.0000001);\n}\n\nfloat OneMinusReflectivityFromMetallic(in float metallic)\n{\n\tfloat oneMinusDielectricSpec = DielectricSpecularColor.a;\n\treturn oneMinusDielectricSpec - metallic * oneMinusDielectricSpec;\n}\n\nfloat SpecularStrength(vec3 specular)\n{\n    //(SHADER_TARGET < 30)return specular.r; \n    return max (max (specular.r, specular.g), specular.b);\n}\n\nvec3 DiffuseAndSpecularFromMetallic(in vec3 diffuseColor, in float metallic, out vec3 specularColor, out float oneMinusReflectivity)\n{\n\tspecularColor = mix(DielectricSpecularColor.rgb, diffuseColor, metallic);\n\toneMinusReflectivity = OneMinusReflectivityFromMetallic(metallic);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec3 EnergyConservationBetweenDiffuseAndSpecular(in vec3 diffuseColor, in vec3 specularColor, out float oneMinusReflectivity)\n{\n\toneMinusReflectivity = 1.0 - SpecularStrength(specularColor);\n\treturn diffuseColor * oneMinusReflectivity;\n}\n\nvec4 Occlusion(in vec2 uv0){\n\t#ifdef OCCLUSIONTEXTURE\n\t\tvec4 occlusionTextureColor = texture2D(u_OcclusionTexture, uv0);\n\t\tfloat occ = occlusionTextureColor.g;\n\t\tfloat oneMinusT = 1.0 - u_occlusionStrength;\n\t\tfloat lerpOneTo = oneMinusT + occ * u_occlusionStrength;\n\t\treturn occlusionTextureColor * lerpOneTo;\n\t#else\n\t\treturn vec4(1.0);\n\t#endif\n}\n\nvec2 ParallaxOffset(in vec3 viewDir){\n\t#ifdef PARALLAXTEXTURE\n\t\tfloat h = texture2D(u_ParallaxTexture, v_Texcoord0).g;\n\t\th = h * u_parallaxScale - u_parallaxScale / 2.0;\n\t\tvec3 v = viewDir;\n\t\tv.z += 0.42;\n\t\tvec2 offset = h * (v.xy / v.z);\n\t\treturn v_Texcoord0 + offset;\n\t#else\n\t\treturn v_Texcoord0;\n\t#endif\n}\n\nvec3 ReflectCubeMap(in vec3 viewDir, in vec3 normal){\n\t#ifdef REFLECTMAP\n\t\tvec3 incident = -viewDir;\n\t\tvec3 reflectionVector = reflect(incident, normal);\n\t\tvec3 reflectionColor = textureCube(u_ReflectTexture, vec3(-reflectionVector.x, reflectionVector.yz)).rgb;\n\t\treturn reflectionColor * u_ReflectIntensity;\n\t#else\n\t\treturn vec3(0.0);\n\t#endif\n}\n\nfloat LayaAttenuation(in vec3 L, in float invLightRadius)\n{\n\tfloat fRatio = clamp(length(L) * invLightRadius, 0.0, 1.0);\n\tfRatio *= fRatio;\n\treturn 1.0 / (1.0 + 25.0 * fRatio) * clamp(4.0*(1.0 - fRatio), 0.0, 1.0); //fade to black as if 4 pixel texture\n}\n\nvec3 LayaPreMultiplyAlpha(vec3 diffColor, float alpha, float oneMinusReflectivity, out float outModifiedAlpha)\n{\n\t#ifdef ALPHAPREMULTIPLY\n\t\tdiffColor *= alpha;\n\t\toutModifiedAlpha = 1.0 - oneMinusReflectivity + alpha * oneMinusReflectivity;\n\t#else\n\t\toutModifiedAlpha = alpha;\n\t#endif\n\treturn diffColor;\n}\n\n"),
                    Lt.addInclude("PBRStandardLighting.glsl", '#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRStandardLight(in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat oneMinusReflectivity;\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat alpha;\n\t\n\tdiffuseColor = DiffuseAndSpecularFromMetallic (albedoColor.rgb, metallic, specularColor, oneMinusReflectivity);\n\t\n\tdiffuseColor = LayaPreMultiplyAlpha(diffuseColor, albedoColor.a, oneMinusReflectivity, alpha);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\tcolor.a = alpha;\n\treturn color;\n}\n\nvec4 PBRStandardDiectionLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in LayaGI gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec4 PBRStandardPointLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in PointLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightCoord = (u_PointLightMatrix * vec4(pos, 1.0)).xyz;\n\tfloat distance = dot(lightCoord, lightCoord);\n\tfloat attenuate = texture2D(u_RangeTexture, vec2(distance)).w;\n\tvec3 lightVec = normalize(pos - light.Position);\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\nvec4 PBRStandardSpotLight (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightVec =  pos - light.Position;\n\tvec3 normalLightVec = normalize(lightVec);\n\tvec2 cosAngles = cos(vec2(light.SpotAngle, light.SpotAngle*0.5) * 0.5);//ConeAttenuation\n\tfloat dl = dot(normalize(light.Direction), normalLightVec);\n\tdl *= smoothstep(cosAngles[0], cosAngles[1], dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range) * dl;\n\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\n//vec4 PBRStandardSpotLight1 (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n//{\n//\tvec4 lightCoord = u_SpotLightMatrix * vec4(pos, 1.0);\n//\t\n//\tfloat distance = dot(lightCoord, lightCoord);\n//\tfloat attenuate = (lightCoord.z < 0.0) ? texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//float attenuate = (lightCoord.z < 0.0) ? texture2D(u_AngleTexture, vec2(lightCoord.x / lightCoord.w + 0.5, lightCoord.y / lightCoord.w + 0.5)).r * texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//vec2 _uv = vec2(pos.x * 180.0/(2.0 * pos.z) + 0.5, pos.y * 180.0/(2.0 * pos.z) + 0.5);\n//\tvec3 lightVec = normalize(pos - light.Position);\n//\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n//}\n\nvec2 MetallicGloss(in float albedoTextureAlpha, in vec2 uv0)\n{\n\tvec2 mg;\n\t\n\t#ifdef METALLICGLOSSTEXTURE\n\t\tvec4 metallicGlossTextureColor = texture2D(u_MetallicGlossTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tmg.r = metallicGlossTextureColor.r;\n\t\t\tmg.g = albedoTextureAlpha;\n\t\t#else\n\t\t    mg = metallicGlossTextureColor.ra;\n\t\t#endif\n\t\tmg.g *= u_smoothnessScale;\n\t#else\n\t\tmg.r = u_metallic;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tmg.g = albedoTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tmg.g = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n\treturn mg;\n}\n\n'),
                    Lt.addInclude("PBRSpecularLighting.glsl", '#include "PBRUtils.glsl"\n#include "BRDF.glsl"\n\nvec4 PBRSpecularLight(in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in vec3 lightDir, in vec3 lightColor, in LayaGI gi)\n{\n\tfloat oneMinusReflectivity;\n\tvec3 diffuseColor;\n\tfloat alpha;\n\t\n\tdiffuseColor = EnergyConservationBetweenDiffuseAndSpecular (albedoColor.rgb, specularColor, oneMinusReflectivity);\n\t\n\tdiffuseColor = LayaPreMultiplyAlpha(diffuseColor, albedoColor.a, oneMinusReflectivity, alpha);\n\t\n\tvec4 color = LayaAirBRDF(diffuseColor, specularColor, oneMinusReflectivity, smoothness, normal, viewDir, lightDir, lightColor, gi);\n\tcolor.a = alpha;\n\treturn color;\n}\n\nvec4 PBRSpecularDiectionLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in DirectionLight light, in LayaGI gi)\n{\n\tvec3 lightVec = normalize(light.Direction);\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi);\n}\n\nvec4 PBRSpecularPointLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in PointLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightCoord = (u_PointLightMatrix * vec4(pos, 1.0)).xyz;\n\tfloat distance = dot(lightCoord, lightCoord);\n\tfloat attenuate = texture2D(u_RangeTexture, vec2(distance)).w;\n\tvec3 lightVec = normalize(pos - light.Position);\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\nvec4 PBRSpecularSpotLight (in vec4 albedoColor, in vec3 specularColor, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n{\n\tvec3 lightVec =  pos - light.Position;\n\tvec3 normalLightVec = normalize(lightVec);\n\tvec2 cosAngles = cos(vec2(light.SpotAngle, light.SpotAngle*0.5) * 0.5);//ConeAttenuation\n\tfloat dl = dot(normalize(light.Direction), normalLightVec);\n\tdl *= smoothstep(cosAngles[0], cosAngles[1], dl);\n\tfloat attenuate = LayaAttenuation(lightVec, 1.0/light.Range) * dl;\n\treturn PBRSpecularLight(albedoColor, specularColor, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n}\n\n//vec4 PBRStandardSpotLight1 (in vec4 albedoColor, in float metallic, in float smoothness, in vec3 normal, in vec3 viewDir, in SpotLight light, in vec3 pos, in LayaGI gi)\n//{\n//\tvec4 lightCoord = u_SpotLightMatrix * vec4(pos, 1.0);\n//\t\n//\tfloat distance = dot(lightCoord, lightCoord);\n//\tfloat attenuate = (lightCoord.z < 0.0) ? texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//float attenuate = (lightCoord.z < 0.0) ? texture2D(u_AngleTexture, vec2(lightCoord.x / lightCoord.w + 0.5, lightCoord.y / lightCoord.w + 0.5)).r * texture2D(u_RangeTexture, vec2(distance)).w : 0.0;\n//\t//vec2 _uv = vec2(pos.x * 180.0/(2.0 * pos.z) + 0.5, pos.y * 180.0/(2.0 * pos.z) + 0.5);\n//\tvec3 lightVec = normalize(pos - light.Position);\n//\treturn PBRStandardLight(albedoColor, metallic, smoothness, normal, viewDir, lightVec, light.Color, gi) * attenuate;\n//}\n\nvec4 SpecularGloss(float albedoTextureAlpha, in vec2 uv0)\n{\n    vec4 sg;\n\t\n\t#ifdef SPECULARTEXTURE\n\t\tvec4 specularTextureColor = texture2D(u_SpecularTexture, uv0);\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tsg.rgb = specularTextureColor.rgb;\n\t\t\tsg.a = albedoTextureAlpha;\n\t\t#else\n\t\t\tsg = specularTextureColor;\n\t\t#endif\n\t\tsg.a *= u_smoothnessScale;\n\t#else\n\t\tsg.rgb = u_SpecularColor.rgb;\n\t\t#ifdef SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA\n\t\t\tsg.a = albedoTextureAlpha * u_smoothnessScale;\n\t\t#else\n\t\t\tsg.a = u_smoothness;\n\t\t#endif\n\t#endif\n\t\n    return sg;\n}\n\n'),
                    Lt.addInclude("Colors.glsl", '#include "StdLib.glsl";\n\n#define EPSILON 1.0e-4\n\n// Quadratic color thresholding\n// curve = (threshold - knee, knee * 2, 0.25 / knee)\nmediump vec4 quadraticThreshold(mediump vec4 color, mediump float threshold, mediump vec3 curve) {\n\t// Pixel brightness\n\tmediump float br = max3(color.r, color.g, color.b);\n\n\t// Under-threshold part: quadratic curve\n\tmediump float rq = clamp(br - curve.x, 0.0, curve.y);\n\trq = curve.z * rq * rq;\n\n\t// Combine and apply the brightness response curve.\n\tcolor *= max(rq, br - threshold) / max(br, EPSILON);\n\n\treturn color;\n}\n\n//\n// sRGB transfer functions\n// Fast path ref: http://chilliant.blogspot.com.au/2012/08/srgb-approximations-for-hlsl.html?m=1\n//\nmediump vec3 SRGBToLinear(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn c * c;\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn c * (c * (c * 0.305306011 + 0.682171111) + 0.012522878);\n\t#else\n\t\tmediump vec3 linearRGBLo = c / 12.92;\n\t\tmediump vec3 power=vec3(2.4, 2.4, 2.4);\n\t\tmediump vec3 linearRGBHi = positivePow((c + 0.055) / 1.055, power);\n\t\tmediump vec3 linearRGB =vec3((c.r<=0.04045) ? linearRGBLo.r : linearRGBHi.r,(c.g<=0.04045) ? linearRGBLo.g : linearRGBHi.g,(c.b<=0.04045) ? linearRGBLo.b : linearRGBHi.b);\n\t\treturn linearRGB;\n\t#endif\n}\n\nmediump vec3 LinearToSRGB(mediump vec3 c) {\n\t#ifdef USE_VERY_FAST_SRGB\n\t\treturn sqrt(c);\n\t#elif defined(USE_FAST_SRGB)\n\t\treturn max(1.055 * PositivePow(c, 0.416666667) - 0.055, 0.0);\n\t#else\n\t\tmediump vec3 sRGBLo = c * 12.92;\n\t\tmediump vec3 power=vec3(1.0 / 2.4, 1.0 / 2.4, 1.0 / 2.4);\n\t\tmediump vec3 sRGBHi = (positivePow(c, power) * 1.055) - 0.055;\n\t\tmediump vec3 sRGB =vec3((c.r<=0.0031308) ? sRGBLo.r : sRGBHi.r,(c.g<=0.0031308) ? sRGBLo.g : sRGBHi.g,(c.b<=0.0031308) ? sRGBLo.b : sRGBHi.b);\n\t\treturn sRGB;\n\t#endif\n}'),
                    Lt.addInclude("Sampling.glsl", "// Better, temporally stable box filtering\n// [Jimenez14] http://goo.gl/eomGso\n// . . . . . . .\n// . A . B . C .\n// . . D . E . .\n// . F . G . H .\n// . . I . J . .\n// . K . L . M .\n// . . . . . . .\nmediump vec4 downsampleBox13Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    mediump vec4 A = texture2D(tex, uv + texelSize * vec2(-1.0, -1.0));\n    mediump vec4 B = texture2D(tex, uv + texelSize * vec2( 0.0, -1.0));\n    mediump vec4 C = texture2D(tex, uv + texelSize * vec2( 1.0, -1.0));\n    mediump vec4 D = texture2D(tex, uv + texelSize * vec2(-0.5, -0.5));\n    mediump vec4 E = texture2D(tex, uv + texelSize * vec2( 0.5, -0.5));\n    mediump vec4 F = texture2D(tex, uv + texelSize * vec2(-1.0,  0.0));\n    mediump vec4 G = texture2D(tex, uv);\n    mediump vec4 H = texture2D(tex, uv + texelSize * vec2( 1.0,  0.0));\n    mediump vec4 I = texture2D(tex, uv + texelSize * vec2(-0.5,  0.5));\n    mediump vec4 J = texture2D(tex, uv + texelSize * vec2( 0.5,  0.5));\n    mediump vec4 K = texture2D(tex, uv + texelSize * vec2(-1.0,  1.0));\n    mediump vec4 L = texture2D(tex, uv + texelSize * vec2( 0.0,  1.0));\n    mediump vec4 M = texture2D(tex, uv + texelSize * vec2( 1.0,  1.0));\n\n\tmediump vec2 scale= vec2(0.5, 0.125);\n    mediump vec2 div = (1.0 / 4.0) * scale;\n\n    mediump vec4 o = (D + E + I + J) * div.x;\n    o += (A + B + G + F) * div.y;\n    o += (B + C + H + G) * div.y;\n    o += (F + G + L + K) * div.y;\n    o += (G + H + M + L) * div.y;\n\n    return o;\n}\n\n// Standard box filtering\nmediump vec4 downsampleBox4Tap(sampler2D tex, vec2 uv, vec2 texelSize)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0);\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}\n\n// 9-tap bilinear upsampler (tent filter)\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\n// . 2 . 4 . 2 .\n// . . . . . . .\n// . 1 . 2 . 1 .\n// . . . . . . .\nmediump vec4 upsampleTent(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(1.0, 1.0, -1.0, 0.0) * sampleScale;\n\n    mediump vec4 s =  texture2D(tex, uv - d.xy);\n    s += texture2D(tex, uv - d.wy) * 2.0;\n    s += texture2D(tex, uv - d.zy);\n\n    s += texture2D(tex, uv + d.zw) * 2.0;\n    s += texture2D(tex, uv) * 4.0;\n    s += texture2D(tex,\tuv + d.xw) * 2.0;\n\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.wy) * 2.0;\n    s += texture2D(tex, uv + d.xy);\n\n    return s * (1.0 / 16.0);\n}\n\n// Standard box filtering\nmediump vec4 upsampleBox(sampler2D tex, vec2 uv, vec2 texelSize, vec4 sampleScale)\n{\n    vec4 d = texelSize.xyxy * vec4(-1.0, -1.0, 1.0, 1.0) * (sampleScale * 0.5);\n\n    mediump vec4 s =  texture2D(tex, uv + d.xy);\n    s += texture2D(tex, uv + d.zy);\n    s += texture2D(tex, uv + d.xw);\n    s += texture2D(tex, uv + d.zw);\n\n    return s * (1.0 / 4.0);\n}"),
                    Lt.addInclude("StdLib.glsl", "#define HALF_MAX       65504.0 // (2 - 2^-10) * 2^15\n\n#define FLT_EPSILON    1.192092896e-07 // Smallest positive number, such that 1.0 + FLT_EPSILON != 1.0\n\nmediump vec4 safeHDR(mediump vec4 c)\n{\n    return min(c, HALF_MAX);\n}\n\nfloat max3(float a, float b, float c)\n{\n    return max(max(a, b), c);\n}\n\nvec3 positivePow(vec3 base, vec3 power)\n{\n    return pow(max(abs(base), vec3(FLT_EPSILON, FLT_EPSILON, FLT_EPSILON)), power);\n}");
                var n = {
                    a_Position: 0,
                    a_Color: 1,
                    a_Normal: 3,
                    a_Texcoord0: 2,
                    a_Texcoord1: 7,
                    a_BoneWeights: 6,
                    a_BoneIndices: 5,
                    a_Tangent0: 4,
                    a_MvpMatrix: 12,
                    a_WorldMat: 8
                }, r = {
                    u_Bones: 0,
                    u_DiffuseTexture: 1,
                    u_SpecularTexture: 1,
                    u_NormalTexture: 1,
                    u_AlphaTestValue: 1,
                    u_DiffuseColor: 1,
                    u_MaterialSpecular: 1,
                    u_Shininess: 1,
                    u_TilingOffset: 1,
                    u_WorldMat: 2,
                    u_MvpMatrix: 2,
                    u_LightmapScaleOffset: 2,
                    u_LightMap: 2,
                    u_CameraPos: 3,
                    u_ReflectTexture: 4,
                    u_ReflectIntensity: 4,
                    u_FogStart: 4,
                    u_FogRange: 4,
                    u_FogColor: 4,
                    "u_DirectionLight.Color": 4,
                    "u_DirectionLight.Direction": 4,
                    "u_PointLight.Position": 4,
                    "u_PointLight.Range": 4,
                    "u_PointLight.Color": 4,
                    "u_SpotLight.Position": 4,
                    "u_SpotLight.Direction": 4,
                    "u_SpotLight.Range": 4,
                    "u_SpotLight.Spot": 4,
                    "u_SpotLight.Color": 4,
                    u_AmbientColor: 4,
                    u_shadowMap1: 4,
                    u_shadowMap2: 4,
                    u_shadowMap3: 4,
                    u_shadowPSSMDistance: 4,
                    u_lightShadowVP: 4,
                    u_shadowPCFoffset: 4
                }, a = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                };
                e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\n\tattribute vec2 a_Texcoord0;\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(LIGHTMAP)&&defined(UV1)\n\tattribute vec2 a_Texcoord1;\n#endif\n\n#ifdef LIGHTMAP\n\tuniform vec4 u_LightmapScaleOffset;\n\tvarying vec2 v_LightMapUV;\n#endif\n\n#ifdef COLOR\n\tattribute vec4 a_Color;\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal; \n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_ViewDir; \n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\tattribute vec4 a_Tangent0;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t#ifdef GPU_INSTANCE\n\t\tattribute mat4 a_WorldMat;\n\t#else\n\t\tuniform mat4 u_WorldMat;\n\t#endif\n\tvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t\t#else\n\t\t\tv_Texcoord0=a_Texcoord0;\n\t\t#endif\n\t#endif\n\n\t#ifdef LIGHTMAP\n\t\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord1.x,1.0-a_Texcoord1.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t\t#else\n\t\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,1.0-a_Texcoord0.y)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t\t#endif \n\t\t\tv_LightMapUV.y=1.0-v_LightMapUV.y;\n\t\t#else\n\t\t\t#ifdef UV1\n\t\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t\t#else\n\t\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t\t#endif \n\t\t#endif \n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color=a_Color;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}',
                    i = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\nuniform vec4 u_DiffuseColor;\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvarying vec3 v_ViewDir; \n#endif\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\n\tuniform sampler2D u_DiffuseTexture;\n#endif\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(SPECULARMAP)||defined(NORMALMAP)))\n\tvarying vec2 v_Texcoord0;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform sampler2D u_LightMap;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tuniform vec3 u_MaterialSpecular;\n\tuniform float u_Shininess;\n\t#ifdef SPECULARMAP \n\t\tuniform sampler2D u_SpecularTexture;\n\t#endif\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\tuniform sampler2D u_NormalTexture;\n\tvarying vec3 v_Tangent;\n\tvarying vec3 v_Binormal;\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n\tvec3 globalDiffuse=u_AmbientColor;\n\t#ifdef LIGHTMAP\t\n\t\tglobalDiffuse += DecodeLightmap(texture2D(u_LightMap, v_LightMapUV));\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 normal;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent,v_Binormal));\n\t\t#else\n\t\t\tnormal = normalize(v_Normal);\n\t\t#endif\n\t\tvec3 viewDir= normalize(v_ViewDir);\n\t#endif\n\t\n\tvec4 mainColor=u_DiffuseColor;\n\t#ifdef DIFFUSEMAP\n\t\tvec4 difTexColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\t\tmainColor=mainColor*difTexColor;\n\t#endif \n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tmainColor=mainColor*v_Color;\n\t#endif \n    \n\t#ifdef ALPHATEST\n\t\tif(mainColor.a<u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\t\n\tvec3 diffuse = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tvec3 dif,spe;\n\t\t#ifdef SPECULARMAP\n\t\t\tvec3 gloss=texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n\t\t#else\n\t\t\t#ifdef DIFFUSEMAP\n\t\t\t\tvec3 gloss=vec3(difTexColor.a);\n\t\t\t#else\n\t\t\t\tvec3 gloss=vec3(1.0);\n\t\t\t#endif\n\t\t#endif\n\t#endif\n\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tLayaAirBlinnPhongDiectionLight(u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_DirectionLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tLayaAirBlinnPhongPointLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_PointLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t#ifdef SPOTLIGHT\n\t\tLayaAirBlinnPhongSpotLight(v_PositionWorld,u_MaterialSpecular,u_Shininess,normal,gloss,viewDir,u_SpotLight,dif,spe);\n\t\tdiffuse+=dif;\n\t\tspecular+=spe;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3(u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2(u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1(u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor =vec4(mainColor.rgb*(globalDiffuse + diffuse*shadowValue),mainColor.a);\n\t#else\n\t\tgl_FragColor =vec4(mainColor.rgb*(globalDiffuse + diffuse),mainColor.a);\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\t#ifdef RECEIVESHADOW\n\t\t\tgl_FragColor.rgb+=specular*shadowValue;\n\t\t#else\n\t\t\tgl_FragColor.rgb+=specular;\n\t\t#endif\n\t#endif\n\t  \n\t#ifdef FOG\n\t\tfloat lerpFact=clamp((1.0/gl_FragCoord.w-u_FogStart)/u_FogRange,0.0,1.0);\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n';
                var s = Lt.add("BLINNPHONG", !0), o = new se(n, r, xn.shaderDefines, cn.shaderDefines);
                s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                    a_Position: 0,
                    a_Color: 1
                }, r = {
                    u_MvpMatrix: 2,
                    u_Color: 1
                }, a = {
                    s_Cull: 0,
                    s_Blend: 1,
                    s_BlendSrc: 2,
                    s_BlendDst: 3,
                    s_DepthTest: 12,
                    s_DepthWrite: 13
                }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nuniform vec4 u_Color;\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n\tv_Color=a_Color*u_Color;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}',
                    i = "#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec4 v_Color;\nuniform vec4 u_Color;\n\nvoid main()\n{\n  gl_FragColor = v_Color * u_Color; \n}\n\n",
                    s = Lt.add("LineShader"), o = new se(n, r), s.addSubShader(o), o.addShaderPass(e, i, a),
                    n = {
                        a_Position: 0,
                        a_Normal: 3,
                        a_Tangent0: 4,
                        a_Texcoord0: 2,
                        a_BoneWeights: 6,
                        a_BoneIndices: 5,
                        a_MvpMatrix: 12,
                        a_WorldMat: 8
                    }, r = {
                        u_Bones: 0,
                        u_MvpMatrix: 2,
                        u_WorldMat: 2,
                        u_CameraPos: 3,
                        u_AlphaTestValue: 1,
                        u_AlbedoColor: 1,
                        u_EmissionColor: 1,
                        u_AlbedoTexture: 1,
                        u_NormalTexture: 1,
                        u_ParallaxTexture: 1,
                        u_MetallicGlossTexture: 1,
                        u_OcclusionTexture: 1,
                        u_EmissionTexture: 1,
                        u_metallic: 1,
                        u_smoothness: 1,
                        u_smoothnessScale: 1,
                        u_occlusionStrength: 1,
                        u_normalScale: 1,
                        u_parallaxScale: 1,
                        u_TilingOffset: 1,
                        "u_DirectionLight.Direction": 4,
                        "u_DirectionLight.Color": 4,
                        u_PointLightMatrix: 4,
                        "u_PointLight.Position": 4,
                        "u_PointLight.Range": 4,
                        "u_PointLight.Color": 4,
                        "u_SpotLight.Position": 4,
                        "u_SpotLight.Direction": 4,
                        "u_SpotLight.Range": 4,
                        "u_SpotLight.SpotAngle": 4,
                        "u_SpotLight.Color": 4,
                        u_RangeTexture: 4,
                        u_ReflectTexture: 4,
                        u_ReflectIntensity: 4,
                        u_AmbientColor: 4,
                        u_shadowMap1: 4,
                        u_shadowMap2: 4,
                        u_shadowMap3: 4,
                        u_shadowPSSMDistance: 4,
                        u_lightShadowVP: 4,
                        u_shadowPCFoffset: 4,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\n\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\t\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}',
                    i = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\nuniform vec3 u_AmbientColor;\nuniform vec4 u_AlbedoColor;\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n#ifdef METALLICGLOSSTEXTURE\n\tuniform sampler2D u_MetallicGlossTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n#ifdef REFLECTMAP\n\tuniform samplerCube u_ReflectTexture;\n\tuniform float u_ReflectIntensity;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\nuniform sampler2D u_RangeTexture;\n//uniform sampler2D u_AngleTexture;\nuniform mat4 u_PointLightMatrix;\n//uniform mat4 u_SpotLightMatrix;\n\n#include "PBRStandardLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_AlbedoTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec2 mg;\n\tvec4 albedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tvec4 abledoTextureColor = texture2D(u_AlbedoTexture, uv0);\n\t\talbedoColor = abledoTextureColor * u_AlbedoColor;\n\t\tmg = MetallicGloss(abledoTextureColor.a, uv0);\n\t#else\n\t\talbedoColor = u_AlbedoColor;\n\t\tmg = MetallicGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(albedoColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tvec3 normal = UnpackScaleNormal(uv0);\n  \n\tLayaGI gi;\n\tgi.diffuse = u_AmbientColor * Occlusion(uv0).rgb;\n\tgi.specular = ReflectCubeMap(viewDir, normal);\n  \n\tvec4 color = vec4(0.0);\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tcolor += PBRStandardDiectionLight(albedoColor, mg.r, mg.g, normal, viewDir, u_DirectionLight, gi);\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRStandardPointLight(albedoColor, mg.r, mg.g, normal, viewDir, u_PointLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef SPOTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRStandardSpotLight(albedoColor, mg.r, mg.g, normal, viewDir, u_SpotLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}',
                    s = Lt.add("PBRStandard", !0), o = new se(n, r, xn.shaderDefines, sn.shaderDefines),
                    s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                        a_Position: 0,
                        a_Normal: 3,
                        a_Tangent0: 4,
                        a_Texcoord0: 2,
                        a_BoneWeights: 6,
                        a_BoneIndices: 5,
                        a_MvpMatrix: 12,
                        a_WorldMat: 8
                    }, r = {
                        u_Bones: 0,
                        u_MvpMatrix: 2,
                        u_WorldMat: 2,
                        u_CameraPos: 3,
                        u_AlphaTestValue: 1,
                        u_AlbedoColor: 1,
                        u_SpecularColor: 1,
                        u_EmissionColor: 1,
                        u_AlbedoTexture: 1,
                        u_NormalTexture: 1,
                        u_ParallaxTexture: 1,
                        u_SpecularTexture: 1,
                        u_OcclusionTexture: 1,
                        u_EmissionTexture: 1,
                        u_smoothness: 1,
                        u_smoothnessScale: 1,
                        u_occlusionStrength: 1,
                        u_normalScale: 1,
                        u_parallaxScale: 1,
                        u_TilingOffset: 1,
                        "u_DirectionLight.Direction": 4,
                        "u_DirectionLight.Color": 4,
                        u_PointLightMatrix: 4,
                        "u_PointLight.Position": 4,
                        "u_PointLight.Range": 4,
                        "u_PointLight.Color": 4,
                        "u_SpotLight.Position": 4,
                        "u_SpotLight.Direction": 4,
                        "u_SpotLight.Range": 4,
                        "u_SpotLight.SpotAngle": 4,
                        "u_SpotLight.Color": 4,
                        u_RangeTexture: 4,
                        u_ReflectTexture: 4,
                        u_ReflectIntensity: 4,
                        u_AmbientColor: 4,
                        u_shadowMap1: 4,
                        u_shadowMap2: 4,
                        u_shadowMap3: 4,
                        u_shadowPSSMDistance: 4,
                        u_lightShadowVP: 4,
                        u_shadowPCFoffset: 4,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_WorldMat;\n#else\n\tuniform mat4 u_WorldMat;\n#endif\nuniform vec3 u_CameraPos;\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n\t  varying vec4 v_lightMVPPos;\n\t  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main_castShadow()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t \n\t//TODO没考虑UV动画呢\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tv_Texcoord0 = a_Texcoord0;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tmat4 worldMat;\n\t\t#ifdef GPU_INSTANCE\n\t\t\tworldMat = a_WorldMat;\n\t\t#else\n\t\t\tworldMat = u_WorldMat;\n\t\t#endif\n\t#endif\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tmat3 worldInvMat;\n\t\t#ifdef BONE\n\t\t\tworldInvMat=inverse(mat3(worldMat*skinTransform));\n\t\t#else\n\t\t\tworldInvMat=inverse(mat3(worldMat));\n\t\t#endif  \n\t\tv_Normal=a_Normal*worldInvMat;\n\t\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))\n\t\t\tv_Tangent=a_Tangent0.xyz*worldInvMat;\n\t\t\tv_Binormal=cross(v_Normal,v_Tangent)*a_Tangent0.w;\n\t\t#endif\n\t#endif\n\t\n\t\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(RECEIVESHADOW)\n\t\tv_PositionWorld=(worldMat*position).xyz;\n\t#endif\n\t\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_ViewDir=u_CameraPos-v_PositionWorld;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n  \n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1 \n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif\n}',
                    i = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nvarying vec2 v_Texcoord0;\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec3 v_PositionWorld;\n\nuniform vec3 u_AmbientColor;\nuniform vec4 u_AlbedoColor;\nuniform vec4 u_SpecularColor;\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n#ifdef SPECULARTEXTURE\n\tuniform sampler2D u_SpecularTexture;\n#endif\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n\tuniform float u_normalScale;\n#endif\n#ifdef PARALLAXTEXTURE\n\tuniform sampler2D u_ParallaxTexture;\n\tuniform float u_parallaxScale;\n#endif\n#ifdef OCCLUSIONTEXTURE\n\tuniform sampler2D u_OcclusionTexture;\n\tuniform float u_occlusionStrength;\n#endif\n#ifdef EMISSION\n\t#ifdef EMISSIONTEXTURE\n\t\tuniform sampler2D u_EmissionTexture;\n\t#endif\n\tuniform vec4 u_EmissionColor;\n#endif\n#ifdef REFLECTMAP\n\tuniform samplerCube u_ReflectTexture;\n\tuniform float u_ReflectIntensity;\n#endif\n\nuniform float u_AlphaTestValue;\nuniform float u_metallic;\nuniform float u_smoothness;\nuniform float u_smoothnessScale;\n\nuniform sampler2D u_RangeTexture;\n//uniform sampler2D u_AngleTexture;\nuniform mat4 u_PointLightMatrix;\n//uniform mat4 u_SpotLightMatrix;\n\n#include "PBRSpecularLighting.glsl"\n#include "ShadowHelper.glsl"\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\nvoid main_castShadow()\n{\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_AlbedoTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\n\nvoid main_normal()\n{\t\n\tvec3 viewDir = normalize(v_ViewDir);\n\t\n\tvec2 uv0 = ParallaxOffset(viewDir);\n\t\n\tvec4 sg;\n\tvec4 albedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tvec4 albedoTextureColor = texture2D(u_AlbedoTexture, uv0);\n\t\talbedoColor = albedoTextureColor * u_AlbedoColor;\n\t\tsg = SpecularGloss(albedoTextureColor.a, uv0);\n\t#else\n\t\talbedoColor = u_AlbedoColor;\n\t\tsg = SpecularGloss(1.0, uv0);\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(albedoColor.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n  \n\tvec3 normal = UnpackScaleNormal(uv0);\n\t\n\tLayaGI gi;\n\tgi.diffuse = u_AmbientColor * Occlusion(uv0).rgb;\n\tgi.specular = ReflectCubeMap(viewDir, normal);\n\t\n\t//float a = (sg.r+sg.g+sg.b) / 3.0;\n  \n\tvec4 color = vec4(0.0);\n\t\n\t#ifdef DIRECTIONLIGHT\n\t\tcolor += PBRSpecularDiectionLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_DirectionLight, gi);\n\t#endif\n \n\t#ifdef POINTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRSpecularPointLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_PointLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef SPOTLIGHT\n\t\tcolor.a = 0.0;\n\t\tcolor += PBRSpecularSpotLight(albedoColor, sg.rgb, sg.a, normal, viewDir, u_SpotLight, v_PositionWorld, gi);\n\t#endif\n\t\n\t#ifdef EMISSION\n\t\tvec4 emissionColor = u_EmissionColor;\n\t\t#ifdef EMISSIONTEXTURE\n\t\t\temissionColor *=  texture2D(u_EmissionTexture, uv0);\n\t\t#endif\n\t\tcolor.rgb += emissionColor.rgb;\n\t#endif\n\t\n\t#ifdef RECEIVESHADOW\n\t\tfloat shadowValue = 1.0;\n\t\t#ifdef SHADOWMAP_PSSM3\n\t\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif\n\t\t#ifdef SHADOWMAP_PSSM2\n\t\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t\t#endif \n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t\t#endif\n\t\tgl_FragColor = vec4(color.rgb * shadowValue, color.a);\n\t#else\n\t\tgl_FragColor = color;\n\t#endif\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t#endif\n}\n\nvoid main()\n{\n\t#ifdef CASTSHADOW\t\t\n\t\tmain_castShadow();\n\t#else\n\t\tmain_normal();\n\t#endif  \n}\n\n',
                    s = Lt.add("PBRSpecular", !0), o = new se(n, r, xn.shaderDefines, fn.shaderDefines),
                    s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                        a_Position: 0,
                        a_Color: 1,
                        a_Texcoord0: 2,
                        a_BoneWeights: 6,
                        a_BoneIndices: 5,
                        a_MvpMatrix: 12
                    }, r = {
                        u_Bones: 0,
                        u_AlbedoTexture: 1,
                        u_AlbedoColor: 1,
                        u_TilingOffset: 1,
                        u_AlphaTestValue: 1,
                        u_MvpMatrix: 2,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\n\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\nattribute vec4 a_Color;\nvarying vec4 v_Color;\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main() {\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tv_Color = a_Color;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}',
                    i = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\tvarying vec4 v_Color;\n#endif\n\n#ifdef ALBEDOTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n\tvarying vec2 v_Texcoord0;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef ALPHATEST\n\tuniform float u_AlphaTestValue;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  u_AlbedoColor;\n\t#ifdef ALBEDOTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t#if defined(COLOR)&&defined(ENABLEVERTEXCOLOR)\n\t\tcolor *= v_Color;\n\t#endif\n\t\n\t#ifdef ALPHATEST\n\t\tif(color.a < u_AlphaTestValue)\n\t\t\tdiscard;\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n\t\n}\n\n",
                    s = Lt.add("Unlit", !0), o = new se(n, r, xn.shaderDefines, Ji.shaderDefines), s.addSubShader(o),
                    o.addShaderPass(e, i, a), n = {
                        a_Position: 0,
                        a_Texcoord0: 2,
                        a_BoneWeights: 6,
                        a_BoneIndices: 5,
                        a_MvpMatrix: 12
                    }, r = {
                        u_Bones: 0,
                        u_AlbedoTexture: 1,
                        u_AlbedoColor: 1,
                        u_TilingOffset: 1,
                        u_AlphaTestValue: 1,
                        u_MvpMatrix: 2,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Texcoord0;\n\n#ifdef GPU_INSTANCE\n\tattribute mat4 a_MvpMatrix;\n#else\n\tuniform mat4 u_MvpMatrix;\n#endif\n\nvarying vec4 v_Color;\nvarying vec2 v_Texcoord0;\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\n#ifdef BONE\n\tconst int c_MaxBoneCount = 24;\n\tattribute vec4 a_BoneIndices;\n\tattribute vec4 a_BoneWeights;\n\tuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\nvoid main()\n{\n\tvec4 position;\n\t#ifdef BONE\n\t\tmat4 skinTransform = u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\t\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\t\tposition=skinTransform*a_Position;\n\t#else\n\t\tposition=a_Position;\n\t#endif\n\t#ifdef GPU_INSTANCE\n\t\tgl_Position = a_MvpMatrix * position;\n\t#else\n\t\tgl_Position = u_MvpMatrix * position;\n\t#endif\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=TransformUV(a_Texcoord0,u_TilingOffset);\n\t#else\n\t\tv_Texcoord0=a_Texcoord0;\n\t#endif\n\t\t\n\tv_Color = a_Color;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}',
                    i = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef COLOR\n\tvarying vec4 v_Color;\n#endif\nvarying vec2 v_Texcoord0;\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_AlbedoTexture;\n#endif\n\nuniform vec4 u_AlbedoColor;\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\nvoid main()\n{\n\tvec4 color =  2.0 * u_AlbedoColor;\n\t#ifdef COLOR\n\t\tcolor *= v_Color;\n\t#endif\n\t#ifdef MAINTEXTURE\n\t\tcolor *= texture2D(u_AlbedoTexture, v_Texcoord0);\n\t#endif\n\t\n\tgl_FragColor = color;\n\t\n\t#ifdef FOG\n\t\tfloat lerpFact = clamp((1.0 / gl_FragCoord.w - u_FogStart) / u_FogRange, 0.0, 1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.0), lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb = mix(gl_FragColor.rgb, u_FogColor, lerpFact);\n\t\t#endif\n\t#endif\n}\n\n",
                    s = Lt.add("Effect", !0), o = new se(n, r, xn.shaderDefines, ln.shaderDefines),
                    s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                        a_CornerTextureCoordinate: 0,
                        a_MeshPosition: 1,
                        a_MeshColor: 2,
                        a_MeshTextureCoordinate: 3,
                        a_ShapePositionStartLifeTime: 4,
                        a_DirectionTime: 5,
                        a_StartColor: 6,
                        a_EndColor: 7,
                        a_StartSize: 8,
                        a_StartRotation0: 9,
                        a_StartSpeed: 10,
                        a_Random0: 11,
                        a_Random1: 12,
                        a_SimulationWorldPostion: 13,
                        a_SimulationWorldRotation: 14
                    }, r = {
                        u_Tintcolor: 1,
                        u_TilingOffset: 1,
                        u_texture: 1,
                        u_WorldPosition: 2,
                        u_WorldRotation: 2,
                        u_PositionScale: 2,
                        u_SizeScale: 2,
                        u_ScalingMode: 2,
                        u_Gravity: 2,
                        u_ThreeDStartRotation: 2,
                        u_StretchedBillboardLengthScale: 2,
                        u_StretchedBillboardSpeedScale: 2,
                        u_SimulationSpace: 2,
                        u_CurrentTime: 2,
                        u_ColorOverLifeGradientAlphas: 2,
                        u_ColorOverLifeGradientColors: 2,
                        u_MaxColorOverLifeGradientAlphas: 2,
                        u_MaxColorOverLifeGradientColors: 2,
                        u_VOLVelocityConst: 2,
                        u_VOLVelocityGradientX: 2,
                        u_VOLVelocityGradientY: 2,
                        u_VOLVelocityGradientZ: 2,
                        u_VOLVelocityConstMax: 2,
                        u_VOLVelocityGradientMaxX: 2,
                        u_VOLVelocityGradientMaxY: 2,
                        u_VOLVelocityGradientMaxZ: 2,
                        u_VOLSpaceType: 2,
                        u_SOLSizeGradient: 2,
                        u_SOLSizeGradientX: 2,
                        u_SOLSizeGradientY: 2,
                        u_SOLSizeGradientZ: 2,
                        u_SOLSizeGradientMax: 2,
                        u_SOLSizeGradientMaxX: 2,
                        u_SOLSizeGradientMaxY: 2,
                        u_SOLSizeGradientMaxZ: 2,
                        u_ROLAngularVelocityConst: 2,
                        u_ROLAngularVelocityConstSeprarate: 2,
                        u_ROLAngularVelocityGradient: 2,
                        u_ROLAngularVelocityGradientX: 2,
                        u_ROLAngularVelocityGradientY: 2,
                        u_ROLAngularVelocityGradientZ: 2,
                        u_ROLAngularVelocityConstMax: 2,
                        u_ROLAngularVelocityConstMaxSeprarate: 2,
                        u_ROLAngularVelocityGradientMax: 2,
                        u_ROLAngularVelocityGradientMaxX: 2,
                        u_ROLAngularVelocityGradientMaxY: 2,
                        u_ROLAngularVelocityGradientMaxZ: 2,
                        u_ROLAngularVelocityGradientMaxW: 2,
                        u_TSACycles: 2,
                        u_TSASubUVLength: 2,
                        u_TSAGradientUVs: 2,
                        u_TSAMaxGradientUVs: 2,
                        u_CameraPos: 3,
                        u_CameraDirection: 3,
                        u_CameraUp: 3,
                        u_View: 3,
                        u_Projection: 3,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\n#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\n#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\tattribute vec4 a_CornerTextureCoordinate;\n#endif\n#ifdef RENDERMODE_MESH\n\tattribute vec3 a_MeshPosition;\n\tattribute vec4 a_MeshColor;\n\tattribute vec2 a_MeshTextureCoordinate;\n\tvarying vec4 v_MeshColor;\n#endif\n\nattribute vec4 a_ShapePositionStartLifeTime;\nattribute vec4 a_DirectionTime;\nattribute vec4 a_StartColor;\nattribute vec3 a_StartSize;\nattribute vec3 a_StartRotation0;\nattribute float a_StartSpeed;\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n  attribute vec4 a_Random0;\n#endif\n#if defined(TEXTURESHEETANIMATIONRANDOMCURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  attribute vec4 a_Random1;\n#endif\nattribute vec3 a_SimulationWorldPostion;\nattribute vec4 a_SimulationWorldRotation;\n\nvarying float v_Discard;\nvarying vec4 v_Color;\n#ifdef DIFFUSEMAP\n\tvarying vec2 v_TextureCoordinate;\n#endif\n\nuniform float u_CurrentTime;\nuniform vec3 u_Gravity;\n\nuniform vec3 u_WorldPosition;\nuniform vec4 u_WorldRotation;\nuniform bool u_ThreeDStartRotation;\nuniform int u_ScalingMode;\nuniform vec3 u_PositionScale;\nuniform vec3 u_SizeScale;\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\n#ifdef STRETCHEDBILLBOARD\n\tuniform vec3 u_CameraPosition;\n#endif\nuniform vec3 u_CameraDirection;//TODO:只有几种广告牌模式需要用\nuniform vec3 u_CameraUp;\n\nuniform  float u_StretchedBillboardLengthScale;\nuniform  float u_StretchedBillboardSpeedScale;\nuniform int u_SimulationSpace;\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  int  u_VOLSpaceType;\n#endif\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)\n  uniform  vec3 u_VOLVelocityConst;\n#endif\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n  uniform  vec2 u_VOLVelocityGradientX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientZ[4];//x为key,y为速度\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n  uniform  vec3 u_VOLVelocityConstMax;\n#endif\n#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n  uniform  vec2 u_VOLVelocityGradientMaxX[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxY[4];//x为key,y为速度\n  uniform  vec2 u_VOLVelocityGradientMaxZ[4];//x为key,y为速度\n#endif\n\n#ifdef COLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n#ifdef RANDOMCOLOROVERLIFETIME\n  uniform  vec4 u_ColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_ColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n  uniform  vec4 u_MaxColorOverLifeGradientColors[4];//x为key,yzw为Color\n  uniform  vec2 u_MaxColorOverLifeGradientAlphas[4];//x为key,y为Alpha\n#endif\n\n\n#if defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMERANDOMCURVES)\n  uniform  vec2 u_SOLSizeGradient[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVES\n  uniform  vec2 u_SOLSizeGradientMax[4];//x为key,y为尺寸\n#endif\n#if defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\n  uniform  vec2 u_SOLSizeGradientX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientZ[4];//x为key,y为尺寸\n#endif\n#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n  uniform  vec2 u_SOLSizeGradientMaxX[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxY[4];//x为key,y为尺寸\n  uniform  vec2 u_SOLSizeGradientMaxZ[4];//x为key,y为尺寸\n#endif\n\n\n#ifdef ROTATIONOVERLIFETIME\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  float u_ROLAngularVelocityConst;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  float u_ROLAngularVelocityConstMax;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradient[4];//x为key,y为旋转\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMax[4];//x为key,y为旋转\n  #endif\n#endif\n#ifdef ROTATIONOVERLIFETIMESEPERATE\n  #if defined(ROTATIONOVERLIFETIMECONSTANT)||defined(ROTATIONOVERLIFETIMERANDOMCONSTANTS)\n    uniform  vec3 u_ROLAngularVelocityConstSeprarate;\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n    uniform  vec3 u_ROLAngularVelocityConstMaxSeprarate;\n  #endif\n  #if defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\n    uniform  vec2 u_ROLAngularVelocityGradientX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientZ[4];\n  #endif\n  #ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n    uniform  vec2 u_ROLAngularVelocityGradientMaxX[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxY[4];\n    uniform  vec2 u_ROLAngularVelocityGradientMaxZ[4];\n\tuniform  vec2 u_ROLAngularVelocityGradientMaxW[4];\n  #endif\n#endif\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\n  uniform  float u_TSACycles;\n  uniform  vec2 u_TSASubUVLength;\n  uniform  vec2 u_TSAGradientUVs[4];//x为key,y为frame\n#endif\n#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n  uniform  vec2 u_TSAMaxGradientUVs[4];//x为key,y为frame\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvec3 rotationByEuler(in vec3 vector,in vec3 rot)\n{\n\tfloat halfRoll = rot.z * 0.5;\n    float halfPitch = rot.x * 0.5;\n\tfloat halfYaw = rot.y * 0.5;\n\n\tfloat sinRoll = sin(halfRoll);\n\tfloat cosRoll = cos(halfRoll);\n\tfloat sinPitch = sin(halfPitch);\n\tfloat cosPitch = cos(halfPitch);\n\tfloat sinYaw = sin(halfYaw);\n\tfloat cosYaw = cos(halfYaw);\n\n\tfloat quaX = (cosYaw * sinPitch * cosRoll) + (sinYaw * cosPitch * sinRoll);\n\tfloat quaY = (sinYaw * cosPitch * cosRoll) - (cosYaw * sinPitch * sinRoll);\n\tfloat quaZ = (cosYaw * cosPitch * sinRoll) - (sinYaw * sinPitch * cosRoll);\n\tfloat quaW = (cosYaw * cosPitch * cosRoll) + (sinYaw * sinPitch * sinRoll);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\n//假定axis已经归一化\nvec3 rotationByAxis(in vec3 vector,in vec3 axis, in float angle)\n{\n\tfloat halfAngle = angle * 0.5;\n\tfloat sin = sin(halfAngle);\n\t\n\tfloat quaX = axis.x * sin;\n\tfloat quaY = axis.y * sin;\n\tfloat quaZ = axis.z * sin;\n\tfloat quaW = cos(halfAngle);\n\t\n\t//vec4 q=vec4(quaX,quaY,quaZ,quaW);\n\t//vec3 temp = cross(q.xyz, vector) + q.w * vector;\n\t//return (cross(temp, -q.xyz) + dot(q.xyz,vector) * q.xyz + q.w * temp);\n\t\n\tfloat x = quaX + quaX;\n    float y = quaY + quaY;\n    float z = quaZ + quaZ;\n    float wx = quaW * x;\n    float wy = quaW * y;\n    float wz = quaW * z;\n\tfloat xx = quaX * x;\n    float xy = quaX * y;\n\tfloat xz = quaX * z;\n    float yy = quaY * y;\n    float yz = quaY * z;\n    float zz = quaZ * z;\n\n    return vec3(((vector.x * ((1.0 - yy) - zz)) + (vector.y * (xy - wz))) + (vector.z * (xz + wy)),\n                ((vector.x * (xy + wz)) + (vector.y * ((1.0 - xx) - zz))) + (vector.z * (yz - wx)),\n                ((vector.x * (xz - wy)) + (vector.y * (yz + wx))) + (vector.z * ((1.0 - xx) - yy)));\n\t\n}\n\nvec3 rotationByQuaternions(in vec3 v,in vec4 q) \n{\n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\n \n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(SIZEOVERLIFETIMECURVE)||defined(SIZEOVERLIFETIMECURVESEPERATE)||defined(SIZEOVERLIFETIMERANDOMCURVES)||defined(SIZEOVERLIFETIMERANDOMCURVESSEPERATE)\nfloat getCurValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat curValue;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\tcurValue=mix(lastGradientNumber.y,gradientNumber.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn curValue;\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)||defined(ROTATIONOVERLIFETIMECURVE)||defined(ROTATIONOVERLIFETIMERANDOMCURVES)\nfloat getTotalValueFromGradientFloat(in vec2 gradientNumbers[4],in float normalizedAge)\n{\n\tfloat totalValue=0.0;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientNumber=gradientNumbers[i];\n\t\tfloat key=gradientNumber.x;\n\t\tvec2 lastGradientNumber=gradientNumbers[i-1];\n\t\tfloat lastValue=lastGradientNumber.y;\n\t\t\n\t\tif(key>=normalizedAge){\n\t\t\tfloat lastKey=lastGradientNumber.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\ttotalValue+=(lastValue+mix(lastValue,gradientNumber.y,age))/2.0*a_ShapePositionStartLifeTime.w*(normalizedAge-lastKey);\n\t\t\tbreak;\n\t\t}\n\t\telse{\n\t\t\ttotalValue+=(lastValue+gradientNumber.y)/2.0*a_ShapePositionStartLifeTime.w*(key-lastGradientNumber.x);\n\t\t}\n\t}\n\treturn totalValue;\n}\n#endif\n\n#if defined(COLOROVERLIFETIME)||defined(RANDOMCOLOROVERLIFETIME)\nvec4 getColorFromGradient(in vec2 gradientAlphas[4],in vec4 gradientColors[4],in float normalizedAge)\n{\n\tvec4 overTimeColor;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientAlpha=gradientAlphas[i];\n\t\tfloat alphaKey=gradientAlpha.x;\n\t\tif(alphaKey>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientAlpha=gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey=lastGradientAlpha.x;\n\t\t\tfloat age=(normalizedAge-lastAlphaKey)/(alphaKey-lastAlphaKey);\n\t\t\toverTimeColor.a=mix(lastGradientAlpha.y,gradientAlpha.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec4 gradientColor=gradientColors[i];\n\t\tfloat colorKey=gradientColor.x;\n\t\tif(colorKey>=normalizedAge)\n\t\t{\n\t\t\tvec4 lastGradientColor=gradientColors[i-1];\n\t\t\tfloat lastColorKey=lastGradientColor.x;\n\t\t\tfloat age=(normalizedAge-lastColorKey)/(colorKey-lastColorKey);\n\t\t\toverTimeColor.rgb=mix(gradientColors[i-1].yzw,gradientColor.yzw,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn overTimeColor;\n}\n#endif\n\n\n#if defined(TEXTURESHEETANIMATIONCURVE)||defined(TEXTURESHEETANIMATIONRANDOMCURVE)\nfloat getFrameFromGradient(in vec2 gradientFrames[4],in float normalizedAge)\n{\n\tfloat overTimeFrame;\n\tfor(int i=1;i<4;i++)\n\t{\n\t\tvec2 gradientFrame=gradientFrames[i];\n\t\tfloat key=gradientFrame.x;\n\t\tif(key>=normalizedAge)\n\t\t{\n\t\t\tvec2 lastGradientFrame=gradientFrames[i-1];\n\t\t\tfloat lastKey=lastGradientFrame.x;\n\t\t\tfloat age=(normalizedAge-lastKey)/(key-lastKey);\n\t\t\toverTimeFrame=mix(lastGradientFrame.y,gradientFrame.y,age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn floor(overTimeFrame);\n}\n#endif\n\n#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\nvec3 computeParticleLifeVelocity(in float normalizedAge)\n{\n  vec3 outLifeVelocity;\n  #ifdef VELOCITYOVERLIFETIMECONSTANT\n\t outLifeVelocity=u_VOLVelocityConst; \n  #endif\n  #ifdef VELOCITYOVERLIFETIMECURVE\n     outLifeVelocity= vec3(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t outLifeVelocity=mix(u_VOLVelocityConst,u_VOLVelocityConstMax,vec3(a_Random1.y,a_Random1.z,a_Random1.w)); \n  #endif\n  #ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n     outLifeVelocity=vec3(mix(getCurValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y),\n\t                 mix(getCurValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z),\n\t\t\t\t\t mix(getCurValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getCurValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n  #endif\n\t\t\t\t\t\n  return outLifeVelocity;\n} \n#endif\n\nvec3 computeParticlePosition(in vec3 startVelocity, in vec3 lifeVelocity,in float age,in float normalizedAge,vec3 gravityVelocity,vec4 worldRotation)\n{\n   vec3 startPosition;\n   vec3 lifePosition;\n   #if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t#ifdef VELOCITYOVERLIFETIMECONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMECURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge));\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCONSTANT\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=lifeVelocity*age;\n\t#endif\n\t#ifdef VELOCITYOVERLIFETIMERANDOMCURVE\n\t\t  startPosition=startVelocity*age;\n\t\t  lifePosition=vec3(mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxX,normalizedAge),a_Random1.y)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxY,normalizedAge),a_Random1.z)\n\t      ,mix(getTotalValueFromGradientFloat(u_VOLVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_VOLVelocityGradientMaxZ,normalizedAge),a_Random1.w));\n\t#endif\n\t\n\tvec3 finalPosition;\n\tif(u_VOLSpaceType==0){\n\t  if(u_ScalingMode!=2)\n\t   finalPosition =rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition),worldRotation);\n\t  else\n\t   finalPosition =rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition+lifePosition,worldRotation);\n\t}\n\telse{\n\t  if(u_ScalingMode!=2)\n\t    finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation)+lifePosition;\n\t  else\n\t    finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation)+lifePosition;\n\t}\n  #else\n\t startPosition=startVelocity*age;\n\t vec3 finalPosition;\n\t if(u_ScalingMode!=2)\n\t   finalPosition = rotationByQuaternions(u_PositionScale*(a_ShapePositionStartLifeTime.xyz+startPosition),worldRotation);\n\t else\n\t   finalPosition = rotationByQuaternions(u_PositionScale*a_ShapePositionStartLifeTime.xyz+startPosition,worldRotation);\n  #endif\n  \n  if(u_SimulationSpace==0)\n    finalPosition=finalPosition+a_SimulationWorldPostion;\n  else if(u_SimulationSpace==1) \n    finalPosition=finalPosition+u_WorldPosition;\n  \n  finalPosition+=0.5*gravityVelocity*age;\n \n  return  finalPosition;\n}\n\n\nvec4 computeParticleColor(in vec4 color,in float normalizedAge)\n{\n\t#ifdef COLOROVERLIFETIME\n\t  color*=getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge);\n\t#endif\n\t\n\t#ifdef RANDOMCOLOROVERLIFETIME\n\t  color*=mix(getColorFromGradient(u_ColorOverLifeGradientAlphas,u_ColorOverLifeGradientColors,normalizedAge),getColorFromGradient(u_MaxColorOverLifeGradientAlphas,u_MaxColorOverLifeGradientColors,normalizedAge),a_Random0.y);\n\t#endif\n\n    return color;\n}\n\nvec2 computeParticleSizeBillbard(in vec2 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec2(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec2(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n\n#ifdef RENDERMODE_MESH\nvec3 computeParticleSizeMesh(in vec3 size,in float normalizedAge)\n{\n\t#ifdef SIZEOVERLIFETIMECURVE\n\t\tsize*=getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge);\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVES\n\t    size*=mix(getCurValueFromGradientFloat(u_SOLSizeGradient,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMax,normalizedAge),a_Random0.z); \n\t#endif\n\t#ifdef SIZEOVERLIFETIMECURVESEPERATE\n\t\tsize*=vec3(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge));\n\t#endif\n\t#ifdef SIZEOVERLIFETIMERANDOMCURVESSEPERATE\n\t    size*=vec3(mix(getCurValueFromGradientFloat(u_SOLSizeGradientX,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxX,normalizedAge),a_Random0.z)\n\t    ,mix(getCurValueFromGradientFloat(u_SOLSizeGradientY,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxY,normalizedAge),a_Random0.z)\n\t\t,mix(getCurValueFromGradientFloat(u_SOLSizeGradientZ,normalizedAge),getCurValueFromGradientFloat(u_SOLSizeGradientMaxZ,normalizedAge),a_Random0.z));\n\t#endif\n\treturn size;\n}\n#endif\n\nfloat computeParticleRotationFloat(in float rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConstSeprarate.z*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConstSeprarate.z,u_ROLAngularVelocityConstMaxSeprarate.z,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n\n#if defined(RENDERMODE_MESH)&&(defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE))\nvec3 computeParticleRotationVec3(in vec3 rotation,in float age,in float normalizedAge)\n{ \n\t#ifdef ROTATIONOVERLIFETIME\n\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tfloat ageRot=u_ROLAngularVelocityConst*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge);\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tfloat ageRot=mix(u_ROLAngularVelocityConst,u_ROLAngularVelocityConstMax,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradient,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMax,normalizedAge),a_Random0.w);\n\t\t#endif\n\t#endif\n\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t#ifdef ROTATIONOVERLIFETIMECONSTANT\n\t\t\tvec3 ageRot=u_ROLAngularVelocityConstSeprarate*age;\n\t        rotation+=ageRot;\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMECURVE\n\t\t\trotation+=vec3(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge));\n\t\t#endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCONSTANTS\n\t\t\tvec3 ageRot=mix(u_ROLAngularVelocityConstSeprarate,u_ROLAngularVelocityConstMaxSeprarate,a_Random0.w)*age;\n\t        rotation+=ageRot;\n\t    #endif\n\t\t#ifdef ROTATIONOVERLIFETIMERANDOMCURVES\n\t\t\trotation+=vec3(mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientX,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxX,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientY,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxY,normalizedAge),a_Random0.w)\n\t        ,mix(getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientZ,normalizedAge),getTotalValueFromGradientFloat(u_ROLAngularVelocityGradientMaxZ,normalizedAge),a_Random0.w));\n\t\t#endif\n\t#endif\n\treturn rotation;\n}\n#endif\n\nvec2 computeParticleUV(in vec2 uv,in float normalizedAge)\n{ \n\t#ifdef TEXTURESHEETANIMATIONCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat frame=getFrameFromGradient(u_TSAGradientUVs,cycleNormalizedAge-floor(cycleNormalizedAge));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\t#ifdef TEXTURESHEETANIMATIONRANDOMCURVE\n\t\tfloat cycleNormalizedAge=normalizedAge*u_TSACycles;\n\t\tfloat uvNormalizedAge=cycleNormalizedAge-floor(cycleNormalizedAge);\n\t    float frame=floor(mix(getFrameFromGradient(u_TSAGradientUVs,uvNormalizedAge),getFrameFromGradient(u_TSAMaxGradientUVs,uvNormalizedAge),a_Random1.x));\n\t\tfloat totalULength=frame*u_TSASubUVLength.x;\n\t\tfloat floorTotalULength=floor(totalULength);\n\t    uv.x+=totalULength-floorTotalULength;\n\t\tuv.y+=floorTotalULength*u_TSASubUVLength.y;\n    #endif\n\treturn uv;\n}\n\nvoid main()\n{\n\tfloat age = u_CurrentTime - a_DirectionTime.w;\n\tfloat normalizedAge = age/a_ShapePositionStartLifeTime.w;\n\tvec3 lifeVelocity;\n\tif(normalizedAge<1.0){ \n\tvec3 startVelocity=a_DirectionTime.xyz*a_StartSpeed;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t\tlifeVelocity= computeParticleLifeVelocity(normalizedAge);//计算粒子生命周期速度\n\t#endif \n\tvec3 gravityVelocity=u_Gravity*age;\n\t\n\tvec4 worldRotation;\n\tif(u_SimulationSpace==0)\n\t\tworldRotation=a_SimulationWorldRotation;\n\telse\n\t\tworldRotation=u_WorldRotation;\n\t\n\tvec3 center=computeParticlePosition(startVelocity, lifeVelocity, age, normalizedAge,gravityVelocity,worldRotation);//计算粒子位置\n   \n   \n   #ifdef SPHERHBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        vec3 cameraUpVector =normalize(u_CameraUp);//TODO:是否外面归一化\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n        vec3 upVector = normalize(cross(sideVector,u_CameraDirection));\n\t    corner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z,age,normalizedAge));\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,rotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\tfloat c = cos(rot);\n\t\t\t\tfloat s = sin(rot);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter += u_SizeScale.xzy*rotationByEuler(corner.x*sideVector+corner.y*upVector,a_StartRotation0);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfloat c = cos(a_StartRotation0.x);\n\t\t\t\tfloat s = sin(a_StartRotation0.x);\n\t\t\t\tmat2 rotation= mat2(c, -s, s, c);\n\t\t\t\tcorner=rotation*corner;\n\t\t\t\tcenter += u_SizeScale.xzy*(corner.x*sideVector+corner.y*upVector);\n\t\t\t}\n\t\t#endif\n   #endif\n   \n   #ifdef STRETCHEDBILLBOARD\n\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n\tvec3 velocity;\n\t#if defined(VELOCITYOVERLIFETIMECONSTANT)||defined(VELOCITYOVERLIFETIMECURVE)||defined(VELOCITYOVERLIFETIMERANDOMCONSTANT)||defined(VELOCITYOVERLIFETIMERANDOMCURVE)\n\t    if(u_VOLSpaceType==0)\n\t\t  velocity=rotationByQuaternions(u_SizeScale*(startVelocity+lifeVelocity),worldRotation)+gravityVelocity;\n\t    else\n\t\t  velocity=rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+lifeVelocity+gravityVelocity;\n    #else\n\t    velocity= rotationByQuaternions(u_SizeScale*startVelocity,worldRotation)+gravityVelocity;\n    #endif\t\n\t\tvec3 cameraUpVector = normalize(velocity);\n\t\tvec3 direction = normalize(center-u_CameraPosition);\n        vec3 sideVector = normalize(cross(direction,normalize(velocity)));\n\t\t\n\t\tsideVector=u_SizeScale.xzy*sideVector;\n\t\tcameraUpVector=length(vec3(u_SizeScale.x,0.0,0.0))*cameraUpVector;\n\t\t\n\t    vec2 size=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n\t\t\n\t    const mat2 rotaionZHalfPI=mat2(0.0, -1.0, 1.0, 0.0);\n\t    corner=rotaionZHalfPI*corner;\n\t    corner.y=corner.y-abs(corner.y);\n\t\t\n\t    float speed=length(velocity);//TODO:\n\t    center +=sign(u_SizeScale.x)*(sign(u_StretchedBillboardLengthScale)*size.x*corner.x*sideVector+(speed*u_StretchedBillboardSpeedScale+size.y*u_StretchedBillboardLengthScale)*corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef HORIZONTALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector=vec3(0.0,0.0,1.0);\n\t    const vec3 sideVector = vec3(-1.0,0.0,0.0);\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef VERTICALBILLBOARD\n\t\tvec2 corner=a_CornerTextureCoordinate.xy;//Billboard模式z轴无效\n        const vec3 cameraUpVector =vec3(0.0,1.0,0.0);\n        vec3 sideVector = normalize(cross(u_CameraDirection,cameraUpVector));\n\t\t\n\t\tfloat rot = computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n        float c = cos(rot);\n        float s = sin(rot);\n        mat2 rotation= mat2(c, -s, s, c);\n\t    corner=rotation*corner*cos(0.78539816339744830961566084581988);//TODO:临时缩小cos45,不确定U3D原因\n\t\tcorner*=computeParticleSizeBillbard(a_StartSize.xy,normalizedAge);\n        center +=u_SizeScale.xzy*(corner.x*sideVector+ corner.y*cameraUpVector);\n   #endif\n   \n   #ifdef RENDERMODE_MESH\n\t    vec3 size=computeParticleSizeMesh(a_StartSize,normalizedAge);\n\t\t#if defined(ROTATIONOVERLIFETIME)||defined(ROTATIONOVERLIFETIMESEPERATE)\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tvec3 rotation=vec3(a_StartRotation0.xy,computeParticleRotationFloat(a_StartRotation0.z, age,normalizedAge));\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,rotation),worldRotation);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t#ifdef ROTATIONOVERLIFETIME\n\t\t\t\t\tfloat angle=computeParticleRotationFloat(a_StartRotation0.x, age,normalizedAge);\n\t\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),angle),worldRotation));//已验证\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\t\tcenter+= u_SizeScale.xzy*(rotationByQuaternions(rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),angle),worldRotation));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\t\tcenter+=rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle);//已验证\n\t\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\t\tcenter+=rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),angle),worldRotation);//已验证\n\t\t\t\t\t\t#endif\n\t\t\t\t\t}\n\t\t\t\t#endif\n\t\t\t\t#ifdef ROTATIONOVERLIFETIMESEPERATE\n\t\t\t\t\t//TODO:是否应合并if(u_ThreeDStartRotation)分支代码,待测试\n\t\t\t\t\tvec3 angle=computeParticleRotationVec3(vec3(0.0,0.0,-a_StartRotation0.x), age,normalizedAge);\n\t\t\t\t\tcenter+= (rotationByQuaternions(rotationByEuler(u_SizeScale*a_MeshPosition*size,vec3(angle.x,angle.y,angle.z)),worldRotation));//已验证\n\t\t\t\t#endif\t\t\n\t\t\t}\n\t\t#else\n\t\t\tif(u_ThreeDStartRotation){\n\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByEuler(a_MeshPosition*size,a_StartRotation0),worldRotation);//已验证\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(a_ShapePositionStartLifeTime.x!=0.0||a_ShapePositionStartLifeTime.y!=0.0){\n\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x);\n\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\tcenter+= (rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,normalize(cross(vec3(0.0,0.0,1.0),vec3(a_ShapePositionStartLifeTime.xy,0.0))),a_StartRotation0.x),worldRotation));//已验证\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t#ifdef SHAPE\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,-1.0,0.0),a_StartRotation0.x),worldRotation);\t\n\t\t\t\t\t#else\n\t\t\t\t\t\tif(u_SimulationSpace==0)\n\t\t\t\t\t\t\tcenter+= rotationByAxis(u_SizeScale*a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x);\n\t\t\t\t\t\telse if(u_SimulationSpace==1)\n\t\t\t\t\t\t\tcenter+= rotationByQuaternions(u_SizeScale*rotationByAxis(a_MeshPosition*size,vec3(0.0,0.0,-1.0),a_StartRotation0.x),worldRotation);//已验证\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t}\n\t\t#endif\n\t\tv_MeshColor=a_MeshColor;\n   #endif\n   \n    gl_Position=u_Projection*u_View*vec4(center,1.0);\n    v_Color = computeParticleColor(a_StartColor, normalizedAge);\n\t#ifdef DIFFUSEMAP\n\t\t#if defined(SPHERHBILLBOARD)||defined(STRETCHEDBILLBOARD)||defined(HORIZONTALBILLBOARD)||defined(VERTICALBILLBOARD)\n\t\t\tv_TextureCoordinate =computeParticleUV(a_CornerTextureCoordinate.zw, normalizedAge);\n\t\t#endif\n\t\t#ifdef RENDERMODE_MESH\n\t\t\tv_TextureCoordinate =computeParticleUV(a_MeshTextureCoordinate, normalizedAge);\n\t\t#endif\n\t\t\n\t\t#ifdef TILINGOFFSET\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y)*u_TilingOffset.xy+vec2(u_TilingOffset.z,-u_TilingOffset.w);//需要特殊处理\n\t\t\tv_TextureCoordinate=vec2(v_TextureCoordinate.x,1.0-v_TextureCoordinate.y);//需要特殊处理\n\t\t#endif\n\t#endif\n    v_Discard=0.0;\n\t  \n\t#ifdef FOG\n\t\tv_PositionWorld=center;\n\t#endif\n   }\n   else\n\t{\n\t\tv_Discard=1.0;\n\t}\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n\n',
                    i = "#ifdef HIGHPRECISION\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\nvarying float v_Discard;\nvarying vec4 v_Color;\nvarying vec2 v_TextureCoordinate;\nuniform sampler2D u_texture;\nuniform vec4 u_Tintcolor;\n\n#ifdef RENDERMODE_MESH\n\tvarying vec4 v_MeshColor;\n#endif\n\n#ifdef FOG\n\tvarying vec3 v_PositionWorld;\n\tuniform vec3 u_CameraPosition;\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\nvoid main()\n{\t\n\t#ifdef RENDERMODE_MESH\n\t\tgl_FragColor=v_MeshColor;\n\t#else\n\t\tgl_FragColor=vec4(1.0);\t\n\t#endif\n\t\t\n\t#ifdef DIFFUSEMAP\n\t\tif(v_Discard!=0.0)\n\t\t\tdiscard;\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=texture2D(u_texture,v_TextureCoordinate)*v_Color;\n\t\t#endif\n\t#else\n\t\t#ifdef TINTCOLOR\n\t\t\tgl_FragColor*=u_Tintcolor*2.0*v_Color;\n\t\t#else\n\t\t\tgl_FragColor*=v_Color;\n\t\t#endif\n\t#endif\n\t\n\t#ifdef FOG\n\t\tvec3 toEye=u_CameraPosition-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t\t\n\t\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t\t#ifdef ADDTIVEFOG\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t\t#else\n\t\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t\t#endif\n\t#endif\n}",
                    s = Lt.add("PARTICLESHURIKEN"), o = new se(n, r, En.shaderDefines, on.shaderDefines),
                    s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                        a_Position: 0
                    }, r = {
                        u_TintColor: 1,
                        u_Exposure: 1,
                        u_Rotation: 1,
                        u_CubeTexture: 1,
                        u_MvpMatrix: 3
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\nuniform float u_Rotation;\nvarying vec3 v_Texcoord;\n\n\nvec4 rotateAroundYInDegrees (vec4 vertex, float degrees)\n{\n\tfloat angle = degrees * 3.141593 / 180.0;\n\tfloat sina=sin(angle);\n\tfloat cosa=cos(angle);\n\tmat2 m = mat2(cosa, -sina, sina, cosa);\n\treturn vec4(m*vertex.xz, vertex.yw).xzyw;\n}\n\t\t\nvoid main()\n{\n\tvec4 position=rotateAroundYInDegrees(a_Position,u_Rotation);\n\tgl_Position = (u_MvpMatrix*position).xyww;\n\tv_Texcoord=vec3(-a_Position.x,a_Position.yz);//转换坐标系\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n',
                    i = "#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nvarying vec3 v_Texcoord;\n\nuniform samplerCube u_CubeTexture;\nuniform float u_Exposure;\nuniform vec4 u_TintColor;\n\n\nvoid main()\n{\t\n\tvec3 color=textureCube(u_CubeTexture, v_Texcoord).rgb*u_TintColor.rgb*u_Exposure*2.0;\n\tgl_FragColor=vec4(color,1.0);\n}\n\n",
                    s = Lt.add("SkyBox"), o = new se(n, r), s.addSubShader(o), o.addShaderPass(e, i),
                    n = {
                        a_Position: 0
                    }, r = {
                        u_SunSize: 1,
                        u_SunSizeConvergence: 1,
                        u_AtmosphereThickness: 1,
                        u_SkyTint: 1,
                        u_GroundTint: 1,
                        u_Exposure: 1,
                        u_MvpMatrix: 3,
                        "u_DirectionLight.Direction": 4,
                        "u_DirectionLight.Color": 4
                    }, e = "#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include \"Lighting.glsl\";\n\n#define OUTER_RADIUS 1.025\n#define RAYLEIGH (mix(0.0, 0.0025, pow(u_AtmosphereThickness,2.5)))// Rayleigh constant Rayleigh为夜空光和极光亮度单位\n#define MIE 0.0010             // Mie constant 米氏散射\n#define SUN_BRIGHTNESS 20.0    // Sun brightness\n#define MAX_SCATTER 50.0 // Maximum scattering value, to prevent math overflows on Adrenos\n\nconst float SKY_GROUND_THRESHOLD = 0.02;\nconst float outerRadius = OUTER_RADIUS;\nconst float outerRadius2 = OUTER_RADIUS*OUTER_RADIUS;\nconst float innerRadius = 1.0;\nconst float innerRadius2 = 1.0;\nconst float cameraHeight = 0.0001;\n\nconst float HDSundiskIntensityFactor = 15.0;\nconst float simpleSundiskIntensityFactor = 27.0;\n\nconst float sunScale = 400.0 * SUN_BRIGHTNESS;\nconst float kmESun = MIE * SUN_BRIGHTNESS;\nconst float km4PI = MIE * 4.0 * 3.14159265;\nconst float scale = 1.0 / (OUTER_RADIUS - 1.0);\nconst float scaleDepth = 0.25;\nconst float scaleOverScaleDepth = (1.0 / (OUTER_RADIUS - 1.0)) / 0.25;\nconst float samples = 2.0; // THIS IS UNROLLED MANUALLY, DON'T TOUCH\n\n// RGB wavelengths        .35 (.62=158), .43 (.68=174), .525 (.75=190)\nconst vec3 c_DefaultScatteringWavelength = vec3(0.65, 0.57, 0.475);//默认散射波长\nconst vec3 c_VariableRangeForScatteringWavelength = vec3(0.15, 0.15, 0.15);//散射播放的可变范围\n\nattribute vec4 a_Position;\n\nuniform mat4 u_MvpMatrix;\nuniform vec3 u_SkyTint;\nuniform vec3 u_GroundTint;\nuniform float u_Exposure;\nuniform float u_AtmosphereThickness;\nuniform DirectionLight u_DirectionLight;\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Rayleigh phase function\nfloat getRayleighPhase(vec3 light, vec3 ray) \n{\n\tfloat eyeCos = dot(light, ray);\n\treturn 0.75 + 0.75*eyeCos*eyeCos;\n}\n\nfloat scaleAngle(float inCos)\n{\n\tfloat x = 1.0 - inCos;\n\treturn 0.25 * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\n\n\nvoid main () {\n\tgl_Position = (u_MvpMatrix*a_Position).xyww;\n\n\tvec3 skyTintInGammaSpace = u_SkyTint;//支持非GAMMA空间后要调整\n\tvec3 scatteringWavelength = mix(c_DefaultScatteringWavelength-c_VariableRangeForScatteringWavelength,c_DefaultScatteringWavelength+c_VariableRangeForScatteringWavelength,vec3(1.0) - skyTintInGammaSpace); // using Tint in sRGB+ gamma allows for more visually linear interpolation and to keep (0.5) at (128, gray in sRGB) point\n\tvec3 invWavelength = 1.0 / pow(scatteringWavelength, vec3(4.0));\n\n\tfloat krESun = RAYLEIGH * SUN_BRIGHTNESS;\n\tfloat kr4PI = RAYLEIGH * 4.0 * 3.14159265;\n\n\tvec3 cameraPos = vec3(0.0,innerRadius + cameraHeight,0.0); // The camera's current position\n\n\t// Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n\tvec3 eyeRay = normalize(a_Position.xyz);\n\n\tfloat far = 0.0;\n\tvec3 cIn, cOut;\n\tif (eyeRay.y >= 0.0) {// Sky\n\t\t// Calculate the length of the \"atmosphere\"\n\t\tfar = sqrt(outerRadius2 + innerRadius2 * eyeRay.y * eyeRay.y - innerRadius2) - innerRadius * eyeRay.y;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat height = innerRadius + cameraHeight;\n\t\tfloat depth = exp(scaleOverScaleDepth * -cameraHeight);\n\t\tfloat startAngle = dot(eyeRay, cameraPos) / height;\n\t\tfloat startOffset = depth*scaleAngle(startAngle);\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\tvec3 frontColor = vec3(0.0);\n\t\t//unrolling this manually to avoid some platform for loop slow\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, samplePoint) / height;\n\t\t\tfloat cameraAngle = dot(eyeRay, samplePoint) / height;\n\t\t\tfloat scatter = (startOffset + depth*(scaleAngle(lightAngle) - scaleAngle(cameraAngle)));\n\t\t\tvec3 attenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\t// Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader\n\t\tcIn = frontColor * (invWavelength * krESun);\n\t\tcOut = frontColor * kmESun;\n\t} else {// Ground\n\t\tfar = (-cameraHeight) / (min(-0.001, eyeRay.y));\n\t\tvec3 pos = cameraPos + far * eyeRay;\n\n\t\t// Calculate the ray's starting position, then calculate its scattering offset\n\t\tfloat depth = exp((-cameraHeight) * (1.0/scaleDepth));\n\t\tfloat cameraAngle = dot(-eyeRay, pos);\n\t\tfloat lightAngle = dot(-u_DirectionLight.Direction, pos);\n\t\tfloat cameraScale = scaleAngle(cameraAngle);\n\t\tfloat lightScale = scaleAngle(lightAngle);\n\t\tfloat cameraOffset = depth*cameraScale;\n\t\tfloat temp = lightScale + cameraScale;\n\n\t\t// Initialize the scattering loop variables\n\t\tfloat sampleLength = far / samples;\n\t\tfloat scaledLength = sampleLength * scale;\n\t\tvec3 sampleRay = eyeRay * sampleLength;\n\t\tvec3 samplePoint = cameraPos + sampleRay * 0.5;\n\n\t\t// Now loop through the sample rays\n\t\tvec3 frontColor = vec3(0.0, 0.0, 0.0);\n\t\tvec3 attenuate;\n\n\t\t// Loop removed because we kept hitting SM2.0 temp variable limits. Doesn't affect the image too much.\n\t\t{\n\t\t\tfloat height = length(samplePoint);\n\t\t\tfloat depth = exp(scaleOverScaleDepth * (innerRadius - height));\n\t\t\tfloat scatter = depth*temp - cameraOffset;\n\t\t\tattenuate = exp(-clamp(scatter, 0.0, MAX_SCATTER) * (invWavelength * kr4PI + km4PI));\n\t\t\tfrontColor += attenuate * (depth * scaledLength);\n\t\t\tsamplePoint += sampleRay;\n\t\t}\n\n\t\tcIn = frontColor * (invWavelength * krESun + kmESun);\n\t\tcOut = clamp(attenuate, 0.0, 1.0);\n\t}\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tv_Vertex = -a_Position.xyz;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_RayDir = -eyeRay;\n\t#else\n\t\tv_SkyGroundFactor = -eyeRay.y / SKY_GROUND_THRESHOLD;\n\t#endif\n\n\t// if we want to calculate color in vprog:\n\t// in case of linear: multiply by _Exposure in here (even in case of lerp it will be common multiplier, so we can skip mul in fshader)\n\tv_GroundColor = u_Exposure * (cIn + u_GroundTint*u_GroundTint * cOut);//u_GroundColor*u_GroundColor is gamma space convert to linear space\n\tv_SkyColor    = u_Exposure * (cIn * getRayleighPhase(-u_DirectionLight.Direction, -eyeRay));\n\n\t\n\t// The sun should have a stable intensity in its course in the sky. Moreover it should match the highlight of a purely specular material.\n\t// This matching was done using the Unity3D standard shader BRDF1 on the 5/31/2017\n\t// Finally we want the sun to be always bright even in LDR thus the normalization of the lightColor for low intensity.\n\tfloat lightColorIntensity = clamp(length(u_DirectionLight.Color), 0.25, 1.0);\n\n\t#ifdef SUN_HIGH_QUALITY \n\t\tv_SunColor = HDSundiskIntensityFactor * clamp(cOut,0.0,1.0) * u_DirectionLight.Color / lightColorIntensity;\n\t#elif defined(SUN_SIMPLE) \n\t\tv_SunColor = simpleSundiskIntensityFactor * clamp(cOut * sunScale,0.0,1.0) * u_DirectionLight.Color / lightColorIntensity;\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n",
                    i = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\nconst float MIE_G = -0.990;\nconst float MIE_G2 = 0.9801;\nconst float SKY_GROUND_THRESHOLD = 0.02;\n\nuniform float u_SunSize;\nuniform float u_SunSizeConvergence;\nuniform DirectionLight u_DirectionLight;\n\n\nvarying vec3 v_GroundColor;\nvarying vec3 v_SkyColor;\n\n\n#ifdef SUN_HIGH_QUALITY\n\tvarying vec3 v_Vertex;\n#elif defined(SUN_SIMPLE)\n\tvarying vec3 v_RayDir;\n#else\n\tvarying float v_SkyGroundFactor;\n#endif\n\n#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\tvarying vec3 v_SunColor;\n#endif\n\n// Calculates the Mie phase function\nfloat getMiePhase(float eyeCos, float eyeCos2) {\n\tfloat temp = 1.0 + MIE_G2 - 2.0 * MIE_G * eyeCos;\n\ttemp = pow(temp, pow(u_SunSize,0.65) * 10.0);\n\ttemp = max(temp,1.0e-4); // prevent division by zero, esp. in half precision\n\ttemp = 1.5 * ((1.0 - MIE_G2) / (2.0 + MIE_G2)) * (1.0 + eyeCos2) / temp;\n\treturn temp;\n}\n\n// Calculates the sun shape\nfloat calcSunAttenuation(vec3 lightPos, vec3 ray) {\n\t#ifdef SUN_HIGH_QUALITY\n\t\tfloat focusedEyeCos = pow(clamp(dot(lightPos, ray),0.0,1.0), u_SunSizeConvergence);\n\t\treturn getMiePhase(-focusedEyeCos, focusedEyeCos * focusedEyeCos);\n\t#else //SUN_SIMPLE\n\t\tvec3 delta = lightPos - ray;\n\t\tfloat dist = length(delta);\n\t\tfloat spot = 1.0 - smoothstep(0.0, u_SunSize, dist);\n\t\treturn spot * spot;\n\t#endif\n}\n\nvoid main() {\n\t// if y > 1 [eyeRay.y < -SKY_GROUND_THRESHOLD] - ground\n\t// if y >= 0 and < 1 [eyeRay.y <= 0 and > -SKY_GROUND_THRESHOLD] - horizon\n\t// if y < 0 [eyeRay.y > 0] - sky\n\tvec3 col = vec3(0.0, 0.0, 0.0);\n\n\t#ifdef SUN_HIGH_QUALITY\n\t\tvec3 ray = normalize(v_Vertex);\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\n\t#elif defined(SUN_SIMPLE) \n\t\tvec3 ray = v_RayDir;\n\t\tfloat y = ray.y / SKY_GROUND_THRESHOLD;\t\n\t#else\n\t\tfloat y = v_SkyGroundFactor;\n\t#endif\n\n\t// if we did precalculate color in vprog: just do lerp between them\n\tcol = mix(v_SkyColor, v_GroundColor, clamp(y,0.0,1.0));\n\n\t#if defined(SUN_HIGH_QUALITY)||defined(SUN_SIMPLE)\n\t\tif (y < 0.0)\n\t\t\tcol += v_SunColor * calcSunAttenuation(-u_DirectionLight.Direction, -ray);\n\t#endif\n\n\tcol = sqrt(col);//linear space convert to gamma space\n\tgl_FragColor=vec4(col,1.0);\n}\n\n',
                    s = Lt.add("SkyBoxProcedural"), o = new se(n, r, null, nn.shaderDefines), s.addSubShader(o),
                    o.addShaderPass(e, i), n = {
                        a_Position: 0,
                        a_Normal: 3,
                        a_Texcoord0: 2
                    }, r = {
                        u_MvpMatrix: 2,
                        u_WorldMat: 2,
                        u_CameraPos: 3,
                        u_LightmapScaleOffset: 2,
                        u_LightMap: 2,
                        u_SplatAlphaTexture: 1,
                        u_DiffuseTexture1: 1,
                        u_DiffuseTexture2: 1,
                        u_DiffuseTexture3: 1,
                        u_DiffuseTexture4: 1,
                        u_DiffuseTexture5: 1,
                        u_DiffuseScaleOffset1: 1,
                        u_DiffuseScaleOffset2: 1,
                        u_DiffuseScaleOffset3: 1,
                        u_DiffuseScaleOffset4: 1,
                        u_DiffuseScaleOffset5: 1,
                        u_FogStart: 4,
                        u_FogRange: 4,
                        u_FogColor: 4,
                        "u_DirectionLight.Direction": 4,
                        "u_DirectionLight.Color": 4,
                        "u_PointLight.Position": 4,
                        "u_PointLight.Range": 4,
                        "u_PointLight.Attenuation": 4,
                        "u_PointLight.Color": 4,
                        "u_SpotLight.Position": 4,
                        "u_SpotLight.Direction": 4,
                        "u_SpotLight.Range": 4,
                        "u_SpotLight.Spot": 4,
                        "u_SpotLight.Color": 4,
                        u_AmbientColor: 4,
                        u_shadowMap1: 4,
                        u_shadowMap2: 4,
                        u_shadowMap3: 4,
                        u_shadowPSSMDistance: 4,
                        u_lightShadowVP: 4,
                        u_shadowPCFoffset: 4
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec2 a_Texcoord0;\n\nuniform mat4 u_MvpMatrix;\n\nvarying vec2 v_Texcoord0;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(LIGHTMAP)\n\tattribute vec3 a_Normal;\n\tvarying vec3 v_Normal;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\tuniform mat4 u_WorldMat;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef LIGHTMAP\n\tvarying vec2 v_LightMapUV;\n\tuniform vec4 u_LightmapScaleOffset;\n#endif\n\n#ifdef RECEIVESHADOW\n\tvarying float v_posViewZ;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tvarying vec4 v_lightMVPPos;\n\t\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n#endif\n\nvoid main()\n{\n\tgl_Position = u_MvpMatrix * a_Position;\n  \n\tv_Texcoord0 = a_Texcoord0;\n  \n\t#ifdef LIGHTMAP\n\t\tv_LightMapUV = vec2(a_Texcoord0.x, 1.0 - a_Texcoord0.y) * u_LightmapScaleOffset.xy + u_LightmapScaleOffset.zw;\n\t\tv_LightMapUV.y = 1.0 - v_LightMapUV.y;\n\t#endif\n  \n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tv_Normal = a_Normal;\n\t#endif\n\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||(defined(RECEIVESHADOW)&&defined(SHADOWMAP_PSSM1))\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n\n\t#ifdef RECEIVESHADOW\n\t\tv_posViewZ = gl_Position.w;\n\t\t#ifdef SHADOWMAP_PSSM1\n\t\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t\t#endif\n\t#endif\n\tgl_Position=remapGLPositionZ(gl_Position);\n}',
                    i = '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Lighting.glsl";\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tuniform vec3 u_CameraPos;\n\tvarying vec3 v_Normal;\n\tvarying vec3 v_PositionWorld;\n#endif\n\n#ifdef FOG\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\tuniform vec3 u_FogColor;\n#endif\n\n\n#ifdef DIRECTIONLIGHT\n\tuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\n\tuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\n\tuniform SpotLight u_SpotLight;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\nuniform vec3 u_AmbientColor;\n\nuniform sampler2D u_SplatAlphaTexture;\n\nuniform sampler2D u_DiffuseTexture1;\nuniform sampler2D u_DiffuseTexture2;\nuniform sampler2D u_DiffuseTexture3;\nuniform sampler2D u_DiffuseTexture4;\nuniform sampler2D u_DiffuseTexture5;\n\nuniform vec4 u_DiffuseScaleOffset1;\nuniform vec4 u_DiffuseScaleOffset2;\nuniform vec4 u_DiffuseScaleOffset3;\nuniform vec4 u_DiffuseScaleOffset4;\nuniform vec4 u_DiffuseScaleOffset5;\n\nvarying vec2 v_Texcoord0;\n\n#ifdef LIGHTMAP\n\tuniform sampler2D u_LightMap;\n\tvarying vec2 v_LightMapUV;\n#endif\n\nvoid main()\n{\n\tvec4 splatAlpha = vec4(1.0);\n\t#ifdef ExtendTerrain_DETAIL_NUM1\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r;\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM2\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r + color2.xyz * (1.0 - splatAlpha.r);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM3\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * (1.0 - splatAlpha.r - splatAlpha.g);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM4\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b);\n\t#endif\n\t#ifdef ExtendTerrain_DETAIL_NUM5\n\t\tsplatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n\t\tvec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScaleOffset1.xy);\n\t\tvec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScaleOffset2.xy);\n\t\tvec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScaleOffset3.xy);\n\t\tvec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScaleOffset4.xy);\n\t\tvec4 color5 = texture2D(u_DiffuseTexture5, v_Texcoord0 * u_DiffuseScaleOffset5.xy);\n\t\tgl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * splatAlpha.a + color5.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b - splatAlpha.a);\n\t#endif\n\t\tgl_FragColor.w = splatAlpha.a;\n\t\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n    vec3 normal = v_Normal;\n\tvec3 dif, spe;\n#endif\n\nvec3 diffuse = vec3(0.0);\nvec3 specular= vec3(0.0);\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\n#ifdef DIRECTIONLIGHT\n\tLayaAirBlinnPhongDiectionLight(vec3(0.0), 1.0, normal, vec3(1.0), toEye,u_DirectionLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tLayaAirBlinnPhongPointLight(v_PositionWorld, vec3(0.0), 1.0, normal, vec3(1.0), toEye, u_PointLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tLayaAirBlinnPhongSpotLight(v_PositionWorld, vec3(0.0), 1.0, normal, vec3(1.0), toEye, u_SpotLight, dif, spe);\n\tdiffuse+=dif;\n\tspecular+=spe;\n#endif\n\nvec3 globalDiffuse = u_AmbientColor;\n#ifdef LIGHTMAP\n\tglobalDiffuse += DecodeLightmap(texture2D(u_LightMap, v_LightMapUV));\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse) * shadowValue, gl_FragColor.a);\n#else\n\tgl_FragColor = vec4(gl_FragColor.rgb * (globalDiffuse + diffuse), gl_FragColor.a);\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor.rgb += specular * shadowValue;\n\t#else\n\t\tgl_FragColor.rgb += specular;\n\t#endif\n#endif\n\n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\n\n\n\n\n',
                    s = Lt.add("ExtendTerrain"), o = new se(n, r, Qi.shaderDefines, un.shaderDefines),
                    s.addSubShader(o), o.addShaderPass(e, i, a), n = {
                        a_Position: 0,
                        a_OffsetVector: 1,
                        a_Texcoord0X: 4,
                        a_Texcoord0Y: 3,
                        a_BirthTime: 2
                    }, r = {
                        u_MvpMatrix: 2,
                        u_View: 3,
                        u_Projection: 3,
                        u_TilingOffset: 1,
                        u_MainTexture: 1,
                        u_MainColor: 1,
                        u_CurTime: 2,
                        u_LifeTime: 2,
                        u_WidthCurve: 2,
                        u_WidthCurveKeyLength: 2,
                        u_GradientColorkey: 2,
                        u_GradientAlphakey: 2
                    }, a = {
                        s_Cull: 0,
                        s_Blend: 1,
                        s_BlendSrc: 2,
                        s_BlendDst: 3,
                        s_DepthTest: 12,
                        s_DepthWrite: 13
                    }, e = '#include "Lighting.glsl";\n\nattribute vec3 a_Position;\nattribute vec3 a_OffsetVector;\nattribute vec4 a_Color;\nattribute float a_Texcoord0X;\nattribute float a_Texcoord0Y;\nattribute float a_BirthTime;\n\nuniform mat4 u_View;\nuniform mat4 u_Projection;\n\nuniform vec4 u_TilingOffset;\n\nuniform float u_CurTime;\nuniform float u_LifeTime;\nuniform vec4 u_WidthCurve[10];\nuniform int u_WidthCurveKeyLength;\n\nuniform vec4 u_GradientColorkey[10];\nuniform vec2 u_GradientAlphakey[10];\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nfloat hermiteInterpolate(float t, float outTangent, float inTangent, float duration, float value1, float value2)\n{\n\tfloat t2 = t * t;\n\tfloat t3 = t2 * t;\n\tfloat a = 2.0 * t3 - 3.0 * t2 + 1.0;\n\tfloat b = t3 - 2.0 * t2 + t;\n\tfloat c = t3 - t2;\n\tfloat d = -2.0 * t3 + 3.0 * t2;\n\treturn a * value1 + b * outTangent * duration + c * inTangent * duration + d * value2;\n}\n\nfloat getCurWidth(in float normalizeTime)\n{\n\tfloat width;\n\tif(normalizeTime == 0.0){\n\t\twidth=u_WidthCurve[0].w;\n\t}\n\telse if(normalizeTime >= 1.0){\n\t\twidth=u_WidthCurve[u_WidthCurveKeyLength - 1].w;\n\t}\n\telse{\n\t\tfor(int i = 0; i < 10; i ++ )\n\t\t{\n\t\t\tif(normalizeTime == u_WidthCurve[i].x){\n\t\t\t\twidth=u_WidthCurve[i].w;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tvec4 lastFrame = u_WidthCurve[i];\n\t\t\tvec4 nextFrame = u_WidthCurve[i + 1];\n\t\t\tif(normalizeTime > lastFrame.x && normalizeTime < nextFrame.x)\n\t\t\t{\n\t\t\t\tfloat duration = nextFrame.x - lastFrame.x;\n\t\t\t\tfloat t = (normalizeTime - lastFrame.x) / duration;\n\t\t\t\tfloat outTangent = lastFrame.z;\n\t\t\t\tfloat inTangent = nextFrame.y;\n\t\t\t\tfloat value1 = lastFrame.w;\n\t\t\t\tfloat value2 = nextFrame.w;\n\t\t\t\twidth=hermiteInterpolate(t, outTangent, inTangent, duration, value1, value2);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn width;\n}\t\n\nvec4 getColorFromGradientByBlend(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tfloat colorKey = gradientColor.x;\n\t\tif(colorKey >= normalizeTime)\n\t\t{\n\t\t\tvec4 lastGradientColor = gradientColors[i-1];\n\t\t\tfloat lastColorKey = lastGradientColor.x;\n\t\t\tfloat age = (normalizeTime - lastColorKey) / (colorKey - lastColorKey);\n\t\t\tcolor.rgb = mix(gradientColors[i-1].yzw, gradientColor.yzw, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tfloat alphaKey = gradientAlpha.x;\n\t\tif(alphaKey >= normalizeTime)\n\t\t{\n\t\t\tvec2 lastGradientAlpha = gradientAlphas[i-1];\n\t\t\tfloat lastAlphaKey = lastGradientAlpha.x;\n\t\t\tfloat age = (normalizeTime - lastAlphaKey) / (alphaKey - lastAlphaKey);\n\t\t\tcolor.a = mix(lastGradientAlpha.y, gradientAlpha.y, age);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvec4 getColorFromGradientByFixed(in vec4 gradientColors[10], in vec2 gradientAlphas[10], in float normalizeTime)\n{\n\tvec4 color;\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec4 gradientColor = gradientColors[i];\n\t\tif(gradientColor.w >= normalizeTime)\n\t\t{\n\t\t\tcolor.rgb = gradientColor.xyz;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i = 1; i < 10; i++)\n\t{\n\t\tvec2 gradientAlpha = gradientAlphas[i];\n\t\tif(gradientAlpha.y >= normalizeTime)\n\t\t{\n\t\t\tcolor.a = gradientAlpha.x;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn color;\n}\n\nvoid main()\n{\n\tfloat normalizeTime = (u_CurTime - a_BirthTime) / u_LifeTime;\n\t\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, 1.0 - a_Texcoord0Y) * u_TilingOffset.xy + u_TilingOffset.zw;\n\t#else\n\t\tv_Texcoord0 = vec2(a_Texcoord0X, a_Texcoord0Y);\n\t#endif\n\t\n\t#ifdef GRADIENTMODE_BLEND\n\t\tv_Color = getColorFromGradientByBlend(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#else\n\t\tv_Color = getColorFromGradientByFixed(u_GradientColorkey, u_GradientAlphakey, normalizeTime);\n\t#endif\n\t\n\tgl_Position = u_Projection * u_View * vec4(a_Position + a_OffsetVector * getCurWidth(normalizeTime),1.0);\n\tgl_Position=remapGLPositionZ(gl_Position);\n}\n',
                    i = "#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_MainTexture;\nuniform vec4 u_MainColor;\n\nvarying vec2 v_Texcoord0;\nvarying vec4 v_Color;\n\nvoid main()\n{\t\n\tvec4 color = 2.0 * u_MainColor * v_Color;\n\t#ifdef MAINTEXTURE\n\t\tvec4 mainTextureColor = texture2D(u_MainTexture, v_Texcoord0);\n\t\tcolor *= mainTextureColor;\n\t#endif\n\tgl_FragColor = color;\n}\n\n",
                    s = Lt.add("Trail"), o = new se(n, r, Tn.shaderDefines, en.shaderDefines), s.addSubShader(o),
                    o.addShaderPass(e, i, a), n = {
                        a_Position: 0,
                        a_Normal: 3,
                        a_Tangent0: 4
                    }, r = {
                        u_MvpMatrix: 2,
                        u_WorldMat: 2,
                        u_CameraPos: 3,
                        u_Time: 4,
                        u_MainTexture: 1,
                        u_NormalTexture: 1,
                        u_HorizonColor: 1,
                        u_WaveScale: 1,
                        u_WaveSpeed: 1
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_Position;\nattribute vec3 a_Normal;\nattribute vec4 a_Tangent0;\n\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_WorldMat;\nuniform vec3 u_CameraPos;\nuniform float u_WaveScale;\nuniform vec4 u_WaveSpeed;\nuniform float u_Time;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\nvoid main()\n{\n\tvec4 positionWorld = u_WorldMat * a_Position;\n\tvec4 position = u_MvpMatrix * a_Position;\n\t\n\tvec4 temp = vec4(positionWorld.x, positionWorld.z, positionWorld.x, positionWorld.z) * u_WaveScale + u_WaveSpeed * u_WaveScale * u_Time;\n\t\n\tv_Texcoord0 = temp.xy * vec2(0.4, 0.45);\n\tv_Texcoord1 = temp.wz;\n\t\n\tmat3 worldMat = mat3(u_WorldMat);\n\tv_Normal = worldMat * a_Normal;\n\tv_Tangent = worldMat * a_Tangent0.xyz;\n\tv_Binormal = cross(v_Normal, v_Tangent) * a_Tangent0.w;\n\t\n\tv_ViewDir = u_CameraPos - positionWorld.xyz;\n\tgl_Position = position;\n\tgl_Position=remapGLPositionZ(gl_Position);\n}',
                    i = '#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#ifdef MAINTEXTURE\n\tuniform sampler2D u_MainTexture;\n#endif\n\n#ifdef NORMALTEXTURE\n\tuniform sampler2D u_NormalTexture;\n#endif\n\nuniform vec4 u_HorizonColor;\n\nvarying vec3 v_Normal;\nvarying vec3 v_Tangent;\nvarying vec3 v_Binormal;\nvarying vec3 v_ViewDir;\nvarying vec2 v_Texcoord0;\nvarying vec2 v_Texcoord1;\n\n#include "Lighting.glsl"\n\nvoid main()\n{\n\tvec4 bumpColor1 = texture2D(u_NormalTexture, v_Texcoord0);\n\tvec4 bumpColor2 = texture2D(u_NormalTexture, v_Texcoord1);\n\t\n\tvec3 normal1 = NormalSampleToWorldSpace1(bumpColor1, v_Tangent, v_Binormal, v_Normal);\n\tvec3 normal2 = NormalSampleToWorldSpace1(bumpColor2, v_Tangent, v_Binormal, v_Normal);\n\t\n\tvec3 normal = normalize((normal1 + normal2) * 0.5);\n\tvec3 viewDir = normalize(v_ViewDir);\n\tfloat fresnel = dot(viewDir, normal);\n\t\n\tvec4 waterColor = texture2D(u_MainTexture, vec2(fresnel, fresnel));\n\t\n\tvec4 color;\n\tcolor.rgb = mix(waterColor.rgb, u_HorizonColor.rgb, vec3(waterColor.a));\n\tcolor.a = u_HorizonColor.a;\n\t\n\tgl_FragColor = color;\n}\n\n',
                    s = Lt.add("WaterPrimary"), o = new se(n, r, null, hn.shaderDefines), s.addSubShader(o),
                    o.addShaderPass(e, i), n = {
                        a_PositionTexcoord: 0
                    }, r = {
                        u_ScreenTexture: 1
                    }, e = '#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}',
                    i = "#ifdef FSHIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\nuniform sampler2D u_ScreenTexture;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_FragColor = texture2D(u_ScreenTexture, v_Texcoord0);\n}\n\n",
                    s = Lt.add("ScreenQuad"), o = new se(n, r, null, null), s.addSubShader(o);
                var l = o.addShaderPass(e, i), h = l.renderState;
                h.depthTest = 519, h.depthWrite = !1, h.cull = 0, h.blend = 0, n = {
                    a_PositionTexcoord: 0
                }, r = {
                    u_MainTex: 1,
                    u_BloomTex: 1,
                    u_AutoExposureTex: 1,
                    u_MainTex_TexelSize: 1,
                    u_SampleScale: 1,
                    u_Threshold: 1,
                    u_Params: 1
                }, s = Lt.add("PostProcessBloom", n, r), o = new se(null, null, null, null), s.addSubShader(o),
                    (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter13();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, o = new se(null, null, null, null),
                    s.addSubShader(o), (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter4() {\n\tmediump vec4 color = downsampleBox4Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter4();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, o = new se(null, null, null, null),
                    s.addSubShader(o), (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform vec4 u_MainTex_TexelSize;\n\nvoid fragDownsample13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = color;\n}\n\nvoid main() {\n\tfragDownsample13();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, o = new se(null, null, null, null),
                    s.addSubShader(o), (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleTent() {\n\tmediump vec4 bloom = UpsampleTent(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, u_SampleScale);\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleTent();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, o = new se(null, null, null, null),
                    s.addSubShader(o), (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform vec4 u_MainTex_TexelSize;\nuniform float u_SampleScale;\n\nmediump vec4 combine(mediump vec4 bloom, vec2 uv) {\n\tmediump vec4 color = texture2D(u_BloomTex, uv);\n\treturn bloom + color;\n}\n\nvoid fragUpsampleBox() {\n\tmediump vec4 bloom = upsampleBox(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy, vec4(u_SampleScale));\n\tgl_FragColor = combine(bloom, v_Texcoord0);\n}\n\nvoid main() {\n\tfragUpsampleBox();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, o = new se(null, null, null, null),
                    s.addSubShader(o), (h = (l = o.addShaderPass('#include "Lighting.glsl";\n\nattribute vec4 a_PositionTexcoord;\nvarying vec2 v_Texcoord0;\n\nvoid main() {\n\tgl_Position = vec4(a_PositionTexcoord.xy, 0.0, 1.0);\n\tv_Texcoord0 = a_PositionTexcoord.zw;\n\tgl_Position = remapGLPositionZ(gl_Position);\n}', '#ifdef HIGHPRECISION\n\tprecision highp float;\n#else\n\tprecision mediump float;\n#endif\n\n#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_AutoExposureTex;\nuniform vec4 u_MainTex_TexelSize;\nuniform vec4 u_Threshold; // x: threshold value (linear), y: threshold - knee, z: knee * 2, w: 0.25 / knee\nuniform vec4 u_Params; // x: clamp, yzw: unused\n\nmediump vec4 prefilter(mediump vec4 color, vec2 uv) {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, uv).r;\n\tcolor *= autoExposure;\n\tcolor = min(vec4(u_Params.x), color); // clamp to max\n\tcolor = quadraticThreshold(color, u_Threshold.x, u_Threshold.yzw);\n\treturn color;\n}\n\nvoid fragPrefilter13() {\n\tmediump vec4 color = downsampleBox13Tap(u_MainTex, v_Texcoord0, u_MainTex_TexelSize.xy);\n\tgl_FragColor = prefilter(safeHDR(color), v_Texcoord0);\n}\n\nvoid main() {\n\tfragPrefilter13();\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0, n = {
                        a_PositionTexcoord: 0
                    }, r = {
                        u_MainTex: 1,
                        u_BloomTex: 1,
                        u_AutoExposureTex: 1,
                        u_Bloom_DirtTex: 1,
                        u_BloomTex_TexelSize: 1,
                        u_Bloom_Settings: 1,
                        u_Bloom_Color: 1
                    }, s = Lt.add("PostProcessComposite", n, r), o = new se(null, null, null, Ie.shaderDefines),
                    s.addSubShader(o), (h = (l = o.addShaderPass("attribute vec4 a_Position;\nvarying vec2 v_Texcoord0;\n\nvec2 TransformTriangleVertexToUV(vec2 vertex)\n{\n    vec2 uv = (vertex + 1.0) * 0.5;\n    return uv;\n}\n\nvoid main() {\n\tgl_Position =vec4(a_Position.xy, 0.0, 1.0);\n\tv_Texcoord0=TransformTriangleVertexToUV(a_Position.xy);\n\tgl_Position=remapGLPositionZ(gl_Position);\n}", '#include "Colors.glsl";\n#include "Sampling.glsl";\n\nvarying vec2 v_Texcoord0;\n\nuniform sampler2D u_MainTex;\nuniform sampler2D u_BloomTex;\n\nuniform sampler2D u_AutoExposureTex;\nuniform sampler2D u_Bloom_DirtTex;\nuniform vec4 u_BloomTex_TexelSize;\nuniform vec4 u_Bloom_DirtTileOffset; // xy: tiling, zw: offset\nuniform mediump vec3 u_Bloom_Settings;// x: sampleScale, y: intensity, z: dirt intensity\nuniform mediump vec3 u_Bloom_Color;\n\nvoid main() {\n\tmediump float autoExposure = texture2D(u_AutoExposureTex, v_Texcoord0).r;\n\tmediump vec4 color=vec4(0.0)\n\tcolor = texture2D(u_MainTex, v_Texcoord0);\n\t\n\tcolor = SRGBToLinear(color);\n\tcolor.rgb *= autoExposure;\n\t\n\t#if BLOOM || BLOOM_LOW\n\t{\n\t\t#if BLOOM\n\t\t\tmediump vec4 bloom = UpsampleTent(_BloomTex, uvDistorted, _BloomTex_TexelSize.xy, _Bloom_Settings.x);\n\t\t#else\n\t\t\tmediump vec4 bloom = UpsampleBox(_BloomTex, uvDistorted, _BloomTex_TexelSize.xy, _Bloom_Settings.x);\n\t\t#endif\n\n\t\t// UVs should be Distort(uv * _Bloom_DirtTileOffset.xy + _Bloom_DirtTileOffset.zw)\n\t\t// but considering we use a cover-style scale on the dirt texture the difference\n\t\t// isn\'t massive so we chose to save a few ALUs here instead in case lens distortion\n\t\t// is active\n\t\tmediump vec4 dirt = mediump vec4(SAMPLE_TEXTURE2D(_Bloom_DirtTex, sampler_Bloom_DirtTex, uvDistorted * _Bloom_DirtTileOffset.xy + _Bloom_DirtTileOffset.zw).rgb, 0.0);\n\n\t\t// Additive bloom (artist friendly)\n\t\tbloom *= _Bloom_Settings.y;\n\t\tdirt *= _Bloom_Settings.z;\n\t\tcolor += bloom * half4(_Bloom_Color, 1.0);\n\t\tcolor += dirt * bloom;\n\t}\n\t#endif\n\t\n\thalf4 output = color;\n\toutput = LinearToSRGB(output);\n\t//output.rgb = Dither(output.rgb, v_Texcoord0);//TODO:\n}')).renderState).depthTest = 519,
                    h.depthWrite = !1, h.cull = 0, h.blend = 0;
            }, t._rangeAttenTex = null, t;
        }(), Ht = function () {
            function t() { }
            return r(t, "laya.d3.utils.Utils3D"), t._convertToLayaVec3 = function (t, e, i) {
                e.x = i ? -t.x() : t.x(), e.y = t.y(), e.z = t.z();
            }, t._convertToBulletVec3 = function (t, e, i) {
                e.setValue(i ? -t.x : t.x, t.y, t.z);
            }, t._rotationTransformScaleSkinAnimation = function (e, i, n, r, a, s, o, l, h, u, c, d) {
                var _, f, p, m, g, y = t._tempArray16_0, v = t._tempArray16_1, S = t._tempArray16_2, T = r + r, E = a + a, C = s + s, x = r * T, b = a * T, I = a * E, w = s * T, A = s * E, R = s * C, M = o * T, D = o * E, O = o * C;
                for (y[15] = 1, y[0] = 1 - I - R, y[1] = b + O, y[2] = w - D, y[4] = b - O, y[5] = 1 - x - R,
                    y[6] = A + M, y[8] = w + D, y[9] = A - M, y[10] = 1 - x - I, v[15] = 1, v[0] = l,
                    v[5] = h, v[10] = u, _ = 0; _ < 4; _++) f = y[_], p = y[_ + 4], m = y[_ + 8], g = y[_ + 12],
                        S[_] = f, S[_ + 4] = p, S[_ + 8] = m, S[_ + 12] = f * e + p * i + m * n + g;
                for (_ = 0; _ < 4; _++) f = S[_], p = S[_ + 4], m = S[_ + 8], g = S[_ + 12], c[_ + d] = f * v[0] + p * v[1] + m * v[2] + g * v[3],
                    c[_ + d + 4] = f * v[4] + p * v[5] + m * v[6] + g * v[7], c[_ + d + 8] = f * v[8] + p * v[9] + m * v[10] + g * v[11],
                    c[_ + d + 12] = f * v[12] + p * v[13] + m * v[14] + g * v[15];
            }, t._createSceneByJsonForMaker = function (e, i, n) {
                var r = t._createNodeByJsonForMaker(e, i, n);
                return t._addComponentByJsonForMaker(e, i, n), r;
            }, t._createNodeByJsonForMaker = function (e, i, n) {
                var r;
                switch (e.type) {
                    case "Scene3D":
                        r = new Zi();
                        break;

                    case "Sprite3D":
                        r = new Bi();
                        break;

                    case "MeshSprite3D":
                        r = new yn(), i && i.push(r);
                        break;

                    case "SkinnedMeshSprite3D":
                        r = new xn();
                        break;

                    case "ShuriKenParticle3D":
                        r = new En();
                        break;

                    case "Terrain":
                        r = new tn();
                        break;

                    case "Camera":
                        r = new wn();
                        break;

                    case "DirectionLight":
                        r = new Sn();
                        break;

                    case "PointLight":
                        r = new bn();
                        break;

                    case "SpotLight":
                        r = new vn();
                        break;

                    case "TrailSprite3D":
                        r = new Tn();
                        break;

                    default:
                        var a = d.getClass(e.props.runtime);
                        r = new a();
                }
                var s = e.child;
                if (s) for (var o = 0, h = s.length; o < h; o++) {
                    var u = t._createNodeByJsonForMaker(s[o], i, n);
                    r.addChild(u);
                }
                var c = e.compId;
                r.compId = c, r._parse(e.props, null), n && (n._idMap[c] = r), t._compIdToNode[c] = r;
                var _ = e.components;
                if (_) for (var f = 0, p = _.length; f < p; f++) {
                    var m = _[f];
                    if (!(a = l.window.Laya[m.type])) a = l.window, m.type.split(".").forEach(function (t) {
                        a = a[t];
                    });
                    if ("function" == typeof a) {
                        var g = new a();
                        n && (n._idMap[m.compId] = g, console.log(m.compId));
                    } else console.warn("Utils3D:Unkown component type.");
                }
                return r;
            }, t._addComponentByJsonForMaker = function (e, i, n) {
                var r = e.compId, a = t._compIdToNode[r], s = e.child;
                if (s) for (var o = 0, h = s.length; o < h; o++) t._addComponentByJsonForMaker(s[o], i, n);
                var u = e.components;
                if (u) for (var c = 0, d = u.length; c < d; c++) {
                    var _ = u[c];
                    if (!(p = l.window.Laya[_.type])) {
                        var f = _.type.split("."), p = l.window;
                        f.forEach(function (t) {
                            p = p[t];
                        });
                    }
                    if ("function" == typeof p) {
                        var m = n._idMap[_.compId];
                        a.addComponentIntance(m), m._parse(_);
                    } else console.warn("Utils3D:Unkown component type.");
                }
            }, t._createSprite3DInstance = function (e, i, n) {
                var r;
                switch (e.type) {
                    case "Scene3D":
                        r = new Zi();
                        break;

                    case "Sprite3D":
                        r = new Bi();
                        break;

                    case "MeshSprite3D":
                        r = new yn(), n && n.push(r);
                        break;

                    case "SkinnedMeshSprite3D":
                        r = new xn();
                        break;

                    case "ShuriKenParticle3D":
                        r = new En();
                        break;

                    case "Terrain":
                        r = new tn();
                        break;

                    case "Camera":
                        r = new wn();
                        break;

                    case "DirectionLight":
                        r = new Sn();
                        break;

                    case "PointLight":
                        r = new bn();
                        break;

                    case "SpotLight":
                        r = new vn();
                        break;

                    case "TrailSprite3D":
                        r = new Tn();
                        break;

                    default:
                        throw new Error("Utils3D:unidentified class type in (.lh) file.");
                }
                var a = e.child;
                if (a) for (var s = 0, o = a.length; s < o; s++) {
                    var l = t._createSprite3DInstance(a[s], i, n);
                    r.addChild(l);
                }
                return i[e.instanceID] = r, r;
            }, t._createComponentInstance = function (e, i) {
                var n = i[e.instanceID];
                n._parse(e.props, i);
                var r = e.child;
                if (r) for (var a = 0, s = r.length; a < s; a++) t._createComponentInstance(r[a], i);
                var o = e.components;
                if (o) for (var h = 0, u = o.length; h < u; h++) {
                    var c = o[h], d = l.window.Laya[c.type];
                    if (!d) {
                        var _ = c.type.split(".");
                        d = l.window, _.forEach(function (t) {
                            d = d[t];
                        });
                    }
                    if ("function" == typeof d) n.addComponent(d)._parse(c); else console.warn("Unkown component type.");
                }
            }, t._createNodeByJson02 = function (e, i) {
                var n = {}, r = t._createSprite3DInstance(e, n, i);
                return t._createComponentInstance(e, n), r;
            }, t._computeBoneAndAnimationDatasByBindPoseMatrxix = function (t, e, i, n, r, a) {
                var s, o, l = 0, h = 0, u = t.length;
                for (s = 0; s < u; l += t[s].keyframeWidth, h += 16, s++) laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(e[l + 0], e[l + 1], e[l + 2], e[l + 3], e[l + 4], e[l + 5], e[l + 6], e[l + 7], e[l + 8], e[l + 9], n, h),
                    0 != s && (o = 16 * t[s].parentIndex, laya.d3.utils.Utils3D.mulMatrixByArray(n, o, n, h, n, h));
                var c = i.length;
                for (s = 0; s < c; s++) laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n, 16 * a[s], i[s], r, 16 * s);
            }, t._computeAnimationDatasByArrayAndMatrixFast = function (t, e, i, n) {
                for (var r = 0, a = t.length; r < a; r++) laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(e, 16 * n[r], t[r], i, 16 * r);
            }, t._computeBoneAndAnimationDatasByBindPoseMatrxixOld = function (t, e, i, n, r) {
                var a, s, o = 0, l = 0, h = t.length;
                for (a = 0; a < h; o += t[a].keyframeWidth, l += 16, a++) laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(e[o + 7], e[o + 8], e[o + 9], e[o + 3], e[o + 4], e[o + 5], e[o + 6], e[o + 0], e[o + 1], e[o + 2], n, l),
                    0 != a && (s = 16 * t[a].parentIndex, laya.d3.utils.Utils3D.mulMatrixByArray(n, s, n, l, n, l));
                var u = i.length;
                for (a = 0; a < u; a++) {
                    var c = 16 * a;
                    laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n, c, i[a], r, c);
                }
            }, t._computeAnimationDatasByArrayAndMatrixFastOld = function (t, e, i) {
                for (var n = t.length, r = 0; r < n; r++) {
                    var a = 16 * r;
                    laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(e, a, t[r], i, a);
                }
            }, t._computeRootAnimationData = function (t, e, i) {
                for (var n = 0, r = 0, a = 0, s = t.length; n < s; r += t[n].keyframeWidth, a += 16,
                    n++) laya.d3.utils.Utils3D.createAffineTransformationArray(e[r + 0], e[r + 1], e[r + 2], e[r + 3], e[r + 4], e[r + 5], e[r + 6], e[r + 7], e[r + 8], e[r + 9], i, a);
            }, t.transformVector3ArrayByQuat = function (t, e, i, n, r) {
                var a = t[e], s = t[e + 1], o = t[e + 2], l = i.x, h = i.y, u = i.z, c = i.w, d = c * a + h * o - u * s, _ = c * s + u * a - l * o, f = c * o + l * s - h * a, p = -l * a - h * s - u * o;
                n[r] = d * c + p * -l + _ * -u - f * -h, n[r + 1] = _ * c + p * -h + f * -l - d * -u,
                    n[r + 2] = f * c + p * -u + d * -h - _ * -l;
            }, t.mulMatrixByArray = function (e, i, n, r, a, s) {
                var o, l, h, u, c;
                if (a === n) {
                    for (n = t._tempArray16_3, o = 0; o < 16; ++o) n[o] = a[s + o];
                    r = 0;
                }
                for (o = 0; o < 4; o++) l = e[i + o], h = e[i + o + 4], u = e[i + o + 8], c = e[i + o + 12],
                    a[s + o] = l * n[r + 0] + h * n[r + 1] + u * n[r + 2] + c * n[r + 3], a[s + o + 4] = l * n[r + 4] + h * n[r + 5] + u * n[r + 6] + c * n[r + 7],
                    a[s + o + 8] = l * n[r + 8] + h * n[r + 9] + u * n[r + 10] + c * n[r + 11], a[s + o + 12] = l * n[r + 12] + h * n[r + 13] + u * n[r + 14] + c * n[r + 15];
            }, t.mulMatrixByArrayFast = function (t, e, i, n, r, a) {
                var s, o, l, h, u;
                for (s = 0; s < 4; s++) o = t[e + s], l = t[e + s + 4], h = t[e + s + 8], u = t[e + s + 12],
                    r[a + s] = o * i[n + 0] + l * i[n + 1] + h * i[n + 2] + u * i[n + 3], r[a + s + 4] = o * i[n + 4] + l * i[n + 5] + h * i[n + 6] + u * i[n + 7],
                    r[a + s + 8] = o * i[n + 8] + l * i[n + 9] + h * i[n + 10] + u * i[n + 11], r[a + s + 12] = o * i[n + 12] + l * i[n + 13] + h * i[n + 14] + u * i[n + 15];
            }, t.mulMatrixByArrayAndMatrixFast = function (t, e, i, n, r) {
                var a, s, o, l, h, u = i.elements, c = u[0], d = u[1], _ = u[2], f = u[3], p = u[4], m = u[5], g = u[6], y = u[7], v = u[8], S = u[9], T = u[10], E = u[11], C = u[12], x = u[13], b = u[14], I = u[15], w = e, A = e + 4, R = e + 8, M = e + 12, D = r, O = r + 4, L = r + 8, P = r + 12;
                for (a = 0; a < 4; a++) s = t[w + a], o = t[A + a], l = t[R + a], h = t[M + a],
                    n[D + a] = s * c + o * d + l * _ + h * f, n[O + a] = s * p + o * m + l * g + h * y,
                    n[L + a] = s * v + o * S + l * T + h * E, n[P + a] = s * C + o * x + l * b + h * I;
            }, t.createAffineTransformationArray = function (t, e, i, n, r, a, s, o, l, h, u, c) {
                var d = n + n, _ = r + r, f = a + a, p = n * d, m = n * _, g = n * f, y = r * _, v = r * f, S = a * f, T = s * d, E = s * _, C = s * f;
                u[c + 0] = (1 - (y + S)) * o, u[c + 1] = (m + C) * o, u[c + 2] = (g - E) * o, u[c + 3] = 0,
                    u[c + 4] = (m - C) * l, u[c + 5] = (1 - (p + S)) * l, u[c + 6] = (v + T) * l, u[c + 7] = 0,
                    u[c + 8] = (g + E) * h, u[c + 9] = (v - T) * h, u[c + 10] = (1 - (p + y)) * h, u[c + 11] = 0,
                    u[c + 12] = t, u[c + 13] = e, u[c + 14] = i, u[c + 15] = 1;
            }, t.transformVector3ArrayToVector3ArrayCoordinate = function (t, e, i, n, r) {
                var a = t[e + 0], s = t[e + 1], o = t[e + 2], l = i.elements, h = a * l[3] + s * l[7] + o * l[11] + l[15];
                n[r] = a * l[0] + s * l[4] + o * l[8] + l[12] / h, n[r + 1] = a * l[1] + s * l[5] + o * l[9] + l[13] / h,
                    n[r + 2] = a * l[2] + s * l[6] + o * l[10] + l[14] / h;
            }, t.transformLightingMapTexcoordArray = function (t, e, i, n, r) {
                n[r + 0] = t[e + 0] * i.x + i.z, n[r + 1] = 1 - ((1 - t[e + 1]) * i.y + i.w);
            }, t.getURLVerion = function (t) {
                var e = t.indexOf("?");
                return e >= 0 ? t.substr(e) : null;
            }, t._createAffineTransformationArray = function (t, e, i, n) {
                var r = e.x, a = e.y, s = e.z, o = e.w, l = r + r, h = a + a, u = s + s, c = r * l, d = r * h, _ = r * u, f = a * h, p = a * u, m = s * u, g = o * l, y = o * h, v = o * u, S = i.x, T = i.y, E = i.z;
                n[0] = (1 - (f + m)) * S, n[1] = (d + v) * S, n[2] = (_ - y) * S, n[3] = 0, n[4] = (d - v) * T,
                    n[5] = (1 - (c + m)) * T, n[6] = (p + g) * T, n[7] = 0, n[8] = (_ + y) * E, n[9] = (p - g) * E,
                    n[10] = (1 - (c + f)) * E, n[11] = 0, n[12] = t.x, n[13] = t.y, n[14] = t.z, n[15] = 1;
            }, t._mulMatrixArray = function (t, e, i, n) {
                var r, a, s, o, l, h = e.elements, u = h[0], c = h[1], d = h[2], _ = h[3], f = h[4], p = h[5], m = h[6], g = h[7], y = h[8], v = h[9], S = h[10], T = h[11], E = h[12], C = h[13], x = h[14], b = h[15], I = n, w = n + 4, A = n + 8, R = n + 12;
                for (r = 0; r < 4; r++) a = t[r], s = t[r + 4], o = t[r + 8], l = t[r + 12], i[I + r] = a * u + s * c + o * d + l * _,
                    i[w + r] = a * f + s * p + o * m + l * g, i[A + r] = a * y + s * v + o * S + l * T,
                    i[R + r] = a * E + s * C + o * x + l * b;
            }, t.arcTanAngle = function (t, e) {
                return 0 == t ? 1 == e ? Math.PI / 2 : -Math.PI / 2 : t > 0 ? Math.atan(e / t) : t < 0 ? e > 0 ? Math.atan(e / t) + Math.PI : Math.atan(e / t) - Math.PI : 0;
            }, t.angleTo = function (e, i, n) {
                gt.subtract(i, e, ht.TEMPVector30), gt.normalize(ht.TEMPVector30, ht.TEMPVector30),
                    n.x = Math.asin(ht.TEMPVector30.y), n.y = t.arcTanAngle(-ht.TEMPVector30.z, -ht.TEMPVector30.x);
            }, t.transformQuat = function (t, e, i) {
                var n = e, r = t.x, a = t.y, s = t.z, o = n[0], l = n[1], h = n[2], u = n[3], c = u * r + l * s - h * a, d = u * a + h * r - o * s, _ = u * s + o * a - l * r, f = -o * r - l * a - h * s;
                i.x = c * u + f * -o + d * -h - _ * -l, i.y = d * u + f * -l + _ * -o - c * -h,
                    i.z = _ * u + f * -h + c * -l - d * -o;
            }, t.quaternionWeight = function (t, e, i) {
                i.x = t.x * e, i.y = t.y * e, i.z = t.z * e, i.w = t.w;
            }, t.quaternionConjugate = function (t, e) {
                e.x = -t.x, e.y = -t.y, e.z = -t.z, e.w = t.w;
            }, t.scaleWeight = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z;
                i.x = n > 0 ? Math.pow(Math.abs(n), e) : -Math.pow(Math.abs(n), e), i.y = r > 0 ? Math.pow(Math.abs(r), e) : -Math.pow(Math.abs(r), e),
                    i.z = a > 0 ? Math.pow(Math.abs(a), e) : -Math.pow(Math.abs(a), e);
            }, t.scaleBlend = function (e, i, n, r) {
                var a = t._tempVector3_0, s = t._tempVector3_1;
                t.scaleWeight(e, 1 - n, a), t.scaleWeight(i, n, s);
                var o = n > .5 ? i : e;
                r.x = o.x > 0 ? Math.abs(a.x * s.x) : -Math.abs(a.x * s.x), r.y = o.y > 0 ? Math.abs(a.y * s.y) : -Math.abs(a.y * s.y),
                    r.z = o.z > 0 ? Math.abs(a.z * s.z) : -Math.abs(a.z * s.z);
            }, t.gammaToLinearSpace = function (t) {
                return t <= .04045 ? t / 12.92 : t < 1 ? Math.pow((t + .055) / 1.055, 2.4) : Math.pow(t, 2.4);
            }, t.linearToGammaSpace = function (t) {
                return t <= 0 ? 0 : t <= .0031308 ? 12.92 * t : t <= 1 ? 1.055 * Math.pow(t, .41666) - .055 : Math.pow(t, .41666);
            }, t.matrix4x4MultiplyFFF = function (t, e, i) {
                var n, r, a, s, o;
                if (i === e) for (e = new Float32Array(16), n = 0; n < 16; ++n) e[n] = i[n];
                var l = e[0], h = e[1], u = e[2], c = e[3], d = e[4], _ = e[5], f = e[6], p = e[7], m = e[8], g = e[9], y = e[10], v = e[11], S = e[12], T = e[13], E = e[14], C = e[15];
                for (n = 0; n < 4; n++) r = t[n], a = t[n + 4], s = t[n + 8], o = t[n + 12], i[n] = r * l + a * h + s * u + o * c,
                    i[n + 4] = r * d + a * _ + s * f + o * p, i[n + 8] = r * m + a * g + s * y + o * v,
                    i[n + 12] = r * S + a * T + s * E + o * C;
            }, t.matrix4x4MultiplyFFFForNative = function (t, e, i) {
                v.instance.matrix4x4Multiply(t, e, i);
            }, t.matrix4x4MultiplyMFM = function (e, i, n) {
                t.matrix4x4MultiplyFFF(e.elements, i, n.elements);
            }, t._buildTexture2D = function (t, e, i, n, r) {
                void 0 === r && (r = !1);
                var a = new N(t, e, i, r, !0);
                return a.anisoLevel = 1, a.filterMode = 0, Ot._generateTexture2D(a, t, e, n), a;
            }, t._drawBound = function (e, i, n) {
                e.lineCount + 12 > e.maxLineCount && (e.maxLineCount += 12);
                var r = t._tempVector3_0, a = t._tempVector3_1, s = i.min, o = i.max;
                r.setValue(s.x, s.y, s.z), a.setValue(o.x, s.y, s.z), e.addLine(r, a, n, n), r.setValue(s.x, s.y, s.z),
                    a.setValue(s.x, s.y, o.z), e.addLine(r, a, n, n), r.setValue(o.x, s.y, s.z), a.setValue(o.x, s.y, o.z),
                    e.addLine(r, a, n, n), r.setValue(s.x, s.y, o.z), a.setValue(o.x, s.y, o.z), e.addLine(r, a, n, n),
                    r.setValue(s.x, s.y, s.z), a.setValue(s.x, o.y, s.z), e.addLine(r, a, n, n), r.setValue(s.x, s.y, o.z),
                    a.setValue(s.x, o.y, o.z), e.addLine(r, a, n, n), r.setValue(o.x, s.y, s.z), a.setValue(o.x, o.y, s.z),
                    e.addLine(r, a, n, n), r.setValue(o.x, s.y, o.z), a.setValue(o.x, o.y, o.z), e.addLine(r, a, n, n),
                    r.setValue(s.x, o.y, s.z), a.setValue(o.x, o.y, s.z), e.addLine(r, a, n, n), r.setValue(s.x, o.y, s.z),
                    a.setValue(s.x, o.y, o.z), e.addLine(r, a, n, n), r.setValue(o.x, o.y, s.z), a.setValue(o.x, o.y, o.z),
                    e.addLine(r, a, n, n), r.setValue(s.x, o.y, o.z), a.setValue(o.x, o.y, o.z), e.addLine(r, a, n, n);
            }, t._getHierarchyPath = function (t, e, i) {
                i.length = 0;
                for (var n = e; n !== t;) {
                    var r = n._parent;
                    if (!r) return null;
                    i.push(r.getChildIndex(n)), n = r;
                }
                return i;
            }, t._getNodeByHierarchyPath = function (t, e) {
                for (var i = t, n = e.length - 1; n >= 0; n--) i = i.getChildAt(e[n]);
                return i;
            }, t._createNodeByJson = function (e, i) {
                var n;
                switch (e.type) {
                    case "Scene3D":
                        n = new Zi();
                        break;

                    case "Sprite3D":
                        n = new Bi();
                        break;

                    case "MeshSprite3D":
                        n = new yn(), i && i.push(n);
                        break;

                    case "SkinnedMeshSprite3D":
                        n = new xn();
                        break;

                    case "ShuriKenParticle3D":
                        n = new En();
                        break;

                    case "Terrain":
                        n = new tn();
                        break;

                    case "Camera":
                        n = new wn();
                        break;

                    case "DirectionLight":
                        n = new Sn();
                        break;

                    case "PointLight":
                        n = new bn();
                        break;

                    case "SpotLight":
                        n = new vn();
                        break;

                    case "TrailSprite3D":
                        n = new Tn();
                        break;

                    default:
                        throw new Error("Utils3D:unidentified class type in (.lh) file.");
                }
                var r = e.child;
                if (r) for (var a = 0, s = r.length; a < s; a++) {
                    var o = t._createNodeByJson(r[a], i);
                    n.addChild(o);
                }
                var h = e.components;
                if (h) for (var u = 0, c = h.length; u < c; u++) {
                    var d = h[u];
                    if (!(f = l.window.Laya[d.type])) {
                        var _ = d.type.split("."), f = l.window;
                        _.forEach(function (t) {
                            f = f[t];
                        });
                    }
                    if ("function" == typeof f) n.addComponent(f)._parse(d); else console.warn("Unkown component type.");
                }
                return n._parse(e.props, null), n;
            }, t._tempArray16_0 = new Float32Array(16), t._tempArray16_1 = new Float32Array(16),
                t._tempArray16_2 = new Float32Array(16), t._tempArray16_3 = new Float32Array(16),
                n(t, ["_tempVector3_0", function () {
                    return this._tempVector3_0 = new gt();
                }, "_tempVector3_1", function () {
                    return this._tempVector3_1 = new gt();
                }, "_tempVector3_2", function () {
                    return this._tempVector3_2 = new gt();
                }, "_tempColor0", function () {
                    return this._tempColor0 = new Ct();
                }, "_compIdToNode", function () {
                    return this._compIdToNode = new Object();
                }]), t;
        }(), jt = function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(8);
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientDataNumber");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.add = function (t, e) {
                this._currentLength < 8 ? (6 === this._currentLength && 1 !== t && (t = 1, console.log("GradientDataNumber warning:the forth key is  be force set to 1.")),
                    this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e) : console.log("GradientDataNumber warning:data count must lessEqual than 4");
            }, e.getKeyByIndex = function (t) {
                return this._elements[2 * t];
            }, e.getValueByIndex = function (t) {
                return this._elements[2 * t + 1];
            }, e.getAverageValue = function () {
                for (var t = 0, e = this._currentLength - 2; t < e; t += 2) {
                    this._elements[t + 1];
                    this._elements[t + 3], this._elements[t + 2] - this._elements[t];
                }
                return 0;
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var i = e._elements;
                i.length = this._elements.length;
                for (var n = 0, r = this._elements.length; n < r; n++) i[n] = this._elements[n];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientCount", function () {
                return this._currentLength / 2;
            }), t;
        }(), Wt = function () {
            function t() { }
            r(t, "laya.d3.core.pixelLine.PixelLineVertex");
            var e = t.prototype;
            return a(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), a(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), n(t, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(28, [new Ut(0, "vector3", 0), new Ut(12, "vector4", 1)]);
            }]), t;
        }(), Xt = function () {
            function t() {
                this._hitResultsPoolIndex = 0, this._contactPonintsPoolIndex = 0, this._collisions = {},
                    this._hitResultsPool = [], this._contactPointsPool = [], this._collisionsPool = [];
            }
            r(t, "laya.d3.physics.CollisionTool");
            var e = t.prototype;
            return e.getHitResult = function () {
                var t = this._hitResultsPool[this._hitResultsPoolIndex++];
                return t || (t = new ge(), this._hitResultsPool.push(t)), t;
            }, e.recoverAllHitResultsPool = function () {
                this._hitResultsPoolIndex = 0;
            }, e.getContactPoints = function () {
                var t = this._contactPointsPool[this._contactPonintsPoolIndex++];
                return t || (t = new K(), this._contactPointsPool.push(t)), t;
            }, e.recoverAllContactPointsPool = function () {
                this._contactPonintsPoolIndex = 0;
            }, e.getCollision = function (t, e) {
                var i, n = t.id, r = e.id, a = this._collisions[n];
                return a && (i = a[r]), i || (a || (a = {}, this._collisions[n] = a), (i = 0 === this._collisionsPool.length ? new _e() : this._collisionsPool.pop())._colliderA = t,
                    i._colliderB = e, a[r] = i), i;
            }, e.recoverCollision = function (t) {
                var e = t._colliderA.id, i = t._colliderB.id;
                this._collisions[e][i] = null, this._collisionsPool.push(t);
            }, e.garbageCollection = function () {
                for (var t in this._hitResultsPoolIndex = 0, this._hitResultsPool.length = 0, this._contactPonintsPoolIndex = 0,
                    this._contactPointsPool.length = 0, this._collisionsPool.length = 0, this._collisionsPool) {
                    var e = this._collisionsPool[t], i = !0;
                    for (var n in e) e[n] ? i = !1 : delete e[n];
                    i && delete this._collisionsPool[t];
                }
            }, t;
        }(), Yt = function () {
            function t() {
                this._scene = null, this._eventList = [], this._multiTouchEnabled = !0, this._mouseTouch = new re(),
                    this._touchPool = [], this._touches = new hi();
            }
            r(t, "laya.d3.Input3D");
            var e = t.prototype;
            return e.__init__ = function (t, e) {
                this._scene = e;
                var i = this._eventList;
                t.oncontextmenu = function (t) {
                    return !1;
                }, t.addEventListener("mousedown", function (t) {
                    t.preventDefault(), i.push(t);
                }), t.addEventListener("mouseup", function (t) {
                    t.preventDefault(), i.push(t);
                }, !0), t.addEventListener("mousemove", function (t) {
                    t.preventDefault(), i.push(t);
                }, !0), t.addEventListener("touchstart", function (t) {
                    t.preventDefault(), i.push(t);
                }), t.addEventListener("touchend", function (t) {
                    t.preventDefault(), i.push(t);
                }, !0), t.addEventListener("touchmove", function (t) {
                    t.preventDefault(), i.push(t);
                }, !0), t.addEventListener("touchcancel", function (t) {
                    i.push(t);
                }, !0);
            }, e.touchCount = function () {
                return this._touches.length;
            }, e._getTouch = function (t) {
                var e = this._touchPool[t];
                return e || (e = new de(), this._touchPool[t] = e, e._identifier = t), e;
            }, e._mouseTouchDown = function () {
                var t = this._mouseTouch, e = t.sprite;
                if (t._pressedSprite = e, t._pressedLoopCount = O.loopCount, e) {
                    var i = e._scripts;
                    if (i) for (var n = 0, r = i.length; n < r; n++) i[n].onMouseDown();
                }
            }, e._mouseTouchUp = function () {
                var t = 0, e = 0, i = this._mouseTouch, n = i._pressedSprite;
                i._pressedSprite = null, i._pressedLoopCount = -1;
                var r = i.sprite;
                if (r && r === n) {
                    var a = r._scripts;
                    if (a) for (t = 0, e = a.length; t < e; t++) a[t].onMouseClick();
                }
                if (n) {
                    var s = n._scripts;
                    if (s) for (t = 0, e = s.length; t < e; t++) s[t].onMouseUp();
                }
            }, e._mouseTouchRayCast = function (e) {
                var i = t._tempHitResult0, n = t._tempVector20, r = t._tempRay0;
                i.succeeded = !1;
                var a = this._mouseTouch.mousePositionX, s = this._mouseTouch.mousePositionY;
                n.x = a, n.y = s;
                for (var o = e.length - 1; o >= 0; o--) {
                    var l = e[o], h = l.viewport;
                    if (n.x >= h.x && n.y >= h.y && n.x <= h.width && n.y <= h.height) if (l.viewportPointToRay(n, r),
                        this._scene._physicsSimulation.rayCast(r, i) || 0 === l.clearFlag || 1 === l.clearFlag) break;
                }
                var u = this._mouseTouch, c = u.sprite;
                if (i.succeeded) {
                    var d = i.collider.owner;
                    u.sprite = d;
                    var _ = d._scripts;
                    if (c !== d && _) for (var f = 0, p = _.length; f < p; f++) _[f].onMouseEnter();
                } else u.sprite = null;
                if (c && c !== d) {
                    var m = c._scripts;
                    if (m) for (f = 0, p = m.length; f < p; f++) m[f].onMouseOut();
                }
            }, e._changeTouches = function (e, n) {
                for (var r = 0, a = 0, s = this._touches.length, o = 0, l = e.length; o < l; o++) {
                    var h = e[o], u = h.identifier;
                    if (this._multiTouchEnabled || 0 === u) {
                        var c = this._getTouch(u), d = c._position, _ = t._tempPoint;
                        _.setTo(h.pageX, h.pageY), i.stage._canvasTransform.invertTransformPoint(_);
                        var f = _.x, p = _.y;
                        switch (n) {
                            case 0:
                                this._touches.add(c), r += f, a += p;
                                break;

                            case 1:
                                this._touches.remove(c), r -= f, a -= p;
                                break;

                            case 2:
                                r = f - d.x, a = p - d.y;
                        }
                        d.x = f, d.y = p;
                    }
                }
                var m = this._touches.length;
                0 === m ? (this._mouseTouch.mousePositionX = 0, this._mouseTouch.mousePositionY = 0) : (this._mouseTouch.mousePositionX = (this._mouseTouch.mousePositionX * s + r) / m,
                    this._mouseTouch.mousePositionY = (this._mouseTouch.mousePositionY * s + a) / m);
            }, e._update = function () {
                var e, n = 0, r = 0, a = 0;
                e = this._eventList.length;
                var s = this._scene._cameraPool;
                if (e > 0) {
                    for (n = 0; n < e; n++) {
                        var o = this._eventList[n];
                        switch (o.type) {
                            case "mousedown":
                                this._mouseTouchDown();
                                break;

                            case "mouseup":
                                this._mouseTouchUp();
                                break;

                            case "mousemove":
                                var l = t._tempPoint;
                                l.setTo(o.pageX, o.pageY), i.stage._canvasTransform.invertTransformPoint(l), this._mouseTouch.mousePositionX = l.x,
                                    this._mouseTouch.mousePositionY = l.y, this._mouseTouchRayCast(s);
                                break;

                            case "touchstart":
                                var h = this._touches.length;
                                this._changeTouches(o.changedTouches, 0), this._mouseTouchRayCast(s), 0 === h && this._mouseTouchDown();
                                break;

                            case "touchend":
                            case "touchcancel":
                                this._changeTouches(o.changedTouches, 1), 0 === this._touches.length && this._mouseTouchUp();
                                break;

                            case "touchmove":
                                this._changeTouches(o.changedTouches, 2), this._mouseTouchRayCast(s);
                                break;

                            default:
                                throw "Input3D:unkonwn event type.";
                        }
                    }
                    this._eventList.length = 0;
                }
                var u = this._mouseTouch, c = u._pressedSprite;
                if (c && O.loopCount > u._pressedLoopCount) {
                    var d = c._scripts;
                    if (d) for (r = 0, a = d.length; r < a; r++) d[r].onMouseDrag();
                }
                var _ = u.sprite;
                if (_) {
                    var f = _._scripts;
                    if (f) for (r = 0, a = f.length; r < a; r++) f[r].onMouseOver();
                }
            }, e.getTouch = function (t) {
                return t < this._touches.length ? this._touches.elements[t] : null;
            }, a(0, e, "multiTouchEnabled", function () {
                return this._multiTouchEnabled;
            }, function (t) {
                this._multiTouchEnabled = t;
            }), n(t, ["_tempPoint", function () {
                return this._tempPoint = new b();
            }, "_tempVector20", function () {
                return this._tempVector20 = new yt();
            }, "_tempRay0", function () {
                return this._tempRay0 = new q(new gt(), new gt());
            }, "_tempHitResult0", function () {
                return this._tempHitResult0 = new ge();
            }]), t;
        }(), qt = function () {
            function t() { }
            return r(t, "laya.d3.core.particleShuriKen.ShurikenParticleData"), t._getStartLifetimeFromGradient = function (t, e) {
                for (var i = 1, n = t.gradientCount; i < n; i++) {
                    var r = t.getKeyByIndex(i);
                    if (r >= e) {
                        var a = t.getKeyByIndex(i - 1), s = (e - a) / (r - a);
                        return C.lerp(t.getValueByIndex(i - 1), t.getValueByIndex(i), s);
                    }
                }
                throw new Error("ShurikenParticleData: can't get value foam startLifeTimeGradient.");
            }, t._randomInvertRoationArray = function (t, e, i, n, r) {
                var a = NaN;
                n ? (n.seed = r[6], a = n.getFloat(), r[6] = n.seed) : a = Math.random(), a < i ? (e.x = -t.x,
                    e.y = -t.y, e.z = -t.z) : (e.x = t.x, e.y = t.y, e.z = t.z);
            }, t._randomInvertRoation = function (t, e, i, n) {
                var r = NaN;
                return i ? (i.seed = n[6], r = i.getFloat(), n[6] = i.seed) : r = Math.random(),
                    r < e && (t = -t), t;
            }, t.create = function (e, i, n) {
                var r = e.autoRandomSeed, a = e._rand, s = e._randomSeeds;
                switch (e.startColorType) {
                    case 0:
                        var o = e.startColorConstant;
                        t.startColor.x = o.x, t.startColor.y = o.y, t.startColor.z = o.z, t.startColor.w = o.w;
                        break;

                    case 2:
                        r ? pt.lerp(e.startColorConstantMin, e.startColorConstantMax, Math.random(), t.startColor) : (a.seed = s[3],
                            pt.lerp(e.startColorConstantMin, e.startColorConstantMax, a.getFloat(), t.startColor),
                            s[3] = a.seed);
                }
                var l = e.colorOverLifetime;
                if (l && l.enbale) {
                    var h = l.color;
                    switch (h.type) {
                        case 0:
                            t.startColor.x = t.startColor.x * h.constant.x, t.startColor.y = t.startColor.y * h.constant.y,
                                t.startColor.z = t.startColor.z * h.constant.z, t.startColor.w = t.startColor.w * h.constant.w;
                            break;

                        case 2:
                            var u = NaN;
                            r ? u = Math.random() : (a.seed = s[10], u = a.getFloat(), s[10] = a.seed);
                            var c = h.constantMin, d = h.constantMax;
                            t.startColor.x = t.startColor.x * C.lerp(c.x, d.x, u), t.startColor.y = t.startColor.y * C.lerp(c.y, d.y, u),
                                t.startColor.z = t.startColor.z * C.lerp(c.z, d.z, u), t.startColor.w = t.startColor.w * C.lerp(c.w, d.w, u);
                    }
                }
                var _ = t.startSize;
                switch (e.startSizeType) {
                    case 0:
                        if (e.threeDStartSize) {
                            var f = e.startSizeConstantSeparate;
                            _[0] = f.x, _[1] = f.y, _[2] = f.z;
                        } else _[0] = _[1] = _[2] = e.startSizeConstant;
                        break;

                    case 2:
                        if (e.threeDStartSize) {
                            var p = e.startSizeConstantMinSeparate, m = e.startSizeConstantMaxSeparate;
                            r ? (_[0] = C.lerp(p.x, m.x, Math.random()), _[1] = C.lerp(p.y, m.y, Math.random()),
                                _[2] = C.lerp(p.z, m.z, Math.random())) : (a.seed = s[4], _[0] = C.lerp(p.x, m.x, a.getFloat()),
                                    _[1] = C.lerp(p.y, m.y, a.getFloat()), _[2] = C.lerp(p.z, m.z, a.getFloat()), s[4] = a.seed);
                        } else r ? _[0] = _[1] = _[2] = C.lerp(e.startSizeConstantMin, e.startSizeConstantMax, Math.random()) : (a.seed = s[4],
                            _[0] = _[1] = _[2] = C.lerp(e.startSizeConstantMin, e.startSizeConstantMax, a.getFloat()),
                            s[4] = a.seed);
                }
                var g = e.sizeOverLifetime;
                if (g && g.enbale && 1 === g.size.type) {
                    var y = g.size;
                    if (y.separateAxes) r ? (_[0] = _[0] * C.lerp(y.constantMinSeparate.x, y.constantMaxSeparate.x, Math.random()),
                        _[1] = _[1] * C.lerp(y.constantMinSeparate.y, y.constantMaxSeparate.y, Math.random()),
                        _[2] = _[2] * C.lerp(y.constantMinSeparate.z, y.constantMaxSeparate.z, Math.random())) : (a.seed = s[11],
                            _[0] = _[0] * C.lerp(y.constantMinSeparate.x, y.constantMaxSeparate.x, a.getFloat()),
                            _[1] = _[1] * C.lerp(y.constantMinSeparate.y, y.constantMaxSeparate.y, a.getFloat()),
                            _[2] = _[2] * C.lerp(y.constantMinSeparate.z, y.constantMaxSeparate.z, a.getFloat()),
                            s[11] = a.seed); else {
                        var v = NaN;
                        r ? v = C.lerp(y.constantMin, y.constantMax, Math.random()) : (a.seed = s[11], v = C.lerp(y.constantMin, y.constantMax, a.getFloat()),
                            s[11] = a.seed), _[0] = _[0] * v, _[1] = _[1] * v, _[2] = _[2] * v;
                    }
                }
                var S = i.renderMode;
                if (1 !== S) switch (e.startRotationType) {
                    case 0:
                        if (e.threeDStartRotation) {
                            var T = e.startRotationConstantSeparate, E = t._tempVector30;
                            t._randomInvertRoationArray(T, E, e.randomizeRotationDirection, r ? null : a, s),
                                t.startRotation[0] = E.x, t.startRotation[1] = E.y, t.startRotation[2] = 4 !== S ? -E.z : E.z;
                        } else t.startRotation[0] = t._randomInvertRoation(e.startRotationConstant, e.randomizeRotationDirection, r ? null : a, s),
                            t.startRotation[1] = 0, t.startRotation[2] = 0;
                        break;

                    case 2:
                        if (e.threeDStartRotation) {
                            var x = e.startRotationConstantMinSeparate, b = e.startRotationConstantMaxSeparate, I = t._tempVector30;
                            r ? (I.x = C.lerp(x.x, b.x, Math.random()), I.y = C.lerp(x.y, b.y, Math.random()),
                                I.z = C.lerp(x.z, b.z, Math.random())) : (a.seed = s[5], I.x = C.lerp(x.x, b.x, a.getFloat()),
                                    I.y = C.lerp(x.y, b.y, a.getFloat()), I.z = C.lerp(x.z, b.z, a.getFloat()), s[5] = a.seed),
                                t._randomInvertRoationArray(I, I, e.randomizeRotationDirection, r ? null : a, s),
                                t.startRotation[0] = I.x, t.startRotation[1] = I.y, t.startRotation[2] = 4 !== S ? -I.z : I.z;
                        } else r ? t.startRotation[0] = t._randomInvertRoation(C.lerp(e.startRotationConstantMin, e.startRotationConstantMax, Math.random()), e.randomizeRotationDirection, r ? null : a, s) : (a.seed = s[5],
                            t.startRotation[0] = t._randomInvertRoation(C.lerp(e.startRotationConstantMin, e.startRotationConstantMax, a.getFloat()), e.randomizeRotationDirection, r ? null : a, s),
                            s[5] = a.seed);
                }
                switch (e.startLifetimeType) {
                    case 0:
                        t.startLifeTime = e.startLifetimeConstant;
                        break;

                    case 1:
                        t.startLifeTime = t._getStartLifetimeFromGradient(e.startLifeTimeGradient, e.emissionTime);
                        break;

                    case 2:
                        r ? t.startLifeTime = C.lerp(e.startLifetimeConstantMin, e.startLifetimeConstantMax, Math.random()) : (a.seed = s[7],
                            t.startLifeTime = C.lerp(e.startLifetimeConstantMin, e.startLifetimeConstantMax, a.getFloat()),
                            s[7] = a.seed);
                        break;

                    case 3:
                        var w = e.emissionTime;
                        r ? t.startLifeTime = C.lerp(t._getStartLifetimeFromGradient(e.startLifeTimeGradientMin, w), t._getStartLifetimeFromGradient(e.startLifeTimeGradientMax, w), Math.random()) : (a.seed = s[7],
                            t.startLifeTime = C.lerp(t._getStartLifetimeFromGradient(e.startLifeTimeGradientMin, w), t._getStartLifetimeFromGradient(e.startLifeTimeGradientMax, w), a.getFloat()),
                            s[7] = a.seed);
                }
                switch (e.startSpeedType) {
                    case 0:
                        t.startSpeed = e.startSpeedConstant;
                        break;

                    case 2:
                        r ? t.startSpeed = C.lerp(e.startSpeedConstantMin, e.startSpeedConstantMax, Math.random()) : (a.seed = s[8],
                            t.startSpeed = C.lerp(e.startSpeedConstantMin, e.startSpeedConstantMax, a.getFloat()),
                            s[8] = a.seed);
                }
                var A = e.textureSheetAnimation;
                if (A && A.enable) {
                    var R = A.tiles, M = R.x, D = R.y, O = 1 / M, L = 1 / D, P = 0, N = A.startFrame;
                    switch (N.type) {
                        case 0:
                            P = N.constant;
                            break;

                        case 1:
                            r ? P = C.lerp(N.constantMin, N.constantMax, Math.random()) : (a.seed = s[14], P = C.lerp(N.constantMin, N.constantMax, a.getFloat()),
                                s[14] = a.seed);
                    }
                    var B = A.frame;
                    switch (B.type) {
                        case 0:
                            P += B.constant;
                            break;

                        case 2:
                            r ? P += C.lerp(B.constantMin, B.constantMax, Math.random()) : (a.seed = s[15],
                                P += C.lerp(B.constantMin, B.constantMax, a.getFloat()), s[15] = a.seed);
                    }
                    var F = 0;
                    switch (A.type) {
                        case 0:
                            F = Math.floor(P / M);
                            break;

                        case 1:
                            A.randomRow ? r ? F = Math.floor(Math.random() * D) : (a.seed = s[13], F = Math.floor(a.getFloat() * D),
                                s[13] = a.seed) : F = A.rowIndex;
                    }
                    var k = Math.floor(P % M);
                    t.startUVInfo = t.startUVInfo, t.startUVInfo[0] = O, t.startUVInfo[1] = L, t.startUVInfo[2] = k * O,
                        t.startUVInfo[3] = F * L;
                } else t.startUVInfo = t.startUVInfo, t.startUVInfo[0] = 1, t.startUVInfo[1] = 1,
                    t.startUVInfo[2] = 0, t.startUVInfo[3] = 0;
                switch (e.simulationSpace) {
                    case 0:
                        var V = n.position;
                        t.simulationWorldPostion[0] = V.x, t.simulationWorldPostion[1] = V.y, t.simulationWorldPostion[2] = V.z;
                        var U = n.rotation;
                        t.simulationWorldRotation[0] = U.x, t.simulationWorldRotation[1] = U.y, t.simulationWorldRotation[2] = U.z,
                            t.simulationWorldRotation[3] = U.w;
                        break;

                    case 1:
                        break;

                    default:
                        throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.");
                }
            }, t.startLifeTime = NaN, t.startSpeed = NaN, n(t, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempQuaternion", function () {
                return this._tempQuaternion = new ht();
            }, "startColor", function () {
                return this.startColor = new pt();
            }, "startSize", function () {
                return this.startSize = new Float32Array(3);
            }, "startRotation", function () {
                return this.startRotation = new Float32Array(3);
            }, "startUVInfo", function () {
                return this.startUVInfo = new Float32Array(4);
            }, "simulationWorldPostion", function () {
                return this.simulationWorldPostion = new Float32Array(3);
            }, "simulationWorldRotation", function () {
                return this.simulationWorldRotation = new Float32Array(4);
            }]), t;
        }(), Kt = function () {
            function t(t, e, i, n) {
                this._octree = null, this._parent = null, this._children = null, this._isContaion = !1,
                    this.baseLength = 0, this._bounds = new Ue(new gt(), new gt()), this._objects = [],
                    this.center = new gt(), this._setValues(t, e, i, n);
            }
            r(t, "laya.d3.core.scene.BoundsOctreeNode");
            var e = t.prototype;
            return e._setValues = function (t, e, i, n) {
                this._octree = t, this._parent = e, this.baseLength = i, n.cloneTo(this.center);
                var r = this._bounds.min, a = this._bounds.max, s = t._looseness * i / 2;
                r.setValue(n.x - s, n.y - s, n.z - s), a.setValue(n.x + s, n.y + s, n.z + s);
            }, e._getChildBound = function (e) {
                if (null != this._children && this._children[e]) return this._children[e]._bounds;
                var i = this.baseLength / 4, n = this.baseLength / 2 * this._octree._looseness / 2, r = t._tempBoundBox, a = r.min, s = r.max;
                switch (e) {
                    case 0:
                        a.x = this.center.x - i - n, a.y = this.center.y + i - n, a.z = this.center.z - i - n,
                            s.x = this.center.x - i + n, s.y = this.center.y + i + n, s.z = this.center.z - i + n;
                        break;

                    case 1:
                        a.x = this.center.x + i - n, a.y = this.center.y + i - n, a.z = this.center.z - i - n,
                            s.x = this.center.x + i + n, s.y = this.center.y + i + n, s.z = this.center.z - i + n;
                        break;

                    case 2:
                        a.x = this.center.x - i - n, a.y = this.center.y + i - n, a.z = this.center.z + i - n,
                            s.x = this.center.x - i + n, s.y = this.center.y + i + n, s.z = this.center.z + i + n;
                        break;

                    case 3:
                        a.x = this.center.x + i - n, a.y = this.center.y + i - n, a.z = this.center.z + i - n,
                            s.x = this.center.x + i + n, s.y = this.center.y + i + n, s.z = this.center.z + i + n;
                        break;

                    case 4:
                        a.x = this.center.x - i - n, a.y = this.center.y - i - n, a.z = this.center.z - i - n,
                            s.x = this.center.x - i + n, s.y = this.center.y - i + n, s.z = this.center.z - i + n;
                        break;

                    case 5:
                        a.x = this.center.x + i - n, a.y = this.center.y - i - n, a.z = this.center.z - i - n,
                            s.x = this.center.x + i + n, s.y = this.center.y - i + n, s.z = this.center.z - i + n;
                        break;

                    case 6:
                        a.x = this.center.x - i - n, a.y = this.center.y - i - n, a.z = this.center.z + i - n,
                            s.x = this.center.x - i + n, s.y = this.center.y - i + n, s.z = this.center.z + i + n;
                        break;

                    case 7:
                        a.x = this.center.x + i - n, a.y = this.center.y - i - n, a.z = this.center.z + i - n,
                            s.x = this.center.x + i + n, s.y = this.center.y - i + n, s.z = this.center.z + i + n;
                }
                return r;
            }, e._getChildCenter = function (e) {
                if (null != this._children) return this._children[e].center;
                var i = this.baseLength / 4, n = t._tempVector30;
                switch (e) {
                    case 0:
                        n.x = this.center.x - i, n.y = this.center.y + i, n.z = this.center.z - i;
                        break;

                    case 1:
                        n.x = this.center.x + i, n.y = this.center.y + i, n.z = this.center.z - i;
                        break;

                    case 2:
                        n.x = this.center.x - i, n.y = this.center.y + i, n.z = this.center.z + i;
                        break;

                    case 3:
                        n.x = this.center.x + i, n.y = this.center.y + i, n.z = this.center.z + i;
                        break;

                    case 4:
                        n.x = this.center.x - i, n.y = this.center.y - i, n.z = this.center.z - i;
                        break;

                    case 5:
                        n.x = this.center.x + i, n.y = this.center.y - i, n.z = this.center.z - i;
                        break;

                    case 6:
                        n.x = this.center.x - i, n.y = this.center.y - i, n.z = this.center.z + i;
                        break;

                    case 7:
                        n.x = this.center.x + i, n.y = this.center.y - i, n.z = this.center.z + i;
                }
                return n;
            }, e._getChild = function (e) {
                var i = this.baseLength / 4;
                switch (this._children || (this._children = s(8, null)), e) {
                    case 0:
                        return this._children[0] || (this._children[0] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x + -i, this.center.y + i, this.center.z - i)));

                    case 1:
                        return this._children[1] || (this._children[1] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x + i, this.center.y + i, this.center.z - i)));

                    case 2:
                        return this._children[2] || (this._children[2] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x - i, this.center.y + i, this.center.z + i)));

                    case 3:
                        return this._children[3] || (this._children[3] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x + i, this.center.y + i, this.center.z + i)));

                    case 4:
                        return this._children[4] || (this._children[4] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x - i, this.center.y - i, this.center.z - i)));

                    case 5:
                        return this._children[5] || (this._children[5] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x + i, this.center.y - i, this.center.z - i)));

                    case 6:
                        return this._children[6] || (this._children[6] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x - i, this.center.y - i, this.center.z + i)));

                    case 7:
                        return this._children[7] || (this._children[7] = new t(this._octree, this, this.baseLength / 2, new gt(this.center.x + i, this.center.y - i, this.center.z + i)));

                    default:
                        throw "BoundsOctreeNode: unknown index.";
                }
            }, e._shouldMerge = function () {
                for (var t = this._objects.length, e = 0; e < 8; e++) {
                    var i = this._children[e];
                    if (i) {
                        if (null != i._children) return !1;
                        t += i._objects.length;
                    }
                }
                return t <= 8;
            }, e._mergeChildren = function () {
                for (var t = 0; t < 8; t++) {
                    var e = this._children[t];
                    if (e) {
                        e._parent = null;
                        for (var i = e._objects, n = i.length - 1; n >= 0; n--) {
                            var r = i[n];
                            this._objects.push(r), r._setOctreeNode(this);
                        }
                    }
                }
                this._children = null;
            }, e._merge = function () {
                if (null === this._children) {
                    var t = this._parent;
                    t && t._shouldMerge() && (t._mergeChildren(), t._merge());
                }
            }, e._checkAddNode = function (e) {
                if (null == this._children) {
                    if (this._objects.length < 8 || this.baseLength / 2 < this._octree._minSize) return this;
                    for (var i = this._objects.length - 1; i >= 0; i--) {
                        var n = this._objects[i], r = this._bestFitChild(n.bounds.getCenter());
                        t._encapsulates(this._getChildBound(r), n.bounds._getBoundBox()) && (this._objects.splice(this._objects.indexOf(n), 1),
                            this._getChild(r)._add(n));
                    }
                }
                var a = this._bestFitChild(e.bounds.getCenter());
                return t._encapsulates(this._getChildBound(a), e.bounds._getBoundBox()) ? this._getChild(a)._checkAddNode(e) : this;
            }, e._add = function (t) {
                var e = this._checkAddNode(t);
                e._objects.push(t), t._setOctreeNode(e);
            }, e._remove = function (t) {
                var e = this._objects.indexOf(t);
                this._objects.splice(e, 1), t._setOctreeNode(null), this._merge();
            }, e._addUp = function (t) {
                return 1 === Fe.boxContainsBox(this._bounds, t.bounds._getBoundBox()) ? (this._add(t),
                    !0) : !!this._parent && this._parent._addUp(t);
            }, e._getCollidingWithFrustum = function (t, e, i, n) {
                if (i) {
                    var r = e.containsBoundBox(this._bounds);
                    if (O.octreeNodeCulling++, 0 === r) return;
                    i = 2 === r;
                }
                this._isContaion = !i;
                for (var a = t.camera, s = t.scene, o = 0, l = this._objects.length; o < l; o++) {
                    var h = this._objects[o];
                    if (a._isLayerVisible(h._owner.layer) && h._enable) {
                        if (i && (O.frustumCulling++, !h._needRender(e))) continue;
                        h._distanceForSort = gt.distance(h.bounds.getCenter(), n);
                        for (var u = h._renderElements, c = 0, d = u.length; c < d; c++) {
                            var _ = u[c], f = s._getRenderQueue(_.material.renderQueue);
                            f.isTransparent ? _.addToTransparentRenderQueue(t, f) : _.addToOpaqueRenderQueue(t, f);
                        }
                    }
                }
                if (null != this._children) for (o = 0; o < 8; o++) {
                    var p = this._children[o];
                    p && p._getCollidingWithFrustum(t, e, i, n);
                }
            }, e._getCollidingWithBoundBox = function (t, e, i) {
                if (e) {
                    var n = Fe.boxContainsBox(this._bounds, t);
                    if (0 === n) return;
                    e = 2 === n;
                }
                if (e) for (var r = 0, a = this._objects.length; r < a; r++) {
                    var s = this._objects[r];
                    Fe.intersectsBoxAndBox(s.bounds._getBoundBox(), t) && i.push(s);
                }
                if (null != this._children) for (r = 0; r < 8; r++) {
                    this._children[r]._getCollidingWithBoundBox(t, e, i);
                }
            }, e._bestFitChild = function (t) {
                return (t.x <= this.center.x ? 0 : 1) + (t.y >= this.center.y ? 0 : 4) + (t.z <= this.center.z ? 0 : 2);
            }, e._update = function (t) {
                if (1 === Fe.boxContainsBox(this._bounds, t.bounds._getBoundBox())) {
                    var e = this._checkAddNode(t);
                    if (e !== t._getOctreeNode()) {
                        e._objects.push(t), t._setOctreeNode(e);
                        var i = this._objects.indexOf(t);
                        this._objects.splice(i, 1), this._merge();
                    }
                    return !0;
                }
                if (this._parent) {
                    var n = this._parent._addUp(t);
                    return n && (i = this._objects.indexOf(t), this._objects.splice(i, 1), this._merge()),
                        n;
                }
                return !1;
            }, e.add = function (e) {
                return !!t._encapsulates(this._bounds, e.bounds._getBoundBox()) && (this._add(e),
                    !0);
            }, e.remove = function (t) {
                return t._getOctreeNode() === this && (this._remove(t), !0);
            }, e.update = function (t) {
                return t._getOctreeNode() === this && this._update(t);
            }, e.shrinkIfPossible = function (e) {
                if (this.baseLength < 2 * e) return this;
                for (var i = -1, n = 0, r = this._objects.length; n < r; n++) {
                    var a = this._objects[n], s = this._bestFitChild(a.bounds.getCenter());
                    if (0 != n && s != i) return this;
                    var o = this._getChildBound(s);
                    if (!t._encapsulates(o, a.bounds._getBoundBox())) return this;
                    0 == n && (i = s);
                }
                if (null == this._children) {
                    if (-1 != i) {
                        var l = this._getChildCenter(i);
                        this._setValues(this._octree, null, this.baseLength / 2, l);
                    }
                    return this;
                }
                var h = !1;
                for (n = 0, r = this._children.length; n < r; n++) {
                    var u = this._children[n];
                    if (u && u.hasAnyObjects()) {
                        if (h) return this;
                        if (i >= 0 && i != n) return this;
                        h = !0, i = n;
                    }
                }
                if (-1 != i) {
                    var c = this._children[i];
                    return c._parent = null, c;
                }
                return this;
            }, e.hasAnyObjects = function () {
                if (this._objects.length > 0) return !0;
                if (null != this._children) for (var t = 0; t < 8; t++) {
                    var e = this._children[t];
                    if (e && e.hasAnyObjects()) return !0;
                }
                return !1;
            }, e.getCollidingWithBoundBox = function (t, e) {
                this._getCollidingWithBoundBox(t, !0, e);
            }, e.getCollidingWithRay = function (t, e, i) {
                void 0 === i && (i = Number.MAX_VALUE);
                var n = Fe.intersectsRayAndBoxRD(t, this._bounds);
                if (!(-1 == n || n > i)) {
                    for (var r = 0, a = this._objects.length; r < a; r++) {
                        var s = this._objects[r];
                        -1 !== (n = Fe.intersectsRayAndBoxRD(t, s.bounds._getBoundBox())) && n <= i && e.push(s);
                    }
                    if (null != this._children) for (r = 0; r < 8; r++) {
                        this._children[r].getCollidingWithRay(t, e, i);
                    }
                }
            }, e.getCollidingWithFrustum = function (t) {
                var e = t.camera.transform.position, i = t.camera.boundFrustum;
                this._getCollidingWithFrustum(t, i, !0, e);
            }, e.isCollidingWithBoundBox = function (t) {
                if (!Fe.intersectsBoxAndBox(this._bounds, t)) return !1;
                for (var e = 0, i = this._objects.length; e < i; e++) {
                    var n = this._objects[e];
                    if (Fe.intersectsBoxAndBox(n.bounds._getBoundBox(), t)) return !0;
                }
                if (null != this._children) for (e = 0; e < 8; e++) {
                    if (this._children[e].isCollidingWithBoundBox(t)) return !0;
                }
                return !1;
            }, e.isCollidingWithRay = function (t, e) {
                void 0 === e && (e = Number.MAX_VALUE);
                var i = Fe.intersectsRayAndBoxRD(t, this._bounds);
                if (-1 == i || i > e) return !1;
                for (var n = 0, r = this._objects.length; n < r; n++) {
                    var a = this._objects[n];
                    if (-1 !== (i = Fe.intersectsRayAndBoxRD(t, a.bounds._getBoundBox())) && i <= e) return !0;
                }
                if (null != this._children) for (n = 0; n < 8; n++) {
                    if (this._children[n].isCollidingWithRay(t, e)) return !0;
                }
                return !1;
            }, e.getBound = function () {
                return this._bounds;
            }, e.drawAllBounds = function (e, i, n) {
                if (null !== this._children || 0 != this._objects.length) {
                    i++;
                    var r = t._tempColor0;
                    if (this._isContaion) r.r = 0, r.g = 0, r.b = 1; else {
                        var a = n ? i / n : 0;
                        r.r = 1 - a, r.g = a, r.b = 0;
                    }
                    if (r.a = .3, Ht._drawBound(e, this._bounds, r), null != this._children) for (var s = 0; s < 8; s++) {
                        var o = this._children[s];
                        o && o.drawAllBounds(e, i, n);
                    }
                }
            }, e.drawAllObjects = function (e, i, n) {
                i++;
                var r = t._tempColor0;
                if (this._isContaion) r.r = 0, r.g = 0, r.b = 1; else {
                    var a = n ? i / n : 0;
                    r.r = 1 - a, r.g = a, r.b = 0;
                }
                r.a = 1;
                for (var s = 0, o = this._objects.length; s < o; s++) Ht._drawBound(e, this._objects[s].bounds._getBoundBox(), r);
                if (null != this._children) for (s = 0; s < 8; s++) {
                    var l = this._children[s];
                    l && l.drawAllObjects(e, i, n);
                }
            }, t._encapsulates = function (t, e) {
                return 1 == Fe.boxContainsBox(t, e);
            }, t._NUM_OBJECTS_ALLOWED = 8, n(t, ["_tempVector3", function () {
                return this._tempVector3 = new gt();
            }, "_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }, "_tempColor0", function () {
                return this._tempColor0 = new Ct();
            }, "_tempBoundBox", function () {
                return this._tempBoundBox = new Ue(new gt(), new gt());
            }]), t;
        }(), Zt = (function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(12);
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientDataVector2");
            var e = t.prototype;
            i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.add = function (t, e) {
                this._currentLength < 8 ? (6 === this._currentLength && 1 !== t && (t = 1, console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),
                    this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e.x,
                    this._elements[this._currentLength++] = e.y) : console.log("GradientDataVector2 warning:data count must lessEqual than 4");
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var i = e._elements;
                i.length = this._elements.length;
                for (var n = 0, r = this._elements.length; n < r; n++) i[n] = this._elements[n];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientCount", function () {
                return this._currentLength / 3;
            });
        }(), function () {
            function t(t, e, i, n) {
                this._position = null, this._normal = null, this._textureCoord0 = null, this._textureCoord1 = null,
                    this._position = t, this._normal = e, this._textureCoord0 = i, this._textureCoord1 = n;
            }
            r(t, "laya.d3.graphics.Vertex.VertexPositionTerrain");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.graphics.IVertex": !0
            }), a(0, e, "normal", function () {
                return this._normal;
            }), a(0, e, "position", function () {
                return this._position;
            }), a(0, e, "textureCoord0", function () {
                return this._textureCoord0;
            }), a(0, e, "textureCoord1", function () {
                return this._textureCoord1;
            }), a(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), a(1, t, "vertexDeclaration", function () {
                return t._vertexDeclaration;
            }), t.TERRAIN_POSITION0 = 0, t.TERRAIN_NORMAL0 = 1, t.TERRAIN_TEXTURECOORDINATE0 = 2,
                t.TERRAIN_TEXTURECOORDINATE1 = 3, n(t, ["_vertexDeclaration", function () {
                    return this._vertexDeclaration = new fe(40, [new Ut(0, "vector3", 0), new Ut(12, "vector3", 1), new Ut(24, "vector2", 2), new Ut(32, "vector2", 3)]);
                }]), t;
        }()), Qt = function () {
            function t() {
                this._nodes = [];
            }
            r(t, "laya.d3.animation.KeyframeNodeList");
            var e = t.prototype;
            return e.getNodeByIndex = function (t) {
                return this._nodes[t];
            }, e.setNodeByIndex = function (t, e) {
                this._nodes[t] = e;
            }, a(0, e, "count", function () {
                return this._nodes.length;
            }, function (t) {
                this._nodes.length = t;
            }), t;
        }(), Jt = function () {
            function t(t, e, i, n) {
                this._initialSize = NaN, this._rootNode = null, this._looseness = NaN, this._minSize = NaN,
                    this.count = 0, this._motionObjects = new yi(), i > t && (console.warn("Minimum node size must be at least as big as the initial world size. Was: " + i + " Adjusted to: " + t),
                        i = t), this._initialSize = t, this._minSize = i, this._looseness = Math.min(Math.max(n, 1), 2),
                    this._rootNode = new Kt(this, null, t, e);
            }
            r(t, "laya.d3.core.scene.BoundsOctree");
            var e = t.prototype;
            return e._getMaxDepth = function (t, e) {
                e++;
                var i = t._children;
                if (null != i) for (var n = e, r = 0, a = i.length; r < a; r++) {
                    var s = i[r];
                    s && (e = Math.max(this._getMaxDepth(s, n), e));
                }
                return e;
            }, e._grow = function (t) {
                var e = t.x >= 0 ? 1 : -1, i = t.y >= 0 ? 1 : -1, n = t.z >= 0 ? 1 : -1, r = this._rootNode, a = this._rootNode.baseLength / 2, o = 2 * this._rootNode.baseLength, l = this._rootNode.center, h = new gt(l.x + e * a, l.y + i * a, l.z + n * a);
                if (this._rootNode = new Kt(this, null, o, h), r.hasAnyObjects()) {
                    for (var u = this._rootNode._bestFitChild(r.center), c = s(8, null), d = 0; d < 8; d++) d == u && (r._parent = this._rootNode,
                        c[d] = r);
                    this._rootNode._children = c;
                }
            }, e.add = function (e) {
                for (var i = 0; !this._rootNode.add(e);) {
                    var n = t._tempVector30;
                    if (gt.subtract(e.bounds.getCenter(), this._rootNode.center, n), this._grow(n),
                        ++i > 20) throw "Aborted Add operation as it seemed to be going on forever (" + (i - 1) + ") attempts at growing the octree.";
                }
                this.count++;
            }, e.remove = function (t) {
                var e = t._getOctreeNode().remove(t);
                return e && this.count--, e;
            }, e.update = function (t) {
                var e = 0, i = t._getOctreeNode();
                if (i) {
                    for (; !i._update(t);) if (this._grow(t.bounds.getCenter()), ++e > 20) throw "Aborted Add operation as it seemed to be going on forever (" + (e - 1) + ") attempts at growing the octree.";
                    return !0;
                }
                return !1;
            }, e.shrinkRootIfPossible = function () {
                this._rootNode = this._rootNode.shrinkIfPossible(this._initialSize);
            }, e.addMotionObject = function (t) {
                this._motionObjects.add(t);
            }, e.removeMotionObject = function (t) {
                this._motionObjects.remove(t);
            }, e.updateMotionObjects = function () {
                for (var t = this._motionObjects.elements, e = 0, i = this._motionObjects.length; e < i; e++) {
                    var n = t[e];
                    this.update(n), n._setIndexInMotionList(-1);
                }
                this._motionObjects.length = 0;
            }, e.isCollidingWithBoundBox = function (t) {
                return this._rootNode.isCollidingWithBoundBox(t);
            }, e.isCollidingWithRay = function (t, e) {
                return void 0 === e && (e = Number.MAX_VALUE), this._rootNode.isCollidingWithRay(t, e);
            }, e.getCollidingWithBoundBox = function (t, e) {
                this._rootNode.getCollidingWithBoundBox(t, e);
            }, e.getCollidingWithRay = function (t, e, i) {
                void 0 === i && (i = Number.MAX_VALUE), this._rootNode.getCollidingWithRay(t, e, i);
            }, e.getCollidingWithFrustum = function (t) {
                this._rootNode.getCollidingWithFrustum(t);
            }, e.getMaxBounds = function () {
                return this._rootNode.getBound();
            }, e.drawAllBounds = function (t) {
                var e = this._getMaxDepth(this._rootNode, -1);
                this._rootNode.drawAllBounds(t, -1, e);
            }, e.drawAllObjects = function (t) {
                var e = this._getMaxDepth(this._rootNode, -1);
                this._rootNode.drawAllObjects(t, -1, e);
            }, n(t, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }]), t;
        }(), $t = function () {
            function t(t) {
                this._owner = null, this._sharedMesh = null, this._owner = t;
            }
            r(t, "laya.d3.core.MeshFilter");
            var e = t.prototype;
            return e._getMeshDefine = function (t) {
                for (var e = 0, i = 0, n = t._subMeshCount; i < n; i++) for (var r = t._getSubMesh(i)._vertexBuffer._vertexDeclaration.vertexElements, a = 0, s = r.length; a < s; a++) {
                    switch (r[a].elementUsage) {
                        case 1:
                            e |= yn.SHADERDEFINE_COLOR;
                            break;

                        case 2:
                            e |= yn.SHADERDEFINE_UV0;
                            break;

                        case 7:
                            e |= yn.SHADERDEFINE_UV1;
                    }
                }
                return e;
            }, e.destroy = function () {
                this._owner = null, this._sharedMesh && (this._sharedMesh._removeReference(), this._sharedMesh = null);
            }, a(0, e, "sharedMesh", function () {
                return this._sharedMesh;
            }, function (t) {
                if (this._sharedMesh !== t) {
                    var e = this._owner._render._defineDatas, i = this._sharedMesh;
                    i && (i._removeReference(), e.remove(this._getMeshDefine(i))), t._addReference(),
                        this._sharedMesh = t, e.add(this._getMeshDefine(t)), this._owner._render._changeRenderObjectsByMesh(t);
                }
                this._owner._render._onMeshChange(t);
            }), t;
        }(), te = function () {
            function t(t) {
                this._minVertexDistance = NaN, this._widthMultiplier = NaN, this._time = NaN, this._widthCurve = null,
                    this._colorGradient = null, this._textureMode = 0, this._trialGeometry = null, this._totalLength = 0,
                    this._owner = null, this._curtime = 0, this._trailRenderElementIndex = 0, this._lastPosition = new gt(),
                    this.alignment = 0, this._owner = t, this._initDefaultData(), this.addRenderElement();
            }
            r(t, "laya.d3.core.trail.TrailFilter");
            var e = t.prototype;
            return e.addRenderElement = function () {
                var t = this._owner._render, e = t._renderElements, i = t.sharedMaterials[0];
                i || (i = en.defaultMaterial);
                var n = new At();
                n.setTransform(this._owner._transform), n.render = t, n.material = i, this._trialGeometry = new di(this),
                    n.setGeometry(this._trialGeometry), e.push(n);
            }, e._update = function (t) {
                var e = this._owner._render;
                this._curtime += t.scene.timer._delta / 1e3, e._shaderValues.setNumber(Tn.CURTIME, this._curtime);
                var i = this._owner.transform.position, n = e._renderElements[0]._geometry;
                n._updateDisappear(), n._updateTrail(t.camera, this._lastPosition, i), n._updateVertexBufferUV(),
                    i.cloneTo(this._lastPosition);
            }, e._initDefaultData = function () {
                this.time = 5, this.minVertexDistance = .1, this.widthMultiplier = 1, this.textureMode = 0;
                var t = [], e = new mi();
                e.time = 0, e.inTangent = 0, e.outTangent = 0, e.value = 1, t.push(e);
                var i = new mi();
                i.time = 1, i.inTangent = 0, i.outTangent = 0, i.value = 1, t.push(i), this.widthCurve = t;
                var n = new lt(2, 2);
                n.mode = 0, n.addColorRGB(0, Ct.WHITE), n.addColorRGB(1, Ct.WHITE), n.addColorAlpha(0, 1),
                    n.addColorAlpha(1, 1), this.colorGradient = n;
            }, e.destroy = function () {
                this._trialGeometry.destroy(), this._trialGeometry = null, this._widthCurve = null,
                    this._colorGradient = null;
            }, a(0, e, "widthMultiplier", function () {
                return this._widthMultiplier;
            }, function (t) {
                this._widthMultiplier = t;
            }), a(0, e, "time", function () {
                return this._time;
            }, function (t) {
                this._time = t, this._owner._render._shaderValues.setNumber(Tn.LIFETIME, t);
            }), a(0, e, "widthCurve", function () {
                return this._widthCurve;
            }, function (t) {
                this._widthCurve = t;
                var e, i = new Float32Array(4 * t.length), n = 0, r = 0;
                for (n = 0, e = t.length; n < e; n++) i[r++] = t[n].time, i[r++] = t[n].inTangent,
                    i[r++] = t[n].outTangent, i[r++] = t[n].value;
                this._owner._render._shaderValues.setBuffer(Tn.WIDTHCURVE, i), this._owner._render._shaderValues.setInt(Tn.WIDTHCURVEKEYLENGTH, t.length);
            }), a(0, e, "minVertexDistance", function () {
                return this._minVertexDistance;
            }, function (t) {
                this._minVertexDistance = t;
            }), a(0, e, "colorGradient", function () {
                return this._colorGradient;
            }, function (t) {
                this._colorGradient = t, this._owner._render._shaderValues.setBuffer(Tn.GRADIENTCOLORKEY, t._rgbElements),
                    this._owner._render._shaderValues.setBuffer(Tn.GRADIENTALPHAKEY, t._alphaElements),
                    0 == t.mode ? this._owner._render._defineDatas.add(Tn.SHADERDEFINE_GRADIENTMODE_BLEND) : this._owner._render._defineDatas.remove(Tn.SHADERDEFINE_GRADIENTMODE_BLEND);
            }), a(0, e, "textureMode", function () {
                return this._textureMode;
            }, function (t) {
                this._textureMode = t;
            }), t.ALIGNMENT_VIEW = 0, t.ALIGNMENT_TRANSFORM_Z = 1, t;
        }(), ee = function () {
            function t() { }
            r(t, "laya.d3.core.trail.VertexTrail");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.graphics.IVertex": !0
            }), a(0, e, "vertexDeclaration", function () {
                return t._vertexDeclaration1;
            }), a(1, t, "vertexDeclaration1", function () {
                return t._vertexDeclaration1;
            }), a(1, t, "vertexDeclaration2", function () {
                return t._vertexDeclaration2;
            }), t.TRAIL_POSITION0 = 0, t.TRAIL_OFFSETVECTOR = 1, t.TRAIL_TIME0 = 2, t.TRAIL_TEXTURECOORDINATE0Y = 3,
                t.TRAIL_TEXTURECOORDINATE0X = 4, n(t, ["_vertexDeclaration1", function () {
                    return this._vertexDeclaration1 = new fe(32, [new Ut(0, "vector3", 0), new Ut(12, "vector3", 1), new Ut(24, "single", 2), new Ut(28, "single", 3)]);
                }, "_vertexDeclaration2", function () {
                    return this._vertexDeclaration2 = new fe(4, [new Ut(0, "single", 4)]);
                }]), t;
        }(), ie = function () {
            function t(t, e, i) {
                this._time = NaN, this._minCount = 0, this._maxCount = 0, this._time = t, this._minCount = e,
                    this._maxCount = i;
            }
            r(t, "laya.d3.core.particleShuriKen.module.Burst");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._time = this._time, e._minCount = this._minCount, e._maxCount = this._maxCount;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "time", function () {
                return this._time;
            }), a(0, e, "minCount", function () {
                return this._minCount;
            }), a(0, e, "maxCount", function () {
                return this._maxCount;
            }), t;
        }(), ne = function () {
            function t() {
                this.time = NaN, this.eventName = null, this.params = null;
            }
            return r(t, "laya.d3.animation.AnimationEvent"), t;
        }(), re = (function () {
            function t() {
                this._nativeConstraint = null, this._simulation = null, this.rigidbodyA = null,
                    this.rigidbodyB = null;
            }
            r(t, "laya.d3.physics.Constraint3D");
        }(), function () {
            function t() {
                this._pressedSprite = null, this._pressedLoopCount = -1, this.sprite = null, this.mousePositionX = 0,
                    this.mousePositionY = 0;
            }
            return r(t, "laya.d3.MouseTouch"), t;
        }()), ae = function () {
            function t() {
                this._currentLength = 0, this._elements = null, this._elements = new Float32Array(8);
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientDataInt");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.add = function (t, e) {
                this._currentLength < 8 ? (6 === this._currentLength && 1 !== t && (t = 1, console.log("Warning:the forth key is  be force set to 1.")),
                    this._elements[this._currentLength++] = t, this._elements[this._currentLength++] = e) : console.log("Warning:data count must lessEqual than 4");
            }, e.cloneTo = function (t) {
                var e = t;
                e._currentLength = this._currentLength;
                var i = e._elements;
                i.length = this._elements.length;
                for (var n = 0, r = this._elements.length; n < r; n++) i[n] = this._elements[n];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientCount", function () {
                return this._currentLength / 2;
            }), t;
        }(), se = function () {
            function t(t, e, i, n) {
                this._attributeMap = null, this._uniformMap = null, this._publicDefines = null,
                    this._publicDefinesMap = null, this._spriteDefines = null, this._spriteDefinesMap = null,
                    this._materialDefines = null, this._materialDefinesMap = null, this._owner = null,
                    this._flags = {}, this._passes = [], this._publicDefines = [], this._publicDefinesMap = {},
                    this._spriteDefines = [], this._spriteDefinesMap = {}, this._materialDefines = [],
                    this._materialDefinesMap = {}, this._addDefines(this._publicDefines, this._publicDefinesMap, Lt._globleDefines),
                    i && this._addDefines(this._spriteDefines, this._spriteDefinesMap, i.defines), n && this._addDefines(this._materialDefines, this._materialDefinesMap, n.defines),
                    this._attributeMap = t, this._uniformMap = e;
            }
            r(t, "laya.d3.shader.SubShader");
            var e = t.prototype;
            return e._addDefines = function (t, e, i) {
                for (var n in i) {
                    var r = i[n], a = parseInt(n);
                    t[a] = r, e[r] = a;
                }
            }, e.getMaterialDefineByName = function (t) {
                return this._materialDefinesMap[t];
            }, e.setFlag = function (t, e) {
                e ? this._flags[t] = e : delete this._flags[t];
            }, e.getFlag = function (t) {
                return this._flags[t];
            }, e.addShaderPass = function (t, e, i) {
                var n = new Qe(this, t, e, i);
                return this._passes.push(n), n;
            }, t;
        }(), oe = function () {
            function t() {
                this.source = null, this.destination = null, this.camera = null, this.compositeShaderData = null,
                    this.compositeDefineData = null, this.command = null, this.tempRenderTextures = [];
            }
            return r(t, "laya.d3.core.render.PostProcessRenderContext"), t;
        }(), le = function () {
            function t() {
                this._commands = [];
            }
            r(t, "laya.d3.core.render.command.CommandBuffer");
            var e = t.prototype;
            return e._apply = function () {
                for (var t = 0, e = this._commands.length; t < e; t++) this._commands[t].run();
            }, e.setShaderDataTexture = function (t, e, i) {
                this._commands.push(Ii.create(t, e, i));
            }, e.blit = function (t, e, i, n, r) {
                void 0 === r && (r = 0), this._commands.push(ii.create(t, e, i, n, r));
            }, e.setRenderTarget = function (t) {
                this._commands.push(vi.create(t));
            }, e.clear = function () {
                for (var t = 0, e = this._commands.length; t < e; t++) this._commands[t].recover();
                this._commands.length = 0;
            }, t.SCREENTEXTURE_NAME = "u_ScreenTexture", n(t, ["screenShader", function () {
                return this.screenShader = Lt.find("ScreenQuad");
            }, "SCREENTEXTURE_ID", function () {
                return this.SCREENTEXTURE_ID = Lt.propertyNameToID("u_ScreenTexture");
            }]), t;
        }(), he = function () {
            function t() {
                this._type = 0, this._separateAxes = !1, this._constant = NaN, this._constantSeparate = null,
                    this._gradient = null, this._gradientX = null, this._gradientY = null, this._gradientZ = null,
                    this._gradientW = null, this._constantMin = NaN, this._constantMax = NaN, this._constantMinSeparate = null,
                    this._constantMaxSeparate = null, this._gradientMin = null, this._gradientMax = null,
                    this._gradientXMin = null, this._gradientXMax = null, this._gradientYMin = null,
                    this._gradientYMax = null, this._gradientZMin = null, this._gradientZMax = null,
                    this._gradientWMin = null, this._gradientWMax = null;
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientAngularVelocity");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._separateAxes = this._separateAxes, e._constant = this._constant,
                    this._constantSeparate.cloneTo(e._constantSeparate), this._gradient.cloneTo(e._gradient),
                    this._gradientX.cloneTo(e._gradientX), this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ),
                    e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._constantMinSeparate.cloneTo(e._constantMinSeparate),
                    this._constantMaxSeparate.cloneTo(e._constantMaxSeparate), this._gradientMin.cloneTo(e._gradientMin),
                    this._gradientMax.cloneTo(e._gradientMax), this._gradientXMin.cloneTo(e._gradientXMin),
                    this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin),
                    this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin),
                    this._gradientZMax.cloneTo(e._gradientZMax);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientZ", function () {
                return this._gradientZ;
            }), a(0, e, "constant", function () {
                return this._constant;
            }), a(0, e, "gradient", function () {
                return this._gradient;
            }), a(0, e, "separateAxes", function () {
                return this._separateAxes;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "constantSeparate", function () {
                return this._constantSeparate;
            }), a(0, e, "gradientX", function () {
                return this._gradientX;
            }), a(0, e, "gradientY", function () {
                return this._gradientY;
            }), a(0, e, "gradientW", function () {
                return this._gradientW;
            }), a(0, e, "gradientMin", function () {
                return this._gradientMin;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "gradientMax", function () {
                return this._gradientMax;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), a(0, e, "gradientWMin", function () {
                return this._gradientWMin;
            }), a(0, e, "constantMinSeparate", function () {
                return this._constantMinSeparate;
            }), a(0, e, "constantMaxSeparate", function () {
                return this._constantMaxSeparate;
            }), a(0, e, "gradientXMin", function () {
                return this._gradientXMin;
            }), a(0, e, "gradientXMax", function () {
                return this._gradientXMax;
            }), a(0, e, "gradientWMax", function () {
                return this._gradientWMax;
            }), a(0, e, "gradientYMin", function () {
                return this._gradientYMin;
            }), a(0, e, "gradientYMax", function () {
                return this._gradientYMax;
            }), a(0, e, "gradientZMin", function () {
                return this._gradientZMin;
            }), a(0, e, "gradientZMax", function () {
                return this._gradientZMax;
            }), t.createByConstant = function (e) {
                var i = new t();
                return i._type = 0, i._separateAxes = !1, i._constant = e, i;
            }, t.createByConstantSeparate = function (e) {
                var i = new t();
                return i._type = 0, i._separateAxes = !0, i._constantSeparate = e, i;
            }, t.createByGradient = function (e) {
                var i = new t();
                return i._type = 1, i._separateAxes = !1, i._gradient = e, i;
            }, t.createByGradientSeparate = function (e, i, n) {
                var r = new t();
                return r._type = 1, r._separateAxes = !0, r._gradientX = e, r._gradientY = i, r._gradientZ = n,
                    r;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 2, n._separateAxes = !1, n._constantMin = e, n._constantMax = i,
                    n;
            }, t.createByRandomTwoConstantSeparate = function (e, i) {
                var n = new t();
                return n._type = 2, n._separateAxes = !0, n._constantMinSeparate = e, n._constantMaxSeparate = i,
                    n;
            }, t.createByRandomTwoGradient = function (e, i) {
                var n = new t();
                return n._type = 3, n._separateAxes = !1, n._gradientMin = e, n._gradientMax = i,
                    n;
            }, t.createByRandomTwoGradientSeparate = function (e, i, n, r, a, s, o, l) {
                var h = new t();
                return h._type = 3, h._separateAxes = !0, h._gradientXMin = e, h._gradientXMax = i,
                    h._gradientYMin = n, h._gradientYMax = r, h._gradientZMin = a, h._gradientZMax = s,
                    h._gradientWMin = o, h._gradientWMax = l, h;
            }, t;
        }(), ue = function () {
            function t() {
                this._defaultPhysicsMemory = 16, this._editerEnvironment = !1, this.isAntialias = !0,
                    this.isAlpha = !1, this.premultipliedAlpha = !0, this.isStencil = !0, this.octreeCulling = !1,
                    this.octreeInitialSize = 64, this.octreeMinNodeSize = 2, this.octreeLooseness = 1.25,
                    this.debugFrustumCulling = !1, this.octreeInitialCenter = new gt(0, 0, 0);
            }
            r(t, "Config3D");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._defaultPhysicsMemory = this._defaultPhysicsMemory, e._editerEnvironment = this._editerEnvironment,
                    e.isAntialias = this.isAntialias, e.isAlpha = this.isAlpha, e.premultipliedAlpha = this.premultipliedAlpha,
                    e.isStencil = this.isStencil, e.octreeCulling = this.octreeCulling, this.octreeInitialCenter.cloneTo(e.octreeInitialCenter),
                    e.octreeMinNodeSize = this.octreeMinNodeSize, e.octreeLooseness = this.octreeLooseness,
                    e.debugFrustumCulling = this.debugFrustumCulling;
            }, e.clone = function () {
                var e = new t();
                return this.cloneTo(e), e;
            }, a(0, e, "defaultPhysicsMemory", function () {
                return this._defaultPhysicsMemory;
            }, function (t) {
                if (t < 16) throw "defaultPhysicsMemory must large than 16M";
                this._defaultPhysicsMemory = t;
            }), n(t, ["_default", function () {
                return this._default = new t();
            }]), t;
        }(), ce = (function () {
            function t(t) {
                if (this._state0U = NaN, this._state0L = NaN, this._state1U = NaN, this._state1L = NaN,
                    !(t instanceof Array) || 4 !== t.length) throw new Error("Rand:Seed must be an array with 4 numbers");
                this._state0U = 0 | t[0], this._state0L = 0 | t[1], this._state1U = 0 | t[2], this._state1L = 0 | t[3];
            }
            r(t, "laya.d3.math.RandX");
            var e = t.prototype;
            e.randomint = function () {
                var t = this._state0U, e = this._state0L, i = this._state1U, n = this._state1L, r = (n >>> 0) + (e >>> 0), a = i + t + (r / 2 >>> 31) >>> 0, s = r >>> 0;
                this._state0U = i, this._state0L = n;
                var o = 0, l = 0;
                o = (t ^= o = t << 23 | (-512 & e) >>> 9) ^ i, l = (e ^= l = e << 23) ^ n;
                o ^= t >>> 18, l ^= e >>> 18 | (262143 & t) << 14;
                return o ^= i >>> 5, l ^= n >>> 5 | (31 & i) << 27, this._state1U = o, this._state1L = l,
                    [a, s];
            }, e.random = function () {
                var e = this.randomint(), i = e[0], n = 1023 << 20 | i >>> 12, r = 0 | (e[1] >>> 12 | (4095 & i) << 20);
                return t._CONVERTION_BUFFER.setUint32(0, n, !1), t._CONVERTION_BUFFER.setUint32(4, r, !1),
                    Pt._CONVERTION_BUFFER.getFloat64(0, !1) - 1;
            }, n(t, ["_CONVERTION_BUFFER", function () {
                return this._CONVERTION_BUFFER = new DataView(new ArrayBuffer(8));
            }, "defaultRand", function () {
                return this.defaultRand = new Pt([0, Date.now() / 65536, 0, Date.now() % 65536]);
            }]);
        }(), function () {
            function t() { }
            return r(t, "laya.d3.utils.Picker"), t.calculateCursorRay = function (e, i, n, r, a, s) {
                var o = e.x, l = e.y, h = t._tempVector30, u = h;
                u.x = o, u.y = l, u.z = i.minDepth;
                var c = t._tempVector31, d = c;
                d.x = o, d.y = l, d.z = i.maxDepth;
                var _ = s.origin, f = t._tempVector32;
                i.unprojectFromWVP(h, n, r, a, _), i.unprojectFromWVP(c, n, r, a, f);
                var p = s.direction;
                p.x = f.x - _.x, p.y = f.y - _.y, p.z = f.z - _.z, gt.normalize(s.direction, s.direction);
            }, t.rayIntersectsTriangle = function (e, i, n, r) {
                var a = t._tempVector30, s = t._tempVector31;
                gt.subtract(n, i, a), gt.subtract(r, i, s);
                var o, l = t._tempVector32;
                if (gt.cross(e.direction, s, l), (o = gt.dot(a, l)) > -Number.MIN_VALUE && o < Number.MIN_VALUE) return Number.NaN;
                var h, u = 1 / o, c = t._tempVector33;
                if (gt.subtract(e.origin, i, c), h = gt.dot(c, l), (h *= u) < 0 || h > 1) return Number.NaN;
                var d, _, f = t._tempVector34;
                return gt.cross(c, a, f), d = gt.dot(e.direction, f), (d *= u) < 0 || h + d > 1 ? Number.NaN : (_ = gt.dot(s, f),
                    (_ *= u) < 0 ? Number.NaN : _);
            }, n(t, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }, "_tempVector32", function () {
                return this._tempVector32 = new gt();
            }, "_tempVector33", function () {
                return this._tempVector33 = new gt();
            }, "_tempVector34", function () {
                return this._tempVector34 = new gt();
            }]), t;
        }()), de = function () {
            function t() {
                this._indexInList = -1, this._identifier = -1, this._position = new yt();
            }
            r(t, "laya.d3.Touch");
            var e = t.prototype;
            return i.imps(e, {
                "laya.resource.ISingletonElement": !0
            }), e._getIndexInList = function () {
                return this._indexInList;
            }, e._setIndexInList = function (t) {
                this._indexInList = t;
            }, a(0, e, "identifier", function () {
                return this._identifier;
            }), a(0, e, "position", function () {
                return this._position;
            }), t;
        }(), _e = (function () {
            function t() {
                this.startPosition = new gt(), this.endPosition = new gt(), this.startColor = new Ct(),
                    this.endColor = new Ct();
            }
            r(t, "laya.d3.core.pixelLine.PixelLineData"), t.prototype.cloneTo = function (t) {
                this.startPosition.cloneTo(t.startPosition), this.endPosition.cloneTo(t.endPosition),
                    this.startColor.cloneTo(t.startColor), this.endColor.cloneTo(t.endColor);
            };
        }(), function () {
            function t() {
                this._lastUpdateFrame = -2147483648, this._updateFrame = -2147483648, this._isTrigger = !1,
                    this.contacts = [];
            }
            return r(t, "laya.d3.physics.Collision"), t.prototype._setUpdateFrame = function (t) {
                this._lastUpdateFrame = this._updateFrame, this._updateFrame = t;
            }, t;
        }()), fe = function () {
            function t(e, i) {
                this._id = 0, this._vertexStride = 0, this._vertexElementsDic = null, this._shaderValues = null,
                    this._defineDatas = null, this.vertexElements = null, this._id = ++t._uniqueIDCounter,
                    this._defineDatas = new Vt(), this._vertexElementsDic = {}, this._vertexStride = e,
                    this.vertexElements = i;
                var n = i.length;
                this._shaderValues = new ut(null);
                for (var r = 0; r < n; r++) {
                    var a = i[r], s = a.elementUsage;
                    this._vertexElementsDic[s] = a;
                    var o = new Int32Array(5), l = De.getElementInfos(a.elementFormat);
                    o[0] = l[0], o[1] = l[1], o[2] = l[2], o[3] = this._vertexStride, o[4] = a.offset,
                        this._shaderValues.setAttribute(s, o);
                }
            }
            r(t, "laya.d3.graphics.VertexDeclaration");
            var e = t.prototype;
            return e.getVertexElementByUsage = function (t) {
                return this._vertexElementsDic[t];
            }, e.unBinding = function () { }, a(0, e, "id", function () {
                return this._id;
            }), a(0, e, "vertexStride", function () {
                return this._vertexStride;
            }), t._uniqueIDCounter = 1, t;
        }(), pe = function () {
            function t() {
                this._material = null, this._mesh = Ei.instance;
            }
            r(t, "laya.d3.resource.models.SkyRenderer");
            var e = t.prototype;
            return e._isAvailable = function () {
                return this._material && this._mesh;
            }, e._render = function (t) {
                if (this._material && this._mesh) {
                    var e = v.instance, i = t.scene, n = t.camera;
                    k.setCullFace(e, !1), k.setDepthFunc(e, 515), k.setDepthMask(e, !1);
                    var r = t.shader = this._material._shader.getSubShaderAt(0)._passes[0].withCompile(0, 0, this._material._defineDatas.value), a = r.bind(), s = O.loopCount !== r._uploadMark, o = r._uploadScene !== i || s;
                    (o || a) && (r.uploadUniforms(r._sceneUniformParamsMap, i._shaderValues, o), r._uploadScene = i);
                    var l = r._uploadCamera !== n || s;
                    (l || a) && (r.uploadUniforms(r._cameraUniformParamsMap, n._shaderValues, l), r._uploadCamera = n);
                    var h = r._uploadMaterial !== this._material || s;
                    (h || a) && (r.uploadUniforms(r._materialUniformParamsMap, this._material._shaderValues, h),
                        r._uploadMaterial = this._material), this._mesh._bufferState.bind(), this._mesh._render(t),
                        k.setDepthFunc(e, 513), k.setDepthMask(e, !0);
                }
            }, e.destroy = function () {
                this._material && (this._material._removeReference(), this._material = null);
            }, a(0, e, "material", function () {
                return this._material;
            }, function (t) {
                this._material !== t && (this._material && this._material._removeReference(), t && t._addReference(),
                    this._material = t);
            }), a(0, e, "mesh", function () {
                return this._mesh;
            }, function (t) {
                this._mesh !== t && (this._mesh = t);
            }), t;
        }(), me = (function () {
            function t() { }
            r(t, "laya.d3.animation.AnimatorStateScript");
            var e = t.prototype;
            e.onStateEnter = function () { }, e.onStateUpdate = function () { }, e.onStateExit = function () { };
        }(), function () {
            function t() {
                this.updateMark = -1, this.indexInList = -1, this.batched = !1;
            }
            return r(t, "laya.d3.core.render.BatchMark"), t;
        }()), ge = function () {
            function t() {
                this.succeeded = !1, this.collider = null, this.hitFraction = 0, this.point = new gt(),
                    this.normal = new gt();
            }
            return r(t, "laya.d3.physics.HitResult"), t;
        }(), ye = function () {
            function t() {
                this._type = 0, this._separateAxes = !1, this._gradient = null, this._gradientX = null,
                    this._gradientY = null, this._gradientZ = null, this._constantMin = NaN, this._constantMax = NaN,
                    this._constantMinSeparate = null, this._constantMaxSeparate = null, this._gradientMin = null,
                    this._gradientMax = null, this._gradientXMin = null, this._gradientXMax = null,
                    this._gradientYMin = null, this._gradientYMax = null, this._gradientZMin = null,
                    this._gradientZMax = null;
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientSize");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.getMaxSizeInGradient = function () {
                var t = 0, e = 0, i = -Number.MAX_VALUE;
                switch (this._type) {
                    case 0:
                        if (this._separateAxes) {
                            for (t = 0, e = this._gradientX.gradientCount; t < e; t++) i = Math.max(i, this._gradientX.getValueByIndex(t));
                            for (t = 0, e = this._gradientY.gradientCount; t < e; t++) i = Math.max(i, this._gradientY.getValueByIndex(t));
                        } else for (t = 0, e = this._gradient.gradientCount; t < e; t++) i = Math.max(i, this._gradient.getValueByIndex(t));
                        break;

                    case 1:
                        this._separateAxes ? (i = Math.max(this._constantMinSeparate.x, this._constantMaxSeparate.x),
                            i = Math.max(i, this._constantMinSeparate.y), i = Math.max(i, this._constantMaxSeparate.y)) : i = Math.max(this._constantMin, this._constantMax);
                        break;

                    case 2:
                        if (this._separateAxes) {
                            for (t = 0, e = this._gradientXMin.gradientCount; t < e; t++) i = Math.max(i, this._gradientXMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientXMax.gradientCount; t < e; t++) i = Math.max(i, this._gradientXMax.getValueByIndex(t));
                            for (t = 0, e = this._gradientYMin.gradientCount; t < e; t++) i = Math.max(i, this._gradientYMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientZMax.gradientCount; t < e; t++) i = Math.max(i, this._gradientZMax.getValueByIndex(t));
                        } else {
                            for (t = 0, e = this._gradientMin.gradientCount; t < e; t++) i = Math.max(i, this._gradientMin.getValueByIndex(t));
                            for (t = 0, e = this._gradientMax.gradientCount; t < e; t++) i = Math.max(i, this._gradientMax.getValueByIndex(t));
                        }
                }
                return i;
            }, e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._separateAxes = this._separateAxes, this._gradient.cloneTo(e._gradient),
                    this._gradientX.cloneTo(e._gradientX), this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ),
                    e._constantMin = this._constantMin, e._constantMax = this._constantMax, this._constantMinSeparate.cloneTo(e._constantMinSeparate),
                    this._constantMaxSeparate.cloneTo(e._constantMaxSeparate), this._gradientMin.cloneTo(e._gradientMin),
                    this._gradientMax.cloneTo(e._gradientMax), this._gradientXMin.cloneTo(e._gradientXMin),
                    this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin),
                    this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin),
                    this._gradientZMax.cloneTo(e._gradientZMax);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientZ", function () {
                return this._gradientZ;
            }), a(0, e, "gradient", function () {
                return this._gradient;
            }), a(0, e, "separateAxes", function () {
                return this._separateAxes;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "gradientMin", function () {
                return this._gradientMin;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "gradientX", function () {
                return this._gradientX;
            }), a(0, e, "gradientY", function () {
                return this._gradientY;
            }), a(0, e, "gradientMax", function () {
                return this._gradientMax;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), a(0, e, "constantMinSeparate", function () {
                return this._constantMinSeparate;
            }), a(0, e, "constantMaxSeparate", function () {
                return this._constantMaxSeparate;
            }), a(0, e, "gradientXMin", function () {
                return this._gradientXMin;
            }), a(0, e, "gradientXMax", function () {
                return this._gradientXMax;
            }), a(0, e, "gradientYMin", function () {
                return this._gradientYMin;
            }), a(0, e, "gradientYMax", function () {
                return this._gradientYMax;
            }), a(0, e, "gradientZMin", function () {
                return this._gradientZMin;
            }), a(0, e, "gradientZMax", function () {
                return this._gradientZMax;
            }), t.createByGradient = function (e) {
                var i = new t();
                return i._type = 0, i._separateAxes = !1, i._gradient = e, i;
            }, t.createByGradientSeparate = function (e, i, n) {
                var r = new t();
                return r._type = 0, r._separateAxes = !0, r._gradientX = e, r._gradientY = i, r._gradientZ = n,
                    r;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 1, n._separateAxes = !1, n._constantMin = e, n._constantMax = i,
                    n;
            }, t.createByRandomTwoConstantSeparate = function (e, i) {
                var n = new t();
                return n._type = 1, n._separateAxes = !0, n._constantMinSeparate = e, n._constantMaxSeparate = i,
                    n;
            }, t.createByRandomTwoGradient = function (e, i) {
                var n = new t();
                return n._type = 2, n._separateAxes = !1, n._gradientMin = e, n._gradientMax = i,
                    n;
            }, t.createByRandomTwoGradientSeparate = function (e, i, n, r, a, s) {
                var o = new t();
                return o._type = 2, o._separateAxes = !0, o._gradientXMin = e, o._gradientXMax = i,
                    o._gradientYMin = n, o._gradientYMax = r, o._gradientZMin = a, o._gradientZMax = s,
                    o;
            }, t;
        }(), ve = function () {
            function t() {
                this.alphaMap = null, this.detailID = null, this.normalMap = null;
            }
            return r(t, "laya.d3.terrain.unit.ChunkInfo"), t;
        }(), Se = function () {
            function t() {
                this.textureID = -1;
            }
            return r(t, "laya.d3.shader.ShaderVariable"), t;
        }(), Te = function () {
            function t() {
                this._indexInList = 0, this.type = 0, this.fullPath = null, this.propertyOwner = null,
                    this.data = null, this._ownerPath = [], this._propertys = [], this._keyFrames = [];
            }
            r(t, "laya.d3.animation.KeyframeNode");
            var e = t.prototype;
            return e._setOwnerPathCount = function (t) {
                this._ownerPath.length = t;
            }, e._setOwnerPathByIndex = function (t, e) {
                this._ownerPath[t] = e;
            }, e._joinOwnerPath = function (t) {
                return this._ownerPath.join(t);
            }, e._setPropertyCount = function (t) {
                this._propertys.length = t;
            }, e._setPropertyByIndex = function (t, e) {
                this._propertys[t] = e;
            }, e._joinProperty = function (t) {
                return this._propertys.join(t);
            }, e._setKeyframeCount = function (t) {
                this._keyFrames.length = t;
            }, e._setKeyframeByIndex = function (t, e) {
                this._keyFrames[t] = e;
            }, e.getOwnerPathByIndex = function (t) {
                return this._ownerPath[t];
            }, e.getPropertyByIndex = function (t) {
                return this._propertys[t];
            }, e.getKeyframeByIndex = function (t) {
                return this._keyFrames[t];
            }, a(0, e, "ownerPathCount", function () {
                return this._ownerPath.length;
            }), a(0, e, "propertyCount", function () {
                return this._propertys.length;
            }), a(0, e, "keyFramesCount", function () {
                return this._keyFrames.length;
            }), t;
        }(), Ee = function () {
            function t() {
                this._type = 0, this._constant = null, this._gradientX = null, this._gradientY = null,
                    this._gradientZ = null, this._constantMin = null, this._constantMax = null, this._gradientXMin = null,
                    this._gradientXMax = null, this._gradientYMin = null, this._gradientYMax = null,
                    this._gradientZMin = null, this._gradientZMax = null;
            }
            r(t, "laya.d3.core.particleShuriKen.module.GradientVelocity");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, this._constant.cloneTo(e._constant), this._gradientX.cloneTo(e._gradientX),
                    this._gradientY.cloneTo(e._gradientY), this._gradientZ.cloneTo(e._gradientZ), this._constantMin.cloneTo(e._constantMin),
                    this._constantMax.cloneTo(e._constantMax), this._gradientXMin.cloneTo(e._gradientXMin),
                    this._gradientXMax.cloneTo(e._gradientXMax), this._gradientYMin.cloneTo(e._gradientYMin),
                    this._gradientYMax.cloneTo(e._gradientYMax), this._gradientZMin.cloneTo(e._gradientZMin),
                    this._gradientZMax.cloneTo(e._gradientZMax);
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "gradientZ", function () {
                return this._gradientZ;
            }), a(0, e, "constant", function () {
                return this._constant;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "gradientXMax", function () {
                return this._gradientXMax;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "gradientX", function () {
                return this._gradientX;
            }), a(0, e, "gradientY", function () {
                return this._gradientY;
            }), a(0, e, "gradientXMin", function () {
                return this._gradientXMin;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), a(0, e, "gradientYMin", function () {
                return this._gradientYMin;
            }), a(0, e, "gradientYMax", function () {
                return this._gradientYMax;
            }), a(0, e, "gradientZMin", function () {
                return this._gradientZMin;
            }), a(0, e, "gradientZMax", function () {
                return this._gradientZMax;
            }), t.createByConstant = function (e) {
                var i = new t();
                return i._type = 0, i._constant = e, i;
            }, t.createByGradient = function (e, i, n) {
                var r = new t();
                return r._type = 1, r._gradientX = e, r._gradientY = i, r._gradientZ = n, r;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 2, n._constantMin = e, n._constantMax = i, n;
            }, t.createByRandomTwoGradient = function (e, i, n, r, a, s) {
                var o = new t();
                return o._type = 3, o._gradientXMin = e, o._gradientXMax = i, o._gradientYMin = n,
                    o._gradientYMax = r, o._gradientZMin = a, o._gradientZMax = s, o;
            }, t;
        }(), Ce = function () {
            function t(t, e) {
                this._updateFlag = 0, this._center = new gt(), this._extent = new gt(), this._boundBox = new Ue(new gt(), new gt()),
                    t.cloneTo(this._boundBox.min), e.cloneTo(this._boundBox.max), this._setUpdateFlag(12, !0);
            }
            r(t, "laya.d3.core.Bounds");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setMin = function (t) {
                var e = this._boundBox.min;
                t !== e && t.cloneTo(e), this._setUpdateFlag(12, !0), this._setUpdateFlag(1, !1);
            }, e.getMin = function () {
                var t = this._boundBox.min;
                return this._getUpdateFlag(1) && (this._getMin(this.getCenter(), this.getExtent(), t),
                    this._setUpdateFlag(1, !1)), t;
            }, e.setMax = function (t) {
                var e = this._boundBox.max;
                t !== e && t.cloneTo(e), this._setUpdateFlag(12, !0), this._setUpdateFlag(2, !1);
            }, e.getMax = function () {
                var t = this._boundBox.max;
                return this._getUpdateFlag(2) && (this._getMax(this.getCenter(), this.getExtent(), t),
                    this._setUpdateFlag(2, !1)), t;
            }, e.setCenter = function (t) {
                t !== this._center && t.cloneTo(this._center), this._setUpdateFlag(3, !0), this._setUpdateFlag(4, !1);
            }, e.getCenter = function () {
                return this._getUpdateFlag(4) && (this._getCenter(this.getMin(), this.getMax(), this._center),
                    this._setUpdateFlag(4, !1)), this._center;
            }, e.setExtent = function (t) {
                t !== this._extent && t.cloneTo(this._extent), this._setUpdateFlag(3, !0), this._setUpdateFlag(8, !1);
            }, e.getExtent = function () {
                return this._getUpdateFlag(8) && (this._getExtent(this.getMin(), this.getMax(), this._extent),
                    this._setUpdateFlag(8, !1)), this._extent;
            }, e._getUpdateFlag = function (t) {
                return 0 != (this._updateFlag & t);
            }, e._setUpdateFlag = function (t, e) {
                e ? this._updateFlag |= t : this._updateFlag &= ~t;
            }, e._getCenter = function (t, e, i) {
                gt.add(t, e, i), gt.scale(i, .5, i);
            }, e._getExtent = function (t, e, i) {
                gt.subtract(e, t, i), gt.scale(i, .5, i);
            }, e._getMin = function (t, e, i) {
                gt.subtract(t, e, i);
            }, e._getMax = function (t, e, i) {
                gt.add(t, e, i);
            }, e._rotateExtents = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.elements;
                i.x = Math.abs(s[0] * n) + Math.abs(s[4] * r) + Math.abs(s[8] * a), i.y = Math.abs(s[1] * n) + Math.abs(s[5] * r) + Math.abs(s[9] * a),
                    i.z = Math.abs(s[2] * n) + Math.abs(s[6] * r) + Math.abs(s[10] * a);
            }, e._tranform = function (t, e) {
                var i = e._center, n = e._extent;
                gt.transformCoordinate(this.getCenter(), t, i), this._rotateExtents(this.getExtent(), t, n),
                    e._boundBox.setCenterAndExtent(i, n), e._updateFlag = 0;
            }, e._getBoundBox = function () {
                var t = this._boundBox.min;
                this._getUpdateFlag(1) && (this._getMin(this.getCenter(), this.getExtent(), t),
                    this._setUpdateFlag(1, !1));
                var e = this._boundBox.max;
                return this._getUpdateFlag(2) && (this._getMax(this.getCenter(), this.getExtent(), e),
                    this._setUpdateFlag(2, !1)), this._boundBox;
            }, e.cloneTo = function (t) {
                var e = t;
                this.getMin().cloneTo(e._boundBox.min), this.getMax().cloneTo(e._boundBox.max),
                    this.getCenter().cloneTo(e._center), this.getExtent().cloneTo(e._extent), e._updateFlag = 0;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t._UPDATE_MIN = 1, t._UPDATE_MAX = 2, t._UPDATE_CENTER = 4, t._UPDATE_EXTENT = 8,
                t;
        }(), xe = function () {
            function t() {
                this._type = 0, this._constant = NaN, this._constantMin = NaN, this._constantMax = NaN;
            }
            r(t, "laya.d3.core.particleShuriKen.module.StartFrame");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                e._type = this._type, e._constant = this._constant, e._constantMin = this._constantMin,
                    e._constantMax = this._constantMax;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "constant", function () {
                return this._constant;
            }), a(0, e, "type", function () {
                return this._type;
            }), a(0, e, "constantMin", function () {
                return this._constantMin;
            }), a(0, e, "constantMax", function () {
                return this._constantMax;
            }), t.createByConstant = function (e) {
                var i = new t();
                return i._type = 0, i._constant = e, i;
            }, t.createByRandomTwoConstant = function (e, i) {
                var n = new t();
                return n._type = 1, n._constantMin = e, n._constantMax = i, n;
            }, t;
        }(), be = function () {
            function t(t, e, i, n) {
                this._children = [], this.transform = new qe(this, t, e, i, n);
            }
            r(t, "laya.d3.animation.AnimationNode");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.addChild = function (t) {
                t._parent = this, t.transform.setParent(this.transform), this._children.push(t);
            }, e.removeChild = function (t) {
                var e = this._children.indexOf(t);
                -1 !== e && this._children.splice(e, 1);
            }, e.getChildByName = function (t) {
                for (var e = 0, i = this._children.length; e < i; e++) {
                    var n = this._children[e];
                    if (n.name === t) return n;
                }
                return null;
            }, e.getChildByIndex = function (t) {
                return this._children[t];
            }, e.getChildCount = function () {
                return this._children.length;
            }, e.cloneTo = function (t) {
                var e = t;
                e.name = this.name;
                for (var i = 0, n = this._children.length; i < n; i++) {
                    var r = this._children[i], a = r.clone();
                    e.addChild(a);
                    var s = r.transform, o = a.transform, l = o.localPosition, h = o.localRotation, u = o.localScale;
                    s.localPosition.cloneTo(l), s.localRotation.cloneTo(h), s.localScale.cloneTo(u),
                        o.localPosition = l, o.localRotation = h, o.localScale = u;
                }
            }, e.clone = function () {
                var e = new t();
                return this.cloneTo(e), e;
            }, e._cloneNative = function (e, i, n, r, a, s, o) {
                var l = o._nativeCurCloneCount;
                a[l] = s;
                var h = new t(new Float32Array(e.buffer, 3 * l * 4, 3), new Float32Array(i.buffer, 4 * l * 4, 4), new Float32Array(n.buffer, 3 * l * 4, 3), new Float32Array(r.buffer, 16 * l * 4, 16));
                return h._worldMatrixIndex = l, this._cloneToNative(h, e, i, n, r, a, l, o), h;
            }, e._cloneToNative = function (t, e, i, n, r, a, s, o) {
                var l = t;
                l.name = this.name;
                for (var h = 0, u = this._children.length; h < u; h++) {
                    var c = this._children[h];
                    o._nativeCurCloneCount++;
                    var d = c._cloneNative(e, i, n, r, a, s, o);
                    l.addChild(d);
                    var _ = c.transform, f = d.transform, p = f.localPosition, m = f.localRotation, g = f.localScale;
                    _.localPosition.cloneTo(p), _.localRotation.cloneTo(m), _.localScale.cloneTo(g),
                        f.localPosition = p, f.localRotation = m, f.localScale = g;
                }
            }, t;
        }(), Ie = function () {
            function t() {
                this._context = null, this._compositeShader = Lt.find("PostProcessComposite"), this._compositeShaderData = new ut(),
                    this._compositeDefineData = new Vt(), this._effects = [], this._context = new oe(),
                    this._context.compositeShaderData = this._compositeShaderData, this._context.compositeDefineData = this._compositeDefineData;
            }
            r(t, "laya.d3.component.PostProcess");
            var e = t.prototype;
            return e._init = function (t, e) {
                this._context.camera = t, this._context.command = e;
            }, e._render = function () {
                var t = mn.getTemporary(J.clientWidth, J.clientHeight, 0, 3), e = this._context.camera.getRenderTexture();
                this._context.command.clear(), this._context.source = t, this._context.destination = e;
                for (var i = 0, n = this._effects.length; i < n; i++) this._effects[i].render(this._context);
                mn.setReleaseTemporary(t);
                var r = this._context.tempRenderTextures;
                for (i = 0, n = r.length; i < n; i++) mn.setReleaseTemporary(r[i]);
            }, e.addEffect = function (t) {
                this._effects.push(t);
            }, e.removeEffect = function (t) {
                var e = this._effects.indexOf(t);
                -1 !== e && this._effects.splice(e, 1);
            }, t.__init__ = function () {
                t.SHADERDEFINE_BLOOM_LOW = t.shaderDefines.registerDefine("BLOOM_LOW"), t.SHADERDEFINE_BLOOM = t.shaderDefines.registerDefine("BLOOM");
            }, t.SHADERDEFINE_BLOOM_LOW = 0, t.SHADERDEFINE_BLOOM = 0, n(t, ["SHADERVALUE_MAINTEX", function () {
                return this.SHADERVALUE_MAINTEX = Lt.propertyNameToID("u_MainTex");
            }, "SHADERVALUE_BLOOMTEX", function () {
                return this.SHADERVALUE_BLOOMTEX = Lt.propertyNameToID("u_BloomTex");
            }, "SHADERVALUE_AUTOEXPOSURETEX", function () {
                return this.SHADERVALUE_AUTOEXPOSURETEX = Lt.propertyNameToID("u_AutoExposureTex");
            }, "SHADERVALUE_BLOOM_DIRTTEX", function () {
                return this.SHADERVALUE_BLOOM_DIRTTEX = Lt.propertyNameToID("u_Bloom_DirtTex");
            }, "SHADERVALUE_BLOOMTEX_TEXELSIZE", function () {
                return this.SHADERVALUE_BLOOMTEX_TEXELSIZE = Lt.propertyNameToID("u_BloomTex_TexelSize");
            }, "SHADERVALUE_BLOOM_DIRTTILEOFFSET", function () {
                return this.SHADERVALUE_BLOOM_DIRTTILEOFFSET = Lt.propertyNameToID("u_Bloom_DirtTileOffset");
            }, "SHADERVALUE_BLOOM_SETTINGS", function () {
                return this.SHADERVALUE_BLOOM_SETTINGS = Lt.propertyNameToID("u_Bloom_Settings");
            }, "SHADERVALUE_BLOOM_COLOR", function () {
                return this.SHADERVALUE_BLOOM_COLOR = Lt.propertyNameToID("u_Bloom_Color");
            }, "shaderDefines", function () {
                return this.shaderDefines = new mt();
            }]), t;
        }(), we = function () {
            function t(t, e, i, n) {
                this.minDepth = 0, this.maxDepth = 1, this.x = t, this.y = e, this.width = i, this.height = n;
            }
            r(t, "laya.d3.math.Viewport");
            var e = t.prototype;
            return e.project = function (t, e, i) {
                if (this.name == "1") {
                    console.log("11111")
                }
                gt.transformV3ToV3(t, e, i);
                var n = e.elements, r = t.x * n[3] + t.y * n[7] + t.z * n[11] + n[15];
                1 !== r && (i.x = i.x / r, i.y = i.y / r, i.z = i.z / r), i.x = .5 * (i.x + 1) * this.width + this.x,
                    i.y = .5 * (1 - i.y) * this.height + this.y, i.z = i.z * (this.maxDepth - this.minDepth) + this.minDepth;
            }, e.project1 = function (t, e, i) {
                if (this.name == "1") {
                    console.log("11111")
                }
                var n = gt._tempVector4;
                gt.transformV3ToV4(t, e, n);
                var r = n.w;
                r < .1 && r > -1e-6 && (r = 1e-6), n.x /= r, n.y /= r, n.z /= r, i.x = (n.x + 1) * this.width / 2 + this.x,
                    i.y = (1 - n.y) * this.height / 2 + this.y, i.z = n.w;
            }, e.unprojectFromMat = function (t, e, i) {
                if (this.name == "1") {
                    console.log("11111")
                }
                var n = e.elements;
                i.x = (t.x - this.x) / this.width * 2 - 1, i.y = -((t.y - this.y) / this.height * 2 - 1);
                var r = (this.maxDepth - this.minDepth) / 2;
                i.z = (t.z - this.minDepth - r) / r;
                var a = i.x * n[3] + i.y * n[7] + i.z * n[11] + n[15];
                gt.transformV3ToV3(i, e, i), 1 !== a && (i.x = i.x / a, i.y = i.y / a, i.z = i.z / a);
            }, e.unprojectFromWVP = function (e, i, n, r, a) {
                if (this.name == "1") {
                    console.log("11111")
                }
                ze.multiply(i, n, t._tempMatrix4x4), r && ze.multiply(t._tempMatrix4x4, r, t._tempMatrix4x4),
                    t._tempMatrix4x4.invert(t._tempMatrix4x4), this.unprojectFromMat(e, t._tempMatrix4x4, a);
            }, e.cloneTo = function (t) {
                t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t.minDepth = this.minDepth,
                    t.maxDepth = this.maxDepth;
            }, n(t, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new ze();
            }]), t;
        }(), Ae = function () {
            function t() {
                this.diffuseTexture = null, this.normalTexture = null, this.scale = null, this.offset = null;
            }
            return r(t, "laya.d3.terrain.unit.DetailTextureInfo"), t;
        }(), Re = (function () {
            function t(t, e) {
                this.extents = null, this.transformation = null, this.extents = t, this.transformation = e;
            }
            r(t, "laya.d3.math.OrientedBoundBox");
            var e = t.prototype;
            e.getCorners = function (e) {
                t._tempV30.x = this.extents.x, t._tempV30.y = t._tempV30.z = 0, t._tempV31.y = this.extents.y,
                    t._tempV31.x = t._tempV31.z = 0, t._tempV32.z = this.extents.z, t._tempV32.x = t._tempV32.y = 0,
                    gt.TransformNormal(t._tempV30, this.transformation, t._tempV30), gt.TransformNormal(t._tempV31, this.transformation, t._tempV31),
                    gt.TransformNormal(t._tempV32, this.transformation, t._tempV32);
                var i = t._tempV33;
                this.transformation.getTranslationVector(i), e.length = 8, gt.add(i, t._tempV30, t._tempV34),
                    gt.add(t._tempV34, t._tempV31, t._tempV34), gt.add(t._tempV34, t._tempV32, e[0]),
                    gt.add(i, t._tempV30, t._tempV34), gt.add(t._tempV34, t._tempV31, t._tempV34), gt.subtract(t._tempV34, t._tempV32, e[1]),
                    gt.subtract(i, t._tempV30, t._tempV34), gt.add(t._tempV34, t._tempV31, t._tempV34),
                    gt.subtract(t._tempV34, t._tempV32, e[2]), gt.subtract(i, t._tempV30, t._tempV34),
                    gt.add(t._tempV34, t._tempV31, t._tempV34), gt.add(t._tempV34, t._tempV32, e[3]),
                    gt.add(i, t._tempV30, t._tempV34), gt.subtract(t._tempV34, t._tempV31, t._tempV34),
                    gt.add(t._tempV34, t._tempV32, e[4]), gt.add(i, t._tempV30, t._tempV34), gt.subtract(t._tempV34, t._tempV31, t._tempV34),
                    gt.subtract(t._tempV34, t._tempV32, e[5]), gt.subtract(i, t._tempV30, t._tempV34),
                    gt.subtract(t._tempV34, t._tempV31, t._tempV34), gt.subtract(t._tempV34, t._tempV32, e[6]),
                    gt.subtract(i, t._tempV30, t._tempV34), gt.subtract(t._tempV34, t._tempV31, t._tempV34),
                    gt.add(t._tempV34, t._tempV32, e[7]);
            }, e.transform = function (t) {
                ze.multiply(this.transformation, t, this.transformation);
            }, e.scale = function (t) {
                gt.multiply(this.extents, t, this.extents);
            }, e.translate = function (e) {
                this.transformation.getTranslationVector(t._tempV30), gt.add(t._tempV30, e, t._tempV31),
                    this.transformation.setTranslationVector(t._tempV31);
            }, e.Size = function (t) {
                gt.scale(this.extents, 2, t);
            }, e.getSize = function (e) {
                t._tempV30.x = this.extents.x, t._tempV31.y = this.extents.y, t._tempV32.z = this.extents.z,
                    gt.TransformNormal(t._tempV30, this.transformation, t._tempV30), gt.TransformNormal(t._tempV31, this.transformation, t._tempV31),
                    gt.TransformNormal(t._tempV31, this.transformation, t._tempV32), e.x = gt.scalarLength(t._tempV30),
                    e.y = gt.scalarLength(t._tempV31), e.z = gt.scalarLength(t._tempV32);
            }, e.getSizeSquared = function (e) {
                t._tempV30.x = this.extents.x, t._tempV31.y = this.extents.y, t._tempV32.z = this.extents.z,
                    gt.TransformNormal(t._tempV30, this.transformation, t._tempV30), gt.TransformNormal(t._tempV31, this.transformation, t._tempV31),
                    gt.TransformNormal(t._tempV31, this.transformation, t._tempV32), e.x = gt.scalarLengthSquared(t._tempV30),
                    e.y = gt.scalarLengthSquared(t._tempV31), e.z = gt.scalarLengthSquared(t._tempV32);
            }, e.getCenter = function (t) {
                this.transformation.getTranslationVector(t);
            }, e.containsPoint = function (e) {
                var i = this.extents.x, n = this.extents.y, r = this.extents.z;
                this.transformation.invert(t._tempM0), gt.transformCoordinate(e, t._tempM0, t._tempV30);
                var a = Math.abs(t._tempV30.x), s = Math.abs(t._tempV30.y), o = Math.abs(t._tempV30.z);
                return nt.nearEqual(a, i) && nt.nearEqual(s, n) && nt.nearEqual(o, r) ? 2 : a < i && s < n && o < r ? 1 : 0;
            }, e.containsPoints = function (e) {
                var i = this.extents.x, n = this.extents.y, r = this.extents.z;
                this.transformation.invert(t._tempM0);
                for (var a = !0, s = !1, o = 0; o < e.length; o++) {
                    gt.transformCoordinate(e[o], t._tempM0, t._tempV30);
                    var l = Math.abs(t._tempV30.x), h = Math.abs(t._tempV30.y), u = Math.abs(t._tempV30.z);
                    nt.nearEqual(l, i) && nt.nearEqual(h, n) && nt.nearEqual(u, r) && (s = !0), l < i && h < n && u < r ? s = !0 : a = !1;
                }
                return a ? 1 : s ? 2 : 0;
            }, e.containsSphere = function (e, i) {
                void 0 === i && (i = !1);
                var n = this.extents.x, r = this.extents.y, a = this.extents.z, s = e.radius;
                this.transformation.invert(t._tempM0), gt.transformCoordinate(e.center, t._tempM0, t._tempV30);
                var o = NaN;
                if (i ? o = s : (gt.scale(gt._UnitX, s, t._tempV31), gt.TransformNormal(t._tempV31, t._tempM0, t._tempV31),
                    o = gt.scalarLength(t._tempV31)), gt.scale(this.extents, -1, t._tempV32), gt.Clamp(t._tempV30, t._tempV32, this.extents, t._tempV33),
                    gt.distanceSquared(t._tempV30, t._tempV33) > o * o) return 0;
                var l = t._tempV30.x, h = t._tempV30.y, u = t._tempV30.z, c = t._tempV32.x, d = t._tempV32.y, _ = t._tempV32.z;
                return c + o <= l && l <= n - o && n - c > o && d + o <= h && h <= r - o && r - d > o && _ + o <= u && u <= a - o && a - _ > o ? 1 : 2;
            }, e.containsOrientedBoundBox = function (e) {
                var i = 0, n = 0;
                e.getCorners(t._corners);
                var r = this.containsPoints(t._corners);
                if (0 != r) return r;
                t._sizeAe[0] = this.extents.x, t._sizeAe[1] = this.extents.y, t._sizeAe[2] = this.extents.z,
                    e.extents.cloneTo(t._tempV35), t._sizeBe[0] = t._tempV35.x, t._sizeBe[1] = t._tempV35.y,
                    t._sizeBe[2] = t._tempV35.z, t._getRows(this.transformation, t._rows1), t._getRows(e.transformation, t._rows2);
                var a = NaN, s = NaN, o = NaN;
                for (i = 0; i < 4; i++) for (n = 0; n < 4; n++) 3 == i || 3 == n ? (t._tempM0.setElementByRowColumn(i, n, 0),
                    t._tempM1.setElementByRowColumn(i, n, 0)) : (o = gt.dot(t._rows1[i], t._rows2[n]),
                        t._tempM0.setElementByRowColumn(i, n, o), t._tempM1.setElementByRowColumn(i, n, Math.abs(o)));
                for (e.getCenter(t._tempV34), this.getCenter(t._tempV36), gt.subtract(t._tempV34, t._tempV36, t._tempV30),
                    t._tempV31.x = gt.dot(t._tempV30, t._rows1[0]), t._tempV31.y = gt.dot(t._tempV30, t._rows1[1]),
                    t._tempV31.z = gt.dot(t._tempV30, t._rows1[2]), t._vsepAe[0] = t._tempV31.x, t._vsepAe[1] = t._tempV31.y,
                    t._vsepAe[2] = t._tempV31.z, i = 0; i < 3; i++) if (t._tempV32.x = t._tempM1.getElementByRowColumn(i, 0),
                        t._tempV32.y = t._tempM1.getElementByRowColumn(i, 1), t._tempV32.z = t._tempM1.getElementByRowColumn(i, 2),
                        a = t._sizeAe[i], s = gt.dot(t._tempV35, t._tempV32), Math.abs(t._vsepAe[i]) > a + s) return 0;
                for (n = 0; n < 3; n++) if (t._tempV32.x = t._tempM1.getElementByRowColumn(0, n),
                    t._tempV32.y = t._tempM1.getElementByRowColumn(1, n), t._tempV32.z = t._tempM1.getElementByRowColumn(2, n),
                    t._tempV33.x = t._tempM0.getElementByRowColumn(0, n), t._tempV33.y = t._tempM0.getElementByRowColumn(1, n),
                    t._tempV33.z = t._tempM0.getElementByRowColumn(2, n), a = gt.dot(this.extents, t._tempV32),
                    s = t._sizeBe[n], Math.abs(gt.dot(t._tempV31, t._tempV33)) > a + s) return 0;
                for (i = 0; i < 3; i++) for (n = 0; n < 3; n++) {
                    var l = (i + 1) % 3, h = (i + 2) % 3, u = (n + 1) % 3, c = (n + 2) % 3;
                    if (a = t._sizeAe[l] * t._tempM1.getElementByRowColumn(h, n) + t._sizeAe[h] * t._tempM1.getElementByRowColumn(l, n),
                        s = t._sizeBe[u] * t._tempM1.getElementByRowColumn(i, c) + t._sizeBe[c] * t._tempM1.getElementByRowColumn(i, u),
                        Math.abs(t._vsepAe[h] * t._tempM0.getElementByRowColumn(l, n) - t._vsepAe[l] * t._tempM0.getElementByRowColumn(h, n)) > a + s) return 0;
                }
                return 2;
            }, e.containsLine = function (e, i) {
                t._corners[0] = e, t._corners[1] = i;
                var n = this.containsPoints(t._corners);
                if (0 != n) return n;
                var r = this.extents.x, a = this.extents.y, s = this.extents.z;
                this.transformation.invert(t._tempM0), gt.transformCoordinate(e, t._tempM0, t._tempV30),
                    gt.transformCoordinate(i, t._tempM0, t._tempV31), gt.add(t._tempV30, t._tempV31, t._tempV32),
                    gt.scale(t._tempV32, .5, t._tempV32), gt.subtract(t._tempV30, t._tempV32, t._tempV33);
                var o = t._tempV33.x, l = t._tempV33.y, h = t._tempV33.z, u = t._tempV34.x = Math.abs(t._tempV33.x), c = t._tempV34.y = Math.abs(t._tempV33.y), d = t._tempV34.z = Math.abs(t._tempV33.z), _ = t._tempV32.x, f = t._tempV32.y, p = t._tempV32.z;
                return Math.abs(_) > r + u || Math.abs(f) > a + c || Math.abs(p) > s + d || Math.abs(f * h - p * l) > a * d + s * c || Math.abs(_ * h - p * o) > r * d + s * u || Math.abs(_ * l - f * o) > r * c + a * u ? 0 : 2;
            }, e.containsBoundBox = function (e) {
                var i = 0, n = 0, r = e.min, a = e.max;
                e.getCorners(t._corners);
                var s = this.containsPoints(t._corners);
                if (0 != s) return s;
                gt.subtract(a, r, t._tempV30), gt.scale(t._tempV30, .5, t._tempV30), gt.add(r, t._tempV30, t._tempV30),
                    gt.subtract(a, t._tempV30, t._tempV31), t._sizeAe[0] = this.extents.x, t._sizeAe[1] = this.extents.y,
                    t._sizeAe[2] = this.extents.z, t._sizeBe[0] = t._tempV31.x, t._sizeBe[1] = t._tempV31.y,
                    t._sizeBe[2] = t._tempV31.z, t._getRows(this.transformation, t._rows1), this.transformation.invert(t._tempM0);
                var o = NaN, l = NaN;
                for (i = 0; i < 3; i++) for (n = 0; n < 3; n++) t._tempM1.setElementByRowColumn(i, n, Math.abs(t._tempM0.getElementByRowColumn(i, n)));
                for (this.getCenter(t._tempV35), gt.subtract(t._tempV30, t._tempV35, t._tempV32),
                    t._tempV31.x = gt.dot(t._tempV32, t._rows1[0]), t._tempV31.y = gt.dot(t._tempV32, t._rows1[1]),
                    t._tempV31.z = gt.dot(t._tempV32, t._rows1[2]), t._vsepAe[0] = t._tempV31.x, t._vsepAe[1] = t._tempV31.y,
                    t._vsepAe[2] = t._tempV31.z, i = 0; i < 3; i++) if (t._tempV33.x = t._tempM1.getElementByRowColumn(i, 0),
                        t._tempV33.y = t._tempM1.getElementByRowColumn(i, 1), t._tempV33.z = t._tempM1.getElementByRowColumn(i, 2),
                        o = t._sizeAe[i], l = gt.dot(t._tempV31, t._tempV33), Math.abs(t._vsepAe[i]) > o + l) return 0;
                for (n = 0; n < 3; n++) if (t._tempV33.x = t._tempM1.getElementByRowColumn(0, n),
                    t._tempV33.y = t._tempM1.getElementByRowColumn(1, n), t._tempV33.z = t._tempM1.getElementByRowColumn(2, n),
                    t._tempV34.x = t._tempM0.getElementByRowColumn(0, n), t._tempV34.y = t._tempM0.getElementByRowColumn(1, n),
                    t._tempV34.z = t._tempM0.getElementByRowColumn(2, n), o = gt.dot(this.extents, t._tempV33),
                    l = t._sizeBe[n], Math.abs(gt.dot(t._tempV31, t._tempV34)) > o + l) return 0;
                for (i = 0; i < 3; i++) for (n = 0; n < 3; n++) {
                    var h = (i + 1) % 3, u = (i + 2) % 3, c = (n + 1) % 3, d = (n + 2) % 3;
                    if (o = t._sizeAe[h] * t._tempM1.getElementByRowColumn(u, n) + t._sizeAe[u] * t._tempM1.getElementByRowColumn(h, n),
                        l = t._sizeBe[c] * t._tempM1.getElementByRowColumn(i, d) + t._sizeBe[d] * t._tempM1.getElementByRowColumn(i, c),
                        Math.abs(t._vsepAe[u] * t._tempM0.getElementByRowColumn(h, n) - t._vsepAe[h] * t._tempM0.getElementByRowColumn(u, n)) > o + l) return 0;
                }
                return 2;
            }, e.intersectsRay = function (e, i) {
                gt.scale(this.extents, -1, t._tempV30), this.transformation.invert(t._tempM0), gt.TransformNormal(e.direction, t._tempM0, t._ray.direction),
                    gt.transformCoordinate(e.origin, t._tempM0, t._ray.origin), t._boxBound1.min = t._tempV30,
                    t._boxBound1.max = this.extents;
                var n = Fe.intersectsRayAndBoxRP(t._ray, t._boxBound1, i);
                return -1 !== n && gt.transformCoordinate(i, this.transformation, i), n;
            }, e._getLocalCorners = function (e) {
                e.length = 8, t._tempV30.x = this.extents.x, t._tempV31.y = this.extents.y, t._tempV32.z = this.extents.z,
                    gt.add(t._tempV30, t._tempV31, t._tempV33), gt.add(t._tempV33, t._tempV32, e[0]),
                    gt.add(t._tempV30, t._tempV31, t._tempV33), gt.subtract(t._tempV33, t._tempV32, e[1]),
                    gt.subtract(t._tempV31, t._tempV30, t._tempV33), gt.subtract(t._tempV33, t._tempV30, e[2]),
                    gt.subtract(t._tempV31, t._tempV30, t._tempV33), gt.add(t._tempV33, t._tempV32, e[3]),
                    gt.subtract(t._tempV30, t._tempV31, t._tempV33), gt.add(t._tempV33, t._tempV32, e[4]),
                    gt.subtract(t._tempV30, t._tempV31, t._tempV33), gt.subtract(t._tempV33, t._tempV32, e[5]),
                    gt.scale(e[0], -1, e[6]), gt.subtract(t._tempV32, t._tempV30, t._tempV33), gt.subtract(t._tempV33, t._tempV31, e[7]);
            }, e.equals = function (t) {
                return this.extents == t.extents && this.transformation == t.transformation;
            }, e.cloneTo = function (t) {
                var e = t;
                this.extents.cloneTo(e.extents), this.transformation.cloneTo(e.transformation);
            }, t.createByBoundBox = function (e, i) {
                var n = e.min, r = e.max;
                gt.subtract(r, n, t._tempV30), gt.scale(t._tempV30, .5, t._tempV30), gt.add(n, t._tempV30, t._tempV31),
                    gt.subtract(r, t._tempV31, t._tempV32), ze.translation(t._tempV31, t._tempM0);
                var a = t._tempV32.clone(), s = t._tempM0.clone();
                i.extents = a, i.transformation = s;
            }, t.createByMinAndMaxVertex = function (e, i) {
                return gt.subtract(i, e, t._tempV30), gt.scale(t._tempV30, .5, t._tempV30), gt.add(e, t._tempV30, t._tempV31),
                    gt.subtract(i, t._tempV31, t._tempV32), ze.translation(t._tempV31, t._tempM0), new t(t._tempV32, t._tempM0);
            }, t._getRows = function (t, e) {
                e.length = 3;
                var i = t.elements;
                e[0].x = i[0], e[0].y = i[1], e[0].z = i[2], e[1].x = i[4], e[1].y = i[5], e[1].z = i[6],
                    e[2].x = i[8], e[2].y = i[9], e[2].z = i[10];
            }, t.getObbtoObbMatrix4x4 = function (e, i, n, r) {
                var a = e.transformation, s = i.transformation;
                if (n) {
                    t._getRows(a, t._rows1), t._getRows(s, t._rows2);
                    for (var o = 0; o < 3; o++) for (var l = 0; l < 3; l++) r.setElementByRowColumn(o, l, gt.dot(t._rows2[o], t._rows1[l]));
                    i.getCenter(t._tempV30), e.getCenter(t._tempV31), gt.subtract(t._tempV30, t._tempV31, t._tempV32);
                    var h = r.elements;
                    h[12] = gt.dot(t._tempV32, t._rows1[0]), h[13] = gt.dot(t._tempV32, t._rows1[1]),
                        h[14] = gt.dot(t._tempV32, t._rows1[2]), h[15] = 1;
                } else a.invert(t._tempM0), ze.multiply(s, t._tempM0, r);
            }, t.merge = function (e, i, n) {
                var r = e.extents, a = e.transformation;
                t.getObbtoObbMatrix4x4(e, i, n, t._tempM0), i._getLocalCorners(t._corners), gt.transformCoordinate(t._corners[0], t._tempM0, t._corners[0]),
                    gt.transformCoordinate(t._corners[1], t._tempM0, t._corners[1]), gt.transformCoordinate(t._corners[2], t._tempM0, t._corners[2]),
                    gt.transformCoordinate(t._corners[3], t._tempM0, t._corners[3]), gt.transformCoordinate(t._corners[4], t._tempM0, t._corners[4]),
                    gt.transformCoordinate(t._corners[5], t._tempM0, t._corners[5]), gt.transformCoordinate(t._corners[6], t._tempM0, t._corners[6]),
                    gt.transformCoordinate(t._corners[7], t._tempM0, t._corners[7]), gt.scale(r, -1, t._boxBound1.min),
                    r.cloneTo(t._boxBound1.max), Ue.createfromPoints(t._corners, t._boxBound2), Ue.merge(t._boxBound2, t._boxBound1, t._boxBound3);
                var s = t._boxBound3.min, o = t._boxBound3.max;
                gt.subtract(o, s, t._tempV30), gt.scale(t._tempV30, .5, t._tempV30), gt.add(s, t._tempV30, t._tempV32),
                    gt.subtract(o, t._tempV32, r), gt.transformCoordinate(t._tempV32, a, t._tempV33);
            }, n(t, ["_tempV30", function () {
                return this._tempV30 = new gt();
            }, "_tempV31", function () {
                return this._tempV31 = new gt();
            }, "_tempV32", function () {
                return this._tempV32 = new gt();
            }, "_tempV33", function () {
                return this._tempV33 = new gt();
            }, "_tempV34", function () {
                return this._tempV34 = new gt();
            }, "_tempV35", function () {
                return this._tempV35 = new gt();
            }, "_tempV36", function () {
                return this._tempV36 = new gt();
            }, "_tempM0", function () {
                return this._tempM0 = new ze();
            }, "_tempM1", function () {
                return this._tempM1 = new ze();
            }, "_corners", function () {
                return this._corners = [new gt(), new gt(), new gt(), new gt(), new gt(), new gt(), new gt(), new gt()];
            }, "_rows1", function () {
                return this._rows1 = [new gt(), new gt(), new gt()];
            }, "_rows2", function () {
                return this._rows2 = [new gt(), new gt(), new gt()];
            }, "_ray", function () {
                return this._ray = new q(new gt(), new gt());
            }, "_boxBound1", function () {
                return this._boxBound1 = new Ue(new gt(), new gt());
            }, "_boxBound2", function () {
                return this._boxBound2 = new Ue(new gt(), new gt());
            }, "_boxBound3", function () {
                return this._boxBound3 = new Ue(new gt(), new gt());
            }, "_vsepAe", function () {
                return this._vsepAe = new Float32Array();
            }, "_sizeBe", function () {
                return this._sizeBe = new Float32Array();
            }, "_sizeAe", function () {
                return this._sizeAe = new Float32Array();
            }]);
        }(), function () {
            function t(t) {
                void 0 === t && (t = !1), this.isTransparent = t, this.elements = [];
            }
            r(t, "laya.d3.core.render.RenderQueue");
            var e = t.prototype;
            return e._compare = function (t, e) {
                var i = t.material.renderQueue - e.material.renderQueue;
                return 0 === i ? (this.isTransparent ? e.render._distanceForSort - t.render._distanceForSort : t.render._distanceForSort - e.render._distanceForSort) + e.render.sortingFudge - t.render.sortingFudge : i;
            }, e._partitionRenderObject = function (t, e) {
                for (var i = this.elements[Math.floor((e + t) / 2)]; t <= e;) {
                    for (; this._compare(this.elements[t], i) < 0;) t++;
                    for (; this._compare(this.elements[e], i) > 0;) e--;
                    if (t < e) {
                        var n = this.elements[t];
                        this.elements[t] = this.elements[e], this.elements[e] = n, t++, e--;
                    } else if (t === e) {
                        t++;
                        break;
                    }
                }
                return t;
            }, e._quickSort = function (t, e) {
                if (this.elements.length > 1) {
                    var i = this._partitionRenderObject(t, e), n = i - 1;
                    t < n && this._quickSort(t, n), i < e && this._quickSort(i, e);
                }
            }, e._render = function (t, e, i, n) {
                for (var r = 0, a = this.elements.length; r < a; r++) this.elements[r]._render(t, e, i, n);
            }, e.clear = function () {
                this.elements.length = 0, this.lastTransparentRenderElement = null, this.lastTransparentBatched = !1;
            }, t;
        }()), Me = (function () {
            function t() { }
            r(t, "laya.d3.core.TextureMode"), t.Stretch = 0, t.Tile = 1;
        }(), function () {
            function t() { }
            r(t, "laya.d3.physics.shape.HeightfieldColliderShape");
        }(), function () {
            function t() { }
            return r(t, "laya.d3.core.particleShuriKen.module.shape.ShapeUtils"), t._randomPointUnitArcCircle = function (t, e, i) {
                var n = NaN;
                n = i ? i.getFloat() * t : Math.random() * t, e.x = Math.cos(n), e.y = Math.sin(n);
            }, t._randomPointInsideUnitArcCircle = function (e, i, n) {
                t._randomPointUnitArcCircle(e, i, n);
                var r = NaN;
                r = n ? Math.pow(n.getFloat(), .5) : Math.pow(Math.random(), .5), i.x = i.x * r,
                    i.y = i.y * r;
            }, t._randomPointUnitCircle = function (t, e) {
                var i = NaN;
                i = e ? e.getFloat() * Math.PI * 2 : Math.random() * Math.PI * 2, t.x = Math.cos(i),
                    t.y = Math.sin(i);
            }, t._randomPointInsideUnitCircle = function (e, i) {
                t._randomPointUnitCircle(e);
                var n = NaN;
                n = i ? Math.pow(i.getFloat(), .5) : Math.pow(Math.random(), .5), e.x = e.x * n,
                    e.y = e.y * n;
            }, t._randomPointUnitSphere = function (t, e) {
                var i = NaN, n = NaN;
                e ? (i = t.z = 2 * e.getFloat() - 1, n = e.getFloat() * Math.PI * 2) : (i = t.z = 2 * Math.random() - 1,
                    n = Math.random() * Math.PI * 2);
                var r = Math.sqrt(1 - i * i);
                t.x = r * Math.cos(n), t.y = r * Math.sin(n);
            }, t._randomPointInsideUnitSphere = function (e, i) {
                t._randomPointUnitSphere(e);
                var n = NaN;
                n = i ? Math.pow(i.getFloat(), 1 / 3) : Math.pow(Math.random(), 1 / 3), e.x = e.x * n,
                    e.y = e.y * n, e.z = e.z * n;
            }, t._randomPointInsideHalfUnitBox = function (t, e) {
                e ? (t.x = e.getFloat() - .5, t.y = e.getFloat() - .5, t.z = e.getFloat() - .5) : (t.x = Math.random() - .5,
                    t.y = Math.random() - .5, t.z = Math.random() - .5);
            }, t;
        }()), De = function () {
            function t() { }
            return r(t, "laya.d3.graphics.VertexElementFormat"), t.getElementInfos = function (e) {
                var i = t._elementInfos[e];
                if (i) return i;
                throw "VertexElementFormat: this vertexElementFormat is not implement.";
            }, t.Single = "single", t.Vector2 = "vector2", t.Vector3 = "vector3", t.Vector4 = "vector4",
                t.Color = "color", t.Byte4 = "byte4", t.Short2 = "short2", t.Short4 = "short4",
                t.NormalizedShort2 = "normalizedshort2", t.NormalizedShort4 = "normalizedshort4",
                t.HalfVector2 = "halfvector2", t.HalfVector4 = "halfvector4", n(t, ["_elementInfos", function () {
                    return this._elementInfos = {
                        single: [1, 5126, 0],
                        vector2: [2, 5126, 0],
                        vector3: [3, 5126, 0],
                        vector4: [4, 5126, 0],
                        color: [4, 5126, 0],
                        byte4: [4, 5121, 0],
                        short2: [2, 5126, 0],
                        short4: [4, 5126, 0],
                        normalizedshort2: [2, 5126, 0],
                        normalizedshort4: [4, 5126, 0],
                        halfvector2: [2, 5126, 0],
                        halfvector4: [4, 5126, 0]
                    };
                }]), t;
        }(), Oe = function () {
            function t(t) {
                this._angularVelocity = null, this.enbale = !1, this._angularVelocity = t;
            }
            r(t, "laya.d3.core.particleShuriKen.module.RotationOverLifetime");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.cloneTo = function (t) {
                var e = t;
                this._angularVelocity.cloneTo(e._angularVelocity), e.enbale = this.enbale;
            }, e.clone = function () {
                var t;
                switch (this._angularVelocity.type) {
                    case 0:
                        t = this._angularVelocity.separateAxes ? he.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()) : he.createByConstant(this._angularVelocity.constant);
                        break;

                    case 1:
                        t = this._angularVelocity.separateAxes ? he.createByGradientSeparate(this._angularVelocity.gradientX.clone(), this._angularVelocity.gradientY.clone(), this._angularVelocity.gradientZ.clone()) : he.createByGradient(this._angularVelocity.gradient.clone());
                        break;

                    case 2:
                        t = this._angularVelocity.separateAxes ? he.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(), this._angularVelocity.constantMaxSeparate.clone()) : he.createByRandomTwoConstant(this._angularVelocity.constantMin, this._angularVelocity.constantMax);
                        break;

                    case 3:
                        t = this._angularVelocity.separateAxes ? he.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(), this._angularVelocity.gradientYMin.clone(), this._angularVelocity.gradientZMin.clone(), this._angularVelocity.gradientWMin.clone(), this._angularVelocity.gradientXMax.clone(), this._angularVelocity.gradientYMax.clone(), this._angularVelocity.gradientZMax.clone(), this._angularVelocity.gradientWMax.clone()) : he.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(), this._angularVelocity.gradientMax.clone());
                }
                var e = new this.constructor(t);
                return e.enbale = this.enbale, e;
            }, a(0, e, "angularVelocity", function () {
                return this._angularVelocity;
            }), t;
        }(), Le = function () {
            function t(e) {
                this._matrix = null, this._near = null, this._far = null, this._left = null, this._right = null,
                    this._top = null, this._bottom = null, this._matrix = e, this._near = new st(new gt()),
                    this._far = new st(new gt()), this._left = new st(new gt()), this._right = new st(new gt()),
                    this._top = new st(new gt()), this._bottom = new st(new gt()), t._getPlanesFromMatrix(this._matrix, this._near, this._far, this._left, this._right, this._top, this._bottom);
            }
            r(t, "laya.d3.math.BoundFrustum");
            var e = t.prototype;
            return e.equalsBoundFrustum = function (t) {
                return this._matrix.equalsOtherMatrix(t.matrix);
            }, e.equalsObj = function (t) {
                if (t instanceof laya.d3.math.BoundFrustum) {
                    var e = t;
                    return this.equalsBoundFrustum(e);
                }
                return !1;
            }, e.getPlane = function (t) {
                switch (t) {
                    case 0:
                        return this._near;

                    case 1:
                        return this._far;

                    case 2:
                        return this._left;

                    case 3:
                        return this._right;

                    case 4:
                        return this._top;

                    case 5:
                        return this._bottom;

                    default:
                        return null;
                }
            }, e.getCorners = function (e) {
                t._get3PlaneInterPoint(this._near, this._bottom, this._right).cloneTo(e[0]), t._get3PlaneInterPoint(this._near, this._top, this._right).cloneTo(e[1]),
                    t._get3PlaneInterPoint(this._near, this._top, this._left).cloneTo(e[2]), t._get3PlaneInterPoint(this._near, this._bottom, this._left).cloneTo(e[3]),
                    t._get3PlaneInterPoint(this._far, this._bottom, this._right).cloneTo(e[4]), t._get3PlaneInterPoint(this._far, this._top, this._right).cloneTo(e[5]),
                    t._get3PlaneInterPoint(this._far, this._top, this._left).cloneTo(e[6]), t._get3PlaneInterPoint(this._far, this._bottom, this._left).cloneTo(e[7]);
            }, e.containsPoint = function (t) {
                for (var e = st.PlaneIntersectionType_Front, i = st.PlaneIntersectionType_Front, n = 0; n < 6; n++) {
                    switch (n) {
                        case 0:
                            i = Fe.intersectsPlaneAndPoint(this._near, t);
                            break;

                        case 1:
                            i = Fe.intersectsPlaneAndPoint(this._far, t);
                            break;

                        case 2:
                            i = Fe.intersectsPlaneAndPoint(this._left, t);
                            break;

                        case 3:
                            i = Fe.intersectsPlaneAndPoint(this._right, t);
                            break;

                        case 4:
                            i = Fe.intersectsPlaneAndPoint(this._top, t);
                            break;

                        case 5:
                            i = Fe.intersectsPlaneAndPoint(this._bottom, t);
                    }
                    switch (i) {
                        case st.PlaneIntersectionType_Back:
                            return 0;

                        case st.PlaneIntersectionType_Intersecting:
                            e = st.PlaneIntersectionType_Intersecting;
                    }
                }
                switch (e) {
                    case st.PlaneIntersectionType_Intersecting:
                        return 2;

                    default:
                        return 1;
                }
            }, e.containsBoundBox = function (e) {
                for (var i = t._tempV30, n = t._tempV31, r = e.min, a = e.max, s = 1, o = 0; o < 6; o++) {
                    var l = this.getPlane(o), h = l.normal;
                    if (h.x >= 0 ? (i.x = a.x, n.x = r.x) : (i.x = r.x, n.x = a.x), h.y >= 0 ? (i.y = a.y,
                        n.y = r.y) : (i.y = r.y, n.y = a.y), h.z >= 0 ? (i.z = a.z, n.z = r.z) : (i.z = r.z,
                            n.z = a.z), Fe.intersectsPlaneAndPoint(l, i) === st.PlaneIntersectionType_Back) return 0;
                    Fe.intersectsPlaneAndPoint(l, n) === st.PlaneIntersectionType_Back && (s = 2);
                }
                return s;
            }, e.containsBoundSphere = function (t) {
                for (var e = st.PlaneIntersectionType_Front, i = st.PlaneIntersectionType_Front, n = 0; n < 6; n++) {
                    switch (n) {
                        case 0:
                            i = Fe.intersectsPlaneAndSphere(this._near, t);
                            break;

                        case 1:
                            i = Fe.intersectsPlaneAndSphere(this._far, t);
                            break;

                        case 2:
                            i = Fe.intersectsPlaneAndSphere(this._left, t);
                            break;

                        case 3:
                            i = Fe.intersectsPlaneAndSphere(this._right, t);
                            break;

                        case 4:
                            i = Fe.intersectsPlaneAndSphere(this._top, t);
                            break;

                        case 5:
                            i = Fe.intersectsPlaneAndSphere(this._bottom, t);
                    }
                    switch (i) {
                        case st.PlaneIntersectionType_Back:
                            return 0;

                        case st.PlaneIntersectionType_Intersecting:
                            e = st.PlaneIntersectionType_Intersecting;
                    }
                }
                switch (e) {
                    case st.PlaneIntersectionType_Intersecting:
                        return 2;

                    default:
                        return 1;
                }
            }, a(0, e, "top", function () {
                return this._top;
            }), a(0, e, "matrix", function () {
                return this._matrix;
            }, function (e) {
                this._matrix = e, t._getPlanesFromMatrix(this._matrix, this._near, this._far, this._left, this._right, this._top, this._bottom);
            }), a(0, e, "near", function () {
                return this._near;
            }), a(0, e, "far", function () {
                return this._far;
            }), a(0, e, "left", function () {
                return this._left;
            }), a(0, e, "right", function () {
                return this._right;
            }), a(0, e, "bottom", function () {
                return this._bottom;
            }), t._getPlanesFromMatrix = function (t, e, i, n, r, a, s) {
                var o = t.elements, l = o[0], h = o[1], u = o[2], c = o[3], d = o[4], _ = o[5], f = o[6], p = o[7], m = o[8], g = o[9], y = o[10], v = o[11], S = o[12], T = o[13], E = o[14], C = o[15], x = e.normal;
                x.x = c + u, x.y = p + f, x.z = v + y, e.distance = C + E, e.normalize();
                var b = i.normal;
                b.x = c - u, b.y = p - f, b.z = v - y, i.distance = C - E, i.normalize();
                var I = n.normal;
                I.x = c + l, I.y = p + d, I.z = v + m, n.distance = C + S, n.normalize();
                var w = r.normal;
                w.x = c - l, w.y = p - d, w.z = v - m, r.distance = C - S, r.normalize();
                var A = a.normal;
                A.x = c - h, A.y = p - _, A.z = v - g, a.distance = C - T, a.normalize();
                var R = s.normal;
                R.x = c + h, R.y = p + _, R.z = v + g, s.distance = C + T, s.normalize();
            }, t._get3PlaneInterPoint = function (e, i, n) {
                var r = e.normal, a = i.normal, s = n.normal;
                gt.cross(a, s, t._tempV30), gt.cross(s, r, t._tempV31), gt.cross(r, a, t._tempV32);
                var o = gt.dot(r, t._tempV30), l = gt.dot(a, t._tempV31), h = gt.dot(s, t._tempV32);
                return gt.scale(t._tempV30, -e.distance / o, t._tempV33), gt.scale(t._tempV31, -i.distance / l, t._tempV34),
                    gt.scale(t._tempV32, -n.distance / h, t._tempV35), gt.add(t._tempV33, t._tempV34, t._tempV36),
                    gt.add(t._tempV35, t._tempV36, t._tempV37), t._tempV37;
            }, n(t, ["_tempV30", function () {
                return this._tempV30 = new gt();
            }, "_tempV31", function () {
                return this._tempV31 = new gt();
            }, "_tempV32", function () {
                return this._tempV32 = new gt();
            }, "_tempV33", function () {
                return this._tempV33 = new gt();
            }, "_tempV34", function () {
                return this._tempV34 = new gt();
            }, "_tempV35", function () {
                return this._tempV35 = new gt();
            }, "_tempV36", function () {
                return this._tempV36 = new gt();
            }, "_tempV37", function () {
                return this._tempV37 = new gt();
            }]), t;
        }(), Pe = function () {
            function t() {
                this.indexInList = -1, this.referenceCount = 0, this.updateMark = -1, this.type = -1,
                    this.fullPath = null, this.propertyOwner = null, this.property = null, this.defaultValue = null,
                    this.crossFixedValue = null;
            }
            return r(t, "laya.d3.component.KeyframeNodeOwner"), t.prototype.saveCrossFixedValue = function () {
                var t = this.propertyOwner;
                if (t) switch (this.type) {
                    case 0:
                        for (var e = this.property, i = e.length - 1, n = 0; n < i && (t = t[e[n]]); n++);
                        this.crossFixedValue = t[e[i]];
                        break;

                    case 1:
                        var r = t.localPosition;
                        this.crossFixedValue || (this.crossFixedValue = new gt()), this.crossFixedValue.x = r.x,
                            this.crossFixedValue.y = r.y, this.crossFixedValue.z = r.z;
                        break;

                    case 2:
                        var a = t.localRotation;
                        this.crossFixedValue || (this.crossFixedValue = new ht()), this.crossFixedValue.x = a.x,
                            this.crossFixedValue.y = a.y, this.crossFixedValue.z = a.z, this.crossFixedValue.w = a.w;
                        break;

                    case 3:
                        var s = t.localScale;
                        this.crossFixedValue || (this.crossFixedValue = new gt()), this.crossFixedValue.x = s.x,
                            this.crossFixedValue.y = s.y, this.crossFixedValue.z = s.z;
                        break;

                    case 4:
                        var o = t.localRotationEuler;
                        this.crossFixedValue || (this.crossFixedValue = new gt()), this.crossFixedValue.x = o.x,
                            this.crossFixedValue.y = o.y, this.crossFixedValue.z = o.z;
                        break;

                    default:
                        throw "Animator:unknown type.";
                }
            }, t;
        }(), Ne = function () {
            function t() { }
            return r(t, "laya.d3.graphics.FrustumCulling"), t.__init__ = function () {
                I.supportWebGLPlusCulling && (t._cullingBufferLength = 0, t._cullingBuffer = new Float32Array(4096));
            }, t._drawTraversalCullingBound = function (e, i) {
                e.length;
                for (var n = e.elements, r = 0, a = e.length; r < a; r++) {
                    var s = t._tempColor0;
                    s.r = 0, s.g = 1, s.b = 0, s.a = 1, Ht._drawBound(i, n[r].bounds._getBoundBox(), s);
                }
            }, t._traversalCulling = function (t, e, i, n) {
                for (var r = n.length, a = n.elements, s = t.boundFrustum, o = t._transform.position, l = 0; l < r; l++) {
                    var h = a[l];
                    if (t._isLayerVisible(h._owner._layer) && h._enable) if (O.frustumCulling++, !t.useOcclusionCulling || h._needRender(s)) {
                        h._visible = !0;
                        var u = h.bounds;
                        h._distanceForSort = gt.distance(u.getCenter(), o);
                        for (var c = h._renderElements, d = 0, _ = c.length; d < _; d++) {
                            var f = c[d], p = e._getRenderQueue(f.material.renderQueue);
                            p.isTransparent ? f.addToTransparentRenderQueue(i, p) : f.addToOpaqueRenderQueue(i, p);
                        }
                    } else h._visible = !1; else h._visible = !1;
                }
            }, t.renderObjectCulling = function (e, i, n, r) {
                var a = 0, s = 0, o = i._opaqueQueue, l = i._transparentQueue;
                o.clear(), l.clear();
                var h = Z._managers;
                for (a = 0, s = h.length; a < s; a++) h[a]._clear();
                var u = tt._managers;
                for (a = 0, s = u.length; a < s; a++) u[a]._clear();
                var c = i._octree;
                if (c ? (c.updateMotionObjects(), c.shrinkRootIfPossible(), c.getCollidingWithFrustum(n)) : t._traversalCulling(e, i, n, r),
                    W._config.debugFrustumCulling) {
                    var d = i._debugTool;
                    d.clear(), c ? (c.drawAllBounds(d), c.drawAllObjects(d)) : t._drawTraversalCullingBound(r, d);
                }
                var _ = o.elements.length;
                _ > 0 && o._quickSort(0, _ - 1), (_ = l.elements.length) > 0 && l._quickSort(0, _ - 1);
            }, t.renderObjectCullingNative = function (e, i, n, r) {
                var a = 0, s = 0, o = 0, l = 0, h = i._opaqueQueue, u = i._transparentQueue;
                h.clear(), u.clear();
                var c = Z._managers;
                for (a = 0, s = c.length; a < s; a++) c[a]._clear();
                var d = tt._managers;
                for (a = 0, s = d.length; a < s; a++) d[a]._clear();
                var _ = r.length, f = r.elements;
                for (a = 0; a < _; a++) f[a].bounds;
                e.boundFrustum;
                t.cullingNative(e._boundFrustumBuffer, t._cullingBuffer, i._cullingBufferIndices, _, i._cullingBufferResult);
                var p = n.camera._transform.position;
                for (a = 0; a < _; a++) {
                    var m = f[a];
                    if (e._isLayerVisible(m._owner._layer) && m._enable && i._cullingBufferResult[a]) {
                        m._visible = !0, m._distanceForSort = gt.distance(m.bounds.getCenter(), p);
                        var g = m._renderElements;
                        for (o = 0, l = g.length; o < l; o++) {
                            var y = g[o], v = i._getRenderQueue(y.material.renderQueue);
                            v.isTransparent ? y.addToTransparentRenderQueue(n, v) : y.addToOpaqueRenderQueue(n, v);
                        }
                    } else m._visible = !1;
                }
                var S = h.elements.length;
                S > 0 && h._quickSort(0, S - 1), (S = u.elements.length) > 0 && u._quickSort(0, S - 1);
            }, t.cullingNative = function (t, e, i, n, r) {
                return v.instance.culling(t, e, i, n, r);
            }, t._cullingBufferLength = 0, t._cullingBuffer = null, n(t, ["_tempVector3", function () {
                return this._tempVector3 = new gt();
            }, "_tempColor0", function () {
                return this._tempColor0 = new Ct();
            }]), t;
        }(), Be = function () {
            function t(t) {
                this._defaultState = null, this._statesMap = {}, this.playOnWake = !0, this._playType = -1,
                    this._crossMark = 0, this._crossDuration = -1, this._crossNodesOwnersIndicesMap = {},
                    this._crossNodesOwnersCount = 0, this._crossNodesOwners = [], this._currentPlayState = null,
                    this._states = [], this._playStateInfo = new vt(), this._crossPlayStateInfo = new vt(),
                    this._srcCrossClipNodeIndices = [], this._destCrossClipNodeIndices = [], this.name = t,
                    this.defaultWeight = 1, this.blendingMode = laya.d3.component.AnimatorControllerLayer.BLENDINGMODE_OVERRIDE;
            }
            r(t, "laya.d3.component.AnimatorControllerLayer");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.getAnimatorState = function (t) {
                var e = this._statesMap[t];
                return e || null;
            }, e.destroy = function () {
                this._statesMap = null, this._states = null, this._playStateInfo = null, this._crossPlayStateInfo = null,
                    this._defaultState = null;
            }, e.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.blendingMode = this.blendingMode, e.defaultWeight = this.defaultWeight,
                    e.playOnWake = this.playOnWake;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "defaultState", function () {
                return this._defaultState;
            }, function (t) {
                this._defaultState = t, this._statesMap[t.name] = t;
            }), t.BLENDINGMODE_OVERRIDE = 0, t.BLENDINGMODE_ADDTIVE = 1, t;
        }(), Fe = function () {
            function t() { }
            return r(t, "laya.d3.math.CollisionUtils"), t.distancePlaneToPoint = function (t, e) {
                return gt.dot(t.normal, e) - t.distance;
            }, t.distanceBoxToPoint = function (t, e) {
                var i = t.min, n = i.x, r = i.y, a = i.z, s = t.max, o = s.x, l = s.y, h = s.z, u = e.x, c = e.y, d = e.z, _ = 0;
                return u < n && (_ += (n - u) * (n - u)), u > o && (_ += (o - u) * (o - u)), c < r && (_ += (r - c) * (r - c)),
                    c > l && (_ += (l - c) * (l - c)), d < a && (_ += (a - d) * (a - d)), d > h && (_ += (h - d) * (h - d)),
                    Math.sqrt(_);
            }, t.distanceBoxToBox = function (t, e) {
                var i = t.min, n = i.x, r = i.y, a = i.z, s = t.max, o = s.x, l = s.y, h = s.z, u = e.min, c = u.x, d = u.y, _ = u.z, f = e.max, p = f.x, m = f.y, g = f.z, y = 0, v = NaN;
                return n > p ? y += (v = n - p) * v : c > o && (y += (v = c - o) * v), r > m ? y += (v = r - m) * v : d > l && (y += (v = d - l) * v),
                    a > g ? y += (v = a - g) * v : _ > h && (y += (v = _ - h) * v), Math.sqrt(y);
            }, t.distanceSphereToPoint = function (t, e) {
                var i = Math.sqrt(gt.distanceSquared(t.center, e));
                return i -= t.radius, Math.max(i, 0);
            }, t.distanceSphereToSphere = function (t, e) {
                var i = Math.sqrt(gt.distanceSquared(t.center, e.center));
                return i -= t.radius + e.radius, Math.max(i, 0);
            }, t.intersectsRayAndTriangleRD = function (e, i, n, r, a) {
                var s = e.origin, o = s.x, l = s.y, h = s.z, u = e.direction, c = u.x, d = u.y, _ = u.z, f = i.x, p = i.y, m = i.z, g = n.x, y = n.y, v = n.z, S = r.x, T = r.y, E = r.z, C = t._tempV30.x, x = t._tempV30.y, b = t._tempV30.z;
                C = g - f, x = y - p, b = v - m;
                var I = t._tempV31.x, w = t._tempV31.y, A = t._tempV31.z;
                I = S - f, w = T - p, A = E - m;
                var R = t._tempV32.x, M = t._tempV32.y, D = t._tempV32.z, O = C * (R = d * A - _ * w) + x * (M = _ * I - c * A) + b * (D = c * w - d * I);
                if (nt.isZero(O)) return 0, !1;
                var L = 1 / O, P = t._tempV33.x, N = t._tempV33.y, B = t._tempV33.z, F = (P = o - f) * R + (N = l - p) * M + (B = h - m) * D;
                if ((F *= L) < 0 || F > 1) return 0, !1;
                var k = t._tempV34.x, V = t._tempV34.y, U = t._tempV34.z, G = c * (k = N * b - B * x) + d * (V = B * C - P * b) + _ * (U = P * x - N * C);
                if ((G *= L) < 0 || F + G > 1) return 0, !1;
                var z = I * k + w * V + A * U;
                return (z *= L) < 0 ? (0, !1) : (z, !0);
            }, t.intersectsRayAndTriangleRP = function (e, i, n, r, a) {
                return t.intersectsRayAndTriangleRD(e, i, n, r, NaN) ? (gt.scale(e.direction, NaN, t._tempV30),
                    gt.add(e.origin, t._tempV30, a), !0) : (a = gt._ZERO, !1);
            }, t.intersectsRayAndPoint = function (e, i) {
                gt.subtract(e.origin, i, t._tempV30);
                var n = gt.dot(t._tempV30, e.direction), r = gt.dot(t._tempV30, t._tempV30) - nt.zeroTolerance;
                return !(r > 0 && n > 0) && !(n * n - r < 0);
            }, t.intersectsRayAndRay = function (e, i, n) {
                var r = e.origin, a = r.x, s = r.y, o = r.z, l = e.direction, h = l.x, u = l.y, c = l.z, d = i.origin, _ = d.x, f = d.y, p = d.z, m = i.direction, g = m.x, y = m.y, v = m.z;
                gt.cross(l, m, t._tempV30);
                var S = t._tempV30, T = gt.scalarLength(t._tempV30);
                if (nt.isZero(T) && nt.nearEqual(_, a) && nt.nearEqual(f, s) && nt.nearEqual(p, o)) return gt._ZERO,
                    !0;
                T *= T;
                var E = _ - a, C = f - s, x = p - o, b = g, I = y, w = v, A = S.x, R = S.y, M = S.z, D = (E * I * M + C * w * A + x * b * R - E * w * R - C * b * M - x * I * A) / T;
                I = u, w = c, b = h;
                gt.scale(l, D, t._tempV30), gt.scale(m, D, t._tempV31), gt.add(r, t._tempV30, t._tempV32),
                    gt.add(d, t._tempV31, t._tempV33);
                var O = t._tempV32, L = t._tempV33;
                return nt.nearEqual(L.x, O.x) && nt.nearEqual(L.y, O.y) && nt.nearEqual(L.z, O.z) ? (t._tempV32,
                    !0) : (gt._ZERO, !1);
            }, t.intersectsPlaneAndTriangle = function (e, i, n, r) {
                var a = t.intersectsPlaneAndPoint(e, i), s = t.intersectsPlaneAndPoint(e, n), o = t.intersectsPlaneAndPoint(e, r);
                return a == st.PlaneIntersectionType_Front && s == st.PlaneIntersectionType_Front && o == st.PlaneIntersectionType_Front ? st.PlaneIntersectionType_Front : a == st.PlaneIntersectionType_Back && s == st.PlaneIntersectionType_Back && o == st.PlaneIntersectionType_Back ? st.PlaneIntersectionType_Back : st.PlaneIntersectionType_Intersecting;
            }, t.intersectsRayAndPlaneRD = function (t, e, i) {
                var n = e.normal, r = gt.dot(n, t.direction);
                if (nt.isZero(r)) return 0, !1;
                var a = gt.dot(n, t.origin);
                return !((-e.distance - a) / r < 0) || (0, !1);
            }, t.intersectsRayAndPlaneRP = function (e, i, n) {
                return t.intersectsRayAndPlaneRD(e, i, NaN) ? (gt.scale(e.direction, NaN, t._tempV30),
                    gt.add(e.origin, t._tempV30, t._tempV31), t._tempV31, !0) : (gt._ZERO, !1);
            }, t.intersectsRayAndBoxRD = function (t, e) {
                var i = t.origin, n = i.x, r = i.y, a = i.z, s = t.direction, o = s.x, l = s.y, h = s.z, u = e.min, c = u.x, d = u.y, _ = u.z, f = e.max, p = f.x, m = f.y, g = f.z, y = 0, v = nt.MaxValue;
                if (nt.isZero(o)) {
                    if (n < c || n > p) return -1;
                } else {
                    var S = 1 / o, T = (c - n) * S, E = (p - n) * S;
                    if (T > E) {
                        var C = T;
                        T = E, E = C;
                    }
                    if ((y = Math.max(T, y)) > (v = Math.min(E, v))) return -1;
                }
                if (nt.isZero(l)) {
                    if (r < d || r > m) return -1;
                } else {
                    var x = 1 / l, b = (d - r) * x, I = (m - r) * x;
                    if (b > I) {
                        var w = b;
                        b = I, I = w;
                    }
                    if ((y = Math.max(b, y)) > (v = Math.min(I, v))) return -1;
                }
                if (nt.isZero(h)) {
                    if (a < _ || a > g) return -1;
                } else {
                    var A = 1 / h, R = (_ - a) * A, M = (g - a) * A;
                    if (R > M) {
                        var D = R;
                        R = M, M = D;
                    }
                    if ((y = Math.max(R, y)) > (v = Math.min(M, v))) return -1;
                }
                return y;
            }, t.intersectsRayAndBoxRP = function (e, i, n) {
                var r = t.intersectsRayAndBoxRD(e, i);
                return -1 === r ? (gt._ZERO.cloneTo(n), r) : (gt.scale(e.direction, r, t._tempV30),
                    gt.add(e.origin, t._tempV30, t._tempV31), t._tempV31.cloneTo(n), r);
            }, t.intersectsRayAndSphereRD = function (e, i) {
                var n = i.radius;
                gt.subtract(e.origin, i.center, t._tempV30);
                var r = gt.dot(t._tempV30, e.direction), a = gt.dot(t._tempV30, t._tempV30) - n * n;
                if (a > 0 && r > 0) return -1;
                var s = r * r - a;
                if (s < 0) return -1;
                var o = -r - Math.sqrt(s);
                return o < 0 && (o = 0), o;
            }, t.intersectsRayAndSphereRP = function (e, i, n) {
                var r = t.intersectsRayAndSphereRD(e, i);
                return -1 === r ? (gt._ZERO.cloneTo(n), r) : (gt.scale(e.direction, r, t._tempV30),
                    gt.add(e.origin, t._tempV30, t._tempV31), t._tempV31.cloneTo(n), r);
            }, t.intersectsSphereAndTriangle = function (e, i, n, r) {
                var a = e.center, s = e.radius;
                return t.closestPointPointTriangle(a, i, n, r, t._tempV30), gt.subtract(t._tempV30, a, t._tempV31),
                    gt.dot(t._tempV31, t._tempV31) <= s * s;
            }, t.intersectsPlaneAndPoint = function (t, e) {
                var i = gt.dot(t.normal, e) + t.distance;
                return i > 0 ? st.PlaneIntersectionType_Front : i < 0 ? st.PlaneIntersectionType_Back : st.PlaneIntersectionType_Intersecting;
            }, t.intersectsPlaneAndPlane = function (e, i) {
                gt.cross(e.normal, i.normal, t._tempV30);
                var n = gt.dot(t._tempV30, t._tempV30);
                return !nt.isZero(n);
            }, t.intersectsPlaneAndPlaneRL = function (e, i, n) {
                var r = e.normal, a = i.normal;
                gt.cross(r, a, t._tempV34);
                var s = gt.dot(t._tempV34, t._tempV34);
                return !nt.isZero(s) && (gt.scale(a, e.distance, t._tempV30), gt.scale(r, i.distance, t._tempV31),
                    gt.subtract(t._tempV30, t._tempV31, t._tempV32), gt.cross(t._tempV32, t._tempV34, t._tempV33),
                    gt.normalize(t._tempV34, t._tempV34), new q(t._tempV33, t._tempV34), !0);
            }, t.intersectsPlaneAndBox = function (e, i) {
                var n = e.distance, r = e.normal, a = r.x, s = r.y, o = r.z, l = i.min, h = l.x, u = l.y, c = l.z, d = i.max, _ = d.x, f = d.y, p = d.z;
                t._tempV30.x = a > 0 ? h : _, t._tempV30.y = s > 0 ? u : f, t._tempV30.z = o > 0 ? c : p,
                    t._tempV31.x = a > 0 ? _ : h, t._tempV31.y = s > 0 ? f : u, t._tempV31.z = o > 0 ? p : c;
                var m = gt.dot(r, t._tempV30);
                return m + n > 0 ? st.PlaneIntersectionType_Front : (m = gt.dot(r, t._tempV31)) + n < 0 ? st.PlaneIntersectionType_Back : st.PlaneIntersectionType_Intersecting;
            }, t.intersectsPlaneAndSphere = function (t, e) {
                var i = e.radius, n = gt.dot(t.normal, e.center) + t.distance;
                return n > i ? st.PlaneIntersectionType_Front : n < -i ? st.PlaneIntersectionType_Back : st.PlaneIntersectionType_Intersecting;
            }, t.intersectsBoxAndBox = function (t, e) {
                var i = t.min, n = t.max, r = e.min, a = e.max;
                return !(i.x > a.x || r.x > n.x) && (!(i.y > a.y || r.y > n.y) && !(i.z > a.z || r.z > n.z));
            }, t.intersectsBoxAndSphere = function (e, i) {
                var n = i.center, r = i.radius;
                return gt.Clamp(n, e.min, e.max, t._tempV30), gt.distanceSquared(n, t._tempV30) <= r * r;
            }, t.intersectsSphereAndSphere = function (t, e) {
                var i = t.radius + e.radius;
                return gt.distanceSquared(t.center, e.center) <= i * i;
            }, t.boxContainsPoint = function (t, e) {
                var i = t.min, n = t.max;
                return i.x <= e.x && n.x >= e.x && i.y <= e.y && n.y >= e.y && i.z <= e.z && n.z >= e.z ? 1 : 0;
            }, t.boxContainsBox = function (t, e) {
                var i = t.min, n = i.x, r = i.y, a = i.z, s = t.max, o = s.x, l = s.y, h = s.z, u = e.min, c = u.x, d = u.y, _ = u.z, f = e.max, p = f.x, m = f.y, g = f.z;
                return o < c || n > p || l < d || r > m || h < _ || a > g ? 0 : n <= c && p <= o && r <= d && m <= l && a <= _ && g <= h ? 1 : 2;
            }, t.boxContainsSphere = function (e, i) {
                var n = e.min, r = n.x, a = n.y, s = n.z, o = e.max, l = o.x, h = o.y, u = o.z, c = i.center, d = c.x, _ = c.y, f = c.z, p = i.radius;
                return gt.Clamp(c, n, o, t._tempV30), gt.distanceSquared(c, t._tempV30) > p * p ? 0 : r + p <= d && d <= l - p && l - r > p && a + p <= _ && _ <= h - p && h - a > p && s + p <= f && f <= u - p && u - s > p ? 1 : 2;
            }, t.sphereContainsPoint = function (t, e) {
                return gt.distanceSquared(e, t.center) <= t.radius * t.radius ? 1 : 0;
            }, t.sphereContainsTriangle = function (e, i, n, r) {
                var a = t.sphereContainsPoint(e, i), s = t.sphereContainsPoint(e, n), o = t.sphereContainsPoint(e, r);
                return 1 == a && 1 == s && 1 == o ? 1 : t.intersectsSphereAndTriangle(e, i, n, r) ? 2 : 0;
            }, t.sphereContainsBox = function (e, i) {
                var n = e.center, r = n.x, a = n.y, s = n.z, o = e.radius, l = i.min, h = l.x, u = l.y, c = l.z, d = i.max, _ = d.x, f = d.y, p = d.z, m = t._tempV30;
                m.x, m.y, m.z;
                if (!t.intersectsBoxAndSphere(i, e)) return 0;
                var g = o * o;
                return r - h, a - f, s - p, gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - _,
                    a - f, s - p, gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - _, a - u, s - p,
                        gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - h, a - u, s - p, gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - h,
                            a - f, s - c, gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - _, a - f, s - c,
                                gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - _, a - u, s - c, gt.scalarLengthSquared(t._tempV30) > g ? 2 : (r - h,
                                    a - u, s - c, gt.scalarLengthSquared(t._tempV30) > g ? 2 : 1)))))));
            }, t.sphereContainsSphere = function (t, e) {
                var i = t.radius, n = e.radius, r = gt.distance(t.center, e.center);
                return i + n < r ? 0 : i - n < r ? 2 : 1;
            }, t.closestPointPointTriangle = function (e, i, n, r, a) {
                gt.subtract(n, i, t._tempV30), gt.subtract(r, i, t._tempV31), gt.subtract(e, i, t._tempV32),
                    gt.subtract(e, n, t._tempV33), gt.subtract(e, r, t._tempV34);
                var s = gt.dot(t._tempV30, t._tempV32), o = gt.dot(t._tempV31, t._tempV32), l = gt.dot(t._tempV30, t._tempV33), h = gt.dot(t._tempV31, t._tempV33), u = gt.dot(t._tempV30, t._tempV34), c = gt.dot(t._tempV31, t._tempV34);
                if (s <= 0 && o <= 0) i.cloneTo(a); else if (l >= 0 && h <= l) n.cloneTo(a); else {
                    var d = s * h - l * o;
                    if (d <= 0 && s >= 0 && l <= 0) {
                        var _ = s / (s - l);
                        return gt.scale(t._tempV30, _, a), void gt.add(i, a, a);
                    }
                    if (c >= 0 && u <= c) r.cloneTo(a); else {
                        var f = u * o - s * c;
                        if (f <= 0 && o >= 0 && c <= 0) {
                            var p = o / (o - c);
                            return gt.scale(t._tempV31, p, a), void gt.add(i, a, a);
                        }
                        var m = l * c - u * h;
                        if (m <= 0 && h - l >= 0 && u - c >= 0) {
                            var g = (h - l) / (h - l + (u - c));
                            return gt.subtract(r, n, a), gt.scale(a, g, a), void gt.add(n, a, a);
                        }
                        var y = 1 / (m + f + d), v = f * y, S = d * y;
                        gt.scale(t._tempV30, v, t._tempV35), gt.scale(t._tempV31, S, t._tempV36), gt.add(t._tempV35, t._tempV36, a),
                            gt.add(i, a, a);
                    }
                }
            }, t.closestPointPlanePoint = function (e, i, n) {
                var r = e.normal, a = gt.dot(r, i) - e.distance;
                gt.scale(r, a, t._tempV30), gt.subtract(i, t._tempV30, n);
            }, t.closestPointBoxPoint = function (e, i, n) {
                gt.max(i, e.min, t._tempV30), gt.min(t._tempV30, e.max, n);
            }, t.closestPointSpherePoint = function (t, e, i) {
                var n = t.center;
                gt.subtract(e, n, i), gt.normalize(i, i), gt.scale(i, t.radius, i), gt.add(i, n, i);
            }, t.closestPointSphereSphere = function (t, e, i) {
                var n = t.center;
                gt.subtract(e.center, n, i), gt.normalize(i, i), gt.scale(i, t.radius, i), gt.add(i, n, i);
            }, n(t, ["_tempV30", function () {
                return this._tempV30 = new gt();
            }, "_tempV31", function () {
                return this._tempV31 = new gt();
            }, "_tempV32", function () {
                return this._tempV32 = new gt();
            }, "_tempV33", function () {
                return this._tempV33 = new gt();
            }, "_tempV34", function () {
                return this._tempV34 = new gt();
            }, "_tempV35", function () {
                return this._tempV35 = new gt();
            }, "_tempV36", function () {
                return this._tempV36 = new gt();
            }]), t;
        }(), ke = function () {
            function t() {
                var t = this.elements = new Float32Array(9);
                t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0,
                    t[8] = 1;
            }
            r(t, "laya.d3.math.Matrix3x3");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.determinant = function () {
                var t = this.elements, e = t[0], i = t[1], n = t[2], r = t[3], a = t[4], s = t[5], o = t[6], l = t[7], h = t[8];
                return e * (h * a - s * l) + i * (-h * r + s * o) + n * (l * r - a * o);
            }, e.translate = function (t, e) {
                var i = e.elements, n = this.elements, r = n[0], a = n[1], s = n[2], o = n[3], l = n[4], h = n[5], u = n[6], c = n[7], d = n[8], _ = t.x, f = t.y;
                i[0] = r, i[1] = a, i[2] = s, i[3] = o, i[4] = l, i[5] = h, i[6] = _ * r + f * o + u,
                    i[7] = _ * a + f * l + c, i[8] = _ * s + f * h + d;
            }, e.rotate = function (t, e) {
                var i = e.elements, n = this.elements, r = n[0], a = n[1], s = n[2], o = n[3], l = n[4], h = n[5], u = n[6], c = n[7], d = n[8], _ = Math.sin(t), f = Math.cos(t);
                i[0] = f * r + _ * o, i[1] = f * a + _ * l, i[2] = f * s + _ * h, i[3] = f * o - _ * r,
                    i[4] = f * l - _ * a, i[5] = f * h - _ * s, i[6] = u, i[7] = c, i[8] = d;
            }, e.scale = function (t, e) {
                var i = e.elements, n = this.elements, r = t.x, a = t.y;
                i[0] = r * n[0], i[1] = r * n[1], i[2] = r * n[2], i[3] = a * n[3], i[4] = a * n[4],
                    i[5] = a * n[5], i[6] = n[6], i[7] = n[7], i[8] = n[8];
            }, e.invert = function (t) {
                var e = t.elements, i = this.elements, n = i[0], r = i[1], a = i[2], s = i[3], o = i[4], l = i[5], h = i[6], u = i[7], c = i[8], d = c * o - l * u, _ = -c * s + l * h, f = u * s - o * h, p = n * d + r * _ + a * f;
                p || (t = null), p = 1 / p, e[0] = d * p, e[1] = (-c * r + a * u) * p, e[2] = (l * r - a * o) * p,
                    e[3] = _ * p, e[4] = (c * n - a * h) * p, e[5] = (-l * n + a * s) * p, e[6] = f * p,
                    e[7] = (-u * n + r * h) * p, e[8] = (o * n - r * s) * p;
            }, e.transpose = function (t) {
                var e = t.elements, i = this.elements;
                if (t === this) {
                    var n = i[1], r = i[2], a = i[5];
                    e[1] = i[3], e[2] = i[6], e[3] = n, e[5] = i[7], e[6] = r, e[7] = a;
                } else e[0] = i[0], e[1] = i[3], e[2] = i[6], e[3] = i[1], e[4] = i[4], e[5] = i[7],
                    e[6] = i[2], e[7] = i[5], e[8] = i[8];
            }, e.identity = function () {
                var t = this.elements;
                t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0,
                    t[8] = 1;
            }, e.cloneTo = function (t) {
                var e, i, n;
                if ((i = this.elements) !== (n = t.elements)) for (e = 0; e < 9; ++e) n[e] = i[e];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, t.createFromTranslation = function (t, e) {
                e.elements;
                e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = t.x, e[7] = t.y,
                    e[8] = 1;
            }, t.createFromRotation = function (t, e) {
                var i = e.elements, n = Math.sin(t), r = Math.cos(t);
                i[0] = r, i[1] = n, i[2] = 0, i[3] = -n, i[4] = r, i[5] = 0, i[6] = 0, i[7] = 0,
                    i[8] = 1;
            }, t.createFromScaling = function (t, e) {
                var i = e.elements;
                i[0] = t.x, i[1] = 0, i[2] = 0, i[3] = 0, i[4] = t.y, i[5] = 0, i[6] = 0, i[7] = 0,
                    i[8] = 1;
            }, t.createFromMatrix4x4 = function (t, e) {
                e[0] = t[0], e[1] = t[1], e[2] = t[2], e[3] = t[4], e[4] = t[5], e[5] = t[6], e[6] = t[8],
                    e[7] = t[9], e[8] = t[10];
            }, t.multiply = function (t, e, i) {
                var n = i.elements, r = t.elements, a = e.elements, s = r[0], o = r[1], l = r[2], h = r[3], u = r[4], c = r[5], d = r[6], _ = r[7], f = r[8], p = a[0], m = a[1], g = a[2], y = a[3], v = a[4], S = a[5], T = a[6], E = a[7], C = a[8];
                n[0] = p * s + m * h + g * d, n[1] = p * o + m * u + g * _, n[2] = p * l + m * c + g * f,
                    n[3] = y * s + v * h + S * d, n[4] = y * o + v * u + S * _, n[5] = y * l + v * c + S * f,
                    n[6] = T * s + E * h + C * d, n[7] = T * o + E * u + C * _, n[8] = T * l + E * c + C * f;
            }, t.lookAt = function (e, i, n, r) {
                gt.subtract(e, i, t._tempV30), gt.normalize(t._tempV30, t._tempV30), gt.cross(n, t._tempV30, t._tempV31),
                    gt.normalize(t._tempV31, t._tempV31), gt.cross(t._tempV30, t._tempV31, t._tempV32);
                var a = t._tempV30, s = t._tempV31, o = t._tempV32, l = r.elements;
                l[0] = s.x, l[3] = s.y, l[6] = s.z, l[1] = o.x, l[4] = o.y, l[7] = o.z, l[2] = a.x,
                    l[5] = a.y, l[8] = a.z;
            }, t.DEFAULT = new t(), n(t, ["_tempV30", function () {
                return this._tempV30 = new gt();
            }, "_tempV31", function () {
                return this._tempV31 = new gt();
            }, "_tempV32", function () {
                return this._tempV32 = new gt();
            }]), t;
        }(), Ve = function () {
            function t() { }
            return r(t, "laya.d3.utils.Physics3DUtils"), t.setColliderCollision = function (t, e, i) { },
                t.getIColliderCollision = function (t, e) {
                    return !1;
                }, t.COLLISIONFILTERGROUP_DEFAULTFILTER = 1, t.COLLISIONFILTERGROUP_STATICFILTER = 2,
                t.COLLISIONFILTERGROUP_KINEMATICFILTER = 4, t.COLLISIONFILTERGROUP_DEBRISFILTER = 8,
                t.COLLISIONFILTERGROUP_SENSORTRIGGER = 16, t.COLLISIONFILTERGROUP_CHARACTERFILTER = 32,
                t.COLLISIONFILTERGROUP_CUSTOMFILTER1 = 64, t.COLLISIONFILTERGROUP_CUSTOMFILTER2 = 128,
                t.COLLISIONFILTERGROUP_CUSTOMFILTER3 = 256, t.COLLISIONFILTERGROUP_CUSTOMFILTER4 = 512,
                t.COLLISIONFILTERGROUP_CUSTOMFILTER5 = 1024, t.COLLISIONFILTERGROUP_CUSTOMFILTER6 = 2048,
                t.COLLISIONFILTERGROUP_CUSTOMFILTER7 = 4096, t.COLLISIONFILTERGROUP_CUSTOMFILTER8 = 8192,
                t.COLLISIONFILTERGROUP_CUSTOMFILTER9 = 16384, t.COLLISIONFILTERGROUP_CUSTOMFILTER10 = 32768,
                t.COLLISIONFILTERGROUP_ALLFILTER = -1, n(t, ["gravity", function () {
                    return this.gravity = new gt(0, -9.81, 0);
                }]), t;
        }(), Ue = function () {
            function t(t, e) {
                this.min = null, this.max = null, this.min = t, this.max = e;
            }
            r(t, "laya.d3.math.BoundBox");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e._rotateExtents = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = e.elements;
                i.x = Math.abs(s[0] * n) + Math.abs(s[4] * r) + Math.abs(s[8] * a), i.y = Math.abs(s[1] * n) + Math.abs(s[5] * r) + Math.abs(s[9] * a),
                    i.z = Math.abs(s[2] * n) + Math.abs(s[6] * r) + Math.abs(s[10] * a);
            }, e.getCorners = function (t) {
                t.length = 8;
                var e = this.min.x, i = this.min.y, n = this.min.z, r = this.max.x, a = this.max.y, s = this.max.z;
                t[0] = new gt(e, a, s), t[1] = new gt(r, a, s), t[2] = new gt(r, i, s), t[3] = new gt(e, i, s),
                    t[4] = new gt(e, a, n), t[5] = new gt(r, a, n), t[6] = new gt(r, i, n), t[7] = new gt(e, i, n);
            }, e.getCenter = function (t) {
                gt.add(this.min, this.max, t), gt.scale(t, .5, t);
            }, e.getExtent = function (t) {
                gt.subtract(this.max, this.min, t), gt.scale(t, .5, t);
            }, e.setCenterAndExtent = function (t, e) {
                gt.subtract(t, e, this.min), gt.add(t, e, this.max);
            }, e.tranform = function (e, i) {
                var n = t._tempVector30, r = t._tempVector31;
                this.getCenter(n), this.getExtent(r), gt.transformCoordinate(n, e, n), this._rotateExtents(r, e, r),
                    i.setCenterAndExtent(n, r);
            }, e.toDefault = function () {
                this.min.toDefault(), this.max.toDefault();
            }, e.cloneTo = function (t) {
                var e = t;
                this.min.cloneTo(e.min), this.max.cloneTo(e.max);
            }, e.clone = function () {
                var t = new this.constructor(new gt(), new gt());
                return this.cloneTo(t), t;
            }, t.createfromPoints = function (t, e) {
                if (null == t) throw new Error("points");
                var i = e.min, n = e.max;
                i.x = Number.MAX_VALUE, i.y = Number.MAX_VALUE, i.z = Number.MAX_VALUE, n.x = -Number.MAX_VALUE,
                    n.y = -Number.MAX_VALUE, n.z = -Number.MAX_VALUE;
                for (var r = 0, a = t.length; r < a; ++r) gt.min(i, t[r], i), gt.max(n, t[r], n);
            }, t.merge = function (t, e, i) {
                gt.min(t.min, e.min, i.min), gt.max(t.max, e.max, i.max);
            }, n(t, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }]), t;
        }(), Ge = function () {
            function t() {
                this.speed = 1, this.clipStart = 0, this.clipEnd = 1, this._nodeOwners = [];
            }
            r(t, "laya.d3.component.AnimatorState");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e._resetFrameIndices = function () {
                for (var t = 0, e = this._currentFrameIndices.length; t < e; t++) this._currentFrameIndices[t] = -1;
            }, e.addScript = function (t) {
                var e = new t();
                return this._scripts = this._scripts || [], this._scripts.push(e), e;
            }, e.getScript = function (t) {
                if (this._scripts) for (var e = 0, n = this._scripts.length; e < n; e++) {
                    var r = this._scripts[e];
                    if (i.__typeof(r, t)) return r;
                }
                return null;
            }, e.getScripts = function (t) {
                var e;
                if (this._scripts) for (var n = 0, r = this._scripts.length; n < r; n++) {
                    var a = this._scripts[n];
                    i.__typeof(a, t) && (e = e || []).push(a);
                }
                return e;
            }, e.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.speed = this.speed, e.clipStart = this.clipStart, e.clipEnd = this.clipEnd,
                    e.clip = this._clip;
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, e, "clip", function () {
                return this._clip;
            }, function (t) {
                this._clip = t, this._currentFrameIndices = new Int16Array(t._nodes.count), this._resetFrameIndices();
            }), t;
        }(), ze = (function () {
            function t() {
                this._vertices = null, this._vertexBuffer = null, this._text = null, this._fontSize = 0,
                    this._color = null;
            }
            r(t, "laya.d3.text.TextMesh");
            var e = t.prototype;
            e._createVertexBuffer = function (t) { }, e._resizeVertexBuffer = function (t) { },
                e._addChar = function () { }, a(0, e, "text", function () {
                    return this._text;
                }, function (t) {
                    this._text = t;
                }), a(0, e, "fontSize", function () {
                    return this._fontSize;
                }, function (t) {
                    this._fontSize = t;
                }), a(0, e, "color", function () {
                    return this._color;
                }, function (t) {
                    this._color = t;
                }), t._indexBuffer = null;
        }(), function () {
            function t(t, e, i, n, r, a, s, o, l, h, u, c, d, _, f, p, m) {
                void 0 === t && (t = 1), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0),
                    void 0 === r && (r = 0), void 0 === a && (a = 1), void 0 === s && (s = 0), void 0 === o && (o = 0),
                    void 0 === l && (l = 0), void 0 === h && (h = 0), void 0 === u && (u = 1), void 0 === c && (c = 0),
                    void 0 === d && (d = 0), void 0 === _ && (_ = 0), void 0 === f && (f = 0), void 0 === p && (p = 1);
                var g = this.elements = m || new Float32Array(16);
                g[0] = t, g[1] = e, g[2] = i, g[3] = n, g[4] = r, g[5] = a, g[6] = s, g[7] = o,
                    g[8] = l, g[9] = h, g[10] = u, g[11] = c, g[12] = d, g[13] = _, g[14] = f, g[15] = p;
            }
            r(t, "laya.d3.math.Matrix4x4");
            var e = t.prototype;
            return i.imps(e, {
                "laya.d3.core.IClone": !0
            }), e.setRotation = function (t) {
                var e = t.x, i = t.y, n = t.z, r = t.w, a = e * e, s = i * i, o = n * n, l = e * i, h = n * r, u = n * e, c = i * r, d = i * n, _ = e * r, f = this.elements;
                f[0] = 1 - 2 * (s + o), f[1] = 2 * (l + h), f[2] = 2 * (u - c), f[4] = 2 * (l - h),
                    f[5] = 1 - 2 * (o + a), f[6] = 2 * (d + _), f[8] = 2 * (u + c), f[9] = 2 * (d - _),
                    f[10] = 1 - 2 * (s + a);
            }, e.setPosition = function (t) {
                var e = this.elements;
                e[12] = t.x, e[13] = t.y, e[14] = t.z;
            }, e.getElementByRowColumn = function (t, e) {
                if (t < 0 || t > 3) throw new Error("row", "Rows and columns for matrices run from 0 to 3, inclusive.");
                if (e < 0 || e > 3) throw new Error("column", "Rows and columns for matrices run from 0 to 3, inclusive.");
                return this.elements[4 * t + e];
            }, e.setElementByRowColumn = function (t, e, i) {
                if (t < 0 || t > 3) throw new Error("row", "Rows and columns for matrices run from 0 to 3, inclusive.");
                if (e < 0 || e > 3) throw new Error("column", "Rows and columns for matrices run from 0 to 3, inclusive.");
                this.elements[4 * t + e] = i;
            }, e.equalsOtherMatrix = function (t) {
                var e = this.elements, i = t.elements;
                return nt.nearEqual(e[0], i[0]) && nt.nearEqual(e[1], i[1]) && nt.nearEqual(e[2], i[2]) && nt.nearEqual(e[3], i[3]) && nt.nearEqual(e[4], i[4]) && nt.nearEqual(e[5], i[5]) && nt.nearEqual(e[6], i[6]) && nt.nearEqual(e[7], i[7]) && nt.nearEqual(e[8], i[8]) && nt.nearEqual(e[9], i[9]) && nt.nearEqual(e[10], i[10]) && nt.nearEqual(e[11], i[11]) && nt.nearEqual(e[12], i[12]) && nt.nearEqual(e[13], i[13]) && nt.nearEqual(e[14], i[14]) && nt.nearEqual(e[15], i[15]);
            }, e.decomposeTransRotScale = function (e, i, n) {
                var r = t._tempMatrix4x4;
                return this.decomposeTransRotMatScale(e, r, n) ? (ht.createFromMatrix4x4(r, i),
                    !0) : (i.identity(), !1);
            }, e.decomposeTransRotMatScale = function (e, i, n) {
                var r = this.elements, a = e, s = i.elements, o = n;
                a.x = r[12], a.y = r[13], a.z = r[14];
                var l = r[0], h = r[1], u = r[2], c = r[4], d = r[5], _ = r[6], f = r[8], p = r[9], m = r[10], g = o.x = Math.sqrt(l * l + h * h + u * u), y = o.y = Math.sqrt(c * c + d * d + _ * _), v = o.z = Math.sqrt(f * f + p * p + m * m);
                if (nt.isZero(g) || nt.isZero(y) || nt.isZero(v)) return s[1] = s[2] = s[3] = s[4] = s[6] = s[7] = s[8] = s[9] = s[11] = s[12] = s[13] = s[14] = 0,
                    s[0] = s[5] = s[10] = s[15] = 1, !1;
                var S = t._tempVector0;
                S.x = f / v, S.y = p / v, S.z = m / v;
                var T = t._tempVector1;
                T.x = l / g, T.y = h / g, T.z = u / g;
                var E = t._tempVector2;
                gt.cross(S, T, E);
                var C = t._tempVector1;
                return gt.cross(E, S, C), s[3] = s[7] = s[11] = s[12] = s[13] = s[14] = 0, s[15] = 1,
                    s[0] = C.x, s[1] = C.y, s[2] = C.z, s[4] = E.x, s[5] = E.y, s[6] = E.z, s[8] = S.x,
                    s[9] = S.y, s[10] = S.z, s[0] * l + s[1] * h + s[2] * u < 0 && (o[0] = -g), s[4] * c + s[5] * d + s[6] * _ < 0 && (o[1] = -y),
                    s[8] * f + s[9] * p + s[10] * m < 0 && (o[2] = -v), !0;
            }, e.decomposeYawPitchRoll = function (t) {
                var e = Math.asin(-this.elements[9]);
                t.y = e, Math.cos(e) > nt.zeroTolerance ? (t.z = Math.atan2(this.elements[1], this.elements[5]),
                    t.x = Math.atan2(this.elements[8], this.elements[10])) : (t.z = Math.atan2(-this.elements[4], this.elements[0]),
                        t.x = 0);
            }, e.normalize = function () {
                var t = this.elements, e = t[0], i = t[1], n = t[2], r = Math.sqrt(e * e + i * i + n * n);
                if (!r) return t[0] = 0, t[1] = 0, void (t[2] = 0);
                1 != r && (r = 1 / r, t[0] = e * r, t[1] = i * r, t[2] = n * r);
            }, e.transpose = function () {
                var t, e;
                return e = (t = this.elements)[1], t[1] = t[4], t[4] = e, e = t[2], t[2] = t[8],
                    t[8] = e, e = t[3], t[3] = t[12], t[12] = e, e = t[6], t[6] = t[9], t[9] = e, e = t[7],
                    t[7] = t[13], t[13] = e, e = t[11], t[11] = t[14], t[14] = e, this;
            }, e.invert = function (t) {
                var e = this.elements, i = t.elements, n = e[0], r = e[1], a = e[2], s = e[3], o = e[4], l = e[5], h = e[6], u = e[7], c = e[8], d = e[9], _ = e[10], f = e[11], p = e[12], m = e[13], g = e[14], y = e[15], v = n * l - r * o, S = n * h - a * o, T = n * u - s * o, E = r * h - a * l, C = r * u - s * l, x = a * u - s * h, b = c * m - d * p, I = c * g - _ * p, w = c * y - f * p, A = d * g - _ * m, R = d * y - f * m, M = _ * y - f * g, D = v * M - S * R + T * A + E * w - C * I + x * b;
                0 !== Math.abs(D) && (D = 1 / D, i[0] = (l * M - h * R + u * A) * D, i[1] = (a * R - r * M - s * A) * D,
                    i[2] = (m * x - g * C + y * E) * D, i[3] = (_ * C - d * x - f * E) * D, i[4] = (h * w - o * M - u * I) * D,
                    i[5] = (n * M - a * w + s * I) * D, i[6] = (g * T - p * x - y * S) * D, i[7] = (c * x - _ * T + f * S) * D,
                    i[8] = (o * R - l * w + u * b) * D, i[9] = (r * w - n * R - s * b) * D, i[10] = (p * C - m * T + y * v) * D,
                    i[11] = (d * T - c * C - f * v) * D, i[12] = (l * I - o * A - h * b) * D, i[13] = (n * A - r * I + a * b) * D,
                    i[14] = (m * S - p * E - g * v) * D, i[15] = (c * E - d * S + _ * v) * D);
            }, e.identity = function () {
                var t = this.elements;
                t[1] = t[2] = t[3] = t[4] = t[6] = t[7] = t[8] = t[9] = t[11] = t[12] = t[13] = t[14] = 0,
                    t[0] = t[5] = t[10] = t[15] = 1;
            }, e.cloneTo = function (t) {
                var e, i, n;
                if ((i = this.elements) !== (n = t.elements)) for (e = 0; e < 16; ++e) n[e] = i[e];
            }, e.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, e.getTranslationVector = function (t) {
                var e = this.elements;
                t.x = e[12], t.y = e[13], t.z = e[14];
            }, e.setTranslationVector = function (t) {
                var e = this.elements, i = t;
                e[12] = i.x, e[13] = i.y, e[14] = i.z;
            }, e.getForward = function (t) {
                var e = this.elements;
                t.x = -e[8], t.y = -e[9], t.z = -e[10];
            }, e.setForward = function (t) {
                var e = this.elements;
                e[8] = -t.x, e[9] = -t.y, e[10] = -t.z;
            }, t.createRotationX = function (t, e) {
                var i = e.elements, n = Math.sin(t), r = Math.cos(t);
                i[1] = i[2] = i[3] = i[4] = i[7] = i[8] = i[11] = i[12] = i[13] = i[14] = 0, i[0] = i[15] = 1,
                    i[5] = i[10] = r, i[6] = n, i[9] = -n;
            }, t.createRotationY = function (t, e) {
                var i = e.elements, n = Math.sin(t), r = Math.cos(t);
                i[1] = i[3] = i[4] = i[6] = i[7] = i[9] = i[11] = i[12] = i[13] = i[14] = 0, i[5] = i[15] = 1,
                    i[0] = i[10] = r, i[2] = -n, i[8] = n;
            }, t.createRotationZ = function (t, e) {
                var i = e.elements, n = Math.sin(t), r = Math.cos(t);
                i[2] = i[3] = i[6] = i[7] = i[8] = i[9] = i[11] = i[12] = i[13] = i[14] = 0, i[10] = i[15] = 1,
                    i[0] = i[5] = r, i[1] = n, i[4] = -n;
            }, t.createRotationYawPitchRoll = function (e, i, n, r) {
                ht.createFromYawPitchRoll(e, i, n, t._tempQuaternion), t.createRotationQuaternion(t._tempQuaternion, r);
            }, t.createRotationAxis = function (t, e, i) {
                var n = t.x, r = t.y, a = t.z, s = Math.cos(e), o = Math.sin(e), l = n * n, h = r * r, u = a * a, c = n * r, d = n * a, _ = r * a, f = i.elements;
                f[3] = f[7] = f[11] = f[12] = f[13] = f[14] = 0, f[15] = 1, f[0] = l + s * (1 - l),
                    f[1] = c - s * c + o * a, f[2] = d - s * d - o * r, f[4] = c - s * c - o * a, f[5] = h + s * (1 - h),
                    f[6] = _ - s * _ + o * n, f[8] = d - s * d + o * r, f[9] = _ - s * _ - o * n, f[10] = u + s * (1 - u);
            }, t.createRotationQuaternion = function (t, e) {
                var i = e.elements, n = t.x, r = t.y, a = t.z, s = t.w, o = n * n, l = r * r, h = a * a, u = n * r, c = a * s, d = a * n, _ = r * s, f = r * a, p = n * s;
                i[3] = i[7] = i[11] = i[12] = i[13] = i[14] = 0, i[15] = 1, i[0] = 1 - 2 * (l + h),
                    i[1] = 2 * (u + c), i[2] = 2 * (d - _), i[4] = 2 * (u - c), i[5] = 1 - 2 * (h + o),
                    i[6] = 2 * (f + p), i[8] = 2 * (d + _), i[9] = 2 * (f - p), i[10] = 1 - 2 * (l + o);
            }, t.createTranslate = function (t, e) {
                var i = e.elements;
                i[4] = i[8] = i[1] = i[9] = i[2] = i[6] = i[3] = i[7] = i[11] = 0, i[0] = i[5] = i[10] = i[15] = 1,
                    i[12] = t.x, i[13] = t.y, i[14] = t.z;
            }, t.createScaling = function (t, e) {
                var i = e.elements;
                i[0] = t.x, i[5] = t.y, i[10] = t.z, i[1] = i[4] = i[8] = i[12] = i[9] = i[13] = i[2] = i[6] = i[14] = i[3] = i[7] = i[11] = 0,
                    i[15] = 1;
            }, t.multiply = function (t, e, i) {
                var n, r, a, s, o, l, h, u;
                if (r = i.elements, a = t.elements, r === (s = e.elements)) for (s = new Float32Array(16),
                    n = 0; n < 16; ++n) s[n] = r[n];
                var c = s[0], d = s[1], _ = s[2], f = s[3], p = s[4], m = s[5], g = s[6], y = s[7], v = s[8], S = s[9], T = s[10], E = s[11], C = s[12], x = s[13], b = s[14], I = s[15];
                for (n = 0; n < 4; n++) o = a[n], l = a[n + 4], h = a[n + 8], u = a[n + 12], r[n] = o * c + l * d + h * _ + u * f,
                    r[n + 4] = o * p + l * m + h * g + u * y, r[n + 8] = o * v + l * S + h * T + u * E,
                    r[n + 12] = o * C + l * x + h * b + u * I;
            }, t.multiplyForNative = function (t, e, i) {
                v.instance.matrix4x4Multiply(t.elements, e.elements, i.elements);
            }, t.createFromQuaternion = function (t, e) {
                var i = e.elements, n = t.x, r = t.y, a = t.z, s = t.w, o = n + n, l = r + r, h = a + a, u = n * o, c = r * o, d = r * l, _ = a * o, f = a * l, p = a * h, m = s * o, g = s * l, y = s * h;
                i[0] = 1 - d - p, i[1] = c + y, i[2] = _ - g, i[3] = 0, i[4] = c - y, i[5] = 1 - u - p,
                    i[6] = f + m, i[7] = 0, i[8] = _ + g, i[9] = f - m, i[10] = 1 - u - d, i[11] = 0,
                    i[12] = 0, i[13] = 0, i[14] = 0, i[15] = 1;
            }, t.createAffineTransformation = function (t, e, i, n) {
                var r = n.elements, a = e.x, s = e.y, o = e.z, l = e.w, h = a + a, u = s + s, c = o + o, d = a * h, _ = a * u, f = a * c, p = s * u, m = s * c, g = o * c, y = l * h, v = l * u, S = l * c, T = i.x, E = i.y, C = i.z;
                r[0] = (1 - (p + g)) * T, r[1] = (_ + S) * T, r[2] = (f - v) * T, r[3] = 0, r[4] = (_ - S) * E,
                    r[5] = (1 - (d + g)) * E, r[6] = (m + y) * E, r[7] = 0, r[8] = (f + v) * C, r[9] = (m - y) * C,
                    r[10] = (1 - (d + p)) * C, r[11] = 0, r[12] = t.x, r[13] = t.y, r[14] = t.z, r[15] = 1;
            }, t.createLookAt = function (e, i, n, r) {
                var a = r.elements, s = t._tempVector0, o = t._tempVector1, l = t._tempVector2;
                gt.subtract(e, i, l), gt.normalize(l, l), gt.cross(n, l, s), gt.normalize(s, s),
                    gt.cross(l, s, o), r.identity(), a[0] = s.x, a[4] = s.y, a[8] = s.z, a[1] = o.x,
                    a[5] = o.y, a[9] = o.z, a[2] = l.x, a[6] = l.y, a[10] = l.z, a[12] = -gt.dot(s, e),
                    a[13] = -gt.dot(o, e), a[14] = -gt.dot(l, e);
            }, t.createPerspective = function (e, i, n, r, a) {
                var s = 1 / Math.tan(.5 * e), o = n / (s / i), l = n / s;
                t.createPerspectiveOffCenter(-o, o, -l, l, n, r, a);
            }, t.createPerspectiveOffCenter = function (t, e, i, n, r, a, s) {
                var o = s.elements, l = a / (a - r);
                o[1] = o[2] = o[3] = o[4] = o[6] = o[7] = o[12] = o[13] = o[15] = 0, o[0] = 2 * r / (e - t),
                    o[5] = 2 * r / (n - i), o[8] = (t + e) / (e - t), o[9] = (n + i) / (n - i), o[10] = -l,
                    o[11] = -1, o[14] = -r * l;
            }, t.createOrthoOffCenter = function (t, e, i, n, r, a, s) {
                var o = s.elements, l = 1 / (a - r);
                o[1] = o[2] = o[3] = o[4] = o[6] = o[8] = o[7] = o[9] = o[11] = 0, o[15] = 1, o[0] = 2 / (e - t),
                    o[5] = 2 / (n - i), o[10] = -l, o[12] = (t + e) / (t - e), o[13] = (n + i) / (i - n),
                    o[14] = -r * l;
            }, t.billboard = function (e, i, n, r, a, s) {
                gt.subtract(e, i, t._tempVector0);
                var o = gt.scalarLengthSquared(t._tempVector0);
                nt.isZero(o) ? (gt.scale(a, -1, t._tempVector1), t._tempVector1.cloneTo(t._tempVector0)) : gt.scale(t._tempVector0, 1 / Math.sqrt(o), t._tempVector0),
                    gt.cross(r, t._tempVector0, t._tempVector2), gt.normalize(t._tempVector2, t._tempVector2),
                    gt.cross(t._tempVector0, t._tempVector2, t._tempVector3);
                var l = t._tempVector2, h = t._tempVector3, u = t._tempVector0, c = e, d = s.elements;
                d[0] = l.x, d[1] = l.y, d[2] = l.z, d[3] = 0, d[4] = h.x, d[5] = h.y, d[6] = h.z,
                    d[7] = 0, d[8] = u.x, d[9] = u.y, d[10] = u.z, d[11] = 0, d[12] = c.x, d[13] = c.y,
                    d[14] = c.z, d[15] = 1;
            }, t.translation = function (t, e) {
                var i = e.elements;
                i[0] = i[5] = i[10] = i[15] = 1, i[12] = t.x, i[13] = t.y, i[14] = t.z;
            }, n(t, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new t();
            }, "_tempVector0", function () {
                return this._tempVector0 = new gt();
            }, "_tempVector1", function () {
                return this._tempVector1 = new gt();
            }, "_tempVector2", function () {
                return this._tempVector2 = new gt();
            }, "_tempVector3", function () {
                return this._tempVector3 = new gt();
            }, "_tempQuaternion", function () {
                return this._tempQuaternion = new ht();
            }, "DEFAULT", function () {
                return this.DEFAULT = new t();
            }, "ZERO", function () {
                return this.ZERO = new t(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
            }]), t;
        }()), He = function () {
            function t(t, e) {
                this._nativeDiscreteDynamicsWorld = null, this._nativeCollisionWorld = null, this._nativeDispatcher = null,
                    this._nativeCollisionConfiguration = null, this._nativeBroadphase = null, this._nativeSolverInfo = null,
                    this._nativeDispatchInfo = null, this._nativeClosestRayResultCallback = null, this._nativeAllHitsRayResultCallback = null,
                    this._nativeClosestConvexResultCallback = null, this._nativeAllConvexResultCallback = null,
                    this._updatedRigidbodies = 0, this.maxSubSteps = 1, this.fixedTimeStep = 1 / 60,
                    this._gravity = new gt(0, -10, 0), this._nativeVector3Zero = new W._physics3D.btVector3(0, 0, 0),
                    this._nativeDefaultQuaternion = new W._physics3D.btQuaternion(0, 0, 0, -1), this._collisionsUtils = new Xt(),
                    this._previousFrameCollisions = [], this._currentFrameCollisions = [], this._physicsUpdateList = new ui(),
                    this._characters = [], void 0 === e && (e = 0), this.maxSubSteps = t.maxSubSteps,
                    this.fixedTimeStep = t.fixedTimeStep;
                var i = W._physics3D;
                this._nativeCollisionConfiguration = new i.btDefaultCollisionConfiguration(), this._nativeDispatcher = new i.btCollisionDispatcher(this._nativeCollisionConfiguration),
                    this._nativeBroadphase = new i.btDbvtBroadphase(), this._nativeBroadphase.getOverlappingPairCache().setInternalGhostPairCallback(new i.btGhostPairCallback());
                var n = t.flags;
                if (1 & n) this._nativeCollisionWorld = new i.btCollisionWorld(this._nativeDispatcher, this._nativeBroadphase, this._nativeCollisionConfiguration); else {
                    if (2 & n) throw "PhysicsSimulation:SoftBody processing is not yet available";
                    var r = new i.btSequentialImpulseConstraintSolver();
                    this._nativeDiscreteDynamicsWorld = new i.btDiscreteDynamicsWorld(this._nativeDispatcher, this._nativeBroadphase, r, this._nativeCollisionConfiguration),
                        this._nativeCollisionWorld = this._nativeDiscreteDynamicsWorld;
                }
                this._nativeDiscreteDynamicsWorld && (this._nativeSolverInfo = this._nativeDiscreteDynamicsWorld.getSolverInfo(),
                    this._nativeDispatchInfo = this._nativeDiscreteDynamicsWorld.getDispatchInfo()),
                    this._nativeClosestRayResultCallback = new i.ClosestRayResultCallback(this._nativeVector3Zero, this._nativeVector3Zero),
                    this._nativeAllHitsRayResultCallback = new i.AllHitsRayResultCallback(this._nativeVector3Zero, this._nativeVector3Zero),
                    this._nativeClosestConvexResultCallback = new i.ClosestConvexResultCallback(this._nativeVector3Zero, this._nativeVector3Zero),
                    this._nativeAllConvexResultCallback = new i.AllConvexResultCallback(this._nativeVector3Zero, this._nativeVector3Zero),
                    i._btGImpactCollisionAlgorithm_RegisterAlgorithm(this._nativeDispatcher.a);
            }
            r(t, "laya.d3.physics.PhysicsSimulation");
            var e = t.prototype;
            return e._simulate = function (t) {
                this._updatedRigidbodies = 0, this._nativeDiscreteDynamicsWorld ? this._nativeDiscreteDynamicsWorld.stepSimulation(t, this.maxSubSteps, this.fixedTimeStep) : this._nativeCollisionWorld.PerformDiscreteCollisionDetection();
            }, e._destroy = function () {
                var t = W._physics3D;
                this._nativeDiscreteDynamicsWorld ? (t.destroy(this._nativeDiscreteDynamicsWorld),
                    this._nativeDiscreteDynamicsWorld = null) : (t.destroy(this._nativeCollisionWorld),
                        this._nativeCollisionWorld = null), t.destroy(this._nativeBroadphase), this._nativeBroadphase = null,
                    t.destroy(this._nativeDispatcher), this._nativeDispatcher = null, t.destroy(this._nativeCollisionConfiguration),
                    this._nativeCollisionConfiguration = null;
            }, e._addPhysicsCollider = function (t, e, i) {
                this._nativeCollisionWorld.addCollisionObject(t._nativeColliderObject, e, i);
            }, e._removePhysicsCollider = function (t) {
                this._nativeCollisionWorld.removeCollisionObject(t._nativeColliderObject);
            }, e._addRigidBody = function (t, e, i) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.addRigidBody(t._nativeColliderObject, e, i);
            }, e._removeRigidBody = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.removeRigidBody(t._nativeColliderObject);
            }, e._addCharacter = function (t, e, i) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.addCollisionObject(t._nativeColliderObject, e, i), this._nativeCollisionWorld.addAction(t._nativeKinematicCharacter);
            }, e._removeCharacter = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeCollisionWorld.removeCollisionObject(t._nativeColliderObject), this._nativeCollisionWorld.removeAction(t._nativeKinematicCharacter);
            }, e.raycastFromTo = function (e, i, n, r, a) {
                void 0 === r && (r = Ve.COLLISIONFILTERGROUP_ALLFILTER), void 0 === a && (a = Ve.COLLISIONFILTERGROUP_ALLFILTER);
                var s = this._nativeClosestRayResultCallback, o = t._nativeTempVector30, l = t._nativeTempVector31;
                if (o.setValue(-e.x, e.y, e.z), l.setValue(-i.x, i.y, i.z), s.set_m_rayFromWorld(o),
                    s.set_m_rayToWorld(l), s.set_m_collisionFilterGroup(r), s.set_m_collisionFilterMask(a),
                    s.set_m_collisionObject(null), s.set_m_closestHitFraction(1), this._nativeCollisionWorld.rayTest(o, l, s),
                    s.hasHit()) {
                    if (n) {
                        n.succeeded = !0, n.collider = je._physicObjectsMap[s.get_m_collisionObject().getUserIndex()],
                            n.hitFraction = s.get_m_closestHitFraction();
                        var h = s.get_m_hitPointWorld(), u = n.point;
                        u.x = -h.x(), u.y = h.y(), u.z = h.z();
                        var c = s.get_m_hitNormalWorld(), d = n.normal;
                        d.x = -c.x(), d.y = c.y(), d.z = c.z();
                    }
                    return !0;
                }
                return n && (n.succeeded = !1), !1;
            }, e.raycastAllFromTo = function (e, i, n, r, a) {
                void 0 === r && (r = Ve.COLLISIONFILTERGROUP_ALLFILTER), void 0 === a && (a = Ve.COLLISIONFILTERGROUP_ALLFILTER);
                var s = this._nativeAllHitsRayResultCallback, o = t._nativeTempVector30, l = t._nativeTempVector31;
                n.length = 0, o.setValue(-e.x, e.y, e.z), l.setValue(-i.x, i.y, i.z), s.set_m_rayFromWorld(o),
                    s.set_m_rayToWorld(l), s.set_m_collisionFilterGroup(r), s.set_m_collisionFilterMask(a);
                var h = s.get_m_collisionObjects(), u = s.get_m_hitPointWorld(), c = s.get_m_hitNormalWorld(), d = s.get_m_hitFractions();
                h.clear(), u.clear(), c.clear(), d.clear(), this._nativeCollisionWorld.rayTest(o, l, s);
                var _ = h.size();
                if (_ > 0) {
                    this._collisionsUtils.recoverAllHitResultsPool();
                    for (var f = 0; f < _; f++) {
                        var p = this._collisionsUtils.getHitResult();
                        n.push(p), p.succeeded = !0, p.collider = je._physicObjectsMap[h.at(f).getUserIndex()],
                            p.hitFraction = d.at(f);
                        var m = u.at(f), g = p.point;
                        g.x = -m.x(), g.y = m.y(), g.z = m.z();
                        var y = c.at(f), v = p.normal;
                        v.x = -y.x(), v.y = y.y(), v.z = y.z();
                    }
                    return !0;
                }
                return !1;
            }, e.rayCast = function (e, i, n, r, a) {
                void 0 === n && (n = 2147483647), void 0 === r && (r = Ve.COLLISIONFILTERGROUP_ALLFILTER),
                    void 0 === a && (a = Ve.COLLISIONFILTERGROUP_ALLFILTER);
                var s = e.origin, o = t._tempVector30;
                return gt.normalize(e.direction, o), gt.scale(o, n, o), gt.add(s, o, o), this.raycastFromTo(s, o, i, r, a);
            }, e.rayCastAll = function (e, i, n, r, a) {
                void 0 === n && (n = 2147483647), void 0 === r && (r = Ve.COLLISIONFILTERGROUP_ALLFILTER),
                    void 0 === a && (a = Ve.COLLISIONFILTERGROUP_ALLFILTER);
                var s = e.origin, o = t._tempVector30;
                return gt.normalize(e.direction, o), gt.scale(o, n, o), gt.add(s, o, o), this.raycastAllFromTo(s, o, i, r, a);
            }, e.shapeCast = function (e, i, n, r, a, s, o, l, h) {
                void 0 === o && (o = Ve.COLLISIONFILTERGROUP_ALLFILTER), void 0 === l && (l = Ve.COLLISIONFILTERGROUP_ALLFILTER),
                    void 0 === h && (h = 0);
                var u = this._nativeClosestConvexResultCallback, c = t._nativeTempVector30, d = t._nativeTempVector31, _ = t._nativeTempQuaternion0, f = t._nativeTempQuaternion1, p = t._nativeTempTransform0, m = t._nativeTempTransform1, g = e._nativeShape;
                if (c.setValue(-i.x, i.y, i.z), d.setValue(-n.x, n.y, n.z), u.set_m_collisionFilterGroup(o),
                    u.set_m_collisionFilterMask(l), p.setOrigin(c), m.setOrigin(d), a ? (_.setValue(-a.x, a.y, a.z, -a.w),
                        p.setRotation(_)) : p.setRotation(this._nativeDefaultQuaternion), s ? (f.setValue(-s.x, s.y, s.z, -s.w),
                            m.setRotation(f)) : m.setRotation(this._nativeDefaultQuaternion), u.set_m_hitCollisionObject(null),
                    u.set_m_closestHitFraction(1), this._nativeCollisionWorld.convexSweepTest(g, p, m, u, h),
                    u.hasHit()) {
                    if (r) {
                        r.succeeded = !0, r.collider = je._physicObjectsMap[u.get_m_hitCollisionObject().getUserIndex()],
                            r.hitFraction = u.get_m_closestHitFraction();
                        var y = u.get_m_hitPointWorld(), v = u.get_m_hitNormalWorld(), S = r.point, T = r.normal;
                        S.x = -y.x(), S.y = y.y(), S.z = y.z(), T.x = -v.x(), T.y = v.y(), T.z = v.z();
                    }
                    return !0;
                }
                return r && (r.succeeded = !1), !1;
            }, e.shapeCastAll = function (e, i, n, r, a, s, o, l, h) {
                void 0 === o && (o = Ve.COLLISIONFILTERGROUP_ALLFILTER), void 0 === l && (l = Ve.COLLISIONFILTERGROUP_ALLFILTER),
                    void 0 === h && (h = 0);
                var u = this._nativeAllConvexResultCallback, c = t._nativeTempVector30, d = t._nativeTempVector31, _ = t._nativeTempQuaternion0, f = t._nativeTempQuaternion1, p = t._nativeTempTransform0, m = t._nativeTempTransform1, g = e._nativeShape;
                r.length = 0, c.setValue(-i.x, i.y, i.z), d.setValue(-n.x, n.y, n.z), u.set_m_collisionFilterGroup(o),
                    u.set_m_collisionFilterMask(l), p.setOrigin(c), m.setOrigin(d), a ? (_.setValue(-a.x, a.y, a.z, -a.w),
                        p.setRotation(_)) : p.setRotation(this._nativeDefaultQuaternion), s ? (f.setValue(-s.x, s.y, s.z, -s.w),
                            m.setRotation(f)) : m.setRotation(this._nativeDefaultQuaternion);
                var y = u.get_m_collisionObjects();
                y.clear(), this._nativeCollisionWorld.convexSweepTest(g, p, m, u, h);
                var v = y.size();
                if (v > 0) {
                    for (var S = u.get_m_hitPointWorld(), T = u.get_m_hitNormalWorld(), E = u.get_m_hitFractions(), C = 0; C < v; C++) {
                        var x = this._collisionsUtils.getHitResult();
                        r.push(x), x.succeeded = !0, x.collider = je._physicObjectsMap[y.at(C).getUserIndex()],
                            x.hitFraction = E.at(C);
                        var b = S.at(C), I = x.point;
                        I.x = -b.x(), I.y = b.y(), I.z = b.z();
                        var w = T.at(C), A = x.normal;
                        A.x = -w.x(), A.y = w.y(), A.z = w.z();
                    }
                    return !0;
                }
                return !1;
            }, e.addConstraint = function (t, e) {
                if (void 0 === e && (e = !1), !this._nativeDiscreteDynamicsWorld) throw "Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.addConstraint(t._nativeConstraint, e), t._simulation = this;
            }, e.removeConstraint = function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.removeConstraint(t._nativeConstraint);
            }, e._updatePhysicsTransformFromRender = function () {
                for (var t = this._physicsUpdateList.elements, e = 0, i = this._physicsUpdateList.length; e < i; e++) {
                    var n = t[e];
                    n._derivePhysicsTransformation(!1), n._inPhysicUpdateListIndex = -1;
                }
                this._physicsUpdateList.length = 0;
            }, e._updateCharacters = function () {
                for (var t = 0, e = this._characters.length; t < e; t++) {
                    var i = this._characters[t];
                    i._updateTransformComponent(i._nativeColliderObject.getWorldTransform());
                }
            }, e._updateCollisions = function () {
                this._collisionsUtils.recoverAllContactPointsPool();
                var t = this._currentFrameCollisions;
                this._currentFrameCollisions = this._previousFrameCollisions, this._currentFrameCollisions.length = 0,
                    this._previousFrameCollisions = t;
                for (var e = O.loopCount, i = this._nativeDispatcher.getNumManifolds(), n = 0; n < i; n++) {
                    var r = this._nativeDispatcher.getManifoldByIndexInternal(n), a = je._physicObjectsMap[r.getBody0().getUserIndex()], s = je._physicObjectsMap[r.getBody1().getUserIndex()], o = null, l = !1, h = null;
                    if ((a.isTrigger || s.isTrigger) && (a.owner._needProcessTriggers || s.owner._needProcessTriggers)) for (var u = r.getNumContacts(), c = 0; c < u; c++) {
                        var d = r.getContactPoint(c), _ = d.getDistance();
                        if (_ <= 0) {
                            h = (o = this._collisionsUtils.getCollision(a, s)).contacts, (l = o._updateFrame !== e) && (o._isTrigger = !0,
                                h.length = 0);
                            break;
                        }
                    } else if ((a.owner._needProcessCollisions || s.owner._needProcessCollisions) && (a._enableProcessCollisions || s._enableProcessCollisions)) for (u = r.getNumContacts(),
                        c = 0; c < u; c++) if ((_ = (d = r.getContactPoint(c)).getDistance()) <= 0) {
                            var f = this._collisionsUtils.getContactPoints();
                            f.colliderA = a, f.colliderB = s, f.distance = _;
                            var p = d.get_m_normalWorldOnB(), m = f.normal;
                            m.x = -p.x(), m.y = p.y(), m.z = p.z();
                            var g = d.get_m_positionWorldOnA(), y = f.positionOnA;
                            y.x = -g.x(), y.y = g.y(), y.z = g.z();
                            var v = d.get_m_positionWorldOnB(), S = f.positionOnB;
                            S.x = -v.x(), S.y = v.y(), S.z = v.z(), o || (h = (o = this._collisionsUtils.getCollision(a, s)).contacts,
                                (l = o._updateFrame !== e) && (o._isTrigger = !1, h.length = 0)), h.push(f);
                        }
                    o && l && (this._currentFrameCollisions.push(o), o._setUpdateFrame(e));
                }
            }, e._eventScripts = function () {
                for (var t = O.loopCount, e = 0, i = this._currentFrameCollisions.length; e < i; e++) {
                    var n = this._currentFrameCollisions[e], r = n._colliderA, a = n._colliderB;
                    if (!r.destroyed && !a.destroyed) if (t - n._lastUpdateFrame == 1) {
                        var s = r.owner, o = s._scripts;
                        if (o) if (n._isTrigger) {
                            if (s._needProcessTriggers) for (var l = 0, h = o.length; l < h; l++) o[l].onTriggerStay(a);
                        } else if (s._needProcessCollisions) for (l = 0, h = o.length; l < h; l++) n.other = a,
                            o[l].onCollisionStay(n);
                        var u = a.owner, c = u._scripts;
                        if (c) if (n._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerStay(r);
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) n.other = r,
                            c[l].onCollisionStay(n);
                    } else {
                        if (o = (s = r.owner)._scripts) if (n._isTrigger) {
                            if (s._needProcessTriggers) for (l = 0, h = o.length; l < h; l++) o[l].onTriggerEnter(a);
                        } else if (s._needProcessCollisions) for (l = 0, h = o.length; l < h; l++) n.other = a,
                            o[l].onCollisionEnter(n);
                        if (c = (u = a.owner)._scripts) if (n._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerEnter(r);
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) n.other = r,
                            c[l].onCollisionEnter(n);
                    }
                }
                for (e = 0, i = this._previousFrameCollisions.length; e < i; e++) {
                    var d = this._previousFrameCollisions[e], _ = d._colliderA, f = d._colliderB;
                    if (!_.destroyed && !f.destroyed && t - d._updateFrame == 1) {
                        if (this._collisionsUtils.recoverCollision(d), o = (s = _.owner)._scripts) if (d._isTrigger) {
                            if (s._needProcessTriggers) for (l = 0, h = o.length; l < h; l++) o[l].onTriggerExit(f);
                        } else if (s._needProcessCollisions) for (l = 0, h = o.length; l < h; l++) d.other = f,
                            o[l].onCollisionExit(d);
                        if (c = (u = f.owner)._scripts) if (d._isTrigger) {
                            if (u._needProcessTriggers) for (l = 0, h = c.length; l < h; l++) c[l].onTriggerExit(_);
                        } else if (u._needProcessCollisions) for (l = 0, h = c.length; l < h; l++) d.other = _,
                            c[l].onCollisionExit(d);
                    }
                }
            }, e.clearForces = function () {
                if (!this._nativeDiscreteDynamicsWorld) throw "Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.clearForces();
            }, a(0, e, "gravity", function () {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                return this._gravity;
            }, function (e) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._gravity = e;
                var i = t._nativeTempVector30;
                i.setValue(-e.x, e.y, e.z), this._nativeDiscreteDynamicsWorld.setGravity(i);
            }), a(0, e, "continuousCollisionDetection", function () {
                return this._nativeDispatchInfo.get_m_useContinuous();
            }, function (t) {
                this._nativeDispatchInfo.set_m_useContinuous(t);
            }), a(0, e, "speculativeContactRestitution", function () {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";
                return this._nativeDiscreteDynamicsWorld.getApplySpeculativeContactRestitution();
            }, function (t) {
                if (!this._nativeDiscreteDynamicsWorld) throw "Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";
                this._nativeDiscreteDynamicsWorld.setApplySpeculativeContactRestitution(t);
            }), t.createConstraint = function () { }, t.PHYSICSENGINEFLAGS_NONE = 0, t.PHYSICSENGINEFLAGS_COLLISIONSONLY = 1,
                t.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT = 2, t.PHYSICSENGINEFLAGS_MULTITHREADED = 4,
                t.PHYSICSENGINEFLAGS_USEHARDWAREWHENPOSSIBLE = 8, t.SOLVERMODE_RANDMIZE_ORDER = 1,
                t.SOLVERMODE_FRICTION_SEPARATE = 2, t.SOLVERMODE_USE_WARMSTARTING = 4, t.SOLVERMODE_USE_2_FRICTION_DIRECTIONS = 16,
                t.SOLVERMODE_ENABLE_FRICTION_DIRECTION_CACHING = 32, t.SOLVERMODE_DISABLE_VELOCITY_DEPENDENT_FRICTION_DIRECTION = 64,
                t.SOLVERMODE_CACHE_FRIENDLY = 128, t.SOLVERMODE_SIMD = 256, t.SOLVERMODE_INTERLEAVE_CONTACT_AND_FRICTION_CONSTRAINTS = 512,
                t.SOLVERMODE_ALLOW_ZERO_LENGTH_FRICTION_DIRECTIONS = 1024, t.disableSimulation = !1,
                n(t, ["_nativeTempVector30", function () {
                    return this._nativeTempVector30 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeTempVector31", function () {
                    return this._nativeTempVector31 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeTempQuaternion0", function () {
                    return this._nativeTempQuaternion0 = new W._physics3D.btQuaternion(0, 0, 0, 1);
                }, "_nativeTempQuaternion1", function () {
                    return this._nativeTempQuaternion1 = new W._physics3D.btQuaternion(0, 0, 0, 1);
                }, "_nativeTempTransform0", function () {
                    return this._nativeTempTransform0 = new W._physics3D.btTransform();
                }, "_nativeTempTransform1", function () {
                    return this._nativeTempTransform1 = new W._physics3D.btTransform();
                }, "_tempVector30", function () {
                    return this._tempVector30 = new gt();
                }]), t;
        }(), je = function (t) {
            function e(t, i) {
                this._restitution = 0, this._friction = .5, this._rollingFriction = 0, this._ccdMotionThreshold = 0,
                    this._ccdSweptSphereRadius = 0, this._colliderShape = null, this._transformFlag = 2147483647,
                    this._enableProcessCollisions = !0, this._inPhysicUpdateListIndex = -1, this.canScaleShape = !0,
                    e.__super.call(this), this._collisionGroup = 1, this._canCollideWith = Ve.COLLISIONFILTERGROUP_ALLFILTER,
                    this._collisionGroup = t, this._canCollideWith = i, e._physicObjectsMap[this.id] = this;
            }
            r(e, "laya.d3.physics.PhysicsComponent", t);
            var s = e.prototype;
            return s._isValid = function () {
                return this._simulation && this._colliderShape && this._enabled;
            }, s._parse = function (t) {
                null != t.collisionGroup && (this.collisionGroup = t.collisionGroup), null != t.canCollideWith && (this.canCollideWith = t.canCollideWith),
                    null != t.ccdMotionThreshold && (this.ccdMotionThreshold = t.ccdMotionThreshold),
                    null != t.ccdSweptSphereRadius && (this.ccdSweptSphereRadius = t.ccdSweptSphereRadius);
            }, s._parseShape = function (t) {
                var e = t.length;
                if (1 === e) {
                    var i = j._creatShape(t[0]);
                    this.colliderShape = i;
                } else {
                    for (var n = new _i(), r = 0; r < e; r++) i = j._creatShape(t[r]), n.addChildShape(i);
                    this.colliderShape = n;
                }
            }, s._onScaleChange = function (t) {
                this._colliderShape._setScale(t);
            }, s._setTransformFlag = function (t, e) {
                e ? this._transformFlag |= t : this._transformFlag &= ~t;
            }, s._getTransformFlag = function (t) {
                return 0 != (this._transformFlag & t);
            }, s._addToSimulation = function () { }, s._removeFromSimulation = function () { },
                s._derivePhysicsTransformation = function (t) {
                    this._innerDerivePhysicsTransformation(this._nativeColliderObject.getWorldTransform(), t);
                }, s._innerDerivePhysicsTransformation = function (t, i) {
                    var n = this.owner._transform, r = n.rotation;
                    if (i || this._getTransformFlag(8)) {
                        var a = this._colliderShape.localOffset, s = n.position, o = e._nativeVector30;
                        if (0 !== a.x || 0 !== a.y || 0 !== a.z) {
                            var l = e._tempVector30;
                            e.physicVector3TransformQuat(a, r.x, r.y, r.z, r.w, l), gt.add(s, l, l), o.setValue(-l.x, l.y, l.z);
                        } else o.setValue(-s.x, s.y, s.z);
                        t.setOrigin(o), this._setTransformFlag(8, !1);
                    }
                    if (i || this._getTransformFlag(16)) {
                        var h = this._colliderShape.localRotation, u = e._nativeQuaternion0;
                        if (0 !== h.x || 0 !== h.y || 0 !== h.z || 1 !== h.w) {
                            var c = e._tempQuaternion0;
                            e.physicQuaternionMultiply(r.x, r.y, r.z, r.w, h, c), u.setValue(-c.x, c.y, c.z, -c.w);
                        } else u.setValue(-r.x, r.y, r.z, -r.w);
                        t.setRotation(u), this._setTransformFlag(16, !1);
                    }
                    (i || this._getTransformFlag(32)) && (this._onScaleChange(n.scale), this._setTransformFlag(32, !1));
                }, s._updateTransformComponent = function (t) {
                    var i = this._colliderShape.localOffset, n = this._colliderShape.localRotation, r = this.owner._transform, a = r.position, s = r.rotation, o = t.getOrigin(), l = t.getRotation(), h = -l.x(), u = l.y(), c = l.z(), d = -l.w();
                    if (0 !== i.x || 0 !== i.y || 0 !== i.z) {
                        var _ = e._tempVector30;
                        e.physicVector3TransformQuat(i, h, u, c, d, _), a.x = -o.x() - _.x, a.y = o.y() - _.y,
                            a.z = o.z() - _.z;
                    } else a.x = -o.x(), a.y = o.y(), a.z = o.z();
                    if (r.position = a, 0 !== n.x || 0 !== n.y || 0 !== n.z || 1 !== n.w) {
                        var f = e._tempQuaternion0;
                        n.invert(f), e.physicQuaternionMultiply(h, u, c, d, f, s);
                    } else s.x = h, s.y = u, s.z = c, s.w = d;
                    r.rotation = s;
                }, s._onEnable = function () {
                    this._simulation = this.owner._scene.physicsSimulation, this._nativeColliderObject.setContactProcessingThreshold(1e30),
                        this._colliderShape && this._enabled && (this._derivePhysicsTransformation(!0),
                            this._addToSimulation());
                }, s._onDisable = function () {
                    this._colliderShape && this._enabled && (this._removeFromSimulation(), -1 !== this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.remove(this)),
                        this._simulation = null;
                }, s._onShapeChange = function (t) {
                    var e = this._nativeColliderObject, i = e.getCollisionFlags();
                    t.needsCustomCollisionCallback ? 0 == (8 & i) && e.setCollisionFlags(8 | i) : (8 & i) > 0 && e.setCollisionFlags(8 ^ i);
                }, s._onAdded = function () {
                    this.enabled = this._enabled, this.restitution = this._restitution, this.friction = this._friction,
                        this.rollingFriction = this._rollingFriction, this.ccdMotionThreshold = this._ccdMotionThreshold,
                        this.ccdSweptSphereRadius = this._ccdSweptSphereRadius, this.owner.transform.on("transformchanged", this, this._onTransformChanged);
                }, s._onDestroy = function () {
                    var i = W._physics3D;
                    delete e._physicObjectsMap[this.id], i.destroy(this._nativeColliderObject), this._colliderShape.destroy(),
                        t.prototype._onDestroy.call(this), this._nativeColliderObject = null, this._colliderShape = null,
                        this._simulation = null, this.owner.transform.off("transformchanged", this, this._onTransformChanged);
                }, s._onTransformChanged = function (t) {
                    e._addUpdateList && (t &= 56) && (this._transformFlag |= t, this._isValid() && -1 === this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.add(this));
                }, s._cloneTo = function (t) {
                    var e = t;
                    e.restitution = this._restitution, e.friction = this._friction, e.rollingFriction = this._rollingFriction,
                        e.ccdMotionThreshold = this._ccdMotionThreshold, e.ccdSweptSphereRadius = this._ccdSweptSphereRadius,
                        e.collisionGroup = this._collisionGroup, e.canCollideWith = this._canCollideWith,
                        e.canScaleShape = this.canScaleShape, this._colliderShape && (e.colliderShape = this._colliderShape.clone());
                }, a(0, s, "isActive", function () {
                    return !!this._nativeColliderObject && this._nativeColliderObject.isActive();
                }), a(0, s, "restitution", function () {
                    return this._restitution;
                }, function (t) {
                    this._restitution = t, this._nativeColliderObject && this._nativeColliderObject.setRestitution(t);
                }), a(0, s, "friction", function () {
                    return this._friction;
                }, function (t) {
                    this._friction = t, this._nativeColliderObject && this._nativeColliderObject.setFriction(t);
                }), a(0, s, "rollingFriction", function () {
                    return this._nativeColliderObject.getRollingFriction();
                }, function (t) {
                    this._rollingFriction = t, this._nativeColliderObject && this._nativeColliderObject.setRollingFriction(t);
                }), a(0, s, "ccdMotionThreshold", function () {
                    return this._ccdMotionThreshold;
                }, function (t) {
                    this._ccdMotionThreshold = t, this._nativeColliderObject && this._nativeColliderObject.setCcdMotionThreshold(t);
                }), a(0, s, "ccdSweptSphereRadius", function () {
                    return this._ccdSweptSphereRadius;
                }, function (t) {
                    this._ccdSweptSphereRadius = t, this._nativeColliderObject && this._nativeColliderObject.setCcdSweptSphereRadius(t);
                }), a(0, s, "collisionGroup", function () {
                    return this._collisionGroup;
                }, function (t) {
                    this._collisionGroup !== t && (this._collisionGroup = t, this._simulation && this._colliderShape && this._enabled && (this._removeFromSimulation(),
                        this._addToSimulation()));
                }), a(0, s, "simulation", function () {
                    return this._simulation;
                }), a(0, s, "colliderShape", function () {
                    return this._colliderShape;
                }, function (t) {
                    var e = this._colliderShape;
                    if (e && (e._attatched = !1, e._attatchedCollisionObject = null), this._colliderShape = t,
                        t) {
                        if (t._attatched) throw "PhysicsComponent: this shape has attatched to other entity.";
                        if (t._attatched = !0, t._attatchedCollisionObject = this, this._nativeColliderObject) {
                            this._nativeColliderObject.setCollisionShape(t._nativeShape);
                            var i = this._simulation && this._enabled;
                            i && e && this._removeFromSimulation(), this._onShapeChange(t), i && (this._derivePhysicsTransformation(!0),
                                this._addToSimulation());
                        }
                    } else this._simulation && this._enabled && e && this._removeFromSimulation();
                }), a(0, s, "enabled", t.prototype._$get_enabled, function (t) {
                    this._simulation && this._colliderShape && (t ? (this._derivePhysicsTransformation(!0),
                        this._addToSimulation()) : this._removeFromSimulation()), i.superSet(f, this, "enabled", t);
                }), a(0, s, "canCollideWith", function () {
                    return this._canCollideWith;
                }, function (t) {
                    this._canCollideWith !== t && (this._canCollideWith = t, this._simulation && this._colliderShape && this._enabled && (this._removeFromSimulation(),
                        this._addToSimulation()));
                }), e._createAffineTransformationArray = function (t, e, i, n, r, a, s, o, l) {
                    var h = n + n, u = r + r, c = a + a, d = n * h, _ = n * u, f = n * c, p = r * u, m = r * c, g = a * c, y = s * h, v = s * u, S = s * c, T = o[0], E = o[1], C = o[2];
                    l[0] = (1 - (p + g)) * T, l[1] = (_ + S) * T, l[2] = (f - v) * T, l[3] = 0, l[4] = (_ - S) * E,
                        l[5] = (1 - (d + g)) * E, l[6] = (m + y) * E, l[7] = 0, l[8] = (f + v) * C, l[9] = (m - y) * C,
                        l[10] = (1 - (d + p)) * C, l[11] = 0, l[12] = t, l[13] = e, l[14] = i, l[15] = 1;
                }, e.physicVector3TransformQuat = function (t, e, i, n, r, a) {
                    var s = t.x, o = t.y, l = t.z, h = r * s + i * l - n * o, u = r * o + n * s - e * l, c = r * l + e * o - i * s, d = -e * s - i * o - n * l;
                    a.x = h * r + d * -e + u * -n - c * -i, a.y = u * r + d * -i + c * -e - h * -n,
                        a.z = c * r + d * -n + h * -i - u * -e;
                }, e.physicQuaternionMultiply = function (t, e, i, n, r, a) {
                    var s = r.x, o = r.y, l = r.z, h = r.w, u = e * l - i * o, c = i * s - t * l, d = t * o - e * s, _ = t * s + e * o + i * l;
                    a.x = t * h + s * n + u, a.y = e * h + o * n + c, a.z = i * h + l * n + d, a.w = n * h - _;
                }, e.ACTIVATIONSTATE_ACTIVE_TAG = 1, e.ACTIVATIONSTATE_ISLAND_SLEEPING = 2, e.ACTIVATIONSTATE_WANTS_DEACTIVATION = 3,
                e.ACTIVATIONSTATE_DISABLE_DEACTIVATION = 4, e.ACTIVATIONSTATE_DISABLE_SIMULATION = 5,
                e.COLLISIONFLAGS_STATIC_OBJECT = 1, e.COLLISIONFLAGS_KINEMATIC_OBJECT = 2, e.COLLISIONFLAGS_NO_CONTACT_RESPONSE = 4,
                e.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK = 8, e.COLLISIONFLAGS_CHARACTER_OBJECT = 16,
                e.COLLISIONFLAGS_DISABLE_VISUALIZE_OBJECT = 32, e.COLLISIONFLAGS_DISABLE_SPU_COLLISION_PROCESSING = 64,
                e._physicObjectsMap = {}, e._addUpdateList = !0, n(e, ["_tempVector30", function () {
                    return this._tempVector30 = new gt();
                }, "_tempQuaternion0", function () {
                    return this._tempQuaternion0 = new ht();
                }, "_tempQuaternion1", function () {
                    return this._tempQuaternion1 = new ht();
                }, "_tempMatrix4x40", function () {
                    return this._tempMatrix4x40 = new ze();
                }, "_nativeVector30", function () {
                    return this._nativeVector30 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeQuaternion0", function () {
                    return this._nativeQuaternion0 = new W._physics3D.btQuaternion(0, 0, 0, 1);
                }]), e;
        }(f), We = function (t) {
            function e(t) {
                if (this._indexInList = -1, this._indexInCastShadowList = -1, this._boundsChange = !0,
                    this._visible = !0, this._indexInOctreeMotionList = -1, this._updateMark = -1, this._updateRenderType = -1,
                    this._isPartOfStaticBatch = !1, this._staticBatch = null, e.__super.call(this),
                    this._sharedMaterials = [], this._id = ++e._uniqueIDCounter, this._indexInCastShadowList = -1,
                    this._bounds = new Ce(gt._ZERO, gt._ZERO), I.supportWebGLPlusCulling) {
                    var i = Ne._cullingBufferLength;
                    this._cullingBufferIndex = i;
                    var n = Ne._cullingBuffer, r = i + 7;
                    if (r >= n.length) {
                        var a = n;
                        (n = Ne._cullingBuffer = new Float32Array(n.length + 4096)).set(a, 0);
                    }
                    n[i] = 2, Ne._cullingBufferLength = r;
                }
                this._renderElements = [], this._owner = t, this._enable = !0, this._materialsInstance = [],
                    this._shaderValues = new ut(null), this._defineDatas = new Vt(), this.lightmapIndex = -1,
                    this._castShadow = !1, this.receiveShadow = !1, this.sortingFudge = 0, t && this._owner.transform.on("transformchanged", this, this._onWorldMatNeedChange);
            }
            r(e, "laya.d3.core.render.BaseRender", t);
            var s = e.prototype;
            return i.imps(s, {
                "laya.resource.ISingletonElement": !0,
                "laya.d3.core.scene.IOctreeObject": !0
            }), s._getOctreeNode = function () {
                return this._octreeNode;
            }, s._setOctreeNode = function (t) {
                this._octreeNode = t;
            }, s._getIndexInMotionList = function () {
                return this._indexInOctreeMotionList;
            }, s._setIndexInMotionList = function (t) {
                this._indexInOctreeMotionList = t;
            }, s._changeMaterialReference = function (t, e) {
                t && t._removeReference(), e._addReference();
            }, s._getInstanceMaterial = function (t, e) {
                var i = new t.constructor();
                return t.cloneTo(i), i.name = i.name + "(Instance)", this._materialsInstance[e] = !0,
                    this._changeMaterialReference(this._sharedMaterials[e], i), this._sharedMaterials[e] = i,
                    i;
            }, s._applyLightMapParams = function () {
                if (this._scene && this._lightmapIndex >= 0) {
                    var t = this._scene.getlightmaps();
                    this._lightmapIndex < t.length ? (this._defineDatas.add(Qi.SAHDERDEFINE_LIGHTMAP),
                        this._shaderValues.setTexture(Qi.LIGHTMAP, t[this._lightmapIndex])) : this._defineDatas.remove(Qi.SAHDERDEFINE_LIGHTMAP);
                } else this._defineDatas.remove(Qi.SAHDERDEFINE_LIGHTMAP);
            }, s._onWorldMatNeedChange = function (t) {
                this._boundsChange = !0, this._octreeNode && (t &= 56) && -1 === this._indexInOctreeMotionList && this._octreeNode._octree.addMotionObject(this);
            }, s._calculateBoundingBox = function () {
                throw "BaseRender: must override it.";
            }, s._getIndexInList = function () {
                return this._indexInList;
            }, s._setIndexInList = function (t) {
                this._indexInList = t;
            }, s._setBelongScene = function (t) {
                this._scene !== t && (this._scene = t, this._applyLightMapParams());
            }, s._needRender = function (t) {
                return !0;
            }, s._renderUpdate = function (t, e) { }, s._renderUpdateWithCamera = function (t, e) { },
                s._revertBatchRenderUpdate = function (t) { }, s._destroy = function () {
                    -1 !== this._indexInOctreeMotionList && this._octreeNode._octree.removeMotionObject(this),
                        this.offAll();
                    var t = 0, e = 0;
                    for (t = 0, e = this._renderElements.length; t < e; t++) this._renderElements[t].destroy();
                    for (t = 0, e = this._sharedMaterials.length; t < e; t++) this._sharedMaterials[t].destroyed || this._sharedMaterials[t]._removeReference();
                    this._renderElements = null, this._owner = null, this._sharedMaterials = null, this._bounds = null,
                        this._lightmapScaleOffset = null;
                }, a(0, s, "bounds", function () {
                    return this._boundsChange && (this._calculateBoundingBox(), this._boundsChange = !1),
                        this._bounds;
                }), a(0, s, "id", function () {
                    return this._id;
                }), a(0, s, "material", function () {
                    var t = this._sharedMaterials[0];
                    if (t && !this._materialsInstance[0]) {
                        var e = this._getInstanceMaterial(t, 0), i = this._renderElements[0];
                        i && (i.material = e);
                    }
                    return this._sharedMaterials[0];
                }, function (t) {
                    this.sharedMaterial = t;
                }), a(0, s, "isPartOfStaticBatch", function () {
                    return this._isPartOfStaticBatch;
                }), a(0, s, "sharedMaterial", function () {
                    return this._sharedMaterials[0];
                }, function (t) {
                    var e = this._sharedMaterials[0];
                    if (e !== t) {
                        this._sharedMaterials[0] = t, this._materialsInstance[0] = !1, this._changeMaterialReference(e, t);
                        var i = this._renderElements[0];
                        i && (i.material = t);
                    }
                }), a(0, s, "lightmapIndex", function () {
                    return this._lightmapIndex;
                }, function (t) {
                    this._lightmapIndex !== t && (this._lightmapIndex = t, this._applyLightMapParams());
                }), a(0, s, "lightmapScaleOffset", function () {
                    return this._lightmapScaleOffset;
                }, function (t) {
                    this._lightmapScaleOffset = t, this._shaderValues.setVector(Qi.LIGHTMAPSCALEOFFSET, t),
                        this._defineDatas.add(Qi.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);
                }), a(0, s, "castShadow", function () {
                    return this._castShadow;
                }, function (t) {
                    this._castShadow !== t && (this._owner.activeInHierarchy && (t ? this._scene._addShadowCastRenderObject(this) : this._scene._removeShadowCastRenderObject(this)),
                        this._castShadow = t);
                }), a(0, s, "enable", function () {
                    return this._enable;
                }, function (t) {
                    this._enable = !!t;
                }), a(0, s, "materials", function () {
                    for (var t = 0, e = this._sharedMaterials.length; t < e; t++) if (!this._materialsInstance[t]) {
                        var i = this._getInstanceMaterial(this._sharedMaterials[t], t), n = this._renderElements[t];
                        n && (n.material = i);
                    }
                    return this._sharedMaterials.slice();
                }, function (t) {
                    this.sharedMaterials = t;
                }), a(0, s, "sharedMaterials", function () {
                    return this._sharedMaterials.slice();
                }, function (t) {
                    for (var e = this._sharedMaterials, i = 0, n = e.length; i < n; i++) e[i]._removeReference();
                    if (!t) throw new Error("BaseRender: shadredMaterials value can't be null.");
                    var r = t.length;
                    for (this._materialsInstance.length = r, e.length = r, i = 0; i < r; i++) {
                        var a = e[i], s = t[i];
                        if (a !== s) {
                            this._materialsInstance[i] = !1;
                            var o = this._renderElements[i];
                            o && (o.material = s);
                        }
                        s._addReference(), e[i] = s;
                    }
                }), a(0, s, "receiveShadow", function () {
                    return this._receiveShadow;
                }, function (t) {
                    this._receiveShadow !== t && (this._receiveShadow = t, t ? this._defineDatas.add(Qi.SHADERDEFINE_RECEIVE_SHADOW) : this._defineDatas.remove(Qi.SHADERDEFINE_RECEIVE_SHADOW));
                }), e._uniqueIDCounter = 0, n(e, ["_tempBoundBoxCorners", function () {
                    return this._tempBoundBoxCorners = [new gt(), new gt(), new gt(), new gt(), new gt(), new gt(), new gt(), new gt()];
                }]), e;
        }(g), Xe = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.component.Script3D", t);
            var n = e.prototype;
            n._checkProcessTriggers = function () {
                var t = laya.d3.component.Script3D.prototype;
                return this.onTriggerEnter !== t.onTriggerEnter || (this.onTriggerStay !== t.onTriggerStay || this.onTriggerExit !== t.onTriggerExit);
            }, n._checkProcessCollisions = function () {
                var t = laya.d3.component.Script3D.prototype;
                return this.onCollisionEnter !== t.onCollisionEnter || (this.onCollisionStay !== t.onCollisionStay || this.onCollisionExit !== t.onCollisionExit);
            }, n._onAwake = function () {
                this.onAwake(), this.onStart !== laya.d3.component.Script3D.prototype.onStart && i.startTimer.callLater(this, this.onStart);
            }, n._onEnable = function () {
                this.owner._scene._scriptPool.add(this);
                var t = laya.d3.component.Script3D.prototype;
                this.onKeyDown !== t.onKeyDown && i.stage.on("keydown", this, this.onKeyDown), this.onKeyPress !== t.onKeyPress && i.stage.on("keypress", this, this.onKeyUp),
                    this.onKeyUp !== t.onKeyUp && i.stage.on("keyup", this, this.onKeyUp);
            }, n._onDisable = function () {
                this.owner._scene._scriptPool.remove(this), this.owner.offAllCaller(this), i.stage.offAllCaller(this);
            }, n._isScript = function () {
                return !0;
            }, n._onAdded = function () {
                var t = this.owner, e = t._scripts;
                e || (t._scripts = e = []), e.push(this), t._needProcessCollisions || (t._needProcessCollisions = this._checkProcessCollisions()),
                    t._needProcessTriggers || (t._needProcessTriggers = this._checkProcessTriggers());
            }, n._onDestroy = function () {
                var t = this.owner._scripts;
                t.splice(t.indexOf(this), 1);
                var e = this.owner;
                e._needProcessTriggers = !1;
                for (var i = 0, n = t.length; i < n; i++) if (t[i]._checkProcessTriggers()) {
                    e._needProcessTriggers = !0;
                    break;
                }
                for (e._needProcessCollisions = !1, i = 0, n = t.length; i < n; i++) if (t[i]._checkProcessCollisions()) {
                    e._needProcessCollisions = !0;
                    break;
                }
                this.onDestroy();
            }, n.onAwake = function () { }, n.onEnable = function () { }, n.onStart = function () { },
                n.onTriggerEnter = function (t) { }, n.onTriggerStay = function (t) { }, n.onTriggerExit = function (t) { },
                n.onCollisionEnter = function (t) { }, n.onCollisionStay = function (t) { }, n.onCollisionExit = function (t) { },
                n.onMouseDown = function () { }, n.onMouseDrag = function () { }, n.onMouseClick = function () { },
                n.onMouseUp = function () { }, n.onMouseEnter = function () { }, n.onMouseOver = function () { },
                n.onMouseOut = function () { }, n.onKeyDown = function (t) { }, n.onKeyPress = function (t) { },
                n.onKeyUp = function (t) { }, n.onUpdate = function () { }, n.onLateUpdate = function () { },
                n.onPreRender = function () { }, n.onPostRender = function () { }, n.onDisable = function () { },
                n.onDestroy = function () { }, a(0, n, "isSingleton", function () {
                    return !1;
                });
        }(f), function (t) {
            function e(t) {
                this._owner = null, this._children = null, this._parent = null, this._dummy = null,
                    this._transformFlag = 0, e.__super.call(this), this._localPosition = new gt(0, 0, 0),
                    this._localRotation = new ht(0, 0, 0, 1), this._localScale = new gt(1, 1, 1), this._localRotationEuler = new gt(0, 0, 0),
                    this._localMatrix = new ze(), this._position = new gt(0, 0, 0), this._rotation = new ht(0, 0, 0, 1),
                    this._scale = new gt(1, 1, 1), this._rotationEuler = new gt(0, 0, 0), this._worldMatrix = new ze(),
                    this._owner = t, this._children = [], this._setTransformFlag(7, !1), this._setTransformFlag(248, !0);
            }
            r(e, "laya.d3.core.Transform3D", t);
            var i = e.prototype;
            return i._setTransformFlag = function (t, e) {
                e ? this._transformFlag |= t : this._transformFlag &= ~t;
            }, i._getTransformFlag = function (t) {
                return 0 != (this._transformFlag & t);
            }, i._setParent = function (t) {
                if (this._parent !== t) {
                    if (this._parent) {
                        var e = this._parent._children, i = e.indexOf(this);
                        e.splice(i, 1);
                    }
                    t && (t._children.push(this), t && this._onWorldTransform()), this._parent = t;
                }
            }, i._updateLocalMatrix = function () {
                ze.createAffineTransformation(this._localPosition, this.localRotation, this._localScale, this._localMatrix);
            }, i._onWorldPositionRotationTransform = function () {
                if (!(this._getTransformFlag(64) && this._getTransformFlag(8) && this._getTransformFlag(16) && this._getTransformFlag(128))) {
                    this._setTransformFlag(216, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionRotationTransform();
                }
            }, i._onWorldPositionScaleTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(8) || !this._getTransformFlag(32)) {
                    this._setTransformFlag(104, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionScaleTransform();
                }
            }, i._onWorldPositionTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(8)) {
                    this._setTransformFlag(72, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionTransform();
                }
            }, i._onWorldRotationTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(16) || !this._getTransformFlag(128)) {
                    this._setTransformFlag(208, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionRotationTransform();
                }
            }, i._onWorldScaleTransform = function () {
                if (!this._getTransformFlag(64) || !this._getTransformFlag(32)) {
                    this._setTransformFlag(96, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldPositionScaleTransform();
                }
            }, i._onWorldTransform = function () {
                if (!(this._getTransformFlag(64) && this._getTransformFlag(8) && this._getTransformFlag(16) && this._getTransformFlag(128) && this._getTransformFlag(32))) {
                    this._setTransformFlag(248, !0), this.event("transformchanged", this._transformFlag);
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldTransform();
                }
            }, i.translate = function (t, i) {
                void 0 === i && (i = !0), i ? (ze.createFromQuaternion(this.localRotation, e._tempMatrix0),
                    gt.transformCoordinate(t, e._tempMatrix0, e._tempVector30), gt.add(this.localPosition, e._tempVector30, this._localPosition),
                    this.localPosition = this._localPosition) : (gt.add(this.position, t, this._position),
                        this.position = this._position);
            }, i.rotate = function (t, i, n) {
                var r;
                void 0 === i && (i = !0), void 0 === n && (n = !0), n ? r = t : (gt.scale(t, Math.PI / 180, e._tempVector30),
                    r = e._tempVector30), ht.createFromYawPitchRoll(r.y, r.x, r.z, e._tempQuaternion0),
                    i ? (ht.multiply(this._localRotation, e._tempQuaternion0, this._localRotation),
                        this.localRotation = this._localRotation) : (ht.multiply(e._tempQuaternion0, this.rotation, this._rotation),
                            this.rotation = this._rotation);
            }, i.getForward = function (t) {
                var e = this.worldMatrix.elements;
                t.x = -e[8], t.y = -e[9], t.z = -e[10];
            }, i.getUp = function (t) {
                var e = this.worldMatrix.elements;
                t.x = e[4], t.y = e[5], t.z = e[6];
            }, i.getRight = function (t) {
                var e = this.worldMatrix.elements;
                t.x = e[0], t.y = e[1], t.z = e[2];
            }, i.lookAt = function (t, e, i) {
                var n;
                if (void 0 === i && (i = !1), i) {
                    if (n = this._localPosition, Math.abs(n.x - t.x) < nt.zeroTolerance && Math.abs(n.y - t.y) < nt.zeroTolerance && Math.abs(n.z - t.z) < nt.zeroTolerance) return;
                    ht.lookAt(this._localPosition, t, e, this._localRotation), this._localRotation.invert(this._localRotation),
                        this.localRotation = this._localRotation;
                } else {
                    var r = this.position;
                    if (n = r, Math.abs(n.x - t.x) < nt.zeroTolerance && Math.abs(n.y - t.y) < nt.zeroTolerance && Math.abs(n.z - t.z) < nt.zeroTolerance) return;
                    ht.lookAt(r, t, e, this._rotation), this._rotation.invert(this._rotation), this.rotation = this._rotation;
                }
            }, a(0, i, "_isFrontFaceInvert", function () {
                var t = this.scale, e = t.x < 0;
                return t.y < 0 && (e = !e), t.z < 0 && (e = !e), e;
            }), a(0, i, "owner", function () {
                return this._owner;
            }), a(0, i, "localPositionY", function () {
                return this._localPosition.y;
            }, function (t) {
                this._localPosition.y = t, this.localPosition = this._localPosition;
            }), a(0, i, "localScaleX", function () {
                return this._localScale.x;
            }, function (t) {
                this._localScale.x = t, this.localScale = this._localScale;
            }), a(0, i, "worldNeedUpdate", function () {
                return this._getTransformFlag(64);
            }), a(0, i, "localPositionX", function () {
                return this._localPosition.x;
            }, function (t) {
                this._localPosition.x = t, this.localPosition = this._localPosition;
            }), a(0, i, "localPosition", function () {
                return this._localPosition;
            }, function (t) {
                this._localPosition !== t && t.cloneTo(this._localPosition), this._setTransformFlag(4, !0),
                    this._onWorldPositionTransform();
            }), a(0, i, "localPositionZ", function () {
                return this._localPosition.z;
            }, function (t) {
                this._localPosition.z = t, this.localPosition = this._localPosition;
            }), a(0, i, "localRotationX", function () {
                return this.localRotation.x;
            }, function (t) {
                this._localRotation.x = t, this.localRotation = this._localRotation;
            }), a(0, i, "localRotationY", function () {
                return this.localRotation.y;
            }, function (t) {
                this._localRotation.y = t, this.localRotation = this._localRotation;
            }), a(0, i, "localRotationZ", function () {
                return this.localRotation.z;
            }, function (t) {
                this._localRotation.z = t, this.localRotation = this._localRotation;
            }), a(0, i, "localRotationW", function () {
                return this.localRotation.w;
            }, function (t) {
                this._localRotation.w = t, this.localRotation = this._localRotation;
            }), a(0, i, "localRotation", function () {
                if (this._getTransformFlag(1)) {
                    var t = this._localRotationEuler;
                    ht.createFromYawPitchRoll(t.y / e._angleToRandin, t.x / e._angleToRandin, t.z / e._angleToRandin, this._localRotation),
                        this._setTransformFlag(1, !1);
                }
                return this._localRotation;
            }, function (t) {
                this._localRotation !== t && t.cloneTo(this._localRotation), this._localRotation.normalize(this._localRotation),
                    this._setTransformFlag(6, !0), this._setTransformFlag(1, !1), this._onWorldRotationTransform();
            }), a(0, i, "localScaleY", function () {
                return this._localScale.y;
            }, function (t) {
                this._localScale.y = t, this.localScale = this._localScale;
            }), a(0, i, "localScaleZ", function () {
                return this._localScale.z;
            }, function (t) {
                this._localScale.z = t, this.localScale = this._localScale;
            }), a(0, i, "position", function () {
                if (this._getTransformFlag(8)) {
                    if (null != this._parent) {
                        var t = this._parent.position;
                        gt.multiply(this._localPosition, this._parent.scale, e._tempVector30), gt.transformQuat(e._tempVector30, this._parent.rotation, e._tempVector30),
                            gt.add(t, e._tempVector30, this._position);
                    } else this._localPosition.cloneTo(this._position);
                    this._setTransformFlag(8, !1);
                }
                return this._position;
            }, function (t) {
                if (null != this._parent) {
                    gt.subtract(t, this._parent.position, this._localPosition);
                    var i = this._parent.scale, n = i.x, r = i.y, a = i.z;
                    if (1 !== n || 1 !== r || 1 !== a) {
                        var s = e._tempVector30;
                        s.x = 1 / n, s.y = 1 / r, s.z = 1 / a, gt.multiply(this._localPosition, s, this._localPosition);
                    }
                    this._parent.rotation.invert(e._tempQuaternion0), gt.transformQuat(this._localPosition, e._tempQuaternion0, this._localPosition);
                } else t.cloneTo(this._localPosition);
                this.localPosition = this._localPosition, this._position !== t && t.cloneTo(this._position),
                    this._setTransformFlag(8, !1);
            }), a(0, i, "localRotationEulerY", function () {
                return this.localRotationEuler.y;
            }, function (t) {
                this._localRotationEuler.y = t, this.localRotationEuler = this._localRotationEuler;
            }), a(0, i, "localScale", function () {
                return this._localScale;
            }, function (t) {
                this._localScale !== t && t.cloneTo(this._localScale), this._setTransformFlag(4, !0),
                    this._onWorldScaleTransform();
            }), a(0, i, "localRotationEulerX", function () {
                return this.localRotationEuler.x;
            }, function (t) {
                this._localRotationEuler.x = t, this.localRotationEuler = this._localRotationEuler;
            }), a(0, i, "localRotationEulerZ", function () {
                return this.localRotationEuler.z;
            }, function (t) {
                this._localRotationEuler.z = t, this.localRotationEuler = this._localRotationEuler;
            }), a(0, i, "localRotationEuler", function () {
                if (this._getTransformFlag(2)) {
                    this._localRotation.getYawPitchRoll(e._tempVector30);
                    var t = e._tempVector30, i = this._localRotationEuler;
                    i.x = t.y * e._angleToRandin, i.y = t.x * e._angleToRandin, i.z = t.z * e._angleToRandin,
                        this._setTransformFlag(2, !1);
                }
                return this._localRotationEuler;
            }, function (t) {
                this._localRotationEuler !== t && t.cloneTo(this._localRotationEuler), this._setTransformFlag(2, !1),
                    this._setTransformFlag(5, !0), this._onWorldRotationTransform();
            }), a(0, i, "localMatrix", function () {
                return this._getTransformFlag(4) && (this._updateLocalMatrix(), this._setTransformFlag(4, !1)),
                    this._localMatrix;
            }, function (t) {
                this._localMatrix !== t && t.cloneTo(this._localMatrix), this._localMatrix.decomposeTransRotScale(this._localPosition, this._localRotation, this._localScale),
                    this._setTransformFlag(4, !1), this._onWorldTransform();
            }), a(0, i, "rotation", function () {
                return this._getTransformFlag(16) && (null != this._parent ? ht.multiply(this._parent.rotation, this.localRotation, this._rotation) : this.localRotation.cloneTo(this._rotation),
                    this._setTransformFlag(16, !1)), this._rotation;
            }, function (t) {
                null != this._parent ? (this._parent.rotation.invert(e._tempQuaternion0), ht.multiply(e._tempQuaternion0, t, this._localRotation)) : t.cloneTo(this._localRotation),
                    this.localRotation = this._localRotation, t !== this._rotation && t.cloneTo(this._rotation),
                    this._setTransformFlag(16, !1);
            }), a(0, i, "scale", function () {
                return this._getTransformFlag(32) ? (null !== this._parent ? gt.multiply(this._parent.scale, this._localScale, this._scale) : this._localScale.cloneTo(this._scale),
                    this._setTransformFlag(32, !1), this._scale) : this._scale;
            }, function (t) {
                if (null !== this._parent) {
                    var i = this._parent.scale, n = e._tempVector30;
                    n.x = 1 / i.x, n.y = 1 / i.y, n.z = 1 / i.z, gt.multiply(t, e._tempVector30, this._localScale);
                } else t.cloneTo(this._localScale);
                this.localScale = this._localScale, this._scale !== t && t.cloneTo(this._scale),
                    this._setTransformFlag(32, !1);
            }), a(0, i, "rotationEuler", function () {
                if (this._getTransformFlag(128)) {
                    this.rotation.getYawPitchRoll(e._tempVector30);
                    var t = e._tempVector30, i = this._rotationEuler;
                    i.x = t.y * e._angleToRandin, i.y = t.x * e._angleToRandin, i.z = t.z * e._angleToRandin,
                        this._setTransformFlag(128, !1);
                }
                return this._rotationEuler;
            }, function (t) {
                ht.createFromYawPitchRoll(t.y / e._angleToRandin, t.x / e._angleToRandin, t.z / e._angleToRandin, this._rotation),
                    this.rotation = this._rotation, this._rotationEuler !== t && t.cloneTo(this._rotationEuler),
                    this._setTransformFlag(128, !1);
            }), a(0, i, "worldMatrix", function () {
                return this._getTransformFlag(64) && (null != this._parent ? ze.multiply(this._parent.worldMatrix, this.localMatrix, this._worldMatrix) : this.localMatrix.cloneTo(this._worldMatrix),
                    this._setTransformFlag(64, !1)), this._worldMatrix;
            }, function (t) {
                null === this._parent ? t.cloneTo(this._localMatrix) : (this._parent.worldMatrix.invert(this._localMatrix),
                    ze.multiply(this._localMatrix, t, this._localMatrix)), this.localMatrix = this._localMatrix,
                    this._worldMatrix !== t && t.cloneTo(this._worldMatrix), this._setTransformFlag(64, !1);
            }), e.TRANSFORM_LOCALQUATERNION = 1, e.TRANSFORM_LOCALEULER = 2, e.TRANSFORM_LOCALMATRIX = 4,
                e.TRANSFORM_WORLDPOSITION = 8, e.TRANSFORM_WORLDQUATERNION = 16, e.TRANSFORM_WORLDSCALE = 32,
                e.TRANSFORM_WORLDMATRIX = 64, e.TRANSFORM_WORLDEULER = 128, n(e, ["_tempVector30", function () {
                    return this._tempVector30 = new gt();
                }, "_tempVector31", function () {
                    return this._tempVector31 = new gt();
                }, "_tempVector32", function () {
                    return this._tempVector32 = new gt();
                }, "_tempVector33", function () {
                    return this._tempVector33 = new gt();
                }, "_tempQuaternion0", function () {
                    return this._tempQuaternion0 = new ht();
                }, "_tempMatrix0", function () {
                    return this._tempMatrix0 = new ze();
                }, "_angleToRandin", function () {
                    return this._angleToRandin = 180 / Math.PI;
                }]), e;
        }(g)), Ye = function (t) {
            function e() {
                this._linkAvatarSpritesData = {}, this._keyframeNodeOwners = [], this._linkAvatarSprites = [],
                    this._renderableSprites = [], this.cullingMode = 2, e.__super.call(this), this._controllerLayers = [],
                    this._linkSprites = {}, this._speed = 1, this._keyframeNodeOwnerMap = {}, this._updateMark = 0;
            }
            r(e, "laya.d3.component.Animator", t);
            var i = e.prototype;
            return i._linkToSprites = function (t) {
                for (var e in t) {
                    for (var i = this.owner, n = t[e], r = 0, a = n.length; r < a; r++) {
                        var s = n[r];
                        if ("" === s) break;
                        if (!(i = i.getChildByName(s))) break;
                    }
                    i && this.linkSprite3DToAvatarNode(e, i);
                }
            }, i._addKeyframeNodeOwner = function (t, e, i) {
                var n = e._indexInList, r = e.fullPath, a = this._keyframeNodeOwnerMap[r];
                if (a) a.referenceCount++, t[n] = a; else {
                    for (var o = i, l = 0, h = e.propertyCount; l < h && (o = o[e.getPropertyByIndex(l)]); l++);
                    (a = this._keyframeNodeOwnerMap[r] = new Pe()).fullPath = r, a.indexInList = this._keyframeNodeOwners.length,
                        a.referenceCount = 1, a.propertyOwner = i;
                    var u = e.propertyCount, c = s(u);
                    for (l = 0; l < u; l++) c[l] = e.getPropertyByIndex(l);
                    if (a.property = c, a.type = e.type, o) if (0 === e.type) a.defaultValue = o; else {
                        var d = new o.constructor();
                        o.cloneTo(d), a.defaultValue = d;
                    }
                    this._keyframeNodeOwners.push(a), t[n] = a;
                }
            }, i._removeKeyframeNodeOwner = function (t, e) {
                var i = e.fullPath, n = this._keyframeNodeOwnerMap[i];
                n && (n.referenceCount--, 0 === n.referenceCount && (delete this._keyframeNodeOwnerMap[i],
                    this._keyframeNodeOwners.splice(this._keyframeNodeOwners.indexOf(n), 1)), t[e._indexInList] = null);
            }, i._getOwnersByClip = function (t) {
                var e = t._clip._nodes, i = e.count, n = t._nodeOwners;
                n.length = i;
                for (var r = 0; r < i; r++) {
                    for (var a = e.getNodeByIndex(r), s = this._avatar ? this._avatarNodeMap[this._avatar._rootNode.name] : this.owner, o = 0, l = a.ownerPathCount; o < l; o++) {
                        var h = a.getOwnerPathByIndex(o);
                        if ("" === h) break;
                        if (!(s = s.getChildByName(h))) break;
                    }
                    if (s) {
                        var u = a.propertyOwner;
                        u && (s = s[u]), s && this._addKeyframeNodeOwner(n, a, s);
                    }
                }
            }, i._updatePlayer = function (t, e, i, n) {
                var r = t._clip._duration * (t.clipEnd - t.clipStart), a = e._elapsedTime, s = a + i;
                e._lastElapsedTime = a, e._elapsedTime = s;
                var o = s / r;
                e._normalizedTime = o;
                var l = o % 1;
                e._normalizedPlayTime = l < 0 ? l + 1 : l, e._duration = r;
                var h = t._scripts;
                if (!n && s >= r) {
                    if (e._finish = !0, e._elapsedTime = r, e._normalizedPlayTime = 1, h) for (var u = 0, c = h.length; u < c; u++) h[u].onStateExit();
                } else if (h) for (u = 0, c = h.length; u < c; u++) h[u].onStateUpdate();
            }, i._eventScript = function (t, e, i, n, r) {
                if (r) for (var a = e.length; i < a; i++) {
                    var s = e[i];
                    if (!(s.time <= n)) break;
                    for (var o = 0, l = t.length; o < l; o++) {
                        var h = t[o], u = h[s.eventName];
                        u && u.apply(h, s.params);
                    }
                } else for (; i >= 0 && (s = e[i]).time >= n; i--) for (o = 0, l = t.length; o < l; o++) (u = (h = t[o])[s.eventName]) && u.apply(h, s.params);
                return i;
            }, i._updateEventScript = function (t, e) {
                var i = this.owner._scripts;
                if (i) {
                    var n = t._clip, r = n._events, a = n._duration, s = e._elapsedTime, o = s % a, l = Math.abs(Math.floor(s / a) - Math.floor(e._lastElapsedTime / a)), h = e._elapsedTime >= e._lastElapsedTime;
                    if (e._lastIsFront !== h && (h ? e._playEventIndex++ : e._playEventIndex--, e._lastIsFront = h),
                        0 == l) e._playEventIndex = this._eventScript(i, r, e._playEventIndex, o, h); else if (h) {
                            this._eventScript(i, r, e._playEventIndex, a, !0);
                            for (var u = 0, c = l - 1; u < c; u++) this._eventScript(i, r, 0, a, !0);
                            e._playEventIndex = this._eventScript(i, r, 0, o, !0);
                        } else {
                        this._eventScript(i, r, e._playEventIndex, 0, !1);
                        var d = r.length - 1;
                        for (u = 0, c = l - 1; u < c; u++) this._eventScript(i, r, d, 0, !1);
                        e._playEventIndex = this._eventScript(i, r, d, o, !1);
                    }
                }
            }, i._updateClipDatas = function (t, e, i, n) {
                var r = t._clip, a = r._duration, s = t.clipStart * a + i._normalizedPlayTime * i._duration, o = t._currentFrameIndices, l = i._elapsedTime > i._lastElapsedTime;
                r._evaluateClipDatasRealTime(r._nodes, s, o, e, l);
            }, i._applyFloat = function (t, e, i, n, r, a, s) {
                if (i.updateMark === this._updateMark) if (n) t[e] += r * s; else {
                    var o = t[e];
                    t[e] = o + r * (s - o);
                } else if (a) t[e] = n ? i.defaultValue + s : s; else if (n) t[e] = i.defaultValue + r * s; else {
                    var l = i.defaultValue;
                    t[e] = l + r * (s - l);
                }
            }, i._applyPositionAndRotationEuler = function (t, e, i, n, r, a) {
                if (t.updateMark === this._updateMark) if (e) a.x += i * r.x, a.y += i * r.y, a.z += i * r.z; else {
                    var s = a.x, o = a.y, l = a.z;
                    a.x = s + i * (r.x - s), a.y = o + i * (r.y - o), a.z = l + i * (r.z - l);
                } else if (n) if (e) {
                    var h = t.defaultValue;
                    a.x = h.x + r.x, a.y = h.y + r.y, a.z = h.z + r.z;
                } else a.x = r.x, a.y = r.y, a.z = r.z; else if (h = t.defaultValue, e) a.x = h.x + i * r.x,
                    a.y = h.y + i * r.y, a.z = h.z + i * r.z; else {
                    var u = h.x, c = h.y, d = h.z;
                    a.x = u + i * (r.x - u), a.y = c + i * (r.y - c), a.z = d + i * (r.z - d);
                }
            }, i._applyRotation = function (t, i, n, r, a, s) {
                if (t.updateMark === this._updateMark) if (i) {
                    var o = e._tempQuaternion1;
                    Ht.quaternionWeight(a, n, o), o.normalize(o), ht.multiply(s, o, s);
                } else ht.lerp(s, a, n, s); else if (r) if (i) {
                    var l = t.defaultValue;
                    ht.multiply(l, a, s);
                } else s.x = a.x, s.y = a.y, s.z = a.z, s.w = a.w; else l = t.defaultValue, i ? (o = e._tempQuaternion1,
                    Ht.quaternionWeight(a, n, o), o.normalize(o), ht.multiply(l, o, s)) : ht.lerp(l, a, n, s);
            }, i._applyScale = function (t, i, n, r, a, s) {
                if (t.updateMark === this._updateMark) if (i) {
                    var o = e._tempVector31;
                    Ht.scaleWeight(a, n, o), s.x = s.x * o.x, s.y = s.y * o.y, s.z = s.z * o.z;
                } else Ht.scaleBlend(s, a, n, s); else if (r) if (i) {
                    var l = t.defaultValue;
                    s.x = l.x * a.x, s.y = l.y * a.y, s.z = l.z * a.z;
                } else s.x = a.x, s.y = a.y, s.z = a.z; else l = t.defaultValue, i ? (o = e._tempVector31,
                    Ht.scaleWeight(a, n, o), s.x = l.x * o.x, s.y = l.y * o.y, s.z = l.z * o.z) : Ht.scaleBlend(l, a, n, s);
            }, i._applyCrossData = function (t, i, n, r, a, s, o) {
                var l = t.propertyOwner;
                if (l) {
                    switch (t.type) {
                        case 0:
                            for (var h = t.property, u = h.length - 1, c = 0; c < u && (l = l[h[c]]); c++);
                            var d = a + o * (s - a);
                            this._applyFloat(l, h[u], t, i, n, r, d);
                            break;

                        case 1:
                            var _ = l.localPosition, f = e._tempVector30, p = a.x, m = a.y, g = a.z;
                            f.x = p + o * (s.x - p), f.y = m + o * (s.y - m), f.z = g + o * (s.z - g), this._applyPositionAndRotationEuler(t, i, n, r, f, _),
                                l.localPosition = _;
                            break;

                        case 2:
                            var y = l.localRotation, v = e._tempQuaternion0;
                            ht.lerp(a, s, o, v), this._applyRotation(t, i, n, r, v, y), l.localRotation = y;
                            break;

                        case 3:
                            var S = l.localScale, T = e._tempVector30;
                            Ht.scaleBlend(a, s, o, T), this._applyScale(t, i, n, r, T, S), l.localScale = S;
                            break;

                        case 4:
                            var E = l.localRotationEuler, C = e._tempVector30;
                            p = a.x, m = a.y, g = a.z, C.x = p + o * (s.x - p), C.y = m + o * (s.y - m), C.z = g + o * (s.z - g),
                                this._applyPositionAndRotationEuler(t, i, n, r, C, E), l.localRotationEuler = E;
                    }
                    t.updateMark = this._updateMark;
                }
            }, i._setClipDatasToNode = function (t, e, i, n) {
                for (var r = t._clip._nodes, a = t._nodeOwners, s = 0, o = r.count; s < o; s++) {
                    var l = a[s];
                    if (l) {
                        var h = l.propertyOwner;
                        if (h) {
                            switch (l.type) {
                                case 0:
                                    for (var u = l.property, c = u.length - 1, d = 0; d < c && (h = h[u[d]]); d++);
                                    this._applyFloat(h, u[c], l, e, i, n, r.getNodeByIndex(s).data);
                                    break;

                                case 1:
                                    var _ = h.localPosition;
                                    this._applyPositionAndRotationEuler(l, e, i, n, r.getNodeByIndex(s).data, _), h.localPosition = _;
                                    break;

                                case 2:
                                    var f = h.localRotation;
                                    this._applyRotation(l, e, i, n, r.getNodeByIndex(s).data, f), h.localRotation = f;
                                    break;

                                case 3:
                                    var p = h.localScale;
                                    this._applyScale(l, e, i, n, r.getNodeByIndex(s).data, p), h.localScale = p;
                                    break;

                                case 4:
                                    var m = h.localRotationEuler;
                                    this._applyPositionAndRotationEuler(l, e, i, n, r.getNodeByIndex(s).data, m), h.localRotationEuler = m;
                            }
                            l.updateMark = this._updateMark;
                        }
                    }
                }
            }, i._setCrossClipDatasToNode = function (t, e, i, n, r) {
                for (var a = t._crossNodesOwners, s = t._crossNodesOwnersCount, o = t.blendingMode !== Be.BLENDINGMODE_OVERRIDE, l = t.defaultWeight, h = t._destCrossClipNodeIndices, u = i._clip._nodes, c = i._nodeOwners, d = t._srcCrossClipNodeIndices, _ = e._nodeOwners, f = e._clip._nodes, p = 0; p < s; p++) {
                    var m = a[p];
                    if (m) {
                        var g = d[p], y = h[p], v = -1 !== g ? f.getNodeByIndex(g).data : c[y].defaultValue, S = -1 !== y ? u.getNodeByIndex(y).data : _[g].defaultValue;
                        this._applyCrossData(m, o, l, r, v, S, n);
                    }
                }
            }, i._setFixedCrossClipDatasToNode = function (t, e, i, n) {
                for (var r = t._crossNodesOwners, a = t._crossNodesOwnersCount, s = t.blendingMode !== Be.BLENDINGMODE_OVERRIDE, o = t.defaultWeight, l = t._destCrossClipNodeIndices, h = e._clip._nodes, u = 0; u < a; u++) {
                    var c = r[u];
                    if (c) {
                        var d = l[u], _ = c.crossFixedValue, f = -1 !== d ? h.getNodeByIndex(d).data : c.defaultValue;
                        this._applyCrossData(c, s, o, n, _, f, i);
                    }
                }
            }, i._revertDefaultKeyframeNodes = function (t) {
                for (var e = t._nodeOwners, i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    if (r) {
                        var a = r.propertyOwner;
                        if (a) switch (r.type) {
                            case 0:
                                for (var s = r.property, o = s.length - 1, l = 0; l < o && (a = a[s[l]]); l++);
                                a[s[o]] = r.defaultValue;
                                break;

                            case 1:
                                var h = a.localPosition, u = r.defaultValue;
                                h.x = u.x, h.y = u.y, h.z = u.z, a.localPosition = h;
                                break;

                            case 2:
                                var c = a.localRotation, d = r.defaultValue;
                                c.x = d.x, c.y = d.y, c.z = d.z, c.w = d.w, a.localRotation = c;
                                break;

                            case 3:
                                var _ = a.localScale;
                                u = r.defaultValue, _.x = u.x, _.y = u.y, _.z = u.z, a.localScale = _;
                                break;

                            case 4:
                                var f = a.localRotationEuler;
                                u = r.defaultValue, f.x = u.x, f.y = u.y, f.z = u.z, a.localRotationEuler = f;
                                break;

                            default:
                                throw "Animator:unknown type.";
                        }
                    }
                }
            }, i._removeClip = function (t, e, i, n) {
                var r = n._clip;
                r._removeReference(), t.splice(i, 1), delete e[n.name];
                for (var a = t[i], s = r._nodes, o = a._nodeOwners, l = 0, h = s.count; l < h; l++) this._removeKeyframeNodeOwner(o, s.getNodeByIndex(l));
            }, i._onAdded = function () {
                var t = this.owner._parent;
                this.owner._setHierarchyAnimator(this, t ? t._hierarchyAnimator : null), this.owner._changeAnimatorToLinkSprite3DNoAvatar(this, !0, []);
            }, i._onDestroy = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) for (var i = this._controllerLayers[t]._states, n = 0, r = i.length; n < r; n++) i[n]._clip._removeReference();
                var a = this.owner._parent;
                this.owner._clearHierarchyAnimator(this, a ? a._hierarchyAnimator : null);
            }, i._onEnableInScene = function () {
                this.owner._scene._animatorPool.add(this);
            }, i._onDisableInScene = function () {
                this.owner._scene._animatorPool.remove(this);
            }, i._onEnable = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) {
                    if (this._controllerLayers[t].playOnWake) this.getDefaultState(t) && this.play(null, t, 0);
                }
            }, i._handleSpriteOwnersBySprite = function (t, e, i) {
                for (var n = 0, r = this._controllerLayers.length; n < r; n++) for (var a = this._controllerLayers[n]._states, s = 0, o = a.length; s < o; s++) {
                    var l = a[s], h = l._clip, u = e.join("/"), c = h._nodesMap[u];
                    if (c) for (var d = l._nodeOwners, _ = 0, f = c.length; _ < f; _++) t ? this._addKeyframeNodeOwner(d, c[_], i) : this._removeKeyframeNodeOwner(d, c[_]);
                }
            }, i._parse = function (t) {
                var e = t.avatar;
                if (e) {
                    this.avatar = T.getRes(e.path);
                    var i = e.linkSprites;
                    this._linkSprites = i, this._linkToSprites(i);
                }
                t.clipPaths;
                for (var n = t.playOnWake, r = t.layers, a = 0; a < r.length; a++) {
                    var s = r[a], o = new Be(s.name);
                    o.defaultWeight = 0 === a ? 1 : s.weight;
                    var l = s.blendingMode;
                    l && (o.blendingMode = l), this.addControllerLayer(o);
                    for (var h = s.states, u = 0, c = h.length; u < c; u++) {
                        var d = h[u], _ = d.clipPath;
                        if (_) {
                            var f, p = d.name;
                            if (f = T.getRes(_)) {
                                var m = new Ge();
                                m.name = p, m.clip = f, this.addState(m, a), 0 === u && (this.getControllerLayer(a).defaultState = m);
                            }
                        }
                    }
                    void 0 !== n && (o.playOnWake = n);
                }
                var g = t.cullingMode;
                void 0 !== g && (this.cullingMode = g);
            }, i._update = function () {
                if (0 !== this._speed) {
                    var t = !1;
                    if (2 === this.cullingMode) {
                        t = !1;
                        for (var e = 0, i = this._renderableSprites.length; e < i; e++) if (this._renderableSprites[e]._render._visible) {
                            t = !0;
                            break;
                        }
                    } else t = !0;
                    this._updateMark++;
                    var n = this.owner._scene.timer, r = n._delta / 1e3, a = n.scale;
                    for (e = 0, i = this._controllerLayers.length; e < i; e++) {
                        var s = this._controllerLayers[e], o = s._playStateInfo, l = s._crossPlayStateInfo;
                        switch (_ = s.blendingMode !== Be.BLENDINGMODE_OVERRIDE, s._playType) {
                            case 0:
                                var h = s._currentPlayState, u = h._clip, c = this._speed * h.speed, d = o._finish;
                                if (d || this._updatePlayer(h, o, r * c, u.islooping), t) {
                                    var _ = s.blendingMode !== Be.BLENDINGMODE_OVERRIDE;
                                    this._updateClipDatas(h, _, o, a * c), this._setClipDatasToNode(h, _, s.defaultWeight, 0 === e),
                                        d || this._updateEventScript(h, o);
                                }
                                break;

                            case 1:
                                u = (h = s._currentPlayState)._clip;
                                var f = s._crossPlayState, p = f._clip, m = s._crossDuration, g = l._startPlayTime, y = p._duration - g, v = m > y ? y / m : 1, S = this._speed * f.speed;
                                this._updatePlayer(f, l, r * v * S, p.islooping);
                                var T = (l._elapsedTime - g) / v / m;
                                T >= 1 ? t && (this._updateClipDatas(f, _, l, a * S), this._setClipDatasToNode(f, _, s.defaultWeight, 0 === e),
                                    s._playType = 0, s._currentPlayState = f, l._cloneTo(o)) : (o._finish || (c = this._speed * h.speed,
                                        this._updatePlayer(h, o, r * c, u.islooping), t && this._updateClipDatas(h, _, o, a * c)),
                                        t && (this._updateClipDatas(f, _, l, a * v * S), this._setCrossClipDatasToNode(s, h, f, T, 0 === e))),
                                    t && (this._updateEventScript(h, o), this._updateEventScript(f, l));
                                break;

                            case 2:
                                p = (f = s._crossPlayState)._clip, m = s._crossDuration, g = l._startPlayTime, v = m > (y = p._duration - g) ? y / m : 1,
                                    S = this._speed * f.speed, this._updatePlayer(f, l, r * v * S, p.islooping), t && ((T = (l._elapsedTime - g) / v / m) >= 1 ? (this._updateClipDatas(f, _, l, a * S),
                                        this._setClipDatasToNode(f, _, 1, 0 === e), s._playType = 0, s._currentPlayState = f,
                                        l._cloneTo(o)) : (this._updateClipDatas(f, _, l, a * v * S), this._setFixedCrossClipDatasToNode(s, f, T, 0 === e)),
                                        this._updateEventScript(f, l));
                        }
                    }
                    t && this._avatar && (I.supportWebGLPlusAnimation && this._updateAnimationNodeWorldMatix(this._animationNodeLocalPositions, this._animationNodeLocalRotations, this._animationNodeLocalScales, this._animationNodeWorldMatrixs, this._animationNodeParentIndices),
                        this._updateAvatarNodesToSprite());
                }
            }, i._cloneTo = function (t) {
                var e = t;
                e.avatar = this.avatar;
                for (var i = 0, n = this._controllerLayers.length; i < n; i++) {
                    var r = this._controllerLayers[i];
                    e.addControllerLayer(r.clone());
                    for (var a = r._states, s = 0, o = a.length; s < o; s++) {
                        var l = a[s].clone();
                        e.addState(l, i), 0 == s && (e.getControllerLayer(i).defaultState = l);
                    }
                }
                e._linkSprites = this._linkSprites, e._linkToSprites(this._linkSprites);
            }, i.getDefaultState = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t].defaultState;
            }, i.addState = function (t, e) {
                void 0 === e && (e = 0);
                var i = t.name, n = this._controllerLayers[e], r = n._statesMap, a = n._states;
                if (r[i]) throw "Animator:this stat's name has exist.";
                r[i] = t, a.push(t), t._clip._addReference(), this._getOwnersByClip(t);
            }, i.removeState = function (t, e) {
                void 0 === e && (e = 0);
                for (var i = this._controllerLayers[e], n = i._states, r = i._statesMap, a = -1, s = 0, o = n.length; s < o; s++) if (n[s] === t) {
                    a = s;
                    break;
                }
                -1 !== a && this._removeClip(n, r, a, t);
            }, i.addControllerLayer = function (t) {
                this._controllerLayers.push(t);
            }, i.getControllerLayer = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t];
            }, i.getCurrentAnimatorPlayState = function (t) {
                return void 0 === t && (t = 0), this._controllerLayers[t]._playStateInfo;
            }, i.play = function (t, e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = Number.NEGATIVE_INFINITY);
                var n = this._controllerLayers[e], r = n.defaultState;
                if (!t && !r) throw new Error("Animator:must have  default clip value,please set clip property.");
                var a = n._currentPlayState, s = n._playStateInfo, o = t ? n._statesMap[t] : r, l = o._clip._duration;
                a !== o ? (i !== Number.NEGATIVE_INFINITY ? s._resetPlayState(l * i) : s._resetPlayState(0),
                    null !== a && a !== o && this._revertDefaultKeyframeNodes(a), n._playType = 0, n._currentPlayState = o) : i !== Number.NEGATIVE_INFINITY && (s._resetPlayState(l * i),
                        n._playType = 0);
                var h = o._scripts;
                if (h) for (var u = 0, c = h.length; u < c; u++) h[u].onStateEnter();
            }, i.crossFade = function (t, e, i, n) {
                void 0 === i && (i = 0), void 0 === n && (n = Number.NEGATIVE_INFINITY);
                var r = this._controllerLayers[i], a = r._statesMap[t];
                if (a) {
                    var s = r._playType;
                    if (-1 === s) return void this.play(t, i, n);
                    var o = r._crossPlayStateInfo, l = r._crossNodesOwners, h = r._crossNodesOwnersIndicesMap, u = r._currentPlayState, c = a._nodeOwners, d = r._destCrossClipNodeIndices, _ = a._clip, f = _._nodes, p = _._nodesDic;
                    switch (s) {
                        case 0:
                            var m = u._nodeOwners, g = r._srcCrossClipNodeIndices, y = u._clip, v = y._nodes, S = y._nodesDic;
                            r._playType = 1;
                            for (var T = ++r._crossMark, E = r._crossNodesOwnersCount = 0, C = 0, x = v.count; C < x; C++) {
                                var b = v.getNodeByIndex(C), I = b._indexInList, w = m[I];
                                if (w) {
                                    var A = b.fullPath;
                                    g[E] = I;
                                    var R = p[A];
                                    d[E] = R ? R._indexInList : -1, h[A] = T, l[E] = w, E++;
                                }
                            }
                            for (C = 0, x = f.count; C < x; C++) {
                                var M = (R = f.getNodeByIndex(C))._indexInList, D = c[M];
                                if (D) {
                                    var O = R.fullPath;
                                    S[O] || (g[E] = -1, d[E] = M, h[O] = T, l[E] = D, E++);
                                }
                            }
                            break;

                        case 1:
                        case 2:
                            for (r._playType = 2, C = 0, x = l.length; C < x; C++) {
                                var L = l[C];
                                L.saveCrossFixedValue(), R = p[L.fullPath], d[C] = R ? R._indexInList : -1;
                            }
                            for (E = r._crossNodesOwnersCount, T = r._crossMark, C = 0, x = f.count; C < x; C++) (D = c[M = (R = f.getNodeByIndex(C))._indexInList]) && h[O = R.fullPath] !== T && (d[E] = M,
                                h[O] = T, L = c[M], l[E] = L, L.saveCrossFixedValue(), E++);
                    }
                    r._crossNodesOwnersCount = E, r._crossPlayState = a, r._crossDuration = u._clip._duration * e,
                        n !== Number.NEGATIVE_INFINITY ? o._resetPlayState(_._duration * n) : o._resetPlayState(0);
                }
                var P = a._scripts;
                if (P) for (C = 0, x = P.length; C < x; C++) P[C].onStateEnter();
            }, i._getAvatarOwnersAndInitDatasAsync = function () {
                for (var t = 0, e = this._controllerLayers.length; t < e; t++) for (var i = this._controllerLayers[t]._states, n = 0, r = i.length; n < r; n++) this._getOwnersByClip(i[n]);
                for (var a in this._avatar._cloneDatasToAnimator(this), this._linkAvatarSpritesData) {
                    var s = this._linkAvatarSpritesData[a];
                    if (s) for (var o = 0, l = s.length; o < l; o++) this._isLinkSpriteToAnimationNode(s[o], a, !0);
                }
            }, i._isLinkSpriteToAnimationNode = function (t, e, i) {
                if (this._avatar) {
                    var n = this._avatarNodeMap[e];
                    if (n) if (i) {
                        t._transform._dummy = n.transform, this._linkAvatarSprites.push(t);
                        var r = n.transform, a = t.transform;
                        if (!a.owner.isStatic && r) {
                            var s = a.worldMatrix, o = this.owner._transform._parent;
                            if (o) Ht.matrix4x4MultiplyMFM(o.worldMatrix, r.getWorldMatrix(), s); else for (var l = s.elements, h = r.getWorldMatrix(), u = 0; u < 16; u++) l[u] = h[u];
                            a.worldMatrix = s;
                        }
                    } else t._transform._dummy = null, this._linkAvatarSprites.splice(this._linkAvatarSprites.indexOf(t), 1);
                }
            }, i._isLinkSpriteToAnimationNodeData = function (t, e, i) {
                var n = this._linkAvatarSpritesData[e];
                i ? (n || (this._linkAvatarSpritesData[e] = n = []), n.push(t)) : n.splice(t, 1);
            }, i._updateAvatarNodesToSprite = function () {
                for (var t = 0, e = this._linkAvatarSprites.length; t < e; t++) {
                    var i = this._linkAvatarSprites[t], n = i.transform._dummy, r = i.transform;
                    if (!r.owner.isStatic && n) {
                        var a = r.worldMatrix, s = this.owner._transform;
                        Ht.matrix4x4MultiplyMFM(s.worldMatrix, n.getWorldMatrix(), a), r.worldMatrix = a;
                    }
                }
            }, i.linkSprite3DToAvatarNode = function (t, e) {
                return this._isLinkSpriteToAnimationNodeData(e, t, !0), this._isLinkSpriteToAnimationNode(e, t, !0),
                    !0;
            }, i.unLinkSprite3DToAvatarNode = function (t) {
                if (t._hierarchyAnimator === this) {
                    var e = t.transform._dummy;
                    if (e) {
                        var i = e._owner.name;
                        return this._isLinkSpriteToAnimationNodeData(t, i, !1), this._isLinkSpriteToAnimationNode(t, i, !1),
                            !0;
                    }
                    return !1;
                }
                throw "Animator:sprite3D must belong to this Animator";
            }, i._updateAnimationNodeWorldMatix = function (t, e, i, n, r) {
                v.instance.updateAnimationNodeWorldMatix(t, e, i, r, n);
            }, a(0, i, "speed", function () {
                return this._speed;
            }, function (t) {
                this._speed = t;
            }), a(0, i, "avatar", function () {
                return this._avatar;
            }, function (t) {
                if (this._avatar !== t) if (this._avatar = t, t) this._getAvatarOwnersAndInitDatasAsync(),
                    this.owner._changeHierarchyAnimatorAvatar(this, t); else {
                    var e = this.owner._parent;
                    this.owner._changeHierarchyAnimatorAvatar(this, e ? e._hierarchyAnimator._avatar : null);
                }
            }), e._update = function (t) {
                for (var e = t._animatorPool, i = e.elements, n = 0, r = e.length; n < r; n++) {
                    var a = i[n];
                    a && a.enabled && a._update();
                }
            }, e._tempVector3Array0 = new Float32Array(3), e._tempVector3Array1 = new Float32Array(3),
                e._tempQuaternionArray0 = new Float32Array(4), e._tempQuaternionArray1 = new Float32Array(4),
                e.CULLINGMODE_ALWAYSANIMATE = 0, e.CULLINGMODE_CULLCOMPLETELY = 2, n(e, ["_tempVector30", function () {
                    return this._tempVector30 = new gt();
                }, "_tempVector31", function () {
                    return this._tempVector31 = new gt();
                }, "_tempQuaternion0", function () {
                    return this._tempQuaternion0 = new ht();
                }, "_tempQuaternion1", function () {
                    return this._tempQuaternion1 = new ht();
                }]), e;
        }(f), qe = function (t) {
            function e(t, i, n, r, a) {
                e.__super.call(this), this._owner = t, this._children = [], this._localMatrix = new Float32Array(16),
                    I.supportWebGLPlusAnimation ? (this._localPosition = new G(0, 0, 0, i), this._localRotation = new V(0, 0, 0, 1, n),
                        this._localScale = new G(0, 0, 0, r), this._worldMatrix = a) : (this._localPosition = new gt(),
                            this._localRotation = new ht(), this._localScale = new gt(), this._worldMatrix = new Float32Array(16)),
                    this._localQuaternionUpdate = !1, this._locaEulerlUpdate = !1, this._localUpdate = !1,
                    this._worldUpdate = !0;
            }
            r(e, "laya.d3.animation.AnimationTransform3D", t);
            var i = e.prototype;
            return i._getlocalMatrix = function () {
                return this._localUpdate && (Ht._createAffineTransformationArray(this._localPosition, this._localRotation, this._localScale, this._localMatrix),
                    this._localUpdate = !1), this._localMatrix;
            }, i._onWorldTransform = function () {
                if (!this._worldUpdate) {
                    this._worldUpdate = !0, this.event("transformchanged");
                    for (var t = 0, e = this._children.length; t < e; t++) this._children[t]._onWorldTransform();
                }
            }, i.getWorldMatrix = function () {
                if (!I.supportWebGLPlusAnimation && this._worldUpdate) {
                    if (null != this._parent) Ht.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(), this._getlocalMatrix(), this._worldMatrix); else {
                        var t = this._worldMatrix;
                        t[1] = t[2] = t[3] = t[4] = t[6] = t[7] = t[8] = t[9] = t[11] = t[12] = t[13] = t[14] = 0,
                            t[0] = t[5] = t[10] = t[15] = 1;
                    }
                    this._worldUpdate = !1;
                }
                return I.supportWebGLPlusAnimation && this._worldUpdate && (this._worldUpdate = !1),
                    this._worldMatrix;
            }, i.setParent = function (t) {
                if (this._parent !== t) {
                    if (this._parent) {
                        var e = this._parent._children, i = e.indexOf(this);
                        e.splice(i, 1);
                    }
                    t && (t._children.push(this), t && this._onWorldTransform()), this._parent = t;
                }
            }, a(0, i, "localPosition", function () {
                return this._localPosition;
            }, function (t) {
                this._localPosition = t, this._localUpdate = !0, this._onWorldTransform();
            }), a(0, i, "localRotation", function () {
                if (this._localQuaternionUpdate) {
                    var t = this._localRotationEuler;
                    ht.createFromYawPitchRoll(t.y / e._angleToRandin, t.x / e._angleToRandin, t.z / e._angleToRandin, this._localRotation),
                        this._localQuaternionUpdate = !1;
                }
                return this._localRotation;
            }, function (t) {
                this._localRotation = t, this._locaEulerlUpdate = !0, this._localQuaternionUpdate = !1,
                    this._localUpdate = !0, this._onWorldTransform();
            }), a(0, i, "localScale", function () {
                return this._localScale;
            }, function (t) {
                this._localScale = t, this._localUpdate = !0, this._onWorldTransform();
            }), a(0, i, "localRotationEuler", function () {
                if (this._locaEulerlUpdate) {
                    this._localRotation.getYawPitchRoll(e._tempVector3);
                    var t = e._tempVector3, i = this._localRotationEuler;
                    i.x = t.y * e._angleToRandin, i.y = t.x * e._angleToRandin, i.z = t.z * e._angleToRandin,
                        this._locaEulerlUpdate = !1;
                }
                return this._localRotationEuler;
            }, function (t) {
                this._localRotationEuler = t, this._locaEulerlUpdate = !1, this._localQuaternionUpdate = !0,
                    this._localUpdate = !0, this._onWorldTransform();
            }), n(e, ["_tempVector3", function () {
                return this._tempVector3 = new gt();
            }, "_angleToRandin", function () {
                return this._angleToRandin = 180 / Math.PI;
            }]), e;
        }(g), Ke = function (t) {
            function e(t, i, n, r) {
                if (this._vertexCount = 0, this._canRead = !1, this._dataType = 0, this._vertexDeclaration = null,
                    void 0 === n && (n = !1), void 0 === r && (r = 0), e.__super.call(this), this._vertexCount = -1,
                    this._bufferUsage = i, this._bufferType = 34962, this._canRead = n, this._dataType = r,
                    this._byteLength = t, this.bind(), v.instance.bufferData(this._bufferType, this._byteLength, this._bufferUsage),
                    n) switch (r) {
                        case 0:
                            this._buffer = new Float32Array(t / 4);
                            break;

                        case 1:
                            this._buffer = new Uint8Array(t);
                    }
            }
            r(e, "laya.d3.graphics.VertexBuffer3D", t);
            var i = e.prototype;
            return i.bind = function () {
                return h._bindedVertexBuffer !== this._glBuffer && (v.instance.bindBuffer(34962, this._glBuffer),
                    h._bindedVertexBuffer = this._glBuffer, !0);
            }, i.setData = function (t, e, i, n) {
                if (void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 4294967295),
                    this.bind(), 0 !== i || 4294967295 !== n) switch (this._dataType) {
                        case 0:
                            t = new Float32Array(t.buffer, 4 * i, n);
                            break;

                        case 1:
                            t = new Uint8Array(t.buffer, i, n);
                    }
                switch (this._dataType) {
                    case 0:
                        v.instance.bufferSubData(this._bufferType, 4 * e, t);
                        break;

                    case 1:
                        v.instance.bufferSubData(this._bufferType, e, t);
                }
                this._canRead && this._buffer.set(t, e);
            }, i.getData = function () {
                if (this._canRead) return this._buffer;
                throw new Error("Can't read data from VertexBuffer with only write flag!");
            }, i.destroy = function () {
                t.prototype.destroy.call(this), this._buffer = null, this._vertexDeclaration = null;
            }, a(0, i, "vertexDeclaration", function () {
                return this._vertexDeclaration;
            }, function (t) {
                this._vertexDeclaration !== t && (this._vertexDeclaration = t, this._vertexCount = t ? this._byteLength / t.vertexStride : -1);
            }), a(0, i, "vertexCount", function () {
                return this._vertexCount;
            }), a(0, i, "canRead", function () {
                return this._canRead;
            }), e.DATATYPE_FLOAT32ARRAY = 0, e.DATATYPE_UINT8ARRAY = 1, e;
        }(h), Ze = (function (t) {
            function e() {
                this._nativeConstraint = null, this._breakingImpulseThreshold = NaN, this._connectedBody = null,
                    this._feedbackEnabled = !1, e.__super.call(this);
            }
            r(e, "laya.d3.physics.constraints.ConstraintComponent", t);
            var n = e.prototype;
            n._onDestroy = function () {
                W._physics3D.destroy(this._nativeConstraint), this._nativeConstraint = null;
            }, a(0, n, "breakingImpulseThreshold", function () {
                return this._breakingImpulseThreshold;
            }, function (t) {
                this._nativeConstraint.BreakingImpulseThreshold = t, this._breakingImpulseThreshold = t;
            }), a(0, n, "enabled", function () {
                return i.superGet(f, this, "enabled");
            }, function (t) {
                this._nativeConstraint.IsEnabled = t, i.superSet(f, this, "enabled", t);
            }), a(0, n, "appliedImpulse", function () {
                return this._feedbackEnabled || (this._nativeConstraint.EnableFeedback(!0), this._feedbackEnabled = !0),
                    this._nativeConstraint.AppliedImpulse;
            }), a(0, n, "connectedBody", function () {
                return this._connectedBody;
            }, function (t) {
                this._connectedBody = t;
            });
        }(f), function (t) {
            function e(t, i, n, r) {
                this._indexType = null, this._indexTypeByteCount = 0, this._indexCount = 0, this._canRead = !1,
                    void 0 === n && (n = 35044), void 0 === r && (r = !1), e.__super.call(this), this._indexType = t,
                    this._indexCount = i, this._bufferUsage = n, this._bufferType = 34963, this._canRead = r;
                var a;
                if ("ushort" == t) this._indexTypeByteCount = 2; else {
                    if ("ubyte" != t) throw new Error("unidentification index type.");
                    this._indexTypeByteCount = 1;
                }
                a = this._indexTypeByteCount * i, this._byteLength = a;
                var s = u._curBindedBufferState;
                s ? s._bindedIndexBuffer === this ? v.instance.bufferData(this._bufferType, a, this._bufferUsage) : (s.unBind(),
                    this.bind(), v.instance.bufferData(this._bufferType, a, this._bufferUsage), s.bind()) : (this.bind(),
                        v.instance.bufferData(this._bufferType, a, this._bufferUsage)), r && ("ushort" == t ? this._buffer = new Uint16Array(i) : "ubyte" == t && (this._buffer = new Uint8Array(i)));
            }
            r(e, "laya.d3.graphics.IndexBuffer3D", t);
            var i = e.prototype;
            return i._bindForVAO = function () {
                if (!u._curBindedBufferState) throw "IndexBuffer3D: must bind current BufferState.";
                v.instance.bindBuffer(34963, this._glBuffer);
            }, i.bind = function () {
                if (u._curBindedBufferState) throw "IndexBuffer3D: must unbind current BufferState.";
                return h._bindedIndexBuffer !== this._glBuffer && (v.instance.bindBuffer(34963, this._glBuffer),
                    h._bindedIndexBuffer = this._glBuffer, !0);
            }, i.setData = function (t, e, i, n) {
                void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 4294967295);
                var r = 0;
                "ushort" == this._indexType ? (r = 2, 0 === i && 4294967295 === n || (t = new Uint16Array(t.buffer, i * r, n))) : "ubyte" == this._indexType && (r = 1,
                    0 === i && 4294967295 === n || (t = new Uint8Array(t.buffer, i * r, n)));
                var a = u._curBindedBufferState;
                if (a ? a._bindedIndexBuffer === this ? v.instance.bufferSubData(this._bufferType, e * r, t) : (a.unBind(),
                    this.bind(), v.instance.bufferSubData(this._bufferType, e * r, t), a.bind()) : (this.bind(),
                        v.instance.bufferSubData(this._bufferType, e * r, t)), this._canRead) if (0 !== e || 0 !== i || 4294967295 !== n) {
                            var s = this._buffer.length - e;
                            n > s && (n = s);
                            for (var o = 0; o < n; o++) this._buffer[e + o] = t[o];
                        } else this._buffer = t;
            }, i.getData = function () {
                if (this._canRead) return this._buffer;
                throw new Error("Can't read data from VertexBuffer with only write flag!");
            }, i.destroy = function () {
                t.prototype.destroy.call(this), this._buffer = null;
            }, a(0, i, "indexType", function () {
                return this._indexType;
            }), a(0, i, "indexTypeByteCount", function () {
                return this._indexTypeByteCount;
            }), a(0, i, "indexCount", function () {
                return this._indexCount;
            }), a(0, i, "canRead", function () {
                return this._canRead;
            }), e.INDEXTYPE_UBYTE = "ubyte", e.INDEXTYPE_USHORT = "ushort", e;
        }(h)), Qe = function (t) {
            function e(t, i, n, r) {
                this._renderState = new Y(), this._owner = t, this._cacheSharders = [], this._publicValidDefine = 0,
                    this._spriteValidDefine = 0, this._materialValidDefine = 0, this._validDefineMap = {},
                    e.__super.call(this, i, n, null, this._validDefineMap);
                var a = this._owner._publicDefinesMap, s = this._owner._spriteDefinesMap, o = this._owner._materialDefinesMap;
                for (var l in this._validDefineMap) null != a[l] ? this._publicValidDefine |= a[l] : null != s[l] ? this._spriteValidDefine |= s[l] : null != o[l] && (this._materialValidDefine |= o[l]);
                this._stateMap = r;
            }
            r(e, "laya.d3.shader.ShaderPass", t);
            var i = e.prototype;
            return i._definesToNameDic = function (t, e) {
                for (var i = {}, n = 1, r = 0; r < 32 && !((n = 1 << r) > t); r++) {
                    t & n && (i[e[n]] = "");
                }
                return i;
            }, i._compileToTree = function (t, e, i, n, r) {
                var a, s, o, l, h, u, c, d = 0, _ = 0, f = 0, p = 0;
                for (_ = i; _ < e.length; _++) if (!((o = e[_]).length < 1) && 0 !== (d = o.indexOf("//"))) {
                    if (d >= 0 && (o = o.substr(0, d)), a = c || new M(n), c = null, a.text = o, (d = o.indexOf("#")) >= 0) {
                        for (l = "#", p = d + 1, f = o.length; p < f; p++) {
                            var m = o.charAt(p);
                            if (" " === m || "\t" === m || "?" === m) break;
                            l += m;
                        }
                        switch (a.name = l, l) {
                            case "#ifdef":
                            case "#ifndef":
                                if (a.setParent(t), t = a, r) for (u = o.substr(p).split(R._splitToWordExps3), p = 0; p < u.length; p++) (o = u[p]).length && (r[o] = !0);
                                continue;

                            case "#if":
                            case "#elif":
                                if (a.setParent(t), t = a, r) for (u = o.substr(p).split(R._splitToWordExps3), p = 0; p < u.length; p++) (o = u[p]).length && "defined" != o && (r[o] = !0);
                                continue;

                            case "#else":
                                s = (t = t.parent).childs[t.childs.length - 1], a.setParent(t), t = a;
                                continue;

                            case "#endif":
                                s = (t = t.parent).childs[t.childs.length - 1], a.setParent(t);
                                continue;

                            case "#include":
                                u = R.splitToWords(o, null);
                                var g = R.includes[u[1]];
                                if (!g) throw "ShaderCompile error no this include file:" + u[1];
                                if ((d = u[0].indexOf("?")) < 0) {
                                    a.setParent(t), o = g.getWith("with" == u[2] ? u[3] : null), this._compileToTree(a, o.split("\n"), 0, n, r),
                                        a.text = "";
                                    continue;
                                }
                                a.setCondition(u[0].substr(d + 1), 1), a.text = g.getWith("with" == u[2] ? u[3] : null);
                                break;

                            case "#import":
                                h = (u = R.splitToWords(o, null))[1], n.push({
                                    node: a,
                                    file: R.includes[h],
                                    ofs: a.text.length
                                });
                                continue;
                        }
                    } else {
                        if ((s = t.childs[t.childs.length - 1]) && !s.name) {
                            n.length > 0 && R.splitToWords(o, s), c = a, s.text += "\n" + o;
                            continue;
                        }
                        n.length > 0 && R.splitToWords(o, a);
                    }
                    a.setParent(t);
                }
            }, i.withCompile = function (t, e, i) {
                var n, r, a;
                if (t &= this._publicValidDefine, e &= this._spriteValidDefine, i &= this._materialValidDefine,
                    r = this._cacheSharders[t]) if (a = r[e]) {
                        if (n = a[i]) return n;
                    } else a = r[e] = []; else a = (r = this._cacheSharders[t] = [])[e] = [];
                var s, o = this._definesToNameDic(t, this._owner._publicDefines), l = this._definesToNameDic(e, this._owner._spriteDefines), h = this._definesToNameDic(i, this._owner._materialDefines);
                if (Lt.debugMode) {
                    var u = "";
                    for (s in o) u += s + " ";
                    var c = "";
                    for (s in l) c += s + " ";
                    var d = "";
                    for (s in h) d += s + " ";
                    F.shaderHighPrecision || (t += Lt.SHADERDEFINE_HIGHPRECISION), console.log("%cShader3DDebugMode---(Name:" + this._owner._owner._name + " PassIndex:" + this._owner._passes.indexOf(this) + " PublicDefine:" + t + " SpriteDefine:" + e + " MaterialDefine:" + i + " PublicDefineGroup:" + u + " SpriteDefineGroup:" + c + "MaterialDefineGroup: " + d + ")---ShaderCompile3DDebugMode", "color:green");
                }
                var _ = {}, f = "";
                if (o) for (s in o) f += "#define " + s + "\n", _[s] = !0;
                if (l) for (s in l) f += "#define " + s + "\n", _[s] = !0;
                if (h) for (s in h) f += "#define " + s + "\n", _[s] = !0;
                var p = this._VS.toscript(_, []), m = "";
                0 == p[0].indexOf("#version") && (m = p[0] + "\n", p.shift());
                var g = this._PS.toscript(_, []), y = "";
                return 0 == g[0].indexOf("#version") && (y = g[0] + "\n", g.shift()), n = new Hi(m + f + p.join("\n"), y + f + g.join("\n"), this._owner._attributeMap || this._owner._owner._attributeMap, this._owner._uniformMap || this._owner._owner._uniformMap, this),
                    a[i] = n, n;
            }, a(0, i, "renderState", function () {
                return this._renderState;
            }), e;
        }(R), Je = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.core.BufferState", t);
            var i = e.prototype;
            return i.applyVertexBuffer = function (t) {
                if (u._curBindedBufferState !== this) throw "BufferState: must call bind() function first.";
                var e = v.instance, i = t.vertexDeclaration, n = null;
                for (var r in n = I.supportWebGLPlusRendering ? i._shaderValues._nativeArray : i._shaderValues.getData(),
                    t.bind(), n) {
                    var a = parseInt(r), s = n[r];
                    e.enableVertexAttribArray(a), e.vertexAttribPointer(a, s[0], s[1], !!s[2], s[3], s[4]);
                }
            }, i.applyVertexBuffers = function (t) {
                if (u._curBindedBufferState !== this) throw "BufferState: must call bind() function first.";
                for (var e = v.instance, i = 0, n = t.length; i < n; i++) {
                    var r = t[i], a = r.vertexDeclaration, s = null;
                    for (var o in s = I.supportWebGLPlusRendering ? a._shaderValues._nativeArray : a._shaderValues.getData(),
                        r.bind(), s) {
                        var l = parseInt(o), h = s[o];
                        e.enableVertexAttribArray(l), e.vertexAttribPointer(l, h[0], h[1], !!h[2], h[3], h[4]);
                    }
                }
            }, i.applyInstanceVertexBuffer = function (t) {
                if (k._angleInstancedArrays) {
                    if (u._curBindedBufferState !== this) throw "BufferState: must call bind() function first.";
                    var e = v.instance, i = t.vertexDeclaration, n = null;
                    for (var r in n = I.supportWebGLPlusRendering ? i._shaderValues._nativeArray : i._shaderValues.getData(),
                        t.bind(), n) {
                        var a = parseInt(r), s = n[r];
                        e.enableVertexAttribArray(a), e.vertexAttribPointer(a, s[0], s[1], !!s[2], s[3], s[4]),
                            k._angleInstancedArrays.vertexAttribDivisorANGLE(a, 1);
                    }
                }
            }, i.applyIndexBuffer = function (t) {
                if (u._curBindedBufferState !== this) throw "BufferState: must call bind() function first.";
                this._bindedIndexBuffer !== t && (t._bindForVAO(), this._bindedIndexBuffer = t);
            }, e;
        }(u), $e = function (t) {
            function e() {
                this.angle = NaN, this.radius = NaN, this.length = NaN, this.emitType = 0, e.__super.call(this),
                    this.angle = 25 / 180 * Math.PI, this.radius = 1, this.length = 5, this.emitType = 0,
                    this.randomDirection = !1;
            }
            r(e, "laya.d3.core.particleShuriKen.module.shape.ConeShape", t);
            var i = e.prototype;
            return i._getShapeBoundBox = function (t) {
                var e = this.radius + this.length * Math.sin(this.angle), i = this.length * Math.cos(this.angle), n = t.min;
                n.x = n.y = -e, n.z = 0;
                var r = t.max;
                r.x = r.y = e, r.z = i;
            }, i._getSpeedBoundBox = function (t) {
                var e = Math.sin(this.angle), i = t.min;
                i.x = i.y = -e, i.z = 0;
                var n = t.max;
                n.x = n.y = e, n.z = 1;
            }, i.generatePositionAndDirection = function (t, i, n, r) {
                var a, s = e._tempPositionPoint, o = NaN, l = NaN, h = Math.cos(this.angle), u = Math.sin(this.angle);
                switch (this.emitType) {
                    case 0:
                        n ? (n.seed = r[16], Me._randomPointInsideUnitCircle(e._tempPositionPoint, n), r[16] = n.seed) : Me._randomPointInsideUnitCircle(e._tempPositionPoint),
                            o = s.x, l = s.y, t.x = o * this.radius, t.y = l * this.radius, t.z = 0, this.randomDirection ? (n ? (n.seed = r[17],
                                Me._randomPointInsideUnitCircle(e._tempDirectionPoint, n), r[17] = n.seed) : Me._randomPointInsideUnitCircle(e._tempDirectionPoint),
                                a = e._tempDirectionPoint, i.x = a.x * u, i.y = a.y * u) : (i.x = o * u, i.y = l * u),
                            i.z = h;
                        break;

                    case 1:
                        n ? (n.seed = r[16], Me._randomPointUnitCircle(e._tempPositionPoint, n), r[16] = n.seed) : Me._randomPointUnitCircle(e._tempPositionPoint),
                            o = s.x, l = s.y, t.x = o * this.radius, t.y = l * this.radius, t.z = 0, this.randomDirection ? (n ? (n.seed = r[17],
                                Me._randomPointInsideUnitCircle(e._tempDirectionPoint, n), r[17] = n.seed) : Me._randomPointInsideUnitCircle(e._tempDirectionPoint),
                                a = e._tempDirectionPoint, i.x = a.x * u, i.y = a.y * u) : (i.x = o * u, i.y = l * u),
                            i.z = h;
                        break;

                    case 2:
                        n ? (n.seed = r[16], Me._randomPointInsideUnitCircle(e._tempPositionPoint, n)) : Me._randomPointInsideUnitCircle(e._tempPositionPoint),
                            o = s.x, l = s.y, t.x = o * this.radius, t.y = l * this.radius, t.z = 0, i.x = o * u,
                            i.y = l * u, i.z = h, gt.normalize(i, i), n ? (gt.scale(i, this.length * n.getFloat(), i),
                                r[16] = n.seed) : gt.scale(i, this.length * Math.random(), i), gt.add(t, i, t),
                            this.randomDirection && (n ? (n.seed = r[17], Me._randomPointUnitSphere(i, n), r[17] = n.seed) : Me._randomPointUnitSphere(i));
                        break;

                    case 3:
                        n ? (n.seed = r[16], Me._randomPointUnitCircle(e._tempPositionPoint, n)) : Me._randomPointUnitCircle(e._tempPositionPoint),
                            o = s.x, l = s.y, t.x = o * this.radius, t.y = l * this.radius, t.z = 0, i.x = o * u,
                            i.y = l * u, i.z = h, gt.normalize(i, i), n ? (gt.scale(i, this.length * n.getFloat(), i),
                                r[16] = n.seed) : gt.scale(i, this.length * Math.random(), i), gt.add(t, i, t),
                            this.randomDirection && (n ? (n.seed = r[17], Me._randomPointUnitSphere(i, n), r[17] = n.seed) : Me._randomPointUnitSphere(i));
                        break;

                    default:
                        throw new Error("ConeShape:emitType is invalid.");
                }
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.angle = this.angle, i.radius = this.radius, i.length = this.length, i.emitType = this.emitType,
                    i.randomDirection = this.randomDirection;
            }, n(e, ["_tempPositionPoint", function () {
                return this._tempPositionPoint = new yt();
            }, "_tempDirectionPoint", function () {
                return this._tempDirectionPoint = new yt();
            }]), e;
        }(H), ti = function (t) {
            function e(t) {
                e.__super.call(this), void 0 === t && (t = .5), this._radius = t, this._type = 1,
                    this._nativeShape = new W._physics3D.btSphereShape(t);
            }
            r(e, "laya.d3.physics.shape.SphereColliderShape", t);
            var i = e.prototype;
            return i.clone = function () {
                var t = new e(this._radius);
                return this.cloneTo(t), t;
            }, a(0, i, "radius", function () {
                return this._radius;
            }), e;
        }(j), ei = function (t) {
            function e() {
                this.radius = NaN, this.arc = NaN, this.emitFromEdge = !1, e.__super.call(this),
                    this.radius = 1, this.arc = 2 * Math.PI, this.emitFromEdge = !1, this.randomDirection = !1;
            }
            r(e, "laya.d3.core.particleShuriKen.module.shape.CircleShape", t);
            var i = e.prototype;
            return i._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.z = -this.radius, e.y = 0;
                var i = t.max;
                i.x = i.z = this.radius, i.y = 0;
            }, i._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = -1, e.z = 0;
                var i = t.max;
                i.x = i.y = 1, i.z = 0;
            }, i.generatePositionAndDirection = function (t, i, n, r) {
                var a = e._tempPositionPoint;
                n ? (n.seed = r[16], this.emitFromEdge ? Me._randomPointUnitArcCircle(this.arc, e._tempPositionPoint, n) : Me._randomPointInsideUnitArcCircle(this.arc, e._tempPositionPoint, n),
                    r[16] = n.seed) : this.emitFromEdge ? Me._randomPointUnitArcCircle(this.arc, e._tempPositionPoint) : Me._randomPointInsideUnitArcCircle(this.arc, e._tempPositionPoint),
                    t.x = -a.x, t.y = a.y, t.z = 0, gt.scale(t, this.radius, t), this.randomDirection ? n ? (n.seed = r[17],
                        Me._randomPointUnitSphere(i, n), r[17] = n.seed) : Me._randomPointUnitSphere(i) : t.cloneTo(i);
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.radius = this.radius, i.arc = this.arc, i.emitFromEdge = this.emitFromEdge, i.randomDirection = this.randomDirection;
            }, n(e, ["_tempPositionPoint", function () {
                return this._tempPositionPoint = new yt();
            }]), e;
        }(H), ii = function (t) {
            function e() {
                this._source = null, this._dest = null, this._shader = null, this._shaderData = null,
                    this._subShader = 0, e.__super.call(this);
            }
            r(e, "laya.d3.core.render.command.BlitCMD", t);
            var i = e.prototype;
            return i.run = function () {
                this._shaderData.setTexture(le.SCREENTEXTURE_ID, this._source);
                var t = this._dest;
                t && t._start();
                for (var e = this._shader.getSubShaderAt(this._subShader)._passes, i = 0, n = e.length; i < n; i++) {
                    var r = e[i].withCompile(0, 0, 0);
                    r.bind(), this._shaderData && r.uploadUniforms(r._materialUniformParamsMap, this._shaderData, !0),
                        r.uploadRenderStateBlendDepth(this._shaderData), r.uploadRenderStateFrontFace(this._shaderData, !0, null),
                        ki.instance.render();
                }
                t && t._end();
            }, i.recover = function () {
                e._pool.push(this), this._dest = null, this._shader = null, this._shaderData = null;
            }, e.create = function (t, i, n, r, a) {
                var s;
                return void 0 === a && (a = 0), (s = e._pool.length > 0 ? e._pool.pop() : new e())._source = t,
                    s._dest = i, s._shader = n, s._shaderData = r, s._subShader = a, s;
            }, e._pool = [], e;
        }(Q), ni = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.CastShadowList", t);
            var i = e.prototype;
            return i.add = function (t) {
                if (-1 !== t._indexInCastShadowList) throw "CastShadowList:element has  in  CastShadowList.";
                this._add(t), t._indexInCastShadowList = this.length++;
            }, i.remove = function (t) {
                var e = t._indexInCastShadowList;
                if (this.length--, e !== this.length) {
                    var i = this.elements[this.length];
                    this.elements[e] = i, i._indexInCastShadowList = e;
                }
                t._indexInCastShadowList = -1;
            }, e;
        }($), ri = function (t) {
            function e(t, i, n) {
                switch (e.__super.call(this), void 0 === t && (t = .5), void 0 === i && (i = 1.25),
                void 0 === n && (n = 1), this._radius = t, this._length = i, this._orientation = n,
                this._type = 3, n) {
                    case 0:
                        this._nativeShape = new W._physics3D.btCapsuleShapeX(t, i - 2 * t);
                        break;

                    case 1:
                        this._nativeShape = new W._physics3D.btCapsuleShape(t, i - 2 * t);
                        break;

                    case 2:
                        this._nativeShape = new W._physics3D.btCapsuleShapeZ(t, i - 2 * t);
                        break;

                    default:
                        throw "CapsuleColliderShape:unknown orientation.";
                }
            }
            r(e, "laya.d3.physics.shape.CapsuleColliderShape", t);
            var i = e.prototype;
            return i._setScale = function (i) {
                var n = e._tempVector30;
                switch (this.orientation) {
                    case 0:
                        n.x = i.x, n.y = n.z = Math.max(i.y, i.z);
                        break;

                    case 1:
                        n.y = i.y, n.x = n.z = Math.max(i.x, i.z);
                        break;

                    case 2:
                        n.z = i.z, n.x = n.y = Math.max(i.x, i.y);
                        break;

                    default:
                        throw "CapsuleColliderShape:unknown orientation.";
                }
                t.prototype._setScale.call(this, n);
            }, i.clone = function () {
                var t = new e(this._radius, this._length, this._orientation);
                return this.cloneTo(t), t;
            }, a(0, i, "radius", function () {
                return this._radius;
            }), a(0, i, "length", function () {
                return this._length;
            }), a(0, i, "orientation", function () {
                return this._orientation;
            }), n(e, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }]), e;
        }(j), ai = function (t) {
            function e(t) {
                this._mesh = null, this._boneIndicesList = null, this._subIndexBufferStart = null,
                    this._subIndexBufferCount = null, this._skinAnimationDatas = null, this._indexInMesh = 0,
                    this._vertexStart = 0, this._indexStart = 0, this._indexCount = 0, this._indices = null,
                    this._vertexBuffer = null, this._indexBuffer = null, this._id = 0, e.__super.call(this),
                    this._id = ++e._uniqueIDCounter, this._mesh = t, this._boneIndicesList = [], this._subIndexBufferStart = [],
                    this._subIndexBufferCount = [];
            }
            r(e, "laya.d3.resource.models.SubMesh", t);
            var i = e.prototype;
            return i._getType = function () {
                return e._type;
            }, i._render = function (t) {
                this._mesh._bufferState.bind();
                var e = t.renderElement.render._skinnedData;
                if (e) for (var i = e[this._indexInMesh], n = this._boneIndicesList.length, r = 0; r < n; r++) t.shader.uploadCustomUniform(xn.BONES, i[r]),
                    v.instance.drawElements(4, this._subIndexBufferCount[r], 5123, 2 * this._subIndexBufferStart[r]); else v.instance.drawElements(4, this._indexCount, 5123, 2 * this._indexStart);
                O.trianglesFaces += this._indexCount / 3, O.renderBatches++;
            }, i.getIndices = function () {
                return this._indices;
            }, i.destroy = function () {
                this._destroyed || (t.prototype.destroy.call(this), this._indexBuffer.destroy(),
                    this._indexBuffer = null, this._mesh = null, this._boneIndicesList = null, this._subIndexBufferStart = null,
                    this._subIndexBufferCount = null, this._skinAnimationDatas = null);
            }, e._uniqueIDCounter = 0, n(e, ["_type", function () {
                return this._type = et._typeCounter++;
            }]), e;
        }(et), si = function (t) {
            function e(t) {
                e.__super.call(this), this._tempRotationMatrix = new ze(), this._uvLength = new yt(),
                    this._bufferState = new Je(), this._firstActiveElement = 0, this._firstNewElement = 0,
                    this._firstFreeElement = 0, this._firstRetiredElement = 0, this._owner = t, this._ownerRender = t.particleRenderer,
                    this._boundingBoxCorners = s(8, null), this._boundingSphere = new wt(new gt(), Number.MAX_VALUE),
                    this._boundingBox = new Ue(new gt(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE), new gt(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)),
                    this._currentTime = 0, this._isEmitting = !1, this._isPlaying = !1, this._isPaused = !1,
                    this._burstsIndex = 0, this._frameRateTime = 0, this._emissionTime = 0, this._totalDelayTime = 0,
                    this._simulateUpdate = !1, this._bufferMaxParticles = 1, this.duration = 5, this.looping = !0,
                    this.prewarm = !1, this.startDelayType = 0, this.startDelay = 0, this.startDelayMin = 0,
                    this.startDelayMax = 0, this._startLifetimeType = 0, this._startLifetimeConstant = 5,
                    this._startLifeTimeGradient = new jt(), this._startLifetimeConstantMin = 0, this._startLifetimeConstantMax = 5,
                    this._startLifeTimeGradientMin = new jt(), this._startLifeTimeGradientMax = new jt(),
                    this._maxStartLifetime = 5, this.startSpeedType = 0, this.startSpeedConstant = 5,
                    this.startSpeedConstantMin = 0, this.startSpeedConstantMax = 5, this.threeDStartSize = !1,
                    this.startSizeType = 0, this.startSizeConstant = 1, this.startSizeConstantSeparate = new gt(1, 1, 1),
                    this.startSizeConstantMin = 0, this.startSizeConstantMax = 1, this.startSizeConstantMinSeparate = new gt(0, 0, 0),
                    this.startSizeConstantMaxSeparate = new gt(1, 1, 1), this.threeDStartRotation = !1,
                    this.startRotationType = 0, this.startRotationConstant = 0, this.startRotationConstantSeparate = new gt(0, 0, 0),
                    this.startRotationConstantMin = 0, this.startRotationConstantMax = 0, this.startRotationConstantMinSeparate = new gt(0, 0, 0),
                    this.startRotationConstantMaxSeparate = new gt(0, 0, 0), this.randomizeRotationDirection = 0,
                    this.startColorType = 0, this.startColorConstant = new pt(1, 1, 1, 1), this.startColorConstantMin = new pt(1, 1, 1, 1),
                    this.startColorConstantMax = new pt(1, 1, 1, 1), this.gravityModifier = 0, this.simulationSpace = 1,
                    this.scaleMode = 0, this.playOnAwake = !0, this._rand = new Pt(0), this.autoRandomSeed = !0,
                    this.randomSeed = new Uint32Array(1), this._randomSeeds = new Uint32Array(e._RANDOMOFFSET.length),
                    this.isPerformanceMode = !0, this._emission = new It(), this._emission.enbale = !0;
            }
            r(e, "laya.d3.core.particleShuriKen.ShurikenParticleSystem", t);
            var o = e.prototype;
            return i.imps(o, {
                "laya.d3.core.IClone": !0
            }), o._getVertexBuffer = function (t) {
                return void 0 === t && (t = 0), 0 === t ? this._vertexBuffer : null;
            }, o._getIndexBuffer = function () {
                return this._indexBuffer;
            }, o._generateBoundingSphere = function () {
                var t = this._boundingSphere.center;
                t.x = 0, t.y = 0, t.z = 0, this._boundingSphere.radius = Number.MAX_VALUE;
            }, o._generateBoundingBox = function () {
                var t = this._owner.particleRenderer, i = this._boundingBox.min, n = this._boundingBox.max, r = 0, a = 0, s = NaN;
                switch (this.startLifetimeType) {
                    case 0:
                        s = this.startLifetimeConstant;
                        break;

                    case 1:
                        s = -Number.MAX_VALUE;
                        var o = o;
                        for (r = 0, a = o.gradientCount; r < a; r++) s = Math.max(s, o.getValueByIndex(r));
                        break;

                    case 2:
                        s = Math.max(this.startLifetimeConstantMin, this.startLifetimeConstantMax);
                        break;

                    case 3:
                        s = -Number.MAX_VALUE;
                        var l = l;
                        for (r = 0, a = l.gradientCount; r < a; r++) s = Math.max(s, l.getValueByIndex(r));
                        var h = h;
                        for (r = 0, a = h.gradientCount; r < a; r++) s = Math.max(s, h.getValueByIndex(r));
                }
                var u, c, d, _, f = NaN, p = NaN;
                switch (this.startSpeedType) {
                    case 0:
                        f = p = this.startSpeedConstant;
                        break;

                    case 1:
                        break;

                    case 2:
                        f = this.startLifetimeConstantMin, p = this.startLifetimeConstantMax;
                }
                this._shape && this._shape.enable || (u = c = gt._ZERO, d = gt._ZERO, _ = gt._UnitZ);
                var m, g, y = new gt(d.x * f, d.y * f, d.z * f), v = new gt(_.x * p, _.y * p, _.z * p);
                if (this._velocityOverLifetime && this._velocityOverLifetime.enbale) {
                    var S = this._velocityOverLifetime.velocity;
                    switch (S.type) {
                        case 0:
                            S.constant;
                            break;

                        case 1:
                            new gt(S.gradientX.getAverageValue(), S.gradientY.getAverageValue(), S.gradientZ.getAverageValue());
                            break;

                        case 2:
                            S.constantMin, S.constantMax;
                            break;

                        case 3:
                            new gt(S.gradientXMin.getAverageValue(), S.gradientYMin.getAverageValue(), S.gradientZMin.getAverageValue()),
                                new gt(S.gradientXMax.getAverageValue(), S.gradientYMax.getAverageValue(), S.gradientZMax.getAverageValue());
                    }
                }
                var T, E, C = this._owner.transform, x = C.position, b = e._tempVector39, I = t.renderMode;
                switch (this.scaleMode) {
                    case 0:
                        var w = C.scale;
                        m = w, b.x = w.x, b.y = w.z, b.z = w.y, 1 === I && (g = w);
                        break;

                    case 1:
                        var A = C.localScale;
                        m = A, b.x = A.x, b.y = A.z, b.z = A.y, 1 === I && (g = A);
                        break;

                    case 2:
                        m = C.scale, b.x = b.y = b.z = 1, 1 === I && (g = gt._ONE);
                }
                switch (this._velocityOverLifetime && this._velocityOverLifetime.enbale || (T = new gt(y.x * s, y.y * s, y.z * s),
                    E = new gt(v.x * s, v.y * s, v.z * s), 2 != this.scaleMode ? (gt.add(u, T, i), gt.multiply(m, i, i),
                        gt.add(c, E, n), gt.multiply(m, n, n)) : (gt.multiply(m, u, i), gt.add(i, T, i),
                            gt.multiply(m, c, n), gt.add(n, E, n))), this.simulationSpace) {
                    case 0:
                        break;

                    case 1:
                        gt.add(i, x, i), gt.add(n, x, n);
                }
                var R = NaN, M = NaN;
                switch (this.startSizeType) {
                    case 0:
                        if (this.threeDStartSize) {
                            var D = D;
                            R = Math.max(D.x, D.y), 1 === I && (M = D.y);
                        } else R = this.startSizeConstant, 1 === I && (M = this.startSizeConstant);
                        break;

                    case 1:
                        break;

                    case 2:
                        if (this.threeDStartSize) {
                            var O = O;
                            R = Math.max(O.x, O.y), 1 === I && (M = O.y);
                        } else R = this.startSizeConstantMax, 1 === I && (M = this.startSizeConstantMax);
                }
                if (this._sizeOverLifetime && this._sizeOverLifetime.enbale) {
                    this._sizeOverLifetime.size;
                    R *= this._sizeOverLifetime.size.getMaxSizeInGradient();
                }
                var L = e._tempVector30, P = NaN, N = NaN;
                switch (I) {
                    case 0:
                        P = R * e.halfKSqrtOf2, gt.scale(b, R, L), gt.subtract(i, L, i), gt.add(n, L, n);
                        break;

                    case 1:
                        var B = e._tempVector31, F = e._tempVector32, k = e._tempVector33, V = e._tempVector34;
                        this._velocityOverLifetime && this._velocityOverLifetime.enbale || (gt.multiply(g, v, F),
                            gt.multiply(g, y, k));
                        var U = M * t.stretchedBillboardLengthScale, G = gt.scalarLength(F) * t.stretchedBillboardSpeedScale + U, z = gt.scalarLength(k) * t.stretchedBillboardSpeedScale + U, H = e._tempVector35, j = e._tempVector36;
                        gt.normalize(F, H), gt.scale(H, G, V), gt.subtract(E, V, V), gt.normalize(k, j),
                            gt.scale(j, z, B), gt.add(T, B, B), P = R * e.halfKSqrtOf2, gt.scale(b, P, L);
                        var W = e._tempVector37, X = e._tempVector38;
                        gt.scale(H, .5, W), gt.scale(j, .5, X), gt.multiply(W, b, W), gt.multiply(X, b, X),
                            gt.add(i, X, i), gt.min(i, V, i), gt.subtract(i, L, i), gt.subtract(n, W, n), gt.max(n, B, n),
                            gt.add(n, L, n);
                        break;

                    case 2:
                        N = .5 * (R *= Math.cos(.7853981633974483)), L.x = b.x * N, L.y = b.z * N, gt.subtract(i, L, i),
                            gt.add(n, L, n);
                        break;

                    case 3:
                        N = .5 * (R *= Math.cos(.7853981633974483)), gt.scale(b, N, L), gt.subtract(i, L, i),
                            gt.add(n, L, n);
                }
                this._boundingBox.getCorners(this._boundingBoxCorners);
            }, o._updateEmission = function () {
                if (this.isAlive) if (this._simulateUpdate) this._simulateUpdate = !1; else {
                    var t = this._startUpdateLoopCount === O.loopCount || this._isPaused ? 0 : this._owner._scene.timer._delta / 1e3;
                    t = Math.min(e._maxElapsedTime, t), this._updateParticles(t);
                }
            }, o._updateParticles = function (t) {
                (4 !== this._ownerRender.renderMode || this._ownerRender.mesh) && (this._currentTime += t,
                    this._retireActiveParticles(), this._freeRetiredParticles(), this._totalDelayTime += t,
                    this._totalDelayTime < this._playStartDelay || this._emission.enbale && this._isEmitting && !this._isPaused && this._advanceTime(t, this._currentTime));
            }, o._updateParticlesSimulationRestart = function (t) {
                this._firstActiveElement = 0, this._firstNewElement = 0, this._firstFreeElement = 0,
                    this._firstRetiredElement = 0, this._burstsIndex = 0, this._frameRateTime = t, this._emissionTime = 0,
                    this._totalDelayTime = 0, this._currentTime = t;
                var e = t;
                e < this._playStartDelay ? this._totalDelayTime = e : this._emission.enbale && this._advanceTime(t, t);
            }, o._retireActiveParticles = function () {
                for (; this._firstActiveElement != this._firstNewElement;) {
                    var t = this._firstActiveElement * this._floatCountPerVertex * this._vertexStride, e = t + this._timeIndex;
                    if (this._currentTime - this._vertices[e] + 1e-4 < this._vertices[t + this._startLifeTimeIndex]) break;
                    this._vertices[e] = this._drawCounter, this._firstActiveElement++, this._firstActiveElement >= this._bufferMaxParticles && (this._firstActiveElement = 0);
                }
            }, o._freeRetiredParticles = function () {
                for (; this._firstRetiredElement != this._firstActiveElement;) {
                    var t = this._drawCounter - this._vertices[this._firstRetiredElement * this._floatCountPerVertex * this._vertexStride + this._timeIndex];
                    if (this.isPerformanceMode && t < 3) break;
                    this._firstRetiredElement++, this._firstRetiredElement >= this._bufferMaxParticles && (this._firstRetiredElement = 0);
                }
            }, o._burst = function (t, e) {
                for (var i = 0, n = this._emission._bursts, r = n.length; this._burstsIndex < r; this._burstsIndex++) {
                    var a = n[this._burstsIndex], s = a.time;
                    if (!(t <= s && s < e)) break;
                    var o = 0;
                    this.autoRandomSeed ? o = C.lerp(a.minCount, a.maxCount, Math.random()) : (this._rand.seed = this._randomSeeds[0],
                        o = C.lerp(a.minCount, a.maxCount, this._rand.getFloat()), this._randomSeeds[0] = this._rand.seed),
                        i += o;
                }
                return i;
            }, o._advanceTime = function (t, e) {
                var i = 0, n = this._emissionTime;
                this._emissionTime += t;
                var r = 0;
                if (this._emissionTime > this.duration) {
                    if (!this.looping) {
                        for (r = Math.min(this.maxParticles - this.aliveParticleCount, r), i = 0; i < r; i++) this.emit(e);
                        return this._isPlaying = !1, void this.stop();
                    }
                    r += this._burst(n, this._emissionTime), this._emissionTime -= this.duration, this._burstsIndex = 0,
                        r += this._burst(0, this._emissionTime);
                } else r += this._burst(n, this._emissionTime);
                for (r = Math.min(this.maxParticles - this.aliveParticleCount, r), i = 0; i < r; i++) this.emit(e);
                var a = this.emission.emissionRate;
                if (a > 0) {
                    var s = 1 / a;
                    for (this._frameRateTime += s, this._frameRateTime = this._currentTime - (this._currentTime - this._frameRateTime) % this._maxStartLifetime; this._frameRateTime <= e && this.emit(this._frameRateTime);) this._frameRateTime += s;
                    this._frameRateTime = Math.floor(e / s) * s;
                }
            }, o._initBufferDatas = function () {
                this._vertexBuffer && (this._vertexBuffer.destroy(), this._indexBuffer.destroy());
                var t = this._ownerRender, e = t.renderMode;
                if (-1 !== e && this.maxParticles > 0) {
                    var i, n, r = 0, a = 0, s = 0, o = 0, l = 0, h = 0, u = 0, c = t.mesh;
                    if (4 === e) {
                        if (c) {
                            if (c._vertexBuffers.length > 1) throw new Error("ShurikenParticleSystem: submesh Count mesh be One or all subMeshes have the same vertexDeclaration.");
                            n = Ni.vertexDeclaration, this._floatCountPerVertex = n.vertexStride / 4, this._startLifeTimeIndex = 12,
                                this._timeIndex = 16, this._vertexStride = c._vertexBuffers[0].vertexCount;
                            var d = this._bufferMaxParticles * this._vertexStride, _ = d % 65535;
                            if (Math.floor(d / 65535) + 1 > 1) throw new Error("ShurikenParticleSystem:the maxParticleCount multiply mesh vertexCount is large than 65535.");
                            h = n.vertexStride * _, this._vertexBuffer = new Ke(h, 35048), this._vertexBuffer.vertexDeclaration = n,
                                this._vertices = new Float32Array(this._floatCountPerVertex * _), this._indexStride = c._indexBuffer.indexCount;
                            var f = c._indexBuffer.getData(), p = this._bufferMaxParticles * this._indexStride;
                            for (this._indexBuffer = new Ze("ushort", p, 35044), i = new Uint16Array(p), u = h + 2 * p,
                                o = 0, r = 0; r < this._bufferMaxParticles; r++) {
                                var m = r * this._vertexStride;
                                for (a = 0, s = f.length; a < s; a++) i[o++] = m + f[a];
                            }
                            this._indexBuffer.setData(i), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                                this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind();
                        }
                    } else {
                        for (n = Li.vertexDeclaration, this._floatCountPerVertex = n.vertexStride / 4, this._startLifeTimeIndex = 7,
                            this._timeIndex = 11, this._vertexStride = 4, h = n.vertexStride * this._bufferMaxParticles * this._vertexStride,
                            this._vertexBuffer = new Ke(h, 35048), this._vertexBuffer.vertexDeclaration = n,
                            this._vertices = new Float32Array(this._floatCountPerVertex * this._bufferMaxParticles * this._vertexStride),
                            r = 0; r < this._bufferMaxParticles; r++) l = r * this._floatCountPerVertex * this._vertexStride,
                                this._vertices[l] = -.5, this._vertices[l + 1] = -.5, this._vertices[l + 2] = 0,
                                this._vertices[l + 3] = 1, l += this._floatCountPerVertex, this._vertices[l] = .5,
                                this._vertices[l + 1] = -.5, this._vertices[l + 2] = 1, this._vertices[l + 3] = 1,
                                l += this._floatCountPerVertex, this._vertices[l] = .5, this._vertices[l + 1] = .5,
                                this._vertices[l + 2] = 1, this._vertices[l + 3] = 0, l += this._floatCountPerVertex,
                                this._vertices[l] = -.5, this._vertices[l + 1] = .5, this._vertices[l + 2] = 0,
                                this._vertices[l + 3] = 0;
                        for (this._indexStride = 6, this._indexBuffer = new Ze("ushort", 6 * this._bufferMaxParticles, 35044),
                            i = new Uint16Array(6 * this._bufferMaxParticles), r = 0; r < this._bufferMaxParticles; r++) {
                            o = 6 * r;
                            var g = r * this._vertexStride, y = g + 2;
                            i[o++] = g, i[o++] = y, i[o++] = g + 1, i[o++] = g, i[o++] = g + 3, i[o++] = y;
                        }
                        this._indexBuffer.setData(i), u = h + 6 * this._bufferMaxParticles * 2, this._bufferState.bind(),
                            this._bufferState.applyVertexBuffer(this._vertexBuffer), this._bufferState.applyIndexBuffer(this._indexBuffer),
                            this._bufferState.unBind();
                    }
                    w._addMemory(u, u);
                }
            }, o.destroy = function () {
                t.prototype.destroy.call(this);
                var e = this._vertexBuffer._byteLength + 2 * this._indexBuffer.indexCount;
                w._addMemory(-e, -e), this._bufferState.destroy(), this._vertexBuffer.destroy(),
                    this._indexBuffer.destroy(), this._emission.destroy(), this._bufferState = null,
                    this._vertexBuffer = null, this._indexBuffer = null, this._owner = null, this._vertices = null,
                    this._indexBuffer = null, this._emission = null, this._shape = null, this.startLifeTimeGradient = null,
                    this.startLifeTimeGradientMin = null, this.startLifeTimeGradientMax = null, this.startSizeConstantSeparate = null,
                    this.startSizeConstantMinSeparate = null, this.startSizeConstantMaxSeparate = null,
                    this.startRotationConstantSeparate = null, this.startRotationConstantMinSeparate = null,
                    this.startRotationConstantMaxSeparate = null, this.startColorConstant = null, this.startColorConstantMin = null,
                    this.startColorConstantMax = null, this._velocityOverLifetime = null, this._colorOverLifetime = null,
                    this._sizeOverLifetime = null, this._rotationOverLifetime = null, this._textureSheetAnimation = null;
            }, o.emit = function (t) {
                var i = e._tempPosition, n = e._tempDirection;
                return this._shape && this._shape.enable ? this.autoRandomSeed ? this._shape.generatePositionAndDirection(i, n) : this._shape.generatePositionAndDirection(i, n, this._rand, this._randomSeeds) : (i.x = i.y = i.z = 0,
                    n.x = n.y = 0, n.z = 1), this.addParticle(i, n, t);
            }, o.addParticle = function (t, e, i) {
                gt.normalize(e, e);
                var n = this._firstFreeElement + 1;
                if (n >= this._bufferMaxParticles && (n = 0), n === this._firstRetiredElement) return !1;
                if (qt.create(this, this._ownerRender, this._owner.transform), this._currentTime - i >= qt.startLifeTime) return !0;
                var r = NaN, a = NaN, s = NaN, o = NaN, l = NaN, h = NaN, u = NaN, c = this._velocityOverLifetime && this._velocityOverLifetime.enbale;
                if (c) {
                    var d = this._velocityOverLifetime.velocity.type;
                    2 === d || 3 === d ? this.autoRandomSeed ? (r = Math.random(), a = Math.random(),
                        s = Math.random()) : (this._rand.seed = this._randomSeeds[9], r = this._rand.getFloat(),
                            a = this._rand.getFloat(), s = this._rand.getFloat(), this._randomSeeds[9] = this._rand.seed) : c = !1;
                } else c = !1;
                var _ = this._colorOverLifetime && this._colorOverLifetime.enbale;
                _ ? 3 === this._colorOverLifetime.color.type ? this.autoRandomSeed ? o = Math.random() : (this._rand.seed = this._randomSeeds[10],
                    o = this._rand.getFloat(), this._randomSeeds[10] = this._rand.seed) : _ = !1 : _ = !1;
                var f = this._sizeOverLifetime && this._sizeOverLifetime.enbale;
                f ? 3 === this._sizeOverLifetime.size.type ? this.autoRandomSeed ? l = Math.random() : (this._rand.seed = this._randomSeeds[11],
                    l = this._rand.getFloat(), this._randomSeeds[11] = this._rand.seed) : f = !1 : f = !1;
                var p = this._rotationOverLifetime && this._rotationOverLifetime.enbale;
                if (p) {
                    var m = this._rotationOverLifetime.angularVelocity.type;
                    2 === m || 3 === m ? this.autoRandomSeed ? h = Math.random() : (this._rand.seed = this._randomSeeds[12],
                        h = this._rand.getFloat(), this._randomSeeds[12] = this._rand.seed) : p = !1;
                } else p = !1;
                var g = this._textureSheetAnimation && this._textureSheetAnimation.enable;
                g ? 3 === this._textureSheetAnimation.frame.type ? this.autoRandomSeed ? u = Math.random() : (this._rand.seed = this._randomSeeds[15],
                    u = this._rand.getFloat(), this._randomSeeds[15] = this._rand.seed) : g = !1 : g = !1;
                var y, v = this._firstFreeElement * this._floatCountPerVertex * this._vertexStride, S = qt.startUVInfo[0], T = qt.startUVInfo[1], E = qt.startUVInfo[2], C = qt.startUVInfo[3], x = 0, b = 0, I = 0, w = 0, A = 0, R = this._ownerRender;
                if (4 === R.renderMode) {
                    var M = R.mesh._vertexBuffers[0];
                    y = M.getData();
                    var D = M.vertexDeclaration;
                    b = D.getVertexElementByUsage(0).offset / 4;
                    var O = D.getVertexElementByUsage(1);
                    I = O ? O.offset / 4 : -1;
                    var L = D.getVertexElementByUsage(2);
                    w = L ? L.offset / 4 : -1, x = D.vertexStride / 4, A = 0;
                } else {
                    this._vertices[v + 2] = E, this._vertices[v + 3] = C + T;
                    var P = v + this._floatCountPerVertex;
                    this._vertices[P + 2] = E + S, this._vertices[P + 3] = C + T;
                    var N = P + this._floatCountPerVertex;
                    this._vertices[N + 2] = E + S, this._vertices[N + 3] = C;
                    var B = N + this._floatCountPerVertex;
                    this._vertices[B + 2] = E, this._vertices[B + 3] = C;
                }
                for (var F = v, k = v + this._floatCountPerVertex * this._vertexStride; F < k; F += this._floatCountPerVertex) {
                    var V = 0;
                    if (4 === R.renderMode) {
                        V = F;
                        var U = x * A++, G = U + b;
                        this._vertices[V++] = y[G++], this._vertices[V++] = y[G++], this._vertices[V++] = y[G],
                            -1 === I ? (this._vertices[V++] = 1, this._vertices[V++] = 1, this._vertices[V++] = 1,
                                this._vertices[V++] = 1) : (G = U + I, this._vertices[V++] = y[G++], this._vertices[V++] = y[G++],
                                    this._vertices[V++] = y[G++], this._vertices[V++] = y[G]), -1 === w ? (this._vertices[V++] = 0,
                                        this._vertices[V++] = 0) : (G = U + w, this._vertices[V++] = E + y[G++] * S, this._vertices[V++] = C + y[G] * T);
                    } else V = F + 4;
                    switch (this._vertices[V++] = t.x, this._vertices[V++] = t.y, this._vertices[V++] = t.z,
                    this._vertices[V++] = qt.startLifeTime, this._vertices[V++] = e.x, this._vertices[V++] = e.y,
                    this._vertices[V++] = e.z, this._vertices[V++] = i, this._vertices[V++] = qt.startColor.x,
                    this._vertices[V++] = qt.startColor.y, this._vertices[V++] = qt.startColor.z, this._vertices[V++] = qt.startColor.w,
                    this._vertices[V++] = qt.startSize[0], this._vertices[V++] = qt.startSize[1], this._vertices[V++] = qt.startSize[2],
                    this._vertices[V++] = qt.startRotation[0], this._vertices[V++] = qt.startRotation[1],
                    this._vertices[V++] = qt.startRotation[2], this._vertices[V++] = qt.startSpeed,
                    _ && (this._vertices[V + 1] = o), f && (this._vertices[V + 2] = l), p && (this._vertices[V + 3] = h),
                    g && (this._vertices[V + 4] = u), c && (this._vertices[V + 5] = r, this._vertices[V + 6] = a,
                        this._vertices[V + 7] = s), this.simulationSpace) {
                        case 0:
                            V += 8, this._vertices[V++] = qt.simulationWorldPostion[0], this._vertices[V++] = qt.simulationWorldPostion[1],
                                this._vertices[V++] = qt.simulationWorldPostion[2], this._vertices[V++] = qt.simulationWorldRotation[0],
                                this._vertices[V++] = qt.simulationWorldRotation[1], this._vertices[V++] = qt.simulationWorldRotation[2],
                                this._vertices[V++] = qt.simulationWorldRotation[3];
                            break;

                        case 1:
                            break;

                        default:
                            throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.");
                    }
                }
                return this._firstFreeElement = n, !0;
            }, o.addNewParticlesToVertexBuffer = function () {
                var t = 0;
                this._firstNewElement < this._firstFreeElement ? (t = this._firstNewElement * this._vertexStride * this._floatCountPerVertex,
                    this._vertexBuffer.setData(this._vertices, t, t, (this._firstFreeElement - this._firstNewElement) * this._vertexStride * this._floatCountPerVertex)) : (t = this._firstNewElement * this._vertexStride * this._floatCountPerVertex,
                        this._vertexBuffer.setData(this._vertices, t, t, (this._bufferMaxParticles - this._firstNewElement) * this._vertexStride * this._floatCountPerVertex),
                        this._firstFreeElement > 0 && this._vertexBuffer.setData(this._vertices, 0, 0, this._firstFreeElement * this._vertexStride * this._floatCountPerVertex)),
                    this._firstNewElement = this._firstFreeElement;
            }, o._getType = function () {
                return e._type;
            }, o._prepareRender = function (t) {
                return this._updateEmission(), this._firstNewElement != this._firstFreeElement && this.addNewParticlesToVertexBuffer(),
                    this._drawCounter++, this._firstActiveElement != this._firstFreeElement;
            }, o._render = function (t) {
                this._bufferState.bind();
                var e = 0, i = v.instance;
                this._firstActiveElement < this._firstFreeElement ? (e = (this._firstFreeElement - this._firstActiveElement) * this._indexStride,
                    i.drawElements(4, e, 5123, 2 * this._firstActiveElement * this._indexStride), O.trianglesFaces += e / 3,
                    O.renderBatches++) : (e = (this._bufferMaxParticles - this._firstActiveElement) * this._indexStride,
                        i.drawElements(4, e, 5123, 2 * this._firstActiveElement * this._indexStride), O.trianglesFaces += e / 3,
                        O.renderBatches++, this._firstFreeElement > 0 && (e = this._firstFreeElement * this._indexStride,
                            i.drawElements(4, e, 5123, 0), O.trianglesFaces += e / 3, O.renderBatches++));
            }, o.play = function () {
                if (this._burstsIndex = 0, this._isEmitting = !0, this._isPlaying = !0, this._isPaused = !1,
                    this._emissionTime = 0, this._totalDelayTime = 0, !this.autoRandomSeed) for (var t = 0, i = this._randomSeeds.length; t < i; t++) this._randomSeeds[t] = this.randomSeed[0] + e._RANDOMOFFSET[t];
                switch (this.startDelayType) {
                    case 0:
                        this._playStartDelay = this.startDelay;
                        break;

                    case 1:
                        this.autoRandomSeed ? this._playStartDelay = C.lerp(this.startDelayMin, this.startDelayMax, Math.random()) : (this._rand.seed = this._randomSeeds[2],
                            this._playStartDelay = C.lerp(this.startDelayMin, this.startDelayMax, this._rand.getFloat()),
                            this._randomSeeds[2] = this._rand.seed);
                        break;

                    default:
                        throw new Error("Utils3D: startDelayType is invalid.");
                }
                this._frameRateTime = this._currentTime + this._playStartDelay, this._startUpdateLoopCount = O.loopCount;
            }, o.pause = function () {
                this._isPaused = !0;
            }, o.simulate = function (t, e) {
                void 0 === e && (e = !0), this._simulateUpdate = !0, e ? this._updateParticlesSimulationRestart(t) : (this._isPaused = !1,
                    this._updateParticles(t)), this.pause();
            }, o.stop = function () {
                this._burstsIndex = 0, this._isEmitting = !1, this._emissionTime = 0;
            }, o.cloneTo = function (t) {
                var e = t;
                e.duration = this.duration, e.looping = this.looping, e.prewarm = this.prewarm,
                    e.startDelayType = this.startDelayType, e.startDelay = this.startDelay, e.startDelayMin = this.startDelayMin,
                    e.startDelayMax = this.startDelayMax, e._maxStartLifetime = this._maxStartLifetime,
                    e.startLifetimeType = this.startLifetimeType, e.startLifetimeConstant = this.startLifetimeConstant,
                    this.startLifeTimeGradient.cloneTo(e.startLifeTimeGradient), e.startLifetimeConstantMin = this.startLifetimeConstantMin,
                    e.startLifetimeConstantMax = this.startLifetimeConstantMax, this.startLifeTimeGradientMin.cloneTo(e.startLifeTimeGradientMin),
                    this.startLifeTimeGradientMax.cloneTo(e.startLifeTimeGradientMax), e.startSpeedType = this.startSpeedType,
                    e.startSpeedConstant = this.startSpeedConstant, e.startSpeedConstantMin = this.startSpeedConstantMin,
                    e.startSpeedConstantMax = this.startSpeedConstantMax, e.threeDStartSize = this.threeDStartSize,
                    e.startSizeType = this.startSizeType, e.startSizeConstant = this.startSizeConstant,
                    this.startSizeConstantSeparate.cloneTo(e.startSizeConstantSeparate), e.startSizeConstantMin = this.startSizeConstantMin,
                    e.startSizeConstantMax = this.startSizeConstantMax, this.startSizeConstantMinSeparate.cloneTo(e.startSizeConstantMinSeparate),
                    this.startSizeConstantMaxSeparate.cloneTo(e.startSizeConstantMaxSeparate), e.threeDStartRotation = this.threeDStartRotation,
                    e.startRotationType = this.startRotationType, e.startRotationConstant = this.startRotationConstant,
                    this.startRotationConstantSeparate.cloneTo(e.startRotationConstantSeparate), e.startRotationConstantMin = this.startRotationConstantMin,
                    e.startRotationConstantMax = this.startRotationConstantMax, this.startRotationConstantMinSeparate.cloneTo(e.startRotationConstantMinSeparate),
                    this.startRotationConstantMaxSeparate.cloneTo(e.startRotationConstantMaxSeparate),
                    e.randomizeRotationDirection = this.randomizeRotationDirection, e.startColorType = this.startColorType,
                    this.startColorConstant.cloneTo(e.startColorConstant), this.startColorConstantMin.cloneTo(e.startColorConstantMin),
                    this.startColorConstantMax.cloneTo(e.startColorConstantMax), e.gravityModifier = this.gravityModifier,
                    e.simulationSpace = this.simulationSpace, e.scaleMode = this.scaleMode, e.playOnAwake = this.playOnAwake,
                    e.maxParticles = this.maxParticles, this._emission && (e._emission = this._emission.clone()),
                    this.shape && (e.shape = this.shape.clone()), this.velocityOverLifetime && (e.velocityOverLifetime = this.velocityOverLifetime.clone()),
                    this.colorOverLifetime && (e.colorOverLifetime = this.colorOverLifetime.clone()),
                    this.sizeOverLifetime && (e.sizeOverLifetime = this.sizeOverLifetime.clone()), this.rotationOverLifetime && (e.rotationOverLifetime = this.rotationOverLifetime.clone()),
                    this.textureSheetAnimation && (e.textureSheetAnimation = this.textureSheetAnimation.clone()),
                    e.isPerformanceMode = this.isPerformanceMode, e._isEmitting = this._isEmitting,
                    e._isPlaying = this._isPlaying, e._isPaused = this._isPaused, e._playStartDelay = this._playStartDelay,
                    e._frameRateTime = this._frameRateTime, e._emissionTime = this._emissionTime, e._totalDelayTime = this._totalDelayTime,
                    e._burstsIndex = this._burstsIndex;
            }, o.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, o, "maxParticles", function () {
                return this._bufferMaxParticles - 1;
            }, function (t) {
                var e = t + 1;
                e !== this._bufferMaxParticles && (this._bufferMaxParticles = e, this._initBufferDatas());
            }), a(0, o, "isEmitting", function () {
                return this._isEmitting;
            }), a(0, o, "isAlive", function () {
                return !!(this._isPlaying || this.aliveParticleCount > 0);
            }), a(0, o, "shape", function () {
                return this._shape;
            }, function (t) {
                this._shape !== t && (t && t.enable ? this._owner._render._defineDatas.add(En.SHADERDEFINE_SHAPE) : this._owner._render._defineDatas.remove(En.SHADERDEFINE_SHAPE),
                    this._shape = t);
            }), a(0, o, "rotationOverLifetime", function () {
                return this._rotationOverLifetime;
            }, function (t) {
                var e = this._owner._render._defineDatas, i = this._owner._render._shaderValues;
                if (t) {
                    var n = t.angularVelocity;
                    if (!n) return;
                    var r = n.separateAxes, a = n.type;
                    if (t.enbale) switch (r ? e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE) : e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIME),
                        a) {
                            case 0:
                                e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT);
                                break;

                            case 1:
                                e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE);
                                break;

                            case 2:
                                e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS);
                                break;

                            case 3:
                                e.add(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);
                        } else e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIME), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE),
                            e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE),
                            e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES);
                    switch (a) {
                        case 0:
                            r ? i.setVector3(En.ROLANGULARVELOCITYCONSTSEPRARATE, n.constantSeparate) : i.setNumber(En.ROLANGULARVELOCITYCONST, n.constant);
                            break;

                        case 1:
                            r ? (i.setBuffer(En.ROLANGULARVELOCITYGRADIENTX, n.gradientX._elements), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTY, n.gradientY._elements),
                                i.setBuffer(En.ROLANGULARVELOCITYGRADIENTZ, n.gradientZ._elements)) : i.setBuffer(En.ROLANGULARVELOCITYGRADIENT, n.gradient._elements);
                            break;

                        case 2:
                            r ? (i.setVector3(En.ROLANGULARVELOCITYCONSTSEPRARATE, n.constantMinSeparate), i.setVector3(En.ROLANGULARVELOCITYCONSTMAXSEPRARATE, n.constantMaxSeparate)) : (i.setNumber(En.ROLANGULARVELOCITYCONST, n.constantMin),
                                i.setNumber(En.ROLANGULARVELOCITYCONSTMAX, n.constantMax));
                            break;

                        case 3:
                            r ? (i.setBuffer(En.ROLANGULARVELOCITYGRADIENTX, n.gradientXMin._elements), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTXMAX, n.gradientXMax._elements),
                                i.setBuffer(En.ROLANGULARVELOCITYGRADIENTY, n.gradientYMin._elements), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTYMAX, n.gradientYMax._elements),
                                i.setBuffer(En.ROLANGULARVELOCITYGRADIENTZ, n.gradientZMin._elements), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTZMAX, n.gradientZMax._elements)) : (i.setBuffer(En.ROLANGULARVELOCITYGRADIENT, n.gradientMin._elements),
                                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTMAX, n.gradientMax._elements));
                    }
                } else e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIME), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE),
                    e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE),
                    e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS), e.remove(En.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES),
                    i.setVector(En.ROLANGULARVELOCITYCONSTSEPRARATE, null), i.setVector(En.ROLANGULARVELOCITYCONSTMAXSEPRARATE, null),
                    i.setNumber(En.ROLANGULARVELOCITYCONST, void 0), i.setNumber(En.ROLANGULARVELOCITYCONSTMAX, void 0),
                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTX, null), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTXMAX, null),
                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTY, null), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTYMAX, null),
                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTZ, null), i.setBuffer(En.ROLANGULARVELOCITYGRADIENTZMAX, null),
                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTWMAX, null), i.setBuffer(En.ROLANGULARVELOCITYGRADIENT, null),
                    i.setBuffer(En.ROLANGULARVELOCITYGRADIENTMAX, null);
                this._rotationOverLifetime = t;
            }), a(0, o, "emission", function () {
                return this._emission;
            }), a(0, o, "emissionTime", function () {
                return this._emissionTime > this.duration ? this.duration : this._emissionTime;
            }), a(0, o, "aliveParticleCount", function () {
                return this._firstNewElement >= this._firstRetiredElement ? this._firstNewElement - this._firstRetiredElement : this._bufferMaxParticles - this._firstRetiredElement + this._firstNewElement;
            }), a(0, o, "isPlaying", function () {
                return this._isPlaying;
            }), a(0, o, "isPaused", function () {
                return this._isPaused;
            }), a(0, o, "startLifetimeType", function () {
                return this._startLifetimeType;
            }, function (t) {
                var e = 0, i = 0;
                switch (this.startLifetimeType) {
                    case 0:
                        this._maxStartLifetime = this.startLifetimeConstant;
                        break;

                    case 1:
                        this._maxStartLifetime = -Number.MAX_VALUE;
                        var n = n;
                        for (e = 0, i = n.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, n.getValueByIndex(e));
                        break;

                    case 2:
                        this._maxStartLifetime = Math.max(this.startLifetimeConstantMin, this.startLifetimeConstantMax);
                        break;

                    case 3:
                        this._maxStartLifetime = -Number.MAX_VALUE;
                        var r = r;
                        for (e = 0, i = r.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, r.getValueByIndex(e));
                        var a = a;
                        for (e = 0, i = a.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, a.getValueByIndex(e));
                }
                this._startLifetimeType = t;
            }), a(0, o, "startLifetimeConstant", function () {
                return this._startLifetimeConstant;
            }, function (t) {
                0 === this._startLifetimeType && (this._maxStartLifetime = t), this._startLifetimeConstant = t;
            }), a(0, o, "startLifetimeConstantMin", function () {
                return this._startLifetimeConstantMin;
            }, function (t) {
                2 === this._startLifetimeType && (this._maxStartLifetime = Math.max(t, this._startLifetimeConstantMax)),
                    this._startLifetimeConstantMin = t;
            }), a(0, o, "startLifeTimeGradient", function () {
                return this._startLifeTimeGradient;
            }, function (t) {
                if (1 === this._startLifetimeType) {
                    this._maxStartLifetime = -Number.MAX_VALUE;
                    for (var e = 0, i = t.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e));
                }
                this._startLifeTimeGradient = t;
            }), a(0, o, "startLifetimeConstantMax", function () {
                return this._startLifetimeConstantMax;
            }, function (t) {
                2 === this._startLifetimeType && (this._maxStartLifetime = Math.max(this._startLifetimeConstantMin, t)),
                    this._startLifetimeConstantMax = t;
            }), a(0, o, "startLifeTimeGradientMin", function () {
                return this._startLifeTimeGradientMin;
            }, function (t) {
                if (3 === this._startLifetimeType) {
                    var e = 0, i = 0;
                    for (this._maxStartLifetime = -Number.MAX_VALUE, e = 0, i = t.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e));
                    for (e = 0, i = this._startLifeTimeGradientMax.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, this._startLifeTimeGradientMax.getValueByIndex(e));
                }
                this._startLifeTimeGradientMin = t;
            }), a(0, o, "startLifeTimeGradientMax", function () {
                return this._startLifeTimeGradientMax;
            }, function (t) {
                if (3 === this._startLifetimeType) {
                    var e = 0, i = 0;
                    for (this._maxStartLifetime = -Number.MAX_VALUE, e = 0, i = this._startLifeTimeGradientMin.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, this._startLifeTimeGradientMin.getValueByIndex(e));
                    for (e = 0, i = t.gradientCount; e < i; e++) this._maxStartLifetime = Math.max(this._maxStartLifetime, t.getValueByIndex(e));
                }
                this._startLifeTimeGradientMax = t;
            }), a(0, o, "velocityOverLifetime", function () {
                return this._velocityOverLifetime;
            }, function (t) {
                var e = this._owner._render._defineDatas, i = this._owner._render._shaderValues;
                if (t) {
                    var n = t.velocity, r = n.type;
                    if (t.enbale) switch (r) {
                        case 0:
                            e.add(En.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT);
                            break;

                        case 1:
                            e.add(En.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE);
                            break;

                        case 2:
                            e.add(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT);
                            break;

                        case 3:
                            e.add(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);
                    } else e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT), e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE),
                        e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT), e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE);
                    switch (r) {
                        case 0:
                            i.setVector3(En.VOLVELOCITYCONST, n.constant);
                            break;

                        case 1:
                            i.setBuffer(En.VOLVELOCITYGRADIENTX, n.gradientX._elements), i.setBuffer(En.VOLVELOCITYGRADIENTY, n.gradientY._elements),
                                i.setBuffer(En.VOLVELOCITYGRADIENTZ, n.gradientZ._elements);
                            break;

                        case 2:
                            i.setVector3(En.VOLVELOCITYCONST, n.constantMin), i.setVector3(En.VOLVELOCITYCONSTMAX, n.constantMax);
                            break;

                        case 3:
                            i.setBuffer(En.VOLVELOCITYGRADIENTX, n.gradientXMin._elements), i.setBuffer(En.VOLVELOCITYGRADIENTXMAX, n.gradientXMax._elements),
                                i.setBuffer(En.VOLVELOCITYGRADIENTY, n.gradientYMin._elements), i.setBuffer(En.VOLVELOCITYGRADIENTYMAX, n.gradientYMax._elements),
                                i.setBuffer(En.VOLVELOCITYGRADIENTZ, n.gradientZMin._elements), i.setBuffer(En.VOLVELOCITYGRADIENTZMAX, n.gradientZMax._elements);
                    }
                    i.setInt(En.VOLSPACETYPE, t.space);
                } else e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT), e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE),
                    e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT), e.remove(En.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE),
                    i.setVector(En.VOLVELOCITYCONST, null), i.setBuffer(En.VOLVELOCITYGRADIENTX, null),
                    i.setBuffer(En.VOLVELOCITYGRADIENTY, null), i.setBuffer(En.VOLVELOCITYGRADIENTZ, null),
                    i.setVector(En.VOLVELOCITYCONST, null), i.setVector(En.VOLVELOCITYCONSTMAX, null),
                    i.setBuffer(En.VOLVELOCITYGRADIENTX, null), i.setBuffer(En.VOLVELOCITYGRADIENTXMAX, null),
                    i.setBuffer(En.VOLVELOCITYGRADIENTY, null), i.setBuffer(En.VOLVELOCITYGRADIENTYMAX, null),
                    i.setBuffer(En.VOLVELOCITYGRADIENTZ, null), i.setBuffer(En.VOLVELOCITYGRADIENTZMAX, null),
                    i.setInt(En.VOLSPACETYPE, void 0);
                this._velocityOverLifetime = t;
            }), a(0, o, "colorOverLifetime", function () {
                return this._colorOverLifetime;
            }, function (t) {
                var e = this._owner._render._defineDatas, i = this._owner._render._shaderValues;
                if (t) {
                    var n = t.color;
                    if (t.enbale) switch (n.type) {
                        case 1:
                            e.add(En.SHADERDEFINE_COLOROVERLIFETIME);
                            break;

                        case 3:
                            e.add(En.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);
                    } else e.remove(En.SHADERDEFINE_COLOROVERLIFETIME), e.remove(En.SHADERDEFINE_RANDOMCOLOROVERLIFETIME);
                    switch (n.type) {
                        case 1:
                            var r = n.gradient;
                            i.setBuffer(En.COLOROVERLIFEGRADIENTALPHAS, r._alphaElements), i.setBuffer(En.COLOROVERLIFEGRADIENTCOLORS, r._rgbElements);
                            break;

                        case 3:
                            var a = n.gradientMin, s = n.gradientMax;
                            i.setBuffer(En.COLOROVERLIFEGRADIENTALPHAS, a._alphaElements), i.setBuffer(En.COLOROVERLIFEGRADIENTCOLORS, a._rgbElements),
                                i.setBuffer(En.MAXCOLOROVERLIFEGRADIENTALPHAS, s._alphaElements), i.setBuffer(En.MAXCOLOROVERLIFEGRADIENTCOLORS, s._rgbElements);
                    }
                } else e.remove(En.SHADERDEFINE_COLOROVERLIFETIME), e.remove(En.SHADERDEFINE_RANDOMCOLOROVERLIFETIME),
                    i.setBuffer(En.COLOROVERLIFEGRADIENTALPHAS, r._alphaElements), i.setBuffer(En.COLOROVERLIFEGRADIENTCOLORS, r._rgbElements),
                    i.setBuffer(En.COLOROVERLIFEGRADIENTALPHAS, a._alphaElements), i.setBuffer(En.COLOROVERLIFEGRADIENTCOLORS, a._rgbElements),
                    i.setBuffer(En.MAXCOLOROVERLIFEGRADIENTALPHAS, s._alphaElements), i.setBuffer(En.MAXCOLOROVERLIFEGRADIENTCOLORS, s._rgbElements);
                this._colorOverLifetime = t;
            }), a(0, o, "sizeOverLifetime", function () {
                return this._sizeOverLifetime;
            }, function (t) {
                var e = this._owner._render._defineDatas, i = this._owner._render._shaderValues;
                if (t) {
                    var n = t.size, r = n.separateAxes, a = n.type;
                    if (t.enbale) switch (a) {
                        case 0:
                            r ? e.add(En.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE) : e.add(En.SHADERDEFINE_SIZEOVERLIFETIMECURVE);
                            break;

                        case 2:
                            r ? e.add(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE) : e.add(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES);
                    } else e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMECURVE), e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE),
                        e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES), e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE);
                    switch (a) {
                        case 0:
                            r ? (i.setBuffer(En.SOLSIZEGRADIENTX, n.gradientX._elements), i.setBuffer(En.SOLSIZEGRADIENTY, n.gradientY._elements),
                                i.setBuffer(En.SOLSizeGradientZ, n.gradientZ._elements)) : i.setBuffer(En.SOLSIZEGRADIENT, n.gradient._elements);
                            break;

                        case 2:
                            r ? (i.setBuffer(En.SOLSIZEGRADIENTX, n.gradientXMin._elements), i.setBuffer(En.SOLSIZEGRADIENTXMAX, n.gradientXMax._elements),
                                i.setBuffer(En.SOLSIZEGRADIENTY, n.gradientYMin._elements), i.setBuffer(En.SOLSIZEGRADIENTYMAX, n.gradientYMax._elements),
                                i.setBuffer(En.SOLSizeGradientZ, n.gradientZMin._elements), i.setBuffer(En.SOLSizeGradientZMAX, n.gradientZMax._elements)) : (i.setBuffer(En.SOLSIZEGRADIENT, n.gradientMin._elements),
                                    i.setBuffer(En.SOLSizeGradientMax, n.gradientMax._elements));
                    }
                } else e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMECURVE), e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE),
                    e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES), e.remove(En.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE),
                    i.setBuffer(En.SOLSIZEGRADIENTX, null), i.setBuffer(En.SOLSIZEGRADIENTXMAX, null),
                    i.setBuffer(En.SOLSIZEGRADIENTY, null), i.setBuffer(En.SOLSIZEGRADIENTYMAX, null),
                    i.setBuffer(En.SOLSizeGradientZ, null), i.setBuffer(En.SOLSizeGradientZMAX, null),
                    i.setBuffer(En.SOLSIZEGRADIENT, null), i.setBuffer(En.SOLSizeGradientMax, null);
                this._sizeOverLifetime = t;
            }), a(0, o, "textureSheetAnimation", function () {
                return this._textureSheetAnimation;
            }, function (t) {
                var e = this._owner._render._defineDatas, i = this._owner._render._shaderValues;
                if (t) {
                    var n = t.frame, r = n.type;
                    if (t.enable) switch (r) {
                        case 1:
                            e.add(En.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE);
                            break;

                        case 3:
                            e.add(En.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);
                    } else e.remove(En.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE), e.remove(En.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE);
                    if (1 === r || 3 === r) {
                        i.setNumber(En.TEXTURESHEETANIMATIONCYCLES, t.cycles);
                        var a = t.tiles, s = this._uvLength;
                        s.x = 1 / a.x, s.y = 1 / a.y, i.setVector2(En.TEXTURESHEETANIMATIONSUBUVLENGTH, this._uvLength);
                    }
                    switch (r) {
                        case 1:
                            i.setBuffer(En.TEXTURESHEETANIMATIONGRADIENTUVS, n.frameOverTimeData._elements);
                            break;

                        case 3:
                            i.setBuffer(En.TEXTURESHEETANIMATIONGRADIENTUVS, n.frameOverTimeDataMin._elements),
                                i.setBuffer(En.TEXTURESHEETANIMATIONGRADIENTMAXUVS, n.frameOverTimeDataMax._elements);
                    }
                } else e.remove(En.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE), e.remove(En.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE),
                    i.setNumber(En.TEXTURESHEETANIMATIONCYCLES, void 0), i.setVector(En.TEXTURESHEETANIMATIONSUBUVLENGTH, null),
                    i.setBuffer(En.TEXTURESHEETANIMATIONGRADIENTUVS, null), i.setBuffer(En.TEXTURESHEETANIMATIONGRADIENTMAXUVS, null);
                this._textureSheetAnimation = t;
            }), e.halfKSqrtOf2 = .71, n(e, ["_RANDOMOFFSET", function () {
                return this._RANDOMOFFSET = new Uint32Array([592910910, 3276756734, 322376503, 306581307, 1793934638, 3737431713, 2527743459, 2368504881, 4085612399, 3774601268, 326370691, 1494990940, 1089181156, 3159510623, 2941263940, 2786374529, 271901988, 4233252447]);
            }, "_maxElapsedTime", function () {
                return this._maxElapsedTime = 1 / 3;
            }, "_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }, "_tempVector32", function () {
                return this._tempVector32 = new gt();
            }, "_tempVector33", function () {
                return this._tempVector33 = new gt();
            }, "_tempVector34", function () {
                return this._tempVector34 = new gt();
            }, "_tempVector35", function () {
                return this._tempVector35 = new gt();
            }, "_tempVector36", function () {
                return this._tempVector36 = new gt();
            }, "_tempVector37", function () {
                return this._tempVector37 = new gt();
            }, "_tempVector38", function () {
                return this._tempVector38 = new gt();
            }, "_tempVector39", function () {
                return this._tempVector39 = new gt();
            }, "_tempPosition", function () {
                return this._tempPosition = new gt();
            }, "_tempDirection", function () {
                return this._tempDirection = new gt();
            }, "_type", function () {
                return this._type = et._typeCounter++;
            }]), e;
        }(et), oi = (function (t) {
            function e(t, i) {
                e.__super.call(this), this._normal = t, this._offset = i, this._type = 6, e._nativeNormal.setValue(-t.x, t.y, t.z),
                    this._nativeShape = new W._physics3D.btStaticPlaneShape(e._nativeNormal, i);
            }
            r(e, "laya.d3.physics.shape.StaticPlaneColliderShape", t), e.prototype.clone = function () {
                var t = new e(this._normal, this._offset);
                return this.cloneTo(t), t;
            }, n(e, ["_nativeNormal", function () {
                return this._nativeNormal = new W._physics3D.btVector3(0, 0, 0);
            }]);
        }(j), function (t) {
            function e() {
                this._instanceBatchOpaqueMarks = [], this._vertexBatchOpaqueMarks = [], this._cacheBufferStates = [],
                    e.__super.call(this), Ti.instance = new Ti(), this._updateCountMark = 0;
            }
            r(e, "laya.d3.graphics.MeshRenderDynamicBatchManager", t);
            var i = e.prototype;
            return i.getInstanceBatchOpaquaMark = function (t, e, i, n) {
                var r = this._instanceBatchOpaqueMarks[t] || (this._instanceBatchOpaqueMarks[t] = []), a = r[e ? 0 : 1] || (r[e ? 0 : 1] = []), s = a[i] || (a[i] = []);
                return s[n] || (s[n] = new me());
            }, i.getVertexBatchOpaquaMark = function (t, e, i, n) {
                var r = this._vertexBatchOpaqueMarks[t] || (this._vertexBatchOpaqueMarks[t] = []), a = r[e ? 0 : 1] || (r[e ? 0 : 1] = []), s = a[i] || (a[i] = []);
                return s[n] || (s[n] = new me());
            }, i._getBufferState = function (t) {
                var e = this._cacheBufferStates[t.id];
                if (!e) {
                    var i = Ti.instance;
                    (e = new Je()).bind();
                    var n = i._vertexBuffer;
                    n.vertexDeclaration = t, e.applyVertexBuffer(n), e.applyIndexBuffer(i._indexBuffer),
                        e.unBind(), this._cacheBufferStates[t.id] = e;
                }
                return e;
            }, i._getBatchRenderElementFromPool = function () {
                var t = this._batchRenderElementPool[this._batchRenderElementPoolIndex++];
                return t || (t = new Pi(), this._batchRenderElementPool[this._batchRenderElementPoolIndex - 1] = t,
                    t.vertexBatchElementList = [], t.instanceBatchElementList = []), t;
            }, i._clear = function () {
                t.prototype._clear.call(this), this._updateCountMark++;
            }, n(e, ["instance", function () {
                return this.instance = new e();
            }]), e;
        }(tt)), li = function (t) {
            function e(t, i, n) {
                e.__super.call(this), void 0 === t && (t = 1), void 0 === i && (i = 1), void 0 === n && (n = 1),
                    this._sizeX = t, this._sizeY = i, this._sizeZ = n, this._type = 0, e._nativeSize.setValue(t / 2, i / 2, n / 2),
                    this._nativeShape = new W._physics3D.btBoxShape(e._nativeSize);
            }
            r(e, "laya.d3.physics.shape.BoxColliderShape", t);
            var i = e.prototype;
            return i.clone = function () {
                var t = new e(this._sizeX, this._sizeY, this._sizeZ);
                return this.cloneTo(t), t;
            }, a(0, i, "sizeX", function () {
                return this._sizeX;
            }), a(0, i, "sizeY", function () {
                return this._sizeY;
            }), a(0, i, "sizeZ", function () {
                return this._sizeZ;
            }), n(e, ["_nativeSize", function () {
                return this._nativeSize = new W._physics3D.btVector3(0, 0, 0);
            }]), e;
        }(j), hi = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.component.SimpleSingletonList", t);
            var i = e.prototype;
            return i.add = function (t) {
                if (-1 !== t._getIndexInList()) throw "SimpleSingletonList:" + t + " has  in  SingletonList.";
                this._add(t), t._setIndexInList(this.length++);
            }, i.remove = function (t) {
                var e = t._getIndexInList();
                if (this.length--, e !== this.length) {
                    var i = this.elements[this.length];
                    this.elements[e] = i, i._setIndexInList(e);
                }
                t._setIndexInList(-1);
            }, e;
        }($), ui = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.physics.PhysicsUpdateList", t);
            var i = e.prototype;
            return i.add = function (t) {
                if (-1 !== t._inPhysicUpdateListIndex) throw "PhysicsUpdateList:element has  in  PhysicsUpdateList.";
                this._add(t), t._inPhysicUpdateListIndex = this.length++;
            }, i.remove = function (t) {
                var e = t._inPhysicUpdateListIndex;
                if (this.length--, e !== this.length) {
                    var i = this.elements[this.length];
                    this.elements[e] = i, i._inPhysicUpdateListIndex = e;
                }
                t._inPhysicUpdateListIndex = -1;
            }, e;
        }($), ci = function (t) {
            function e(t, i, n) {
                e.__super.call(this), this._bufferState = new Je(), this._batchID = e._batchIDCounter++,
                    this._batchElements = [], this._currentBatchVertexCount = 0, this._currentBatchIndexCount = 0,
                    this._vertexDeclaration = n, this.batchOwner = t, this.number = i;
            }
            r(e, "laya.d3.graphics.SubMeshStaticBatch", t);
            var a = e.prototype;
            return i.imps(a, {
                "laya.resource.IDispose": !0
            }), a._getStaticBatchBakedVertexs = function (t, i, n, r, a, s) {
                var o, l = s._vertexBuffers[0], h = l.vertexDeclaration, u = h.getVertexElementByUsage(0).offset / 4, c = h.getVertexElementByUsage(3), d = c ? c.offset / 4 : -1, _ = h.getVertexElementByUsage(1), f = _ ? _.offset / 4 : -1, p = h.getVertexElementByUsage(2), m = p ? p.offset / 4 : -1, g = h.getVertexElementByUsage(7), y = g ? g.offset / 4 : -1, v = h.getVertexElementByUsage(4), S = v ? v.offset / 4 : -1, T = h.vertexStride / 4, E = l.getData();
                n ? (n.worldMatrix.invert(e._tempMatrix4x40), o = e._tempMatrix4x41, ze.multiply(e._tempMatrix4x40, r.worldMatrix, o)) : o = r.worldMatrix;
                var C = e._tempQuaternion0;
                o.decomposeTransRotScale(e._tempVector30, C, e._tempVector31);
                for (var x = a.lightmapScaleOffset, b = s.vertexCount, I = 0; I < b; I++) {
                    var w = I * T, A = 18 * (I + i);
                    Ht.transformVector3ArrayToVector3ArrayCoordinate(E, w + u, o, t, A + 0), -1 !== d && Ht.transformVector3ArrayByQuat(E, w + d, C, t, A + 3);
                    var R = 0, M = 0, D = A + 6;
                    if (-1 !== f) {
                        var O = w + f;
                        for (R = 0, M = 4; R < M; R++) t[D + R] = E[O + R];
                    } else for (R = 0, M = 4; R < M; R++) t[D + R] = 1;
                    if (-1 !== m) {
                        var L = w + m;
                        t[A + 10] = E[L], t[A + 11] = E[L + 1];
                    }
                    if (x && (-1 !== y ? Ht.transformLightingMapTexcoordArray(E, w + y, x, t, A + 12) : Ht.transformLightingMapTexcoordArray(E, w + m, x, t, A + 12)),
                        -1 !== S) {
                        var P = w + S;
                        t[A + 14] = E[P], t[A + 15] = E[P + 1], t[A + 16] = E[P + 2], t[A + 17] = E[P + 3];
                    }
                }
                return b;
            }, a.addTest = function (t) {
                var e = t.meshFilter.sharedMesh.vertexCount;
                return !(this._currentBatchVertexCount + e > 65535);
            }, a.add = function (t) {
                var e = t._render._staticBatch;
                e && e.remove(t);
                var i = t.meshFilter.sharedMesh, n = i.vertexCount;
                this._batchElements.push(t);
                var r = t._render;
                r._isPartOfStaticBatch = !0, r._staticBatch = this;
                for (var a = r._renderElements, s = 0, o = a.length; s < o; s++) a[s].staticBatch = this;
                this._currentBatchIndexCount += i._indexBuffer.indexCount, this._currentBatchVertexCount += n;
            }, a.remove = function (t) {
                var e = t.meshFilter.sharedMesh, i = this._batchElements.indexOf(t);
                if (-1 !== i) {
                    this._batchElements.splice(i, 1);
                    t._render;
                    for (var n = t._render._renderElements, r = 0, a = n.length; r < a; r++) n[r].staticBatch = null;
                    var s = e.vertexCount;
                    this._currentBatchIndexCount = this._currentBatchIndexCount - e._indexBuffer.indexCount,
                        this._currentBatchVertexCount = this._currentBatchVertexCount - s, t._render._isPartOfStaticBatch = !1;
                }
            }, a.finishInit = function () {
                this._vertexBuffer && (this._vertexBuffer.destroy(), this._indexBuffer.destroy(),
                    w._addGPUMemory(-(this._vertexBuffer._byteLength + this._indexBuffer._byteLength)));
                var t = 0, e = 0, i = this.batchOwner, n = this._vertexDeclaration.vertexStride / 4, r = new Float32Array(n * this._currentBatchVertexCount), a = new Uint16Array(this._currentBatchIndexCount);
                this._vertexBuffer = new Ke(this._vertexDeclaration.vertexStride * this._currentBatchVertexCount, 35044),
                    this._vertexBuffer.vertexDeclaration = this._vertexDeclaration, this._indexBuffer = new Ze("ushort", this._currentBatchIndexCount, 35044);
                for (var s = 0, o = this._batchElements.length; s < o; s++) {
                    for (var l = this._batchElements[s], h = l.meshFilter.sharedMesh, u = this._getStaticBatchBakedVertexs(r, t, i ? i._transform : null, l._transform, l._render, h), c = h._indexBuffer.getData(), d = t, _ = e + c.length, f = l._render._renderElements, p = 0, m = h.subMeshCount; p < m; p++) {
                        var g = h._subMeshes[p], y = e + g._indexStart, v = f[p];
                        v.staticBatchIndexStart = y, v.staticBatchIndexEnd = y + g._indexCount;
                    }
                    a.set(c, e);
                    var S = 0;
                    if (i ? l._transform._isFrontFaceInvert !== i.transform._isFrontFaceInvert : l._transform._isFrontFaceInvert) for (S = e; S < _; S += 3) {
                        a[S] = d + a[S];
                        var T = a[S + 1], E = a[S + 2];
                        a[S + 1] = d + E, a[S + 2] = d + T;
                    } else for (S = e; S < _; S += 3) a[S] = d + a[S], a[S + 1] = d + a[S + 1], a[S + 2] = d + a[S + 2];
                    e += c.length, t += u;
                }
                this._vertexBuffer.setData(r), this._indexBuffer.setData(a);
                var C = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                w._addGPUMemory(C), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                    this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind();
            }, a._render = function (t) {
                this._bufferState.bind();
                for (var e = t.renderElement.staticBatchElementList, i = 0, n = 0, r = e.length, a = 1; a < r; a++) {
                    if (e[a - 1].staticBatchIndexEnd !== e[a].staticBatchIndexStart) {
                        var s = e[i].staticBatchIndexStart, o = e[n].staticBatchIndexEnd - s;
                        v.instance.drawElements(4, o, 5123, 2 * s), i = ++n, O.trianglesFaces += o / 3;
                    } else n++;
                }
                s = e[i].staticBatchIndexStart, o = e[n].staticBatchIndexEnd - s, v.instance.drawElements(4, o, 5123, 2 * s),
                    O.renderBatches++, O.savedRenderBatches += r - 1, O.trianglesFaces += o / 3;
            }, a.dispose = function () {
                var t = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                w._addGPUMemory(-t), this._batchElements = null, this.batchOwner = null, this._vertexDeclaration = null,
                    this._bufferState.destroy(), this._vertexBuffer.destroy(), this._indexBuffer.destroy(),
                    this._vertexBuffer = null, this._indexBuffer = null, this._bufferState = null;
            }, e.maxBatchVertexCount = 65535, e._batchIDCounter = 0, n(e, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }, "_tempQuaternion0", function () {
                return this._tempQuaternion0 = new ht();
            }, "_tempMatrix4x40", function () {
                return this._tempMatrix4x40 = new ze();
            }, "_tempMatrix4x41", function () {
                return this._tempMatrix4x41 = new ze();
            }]), e;
        }(et), di = function (t) {
            function e(t) {
                this._floatCountPerVertices1 = 8, this._floatCountPerVertices2 = 1, this._increaseSegementCount = 128,
                    this._activeIndex = 0, this._endIndex = 0, this._needAddFirstVertex = !1, this._isTempEndVertex = !1,
                    this._subBirthTime = null, this._subDistance = null, this._segementCount = 0, this._vertices1 = null,
                    this._vertices2 = null, this._vertexBuffer1 = null, this._vertexBuffer2 = null,
                    this._owner = null, e.__super.call(this), this._lastFixedVertexPosition = new gt(),
                    this._bufferState = new Je(), this._owner = t, this._resizeData(this._increaseSegementCount, this._bufferState);
            }
            r(e, "laya.d3.core.trail.TrailGeometry", t);
            var i = e.prototype;
            return i._resizeData = function (t, e) {
                this._segementCount = this._increaseSegementCount, this._subBirthTime = new Float32Array(t),
                    this._subDistance = new Float32Array(t);
                var i = 2 * t, n = ee.vertexDeclaration1, r = ee.vertexDeclaration2, a = [], s = i * n.vertexStride, o = i * r.vertexStride, l = s + o;
                this._vertices1 = new Float32Array(i * this._floatCountPerVertices1), this._vertexBuffer1 = new Ke(s, 35044, !1),
                    this._vertexBuffer1.vertexDeclaration = n, this._vertices2 = new Float32Array(i * this._floatCountPerVertices2),
                    this._vertexBuffer2 = new Ke(o, 35048, !1), this._vertexBuffer2.vertexDeclaration = r,
                    a.push(this._vertexBuffer1), a.push(this._vertexBuffer2), e.bind(), e.applyVertexBuffers(a),
                    e.unBind(), w._addMemory(l, l);
            }, i._resetData = function () {
                var t = this._endIndex - this._activeIndex;
                t == this._segementCount && (this._vertexBuffer1.destroy(), this._vertexBuffer2.destroy(),
                    this._segementCount += this._increaseSegementCount, this._resizeData(this._segementCount, this._bufferState)),
                    this._vertexBuffer1.setData(this._vertices1, 0, 2 * this._floatCountPerVertices1 * this._activeIndex, 2 * this._floatCountPerVertices1 * t),
                    this._vertexBuffer2.setData(this._vertices2, 0, 2 * this._floatCountPerVertices2 * this._activeIndex, 2 * this._floatCountPerVertices2 * t);
                var e = 4 * this._activeIndex, i = new Float32Array(this._subDistance.buffer, e, t), n = new Float32Array(this._subBirthTime.buffer, e, t);
                this._subDistance.set(i, 0), this._subBirthTime.set(n, 0), this._endIndex = t, this._activeIndex = 0;
            }, i._updateTrail = function (t, e, i) {
                gt.equals(e, i) || (this._endIndex - this._activeIndex == 0 ? this._addTrailByFirstPosition(t, i) : this._addTrailByNextPosition(t, i));
            }, i._addTrailByFirstPosition = function (t, e) {
                this._endIndex === this._segementCount && this._resetData(), this._subDistance[this._endIndex] = 0,
                    this._subBirthTime[this._endIndex] = this._owner._curtime, this._endIndex++, e.cloneTo(this._lastFixedVertexPosition),
                    this._needAddFirstVertex = !0;
            }, i._addTrailByNextPosition = function (t, i) {
                var n = e._tempVector30, r = e._tempVector31;
                gt.subtract(i, this._lastFixedVertexPosition, n);
                var a = e._tempVector32;
                switch (this._owner.alignment) {
                    case 0:
                        t.transform.getForward(a), gt.cross(n, a, r);
                        break;

                    case 1:
                        this._owner._owner.transform.getForward(a), gt.cross(n, a, r);
                }
                gt.normalize(r, r), gt.scale(r, this._owner.widthMultiplier / 2, r);
                var s = gt.scalarLength(n), o = 0, l = NaN;
                this._needAddFirstVertex && (this._updateVerticesByPositionData(i, r, this._endIndex - 1),
                    this._needAddFirstVertex = !1), s - this._owner.minVertexDistance >= nt.zeroTolerance ? (this._isTempEndVertex ? (o = this._endIndex - 1,
                        l = s - this._subDistance[o], this._updateVerticesByPosition(i, r, s, o), this._owner._totalLength += l) : (this._endIndex === this._segementCount && this._resetData(),
                            this._updateVerticesByPosition(i, r, s, this._endIndex), this._owner._totalLength += s,
                            this._endIndex++), i.cloneTo(this._lastFixedVertexPosition), this._isTempEndVertex = !1) : (this._isTempEndVertex ? (o = this._endIndex - 1,
                                l = s - this._subDistance[o], this._updateVerticesByPosition(i, r, s, o), this._owner._totalLength += l) : (this._endIndex === this._segementCount && this._resetData(),
                                    this._updateVerticesByPosition(i, r, s, this._endIndex), this._owner._totalLength += s,
                                    this._endIndex++), this._isTempEndVertex = !0);
            }, i._updateVerticesByPositionData = function (t, e, i) {
                var n = 2 * this._floatCountPerVertices1 * i, r = this._owner._curtime;
                this._vertices1[n] = t.x, this._vertices1[n + 1] = t.y, this._vertices1[n + 2] = t.z,
                    this._vertices1[n + 3] = -e.x, this._vertices1[n + 4] = -e.y, this._vertices1[n + 5] = -e.z,
                    this._vertices1[n + 6] = r, this._vertices1[n + 7] = 1, this._vertices1[n + 8] = t.x,
                    this._vertices1[n + 9] = t.y, this._vertices1[n + 10] = t.z, this._vertices1[n + 11] = e.x,
                    this._vertices1[n + 12] = e.y, this._vertices1[n + 13] = e.z, this._vertices1[n + 14] = r,
                    this._vertices1[n + 15] = 0;
                var a = 2 * this._floatCountPerVertices1;
                this._vertexBuffer1.setData(this._vertices1, n, n, a);
            }, i._updateVerticesByPosition = function (t, e, i, n) {
                this._updateVerticesByPositionData(t, e, n), this._subDistance[n] = i, this._subBirthTime[n] = this._owner._curtime;
            }, i._updateVertexBufferUV = function () {
                for (var t = this._endIndex, e = 0, i = this._activeIndex, n = t; i < n; i++) {
                    i !== this._activeIndex && (e += this._subDistance[i]);
                    var r = NaN;
                    r = 0 == this._owner.textureMode ? 1 - e / this._owner._totalLength : 1 - (this._owner._totalLength - e),
                        this._vertices2[2 * i] = r, this._vertices2[2 * i + 1] = r;
                }
                var a = 2 * this._activeIndex;
                this._vertexBuffer2.setData(this._vertices2, a, a, 2 * t - a);
            }, i._updateDisappear = function () {
                for (var t = this._endIndex, e = this._activeIndex; e < t && this._owner._curtime - this._subBirthTime[e] >= this._owner.time + nt.zeroTolerance; e++) {
                    var i = e + 1;
                    if (i !== t && (this._owner._totalLength -= this._subDistance[i]), this._isTempEndVertex && i === t - 1) {
                        this._floatCountPerVertices1;
                        var n = this._lastFixedVertexPosition;
                        n.x = this._vertices1[0], n.y = this._vertices1[1], n.z = this._vertices1[2], this._isTempEndVertex = !1;
                    }
                    this._activeIndex++;
                }
            }, i._getType = function () {
                return e._type;
            }, i._prepareRender = function (t) {
                return this._endIndex - this._activeIndex > 1;
            }, i._render = function (t) {
                this._bufferState.bind();
                var e = 2 * this._activeIndex, i = 2 * this._endIndex - e;
                v.instance.drawArrays(5, e, i), O.renderBatches++, O.trianglesFaces += i - 2;
            }, i.destroy = function () {
                t.prototype.destroy.call(this);
                var e = this._vertexBuffer1._byteLength + this._vertexBuffer2._byteLength;
                w._addMemory(-e, -e), this._bufferState.destroy(), this._vertexBuffer1.destroy(),
                    this._vertexBuffer2.destroy(), this._bufferState = null, this._vertices1 = null,
                    this._vertexBuffer1 = null, this._vertices2 = null, this._vertexBuffer2 = null,
                    this._subBirthTime = null, this._subDistance = null, this._lastFixedVertexPosition = null;
            }, n(e, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }, "_tempVector32", function () {
                return this._tempVector32 = new gt();
            }, "_type", function () {
                return this._type = et._typeCounter++;
            }]), e;
        }(et), _i = function (t) {
            function e() {
                e.__super.call(this), this._childColliderShapes = [], this._type = 5, this._nativeShape = new W._physics3D.btCompoundShape();
            }
            r(e, "laya.d3.physics.shape.CompoundColliderShape", t);
            var i = e.prototype;
            return i._clearChildShape = function (t) {
                t._attatched = !1, t._compoundParent = null, t._indexInCompound = -1;
            }, i._addReference = function () { }, i._removeReference = function () { }, i._updateChildTransform = function (t) {
                var e = t.localOffset, i = t.localRotation, n = j._nativeVector30, r = j._nativQuaternion0, a = j._nativeTransform0;
                n.setValue(-e.x, e.y, e.z), r.setValue(-i.x, i.y, i.z, -i.w), a.setOrigin(n), a.setRotation(r),
                    this._nativeShape.updateChildTransform(t._indexInCompound, a, !0);
            }, i.addChildShape = function (t) {
                if (t._attatched) throw "CompoundColliderShape: this shape has attatched to other entity.";
                t._attatched = !0, t._compoundParent = this, t._indexInCompound = this._childColliderShapes.length,
                    this._childColliderShapes.push(t);
                var i = t.localOffset, n = t.localRotation;
                e._nativeOffset.setValue(-i.x, i.y, i.z), e._nativRotation.setValue(-n.x, n.y, n.z, -n.w),
                    e._nativeTransform.setOrigin(e._nativeOffset), e._nativeTransform.setRotation(e._nativRotation);
                var r = this._nativeShape.getLocalScaling();
                this._nativeShape.setLocalScaling(e._nativeVector3One), this._nativeShape.addChildShape(e._nativeTransform, t._nativeShape),
                    this._nativeShape.setLocalScaling(r), this._attatchedCollisionObject && (this._attatchedCollisionObject.colliderShape = this);
            }, i.removeChildShape = function (t) {
                if (t._compoundParent === this) {
                    var e = t._indexInCompound;
                    this._clearChildShape(t);
                    var i = this._childColliderShapes[this._childColliderShapes.length - 1];
                    i._indexInCompound = e, this._childColliderShapes[e] = i, this._childColliderShapes.pop(),
                        this._nativeShape.removeChildShapeByIndex(e);
                }
            }, i.clearChildShape = function () {
                for (var t = 0, e = this._childColliderShapes.length; t < e; t++) this._clearChildShape(this._childColliderShapes[t]),
                    this._nativeShape.removeChildShapeByIndex(0);
                this._childColliderShapes.length = 0;
            }, i.getChildShapeCount = function () {
                return this._childColliderShapes.length;
            }, i.cloneTo = function (t) {
                var e = t;
                e.clearChildShape();
                for (var i = 0, n = this._childColliderShapes.length; i < n; i++) e.addChildShape(this._childColliderShapes[i].clone());
            }, i.clone = function () {
                var t = new e();
                return this.cloneTo(t), t;
            }, i.destroy = function () {
                t.prototype.destroy.call(this);
                for (var e = 0, i = this._childColliderShapes.length; e < i; e++) {
                    var n = this._childColliderShapes[e];
                    0 === n._referenceCount && n.destroy();
                }
            }, n(e, ["_nativeVector3One", function () {
                return this._nativeVector3One = new W._physics3D.btVector3(1, 1, 1);
            }, "_nativeTransform", function () {
                return this._nativeTransform = new W._physics3D.btTransform();
            }, "_nativeOffset", function () {
                return this._nativeOffset = new W._physics3D.btVector3(0, 0, 0);
            }, "_nativRotation", function () {
                return this._nativRotation = new W._physics3D.btQuaternion(0, 0, 0, 1);
            }]), e;
        }(j), fi = function (t) {
            function e(t, i) {
                this._floatCountPerVertices = 7, this._owner = null, this._vertexBuffer = null,
                    this._vertices = null, this._maxLineCount = 0, this._lineCount = 0, e.__super.call(this),
                    this._minUpdate = Number.MAX_VALUE, this._maxUpdate = Number.MIN_VALUE, this._bufferState = new Je();
                var n = 2 * i;
                this._owner = t, this._maxLineCount = i, this._vertices = new Float32Array(n * this._floatCountPerVertices),
                    this._vertexBuffer = new Ke(Wt.vertexDeclaration.vertexStride * n, 35044, !1), this._vertexBuffer.vertexDeclaration = Wt.vertexDeclaration,
                    this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                    this._bufferState.unBind();
            }
            r(e, "laya.d3.core.pixelLine.PixelLineFilter", t);
            var i = e.prototype;
            return i._getType = function () {
                return e._type;
            }, i._resizeLineData = function (t) {
                var e = 2 * t, i = this._vertices;
                this._vertexBuffer.destroy(), this._maxLineCount = t;
                var n = e * this._floatCountPerVertices;
                this._vertices = new Float32Array(n), this._vertexBuffer = new Ke(Wt.vertexDeclaration.vertexStride * e, 35044, !1),
                    this._vertexBuffer.vertexDeclaration = Wt.vertexDeclaration, n < i.length ? (this._vertices.set(new Float32Array(i.buffer, 0, n)),
                        this._vertexBuffer.setData(this._vertices, 0, 0, n)) : (this._vertices.set(i), this._vertexBuffer.setData(this._vertices, 0, 0, i.length)),
                    this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                    this._bufferState.unBind();
            }, i._updateLineVertices = function (t, e, i, n, r) {
                e && (this._vertices[t + 0] = e.x, this._vertices[t + 1] = e.y, this._vertices[t + 2] = e.z),
                    n && (this._vertices[t + 3] = n.r, this._vertices[t + 4] = n.g, this._vertices[t + 5] = n.b,
                        this._vertices[t + 6] = n.a), i && (this._vertices[t + 7] = i.x, this._vertices[t + 8] = i.y,
                            this._vertices[t + 9] = i.z), r && (this._vertices[t + 10] = r.r, this._vertices[t + 11] = r.g,
                                this._vertices[t + 12] = r.b, this._vertices[t + 13] = r.a), this._minUpdate = Math.min(this._minUpdate, t),
                    this._maxUpdate = Math.max(this._maxUpdate, t + 2 * this._floatCountPerVertices);
            }, i._removeLineData = function (t) {
                var e = 2 * this._floatCountPerVertices, i = t + 1, n = t * e, r = new Float32Array(this._vertices.buffer, i * e * 4, (this._lineCount - i) * e);
                this._vertices.set(r, n), this._minUpdate = n, this._maxUpdate = n + 2 * this._floatCountPerVertices,
                    this._lineCount--;
            }, i._updateLineData = function (t, e, i, n, r) {
                var a = t * (2 * this._floatCountPerVertices);
                this._updateLineVertices(a, e, i, n, r);
            }, i._updateLineDatas = function (t, e) {
                for (var i = 2 * this._floatCountPerVertices, n = e.length, r = 0; r < n; r++) {
                    var a = e[r];
                    this._updateLineVertices((t + r) * i, a.startPosition, a.endPosition, a.startColor, a.endColor);
                }
            }, i._getLineData = function (t, e) {
                var i = e.startPosition, n = e.startColor, r = e.endPosition, a = e.endColor, s = this._vertices, o = t * this._floatCountPerVertices * 2;
                i.x = s[o + 0], i.y = s[o + 1], i.z = s[o + 2], n.r = s[o + 3], n.g = s[o + 4],
                    n.b = s[o + 5], n.a = s[o + 6], r.x = s[o + 7], r.y = s[o + 8], r.z = s[o + 9],
                    a.r = s[o + 10], a.g = s[o + 11], a.b = s[o + 12], a.a = s[o + 13];
            }, i._prepareRender = function (t) {
                return !0;
            }, i._render = function (t) {
                this._minUpdate !== Number.MAX_VALUE && this._maxUpdate !== Number.MIN_VALUE && (this._vertexBuffer.setData(this._vertices, this._minUpdate, this._minUpdate, this._maxUpdate - this._minUpdate),
                    this._minUpdate = Number.MAX_VALUE, this._maxUpdate = Number.MIN_VALUE), this._lineCount > 0 && (this._bufferState.bind(),
                        v.instance.drawArrays(1, 0, 2 * this._lineCount), O.renderBatches++);
            }, i.destroy = function () {
                this._destroyed || (t.prototype.destroy.call(this), this._bufferState.destroy(),
                    this._vertexBuffer.destroy(), this._bufferState = null, this._vertexBuffer = null,
                    this._vertices = null);
            }, n(e, ["_type", function () {
                return this._type = et._typeCounter++;
            }]), e;
        }(et), pi = function (t) {
            function e(t, i, n) {
                switch (this._radius = 1, this._height = .5, e.__super.call(this), void 0 === t && (t = .5),
                void 0 === i && (i = 1), void 0 === n && (n = 1), this._radius = t, this._height = i,
                this._orientation = n, this._type = 2, n) {
                    case 0:
                        e._nativeSize.setValue(i / 2, t, t), this._nativeShape = new W._physics3D.btCylinderShapeX(e._nativeSize);
                        break;

                    case 1:
                        e._nativeSize.setValue(t, i / 2, t), this._nativeShape = new W._physics3D.btCylinderShape(e._nativeSize);
                        break;

                    case 2:
                        e._nativeSize.setValue(t, t, i / 2), this._nativeShape = new W._physics3D.btCylinderShapeZ(e._nativeSize);
                        break;

                    default:
                        throw "CapsuleColliderShape:unknown orientation.";
                }
            }
            r(e, "laya.d3.physics.shape.CylinderColliderShape", t);
            var i = e.prototype;
            return i.clone = function () {
                var t = new e(this._radius, this._height, this._orientation);
                return this.cloneTo(t), t;
            }, a(0, i, "radius", function () {
                return this._radius;
            }), a(0, i, "height", function () {
                return this._height;
            }), a(0, i, "orientation", function () {
                return this._orientation;
            }), n(e, ["_nativeSize", function () {
                return this._nativeSize = new W._physics3D.btVector3(0, 0, 0);
            }]), e;
        }(j), mi = function (t) {
            function e() {
                e.__super.call(this);
            }
            return r(e, "laya.d3.core.FloatKeyframe", t), e.prototype.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.inTangent = this.inTangent, i.outTangent = this.outTangent, i.value = this.value;
            }, e;
        }(ft), gi = function (t) {
            function e() {
                this.maxInstanceCount = 1024, e.__super.call(this), this.instanceWorldMatrixData = new Float32Array(16 * this.maxInstanceCount),
                    this.instanceMVPMatrixData = new Float32Array(16 * this.maxInstanceCount), this.instanceWorldMatrixBuffer = new Ke(4 * this.instanceWorldMatrixData.length, 35048),
                    this.instanceMVPMatrixBuffer = new Ke(4 * this.instanceMVPMatrixData.length, 35048),
                    this.instanceWorldMatrixBuffer.vertexDeclaration = bt.instanceWorldMatrixDeclaration,
                    this.instanceMVPMatrixBuffer.vertexDeclaration = bt.instanceMVPMatrixDeclaration;
            }
            return r(e, "laya.d3.graphics.SubMeshInstanceBatch", t), e.prototype._render = function (t) {
                var e = t.renderElement, i = e.instanceSubMesh, n = e.instanceBatchElementList.length, r = i._indexCount;
                i._mesh._instanceBufferState.bind(), k._angleInstancedArrays.drawElementsInstancedANGLE(4, r, 5123, 2 * i._indexStart, n),
                    O.renderBatches++, O.savedRenderBatches += n - 1, O.trianglesFaces += r * n / 3;
            }, n(e, ["instance", function () {
                return this.instance = new e();
            }]), e;
        }(et), yi = function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.d3.core.scene.OctreeMotionList", t);
            var i = e.prototype;
            return i.add = function (t) {
                if (-1 !== t._getIndexInMotionList()) throw "OctreeMotionList:element has  in  PhysicsUpdateList.";
                this._add(t), t._setIndexInMotionList(this.length++);
            }, i.remove = function (t) {
                var e = t._getIndexInMotionList();
                if (this.length--, e !== this.length) {
                    var i = this.elements[this.length];
                    this.elements[e] = i, i._inPhysicUpdateListIndex = e;
                }
                t._setIndexInMotionList(-1);
            }, e;
        }($), vi = function (t) {
            function e() {
                this._renderTexture = null, e.__super.call(this);
            }
            r(e, "laya.d3.core.render.command.SetRenderTargetCMD", t);
            var i = e.prototype;
            return i.run = function () {
                this._renderTexture._start();
            }, i.recover = function () {
                e._pool.push(this), this._renderTexture = null;
            }, e.create = function (t) {
                var i;
                return (i = e._pool.length > 0 ? e._pool.pop() : new e())._renderTexture = t, i;
            }, e._pool = [], e;
        }(Q), Si = function (t) {
            function e() {
                this._opaqueBatchMarks = [], e.__super.call(this), this._updateCountMark = 0;
            }
            r(e, "laya.d3.graphics.MeshRenderStaticBatchManager", t);
            var i = e.prototype;
            return i._compare = function (t, e) {
                var i = t._render, n = e._render, r = t.meshFilter.sharedMesh, a = e.meshFilter.sharedMesh, s = i.lightmapIndex - n.lightmapIndex;
                if (0 === s) {
                    var o = (i.receiveShadow ? 1 : 0) - (n.receiveShadow ? 1 : 0);
                    if (0 === o) {
                        var l = i.sharedMaterial.id - n.sharedMaterial.id;
                        if (0 === l) {
                            var h = r._vertexBuffers[0].vertexDeclaration.id - a._vertexBuffers[0].vertexDeclaration.id;
                            return 0 === h ? a._indexBuffer.indexCount - r._indexBuffer.indexCount : h;
                        }
                        return l;
                    }
                    return o;
                }
                return s;
            }, i._getBatchRenderElementFromPool = function () {
                var t = this._batchRenderElementPool[this._batchRenderElementPoolIndex++];
                return t || (t = new Pi(), this._batchRenderElementPool[this._batchRenderElementPoolIndex - 1] = t,
                    t.staticBatchElementList = []), t;
            }, i._getStaticBatch = function (t, i) {
                var n = t ? t.id : 0, r = this._staticBatches[n];
                return r || (r = this._staticBatches[n] = []), r[i] || (r[i] = new ci(t, i, e._verDec));
            }, i._initStaticBatchs = function (t) {
                this._quickSort(this._initBatchSprites, 0, this._initBatchSprites.length - 1);
                for (var e, i = !1, n = 0, r = 0, a = this._initBatchSprites.length; r < a; r++) {
                    var s = this._initBatchSprites[r];
                    if (i) e.addTest(s) ? e.add(s) : (i = !1, n++); else r !== a - 1 && ((e = this._getStaticBatch(t, n)).add(s),
                        i = !0);
                }
                for (var o in this._staticBatches) {
                    var l = this._staticBatches[o];
                    for (r = 0, a = l.length; r < a; r++) l[r].finishInit();
                }
                this._initBatchSprites.length = 0;
            }, i._destroyRenderSprite = function (t) {
                var e = t._render._staticBatch;
                if (e.remove(t), 0 === e._batchElements.length) {
                    var i = e.batchOwner, n = i ? i.id : 0, r = this._staticBatches[n];
                    r[e.number] = null, e.dispose();
                    for (var a = !0, s = 0; s < r.length; s++) r[s] && (a = !1);
                    a && delete this._staticBatches[n];
                }
            }, i._clear = function () {
                t.prototype._clear.call(this), this._updateCountMark++;
            }, i._garbageCollection = function () {
                for (var t in this._staticBatches) for (var e = this._staticBatches[t], i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    0 === r._batchElements.length && (r.dispose(), e.splice(i, 1), i--, 0 === --n && delete this._staticBatches[t]);
                }
            }, i.getBatchOpaquaMark = function (t, e, i, n) {
                var r = this._opaqueBatchMarks[t] || (this._opaqueBatchMarks[t] = []), a = r[e] || (r[e] = []), s = a[i] || (a[i] = []);
                return s[n] || (s[n] = new me());
            }, n(e, ["_verDec", function () {
                return this._verDec = bt.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT");
            }, "instance", function () {
                return this.instance = new e();
            }]), e;
        }(Z), Ti = function (t) {
            function e() {
                this._vertices = null, this._indices = null, this._positionOffset = 0, this._normalOffset = 0,
                    this._colorOffset = 0, this._uv0Offset = 0, this._uv1Offset = 0, this._sTangentOffset = 0,
                    this._vertexBuffer = null, this._indexBuffer = null, e.__super.call(this), this._bufferState = new Je();
                var t = 32e3 * bt.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT").vertexStride;
                this._vertices = new Float32Array(t / 4), this._vertexBuffer = new Ke(t, 35048),
                    this._indices = new Int16Array(32e3), this._indexBuffer = new Ze("ushort", this._indices.length, 35048);
                var i = this._vertexBuffer._byteLength + this._indexBuffer._byteLength;
                w._addMemory(i, i);
            }
            r(e, "laya.d3.graphics.SubMeshDynamicBatch", t);
            var i = e.prototype;
            return i._getBatchVertices = function (t, e, i, n, r, a) {
                var s = t.vertexStride / 4, o = a._vertexBuffer.getData(), l = (r.render.lightmapScaleOffset,
                    r._dynamicMultiSubMesh), h = r._dynamicVertexCount;
                r._computeWorldPositionsAndNormals(this._positionOffset, this._normalOffset, l, h);
                for (var u = r._dynamicWorldPositions, c = r._dynamicWorldNormals, d = a._indices, _ = 0; _ < h; _++) {
                    var f = (l ? d[_] : _) * s, p = (_ + i) * s, m = 3 * _, g = p + this._positionOffset;
                    e[g] = u[m], e[g + 1] = u[m + 1], e[g + 2] = u[m + 2], -1 !== this._normalOffset && (e[g = p + this._normalOffset] = c[m],
                        e[g + 1] = c[m + 1], e[g + 2] = c[m + 2]), -1 !== this._colorOffset && (g = p + this._colorOffset,
                            m = f + this._colorOffset, e[g] = o[m], e[g + 1] = o[m + 1], e[g + 2] = o[m + 2],
                            e[g + 3] = o[m + 3]), -1 !== this._uv0Offset && (g = p + this._uv0Offset, m = f + this._uv0Offset,
                                e[g] = o[m], e[g + 1] = o[m + 1]), -1 !== this._sTangentOffset && (g = p + this._sTangentOffset,
                                    m = f + this._sTangentOffset, e[g] = o[m], e[g + 1] = o[m + 1], e[g + 2] = o[m + 2],
                                    e[g + 3] = o[m + 3], g = p + this._sTangentOffset, m = f + this._sTangentOffset,
                                    e[g] = o[m], e[g + 1] = o[m + 1], e[g + 2] = o[m + 2], e[g + 3] = o[m + 3]);
                }
            }, i._getBatchIndices = function (t, e, i, n, r, a) {
                var s = r._indices, o = 0, l = 0, h = 0, u = n._isFrontFaceInvert;
                if (a) if (u) for (o = 0, l = s.length; o < l; o += 3) {
                    var c = i + o;
                    t[h = e + o] = c, t[h + 1] = c + 2, t[h + 2] = c + 1;
                } else for (o = l, l = s.length; o < l; o += 3) c = i + o, t[h = e + o] = c, t[h + 1] = c + 1,
                    t[h + 2] = c + 2; else if (u) for (o = 0, l = s.length; o < l; o += 3) t[h = e + o] = i + s[o],
                        t[h + 1] = i + s[o + 2], t[h + 2] = i + s[o + 1]; else for (o = l, l = s.length; o < l; o += 3) t[h = e + o] = i + s[o],
                            t[h + 1] = i + s[o + 1], t[h + 2] = i + s[o + 2];
            }, i._flush = function (t, e) {
                this._vertexBuffer.setData(this._vertices, 0, 0, t * (this._vertexBuffer.vertexDeclaration.vertexStride / 4)),
                    this._indexBuffer.setData(this._indices, 0, 0, e), v.instance.drawElements(4, e, 5123, 0);
            }, i._prepareRender = function (t) {
                var e = t.renderElement.vertexBatchVertexDeclaration;
                this._bufferState = oi.instance._getBufferState(e), this._positionOffset = e.getVertexElementByUsage(0).offset / 4;
                var i = e.getVertexElementByUsage(3);
                this._normalOffset = i ? i.offset / 4 : -1;
                var n = e.getVertexElementByUsage(1);
                this._colorOffset = n ? n.offset / 4 : -1;
                var r = e.getVertexElementByUsage(2);
                this._uv0Offset = r ? r.offset / 4 : -1;
                var a = e.getVertexElementByUsage(7);
                this._uv1Offset = a ? a.offset / 4 : -1;
                var s = e.getVertexElementByUsage(4);
                return this._sTangentOffset = s ? s.offset / 4 : -1, !0;
            }, i._render = function (t) {
                this._bufferState.bind();
                for (var e = t.renderElement, i = e.vertexBatchVertexDeclaration, n = e.vertexBatchElementList, r = 0, a = 0, s = (i.vertexStride,
                    0), o = n.length, l = 0; l < o; l++) {
                    var h = n[l], u = h._geometry, c = u._indexCount;
                    a + c > 32e3 && (this._flush(r, a), s++, O.trianglesFaces += a / 3, r = a = 0);
                    var d = h._transform;
                    this._getBatchVertices(i, this._vertices, r, d, h, u), this._getBatchIndices(this._indices, a, r, d, u, h._dynamicMultiSubMesh),
                        r += h._dynamicVertexCount, a += c;
                }
                this._flush(r, a), s++, O.renderBatches += s, O.savedRenderBatches += o - s, O.trianglesFaces += a / 3;
            }, e.maxAllowVertexCount = 10, e.maxAllowAttribueCount = 900, e.maxIndicesCount = 32e3,
                e.instance = null, e;
        }(et), Ei = function (t) {
            function e() {
                e.__super.call(this);
                var t = new Float32Array([-.5, .5, -.5, .5, .5, -.5, .5, .5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5, -.5, -.5, .5]), i = new Uint8Array([0, 1, 2, 2, 3, 0, 4, 7, 6, 6, 5, 4, 0, 3, 7, 7, 4, 0, 1, 5, 6, 6, 2, 1, 3, 2, 6, 6, 7, 3, 0, 4, 5, 5, 1, 0]), n = bt.getVertexDeclaration("POSITION");
                this._vertexBuffer = new Ke(8 * n.vertexStride, 35044, !1), this._vertexBuffer.vertexDeclaration = n,
                    this._indexBuffer = new Ze("ubyte", 36, 35044, !1), this._vertexBuffer.setData(t),
                    this._indexBuffer.setData(i);
                var r = new Je();
                r.bind(), r.applyVertexBuffer(this._vertexBuffer), r.applyIndexBuffer(this._indexBuffer),
                    r.unBind(), this._bufferState = r;
            }
            return r(e, "laya.d3.resource.models.SkyBox", t), e.prototype._render = function (t) {
                v.instance.drawElements(4, 36, 5121, 0), O.trianglesFaces += 12, O.renderBatches++;
            }, e.__init__ = function () {
                e.instance = new e();
            }, e.instance = null, e;
        }(Mt), Ci = function (t) {
            function e() {
                this._mesh = null, this._convex = !1, e.__super.call(this);
            }
            r(e, "laya.d3.physics.shape.MeshColliderShape", t);
            var i = e.prototype;
            return i._setScale = function (t) {
                this._compoundParent ? this.updateLocalTransformations() : (j._nativeScale.setValue(t.x, t.y, t.z),
                    this._nativeShape.setLocalScaling(j._nativeScale), this._nativeShape.updateBound());
            }, i.cloneTo = function (e) {
                var i = e;
                i.convex = this._convex, i.mesh = this._mesh, t.prototype.cloneTo.call(this, e);
            }, i.clone = function () {
                var t = new e();
                return this.cloneTo(t), t;
            }, i.destroy = function () {
                this._nativeShape && (W._physics3D.destroy(this._nativeShape), this._nativeShape = null);
            }, a(0, i, "mesh", function () {
                return this._mesh;
            }, function (t) {
                if (this._mesh !== t) {
                    var e = W._physics3D;
                    this._mesh && e.destroy(this._nativeShape), t && (this._nativeShape = new e.btGImpactMeshShape(t._getPhysicMesh()),
                        this._nativeShape.updateBound()), this._mesh = t;
                }
            }), a(0, i, "convex", function () {
                return this._convex;
            }, function (t) {
                this._convex = t;
            }), e;
        }(j), xi = function (t) {
            function e() {
                this.radius = NaN, this.emitFromShell = !1, e.__super.call(this), this.radius = 1,
                    this.emitFromShell = !1, this.randomDirection = !1;
            }
            r(e, "laya.d3.core.particleShuriKen.module.shape.HemisphereShape", t);
            var i = e.prototype;
            return i._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -this.radius;
                var i = t.max;
                i.x = i.y = this.radius, i.z = 0;
            }, i._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = -1, e.z = 0;
                var i = t.max;
                i.x = i.y = i.z = 1;
            }, i.generatePositionAndDirection = function (t, e, i, n) {
                i ? (i.seed = n[16], this.emitFromShell ? Me._randomPointUnitSphere(t, i) : Me._randomPointInsideUnitSphere(t, i),
                    n[16] = i.seed) : this.emitFromShell ? Me._randomPointUnitSphere(t) : Me._randomPointInsideUnitSphere(t),
                    gt.scale(t, this.radius, t);
                var r = t.z;
                r < 0 && (t.z = -1 * r), this.randomDirection ? i ? (i.seed = n[17], Me._randomPointUnitSphere(e, i),
                    n[17] = i.seed) : Me._randomPointUnitSphere(e) : t.cloneTo(e);
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.radius = this.radius, i.emitFromShell = this.emitFromShell, i.randomDirection = this.randomDirection;
            }, e;
        }(H), bi = function (t) {
            function e(t, i, n, r, a, o, l, h) {
                this._owner = null, this._gridSize = NaN, this.memorySize = 0, this._numberVertices = 0,
                    this._maxNumberIndices = 0, this._currentNumberIndices = 0, this._numberTriangle = 0,
                    this._vertexBuffer = null, this._indexBuffer = null, this._indexArrayBuffer = null,
                    this._boundingBoxCorners = null, this._leafs = null, this._leafNum = 0, this._terrainHeightData = null,
                    this._terrainHeightDataWidth = 0, this._terrainHeightDataHeight = 0, this._chunkOffsetX = 0,
                    this._chunkOffsetZ = 0, this._cameraCoordinateInverse = !1, this._cameraPos = null,
                    this._currentLOD = 0, this._perspectiveFactor = NaN, this._LODTolerance = 0, this._boundingSphere = null,
                    this._boundingBox = null, e.__super.call(this), this._bufferState = new Je(), this._owner = t,
                    this._cameraPos = new gt(), this._chunkOffsetX = i, this._chunkOffsetZ = n, this._gridSize = r,
                    this._terrainHeightData = a, this._terrainHeightDataWidth = o, this._terrainHeightDataHeight = l,
                    this._leafNum = ct.CHUNK_GRID_NUM / ct.LEAF_GRID_NUM * (ct.CHUNK_GRID_NUM / ct.LEAF_GRID_NUM),
                    this._leafs = s(this._leafNum), this._cameraCoordinateInverse = h;
                for (var u = 0; u < this._leafNum; u++) this._leafs[u] = new ct();
                this.recreateResource();
            }
            r(e, "laya.d3.terrain.TerrainFilter", t);
            var i = e.prototype;
            return i.recreateResource = function () {
                this._currentNumberIndices = 0, this._numberTriangle = 0;
                var t = ct.LEAF_VERTEXT_COUNT, e = ct.LEAF_MAX_INDEX_COUNT;
                this._numberVertices = t * this._leafNum, this._maxNumberIndices = e * this._leafNum,
                    this._indexArrayBuffer = new Uint16Array(this._maxNumberIndices);
                var i = Zt.vertexDeclaration, n = i.vertexStride / 4, r = new Float32Array(this._numberVertices * n), a = ct.CHUNK_GRID_NUM / ct.LEAF_GRID_NUM, s = 0, o = 0, l = 0;
                for (s = 0; s < this._leafNum; s++) o = s % a, l = Math.floor(s / a), this._leafs[s].calcVertextBuffer(this._chunkOffsetX, this._chunkOffsetZ, o * ct.LEAF_GRID_NUM, l * ct.LEAF_GRID_NUM, this._gridSize, r, s * ct.LEAF_PLANE_VERTEXT_COUNT, n, this._terrainHeightData, this._terrainHeightDataWidth, this._terrainHeightDataHeight, this._cameraCoordinateInverse);
                for (s = 0; s < this._leafNum; s++) o = s % a, l = Math.floor(s / a), this._leafs[s].calcSkirtVertextBuffer(this._chunkOffsetX, this._chunkOffsetZ, o * ct.LEAF_GRID_NUM, l * ct.LEAF_GRID_NUM, this._gridSize, r, this._leafNum * ct.LEAF_PLANE_VERTEXT_COUNT + s * ct.LEAF_SKIRT_VERTEXT_COUNT, n, this._terrainHeightData, this._terrainHeightDataWidth, this._terrainHeightDataHeight);
                this.assembleIndexInit(), this._vertexBuffer = new Ke(i.vertexStride * this._numberVertices, 35044, !1),
                    this._vertexBuffer.vertexDeclaration = i, this._indexBuffer = new Ze("ushort", this._maxNumberIndices, 35044, !1),
                    this._vertexBuffer.setData(r), this._indexBuffer.setData(this._indexArrayBuffer),
                    this.memorySize = 2 * (this._vertexBuffer._byteLength + this._indexBuffer._byteLength),
                    this.calcOriginalBoudingBoxAndSphere(), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                    this._bufferState.applyIndexBuffer(this._indexBuffer), this._bufferState.unBind();
            }, i.setLODLevel = function (t) {
                if (4 != t.length) return !0;
                var e = (t[0] + 1 << 24) + (t[1] + 1 << 16) + (t[2] + 1 << 8) + (t[3] + 1);
                return this._currentLOD != e && (this._currentLOD = e, !0);
            }, i.assembleIndexInit = function () {
                this._currentNumberIndices = 0, this._numberTriangle = 0;
                for (var t = 0, e = 0; e < this._leafNum; e++) {
                    var i = ct.getPlaneLODIndex(e, 0);
                    this._indexArrayBuffer.set(i, t), t += i.length;
                    var n = ct.getSkirtLODIndex(e, 0);
                    this._indexArrayBuffer.set(n, t), t += n.length, this._currentNumberIndices += i.length + n.length;
                }
                this._numberTriangle = this._currentNumberIndices / 3;
            }, i.isNeedAssemble = function (t, e) {
                var i = Math.min(t.viewport.width, t.viewport.height) / (2 * Math.tan(Math.PI * t.fieldOfView / 180));
                return this._perspectiveFactor != i ? (this._perspectiveFactor = i, 1) : this._LODTolerance != tn.LOD_TOLERANCE_VALUE ? (this._LODTolerance = tn.LOD_TOLERANCE_VALUE,
                    1) : 0 == gt.equals(e, this._cameraPos) ? (this._cameraPos.x = e.x, this._cameraPos.y = e.y,
                        this._cameraPos.z = e.z, 2) : 0;
            }, i.assembleIndex = function (t, i) {
                var n = this.isNeedAssemble(t, i);
                if (n > 0) {
                    for (var r = 0; r < this._leafNum; r++) e._TEMP_ARRAY_BUFFER[r] = this._leafs[r].determineLod(i, this._perspectiveFactor, tn.LOD_TOLERANCE_VALUE, 1 == n);
                    if (this.setLODLevel(e._TEMP_ARRAY_BUFFER)) {
                        this._currentNumberIndices = 0, this._numberTriangle = 0;
                        var a = 0;
                        for (r = 0; r < this._leafNum; r++) {
                            var s = e._TEMP_ARRAY_BUFFER[r], o = ct.getPlaneLODIndex(r, s);
                            this._indexArrayBuffer.set(o, a), a += o.length;
                            var l = ct.getSkirtLODIndex(r, s);
                            this._indexArrayBuffer.set(l, a), a += l.length, this._currentNumberIndices += o.length + l.length;
                        }
                        return this._numberTriangle = this._currentNumberIndices / 3, !0;
                    }
                }
                return !1;
            }, i.calcOriginalBoudingBoxAndSphere = function () {
                for (var t = new yt(2147483647, -2147483647), e = 0; e < this._leafNum; e++) t.x = this._leafs[e]._sizeOfY.x < t.x ? this._leafs[e]._sizeOfY.x : t.x,
                    t.y = this._leafs[e]._sizeOfY.y > t.y ? this._leafs[e]._sizeOfY.y : t.y;
                var i = new gt(this._chunkOffsetX * ct.CHUNK_GRID_NUM * this._gridSize, t.x, this._chunkOffsetZ * ct.CHUNK_GRID_NUM * this._gridSize), n = new gt((this._chunkOffsetX + 1) * ct.CHUNK_GRID_NUM * this._gridSize, t.y, (this._chunkOffsetZ + 1) * ct.CHUNK_GRID_NUM * this._gridSize);
                ct.__ADAPT_MATRIX__ && (gt.transformV3ToV3(i, ct.__ADAPT_MATRIX__, i), gt.transformV3ToV3(n, ct.__ADAPT_MATRIX__, n)),
                    this._boundingBox = new Ue(i, n);
                var r = new gt();
                gt.subtract(n, i, r), gt.scale(r, .5, r);
                var a = new gt();
                gt.add(i, r, a), this._boundingSphere = new wt(a, gt.scalarLength(r)), this._boundingBoxCorners = s(8, null),
                    this._boundingBox.getCorners(this._boundingBoxCorners);
            }, i.calcLeafBoudingBox = function (t) {
                for (var e = 0; e < this._leafNum; e++) this._leafs[e].calcLeafBoudingBox(t);
            }, i.calcLeafBoudingSphere = function (t, e) {
                for (var i = 0; i < this._leafNum; i++) this._leafs[i].calcLeafBoudingSphere(t, e);
            }, i._getVertexBuffer = function (t) {
                return void 0 === t && (t = 0), 0 == t ? this._vertexBuffer : null;
            }, i._getIndexBuffer = function () {
                return this._indexBuffer;
            }, i._getType = function () {
                return e._type;
            }, i._prepareRender = function (t) {
                return !0;
            }, i._render = function (t) {
                this._bufferState.bind(), v.instance.drawElements(tn.RENDER_LINE_MODEL ? 1 : 4, this._currentNumberIndices, 5123, 0),
                    O.trianglesFaces += this._numberTriangle, O.renderBatches++;
            }, i.destroy = function () {
                this._owner = null, this._bufferState.destroy(), this._vertexBuffer && this._vertexBuffer.destroy(),
                    this._indexBuffer && this._indexBuffer.destroy();
            }, n(e, ["_TEMP_ARRAY_BUFFER", function () {
                return this._TEMP_ARRAY_BUFFER = new Uint32Array(ct.CHUNK_GRID_NUM / ct.LEAF_GRID_NUM * ct.CHUNK_GRID_NUM / ct.LEAF_GRID_NUM);
            }, "_type", function () {
                return this._type = et._typeCounter++;
            }]), e;
        }(et), Ii = (function (t) {
            function e() {
                this._shader = null, this._pyramid = null, this._intensity = 0, this._threshold = 1,
                    this._softKnee = .5, this._diffusion = 7, this._anamorphicRatio = 0, this._dirtIntensity = 0,
                    this.clamp = 65472, this.fastMode = !1, this.dirtTexture = null, e.__super.call(this),
                    this._shaderData = new ut(), this._linearColor = new Ct(), this._shaderThreshold = new pt(),
                    this._shaderParams = new pt(), this._shaderSetting = new pt(), this._dirtTileOffset = new pt(),
                    this.color = new Ct(1, 1, 1, 1), this._shader = Lt.find("PostProcessBloom"), this._pyramid = new Array(32);
            }
            r(e, "laya.d3.core.render.BloomEffect", t);
            var i = e.prototype;
            i.render = function (t) {
                var i = t.command, n = t.camera.viewport;
                this._shaderData.setTexture(e.SHADERVALUE_AUTOEXPOSURETEX, N.whiteTexture);
                var r, a = this._anamorphicRatio, s = a < 0 ? -a : 0, o = a > 0 ? a : 0, l = Math.floor(n.width / (2 - s)), h = Math.floor(n.height / (2 - o)), u = Math.max(l, h);
                r = Math.log2(u) + this._diffusion - 10;
                var c = Math.floor(r), d = Math.min(Math.max(c, 1), 16), _ = .5 + r - c;
                this._shaderData.setNumber(e.SHADERVALUE_SAMPLESCALE, _);
                var f = Ht.gammaToLinearSpace(this.threshold), p = f * this._softKnee + 1e-5;
                this._shaderThreshold.setValue(f, f - p, 2 * p, .25 / p), this._shaderData.setVector(e.SHADERVALUE_THRESHOLD, this._shaderThreshold);
                var m = Ht.gammaToLinearSpace(this.clamp);
                this._shaderParams.setValue(m, 0, 0, 0), this._shaderData.setVector(e.SHADERVALUE_PARAMS, this._shaderParams);
                for (var g = this.fastMode ? 1 : 0, y = t.source, v = 0; v < d; v++) {
                    var S = 2 * v, T = S + 1, E = 0 == v ? 0 + g : 2 + g, C = mn.getTemporary(l, h, 0, 3, 1), x = mn.getTemporary(l, h, 0, 3, 1);
                    this._pyramid[S] = C, this._pyramid[T] = x, i.blit(y, C, this._shader, this._shaderData, E),
                        y = C, l = Math.max(l / 2, 1), h = Math.max(h / 2, 1);
                }
                var b = this._pyramid[2 * d - 3];
                for (v = d - 2; v >= 0; v--) T = (S = 2 * v) + 1, C = this._pyramid[S], x = this._pyramid[T],
                    i.setShaderDataTexture(this._shaderData, e.SHADERVALUE_BLOOMTEX, C), i.blit(b, x, this._shader, this._shaderData, 4 + g),
                    b = x;
                var I = this._linearColor;
                this.color.toLinear(I);
                var w = Math.pow(2, this._intensity / 10) - 1, A = this._shaderSetting;
                this._shaderSetting.setValue(_, w, this._dirtIntensity, d);
                var R = R || N.blackTexture, M = R.width / R.height, D = n.width / n.height, O = this._dirtTileOffset;
                O.setValue(1, 1, 0, 0), M > D ? O.setValue(D / M, 1, .5 * (1 - O.x), 0) : M < D && O.setValue(1, M / D, 0, .5 * (1 - O.y));
                var L = t.compositeShaderData, P = t.compositeDefineData;
                for (this.fastMode ? P.add(Ie.SHADERDEFINE_BLOOM_LOW) : P.add(Ie.SHADERDEFINE_BLOOM),
                    L.setVector(Ie.SHADERVALUE_BLOOM_DIRTTILEOFFSET, O), L.setVector(Ie.SHADERVALUE_BLOOM_SETTINGS, A),
                    L.setVector(Ie.SHADERVALUE_BLOOM_COLOR, new pt(I.r, I.g, I.b, I.a)), L.setTexture(Ie.SHADERVALUE_BLOOM_DIRTTEX, R),
                    L.setTexture(Ie.SHADERVALUE_BLOOMTEX, b), v = 0; v < d; v++) T = (S = 2 * v) + 1,
                        this._pyramid[S] != b && mn.setReleaseTemporary(this._pyramid[S]), this._pyramid[T] != b && mn.setReleaseTemporary(this._pyramid[T]);
                t.tempRenderTextures.push(b);
            }, a(0, i, "softKnee", function () {
                return this._softKnee;
            }, function (t) {
                this._softKnee = Math.min(Math.max(t, 0), 1);
            }), a(0, i, "intensity", function () {
                return this._intensity;
            }, function (t) {
                this._intensity = Math.max(t, 0);
            }), a(0, i, "threshold", function () {
                return this._threshold;
            }, function (t) {
                this._threshold = Math.max(t, 0);
            }), a(0, i, "anamorphicRatio", function () {
                return this._anamorphicRatio;
            }, function (t) {
                this._anamorphicRatio = Math.min(Math.max(t, -1), 1);
            }), a(0, i, "diffusion", function () {
                return this._diffusion;
            }, function (t) {
                this._diffusion = Math.min(Math.max(t, 1), 10);
            }), a(0, i, "dirtIntensity", function () {
                return this._dirtIntensity;
            }, function (t) {
                this._dirtIntensity = Math.max(t, 0);
            }), e.SUBSHADER_PREFILTER13 = 0, e.SUBSHADER_PREFILTER4 = 1, e.SUBSHADER_DOWNSAMPLE13 = 2,
                e.SUBSHADER_DOWNSAMPLE4 = 3, e.SUBSHADER_UPSAMPLETENT = 4, e.SUBSHADER_UPSAMPLEBOX = 5,
                e.MAXPYRAMIDSIZE = 16, n(e, ["SHADERVALUE_MAINTEX", function () {
                    return this.SHADERVALUE_MAINTEX = Lt.propertyNameToID("u_MainTex");
                }, "SHADERVALUE_AUTOEXPOSURETEX", function () {
                    return this.SHADERVALUE_AUTOEXPOSURETEX = Lt.propertyNameToID("u_AutoExposureTex");
                }, "SHADERVALUE_SAMPLESCALE", function () {
                    return this.SHADERVALUE_SAMPLESCALE = Lt.propertyNameToID("u_SampleScale");
                }, "SHADERVALUE_THRESHOLD", function () {
                    return this.SHADERVALUE_THRESHOLD = Lt.propertyNameToID("u_Threshold");
                }, "SHADERVALUE_PARAMS", function () {
                    return this.SHADERVALUE_PARAMS = Lt.propertyNameToID("u_Params");
                }, "SHADERVALUE_BLOOMTEX", function () {
                    return this.SHADERVALUE_BLOOMTEX = Lt.propertyNameToID("u_BloomTex");
                }]);
        }(Bt), function (t) {
            function e() {
                this._shaderData = null, this._nameID = 0, this._texture = null, e.__super.call(this);
            }
            r(e, "laya.d3.core.render.command.SetShaderDataTextureCMD", t);
            var i = e.prototype;
            return i.run = function () {
                this._shaderData.setTexture(this._nameID, this._texture);
            }, i.recover = function () {
                e._pool.push(this), this._shaderData = null, this._nameID = 0, this._texture = null;
            }, e.create = function (t, i, n) {
                var r;
                return (r = e._pool.length > 0 ? e._pool.pop() : new e())._shaderData = t, r._nameID = i,
                    r._texture = n, r;
            }, e._pool = [], e;
        }(Q)), wi = function (t) {
            function e() {
                this.radius = NaN, this.emitFromShell = !1, e.__super.call(this), this.radius = 1,
                    this.emitFromShell = !1, this.randomDirection = !1;
            }
            r(e, "laya.d3.core.particleShuriKen.module.shape.SphereShape", t);
            var i = e.prototype;
            return i._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -this.radius;
                var i = t.max;
                i.x = i.y = i.z = this.radius;
            }, i._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = e.y = e.z = -1;
                var i = t.max;
                i.x = i.y = i.z = 1;
            }, i.generatePositionAndDirection = function (t, e, i, n) {
                i ? (i.seed = n[16], this.emitFromShell ? Me._randomPointUnitSphere(t, i) : Me._randomPointInsideUnitSphere(t, i),
                    n[16] = i.seed) : this.emitFromShell ? Me._randomPointUnitSphere(t) : Me._randomPointInsideUnitSphere(t),
                    gt.scale(t, this.radius, t), this.randomDirection ? i ? (i.seed = n[17], Me._randomPointUnitSphere(e, i),
                        n[17] = i.seed) : Me._randomPointUnitSphere(e) : t.cloneTo(e);
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.radius = this.radius, i.emitFromShell = this.emitFromShell, i.randomDirection = this.randomDirection;
            }, e;
        }(H), Ai = function (t) {
            function e() {
                e.__super.call(this), this.inTangent = new gt(), this.outTangent = new gt(), this.value = new gt();
            }
            return r(e, "laya.d3.core.Vector3Keyframe", t), e.prototype.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                this.inTangent.cloneTo(i.inTangent), this.outTangent.cloneTo(i.outTangent), this.value.cloneTo(i.value);
            }, e;
        }(ft), Ri = function (t) {
            function e(t, i) {
                this._stacks = 0, this._slices = 0, e.__super.call(this), void 0 === t && (t = 48),
                    void 0 === i && (i = 48), this._stacks = t, this._slices = i;
                for (var n = it.vertexDeclaration, r = n.vertexStride / 4, a = (this._stacks + 1) * (this._slices + 1), s = 3 * this._stacks * (this._slices + 1) * 2, o = new Float32Array(a * r), l = new Uint16Array(s), h = Math.PI / this._stacks, u = 2 * Math.PI / this._slices, c = 0, d = 0, _ = 0, f = 0; f < this._stacks + 1; f++) for (var p = Math.sin(f * h), m = Math.cos(f * h), g = 0; g < this._slices + 1; g++) {
                    var y = p * Math.sin(g * u), v = p * Math.cos(g * u);
                    o[d + 0] = y * e._radius, o[d + 1] = m * e._radius, o[d + 2] = v * e._radius, o[d + 3] = -g / this._slices + .75,
                        o[d + 4] = f / this._stacks, d += r, f != this._stacks - 1 && (l[_++] = c + 1, l[_++] = c,
                            l[_++] = c + (this._slices + 1), l[_++] = c + (this._slices + 1), l[_++] = c, l[_++] = c + this._slices,
                            c++);
                }
                this._vertexBuffer = new Ke(4 * o.length, 35044, !1), this._vertexBuffer.vertexDeclaration = n,
                    this._indexBuffer = new Ze("ushort", l.length, 35044, !1), this._vertexBuffer.setData(o),
                    this._indexBuffer.setData(l);
                var S = new Je();
                S.bind(), S.applyVertexBuffer(this._vertexBuffer), S.applyIndexBuffer(this._indexBuffer),
                    S.unBind(), this._bufferState = S;
            }
            r(e, "laya.d3.resource.models.SkyDome", t);
            var i = e.prototype;
            return i._render = function (t) {
                var e = this._indexBuffer.indexCount;
                v.instance.drawElements(4, e, 5123, 0), O.trianglesFaces += e / 3, O.renderBatches++;
            }, a(0, i, "stacks", function () {
                return this._stacks;
            }), a(0, i, "slices", function () {
                return this._slices;
            }), e.__init__ = function () {
                e.instance = new e();
            }, e._radius = 1, e.instance = null, e;
        }(Mt), Mi = function (t) {
            function e(t, i, n) {
                switch (this._radius = 1, this._height = .5, e.__super.call(this), void 0 === t && (t = .5),
                void 0 === i && (i = 1), void 0 === n && (n = 1), this._radius = t, this._height = i,
                this._orientation = n, this._type = 2, n) {
                    case 0:
                        this._nativeShape = new W._physics3D.btConeShapeX(t, i);
                        break;

                    case 1:
                        this._nativeShape = new W._physics3D.btConeShape(t, i);
                        break;

                    case 2:
                        this._nativeShape = new W._physics3D.btConeShapeZ(t, i);
                        break;

                    default:
                        throw "ConeColliderShape:unknown orientation.";
                }
            }
            r(e, "laya.d3.physics.shape.ConeColliderShape", t);
            var i = e.prototype;
            return i.clone = function () {
                var t = new e(this._radius, this._height, this._orientation);
                return this.cloneTo(t), t;
            }, a(0, i, "radius", function () {
                return this._radius;
            }), a(0, i, "height", function () {
                return this._height;
            }), a(0, i, "orientation", function () {
                return this._orientation;
            }), e;
        }(j), Di = function (t) {
            function e() {
                this.x = NaN, this.y = NaN, this.z = NaN, e.__super.call(this), this.x = 1, this.y = 1,
                    this.z = 1, this.randomDirection = !1;
            }
            r(e, "laya.d3.core.particleShuriKen.module.shape.BoxShape", t);
            var i = e.prototype;
            return i._getShapeBoundBox = function (t) {
                var e = t.min;
                e.x = .5 * -this.x, e.y = .5 * -this.y, e.z = .5 * -this.z;
                var i = t.max;
                i.x = .5 * this.x, i.y = .5 * this.y, i.z = .5 * this.z;
            }, i._getSpeedBoundBox = function (t) {
                var e = t.min;
                e.x = 0, e.y = 0, e.z = 0;
                var i = t.max;
                i.x = 0, i.y = 1, i.z = 0;
            }, i.generatePositionAndDirection = function (t, e, i, n) {
                i ? (i.seed = n[16], Me._randomPointInsideHalfUnitBox(t, i), n[16] = i.seed) : Me._randomPointInsideHalfUnitBox(t),
                    t.x = this.x * t.x, t.y = this.y * t.y, t.z = this.z * t.z, this.randomDirection ? i ? (i.seed = n[17],
                        Me._randomPointUnitSphere(e, i), n[17] = i.seed) : Me._randomPointUnitSphere(e) : (e.x = 0,
                            e.y = 0, e.z = 1);
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i.x = this.x, i.y = this.y, i.z = this.z, i.randomDirection = this.randomDirection;
            }, e;
        }(H), Oi = function (t) {
            function e() {
                e.__super.call(this), this.inTangent = new pt(), this.outTangent = new pt(), this.value = new ht();
            }
            return r(e, "laya.d3.core.QuaternionKeyframe", t), e.prototype.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                this.inTangent.cloneTo(i.inTangent), this.outTangent.cloneTo(i.outTangent), this.value.cloneTo(i.value);
            }, e;
        }(ft), Li = function (t) {
            function e(t, i, n, r, a, s, o, l, h, u, c, d, _, f) {
                this._cornerTextureCoordinate = null, this._positionStartLifeTime = null, this._velocity = null,
                    this._startColor = null, this._startSize = null, this._startRotation0 = null, this._startRotation1 = null,
                    this._startRotation2 = null, this._startLifeTime = NaN, this._time = NaN, this._startSpeed = NaN,
                    this._randoms0 = null, this._randoms1 = null, this._simulationWorldPostion = null,
                    e.__super.call(this), this._cornerTextureCoordinate = t, this._positionStartLifeTime = i,
                    this._velocity = n, this._startColor = r, this._startSize = a, this._startRotation0 = s,
                    this._startRotation1 = o, this._startRotation2 = l, this._startLifeTime = h, this._time = u,
                    this._startSpeed = c, this._randoms0 = this.random0, this._randoms1 = this.random1,
                    this._simulationWorldPostion = f;
            }
            r(e, "laya.d3.graphics.Vertex.VertexShurikenParticleBillboard", t);
            var i = e.prototype;
            return a(0, i, "cornerTextureCoordinate", function () {
                return this._cornerTextureCoordinate;
            }), a(0, i, "random1", function () {
                return this._randoms1;
            }), a(0, i, "startRotation2", function () {
                return this._startRotation2;
            }), a(0, i, "positionStartLifeTime", function () {
                return this._positionStartLifeTime;
            }), a(0, i, "velocity", function () {
                return this._velocity;
            }), a(0, i, "random0", function () {
                return this._randoms0;
            }), a(0, i, "startSize", function () {
                return this._startSize;
            }), a(0, i, "startColor", function () {
                return this._startColor;
            }), a(0, i, "startRotation0", function () {
                return this._startRotation0;
            }), a(0, i, "startRotation1", function () {
                return this._startRotation1;
            }), a(0, i, "startLifeTime", function () {
                return this._startLifeTime;
            }), a(0, i, "time", function () {
                return this._time;
            }), a(0, i, "startSpeed", function () {
                return this._startSpeed;
            }), a(0, i, "simulationWorldPostion", function () {
                return this._simulationWorldPostion;
            }), a(1, e, "vertexDeclaration", function () {
                return e._vertexDeclaration;
            }, laya.d3.graphics.Vertex.VertexShuriKenParticle._$SET_vertexDeclaration), n(e, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(152, [new Ut(0, "vector4", 0), new Ut(16, "vector4", 4), new Ut(32, "vector4", 5), new Ut(48, "vector4", 6), new Ut(64, "vector3", 8), new Ut(76, "vector3", 9), new Ut(88, "single", 10), new Ut(92, "vector4", 11), new Ut(108, "vector4", 12), new Ut(124, "vector3", 13), new Ut(136, "vector4", 14)]);
            }]), e;
        }(dt), Pi = function (t) {
            function e() {
                e.__super.call(this), this._dynamicWorldPositionNormalNeedUpdate = !0;
            }
            r(e, "laya.d3.core.render.SubMeshRenderElement", t);
            var i = e.prototype;
            return i._onWorldMatrixChanged = function () {
                this._dynamicWorldPositionNormalNeedUpdate = !0;
            }, i._computeWorldPositionsAndNormals = function (t, e, i, n) {
                if (this._dynamicWorldPositionNormalNeedUpdate) {
                    for (var r = this._geometry, a = r._vertexBuffer, s = a.vertexDeclaration.vertexStride / 4, o = a.getData(), l = this._transform.worldMatrix, h = this._transform.rotation, u = r._indices, c = 0; c < n; c++) {
                        var d = (i ? u[c] : c) * s, _ = 3 * c;
                        Ht.transformVector3ArrayToVector3ArrayCoordinate(o, d + t, l, this._dynamicWorldPositions, _),
                            -1 !== e && Ht.transformVector3ArrayByQuat(o, d + e, h, this._dynamicWorldNormals, _);
                    }
                    this._dynamicWorldPositionNormalNeedUpdate = !1;
                }
            }, i.setTransform = function (t) {
                this._transform !== t && (this._transform && this._transform.off("transformchanged", this, this._onWorldMatrixChanged),
                    t && t.on("transformchanged", this, this._onWorldMatrixChanged), this._dynamicWorldPositionNormalNeedUpdate = !0,
                    this._transform = t);
            }, i.setGeometry = function (t) {
                if (this._geometry !== t) {
                    var e = t, i = e._mesh;
                    if (i) {
                        var n = i._subMeshCount > 1, r = n ? e._indexCount : i._vertexCount;
                        if (r <= 10) {
                            var a = 3 * r;
                            this._dynamicVertexBatch = !0, this._dynamicWorldPositions = new Float32Array(a),
                                this._dynamicWorldNormals = new Float32Array(a), this._dynamicVertexCount = r, this._dynamicMultiSubMesh = n;
                        } else this._dynamicVertexBatch = !1;
                    }
                    this._geometry = t;
                }
            }, i.addToOpaqueRenderQueue = function (t, e) {
                var i = this.staticBatch, n = e.elements;
                if (i) {
                    var r = Si.instance, a = r.getBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, i._batchID);
                    if (r._updateCountMark === a.updateMark) {
                        var s = a.indexInList;
                        if (a.batched) n[s].staticBatchElementList.push(this); else {
                            var o = n[s], l = o.render, h = r._getBatchRenderElementFromPool();
                            h.renderType = 1, h.setGeometry(i), h.material = o.material;
                            var u = i.batchOwner, c = u ? u._transform : null;
                            h.setTransform(c), h.render = l;
                            var d = h.staticBatchElementList;
                            d.length = 0, d.push(o), d.push(this), n[s] = h, a.batched = !0;
                        }
                    } else a.updateMark = r._updateCountMark, a.indexInList = n.length, a.batched = !1,
                        n.push(this);
                } else if (this.material._shader._enableInstancing && k._angleInstancedArrays) {
                    var _ = this._geometry, f = oi.instance, p = f.getInstanceBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, _._id);
                    if (f._updateCountMark === p.updateMark) {
                        var m = p.indexInList;
                        if (p.batched) {
                            var g = n[m].instanceBatchElementList;
                            g.length === gi.instance.maxInstanceCount ? (p.updateMark = f._updateCountMark,
                                p.indexInList = n.length, p.batched = !1, n.push(this)) : g.push(this);
                        } else {
                            var y = n[m], v = y.render, S = f._getBatchRenderElementFromPool();
                            S.renderType = 2, S.setGeometry(gi.instance), S.material = y.material, S.setTransform(null),
                                S.render = v, S.instanceSubMesh = _;
                            var T = S.instanceBatchElementList;
                            T.length = 0, T.push(y), T.push(this), n[m] = S, p.batched = !0;
                        }
                    } else p.updateMark = f._updateCountMark, p.indexInList = n.length, p.batched = !1,
                        n.push(this);
                } else if (this._dynamicVertexBatch) {
                    var E = this._geometry._vertexBuffer.vertexDeclaration, C = oi.instance, x = C.getVertexBatchOpaquaMark(this.render.lightmapIndex + 1, this.render.receiveShadow, this.material.id, E.id);
                    if (C._updateCountMark === x.updateMark) {
                        var b = x.indexInList;
                        if (x.batched) n[b].vertexBatchElementList.push(this); else {
                            var I = n[b], w = I.render, A = C._getBatchRenderElementFromPool();
                            A.renderType = 3, A.setGeometry(Ti.instance), A.material = I.material, A.setTransform(null),
                                A.render = w, A.vertexBatchVertexDeclaration = E;
                            var R = A.vertexBatchElementList;
                            R.length = 0, R.push(I), R.push(this), n[b] = A, x.batched = !0;
                        }
                    } else x.updateMark = C._updateCountMark, x.indexInList = n.length, x.batched = !1,
                        n.push(this);
                } else n.push(this);
            }, i.addToTransparentRenderQueue = function (t, e) {
                var i = this.staticBatch, n = e.elements;
                if (i) {
                    var r = Si.instance, a = e.lastTransparentRenderElement;
                    if (a) {
                        var s = a.render;
                        if (a._geometry._getType() !== this._geometry._getType() || a.staticBatch !== i || a.material !== this.material || s.receiveShadow !== this.render.receiveShadow || s.lightmapIndex !== this.render.lightmapIndex) n.push(this),
                            e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) n[n.length - 1].staticBatchElementList.push(this); else {
                                var o = r._getBatchRenderElementFromPool();
                                o.renderType = 1, o.setGeometry(i), o.material = a.material;
                                var l = i.batchOwner, h = l ? l._transform : null;
                                o.setTransform(h), o.render = this.render;
                                var u = o.staticBatchElementList;
                                u.length = 0, u.push(a), u.push(this), n[n.length - 1] = o;
                            }
                            e.lastTransparentBatched = !0;
                        }
                    } else n.push(this), e.lastTransparentBatched = !1;
                } else if (this.material._shader._enableInstancing && k._angleInstancedArrays) {
                    var c = this._geometry, d = oi.instance, _ = e.lastTransparentRenderElement;
                    if (_) {
                        var f = _.render;
                        if (_._geometry._getType() !== this._geometry._getType() || _._geometry !== c || _.material !== this.material || f.receiveShadow !== this.render.receiveShadow || f.lightmapIndex !== this.render.lightmapIndex) n.push(this),
                            e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) n[n.length - 1].instanceBatchElementList.push(this); else {
                                var p = d._getBatchRenderElementFromPool();
                                p.renderType = 2, p.setGeometry(gi.instance), p.material = _.material, p.setTransform(null),
                                    p.render = this.render, p.instanceSubMesh = c;
                                var m = p.instanceBatchElementList;
                                m.length = 0, m.push(_), m.push(this), n[n.length - 1] = p;
                            }
                            e.lastTransparentBatched = !0;
                        }
                    } else n.push(this), e.lastTransparentBatched = !1;
                } else if (this._dynamicVertexBatch) {
                    var g = this._geometry._vertexBuffer.vertexDeclaration, y = oi.instance, v = e.lastTransparentRenderElement;
                    if (v) {
                        var S = v.render;
                        if (v._geometry._getType() !== this._geometry._getType() || v._geometry._vertexBuffer._vertexDeclaration !== g || v.material !== this.material || S.receiveShadow !== this.render.receiveShadow || S.lightmapIndex !== this.render.lightmapIndex) n.push(this),
                            e.lastTransparentBatched = !1; else {
                            if (e.lastTransparentBatched) n[n.length - 1].vertexBatchElementList.push(this); else {
                                var T = y._getBatchRenderElementFromPool();
                                T.renderType = 3, T.setGeometry(Ti.instance), T.material = v.material, T.setTransform(null),
                                    T.render = this.render, T.vertexBatchVertexDeclaration = g;
                                var E = T.vertexBatchElementList;
                                E.length = 0, E.push(v), E.push(this), n[n.length - 1] = T;
                            }
                            e.lastTransparentBatched = !0;
                        }
                    } else n.push(this), e.lastTransparentBatched = !1;
                } else n.push(this);
                e.lastTransparentRenderElement = this;
            }, i.destroy = function () {
                t.prototype.destroy.call(this), this._dynamicWorldPositions = null, this._dynamicWorldNormals = null,
                    this.staticBatch = null, this.staticBatchElementList = null, this.vertexBatchElementList = null,
                    this.vertexBatchVertexDeclaration = null;
            }, e._maxInstanceCount = 1024, n(e, ["_instanceMatrixData", function () {
                return this._instanceMatrixData = new Float32Array(16 * e._maxInstanceCount);
            }, "_instanceMatrixBuffer", function () {
                return this._instanceMatrixBuffer = new Ke(4 * e._instanceMatrixData.length, 35048);
            }]), e;
        }(At), Ni = function (t) {
            function e(t, i, n, r, a, s, o, l, h, u, c, d, _, f) {
                this._cornerTextureCoordinate = null, this._positionStartLifeTime = null, this._velocity = null,
                    this._startColor = null, this._startSize = null, this._startRotation0 = null, this._startRotation1 = null,
                    this._startRotation2 = null, this._startLifeTime = NaN, this._time = NaN, this._startSpeed = NaN,
                    this._randoms0 = null, this._randoms1 = null, this._simulationWorldPostion = null,
                    e.__super.call(this), this._cornerTextureCoordinate = t, this._positionStartLifeTime = i,
                    this._velocity = n, this._startColor = r, this._startSize = a, this._startRotation0 = s,
                    this._startRotation1 = o, this._startRotation2 = l, this._startLifeTime = h, this._time = u,
                    this._startSpeed = c, this._randoms0 = this.random0, this._randoms1 = this.random1,
                    this._simulationWorldPostion = f;
            }
            r(e, "laya.d3.graphics.Vertex.VertexShurikenParticleMesh", t);
            var i = e.prototype;
            return a(0, i, "cornerTextureCoordinate", function () {
                return this._cornerTextureCoordinate;
            }), a(0, i, "velocity", function () {
                return this._velocity;
            }), a(0, i, "position", function () {
                return this._positionStartLifeTime;
            }), a(0, i, "random0", function () {
                return this._randoms0;
            }), a(0, i, "startSize", function () {
                return this._startSize;
            }), a(0, i, "startColor", function () {
                return this._startColor;
            }), a(0, i, "startRotation0", function () {
                return this._startRotation0;
            }), a(0, i, "startRotation1", function () {
                return this._startRotation1;
            }), a(0, i, "random1", function () {
                return this._randoms1;
            }), a(0, i, "startRotation2", function () {
                return this._startRotation2;
            }), a(0, i, "startLifeTime", function () {
                return this._startLifeTime;
            }), a(0, i, "time", function () {
                return this._time;
            }), a(0, i, "startSpeed", function () {
                return this._startSpeed;
            }), a(0, i, "simulationWorldPostion", function () {
                return this._simulationWorldPostion;
            }), a(1, e, "vertexDeclaration", function () {
                return e._vertexDeclaration;
            }, laya.d3.graphics.Vertex.VertexShuriKenParticle._$SET_vertexDeclaration), n(e, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(172, [new Ut(0, "vector3", 1), new Ut(12, "vector4", 2), new Ut(28, "vector2", 3), new Ut(36, "vector4", 4), new Ut(52, "vector4", 5), new Ut(68, "vector4", 6), new Ut(84, "vector3", 8), new Ut(96, "vector3", 9), new Ut(108, "single", 10), new Ut(112, "vector4", 11), new Ut(128, "vector4", 12), new Ut(144, "vector3", 13), new Ut(156, "vector4", 14)]);
            }]), e;
        }(dt), Bi = function (t) {
            function e(t, i) {
                this._needProcessCollisions = !1, this._needProcessTriggers = !1, e.__super.call(this),
                    void 0 === i && (i = !1), this._id = ++e._uniqueIDCounter, this._transform = new Xe(this),
                    this._isStatic = i, this.layer = 0, this.name = t || "New Sprite3D";
            }
            r(e, "laya.d3.core.Sprite3D", t);
            var s = e.prototype;
            return i.imps(s, {
                "laya.resource.ICreateResource": !0
            }), s._setCreateURL = function (t) {
                this._url = B.formatURL(t);
            }, s._changeAnimatorsToLinkSprite3D = function (t, e, i) {
                var n = this.getComponent(Ye);
                if (n && (n.avatar || t._changeAnimatorToLinkSprite3DNoAvatar(n, e, i)), this._parent && this._parent instanceof laya.d3.core.Sprite3D) {
                    i.unshift(this._parent.name);
                    var r = this._parent;
                    r._hierarchyAnimator && r._changeAnimatorsToLinkSprite3D(t, e, i);
                }
            }, s._setHierarchyAnimator = function (t, e) {
                this._changeHierarchyAnimator(t), this._changeAnimatorAvatar(t.avatar);
                for (var i = 0, n = this._children.length; i < n; i++) {
                    var r = this._children[i];
                    r._hierarchyAnimator == e && r._setHierarchyAnimator(t, e);
                }
            }, s._clearHierarchyAnimator = function (t, e) {
                this._changeHierarchyAnimator(e), this._changeAnimatorAvatar(e ? e.avatar : null);
                for (var i = 0, n = this._children.length; i < n; i++) {
                    var r = this._children[i];
                    r._hierarchyAnimator == t && r._clearHierarchyAnimator(t, e);
                }
            }, s._changeHierarchyAnimatorAvatar = function (t, e) {
                this._changeAnimatorAvatar(e);
                for (var i = 0, n = this._children.length; i < n; i++) {
                    var r = this._children[i];
                    r._hierarchyAnimator == t && r._changeHierarchyAnimatorAvatar(t, e);
                }
            }, s._changeAnimatorToLinkSprite3DNoAvatar = function (t, e, i) {
                t._handleSpriteOwnersBySprite(e, i, this);
                for (var n = 0, r = this._children.length; n < r; n++) {
                    var a = this._children[n], s = i.length;
                    i.push(a.name), a._changeAnimatorToLinkSprite3DNoAvatar(t, e, i), i.splice(s, 1);
                }
            }, s._changeHierarchyAnimator = function (t) {
                this._hierarchyAnimator = t;
            }, s._changeAnimatorAvatar = function (t) { }, s._onAdded = function () {
                if (this._parent instanceof laya.d3.core.Sprite3D) {
                    var e = this._parent;
                    this.transform._setParent(e.transform), e._hierarchyAnimator && (!this._hierarchyAnimator && this._setHierarchyAnimator(e._hierarchyAnimator, null),
                        e._changeAnimatorsToLinkSprite3D(this, !0, [this.name]));
                }
                t.prototype._onAdded.call(this);
            }, s._onRemoved = function () {
                if (t.prototype._onRemoved.call(this), this._parent instanceof laya.d3.core.Sprite3D) {
                    var e = this._parent;
                    this.transform._setParent(null), e._hierarchyAnimator && (this._hierarchyAnimator == e._hierarchyAnimator && this._clearHierarchyAnimator(e._hierarchyAnimator, null),
                        e._changeAnimatorsToLinkSprite3D(this, !1, [this.name]));
                }
            }, s._parse = function (t, e) {
                if (void 0 !== t.isStatic && (this._isStatic = t.isStatic), void 0 !== t.active && (this.active = t.active),
                    null != t.name && (this.name = t.name), void 0 !== t.position) {
                    var i = this.transform.localPosition;
                    i.fromArray(t.position), this.transform.localPosition = i;
                }
                if (void 0 !== t.rotationEuler) {
                    var n = this.transform.localRotationEuler;
                    n.fromArray(t.rotationEuler), this.transform.localRotationEuler = n;
                }
                if (void 0 !== t.rotation) {
                    var r = this.transform.localRotation;
                    r.fromArray(t.rotation), this.transform.localRotation = r;
                }
                if (void 0 !== t.scale) {
                    var a = this.transform.localScale;
                    a.fromArray(t.scale), this.transform.localScale = a;
                }
                null != t.layer && (this.layer = t.layer);
            }, s._cloneTo = function (e, i, n) {
                if (this.destroyed) throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");
                var r = e;
                r.name = this.name, r.destroyed = this.destroyed, r.active = this.active;
                var a = r.transform.localPosition;
                this.transform.localPosition.cloneTo(a), r.transform.localPosition = a;
                var s = r.transform.localRotation;
                this.transform.localRotation.cloneTo(s), r.transform.localRotation = s;
                var o = r.transform.localScale;
                this.transform.localScale.cloneTo(o), r.transform.localScale = o, r._isStatic = this._isStatic,
                    r.layer = this.layer, t.prototype._cloneTo.call(this, r, i, n);
            }, s.clone = function () {
                var t = e._createSprite3DInstance(this);
                return e._parseSprite3DInstance(this, t, this, t), t;
            }, s.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._transform = null, this._scripts = null, this._url && T.clearRes(this._url));
            }, a(0, s, "id", function () {
                return this._id;
            }), a(0, s, "url", function () {
                return this._url;
            }), a(0, s, "layer", function () {
                return this._layer;
            }, function (t) {
                if (this._layer !== t) {
                    if (!(t >= 0 && t <= 30)) throw new Error("Layer value must be 0-30.");
                    this._layer = t;
                }
            }), a(0, s, "transform", function () {
                return this._transform;
            }), a(0, s, "isStatic", function () {
                return this._isStatic;
            }), e._parse = function (t, e, i) {
                var n, r = t.data, a = [];
                switch (t.version) {
                    case "LAYAHIERARCHY:02":
                        n = Ht._createNodeByJson02(r, a);
                        break;

                    default:
                        n = Ht._createNodeByJson(r, a);
                }
                return Z.combine(n, a), n;
            }, e.__init__ = function () { }, e.instantiate = function (t, e, i, n, r) {
                void 0 === i && (i = !0);
                var a = t.clone();
                e && e.addChild(a);
                var s = a.transform;
                if (i) {
                    var o = s.worldMatrix;
                    t.transform.worldMatrix.cloneTo(o), s.worldMatrix = o;
                } else n && (s.position = n), r && (s.rotation = r);
                return a;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "HIERARCHY");
            }, e._createSprite3DInstance = function (t) {
                for (var i = new t.constructor(), n = t._children, r = 0, a = n.length; r < a; r++) {
                    var s = e._createSprite3DInstance(n[r]);
                    i.addChild(s);
                }
                return i;
            }, e._parseSprite3DInstance = function (t, i, n, r) {
                for (var a = n._children, s = r._children, o = 0, l = a.length; o < l; o++) e._parseSprite3DInstance(t, i, a[o], s[o]);
                n._cloneTo(r, t, i);
            }, e._uniqueIDCounter = 0, n(e, ["WORLDMATRIX", function () {
                return this.WORLDMATRIX = Lt.propertyNameToID("u_WorldMat");
            }, "MVPMATRIX", function () {
                return this.MVPMATRIX = Lt.propertyNameToID("u_MvpMatrix");
            }]), e;
        }(x), Fi = function (t) {
            function e() {
                this._shaderValues = null, e.__super.call(this), this._defineDatas = new Vt(), this._disablePublicDefineDatas = new Vt(),
                    this._shaderValues = new ut(this), this.renderQueue = 2e3, this._alphaTest = !1;
            }
            r(e, "laya.d3.core.material.BaseMaterial", t);
            var s = e.prototype;
            return i.imps(s, {
                "laya.d3.core.IClone": !0
            }), s._removeTetxureReference = function () {
                var t = this._shaderValues.getData();
                for (var e in t) {
                    var i = t[e];
                    i && i instanceof laya.resource.BaseTexture && i._removeReference();
                }
            }, s._addReference = function (e) {
                void 0 === e && (e = 1), t.prototype._addReference.call(this, e);
                var i = this._shaderValues.getData();
                for (var n in i) {
                    var r = i[n];
                    r && r instanceof laya.resource.BaseTexture && r._addReference();
                }
            }, s._removeReference = function (e) {
                void 0 === e && (e = 1), t.prototype._removeReference.call(this, e), this._removeTetxureReference();
            }, s._disposeResource = function () {
                this._referenceCount > 0 && this._removeTetxureReference(), this._shaderValues = null;
            }, s.setShaderName = function (t) {
                if (this._shader = Lt.find(t), !this._shader) throw new Error("BaseMaterial: unknown shader name.");
            }, s.cloneTo = function (t) {
                var e = t;
                e.name = this.name, e.renderQueue = this.renderQueue, this._disablePublicDefineDatas.cloneTo(e._disablePublicDefineDatas),
                    this._defineDatas.cloneTo(e._defineDatas), this._shaderValues.cloneTo(e._shaderValues);
            }, s.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, s, "alphaTestValue", function () {
                return this._shaderValues.getNumber(e.ALPHATESTVALUE);
            }, function (t) {
                this._shaderValues.setNumber(e.ALPHATESTVALUE, t);
            }), a(0, s, "alphaTest", function () {
                return this._alphaTest;
            }, function (t) {
                this._alphaTest = t, t ? this._defineDatas.add(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST) : this._defineDatas.remove(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST);
            }), e.load = function (t, e) {
                i.loader.create(t, e, null, "MATERIAL");
            }, e.__init__ = function () {
                e.SHADERDEFINE_ALPHATEST = e.shaderDefines.registerDefine("ALPHATEST");
            }, e._parse = function (t, e, i) {
                var n, r = t, a = r.props, s = a.type.split("."), o = l.window;
                if (s.forEach(function (t) {
                    o = o[t];
                }), "function" != typeof o) throw "_getSprite3DHierarchyInnerUrls 错误: " + t.type + " 不是类";
                switch (n = new o(), r.version) {
                    case "LAYAMATERIAL:01":
                    case "LAYAMATERIAL:02":
                        var h = 0, u = 0;
                        for (var c in a) switch (c) {
                            case "vectors":
                                var d = a[c];
                                for (h = 0, u = d.length; h < u; h++) {
                                    var _ = d[h], f = _.value;
                                    switch (f.length) {
                                        case 2:
                                            n[_.name] = new yt(f[0], f[1]);
                                            break;

                                        case 3:
                                            n[_.name] = new gt(f[0], f[1], f[2]);
                                            break;

                                        case 4:
                                            n[_.name] = new pt(f[0], f[1], f[2], f[3]);
                                            break;

                                        default:
                                            throw new Error("BaseMaterial:unkonwn color length.");
                                    }
                                }
                                break;

                            case "textures":
                                var p = a[c];
                                for (h = 0, u = p.length; h < u; h++) {
                                    var m = p[h], g = m.path;
                                    g && (n[m.name] = T.getRes(g));
                                }
                                break;

                            case "defines":
                                var y = a[c];
                                for (h = 0, u = y.length; h < u; h++) {
                                    var v = n._shader.getSubShaderAt(0).getMaterialDefineByName(y[h]);
                                    n._defineDatas.add(v);
                                }
                                break;

                            case "renderStates":
                                var S = a[c][0], E = n;
                                E.blend = S.blend, E.cull = S.cull, E.depthTest = S.depthTest, E.depthWrite = S.depthWrite,
                                    E.blendSrc = S.srcBlend, E.blendDst = S.dstBlend;
                                break;

                            case "cull":
                                n.cull = a[c];
                                break;

                            case "blend":
                                n.blend = a[c];
                                break;

                            case "depthWrite":
                                n.depthWrite = a[c];
                                break;

                            case "srcBlend":
                                n.blendSrc = a[c];
                                break;

                            case "dstBlend":
                                n.blendDst = a[c];
                                break;

                            default:
                                n[c] = a[c];
                        }
                        break;

                    default:
                        throw new Error("BaseMaterial:unkonwn version.");
                }
                return n;
            }, e.RENDERQUEUE_OPAQUE = 2e3, e.RENDERQUEUE_ALPHATEST = 2450, e.RENDERQUEUE_TRANSPARENT = 3e3,
                e.SHADERDEFINE_ALPHATEST = 0, n(e, ["ALPHATESTVALUE", function () {
                    return this.ALPHATESTVALUE = Lt.propertyNameToID("u_AlphaTestValue");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt();
                }]), e;
        }(w), ki = function (t) {
            function e() {
                this._vertexBuffer = null, e.__super.call(this), this._bufferState = new Je(), this._vertexBuffer = new Ke(64, 35044, !1),
                    this._vertexBuffer.vertexDeclaration = laya.d3.core.render.ScreenQuad._vertexDeclaration,
                    this._vertexBuffer.setData(e._vertices), this._bufferState.bind(), this._bufferState.applyVertexBuffer(this._vertexBuffer),
                    this._bufferState.unBind(), this._setGPUMemory(this._vertexBuffer._byteLength);
            }
            r(e, "laya.d3.core.render.ScreenQuad", t);
            var i = e.prototype;
            return i.render = function () {
                this._bufferState.bind(), v.instance.drawArrays(5, 0, 4), O.renderBatches++;
            }, i.destroy = function () {
                t.prototype.destroy.call(this), this._bufferState.destroy(), this._vertexBuffer.destroy(),
                    this._setGPUMemory(0);
            }, e.__init__ = function () {
                e.instance = new e(), e.instance.lock = !0;
            }, e.SCREENQUAD_POSITION_UV = 0, e.instance = null, n(e, ["_vertexDeclaration", function () {
                return this._vertexDeclaration = new fe(16, [new Ut(0, "vector4", 0)]);
            }, "_vertices", function () {
                return this._vertices = new Float32Array([1, 1, 1, 0, 1, -1, 1, 1, -1, 1, 0, 0, -1, -1, 0, 1]);
            }]), e;
        }(w), Vi = function (t) {
            function e() {
                this._rootNode = null, this._nativeNodeCount = 0, this._nativeCurCloneCount = 0,
                    e.__super.call(this);
            }
            r(e, "laya.d3.core.Avatar", t);
            var n = e.prototype;
            return i.imps(n, {
                "laya.d3.core.IClone": !0
            }), n._initCloneToAnimator = function (t, e) {
                e._avatarNodeMap[t.name] = t;
                for (var i = 0, n = t.getChildCount(); i < n; i++) this._initCloneToAnimator(t.getChildByIndex(i), e);
            }, n._parseNode = function (t, e) {
                var i = t.props.name;
                e.name = i;
                var n = t.props, r = e.transform, a = r.localPosition, s = r.localRotation, o = r.localScale;
                a.fromArray(n.translate), s.fromArray(n.rotation), o.fromArray(n.scale), r.localPosition = a,
                    r.localRotation = s, r.localScale = o;
                for (var l = t.child, h = 0, u = l.length; h < u; h++) {
                    var c = l[h], d = new be(new Float32Array(3), new Float32Array(4), new Float32Array(3), new Float32Array(16));
                    e.addChild(d), I.supportWebGLPlusAnimation && this._nativeNodeCount++, this._parseNode(c, d);
                }
            }, n._cloneDatasToAnimator = function (t) {
                var e;
                e = this._rootNode.clone();
                var i = this._rootNode.transform, n = e.transform, r = n.localPosition, a = n.localRotation, s = n.localScale;
                i.localPosition.cloneTo(r), i.localRotation.cloneTo(a), i.localScale.cloneTo(s),
                    n.localPosition = r, n.localRotation = a, n.localScale = s, t._avatarNodeMap = {},
                    this._initCloneToAnimator(e, t);
            }, n.cloneTo = function (t) {
                var e = t, i = this._rootNode.clone();
                e._rootNode = i;
            }, n.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, n._cloneDatasToAnimatorNative = function (t) {
                var e = new Float32Array(3 * this._nativeNodeCount), i = new Float32Array(4 * this._nativeNodeCount), n = new Float32Array(3 * this._nativeNodeCount), r = new Float32Array(16 * this._nativeNodeCount), a = new Int16Array(this._nativeNodeCount);
                t._animationNodeLocalPositions = e, t._animationNodeLocalRotations = i, t._animationNodeLocalScales = n,
                    t._animationNodeWorldMatrixs = r, t._animationNodeParentIndices = a, this._nativeCurCloneCount = 0;
                var s = this._rootNode._cloneNative(e, i, n, r, a, -1, this), o = this._rootNode.transform, l = s.transform, h = l.localPosition, u = l.localRotation, c = l.localScale;
                o.localPosition.cloneTo(h), o.localRotation.cloneTo(u), o.localScale.cloneTo(c),
                    l.localPosition = h, l.localRotation = u, l.localScale = c, t._avatarNodeMap = {},
                    this._initCloneToAnimator(s, t);
            }, e._parse = function (t, i, n) {
                var r = new e();
                if (r._rootNode = new be(new Float32Array(3), new Float32Array(4), new Float32Array(3), new Float32Array(16)),
                    I.supportWebGLPlusAnimation && r._nativeNodeCount++, t.version) {
                    var a = t.rootNode;
                    a && r._parseNode(a, r._rootNode);
                }
                return r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "AVATAR");
            }, e;
        }(w), Ui = function (t) {
            function e() {
                this._nativeTriangleMesh = null, this._bounds = null, this._subMeshCount = 0, this._subMeshes = null,
                    this._vertexBuffers = null, this._indexBuffer = null, this._boneNames = null, this._inverseBindPoses = null,
                    this._inverseBindPosesBuffer = null, this._bindPoseIndices = null, this._skinDataPathMarks = null,
                    this._vertexCount = 0, this._tempVector30 = new gt(), this._tempVector31 = new gt(),
                    this._tempVector32 = new gt(), this._bufferState = new Je(), this._instanceBufferState = new Je(),
                    e.__super.call(this), this._subMeshes = [], this._vertexBuffers = [], this._skinDataPathMarks = [];
            }
            r(e, "laya.d3.resource.models.Mesh", t);
            var o = e.prototype;
            return i.imps(o, {
                "laya.d3.core.IClone": !0
            }), o._getPositionElement = function (t) {
                for (var e = t.vertexDeclaration.vertexElements, i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    if ("vector3" === r.elementFormat && 0 === r.elementUsage) return r;
                }
                return null;
            }, o._generateBoundingObject = function () {
                var t = this._tempVector30, e = this._tempVector31;
                t.x = t.y = t.z = Number.MAX_VALUE, e.x = e.y = e.z = -Number.MAX_VALUE;
                for (var i = this._vertexBuffers.length, n = 0; n < i; n++) for (var r = this._vertexBuffers[n], a = this._getPositionElement(r), s = r.getData(), o = r.vertexDeclaration.vertexStride / 4, l = a.offset / 4, h = 0, u = s.length; h < u; h += o) {
                    var c = h + l, d = s[c], _ = s[c + 1], f = s[c + 2];
                    t.x = Math.min(t.x, d), t.y = Math.min(t.y, _), t.z = Math.min(t.z, f), e.x = Math.max(e.x, d),
                        e.y = Math.max(e.y, _), e.z = Math.max(e.z, f);
                }
                this._bounds = new Ce(t, e);
            }, o._setSubMeshes = function (t) {
                this._subMeshes = t, this._subMeshCount = t.length;
                for (var e = 0; e < this._subMeshCount; e++) t[e]._indexInMesh = e;
                this._generateBoundingObject();
            }, o._getSubMesh = function (t) {
                return this._subMeshes[t];
            }, o._setBuffer = function (t, e) {
                var i = this._bufferState;
                i.bind(), i.applyVertexBuffers(t), i.applyIndexBuffer(e), i.unBind();
                var n = this._instanceBufferState;
                n.bind(), n.applyVertexBuffers(t), n.applyInstanceVertexBuffer(gi.instance.instanceWorldMatrixBuffer),
                    n.applyInstanceVertexBuffer(gi.instance.instanceMVPMatrixBuffer), n.applyIndexBuffer(e),
                    n.unBind();
            }, o._disposeResource = function () {
                for (var t = 0, e = this._subMeshes.length; t < e; t++) this._subMeshes[t].destroy();
                for (this._nativeTriangleMesh && W._physics3D.destroy(this._nativeTriangleMesh),
                    t = 0, e = this._vertexBuffers.length; t < e; t++) this._vertexBuffers[t].destroy();
                this._indexBuffer.destroy(), this._setCPUMemory(0), this._setGPUMemory(0), this._bufferState.destroy(),
                    this._instanceBufferState.destroy(), this._bufferState = null, this._instanceBufferState = null,
                    this._vertexBuffers = null, this._indexBuffer = null, this._subMeshes = null, this._nativeTriangleMesh = null,
                    this._vertexBuffers = null, this._indexBuffer = null, this._boneNames = null, this._inverseBindPoses = null;
            }, o._getPhysicMesh = function () {
                if (!this._nativeTriangleMesh) {
                    for (var t = new W._physics3D.btTriangleMesh(), i = e._nativeTempVector30, n = e._nativeTempVector31, r = e._nativeTempVector32, a = this._tempVector30, s = this._tempVector31, o = this._tempVector32, l = this._vertexBuffers[0], h = this._getPositionElement(l), u = l.getData(), c = l.vertexDeclaration.vertexStride / 4, d = h.offset / 4, _ = this._indexBuffer.getData(), f = 0, p = _.length; f < p; f += 3) {
                        var m = _[f] * c + d, g = _[f + 1] * c + d, y = _[f + 2] * c + d;
                        a.setValue(u[m], u[m + 1], u[m + 2]), s.setValue(u[g], u[g + 1], u[g + 2]), o.setValue(u[y], u[y + 1], u[y + 2]),
                            Ht._convertToBulletVec3(a, i, !0), Ht._convertToBulletVec3(s, n, !0), Ht._convertToBulletVec3(o, r, !0),
                            t.addTriangle(i, n, r, !0);
                    }
                    this._nativeTriangleMesh = t;
                }
                return this._nativeTriangleMesh;
            }, o.cloneTo = function (t) {
                for (var e = t, i = 0; i < this._vertexBuffers.length; i++) {
                    var n = this._vertexBuffers[i], r = new Ke(n._byteLength, n.bufferUsage, n.canRead);
                    r.vertexDeclaration = n.vertexDeclaration, r.setData(n.getData().slice()), e._vertexBuffers.push(r),
                        e._vertexCount += r.vertexCount;
                }
                var a = this._indexBuffer, o = new Ze("ushort", a.indexCount, a.bufferUsage, a.canRead);
                o.setData(a.getData().slice()), e._indexBuffer = o, e._setBuffer(e._vertexBuffers, o),
                    e._setCPUMemory(this.cpuMemory), e._setGPUMemory(this.gpuMemory);
                var l = this._boneNames, h = e._boneNames = s(l.length);
                for (i = 0; i < l.length; i++) h[i] = l[i];
                var u = this._inverseBindPoses, c = e._inverseBindPoses = s(u.length);
                for (i = 0; i < u.length; i++) c[i] = u[i];
                for (e._bindPoseIndices = new Uint16Array(this._bindPoseIndices), i = 0; i < this._skinDataPathMarks.length; i++) e._skinDataPathMarks[i] = this._skinDataPathMarks[i].slice();
                for (i = 0; i < this.subMeshCount; i++) {
                    var d = this._subMeshes[i], _ = d._subIndexBufferStart, f = d._subIndexBufferCount, p = d._boneIndicesList, m = new ai(e);
                    m._subIndexBufferStart.length = _.length, m._subIndexBufferCount.length = f.length,
                        m._boneIndicesList.length = p.length;
                    for (var g = 0; g < _.length; g++) m._subIndexBufferStart[g] = _[g];
                    for (g = 0; g < f.length; g++) m._subIndexBufferCount[g] = f[g];
                    for (g = 0; g < p.length; g++) m._boneIndicesList[g] = new Uint16Array(p[g]);
                    m._indexBuffer = o, m._indexStart = d._indexStart, m._indexCount = d._indexCount,
                        m._indices = new Uint16Array(o.getData().buffer, 2 * d._indexStart, d._indexCount);
                    var y = e._vertexBuffers[0];
                    m._vertexBuffer = y, e._subMeshes.push(m);
                }
                e._setSubMeshes(e._subMeshes);
            }, o.clone = function () {
                var t = new this.constructor();
                return this.cloneTo(t), t;
            }, a(0, o, "inverseAbsoluteBindPoses", function () {
                return this._inverseBindPoses;
            }), a(0, o, "vertexCount", function () {
                return this._vertexCount;
            }), a(0, o, "subMeshCount", function () {
                return this._subMeshCount;
            }), a(0, o, "bounds", function () {
                return this._bounds;
            }), e._parse = function (t, i, n) {
                var r = new e();
                return Tt.read(t, r, r._subMeshes), r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "MESH");
            }, n(e, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new W._physics3D.btVector3(0, 0, 0);
            }, "_nativeTempVector31", function () {
                return this._nativeTempVector31 = new W._physics3D.btVector3(0, 0, 0);
            }, "_nativeTempVector32", function () {
                return this._nativeTempVector32 = new W._physics3D.btVector3(0, 0, 0);
            }]), e;
        }(w), Gi = function (t) {
            function e(t, i, n, r) {
                this._terrainHeightData = null, this._width = 0, this._height = 0, this._bitType = 0,
                    this._value = NaN, e.__super.call(this), this._width = t, this._height = i, this._bitType = n,
                    this._value = r;
            }
            return r(e, "laya.d3.terrain.TerrainHeightData", t), e._pharse = function (t, i, n) {
                var r, a = new e(n[0], n[1], n[2], n[3]), s = NaN;
                8 == a._bitType ? (r = new Uint8Array(t), s = 1 / 255) : 16 == a._bitType && (r = new Int16Array(t),
                    s = 1 / 32766), a._terrainHeightData = new Float32Array(a._height * a._width);
                for (var o = 0, l = a._height * a._width; o < l; o++) a._terrainHeightData[o] = r[o] * s * a._value / 2;
            }, e.load = function (t, e, n, r, a, s) {
                i.loader.create(t, e, null, "TERRAINHEIGHTDATA", [n, r, a, s], null, 1, !1);
            }, e;
        }(w), zi = function (t) {
            function e() {
                e.__super.call(this), this._nodes = new Qt(), this._events = [];
            }
            r(e, "laya.d3.animation.AnimationClip", t);
            var a = e.prototype;
            return a.duration = function () {
                return this._duration;
            }, a._hermiteInterpolate = function (t, e, i, n) {
                var r = t.outTangent, a = e.inTangent;
                if (Number.isFinite(r) && Number.isFinite(a)) {
                    var s = i * i, o = s * i, l = o - 2 * s + i, h = o - s, u = -2 * o + 3 * s;
                    return (2 * o - 3 * s + 1) * t.value + l * r * n + h * a * n + u * e.value;
                }
                return t.value;
            }, a._hermiteInterpolateVector3 = function (t, e, i, n, r) {
                var a = t.value, s = t.outTangent, o = e.value, l = e.inTangent, h = i * i, u = h * i, c = 2 * u - 3 * h + 1, d = u - 2 * h + i, _ = u - h, f = -2 * u + 3 * h, p = s.x, m = l.x;
                Number.isFinite(p) && Number.isFinite(m) ? r.x = c * a.x + d * p * n + _ * m * n + f * o.x : r.x = a.x,
                    p = s.y, m = l.y, Number.isFinite(p) && Number.isFinite(m) ? r.y = c * a.y + d * p * n + _ * m * n + f * o.y : r.y = a.y,
                    p = s.z, m = l.z, Number.isFinite(p) && Number.isFinite(m) ? r.z = c * a.z + d * p * n + _ * m * n + f * o.z : r.z = a.z;
            }, a._hermiteInterpolateQuaternion = function (t, e, i, n, r) {
                var a = t.value, s = t.outTangent, o = e.value, l = e.inTangent, h = i * i, u = h * i, c = 2 * u - 3 * h + 1, d = u - 2 * h + i, _ = u - h, f = -2 * u + 3 * h, p = s.x, m = l.x;
                Number.isFinite(p) && Number.isFinite(m) ? r.x = c * a.x + d * p * n + _ * m * n + f * o.x : r.x = a.x,
                    p = s.y, m = l.y, Number.isFinite(p) && Number.isFinite(m) ? r.y = c * a.y + d * p * n + _ * m * n + f * o.y : r.y = a.y,
                    p = s.z, m = l.z, Number.isFinite(p) && Number.isFinite(m) ? r.z = c * a.z + d * p * n + _ * m * n + f * o.z : r.z = a.z,
                    p = s.w, m = l.w, Number.isFinite(p) && Number.isFinite(m) ? r.w = c * a.w + d * p * n + _ * m * n + f * o.w : r.w = a.w;
            }, a._evaluateClipDatasRealTime = function (t, i, n, r, a) {
                for (var s = 0, o = t.count; s < o; s++) {
                    var l = t.getNodeByIndex(s), h = l.type, u = 0, c = l._keyFrames, d = c.length, _ = n[s];
                    if (a) for (-1 !== _ && i < c[_].time && (_ = -1, n[s] = _), u = _ + 1; u < d && !(c[u].time > i);) _++,
                        u++, n[s] = _; else for ((u = _ + 1) !== d && i > c[u].time && (_ = d - 1, n[s] = _),
                            u = _ + 1; _ > -1 && !(c[_].time < i);) _--, u--, n[s] = _;
                    var f = u === d;
                    switch (h) {
                        case 0:
                            if (-1 !== _) {
                                var p = c[_];
                                if (f) l.data = p.value; else {
                                    var m = c[u], g = m.time - p.time, y = NaN;
                                    y = 0 !== g ? (i - p.time) / g : 0, l.data = this._hermiteInterpolate(p, m, y, g);
                                }
                            } else l.data = c[0].value;
                            r && (l.data -= c[0].value);
                            break;

                        case 1:
                        case 4:
                            var v = l.data;
                            if (this._evaluateFrameNodeVector3DatasRealTime(c, _, f, i, v), r) {
                                var S = c[0].value;
                                v.x -= S.x, v.y -= S.y, v.z -= S.z;
                            }
                            break;

                        case 2:
                            var T = l.data;
                            if (this._evaluateFrameNodeQuaternionDatasRealTime(c, _, f, i, T), r) {
                                var E = e._tempQuaternion0, C = c[0].value;
                                Ht.quaternionConjugate(C, E), ht.multiply(E, T, T);
                            }
                            break;

                        case 3:
                            v = l.data, this._evaluateFrameNodeVector3DatasRealTime(c, _, f, i, v), r && (S = c[0].value,
                                v.x /= S.x, v.y /= S.y, v.z /= S.z);
                            break;

                        default:
                            throw "AnimationClip:unknown node type.";
                    }
                }
            }, a._evaluateClipDatasRealTimeForNative = function (t, e, i, n) {
                v.instance.evaluateClipDatasRealTime(t._nativeObj, e, i, n);
            }, a._evaluateFrameNodeVector3DatasRealTime = function (t, e, i, n, r) {
                if (-1 !== e) {
                    var a = t[e];
                    if (i) {
                        var s = a.value;
                        r.x = s.x, r.y = s.y, r.z = s.z;
                    } else {
                        var o = t[e + 1], l = NaN, h = a.time, u = o.time - h;
                        l = 0 !== u ? (n - h) / u : 0, this._hermiteInterpolateVector3(a, o, l, u, r);
                    }
                } else {
                    var c = t[0].value;
                    r.x = c.x, r.y = c.y, r.z = c.z;
                }
            }, a._evaluateFrameNodeQuaternionDatasRealTime = function (t, e, i, n, r) {
                if (-1 !== e) {
                    var a = t[e];
                    if (i) {
                        var s = a.value;
                        r.x = s.x, r.y = s.y, r.z = s.z, r.w = s.w;
                    } else {
                        var o = t[e + 1], l = NaN, h = a.time, u = o.time - h;
                        l = 0 !== u ? (n - h) / u : 0, this._hermiteInterpolateQuaternion(a, o, l, u, r);
                    }
                } else {
                    var c = t[0].value;
                    r.x = c.x, r.y = c.y, r.z = c.z, r.w = c.w;
                }
            }, a._binarySearchEventIndex = function (t) {
                for (var e = 0, i = this._events.length - 1, n = 0; e <= i;) {
                    n = Math.floor((e + i) / 2);
                    var r = this._events[n].time;
                    if (r == t) return n;
                    r > t ? i = n - 1 : e = n + 1;
                }
                return e;
            }, a.addEvent = function (t) {
                var e = this._binarySearchEventIndex(t.time);
                this._events.splice(e, 0, t);
            }, a._disposeResource = function () {
                this._nodes = null, this._nodesMap = null;
            }, e._parse = function (t, i, n) {
                var r = new e(), a = new c(t), s = a.readUTFString();
                switch (s) {
                    case "LAYAANIMATION:03":
                        kt.parse(r, a);
                        break;

                    case "LAYAANIMATION:04":
                    case "LAYAANIMATION:COMPRESSION_04":
                        Ft.parse(r, a, s);
                        break;

                    default:
                        throw "unknown animationClip version.";
                }
                return r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "ANIMATIONCLIP");
            }, n(e, ["_tempQuaternion0", function () {
                return this._tempQuaternion0 = new ht();
            }]), e;
        }(w), Hi = function (t) {
            function e(t, i, n, r, a) {
                this._stateParamsMap = [], this._uploadMark = -1, this._uploadRenderType = -1, e.__super.call(this),
                    this._vs = t, this._ps = i, this._attributeMap = n, this._uniformMap = r, this._shaderPass = a,
                    this._create(), this.lock = !0;
            }
            r(e, "laya.d3.shader.ShaderInstance", t);
            var i = e.prototype;
            return i._create = function () {
                var t = v.instance;
                for (var e in this._program = t.createProgram(), this._vshader = this._createShader(t, this._vs, 35633),
                    this._pshader = this._createShader(t, this._ps, 35632), t.attachShader(this._program, this._vshader),
                    t.attachShader(this._program, this._pshader), this._attributeMap) t.bindAttribLocation(this._program, this._attributeMap[e], e);
                if (t.linkProgram(this._program), !I.isConchApp && Lt.debugMode && !t.getProgramParameter(this._program, 35714)) throw t.getProgramInfoLog(this._program);
                var i = [], n = [], r = [], a = [], s = [];
                this._customUniformParamsMap = [];
                var o = t.getProgramParameter(this._program, 35718);
                k.useProgram(t, this._program), this._curActTexIndex = 0;
                var l, h = 0, u = 0;
                for (h = 0; h < o; h++) {
                    var c = t.getActiveUniform(this._program, h), d = c.name;
                    (l = new Se()).location = t.getUniformLocation(this._program, d), d.indexOf("[0]") > 0 ? (l.name = d = d.substr(0, d.length - 3),
                        l.isArray = !0) : (l.name = d, l.isArray = !1), l.type = c.type, this._addShaderUnifiormFun(l);
                    var _ = this._uniformMap[d];
                    if (null != _) switch (l.dataOffset = Lt.propertyNameToID(d), _) {
                        case 0:
                            s.push(l);
                            break;

                        case 1:
                            a.push(l);
                            break;

                        case 2:
                            r.push(l);
                            break;

                        case 3:
                            n.push(l);
                            break;

                        case 4:
                            i.push(l);
                            break;

                        default:
                            throw new Error("Shader3D: period is unkonw.");
                    }
                }
                for (this._sceneUniformParamsMap = v.instance.createCommandEncoder(4 * i.length * 5 + 4, 64, !0),
                    h = 0, u = i.length; h < u; h++) this._sceneUniformParamsMap.addShaderUniform(i[h]);
                for (this._cameraUniformParamsMap = v.instance.createCommandEncoder(4 * n.length * 5 + 4, 64, !0),
                    h = 0, u = n.length; h < u; h++) this._cameraUniformParamsMap.addShaderUniform(n[h]);
                for (this._spriteUniformParamsMap = v.instance.createCommandEncoder(4 * r.length * 5 + 4, 64, !0),
                    h = 0, u = r.length; h < u; h++) this._spriteUniformParamsMap.addShaderUniform(r[h]);
                for (this._materialUniformParamsMap = v.instance.createCommandEncoder(4 * a.length * 5 + 4, 64, !0),
                    h = 0, u = a.length; h < u; h++) this._materialUniformParamsMap.addShaderUniform(a[h]);
                for (this._customUniformParamsMap.length = s.length, h = 0, u = s.length; h < u; h++) {
                    var f = s[h];
                    this._customUniformParamsMap[f.dataOffset] = f;
                }
                var p = this._shaderPass._stateMap;
                for (var m in p) this._stateParamsMap[p[m]] = Lt.propertyNameToID(m);
            }, i._getRenderState = function (t, e) {
                var i = this._stateParamsMap[e];
                return null == i ? null : t[i];
            }, i._disposeResource = function () {
                v.instance.deleteShader(this._vshader), v.instance.deleteShader(this._pshader),
                    v.instance.deleteProgram(this._program), this._vshader = this._pshader = this._program = null,
                    this._setGPUMemory(0), this._curActTexIndex = 0;
            }, i._addShaderUnifiormFun = function (t) {
                var e = v.instance;
                t.caller = this;
                var i = t.isArray;
                switch (t.type) {
                    case 35670:
                        t.fun = this._uniform1i, t.uploadedValue = new Array(1);
                        break;

                    case 5124:
                        t.fun = i ? this._uniform1iv : this._uniform1i, t.uploadedValue = new Array(1);
                        break;

                    case 5126:
                        t.fun = i ? this._uniform1fv : this._uniform1f, t.uploadedValue = new Array(1);
                        break;

                    case 35664:
                        t.fun = i ? this._uniform_vec2v : this._uniform_vec2, t.uploadedValue = new Array(2);
                        break;

                    case 35665:
                        t.fun = i ? this._uniform_vec3v : this._uniform_vec3, t.uploadedValue = new Array(3);
                        break;

                    case 35666:
                        t.fun = i ? this._uniform_vec4v : this._uniform_vec4, t.uploadedValue = new Array(4);
                        break;

                    case 35674:
                        t.fun = this._uniformMatrix2fv;
                        break;

                    case 35675:
                        t.fun = this._uniformMatrix3fv;
                        break;

                    case 35676:
                        t.fun = i ? this._uniformMatrix4fv : this._uniformMatrix4f;
                        break;

                    case 35678:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = k._glTextureIDs[this._curActTexIndex++],
                            t.fun = this._uniform_sampler2D;
                        break;

                    case 35679:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = k._glTextureIDs[this._curActTexIndex++],
                            t.fun = this._uniform_sampler3D;
                        break;

                    case 35680:
                        e.uniform1i(t.location, this._curActTexIndex), t.textureID = k._glTextureIDs[this._curActTexIndex++],
                            t.fun = this._uniform_samplerCube;
                        break;

                    default:
                        throw new Error("compile shader err!");
                }
            }, i._createShader = function (t, e, i) {
                var n = t.createShader(i);
                if (t.shaderSource(n, e), t.compileShader(n), Lt.debugMode && !t.getShaderParameter(n, 35713)) throw t.getShaderInfoLog(n);
                return n;
            }, i._uniform1f = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (v.instance.uniform1f(t.location, i[0] = e), 1) : 0;
            }, i._uniform1fv = function (t, e) {
                if (e.length < 4) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (v.instance.uniform1fv(t.location, e),
                        i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0;
                }
                return v.instance.uniform1fv(t.location, e), 1;
            }, i._uniform_vec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e.x || i[1] !== e.y ? (v.instance.uniform2f(t.location, i[0] = e.x, i[1] = e.y),
                    1) : 0;
            }, i._uniform_vec2v = function (t, e) {
                if (e.length < 2) {
                    var i = t.uploadedValue;
                    return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (v.instance.uniform2fv(t.location, e),
                        i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3], 1) : 0;
                }
                return v.instance.uniform2fv(t.location, e), 1;
            }, i._uniform_vec3 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e.x || i[1] !== e.y || i[2] !== e.z ? (v.instance.uniform3f(t.location, i[0] = e.x, i[1] = e.y, i[2] = e.z),
                    1) : 0;
            }, i._uniform_vec3v = function (t, e) {
                return v.instance.uniform3fv(t.location, e), 1;
            }, i._uniform_vec4 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e.x || i[1] !== e.y || i[2] !== e.z || i[3] !== e.w ? (v.instance.uniform4f(t.location, i[0] = e.x, i[1] = e.y, i[2] = e.z, i[3] = e.w),
                    1) : 0;
            }, i._uniform_vec4v = function (t, e) {
                return v.instance.uniform4fv(t.location, e), 1;
            }, i._uniformMatrix2fv = function (t, e) {
                return v.instance.uniformMatrix2fv(t.location, !1, e), 1;
            }, i._uniformMatrix3fv = function (t, e) {
                return v.instance.uniformMatrix3fv(t.location, !1, e), 1;
            }, i._uniformMatrix4f = function (t, e) {
                var i = e.elements;
                return v.instance.uniformMatrix4fv(t.location, !1, i), 1;
            }, i._uniformMatrix4fv = function (t, e) {
                return v.instance.uniformMatrix4fv(t.location, !1, e), 1;
            }, i._uniform1i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e ? (v.instance.uniform1i(t.location, i[0] = e), 1) : 0;
            }, i._uniform1iv = function (t, e) {
                return v.instance.uniform1iv(t.location, e), 1;
            }, i._uniform_ivec2 = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] ? (v.instance.uniform2i(t.location, i[0] = e[0], i[1] = e[1]),
                    1) : 0;
            }, i._uniform_ivec2v = function (t, e) {
                return v.instance.uniform2iv(t.location, e), 1;
            }, i._uniform_vec3i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] ? (v.instance.uniform3i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2]),
                    1) : 0;
            }, i._uniform_vec3vi = function (t, e) {
                return v.instance.uniform3iv(t.location, e), 1;
            }, i._uniform_vec4i = function (t, e) {
                var i = t.uploadedValue;
                return i[0] !== e[0] || i[1] !== e[1] || i[2] !== e[2] || i[3] !== e[3] ? (v.instance.uniform4i(t.location, i[0] = e[0], i[1] = e[1], i[2] = e[2], i[3] = e[3]),
                    1) : 0;
            }, i._uniform_vec4vi = function (t, e) {
                return v.instance.uniform4iv(t.location, e), 1;
            }, i._uniform_sampler2D = function (t, e) {
                var i = e._getSource() || e.defaulteTexture._getSource(), n = v.instance;
                return k.activeTexture(n, t.textureID), k.bindTexture(n, 3553, i), 0;
            }, i._uniform_sampler3D = function (t, e) {
                var i = e._getSource() || e.defaulteTexture._getSource(), n = v.instance;
                return k.activeTexture(n, t.textureID), k.bindTexture(n, 32879, i), 0;
            }, i._uniform_samplerCube = function (t, e) {
                var i = e._getSource() || e.defaulteTexture._getSource(), n = v.instance;
                return k.activeTexture(n, t.textureID), k.bindTexture(n, 34067, i), 0;
            }, i.bind = function () {
                return k.useProgram(v.instance, this._program);
            }, i.uploadUniforms = function (t, e, i) {
                O.shaderCall += S.uploadShaderUniforms(v.instance, t, e, i);
            }, i.uploadRenderStateBlendDepth = function (t) {
                var e = v.instance, i = this._shaderPass.renderState, n = t.getData(), r = this._getRenderState(n, 13), a = this._getRenderState(n, 12), s = this._getRenderState(n, 1);
                switch (null == r && (r = i.depthWrite), null == a && (a = i.depthTest), null == s && (s = i.blend),
                k.setDepthMask(e, r), 0 === a ? k.setDepthTest(e, !1) : (k.setDepthTest(e, !0),
                    k.setDepthFunc(e, a)), s) {
                    case 0:
                        k.setBlend(e, !1);
                        break;

                    case 1:
                        k.setBlend(e, !0);
                        var o = this._getRenderState(n, 2);
                        null == o && (o = i.srcBlend);
                        var l = this._getRenderState(n, 3);
                        null == l && (l = i.dstBlend), k.setBlendFunc(e, o, l);
                        break;

                    case 2:
                        k.setBlend(e, !0);
                        var h = this._getRenderState(n, 4);
                        null == h && (h = i.srcBlendRGB);
                        var u = this._getRenderState(n, 5);
                        null == u && (u = i.dstBlendRGB);
                        var c = this._getRenderState(n, 6);
                        null == c && (c = i.srcBlendAlpha);
                        var d = this._getRenderState(n, 7);
                        null == d && (d = i.dstBlendAlpha), k.setBlendFuncSeperate(e, h, u, c, d);
                }
            }, i.uploadRenderStateFrontFace = function (t, e, i) {
                var n = v.instance, r = this._shaderPass.renderState, a = t.getData(), s = this._getRenderState(a, 0);
                null == s && (s = r.cull);
                var o = 0;
                switch (s) {
                    case 0:
                        k.setCullFace(n, !1);
                        break;

                    case 1:
                        k.setCullFace(n, !0), o = e ? i && i._isFrontFaceInvert ? 2305 : 2304 : i && i._isFrontFaceInvert ? 2304 : 2305,
                            k.setFrontFace(n, o);
                        break;

                    case 2:
                        k.setCullFace(n, !0), o = e ? i && i._isFrontFaceInvert ? 2304 : 2305 : i && i._isFrontFaceInvert ? 2305 : 2304,
                            k.setFrontFace(n, o);
                }
            }, i.uploadCustomUniform = function (t, e) {
                O.shaderCall += S.uploadCustomUniform(v.instance, this._customUniformParamsMap, t, e);
            }, i._uniformMatrix2fvForNative = function (t, e) {
                return v.instance.uniformMatrix2fvEx(t.location, !1, e), 1;
            }, i._uniformMatrix3fvForNative = function (t, e) {
                return v.instance.uniformMatrix3fvEx(t.location, !1, e), 1;
            }, i._uniformMatrix4fvForNative = function (t, e) {
                return v.instance.uniformMatrix4fvEx(t.location, !1, e), 1;
            }, e;
        }(w), ji = (function (t) {
            function e() {
                this._version = NaN, this._cameraCoordinateInverse = !1, this._gridSize = NaN, this._chunkNumX = 0,
                    this._chunkNumZ = 0, this._heightDataX = 0, this._heightDataZ = 0, this._heightDataBitType = 0,
                    this._heightDataValue = NaN, this._heightDataUrl = null, this._detailTextureInfos = null,
                    this._chunkInfos = null, this._heightData = null, this._materialInfo = null, this._alphaMaps = null,
                    this._normalMaps = null, e.__super.call(this);
            }
            r(e, "laya.d3.terrain.TerrainRes", t);
            var n = e.prototype;
            n.parseData = function (t) {
                var e = t[0], i = t[1];
                if (this._version = e.version, 1 == this._version) {
                    this._cameraCoordinateInverse = e.cameraCoordinateInverse, this._gridSize = e.gridSize,
                        this._chunkNumX = e.chunkNumX, this._chunkNumZ = e.chunkNumZ;
                    var n = e.heightData;
                    if (this._heightDataX = n.numX, this._heightDataZ = n.numZ, this._heightDataBitType = n.bitType,
                        this._heightDataValue = n.value, this._heightDataUrl = i[n.url], this._materialInfo = new ot(),
                        e.material) {
                        var r = e.material.ambient, a = e.material.diffuse, o = e.material.specular;
                        this._materialInfo.ambientColor = new gt(r[0], r[1], r[2]), this._materialInfo.diffuseColor = new gt(a[0], a[1], a[2]),
                            this._materialInfo.specularColor = new pt(o[0], o[1], o[2], o[3]);
                    }
                    var l = e.detailTexture;
                    this._detailTextureInfos = s(l.length);
                    for (var h = 0; h < l.length; h++) {
                        var u = l[h], c = new Ae();
                        c.diffuseTexture = i[u.diffuse], c.normalTexture = u.normal ? i[u.normal] : null,
                            u.scale ? c.scale = new yt(u.scale[0], u.scale[1]) : c.scale = new yt(1, 1), u.offset ? c.offset = new yt(u.offset[0], u.offset[1]) : c.offset = new yt(0, 0),
                            this._detailTextureInfos[h] = c;
                    }
                    var d = e.alphaMap;
                    for (this._alphaMaps = s(d.length), h = 0; h < this._alphaMaps.length; h++) this._alphaMaps[h] = e.alphaMap[h];
                    var _ = e.normalMap;
                    for (this._normalMaps = s(_.length), h = 0; h < this._normalMaps.length; h++) this._normalMaps[h] = e.normalMap[h];
                    var f = e.chunkInfo;
                    if (this._chunkNumX * this._chunkNumZ != f.length) return alert("terrain data error"),
                        !1;
                    for (this._chunkInfos = s(f.length), h = 0; h < f.length; h++) {
                        var p = f[h], m = new ve(), g = p.alphaMap.length, y = p.detailID.length;
                        if (g != y) return alert("terrain chunk data error"), !1;
                        m.alphaMap = s(g), m.detailID = s(y), m.normalMap = i[this._normalMaps[p.normalMap]];
                        for (var v = 0; v < g; v++) {
                            m.alphaMap[v] = i[this._alphaMaps[p.alphaMap[v]]];
                            var S = p.detailID[v], E = S.length;
                            m.detailID[v] = new Uint8Array(E);
                            for (var C = 0; C < E; C++) m.detailID[v][C] = S[C];
                        }
                        this._chunkInfos[h] = m;
                    }
                    this._heightData = T.getRes(this._heightDataUrl), this.onLoadTerrainComplete(this._heightData);
                }
                return !0;
            }, n.onLoadTerrainComplete = function (t) { }, e._parse = function (t, i, n) {
                var r = new e();
                return r.parseData(t), r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "TERRAIN", null, null, 1, !1);
            };
        }(w), function (t) {
            function e(t) {
                this._finalGravity = new gt(), this._tempRotationMatrix = new ze(), e.__super.call(this, t),
                    this._defaultBoundBox = new Ue(new gt(), new gt()), this._renderMode = -1, this.stretchedBillboardCameraSpeedScale = 0,
                    this.stretchedBillboardSpeedScale = 0, this.stretchedBillboardLengthScale = 1;
            }
            r(e, "laya.d3.core.particleShuriKen.ShurikenParticleRenderer", t);
            var i = e.prototype;
            return i._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e),
                    I.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var i = Ne._cullingBuffer;
                    i[this._cullingBufferIndex + 1] = t.x, i[this._cullingBufferIndex + 2] = t.y, i[this._cullingBufferIndex + 3] = t.z,
                        i[this._cullingBufferIndex + 4] = e.x, i[this._cullingBufferIndex + 5] = e.y, i[this._cullingBufferIndex + 6] = e.z;
                }
            }, i._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this.bounds._getBoundBox()) && !!this._owner.particleSystem.isAlive;
            }, i._renderUpdate = function (t, e) {
                var i = this._owner.particleSystem, n = this._shaderValues, r = this._owner.transform;
                switch (i.simulationSpace) {
                    case 0:
                        break;

                    case 1:
                        n.setVector3(En.WORLDPOSITION, r.position), n.setQuaternion(En.WORLDROTATION, r.rotation);
                        break;

                    default:
                        throw new Error("ShurikenParticleMaterial: SimulationSpace value is invalid.");
                }
                switch (i.scaleMode) {
                    case 0:
                        var a = r.scale;
                        n.setVector3(En.POSITIONSCALE, a), n.setVector3(En.SIZESCALE, a);
                        break;

                    case 1:
                        var s = r.localScale;
                        n.setVector3(En.POSITIONSCALE, s), n.setVector3(En.SIZESCALE, s);
                        break;

                    case 2:
                        n.setVector3(En.POSITIONSCALE, r.scale), n.setVector3(En.SIZESCALE, gt._ONE);
                }
                gt.scale(Ve.gravity, i.gravityModifier, this._finalGravity), n.setVector3(En.GRAVITY, this._finalGravity),
                    n.setInt(En.SIMULATIONSPACE, i.simulationSpace), n.setBool(En.THREEDSTARTROTATION, i.threeDStartRotation),
                    n.setInt(En.SCALINGMODE, i.scaleMode), n.setNumber(En.STRETCHEDBILLBOARDLENGTHSCALE, this.stretchedBillboardLengthScale),
                    n.setNumber(En.STRETCHEDBILLBOARDSPEEDSCALE, this.stretchedBillboardSpeedScale),
                    n.setNumber(En.CURRENTTIME, i._currentTime);
            }, i._destroy = function () {
                t.prototype._destroy.call(this), this._mesh && (this._mesh._removeReference(), this._mesh = null);
            }, a(0, i, "renderMode", function () {
                return this._renderMode;
            }, function (t) {
                if (this._renderMode !== t) {
                    var e = this._defineDatas;
                    switch (this._renderMode) {
                        case 0:
                            e.remove(En.SHADERDEFINE_RENDERMODE_BILLBOARD);
                            break;

                        case 1:
                            e.remove(En.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);
                            break;

                        case 2:
                            e.remove(En.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);
                            break;

                        case 3:
                            e.remove(En.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);
                            break;

                        case 4:
                            e.remove(En.SHADERDEFINE_RENDERMODE_MESH);
                    }
                    switch (this._renderMode = t, t) {
                        case 0:
                            e.add(En.SHADERDEFINE_RENDERMODE_BILLBOARD);
                            break;

                        case 1:
                            e.add(En.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD);
                            break;

                        case 2:
                            e.add(En.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD);
                            break;

                        case 3:
                            e.add(En.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD);
                            break;

                        case 4:
                            e.add(En.SHADERDEFINE_RENDERMODE_MESH);
                            break;

                        default:
                            throw new Error("ShurikenParticleRender: unknown renderMode Value.");
                    }
                    this._owner.particleSystem._initBufferDatas();
                }
            }), a(0, i, "mesh", function () {
                return this._mesh;
            }, function (t) {
                this._mesh !== t && (this._mesh && this._mesh._removeReference(), this._mesh = t,
                    t && t._addReference(), this._owner.particleSystem._initBufferDatas());
            }), a(0, i, "bounds", function () {
                return this._boundsChange && (this._calculateBoundingBox(), this._boundsChange = !1),
                    this._bounds;
            }), e;
        }(We)), Wi = function (t) {
            function e(t, i) {
                this._isTrigger = !1, e.__super.call(this, t, i);
            }
            r(e, "laya.d3.physics.PhysicsTriggerComponent", t);
            var i = e.prototype;
            return i._onAdded = function () {
                t.prototype._onAdded.call(this), this.isTrigger = this._isTrigger;
            }, i._cloneTo = function (e) {
                t.prototype._cloneTo.call(this, e), e.isTrigger = this._isTrigger;
            }, a(0, i, "isTrigger", function () {
                return this._isTrigger;
            }, function (t) {
                if (this._isTrigger = t, this._nativeColliderObject) {
                    var e = this._nativeColliderObject.getCollisionFlags();
                    t ? 0 == (4 & e) && this._nativeColliderObject.setCollisionFlags(4 | e) : 0 != (4 & e) && this._nativeColliderObject.setCollisionFlags(4 ^ e);
                }
            }), e;
        }(je), Xi = (function (t) {
            function e(t, i, n, r) {
                this._maxSlope = 45, this._jumpSpeed = 10, this._fallSpeed = 55, this._upAxis = new gt(0, 1, 0),
                    this._gravity = new gt(0, 3 * -9.8, 0), void 0 === t && (t = .1), void 0 === n && (n = 1),
                    void 0 === r && (r = Ve.COLLISIONFILTERGROUP_ALLFILTER), this._stepHeight = t, i && (this._upAxis = i),
                    e.__super.call(this, n, r);
            }
            r(e, "laya.d3.physics.CharacterController", t);
            var i = e.prototype;
            i._constructCharacter = function () {
                var t = W._physics3D;
                this._nativeKinematicCharacter && t.destroy(this._nativeKinematicCharacter);
                var i = e._nativeTempVector30;
                i.setValue(this._upAxis.x, this._upAxis.y, this._upAxis.z), this._nativeKinematicCharacter = new t.btKinematicCharacterController(this._nativeColliderObject, this._colliderShape._nativeShape, this._stepHeight, i),
                    this.fallSpeed = this._fallSpeed, this.maxSlope = this._maxSlope, this.jumpSpeed = this._jumpSpeed,
                    this.gravity = this._gravity;
            }, i._onShapeChange = function (e) {
                t.prototype._onShapeChange.call(this, e), this._constructCharacter();
            }, i._onAdded = function () {
                var e = new W._physics3D.btPairCachingGhostObject();
                e.setUserIndex(this.id), e.setCollisionFlags(16), this._nativeColliderObject = e,
                    this._colliderShape && this._constructCharacter(), t.prototype._onAdded.call(this);
            }, i._addToSimulation = function () {
                this._simulation._characters.push(this), this._simulation._addCharacter(this, this._collisionGroup, this._canCollideWith);
            }, i._removeFromSimulation = function () {
                this._simulation._removeCharacter(this);
                var t = this._simulation._characters;
                t.splice(t.indexOf(this), 1);
            }, i._cloneTo = function (e) {
                t.prototype._cloneTo.call(this, e);
                var i = e;
                i.stepHeight = this._stepHeight, i.upAxis = this._upAxis, i.maxSlope = this._maxSlope,
                    i.jumpSpeed = this._jumpSpeed, i.fallSpeed = this._fallSpeed, i.gravity = this._gravity;
            }, i._onDestroy = function () {
                W._physics3D.destroy(this._nativeKinematicCharacter), t.prototype._onDestroy.call(this),
                    this._nativeKinematicCharacter = null;
            }, i.move = function (t) {
                var e = je._nativeVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeKinematicCharacter.setWalkDirection(e);
            }, i.jump = function (t) {
                if (t) {
                    var e = je._nativeVector30;
                    Ht._convertToBulletVec3(t, e, !0), this._nativeKinematicCharacter.jump(e);
                } else this._nativeKinematicCharacter.jump();
            }, a(0, i, "fallSpeed", function () {
                return this._fallSpeed;
            }, function (t) {
                this._fallSpeed = t, this._nativeKinematicCharacter.setFallSpeed(t);
            }), a(0, i, "stepHeight", function () {
                return this._stepHeight;
            }, function (t) {
                this._stepHeight = t, this._constructCharacter();
            }), a(0, i, "jumpSpeed", function () {
                return this._jumpSpeed;
            }, function (t) {
                this._jumpSpeed = t, this._nativeKinematicCharacter.setJumpSpeed(t);
            }), a(0, i, "gravity", function () {
                return this._gravity;
            }, function (t) {
                this._gravity = t;
                var i = e._nativeTempVector30;
                i.setValue(-t.x, t.y, t.z), this._nativeKinematicCharacter.setGravity(i);
            }), a(0, i, "maxSlope", function () {
                return this._maxSlope;
            }, function (t) {
                this._maxSlope = t, this._nativeKinematicCharacter.setMaxSlope(t / 180 * Math.PI);
            }), a(0, i, "isGrounded", function () {
                return this._nativeKinematicCharacter.onGround();
            }), a(0, i, "upAxis", function () {
                return this._upAxis;
            }, function (t) {
                this._upAxis = t, this._constructCharacter();
            }), e.UPAXIS_X = 0, e.UPAXIS_Y = 1, e.UPAXIS_Z = 2, n(e, ["_nativeTempVector30", function () {
                return this._nativeTempVector30 = new W._physics3D.btVector3(0, 0, 0);
            }]);
        }(je), function (t) {
            function e(t) {
                this._terrainSprite3DOwner = null, this._projectionViewWorldMatrix = null, e.__super.call(this, t),
                    this._terrainSprite3DOwner = t, this._projectionViewWorldMatrix = new ze();
            }
            r(e, "laya.d3.terrain.TerrainRender", t);
            var i = e.prototype;
            return i._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this._bounds._getBoundBox());
            }, i._calculateBoundingBox = function () { }, i._renderUpdate = function (t, e) {
                this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, e.worldMatrix);
            }, i._renderUpdateWithCamera = function (t, e) {
                var i = t.projectionViewMatrix;
                ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix);
            }, i._destroy = function () {
                t.prototype._destroy.call(this), this._terrainSprite3DOwner = null;
            }, e;
        }(We)), Yi = function (t) {
            function e(t) {
                e.__super.call(this, t), this._projectionViewWorldMatrix = new ze();
            }
            r(e, "laya.d3.core.MeshRenderer", t);
            var i = e.prototype;
            return i._onMeshChange = function (t) {
                this._boundsChange = !0;
            }, i._calculateBoundingBox = function () {
                var t = this._owner.meshFilter.sharedMesh;
                if (t) {
                    var e = this._owner.transform.worldMatrix;
                    t.bounds._tranform(e, this._bounds);
                }
                if (I.supportWebGLPlusCulling) {
                    var i = this._bounds.getMin(), n = this._bounds.getMax(), r = Ne._cullingBuffer;
                    r[this._cullingBufferIndex + 1] = i.x, r[this._cullingBufferIndex + 2] = i.y, r[this._cullingBufferIndex + 3] = i.z,
                        r[this._cullingBufferIndex + 4] = n.x, r[this._cullingBufferIndex + 5] = n.y, r[this._cullingBufferIndex + 6] = n.z;
                }
            }, i._changeRenderObjectsByMesh = function (t) {
                var e = t.subMeshCount;
                this._renderElements.length = e;
                for (var i = 0; i < e; i++) {
                    var n = this._renderElements[i];
                    if (!n) {
                        var r = this.sharedMaterials[i];
                        (n = this._renderElements[i] = new Pi()).setTransform(this._owner._transform), n.render = this,
                            n.material = r || cn.defaultMaterial;
                    }
                    n.setGeometry(t._getSubMesh(i));
                }
            }, i._needRender = function (t) {
                return !t || 0 !== t.containsBoundBox(this.bounds._getBoundBox());
            }, i._renderUpdate = function (t, e) {
                var i = t.renderElement;
                switch (i.renderType) {
                    case 0:
                        this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, e.worldMatrix);
                        break;

                    case 1:
                        this._oriDefineValue = this._defineDatas.value, e ? this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, e.worldMatrix) : this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, ze.DEFAULT),
                            this._defineDatas.add(yn.SHADERDEFINE_UV1), this._defineDatas.remove(Qi.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);
                        break;

                    case 3:
                        this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, ze.DEFAULT);
                        break;

                    case 2:
                        for (var n = gi.instance.instanceWorldMatrixData, r = i.instanceBatchElementList, a = r.length, s = 0; s < a; s++) n.set(r[s]._transform.worldMatrix.elements, 16 * s);
                        gi.instance.instanceWorldMatrixBuffer.setData(n, 0, 0, 16 * a), this._defineDatas.add(yn.SHADERDEFINE_GPU_INSTANCE);
                }
            }, i._renderUpdateWithCamera = function (t, e) {
                var i = t.projectionViewMatrix, n = t.renderElement;
                switch (n.renderType) {
                    case 0:
                    case 1:
                    case 3:
                        e ? (ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, i);
                        break;

                    case 2:
                        for (var r = gi.instance.instanceMVPMatrixData, a = n.instanceBatchElementList, s = a.length, o = 0; o < s; o++) {
                            var l = a[o]._transform.worldMatrix;
                            Ht.mulMatrixByArray(i.elements, 0, l.elements, 0, r, 16 * o);
                        }
                        gi.instance.instanceMVPMatrixBuffer.setData(r, 0, 0, 16 * s);
                }
            }, i._renderUpdateWithCameraForNative = function (t, e) {
                var i = t.projectionViewMatrix, n = t.renderElement;
                switch (n.renderType) {
                    case 0:
                        e ? (ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, i);
                        break;

                    case 1:
                    case 3:
                        var r = ut._SET_RUNTIME_VALUE_MODE_REFERENCE_;
                        ut.setRuntimeValueMode(!1), e ? (ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix),
                            this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, i),
                            ut.setRuntimeValueMode(r);
                        break;

                    case 2:
                        for (var a = gi.instance.instanceMVPMatrixData, s = n.instanceBatchElementList, o = s.length, l = 0; l < o; l++) {
                            var h = s[l]._transform.worldMatrix;
                            Ht.mulMatrixByArray(i.elements, 0, h.elements, 0, a, 16 * l);
                        }
                        gi.instance.instanceMVPMatrixBuffer.setData(a, 0, 0, 16 * o);
                }
            }, i._revertBatchRenderUpdate = function (t) {
                switch (t.renderElement.renderType) {
                    case 1:
                        this._defineDatas.value = this._oriDefineValue;
                        break;

                    case 2:
                        this._defineDatas.remove(yn.SHADERDEFINE_GPU_INSTANCE);
                }
            }, i._destroy = function () {
                this._isPartOfStaticBatch && Si.instance._destroyRenderSprite(this._owner), t.prototype._destroy.call(this);
            }, n(e, ["_tempVector30", function () {
                return this._tempVector30 = new gt();
            }, "_tempVector31", function () {
                return this._tempVector31 = new gt();
            }]), e;
        }(We), qi = function (t) {
            function e(t) {
                this._projectionViewWorldMatrix = new ze(), e.__super.call(this, t);
            }
            r(e, "laya.d3.core.trail.TrailRenderer", t);
            var i = e.prototype;
            return i._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e),
                    I.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var i = Ne._cullingBuffer;
                    i[this._cullingBufferIndex + 1] = t.x, i[this._cullingBufferIndex + 2] = t.y, i[this._cullingBufferIndex + 3] = t.z,
                        i[this._cullingBufferIndex + 4] = e.x, i[this._cullingBufferIndex + 5] = e.y, i[this._cullingBufferIndex + 6] = e.z;
                }
            }, i._needRender = function (t) {
                return !0;
            }, i._renderUpdate = function (e, i) {
                t.prototype._renderUpdate.call(this, e, i), this._owner.trailFilter._update(e);
            }, i._renderUpdateWithCamera = function (t, e) {
                var i = t.projectionViewMatrix;
                e ? (ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix), this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix)) : this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, i);
            }, e;
        }(We), Ki = function (t) {
            function e(t) {
                this._projectionViewWorldMatrix = null, e.__super.call(this, t), this._projectionViewWorldMatrix = new ze();
            }
            r(e, "laya.d3.core.pixelLine.PixelLineRenderer", t);
            var i = e.prototype;
            return i._calculateBoundingBox = function () {
                var t = this._bounds.getMin();
                t.x = -Number.MAX_VALUE, t.y = -Number.MAX_VALUE, t.z = -Number.MAX_VALUE, this._bounds.setMin(t);
                var e = this._bounds.getMax();
                if (e.x = Number.MAX_VALUE, e.y = Number.MAX_VALUE, e.z = Number.MAX_VALUE, this._bounds.setMax(e),
                    I.supportWebGLPlusCulling) {
                    t = this._bounds.getMin(), e = this._bounds.getMax();
                    var i = Ne._cullingBuffer;
                    i[this._cullingBufferIndex + 1] = t.x, i[this._cullingBufferIndex + 2] = t.y, i[this._cullingBufferIndex + 3] = t.z,
                        i[this._cullingBufferIndex + 4] = e.x, i[this._cullingBufferIndex + 5] = e.y, i[this._cullingBufferIndex + 6] = e.z;
                }
            }, i._renderUpdateWithCamera = function (t, e) {
                var i = t.projectionViewMatrix, n = this._shaderValues;
                if (e) {
                    var r = e.worldMatrix;
                    n.setMatrix4x4(Bi.WORLDMATRIX, r), ze.multiply(i, r, this._projectionViewWorldMatrix),
                        n.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix);
                } else n.setMatrix4x4(Bi.WORLDMATRIX, ze.DEFAULT), n.setMatrix4x4(Bi.MVPMATRIX, i);
            }, e;
        }(We), Zi = function (t) {
            function e() {
                this._reflectionMode = 1, this._enableLightCount = 3, this.enableLight = !0, this._time = 0,
                    e.__super.call(this), this._lights = [], this._lightmaps = [], this._skyRenderer = new pe(),
                    this._input = new Yt(), this._timer = i.timer, this._collsionTestList = [], this._renders = new hi(),
                    this._opaqueQueue = new Re(!1), this._transparentQueue = new Re(!0), this._cameraPool = [],
                    this._animatorPool = new hi(), this._scriptPool = new hi(), this._castShadowRenders = new ni(),
                    this.currentCreationLayer = Math.pow(2, 0), this._key = new P(), this._pickIdToSprite = new Object(),
                    W._enbalePhysics && (this._physicsSimulation = new He(W.physicsSettings)), this._defineDatas = new Vt(),
                    this._shaderValues = new ut(null), this.parallelSplitShadowMaps = [], this.enableFog = !1,
                    this.fogStart = 300, this.fogRange = 1e3, this.fogColor = new gt(.7, .7, .7), this.ambientColor = new gt(.212, .227, .259),
                    this.reflectionIntensity = 1, F.shaderHighPrecision && this._defineDatas.add(Lt.SHADERDEFINE_HIGHPRECISION),
                    I.supportWebGLPlusCulling && (this._cullingBufferIndices = new Int32Array(1024),
                        this._cullingBufferResult = new Int32Array(1024)), this._shaderValues.setTexture(laya.d3.core.scene.Scene3D.RANGEATTENUATIONTEXTURE, zt._rangeAttenTex),
                    this._scene = this, W._enbalePhysics && !He.disableSimulation && this._input.__init__(I.canvas, this);
                var t = W._config;
                if (t.octreeCulling && (this._octree = new Jt(t.octreeInitialSize, t.octreeInitialCenter, t.octreeMinNodeSize, t.octreeLooseness)),
                    W._config.debugFrustumCulling) {
                    this._debugTool = new Cn();
                    var n = new rn();
                    n.renderQueue = 3e3, n.alphaTest = !1, n.depthWrite = !1, n.cull = 2, n.blend = 1,
                        n.blendSrc = 770, n.blendDst = 771, n.depthTest = 513, this._debugTool.pixelLineRenderer.sharedMaterial = n;
                }
            }
            r(e, "laya.d3.core.scene.Scene3D", t);
            var o = e.prototype;
            return i.imps(o, {
                "laya.webgl.submit.ISubmit": !0,
                "laya.resource.ICreateResource": !0
            }), o._allotPickColorByID = function (t, e) {
                var i = Math.floor(t / 65025);
                t -= 255 * i * 255;
                var n = Math.floor(t / 255), r = t -= 255 * n;
                e.x = i / 255, e.y = n / 255, e.z = r / 255, e.w = 1;
            }, o._searchIDByPickColor = function (t) {
                return 255 * t.x * 255 + 255 * t.y + t.z;
            }, o._setLightmapToChildNode = function (t) {
                t instanceof laya.d3.core.RenderableSprite3D && t._render._applyLightMapParams();
                for (var e = t._children, i = 0, n = e.length; i < n; i++) this._setLightmapToChildNode(e[i]);
            }, o._update = function () {
                var t = this.timer._delta / 1e3;
                this._time += t, this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.TIME, this._time);
                var e = this._physicsSimulation;
                W._enbalePhysics && !He.disableSimulation && (e._updatePhysicsTransformFromRender(),
                    je._addUpdateList = !1, e._simulate(t), e._updateCharacters(), je._addUpdateList = !0,
                    e._updateCollisions(), e._eventScripts(), this._input._update()), this._updateScript(),
                    Ye._update(this), this._lateUpdateScript();
            }, o._binarySearchIndexInCameraPool = function (t) {
                for (var e = 0, i = this._cameraPool.length - 1, n = 0; e <= i;) {
                    n = Math.floor((e + i) / 2);
                    var r = this._cameraPool[n]._renderingOrder;
                    if (r == t._renderingOrder) return n;
                    r > t._renderingOrder ? i = n - 1 : e = n + 1;
                }
                return e;
            }, o._setCreateURL = function (t) {
                this._url = B.formatURL(t);
            }, o._getGroup = function () {
                return this._group;
            }, o._setGroup = function (t) {
                this._group = t;
            }, o._updateScript = function () {
                for (var t = this._scriptPool, e = t.elements, i = 0, n = t.length; i < n; i++) {
                    var r = e[i];
                    r && r.enabled && r.onUpdate();
                }
            }, o._lateUpdateScript = function () {
                for (var t = this._scriptPool, e = t.elements, i = 0, n = t.length; i < n; i++) {
                    var r = e[i];
                    r && r.enabled && r.onLateUpdate();
                }
            }, o._preRenderScript = function () {
                for (var t = this._scriptPool, e = t.elements, i = 0, n = t.length; i < n; i++) {
                    var r = e[i];
                    r && r.enabled && r.onPreRender();
                }
            }, o._postRenderScript = function () {
                for (var t = this._scriptPool, e = t.elements, i = 0, n = t.length; i < n; i++) {
                    var r = e[i];
                    r && r.enabled && r.onPostRender();
                }
            }, o._prepareSceneToRender = function () {
                var t = this._lights.length;
                if (t > 0) for (var e = 0, i = 0; i < t && !(this._lights[i]._prepareToScene() && ++e >= this._enableLightCount); i++);
            }, o._addCamera = function (t) {
                for (var e = this._binarySearchIndexInCameraPool(t), i = t._renderingOrder, n = this._cameraPool.length; e < n && this._cameraPool[e]._renderingOrder <= i;) e++;
                this._cameraPool.splice(e, 0, t);
            }, o._removeCamera = function (t) {
                this._cameraPool.splice(this._cameraPool.indexOf(t), 1);
            }, o._preCulling = function (t, e) {
                Ne.renderObjectCulling(e, this, t, this._renders);
            }, o._clear = function (t, e) {
                var i = e.viewport, n = e.camera, r = n.getRenderTexture(), a = i.width, s = i.height, o = i.x, l = n._getCanvasHeight() - i.y - s;
                t.viewport(o, l, a, s);
                var h = 0, u = n.clearFlag;
                switch (1 !== u || n.skyRenderer._isAvailable() || this._skyRenderer._isAvailable() || (u = 0),
                u) {
                    case 0:
                        var c = n.clearColor;
                        if (t.enable(3089), t.scissor(o, l, a, s), c ? t.clearColor(c.x, c.y, c.z, c.w) : t.clearColor(0, 0, 0, 0),
                            r) switch (h = 16384, r.depthStencilFormat) {
                                case 0:
                                    h |= 256;
                                    break;

                                case 1:
                                    h |= 1024;
                                    break;

                                case 2:
                                    h |= 256, h |= 1024;
                            } else h = 16640;
                        k.setDepthMask(t, !0), t.clear(h), t.disable(3089);
                        break;

                    case 1:
                    case 2:
                        if (t.enable(3089), t.scissor(o, l, a, s), r) switch (r.depthStencilFormat) {
                            case 0:
                                h = 256;
                                break;

                            case 1:
                                h = 1024;
                                break;

                            case 2:
                                h = 1280;
                        } else h = 256;
                        k.setDepthMask(t, !0), t.clear(h), t.disable(3089);
                        break;

                    case 3:
                        break;

                    default:
                        throw new Error("BaseScene:camera clearFlag invalid.");
                }
            }, o._renderScene = function (t, e, i, n) {
                var r = e.camera;
                r.transform.position;
                if (r.getRenderTexture() ? this._opaqueQueue._render(e, !0, i, n) : this._opaqueQueue._render(e, !1, i, n),
                    1 === r.clearFlag && (r.skyRenderer._isAvailable() ? r.skyRenderer._render(e) : this._skyRenderer._isAvailable() && this._skyRenderer._render(e)),
                    r.getRenderTexture() ? this._transparentQueue._render(e, !0, i, n) : this._transparentQueue._render(e, !1, i, n),
                    r._applyPostProcessCommandBuffers(), W._config.debugFrustumCulling) for (var a = this._debugTool._render._renderElements, s = 0, o = a.length; s < o; s++) a[s]._render(e, !1, i, n);
            }, o._parse = function (t, e) {
                var i = t.lightmaps;
                if (i) {
                    for (var n = i.length, r = s(n), a = 0; a < n; a++) r[a] = T.getRes(i[a].path);
                    this.setlightmaps(r);
                }
                var o = t.ambientColor;
                if (o) {
                    var l = this.ambientColor;
                    l.fromArray(o), this.ambientColor = l;
                }
                var h = t.sky;
                if (h) switch (this._skyRenderer.material = T.getRes(h.material.path), h.mesh) {
                    case "SkyBox":
                        this._skyRenderer.mesh = Ei.instance;
                        break;

                    case "SkyDome":
                        this._skyRenderer.mesh = Ri.instance;
                        break;

                    default:
                        this.skyRenderer.mesh = Ei.instance;
                }
                var u = t.reflectionTexture;
                u && (this.customReflection = T.getRes(u)), this.enableFog = t.enableFog, this.fogStart = t.fogStart,
                    this.fogRange = t.fogRange;
                var c = t.fogColor;
                if (c) {
                    var d = this.fogColor;
                    d.fromArray(c), this.fogColor = d;
                }
            }, o._onActive = function () {
                laya.display.Node.prototype._onActive.call(this), i.stage._scene3Ds.push(this);
            }, o._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this);
                var t = i.stage._scene3Ds;
                t.splice(t.indexOf(this), 1);
            }, o._addLight = function (t) {
                this._lights.indexOf(t) < 0 && this._lights.push(t);
            }, o._removeLight = function (t) {
                var e = this._lights.indexOf(t);
                e >= 0 && this._lights.splice(e, 1);
            }, o._addRenderObject = function (t) {
                if (this._octree) this._octree.add(t); else if (this._renders.add(t), I.supportWebGLPlusCulling) {
                    var e = t._getIndexInList(), i = this._cullingBufferIndices.length;
                    if (e >= i) {
                        var n = this._cullingBufferIndices, r = this._cullingBufferResult;
                        this._cullingBufferIndices = new Int32Array(i + 1024), this._cullingBufferResult = new Int32Array(i + 1024),
                            this._cullingBufferIndices.set(n, 0), this._cullingBufferResult.set(r, 0);
                    }
                    this._cullingBufferIndices[e] = t._cullingBufferIndex;
                }
            }, o._removeRenderObject = function (t) {
                var e;
                this._octree ? this._octree.remove(t) : (I.supportWebGLPlusCulling && (e = this._renders.elements[this._renders.length - 1]),
                    this._renders.remove(t), I.supportWebGLPlusCulling && (this._cullingBufferIndices[e._getIndexInList()] = e._cullingBufferIndex));
            }, o._addShadowCastRenderObject = function (t) {
                this._octree || this._castShadowRenders.add(t);
            }, o._removeShadowCastRenderObject = function (t) {
                this._octree || this._castShadowRenders.remove(t);
            }, o._getRenderQueue = function (t) {
                return t <= 2500 ? this._opaqueQueue : this._transparentQueue;
            }, o.setlightmaps = function (t) {
                for (var e = this._lightmaps, i = 0, n = e.length; i < n; i++) e[i]._removeReference();
                if (!t) throw new Error("Scene3D: value value can't be null.");
                var r = t.length;
                for (e.length = r, i = 0; i < r; i++) {
                    var a = t[i];
                    a._addReference(), e[i] = a;
                }
                for (i = 0, n = this._children.length; i < n; i++) this._setLightmapToChildNode(this._children[i]);
            }, o.getlightmaps = function () {
                return this._lightmaps.slice();
            }, o.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._skyRenderer.destroy(), this._skyRenderer = null, this._lights = null, this._lightmaps = null,
                    this._renderTargetTexture = null, this._shaderValues = null, this._renders = null,
                    this._castShadowRenders = null, this._cameraPool = null, this._octree = null, this.parallelSplitShadowMaps = null,
                    this._physicsSimulation && this._physicsSimulation._destroy(), T.clearRes(this.url));
            }, o.render = function (t, e, i) {
                t._curSubmit = L.RENDERBASE, this._children.length > 0 && t.addRenderObject(this);
            }, o.renderSubmit = function () {
                v.instance;
                this._prepareSceneToRender();
                var t, e, i = 0;
                for (i = 0, e = (t = this._cameraPool.length) - 1; i < t; i++) {
                    I.supportWebGLPlusRendering && ut.setRuntimeValueMode(i == e);
                    var n = this._cameraPool[i];
                    n.enableRender && n.render();
                }
                return m.set2DRenderConfig(), 1;
            }, o.getRenderType = function () {
                return 0;
            }, o.releaseRender = function () { }, o.reUse = function (t, e) {
                return 0;
            }, a(0, o, "fogColor", function () {
                return this._shaderValues.getVector(laya.d3.core.scene.Scene3D.FOGCOLOR);
            }, function (t) {
                this._shaderValues.setVector3(laya.d3.core.scene.Scene3D.FOGCOLOR, t);
            }), a(0, o, "enableFog", function () {
                return this._enableFog;
            }, function (t) {
                this._enableFog !== t && (this._enableFog = t, t ? this._defineDatas.add(laya.d3.core.scene.Scene3D.SHADERDEFINE_FOG) : this._defineDatas.remove(laya.d3.core.scene.Scene3D.SHADERDEFINE_FOG));
            }), a(0, o, "url", function () {
                return this._url;
            }), a(0, o, "fogStart", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.FOGSTART);
            }, function (t) {
                this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.FOGSTART, t);
            }), a(0, o, "reflectionIntensity", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.REFLETIONINTENSITY);
            }, function (t) {
                t = Math.max(Math.min(t, 1), 0), this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.REFLETIONINTENSITY, t);
            }), a(0, o, "skyRenderer", function () {
                return this._skyRenderer;
            }), a(0, o, "fogRange", function () {
                return this._shaderValues.getNumber(laya.d3.core.scene.Scene3D.FOGRANGE);
            }, function (t) {
                this._shaderValues.setNumber(laya.d3.core.scene.Scene3D.FOGRANGE, t);
            }), a(0, o, "ambientColor", function () {
                return this._shaderValues.getVector(laya.d3.core.scene.Scene3D.AMBIENTCOLOR);
            }, function (t) {
                this._shaderValues.setVector3(laya.d3.core.scene.Scene3D.AMBIENTCOLOR, t);
            }), a(0, o, "customReflection", function () {
                return this._shaderValues.getTexture(laya.d3.core.scene.Scene3D.REFLECTIONTEXTURE);
            }, function (t) {
                this._shaderValues.setTexture(laya.d3.core.scene.Scene3D.REFLECTIONTEXTURE, t),
                    t ? this._defineDatas.add(laya.d3.core.scene.Scene3D.SHADERDEFINE_REFLECTMAP) : this._defineDatas.remove(laya.d3.core.scene.Scene3D.SHADERDEFINE_REFLECTMAP);
            }), a(0, o, "physicsSimulation", function () {
                return this._physicsSimulation;
            }), a(0, o, "reflectionMode", function () {
                return this._reflectionMode;
            }, function (t) {
                this._reflectionMode = t;
            }), a(0, o, "timer", function () {
                return this._timer;
            }, function (t) {
                this._timer = t;
            }), a(0, o, "input", function () {
                return this._input;
            }), e._parse = function (t, e, i) {
                var n, r = t.data, a = [];
                switch (t.version) {
                    case "LAYAHIERARCHY:02":
                        n = Ht._createNodeByJson02(r, a);
                        break;

                    default:
                        n = Ht._createNodeByJson(r, a);
                }
                return Z.combine(null, a), n;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "HIERARCHY");
            }, e.REFLECTIONMODE_SKYBOX = 0, e.REFLECTIONMODE_CUSTOM = 1, e.SHADERDEFINE_FOG = 0,
                e.SHADERDEFINE_DIRECTIONLIGHT = 0, e.SHADERDEFINE_POINTLIGHT = 0, e.SHADERDEFINE_SPOTLIGHT = 0,
                e.SHADERDEFINE_CAST_SHADOW = 0, e.SHADERDEFINE_SHADOW_PSSM1 = 0, e.SHADERDEFINE_SHADOW_PSSM2 = 0,
                e.SHADERDEFINE_SHADOW_PSSM3 = 0, e.SHADERDEFINE_SHADOW_PCF_NO = 0, e.SHADERDEFINE_SHADOW_PCF1 = 0,
                e.SHADERDEFINE_SHADOW_PCF2 = 0, e.SHADERDEFINE_SHADOW_PCF3 = 0, e.SHADERDEFINE_REFLECTMAP = 0,
                n(e, ["FOGCOLOR", function () {
                    return this.FOGCOLOR = Lt.propertyNameToID("u_FogColor");
                }, "FOGSTART", function () {
                    return this.FOGSTART = Lt.propertyNameToID("u_FogStart");
                }, "FOGRANGE", function () {
                    return this.FOGRANGE = Lt.propertyNameToID("u_FogRange");
                }, "LIGHTDIRECTION", function () {
                    return this.LIGHTDIRECTION = Lt.propertyNameToID("u_DirectionLight.Direction");
                }, "LIGHTDIRCOLOR", function () {
                    return this.LIGHTDIRCOLOR = Lt.propertyNameToID("u_DirectionLight.Color");
                }, "POINTLIGHTPOS", function () {
                    return this.POINTLIGHTPOS = Lt.propertyNameToID("u_PointLight.Position");
                }, "POINTLIGHTRANGE", function () {
                    return this.POINTLIGHTRANGE = Lt.propertyNameToID("u_PointLight.Range");
                }, "POINTLIGHTATTENUATION", function () {
                    return this.POINTLIGHTATTENUATION = Lt.propertyNameToID("u_PointLight.Attenuation");
                }, "POINTLIGHTCOLOR", function () {
                    return this.POINTLIGHTCOLOR = Lt.propertyNameToID("u_PointLight.Color");
                }, "SPOTLIGHTPOS", function () {
                    return this.SPOTLIGHTPOS = Lt.propertyNameToID("u_SpotLight.Position");
                }, "SPOTLIGHTDIRECTION", function () {
                    return this.SPOTLIGHTDIRECTION = Lt.propertyNameToID("u_SpotLight.Direction");
                }, "SPOTLIGHTSPOTANGLE", function () {
                    return this.SPOTLIGHTSPOTANGLE = Lt.propertyNameToID("u_SpotLight.Spot");
                }, "SPOTLIGHTRANGE", function () {
                    return this.SPOTLIGHTRANGE = Lt.propertyNameToID("u_SpotLight.Range");
                }, "SPOTLIGHTCOLOR", function () {
                    return this.SPOTLIGHTCOLOR = Lt.propertyNameToID("u_SpotLight.Color");
                }, "SHADOWDISTANCE", function () {
                    return this.SHADOWDISTANCE = Lt.propertyNameToID("u_shadowPSSMDistance");
                }, "SHADOWLIGHTVIEWPROJECT", function () {
                    return this.SHADOWLIGHTVIEWPROJECT = Lt.propertyNameToID("u_lightShadowVP");
                }, "SHADOWMAPPCFOFFSET", function () {
                    return this.SHADOWMAPPCFOFFSET = Lt.propertyNameToID("u_shadowPCFoffset");
                }, "SHADOWMAPTEXTURE1", function () {
                    return this.SHADOWMAPTEXTURE1 = Lt.propertyNameToID("u_shadowMap1");
                }, "SHADOWMAPTEXTURE2", function () {
                    return this.SHADOWMAPTEXTURE2 = Lt.propertyNameToID("u_shadowMap2");
                }, "SHADOWMAPTEXTURE3", function () {
                    return this.SHADOWMAPTEXTURE3 = Lt.propertyNameToID("u_shadowMap3");
                }, "AMBIENTCOLOR", function () {
                    return this.AMBIENTCOLOR = Lt.propertyNameToID("u_AmbientColor");
                }, "REFLECTIONTEXTURE", function () {
                    return this.REFLECTIONTEXTURE = Lt.propertyNameToID("u_ReflectTexture");
                }, "REFLETIONINTENSITY", function () {
                    return this.REFLETIONINTENSITY = Lt.propertyNameToID("u_ReflectIntensity");
                }, "TIME", function () {
                    return this.TIME = Lt.propertyNameToID("u_Time");
                }, "ANGLEATTENUATIONTEXTURE", function () {
                    return this.ANGLEATTENUATIONTEXTURE = Lt.propertyNameToID("u_AngleTexture");
                }, "RANGEATTENUATIONTEXTURE", function () {
                    return this.RANGEATTENUATIONTEXTURE = Lt.propertyNameToID("u_RangeTexture");
                }, "POINTLIGHTMATRIX", function () {
                    return this.POINTLIGHTMATRIX = Lt.propertyNameToID("u_PointLightMatrix");
                }, "SPOTLIGHTMATRIX", function () {
                    return this.SPOTLIGHTMATRIX = Lt.propertyNameToID("u_SpotLightMatrix");
                }]), e;
        }(D), Qi = function (t) {
            function e(t) {
                this.pickColor = null, this._render = null, e.__super.call(this, t);
            }
            r(e, "laya.d3.core.RenderableSprite3D", t);
            var i = e.prototype;
            return i._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this);
                var t = this._scene;
                t._removeRenderObject(this._render), this._render.castShadow && t._removeShadowCastRenderObject(this._render);
            }, i._onActive = function () {
                laya.display.Node.prototype._onActive.call(this);
                var t = this._scene;
                t._addRenderObject(this._render), this._render.castShadow && t._addShadowCastRenderObject(this._render);
            }, i._onActiveInScene = function () {
                if (laya.display.Node.prototype._onActiveInScene.call(this), W._editerEnvironment) {
                    var t = this._scene, e = new pt();
                    t._allotPickColorByID(this.id, e), t._pickIdToSprite[this.id] = this, this._render._shaderValues.setVector(laya.d3.core.RenderableSprite3D.PICKCOLOR, e);
                }
            }, i._addToInitStaticBatchManager = function () { }, i._setBelongScene = function (t) {
                laya.display.Node.prototype._setBelongScene.call(this, t), this._render._setBelongScene(t);
            }, i._setUnBelongScene = function () {
                this._render._defineDatas.remove(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),
                    laya.display.Node.prototype._setUnBelongScene.call(this);
            }, i._changeHierarchyAnimator = function (e) {
                if (this._hierarchyAnimator) {
                    var i = this._hierarchyAnimator._renderableSprites;
                    i.splice(i.indexOf(this), 1);
                }
                e && e._renderableSprites.push(this), t.prototype._changeHierarchyAnimator.call(this, e);
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), t.prototype.destroy.call(this, e), this._render._destroy(),
                    this._render = null;
            }, e.__init__ = function () {
                e.SHADERDEFINE_RECEIVE_SHADOW = e.shaderDefines.registerDefine("RECEIVESHADOW"),
                    e.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV = e.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),
                    e.SAHDERDEFINE_LIGHTMAP = e.shaderDefines.registerDefine("LIGHTMAP");
            }, e.SHADERDEFINE_RECEIVE_SHADOW = 0, e.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV = 0,
                e.SAHDERDEFINE_LIGHTMAP = 0, n(e, ["LIGHTMAPSCALEOFFSET", function () {
                    return this.LIGHTMAPSCALEOFFSET = Lt.propertyNameToID("u_LightmapScaleOffset");
                }, "LIGHTMAP", function () {
                    return this.LIGHTMAP = Lt.propertyNameToID("u_LightMap");
                }, "PICKCOLOR", function () {
                    return this.PICKCOLOR = Lt.propertyNameToID("u_PickColor");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt();
                }]), e;
        }(Bi), Ji = function (t) {
            function e() {
                this._albedoIntensity = 1, this._enableVertexColor = !1, this._albedoColor = new pt(1, 1, 1, 1),
                    e.__super.call(this), this.setShaderName("Unlit"), this._shaderValues.setVector(e.ALBEDOCOLOR, new pt(1, 1, 1, 1)),
                    this.renderMode = 0;
            }
            r(e, "laya.d3.core.material.UnlitMaterial", t);
            var i = e.prototype;
            return a(0, i, "_ColorB", function () {
                return this._albedoColor.z;
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorR", function () {
                return this._albedoColor.x;
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "albedoColorA", function () {
                return this._ColorA;
            }, function (t) {
                this._ColorA = t;
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "_ColorG", function () {
                return this._albedoColor.y;
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorA", function () {
                return this._albedoColor.w;
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_AlbedoIntensity", function () {
                return this._albedoIntensity;
            }, function (t) {
                if (this._albedoIntensity !== t) {
                    var i = this._shaderValues.getVector(e.ALBEDOCOLOR);
                    pt.scale(this._albedoColor, t, i), this._albedoIntensity = t, this._shaderValues.setVector(e.ALBEDOCOLOR, i);
                }
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "_Cutoff", function () {
                return this.alphaTestValue;
            }, function (t) {
                this.alphaTestValue = t;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "albedoColorR", function () {
                return this._ColorR;
            }, function (t) {
                this._ColorR = t;
            }), a(0, i, "albedoColorG", function () {
                return this._ColorG;
            }, function (t) {
                this._ColorG = t;
            }), a(0, i, "albedoColorB", function () {
                return this._ColorB;
            }, function (t) {
                this._ColorB = t;
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "albedoColor", function () {
                return this._albedoColor;
            }, function (t) {
                var i = this._shaderValues.getVector(e.ALBEDOCOLOR);
                pt.scale(t, this._albedoIntensity, i), this._albedoColor = t, this._shaderValues.setVector(e.ALBEDOCOLOR, i);
            }), a(0, i, "albedoIntensity", function () {
                return this._albedoIntensity;
            }, function (t) {
                this._AlbedoIntensity = t;
            }), a(0, i, "enableVertexColor", function () {
                return this._enableVertexColor;
            }, function (t) {
                this._enableVertexColor = t, t ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);
            }), a(0, i, "albedoTexture", function () {
                return this._shaderValues.getTexture(e.ALBEDOTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_ALBEDOTEXTURE),
                    this._shaderValues.setTexture(e.ALBEDOTEXTURE, t);
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.UnlitMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513;
                        break;

                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513;
                        break;

                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513;
                        break;

                    default:
                        throw new Error("UnlitMaterial : renderMode value error.");
                }
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_ALBEDOTEXTURE = e.shaderDefines.registerDefine("ALBEDOTEXTURE"),
                    e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"), e.SHADERDEFINE_ENABLEVERTEXCOLOR = e.shaderDefines.registerDefine("ENABLEVERTEXCOLOR");
            }, e.RENDERMODE_OPAQUE = 0, e.RENDERMODE_CUTOUT = 1, e.RENDERMODE_TRANSPARENT = 2,
                e.RENDERMODE_ADDTIVE = 3, e.SHADERDEFINE_ALBEDOTEXTURE = 0, e.SHADERDEFINE_TILINGOFFSET = 0,
                e.SHADERDEFINE_ENABLEVERTEXCOLOR = 0, n(e, ["ALBEDOTEXTURE", function () {
                    return this.ALBEDOTEXTURE = Lt.propertyNameToID("u_AlbedoTexture");
                }, "ALBEDOCOLOR", function () {
                    return this.ALBEDOCOLOR = Lt.propertyNameToID("u_AlbedoColor");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), $i = function (t) {
            function e() {
                this._intensityColor = null, this._intensity = NaN, this._shadow = !1, this._shadowFarPlane = 0,
                    this._shadowMapSize = 0, this._shadowMapCount = 0, this._shadowMapPCFType = 0, this._parallelSplitShadowMap = null,
                    this._lightmapBakedType = 0, this.color = null, e.__super.call(this), this._intensity = 1,
                    this._intensityColor = new gt(), this.color = new gt(1, 1, 1), this._shadow = !1,
                    this._shadowFarPlane = 8, this._shadowMapSize = 512, this._shadowMapCount = 1, this._shadowMapPCFType = 0,
                    this._lightmapBakedType = e.LIGHTMAPBAKEDTYPE_REALTIME;
            }
            r(e, "laya.d3.core.light.LightSprite", t);
            var i = e.prototype;
            return i._parse = function (e, i) {
                t.prototype._parse.call(this, e, i);
                var n = e.color;
                this.color.fromArray(n), this.intensity = e.intensity, this.lightmapBakedType = e.lightmapBakedType;
            }, i._onActive = function () {
                laya.display.Node.prototype._onActive.call(this), this.lightmapBakedType !== e.LIGHTMAPBAKEDTYPE_BAKED && this._scene._addLight(this);
            }, i._onInActive = function () {
                laya.display.Node.prototype._onInActive.call(this), this.lightmapBakedType !== e.LIGHTMAPBAKEDTYPE_BAKED && this._scene._removeLight(this);
            }, i._prepareToScene = function () {
                return !1;
            }, a(0, i, "lightmapBakedType", function () {
                return this._lightmapBakedType;
            }, function (t) {
                this._lightmapBakedType !== t && (this._lightmapBakedType = t, this.activeInHierarchy && (t !== e.LIGHTMAPBAKEDTYPE_BAKED ? this._scene._addLight(this) : this._scene._removeLight(this)));
            }), a(0, i, "shadowPCFType", function () {
                return this._shadowMapPCFType;
            }, function (t) {
                this._shadowMapPCFType = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setPCFType(t);
            }), a(0, i, "intensity", function () {
                return this._intensity;
            }, function (t) {
                this._intensity = t;
            }), a(0, i, "shadow", function () {
                return this._shadow;
            }, function (t) {
                throw new Error("LightSprite: must override it.");
            }), a(0, i, "shadowDistance", function () {
                return this._shadowFarPlane;
            }, function (t) {
                this._shadowFarPlane = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setFarDistance(t);
            }), a(0, i, "shadowPSSMCount", function () {
                return this._shadowMapCount;
            }, function (t) {
                this._shadowMapCount = t, this._parallelSplitShadowMap && (this._parallelSplitShadowMap.shadowMapCount = t);
            }), a(0, i, "shadowResolution", function () {
                return this._shadowMapSize;
            }, function (t) {
                this._shadowMapSize = t, this._parallelSplitShadowMap && this._parallelSplitShadowMap.setShadowMapTextureSize(t);
            }), a(0, i, "diffuseColor", function () {
                return console.log("LightSprite: discard property,please use color property instead."),
                    this.color;
            }, function (t) {
                console.log("LightSprite: discard property,please use color property instead."),
                    this.color = t;
            }), e.LIGHTMAPBAKEDTYPE_REALTIME = 0, e.LIGHTMAPBAKEDTYPE_MIXED = 1, e.LIGHTMAPBAKEDTYPE_BAKED = 2,
                e;
        }(Bi), tn = function (t) {
            function e(t) {
                this._terrainRes = null, this._lightmapScaleOffset = null, e.__super.call(this),
                    this._lightmapScaleOffset = new pt(1, 1, 0, 0), t && (this._terrainRes = t, this.buildTerrain(t));
            }
            r(e, "laya.d3.terrain.Terrain", t);
            var n = e.prototype;
            return n._parse = function (e, i) {
                t.prototype._parse.call(this, e, i), this.terrainRes = T.getRes(e.dataPath);
                var n = e.lightmapIndex;
                null != n && this.setLightmapIndex(n);
                var r = e.lightmapScaleOffset;
                r && this.setLightmapScaleOffset(new pt(r[0], r[1], r[2], r[3]));
            }, n.setLightmapIndex = function (t) {
                for (var e = 0; e < this._children.length; e++) {
                    this._children[e].terrainRender.lightmapIndex = t;
                }
            }, n.setLightmapScaleOffset = function (t) {
                if (t) {
                    t.cloneTo(this._lightmapScaleOffset);
                    for (var e = 0; e < this._children.length; e++) {
                        this._children[e].terrainRender.lightmapScaleOffset = this._lightmapScaleOffset;
                    }
                }
            }, n.disableLight = function () {
                for (var t = 0, e = this._children.length; t < e; t++) for (var i = this._children[t], n = 0, r = i._render.sharedMaterials.length; n < r; n++) {
                    i._render.sharedMaterials[n].disableLight();
                }
            }, n.buildTerrain = function (t) {
                for (var e = t._chunkNumX, i = t._chunkNumZ, n = t._heightData, r = 0, a = 0; a < i; a++) for (var s = 0; s < e; s++) {
                    for (var o = new In(s, a, t._gridSize, n._terrainHeightData, n._width, n._height, t._cameraCoordinateInverse), l = t._chunkInfos[r++], h = 0; h < l.alphaMap.length; h++) {
                        var u = l.detailID[h].length, c = u > 0 ? t._detailTextureInfos[l.detailID[h][0]].diffuseTexture : null, d = u > 1 ? t._detailTextureInfos[l.detailID[h][1]].diffuseTexture : null, _ = u > 2 ? t._detailTextureInfos[l.detailID[h][2]].diffuseTexture : null, f = u > 3 ? t._detailTextureInfos[l.detailID[h][3]].diffuseTexture : null, p = u > 0 ? t._detailTextureInfos[l.detailID[h][0]].scale : null, m = u > 1 ? t._detailTextureInfos[l.detailID[h][1]].scale : null, g = u > 2 ? t._detailTextureInfos[l.detailID[h][2]].scale : null, y = u > 3 ? t._detailTextureInfos[l.detailID[h][3]].scale : null;
                        o.buildRenderElementAndMaterial(u, l.normalMap, l.alphaMap[h], c, d, _, f, t._materialInfo.ambientColor, t._materialInfo.diffuseColor, t._materialInfo.specularColor, p ? p.x : 1, p ? p.y : 1, m ? m.x : 1, m ? m.y : 1, g ? g.x : 1, g ? g.y : 1, y ? y.x : 1, y ? y.y : 1);
                    }
                    o.terrainRender.receiveShadow = !0, o.terrainRender.lightmapScaleOffset = this._lightmapScaleOffset,
                        this.addChild(o);
                }
            }, n.width = function () {
                return this._terrainRes._chunkNumX * ct.CHUNK_GRID_NUM * this._terrainRes._gridSize;
            }, n.depth = function () {
                return this._terrainRes._chunkNumZ * ct.CHUNK_GRID_NUM * this._terrainRes._gridSize;
            }, n.getHeightXZ = function (t, i) {
                if (!this._terrainRes) return NaN;
                if (t -= this.transform.position.x, i -= this.transform.position.z, e.__VECTOR3__ || (e.__VECTOR3__ = new gt()),
                    e.__VECTOR3__.x = t, e.__VECTOR3__.y = 0, e.__VECTOR3__.z = i, gt.transformV3ToV3(e.__VECTOR3__, ct.__ADAPT_MATRIX_INV__, e.__VECTOR3__),
                    t = e.__VECTOR3__.x, i = e.__VECTOR3__.z, t < 0 || t > this.width() || i < 0 || i > this.depth()) return NaN;
                var n = this._terrainRes._gridSize, r = parseInt("" + t / n), a = parseInt("" + i / n), s = t - r * n, o = i - a * n, l = NaN, h = this._terrainRes._heightData;
                return s + o > n ? (l = h._terrainHeightData[(a + 1 - 1) * h._width + r + 1]) + (h._terrainHeightData[(a + 1 - 1) * h._width + r] - l) * ((n - s) / n) + (h._terrainHeightData[(a - 1) * h._width + r + 1] - l) * ((n - o) / n) : (l = h._terrainHeightData[Math.max(0, a - 1) * h._width + r]) + (h._terrainHeightData[Math.min(h._width * h._height - 1, (a + 1 - 1) * h._width + r)] - l) * (o / n) + (h._terrainHeightData[Math.min(h._width * h._height - 1, Math.max(0, a - 1) * h._width + r + 1)] - l) * (s / n);
            }, a(0, n, "terrainRes", null, function (t) {
                t && (this._terrainRes = t, this.buildTerrain(t));
            }), e.load = function (t) {
                i.loader.create(t, null, null, "TERRAIN", null, null, 1, !1);
            }, e.RENDER_LINE_MODEL = !1, e.LOD_TOLERANCE_VALUE = 4, e.LOD_DISTANCE_FACTOR = 2,
                e.__VECTOR3__ = null, e;
        }(Bi), en = function (t) {
            function e() {
                this._color = null, e.__super.call(this), this.setShaderName("Trail"), this._color = new pt(1, 1, 1, 1),
                    this._shaderValues.setVector(e.TINTCOLOR, new pt(1, 1, 1, 1)), this.renderMode = 0;
            }
            r(e, "laya.d3.core.trail.TrailMaterial", t);
            var i = e.prototype;
            return a(0, i, "_TintColorB", function () {
                return this._color.z;
            }, function (t) {
                this._color.z = t, this.color = this._color;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "texture", function () {
                return this._shaderValues.getTexture(e.MAINTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_MAINTEXTURE),
                    this._shaderValues.setTexture(e.MAINTEXTURE, t);
            }), a(0, i, "_TintColorR", function () {
                return this._color.x;
            }, function (t) {
                this._color.x = t, this.color = this._color;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "_TintColorG", function () {
                return this._color.y;
            }, function (t) {
                this._color.y = t, this.color = this._color;
            }), a(0, i, "_TintColorA", function () {
                return this._color.w;
            }, function (t) {
                this._color.w = t, this.color = this._color;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 1, this.depthTest = 513, this._defineDatas.add(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    case 0:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513,
                            this._defineDatas.remove(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    default:
                        throw new Error("TrailMaterial : renderMode value error.");
                }
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "colorR", function () {
                return this._TintColorR;
            }, function (t) {
                this._TintColorR = t;
            }), a(0, i, "colorG", function () {
                return this._TintColorG;
            }, function (t) {
                this._TintColorG = t;
            }), a(0, i, "colorB", function () {
                return this._TintColorB;
            }, function (t) {
                this._TintColorB = t;
            }), a(0, i, "colorA", function () {
                return this._TintColorA;
            }, function (t) {
                this._TintColorA = t;
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "color", function () {
                return this._shaderValues.getVector(e.TINTCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.TINTCOLOR, t);
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.trail.TrailMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_MAINTEXTURE = e.shaderDefines.registerDefine("MAINTEXTURE"), e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"),
                    e.SHADERDEFINE_ADDTIVEFOG = e.shaderDefines.registerDefine("ADDTIVEFOG");
            }, e.RENDERMODE_ALPHABLENDED = 0, e.RENDERMODE_ADDTIVE = 1, e.SHADERDEFINE_MAINTEXTURE = 0,
                e.SHADERDEFINE_TILINGOFFSET = 0, e.SHADERDEFINE_ADDTIVEFOG = 0, n(e, ["defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "MAINTEXTURE", function () {
                    return this.MAINTEXTURE = Lt.propertyNameToID("u_MainTexture");
                }, "TINTCOLOR", function () {
                    return this.TINTCOLOR = Lt.propertyNameToID("u_MainColor");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), nn = function (t) {
            function e() {
                this._sunDisk = 0, e.__super.call(this), this.setShaderName("SkyBoxProcedural"),
                    this.sunDisk = 1, this.sunSize = .04, this.sunSizeConvergence = 5, this.atmosphereThickness = 1,
                    this.skyTint = new pt(.5, .5, .5, 1), this.groundTint = new pt(.369, .349, .341, 1),
                    this.exposure = 1.3;
            }
            r(e, "laya.d3.core.material.SkyProceduralMaterial", t);
            var i = e.prototype;
            return a(0, i, "exposure", function () {
                return this._shaderValues.getNumber(e.EXPOSURE);
            }, function (t) {
                t = Math.min(Math.max(0, t), 8), this._shaderValues.setNumber(e.EXPOSURE, t);
            }), a(0, i, "sunSize", function () {
                return this._shaderValues.getNumber(e.SUNSIZE);
            }, function (t) {
                t = Math.min(Math.max(0, t), 1), this._shaderValues.setNumber(e.SUNSIZE, t);
            }), a(0, i, "sunDisk", function () {
                return this._sunDisk;
            }, function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_SIMPLE), this._defineDatas.add(e.SHADERDEFINE_SUN_HIGH_QUALITY);
                        break;

                    case 2:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_HIGH_QUALITY), this._defineDatas.add(e.SHADERDEFINE_SUN_SIMPLE);
                        break;

                    case 0:
                        this._defineDatas.remove(e.SHADERDEFINE_SUN_HIGH_QUALITY), this._defineDatas.remove(e.SHADERDEFINE_SUN_SIMPLE);
                        break;

                    default:
                        throw "SkyBoxProceduralMaterial: unknown sun value.";
                }
                this._sunDisk = t;
            }), a(0, i, "sunSizeConvergence", function () {
                return this._shaderValues.getNumber(e.SUNSIZECONVERGENCE);
            }, function (t) {
                t = Math.min(Math.max(0, t), 20), this._shaderValues.setNumber(e.SUNSIZECONVERGENCE, t);
            }), a(0, i, "atmosphereThickness", function () {
                return this._shaderValues.getNumber(e.ATMOSPHERETHICKNESS);
            }, function (t) {
                t = Math.min(Math.max(0, t), 5), this._shaderValues.setNumber(e.ATMOSPHERETHICKNESS, t);
            }), a(0, i, "groundTint", function () {
                return this._shaderValues.getVector(e.GROUNDTINT);
            }, function (t) {
                this._shaderValues.setVector(e.GROUNDTINT, t);
            }), a(0, i, "skyTint", function () {
                return this._shaderValues.getVector(e.SKYTINT);
            }, function (t) {
                this._shaderValues.setVector(e.SKYTINT, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_SUN_HIGH_QUALITY = e.shaderDefines.registerDefine("SUN_HIGH_QUALITY"),
                    e.SHADERDEFINE_SUN_SIMPLE = e.shaderDefines.registerDefine("SUN_SIMPLE");
            }, e.SUN_NODE = 0, e.SUN_HIGH_QUALITY = 1, e.SUN_SIMPLE = 2, e.SHADERDEFINE_SUN_HIGH_QUALITY = 0,
                e.SHADERDEFINE_SUN_SIMPLE = 0, n(e, ["SUNSIZE", function () {
                    return this.SUNSIZE = Lt.propertyNameToID("u_SunSize");
                }, "SUNSIZECONVERGENCE", function () {
                    return this.SUNSIZECONVERGENCE = Lt.propertyNameToID("u_SunSizeConvergence");
                }, "ATMOSPHERETHICKNESS", function () {
                    return this.ATMOSPHERETHICKNESS = Lt.propertyNameToID("u_AtmosphereThickness");
                }, "SKYTINT", function () {
                    return this.SKYTINT = Lt.propertyNameToID("u_SkyTint");
                }, "GROUNDTINT", function () {
                    return this.GROUNDTINT = Lt.propertyNameToID("u_GroundTint");
                }, "EXPOSURE", function () {
                    return this.EXPOSURE = Lt.propertyNameToID("u_Exposure");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), rn = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("LineShader"), this._shaderValues.setVector(e.COLOR, new pt(1, 1, 1, 1));
            }
            r(e, "laya.d3.core.pixelLine.PixelLineMaterial", t);
            var i = e.prototype;
            return a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "color", function () {
                return this._shaderValues.getVector(e.COLOR);
            }, function (t) {
                this._shaderValues.setVector(e.COLOR, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), n(e, ["COLOR", function () {
                return this.COLOR = Lt.propertyNameToID("u_Color");
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e();
            }, "shaderDefines", function () {
                return this.shaderDefines = new mt(Fi.shaderDefines);
            }, "CULL", function () {
                return this.CULL = Lt.propertyNameToID("s_Cull");
            }, "BLEND", function () {
                return this.BLEND = Lt.propertyNameToID("s_Blend");
            }, "BLEND_SRC", function () {
                return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
            }, "BLEND_DST", function () {
                return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
            }, "DEPTH_TEST", function () {
                return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
            }, "DEPTH_WRITE", function () {
                return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
            }]), e;
        }(Fi), an = function (t) {
            function e(t, n) {
                e.__super.call(this), this._skyRenderer = new pe(), this._forward = new gt(), this._up = new gt(),
                    this.clearColor = new pt(100 / 255, 149 / 255, 237 / 255, 1), void 0 === t && (t = .3),
                    void 0 === n && (n = 1e3), this._shaderValues = new ut(null), this._fieldOfView = 60,
                    this._useUserProjectionMatrix = !1, this._orthographic = !1, this._orthographicVerticalSize = 10,
                    this.renderingOrder = 0, this._nearPlane = t, this._farPlane = n, this.cullingMask = 2147483647,
                    this.clearFlag = 0, this.useOcclusionCulling = !0, this._calculateProjectionMatrix(),
                    i.stage.on("resize", this, this._onScreenSizeChanged);
            }
            r(e, "laya.d3.core.BaseCamera", t);
            var s = e.prototype;
            return s._sortCamerasByRenderingOrder = function () {
                if (this.displayedInStage) for (var t = this.scene._cameraPool, e = t.length - 1, i = 0; i < e; i++) if (t[i].renderingOrder > t[e].renderingOrder) {
                    var n = t[i];
                    t[i] = t[e], t[e] = n;
                }
            }, s._calculateProjectionMatrix = function () { }, s._onScreenSizeChanged = function () {
                this._calculateProjectionMatrix();
            }, s._prepareCameraToRender = function () {
                this.transform.getForward(this._forward), this.transform.getUp(this._up);
                var t = this._shaderValues;
                t.setVector3(laya.d3.core.BaseCamera.CAMERAPOS, this.transform.position), t.setVector3(laya.d3.core.BaseCamera.CAMERADIRECTION, this._forward),
                    t.setVector3(laya.d3.core.BaseCamera.CAMERAUP, this._up);
            }, s._prepareCameraViewProject = function (t, i, n, r) {
                var a = this._shaderValues;
                a.setMatrix4x4(laya.d3.core.BaseCamera.VIEWMATRIX, t), a.setMatrix4x4(laya.d3.core.BaseCamera.PROJECTMATRIX, i),
                    a.setMatrix4x4(laya.d3.core.BaseCamera.VIEWPROJECTMATRIX, n), this.transform.worldMatrix.cloneTo(e._tempMatrix4x40),
                    e._tempMatrix4x40.transpose(), ze.multiply(i, e._tempMatrix4x40, r), a.setMatrix4x4(laya.d3.core.BaseCamera.VPMATRIX_NO_TRANSLATE, r);
            }, s.render = function (t, e) { }, s.addLayer = function (t) {
                this.cullingMask |= Math.pow(2, t);
            }, s.removeLayer = function (t) {
                this.cullingMask &= ~Math.pow(2, t);
            }, s.addAllLayers = function () {
                this.cullingMask = 2147483647;
            }, s.removeAllLayers = function () {
                this.cullingMask = 0;
            }, s.resetProjectionMatrix = function () {
                this._useUserProjectionMatrix = !1, this._calculateProjectionMatrix();
            }, s._onActive = function () {
                this._scene._addCamera(this), laya.display.Node.prototype._onActive.call(this);
            }, s._onInActive = function () {
                this._scene._removeCamera(this), laya.display.Node.prototype._onInActive.call(this);
            }, s._parse = function (e, i) {
                t.prototype._parse.call(this, e, i);
                var n = e.clearFlag;
                void 0 !== n && (this.clearFlag = n), this.orthographic = e.orthographic, this.fieldOfView = e.fieldOfView,
                    this.nearPlane = e.nearPlane, this.farPlane = e.farPlane;
                var r = e.clearColor;
                this.clearColor = new pt(r[0], r[1], r[2], r[3]);
                var a = e.skyboxMaterial;
                a && (this._skyRenderer.material = T.getRes(a.path));
            }, s.destroy = function (e) {
                void 0 === e && (e = !0), this._skyRenderer.destroy(), this._skyRenderer = null,
                    i.stage.off("resize", this, this._onScreenSizeChanged), t.prototype.destroy.call(this, e);
            }, a(0, s, "renderingOrder", function () {
                return this._renderingOrder;
            }, function (t) {
                this._renderingOrder = t, this._sortCamerasByRenderingOrder();
            }), a(0, s, "skyRenderer", function () {
                return this._skyRenderer;
            }), a(0, s, "orthographic", function () {
                return this._orthographic;
            }, function (t) {
                this._orthographic = t, this._calculateProjectionMatrix();
            }), a(0, s, "fieldOfView", function () {
                return this._fieldOfView;
            }, function (t) {
                this._fieldOfView = t, this._calculateProjectionMatrix();
            }), a(0, s, "nearPlane", function () {
                return this._nearPlane;
            }, function (t) {
                this._nearPlane = t, this._calculateProjectionMatrix();
            }), a(0, s, "farPlane", function () {
                return this._farPlane;
            }, function (t) {
                this._farPlane = t, this._calculateProjectionMatrix();
            }), a(0, s, "orthographicVerticalSize", function () {
                return this._orthographicVerticalSize;
            }, function (t) {
                this._orthographicVerticalSize = t, this._calculateProjectionMatrix();
            }), e.RENDERINGTYPE_DEFERREDLIGHTING = "DEFERREDLIGHTING", e.RENDERINGTYPE_FORWARDRENDERING = "FORWARDRENDERING",
                e.CLEARFLAG_SOLIDCOLOR = 0, e.CLEARFLAG_SKY = 1, e.CLEARFLAG_DEPTHONLY = 2, e.CLEARFLAG_NONE = 3,
                n(e, ["_tempMatrix4x40", function () {
                    return this._tempMatrix4x40 = new ze();
                }, "CAMERAPOS", function () {
                    return this.CAMERAPOS = Lt.propertyNameToID("u_CameraPos");
                }, "VIEWMATRIX", function () {
                    return this.VIEWMATRIX = Lt.propertyNameToID("u_View");
                }, "PROJECTMATRIX", function () {
                    return this.PROJECTMATRIX = Lt.propertyNameToID("u_Projection");
                }, "VIEWPROJECTMATRIX", function () {
                    return this.VIEWPROJECTMATRIX = Lt.propertyNameToID("u_ViewProjection");
                }, "VPMATRIX_NO_TRANSLATE", function () {
                    return this.VPMATRIX_NO_TRANSLATE = Lt.propertyNameToID("u_MvpMatrix");
                }, "CAMERADIRECTION", function () {
                    return this.CAMERADIRECTION = Lt.propertyNameToID("u_CameraDirection");
                }, "CAMERAUP", function () {
                    return this.CAMERAUP = Lt.propertyNameToID("u_CameraUp");
                }, "_invertYScaleMatrix", function () {
                    return this._invertYScaleMatrix = new ze(1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
                }, "_invertYProjectionMatrix", function () {
                    return this._invertYProjectionMatrix = new ze();
                }, "_invertYProjectionViewMatrix", function () {
                    return this._invertYProjectionViewMatrix = new ze();
                }]), e;
        }(Bi), sn = function (t) {
            function e() {
                this._albedoColor = null, this._emissionColor = null, e.__super.call(this), this.setShaderName("PBRStandard"),
                    this._albedoColor = new pt(1, 1, 1, 1), this._shaderValues.setVector(e.ALBEDOCOLOR, new pt(1, 1, 1, 1)),
                    this._emissionColor = new pt(0, 0, 0, 0), this._shaderValues.setVector(e.EMISSIONCOLOR, new pt(0, 0, 0, 0)),
                    this._shaderValues.setNumber(e.METALLIC, 0), this._shaderValues.setNumber(e.SMOOTHNESS, .5),
                    this._shaderValues.setNumber(e.SMOOTHNESSSCALE, 1), this._shaderValues.setNumber(e.SMOOTHNESSSOURCE, 0),
                    this._shaderValues.setNumber(e.OCCLUSIONSTRENGTH, 1), this._shaderValues.setNumber(e.NORMALSCALE, 1),
                    this._shaderValues.setNumber(e.PARALLAXSCALE, .001), this._shaderValues.setBool(e.ENABLEEMISSION, !1),
                    this._shaderValues.setBool(e.ENABLEREFLECT, !0), this._shaderValues.setNumber(Fi.ALPHATESTVALUE, .5),
                    this._disablePublicDefineDatas.remove(Zi.SHADERDEFINE_REFLECTMAP), this.renderMode = 0;
            }
            r(e, "laya.d3.core.material.PBRStandardMaterial", t);
            var i = e.prototype;
            return i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                this._albedoColor.cloneTo(i._albedoColor), this._emissionColor.cloneTo(i._emissionColor);
            }, a(0, i, "_Parallax", function () {
                return this._shaderValues.getNumber(e.PARALLAXSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.PARALLAXSCALE, t);
            }), a(0, i, "_ColorB", function () {
                return this._albedoColor.z;
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorR", function () {
                return this._albedoColor.x;
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorG", function () {
                return this._albedoColor.y;
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "metallic", function () {
                return this._Metallic;
            }, function (t) {
                this._Metallic = Math.max(0, Math.min(1, t));
            }), a(0, i, "_GlossMapScale", function () {
                return this._shaderValues.getNumber(e.SMOOTHNESSSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.SMOOTHNESSSCALE, t);
            }), a(0, i, "_Glossiness", function () {
                return this._shaderValues.getNumber(e.SMOOTHNESS);
            }, function (t) {
                this._shaderValues.setNumber(e.SMOOTHNESS, t);
            }), a(0, i, "_ColorA", function () {
                return this._albedoColor.w;
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "enableReflection", function () {
                return this._shaderValues.getBool(e.ENABLEREFLECT);
            }, function (t) {
                this._shaderValues.setBool(e.ENABLEREFLECT, !0), t ? this._disablePublicDefineDatas.remove(Zi.SHADERDEFINE_REFLECTMAP) : this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_REFLECTMAP);
            }), a(0, i, "_Metallic", function () {
                return this._shaderValues.getNumber(e.METALLIC);
            }, function (t) {
                this._shaderValues.setNumber(e.METALLIC, t);
            }), a(0, i, "_BumpScale", function () {
                return this._shaderValues.getNumber(e.NORMALSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.NORMALSCALE, t);
            }), a(0, i, "_OcclusionStrength", function () {
                return this._shaderValues.getNumber(e.OCCLUSIONSTRENGTH);
            }, function (t) {
                this._shaderValues.setNumber(e.OCCLUSIONSTRENGTH, t);
            }), a(0, i, "_EmissionColorR", function () {
                return this._emissionColor.x;
            }, function (t) {
                this._emissionColor.x = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "_EmissionColorG", function () {
                return this._emissionColor.y;
            }, function (t) {
                this._emissionColor.y = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "_EmissionColorB", function () {
                return this._emissionColor.z;
            }, function (t) {
                this._emissionColor.z = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "_EmissionColorA", function () {
                return this._emissionColor.w;
            }, function (t) {
                this._emissionColor.w = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "albedoColorA", function () {
                return this._ColorA;
            }, function (t) {
                this._ColorA = t;
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "_Cutoff", function () {
                return this.alphaTestValue;
            }, function (t) {
                this.alphaTestValue = t;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "albedoColorR", function () {
                return this._ColorR;
            }, function (t) {
                this._ColorR = t;
            }), a(0, i, "albedoColorG", function () {
                return this._ColorG;
            }, function (t) {
                this._ColorG = t;
            }), a(0, i, "albedoColorB", function () {
                return this._ColorB;
            }, function (t) {
                this._ColorB = t;
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "albedoColor", function () {
                return this._albedoColor;
            }, function (t) {
                this._albedoColor = t, this._shaderValues.setVector(e.ALBEDOCOLOR, t);
            }), a(0, i, "albedoTexture", function () {
                return this._shaderValues.getTexture(e.ALBEDOTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_ALBEDOTEXTURE),
                    this._shaderValues.setTexture(e.ALBEDOTEXTURE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "parallaxTexture", function () {
                return this._shaderValues.getTexture(e.PARALLAXTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_PARALLAXTEXTURE),
                    this._shaderValues.setTexture(e.PARALLAXTEXTURE, t);
            }), a(0, i, "normalTexture", function () {
                return this._shaderValues.getTexture(e.NORMALTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_NORMALTEXTURE),
                    this._shaderValues.setTexture(e.NORMALTEXTURE, t);
            }), a(0, i, "emissionColor", function () {
                return this._shaderValues.getVector(e.EMISSIONCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.EMISSIONCOLOR, t);
            }), a(0, i, "parallaxTextureScale", function () {
                return this._Parallax;
            }, function (t) {
                this._Parallax = Math.max(.005, Math.min(.08, t));
            }), a(0, i, "normalTextureScale", function () {
                return this._BumpScale;
            }, function (t) {
                this._BumpScale = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "occlusionTexture", function () {
                return this._shaderValues.getTexture(e.OCCLUSIONTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_OCCLUSIONTEXTURE),
                    this._shaderValues.setTexture(e.OCCLUSIONTEXTURE, t);
            }), a(0, i, "occlusionTextureStrength", function () {
                return this._OcclusionStrength;
            }, function (t) {
                this._OcclusionStrength = Math.max(0, Math.min(1, t));
            }), a(0, i, "enableEmission", function () {
                return this._shaderValues.getBool(e.ENABLEEMISSION);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSION),
                    this._shaderValues.setBool(e.ENABLEEMISSION, t);
            }), a(0, i, "metallicGlossTexture", function () {
                return this._shaderValues.getTexture(e.METALLICGLOSSTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_METALLICGLOSSTEXTURE),
                    this._shaderValues.setTexture(e.METALLICGLOSSTEXTURE, t);
            }), a(0, i, "emissionColorA", function () {
                return this._EmissionColorA;
            }, function (t) {
                this._EmissionColorA = t;
            }), a(0, i, "smoothness", function () {
                return this._Glossiness;
            }, function (t) {
                this._Glossiness = Math.max(0, Math.min(1, t));
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "smoothnessTextureScale", function () {
                return this._GlossMapScale;
            }, function (t) {
                this._GlossMapScale = Math.max(0, Math.min(1, t));
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "smoothnessSource", function () {
                return this._shaderValues.getInt(e.SMOOTHNESSSOURCE);
            }, function (t) {
                t ? (this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA),
                    this._shaderValues.setInt(e.SMOOTHNESSSOURCE, 1)) : (this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA),
                        this._shaderValues.setInt(e.SMOOTHNESSSOURCE, 0));
            }), a(0, i, "emissionColorR", function () {
                return this._EmissionColorR;
            }, function (t) {
                this._EmissionColorR = t;
            }), a(0, i, "emissionColorG", function () {
                return this._EmissionColorG;
            }, function (t) {
                this._EmissionColorG = t;
            }), a(0, i, "emissionColorB", function () {
                return this._EmissionColorB;
            }, function (t) {
                this._EmissionColorB = t;
            }), a(0, i, "emissionTexture", function () {
                return this._shaderValues.getTexture(e.EMISSIONTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRStandardMaterial.SHADERDEFINE_EMISSIONTEXTURE),
                    this._shaderValues.setTexture(e.EMISSIONTEXTURE, t);
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513, this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513, this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513,
                            this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 3:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 1, this.blendDst = 771, this.depthTest = 513, this._defineDatas.add(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    default:
                        throw new Error("PBRSpecularMaterial : renderMode value error.");
                }
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_ALBEDOTEXTURE = e.shaderDefines.registerDefine("ALBEDOTEXTURE"),
                    e.SHADERDEFINE_METALLICGLOSSTEXTURE = e.shaderDefines.registerDefine("METALLICGLOSSTEXTURE"),
                    e.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = e.shaderDefines.registerDefine("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA"),
                    e.SHADERDEFINE_NORMALTEXTURE = e.shaderDefines.registerDefine("NORMALTEXTURE"),
                    e.SHADERDEFINE_PARALLAXTEXTURE = e.shaderDefines.registerDefine("PARALLAXTEXTURE"),
                    e.SHADERDEFINE_OCCLUSIONTEXTURE = e.shaderDefines.registerDefine("OCCLUSIONTEXTURE"),
                    e.SHADERDEFINE_EMISSION = e.shaderDefines.registerDefine("EMISSION"), e.SHADERDEFINE_EMISSIONTEXTURE = e.shaderDefines.registerDefine("EMISSIONTEXTURE"),
                    e.SHADERDEFINE_REFLECTMAP = e.shaderDefines.registerDefine("REFLECTMAP"), e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"),
                    e.SHADERDEFINE_ALPHAPREMULTIPLY = e.shaderDefines.registerDefine("ALPHAPREMULTIPLY");
            }, e.SmoothnessSource_MetallicGlossTexture_Alpha = 0, e.SmoothnessSource_AlbedoTexture_Alpha = 1,
                e.RENDERMODE_OPAQUE = 0, e.RENDERMODE_CUTOUT = 1, e.RENDERMODE_FADE = 2, e.RENDERMODE_TRANSPARENT = 3,
                e.SHADERDEFINE_ALBEDOTEXTURE = 0, e.SHADERDEFINE_NORMALTEXTURE = 0, e.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = 0,
                e.SHADERDEFINE_METALLICGLOSSTEXTURE = 0, e.SHADERDEFINE_OCCLUSIONTEXTURE = 0, e.SHADERDEFINE_PARALLAXTEXTURE = 0,
                e.SHADERDEFINE_EMISSION = 0, e.SHADERDEFINE_EMISSIONTEXTURE = 0, e.SHADERDEFINE_REFLECTMAP = 0,
                e.SHADERDEFINE_TILINGOFFSET = 0, e.SHADERDEFINE_ALPHAPREMULTIPLY = 0, e.SMOOTHNESSSOURCE = -1,
                e.ENABLEEMISSION = -1, e.ENABLEREFLECT = -1, n(e, ["ALBEDOTEXTURE", function () {
                    return this.ALBEDOTEXTURE = Lt.propertyNameToID("u_AlbedoTexture");
                }, "METALLICGLOSSTEXTURE", function () {
                    return this.METALLICGLOSSTEXTURE = Lt.propertyNameToID("u_MetallicGlossTexture");
                }, "NORMALTEXTURE", function () {
                    return this.NORMALTEXTURE = Lt.propertyNameToID("u_NormalTexture");
                }, "PARALLAXTEXTURE", function () {
                    return this.PARALLAXTEXTURE = Lt.propertyNameToID("u_ParallaxTexture");
                }, "OCCLUSIONTEXTURE", function () {
                    return this.OCCLUSIONTEXTURE = Lt.propertyNameToID("u_OcclusionTexture");
                }, "EMISSIONTEXTURE", function () {
                    return this.EMISSIONTEXTURE = Lt.propertyNameToID("u_EmissionTexture");
                }, "ALBEDOCOLOR", function () {
                    return this.ALBEDOCOLOR = Lt.propertyNameToID("u_AlbedoColor");
                }, "EMISSIONCOLOR", function () {
                    return this.EMISSIONCOLOR = Lt.propertyNameToID("u_EmissionColor");
                }, "METALLIC", function () {
                    return this.METALLIC = Lt.propertyNameToID("u_metallic");
                }, "SMOOTHNESS", function () {
                    return this.SMOOTHNESS = Lt.propertyNameToID("u_smoothness");
                }, "SMOOTHNESSSCALE", function () {
                    return this.SMOOTHNESSSCALE = Lt.propertyNameToID("u_smoothnessScale");
                }, "OCCLUSIONSTRENGTH", function () {
                    return this.OCCLUSIONSTRENGTH = Lt.propertyNameToID("u_occlusionStrength");
                }, "NORMALSCALE", function () {
                    return this.NORMALSCALE = Lt.propertyNameToID("u_normalScale");
                }, "PARALLAXSCALE", function () {
                    return this.PARALLAXSCALE = Lt.propertyNameToID("u_parallaxScale");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), on = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("PARTICLESHURIKEN"), this._color = new pt(1, 1, 1, 1),
                    this.renderMode = 0;
            }
            r(e, "laya.d3.core.particleShuriKen.ShurikenParticleMaterial", t);
            var i = e.prototype;
            return a(0, i, "_TintColorB", function () {
                return this._color.z;
            }, function (t) {
                this._color.z = t, this.color = this._color;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "texture", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_DIFFUSEMAP),
                    this._shaderValues.setTexture(e.DIFFUSETEXTURE, t);
            }), a(0, i, "_TintColorR", function () {
                return this._color.x;
            }, function (t) {
                this._color.x = t, this.color = this._color;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "_TintColorG", function () {
                return this._color.y;
            }, function (t) {
                this._color.y = t, this.color = this._color;
            }), a(0, i, "_TintColorA", function () {
                return this._color.w;
            }, function (t) {
                this._color.w = t, this.color = this._color;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 3e3, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770,
                            this.blendDst = 1, this.alphaTest = !1, this._defineDatas.add(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    case 0:
                        this.renderQueue = 3e3, this.depthWrite = !1, this.cull = 0, this.blend = 1, this.blendSrc = 770,
                            this.blendDst = 771, this.alphaTest = !1, this._defineDatas.remove(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    default:
                        throw new Error("ShurikenParticleMaterial : renderMode value error.");
                }
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "colorR", function () {
                return this._TintColorR;
            }, function (t) {
                this._TintColorR = t;
            }), a(0, i, "colorG", function () {
                return this._TintColorG;
            }, function (t) {
                this._TintColorG = t;
            }), a(0, i, "colorB", function () {
                return this._TintColorB;
            }, function (t) {
                this._TintColorB = t;
            }), a(0, i, "colorA", function () {
                return this._TintColorA;
            }, function (t) {
                this._TintColorA = t;
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "color", function () {
                return this._shaderValues.getVector(e.TINTCOLOR);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TINTCOLOR),
                    this._shaderValues.setVector(e.TINTCOLOR, t);
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.particleShuriKen.ShurikenParticleMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_DIFFUSEMAP = e.shaderDefines.registerDefine("DIFFUSEMAP"), e.SHADERDEFINE_TINTCOLOR = e.shaderDefines.registerDefine("TINTCOLOR"),
                    e.SHADERDEFINE_ADDTIVEFOG = e.shaderDefines.registerDefine("ADDTIVEFOG"), e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET");
            }, e.RENDERMODE_ALPHABLENDED = 0, e.RENDERMODE_ADDTIVE = 1, e.SHADERDEFINE_DIFFUSEMAP = 0,
                e.SHADERDEFINE_TINTCOLOR = 0, e.SHADERDEFINE_TILINGOFFSET = 0, e.SHADERDEFINE_ADDTIVEFOG = 0,
                n(e, ["DIFFUSETEXTURE", function () {
                    return this.DIFFUSETEXTURE = Lt.propertyNameToID("u_texture");
                }, "TINTCOLOR", function () {
                    return this.TINTCOLOR = Lt.propertyNameToID("u_Tintcolor");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), ln = function (t) {
            function e() {
                this._color = null, e.__super.call(this), this.setShaderName("Effect"), this._color = new pt(1, 1, 1, 1),
                    this._shaderValues.setVector(e.TINTCOLOR, new pt(1, 1, 1, 1)), this.renderMode = 0;
            }
            r(e, "laya.d3.core.material.EffectMaterial", t);
            var i = e.prototype;
            return a(0, i, "_TintColorB", function () {
                return this._color.z;
            }, function (t) {
                this._color.z = t, this.color = this._color;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "texture", function () {
                return this._shaderValues.getTexture(e.MAINTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.EffectMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.material.EffectMaterial.SHADERDEFINE_MAINTEXTURE),
                    this._shaderValues.setTexture(e.MAINTEXTURE, t);
            }), a(0, i, "_TintColorR", function () {
                return this._color.x;
            }, function (t) {
                this._color.x = t, this.color = this._color;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "_TintColorG", function () {
                return this._color.y;
            }, function (t) {
                this._color.y = t, this.color = this._color;
            }), a(0, i, "_TintColorA", function () {
                return this._color.w;
            }, function (t) {
                this._color.w = t, this.color = this._color;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 1, this.depthTest = 513, this._defineDatas.add(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    case 1:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 0,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513,
                            this._defineDatas.remove(e.SHADERDEFINE_ADDTIVEFOG);
                        break;

                    default:
                        throw new Error("MeshEffectMaterial : renderMode value error.");
                }
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "colorR", function () {
                return this._TintColorR;
            }, function (t) {
                this._TintColorR = t;
            }), a(0, i, "colorG", function () {
                return this._TintColorG;
            }, function (t) {
                this._TintColorG = t;
            }), a(0, i, "colorB", function () {
                return this._TintColorB;
            }, function (t) {
                this._TintColorB = t;
            }), a(0, i, "colorA", function () {
                return this._TintColorA;
            }, function (t) {
                this._TintColorA = t;
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "color", function () {
                return this._shaderValues.getVector(e.TINTCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.TINTCOLOR, t);
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.EffectMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.EffectMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_MAINTEXTURE = e.shaderDefines.registerDefine("MAINTEXTURE"), e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"),
                    e.SHADERDEFINE_ADDTIVEFOG = e.shaderDefines.registerDefine("ADDTIVEFOG");
            }, e.RENDERMODE_ADDTIVE = 0, e.RENDERMODE_ALPHABLENDED = 1, e.SHADERDEFINE_MAINTEXTURE = 0,
                e.SHADERDEFINE_TILINGOFFSET = 0, e.SHADERDEFINE_ADDTIVEFOG = 0, n(e, ["defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "MAINTEXTURE", function () {
                    return this.MAINTEXTURE = Lt.propertyNameToID("u_AlbedoTexture");
                }, "TINTCOLOR", function () {
                    return this.TINTCOLOR = Lt.propertyNameToID("u_AlbedoColor");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), hn = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("WaterPrimary"), this._shaderValues.setVector(e.HORIZONCOLOR, new pt(.172, .463, .435, 0)),
                    this._shaderValues.setNumber(e.WAVESCALE, .15), this._shaderValues.setVector(e.WAVESPEED, new pt(19, 9, -16, -7));
            }
            r(e, "laya.d3.core.material.WaterPrimaryMaterial", t);
            var i = e.prototype;
            return a(0, i, "waveSpeed", function () {
                return this._shaderValues.getVector(e.WAVESPEED);
            }, function (t) {
                this._shaderValues.setVector(e.WAVESPEED, t);
            }), a(0, i, "horizonColor", function () {
                return this._shaderValues.getVector(e.HORIZONCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.HORIZONCOLOR, t);
            }), a(0, i, "mainTexture", function () {
                return this._shaderValues.getTexture(e.MAINTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE) : this._defineDatas.remove(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_MAINTEXTURE),
                    this._shaderValues.setTexture(e.MAINTEXTURE, t);
            }), a(0, i, "normalTexture", function () {
                return this._shaderValues.getTexture(e.NORMALTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.WaterPrimaryMaterial.SHADERDEFINE_NORMALTEXTURE),
                    this._shaderValues.setTexture(e.NORMALTEXTURE, t);
            }), a(0, i, "waveScale", function () {
                return this._shaderValues.getNumber(e.WAVESCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.WAVESCALE, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_MAINTEXTURE = e.shaderDefines.registerDefine("MAINTEXTURE"), e.SHADERDEFINE_NORMALTEXTURE = e.shaderDefines.registerDefine("NORMALTEXTURE");
            }, e.SHADERDEFINE_MAINTEXTURE = 0, e.SHADERDEFINE_NORMALTEXTURE = 0, n(e, ["HORIZONCOLOR", function () {
                return this.HORIZONCOLOR = Lt.propertyNameToID("u_HorizonColor");
            }, "MAINTEXTURE", function () {
                return this.MAINTEXTURE = Lt.propertyNameToID("u_MainTexture");
            }, "NORMALTEXTURE", function () {
                return this.NORMALTEXTURE = Lt.propertyNameToID("u_NormalTexture");
            }, "WAVESCALE", function () {
                return this.WAVESCALE = Lt.propertyNameToID("u_WaveScale");
            }, "WAVESPEED", function () {
                return this.WAVESPEED = Lt.propertyNameToID("u_WaveSpeed");
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e();
            }, "shaderDefines", function () {
                return this.shaderDefines = new mt(Fi.shaderDefines);
            }]), e;
        }(Fi), un = function (t) {
            function e() {
                this._enableLighting = !0, e.__super.call(this), this.setShaderName("ExtendTerrain"),
                    this.renderMode = 1;
            }
            r(e, "laya.d3.core.material.ExtendTerrainMaterial", t);
            var i = e.prototype;
            return i._setDetailNum = function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;

                    case 2:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;

                    case 3:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;

                    case 4:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5);
                        break;

                    case 5:
                        this._defineDatas.add(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM5),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.ExtendTerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                }
            }, a(0, i, "diffuseScaleOffset2", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET2, t);
            }), a(0, i, "splatAlphaTexture", function () {
                return this._shaderValues.getTexture(e.SPLATALPHATEXTURE);
            }, function (t) {
                this._shaderValues.setTexture(e.SPLATALPHATEXTURE, t);
            }), a(0, i, "diffuseScaleOffset3", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET3, t);
            }), a(0, i, "diffuseTexture1", null, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE1, t), this._setDetailNum(1);
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;

                    case 2:
                        this.renderQueue = 2e3, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770,
                            this.blendDst = 771, this.depthTest = 515;
                        break;

                    default:
                        throw new Error("ExtendTerrainMaterial:renderMode value error.");
                }
            }), a(0, i, "diffuseTexture2", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE2);
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE2, t), this._setDetailNum(2);
            }), a(0, i, "diffuseScaleOffset1", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET1, t);
            }), a(0, i, "diffuseTexture3", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE3);
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE3, t), this._setDetailNum(3);
            }), a(0, i, "diffuseTexture4", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE4);
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE4, t), this._setDetailNum(4);
            }), a(0, i, "diffuseTexture5", function () {
                return this._shaderValues.getTexture(e.DIFFUSETEXTURE5);
            }, function (t) {
                this._shaderValues.setTexture(e.DIFFUSETEXTURE5, t), this._setDetailNum(5);
            }), a(0, i, "diffuseScaleOffset4", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET4, t);
            }), a(0, i, "diffuseScaleOffset5", null, function (t) {
                this._shaderValues.setVector(e.DIFFUSESCALEOFFSET5, t);
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "enableLighting", function () {
                return this._enableLighting;
            }, function (t) {
                this._enableLighting !== t && (t ? this._disablePublicDefineDatas.remove(Zi.SHADERDEFINE_POINTLIGHT | Zi.SHADERDEFINE_SPOTLIGHT | Zi.SHADERDEFINE_DIRECTIONLIGHT) : this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_POINTLIGHT | Zi.SHADERDEFINE_SPOTLIGHT | Zi.SHADERDEFINE_DIRECTIONLIGHT),
                    this._enableLighting = t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_DETAIL_NUM1 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM1"),
                    e.SHADERDEFINE_DETAIL_NUM2 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM2"),
                    e.SHADERDEFINE_DETAIL_NUM3 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM3"),
                    e.SHADERDEFINE_DETAIL_NUM4 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM4"),
                    e.SHADERDEFINE_DETAIL_NUM5 = e.shaderDefines.registerDefine("ExtendTerrain_DETAIL_NUM5");
            }, e.RENDERMODE_OPAQUE = 1, e.RENDERMODE_TRANSPARENT = 2, e.SHADERDEFINE_DETAIL_NUM1 = 0,
                e.SHADERDEFINE_DETAIL_NUM2 = 0, e.SHADERDEFINE_DETAIL_NUM3 = 0, e.SHADERDEFINE_DETAIL_NUM4 = 0,
                e.SHADERDEFINE_DETAIL_NUM5 = 0, n(e, ["SPLATALPHATEXTURE", function () {
                    return this.SPLATALPHATEXTURE = Lt.propertyNameToID("u_SplatAlphaTexture");
                }, "DIFFUSETEXTURE1", function () {
                    return this.DIFFUSETEXTURE1 = Lt.propertyNameToID("u_DiffuseTexture1");
                }, "DIFFUSETEXTURE2", function () {
                    return this.DIFFUSETEXTURE2 = Lt.propertyNameToID("u_DiffuseTexture2");
                }, "DIFFUSETEXTURE3", function () {
                    return this.DIFFUSETEXTURE3 = Lt.propertyNameToID("u_DiffuseTexture3");
                }, "DIFFUSETEXTURE4", function () {
                    return this.DIFFUSETEXTURE4 = Lt.propertyNameToID("u_DiffuseTexture4");
                }, "DIFFUSETEXTURE5", function () {
                    return this.DIFFUSETEXTURE5 = Lt.propertyNameToID("u_DiffuseTexture5");
                }, "DIFFUSESCALEOFFSET1", function () {
                    return this.DIFFUSESCALEOFFSET1 = Lt.propertyNameToID("u_DiffuseScaleOffset1");
                }, "DIFFUSESCALEOFFSET2", function () {
                    return this.DIFFUSESCALEOFFSET2 = Lt.propertyNameToID("u_DiffuseScaleOffset2");
                }, "DIFFUSESCALEOFFSET3", function () {
                    return this.DIFFUSESCALEOFFSET3 = Lt.propertyNameToID("u_DiffuseScaleOffset3");
                }, "DIFFUSESCALEOFFSET4", function () {
                    return this.DIFFUSESCALEOFFSET4 = Lt.propertyNameToID("u_DiffuseScaleOffset4");
                }, "DIFFUSESCALEOFFSET5", function () {
                    return this.DIFFUSESCALEOFFSET5 = Lt.propertyNameToID("u_DiffuseScaleOffset5");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), cn = function (t) {
            function e() {
                this._enableVertexColor = !1, e.__super.call(this), this.setShaderName("BLINNPHONG"),
                    this._albedoIntensity = 1, this._albedoColor = new pt(1, 1, 1, 1);
                var t = this._shaderValues;
                t.setVector(e.ALBEDOCOLOR, new pt(1, 1, 1, 1)), t.setVector(e.MATERIALSPECULAR, new pt(1, 1, 1, 1)),
                    t.setNumber(e.SHININESS, .078125), t.setNumber(Fi.ALPHATESTVALUE, .5), t.setVector(e.TILINGOFFSET, new pt(1, 1, 0, 0)),
                    this._enableLighting = !0, this.renderMode = 0;
            }
            r(e, "laya.d3.core.material.BlinnPhongMaterial", t);
            var i = e.prototype;
            return i.disableFog = function () {
                this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_FOG);
            }, i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                i._enableLighting = this._enableLighting, i._albedoIntensity = this._albedoIntensity,
                    i._enableVertexColor = this._enableVertexColor, this._albedoColor.cloneTo(i._albedoColor);
            }, a(0, i, "_SpecColorG", function () {
                return this._shaderValues.getVector(e.MATERIALSPECULAR).y;
            }, function (t) {
                this._shaderValues.getVector(e.MATERIALSPECULAR).y = t;
            }), a(0, i, "_ColorB", function () {
                return this._albedoColor.z;
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorR", function () {
                return this._albedoColor.x;
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "albedoColorA", function () {
                return this._ColorA;
            }, function (t) {
                this._ColorA = t;
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "_SpecColorB", function () {
                return this._shaderValues.getVector(e.MATERIALSPECULAR).z;
            }, function (t) {
                this._shaderValues.getVector(e.MATERIALSPECULAR).z = t;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513;
                        break;

                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513;
                        break;

                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513;
                        break;

                    default:
                        throw new Error("Material:renderMode value error.");
                }
            }), a(0, i, "_SpecColorR", function () {
                return this._shaderValues.getVector(e.MATERIALSPECULAR).x;
            }, function (t) {
                this._shaderValues.getVector(e.MATERIALSPECULAR).x = t;
            }), a(0, i, "_ColorG", function () {
                return this._albedoColor.y;
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorA", function () {
                return this._albedoColor.w;
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "specularColor", function () {
                return this._shaderValues.getVector(e.MATERIALSPECULAR);
            }, function (t) {
                this._shaderValues.setVector(e.MATERIALSPECULAR, t);
            }), a(0, i, "albedoColorB", function () {
                return this._ColorB;
            }, function (t) {
                this._ColorB = t;
            }), a(0, i, "_SpecColorA", function () {
                return this._shaderValues.getVector(e.MATERIALSPECULAR).w;
            }, function (t) {
                this._shaderValues.getVector(e.MATERIALSPECULAR).w = t;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "_AlbedoIntensity", function () {
                return this._albedoIntensity;
            }, function (t) {
                if (this._albedoIntensity !== t) {
                    var i = this._shaderValues.getVector(e.ALBEDOCOLOR);
                    pt.scale(this._albedoColor, t, i), this._albedoIntensity = t, this._shaderValues.setVector(e.ALBEDOCOLOR, i);
                }
            }), a(0, i, "specularColorA", function () {
                return this._SpecColorA;
            }, function (t) {
                this._SpecColorA = t;
            }), a(0, i, "_Shininess", function () {
                return this._shaderValues.getNumber(e.SHININESS);
            }, function (t) {
                t = Math.max(0, Math.min(1, t)), this._shaderValues.setNumber(e.SHININESS, t);
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "_Cutoff", function () {
                return this.alphaTestValue;
            }, function (t) {
                this.alphaTestValue = t;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "albedoTexture", function () {
                return this._shaderValues.getTexture(e.ALBEDOTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_DIFFUSEMAP),
                    this._shaderValues.setTexture(e.ALBEDOTEXTURE, t);
            }), a(0, i, "enableVertexColor", function () {
                return this._enableVertexColor;
            }, function (t) {
                this._enableVertexColor = t, t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_ENABLEVERTEXCOLOR);
            }), a(0, i, "albedoColor", function () {
                return this._albedoColor;
            }, function (t) {
                var i = this._shaderValues.getVector(e.ALBEDOCOLOR);
                pt.scale(t, this._albedoIntensity, i), this._albedoColor = t, this._shaderValues.setVector(e.ALBEDOCOLOR, i);
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "enableLighting", function () {
                return this._enableLighting;
            }, function (t) {
                this._enableLighting !== t && (t ? this._disablePublicDefineDatas.remove(Zi.SHADERDEFINE_POINTLIGHT | Zi.SHADERDEFINE_SPOTLIGHT | Zi.SHADERDEFINE_DIRECTIONLIGHT) : this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_POINTLIGHT | Zi.SHADERDEFINE_SPOTLIGHT | Zi.SHADERDEFINE_DIRECTIONLIGHT),
                    this._enableLighting = t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "albedoColorR", function () {
                return this._ColorR;
            }, function (t) {
                this._ColorR = t;
            }), a(0, i, "albedoColorG", function () {
                return this._ColorG;
            }, function (t) {
                this._ColorG = t;
            }), a(0, i, "albedoIntensity", function () {
                return this._albedoIntensity;
            }, function (t) {
                this._AlbedoIntensity = t;
            }), a(0, i, "specularColorR", function () {
                return this._SpecColorR;
            }, function (t) {
                this._SpecColorR = t;
            }), a(0, i, "specularColorG", function () {
                return this._SpecColorG;
            }, function (t) {
                this._SpecColorG = t;
            }), a(0, i, "specularColorB", function () {
                return this._SpecColorB;
            }, function (t) {
                this._SpecColorB = t;
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "shininess", function () {
                return this._Shininess;
            }, function (t) {
                this._Shininess = t;
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "normalTexture", function () {
                return this._shaderValues.getTexture(e.NORMALTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_NORMALMAP),
                    this._shaderValues.setTexture(e.NORMALTEXTURE, t);
            }), a(0, i, "specularTexture", function () {
                return this._shaderValues.getTexture(e.SPECULARTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP) : this._defineDatas.remove(laya.d3.core.material.BlinnPhongMaterial.SHADERDEFINE_SPECULARMAP),
                    this._shaderValues.setTexture(e.SPECULARTEXTURE, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_DIFFUSEMAP = e.shaderDefines.registerDefine("DIFFUSEMAP"), e.SHADERDEFINE_NORMALMAP = e.shaderDefines.registerDefine("NORMALMAP"),
                    e.SHADERDEFINE_SPECULARMAP = e.shaderDefines.registerDefine("SPECULARMAP"), e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"),
                    e.SHADERDEFINE_ENABLEVERTEXCOLOR = e.shaderDefines.registerDefine("ENABLEVERTEXCOLOR");
            }, e.SPECULARSOURCE_DIFFUSEMAPALPHA = 0, e.SPECULARSOURCE_SPECULARMAP = 0, e.RENDERMODE_OPAQUE = 0,
                e.RENDERMODE_CUTOUT = 1, e.RENDERMODE_TRANSPARENT = 2, e.SHADERDEFINE_DIFFUSEMAP = 0,
                e.SHADERDEFINE_NORMALMAP = 0, e.SHADERDEFINE_SPECULARMAP = 0, e.SHADERDEFINE_TILINGOFFSET = 0,
                e.SHADERDEFINE_ENABLEVERTEXCOLOR = 0, n(e, ["ALBEDOTEXTURE", function () {
                    return this.ALBEDOTEXTURE = Lt.propertyNameToID("u_DiffuseTexture");
                }, "NORMALTEXTURE", function () {
                    return this.NORMALTEXTURE = Lt.propertyNameToID("u_NormalTexture");
                }, "SPECULARTEXTURE", function () {
                    return this.SPECULARTEXTURE = Lt.propertyNameToID("u_SpecularTexture");
                }, "ALBEDOCOLOR", function () {
                    return this.ALBEDOCOLOR = Lt.propertyNameToID("u_DiffuseColor");
                }, "MATERIALSPECULAR", function () {
                    return this.MATERIALSPECULAR = Lt.propertyNameToID("u_MaterialSpecular");
                }, "SHININESS", function () {
                    return this.SHININESS = Lt.propertyNameToID("u_Shininess");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), dn = function (t) {
            function e() {
                this._diffuseScale1 = null, this._diffuseScale2 = null, this._diffuseScale3 = null,
                    this._diffuseScale4 = null, e.__super.call(this), this.setShaderName("Terrain"),
                    this.renderMode = 1, this._diffuseScale1 = new yt(), this._diffuseScale2 = new yt(),
                    this._diffuseScale3 = new yt(), this._diffuseScale4 = new yt(), this.ambientColor = new gt(.6, .6, .6),
                    this.diffuseColor = new gt(1, 1, 1), this.specularColor = new pt(.2, .2, .2, 32);
            }
            r(e, "laya.d3.core.material.TerrainMaterial", t);
            var i = e.prototype;
            return i.setDiffuseScale1 = function (t, e) {
                this._diffuseScale1.x = t, this._diffuseScale1.y = e, this._shaderValues.setVector2(6, this._diffuseScale1);
            }, i.setDiffuseScale2 = function (t, e) {
                this._diffuseScale2.x = t, this._diffuseScale2.y = e, this._shaderValues.setVector2(7, this._diffuseScale2);
            }, i.setDiffuseScale3 = function (t, e) {
                this._diffuseScale3.x = t, this._diffuseScale3.y = e, this._shaderValues.setVector2(8, this._diffuseScale3);
            }, i.setDiffuseScale4 = function (t, e) {
                this._diffuseScale4.x = t, this._diffuseScale4.y = e, this._shaderValues.setVector2(9, this._diffuseScale4);
            }, i.setDetailNum = function (t) {
                switch (t) {
                    case 1:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;

                    case 2:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;

                    case 3:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4);
                        break;

                    case 4:
                        this._defineDatas.add(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM4),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM1),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM2),
                            this._defineDatas.remove(laya.d3.core.material.TerrainMaterial.SHADERDEFINE_DETAIL_NUM3);
                }
            }, i.disableLight = function () {
                this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_POINTLIGHT | Zi.SHADERDEFINE_SPOTLIGHT | Zi.SHADERDEFINE_DIRECTIONLIGHT);
            }, i.setShaderName = function (e) {
                t.prototype.setShaderName.call(this, e);
            }, a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 1:
                        this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2, this.blend = 0, this.depthTest = 513;
                        break;

                    case 2:
                        this.renderQueue = 2e3, this.depthWrite = !1, this.cull = 2, this.blend = 1, this.blendSrc = 770,
                            this.blendDst = 771, this.depthTest = 515;
                        break;

                    default:
                        throw new Error("TerrainMaterial:renderMode value error.");
                }
            }), a(0, i, "diffuseTexture2", function () {
                return this._shaderValues.getTexture(3);
            }, function (t) {
                this._shaderValues.setTexture(3, t);
            }), a(0, i, "ambientColor", function () {
                return this._shaderValues.getVector(10);
            }, function (t) {
                this._shaderValues.setVector3(10, t);
            }), a(0, i, "diffuseTexture4", function () {
                return this._shaderValues.getTexture(5);
            }, function (t) {
                this._shaderValues.setTexture(5, t);
            }), a(0, i, "diffuseColor", function () {
                return this._shaderValues.getVector(11);
            }, function (t) {
                this._shaderValues.setVector3(11, t);
            }), a(0, i, "diffuseTexture1", function () {
                return this._shaderValues.getTexture(2);
            }, function (t) {
                this._shaderValues.setTexture(2, t);
            }), a(0, i, "specularColor", function () {
                return this._shaderValues.getVector(12);
            }, function (t) {
                this._shaderValues.setVector(12, t);
            }), a(0, i, "diffuseTexture3", function () {
                return this._shaderValues.getTexture(4);
            }, function (t) {
                this._shaderValues.setTexture(4, t);
            }), a(0, i, "splatAlphaTexture", function () {
                return this._shaderValues.getTexture(0);
            }, function (t) {
                this._shaderValues.setTexture(0, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "normalTexture", function () {
                return this._shaderValues.getTexture(1);
            }, function (t) {
                this._shaderValues.setTexture(1, t);
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_DETAIL_NUM1 = e.shaderDefines.registerDefine("DETAIL_NUM1"), e.SHADERDEFINE_DETAIL_NUM2 = e.shaderDefines.registerDefine("DETAIL_NUM2"),
                    e.SHADERDEFINE_DETAIL_NUM4 = e.shaderDefines.registerDefine("DETAIL_NUM4"), e.SHADERDEFINE_DETAIL_NUM3 = e.shaderDefines.registerDefine("DETAIL_NUM3");
            }, e.RENDERMODE_OPAQUE = 1, e.RENDERMODE_TRANSPARENT = 2, e.SPLATALPHATEXTURE = 0,
                e.NORMALTEXTURE = 1, e.DIFFUSETEXTURE1 = 2, e.DIFFUSETEXTURE2 = 3, e.DIFFUSETEXTURE3 = 4,
                e.DIFFUSETEXTURE4 = 5, e.DIFFUSESCALE1 = 6, e.DIFFUSESCALE2 = 7, e.DIFFUSESCALE3 = 8,
                e.DIFFUSESCALE4 = 9, e.MATERIALAMBIENT = 10, e.MATERIALDIFFUSE = 11, e.MATERIALSPECULAR = 12,
                e.SHADERDEFINE_DETAIL_NUM1 = 0, e.SHADERDEFINE_DETAIL_NUM2 = 0, e.SHADERDEFINE_DETAIL_NUM3 = 0,
                e.SHADERDEFINE_DETAIL_NUM4 = 0, n(e, ["CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), _n = function (t) {
            function e() {
                e.__super.call(this), this.setShaderName("SkyBox");
            }
            r(e, "laya.d3.core.material.SkyBoxMaterial", t);
            var i = e.prototype;
            return a(0, i, "tintColor", function () {
                return this._shaderValues.getVector(e.TINTCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.TINTCOLOR, t);
            }), a(0, i, "exposure", function () {
                return this._shaderValues.getNumber(e.EXPOSURE);
            }, function (t) {
                this._shaderValues.setNumber(e.EXPOSURE, t);
            }), a(0, i, "rotation", function () {
                return this._shaderValues.getNumber(e.ROTATION);
            }, function (t) {
                this._shaderValues.setNumber(e.ROTATION, t);
            }), a(0, i, "textureCube", function () {
                return this._shaderValues.getTexture(e.TEXTURECUBE);
            }, function (t) {
                this._shaderValues.setTexture(e.TEXTURECUBE, t);
            }), n(e, ["TINTCOLOR", function () {
                return this.TINTCOLOR = Lt.propertyNameToID("u_TintColor");
            }, "EXPOSURE", function () {
                return this.EXPOSURE = Lt.propertyNameToID("u_Exposure");
            }, "ROTATION", function () {
                return this.ROTATION = Lt.propertyNameToID("u_Rotation");
            }, "TEXTURECUBE", function () {
                return this.TEXTURECUBE = Lt.propertyNameToID("u_CubeTexture");
            }, "defaultMaterial", function () {
                return this.defaultMaterial = new e();
            }]), e;
        }(Fi), fn = function (t) {
            function e() {
                this._albedoColor = null, this._specularColor = null, this._emissionColor = null,
                    e.__super.call(this), this.setShaderName("PBRSpecular"), this._albedoColor = new pt(1, 1, 1, 1),
                    this._shaderValues.setVector(e.ALBEDOCOLOR, new pt(1, 1, 1, 1)), this._emissionColor = new pt(0, 0, 0, 0),
                    this._shaderValues.setVector(e.EMISSIONCOLOR, new pt(0, 0, 0, 0)), this._specularColor = new pt(.2, .2, .2, .2),
                    this._shaderValues.setVector(e.SPECULARCOLOR, new pt(.2, .2, .2, .2)), this._shaderValues.setNumber(e.SMOOTHNESS, .5),
                    this._shaderValues.setNumber(e.SMOOTHNESSSCALE, 1), this._shaderValues.setNumber(e.SMOOTHNESSSOURCE, 0),
                    this._shaderValues.setNumber(e.OCCLUSIONSTRENGTH, 1), this._shaderValues.setNumber(e.NORMALSCALE, 1),
                    this._shaderValues.setNumber(e.PARALLAXSCALE, .001), this._shaderValues.setBool(e.ENABLEEMISSION, !1),
                    this._shaderValues.setNumber(Fi.ALPHATESTVALUE, .5), this.renderMode = 0;
            }
            r(e, "laya.d3.core.material.PBRSpecularMaterial", t);
            var i = e.prototype;
            return i.cloneTo = function (e) {
                t.prototype.cloneTo.call(this, e);
                var i = e;
                this._albedoColor.cloneTo(i._albedoColor), this._specularColor.cloneTo(i._specularColor),
                    this._emissionColor.cloneTo(i._emissionColor);
            }, a(0, i, "emissionTexture", function () {
                return this._shaderValues.getTexture(e.EMISSIONTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSIONTEXTURE),
                    this._shaderValues.setTexture(e.EMISSIONTEXTURE, t);
            }), a(0, i, "_SpecColorG", function () {
                return this._specularColor.y;
            }, function (t) {
                this._specularColor.y = t, this.specularColor = this._specularColor;
            }), a(0, i, "_ColorB", function () {
                return this._albedoColor.z;
            }, function (t) {
                this._albedoColor.z = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_ColorR", function () {
                return this._albedoColor.x;
            }, function (t) {
                this._albedoColor.x = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "albedoColorA", function () {
                return this._ColorA;
            }, function (t) {
                this._ColorA = t;
            }), a(0, i, "_MainTex_STX", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).x;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.x = t, this.tilingOffset = i;
            }), a(0, i, "_SpecColorB", function () {
                return this._specularColor.z;
            }, function (t) {
                this._specularColor.z = t, this.specularColor = this._specularColor;
            }), a(0, i, "renderMode", null, function (t) {
                switch (t) {
                    case 0:
                        this.alphaTest = !1, this.renderQueue = 2e3, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513, this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 1:
                        this.renderQueue = 2450, this.alphaTest = !0, this.depthWrite = !0, this.cull = 2,
                            this.blend = 0, this.depthTest = 513, this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 2:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 770, this.blendDst = 771, this.depthTest = 513,
                            this._defineDatas.remove(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    case 3:
                        this.renderQueue = 3e3, this.alphaTest = !1, this.depthWrite = !1, this.cull = 2,
                            this.blend = 1, this.blendSrc = 1, this.blendDst = 771, this.depthTest = 513, this._defineDatas.add(e.SHADERDEFINE_ALPHAPREMULTIPLY);
                        break;

                    default:
                        throw new Error("PBRSpecularMaterial : renderMode value error.");
                }
            }), a(0, i, "_SpecColorR", function () {
                return this._specularColor.x;
            }, function (t) {
                this._specularColor.x = t, this.specularColor = this._specularColor;
            }), a(0, i, "_ColorG", function () {
                return this._albedoColor.y;
            }, function (t) {
                this._albedoColor.y = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "_Glossiness", function () {
                return this._shaderValues.getNumber(e.SMOOTHNESS);
            }, function (t) {
                this._shaderValues.setNumber(e.SMOOTHNESS, t);
            }), a(0, i, "_ColorA", function () {
                return this._albedoColor.w;
            }, function (t) {
                this._albedoColor.w = t, this.albedoColor = this._albedoColor;
            }), a(0, i, "specularColor", function () {
                return this._shaderValues.getVector(e.SPECULARCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.SPECULARCOLOR, t);
            }), a(0, i, "albedoColorB", function () {
                return this._ColorB;
            }, function (t) {
                this._ColorB = t;
            }), a(0, i, "_SpecColorA", function () {
                return this._specularColor.w;
            }, function (t) {
                this._specularColor.w = t, this.specularColor = this._specularColor;
            }), a(0, i, "_GlossMapScale", function () {
                return this._shaderValues.getNumber(e.SMOOTHNESSSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.SMOOTHNESSSCALE, t);
            }), a(0, i, "_BumpScale", function () {
                return this._shaderValues.getNumber(e.NORMALSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.NORMALSCALE, t);
            }), a(0, i, "_Parallax", function () {
                return this._shaderValues.getNumber(e.PARALLAXSCALE);
            }, function (t) {
                this._shaderValues.setNumber(e.PARALLAXSCALE, t);
            }), a(0, i, "_OcclusionStrength", function () {
                return this._shaderValues.getNumber(e.OCCLUSIONSTRENGTH);
            }, function (t) {
                this._shaderValues.setNumber(e.OCCLUSIONSTRENGTH, t);
            }), a(0, i, "_EmissionColorR", function () {
                return this._emissionColor.x;
            }, function (t) {
                this._emissionColor.x = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "tilingOffset", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET);
            }, function (t) {
                t && (1 != t.x || 1 != t.y || 0 != t.z || 0 != t.w) ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_TILINGOFFSET),
                    this._shaderValues.setVector(e.TILINGOFFSET, t);
            }), a(0, i, "_EmissionColorG", function () {
                return this._emissionColor.y;
            }, function (t) {
                this._emissionColor.y = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "blendSrc", function () {
                return this._shaderValues.getInt(e.BLEND_SRC);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_SRC, t);
            }), a(0, i, "tilingOffsetW", function () {
                return this._MainTex_STW;
            }, function (t) {
                this._MainTex_STW = t;
            }), a(0, i, "_EmissionColorB", function () {
                return this._emissionColor.z;
            }, function (t) {
                this._emissionColor.z = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "_EmissionColorA", function () {
                return this._emissionColor.w;
            }, function (t) {
                this._emissionColor.w = t, this.emissionColor = this._emissionColor;
            }), a(0, i, "_MainTex_STY", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).y;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.y = t, this.tilingOffset = i;
            }), a(0, i, "_MainTex_STZ", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).z;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.z = t, this.tilingOffset = i;
            }), a(0, i, "_Cutoff", function () {
                return this.alphaTestValue;
            }, function (t) {
                this.alphaTestValue = t;
            }), a(0, i, "_MainTex_STW", function () {
                return this._shaderValues.getVector(e.TILINGOFFSET).w;
            }, function (t) {
                var i = this._shaderValues.getVector(e.TILINGOFFSET);
                i.w = t, this.tilingOffset = i;
            }), a(0, i, "albedoColorR", function () {
                return this._ColorR;
            }, function (t) {
                this._ColorR = t;
            }), a(0, i, "albedoColorG", function () {
                return this._ColorG;
            }, function (t) {
                this._ColorG = t;
            }), a(0, i, "tilingOffsetX", function () {
                return this._MainTex_STX;
            }, function (t) {
                this._MainTex_STX = t;
            }), a(0, i, "albedoColor", function () {
                return this._albedoColor;
            }, function (t) {
                this._albedoColor = t, this._shaderValues.setVector(e.ALBEDOCOLOR, t);
            }), a(0, i, "albedoTexture", function () {
                return this._shaderValues.getTexture(e.ALBEDOTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_ALBEDOTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_ALBEDOTEXTURE),
                    this._shaderValues.setTexture(e.ALBEDOTEXTURE, t);
            }), a(0, i, "cull", function () {
                return this._shaderValues.getInt(e.CULL);
            }, function (t) {
                this._shaderValues.setInt(e.CULL, t);
            }), a(0, i, "parallaxTexture", function () {
                return this._shaderValues.getTexture(e.PARALLAXTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_PARALLAXTEXTURE),
                    this._shaderValues.setTexture(e.PARALLAXTEXTURE, t);
            }), a(0, i, "normalTexture", function () {
                return this._shaderValues.getTexture(e.NORMALTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_NORMALTEXTURE),
                    this._shaderValues.setTexture(e.NORMALTEXTURE, t);
            }), a(0, i, "emissionColor", function () {
                return this._shaderValues.getVector(e.EMISSIONCOLOR);
            }, function (t) {
                this._shaderValues.setVector(e.EMISSIONCOLOR, t);
            }), a(0, i, "parallaxTextureScale", function () {
                return this._Parallax;
            }, function (t) {
                this._Parallax = Math.max(.005, Math.min(.08, t));
            }), a(0, i, "normalTextureScale", function () {
                return this._BumpScale;
            }, function (t) {
                this._BumpScale = t;
            }), a(0, i, "tilingOffsetZ", function () {
                return this._MainTex_STZ;
            }, function (t) {
                this._MainTex_STZ = t;
            }), a(0, i, "occlusionTexture", function () {
                return this._shaderValues.getTexture(e.OCCLUSIONTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_OCCLUSIONTEXTURE),
                    this._shaderValues.setTexture(e.OCCLUSIONTEXTURE, t);
            }), a(0, i, "occlusionTextureStrength", function () {
                return this._OcclusionStrength;
            }, function (t) {
                this._OcclusionStrength = Math.max(0, Math.min(1, t));
            }), a(0, i, "specularTexture", function () {
                return this._shaderValues.getTexture(e.SPECULARTEXTURE);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SPECULARTEXTURE),
                    this._shaderValues.setTexture(e.SPECULARTEXTURE, t);
            }), a(0, i, "specularColorR", function () {
                return this._SpecColorR;
            }, function (t) {
                this._SpecColorR = t;
            }), a(0, i, "smoothness", function () {
                return this._Glossiness;
            }, function (t) {
                this._Glossiness = Math.max(0, Math.min(1, t));
            }), a(0, i, "specularColorG", function () {
                return this._SpecColorG;
            }, function (t) {
                this._SpecColorG = t;
            }), a(0, i, "specularColorB", function () {
                return this._SpecColorB;
            }, function (t) {
                this._SpecColorB = t;
            }), a(0, i, "specularColorA", function () {
                return this._SpecColorA;
            }, function (t) {
                this._SpecColorA = t;
            }), a(0, i, "blendDst", function () {
                return this._shaderValues.getInt(e.BLEND_DST);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND_DST, t);
            }), a(0, i, "smoothnessTextureScale", function () {
                return this._GlossMapScale;
            }, function (t) {
                this._GlossMapScale = Math.max(0, Math.min(1, t));
            }), a(0, i, "depthWrite", function () {
                return this._shaderValues.getBool(e.DEPTH_WRITE);
            }, function (t) {
                this._shaderValues.setBool(e.DEPTH_WRITE, t);
            }), a(0, i, "smoothnessSource", function () {
                return this._shaderValues.getInt(e.SMOOTHNESSSOURCE);
            }, function (t) {
                t ? (this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA),
                    this._shaderValues.setInt(e.SMOOTHNESSSOURCE, 1)) : (this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA),
                        this._shaderValues.setInt(e.SMOOTHNESSSOURCE, 0));
            }), a(0, i, "enableEmission", function () {
                return this._shaderValues.getBool(e.ENABLEEMISSION);
            }, function (t) {
                t ? this._defineDatas.add(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION) : this._defineDatas.remove(laya.d3.core.material.PBRSpecularMaterial.SHADERDEFINE_EMISSION),
                    this._shaderValues.setBool(e.ENABLEEMISSION, t);
            }), a(0, i, "enableReflection", function () {
                return this._shaderValues.getBool(e.ENABLEREFLECT);
            }, function (t) {
                this._shaderValues.setBool(e.ENABLEREFLECT, !0), t ? this._disablePublicDefineDatas.remove(Zi.SHADERDEFINE_REFLECTMAP) : this._disablePublicDefineDatas.add(Zi.SHADERDEFINE_REFLECTMAP);
            }), a(0, i, "tilingOffsetY", function () {
                return this._MainTex_STY;
            }, function (t) {
                this._MainTex_STY = t;
            }), a(0, i, "blend", function () {
                return this._shaderValues.getInt(e.BLEND);
            }, function (t) {
                this._shaderValues.setInt(e.BLEND, t);
            }), a(0, i, "depthTest", function () {
                return this._shaderValues.getInt(e.DEPTH_TEST);
            }, function (t) {
                this._shaderValues.setInt(e.DEPTH_TEST, t);
            }), e.__init__ = function () {
                e.SHADERDEFINE_ALBEDOTEXTURE = e.shaderDefines.registerDefine("ALBEDOTEXTURE"),
                    e.SHADERDEFINE_SPECULARTEXTURE = e.shaderDefines.registerDefine("SPECULARTEXTURE"),
                    e.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = e.shaderDefines.registerDefine("SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA"),
                    e.SHADERDEFINE_NORMALTEXTURE = e.shaderDefines.registerDefine("NORMALTEXTURE"),
                    e.SHADERDEFINE_PARALLAXTEXTURE = e.shaderDefines.registerDefine("PARALLAXTEXTURE"),
                    e.SHADERDEFINE_OCCLUSIONTEXTURE = e.shaderDefines.registerDefine("OCCLUSIONTEXTURE"),
                    e.SHADERDEFINE_EMISSION = e.shaderDefines.registerDefine("EMISSION"), e.SHADERDEFINE_EMISSIONTEXTURE = e.shaderDefines.registerDefine("EMISSIONTEXTURE"),
                    e.SHADERDEFINE_TILINGOFFSET = e.shaderDefines.registerDefine("TILINGOFFSET"), e.SHADERDEFINE_ALPHAPREMULTIPLY = e.shaderDefines.registerDefine("ALPHAPREMULTIPLY");
            }, e.SmoothnessSource_SpecularTexture_Alpha = 0, e.SmoothnessSource_AlbedoTexture_Alpha = 1,
                e.RENDERMODE_OPAQUE = 0, e.RENDERMODE_CUTOUT = 1, e.RENDERMODE_FADE = 2, e.RENDERMODE_TRANSPARENT = 3,
                e.SHADERDEFINE_ALBEDOTEXTURE = 0, e.SHADERDEFINE_NORMALTEXTURE = 0, e.SHADERDEFINE_SMOOTHNESSSOURCE_ALBEDOTEXTURE_ALPHA = 0,
                e.SHADERDEFINE_SPECULARTEXTURE = 0, e.SHADERDEFINE_OCCLUSIONTEXTURE = 0, e.SHADERDEFINE_PARALLAXTEXTURE = 0,
                e.SHADERDEFINE_EMISSION = 0, e.SHADERDEFINE_EMISSIONTEXTURE = 0, e.SHADERDEFINE_TILINGOFFSET = 0,
                e.SHADERDEFINE_ALPHAPREMULTIPLY = 0, e.SMOOTHNESSSOURCE = -1, e.ENABLEEMISSION = -1,
                e.ENABLEREFLECT = -1, n(e, ["ALBEDOTEXTURE", function () {
                    return this.ALBEDOTEXTURE = Lt.propertyNameToID("u_AlbedoTexture");
                }, "SPECULARTEXTURE", function () {
                    return this.SPECULARTEXTURE = Lt.propertyNameToID("u_SpecularTexture");
                }, "NORMALTEXTURE", function () {
                    return this.NORMALTEXTURE = Lt.propertyNameToID("u_NormalTexture");
                }, "PARALLAXTEXTURE", function () {
                    return this.PARALLAXTEXTURE = Lt.propertyNameToID("u_ParallaxTexture");
                }, "OCCLUSIONTEXTURE", function () {
                    return this.OCCLUSIONTEXTURE = Lt.propertyNameToID("u_OcclusionTexture");
                }, "EMISSIONTEXTURE", function () {
                    return this.EMISSIONTEXTURE = Lt.propertyNameToID("u_EmissionTexture");
                }, "ALBEDOCOLOR", function () {
                    return this.ALBEDOCOLOR = Lt.propertyNameToID("u_AlbedoColor");
                }, "SPECULARCOLOR", function () {
                    return this.SPECULARCOLOR = Lt.propertyNameToID("u_SpecularColor");
                }, "EMISSIONCOLOR", function () {
                    return this.EMISSIONCOLOR = Lt.propertyNameToID("u_EmissionColor");
                }, "SMOOTHNESS", function () {
                    return this.SMOOTHNESS = Lt.propertyNameToID("u_smoothness");
                }, "SMOOTHNESSSCALE", function () {
                    return this.SMOOTHNESSSCALE = Lt.propertyNameToID("u_smoothnessScale");
                }, "OCCLUSIONSTRENGTH", function () {
                    return this.OCCLUSIONSTRENGTH = Lt.propertyNameToID("u_occlusionStrength");
                }, "NORMALSCALE", function () {
                    return this.NORMALSCALE = Lt.propertyNameToID("u_normalScale");
                }, "PARALLAXSCALE", function () {
                    return this.PARALLAXSCALE = Lt.propertyNameToID("u_parallaxScale");
                }, "TILINGOFFSET", function () {
                    return this.TILINGOFFSET = Lt.propertyNameToID("u_TilingOffset");
                }, "CULL", function () {
                    return this.CULL = Lt.propertyNameToID("s_Cull");
                }, "BLEND", function () {
                    return this.BLEND = Lt.propertyNameToID("s_Blend");
                }, "BLEND_SRC", function () {
                    return this.BLEND_SRC = Lt.propertyNameToID("s_BlendSrc");
                }, "BLEND_DST", function () {
                    return this.BLEND_DST = Lt.propertyNameToID("s_BlendDst");
                }, "DEPTH_TEST", function () {
                    return this.DEPTH_TEST = Lt.propertyNameToID("s_DepthTest");
                }, "DEPTH_WRITE", function () {
                    return this.DEPTH_WRITE = Lt.propertyNameToID("s_DepthWrite");
                }, "defaultMaterial", function () {
                    return this.defaultMaterial = new e();
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Fi.shaderDefines);
                }]), e;
        }(Fi), pn = (function (e) {
            function i(t, e) {
                this._isKinematic = !1, this._mass = 1, this._angularDamping = 0, this._linearDamping = 0,
                    this._overrideGravity = !1, this._detectCollisions = !0, this._gravity = new gt(0, -10, 0),
                    this._totalTorque = new gt(0, 0, 0), this._linearVelocity = new gt(), this._angularVelocity = new gt(),
                    this._linearFactor = new gt(1, 1, 1), this._angularFactor = new gt(1, 1, 1), void 0 === t && (t = 1),
                    void 0 === e && (e = Ve.COLLISIONFILTERGROUP_ALLFILTER), i.__super.call(this, t, e);
            }
            r(i, "laya.d3.physics.Rigidbody3D", e);
            var s = i.prototype;
            s._updateMass = function (t) {
                this._nativeColliderObject && this._colliderShape && (this._colliderShape._nativeShape.calculateLocalInertia(t, i._nativeInertia),
                    this._nativeColliderObject.setMassProps(t, i._nativeInertia), this._nativeColliderObject.updateInertiaTensor());
            }, s._delegateMotionStateGetWorldTransform = function (t) { }, s._delegateMotionStateSetWorldTransform = function (t) {
                var e = this._rigidbody;
                e._simulation._updatedRigidbodies++;
                var i = W._physics3D, n = i.wrapPointer(t, i.btTransform);
                e._updateTransformComponent(n);
            }, s._delegateMotionStateGetWorldTransformNative = function (t, e) { }, s._delegateMotionStateSetWorldTransformNative = function (t, e) {
                var i = t;
                i._simulation._updatedRigidbodies++;
                var n = W._physics3D, r = n.wrapPointer(e, n.btTransform);
                i._updateTransformComponent(r);
            }, s._onScaleChange = function (t) {
                laya.d3.physics.PhysicsComponent.prototype._onScaleChange.call(this, t), this._updateMass(this._isKinematic ? 0 : this._mass);
            }, s._delegateMotionStateClear = function () {
                this._rigidbody = null;
            }, s._onAdded = function () {
                var n = W._physics3D, r = new n.LayaMotionState();
                null != t.conch && n.LayaMotionState.prototype.setRigidbody ? (r.setRigidbody(this),
                    r.setNativeGetWorldTransform(this._delegateMotionStateGetWorldTransformNative),
                    r.setNativeSetWorldTransform(this._delegateMotionStateSetWorldTransformNative)) : (r.getWorldTransform = this._delegateMotionStateGetWorldTransform,
                        r.setWorldTransform = this._delegateMotionStateSetWorldTransform), r.clear = this._delegateMotionStateClear,
                    r._rigidbody = this, this._nativeMotionState = r;
                var a = new n.btRigidBodyConstructionInfo(0, r, null, i._nativeVector3Zero), s = new n.btRigidBody(a);
                s.setUserIndex(this.id), this._nativeColliderObject = s, e.prototype._onAdded.call(this),
                    this.mass = this._mass, this.linearFactor = this._linearFactor, this.angularFactor = this._angularFactor,
                    this.linearDamping = this._linearDamping, this.angularDamping = this._angularDamping,
                    this.overrideGravity = this._overrideGravity, this.gravity = this._gravity, this.isKinematic = this._isKinematic,
                    n.destroy(a);
            }, s._onShapeChange = function (t) {
                laya.d3.physics.PhysicsComponent.prototype._onShapeChange.call(this, t), this._isKinematic ? this._updateMass(0) : (this._nativeColliderObject.setCenterOfMassTransform(this._nativeColliderObject.getWorldTransform()),
                    this._updateMass(this._mass));
            }, s._parse = function (t) {
                null != t.friction && (this.friction = t.friction), null != t.rollingFriction && (this.rollingFriction = t.rollingFriction),
                    null != t.restitution && (this.restitution = t.restitution), null != t.isTrigger && (this.isTrigger = t.isTrigger),
                    null != t.mass && (this.mass = t.mass), null != t.isKinematic && (this.isKinematic = t.isKinematic),
                    null != t.linearDamping && (this.linearDamping = t.linearDamping), null != t.angularDamping && (this.angularDamping = t.angularDamping),
                    null != t.overrideGravity && (this.overrideGravity = t.overrideGravity), t.gravity && (this.gravity.fromArray(t.gravity),
                        this.gravity = this.gravity), laya.d3.physics.PhysicsComponent.prototype._parse.call(this, t),
                    this._parseShape(t.shapes);
            }, s._onDestroy = function () {
                var t = W._physics3D;
                this._nativeMotionState.clear(), t.destroy(this._nativeMotionState), laya.d3.physics.PhysicsComponent.prototype._onDestroy.call(this),
                    this._nativeMotionState = null, this._gravity = null, this._totalTorque = null,
                    this._linearVelocity = null, this._angularVelocity = null, this._linearFactor = null,
                    this._angularFactor = null;
            }, s._addToSimulation = function () {
                this._simulation._addRigidBody(this, this._collisionGroup, this._detectCollisions ? this._canCollideWith : 0);
            }, s._removeFromSimulation = function () {
                this._simulation._removeRigidBody(this);
            }, s._cloneTo = function (t) {
                e.prototype._cloneTo.call(this, t);
                var i = t;
                i.isKinematic = this._isKinematic, i.mass = this._mass, i.gravity = this._gravity,
                    i.angularDamping = this._angularDamping, i.linearDamping = this._linearDamping,
                    i.overrideGravity = this._overrideGravity, i.linearVelocity = this._linearVelocity,
                    i.angularVelocity = this._angularVelocity, i.linearFactor = this._linearFactor,
                    i.angularFactor = this._angularFactor, i.detectCollisions = this._detectCollisions;
            }, s.applyForce = function (t, e) {
                if (null == this._nativeColliderObject) throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var n = i._nativeTempVector30;
                if (n.setValue(-t.x, t.y, t.z), e) {
                    var r = i._nativeTempVector31;
                    r.setValue(-e.x, e.y, e.z), this._nativeColliderObject.applyForce(n, r);
                } else this._nativeColliderObject.applyCentralForce(n);
            }, s.applyTorque = function (t) {
                if (null == this._nativeColliderObject) throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var e = i._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeColliderObject.applyTorque(e);
            }, s.applyImpulse = function (t, e) {
                if (null == this._nativeColliderObject) throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                i._nativeImpulse.setValue(-t.x, t.y, t.z), e ? (i._nativeImpulseOffset.setValue(-e.x, e.y, e.z),
                    this._nativeColliderObject.applyImpulse(i._nativeImpulse, i._nativeImpulseOffset)) : this._nativeColliderObject.applyCentralImpulse(i._nativeImpulse);
            }, s.applyTorqueImpulse = function (t) {
                if (null == this._nativeColliderObject) throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                var e = i._nativeTempVector30;
                e.setValue(-t.x, t.y, t.z), this._nativeColliderObject.applyTorqueImpulse(e);
            }, s.wakeUp = function () {
                this._nativeColliderObject && this._nativeColliderObject.activate(!1);
            }, s.clearForces = function () {
                var t = this._nativeColliderObject;
                if (null == t) throw "Attempted to call a Physics function that is avaliable only when the Entity has been already added to the Scene.";
                t.clearForces();
                var e = i._nativeVector3Zero;
                t.setInterpolationAngularVelocity(e), t.setLinearVelocity(e), t.setInterpolationAngularVelocity(e),
                    t.setAngularVelocity(e);
            }, a(0, s, "angularDamping", function () {
                return this._angularDamping;
            }, function (t) {
                this._angularDamping = t, this._nativeColliderObject && this._nativeColliderObject.setDamping(this._linearDamping, t);
            }), a(0, s, "mass", function () {
                return this._mass;
            }, function (t) {
                t = Math.max(t, 1e-7), this._mass = t, this._isKinematic || this._updateMass(t);
            }), a(0, s, "linearDamping", function () {
                return this._linearDamping;
            }, function (t) {
                this._linearDamping = t, this._nativeColliderObject && this._nativeColliderObject.setDamping(t, this._angularDamping);
            }), a(0, s, "isKinematic", function () {
                return this._isKinematic;
            }, function (t) {
                this._isKinematic = t;
                var e = !!(this._simulation && this._enabled && this._colliderShape);
                e && this._removeFromSimulation();
                var n = this._nativeColliderObject, r = n.getCollisionFlags();
                t ? (r |= 2, n.setCollisionFlags(r), this._nativeColliderObject.forceActivationState(4),
                    this._enableProcessCollisions = !1, this._updateMass(0)) : ((2 & r) > 0 && (r ^= 2),
                        n.setCollisionFlags(r), this._nativeColliderObject.setActivationState(1), this._enableProcessCollisions = !0,
                        this._updateMass(this._mass));
                var a = i._nativeVector3Zero;
                n.setInterpolationLinearVelocity(a), n.setLinearVelocity(a), n.setInterpolationAngularVelocity(a),
                    n.setAngularVelocity(a), e && this._addToSimulation();
            }), a(0, s, "gravity", function () {
                return this._gravity;
            }, function (t) {
                this._gravity = t, i._nativeGravity.setValue(-t.x, t.y, t.z), this._nativeColliderObject.setGravity(i._nativeGravity);
            }), a(0, s, "overrideGravity", function () {
                return this._overrideGravity;
            }, function (t) {
                if (this._overrideGravity = t, this._nativeColliderObject) {
                    var e = this._nativeColliderObject.getFlags();
                    t ? 0 == (1 & e) && this._nativeColliderObject.setFlags(1 | e) : (1 & e) > 0 && this._nativeColliderObject.setFlags(1 ^ e);
                }
            }), a(0, s, "totalForce", function () {
                return this._nativeColliderObject ? this._nativeColliderObject.getTotalForce() : null;
            }), a(0, s, "linearVelocity", function () {
                return this._nativeColliderObject && Ht._convertToLayaVec3(this._nativeColliderObject.getLinearVelocity(), this._linearVelocity, !0),
                    this._linearVelocity;
            }, function (t) {
                if (this._linearVelocity = t, this._nativeColliderObject) {
                    var e = i._nativeTempVector30;
                    Ht._convertToBulletVec3(t, e, !0), this.isSleeping && this.wakeUp(), this._nativeColliderObject.setLinearVelocity(e);
                }
            }), a(0, s, "detectCollisions", function () {
                return this._detectCollisions;
            }, function (t) {
                this._detectCollisions !== t && (this._detectCollisions = t, this._colliderShape && this._enabled && this._simulation && (this._simulation._removeRigidBody(this),
                    this._simulation._addRigidBody(this, this._collisionGroup, t ? this._canCollideWith : 0)));
            }), a(0, s, "linearFactor", function () {
                return this._nativeColliderObject ? this._linearFactor : null;
            }, function (t) {
                if (this._linearFactor = t, this._nativeColliderObject) {
                    var e = i._nativeTempVector30;
                    Ht._convertToBulletVec3(t, e, !1), this._nativeColliderObject.setLinearFactor(e);
                }
            }), a(0, s, "angularFactor", function () {
                return this._nativeColliderObject ? this._angularFactor : null;
            }, function (t) {
                if (this._angularFactor = t, this._nativeColliderObject) {
                    var e = i._nativeTempVector30;
                    Ht._convertToBulletVec3(t, e, !1), this._nativeColliderObject.setAngularFactor(e);
                }
            }), a(0, s, "angularVelocity", function () {
                return this._nativeColliderObject && Ht._convertToLayaVec3(this._nativeColliderObject.getAngularVelocity(), this._angularVelocity, !0),
                    this._angularVelocity;
            }, function (t) {
                if (this._angularVelocity = t, this._nativeColliderObject) {
                    var e = i._nativeTempVector30;
                    Ht._convertToBulletVec3(t, e, !0), this.isSleeping && this.wakeUp(), this._nativeColliderObject.setAngularVelocity(e);
                }
            }), a(0, s, "totalTorque", function () {
                if (this._nativeColliderObject) {
                    var t = this._nativeColliderObject.getTotalTorque(), e = this._totalTorque;
                    e.x = -t.x, e.y = t.y, e.z = t.z;
                }
                return null;
            }), a(0, s, "isSleeping", function () {
                return !!this._nativeColliderObject && 2 === this._nativeColliderObject.getActivationState();
            }), a(0, s, "sleepLinearVelocity", function () {
                return this._nativeColliderObject.getLinearSleepingThreshold();
            }, function (t) {
                this._nativeColliderObject.setSleepingThresholds(t, this._nativeColliderObject.getAngularSleepingThreshold());
            }), a(0, s, "sleepAngularVelocity", function () {
                return this._nativeColliderObject.getAngularSleepingThreshold();
            }, function (t) {
                this._nativeColliderObject.setSleepingThresholds(this._nativeColliderObject.getLinearSleepingThreshold(), t);
            }), i.TYPE_STATIC = 0, i.TYPE_DYNAMIC = 1, i.TYPE_KINEMATIC = 2, i._BT_DISABLE_WORLD_GRAVITY = 1,
                i._BT_ENABLE_GYROPSCOPIC_FORCE = 2, n(i, ["_nativeTempVector30", function () {
                    return this._nativeTempVector30 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeTempVector31", function () {
                    return this._nativeTempVector31 = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeVector3Zero", function () {
                    return this._nativeVector3Zero = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeInertia", function () {
                    return this._nativeInertia = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeImpulse", function () {
                    return this._nativeImpulse = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeImpulseOffset", function () {
                    return this._nativeImpulseOffset = new W._physics3D.btVector3(0, 0, 0);
                }, "_nativeGravity", function () {
                    return this._nativeGravity = new W._physics3D.btVector3(0, 0, 0);
                }]);
        }(Wi), function (t) {
            function e(t, i) {
                void 0 === t && (t = 1), void 0 === i && (i = Ve.COLLISIONFILTERGROUP_ALLFILTER),
                    e.__super.call(this, t, i);
            }
            r(e, "laya.d3.physics.PhysicsCollider", t);
            var i = e.prototype;
            i._addToSimulation = function () {
                this._simulation._addPhysicsCollider(this, this._collisionGroup, this._canCollideWith);
            }, i._removeFromSimulation = function () {
                this._simulation._removePhysicsCollider(this);
            }, i._onTransformChanged = function (t) {
                (t &= 56) && (this._transformFlag |= t, this._isValid() && -1 === this._inPhysicUpdateListIndex && this._simulation._physicsUpdateList.add(this));
            }, i._parse = function (t) {
                null != t.friction && (this.friction = t.friction), null != t.rollingFriction && (this.rollingFriction = t.rollingFriction),
                    null != t.restitution && (this.restitution = t.restitution), null != t.isTrigger && (this.isTrigger = t.isTrigger),
                    laya.d3.physics.PhysicsComponent.prototype._parse.call(this, t), this._parseShape(t.shapes);
            }, i._onAdded = function () {
                var e = new W._physics3D.btCollisionObject();
                e.setUserIndex(this.id), e.forceActivationState(5);
                var i = e.getCollisionFlags();
                this.owner.isStatic ? ((2 & i) > 0 && (i ^= 2), i |= 1) : ((1 & i) > 0 && (i ^= 1),
                    i |= 2), e.setCollisionFlags(i), this._nativeColliderObject = e, t.prototype._onAdded.call(this);
            };
        }(Wi), function (t) {
            function e(t) {
                this._bones = [], this._skinnedDataLoopMarks = [], this._localBounds = new Ce(gt._ZERO, gt._ZERO),
                    this._cacheAnimationNode = [], e.__super.call(this, t);
            }
            r(e, "laya.d3.core.SkinnedMeshRenderer", t);
            var i = e.prototype;
            return i._computeSkinnedData = function () {
                if (this._cacheMesh && this._cacheAvatar || this._cacheMesh && this._cacheRootBone) for (var t = this._cacheMesh._inverseBindPoses, e = this._cacheMesh._bindPoseIndices, i = this._cacheMesh._skinDataPathMarks, n = 0, r = this._cacheMesh.subMeshCount; n < r; n++) for (var a = this._cacheMesh._getSubMesh(n)._boneIndicesList, s = this._skinnedData[n], o = 0, l = a.length; o < l; o++) {
                    var h = a[o];
                    I.supportWebGLPlusAnimation ? this._computeSubSkinnedDataNative(this._cacheAnimator._animationNodeWorldMatrixs, this._cacheAnimationNodeIndices, this._cacheMesh._inverseBindPosesBuffer, h, e, s[o]) : this._computeSubSkinnedData(t, h, e, s[o], i);
                }
            }, i._computeSubSkinnedData = function (t, e, i, n, r) {
                for (var a = 0, s = e.length; a < s; a++) {
                    var o = e[a];
                    if (this._skinnedDataLoopMarks[o] === O.loopCount) for (var l = r[o], h = this._skinnedData[l[0]][l[1]], u = 16 * l[2], c = 16 * a, d = 0; d < 16; d++) n[c + d] = h[u + d]; else {
                        if (this._cacheRootBone) {
                            var _ = i[o];
                            Ht._mulMatrixArray(this._bones[_].transform.worldMatrix.elements, t[_], n, 16 * a);
                        } else Ht._mulMatrixArray(this._cacheAnimationNode[o].transform.getWorldMatrix(), t[i[o]], n, 16 * a);
                        this._skinnedDataLoopMarks[o] = O.loopCount;
                    }
                }
            }, i._boundChange = function () {
                this._boundsChange = !0;
            }, i._onMeshChange = function (e) {
                t.prototype._onMeshChange.call(this, e), this._cacheMesh = e;
                var i = e.subMeshCount;
                this._skinnedData = s(i), this._skinnedDataLoopMarks.length = e._bindPoseIndices.length;
                for (var n = 0; n < i; n++) for (var r = e._getSubMesh(n)._boneIndicesList, a = r.length, o = this._skinnedData[n] = s(a), l = 0; l < a; l++) o[l] = new Float32Array(16 * r[l].length);
                this._bones || this._cacheAvatar && e && this._getCacheAnimationNodes();
            }, i._setCacheAnimator = function (t) {
                this._cacheAnimator = t, this._defineDatas.add(xn.SHADERDEFINE_BONE), this._setRootNode();
            }, i._calculateBoundingBox = function () {
                if (this._cacheRootBone) this._localBounds._tranform(this._cacheRootBone.transform.worldMatrix, this._bounds); else if (this._cacheAnimator && this._rootBone) {
                    var i = e._tempMatrix4x4;
                    Ht.matrix4x4MultiplyMFM(this._cacheAnimator.owner.transform.worldMatrix, this._cacheRootAnimationNode.transform.getWorldMatrix(), i),
                        this._localBounds._tranform(i, this._bounds);
                } else t.prototype._calculateBoundingBox.call(this);
                if (I.supportWebGLPlusCulling) {
                    var n = this._bounds.getMin(), r = this._bounds.getMax(), a = Ne._cullingBuffer;
                    a[this._cullingBufferIndex + 1] = n.x, a[this._cullingBufferIndex + 2] = n.y, a[this._cullingBufferIndex + 3] = n.z,
                        a[this._cullingBufferIndex + 4] = r.x, a[this._cullingBufferIndex + 5] = r.y, a[this._cullingBufferIndex + 6] = r.z;
                }
            }, i._changeRenderObjectsByMesh = function (t) {
                var e = t.subMeshCount;
                this._renderElements.length = e;
                for (var i = 0; i < e; i++) {
                    var n = this._renderElements[i];
                    if (!n) {
                        var r = this.sharedMaterials[i];
                        (n = this._renderElements[i] = new At()).setTransform(this._owner._transform), n.render = this,
                            n.material = r || cn.defaultMaterial;
                    }
                    n.setGeometry(t._getSubMesh(i));
                }
            }, i._renderUpdate = function (t, e) {
                if (this._cacheAnimator) if (this._computeSkinnedData(), this._cacheRootBone) this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, ze.DEFAULT); else {
                    var i = this._cacheAnimator.owner._transform;
                    this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, i.worldMatrix);
                } else this._shaderValues.setMatrix4x4(Bi.WORLDMATRIX, e.worldMatrix);
            }, i._renderUpdateWithCamera = function (t, e) {
                var i = t.projectionViewMatrix;
                if (this._cacheRootBone) this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, i); else {
                    if (this._cacheAnimator) {
                        var n = this._cacheAnimator.owner._transform;
                        ze.multiply(i, n.worldMatrix, this._projectionViewWorldMatrix);
                    } else ze.multiply(i, e.worldMatrix, this._projectionViewWorldMatrix);
                    this._shaderValues.setMatrix4x4(Bi.MVPMATRIX, this._projectionViewWorldMatrix);
                }
            }, i._destroy = function () {
                t.prototype._destroy.call(this), this._cacheRootBone ? this._cacheRootBone.transform.off("transformchanged", this, this._boundChange) : this._cacheRootAnimationNode && this._cacheRootAnimationNode.transform.off("transformchanged", this, this._boundChange);
            }, i._setRootBone = function (t) {
                this._rootBone = t, this._setRootNode();
            }, i._setRootNode = function () {
                var t;
                t = this._cacheAnimator && this._rootBone && this._cacheAvatar ? this._cacheAnimator._avatarNodeMap[this._rootBone] : null,
                    this._cacheRootAnimationNode != t && (this._boundChange(), this._cacheRootAnimationNode && this._cacheRootAnimationNode.transform.off("transformchanged", this, this._boundChange),
                        t && t.transform.on("transformchanged", this, this._boundChange), this._cacheRootAnimationNode = t);
            }, i._getCacheAnimationNodes = function () {
                var t = this._cacheMesh._boneNames, e = this._cacheMesh._bindPoseIndices, i = e.length;
                if (I.supportWebGLPlusAnimation) {
                    this._cacheAnimationNodeIndices = new Uint16Array(i);
                    var n = this._cacheAnimator._avatarNodeMap;
                    for (s = 0; s < i; s++) {
                        var r = n[t[e[s]]];
                        this._cacheAnimationNodeIndices[s] = r._worldMatrixIndex;
                    }
                } else {
                    this._cacheAnimationNode.length = i;
                    for (var a = this._cacheAnimator._avatarNodeMap, s = 0; s < i; s++) {
                        var o = a[t[e[s]]];
                        this._cacheAnimationNode[s] = o;
                    }
                }
            }, i._setCacheAvatar = function (t) {
                this._cacheAvatar !== t && (this._cacheMesh ? (this._cacheAvatar = t, t && (this._defineDatas.add(xn.SHADERDEFINE_BONE),
                    this._getCacheAnimationNodes())) : this._cacheAvatar = t, this._setRootNode());
            }, i._computeSubSkinnedDataNative = function (t, e, i, n, r, a) {
                v.instance.computeSubSkinnedData(t, e, i, n, r, a);
            }, a(0, i, "localBounds", function () {
                return this._localBounds;
            }, function (t) {
                this._localBounds = t;
            }), a(0, i, "rootBone", function () {
                return this._cacheRootBone;
            }, function (t) {
                this._cacheRootBone != t && (this._cacheRootBone && this._cacheRootBone.transform.off("transformchanged", this, this._boundChange),
                    t.transform.on("transformchanged", this, this._boundChange), this._cacheRootBone = t,
                    this._boundChange());
            }), a(0, i, "bones", function () {
                return this._bones;
            }), n(e, ["_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new ze();
            }]), e;
        }(Yi)), mn = function (t) {
            function e(t, i, n, r) {
                void 0 === n && (n = 0), void 0 === r && (r = 0), e.__super.call(this, n, !1), this._glTextureType = 3553,
                    this._width = t, this._height = i, this._depthStencilFormat = r, this._create(t, i);
            }
            r(e, "laya.d3.resource.RenderTexture", t);
            var i = e.prototype;
            return i._create = function (t, e) {
                var i = v.instance;
                this._frameBuffer = i.createFramebuffer(), k.bindTexture(i, this._glTextureType, this._glTexture);
                var n = this._getGLFormat();
                if (i.texImage2D(this._glTextureType, 0, n, t, e, 0, n, 5121, null), this._setGPUMemory(t * e * 4),
                    i.bindFramebuffer(36160, this._frameBuffer), i.framebufferTexture2D(36160, 36064, 3553, this._glTexture, 0),
                    3 !== this._depthStencilFormat) switch (this._depthStencilBuffer = i.createRenderbuffer(),
                    i.bindRenderbuffer(36161, this._depthStencilBuffer), this._depthStencilFormat) {
                        case 0:
                            i.renderbufferStorage(36161, 33189, t, e), i.framebufferRenderbuffer(36160, 36096, 36161, this._depthStencilBuffer);
                            break;

                        case 1:
                            i.renderbufferStorage(36161, 36168, t, e), i.framebufferRenderbuffer(36160, 36128, 36161, this._depthStencilBuffer);
                            break;

                        case 2:
                            i.renderbufferStorage(36161, 34041, t, e), i.framebufferRenderbuffer(36160, 33306, 36161, this._depthStencilBuffer);
                            break;

                        default:
                            throw "RenderTexture: unkonw depth format.";
                    }
                i.bindFramebuffer(36160, null), i.bindRenderbuffer(36161, null), this._setWarpMode(10242, this._wrapModeU),
                    this._setWarpMode(10243, this._wrapModeV), this._setFilterMode(this._filterMode),
                    this._setAnisotropy(this._anisoLevel), this._readyed = !0, this._activeResource();
            }, i._start = function () {
                v.instance.bindFramebuffer(36160, this._frameBuffer), e._currentActive = this, this._readyed = !1;
            }, i._end = function () {
                v.instance.bindFramebuffer(36160, null), e._currentActive = null, this._readyed = !0;
            }, i.getData = function (t, e, i, n, r) {
                if (I.isConchApp && 2 == conchConfig.threadMode) throw "native 2 thread mode use getDataAsync";
                var a = v.instance;
                return a.bindFramebuffer(36160, this._frameBuffer), 36053 === a.checkFramebufferStatus(36160) ? (a.readPixels(t, e, i, n, 6408, 5121, r),
                    a.bindFramebuffer(36160, null), r) : (a.bindFramebuffer(36160, null), null);
            }, i.getDataAsync = function (t, e, i, n, r) {
                var a = v.instance;
                a.bindFramebuffer(36160, this._frameBuffer), a.readPixelsAsync(t, e, i, n, 6408, 5121, function (t) {
                    r(new Uint8Array(t));
                }), a.bindFramebuffer(36160, null);
            }, i._disposeResource = function () {
                if (this._frameBuffer) {
                    var t = v.instance;
                    t.deleteTexture(this._glTexture), t.deleteFramebuffer(this._frameBuffer), t.deleteRenderbuffer(this._depthStencilBuffer),
                        this._glTexture = null, this._frameBuffer = null, this._depthStencilBuffer = null,
                        this._setGPUMemory(0);
                }
            }, a(0, i, "depthStencilFormat", function () {
                return this._depthStencilFormat;
            }), a(0, i, "defaulteTexture", function () {
                return N.grayTexture;
            }), a(1, e, "currentActive", function () {
                return e._currentActive;
            }, laya.resource.BaseTexture._$SET_currentActive), e.getTemporary = function (t, i, n, r, a) {
                void 0 === n && (n = 0), void 0 === r && (r = 0), void 0 === a && (a = 1);
                var s = 1e7 * a + 1e6 * r + 1e5 * n + 1e4 * i + t, o = e._temporaryMap[s];
                if (!o || o && 0 === o.length) {
                    var l = new e(t, i, n, r);
                    return l.filterMode = a, l;
                }
                return o.pop();
            }, e.setReleaseTemporary = function (t) {
                var i = 1e7 * t.filterMode + 1e6 * t.depthStencilFormat + 1e5 * t.format + 1e4 * t.height + t.width, n = e._temporaryMap[i];
                n || (e._temporaryMap[i] = n = []), n.push(t);
            }, e._temporaryMap = {}, e._currentActive = null, e;
        }(o), gn = function (t) {
            function e(t, i) {
                void 0 === t && (t = 0), void 0 === i && (i = !1), e.__super.call(this, t, i), this._glTextureType = 34067;
            }
            r(e, "laya.d3.resource.TextureCube", t);
            var n = e.prototype;
            return n.setSixSideImageSources = function (t, e) {
                void 0 === e && (e = !1);
                for (var i = 0, n = 0, r = 0; r < 6; r++) {
                    var a = t[r];
                    if (!a) return void console.log("TextureCube: image Source can't be null.");
                    var s = a.width, o = a.height;
                    if (r > 0 && i !== s) return void console.log("TextureCube: each side image's width and height must same.");
                    if ((i = s) !== (n = o)) return void console.log("TextureCube: each side image's width and height must same.");
                }
                this._width = i, this._height = n;
                var l = v.instance;
                k.bindTexture(l, this._glTextureType, this._glTexture);
                var h = this._getGLFormat();
                if (I.isConchApp) {
                    if (1 == e) for (var u = 0; u < 6; u++) t[u].setPremultiplyAlpha(e);
                    l.texImage2D(34073, 0, 6408, 6408, 5121, t[0]), l.texImage2D(34074, 0, 6408, 6408, 5121, t[1]),
                        l.texImage2D(34069, 0, 6408, 6408, 5121, t[2]), l.texImage2D(34070, 0, 6408, 6408, 5121, t[3]),
                        l.texImage2D(34071, 0, 6408, 6408, 5121, t[4]), l.texImage2D(34072, 0, 6408, 6408, 5121, t[5]);
                } else e && l.pixelStorei(37441, !0), l.texImage2D(34073, 0, h, h, 5121, t[0]),
                    l.texImage2D(34074, 0, h, h, 5121, t[1]), l.texImage2D(34069, 0, h, h, 5121, t[2]),
                    l.texImage2D(34070, 0, h, h, 5121, t[3]), l.texImage2D(34071, 0, h, h, 5121, t[4]),
                    l.texImage2D(34072, 0, h, h, 5121, t[5]), e && l.pixelStorei(37441, !1);
                this._mipmap && this._isPot(i) && this._isPot(n) ? (l.generateMipmap(this._glTextureType),
                    this._setGPUMemory(i * n * 4 * (1 + 1 / 3) * 6)) : this._setGPUMemory(i * n * 4 * 6),
                    this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV),
                    this._setFilterMode(this._filterMode), this._readyed = !0, this._activeResource();
            }, n.setSixSidePixels = function (t, e, i) {
                if (t <= 0 || e <= 0) throw new Error("TextureCube:width or height must large than 0.");
                if (!i) throw new Error("TextureCube:pixels can't be null.");
                this._width = t, this._height = e;
                var n = v.instance;
                k.bindTexture(n, this._glTextureType, this._glTexture);
                var r = this._getGLFormat();
                n.texImage2D(34073, 0, r, t, e, 0, r, 5121, i[0]), n.texImage2D(34074, 0, r, t, e, 0, r, 5121, i[1]),
                    n.texImage2D(34069, 0, r, t, e, 0, r, 5121, i[2]), n.texImage2D(34070, 0, r, t, e, 0, r, 5121, i[3]),
                    n.texImage2D(34071, 0, r, t, e, 0, r, 5121, i[4]), n.texImage2D(34072, 0, r, t, e, 0, r, 5121, i[5]),
                    this._mipmap && this._isPot(t) && this._isPot(e) ? (n.generateMipmap(this._glTextureType),
                        this._setGPUMemory(t * e * 4 * (1 + 1 / 3) * 6)) : this._setGPUMemory(t * e * 4 * 6),
                    this._setWarpMode(10242, this._wrapModeU), this._setWarpMode(10243, this._wrapModeV),
                    this._setFilterMode(this._filterMode), this._readyed = !0, this._activeResource();
            }, n._recoverResource = function () { }, a(0, n, "defaulteTexture", function () {
                return e.grayTexture;
            }), e.__init__ = function () {
                var t = new Uint8Array(3);
                t[0] = 128, t[1] = 128, t[2] = 128, e.grayTexture = new e(0, !1), e.grayTexture.setSixSidePixels(1, 1, [t, t, t, t, t, t]),
                    e.grayTexture.lock = !0;
            }, e._parse = function (t, i, n) {
                var r = n ? new e(n[0], n[1]) : new e();
                return r.setSixSideImageSources(t), r;
            }, e.load = function (t, e) {
                i.loader.create(t, e, null, "TEXTURECUBE");
            }, e.grayTexture = null, e;
        }(o), yn = function (t) {
            function e(t, i) {
                e.__super.call(this, i), this._meshFilter = new $t(this), this._render = new Yi(this),
                    t && (this._meshFilter.sharedMesh = t);
            }
            r(e, "laya.d3.core.MeshSprite3D", t);
            var i = e.prototype;
            return i._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var i = this.meshRenderer, n = t.lightmapIndex;
                null != n && (i.lightmapIndex = n);
                var r = t.lightmapScaleOffset;
                r && (i.lightmapScaleOffset = new pt(r[0], r[1], r[2], r[3])), null != t.meshPath && (this.meshFilter.sharedMesh = T.getRes(t.meshPath)),
                    null != t.enableRender && (this.meshRenderer.enable = t.enableRender);
                var a = t.materials;
                if (a) {
                    var s = i.sharedMaterials, o = a.length;
                    s.length = o;
                    for (var l = 0; l < o; l++) s[l] = T.getRes(a[l].path);
                    i.sharedMaterials = s;
                }
            }, i._addToInitStaticBatchManager = function () {
                Si.instance._addBatchSprite(this);
            }, i._cloneTo = function (t, e, i) {
                var n = t;
                n._meshFilter.sharedMesh = this._meshFilter.sharedMesh;
                var r = this._render, a = n._render;
                a.enable = r.enable, a.sharedMaterials = r.sharedMaterials, a.castShadow = r.castShadow;
                var s = r.lightmapScaleOffset;
                s && (a.lightmapScaleOffset = s.clone()), a.lightmapIndex = r.lightmapIndex, a.receiveShadow = r.receiveShadow,
                    a.sortingFudge = r.sortingFudge, laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, i);
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._meshFilter.destroy());
            }, a(0, i, "meshFilter", function () {
                return this._meshFilter;
            }), a(0, i, "meshRenderer", function () {
                return this._render;
            }), e.__init__ = function () {
                e.SHADERDEFINE_UV0 = e.shaderDefines.registerDefine("UV"), e.SHADERDEFINE_COLOR = e.shaderDefines.registerDefine("COLOR"),
                    e.SHADERDEFINE_UV1 = e.shaderDefines.registerDefine("UV1"), e.SHADERDEFINE_GPU_INSTANCE = e.shaderDefines.registerDefine("GPU_INSTANCE"),
                    Z._registerManager(Si.instance), tt._registerManager(oi.instance);
            }, e.SHADERDEFINE_UV0 = 0, e.SHADERDEFINE_COLOR = 0, e.SHADERDEFINE_UV1 = 0, e.SHADERDEFINE_GPU_INSTANCE = 0,
                n(e, ["shaderDefines", function () {
                    return this.shaderDefines = new mt(Qi.shaderDefines);
                }]), e;
        }(Qi), vn = function (t) {
            function e() {
                this._direction = null, this._spotAngle = NaN, this._range = NaN, e.__super.call(this),
                    this._spotAngle = 30, this._range = 10, this._direction = new gt();
            }
            r(e, "laya.d3.core.light.SpotLight", t);
            var i = e.prototype;
            return i._onActive = function () {
                t.prototype._onActive.call(this), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this.scene._defineDatas.add(Zi.SHADERDEFINE_SPOTLIGHT);
            }, i._onInActive = function () {
                t.prototype._onInActive.call(this), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this.scene._defineDatas.remove(Zi.SHADERDEFINE_SPOTLIGHT);
            }, i._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var e = t._shaderValues;
                    return gt.scale(this.color, this._intensity, this._intensityColor), e.setVector3(Zi.SPOTLIGHTCOLOR, this._intensityColor),
                        e.setVector3(Zi.SPOTLIGHTPOS, this.transform.position), this.transform.worldMatrix.getForward(this._direction),
                        gt.normalize(this._direction, this._direction), e.setVector3(Zi.SPOTLIGHTDIRECTION, this._direction),
                        e.setNumber(Zi.SPOTLIGHTRANGE, this.range), e.setNumber(Zi.SPOTLIGHTSPOTANGLE, this.spotAngle * Math.PI / 180),
                        !0;
                }
                return !1;
            }, i._parse = function (e, i) {
                t.prototype._parse.call(this, e, i), this.range = e.range, this.spotAngle = e.spotAngle;
            }, a(0, i, "spotAngle", function () {
                return this._spotAngle;
            }, function (t) {
                this._spotAngle = Math.max(Math.min(t, 180), 0);
            }), a(0, i, "range", function () {
                return this._range;
            }, function (t) {
                this._range = t;
            }), n(e, ["_tempMatrix0", function () {
                return this._tempMatrix0 = new ze();
            }, "_tempMatrix1", function () {
                return this._tempMatrix1 = new ze();
            }]), e;
        }($i), Sn = function (t) {
            function e() {
                this._direction = null, e.__super.call(this), this._direction = new gt();
            }
            r(e, "laya.d3.core.light.DirectionLight", t);
            var i = e.prototype;
            return i._initShadow = function () {
                if (this._shadow) this._parallelSplitShadowMap = new Nt(), this.scene.parallelSplitShadowMaps.push(this._parallelSplitShadowMap),
                    this.transform.worldMatrix.getForward(this._direction), gt.normalize(this._direction, this._direction),
                    this._parallelSplitShadowMap.setInfo(this.scene, this._shadowFarPlane, this._direction, this._shadowMapSize, this._shadowMapCount, this._shadowMapPCFType); else {
                    var t = this._scene._defineDatas, e = this.scene.parallelSplitShadowMaps;
                    e.splice(e.indexOf(this._parallelSplitShadowMap), 1), this._parallelSplitShadowMap.disposeAllRenderTarget(),
                        this._parallelSplitShadowMap = null, t.remove(Zi.SHADERDEFINE_SHADOW_PSSM1), t.remove(Zi.SHADERDEFINE_SHADOW_PSSM2),
                        t.remove(Zi.SHADERDEFINE_SHADOW_PSSM3);
                }
            }, i._onActive = function () {
                t.prototype._onActive.call(this), this._shadow && this._initShadow(), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.add(Zi.SHADERDEFINE_DIRECTIONLIGHT);
            }, i._onInActive = function () {
                t.prototype._onInActive.call(this), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.remove(Zi.SHADERDEFINE_DIRECTIONLIGHT);
            }, i._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var e = t._shaderValues;
                    return gt.scale(this.color, this._intensity, this._intensityColor), e.setVector3(Zi.LIGHTDIRCOLOR, this._intensityColor),
                        this.transform.worldMatrix.getForward(this._direction), gt.normalize(this._direction, this._direction),
                        e.setVector3(Zi.LIGHTDIRECTION, this._direction), !0;
                }
                return !1;
            }, a(0, i, "shadow", t.prototype._$get_shadow, function (t) {
                this._shadow !== t && (this._shadow = t, this.scene && this._initShadow());
            }), e;
        }($i), Tn = function (t) {
            function e() {
                e.__super.call(this, this.name), this._render = new qi(this), this._geometryFilter = new te(this);
            }
            r(e, "laya.d3.core.trail.TrailSprite3D", t);
            var i = e.prototype;
            return i._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var i = this._render, n = this._geometryFilter, r = 0, a = 0, s = t.materials;
                if (s) {
                    var o = i.sharedMaterials, l = s.length;
                    for (o.length = l, r = 0; r < l; r++) o[r] = T.getRes(s[r].path);
                    i.sharedMaterials = o;
                }
                n.time = t.time, n.minVertexDistance = t.minVertexDistance, n.widthMultiplier = t.widthMultiplier,
                    n.textureMode = t.textureMode, null != t.alignment && (n.alignment = t.alignment);
                var h = [], u = t.widthCurve;
                for (r = 0, a = u.length; r < a; r++) {
                    var c = new mi();
                    c.time = u[r].time, c.inTangent = u[r].inTangent, c.outTangent = u[r].outTangent,
                        c.value = u[r].value, h.push(c);
                }
                n.widthCurve = h;
                var d = t.colorGradient, _ = d.colorKeys, f = d.alphaKeys, p = new lt(_.length, f.length);
                for (p.mode = d.mode, r = 0, a = _.length; r < a; r++) {
                    var m = _[r];
                    p.addColorRGB(m.time, new Ct(m.value[0], m.value[1], m.value[2], 1));
                }
                for (r = 0, a = f.length; r < a; r++) {
                    var g = f[r];
                    p.addColorAlpha(g.time, g.value);
                }
                n.colorGradient = p;
            }, i._onActive = function () {
                t.prototype._onActive.call(this), this._transform.position.cloneTo(this._geometryFilter._lastPosition);
            }, i._cloneTo = function (t, e, i) {
                laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, i);
                var n, r = 0, a = t, s = a.trailFilter;
                s.time = this.trailFilter.time, s.minVertexDistance = this.trailFilter.minVertexDistance,
                    s.widthMultiplier = this.trailFilter.widthMultiplier, s.textureMode = this.trailFilter.textureMode;
                var o = this.trailFilter.widthCurve, l = [];
                for (r = 0, n = o.length; r < n; r++) {
                    var h = new mi();
                    o[r].cloneTo(h), l.push(h);
                }
                s.widthCurve = l;
                var u = new lt(this.trailFilter.colorGradient.maxColorRGBKeysCount, this.trailFilter.colorGradient.maxColorAlphaKeysCount);
                this.trailFilter.colorGradient.cloneTo(u), s.colorGradient = u, a.trailRenderer.sharedMaterial = this.trailRenderer.sharedMaterial;
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._geometryFilter.destroy(), this._geometryFilter = null);
            }, a(0, i, "trailFilter", function () {
                return this._geometryFilter;
            }), a(0, i, "trailRenderer", function () {
                return this._render;
            }), e.__init__ = function () {
                e.SHADERDEFINE_GRADIENTMODE_BLEND = e.shaderDefines.registerDefine("GRADIENTMODE_BLEND");
            }, e.SHADERDEFINE_GRADIENTMODE_BLEND = 0, n(e, ["CURTIME", function () {
                return this.CURTIME = Lt.propertyNameToID("u_CurTime");
            }, "LIFETIME", function () {
                return this.LIFETIME = Lt.propertyNameToID("u_LifeTime");
            }, "WIDTHCURVE", function () {
                return this.WIDTHCURVE = Lt.propertyNameToID("u_WidthCurve");
            }, "WIDTHCURVEKEYLENGTH", function () {
                return this.WIDTHCURVEKEYLENGTH = Lt.propertyNameToID("u_WidthCurveKeyLength");
            }, "GRADIENTCOLORKEY", function () {
                return this.GRADIENTCOLORKEY = Lt.propertyNameToID("u_GradientColorkey");
            }, "GRADIENTALPHAKEY", function () {
                return this.GRADIENTALPHAKEY = Lt.propertyNameToID("u_GradientAlphakey");
            }, "shaderDefines", function () {
                return this.shaderDefines = new mt(Qi.shaderDefines);
            }]), e;
        }(Qi), En = function (t) {
            function e() {
                e.__super.call(this, null), this._render = new ji(this), this._particleSystem = new si(this);
                var t = this._render._renderElements[0] = new At();
                t.setTransform(this._transform), t.render = this._render, t.setGeometry(this._particleSystem),
                    t.material = on.defaultMaterial;
            }
            r(e, "laya.d3.core.particleShuriKen.ShuriKenParticle3D", t);
            var i = e.prototype;
            return i._initParticleVelocity = function (t) {
                for (var e = new jt(), i = t.velocitys, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    e.add(a.key, a.value);
                }
                return e;
            }, i._initParticleColor = function (t) {
                var e = new lt(4, 4), i = t.alphas, n = 0, r = 0;
                for (n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    3 === n && 1 !== a.key && (a.key = 1, console.log("GradientDataColor warning:the forth key is  be force set to 1.")),
                        e.addColorAlpha(a.key, a.value);
                }
                var s = t.rgbs;
                for (n = 0, r = s.length; n < r; n++) {
                    var o = s[n], l = o.value;
                    3 === n && 1 !== o.key && (o.key = 1, console.log("GradientDataColor warning:the forth key is  be force set to 1.")),
                        e.addColorRGB(o.key, new Ct(l[0], l[1], l[2], 1));
                }
                return e;
            }, i._initParticleSize = function (t) {
                for (var e = new jt(), i = t.sizes, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    e.add(a.key, a.value);
                }
                return e;
            }, i._initParticleRotation = function (t) {
                for (var e = new jt(), i = t.angularVelocitys, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    e.add(a.key, a.value / 180 * Math.PI);
                }
                return e;
            }, i._initParticleFrame = function (t) {
                for (var e = new ae(), i = t.frames, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    e.add(a.key, a.value);
                }
                return e;
            }, i._parse = function (t, i) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, i);
                var n, r = Math.PI / 180, a = 0, s = 0, o = this.particleRenderer, l = t.material;
                l && (n = T.getRes(l.path)), o.sharedMaterial = n;
                var h = t.meshPath;
                h && (o.mesh = T.getRes(h)), o.renderMode = t.renderMode, o.stretchedBillboardCameraSpeedScale = t.stretchedBillboardCameraSpeedScale,
                    o.stretchedBillboardSpeedScale = t.stretchedBillboardSpeedScale, o.stretchedBillboardLengthScale = t.stretchedBillboardLengthScale,
                    o.sortingFudge = t.sortingFudge ? t.sortingFudge : 0;
                var u = this.particleSystem;
                u.isPerformanceMode = t.isPerformanceMode, u.duration = t.duration, u.looping = t.looping,
                    u.prewarm = t.prewarm, u.startDelayType = t.startDelayType, u.startDelay = t.startDelay,
                    u.startDelayMin = t.startDelayMin, u.startDelayMax = t.startDelayMax, u.startLifetimeType = t.startLifetimeType,
                    u.startLifetimeConstant = t.startLifetimeConstant, u.startLifeTimeGradient = e._initStartLife(t.startLifetimeGradient),
                    u.startLifetimeConstantMin = t.startLifetimeConstantMin, u.startLifetimeConstantMax = t.startLifetimeConstantMax,
                    u.startLifeTimeGradientMin = e._initStartLife(t.startLifetimeGradientMin), u.startLifeTimeGradientMax = e._initStartLife(t.startLifetimeGradientMax),
                    u.startSpeedType = t.startSpeedType, u.startSpeedConstant = t.startSpeedConstant,
                    u.startSpeedConstantMin = t.startSpeedConstantMin, u.startSpeedConstantMax = t.startSpeedConstantMax,
                    u.threeDStartSize = t.threeDStartSize, u.startSizeType = t.startSizeType, u.startSizeConstant = t.startSizeConstant;
                var c = t.startSizeConstantSeparate, d = u.startSizeConstantSeparate;
                d.x = c[0], d.y = c[1], d.z = c[2], u.startSizeConstantMin = t.startSizeConstantMin,
                    u.startSizeConstantMax = t.startSizeConstantMax;
                var _ = t.startSizeConstantMinSeparate, f = u.startSizeConstantMinSeparate;
                f.x = _[0], f.y = _[1], f.z = _[2];
                var p = t.startSizeConstantMaxSeparate, m = u.startSizeConstantMaxSeparate;
                m.x = p[0], m.y = p[1], m.z = p[2], u.threeDStartRotation = t.threeDStartRotation,
                    u.startRotationType = t.startRotationType, u.startRotationConstant = t.startRotationConstant * r;
                var g = t.startRotationConstantSeparate, y = u.startRotationConstantSeparate;
                y.x = g[0] * r, y.y = g[1] * r, y.z = g[2] * r, u.startRotationConstantMin = t.startRotationConstantMin * r,
                    u.startRotationConstantMax = t.startRotationConstantMax * r;
                var v = t.startRotationConstantMinSeparate, S = u.startRotationConstantMinSeparate;
                S.x = v[0] * r, S.y = v[1] * r, S.z = v[2] * r;
                var E = t.startRotationConstantMaxSeparate, C = u.startRotationConstantMaxSeparate;
                C.x = E[0] * r, C.y = E[1] * r, C.z = E[2] * r, u.randomizeRotationDirection = t.randomizeRotationDirection,
                    u.startColorType = t.startColorType;
                var x = t.startColorConstant, b = u.startColorConstant;
                b.x = x[0], b.y = x[1], b.z = x[2], b.w = x[3];
                var I = t.startColorConstantMin, w = u.startColorConstantMin;
                w.x = I[0], w.y = I[1], w.z = I[2], w.w = I[3];
                var A = t.startColorConstantMax, R = u.startColorConstantMax;
                R.x = A[0], R.y = A[1], R.z = A[2], R.w = A[3], u.gravityModifier = t.gravityModifier,
                    u.simulationSpace = t.simulationSpace, u.scaleMode = t.scaleMode, u.playOnAwake = t.playOnAwake,
                    u.maxParticles = t.maxParticles;
                var M = t.autoRandomSeed;
                null != M && (u.autoRandomSeed = M);
                var D = t.randomSeed;
                null != D && (u.randomSeed[0] = D);
                var O = t.emission, L = u.emission;
                if (O) {
                    L.emissionRate = O.emissionRate;
                    var P = O.bursts;
                    if (P) for (a = 0, s = P.length; a < s; a++) {
                        var N = P[a];
                        L.addBurst(new ie(N.time, N.min, N.max));
                    }
                    L.enbale = O.enable;
                } else L.enbale = !1;
                var B = t.shape;
                if (B) {
                    var F;
                    switch (B.shapeType) {
                        case 0:
                            var k;
                            F = k = new wi(), k.radius = B.sphereRadius, k.emitFromShell = B.sphereEmitFromShell,
                                k.randomDirection = B.sphereRandomDirection;
                            break;

                        case 1:
                            var V;
                            F = V = new xi(), V.radius = B.hemiSphereRadius, V.emitFromShell = B.hemiSphereEmitFromShell,
                                V.randomDirection = B.hemiSphereRandomDirection;
                            break;

                        case 2:
                            var U;
                            F = U = new $e(), U.angle = B.coneAngle * r, U.radius = B.coneRadius, U.length = B.coneLength,
                                U.emitType = B.coneEmitType, U.randomDirection = B.coneRandomDirection;
                            break;

                        case 3:
                            var G;
                            F = G = new Di(), G.x = B.boxX, G.y = B.boxY, G.z = B.boxZ, G.randomDirection = B.boxRandomDirection;
                            break;

                        case 7:
                            var H;
                            F = H = new ei(), H.radius = B.circleRadius, H.arc = B.circleArc * r, H.emitFromEdge = B.circleEmitFromEdge,
                                H.randomDirection = B.circleRandomDirection;
                            break;

                        default:
                            var j;
                            F = j = new ei(), j.radius = B.circleRadius, j.arc = B.circleArc * r, j.emitFromEdge = B.circleEmitFromEdge,
                                j.randomDirection = B.circleRandomDirection;
                    }
                    F.enable = B.enable, u.shape = F;
                }
                var W = t.velocityOverLifetime;
                if (W) {
                    var Y, q = W.velocity;
                    switch (q.type) {
                        case 0:
                            var K = q.constant;
                            Y = Ee.createByConstant(new gt(K[0], K[1], K[2]));
                            break;

                        case 1:
                            Y = Ee.createByGradient(this._initParticleVelocity(q.gradientX), this._initParticleVelocity(q.gradientY), this._initParticleVelocity(q.gradientZ));
                            break;

                        case 2:
                            var Z = q.constantMin, Q = q.constantMax;
                            Y = Ee.createByRandomTwoConstant(new gt(Z[0], Z[1], Z[2]), new gt(Q[0], Q[1], Q[2]));
                            break;

                        case 3:
                            Y = Ee.createByRandomTwoGradient(this._initParticleVelocity(q.gradientXMin), this._initParticleVelocity(q.gradientXMax), this._initParticleVelocity(q.gradientYMin), this._initParticleVelocity(q.gradientYMax), this._initParticleVelocity(q.gradientZMin), this._initParticleVelocity(q.gradientZMax));
                    }
                    var J = new St(Y);
                    J.space = W.space, J.enbale = W.enable, u.velocityOverLifetime = J;
                }
                var $ = t.colorOverLifetime;
                if ($) {
                    var tt, et = $.color;
                    switch (et.type) {
                        case 0:
                            var it = et.constant;
                            tt = rt.createByConstant(new pt(it[0], it[1], it[2], it[3]));
                            break;

                        case 1:
                            tt = rt.createByGradient(this._initParticleColor(et.gradient));
                            break;

                        case 2:
                            var nt = et.constantMin, at = et.constantMax;
                            tt = rt.createByRandomTwoConstant(new pt(nt[0], nt[1], nt[2], nt[3]), new pt(at[0], at[1], at[2], at[3]));
                            break;

                        case 3:
                            tt = rt.createByRandomTwoGradient(this._initParticleColor(et.gradientMin), this._initParticleColor(et.gradientMax));
                    }
                    var st = new z(tt);
                    st.enbale = $.enable, u.colorOverLifetime = st;
                }
                var ot = t.sizeOverLifetime;
                if (ot) {
                    var lt, ht = ot.size;
                    switch (ht.type) {
                        case 0:
                            lt = ht.separateAxes ? ye.createByGradientSeparate(this._initParticleSize(ht.gradientX), this._initParticleSize(ht.gradientY), this._initParticleSize(ht.gradientZ)) : ye.createByGradient(this._initParticleSize(ht.gradient));
                            break;

                        case 1:
                            if (ht.separateAxes) {
                                var ut = ht.constantMinSeparate, ct = ht.constantMaxSeparate;
                                lt = ye.createByRandomTwoConstantSeparate(new gt(ut[0], ut[1], ut[2]), new gt(ct[0], ct[1], ct[2]));
                            } else lt = ye.createByRandomTwoConstant(ht.constantMin, ht.constantMax);
                            break;

                        case 2:
                            lt = ht.separateAxes ? ye.createByRandomTwoGradientSeparate(this._initParticleSize(ht.gradientXMin), this._initParticleSize(ht.gradientYMin), this._initParticleSize(ht.gradientZMin), this._initParticleSize(ht.gradientXMax), this._initParticleSize(ht.gradientYMax), this._initParticleSize(ht.gradientZMax)) : ye.createByRandomTwoGradient(this._initParticleSize(ht.gradientMin), this._initParticleSize(ht.gradientMax));
                    }
                    var dt = new _t(lt);
                    dt.enbale = ot.enable, u.sizeOverLifetime = dt;
                }
                var ft = t.rotationOverLifetime;
                if (ft) {
                    var mt, vt = ft.angularVelocity;
                    switch (vt.type) {
                        case 0:
                            if (vt.separateAxes) {
                                var Tt = vt.constantSeparate;
                                mt = he.createByConstantSeparate(new gt(Tt[0] * r, Tt[1] * r, Tt[2] * r));
                            } else mt = he.createByConstant(vt.constant * r);
                            break;

                        case 1:
                            mt = vt.separateAxes ? he.createByGradientSeparate(this._initParticleRotation(vt.gradientX), this._initParticleRotation(vt.gradientY), this._initParticleRotation(vt.gradientZ)) : he.createByGradient(this._initParticleRotation(vt.gradient));
                            break;

                        case 2:
                            if (vt.separateAxes) {
                                var Et = vt.constantMinSeparate, Ct = vt.constantMaxSeparate;
                                mt = he.createByRandomTwoConstantSeparate(new gt(Et[0] * r, Et[1] * r, Et[2] * r), new gt(Ct[0] * r, Ct[1] * r, Ct[2] * r));
                            } else mt = he.createByRandomTwoConstant(vt.constantMin * r, vt.constantMax * r);
                            break;

                        case 3:
                            vt.separateAxes || (mt = he.createByRandomTwoGradient(this._initParticleRotation(vt.gradientMin), this._initParticleRotation(vt.gradientMax)));
                    }
                    var xt = new Oe(mt);
                    xt.enbale = ft.enable, u.rotationOverLifetime = xt;
                }
                var bt = t.textureSheetAnimation;
                if (bt) {
                    var It, wt = bt.frame;
                    switch (wt.type) {
                        case 0:
                            It = X.createByConstant(wt.constant);
                            break;

                        case 1:
                            It = X.createByOverTime(this._initParticleFrame(wt.overTime));
                            break;

                        case 2:
                            It = X.createByRandomTwoConstant(wt.constantMin, wt.constantMax);
                            break;

                        case 3:
                            It = X.createByRandomTwoOverTime(this._initParticleFrame(wt.overTimeMin), this._initParticleFrame(wt.overTimeMax));
                    }
                    var At, Rt = bt.startFrame;
                    switch (Rt.type) {
                        case 0:
                            At = xe.createByConstant(Rt.constant);
                            break;

                        case 1:
                            At = xe.createByRandomTwoConstant(Rt.constantMin, Rt.constantMax);
                    }
                    var Mt = new Dt(It, At);
                    Mt.enable = bt.enable;
                    var Ot = bt.tiles;
                    Mt.tiles = new yt(Ot[0], Ot[1]), Mt.type = bt.type, Mt.randomRow = bt.randomRow;
                    var Lt = bt.rowIndex;
                    void 0 !== Lt && (Mt.rowIndex = Lt), Mt.cycles = bt.cycles, u.textureSheetAnimation = Mt;
                }
            }, i._activeHierarchy = function (t) {
                laya.display.Node.prototype._activeHierarchy.call(this, t), this.particleSystem.playOnAwake && this.particleSystem.play();
            }, i._inActiveHierarchy = function (t) {
                laya.display.Node.prototype._inActiveHierarchy.call(this, t), this.particleSystem.isAlive && this.particleSystem.simulate(0, !0);
            }, i._cloneTo = function (t, e, i) {
                var n = t, r = n._particleSystem;
                this._particleSystem.cloneTo(r);
                var a = n._render, s = this._render;
                a.sharedMaterials = s.sharedMaterials, a.enable = s.enable, a.renderMode = s.renderMode,
                    a.mesh = s.mesh, a.stretchedBillboardCameraSpeedScale = s.stretchedBillboardCameraSpeedScale,
                    a.stretchedBillboardSpeedScale = s.stretchedBillboardSpeedScale, a.stretchedBillboardLengthScale = s.stretchedBillboardLengthScale,
                    a.sortingFudge = s.sortingFudge, laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, e, i);
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._particleSystem.destroy(), this._particleSystem = null);
            }, a(0, i, "particleSystem", function () {
                return this._particleSystem;
            }), a(0, i, "particleRenderer", function () {
                return this._render;
            }), e.__init__ = function () {
                e.SHADERDEFINE_RENDERMODE_BILLBOARD = e.shaderDefines.registerDefine("SPHERHBILLBOARD"),
                    e.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD = e.shaderDefines.registerDefine("STRETCHEDBILLBOARD"),
                    e.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD = e.shaderDefines.registerDefine("HORIZONTALBILLBOARD"),
                    e.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD = e.shaderDefines.registerDefine("VERTICALBILLBOARD"),
                    e.SHADERDEFINE_COLOROVERLIFETIME = e.shaderDefines.registerDefine("COLOROVERLIFETIME"),
                    e.SHADERDEFINE_RANDOMCOLOROVERLIFETIME = e.shaderDefines.registerDefine("RANDOMCOLOROVERLIFETIME"),
                    e.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT = e.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECONSTANT"),
                    e.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE = e.shaderDefines.registerDefine("VELOCITYOVERLIFETIMECURVE"),
                    e.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT = e.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCONSTANT"),
                    e.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE = e.shaderDefines.registerDefine("VELOCITYOVERLIFETIMERANDOMCURVE"),
                    e.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE = e.shaderDefines.registerDefine("TEXTURESHEETANIMATIONCURVE"),
                    e.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE = e.shaderDefines.registerDefine("TEXTURESHEETANIMATIONRANDOMCURVE"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIME = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIME"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIMESEPERATE"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECONSTANT"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIMECURVE"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCONSTANTS"),
                    e.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES = e.shaderDefines.registerDefine("ROTATIONOVERLIFETIMERANDOMCURVES"),
                    e.SHADERDEFINE_SIZEOVERLIFETIMECURVE = e.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVE"),
                    e.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE = e.shaderDefines.registerDefine("SIZEOVERLIFETIMECURVESEPERATE"),
                    e.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES = e.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVES"),
                    e.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE = e.shaderDefines.registerDefine("SIZEOVERLIFETIMERANDOMCURVESSEPERATE"),
                    e.SHADERDEFINE_RENDERMODE_MESH = e.shaderDefines.registerDefine("RENDERMODE_MESH"),
                    e.SHADERDEFINE_SHAPE = e.shaderDefines.registerDefine("SHAPE");
            }, e._initStartLife = function (t) {
                for (var e = new jt(), i = t.startLifetimes, n = 0, r = i.length; n < r; n++) {
                    var a = i[n];
                    e.add(a.key, a.value);
                }
                return e;
            }, e.SHADERDEFINE_RENDERMODE_BILLBOARD = 0, e.SHADERDEFINE_RENDERMODE_STRETCHEDBILLBOARD = 0,
                e.SHADERDEFINE_RENDERMODE_HORIZONTALBILLBOARD = 0, e.SHADERDEFINE_RENDERMODE_VERTICALBILLBOARD = 0,
                e.SHADERDEFINE_COLOROVERLIFETIME = 0, e.SHADERDEFINE_RANDOMCOLOROVERLIFETIME = 0,
                e.SHADERDEFINE_VELOCITYOVERLIFETIMECONSTANT = 0, e.SHADERDEFINE_VELOCITYOVERLIFETIMECURVE = 0,
                e.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCONSTANT = 0, e.SHADERDEFINE_VELOCITYOVERLIFETIMERANDOMCURVE = 0,
                e.SHADERDEFINE_TEXTURESHEETANIMATIONCURVE = 0, e.SHADERDEFINE_TEXTURESHEETANIMATIONRANDOMCURVE = 0,
                e.SHADERDEFINE_ROTATIONOVERLIFETIME = 0, e.SHADERDEFINE_ROTATIONOVERLIFETIMESEPERATE = 0,
                e.SHADERDEFINE_ROTATIONOVERLIFETIMECONSTANT = 0, e.SHADERDEFINE_ROTATIONOVERLIFETIMECURVE = 0,
                e.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCONSTANTS = 0, e.SHADERDEFINE_ROTATIONOVERLIFETIMERANDOMCURVES = 0,
                e.SHADERDEFINE_SIZEOVERLIFETIMECURVE = 0, e.SHADERDEFINE_SIZEOVERLIFETIMECURVESEPERATE = 0,
                e.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVES = 0, e.SHADERDEFINE_SIZEOVERLIFETIMERANDOMCURVESSEPERATE = 0,
                e.SHADERDEFINE_RENDERMODE_MESH = 0, e.SHADERDEFINE_SHAPE = 0, n(e, ["WORLDPOSITION", function () {
                    return this.WORLDPOSITION = Lt.propertyNameToID("u_WorldPosition");
                }, "WORLDROTATION", function () {
                    return this.WORLDROTATION = Lt.propertyNameToID("u_WorldRotation");
                }, "POSITIONSCALE", function () {
                    return this.POSITIONSCALE = Lt.propertyNameToID("u_PositionScale");
                }, "SIZESCALE", function () {
                    return this.SIZESCALE = Lt.propertyNameToID("u_SizeScale");
                }, "SCALINGMODE", function () {
                    return this.SCALINGMODE = Lt.propertyNameToID("u_ScalingMode");
                }, "GRAVITY", function () {
                    return this.GRAVITY = Lt.propertyNameToID("u_Gravity");
                }, "THREEDSTARTROTATION", function () {
                    return this.THREEDSTARTROTATION = Lt.propertyNameToID("u_ThreeDStartRotation");
                }, "STRETCHEDBILLBOARDLENGTHSCALE", function () {
                    return this.STRETCHEDBILLBOARDLENGTHSCALE = Lt.propertyNameToID("u_StretchedBillboardLengthScale");
                }, "STRETCHEDBILLBOARDSPEEDSCALE", function () {
                    return this.STRETCHEDBILLBOARDSPEEDSCALE = Lt.propertyNameToID("u_StretchedBillboardSpeedScale");
                }, "SIMULATIONSPACE", function () {
                    return this.SIMULATIONSPACE = Lt.propertyNameToID("u_SimulationSpace");
                }, "CURRENTTIME", function () {
                    return this.CURRENTTIME = Lt.propertyNameToID("u_CurrentTime");
                }, "VOLVELOCITYCONST", function () {
                    return this.VOLVELOCITYCONST = Lt.propertyNameToID("u_VOLVelocityConst");
                }, "VOLVELOCITYGRADIENTX", function () {
                    return this.VOLVELOCITYGRADIENTX = Lt.propertyNameToID("u_VOLVelocityGradientX");
                }, "VOLVELOCITYGRADIENTY", function () {
                    return this.VOLVELOCITYGRADIENTY = Lt.propertyNameToID("u_VOLVelocityGradientY");
                }, "VOLVELOCITYGRADIENTZ", function () {
                    return this.VOLVELOCITYGRADIENTZ = Lt.propertyNameToID("u_VOLVelocityGradientZ");
                }, "VOLVELOCITYCONSTMAX", function () {
                    return this.VOLVELOCITYCONSTMAX = Lt.propertyNameToID("u_VOLVelocityConstMax");
                }, "VOLVELOCITYGRADIENTXMAX", function () {
                    return this.VOLVELOCITYGRADIENTXMAX = Lt.propertyNameToID("u_VOLVelocityGradientMaxX");
                }, "VOLVELOCITYGRADIENTYMAX", function () {
                    return this.VOLVELOCITYGRADIENTYMAX = Lt.propertyNameToID("u_VOLVelocityGradientMaxY");
                }, "VOLVELOCITYGRADIENTZMAX", function () {
                    return this.VOLVELOCITYGRADIENTZMAX = Lt.propertyNameToID("u_VOLVelocityGradientMaxZ");
                }, "VOLSPACETYPE", function () {
                    return this.VOLSPACETYPE = Lt.propertyNameToID("u_VOLSpaceType");
                }, "COLOROVERLIFEGRADIENTALPHAS", function () {
                    return this.COLOROVERLIFEGRADIENTALPHAS = Lt.propertyNameToID("u_ColorOverLifeGradientAlphas");
                }, "COLOROVERLIFEGRADIENTCOLORS", function () {
                    return this.COLOROVERLIFEGRADIENTCOLORS = Lt.propertyNameToID("u_ColorOverLifeGradientColors");
                }, "MAXCOLOROVERLIFEGRADIENTALPHAS", function () {
                    return this.MAXCOLOROVERLIFEGRADIENTALPHAS = Lt.propertyNameToID("u_MaxColorOverLifeGradientAlphas");
                }, "MAXCOLOROVERLIFEGRADIENTCOLORS", function () {
                    return this.MAXCOLOROVERLIFEGRADIENTCOLORS = Lt.propertyNameToID("u_MaxColorOverLifeGradientColors");
                }, "SOLSIZEGRADIENT", function () {
                    return this.SOLSIZEGRADIENT = Lt.propertyNameToID("u_SOLSizeGradient");
                }, "SOLSIZEGRADIENTX", function () {
                    return this.SOLSIZEGRADIENTX = Lt.propertyNameToID("u_SOLSizeGradientX");
                }, "SOLSIZEGRADIENTY", function () {
                    return this.SOLSIZEGRADIENTY = Lt.propertyNameToID("u_SOLSizeGradientY");
                }, "SOLSizeGradientZ", function () {
                    return this.SOLSizeGradientZ = Lt.propertyNameToID("u_SOLSizeGradientZ");
                }, "SOLSizeGradientMax", function () {
                    return this.SOLSizeGradientMax = Lt.propertyNameToID("u_SOLSizeGradientMax");
                }, "SOLSIZEGRADIENTXMAX", function () {
                    return this.SOLSIZEGRADIENTXMAX = Lt.propertyNameToID("u_SOLSizeGradientMaxX");
                }, "SOLSIZEGRADIENTYMAX", function () {
                    return this.SOLSIZEGRADIENTYMAX = Lt.propertyNameToID("u_SOLSizeGradientMaxY");
                }, "SOLSizeGradientZMAX", function () {
                    return this.SOLSizeGradientZMAX = Lt.propertyNameToID("u_SOLSizeGradientMaxZ");
                }, "ROLANGULARVELOCITYCONST", function () {
                    return this.ROLANGULARVELOCITYCONST = Lt.propertyNameToID("u_ROLAngularVelocityConst");
                }, "ROLANGULARVELOCITYCONSTSEPRARATE", function () {
                    return this.ROLANGULARVELOCITYCONSTSEPRARATE = Lt.propertyNameToID("u_ROLAngularVelocityConstSeprarate");
                }, "ROLANGULARVELOCITYGRADIENT", function () {
                    return this.ROLANGULARVELOCITYGRADIENT = Lt.propertyNameToID("u_ROLAngularVelocityGradient");
                }, "ROLANGULARVELOCITYGRADIENTX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTX = Lt.propertyNameToID("u_ROLAngularVelocityGradientX");
                }, "ROLANGULARVELOCITYGRADIENTY", function () {
                    return this.ROLANGULARVELOCITYGRADIENTY = Lt.propertyNameToID("u_ROLAngularVelocityGradientY");
                }, "ROLANGULARVELOCITYGRADIENTZ", function () {
                    return this.ROLANGULARVELOCITYGRADIENTZ = Lt.propertyNameToID("u_ROLAngularVelocityGradientZ");
                }, "ROLANGULARVELOCITYCONSTMAX", function () {
                    return this.ROLANGULARVELOCITYCONSTMAX = Lt.propertyNameToID("u_ROLAngularVelocityConstMax");
                }, "ROLANGULARVELOCITYCONSTMAXSEPRARATE", function () {
                    return this.ROLANGULARVELOCITYCONSTMAXSEPRARATE = Lt.propertyNameToID("u_ROLAngularVelocityConstMaxSeprarate");
                }, "ROLANGULARVELOCITYGRADIENTMAX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTMAX = Lt.propertyNameToID("u_ROLAngularVelocityGradientMax");
                }, "ROLANGULARVELOCITYGRADIENTXMAX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTXMAX = Lt.propertyNameToID("u_ROLAngularVelocityGradientMaxX");
                }, "ROLANGULARVELOCITYGRADIENTYMAX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTYMAX = Lt.propertyNameToID("u_ROLAngularVelocityGradientMaxY");
                }, "ROLANGULARVELOCITYGRADIENTZMAX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTZMAX = Lt.propertyNameToID("u_ROLAngularVelocityGradientMaxZ");
                }, "ROLANGULARVELOCITYGRADIENTWMAX", function () {
                    return this.ROLANGULARVELOCITYGRADIENTWMAX = Lt.propertyNameToID("u_ROLAngularVelocityGradientMaxW");
                }, "TEXTURESHEETANIMATIONCYCLES", function () {
                    return this.TEXTURESHEETANIMATIONCYCLES = Lt.propertyNameToID("u_TSACycles");
                }, "TEXTURESHEETANIMATIONSUBUVLENGTH", function () {
                    return this.TEXTURESHEETANIMATIONSUBUVLENGTH = Lt.propertyNameToID("u_TSASubUVLength");
                }, "TEXTURESHEETANIMATIONGRADIENTUVS", function () {
                    return this.TEXTURESHEETANIMATIONGRADIENTUVS = Lt.propertyNameToID("u_TSAGradientUVs");
                }, "TEXTURESHEETANIMATIONGRADIENTMAXUVS", function () {
                    return this.TEXTURESHEETANIMATIONGRADIENTMAXUVS = Lt.propertyNameToID("u_TSAMaxGradientUVs");
                }, "shaderDefines", function () {
                    return this.shaderDefines = new mt(Qi.shaderDefines);
                }]), e;
        }(Qi), Cn = function (t) {
            function e(t, i) {
                this._geometryFilter = null, void 0 === t && (t = 2), e.__super.call(this, i), this._geometryFilter = new fi(this, t),
                    this._render = new Ki(this), this._changeRenderObjects(this._render, 0, rn.defaultMaterial);
            }
            r(e, "laya.d3.core.pixelLine.PixelLineSprite3D", t);
            var i = e.prototype;
            return i._changeRenderObjects = function (t, e, i) {
                var n = this._render._renderElements;
                i || (i = rn.defaultMaterial);
                var r = n[e];
                r || (r = n[e] = new At()), r.setTransform(this._transform), r.setGeometry(this._geometryFilter),
                    r.render = this._render, r.material = i;
            }, i.addLine = function (t, e, i, n) {
                if (this._geometryFilter._lineCount === this._geometryFilter._maxLineCount) throw "PixelLineSprite3D: lineCount has equal with maxLineCount.";
                this._geometryFilter._updateLineData(this._geometryFilter._lineCount++, t, e, i, n);
            }, i.addLines = function (t) {
                var e = this._geometryFilter._lineCount, i = t.length;
                if (e + i > this._geometryFilter._maxLineCount) throw "PixelLineSprite3D: lineCount plus lines count must less than maxLineCount.";
                this._geometryFilter._updateLineDatas(e, t), this._geometryFilter._lineCount += i;
            }, i.removeLine = function (t) {
                if (!(t < this._geometryFilter._lineCount)) throw "PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._removeLineData(t);
            }, i.setLine = function (t, e, i, n, r) {
                if (!(t < this._geometryFilter._lineCount)) throw "PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._updateLineData(t, e, i, n, r);
            }, i.getLine = function (t, e) {
                if (!(t < this.lineCount)) throw "PixelLineSprite3D: index must less than lineCount.";
                this._geometryFilter._getLineData(t, e);
            }, i.clear = function () {
                this._geometryFilter._lineCount = 0;
            }, a(0, i, "maxLineCount", function () {
                return this._geometryFilter._maxLineCount;
            }, function (t) {
                this._geometryFilter._resizeLineData(t), this._geometryFilter._lineCount = Math.min(this._geometryFilter._lineCount, t);
            }), a(0, i, "pixelLineRenderer", function () {
                return this._render;
            }), a(0, i, "lineCount", function () {
                return this._geometryFilter._lineCount;
            }, function (t) {
                if (t > this.maxLineCount) throw "PixelLineSprite3D: lineCount can't large than maxLineCount";
                this._geometryFilter._lineCount = t;
            }), e;
        }(Qi), xn = function (t) {
            function e(t, i) {
                e.__super.call(this, i), this._meshFilter = new $t(this), this._render = new pn(this),
                    t && (this._meshFilter.sharedMesh = t);
            }
            r(e, "laya.d3.core.SkinnedMeshSprite3D", t);
            var i = e.prototype;
            return i._parse = function (t, e) {
                laya.d3.core.Sprite3D.prototype._parse.call(this, t, e);
                var i = this.skinnedMeshRenderer, n = t.lightmapIndex;
                null != n && (i.lightmapIndex = n);
                var r, a = t.lightmapScaleOffset;
                if (a && (i.lightmapScaleOffset = new pt(a[0], a[1], a[2], a[3])), r = t.meshPath) {
                    var s = T.getRes(r);
                    s && (this.meshFilter.sharedMesh = s);
                }
                var o = t.materials;
                if (o) {
                    var l = i.sharedMaterials, h = o.length;
                    l.length = h;
                    for (var u = 0; u < h; u++) l[u] = T.getRes(o[u].path);
                    i.sharedMaterials = l;
                }
                var c = t.boundBox, d = c.min, _ = c.max;
                if (i.localBounds.setMin(new gt(d[0], d[1], d[2])), i.localBounds.setMax(new gt(_[0], _[1], _[2])),
                    e) {
                    var f = t.rootBone;
                    i.rootBone = e[f];
                    var p, m = t.bones;
                    for (u = 0, p = m.length; u < p; u++) i.bones.push(e[m[u]]);
                } else t.rootBone && i._setRootBone(t.rootBone);
            }, i._changeHierarchyAnimator = function (e) {
                t.prototype._changeHierarchyAnimator.call(this, e), this.skinnedMeshRenderer._setCacheAnimator(e);
            }, i._changeAnimatorAvatar = function (t) {
                this.skinnedMeshRenderer._setCacheAvatar(t);
            }, i._cloneTo = function (t, i, n) {
                var r = t;
                r.meshFilter.sharedMesh = this.meshFilter.sharedMesh;
                var a = this._render, s = r._render;
                s.enable = a.enable, s.sharedMaterials = a.sharedMaterials, s.castShadow = a.castShadow;
                var o = a.lightmapScaleOffset;
                o && (s.lightmapScaleOffset = o.clone()), s.receiveShadow = a.receiveShadow, s.sortingFudge = a.sortingFudge,
                    s._rootBone = a._rootBone;
                var l = a.bones, h = s.bones, u = l.length;
                h.length = u;
                var c = a.rootBone;
                if (c) {
                    var d = Ht._getHierarchyPath(i, c, e._tempArray0);
                    s.rootBone = d ? Ht._getNodeByHierarchyPath(n, d) : c;
                }
                for (var _ = 0; _ < l.length; _++) d = Ht._getHierarchyPath(i, l[_], e._tempArray0),
                    h[_] = d ? Ht._getNodeByHierarchyPath(n, d) : l[_];
                var f = a.localBounds;
                f && f.cloneTo(s.localBounds), laya.d3.core.Sprite3D.prototype._cloneTo.call(this, t, i, n);
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._meshFilter.destroy());
            }, a(0, i, "meshFilter", function () {
                return this._meshFilter;
            }), a(0, i, "skinnedMeshRenderer", function () {
                return this._render;
            }), e.__init__ = function () {
                e.SHADERDEFINE_BONE = e.shaderDefines.registerDefine("BONE");
            }, e._tempArray0 = [], e.SHADERDEFINE_BONE = 0, n(e, ["BONES", function () {
                return this.BONES = Lt.propertyNameToID("u_Bones");
            }, "shaderDefines", function () {
                return this.shaderDefines = new mt(yn.shaderDefines);
            }]), e;
        }(Qi), bn = function (t) {
            function e() {
                this._range = NaN, this._lightMatrix = new ze(), e.__super.call(this), this._range = 6;
            }
            r(e, "laya.d3.core.light.PointLight", t);
            var i = e.prototype;
            return i._onActive = function () {
                t.prototype._onActive.call(this), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.add(Zi.SHADERDEFINE_POINTLIGHT);
            }, i._onInActive = function () {
                t.prototype._onInActive.call(this), this._lightmapBakedType !== $i.LIGHTMAPBAKEDTYPE_BAKED && this._scene._defineDatas.remove(Zi.SHADERDEFINE_POINTLIGHT);
            }, i._prepareToScene = function () {
                var t = this._scene;
                if (t.enableLight && this.activeInHierarchy) {
                    t._defineDatas;
                    var i = t._shaderValues;
                    gt.scale(this.color, this._intensity, this._intensityColor), i.setVector3(Zi.POINTLIGHTCOLOR, this._intensityColor),
                        i.setVector3(Zi.POINTLIGHTPOS, this.transform.position), i.setNumber(Zi.POINTLIGHTRANGE, this.range);
                    var n = this._lightMatrix, r = n.elements;
                    n.identity(), r[0] = r[5] = r[10] = 1 / this._range;
                    var a = e._tempMatrix0;
                    return this.transform.worldMatrix.invert(a), ze.multiply(n, a, n), i.setMatrix4x4(Zi.POINTLIGHTMATRIX, n),
                        !0;
                }
                return !1;
            }, i._parse = function (e, i) {
                t.prototype._parse.call(this, e, i), this.range = e.range;
            }, a(0, i, "range", function () {
                return this._range;
            }, function (t) {
                this._range = t;
            }), n(e, ["_tempMatrix0", function () {
                return this._tempMatrix0 = new ze();
            }]), e;
        }($i), In = function (t) {
            function e(t, i, n, r, a, s, o, l) {
                this._terrainFilter = null, e.__super.call(this, l), this._terrainFilter = new bi(this, t, i, n, r, a, s, o),
                    this._render = new Xi(this);
            }
            r(e, "laya.d3.terrain.TerrainChunk", t);
            var i = e.prototype;
            return i.buildRenderElementAndMaterial = function (t, e, i, n, r, a, s, o, l, h, u, c, d, _, f, p, m, g) {
                void 0 === u && (u = 1), void 0 === c && (c = 1), void 0 === d && (d = 1), void 0 === _ && (_ = 1),
                    void 0 === f && (f = 1), void 0 === p && (p = 1), void 0 === m && (m = 1), void 0 === g && (g = 1);
                var y = new dn();
                l && (y.diffuseColor = l), o && (y.ambientColor = o), h && (y.specularColor = h),
                    y.splatAlphaTexture = T.getRes(i), y.normalTexture = e ? T.getRes(e) : null, y.diffuseTexture1 = n ? T.getRes(n) : null,
                    y.diffuseTexture2 = r ? T.getRes(r) : null, y.diffuseTexture3 = a ? T.getRes(a) : null,
                    y.diffuseTexture4 = s ? T.getRes(s) : null, y.setDiffuseScale1(u, c), y.setDiffuseScale2(d, _),
                    y.setDiffuseScale3(f, p), y.setDiffuseScale4(m, g), y.setDetailNum(t), 0 != this._render._renderElements.length && (y.renderMode = 2);
                var v = new At();
                v.setTransform(this._transform), v.render = this._render, v.setGeometry(this._terrainFilter),
                    this._render._renderElements.push(v), this._render.sharedMaterial = y;
            }, i._cloneTo = function (t, e, i) {
                console.log("Terrain Chunk can't clone");
            }, i.destroy = function (e) {
                void 0 === e && (e = !0), this.destroyed || (t.prototype.destroy.call(this, e),
                    this._terrainFilter.destroy(), this._terrainFilter = null);
            }, a(0, i, "terrainFilter", function () {
                return this._terrainFilter;
            }), a(0, i, "terrainRender", function () {
                return this._render;
            }), e;
        }(Qi), wn = function (t) {
            function e(t, i, n) {
                this._updateViewMatrix = !0, this._offScreenRenderTexture = null, this._alwaysUseRenderTexture = !1,
                    this._renderTexture = null, this._postProcess = null, this.enableRender = !0, this._screenShaderData = new ut(),
                    this._postProcessCommandBuffers = [], void 0 === t && (t = 0), void 0 === i && (i = .3),
                    void 0 === n && (n = 1e3), this._viewMatrix = new ze(), this._projectionMatrix = new ze(),
                    this._projectionViewMatrix = new ze(), this._projectionViewMatrixNoTranslateScale = new ze(),
                    this._viewport = new we(0, 0, 0, 0), this._normalizedViewport = new we(0, 0, 1, 1),
                    this._aspectRatio = t, this._boundFrustum = new Le(ze.DEFAULT), I.supportWebGLPlusCulling && (this._boundFrustumBuffer = new Float32Array(24)),
                    e.__super.call(this, i, n), this.transform.on("transformchanged", this, this._onTransformChanged);
            }
            r(e, "laya.d3.core.Camera", t);
            var s = e.prototype;
            return s._isLayerVisible = function (t) {
                return 0 != (Math.pow(2, t) & this.cullingMask);
            }, s._onTransformChanged = function (t) {
                (t &= 64) && (this._updateViewMatrix = !0);
            }, s._calculationViewport = function (t, e, i) {

                var n = t.x * e, r = t.y * i, a = n + Math.max(t.width * e, 0),
                    s = r + Math.max(t.height * i, 0), o = Math.ceil(n),
                    l = Math.ceil(r), h = Math.floor(a),
                    u = Math.floor(s), c = o - n >= .5 ? Math.floor(n) : o, d = l - r >= .5 ? Math.floor(r) : l, _ = a - h >= .5 ?
                        Math.ceil(a) : h, f = s - u >= .5 ? Math.ceil(s) : u;
                this._viewport.x = c, this._viewport.y = d,
                    this._viewport.width = _ - c,
                    this._viewport.height = f - d;
            }, s._parse = function (e, i) {
                t.prototype._parse.call(this, e, i);
                var n = e.viewport;
                this.normalizedViewport = new we(n[0], n[1], n[2], n[3]);
            }, s._calculateProjectionMatrix = function () {
                if (!this._useUserProjectionMatrix)
                    console.log("this._orthographic", this._orthographic)
                if (this._orthographic) {
                    var t = this.orthographicVerticalSize * this.aspectRatio * .5,
                        e = .5 * this.orthographicVerticalSize;
                    ze.createOrthoOffCenter(-t, t, -e, e, this.nearPlane, this.farPlane, this._projectionMatrix);
                } else {
                    console.log(" this.aspectRatio", (3.1416 * this.fieldOfView / 180), this._projectionMatrix)
                    ze.createPerspective(3.1416 * this.fieldOfView / 180, this.aspectRatio, this.nearPlane, this.farPlane, this._projectionMatrix);
                }

            }, s._getCanvasHeight = function () {
                return this._offScreenRenderTexture ? this._offScreenRenderTexture.height : J.clientHeight;
            }, s._applyPostProcessCommandBuffers = function () {
                for (var t = 0, e = this._postProcessCommandBuffers.length; t < e; t++) this._postProcessCommandBuffers[t]._apply();
            }, s._needForceSetRenderTexture = function () {
                return this._alwaysUseRenderTexture && !this._offScreenRenderTexture;
            }, s.render = function (t, e) {
                if (this._scene) {
                    var i = this._needForceSetRenderTexture();
                    i && (this._renderTexture = mn.getTemporary(J.clientWidth, J.clientHeight, 0, 0, 1));
                    var n, r, a = v.instance, s = J._instance, o = s.scene = this._scene;
                    if (o.parallelSplitShadowMaps[0]) {
                        ut.setRuntimeValueMode(!1);
                        var l = o.parallelSplitShadowMaps[0];
                        l._calcAllLightCameraInfo(this), o._defineDatas.add(Zi.SHADERDEFINE_CAST_SHADOW);
                        for (var h = 0, u = l.shadowMapCount; h < u; h++) {
                            var c = l.cameras[h];
                            s.camera = c, s.projectionViewMatrix = c.projectionViewMatrix, Ne.renderObjectCulling(c, o, s, o._castShadowRenders);
                            var d = l.cameras[h + 1].renderTarget;
                            d._start(), s.camera = c, s.viewport = c.viewport, c._prepareCameraToRender(), c._prepareCameraViewProject(c.viewMatrix, c.projectionMatrix, s.projectionViewMatrix, c._projectionViewMatrixNoTranslateScale),
                                o._clear(a, s), o._opaqueQueue._render(s, !1), d._end();
                        }
                        o._defineDatas.remove(Zi.SHADERDEFINE_CAST_SHADOW), ut.setRuntimeValueMode(!0);
                    }
                    s.camera = this, o._preRenderScript(), n = s.viewMatrix = this.viewMatrix;
                    var _ = this._renderTexture;
                    if (_ ? (_._start(), ze.multiply(an._invertYScaleMatrix, this._projectionMatrix, an._invertYProjectionMatrix),
                        ze.multiply(an._invertYScaleMatrix, this.projectionViewMatrix, an._invertYProjectionViewMatrix),
                        r = s.projectionMatrix = an._invertYProjectionMatrix, s.projectionViewMatrix = an._invertYProjectionViewMatrix) : (r = s.projectionMatrix = this._projectionMatrix,
                            s.projectionViewMatrix = this.projectionViewMatrix), s.viewport = this.viewport,
                        this._prepareCameraToRender(), this._prepareCameraViewProject(n, r, s.projectionViewMatrix, this._projectionViewMatrixNoTranslateScale),
                        o._preCulling(s, this), o._clear(a, s), o._renderScene(a, s, t, e), o._postRenderScript(),
                        _ && _._end(), this._postProcess && this._postProcess._render(), i) {
                        var f = ii.create(this._renderTexture, null, le.screenShader, this._screenShaderData);
                        f.run(), f.recover(), mn.setReleaseTemporary(this._renderTexture);
                    }
                }
            }, s.viewportPointToRay = function (t, e) {
                ce.calculateCursorRay(t, this.viewport, this._projectionMatrix, this.viewMatrix, null, e);
            }, s.normalizedViewportPointToRay = function (t, i) {
                var n = e._tempVector20, r = this.viewport;
                n.x = t.x * r.width, n.y = t.y * r.height, ce.calculateCursorRay(n, this.viewport, this._projectionMatrix, this.viewMatrix, null, i);
            }, s.worldToViewportPoint = function (t, e) {
                ze.multiply(this._projectionMatrix, this._viewMatrix, this._projectionViewMatrix),
                    this.viewport.project(t, this._projectionViewMatrix, e), e.x = e.x / i.stage.clientScaleX,
                    e.y = e.y / i.stage.clientScaleY;
            }, s.worldToNormalizedViewportPoint = function (t, e) {
                ze.multiply(this._projectionMatrix, this._viewMatrix, this._projectionViewMatrix),
                    this.normalizedViewport.project(t, this._projectionViewMatrix, e), e.x = e.x / i.stage.clientScaleX,
                    e.y = e.y / i.stage.clientScaleY;
            }, s.convertScreenCoordToOrthographicCoord = function (t, e) {
                if (this._orthographic) {
                    var i = J.clientWidth, n = J.clientHeight, r = this.orthographicVerticalSize * this.aspectRatio / i, a = this.orthographicVerticalSize / n;
                    return e.x = (-i / 2 + t.x) * r, e.y = (n / 2 - t.y) * a, e.z = (this.nearPlane - this.farPlane) * (t.z + 1) / 2 - this.nearPlane,
                        gt.transformCoordinate(e, this.transform.worldMatrix, e), !0;
                }
                return !1;
            }, s.destroy = function (e) {
                void 0 === e && (e = !0), this._offScreenRenderTexture = null, this.transform.off("transformchanged", this, this._onTransformChanged),
                    t.prototype.destroy.call(this, e);
            }, s.addCommandBuffer = function (t, e) {
                switch (t) {
                    case 0:
                        this._postProcessCommandBuffers.push(e);
                        break;

                    default:
                        throw "Camera:unknown event.";
                }
            }, s.removeCommandBuffer = function (t, e) {
                switch (t) {
                    case 0:
                        var i = this._postProcessCommandBuffers.indexOf(e);
                        -1 !== i && this._postProcessCommandBuffers.splice(i, 1);
                        break;

                    default:
                        throw "Camera:unknown event.";
                }
            }, s.removeCommandBuffers = function (t) {
                switch (t) {
                    case 0:
                        this._postProcessCommandBuffers.length = 0;
                        break;

                    default:
                        throw "Camera:unknown event.";
                }
            }, s.getRenderTexture = function () {
                return this._renderTexture;
            }, a(0, s, "renderTarget", function () {
                return this._offScreenRenderTexture;
            }, function (t) {
                this._offScreenRenderTexture !== t && (this._offScreenRenderTexture = t, this._renderTexture = t,
                    this._calculateProjectionMatrix());
            }), a(0, s, "projectionViewMatrix", function () {
                return ze.multiply(this.projectionMatrix, this.viewMatrix, this._projectionViewMatrix),
                    this._projectionViewMatrix;
            }), a(0, s, "aspectRatio", function () {
                if (0 === this._aspectRatio) {
                    var t = this.viewport;
                    return t.width / t.height;
                }
                return this._aspectRatio;
            }, function (t) {
                if (t < 0) throw new Error("Camera: the aspect ratio has to be a positive real number.");
                this._aspectRatio = t, this._calculateProjectionMatrix();
            }), a(0, s, "boundFrustum", function () {
                if (this._boundFrustum.matrix = this.projectionViewMatrix, I.supportWebGLPlusCulling) {
                    var t = this._boundFrustum.near, e = this._boundFrustum.far, i = this._boundFrustum.left, n = this._boundFrustum.right, r = this._boundFrustum.top, a = this._boundFrustum.bottom, s = t.normal, o = e.normal, l = i.normal, h = n.normal, u = r.normal, c = a.normal, d = this._boundFrustumBuffer;
                    d[0] = s.x, d[1] = s.y, d[2] = s.z, d[3] = t.distance, d[4] = o.x, d[5] = o.y, d[6] = o.z,
                        d[7] = e.distance, d[8] = l.x, d[9] = l.y, d[10] = l.z, d[11] = i.distance, d[12] = h.x,
                        d[13] = h.y, d[14] = h.z, d[15] = n.distance, d[16] = u.x, d[17] = u.y, d[18] = u.z,
                        d[19] = r.distance, d[20] = c.x, d[21] = c.y, d[22] = c.z, d[23] = a.distance;
                }
                return this._boundFrustum;
            }), a(0, s, "viewport", function () {


                //aabbcc
                return this._offScreenRenderTexture ?
                    this._calculationViewport(this._normalizedViewport, this._offScreenRenderTexture.width, this._offScreenRenderTexture.height) :
                    this._calculationViewport(this._normalizedViewport, J.clientWidth, J.clientHeight),
                    this._viewport;
            }, function (t) {
                var e = 0, i = 0;
                this._offScreenRenderTexture ? (e = this._offScreenRenderTexture.width, i = this._offScreenRenderTexture.height) : (e = J.clientWidth,
                    i = J.clientHeight), this._normalizedViewport.x = t.x / e, this._normalizedViewport.y = t.y / i,
                    this._normalizedViewport.width = t.width / e, this._normalizedViewport.height = t.height / i,
                    this._calculationViewport(this._normalizedViewport, e, i), this._calculateProjectionMatrix();
            }), a(0, s, "alwaysUseRenderTexture", function () {
                return this._alwaysUseRenderTexture;
            }, function (t) {
                this._alwaysUseRenderTexture = t;
            }), a(0, s, "normalizedViewport", function () {
                return this._normalizedViewport;
            }, function (t) {
                var e = 0, i = 0;
                this._offScreenRenderTexture ? (e = this._offScreenRenderTexture.width, i = this._offScreenRenderTexture.height) : (e = J.clientWidth,
                    i = J.clientHeight), this._normalizedViewport !== t && t.cloneTo(this._normalizedViewport),
                    this._calculationViewport(t, e, i), this._calculateProjectionMatrix();
            }), a(0, s, "projectionMatrix", function () {
                return this._projectionMatrix;
            }, function (t) {
                this._projectionMatrix = t, this._useUserProjectionMatrix = !0;
            }), a(0, s, "viewMatrix", function () {
                if (this._updateViewMatrix) {
                    var t = this.transform.scale, e = t.x, i = t.y, n = t.z, r = this._viewMatrix.elements;
                    this.transform.worldMatrix.cloneTo(this._viewMatrix), r[0] /= e, r[1] /= e, r[2] /= e,
                        r[4] /= i, r[5] /= i, r[6] /= i, r[8] /= n, r[9] /= n, r[10] /= n, this._viewMatrix.invert(this._viewMatrix),
                        this._updateViewMatrix = !1;
                }
                return this._viewMatrix;
            }), a(0, s, "postProcess", function () {
                return this._postProcess;
            }, function (t) {
                this._postProcess = t, this.alwaysUseRenderTexture = !0;
                var e = new le();
                this.addCommandBuffer(0, e), t._init(this, e);
            }), e.CAMERAEVENT_POSTPROCESS = 0, e._updateMark = 0, n(e, ["_tempVector20", function () {
                return this._tempVector20 = new yt();
            }]), e;
        }(an);
        !function (t) {
            function e(t, i, n) {
                this._minX = NaN, this._minZ = NaN, this._cellSize = null, this._heightMap = null,
                    e.__super.call(this, t, n), this._heightMap = i, this._cellSize = new yt();
            }
            r(e, "laya.d3.core.MeshTerrainSprite3D", t);
            var i = e.prototype;
            i._disableRotation = function () {
                var t = this.transform.rotation;
                t.x = 0, t.y = 0, t.z = 0, t.w = 1, this.transform.rotation = t;
            }, i._getScaleX = function () {
                var t = this.transform.worldMatrix.elements, e = t[0], i = t[1], n = t[2];
                return Math.sqrt(e * e + i * i + n * n);
            }, i._getScaleZ = function () {
                var t = this.transform.worldMatrix.elements, e = t[8], i = t[9], n = t[10];
                return Math.sqrt(e * e + i * i + n * n);
            }, i._initCreateFromMesh = function (t, e) {
                this._heightMap = Gt.creatFromMesh(this.meshFilter.sharedMesh, t, e, this._cellSize);
                var i = this.meshFilter.sharedMesh.bounds, n = i.getMin();
                i.getMax();
                this._minX = n.x, this._minZ = n.z;
            }, i._initCreateFromMeshHeightMap = function (t, e, i) {
                var n = this.meshFilter.sharedMesh.bounds;
                this._heightMap = Gt.createFromImage(t, e, i), this._computeCellSize(n);
                var r = n.getMin();
                n.getMax();
                this._minX = r.x, this._minZ = r.z;
            }, i._computeCellSize = function (t) {
                var e = t.getMin(), i = t.getMax(), n = e.x, r = e.z, a = i.x - n, s = i.z - r;
                this._cellSize.x = a / (this._heightMap.width - 1), this._cellSize.y = s / (this._heightMap.height - 1);
            }, i._update = function (t) {
                this._disableRotation();
            }, i.getHeight = function (t, i) {
                e._tempVector3.x = t, e._tempVector3.y = 0, e._tempVector3.z = i, this._disableRotation();
                var n = this.transform.worldMatrix;
                n.invert(e._tempMatrix4x4), gt.transformCoordinate(e._tempVector3, e._tempMatrix4x4, e._tempVector3),
                    t = e._tempVector3.x, i = e._tempVector3.z;
                var r = (t - this._minX) / this._cellSize.x, a = (i - this._minZ) / this._cellSize.y, s = Math.floor(a), o = Math.floor(r), l = r - o, h = a - s, u = n.elements, c = u[4], d = u[5], _ = u[6], f = Math.sqrt(c * c + d * d + _ * _), p = u[13], m = this._heightMap.getHeight(s, o + 1), g = this._heightMap.getHeight(s + 1, o);
                if (isNaN(m) || isNaN(g)) return NaN;
                if (l + h <= 1) {
                    var y = this._heightMap.getHeight(s, o);
                    return isNaN(y) ? NaN : (y + l * (m - y) + h * (g - y)) * f + p;
                }
                var v = this._heightMap.getHeight(s + 1, o + 1);
                return isNaN(v) ? NaN : (v + (1 - l) * (g - v) + (1 - h) * (m - v)) * f + p;
            }, a(0, i, "minX", function () {
                var t = this.transform.worldMatrix.elements;
                return this._minX * this._getScaleX() + t[12];
            }), a(0, i, "width", function () {
                return (this._heightMap.width - 1) * this._cellSize.x * this._getScaleX();
            }), a(0, i, "minZ", function () {
                var t = this.transform.worldMatrix.elements;
                return this._minZ * this._getScaleZ() + t[14];
            }), a(0, i, "depth", function () {
                return (this._heightMap.height - 1) * this._cellSize.y * this._getScaleZ();
            }), e.createFromMesh = function (t, i, n, r) {
                var a = new e(t, null, r);
                return a._initCreateFromMesh(i, n), a;
            }, e.createFromMeshAndHeightMap = function (t, i, n, r, a) {
                var s = new e(t, null, a);
                return s._initCreateFromMeshHeightMap(i, n, r), s;
            }, n(e, ["_tempVector3", function () {
                return this._tempVector3 = new gt();
            }, "_tempMatrix4x4", function () {
                return this._tempMatrix4x4 = new ze();
            }]);
        }(yn);
    }(window, document, Laya);
}, function (t, e) {
    !function (t, e, i) {
        i.un, i.uns;
        var n = i.static, r = i.class, a = i.getset, s = (i.__newvec, laya.utils.Browser), o = laya.utils.ClassUtils, l = (laya.resource.Context,
            laya.events.Event, laya.display.Graphics, laya.utils.HTMLChar), h = laya.utils.Handler, u = laya.net.Loader, c = laya.utils.Pool, d = laya.maths.Rectangle, _ = laya.display.Sprite, f = laya.display.Text, p = laya.resource.Texture, m = laya.net.URL, g = laya.utils.Utils;
        i.interface("laya.html.utils.ILayout");
        var y = function () {
            function t() {
                this.rec = new d(), this.reset();
            }
            r(t, "laya.html.dom.HTMLHitRect");
            var e = t.prototype;
            return e.reset = function () {
                return this.rec.reset(), this.href = null, this;
            }, e.recover = function () {
                c.recover("HTMLHitRect", this.reset());
            }, t.create = function () {
                return c.getItemByClass("HTMLHitRect", t);
            }, t;
        }(), v = function () {
            function t() {
                this.x = 0, this.y = 0, this.w = 0, this.h = 0, this.wordStartIndex = 0, this.minTextHeight = 99999,
                    this.mWidth = 0, this.elements = new Array();
            }
            return r(t, "laya.html.utils.LayoutLine"), t.prototype.updatePos = function (t, e, i, n, r, a, s) {
                var o, l = 0;
                this.elements.length > 0 && (l = (o = this.elements[this.elements.length - 1]).x + o.width - this.elements[0].x),
                    s = s || this.h;
                var h = 0, u = NaN;
                "center" === r && (h = (e - l) / 2), "right" === r && (h = e - l);
                for (var c = 0, d = this.elements.length; c < d; c++) {
                    var _ = (o = this.elements[c])._getCSSStyle();
                    switch (0 !== h && (o.x += h), _.valign) {
                        case "top":
                            o.y = n;
                            break;

                        case "middle":
                            var f = 0;
                            99999 != this.minTextHeight && (f = this.minTextHeight);
                            var p = (f + s) / 2;
                            p = Math.max(p, this.h), u = (laya.html.dom.HTMLImageElement, n + p - o.height),
                                o.y = u;
                            break;

                        case "bottom":
                            o.y = n + (s - o.height);
                    }
                }
            }, t;
        }(), S = function () {
            function t() {
                this.all = new Array(), this.styleSheets = E.styleSheets;
            }
            r(t, "laya.html.dom.HTMLDocument");
            var e = t.prototype;
            return e.getElementById = function (t) {
                return this.all[t];
            }, e.setElementById = function (t, e) {
                this.all[t] = e;
            }, n(t, ["document", function () {
                return this.document = new t();
            }]), t;
        }(), T = function () {
            function t() { }
            return r(t, "laya.html.utils.Layout"), t.later = function (e) {
                null == t._will && (t._will = [], i.stage.frameLoop(1, null, function () {
                    if (!(t._will.length < 1)) {
                        for (var e = 0; e < t._will.length; e++) laya.html.utils.Layout.layout(t._will[e]);
                        t._will.length = 0;
                    }
                })), t._will.push(e);
            }, t.layout = function (e) {
                return e && e._style ? 0 == (512 & e._style._type) ? null : (e.style._type &= -513,
                    t._multiLineLayout(e)) : null;
            }, t._multiLineLayout = function (e) {
                var i = new Array();
                e._addChildsToLayout(i);
                var n, r, a, s, o, l = 0, h = i.length, u = e._getCSSStyle(), c = u.letterSpacing, d = u.leading, _ = u.lineHeight, f = u._widthAuto() || !u.wordWrap, p = f ? 999999 : e.width, m = (e.height,
                    0), g = u.italic ? u.fontSize / 3 : 0, y = u.align, S = u.valign, T = "top" !== S || "left" !== y || 0 != _, E = 0, C = 0, x = 0, b = 0, I = new Array(), w = I[0] = new v(), A = !1, R = !1;
                w.h = 0, u.italic && (p -= u.fontSize / 3);
                var M = 0, D = !0;
                function O() {
                    w.y = C, C += w.h + d, w.mWidth = M, M = 0, w = new v(), I.push(w), w.h = 0, E = 0,
                        D = !0, A = !1;
                }
                for (l = 0; l < h; l++) if (null != (n = i[l])) if (D = !1, n instanceof laya.html.dom.HTMLBrElement) O(),
                    w.y = C, w.h = _; else {
                    if (n._isChar()) {
                        if ((s = n).isWord) A = R || "\n" === s.char, w.wordStartIndex = w.elements.length; else {
                            if (I.length > 0 && E + x > p && w.wordStartIndex > 0) {
                                var L;
                                L = w.elements.length - w.wordStartIndex + 1, w.elements.length = w.wordStartIndex,
                                    l -= L, O();
                                continue;
                            }
                            A = !1, M += s.width;
                        }
                        x = s.width + s.style.letterSpacing, b = s.height, R = !1, (A = A || E + x > p) && O(),
                            w.minTextHeight = Math.min(w.minTextHeight, n.height);
                    } else r = n._getCSSStyle(), o = n, a = r.padding, A = R || r.getLineElement(),
                        x = o.width + a[1] + a[3] + r.letterSpacing, b = o.height + a[0] + a[2], R = r.getLineElement(),
                        (A = A || E + x > p && r.wordWrap) && O();
                    w.elements.push(n), w.h = Math.max(w.h, b), n.x = E, n.y = C, E += x, w.w = E - c,
                        w.y = C, m = Math.max(E + g, m);
                } else D || (E += t.DIV_ELEMENT_PADDING), w.wordStartIndex = w.elements.length;
                if (C = w.y + w.h, T) {
                    var P = 0, N = p;
                    for (f && e.width > 0 && (N = e.width), l = 0, h = I.length; l < h; l++) I[l].updatePos(0, N, l, P, y, S, _),
                        P += Math.max(_, I[l].h + d);
                    C = P;
                }
                return f && (e.width = m), C > e.height && (e.height = C), [m, C];
            }, t.DIV_ELEMENT_PADDING = 0, t._will = null, t;
        }(), E = (function () {
            function t() { }
            r(t, "laya.html.dom.HTMLBrElement");
            var e = t.prototype;
            e._addToLayout = function (t) {
                t.push(this);
            }, e.reset = function () {
                return this;
            }, e.destroy = function () {
                c.recover(x.getClassName(this), this.reset());
            }, e._setParent = function (t) { }, e._getCSSStyle = function () {
                return t.brStyle || (t.brStyle = new E(), t.brStyle.setLineElement(!0), t.brStyle.block = !0),
                    t.brStyle;
            }, e.renderSelfToGraphic = function (t, e, i, n) { }, a(0, e, "URI", null, function (t) { }),
                a(0, e, "parent", null, function (t) { }), a(0, e, "href", null, function (t) { }),
                t.brStyle = null;
        }(), function () {
            function t() {
                this.padding = t._PADDING, this.reset();
            }
            r(t, "laya.html.utils.HTMLStyle");
            var e = t.prototype;
            return e._getExtendStyle = function () {
                return this._extendStyle === C.EMPTY && (this._extendStyle = C.create()), this._extendStyle;
            }, e.reset = function () {
                return this.ower = null, this._type = 0, this.wordWrap = !0, this.fontSize = f.defaultFontSize,
                    this.family = f.defaultFont, this.color = "#000000", this.valign = "top", this.padding = t._PADDING,
                    this.bold = !1, this.italic = !1, this.align = "left", this.textDecoration = null,
                    this.bgColor = null, this.borderColor = null, this._extendStyle && this._extendStyle.recover(),
                    this._extendStyle = C.EMPTY, this;
            }, e.recover = function () {
                c.recover("HTMLStyle", this.reset());
            }, e.inherit = function (e) {
                var i, n, r, a = 0;
                for (i = (n = t._inheritProps).length, a = 0; a < i; a++) this[r = n[a]] = e[r];
            }, e._widthAuto = function () {
                return 0 != (262144 & this._type);
            }, e.widthed = function (t) {
                return 0 != (8 & this._type);
            }, e._calculation = function (t, e) {
                return !1;
            }, e.heighted = function (t) {
                return 0 != (8192 & this._type);
            }, e.size = function (t, e) {
                var i = this.ower, n = !1;
                -1 !== t && t != i.width && (this._type |= 8, i.width = t, n = !0), -1 !== e && e != i.height && (this._type |= 8192,
                    i.height = e, n = !0), n && i._layoutLater();
            }, e.getLineElement = function () {
                return 0 != (65536 & this._type);
            }, e.setLineElement = function (t) {
                t ? this._type |= 65536 : this._type &= -65537;
            }, e._enableLayout = function () {
                return 0 == (2 & this._type) && 0 == (4 & this._type);
            }, e.cssText = function (e) {
                this.attrs(t.parseOneCSS(e, ";"));
            }, e.attrs = function (t) {
                if (t) for (var e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    this[n[0]] = n[1];
                }
            }, a(0, e, "font", function () {
                return (this.italic ? "italic " : "") + (this.bold ? "bold " : "") + this.fontSize + "px " + (s.onIPhone && f.fontFamilyMap[this.family] || this.family);
            }, function (t) {
                for (var e = t.split(" "), i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    switch (r) {
                        case "italic":
                            this.italic = !0;
                            continue;

                        case "bold":
                            this.bold = !0;
                            continue;
                    }
                    r.indexOf("px") > 0 && (this.fontSize = parseInt(r), this.family = e[i + 1], i++);
                }
            }), a(0, e, "href", function () {
                return this._extendStyle.href;
            }, function (t) {
                t !== this._extendStyle.href && (this._getExtendStyle().href = t);
            }), a(0, e, "lineHeight", function () {
                return this._extendStyle.lineHeight;
            }, function (t) {
                this._extendStyle.lineHeight !== t && (this._getExtendStyle().lineHeight = t);
            }), a(0, e, "strokeColor", function () {
                return this._extendStyle.strokeColor;
            }, function (t) {
                this._extendStyle.strokeColor !== t && (this._getExtendStyle().strokeColor = t);
            }), a(0, e, "stroke", function () {
                return this._extendStyle.stroke;
            }, function (t) {
                this._extendStyle.stroke !== t && (this._getExtendStyle().stroke = t);
            }), a(0, e, "leading", function () {
                return this._extendStyle.leading;
            }, function (t) {
                this._extendStyle.leading !== t && (this._getExtendStyle().leading = t);
            }), a(0, e, "align", function () {
                var e = 48 & this._type;
                return t.align_Value[e];
            }, function (e) {
                e in t.alignVDic && (this._type &= -49, this._type |= t.alignVDic[e]);
            }), a(0, e, "valign", function () {
                var e = 192 & this._type;
                return t.vAlign_Value[e];
            }, function (e) {
                e in t.alignVDic && (this._type &= -193, this._type |= t.alignVDic[e]);
            }), a(0, e, "block", function () {
                return 0 != (1 & this._type);
            }, function (t) {
                t ? this._type |= 1 : this._type &= -2;
            }), a(0, e, "wordWrap", function () {
                return 0 == (131072 & this._type);
            }, function (t) {
                t ? this._type &= -131073 : this._type |= 131072;
            }), a(0, e, "bold", function () {
                return 0 != (1024 & this._type);
            }, function (t) {
                t ? this._type |= 1024 : this._type &= -1025;
            }), a(0, e, "italic", function () {
                return 0 != (2048 & this._type);
            }, function (t) {
                t ? this._type |= 2048 : this._type &= -2049;
            }), a(0, e, "whiteSpace", function () {
                return 131072 & this._type ? "nowrap" : "";
            }, function (t) {
                "nowrap" === t && (this._type |= 131072), "none" === t && (this._type &= -131073);
            }), a(0, e, "width", null, function (t) {
                if (this._type |= 8, "string" == typeof t) {
                    var e = t.indexOf("auto");
                    if (e >= 0 && (this._type |= 262144, t = t.substr(0, e)), this._calculation("width", t)) return;
                    t = parseInt(t);
                }
                this.size(t, -1);
            }), a(0, e, "height", null, function (t) {
                if (this._type |= 8192, "string" == typeof t) {
                    if (this._calculation("height", t)) return;
                    t = parseInt(t);
                }
                this.size(-1, t);
            }), a(0, e, "letterSpacing", function () {
                return this._extendStyle.letterSpacing;
            }, function (t) {
                "string" == typeof t && (t = parseInt(t + "")), t != this._extendStyle.letterSpacing && (this._getExtendStyle().letterSpacing = t);
            }), a(0, e, "position", function () {
                return 4 & this._type ? "absolute" : "";
            }, function (t) {
                "absolute" === t ? this._type |= 4 : this._type &= -5;
            }), a(0, e, "absolute", function () {
                return 0 != (4 & this._type);
            }), a(0, e, "paddingLeft", function () {
                return this.padding[3];
            }), a(0, e, "paddingTop", function () {
                return this.padding[0];
            }), t.create = function () {
                return c.getItemByClass("HTMLStyle", t);
            }, t.parseOneCSS = function (e, i) {
                for (var n, r = [], a = e.split(i), s = 0, o = a.length; s < o; s++) {
                    var l = a[s], h = l.indexOf(":"), u = l.substr(0, h).replace(/^\s+|\s+$/g, "");
                    if (0 !== u.length) {
                        var c = l.substr(h + 1).replace(/^\s+|\s+$/g, ""), d = [u, c];
                        switch (u) {
                            case "italic":
                            case "bold":
                                d[1] = "true" == c;
                                break;

                            case "font-weight":
                                "bold" == c && (d[1] = !0, d[0] = "bold");
                                break;

                            case "line-height":
                                d[0] = "lineHeight", d[1] = parseInt(c);
                                break;

                            case "font-size":
                                d[0] = "fontSize", d[1] = parseInt(c);
                                break;

                            case "stroke":
                                d[0] = "stroke", d[1] = parseInt(c);
                                break;

                            case "padding":
                                (n = c.split(" ")).length > 1 || (n[1] = n[2] = n[3] = n[0]), d[1] = [parseInt(n[0]), parseInt(n[1]), parseInt(n[2]), parseInt(n[3])];
                                break;

                            default:
                                (d[0] = t._CSSTOVALUE[u]) || (d[0] = u);
                        }
                        r.push(d);
                    }
                }
                return r;
            }, t.parseCSS = function (e, i) {
                for (var n; null != (n = t._parseCSSRegExp.exec(e));) t.styleSheets[n[1]] = t.parseOneCSS(n[2], ";");
            }, t._CSSTOVALUE = {
                "letter-spacing": "letterSpacing",
                "white-space": "whiteSpace",
                "line-height": "lineHeight",
                "font-family": "family",
                "vertical-align": "valign",
                "text-decoration": "textDecoration",
                "background-color": "bgColor",
                "border-color": "borderColor"
            }, t._parseCSSRegExp = new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}", "g"), t.ALIGN_LEFT = "left",
                t.ALIGN_CENTER = "center", t.ALIGN_RIGHT = "right", t.VALIGN_TOP = "top", t.VALIGN_MIDDLE = "middle",
                t.VALIGN_BOTTOM = "bottom", t.styleSheets = {}, t.ADDLAYOUTED = 512, t._PADDING = [0, 0, 0, 0],
                t._HEIGHT_SET = 8192, t._LINE_ELEMENT = 65536, t._NOWARP = 131072, t._WIDTHAUTO = 262144,
                t._BOLD = 1024, t._ITALIC = 2048, t._CSS_BLOCK = 1, t._DISPLAY_NONE = 2, t._ABSOLUTE = 4,
                t._WIDTH_SET = 8, t._ALIGN = 48, t._VALIGN = 192, n(t, ["_inheritProps", function () {
                    return this._inheritProps = ["italic", "align", "valign", "leading", "stroke", "strokeColor", "bold", "fontSize", "lineHeight", "wordWrap", "color"];
                }, "alignVDic", function () {
                    return this.alignVDic = {
                        left: 0,
                        center: 16,
                        right: 32,
                        top: 0,
                        middle: 64,
                        bottom: 128
                    };
                }, "align_Value", function () {
                    return this.align_Value = {
                        0: "left",
                        16: "center",
                        32: "right"
                    };
                }, "vAlign_Value", function () {
                    return this.vAlign_Value = {
                        0: "top",
                        64: "middle",
                        128: "bottom"
                    };
                }]), t;
        }()), C = function () {
            function t() {
                this.reset();
            }
            r(t, "laya.html.utils.HTMLExtendStyle");
            var e = t.prototype;
            return e.reset = function () {
                return this.stroke = 0, this.strokeColor = "#000000", this.leading = 0, this.lineHeight = 0,
                    this.letterSpacing = 0, this.href = null, this;
            }, e.recover = function () {
                this != t.EMPTY && c.recover("HTMLExtendStyle", this.reset());
            }, t.create = function () {
                return c.getItemByClass("HTMLExtendStyle", t);
            }, t.EMPTY = new t(), t;
        }(), x = function () {
            function t() {
                this._creates(), this.reset();
            }
            r(t, "laya.html.dom.HTMLElement");
            var e = t.prototype;
            return e._creates = function () {
                this._style = E.create();
            }, e.reset = function () {
                if (this.URI = null, this.parent = null, this._style.reset(), this._style.ower = this,
                    this._style.valign = "middle", this._text && this._text.words) {
                    var e, i, n = this._text.words, r = 0;
                    for (e = n.length, r = 0; r < e; r++) (i = n[r]) && i.recover();
                }
                return this._text = t._EMPTYTEXT, this._children && (this._children.length = 0),
                    this._x = this._y = this._width = this._height = 0, this;
            }, e._getCSSStyle = function () {
                return this._style;
            }, e._addChildsToLayout = function (t) {
                var e = this._getWords();
                if (null == e && (!this._children || 0 == this._children.length)) return !1;
                if (e) for (var i = 0, n = e.length; i < n; i++) t.push(e[i]);
                return this._children && this._children.forEach(function (e, i, n) {
                    var r = e._style;
                    r._enableLayout && r._enableLayout() && e._addToLayout(t);
                }), !0;
            }, e._addToLayout = function (t) {
                if (this._style) {
                    var e = this._style;
                    e.absolute || (e.block ? t.push(this) : this._addChildsToLayout(t) && (this.x = this.y = 0));
                }
            }, e.repaint = function (t) {
                void 0 === t && (t = !1), this.parentRepaint(t);
            }, e.parentRepaint = function (t) {
                void 0 === t && (t = !1), this.parent && this.parent.repaint(t);
            }, e._setParent = function (t) {
                if (t instanceof laya.html.dom.HTMLElement) {
                    var e = t;
                    this.URI || (this.URI = e.URI), this.style && this.style.inherit(e.style);
                }
            }, e.appendChild = function (t) {
                return this.addChild(t);
            }, e.addChild = function (t) {
                return t.parent && t.parent.removeChild(t), this._children || (this._children = []),
                    this._children.push(t), t.parent = this, t._setParent(this), this.repaint(), t;
            }, e.removeChild = function (t) {
                if (!this._children) return null;
                var e, i = 0;
                for (e = this._children.length, i = 0; i < e; i++) if (this._children[i] == t) return this._children.splice(i, 1),
                    t;
                return null;
            }, e.destroy = function () {
                this._children && (this.destroyChildren(), this._children.length = 0), c.recover(t.getClassName(this), this.reset());
            }, e.destroyChildren = function () {
                if (this._children) {
                    for (var t = this._children.length - 1; t > -1; t--) this._children[t].destroy();
                    this._children.length = 0;
                }
            }, e._getWords = function () {
                if (!this._text) return null;
                var t = this._text.text;
                if (!t || 0 === t.length) return null;
                var e, i = this._text.words;
                if (i && i.length === t.length) return i;
                null === i && (this._text.words = i = []), i.length = t.length;
                for (var n = this.style, r = n.font, a = 0, s = t.length; a < s; a++) e = g.measureText(t.charAt(a), r),
                    i[a] = l.create().setData(t.charAt(a), e.width, e.height || n.fontSize, n);
                return i;
            }, e._isChar = function () {
                return !1;
            }, e._layoutLater = function () {
                var t = this.style;
                512 & t._type || (t.widthed(this) && (this._children && this._children.length > 0 || null != this._getWords()) && t.block ? (T.later(this),
                    t._type |= 512) : this.parent && this.parent._layoutLater());
            }, e._setAttributes = function (t, e) {
                switch (t) {
                    case "style":
                        this.style.cssText(e);
                        break;

                    case "class":
                        this.className = e;
                        break;

                    case "x":
                        this.x = parseFloat(e);
                        break;

                    case "y":
                        this.y = parseFloat(e);
                        break;

                    case "width":
                        this.width = parseFloat(e);
                        break;

                    case "height":
                        this.height = parseFloat(e);
                        break;

                    default:
                        this[t] = e;
                }
            }, e.formatURL = function (e) {
                return this.URI ? t.formatURL1(e, this.URI ? this.URI.path : null) : e;
            }, e.drawToGraphic = function (t, e, i, n) {
                e += this.x, i += this.y;
                var r = this.style;
                r.paddingLeft && (e += r.paddingLeft), r.paddingTop && (i += r.paddingTop), (null != r.bgColor || r.borderColor) && t.drawRect(e, i, this.width, this.height, r.bgColor, r.borderColor, 1),
                    this.renderSelfToGraphic(t, e, i, n);
                var a, s = 0, o = 0;
                if (this._children && this._children.length > 0) for (o = this._children.length,
                    s = 0; s < o; s++) null != (a = this._children[s]).drawToGraphic && a.drawToGraphic(t, e, i, n);
            }, e.renderSelfToGraphic = function (t, e, i, n) {
                var r = this.style, a = this._getWords();
                if (a && (a.length, r)) {
                    var s = r.font, o = r.color;
                    if (r.stroke) {
                        var l = r.stroke;
                        l = parseInt(l);
                        var h = r.strokeColor;
                        t.fillBorderWords(a, e, i, s, o, h, l);
                    } else t.fillWords(a, e, i, s, o);
                    if (this.href) {
                        var u = a[a.length - 1], c = u.y + u.height;
                        if (u.y == a[0].y) {
                            "none" != r.textDecoration && t.drawLine(a[0].x, c, u.x + u.width, c, o, 1);
                            var d = y.create();
                            d.rec.setTo(a[0].x, u.y, u.x + u.width - a[0].x, u.height), d.href = this.href,
                                n.push(d);
                        } else this.workLines(a, t, n);
                    }
                }
            }, e.workLines = function (t, e, i) {
                var n;
                n = "none" != this.style.textDecoration;
                var r, a, s, o = 0;
                if (r = t.length, s = a = t[o], a) {
                    var l;
                    for (o = 1; o < r; o++) (l = t[o]).y != a.y ? (this.createOneLine(a, s, n, e, i),
                        a = l, s = l) : s = l;
                    this.createOneLine(a, s, n, e, i);
                }
            }, e.createOneLine = function (t, e, i, n, r) {
                var a = e.y + e.height;
                i && n.drawLine(t.x, a, e.x + e.width, a, this.color, 1);
                var s = y.create();
                s.rec.setTo(t.x, e.y, e.x + e.width - t.x, e.height), s.href = this.href, r.push(s);
            }, a(0, e, "href", function () {
                return this._style ? this._style.href : null;
            }, function (t) {
                this._style && t != this._style.href && (this._style.href = t, this.repaint());
            }), a(0, e, "color", null, function (t) {
                this.style.color = t;
            }), a(0, e, "id", null, function (t) {
                S.document.setElementById(t, this);
            }), a(0, e, "innerTEXT", function () {
                return this._text.text;
            }, function (e) {
                this._text === t._EMPTYTEXT ? this._text = {
                    text: e,
                    words: null
                } : (this._text.text = e, this._text.words && (this._text.words.length = 0)), this.repaint();
            }), a(0, e, "style", function () {
                return this._style;
            }), a(0, e, "width", function () {
                return this._width;
            }, function (t) {
                this._width !== t && (this._width = t, this.repaint());
            }), a(0, e, "x", function () {
                return this._x;
            }, function (t) {
                this._x != t && (this._x = t, this.parentRepaint());
            }), a(0, e, "y", function () {
                return this._y;
            }, function (t) {
                this._y != t && (this._y = t, this.parentRepaint());
            }), a(0, e, "height", function () {
                return this._height;
            }, function (t) {
                this._height !== t && (this._height = t, this.repaint());
            }), a(0, e, "className", null, function (t) {
                this.style.attrs(S.document.styleSheets["." + t]);
            }), t.formatURL1 = function (t, e) {
                if (!t) return "null path";
                if (e || (e = m.basePath), t.indexOf(":") > 0) return t;
                if (null != m.customFormat && (t = m.customFormat(t)), t.indexOf(":") > 0) return t;
                var i = t.charAt(0);
                if ("." === i) return m._formatRelativePath(e + t);
                if ("~" === i) return m.rootPath + t.substring(1);
                if ("d" === i) {
                    if (0 === t.indexOf("data:image")) return t;
                } else if ("/" === i) return t;
                return e + t;
            }, t.getClassName = function (t) {
                return "function" == typeof t ? t.name : t.constructor.name;
            }, t._EMPTYTEXT = {
                text: null,
                words: null
            }, t;
        }(), b = function () {
            function t() { }
            return r(t, "laya.html.utils.HTMLParse"), t.getInstance = function (e) {
                var i = c.getItem(t._htmlClassMapShort[e]);
                return i || (i = o.getInstance(e)), i;
            }, t.parse = function (e, i, n) {
                i = (i = "<root>" + (i = i.replace(/<br>/g, "<br/>")) + "</root>").replace(t.spacePattern, t.char255);
                var r = g.parseXMLFromString(i);
                t._parseXML(e, r.childNodes[0].childNodes, n);
            }, t._parseXML = function (e, i, n, r) {
                var a = 0, s = 0;
                if (i.join || i.item) for (a = 0, s = i.length; a < s; ++a) t._parseXML(e, i[a], n, r); else {
                    var o, l, h;
                    if (3 == i.nodeType) return void (e instanceof laya.html.dom.HTMLDivParser ? (null == i.nodeName && (i.nodeName = "#text"),
                        l = i.nodeName.toLowerCase(), (h = i.textContent.replace(/^\s+|\s+$/g, "")).length > 0 && (o = t.getInstance(l)) && (e.addChild(o),
                            o.innerTEXT = h.replace(t.char255AndOneSpacePattern, " "))) : (h = i.textContent.replace(/^\s+|\s+$/g, "")).length > 0 && (e.innerTEXT = h.replace(t.char255AndOneSpacePattern, " ")));
                    if ("#comment" == (l = i.nodeName.toLowerCase())) return;
                    if (o = t.getInstance(l)) {
                        "p" == l ? (e.addChild(t.getInstance("br")), o = e.addChild(o), e.addChild(t.getInstance("br"))) : o = e.addChild(o),
                            o.URI = n, o.href = r;
                        var u = i.attributes;
                        if (u && u.length > 0) for (a = 0, s = u.length; a < s; ++a) {
                            var c = u[a], d = c.nodeName, _ = c.value;
                            o._setAttributes(d, _);
                        }
                        t._parseXML(o, i.childNodes, n, o.href);
                    } else t._parseXML(e, i.childNodes, n, r);
                }
            }, t.char255 = String.fromCharCode(255), t.spacePattern = /&nbsp;|&#160;/g, t.char255AndOneSpacePattern = new RegExp(String.fromCharCode(255) + "|(\\s+)", "g"),
                t._htmlClassMapShort = {
                    div: "HTMLDivParser",
                    p: "HTMLElement",
                    img: "HTMLImageElement",
                    span: "HTMLElement",
                    br: "HTMLBrElement",
                    style: "HTMLStyleElement",
                    font: "HTMLElement",
                    a: "HTMLElement",
                    "#text": "HTMLElement",
                    link: "HTMLLinkElement"
                }, t;
        }(), I = (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.html.dom.HTMLImageElement", t);
            var i = e.prototype;
            i.reset = function () {
                return t.prototype.reset.call(this), this._tex && this._tex.off("loaded", this, this.onloaded),
                    this._tex = null, this._url = null, this;
            }, i.onloaded = function () {
                if (this._style) {
                    var t = this._style;
                    t.widthed(this) || this._tex.width, t.heighted(this) || this._tex.height;
                    t.widthed(this) || this._width == this._tex.width || (this.width = this._tex.width,
                        this.parent && this.parent._layoutLater()), t.heighted(this) || this._height == this._tex.height || (this.height = this._tex.height,
                            this.parent && this.parent._layoutLater()), this.repaint();
                }
            }, i._addToLayout = function (t) {
                !this._style.absolute && t.push(this);
            }, i.renderSelfToGraphic = function (t, e, i, n) {
                this._tex && t.drawImage(this._tex, e, i, this.width || this._tex.width, this.height || this._tex.height);
            }, a(0, i, "src", null, function (t) {
                if (t = this.formatURL(t), this._url !== t) {
                    this._url = t;
                    var e = this._tex = u.getRes(t);
                    e || (this._tex = e = new p(), e.load(t), u.cacheRes(t, e)), e.getIsReady() ? this.onloaded() : e.once("ready", this, this.onloaded);
                }
            });
        }(x), function (t) {
            function e() {
                this.contextHeight = NaN, this.contextWidth = NaN, this._htmlBounds = null, this._boundsRec = null,
                    this.repaintHandler = null, e.__super.call(this);
            }
            r(e, "laya.html.dom.HTMLDivParser", t);
            var n = e.prototype;
            return n.reset = function () {
                return t.prototype.reset.call(this), this._style.block = !0, this._style.setLineElement(!0),
                    this._style.width = 200, this._style.height = 200, this.repaintHandler = null, this.contextHeight = 0,
                    this.contextWidth = 0, this;
            }, n.appendHTML = function (t) {
                b.parse(this, t, this.URI), this.layout();
            }, n._addChildsToLayout = function (t) {
                var e = this._getWords();
                if (null == e && (!this._children || 0 == this._children.length)) return !1;
                e && e.forEach(function (e) {
                    t.push(e);
                });
                for (var i = !0, n = 0, r = this._children.length; n < r; n++) {
                    var a = this._children[n];
                    i ? i = !1 : t.push(null), a._addToLayout(t);
                }
                return !0;
            }, n._addToLayout = function (t) {
                this.layout(), !this.style.absolute && t.push(this);
            }, n.getBounds = function () {
                return this._htmlBounds ? (this._boundsRec || (this._boundsRec = d.create()), this._boundsRec.copyFrom(this._htmlBounds)) : null;
            }, n.parentRepaint = function (e) {
                void 0 === e && (e = !1), t.prototype.parentRepaint.call(this), this.repaintHandler && this.repaintHandler.runWith(e);
            }, n.layout = function () {
                this.style._type |= 512;
                var t = T.layout(this);
                if (t) {
                    this._htmlBounds || (this._htmlBounds = d.create());
                    var e = this._htmlBounds;
                    e.x = e.y = 0, e.width = this.contextWidth = t[0], e.height = this.contextHeight = t[1];
                }
            }, a(0, n, "height", function () {
                return this._height ? this._height : this.contextHeight;
            }, t.prototype._$set_height), a(0, n, "innerHTML", null, function (t) {
                this.destroyChildren(), this.appendHTML(t);
            }), a(0, n, "width", function () {
                return this._width ? this._width : this.contextWidth;
            }, function (t) {
                var e = !1;
                e = 0 === t ? t != this._width : t != this.width, i.superSet(x, this, "width", t),
                    e && this.layout();
            }), e;
        }(x));
        (function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.html.dom.HTMLLinkElement", t);
            var i = e.prototype;
            i._creates = function () { }, i.drawToGraphic = function (t, e, i, n) { }, i.reset = function () {
                return this._loader && this._loader.off("complete", this, this._onload), this._loader = null,
                    this;
            }, i._onload = function (t) {
                switch (this._loader && (this._loader = null), this.type) {
                    case "text/css":
                        E.parseCSS(t, this.URI);
                }
                this.repaint(!0);
            }, a(0, i, "href", t.prototype._$get_href, function (t) {
                t && (t = this.formatURL(t), this.URI = new m(t), this._loader && this._loader.off("complete", this, this._onload),
                    u.getRes(t) ? "text/css" == this.type && E.parseCSS(u.getRes(t), this.URI) : (this._loader = new u(),
                        this._loader.once("complete", this, this._onload), this._loader.load(t, "text")));
            }), e._cuttingStyle = new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{", "g");
        })(x), function (t) {
            function e() {
                e.__super.call(this);
            }
            r(e, "laya.html.dom.HTMLStyleElement", t);
            var i = e.prototype;
            i._creates = function () { }, i.drawToGraphic = function (t, e, i, n) { }, i.reset = function () {
                return this;
            }, a(0, i, "innerTEXT", t.prototype._$get_innerTEXT, function (t) {
                E.parseCSS(t, null);
            });
        }(x), function (t) {
            function e() {
                e.__super.call(this), this._element._getCSSStyle().valign = "middle";
            }
            r(e, "laya.html.dom.HTMLIframeElement", t);
            var i = e.prototype;
            a(0, i, "href", null, function (t) {
                var e = this;
                t = this._element.formatURL(t);
                var i = new u();
                i.once("complete", null, function (i) {
                    var n = e._element.URI;
                    e._element.URI = new m(t), e.innerHTML = i, !n || (e._element.URI = n);
                }), i.load(t, "text");
            });
        }(function (t) {
            function e() {
                this._element = null, this._recList = [], this._innerHTML = null, this._repaintState = 0,
                    e.__super.call(this), this._element = new I(), this._element.repaintHandler = new h(this, this._htmlDivRepaint),
                    this.mouseEnabled = !0, this.on("click", this, this._onMouseClick);
            }
            r(e, "laya.html.dom.HTMLDivElement", t);
            var i = e.prototype;
            return i.destroy = function (e) {
                void 0 === e && (e = !0), this._element && this._element.reset(), this._element = null,
                    this._doClears(), t.prototype.destroy.call(this, e);
            }, i._htmlDivRepaint = function (t) {
                void 0 === t && (t = !1), t ? this._repaintState < 2 && (this._repaintState = 2) : this._repaintState < 1 && (this._repaintState = 1),
                    this._repaintState > 0 && this._setGraphicDirty();
            }, i._updateGraphicWork = function () {
                switch (this._repaintState) {
                    case 1:
                        this._updateGraphic();
                        break;

                    case 2:
                        this._refresh();
                }
            }, i._setGraphicDirty = function () {
                this.callLater(this._updateGraphicWork);
            }, i._doClears = function () {
                if (this._recList) {
                    var t = 0, e = this._recList.length;
                    for (t = 0; t < e; t++) this._recList[t].recover();
                    this._recList.length = 0;
                }
            }, i._updateGraphic = function () {
                this._doClears(), this.graphics.clear(!0), this._repaintState = 0, this._element.drawToGraphic(this.graphics, -this._element.x, -this._element.y, this._recList);
                var t = this._element.getBounds();
                t && this.setSelfBounds(t), this.size(t.width, t.height);
            }, i._refresh = function () {
                this._repaintState = 1, this._innerHTML && (this._element.innerHTML = this._innerHTML),
                    this._setGraphicDirty();
            }, i._onMouseClick = function () {
                var t, e, i = this.mouseX, n = this.mouseY, r = 0;
                for (t = this._recList.length, r = 0; r < t; r++) (e = this._recList[r]).rec.contains(i, n) && this._eventLink(e.href);
            }, i._eventLink = function (t) {
                this.event("link", [t]);
            }, a(0, i, "style", function () {
                return this._element.style;
            }), a(0, i, "innerHTML", null, function (t) {
                this._innerHTML != t && (this._repaintState = 1, this._innerHTML = t, this._element.innerHTML = t,
                    this._setGraphicDirty());
            }), a(0, i, "contextWidth", function () {
                return this._element.contextWidth;
            }), a(0, i, "contextHeight", function () {
                return this._element.contextHeight;
            }), e;
        }(_));
    }(window, document, Laya);
}, function (t, e) {
    !function (t, e, i) {
        i.un, i.uns;
        var n = i.static, r = i.class, a = i.getset, s = i.__newvec, o = laya.utils.Browser, l = laya.utils.Byte, h = laya.filters.ColorFilter, u = laya.events.Event, c = laya.events.EventDispatcher, d = (laya.display.Graphics,
            laya.html.dom.HTMLDivElement), _ = laya.utils.Handler, f = laya.utils.HitArea, p = laya.display.Input, m = (laya.net.Loader,
                laya.utils.Log), g = (laya.display.Node, laya.maths.Point), y = laya.maths.Rectangle, v = laya.renders.Render, S = laya.media.SoundManager, T = laya.display.Sprite, E = (laya.display.Stage,
                    laya.display.Text), C = laya.resource.Texture, x = laya.utils.Utils;
        i.interface("fairygui.IUISource"), i.interface("fairygui.gears.IColorGear"), i.interface("fairygui.gears.IAnimationGear");
        var b = function () {
            function t() {
                this.fromPage = null, this.toPage = null;
            }
            r(t, "fairygui.action.ControllerAction");
            var e = t.prototype;
            return e.run = function (t, e, i) {
                null != this.fromPage && 0 != this.fromPage.length && -1 == this.fromPage.indexOf(e) || null != this.toPage && 0 != this.toPage.length && -1 == this.toPage.indexOf(i) ? this.leave(t) : this.enter(t);
            }, e.enter = function (t) { }, e.leave = function (t) { }, e.setup = function (t) {
                var e = 0, i = 0;
                for (e = t.getInt16(), this.fromPage = [], i = 0; i < e; i++) this.fromPage[i] = t.readS();
                for (e = t.getInt16(), this.toPage = [], i = 0; i < e; i++) this.toPage[i] = t.readS();
            }, t.createAction = function (t) {
                switch (t) {
                    case 0:
                        return new ht();

                    case 1:
                        return new lt();
                }
                return null;
            }, t;
        }(), I = function () {
            function t() {
                this._asset = null, this._asset = i.loader;
            }
            r(t, "fairygui.AssetProxy");
            var e = t.prototype;
            return e.getRes = function (t) {
                return this._asset.getRes(t);
            }, e.load = function (t, e, i, n, r, a) {
                void 0 === r && (r = 1), void 0 === a && (a = !0), this._asset.load(t, e, i, n, r, a);
            }, e.setAsset = function (t) {
                this._asset = t;
            }, a(1, t, "inst", function () {
                return null == fairygui.AssetProxy._inst && (t._inst = new t()), fairygui.AssetProxy._inst;
            }), t._inst = null, t;
        }(), w = function () {
            var t;
            function e() {
                this.callback = null, this._itemList = null, this._objectPool = null, this._index = 0,
                    this._itemList = [], this._objectPool = [];
            }
            r(e, "fairygui.AsyncOperation");
            var n = e.prototype;
            return n.createObject = function (t, e) {
                var i = $.getByName(t);
                if (!i) throw new Error("package not found: " + t);
                var n = i.getItemByName(e);
                if (!n) throw new Error("resource not found: " + e);
                this.internalCreateObject(n);
            }, n.createObjectFromURL = function (t) {
                var e = $.getItemByURL(t);
                if (!e) throw new Error("resource not found: " + t);
                this.internalCreateObject(e);
            }, n.cancel = function () {
                if (i.timer.clear(this, this.run), this._itemList.length = 0, this._objectPool.length > 0) {
                    for (var t = this._objectPool.length, e = 0; e < t; e++) this._objectPool[e].dispose();
                    this._objectPool.length = 0;
                }
            }, n.internalCreateObject = function (e) {
                this._itemList.length = 0, this._objectPool.length = 0;
                var n = new t(e, 9);
                n.childCount = this.collectComponentChildren(e), this._itemList.push(n), this._index = 0,
                    i.timer.frameLoop(1, this, this.run);
            }, n.collectComponentChildren = function (e) {
                var i, n, r = e.rawData;
                r.seek(0, 2);
                var a, s = 0, o = 0, l = 0, h = r.getInt16();
                for (s = 0; s < h; s++) {
                    o = r.getInt16(), l = r.pos, r.seek(l, 0);
                    var u = r.readByte(), c = r.readS(), d = r.readS();
                    r.pos = l, null != c ? (n = null != (a = null != d ? $.getById(d) : e.owner) ? a.getItemById(c) : null,
                        i = new t(n, u), null != n && 3 == n.type && (i.childCount = this.collectComponentChildren(n))) : (i = new t(null, u),
                            10 == u && (i.listItemCount = this.collectListChildren(r))), this._itemList.push(i),
                        r.pos = l + o;
                }
                return h;
            }, n.collectListChildren = function (e) {
                e.seek(e.pos, 8);
                var i, n, r, a = 0, s = 0, o = 0, l = e.readS(), h = e.getInt16();
                for (s = 0; s < h; s++) o = e.getInt16(), o += e.pos, null == (i = e.readS()) && (i = l),
                    i && null != (n = $.getItemByURL(i)) && (r = new t(n, n.objectType), 3 == n.type && (r.childCount = this.collectComponentChildren(n)),
                        this._itemList.push(r), a++), e.pos = o;
                return a;
            }, n.run = function () {
                for (var t, e, n = 0, r = 0, a = o.now(), s = Q.frameTimeForAsyncUIConstruction, l = this._itemList.length; this._index < l;) {
                    if (null != (e = this._itemList[this._index]).packageItem) (t = J.newObject(e.packageItem)).packageItem = e.packageItem,
                        this._objectPool.push(t), $._constructing++, 3 == e.packageItem.type ? (n = this._objectPool.length - e.childCount - 1,
                            t.constructFromResource2(this._objectPool, n), this._objectPool.splice(n, e.childCount)) : t.constructFromResource(),
                        $._constructing--; else if (t = J.newObject2(e.type), this._objectPool.push(t),
                            10 == e.type && e.listItemCount > 0) {
                        for (n = this._objectPool.length - e.listItemCount - 1, r = 0; r < e.listItemCount; r++) t.itemPool.returnObject(this._objectPool[r + n]);
                        this._objectPool.splice(n, e.listItemCount);
                    }
                    if (this._index++, this._index % 5 == 0 && o.now() - a >= s) return;
                }
                i.timer.clear(this, this.run);
                var h = this._objectPool[0];
                this._itemList.length = 0, this._objectPool.length = 0, null != this.callback && this.callback.runWith(h);
            }, e.__init$ = function () {
                t = function () {
                    function t(t, e) {
                        this.packageItem = null, this.type = 0, this.childCount = 0, this.listItemCount = 0,
                            this.packageItem = t, this.type = e;
                    }
                    return r(t, ""), t;
                }();
            }, e;
        }(), A = (function () {
            function t() { }
            r(t, "fairygui.AutoSizeType"), t.None = 0, t.Both = 1, t.Height = 2, t.Shrink = 3;
        }(), function () {
            function t() { }
            r(t, "fairygui.ButtonMode"), t.Common = 0, t.Check = 1, t.Radio = 2;
        }(), function () {
            function t() { }
            r(t, "fairygui.ChildrenRenderOrder"), t.Ascent = 0, t.Descent = 1, t.Arch = 2;
        }(), function () {
            function t() {
                this.id = null, this.size = 0, this.ttf = !1, this.glyphs = null, this.resizable = !1,
                    this.glyphs = {};
            }
            return r(t, "fairygui.display.BitmapFont", null, "BitmapFont$1"), t;
        }()), R = function () {
            function t() {
                this.offsetX = 0, this.offsetY = 0, this.width = 0, this.height = 0, this.advance = 0,
                    this.lineHeight = 0, this.channel = 0, this.texture = null;
            }
            return r(t, "fairygui.display.BMGlyph"), t;
        }(), M = function () {
            function t() { }
            return r(t, "fairygui.display.FillUtils"), t.fill = function (t, e, i, n, r, a) {
                if (a <= 0) return null;
                if (a >= .9999) return [0, 0, t, 0, t, e, 0, e];
                var s;
                switch (i) {
                    case 1:
                        s = fairygui.display.FillUtils.fillHorizontal(t, e, n, a);
                        break;

                    case 2:
                        s = fairygui.display.FillUtils.fillVertical(t, e, n, a);
                        break;

                    case 3:
                        s = fairygui.display.FillUtils.fillRadial90(t, e, n, r, a);
                        break;

                    case 4:
                        s = fairygui.display.FillUtils.fillRadial180(t, e, n, r, a);
                        break;

                    case 5:
                        s = fairygui.display.FillUtils.fillRadial360(t, e, n, r, a);
                }
                return s;
            }, t.fillHorizontal = function (t, e, i, n) {
                var r = t * n;
                return 2 == i || 0 == i ? [0, 0, r, 0, r, e, 0, e] : [t, 0, t, e, t - r, e, t - r, 0];
            }, t.fillVertical = function (t, e, i, n) {
                var r = e * n;
                return 2 == i || 0 == i ? [0, 0, 0, r, t, r, t, 0] : [0, e, t, e, t, e - r, 0, e - r];
            }, t.fillRadial90 = function (t, e, i, n, r) {
                (!n || 1 != i && 2 != i) && (n || 0 != i && 3 != i) || (r = 1 - r);
                var a, s, o;
                switch (a = ((s = t * Math.tan(Math.PI / 2 * r)) - e) / s, i) {
                    case 0:
                        o = n ? s <= e ? [0, 0, t, s, t, 0] : [0, 0, t * (1 - a), e, t, e, t, 0] : s <= e ? [0, 0, t, s, t, e, 0, e] : [0, 0, t * (1 - a), e, 0, e];
                        break;

                    case 1:
                        o = n ? s <= e ? [t, 0, 0, s, 0, e, t, e] : [t, 0, t * a, e, t, e] : s <= e ? [t, 0, 0, s, 0, 0] : [t, 0, t * a, e, 0, e, 0, 0];
                        break;

                    case 2:
                        o = n ? s <= e ? [0, e, t, e - s, t, 0, 0, 0] : [0, e, t * (1 - a), 0, 0, 0] : s <= e ? [0, e, t, e - s, t, e] : [0, e, t * (1 - a), 0, t, 0, t, e];
                        break;

                    case 3:
                        o = n ? s <= e ? [t, e, 0, e - s, 0, e] : [t, e, t * a, 0, 0, 0, 0, e] : s <= e ? [t, e, 0, e - s, 0, 0, t, 0] : [t, e, t * a, 0, t, 0];
                }
                return o;
            }, t.movePoints = function (t, e, i) {
                for (var n = t.length, r = 0; r < n; r += 2) t[r] += e, t[r + 1] += i;
            }, t.fillRadial180 = function (e, i, n, r, a) {
                var s;
                switch (n) {
                    case 0:
                        a <= .5 ? (a /= .5, s = t.fillRadial90(e / 2, i, r ? 0 : 1, r, a), r && t.movePoints(s, e / 2, 0)) : (a = (a - .5) / .5,
                            s = t.fillRadial90(e / 2, i, r ? 1 : 0, r, a), r ? s.push(e, i, e, 0) : (t.movePoints(s, e / 2, 0),
                                s.push(0, i, 0, 0)));
                        break;

                    case 1:
                        a <= .5 ? (a /= .5, s = t.fillRadial90(e / 2, i, r ? 3 : 2, r, a), r || t.movePoints(s, e / 2, 0)) : (a = (a - .5) / .5,
                            s = t.fillRadial90(e / 2, i, r ? 2 : 3, r, a), r ? (t.movePoints(s, e / 2, 0), s.push(0, 0, 0, i)) : s.push(e, 0, e, i));
                        break;

                    case 2:
                        a <= .5 ? (a /= .5, s = t.fillRadial90(e, i / 2, r ? 2 : 0, r, a), r || t.movePoints(s, 0, i / 2)) : (a = (a - .5) / .5,
                            s = t.fillRadial90(e, i / 2, r ? 0 : 2, r, a), r ? (t.movePoints(s, 0, i / 2), s.push(e, 0, 0, 0)) : s.push(e, i, 0, i));
                        break;

                    case 3:
                        a <= .5 ? (a /= .5, s = t.fillRadial90(e, i / 2, r ? 1 : 3, r, a), r && t.movePoints(s, 0, i / 2)) : (a = (a - .5) / .5,
                            s = t.fillRadial90(e, i / 2, r ? 3 : 1, r, a), r ? s.push(0, i, e, i) : (t.movePoints(s, 0, i / 2),
                                s.push(0, 0, e, 0)));
                }
                return s;
            }, t.fillRadial360 = function (e, i, n, r, a) {
                var s;
                switch (n) {
                    case 0:
                        a <= .5 ? (a /= .5, s = t.fillRadial180(e / 2, i, r ? 2 : 3, r, a), r && t.movePoints(s, e / 2, 0)) : (a = (a - .5) / .5,
                            s = t.fillRadial180(e / 2, i, r ? 3 : 2, r, a), r ? s.push(e, i, e, 0, e / 2, 0) : (t.movePoints(s, e / 2, 0),
                                s.push(0, i, 0, 0, e / 2, 0)));
                        break;

                    case 1:
                        a <= .5 ? (a /= .5, s = t.fillRadial180(e / 2, i, r ? 3 : 2, r, a), r || t.movePoints(s, e / 2, 0)) : (a = (a - .5) / .5,
                            s = t.fillRadial180(e / 2, i, r ? 2 : 3, r, a), r ? (t.movePoints(s, e / 2, 0),
                                s.push(0, 0, 0, i, e / 2, i)) : s.push(e, 0, e, i, e / 2, i));
                        break;

                    case 2:
                        a <= .5 ? (a /= .5, s = t.fillRadial180(e, i / 2, r ? 1 : 0, r, a), r || t.movePoints(s, 0, i / 2)) : (a = (a - .5) / .5,
                            s = t.fillRadial180(e, i / 2, r ? 0 : 1, r, a), r ? (t.movePoints(s, 0, i / 2),
                                s.push(e, 0, 0, 0, 0, i / 2)) : s.push(e, i, 0, i, 0, i / 2));
                        break;

                    case 3:
                        a <= .5 ? (a /= .5, s = t.fillRadial180(e, i / 2, r ? 0 : 1, r, a), r && t.movePoints(s, 0, i / 2)) : (a = (a - .5) / .5,
                            s = t.fillRadial180(e, i / 2, r ? 1 : 0, r, a), r ? s.push(0, i, e, i, e, i / 2) : (t.movePoints(s, 0, i / 2),
                                s.push(0, 0, e, 0, e, i / 2)));
                }
                return s;
            }, t;
        }(), D = function () {
            function t() {
                this.addDelay = 0, this.texture = null;
            }
            return r(t, "fairygui.display.Frame"), t;
        }(), O = (function () {
            function t() {
                this._agent = null, this._sourceData = null, this._agent = new Ct(), this._agent.draggable = !0,
                    this._agent.touchable = !1, this._agent.setSize(100, 100), this._agent.setPivot(.5, .5, !0),
                    this._agent.align = "center", this._agent.verticalAlign = "middle", this._agent.sortingOrder = 1e6,
                    this._agent.on("fui_drag_end", this, this.__dragEnd);
            }
            r(t, "fairygui.DragDropManager");
            var e = t.prototype;
            e.startDrag = function (t, e, n, r) {
                if (void 0 === r && (r = -1), null == this._agent.parent) {
                    this._sourceData = n, this._agent.url = e, Ot.inst.addChild(this._agent);
                    var a = Ot.inst.globalToLocal(i.stage.mouseX, i.stage.mouseY);
                    this._agent.setXY(a.x, a.y), this._agent.startDrag(r);
                }
            }, e.cancel = function () {
                null != this._agent.parent && (this._agent.stopDrag(), Ot.inst.removeChild(this._agent),
                    this._sourceData = null);
            }, e.__dragEnd = function (t) {
                if (null != this._agent.parent) {
                    Ot.inst.removeChild(this._agent);
                    var e = this._sourceData;
                    this._sourceData = null;
                    for (var i = L.cast(t.target); null != i;) {
                        if (i.displayObject.hasListener("fui_drop")) return i.requestFocus(), void i.displayObject.event("fui_drop", [e, O.createEvent("fui_drop", i.displayObject, t)]);
                        i = i.parent;
                    }
                }
            }, a(0, e, "dragAgent", function () {
                return this._agent;
            }), a(0, e, "dragging", function () {
                return null != this._agent.parent;
            }), a(1, t, "inst", function () {
                return null == fairygui.DragDropManager._inst && (fairygui.DragDropManager._inst = new t()),
                    fairygui.DragDropManager._inst;
            }), t._inst = null;
        }(), function () {
            function t() { }
            return r(t, "fairygui.Events"), t.createEvent = function (t, e, i) {
                return fairygui.Events.$event.setTo(t, e, i ? i.target : e), i ? (fairygui.Events.$event.touchId = i.touchId,
                    fairygui.Events.$event.nativeEvent = i.nativeEvent) : fairygui.Events.$event.nativeEvent = null,
                    fairygui.Events.$event._stoped = !1, fairygui.Events.$event;
            }, t.dispatch = function (t, e, i) {
                e.event(t, fairygui.Events.createEvent(t, e, i));
            }, t.STATE_CHANGED = "fui_state_changed", t.XY_CHANGED = "fui_xy_changed", t.SIZE_CHANGED = "fui_size_changed",
                t.SIZE_DELAY_CHANGE = "fui_size_delay_change", t.CLICK_ITEM = "fui_click_item",
                t.SCROLL = "fui_scroll", t.SCROLL_END = "fui_scroll_end", t.DROP = "fui_drop", t.FOCUS_CHANGED = "fui_focus_changed",
                t.DRAG_START = "fui_drag_start", t.DRAG_MOVE = "fui_drag_move", t.DRAG_END = "fui_drag_end",
                t.PULL_DOWN_RELEASE = "fui_pull_down_release", t.PULL_UP_RELEASE = "fui_pull_up_release",
                t.GEAR_STOP = "fui_gear_stop", n(t, ["$event", function () {
                    return this.$event = new u();
                }]), t;
        }()), L = (function () {
            function t() { }
            r(t, "fairygui.FillMethod"), t.None = 0, t.Horizontal = 1, t.Vertical = 2, t.Radial90 = 3,
                t.Radial180 = 4, t.Radial360 = 5;
        }(), function () {
            function t() { }
            r(t, "fairygui.FillOrigin"), t.Top = 0, t.Bottom = 1, t.Left = 2, t.Right = 3, t.TopLeft = 0,
                t.TopRight = 1, t.BottomLeft = 2, t.BottomRight = 3;
        }(), function () {
            function t() { }
            r(t, "fairygui.FlipType"), t.None = 0, t.Horizontal = 1, t.Vertical = 2, t.Both = 3;
        }(), function () {
            function t() {
                this.data = null, this.packageItem = null, this._x = 0, this._y = 0, this._alpha = 1,
                    this._rotation = 0, this._visible = !0, this._touchable = !0, this._grayed = !1,
                    this._draggable = !1, this._scaleX = 1, this._scaleY = 1, this._skewX = 0, this._skewY = 0,
                    this._pivotX = 0, this._pivotY = 0, this._pivotAsAnchor = !1, this._pivotOffsetX = 0,
                    this._pivotOffsetY = 0, this._sortingOrder = 0, this._internalVisible = !0, this._handlingController = !1,
                    this._focusable = !1, this._tooltips = null, this._pixelSnapping = !1, this._relations = null,
                    this._group = null, this._gears = null, this._dragBounds = null, this._displayObject = null,
                    this._yOffset = 0, this.minWidth = 0, this.minHeight = 0, this.maxWidth = 0, this.maxHeight = 0,
                    this.sourceWidth = 0, this.sourceHeight = 0, this.initWidth = 0, this.initHeight = 0,
                    this._parent = null, this._width = 0, this._height = 0, this._rawWidth = 0, this._rawHeight = 0,
                    this._id = null, this._name = null, this._underConstruct = !1, this._gearLocked = !1,
                    this._sizePercentInGroup = 0, this._touchDownPoint = null, this._id = "" + fairygui.GObject._gInstanceCounter++,
                    this._name = "", this.createDisplayObject(), this._relations = new G(this), this._gears = s(8, null);
            }
            r(t, "fairygui.GObject");
            var e = t.prototype;
            return e.setXY = function (e, i) {
                if (this._x != e || this._y != i) {
                    var n = e - this._x, r = i - this._y;
                    this._x = e, this._y = i, this.handleXYChanged(), this instanceof fairygui.GGroup && this.moveChildren(n, r),
                        this.updateGear(1), !this._parent || this._parent instanceof fairygui.GList || (this._parent.setBoundsChangedFlag(),
                            null != this._group && this._group.setBoundsChangedFlag(), this.displayObject.event("fui_xy_changed")),
                        t.draggingObject != this || t.sUpdateInDragging || this.localToGlobalRect(0, 0, this.width, this.height, t.sGlobalRect);
                }
            }, e.center = function (t) {
                var e;
                void 0 === t && (t = !1), e = null != this._parent ? this.parent : this.root, this.setXY((e.width - this.width) / 2, (e.height - this.height) / 2),
                    t && (this.addRelation(e, 3), this.addRelation(e, 10));
            }, e.setSize = function (t, e, i) {
                if (void 0 === i && (i = !1), this._rawWidth != t || this._rawHeight != e) {
                    this._rawWidth = t, this._rawHeight = e, t < this.minWidth && (t = this.minWidth),
                        e < this.minHeight && (e = this.minHeight), this.maxWidth > 0 && t > this.maxWidth && (t = this.maxWidth),
                        this.maxHeight > 0 && e > this.maxHeight && (e = this.maxHeight);
                    var n = t - this._width, r = e - this._height;
                    this._width = t, this._height = e, this.handleSizeChanged(), 0 == this._pivotX && 0 == this._pivotY || (this._pivotAsAnchor ? this.applyPivot() : (i || this.setXY(this.x - this._pivotX * n, this.y - this._pivotY * r),
                        this.updatePivotOffset())), this instanceof fairygui.GGroup && this.resizeChildren(n, r),
                        this.updateGear(2), this._parent && (this._relations.onOwnerSizeChanged(n, r, this._pivotAsAnchor || !i),
                            this._parent.setBoundsChangedFlag(), null != this._group && this._group.setBoundsChangedFlag(!0)),
                        this.displayObject.event("fui_size_changed");
                }
            }, e.ensureSizeCorrect = function () { }, e.setScale = function (t, e) {
                this._scaleX == t && this._scaleY == e || (this._scaleX = t, this._scaleY = e, this.handleScaleChanged(),
                    this.applyPivot(), this.updateGear(2));
            }, e.setSkew = function (t, e) {
                this._skewX == t && this._skewY == e || (this._skewX = t, this._skewY = e, null != this._displayObject && (this._displayObject.skew(-t, e),
                    this.applyPivot()));
            }, e.setPivot = function (t, e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = !1), this._pivotX == t && this._pivotY == e && this._pivotAsAnchor == i || (this._pivotX = t,
                    this._pivotY = e, this._pivotAsAnchor = i, this.updatePivotOffset(), this.handleXYChanged());
            }, e.internalSetPivot = function (t, e, i) {
                this._pivotX = t, this._pivotY = e, this._pivotAsAnchor = i, this._pivotAsAnchor && this.handleXYChanged();
            }, e.updatePivotOffset = function () {
                if (null != this._displayObject) if (!this._displayObject.transform || 0 == this._pivotX && 0 == this._pivotY) this._pivotOffsetX = 0,
                    this._pivotOffsetY = 0; else {
                    fairygui.GObject.sHelperPoint.x = this._pivotX * this._width, fairygui.GObject.sHelperPoint.y = this._pivotY * this._height;
                    var t = this._displayObject.transform.transformPoint(fairygui.GObject.sHelperPoint);
                    this._pivotOffsetX = this._pivotX * this._width - t.x, this._pivotOffsetY = this._pivotY * this._height - t.y;
                }
            }, e.applyPivot = function () {
                0 == this._pivotX && 0 == this._pivotY || (this.updatePivotOffset(), this.handleXYChanged());
            }, e.requestFocus = function () {
                for (var t = this; t && !t._focusable;) t = t.parent;
                null != t && (this.root.focus = t);
            }, e.__rollOver = function (t) {
                i.timer.once(100, this, this.__doShowTooltips);
            }, e.__doShowTooltips = function () {
                this.root && this.root.showTooltips(this._tooltips);
            }, e.__rollOut = function (t) {
                i.timer.clear(this, this.__doShowTooltips), this.root.hideTooltips();
            }, e.getGear = function (t) {
                var e = this._gears[t];
                if (null == e) {
                    switch (t) {
                        case 0:
                            e = new ft(this);
                            break;

                        case 1:
                            e = new Et(this);
                            break;

                        case 2:
                            e = new gt(this);
                            break;

                        case 3:
                            e = new mt(this);
                            break;

                        case 4:
                            e = new _t(this);
                            break;

                        case 5:
                            e = new dt(this);
                            break;

                        case 6:
                            e = new vt(this);
                            break;

                        case 7:
                            e = new pt(this);
                            break;

                        default:
                            throw new Error("FairyGUI: invalid gear index!");
                    }
                    this._gears[t] = e;
                }
                return e;
            }, e.updateGear = function (t) {
                if (!this._underConstruct && !this._gearLocked) {
                    var e = this._gears[t];
                    null != e && null != e.controller && e.updateState();
                }
            }, e.checkGearController = function (t, e) {
                return null != this._gears[t] && this._gears[t].controller == e;
            }, e.updateGearFromRelations = function (t, e, i) {
                null != this._gears[t] && this._gears[t].updateFromRelations(e, i);
            }, e.addDisplayLock = function () {
                var t = this._gears[0];
                if (t && t.controller) {
                    var e = t.addLock();
                    return this.checkGearDisplay(), e;
                }
                return 0;
            }, e.releaseDisplayLock = function (t) {
                var e = this._gears[0];
                e && e.controller && (e.releaseLock(t), this.checkGearDisplay());
            }, e.checkGearDisplay = function () {
                if (!this._handlingController) {
                    var t = null == this._gears[0] || this._gears[0].connected;
                    t != this._internalVisible && (this._internalVisible = t, this._parent && this._parent.childStateChanged(this));
                }
            }, e.addRelation = function (t, e, i) {
                void 0 === i && (i = !1), this._relations.add(t, e, i);
            }, e.removeRelation = function (t, e) {
                void 0 === e && (e = 0), this._relations.remove(t, e);
            }, e.removeFromParent = function () {
                this._parent && this._parent.removeChild(this);
            }, e.dispose = function () {
                i.Tween.clearTween(this), this.removeFromParent(), this._relations.dispose(), this._displayObject.destroy(),
                    this._displayObject = null;
            }, e.onClick = function (t, e, i) {
                this.on("click", t, e, i);
            }, e.offClick = function (t, e) {
                this.off("click", t, e);
            }, e.hasClickListener = function () {
                return this._displayObject.hasListener("click");
            }, e.on = function (t, e, i, n) {
                this._displayObject.on(t, e, i, n);
            }, e.off = function (t, e, i) {
                this._displayObject.off(t, e, i);
            }, e.startDrag = function (t) {
                void 0 === t && (t = -1), null != this._displayObject.stage && this.dragBegin();
            }, e.stopDrag = function () {
                this.dragEnd();
            }, e.localToGlobal = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), this._pivotAsAnchor && (t += this._pivotX * this._width,
                    e += this._pivotY * this._height), i ? (i.x = t, i.y = e, this._displayObject.localToGlobal(i, !1)) : ((i = fairygui.GObject.sHelperPoint).x = t,
                        i.y = e, this._displayObject.localToGlobal(i, !0));
            }, e.globalToLocal = function (t, e, i) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), i ? (i.x = t, i.y = e,
                    this._displayObject.globalToLocal(i, !1)) : ((i = fairygui.GObject.sHelperPoint).x = t,
                        i.y = e, i = this._displayObject.globalToLocal(i, !0)), this._pivotAsAnchor && (i.x -= this._pivotX * this._width,
                            i.y -= this._pivotY * this._height), i;
            }, e.localToGlobalRect = function (t, e, i, n, r) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0),
                    null == r && (r = new y());
                var a = this.localToGlobal(t, e);
                return r.x = a.x, r.y = a.y, a = this.localToGlobal(t + i, e + n), r.width = a.x - r.x,
                    r.height = a.y - r.y, r;
            }, e.globalToLocalRect = function (t, e, i, n, r) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0),
                    null == r && (r = new y());
                var a = this.globalToLocal(t, e);
                return r.x = a.x, r.y = a.y, a = this.globalToLocal(t + i, e + n), r.width = a.x - r.x,
                    r.height = a.y - r.y, r;
            }, e.handleControllerChanged = function (t) {
                this._handlingController = !0;
                for (var e = 0; e < 8; e++) {
                    var i = this._gears[e];
                    null != i && i.controller == t && i.apply();
                }
                this._handlingController = !1, this.checkGearDisplay();
            }, e.createDisplayObject = function () {
                this._displayObject = new T(), this._displayObject.$owner = this;
            }, e.handleXYChanged = function () {
                var t = this._x, e = this._y + this._yOffset;
                this._pivotAsAnchor && (t -= this._pivotX * this._width, e -= this._pivotY * this._height),
                    this._pixelSnapping && (t = Math.round(t), e = Math.round(e)), this._displayObject.pos(t + this._pivotOffsetX, e + this._pivotOffsetY);
            }, e.handleSizeChanged = function () {
                null != this._displayObject && this._displayObject.size(this._width, this._height);
            }, e.handleScaleChanged = function () {
                null != this._displayObject && this._displayObject.scale(this._scaleX, this._scaleY);
            }, e.handleGrayedChanged = function () {
                this._displayObject && (this._grayed ? (null == t.grayFilter && (t.grayFilter = new h([.3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, .3086, .6094, .082, 0, 0, 0, 0, 0, 1, 0])),
                    this._displayObject.filters = [t.grayFilter]) : this._displayObject.filters = null);
            }, e.handleAlphaChanged = function () {
                this._displayObject && (this._displayObject.alpha = this._alpha);
            }, e.handleVisibleChanged = function () {
                this._displayObject && (this._displayObject.visible = this.internalVisible2);
            }, e.constructFromResource = function () { }, e.setup_beforeAdd = function (t, e) {
                t.seek(e, 0), t.skip(5);
                var i = NaN, n = NaN;
                if (this._id = t.readS(), this._name = t.readS(), i = t.getInt32(), n = t.getInt32(),
                    this.setXY(i, n), t.readBool() && (this.initWidth = t.getInt32(), this.initHeight = t.getInt32(),
                        this.setSize(this.initWidth, this.initHeight, !0)), t.readBool() && (this.minWidth = t.getInt32(),
                            this.maxWidth = t.getInt32(), this.minHeight = t.getInt32(), this.maxHeight = t.getInt32()),
                    t.readBool() && (i = t.getFloat32(), n = t.getFloat32(), this.setScale(i, n)), t.readBool() && (i = t.getFloat32(),
                        n = t.getFloat32(), this.setSkew(i, n)), t.readBool() && (i = t.getFloat32(), n = t.getFloat32(),
                            this.setPivot(i, n, t.readBool())), 1 != (i = t.getFloat32()) && (this.alpha = i),
                    0 != (i = t.getFloat32()) && (this.rotation = i), t.readBool() || (this.visible = !1),
                    t.readBool() || (this.touchable = !1), t.readBool() && (this.grayed = !0), 2 == t.readByte() && (this.blendMode = "lighter"),
                    1 == t.readByte()) {
                    var r = new nt();
                    r.adjustBrightness(t.getFloat32()), r.adjustContrast(t.getFloat32()), r.adjustSaturation(t.getFloat32()),
                        r.adjustHue(t.getFloat32());
                    var a = new h(r);
                    this.filters = [a];
                }
                var s = t.readS();
                null != s && (this.data = s);
            }, e.setup_afterAdd = function (t, e) {
                t.seek(e, 1);
                var i = t.readS();
                null != i && (this.tooltips = i);
                var n = t.getInt16();
                n >= 0 && (this.group = this.parent.getChildAt(n)), t.seek(e, 2);
                for (var r = t.getInt16(), a = 0; a < r; a++) {
                    var s = t.getInt16();
                    s += t.pos, this.getGear(t.readByte()).setup(t), t.pos = s;
                }
            }, e.initDrag = function () {
                this._draggable ? this.on("mousedown", this, this.__begin) : this.off("mousedown", this, this.__begin);
            }, e.dragBegin = function () {
                null != fairygui.GObject.draggingObject && fairygui.GObject.draggingObject.stopDrag(),
                    fairygui.GObject.sGlobalDragStart.x = i.stage.mouseX, fairygui.GObject.sGlobalDragStart.y = i.stage.mouseY,
                    this.localToGlobalRect(0, 0, this.width, this.height, fairygui.GObject.sGlobalRect),
                    fairygui.GObject.draggingObject = this, i.stage.on("mousemove", this, this.__moving2),
                    i.stage.on("mouseup", this, this.__end2);
            }, e.dragEnd = function () {
                fairygui.GObject.draggingObject == this && (i.stage.off("mousemove", this, this.__moving2),
                    i.stage.off("mouseup", this, this.__end2), fairygui.GObject.draggingObject = null),
                    fairygui.GObject.sDraggingQuery = !1;
            }, e.reset = function () {
                i.stage.off("mousemove", this, this.__moving), i.stage.off("mouseup", this, this.__end);
            }, e.__begin = function () {
                null == this._touchDownPoint && (this._touchDownPoint = new g()), this._touchDownPoint.x = i.stage.mouseX,
                    this._touchDownPoint.y = i.stage.mouseY, i.stage.on("mousemove", this, this.__moving),
                    i.stage.on("mouseup", this, this.__end);
            }, e.__end = function () {
                this.reset();
            }, e.__moving = function (t) {
                var e = Q.touchDragSensitivity;
                null != this._touchDownPoint && Math.abs(this._touchDownPoint.x - i.stage.mouseX) < e && Math.abs(this._touchDownPoint.y - i.stage.mouseY) < e || (this.reset(),
                    fairygui.GObject.sDraggingQuery = !0, O.dispatch("fui_drag_start", this._displayObject, t),
                    fairygui.GObject.sDraggingQuery && this.dragBegin());
            }, e.__moving2 = function (e) {
                var n = i.stage.mouseX - fairygui.GObject.sGlobalDragStart.x + fairygui.GObject.sGlobalRect.x, r = i.stage.mouseY - fairygui.GObject.sGlobalDragStart.y + fairygui.GObject.sGlobalRect.y;
                if (null != this._dragBounds) {
                    var a = Ot.inst.localToGlobalRect(this._dragBounds.x, this._dragBounds.y, this._dragBounds.width, this._dragBounds.height, fairygui.GObject.sDragHelperRect);
                    (n < a.x || n + fairygui.GObject.sGlobalRect.width > a.right && (n = a.right - fairygui.GObject.sGlobalRect.width) < a.x) && (n = a.x),
                        (r < a.y || r + fairygui.GObject.sGlobalRect.height > a.bottom && (r = a.bottom - fairygui.GObject.sGlobalRect.height) < a.y) && (r = a.y);
                }
                t.sUpdateInDragging = !0;
                var s = this.parent.globalToLocal(n, r, fairygui.GObject.sHelperPoint);
                this.setXY(Math.round(s.x), Math.round(s.y)), t.sUpdateInDragging = !1, O.dispatch("fui_drag_move", this._displayObject, e);
            }, e.__end2 = function (t) {
                fairygui.GObject.draggingObject == this && (this.stopDrag(), O.dispatch("fui_drag_end", this._displayObject, t));
            }, a(0, e, "yMin", function () {
                return this._pivotAsAnchor ? this._y - this._height * this._pivotY : this._y;
            }, function (t) {
                this._pivotAsAnchor ? this.setXY(this._x, t + this._height * this._pivotY) : this.setXY(this._x, t);
            }), a(0, e, "id", function () {
                return this._id;
            }), a(0, e, "name", function () {
                return this._name;
            }, function (t) {
                this._name = t;
            }), a(0, e, "rotation", function () {
                return this._rotation;
            }, function (t) {
                this._rotation != t && (this._rotation = t, null != this._displayObject && (this._displayObject.rotation = this.normalizeRotation,
                    this.applyPivot()), this.updateGear(3));
            }), a(0, e, "width", function () {
                return this.ensureSizeCorrect(), this._relations.sizeDirty && this._relations.ensureRelationsSizeCorrect(),
                    this._width;
            }, function (t) {
                this.setSize(t, this._rawHeight);
            }), a(0, e, "x", function () {
                return this._x;
            }, function (t) {
                this.setXY(t, this._y);
            }), a(0, e, "draggable", function () {
                return this._draggable;
            }, function (t) {
                this._draggable != t && (this._draggable = t, this.initDrag());
            }), a(0, e, "y", function () {
                return this._y;
            }, function (t) {
                this.setXY(this._x, t);
            }), a(0, e, "gearXY", function () {
                return this.getGear(1);
            }), a(0, e, "xMin", function () {
                return this._pivotAsAnchor ? this._x - this._width * this._pivotX : this._x;
            }, function (t) {
                this._pivotAsAnchor ? this.setXY(t + this._width * this._pivotX, this._y) : this.setXY(t, this._y);
            }), a(0, e, "pixelSnapping", function () {
                return this._pixelSnapping;
            }, function (t) {
                this._pixelSnapping != t && (this._pixelSnapping = t, this.handleXYChanged());
            }), a(0, e, "height", function () {
                return this.ensureSizeCorrect(), this._relations.sizeDirty && this._relations.ensureRelationsSizeCorrect(),
                    this._height;
            }, function (t) {
                this.setSize(this._rawWidth, t);
            }), a(0, e, "asButton", function () {
                return this;
            }), a(0, e, "actualWidth", function () {
                return this.width * Math.abs(this._scaleX);
            }), a(0, e, "actualHeight", function () {
                return this.height * Math.abs(this._scaleY);
            }), a(0, e, "blendMode", function () {
                return this._displayObject.blendMode;
            }, function (t) {
                this._displayObject.blendMode = t;
            }), a(0, e, "scaleX", function () {
                return this._scaleX;
            }, function (t) {
                this.setScale(t, this._scaleY);
            }), a(0, e, "scaleY", function () {
                return this._scaleY;
            }, function (t) {
                this.setScale(this._scaleX, t);
            }), a(0, e, "skewX", function () {
                return this._skewX;
            }, function (t) {
                this.setSkew(t, this._skewY);
            }), a(0, e, "pivotAsAnchor", function () {
                return this._pivotAsAnchor;
            }), a(0, e, "skewY", function () {
                return this._skewY;
            }, function (t) {
                this.setSkew(this._skewX, t);
            }), a(0, e, "pivotX", function () {
                return this._pivotX;
            }, function (t) {
                this.setPivot(t, this._pivotY);
            }), a(0, e, "asLoader", function () {
                return this;
            }), a(0, e, "asTextInput", function () {
                return this;
            }), a(0, e, "displayObject", function () {
                return this._displayObject;
            }), a(0, e, "normalizeRotation", function () {
                var t = this._rotation % 360;
                return t > 180 ? t -= 360 : t < -180 && (t = 360 + t), t;
            }), a(0, e, "pivotY", function () {
                return this._pivotY;
            }, function (t) {
                this.setPivot(this._pivotX, t);
            }), a(0, e, "touchable", function () {
                return this._touchable;
            }, function (t) {
                if (this._touchable != t) {
                    if (this._touchable = t, this.updateGear(3), this instanceof fairygui.GImage || this instanceof fairygui.GMovieClip || this instanceof fairygui.GTextField && !(this instanceof fairygui.GTextInput) && !(this instanceof fairygui.GRichTextField)) return;
                    null != this._displayObject && (this._displayObject.mouseEnabled = this._touchable);
                }
            }), a(0, e, "alpha", function () {
                return this._alpha;
            }, function (t) {
                this._alpha != t && (this._alpha = t, this.handleAlphaChanged(), this.updateGear(3));
            }), a(0, e, "grayed", function () {
                return this._grayed;
            }, function (t) {
                this._grayed != t && (this._grayed = t, this.handleGrayedChanged(), this.updateGear(3));
            }), a(0, e, "dragBounds", function () {
                return this._dragBounds;
            }, function (t) {
                this._dragBounds = t;
            }), a(0, e, "asProgress", function () {
                return this;
            }), a(0, e, "enabled", function () {
                return !this._grayed && this._touchable;
            }, function (t) {
                this.grayed = !t, this.touchable = t;
            }), a(0, e, "sortingOrder", function () {
                return this._sortingOrder;
            }, function (t) {
                if (t < 0 && (t = 0), this._sortingOrder != t) {
                    var e = this._sortingOrder;
                    this._sortingOrder = t, null != this._parent && this._parent.childSortingOrderChanged(this, e, this._sortingOrder);
                }
            }), a(0, e, "visible", function () {
                return this._visible;
            }, function (t) {
                this._visible != t && (this._visible = t, this.handleVisibleChanged(), this._parent && this._parent.setBoundsChangedFlag());
            }), a(0, e, "internalVisible", function () {
                return this._internalVisible && (!this._group || this._group.internalVisible) && !this._displayObject._cacheStyle.maskParent;
            }), a(0, e, "icon", function () {
                return null;
            }, function (t) { }), a(0, e, "internalVisible2", function () {
                return this._visible && (!this._group || this._group.internalVisible2);
            }), a(0, e, "asGraph", function () {
                return this;
            }), a(0, e, "gearSize", function () {
                return this.getGear(2);
            }), a(0, e, "focusable", function () {
                return this._focusable;
            }, function (t) {
                this._focusable = t;
            }), a(0, e, "focused", function () {
                return this.root.focus == this;
            }), a(0, e, "tooltips", function () {
                return this._tooltips;
            }, function (t) {
                this._tooltips && (this.off("mouseover", this, this.__rollOver), this.off("mouseout", this, this.__rollOut)),
                    this._tooltips = t, this._tooltips && (this.on("mouseover", this, this.__rollOver),
                        this.on("mouseout", this, this.__rollOut));
            }), a(0, e, "dragging", function () {
                return fairygui.GObject.draggingObject == this;
            }), a(0, e, "group", function () {
                return this._group;
            }, function (t) {
                this._group != t && (null != this._group && this._group.setBoundsChangedFlag(!0),
                    this._group = t, null != this._group && this._group.setBoundsChangedFlag(!0));
            }), a(0, e, "filters", function () {
                return this._displayObject.filters;
            }, function (t) {
                this._displayObject.filters = t;
            }), a(0, e, "inContainer", function () {
                return null != this._displayObject && null != this._displayObject.parent;
            }), a(0, e, "resourceURL", function () {
                return null != this.packageItem ? "ui://" + this.packageItem.owner.id + this.packageItem.id : null;
            }), a(0, e, "onStage", function () {
                return null != this._displayObject && null != this._displayObject.stage;
            }), a(0, e, "root", function () {
                if (this instanceof fairygui.GRoot) return this;
                for (var t = this._parent; t;) {
                    if (t instanceof fairygui.GRoot) return t;
                    t = t.parent;
                }
                return Ot.inst;
            }), a(0, e, "gearLook", function () {
                return this.getGear(3);
            }), a(0, e, "asCom", function () {
                return this;
            }), a(0, e, "relations", function () {
                return this._relations;
            }), a(0, e, "parent", function () {
                return this._parent;
            }, function (t) {
                this._parent = t;
            }), a(0, e, "asLabel", function () {
                return this;
            }), a(0, e, "asImage", function () {
                return this;
            }), a(0, e, "asTextField", function () {
                return this;
            }), a(0, e, "asGroup", function () {
                return this;
            }), a(0, e, "asRichTextField", function () {
                return this;
            }), a(0, e, "asList", function () {
                return this;
            }), a(0, e, "asSlider", function () {
                return this;
            }), a(0, e, "asComboBox", function () {
                return this;
            }), a(0, e, "asMovieClip", function () {
                return this;
            }), a(0, e, "text", function () {
                return null;
            }, function (t) { }), t.cast = function (t) {
                return t.$owner;
            }, t.draggingObject = null, t._gInstanceCounter = 0, t.grayFilter = null, t.sDraggingQuery = !1,
                t.sUpdateInDragging = !1, n(t, ["sGlobalDragStart", function () {
                    return this.sGlobalDragStart = new g();
                }, "sGlobalRect", function () {
                    return this.sGlobalRect = new y();
                }, "sHelperPoint", function () {
                    return this.sHelperPoint = new g();
                }, "sDragHelperRect", function () {
                    return this.sDragHelperRect = new y();
                }]), t;
        }()), P = function () {
            function t(t) {
                this._owner = null, this._controller = null, this._tweenConfig = null, this._owner = t;
            }
            r(t, "fairygui.gears.GearBase");
            var e = t.prototype;
            return e.setup = function (t) {
                this._controller = this._owner.parent.getControllerAt(t.getInt16()), this.init();
                var e, i = 0, n = 0;
                if (this instanceof fairygui.gears.GearDisplay) {
                    i = t.getInt16();
                    var r = [];
                    for (n = 0; n < i; n++) r[n] = t.readS();
                    this.pages = r;
                } else {
                    for (i = t.getInt16(), n = 0; n < i; n++) null != (e = t.readS()) && this.addStatus(e, t);
                    t.readBool() && this.addStatus(null, t);
                }
                t.readBool() && (this._tweenConfig = new N(), this._tweenConfig.easeType = t.readByte(),
                    this._tweenConfig.duration = t.getFloat32(), this._tweenConfig.delay = t.getFloat32());
            }, e.updateFromRelations = function (t, e) { }, e.addStatus = function (t, e) { }, e.init = function () { },
                e.apply = function () { }, e.updateState = function () { }, a(0, e, "controller", function () {
                    return this._controller;
                }, function (t) {
                    t != this._controller && (this._controller = t, this._controller && this.init());
                }), a(0, e, "tweenConfig", function () {
                    return null == this._tweenConfig && (this._tweenConfig = new N()), this._tweenConfig;
                }), t.disableAllTweenEffect = !1, t;
        }(), N = function () {
            function t() {
                this.tween = !1, this.easeType = 0, this.duration = NaN, this.delay = NaN, this._displayLockToken = NaN,
                    this._tweener = null, this.tween = !0, this.easeType = 5, this.duration = .3, this.delay = 0;
            }
            return r(t, "fairygui.gears.GearTweenConfig"), t;
        }(), B = function () {
            function t() {
                this._pool = null, this._count = 0, this._pool = {};
            }
            r(t, "fairygui.GObjectPool");
            var e = t.prototype;
            return e.clear = function () {
                for (var t in this._pool) for (var e = this._pool[t], i = e.length, n = 0; n < i; n++) e[n].dispose();
                this._pool = {}, this._count = 0;
            }, e.getObject = function (t) {
                if (null == (t = $.normalizeURL(t))) return null;
                var e = this._pool[t];
                return null != e && e.length > 0 ? (this._count--, e.shift()) : $.createObjectFromURL(t);
            }, e.returnObject = function (t) {
                var e = t.resourceURL;
                if (e) {
                    var i = this._pool[e];
                    null == i && (i = [], this._pool[e] = i), this._count++, i.push(t);
                }
            }, a(0, e, "count", function () {
                return this._count;
            }), t;
        }(), F = (function () {
            function t() { }
            r(t, "fairygui.GroupLayoutType"), t.None = 0, t.Horizontal = 1, t.Vertical = 2;
        }(), function () {
            function t() { }
            r(t, "fairygui.ListLayoutType"), t.SingleColumn = 0, t.SingleRow = 1, t.FlowHorizontal = 2,
                t.FlowVertical = 3, t.Pagination = 4;
        }(), function () {
            function t() { }
            r(t, "fairygui.ListSelectionMode"), t.Single = 0, t.Multiple = 1, t.Multiple_SingleClick = 2,
                t.None = 3;
        }(), function () {
            function t() { }
            r(t, "fairygui.LoaderFillType"), t.None = 0, t.Scale = 1, t.ScaleMatchHeight = 2,
                t.ScaleMatchWidth = 3, t.ScaleFree = 4, t.ScaleNoBorder = 5;
        }(), function () {
            function t() {
                this.left = 0, this.right = 0, this.top = 0, this.bottom = 0;
            }
            return r(t, "fairygui.Margin"), t.prototype.copy = function (t) {
                this.top = t.top, this.bottom = t.bottom, this.left = t.left, this.right = t.right;
            }, t;
        }()), k = (function () {
            function t() { }
            r(t, "fairygui.ObjectType"), t.Image = 0, t.MovieClip = 1, t.Swf = 2, t.Graph = 3,
                t.Loader = 4, t.Group = 5, t.Text = 6, t.RichText = 7, t.InputText = 8, t.Component = 9,
                t.List = 10, t.Label = 11, t.Button = 12, t.ComboBox = 13, t.ProgressBar = 14, t.Slider = 15,
                t.ScrollBar = 16;
        }(), function () {
            function t() { }
            r(t, "fairygui.OverflowType"), t.Visible = 0, t.Hidden = 1, t.Scroll = 2;
        }(), function () {
            function t() {
                this.owner = null, this.type = 0, this.objectType = 0, this.id = null, this.name = null,
                    this.width = 0, this.height = 0, this.file = null, this.decoded = !1, this.rawData = null,
                    this.scale9Grid = null, this.scaleByTile = !1, this.tileGridIndice = 0, this.smoothing = !1,
                    this.texture = null, this.pixelHitTestData = null, this.interval = 0, this.repeatDelay = 0,
                    this.swing = !1, this.frames = null, this.extensionType = null, this.bitmapFont = null;
            }
            r(t, "fairygui.PackageItem");
            var e = t.prototype;
            return e.load = function () {
                return this.owner.getItemAsset(this);
            }, e.toString = function () {
                return this.name;
            }, t;
        }()), V = (function () {
            function t() { }
            r(t, "fairygui.PackageItemType"), t.Image = 0, t.MovieClip = 1, t.Sound = 2, t.Component = 3,
                t.Atlas = 4, t.Font = 5, t.Swf = 6, t.Misc = 7, t.Unknown = 8;
        }(), function () {
            function t() {
                this._controller = null, this._id = null;
            }
            r(t, "fairygui.PageOption");
            var e = t.prototype;
            return e.clear = function () {
                this._id = null;
            }, a(0, e, "controller", null, function (t) {
                this._controller = t;
            }), a(0, e, "index", function () {
                return this._id ? this._controller.getPageIndexById(this._id) : -1;
            }, function (t) {
                this._id = this._controller.getPageId(t);
            }), a(0, e, "name", function () {
                return this._id ? this._controller.getPageNameById(this._id) : null;
            }, function (t) {
                this._id = this._controller.getPageIdByName(t);
            }), a(0, e, "id", function () {
                return this._id;
            }, function (t) {
                this._id = t;
            }), t;
        }()), U = (function () {
            function t() { }
            r(t, "fairygui.PopupDirection"), t.Auto = 0, t.Up = 1, t.Down = 2;
        }(), function () {
            function t(t) {
                if (this._contentPane = null, this._list = null, !t && !(t = Q.popupMenu)) throw "UIConfig.popupMenu not defined";
                this._contentPane = $.createObjectFromURL(t).asCom, this._contentPane.on("display", this, this.__addedToStage),
                    this._list = this._contentPane.getChild("list"), this._list.removeChildrenToPool(),
                    this._list.addRelation(this._contentPane, 14), this._list.removeRelation(this._contentPane, 15),
                    this._contentPane.addRelation(this._list, 15), this._list.on("fui_click_item", this, this.__clickItem);
            }
            r(t, "fairygui.PopupMenu");
            var e = t.prototype;
            e.dispose = function () {
                this._contentPane.dispose();
            }, e.addItem = function (t, e) {
                var i = this._list.addItemFromPool().asButton;
                i.title = t, i.data = e, i.grayed = !1;
                var n = i.getController("checked");
                return null != n && (n.selectedIndex = 0), i;
            }, e.addItemAt = function (t, e, i) {
                var n = this._list.getFromPool().asButton;
                this._list.addChildAt(n, e), n.title = t, n.data = i, n.grayed = !1;
                var r = n.getController("checked");
                return null != r && (r.selectedIndex = 0), n;
            }, e.addSeperator = function () {
                if (null == Q.popupMenu_seperator) throw "UIConfig.popupMenu_seperator not defined";
                this.list.addItemFromPool(Q.popupMenu_seperator);
            }, e.getItemName = function (t) {
                return this._list.getChildAt(t).name;
            }, e.setItemText = function (t, e) {
                this._list.getChild(t).asButton.title = e;
            }, e.setItemVisible = function (t, e) {
                var i = this._list.getChild(t).asButton;
                i.visible != e && (i.visible = e, this._list.setBoundsChangedFlag());
            }, e.setItemGrayed = function (t, e) {
                this._list.getChild(t).asButton.grayed = e;
            }, e.setItemCheckable = function (t, e) {
                var i = this._list.getChild(t).asButton.getController("checked");
                null != i && (e ? 0 == i.selectedIndex && (i.selectedIndex = 1) : i.selectedIndex = 0);
            }, e.setItemChecked = function (t, e) {
                var i = this._list.getChild(t).asButton.getController("checked");
                null != i && (i.selectedIndex = e ? 2 : 1);
            }, e.isItemChecked = function (t) {
                var e = this._list.getChild(t).asButton.getController("checked");
                return null != e && 2 == e.selectedIndex;
            }, e.removeItem = function (t) {
                var e = this._list.getChild(t);
                if (null != e) {
                    var i = this._list.getChildIndex(e);
                    return this._list.removeChildToPoolAt(i), !0;
                }
                return !1;
            }, e.clearItems = function () {
                this._list.removeChildrenToPool();
            }, e.show = function (t, e) {
                (null != t ? t.root : Ot.inst).showPopup(this.contentPane, t instanceof fairygui.GRoot ? null : t, e);
            }, e.__clickItem = function (t) {
                i.timer.once(100, this, this.__clickItem2, [t]);
            }, e.__clickItem2 = function (t) {
                if (t instanceof fairygui.GButton) if (t.grayed) this._list.selectedIndex = -1; else {
                    var e = t.asCom.getController("checked");
                    null != e && 0 != e.selectedIndex && (1 == e.selectedIndex ? e.selectedIndex = 2 : e.selectedIndex = 1),
                        this._contentPane.parent.hidePopup(this.contentPane), null != t.data && t.data.run();
                }
            }, e.__addedToStage = function () {
                this._list.selectedIndex = -1, this._list.resizeToFit(1e5, 10);
            }, a(0, e, "itemCount", function () {
                return this._list.numChildren;
            }), a(0, e, "contentPane", function () {
                return this._contentPane;
            }), a(0, e, "list", function () {
                return this._list;
            });
        }(), function () {
            function t() { }
            r(t, "fairygui.ProgressTitleType"), t.Percent = 0, t.ValueAndMax = 1, t.Value = 2,
                t.Max = 3;
        }(), function () {
            var t;
            function e(t) {
                this._owner = null, this._target = null, this._defs = null, this._targetX = NaN,
                    this._targetY = NaN, this._targetWidth = NaN, this._targetHeight = NaN, this._owner = t,
                    this._defs = [];
            }
            r(e, "fairygui.RelationItem");
            var i = e.prototype;
            return i.add = function (t, e) {
                if (24 == t) return this.add(14, e), void this.add(15, e);
                for (var i = this._defs.length, n = 0; n < i; n++) if (this._defs[n].type == t) return;
                this.internalAdd(t, e);
            }, i.internalAdd = function (e, i) {
                if (24 == e) return this.internalAdd(14, i), void this.internalAdd(15, i);
                var n = new t();
                n.percent = i, n.type = e, n.axis = e <= 6 || 14 == e || e >= 16 && e <= 19 ? 0 : 1,
                    this._defs.push(n), (i || 1 == e || 3 == e || 5 == e || 8 == e || 10 == e || 12 == e) && (this._owner.pixelSnapping = !0);
            }, i.remove = function (t) {
                if (24 == t) return this.remove(14), void this.remove(15);
                for (var e = this._defs.length, i = 0; i < e; i++) if (this._defs[i].type == t) {
                    this._defs.splice(i, 1);
                    break;
                }
            }, i.copyFrom = function (e) {
                this.target = e.target, this._defs.length = 0;
                for (var i = e._defs.length, n = 0; n < i; n++) {
                    var r = e._defs[n], a = new t();
                    a.copyFrom(r), this._defs.push(a);
                }
            }, i.dispose = function () {
                null != this._target && (this.releaseRefTarget(this._target), this._target = null);
            }, i.applyOnSelfResized = function (t, e, i) {
                var n = this._defs.length;
                if (0 != n) {
                    for (var r = this._owner.x, a = this._owner.y, s = 0; s < n; s++) {
                        switch (this._defs[s].type) {
                            case 3:
                                this._owner.x -= (.5 - (i ? this._owner.pivotX : 0)) * t;
                                break;

                            case 5:
                            case 4:
                            case 6:
                                this._owner.x -= (1 - (i ? this._owner.pivotX : 0)) * t;
                                break;

                            case 10:
                                this._owner.y -= (.5 - (i ? this._owner.pivotY : 0)) * e;
                                break;

                            case 12:
                            case 11:
                            case 13:
                                this._owner.y -= (1 - (i ? this._owner.pivotY : 0)) * e;
                        }
                    }
                    if ((r != this._owner.x || a != this._owner.y) && (r = this._owner.x - r, a = this._owner.y - a,
                        this._owner.updateGearFromRelations(1, r, a), null != this._owner.parent && this._owner.parent._transitions.length > 0)) {
                        n = this._owner.parent._transitions.length;
                        for (var o = 0; o < n; o++) {
                            this._owner.parent._transitions[o].updateFromRelations(this._owner.id, r, a);
                        }
                    }
                }
            }, i.applyOnXYChanged = function (t, e, i) {
                var n = NaN;
                switch (t.type) {
                    case 0:
                    case 1:
                    case 2:
                    case 3:
                    case 4:
                    case 5:
                    case 6:
                        this._owner.x += e;
                        break;

                    case 7:
                    case 8:
                    case 9:
                    case 10:
                    case 11:
                    case 12:
                    case 13:
                        this._owner.y += i;
                        break;

                    case 14:
                    case 15:
                        break;

                    case 16:
                    case 17:
                        n = this._owner.xMin, this._owner.width = this._owner._rawWidth - e, this._owner.xMin = n + e;
                        break;

                    case 18:
                    case 19:
                        n = this._owner.xMin, this._owner.width = this._owner._rawWidth + e, this._owner.xMin = n;
                        break;

                    case 20:
                    case 21:
                        n = this._owner.yMin, this._owner.height = this._owner._rawHeight - i, this._owner.yMin = n + i;
                        break;

                    case 22:
                    case 23:
                        n = this._owner.yMin, this._owner.height = this._owner._rawHeight + i, this._owner.yMin = n;
                }
            }, i.applyOnSizeChanged = function (t) {
                var e = 0, i = 0, n = 0, r = NaN, a = NaN;
                switch (0 == t.axis ? (this._target != this._owner.parent && (e = this._target.x,
                    this._target.pivotAsAnchor && (i = this._target.pivotX)), t.percent ? 0 != this._targetWidth && (n = this._target._width / this._targetWidth) : n = this._target._width - this._targetWidth) : (this._target != this._owner.parent && (e = this._target.y,
                        this._target.pivotAsAnchor && (i = this._target.pivotY)), t.percent ? 0 != this._targetHeight && (n = this._target._height / this._targetHeight) : n = this._target._height - this._targetHeight),
                t.type) {
                    case 0:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin - e) * n : 0 != i && (this._owner.x += n * -i);
                        break;

                    case 1:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin - e) * n : this._owner.x += n * (.5 - i);
                        break;

                    case 2:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin - e) * n : this._owner.x += n * (1 - i);
                        break;

                    case 3:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin + .5 * this._owner._rawWidth - e) * n - .5 * this._owner._rawWidth : this._owner.x += n * (.5 - i);
                        break;

                    case 4:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin + this._owner._rawWidth - e) * n - this._owner._rawWidth : 0 != i && (this._owner.x += n * -i);
                        break;

                    case 5:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin + this._owner._rawWidth - e) * n - this._owner._rawWidth : this._owner.x += n * (.5 - i);
                        break;

                    case 6:
                        t.percent ? this._owner.xMin = e + (this._owner.xMin + this._owner._rawWidth - e) * n - this._owner._rawWidth : this._owner.x += n * (1 - i);
                        break;

                    case 7:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin - e) * n : 0 != i && (this._owner.y += n * -i);
                        break;

                    case 8:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin - e) * n : this._owner.y += n * (.5 - i);
                        break;

                    case 9:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin - e) * n : this._owner.y += n * (1 - i);
                        break;

                    case 10:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin + .5 * this._owner._rawHeight - e) * n - .5 * this._owner._rawHeight : this._owner.y += n * (.5 - i);
                        break;

                    case 11:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin + this._owner._rawHeight - e) * n - this._owner._rawHeight : 0 != i && (this._owner.y += n * -i);
                        break;

                    case 12:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin + this._owner._rawHeight - e) * n - this._owner._rawHeight : this._owner.y += n * (.5 - i);
                        break;

                    case 13:
                        t.percent ? this._owner.yMin = e + (this._owner.yMin + this._owner._rawHeight - e) * n - this._owner._rawHeight : this._owner.y += n * (1 - i);
                        break;

                    case 14:
                        r = this._owner._underConstruct && this._owner == this._target.parent ? this._owner.sourceWidth - this._target.initWidth : this._owner._rawWidth - this._targetWidth,
                            t.percent && (r *= n), this._target == this._owner.parent ? this._owner.pivotAsAnchor ? (a = this._owner.xMin,
                                this._owner.setSize(this._target._width + r, this._owner._rawHeight, !0), this._owner.xMin = a) : this._owner.setSize(this._target._width + r, this._owner._rawHeight, !0) : this._owner.width = this._target._width + r;
                        break;

                    case 15:
                        r = this._owner._underConstruct && this._owner == this._target.parent ? this._owner.sourceHeight - this._target.initHeight : this._owner._rawHeight - this._targetHeight,
                            t.percent && (r *= n), this._target == this._owner.parent ? this._owner.pivotAsAnchor ? (a = this._owner.yMin,
                                this._owner.setSize(this._owner._rawWidth, this._target._height + r, !0), this._owner.yMin = a) : this._owner.setSize(this._owner._rawWidth, this._target._height + r, !0) : this._owner.height = this._target._height + r;
                        break;

                    case 16:
                        a = this._owner.xMin, r = t.percent ? e + (a - e) * n - a : n * -i, this._owner.width = this._owner._rawWidth - r,
                            this._owner.xMin = a + r;
                        break;

                    case 17:
                        a = this._owner.xMin, r = t.percent ? e + (a - e) * n - a : n * (1 - i), this._owner.width = this._owner._rawWidth - r,
                            this._owner.xMin = a + r;
                        break;

                    case 18:
                        a = this._owner.xMin, r = t.percent ? e + (a + this._owner._rawWidth - e) * n - (a + this._owner._rawWidth) : n * -i,
                            this._owner.width = this._owner._rawWidth + r, this._owner.xMin = a;
                        break;

                    case 19:
                        a = this._owner.xMin, t.percent ? this._owner == this._target.parent ? this._owner._underConstruct ? this._owner.width = e + this._target._width - this._target._width * i + (this._owner.sourceWidth - e - this._target.initWidth + this._target.initWidth * i) * n : this._owner.width = e + (this._owner._rawWidth - e) * n : (r = e + (a + this._owner._rawWidth - e) * n - (a + this._owner._rawWidth),
                            this._owner.width = this._owner._rawWidth + r, this._owner.xMin = a) : this._owner == this._target.parent ? this._owner._underConstruct ? this._owner.width = this._owner.sourceWidth + (this._target._width - this._target.initWidth) * (1 - i) : this._owner.width = this._owner._rawWidth + n * (1 - i) : (r = n * (1 - i),
                                this._owner.width = this._owner._rawWidth + r, this._owner.xMin = a);
                        break;

                    case 20:
                        a = this._owner.yMin, r = t.percent ? e + (a - e) * n - a : n * -i, this._owner.height = this._owner._rawHeight - r,
                            this._owner.yMin = a + r;
                        break;

                    case 21:
                        a = this._owner.yMin, r = t.percent ? e + (a - e) * n - a : n * (1 - i), this._owner.height = this._owner._rawHeight - r,
                            this._owner.yMin = a + r;
                        break;

                    case 22:
                        a = this._owner.yMin, r = t.percent ? e + (a + this._owner._rawHeight - e) * n - (a + this._owner._rawHeight) : n * -i,
                            this._owner.height = this._owner._rawHeight + r, this._owner.yMin = a;
                        break;

                    case 23:
                        a = this._owner.yMin, t.percent ? this._owner == this._target.parent ? this._owner._underConstruct ? this._owner.height = e + this._target._height - this._target._height * i + (this._owner.sourceHeight - e - this._target.initHeight + this._target.initHeight * i) * n : this._owner.height = e + (this._owner._rawHeight - e) * n : (r = e + (a + this._owner._rawHeight - e) * n - (a + this._owner._rawHeight),
                            this._owner.height = this._owner._rawHeight + r, this._owner.yMin = a) : this._owner == this._target.parent ? this._owner._underConstruct ? this._owner.height = this._owner.sourceHeight + (this._target._height - this._target.initHeight) * (1 - i) : this._owner.height = this._owner._rawHeight + n * (1 - i) : (r = n * (1 - i),
                                this._owner.height = this._owner._rawHeight + r, this._owner.yMin = a);
                }
            }, i.addRefTarget = function (t) {
                t != this._owner.parent && t.on("fui_xy_changed", this, this.__targetXYChanged),
                    t.on("fui_size_changed", this, this.__targetSizeChanged), t.on("fui_size_delay_change", this, this.__targetSizeWillChange),
                    this._targetX = this._target.x, this._targetY = this._target.y, this._targetWidth = this._target._width,
                    this._targetHeight = this._target._height;
            }, i.releaseRefTarget = function (t) {
                null != t.displayObject && (t.off("fui_xy_changed", this, this.__targetXYChanged),
                    t.off("fui_size_changed", this, this.__targetSizeChanged), t.off("fui_size_delay_change", this, this.__targetSizeWillChange));
            }, i.__targetXYChanged = function (t) {
                if (null != this._owner.relations.handling || null != this._owner.group && this._owner.group._updating) return this._targetX = this._target.x,
                    void (this._targetY = this._target.y);
                this._owner.relations.handling = t;
                for (var e = this._owner.x, i = this._owner.y, n = this._target.x - this._targetX, r = this._target.y - this._targetY, a = this._defs.length, s = 0; s < a; s++) this.applyOnXYChanged(this._defs[s], n, r);
                if (this._targetX = this._target.x, this._targetY = this._target.y, (e != this._owner.x || i != this._owner.y) && (e = this._owner.x - e,
                    i = this._owner.y - i, this._owner.updateGearFromRelations(1, e, i), null != this._owner.parent && this._owner.parent._transitions.length > 0)) {
                    a = this._owner.parent._transitions.length;
                    for (var o = 0; o < a; o++) {
                        this._owner.parent._transitions[o].updateFromRelations(this._owner.id, e, i);
                    }
                }
                this._owner.relations.handling = null;
            }, i.__targetSizeChanged = function (t) {
                if (null != this._owner.relations.handling) return this._targetWidth = this._target._width,
                    void (this._targetHeight = this._target._height);
                this._owner.relations.handling = t;
                for (var e = this._owner.x, i = this._owner.y, n = this._owner._rawWidth, r = this._owner._rawHeight, a = this._defs.length, s = 0; s < a; s++) this.applyOnSizeChanged(this._defs[s]);
                if (this._targetWidth = this._target._width, this._targetHeight = this._target._height,
                    (e != this._owner.x || i != this._owner.y) && (e = this._owner.x - e, i = this._owner.y - i,
                        this._owner.updateGearFromRelations(1, e, i), null != this._owner.parent && this._owner.parent._transitions.length > 0)) {
                    a = this._owner.parent._transitions.length;
                    for (var o = 0; o < a; o++) {
                        this._owner.parent._transitions[o].updateFromRelations(this._owner.id, e, i);
                    }
                }
                n == this._owner._rawWidth && r == this._owner._rawHeight || (n = this._owner._rawWidth - n,
                    r = this._owner._rawHeight - r, this._owner.updateGearFromRelations(2, n, r)), this._owner.relations.handling = null;
            }, i.__targetSizeWillChange = function (t) {
                this._owner.relations.sizeDirty = !0;
            }, a(0, i, "owner", function () {
                return this._owner;
            }), a(0, i, "target", function () {
                return this._target;
            }, function (t) {
                this._target != t && (this._target && this.releaseRefTarget(this._target), this._target = t,
                    this._target && this.addRefTarget(this._target));
            }), a(0, i, "isEmpty", function () {
                return 0 == this._defs.length;
            }), e.__init$ = function () {
                t = function () {
                    function t() {
                        this.percent = !1, this.type = 0, this.axis = 0;
                    }
                    return r(t, ""), t.prototype.copyFrom = function (t) {
                        this.percent = t.percent, this.type = t.type, this.axis = t.axis;
                    }, t;
                }();
            }, e;
        }()), G = function () {
            function t(t) {
                this._owner = null, this._items = null, this.handling = null, this.sizeDirty = !1,
                    this._owner = t, this._items = [];
            }
            r(t, "fairygui.Relations");
            var e = t.prototype;
            return e.add = function (t, e, i) {
                void 0 === i && (i = !1);
                for (var n = this._items.length, r = 0; r < n; r++) {
                    var a = this._items[r];
                    if (a.target == t) return void a.add(e, i);
                }
                var s = new U(this._owner);
                s.target = t, s.add(e, i), this._items.push(s);
            }, e.remove = function (t, e) {
                void 0 === e && (e = 0);
                for (var i = this._items.length, n = 0; n < i;) {
                    var r = this._items[n];
                    r.target == t ? (r.remove(e), r.isEmpty ? (r.dispose(), this._items.splice(n, 1),
                        i--) : n++) : n++;
                }
            }, e.contains = function (t) {
                for (var e = this._items.length, i = 0; i < e; i++) {
                    if (this._items[i].target == t) return !0;
                }
                return !1;
            }, e.clearFor = function (t) {
                for (var e = this._items.length, i = 0; i < e;) {
                    var n = this._items[i];
                    n.target == t ? (n.dispose(), this._items.splice(i, 1), e--) : i++;
                }
            }, e.clearAll = function () {
                for (var t = this._items.length, e = 0; e < t; e++) {
                    this._items[e].dispose();
                }
                this._items.length = 0;
            }, e.copyFrom = function (t) {
                this.clearAll();
                for (var e = t._items, i = e.length, n = 0; n < i; n++) {
                    var r = e[n], a = new U(this._owner);
                    a.copyFrom(r), this._items.push(a);
                }
            }, e.dispose = function () {
                this.clearAll();
            }, e.onOwnerSizeChanged = function (t, e, i) {
                if (0 != this._items.length) for (var n = this._items.length, r = 0; r < n; r++) {
                    this._items[r].applyOnSelfResized(t, e, i);
                }
            }, e.ensureRelationsSizeCorrect = function () {
                if (0 != this._items.length) {
                    this.sizeDirty = !1;
                    for (var t = this._items.length, e = 0; e < t; e++) {
                        this._items[e].target.ensureSizeCorrect();
                    }
                }
            }, e.setup = function (t, e) {
                for (var i, n = t.readByte(), r = 0; r < n; r++) {
                    var a = t.getInt16();
                    i = -1 == a ? this._owner.parent : e ? this._owner.getChildAt(a) : this._owner.parent.getChildAt(a);
                    var s = new U(this._owner);
                    s.target = i, this._items.push(s);
                    for (var o = t.readByte(), l = 0; l < o; l++) {
                        var h = t.readByte(), u = t.readBool();
                        s.internalAdd(h, u);
                    }
                }
            }, a(0, e, "empty", function () {
                return 0 == this._items.length;
            }), t;
        }(), z = (function () {
            function t() { }
            r(t, "fairygui.RelationType"), t.Left_Left = 0, t.Left_Center = 1, t.Left_Right = 2,
                t.Center_Center = 3, t.Right_Left = 4, t.Right_Center = 5, t.Right_Right = 6, t.Top_Top = 7,
                t.Top_Middle = 8, t.Top_Bottom = 9, t.Middle_Middle = 10, t.Bottom_Top = 11, t.Bottom_Middle = 12,
                t.Bottom_Bottom = 13, t.Width = 14, t.Height = 15, t.LeftExt_Left = 16, t.LeftExt_Right = 17,
                t.RightExt_Left = 18, t.RightExt_Right = 19, t.TopExt_Top = 20, t.TopExt_Bottom = 21,
                t.BottomExt_Top = 22, t.BottomExt_Bottom = 23, t.Size = 24;
        }(), function () {
            function t() { }
            r(t, "fairygui.ScrollBarDisplayType"), t.Default = 0, t.Visible = 1, t.Auto = 2,
                t.Hidden = 3;
        }(), function () {
            function t(t) {
                this._owner = null, this._container = null, this._maskContainer = null, this._alignContainer = null,
                    this._scrollType = 0, this._scrollStep = 0, this._mouseWheelStep = 0, this._decelerationRate = NaN,
                    this._scrollBarMargin = null, this._bouncebackEffect = !1, this._touchEffect = !1,
                    this._scrollBarDisplayAuto = !1, this._vScrollNone = !1, this._hScrollNone = !1,
                    this._needRefresh = !1, this._refreshBarAxis = null, this._displayOnLeft = !1, this._snapToItem = !1,
                    this._displayInDemand = !1, this._mouseWheelEnabled = !1, this._pageMode = !1, this._inertiaDisabled = !1,
                    this._xPos = NaN, this._yPos = NaN, this._viewSize = null, this._contentSize = null,
                    this._overlapSize = null, this._pageSize = null, this._containerPos = null, this._beginTouchPos = null,
                    this._lastTouchPos = null, this._lastTouchGlobalPos = null, this._velocity = null,
                    this._velocityScale = NaN, this._lastMoveTime = NaN, this._isHoldAreaDone = !1,
                    this._aniFlag = 0, this._scrollBarVisible = !1, this._loop = 0, this._headerLockedSize = 0,
                    this._footerLockedSize = 0, this._refreshEventDispatching = !1, this._tweening = 0,
                    this._tweenTime = null, this._tweenDuration = null, this._tweenStart = null, this._tweenChange = null,
                    this._pageController = null, this._hzScrollBar = null, this._vtScrollBar = null,
                    this._header = null, this._footer = null, this.isDragged = !1, this._owner = t,
                    this._maskContainer = new T(), this._owner.displayObject.addChild(this._maskContainer),
                    this._container = this._owner._container, this._container.pos(0, 0), this._maskContainer.addChild(this._container),
                    this._scrollBarVisible = !0, this._mouseWheelEnabled = !0, this._xPos = 0, this._yPos = 0,
                    this._aniFlag = 0, this._footerLockedSize = 0, this._headerLockedSize = 0, this._scrollBarMargin = new F(),
                    this._viewSize = new g(), this._contentSize = new g(), this._pageSize = new g(1, 1),
                    this._overlapSize = new g(), this._tweenTime = new g(), this._tweenStart = new g(),
                    this._tweenDuration = new g(), this._tweenChange = new g(), this._velocity = new g(),
                    this._containerPos = new g(), this._beginTouchPos = new g(), this._lastTouchPos = new g(),
                    this._lastTouchGlobalPos = new g(), this._scrollStep = Q.defaultScrollStep, this._mouseWheelStep = 2 * this._scrollStep,
                    this._decelerationRate = Q.defaultScrollDecelerationRate, this._owner.on("mousedown", this, this.__mouseDown),
                    this._owner.on("mousewheel", this, this.__mouseWheel);
            }
            r(t, "fairygui.ScrollPane");
            var e = t.prototype;
            return e.setup = function (t) {
                this._scrollType = t.readByte();
                var e = t.readByte(), i = t.getInt32();
                t.readBool() && (this._scrollBarMargin.top = t.getInt32(), this._scrollBarMargin.bottom = t.getInt32(),
                    this._scrollBarMargin.left = t.getInt32(), this._scrollBarMargin.right = t.getInt32());
                var n = t.readS(), r = t.readS(), a = t.readS(), s = t.readS();
                if (this._displayOnLeft = 0 != (1 & i), this._snapToItem = 0 != (2 & i), this._displayInDemand = 0 != (4 & i),
                    this._pageMode = 0 != (8 & i), this._touchEffect = !!(16 & i) || !(32 & i) && Q.defaultScrollTouchEffect,
                    this._bouncebackEffect = !!(64 & i) || !(128 & i) && Q.defaultScrollBounceEffect,
                    this._inertiaDisabled = 0 != (256 & i), 0 == (512 & i) && (this._maskContainer.scrollRect = new y()),
                    0 == e && (e = Q.defaultScrollBarDisplay), 3 != e) {
                    if (2 == this._scrollType || 1 == this._scrollType) {
                        var o = n || Q.verticalScrollBar;
                        if (o) {
                            if (this._vtScrollBar = $.createObjectFromURL(o), !this._vtScrollBar) throw "cannot create scrollbar from " + o;
                            this._vtScrollBar.setScrollPane(this, !0), this._owner.displayObject.addChild(this._vtScrollBar.displayObject);
                        }
                    }
                    if ((2 == this._scrollType || 0 == this._scrollType) && (o = r || Q.horizontalScrollBar)) {
                        if (this._hzScrollBar = $.createObjectFromURL(o), !this._hzScrollBar) throw "cannot create scrollbar from " + o;
                        this._hzScrollBar.setScrollPane(this, !1), this._owner.displayObject.addChild(this._hzScrollBar.displayObject);
                    }
                    this._scrollBarDisplayAuto = 2 == e, this._scrollBarDisplayAuto && (this._scrollBarVisible = !1,
                        this._vtScrollBar && (this._vtScrollBar.displayObject.visible = !1), this._hzScrollBar && (this._hzScrollBar.displayObject.visible = !1));
                } else this._mouseWheelEnabled = !1;
                if (a && (this._header = $.createObjectFromURL(a), null == this._header)) throw new Error("FairyGUI: cannot create scrollPane header from " + a);
                if (s && (this._footer = $.createObjectFromURL(s), null == this._footer)) throw new Error("FairyGUI: cannot create scrollPane footer from " + s);
                null == this._header && null == this._footer || (this._refreshBarAxis = 2 == this._scrollType || 1 == this._scrollType ? "y" : "x"),
                    this.setSize(this.owner.width, this.owner.height);
            }, e.dispose = function () {
                0 != this._tweening && i.timer.clear(this, this.tweenUpdate), this._pageController = null,
                    null != this._hzScrollBar && this._hzScrollBar.dispose(), null != this._vtScrollBar && this._vtScrollBar.dispose(),
                    null != this._header && this._header.dispose(), null != this._footer && this._footer.dispose();
            }, e.setPercX = function (t, e) {
                void 0 === e && (e = !1), this._owner.ensureBoundsCorrect(), this.setPosX(this._overlapSize.x * et.clamp01(t), e);
            }, e.setPercY = function (t, e) {
                void 0 === e && (e = !1), this._owner.ensureBoundsCorrect(), this.setPosY(this._overlapSize.y * et.clamp01(t), e);
            }, e.setPosX = function (t, e) {
                void 0 === e && (e = !1), this._owner.ensureBoundsCorrect(), 1 == this._loop && (t = this.loopCheckingNewPos(t, "x")),
                    (t = et.clamp(t, 0, this._overlapSize.x)) != this._xPos && (this._xPos = t, this.posChanged(e));
            }, e.setPosY = function (t, e) {
                void 0 === e && (e = !1), this._owner.ensureBoundsCorrect(), 1 == this._loop && (t = this.loopCheckingNewPos(t, "y")),
                    (t = et.clamp(t, 0, this._overlapSize.y)) != this._yPos && (this._yPos = t, this.posChanged(e));
            }, e.setCurrentPageX = function (t, e) {
                this._pageMode && this._overlapSize.x > 0 && this.setPosX(t * this._pageSize.x, e);
            }, e.setCurrentPageY = function (t, e) {
                this._pageMode && this._overlapSize.y > 0 && this.setPosY(t * this._pageSize.y, e);
            }, e.scrollTop = function (t) {
                void 0 === t && (t = !1), this.setPercY(0, t);
            }, e.scrollBottom = function (t) {
                void 0 === t && (t = !1), this.setPercY(1, t);
            }, e.scrollUp = function (t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = !1), this._pageMode ? this.setPosY(this._yPos - this._pageSize.y * t, e) : this.setPosY(this._yPos - this._scrollStep * t, e);
            }, e.scrollDown = function (t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = !1), this._pageMode ? this.setPosY(this._yPos + this._pageSize.y * t, e) : this.setPosY(this._yPos + this._scrollStep * t, e);
            }, e.scrollLeft = function (t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = !1), this._pageMode ? this.setPosX(this._xPos - this._pageSize.x * t, e) : this.setPosX(this._xPos - this._scrollStep * t, e);
            }, e.scrollRight = function (t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = !1), this._pageMode ? this.setPosX(this._xPos + this._pageSize.x * t, e) : this.setPosX(this._xPos + this._scrollStep * t, e);
            }, e.scrollToView = function (t, e, i) {
                var n;
                if (void 0 === e && (e = !1), void 0 === i && (i = !1), this._owner.ensureBoundsCorrect(),
                    this._needRefresh && this.refresh(), t instanceof fairygui.GObject ? t.parent != this._owner ? (t.parent.localToGlobalRect(t.x, t.y, t.width, t.height, fairygui.ScrollPane.sHelperRect),
                        n = this._owner.globalToLocalRect(fairygui.ScrollPane.sHelperRect.x, fairygui.ScrollPane.sHelperRect.y, fairygui.ScrollPane.sHelperRect.width, fairygui.ScrollPane.sHelperRect.height, fairygui.ScrollPane.sHelperRect)) : (n = fairygui.ScrollPane.sHelperRect).setTo(t.x, t.y, t.width, t.height) : n = t,
                    this._overlapSize.y > 0) {
                    var r = this._yPos + this._viewSize.y;
                    i || n.y <= this._yPos || n.height >= this._viewSize.y ? this._pageMode ? this.setPosY(Math.floor(n.y / this._pageSize.y) * this._pageSize.y, e) : this.setPosY(n.y, e) : n.y + n.height > r && (this._pageMode ? this.setPosY(Math.floor(n.y / this._pageSize.y) * this._pageSize.y, e) : n.height <= this._viewSize.y / 2 ? this.setPosY(n.y + 2 * n.height - this._viewSize.y, e) : this.setPosY(n.y + n.height - this._viewSize.y, e));
                }
                if (this._overlapSize.x > 0) {
                    var a = this._xPos + this._viewSize.x;
                    i || n.x <= this._xPos || n.width >= this._viewSize.x ? this._pageMode ? this.setPosX(Math.floor(n.x / this._pageSize.x) * this._pageSize.x, e) : this.setPosX(n.x, e) : n.x + n.width > a && (this._pageMode ? this.setPosX(Math.floor(n.x / this._pageSize.x) * this._pageSize.x, e) : n.width <= this._viewSize.x / 2 ? this.setPosX(n.x + 2 * n.width - this._viewSize.x, e) : this.setPosX(n.x + n.width - this._viewSize.x, e));
                }
                !e && this._needRefresh && this.refresh();
            }, e.isChildInView = function (t) {
                if (this._overlapSize.y > 0) {
                    var e = t.y + this._container.y;
                    if (e < -t.height || e > this._viewSize.y) return !1;
                }
                return !(this._overlapSize.x > 0 && ((e = t.x + this._container.x) < -t.width || e > this._viewSize.x));
            }, e.cancelDragging = function () {
                this._owner.displayObject.stage.off("mousemove", this, this.__mouseMove), this._owner.displayObject.stage.off("mouseup", this, this.__mouseUp),
                    this._owner.displayObject.stage.off("click", this, this.__click), t.draggingPane == this && (t.draggingPane = null),
                    t._gestureFlag = 0, this.isDragged = !1, this._maskContainer.mouseEnabled = !0;
            }, e.lockHeader = function (t) {
                this._headerLockedSize != t && (this._headerLockedSize = t, !this._refreshEventDispatching && this._container[this._refreshBarAxis] >= 0 && (this._tweenStart.setTo(this._container.x, this._container.y),
                    this._tweenChange.setTo(0, 0), this._tweenChange[this._refreshBarAxis] = this._headerLockedSize - this._tweenStart[this._refreshBarAxis],
                    this._tweenDuration.setTo(.3, .3), this._tweenTime.setTo(0, 0), this._tweening = 2,
                    i.timer.frameLoop(1, this, this.tweenUpdate)));
            }, e.lockFooter = function (t) {
                if (this._footerLockedSize != t && (this._footerLockedSize = t, !this._refreshEventDispatching && this._container[this._refreshBarAxis] <= -this._overlapSize[this._refreshBarAxis])) {
                    this._tweenStart.setTo(this._container.x, this._container.y), this._tweenChange.setTo(0, 0);
                    var e = this._overlapSize[this._refreshBarAxis];
                    0 == e ? e = Math.max(this._contentSize[this._refreshBarAxis] + this._footerLockedSize - this._viewSize[this._refreshBarAxis], 0) : e += this._footerLockedSize,
                        this._tweenChange[this._refreshBarAxis] = -e - this._tweenStart[this._refreshBarAxis],
                        this._tweenDuration.setTo(.3, .3), this._tweenTime.setTo(0, 0), this._tweening = 2,
                        i.timer.frameLoop(1, this, this.tweenUpdate);
                }
            }, e.onOwnerSizeChanged = function () {
                this.setSize(this._owner.width, this._owner.height), this.posChanged(!1);
            }, e.handleControllerChanged = function (t) {
                this._pageController == t && (0 == this._scrollType ? this.setCurrentPageX(t.selectedIndex, !0) : this.setCurrentPageY(t.selectedIndex, !0));
            }, e.updatePageController = function () {
                if (null != this._pageController && !this._pageController.changing) {
                    var t = 0;
                    if ((t = 0 == this._scrollType ? this.currentPageX : this.currentPageY) < this._pageController.pageCount) {
                        var e = this._pageController;
                        this._pageController = null, e.selectedIndex = t, this._pageController = e;
                    }
                }
            }, e.adjustMaskContainer = function () {
                var t, e = NaN;
                e = this._displayOnLeft && null != this._vtScrollBar ? Math.floor(this._owner.margin.left + this._vtScrollBar.width) : Math.floor(this._owner.margin.left),
                    t = Math.floor(this._owner.margin.top), this._maskContainer.pos(e, t), 0 != this._owner._alignOffset.x || 0 != this._owner._alignOffset.y ? (null == this._alignContainer && (this._alignContainer = new T(),
                        this._maskContainer.addChild(this._alignContainer), this._alignContainer.addChild(this._container)),
                        this._alignContainer.pos(this._owner._alignOffset.x, this._owner._alignOffset.y)) : this._alignContainer && this._alignContainer.pos(0, 0);
            }, e.setSize = function (t, e) {
                this.adjustMaskContainer(), this._hzScrollBar && (this._hzScrollBar.y = e - this._hzScrollBar.height,
                    this._vtScrollBar && !this._vScrollNone ? (this._hzScrollBar.width = t - this._vtScrollBar.width - this._scrollBarMargin.left - this._scrollBarMargin.right,
                        this._displayOnLeft ? this._hzScrollBar.x = this._scrollBarMargin.left + this._vtScrollBar.width : this._hzScrollBar.x = this._scrollBarMargin.left) : (this._hzScrollBar.width = t - this._scrollBarMargin.left - this._scrollBarMargin.right,
                            this._hzScrollBar.x = this._scrollBarMargin.left)), this._vtScrollBar && (this._displayOnLeft || (this._vtScrollBar.x = t - this._vtScrollBar.width),
                                this._hzScrollBar ? this._vtScrollBar.height = e - this._hzScrollBar.height - this._scrollBarMargin.top - this._scrollBarMargin.bottom : this._vtScrollBar.height = e - this._scrollBarMargin.top - this._scrollBarMargin.bottom,
                                this._vtScrollBar.y = this._scrollBarMargin.top), this._viewSize.x = t, this._viewSize.y = e,
                    this._hzScrollBar && !this._hScrollNone && (this._viewSize.y -= this._hzScrollBar.height),
                    this._vtScrollBar && !this._vScrollNone && (this._viewSize.x -= this._vtScrollBar.width),
                    this._viewSize.x -= this._owner.margin.left + this._owner.margin.right, this._viewSize.y -= this._owner.margin.top + this._owner.margin.bottom,
                    this._viewSize.x = Math.max(1, this._viewSize.x), this._viewSize.y = Math.max(1, this._viewSize.y),
                    this._pageSize.x = this._viewSize.x, this._pageSize.y = this._viewSize.y, this.handleSizeChanged();
            }, e.setContentSize = function (t, e) {
                this._contentSize.x == t && this._contentSize.y == e || (this._contentSize.x = t,
                    this._contentSize.y = e, this.handleSizeChanged());
            }, e.changeContentSizeOnScrolling = function (t, e, i, n) {
                var r = this._xPos == this._overlapSize.x, a = this._yPos == this._overlapSize.y;
                this._contentSize.x += t, this._contentSize.y += e, this.handleSizeChanged(), 1 == this._tweening ? (0 != t && r && this._tweenChange.x < 0 && (this._xPos = this._overlapSize.x,
                    this._tweenChange.x = -this._xPos - this._tweenStart.x), 0 != e && a && this._tweenChange.y < 0 && (this._yPos = this._overlapSize.y,
                        this._tweenChange.y = -this._yPos - this._tweenStart.y)) : 2 == this._tweening ? (0 != i && (this._container.x -= i,
                            this._tweenStart.x -= i, this._xPos = -this._container.x), 0 != n && (this._container.y -= n,
                                this._tweenStart.y -= n, this._yPos = -this._container.y)) : this.isDragged ? (0 != i && (this._container.x -= i,
                                    this._containerPos.x -= i, this._xPos = -this._container.x), 0 != n && (this._container.y -= n,
                                        this._containerPos.y -= n, this._yPos = -this._container.y)) : (0 != t && r && (this._xPos = this._overlapSize.x,
                                            this._container.x = -this._xPos), 0 != e && a && (this._yPos = this._overlapSize.y,
                                                this._container.y = -this._yPos)), this._pageMode && this.updatePageController();
            }, e.handleSizeChanged = function (t) {
                void 0 === t && (t = !1), this._displayInDemand && (this._vtScrollBar && (this._contentSize.y <= this._viewSize.y ? this._vScrollNone || (this._vScrollNone = !0,
                    this._viewSize.x += this._vtScrollBar.width) : this._vScrollNone && (this._vScrollNone = !1,
                        this._viewSize.x -= this._vtScrollBar.width)), this._hzScrollBar && (this._contentSize.x <= this._viewSize.x ? this._hScrollNone || (this._hScrollNone = !0,
                            this._viewSize.y += this._hzScrollBar.height) : this._hScrollNone && (this._hScrollNone = !1,
                                this._viewSize.y -= this._hzScrollBar.height))), this._vtScrollBar && (this._viewSize.y < this._vtScrollBar.minSize ? this._vtScrollBar.displayObject.visible = !1 : (this._vtScrollBar.displayObject.visible = this._scrollBarVisible && !this._vScrollNone,
                                    0 == this._contentSize.y ? this._vtScrollBar.displayPerc = 0 : this._vtScrollBar.displayPerc = Math.min(1, this._viewSize.y / this._contentSize.y))),
                    this._hzScrollBar && (this._viewSize.x < this._hzScrollBar.minSize ? this._hzScrollBar.displayObject.visible = !1 : (this._hzScrollBar.displayObject.visible = this._scrollBarVisible && !this._hScrollNone,
                        0 == this._contentSize.x ? this._hzScrollBar.displayPerc = 0 : this._hzScrollBar.displayPerc = Math.min(1, this._viewSize.x / this._contentSize.x)));
                var e = this._maskContainer.scrollRect;
                if (e && (e.width = this._viewSize.x, e.height = this._viewSize.y, this._maskContainer.scrollRect = e),
                    0 == this._scrollType || 2 == this._scrollType ? this._overlapSize.x = Math.ceil(Math.max(0, this._contentSize.x - this._viewSize.x)) : this._overlapSize.x = 0,
                    1 == this._scrollType || 2 == this._scrollType ? this._overlapSize.y = Math.ceil(Math.max(0, this._contentSize.y - this._viewSize.y)) : this._overlapSize.y = 0,
                    this._xPos = et.clamp(this._xPos, 0, this._overlapSize.x), this._yPos = et.clamp(this._yPos, 0, this._overlapSize.y),
                    null != this._refreshBarAxis) {
                    var i = this._overlapSize[this._refreshBarAxis];
                    0 == i ? i = Math.max(this._contentSize[this._refreshBarAxis] + this._footerLockedSize - this._viewSize[this._refreshBarAxis], 0) : i += this._footerLockedSize,
                        "x" == this._refreshBarAxis ? this._container.pos(et.clamp(this._container.x, -i, this._headerLockedSize), et.clamp(this._container.y, -this._overlapSize.y, 0)) : this._container.pos(et.clamp(this._container.x, -this._overlapSize.x, 0), et.clamp(this._container.y, -i, this._headerLockedSize)),
                        null != this._header && ("x" == this._refreshBarAxis ? this._header.height = this._viewSize.y : this._header.width = this._viewSize.x),
                        null != this._footer && ("y" == this._refreshBarAxis ? this._footer.height = this._viewSize.y : this._footer.width = this._viewSize.x);
                } else this._container.pos(et.clamp(this._container.x, -this._overlapSize.x, 0), et.clamp(this._container.y, -this._overlapSize.y, 0));
                this.syncScrollBar(!0), this.checkRefreshBar(), this._pageMode && this.updatePageController();
            }, e.posChanged = function (t) {
                0 == this._aniFlag ? this._aniFlag = t ? 1 : -1 : 1 != this._aniFlag || t || (this._aniFlag = -1),
                    this._needRefresh = !0, i.timer.callLater(this, this.refresh);
            }, e.refresh = function () {
                this._needRefresh = !1, i.timer.clear(this, this.refresh), (this._pageMode || this._snapToItem) && (t.sEndPos.setTo(-this._xPos, -this._yPos),
                    this.alignPosition(t.sEndPos, !1), this._xPos = -t.sEndPos.x, this._yPos = -t.sEndPos.y),
                    this.refresh2(), O.dispatch("fui_scroll", this._owner.displayObject), this._needRefresh && (this._needRefresh = !1,
                        i.timer.clear(this, this.refresh), this.refresh2()), this.syncScrollBar(), this._aniFlag = 0;
            }, e.refresh2 = function () {
                if (1 != this._aniFlag || this.isDragged) 0 != this._tweening && this.killTween(),
                    this._container.pos(Math.floor(-this._xPos), Math.floor(-this._yPos)), this.loopCheckingCurrent(); else {
                    var t = NaN, e = NaN;
                    this._overlapSize.x > 0 ? t = -Math.floor(this._xPos) : (0 != this._container.x && (this._container.x = 0),
                        t = 0), this._overlapSize.y > 0 ? e = -Math.floor(this._yPos) : (0 != this._container.y && (this._container.y = 0),
                            e = 0), t != this._container.x || e != this._container.y ? (this._tweening = 1,
                                this._tweenTime.setTo(0, 0), this._tweenDuration.setTo(.5, .5), this._tweenStart.setTo(this._container.x, this._container.y),
                                this._tweenChange.setTo(t - this._tweenStart.x, e - this._tweenStart.y), i.timer.frameLoop(1, this, this.tweenUpdate)) : 0 != this._tweening && this.killTween();
                }
                this._pageMode && this.updatePageController();
            }, e.syncScrollBar = function (t) {
                void 0 === t && (t = !1), null != this._vtScrollBar && (this._vtScrollBar.scrollPerc = 0 == this._overlapSize.y ? 0 : et.clamp(-this._container.y, 0, this._overlapSize.y) / this._overlapSize.y,
                    this._scrollBarDisplayAuto && this.showScrollBar(!t)), null != this._hzScrollBar && (this._hzScrollBar.scrollPerc = 0 == this._overlapSize.x ? 0 : et.clamp(-this._container.x, 0, this._overlapSize.x) / this._overlapSize.x,
                        this._scrollBarDisplayAuto && this.showScrollBar(!t)), t && (this._maskContainer.mouseEnabled = !0);
            }, e.__mouseDown = function () {
                if (this._touchEffect) {
                    0 != this._tweening ? (this.killTween(), this.isDragged = !0) : this.isDragged = !1;
                    var t = this._owner.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.ScrollPane.sHelperPoint);
                    this._containerPos.setTo(this._container.x, this._container.y), this._beginTouchPos.setTo(t.x, t.y),
                        this._lastTouchPos.setTo(t.x, t.y), this._lastTouchGlobalPos.setTo(i.stage.mouseX, i.stage.mouseY),
                        this._isHoldAreaDone = !1, this._velocity.setTo(0, 0), this._velocityScale = 1,
                        this._lastMoveTime = i.timer.currTimer / 1e3, this._owner.displayObject.stage.on("mousemove", this, this.__mouseMove),
                        this._owner.displayObject.stage.on("mouseup", this, this.__mouseUp), this._owner.displayObject.stage.on("click", this, this.__click);
                }
            }, e.__mouseMove = function () {
                if (this._touchEffect && (null == t.draggingPane || t.draggingPane == this) && null == L.draggingObject) {
                    var e = Q.touchScrollSensitivity, n = this._owner.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.ScrollPane.sHelperPoint), r = NaN, a = !1, s = !1;
                    if (1 == this._scrollType) {
                        if (!this._isHoldAreaDone) {
                            if (t._gestureFlag |= 1, (r = Math.abs(this._beginTouchPos.y - n.y)) < e) return;
                            if (0 != (2 & t._gestureFlag) && r < Math.abs(this._beginTouchPos.x - n.x)) return;
                        }
                        a = !0;
                    } else if (0 == this._scrollType) {
                        if (!this._isHoldAreaDone) {
                            if (t._gestureFlag |= 2, (r = Math.abs(this._beginTouchPos.x - n.x)) < e) return;
                            if (0 != (1 & t._gestureFlag) && r < Math.abs(this._beginTouchPos.y - n.y)) return;
                        }
                        s = !0;
                    } else {
                        if (t._gestureFlag = 3, !this._isHoldAreaDone && (r = Math.abs(this._beginTouchPos.y - n.y)) < e && (r = Math.abs(this._beginTouchPos.x - n.x)) < e) return;
                        a = s = !0;
                    }
                    var o = Math.floor(this._containerPos.x + n.x - this._beginTouchPos.x), l = Math.floor(this._containerPos.y + n.y - this._beginTouchPos.y);
                    a && (l > 0 ? this._bouncebackEffect ? null != this._header && 0 != this._header.maxHeight ? this._container.y = Math.floor(Math.min(.5 * l, this._header.maxHeight)) : this._container.y = Math.floor(Math.min(.5 * l, .5 * this._viewSize.y)) : this._container.y = 0 : l < -this._overlapSize.y ? this._bouncebackEffect ? null != this._footer && this._footer.maxHeight > 0 ? this._container.y = Math.floor(Math.max(.5 * (l + this._overlapSize.y), -this._footer.maxHeight) - this._overlapSize.y) : this._container.y = Math.floor(Math.max(.5 * (l + this._overlapSize.y), .5 * -this._viewSize.y) - this._overlapSize.y) : this._container.y = -this._overlapSize.y : this._container.y = l),
                        s && (o > 0 ? this._bouncebackEffect ? null != this._header && 0 != this._header.maxWidth ? this._container.x = Math.floor(Math.min(.5 * o, this._header.maxWidth)) : this._container.x = Math.floor(Math.min(.5 * o, .5 * this._viewSize.x)) : this._container.x = 0 : o < 0 - this._overlapSize.x ? this._bouncebackEffect ? null != this._footer && this._footer.maxWidth > 0 ? this._container.x = Math.floor(Math.max(.5 * (o + this._overlapSize.x), -this._footer.maxWidth) - this._overlapSize.x) : this._container.x = Math.floor(Math.max(.5 * (o + this._overlapSize.x), .5 * -this._viewSize.x) - this._overlapSize.x) : this._container.x = -this._overlapSize.x : this._container.x = o);
                    var h = "slow" == i.stage.frameRate ? 30 : 60, u = i.timer.currTimer / 1e3, c = Math.max(u - this._lastMoveTime, 1 / h), d = n.x - this._lastTouchPos.x, _ = n.y - this._lastTouchPos.y;
                    if (s || (d = 0), a || (_ = 0), 0 != c) {
                        var f = c * h - 1;
                        if (f > 1) {
                            var p = Math.pow(.833, f);
                            this._velocity.x = this._velocity.x * p, this._velocity.y = this._velocity.y * p;
                        }
                        this._velocity.x = et.lerp(this._velocity.x, 60 * d / h / c, 10 * c), this._velocity.y = et.lerp(this._velocity.y, 60 * _ / h / c, 10 * c);
                    }
                    var m = this._lastTouchGlobalPos.x - i.stage.mouseX, g = this._lastTouchGlobalPos.y - i.stage.mouseY;
                    0 != d ? this._velocityScale = Math.abs(m / d) : 0 != _ && (this._velocityScale = Math.abs(g / _)),
                        this._lastTouchPos.setTo(n.x, n.y), this._lastTouchGlobalPos.setTo(i.stage.mouseX, i.stage.mouseY),
                        this._lastMoveTime = u, this._overlapSize.x > 0 && (this._xPos = et.clamp(-this._container.x, 0, this._overlapSize.x)),
                        this._overlapSize.y > 0 && (this._yPos = et.clamp(-this._container.y, 0, this._overlapSize.y)),
                        0 != this._loop && (o = this._container.x, l = this._container.y, this.loopCheckingCurrent() && (this._containerPos.x += this._container.x - o,
                            this._containerPos.y += this._container.y - l)), t.draggingPane = this, this._isHoldAreaDone = !0,
                        this.isDragged = !0, this._maskContainer.mouseEnabled = !1, this.syncScrollBar(),
                        this.checkRefreshBar(), this._pageMode && this.updatePageController(), O.dispatch("fui_scroll", this._owner.displayObject);
                }
            }, e.__mouseUp = function () {
                if (this._owner.displayObject.stage.off("mousemove", this, this.__mouseMove), this._owner.displayObject.stage.off("mouseup", this, this.__mouseUp),
                    this._owner.displayObject.stage.off("click", this, this.__click), t.draggingPane == this && (t.draggingPane = null),
                    t._gestureFlag = 0, !this.isDragged || !this._touchEffect) return this.isDragged = !1,
                        void (this._maskContainer.mouseEnabled = !0);
                this.isDragged = !1, this._maskContainer.mouseEnabled = !0, this._tweenStart.setTo(this._container.x, this._container.y),
                    t.sEndPos.setTo(this._tweenStart.x, this._tweenStart.y);
                var e = !1;
                if (this._container.x > 0 ? (t.sEndPos.x = 0, e = !0) : this._container.x < -this._overlapSize.x && (t.sEndPos.x = -this._overlapSize.x,
                    e = !0), this._container.y > 0 ? (t.sEndPos.y = 0, e = !0) : this._container.y < -this._overlapSize.y && (t.sEndPos.y = -this._overlapSize.y,
                        e = !0), e) {
                    if (this._tweenChange.setTo(t.sEndPos.x - this._tweenStart.x, t.sEndPos.y - this._tweenStart.y),
                        this._tweenChange.x < -Q.touchDragSensitivity || this._tweenChange.y < -Q.touchDragSensitivity ? (this._refreshEventDispatching = !0,
                            O.dispatch("fui_pull_down_release", this._owner.displayObject), this._refreshEventDispatching = !1) : (this._tweenChange.x > Q.touchDragSensitivity || this._tweenChange.y > Q.touchDragSensitivity) && (this._refreshEventDispatching = !0,
                                O.dispatch("fui_pull_up_release", this._owner.displayObject), this._refreshEventDispatching = !1),
                        this._headerLockedSize > 0 && 0 == t.sEndPos[this._refreshBarAxis]) t.sEndPos[this._refreshBarAxis] = this._headerLockedSize,
                            this._tweenChange.x = t.sEndPos.x - this._tweenStart.x, this._tweenChange.y = t.sEndPos.y - this._tweenStart.y; else if (this._footerLockedSize > 0 && t.sEndPos[this._refreshBarAxis] == -this._overlapSize[this._refreshBarAxis]) {
                                var n = this._overlapSize[this._refreshBarAxis];
                                0 == n ? n = Math.max(this._contentSize[this._refreshBarAxis] + this._footerLockedSize - this._viewSize[this._refreshBarAxis], 0) : n += this._footerLockedSize,
                                    t.sEndPos[this._refreshBarAxis] = -n, this._tweenChange.x = t.sEndPos.x - this._tweenStart.x,
                                    this._tweenChange.y = t.sEndPos.y - this._tweenStart.y;
                            }
                    this._tweenDuration.setTo(.3, .3);
                } else {
                    if (this._inertiaDisabled) this._tweenDuration.setTo(.3, .3); else {
                        var r = "slow" == i.stage.frameRate ? 30 : 60, a = (i.timer.currTimer / 1e3 - this._lastMoveTime) * r - 1;
                        if (a > 1) {
                            var s = Math.pow(.833, a);
                            this._velocity.x = this._velocity.x * s, this._velocity.y = this._velocity.y * s;
                        }
                        this.updateTargetAndDuration(this._tweenStart, t.sEndPos);
                    }
                    if (t.sOldChange.setTo(t.sEndPos.x - this._tweenStart.x, t.sEndPos.y - this._tweenStart.y),
                        this.loopCheckingTarget(t.sEndPos), (this._pageMode || this._snapToItem) && this.alignPosition(t.sEndPos, !0),
                        this._tweenChange.x = t.sEndPos.x - this._tweenStart.x, this._tweenChange.y = t.sEndPos.y - this._tweenStart.y,
                        0 == this._tweenChange.x && 0 == this._tweenChange.y) return void (this._scrollBarDisplayAuto && this.showScrollBar(!1));
                    (this._pageMode || this._snapToItem) && (this.fixDuration("x", t.sOldChange.x),
                        this.fixDuration("y", t.sOldChange.y));
                }
                this._tweening = 2, this._tweenTime.setTo(0, 0), i.timer.frameLoop(1, this, this.tweenUpdate);
            }, e.__click = function () {
                this.isDragged = !1;
            }, e.__mouseWheel = function (t) {
                if (this._mouseWheelEnabled) {
                    this._owner.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.ScrollPane.sHelperPoint);
                    var e = t.delta;
                    e = e > 0 ? -1 : e < 0 ? 1 : 0, this._overlapSize.x > 0 && 0 == this._overlapSize.y ? this._pageMode ? this.setPosX(this._xPos + this._pageSize.x * e, !1) : this.setPosX(this._xPos + this._mouseWheelStep * e, !1) : this._pageMode ? this.setPosY(this._yPos + this._pageSize.y * e, !1) : this.setPosY(this._yPos + this._mouseWheelStep * e, !1);
                }
            }, e.__rollOver = function () {
                this.showScrollBar(!0);
            }, e.__rollOut = function () {
                this.showScrollBar(!1);
            }, e.showScrollBar = function (t) {
                t ? (this.__showScrollBar(!0), i.timer.clear(this, this.__showScrollBar)) : i.timer.once(500, this, this.__showScrollBar, [t]);
            }, e.__showScrollBar = function (t) {
                this._scrollBarVisible = t && this._viewSize.x > 0 && this._viewSize.y > 0, this._vtScrollBar && (this._vtScrollBar.displayObject.visible = this._scrollBarVisible && !this._vScrollNone),
                    this._hzScrollBar && (this._hzScrollBar.displayObject.visible = this._scrollBarVisible && !this._hScrollNone);
            }, e.getLoopPartSize = function (t, e) {
                return (this._contentSize[e] + ("x" == e ? this._owner.columnGap : this._owner.lineGap)) / t;
            }, e.loopCheckingCurrent = function () {
                var t = !1;
                return 1 == this._loop && this._overlapSize.x > 0 ? this._xPos < .001 ? (this._xPos += this.getLoopPartSize(2, "x"),
                    t = !0) : this._xPos >= this._overlapSize.x && (this._xPos -= this.getLoopPartSize(2, "x"),
                        t = !0) : 2 == this._loop && this._overlapSize.y > 0 && (this._yPos < .001 ? (this._yPos += this.getLoopPartSize(2, "y"),
                            t = !0) : this._yPos >= this._overlapSize.y && (this._yPos -= this.getLoopPartSize(2, "y"),
                                t = !0)), t && this._container.pos(Math.floor(-this._xPos), Math.floor(-this._yPos)),
                    t;
            }, e.loopCheckingTarget = function (t) {
                1 == this._loop && this.loopCheckingTarget2(t, "x"), 2 == this._loop && this.loopCheckingTarget2(t, "y");
            }, e.loopCheckingTarget2 = function (t, e) {
                var i = NaN, n = NaN;
                t[e] > 0 ? (i = this.getLoopPartSize(2, e), (n = this._tweenStart[e] - i) <= 0 && n >= -this._overlapSize[e] && (t[e] -= i,
                    this._tweenStart[e] = n)) : t[e] < -this._overlapSize[e] && (i = this.getLoopPartSize(2, e),
                        (n = this._tweenStart[e] + i) <= 0 && n >= -this._overlapSize[e] && (t[e] += i,
                            this._tweenStart[e] = n));
            }, e.loopCheckingNewPos = function (t, e) {
                if (0 == this._overlapSize[e]) return t;
                var i = "x" == e ? this._xPos : this._yPos, n = !1, r = NaN;
                return t < .001 ? (t += this.getLoopPartSize(2, e)) > i && (r = this.getLoopPartSize(6, e),
                    r = Math.ceil((t - i) / r) * r, i = et.clamp(i + r, 0, this._overlapSize[e]), n = !0) : t >= this._overlapSize[e] && (t -= this.getLoopPartSize(2, e)) < i && (r = this.getLoopPartSize(6, e),
                        r = Math.ceil((i - t) / r) * r, i = et.clamp(i - r, 0, this._overlapSize[e]), n = !0),
                    n && ("x" == e ? this._container.x = -Math.floor(i) : this._container.y = -Math.floor(i)),
                    t;
            }, e.alignPosition = function (e, i) {
                if (this._pageMode) e.x = this.alignByPage(e.x, "x", i), e.y = this.alignByPage(e.y, "y", i); else if (this._snapToItem) {
                    var n = this._owner.getSnappingPosition(-e.x, -e.y, t.sHelperPoint);
                    e.x < 0 && e.x > -this._overlapSize.x && (e.x = -n.x), e.y < 0 && e.y > -this._overlapSize.y && (e.y = -n.y);
                }
            }, e.alignByPage = function (t, e, i) {
                var n = 0;
                if (t > 0) n = 0; else if (t < -this._overlapSize[e]) n = Math.ceil(this._contentSize[e] / this._pageSize[e]) - 1; else {
                    n = Math.floor(-t / this._pageSize[e]);
                    var r = i ? t - this._containerPos[e] : t - this._container[e], a = Math.min(this._pageSize[e], this._contentSize[e] - (n + 1) * this._pageSize[e]), s = -t - n * this._pageSize[e];
                    Math.abs(r) > this._pageSize[e] ? s > .5 * a && n++ : s > a * (r < 0 ? .3 : .7) && n++,
                        (t = -n * this._pageSize[e]) < -this._overlapSize[e] && (t = -this._overlapSize[e]);
                }
                if (i) {
                    var o = this._tweenStart[e], l = 0;
                    l = o > 0 ? 0 : o < -this._overlapSize[e] ? Math.ceil(this._contentSize[e] / this._pageSize[e]) - 1 : Math.floor(-o / this._pageSize[e]);
                    var h = Math.floor(-this._containerPos[e] / this._pageSize[e]);
                    Math.abs(n - h) > 1 && Math.abs(l - h) <= 1 && (t = -(n = n > h ? h + 1 : h - 1) * this._pageSize[e]);
                }
                return t;
            }, e.updateTargetAndDuration = function (t, e) {
                e.x = this.updateTargetAndDuration2(t.x, "x"), e.y = this.updateTargetAndDuration2(t.y, "y");
            }, e.updateTargetAndDuration2 = function (t, e) {
                var n = this._velocity[e], r = 0;
                if (t > 0) t = 0; else if (t < -this._overlapSize[e]) t = -this._overlapSize[e]; else {
                    var a = Math.abs(n) * this._velocityScale;
                    o.onMobile && (a *= 1136 / Math.max(i.stage.width, i.stage.height));
                    var s = 0;
                    if (this._pageMode || !o.onMobile ? a > 500 && (s = Math.pow((a - 500) / 500, 2)) : a > 1e3 && (s = Math.pow((a - 1e3) / 1e3, 2)),
                        0 != s) s > 1 && (s = 1), a *= s, n *= s, this._velocity[e] = n, r = Math.log(60 / a) / Math.log(this._decelerationRate) / 60,
                            t += Math.floor(n * r * .4);
                }
                return r < .3 && (r = .3), this._tweenDuration[e] = r, t;
            }, e.fixDuration = function (t, e) {
                if (!(0 == this._tweenChange[t] || Math.abs(this._tweenChange[t]) >= Math.abs(e))) {
                    var i = Math.abs(this._tweenChange[t] / e) * this._tweenDuration[t];
                    i < .3 && (i = .3), this._tweenDuration[t] = i;
                }
            }, e.killTween = function () {
                1 == this._tweening && (this._container.pos(this._tweenStart.x + this._tweenChange.x, this._tweenStart.y + this._tweenChange.y),
                    O.dispatch("fui_scroll", this._owner.displayObject)), this._tweening = 0, i.timer.clear(this, this.tweenUpdate),
                    O.dispatch("fui_scroll_end", this._owner.displayObject);
            }, e.checkRefreshBar = function () {
                if (null != this._header || null != this._footer) {
                    var e = this._container[this._refreshBarAxis];
                    if (null != this._header) if (e > 0) {
                        null == this._header.displayObject.parent && this._maskContainer.addChildAt(this._header.displayObject, 0);
                        var i = t.sHelperPoint;
                        i.setTo(this._header.width, this._header.height), i[this._refreshBarAxis] = e, this._header.setSize(i.x, i.y);
                    } else null != this._header.displayObject.parent && this._maskContainer.removeChild(this._header.displayObject);
                    if (null != this._footer) {
                        var n = this._overlapSize[this._refreshBarAxis];
                        e < -n || 0 == n && this._footerLockedSize > 0 ? (null == this._footer.displayObject.parent && this._maskContainer.addChildAt(this._footer.displayObject, 0),
                            (i = t.sHelperPoint).setTo(this._footer.x, this._footer.y), i[this._refreshBarAxis] = n > 0 ? e + this._contentSize[this._refreshBarAxis] : Math.max(Math.min(e + this._viewSize[this._refreshBarAxis], this._viewSize[this._refreshBarAxis] - this._footerLockedSize), this._viewSize[this._refreshBarAxis] - this._contentSize[this._refreshBarAxis]),
                            this._footer.setXY(i.x, i.y), i.setTo(this._footer.width, this._footer.height),
                            i[this._refreshBarAxis] = n > 0 ? -n - e : this._viewSize[this._refreshBarAxis] - this._footer[this._refreshBarAxis],
                            this._footer.setSize(i.x, i.y)) : null != this._footer.displayObject.parent && this._maskContainer.removeChild(this._footer.displayObject);
                    }
                }
            }, e.tweenUpdate = function () {
                var t = this.runTween("x"), e = this.runTween("y");
                this._container.pos(t, e), 2 == this._tweening && (this._overlapSize.x > 0 && (this._xPos = et.clamp(-t, 0, this._overlapSize.x)),
                    this._overlapSize.y > 0 && (this._yPos = et.clamp(-e, 0, this._overlapSize.y)),
                    this._pageMode && this.updatePageController()), 0 == this._tweenChange.x && 0 == this._tweenChange.y ? (this._tweening = 0,
                        i.timer.clear(this, this.tweenUpdate), this.loopCheckingCurrent(), this.syncScrollBar(!0),
                        this.checkRefreshBar(), O.dispatch("fui_scroll", this._owner.displayObject), O.dispatch("fui_scroll_end", this._owner.displayObject)) : (this.syncScrollBar(!1),
                            this.checkRefreshBar(), O.dispatch("fui_scroll", this._owner.displayObject));
            }, e.runTween = function (e) {
                var n = NaN;
                if (0 != this._tweenChange[e]) {
                    if (this._tweenTime[e] += i.timer.delta / 1e3, this._tweenTime[e] >= this._tweenDuration[e]) n = this._tweenStart[e] + this._tweenChange[e],
                        this._tweenChange[e] = 0; else {
                        var r = t.easeFunc(this._tweenTime[e], this._tweenDuration[e]);
                        n = this._tweenStart[e] + Math.floor(this._tweenChange[e] * r);
                    }
                    var a = 0, s = -this._overlapSize[e];
                    if (this._headerLockedSize > 0 && this._refreshBarAxis == e && (a = this._headerLockedSize),
                        this._footerLockedSize > 0 && this._refreshBarAxis == e) {
                        var o = this._overlapSize[this._refreshBarAxis];
                        0 == o ? o = Math.max(this._contentSize[this._refreshBarAxis] + this._footerLockedSize - this._viewSize[this._refreshBarAxis], 0) : o += this._footerLockedSize,
                            s = -o;
                    }
                    2 == this._tweening && this._bouncebackEffect ? n > 20 + a && this._tweenChange[e] > 0 || n > a && 0 == this._tweenChange[e] ? (this._tweenTime[e] = 0,
                        this._tweenDuration[e] = .3, this._tweenChange[e] = -n + a, this._tweenStart[e] = n) : (n < s - 20 && this._tweenChange[e] < 0 || n < s && 0 == this._tweenChange[e]) && (this._tweenTime[e] = 0,
                            this._tweenDuration[e] = .3, this._tweenChange[e] = s - n, this._tweenStart[e] = n) : n > a ? (n = a,
                                this._tweenChange[e] = 0) : n < s && (n = s, this._tweenChange[e] = 0);
                } else n = this._container[e];
                return n;
            }, a(0, e, "viewWidth", function () {
                return this._viewSize.x;
            }, function (t) {
                t = t + this._owner.margin.left + this._owner.margin.right, null != this._vtScrollBar && (t += this._vtScrollBar.width),
                    this._owner.width = t;
            }), a(0, e, "percY", function () {
                return 0 == this._overlapSize.y ? 0 : this._yPos / this._overlapSize.y;
            }, function (t) {
                this.setPercY(t, !1);
            }), a(0, e, "owner", function () {
                return this._owner;
            }), a(0, e, "bouncebackEffect", function () {
                return this._bouncebackEffect;
            }, function (t) {
                this._bouncebackEffect = t;
            }), a(0, e, "vtScrollBar", function () {
                return this._vtScrollBar;
            }), a(0, e, "hzScrollBar", function () {
                return this._hzScrollBar;
            }), a(0, e, "header", function () {
                return this._header;
            }), a(0, e, "footer", function () {
                return this._footer;
            }), a(0, e, "isBottomMost", function () {
                return this._yPos == this._overlapSize.y || 0 == this._overlapSize.y;
            }), a(0, e, "touchEffect", function () {
                return this._touchEffect;
            }, function (t) {
                this._touchEffect = t;
            }), a(0, e, "contentWidth", function () {
                return this._contentSize.x;
            }), a(0, e, "scrollStep", function () {
                return this._scrollStep;
            }, function (t) {
                this._scrollStep = t, 0 == this._scrollStep && (this._scrollStep = Q.defaultScrollStep),
                    this._mouseWheelStep = 2 * this._scrollStep;
            }), a(0, e, "viewHeight", function () {
                return this._viewSize.y;
            }, function (t) {
                t = t + this._owner.margin.top + this._owner.margin.bottom, null != this._hzScrollBar && (t += this._hzScrollBar.height),
                    this._owner.height = t;
            }), a(0, e, "posX", function () {
                return this._xPos;
            }, function (t) {
                this.setPosX(t, !1);
            }), a(0, e, "snapToItem", function () {
                return this._snapToItem;
            }, function (t) {
                this._snapToItem = t;
            }), a(0, e, "mouseWheelEnabled", function () {
                return this._mouseWheelEnabled;
            }, function (t) {
                this._mouseWheelEnabled = t;
            }), a(0, e, "decelerationRate", function () {
                return this._decelerationRate;
            }, function (t) {
                this._decelerationRate = t;
            }), a(0, e, "percX", function () {
                return 0 == this._overlapSize.x ? 0 : this._xPos / this._overlapSize.x;
            }, function (t) {
                this.setPercX(t, !1);
            }), a(0, e, "posY", function () {
                return this._yPos;
            }, function (t) {
                this.setPosY(t, !1);
            }), a(0, e, "contentHeight", function () {
                return this._contentSize.y;
            }), a(0, e, "currentPageX", function () {
                if (!this._pageMode) return 0;
                var t = Math.floor(this._xPos / this._pageSize.x);
                return this._xPos - t * this._pageSize.x > .5 * this._pageSize.x && t++, t;
            }, function (t) {
                this.setCurrentPageX(t, !1);
            }), a(0, e, "currentPageY", function () {
                if (!this._pageMode) return 0;
                var t = Math.floor(this._yPos / this._pageSize.y);
                return this._yPos - t * this._pageSize.y > .5 * this._pageSize.y && t++, t;
            }, function (t) {
                this.setCurrentPageY(t, !1);
            }), a(0, e, "isRightMost", function () {
                return this._xPos == this._overlapSize.x || 0 == this._overlapSize.x;
            }), a(0, e, "pageController", function () {
                return this._pageController;
            }, function (t) {
                this._pageController = t;
            }), a(0, e, "scrollingPosX", function () {
                return et.clamp(-this._container.x, 0, this._overlapSize.x);
            }), a(0, e, "scrollingPosY", function () {
                return et.clamp(-this._container.y, 0, this._overlapSize.y);
            }), t.easeFunc = function (t, e) {
                return (t = t / e - 1) * t * t + 1;
            }, t.draggingPane = null, t._gestureFlag = 0, t.TWEEN_TIME_GO = .5, t.TWEEN_TIME_DEFAULT = .3,
                t.PULL_RATIO = .5, n(t, ["sHelperPoint", function () {
                    return this.sHelperPoint = new g();
                }, "sHelperRect", function () {
                    return this.sHelperRect = new y();
                }, "sEndPos", function () {
                    return this.sEndPos = new g();
                }, "sOldChange", function () {
                    return this.sOldChange = new g();
                }]), t;
        }()), H = (function () {
            function t() { }
            r(t, "fairygui.ScrollType"), t.Horizontal = 0, t.Vertical = 1, t.Both = 2;
        }(), function () {
            var t, e, i, n, s, o, l, u, c;
            function d(t) {
                this.name = null, this._owner = null, this._ownerBaseX = NaN, this._ownerBaseY = NaN,
                    this._items = null, this._totalTimes = 0, this._totalTasks = 0, this._playing = !1,
                    this._paused = !1, this._onComplete = null, this._options = 0, this._reversed = !1,
                    this._totalDuration = NaN, this._autoPlay = !1, this._autoPlayTimes = 0, this._autoPlayDelay = NaN,
                    this._timeScale = NaN, this._startTime = NaN, this._endTime = NaN, this.OPTION_IGNORE_DISPLAY_CONTROLLER = 1,
                    this.OPTION_AUTO_STOP_DISABLED = 2, this.OPTION_AUTO_STOP_AT_END = 4, this._owner = t,
                    this._items = [], this._totalDuration = 0, this._autoPlayTimes = 1, this._autoPlayDelay = 0,
                    this._timeScale = 1, this._startTime = 0, this._endTime = 0;
            }
            r(d, "fairygui.Transition");
            var f = d.prototype;
            return f.play = function (t, e, i, n, r) {
                void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = -1),
                    this._play(t, e, i, n, r, !1);
            }, f.playReverse = function (t, e, i, n, r) {
                void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = -1),
                    this._play(t, 1, i, n, r, !0);
            }, f.changePlayTimes = function (t) {
                this._totalTimes = t;
            }, f.setAutoPlay = function (t, e, i) {
                void 0 === e && (e = 1), void 0 === i && (i = 0), this._autoPlay != t && (this._autoPlay = t,
                    this._autoPlayTimes = e, this._autoPlayDelay = i, this._autoPlay ? this._owner.onStage && this.play(null, null, this._autoPlayTimes, this._autoPlayDelay) : this._owner.onStage || this.stop(!1, !0));
            }, f._play = function (t, e, i, n, r, a) {
                void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = -1),
                    void 0 === a && (a = !1), this.stop(!0, !0), this._totalTimes = e, this._reversed = a,
                    this._startTime = n, this._endTime = r, this._playing = !0, this._paused = !1, this._onComplete = t;
                for (var s = this._items.length, o = 0; o < s; o++) {
                    var l = this._items[o];
                    if (null == l.target ? l.targetId ? l.target = this._owner.getChildById(l.targetId) : l.target = this._owner : l.target != this._owner && l.target.parent != this._owner && (l.target = null),
                        null != l.target && 10 == l.type) {
                        var h = l.target.getTransition(l.value.transName);
                        if (h == this && (h = null), null != h) if (0 == l.value.playTimes) {
                            var u = 0;
                            for (u = o - 1; u >= 0; u--) {
                                var c = this._items[u];
                                if (10 == c.type && c.value.trans == h) {
                                    c.value.stopTime = l.time - c.time;
                                    break;
                                }
                            }
                            u < 0 ? l.value.stopTime = 0 : h = null;
                        } else l.value.stopTime = -1;
                        l.value.trans = h;
                    }
                }
                0 == i ? this.onDelayedPlay() : Y.delayedCall(i).onComplete(this.onDelayedPlay, this);
            }, f.stop = function (t, e) {
                if (void 0 === t && (t = !0), void 0 === e && (e = !1), this._playing) {
                    this._playing = !1, this._totalTasks = 0, this._totalTimes = 0;
                    var i = this._onComplete;
                    this._onComplete = null, Y.kill(this);
                    var n = this._items.length;
                    if (this._reversed) for (var r = n - 1; r >= 0; r--) {
                        var a = this._items[r];
                        null != a.target && this.stopItem(a, t);
                    } else for (r = 0; r < n; r++) null != (a = this._items[r]).target && this.stopItem(a, t);
                    e && null != i && i.run();
                }
            }, f.stopItem = function (t, e) {
                if (0 != t.displayLockToken && (t.target.releaseDisplayLock(t.displayLockToken),
                    t.displayLockToken = 0), null != t.tweener && (t.tweener.kill(e), t.tweener = null,
                        11 != t.type || e || (t.target._gearLocked = !0, t.target.setXY(t.target.x - t.value.lastOffsetX, t.target.y - t.value.lastOffsetY),
                            t.target._gearLocked = !1)), 10 == t.type) {
                    var i = t.value.trans;
                    null != i && i.stop(e, !1);
                }
            }, f.setPaused = function (t) {
                if (this._playing && this._paused != t) {
                    this._paused = t;
                    var e = Y.getTween(this);
                    null != e && e.setPaused(t);
                    for (var i = this._items.length, n = 0; n < i; n++) {
                        var r = this._items[n];
                        null != r.target && (10 == r.type ? null != r.value.trans && r.value.trans.setPaused(t) : 7 == r.type && (t ? (r.value.flag = r.target.playing,
                            r.target.playing = !1) : r.target.playing = r.value.flag), null != r.tweener && r.tweener.setPaused(t));
                    }
                }
            }, f.dispose = function () {
                this._playing && Y.kill(this);
                for (var t = this._items.length, e = 0; e < t; e++) {
                    var i = this._items[e];
                    null != i.tweener && (i.tweener.kill(), i.tweener = null), i.target = null, i.hook = null,
                        null != i.tweenConfig && (i.tweenConfig.endHook = null);
                }
                this._items.length = 0, this._playing = !1, this._onComplete = null;
            }, f.setValue = function (t, e) {
                for (var i = [], n = 1, r = arguments.length; n < r; n++) i.push(arguments[n]);
                var a, s = this._items.length;
                for (n = 0; n < s; n++) {
                    var o = this._items[n];
                    if (o.label == t) a = null != o.tweenConfig ? o.tweenConfig.startValue : o.value; else {
                        if (null == o.tweenConfig || o.tweenConfig.endLabel != t) continue;
                        a = o.tweenConfig.endValue;
                    }
                    switch (o.type) {
                        case 0:
                        case 1:
                        case 3:
                        case 2:
                        case 13:
                            a.b1 = !0, a.b2 = !0, a.f1 = parseFloat(i[0]), a.f2 = parseFloat(i[1]);
                            break;

                        case 4:
                        case 5:
                        case 6:
                            a.f1 = parseFloat(i[0]);
                            break;

                        case 7:
                            a.frame = parseInt(i[0]), i.length > 1 && (a.playing = i[1]);
                            break;

                        case 8:
                            a.visible = i[0];
                            break;

                        case 9:
                            a.sound = i[0], i.length > 1 && (a.volume = parseFloat(i[1]));
                            break;

                        case 10:
                            a.transName = i[0], i.length > 1 && (a.playTimes = parseInt(i[1]));
                            break;

                        case 11:
                            a.amplitude = parseFloat(i[0]), i.length > 1 && (a.duration = parseFloat(i[1]));
                            break;

                        case 12:
                            a.f1 = parseFloat(i[0]), a.f2 = parseFloat(i[1]), a.f3 = parseFloat(i[2]), a.f4 = parseFloat(i[3]);
                            break;

                        case 14:
                        case 15:
                            a.text = i[0];
                    }
                }
            }, f.setHook = function (t, e) {
                for (var i = this._items.length, n = 0; n < i; n++) {
                    var r = this._items[n];
                    if (r.label == t) {
                        r.hook = e;
                        break;
                    }
                    if (null != r.tweenConfig && r.tweenConfig.endLabel == t) {
                        r.tweenConfig.endHook = e;
                        break;
                    }
                }
            }, f.clearHooks = function () {
                for (var t = this._items.length, e = 0; e < t; e++) {
                    var i = this._items[e];
                    i.hook = null, null != i.tweenConfig && (i.tweenConfig.endHook = null);
                }
            }, f.setTarget = function (t, e) {
                for (var i = this._items.length, n = 0; n < i; n++) {
                    var r = this._items[n];
                    r.label == t && (r.targetId = e.id, r.target = null);
                }
            }, f.setDuration = function (t, e) {
                for (var i = this._items.length, n = 0; n < i; n++) {
                    var r = this._items[n];
                    null != r.tweenConfig && r.label == t && (r.tweenConfig.duration = e);
                }
            }, f.getLabelTime = function (t) {
                for (var e = this._items.length, i = 0; i < e; i++) {
                    var n = this._items[i];
                    if (n.label == t) return n.time;
                    if (null != n.tweenConfig && n.tweenConfig.endLabel == t) return n.time + n.tweenConfig.duration;
                }
                return Number.NaN;
            }, f.updateFromRelations = function (t, e, i) {
                var n = this._items.length;
                if (0 != n) for (var r = 0; r < n; r++) {
                    var a = this._items[r];
                    0 == a.type && a.targetId == t && (null != a.tweenConfig ? (a.tweenConfig.startValue.f1 += e,
                        a.tweenConfig.startValue.f2 += i, a.tweenConfig.endValue.f1 += e, a.tweenConfig.endValue.f2 += i) : (a.value.f1 += e,
                            a.value.f2 += i));
                }
            }, f.onOwnerAddedToStage = function () {
                this._autoPlay && !this._playing && this.play(null, this._autoPlayTimes, this._autoPlayDelay);
            }, f.onOwnerRemovedFromStage = function () {
                0 == (this._options & this.OPTION_AUTO_STOP_DISABLED) && this.stop(0 != (this._options & this.OPTION_AUTO_STOP_AT_END), !1);
            }, f.onDelayedPlay = function () {
                if (this.internalPlay(), this._playing = this._totalTasks > 0, this._playing) {
                    if (0 != (this._options & this.OPTION_IGNORE_DISPLAY_CONTROLLER)) for (var t = this._items.length, e = 0; e < t; e++) {
                        var i = this._items[e];
                        null != i.target && i.target != this._owner && (i.displayLockToken = i.target.addDisplayLock());
                    }
                } else if (null != this._onComplete) {
                    var n = this._onComplete;
                    this._onComplete = null, n.run();
                }
            }, f.internalPlay = function () {
                this._ownerBaseX = this._owner.x, this._ownerBaseY = this._owner.y, this._totalTasks = 0;
                var t, e = this._items.length, i = !1;
                if (this._reversed) for (n = e - 1; n >= 0; n--) null != (t = this._items[n]).target && this.playItem(t); else for (var n = 0; n < e; n++) null != (t = this._items[n]).target && (7 == t.type && 0 != this._startTime && t.time <= this._startTime ? (i = !0,
                    t.value.flag = !1) : this.playItem(t));
                i && this.skipAnimations();
            }, f.playItem = function (t) {
                var e = NaN;
                if (null != t.tweenConfig) {
                    if (e = this._reversed ? this._totalDuration - t.time - t.tweenConfig.duration : t.time,
                        -1 == this._endTime || e <= this._endTime) {
                        var i, n;
                        switch (this._reversed ? (i = t.tweenConfig.endValue, n = t.tweenConfig.startValue) : (i = t.tweenConfig.startValue,
                            n = t.tweenConfig.endValue), t.value.b1 = i.b1 || n.b1, t.value.b2 = i.b2 || n.b2,
                        t.type) {
                            case 0:
                            case 1:
                            case 2:
                            case 13:
                                t.tweener = Y.to2(i.f1, i.f2, n.f1, n.f2, t.tweenConfig.duration);
                                break;

                            case 4:
                            case 5:
                                t.tweener = Y.to(i.f1, n.f1, t.tweenConfig.duration);
                                break;

                            case 6:
                                t.tweener = Y.toColor(i.f1, n.f1, t.tweenConfig.duration);
                                break;

                            case 12:
                                t.tweener = Y.to4(i.f1, i.f2, i.f3, i.f4, n.f1, n.f2, n.f3, n.f4, t.tweenConfig.duration);
                        }
                        t.tweener.setDelay(e).setEase(t.tweenConfig.easeType).setRepeat(t.tweenConfig.repeat, t.tweenConfig.yoyo).setTimeScale(this._timeScale).setTarget(t).onStart(this.onTweenStart, this).onUpdate(this.onTweenUpdate, this).onComplete(this.onTweenComplete, this),
                            this._endTime >= 0 && t.tweener.setBreakpoint(this._endTime - e), this._totalTasks++;
                    }
                } else 11 == t.type ? (e = this._reversed ? this._totalDuration - t.time - t.value.duration : t.time,
                    t.value.offsetX = t.value.offsetY = 0, t.value.lastOffsetX = t.value.lastOffsetY = 0,
                    t.tweener = Y.shake(0, 0, t.value.amplitude, t.value.duration).setDelay(e).setTimeScale(this._timeScale).setTarget(t).onUpdate(this.onTweenUpdate, this).onComplete(this.onTweenComplete, this),
                    this._endTime >= 0 && t.tweener.setBreakpoint(this._endTime - t.time), this._totalTasks++) : (e = this._reversed ? this._totalDuration - t.time : t.time) <= this._startTime ? (this.applyValue(t),
                        this.callHook(t, !1)) : (-1 == this._endTime || e <= this._endTime) && (this._totalTasks++,
                            t.tweener = Y.delayedCall(e).setTimeScale(this._timeScale).setTarget(t).onComplete(this.onDelayedPlayItem, this));
                null != t.tweener && t.tweener.seek(this._startTime);
            }, f.skipAnimations = function () {
                for (var t, e, i, n = 0, r = NaN, a = NaN, s = this._items.length, o = 0; o < s; o++) if (!(7 != (i = this._items[o]).type || i.time > this._startTime || (t = i.value).flag)) {
                    n = (e = i.target).frame, r = e.playing ? 0 : -1, a = 0;
                    for (var l = o; l < s; l++) 7 != (i = this._items[l]).type || i.target != e || i.time > this._startTime || ((t = i.value).flag = !0,
                        -1 != t.frame ? (n = t.frame, r = t.playing ? i.time : -1, a = 0) : t.playing ? r < 0 && (r = i.time) : (r >= 0 && (a += i.time - r),
                            r = -1), this.callHook(i, !1));
                    r >= 0 && (a += this._startTime - r), e.playing = r >= 0, e.frame = n, a > 0 && e.advance(1e3 * a);
                }
            }, f.onDelayedPlayItem = function (t) {
                var e = t.target;
                e.tweener = null, this._totalTasks--, this.applyValue(e), this.callHook(e, !1),
                    this.checkAllComplete();
            }, f.onTweenStart = function (t) {
                var e, i, n = t.target;
                0 != n.type && 1 != n.type || (this._reversed ? (e = n.tweenConfig.endValue, i = n.tweenConfig.startValue) : (e = n.tweenConfig.startValue,
                    i = n.tweenConfig.endValue), 0 == n.type ? n.target != this._owner ? (e.b1 || (e.f1 = n.target.x),
                        e.b2 || (e.f2 = n.target.y)) : (e.b1 || (e.f1 = n.target.x - this._ownerBaseX),
                            e.b2 || (e.f2 = n.target.y - this._ownerBaseY)) : (e.b1 || (e.f1 = n.target.width),
                                e.b2 || (e.f2 = n.target.height)), i.b1 || (i.f1 = e.f1), i.b2 || (i.f2 = e.f2),
                    t.startValue.x = e.f1, t.startValue.y = e.f2, t.endValue.x = i.f1, t.endValue.y = i.f2);
                this.callHook(n, !1);
            }, f.onTweenUpdate = function (t) {
                var e = t.target;
                switch (e.type) {
                    case 0:
                    case 1:
                    case 2:
                    case 13:
                        e.value.f1 = t.value.x, e.value.f2 = t.value.y;
                        break;

                    case 4:
                    case 5:
                        e.value.f1 = t.value.x;
                        break;

                    case 6:
                        e.value.f1 = t.value.color;
                        break;

                    case 12:
                        e.value.f1 = t.value.x, e.value.f2 = t.value.y, e.value.f3 = t.value.z, e.value.f4 = t.value.w;
                        break;

                    case 11:
                        e.value.offsetX = t.deltaValue.x, e.value.offsetY = t.deltaValue.y;
                }
                this.applyValue(e);
            }, f.onTweenComplete = function (t) {
                var e = t.target;
                e.tweener = null, this._totalTasks--, t.allCompleted && this.callHook(e, !0), this.checkAllComplete();
            }, f.onPlayTransCompleted = function (t) {
                this._totalTasks--, this.checkAllComplete();
            }, f.callHook = function (t, e) {
                e ? null != t.tweenConfig && null != t.tweenConfig.endHook && t.tweenConfig.endHook.run() : t.time >= this._startTime && null != t.hook && t.hook.run();
            }, f.checkAllComplete = function () {
                if (this._playing && 0 == this._totalTasks) if (this._totalTimes < 0) this.internalPlay(); else if (this._totalTimes--,
                    this._totalTimes > 0) this.internalPlay(); else {
                    this._playing = !1;
                    for (var t = this._items.length, e = 0; e < t; e++) {
                        var i = this._items[e];
                        null != i.target && 0 != i.displayLockToken && (i.target.releaseDisplayLock(i.displayLockToken),
                            i.displayLockToken = 0);
                    }
                    if (null != this._onComplete) {
                        var n = this._onComplete;
                        this._onComplete = null, n.run();
                    }
                }
            }, f.applyValue = function (t) {
                switch (t.target._gearLocked = !0, t.type) {
                    case 0:
                        if (t.target == this._owner) {
                            var e = NaN, i = NaN;
                            e = t.value.b1 ? t.value.f1 + this._ownerBaseX : t.target.x, i = t.value.b2 ? t.value.f2 + this._ownerBaseY : t.target.y,
                                t.target.setXY(e, i);
                        } else t.value.b1 || (t.value.f1 = t.target.x), t.value.b2 || (t.value.f2 = t.target.y),
                            t.target.setXY(t.value.f1, t.value.f2);
                        break;

                    case 1:
                        t.value.b1 || (t.value.f1 = t.target.width), t.value.b2 || (t.value.f2 = t.target.height),
                            t.target.setSize(t.value.f1, t.value.f2);
                        break;

                    case 3:
                        t.target.setPivot(t.value.f1, t.value.f2, t.target.pivotAsAnchor);
                        break;

                    case 4:
                        t.target.alpha = t.value.f1;
                        break;

                    case 5:
                        t.target.rotation = t.value.f1;
                        break;

                    case 2:
                        t.target.setScale(t.value.f1, t.value.f2);
                        break;

                    case 13:
                        t.target.setSkew(t.value.f1, t.value.f2);
                        break;

                    case 6:
                        t.target.color = et.convertToHtmlColor(t.value.f1, !1);
                        break;

                    case 7:
                        t.value.frame >= 0 && (t.target.frame = t.value.frame), t.target.playing = t.value.playing,
                            t.target.timeScale = this._timeScale;
                        break;

                    case 8:
                        t.target.visible = t.value.visible;
                        break;

                    case 10:
                        if (this._playing) {
                            var n = t.value.trans;
                            if (null != n) {
                                this._totalTasks++;
                                var r = this._startTime > t.time ? this._startTime - t.time : 0, a = this._endTime >= 0 ? this._endTime - t.time : -1;
                                t.value.stopTime >= 0 && (a < 0 || a > t.value.stopTime) && (a = t.value.stopTime),
                                    n.timeScale = this._timeScale, n._play(_.create(this, this.onPlayTransCompleted, [t]), t.value.playTimes, 0, r, a, this._reversed);
                            }
                        }
                        break;

                    case 9:
                        if (this._playing && t.time >= this._startTime) {
                            if (null == t.value.audioClip) {
                                var s = $.getItemByURL(t.value.sound);
                                t.value.audioClip = s ? s.file : t.value.sound;
                            }
                            t.value.audioClip && Ot.inst.playOneShotSound(t.value.audioClip, t.value.volume);
                        }
                        break;

                    case 11:
                        t.target.setXY(t.target.x - t.value.lastOffsetX + t.value.offsetX, t.target.y - t.value.lastOffsetY + t.value.offsetY),
                            t.value.lastOffsetX = t.value.offsetX, t.value.lastOffsetY = t.value.offsetY;
                        break;

                    case 12:
                        var o = t.target.filters, l = new nt();
                        l.adjustBrightness(t.value.f1), l.adjustContrast(t.value.f2), l.adjustSaturation(t.value.f3),
                            l.adjustHue(t.value.f4), o = [new h(l)], t.target.filters = o;
                        break;

                    case 14:
                        t.target.text = t.value.text;
                        break;

                    case 15:
                        t.target.icon = t.value.text;
                }
                t.target._gearLocked = !1;
            }, f.setup = function (i) {
                this.name = i.readS(), this._options = i.getInt32(), this._autoPlay = i.readBool(),
                    this._autoPlayTimes = i.getInt32(), this._autoPlayDelay = i.getFloat32();
                for (var n = i.getInt16(), r = 0; r < n; r++) {
                    var a = i.getInt16(), s = i.pos;
                    i.seek(s, 0);
                    var o = new t(i.readByte());
                    this._items[r] = o, o.time = i.getFloat32();
                    var l = i.getInt16();
                    o.targetId = l < 0 ? "" : this._owner.getChildAt(l).id, o.label = i.readS(), i.readBool() ? (i.seek(s, 1),
                        o.tweenConfig = new e(), o.tweenConfig.duration = i.getFloat32(), o.time + o.tweenConfig.duration > this._totalDuration && (this._totalDuration = o.time + o.tweenConfig.duration),
                        o.tweenConfig.easeType = i.readByte(), o.tweenConfig.repeat = i.getInt32(), o.tweenConfig.yoyo = i.readBool(),
                        o.tweenConfig.endLabel = i.readS(), i.seek(s, 2), this.decodeValue(o, i, o.tweenConfig.startValue),
                        i.seek(s, 3), this.decodeValue(o, i, o.tweenConfig.endValue)) : (o.time > this._totalDuration && (this._totalDuration = o.time),
                            i.seek(s, 2), this.decodeValue(o, i, o.value)), i.pos = s + a;
                }
            }, f.decodeValue = function (t, e, i) {
                switch (t.type) {
                    case 0:
                    case 1:
                    case 3:
                    case 13:
                        i.b1 = e.readBool(), i.b2 = e.readBool(), i.f1 = e.getFloat32(), i.f2 = e.getFloat32();
                        break;

                    case 4:
                    case 5:
                        i.f1 = e.getFloat32();
                        break;

                    case 2:
                        i.f1 = e.getFloat32(), i.f2 = e.getFloat32();
                        break;

                    case 6:
                        i.f1 = e.readColor();
                        break;

                    case 7:
                        i.playing = e.readBool(), i.frame = e.getInt32();
                        break;

                    case 8:
                        i.visible = e.readBool();
                        break;

                    case 9:
                        i.sound = e.readS(), i.volume = e.getFloat32();
                        break;

                    case 10:
                        i.transName = e.readS(), i.playTimes = e.getInt32();
                        break;

                    case 11:
                        i.amplitude = e.getFloat32(), i.duration = e.getFloat32();
                        break;

                    case 12:
                        i.f1 = e.getFloat32(), i.f2 = e.getFloat32(), i.f3 = e.getFloat32(), i.f4 = e.getFloat32();
                        break;

                    case 14:
                    case 15:
                        i.text = e.readS();
                }
            }, a(0, f, "playing", function () {
                return this._playing;
            }), a(0, f, "timeScale", function () {
                return this._timeScale;
            }, function (t) {
                if (this._timeScale != t && (this._timeScale = t, this._playing)) for (var e = this._items.length, i = 0; i < e; i++) {
                    var n = this._items[i];
                    null != n.tweener ? n.tweener.setTimeScale(t) : 10 == n.type ? null != n.value.trans && (n.value.trans.timeScale = t) : 7 == n.type && null != n.target && (n.target.timeScale = t);
                }
            }), d.__init$ = function () {
                (function () {
                    function t() { }
                    return r(t, ""), t.XY = 0, t.Size = 1, t.Scale = 2, t.Pivot = 3, t.Alpha = 4, t.Rotation = 5,
                        t.Color = 6, t.Animation = 7, t.Visible = 8, t.Sound = 9, t.Transition = 10, t.Shake = 11,
                        t.ColorFilter = 12, t.Skew = 13, t.Text = 14, t.Icon = 15, t.Unknown = 16, t;
                })(), t = function () {
                    function t(t) {
                        switch (this.time = NaN, this.targetId = null, this.type = 0, this.tweenConfig = null,
                        this.label = null, this.value = null, this.hook = null, this.tweener = null, this.target = null,
                        this.displayLockToken = 0, this.type = t, t) {
                            case 0:
                            case 1:
                            case 2:
                            case 3:
                            case 13:
                            case 4:
                            case 5:
                            case 6:
                            case 12:
                                this.value = new c();
                                break;

                            case 7:
                                this.value = new n();
                                break;

                            case 11:
                                this.value = new l();
                                break;

                            case 9:
                                this.value = new s();
                                break;

                            case 10:
                                this.value = new o();
                                break;

                            case 8:
                                this.value = new i();
                                break;

                            case 14:
                            case 15:
                                this.value = new u();
                        }
                    }
                    return r(t, ""), t;
                }(), e = function () {
                    function t() {
                        this.duration = NaN, this.easeType = 0, this.repeat = 0, this.yoyo = !1, this.startValue = null,
                            this.endValue = null, this.endLabel = null, this.endHook = null, this.easeType = 5,
                            this.startValue = new c(), this.endValue = new c();
                    }
                    return r(t, ""), t;
                }(), i = function () {
                    function t() {
                        this.visible = !1;
                    }
                    return r(t, ""), t;
                }(), n = function () {
                    function t() {
                        this.frame = 0, this.playing = !1, this.flag = !1;
                    }
                    return r(t, ""), t;
                }(), s = function () {
                    function t() {
                        this.sound = null, this.volume = NaN, this.audioClip = null;
                    }
                    return r(t, ""), t;
                }(), o = function () {
                    function t() {
                        this.transName = null, this.playTimes = 0, this.trans = null, this.stopTime = NaN;
                    }
                    return r(t, ""), t;
                }(), l = function () {
                    function t() {
                        this.amplitude = NaN, this.duration = NaN, this.offsetX = NaN, this.offsetY = NaN,
                            this.lastOffsetX = NaN, this.lastOffsetY = NaN;
                    }
                    return r(t, ""), t;
                }(), u = function () {
                    function t() {
                        this.text = null;
                    }
                    return r(t, ""), t;
                }(), c = function () {
                    function t() {
                        this.f1 = NaN, this.f2 = NaN, this.f3 = NaN, this.f4 = NaN, this.b1 = !1, this.b2 = !1,
                            this.b1 = this.b2 = !0;
                    }
                    return r(t, ""), t;
                }();
            }, d;
        }()), j = function () {
            function t() { }
            return r(t, "fairygui.TranslationHelper"), t.loadFromXML = function (e) {
                t.strings = {};
                for (var i = x.parseXMLFromString(e), n = t.findChildNode(i, "resources").childNodes, r = n.length, a = 0; a < r; a++) {
                    var s = n[a];
                    if ("string" == s.nodeName) {
                        var o = s.getAttribute("name"), l = s.textContent, h = o.indexOf("-");
                        if (-1 == h) continue;
                        var u = o.substr(0, h), c = o.substr(h + 1), d = t.strings[u];
                        d || (d = {}, t.strings[u] = d), d[c] = l;
                    }
                }
            }, t.translateComponent = function (e) {
                if (null != t.strings) {
                    var i = t.strings[e.owner.id + e.id];
                    if (null != i) {
                        var n, r, a = e.rawData, s = 0, o = 0, l = 0, h = 0, u = 0, c = 0, d = 0, _ = 0;
                        a.seek(0, 2);
                        var f = a.getInt16();
                        for (l = 0; l < f; l++) {
                            c = a.getInt16(), d = a.pos, a.seek(d, 0);
                            var p = a.readByte();
                            a.skip(4), n = a.readS(), 9 == p && a.seek(d, 6) && (p = a.readByte()), a.seek(d, 1),
                                null != (r = i[n + "-tips"]) && a.writeS(r), a.seek(d, 2);
                            var m = a.getInt16();
                            for (h = 0; h < m; h++) {
                                if (s = a.getInt16(), s += a.pos, 6 == a.readByte()) {
                                    for (a.skip(2), _ = a.getInt16(), u = 0; u < _; u++) null != a.readS() && (null != (r = i[n + "-texts_" + u]) ? a.writeS(r) : a.skip(2));
                                    a.readBool() && null != (r = i[n + "-texts_def"]) && a.writeS(r);
                                }
                                a.pos = s;
                            }
                            switch (p) {
                                case 6:
                                case 7:
                                case 8:
                                    null != (r = i[n]) && (a.seek(d, 6), a.writeS(r)), null != (r = i[n + "-prompt"]) && (a.seek(d, 4),
                                        a.writeS(r));
                                    break;

                                case 10:
                                    for (a.seek(d, 8), a.skip(2), o = a.getInt16(), h = 0; h < o; h++) s = a.getInt16(),
                                        s += a.pos, a.skip(2), null != (r = i[n + "-" + h]) ? a.writeS(r) : a.skip(2), null != (r = i[n + "-" + h + "-0"]) && a.writeS(r),
                                        a.pos = s;
                                    break;

                                case 11:
                                    a.seek(d, 6) && a.readByte() == p && (null != (r = i[n]) ? a.writeS(r) : a.skip(2),
                                        a.skip(2), a.readBool() && a.skip(4), a.skip(4), a.readBool() && null != (r = i[n + "-prompt"]) && a.writeS(r));
                                    break;

                                case 12:
                                    a.seek(d, 6) && a.readByte() == p && (null != (r = i[n]) ? a.writeS(r) : a.skip(2),
                                        null != (r = i[n + "-0"]) && a.writeS(r));
                                    break;

                                case 13:
                                    if (a.seek(d, 6) && a.readByte() == p) {
                                        for (o = a.getInt16(), h = 0; h < o; h++) s = a.getInt16(), s += a.pos, null != (r = i[n + "-" + h]) && a.writeS(r),
                                            a.pos = s;
                                        null != (r = i[n]) && a.writeS(r);
                                    }
                            }
                            a.pos = d + c;
                        }
                    }
                }
            }, t.findChildNode = function (t, e) {
                var i = t.childNodes, n = i.length;
                if (n > 0) for (var r = 0; r < n; r++) {
                    var a = i[r];
                    if (a.nodeName == e) return a;
                }
                return null;
            }, t.strings = null, t;
        }(), W = function () {
            function t(t) {
                this._data = null, this._parent = null, this._children = null, this._expanded = !1,
                    this._tree = null, this._cell = null, this._level = 0, t && (this._children = []);
            }
            r(t, "fairygui.tree.TreeNode");
            var e = t.prototype;
            return e.setCell = function (t) {
                this._cell = t;
            }, e.setLevel = function (t) {
                this._level = t;
            }, e.addChild = function (t) {
                return this.addChildAt(t, this._children.length), t;
            }, e.addChildAt = function (t, e) {
                if (!t) throw new Error("child is null");
                var i = this._children.length;
                if (e >= 0 && e <= i) {
                    if (t._parent == this) this.setChildIndex(t, e); else t._parent && t._parent.removeChild(t),
                        e == this._children.length ? this._children.push(t) : this._children.splice(e, 0, t),
                        t._parent = this, t._level = this._level + 1, t.setTree(this._tree), null != this._cell && null != this._cell.parent && this._expanded && this._tree.afterInserted(t);
                    return t;
                }
                throw new Error("Invalid child index");
            }, e.removeChild = function (t) {
                var e = this._children.indexOf(t);
                return -1 != e && this.removeChildAt(e), t;
            }, e.removeChildAt = function (t) {
                if (t >= 0 && t < this.numChildren) {
                    var e = this._children[t];
                    return this._children.splice(t, 1), e._parent = null, null != this._tree && (e.setTree(null),
                        this._tree.afterRemoved(e)), e;
                }
                throw new Error("Invalid child index");
            }, e.removeChildren = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), (e < 0 || e >= this.numChildren) && (e = this.numChildren - 1);
                for (var i = t; i <= e; ++i) this.removeChildAt(t);
            }, e.getChildAt = function (t) {
                if (t >= 0 && t < this.numChildren) return this._children[t];
                throw new Error("Invalid child index");
            }, e.getChildIndex = function (t) {
                return this._children.indexOf(t);
            }, e.getPrevSibling = function () {
                if (null == this._parent) return null;
                var t = this._parent._children.indexOf(this);
                return t <= 0 ? null : this._parent._children[t - 1];
            }, e.getNextSibling = function () {
                if (null == this._parent) return null;
                var t = this._parent._children.indexOf(this);
                return t < 0 || t >= this._parent._children.length - 1 ? null : this._parent._children[t + 1];
            }, e.setChildIndex = function (t, e) {
                var i = this._children.indexOf(t);
                if (-1 == i) throw new Error("Not a child of this container");
                var n = this._children.length;
                e < 0 ? e = 0 : e > n && (e = n), i != e && (this._children.splice(i, 1), this._children.splice(e, 0, t),
                    null != this._cell && null != this._cell.parent && this._expanded && this._tree.afterMoved(t));
            }, e.swapChildren = function (t, e) {
                var i = this._children.indexOf(t), n = this._children.indexOf(e);
                if (-1 == i || -1 == n) throw new Error("Not a child of this container");
                this.swapChildrenAt(i, n);
            }, e.swapChildrenAt = function (t, e) {
                var i = this._children[t], n = this._children[e];
                this.setChildIndex(i, e), this.setChildIndex(n, t);
            }, e.setTree = function (t) {
                if (this._tree = t, null != this._tree && this._tree.treeNodeWillExpand && this._expanded && this._tree.treeNodeWillExpand.runWith(this),
                    null != this._children) for (var e = this._children.length, i = 0; i < e; i++) {
                        var n = this._children[i];
                        n._level = this._level + 1, n.setTree(t);
                    }
            }, a(0, e, "expanded", function () {
                return this._expanded;
            }, function (t) {
                null != this._children && this._expanded != t && (this._expanded = t, null != this._tree && (this._expanded ? this._tree.afterExpanded(this) : this._tree.afterCollapsed(this)));
            }), a(0, e, "tree", function () {
                return this._tree;
            }), a(0, e, "level", function () {
                return this._level;
            }), a(0, e, "cell", function () {
                return this._cell;
            }), a(0, e, "data", function () {
                return this._data;
            }, function (t) {
                this._data = t;
            }), a(0, e, "parent", function () {
                return this._parent;
            }), a(0, e, "isFolder", function () {
                return null != this._children;
            }), a(0, e, "text", function () {
                return null != this._cell ? this._cell.text : null;
            }), a(0, e, "numChildren", function () {
                return this._children.length;
            }), t;
        }(), X = (function () {
            function t(t) {
                this._list = null, this._root = null, this._indent = 0, this.treeNodeCreateCell = null,
                    this.treeNodeRender = null, this.treeNodeWillExpand = null, this.treeNodeClick = null,
                    this._list = t, this._list.removeChildrenToPool(), this._list.on("fui_click_item", this, this.__clickItem),
                    this._root = new W(!0), this._root.setTree(this), this._root.setCell(this._list),
                    this._root.expanded = !0, this._indent = 15;
            }
            r(t, "fairygui.tree.TreeView");
            var e = t.prototype;
            e.getSelectedNode = function () {
                return -1 != this._list.selectedIndex ? this._list.getChildAt(this._list.selectedIndex).data : null;
            }, e.getSelection = function () {
                for (var t = this._list.getSelection(), e = t.length, i = [], n = 0; n < e; n++) {
                    var r = this._list.getChildAt(t[n]).data;
                    i.push(r);
                }
                return i;
            }, e.addSelection = function (t, e) {
                void 0 === e && (e = !1);
                for (var i = t.parent; null != i && i != this._root;) i.expanded = !0, i = i.parent;
                t.cell && this._list.addSelection(this._list.getChildIndex(t.cell), e);
            }, e.removeSelection = function (t) {
                t.cell && this._list.removeSelection(this._list.getChildIndex(t.cell));
            }, e.clearSelection = function () {
                this._list.clearSelection();
            }, e.getNodeIndex = function (t) {
                return this._list.getChildIndex(t.cell);
            }, e.updateNode = function (t) {
                null != t.cell && this.treeNodeRender && this.treeNodeRender.runWith(t);
            }, e.updateNodes = function (t) {
                for (var e = t.length, i = 0; i < e; i++) {
                    var n = t[i];
                    if (null == n.cell) return;
                    this.treeNodeRender && this.treeNodeRender.runWith(n);
                }
            }, e.expandAll = function (t) {
                t.expanded = !0;
                for (var e = t.numChildren, i = 0; i < e; i++) {
                    var n = t.getChildAt(i);
                    n.isFolder && this.expandAll(n);
                }
            }, e.collapseAll = function (t) {
                t != this._root && (t.expanded = !1);
                for (var e = t.numChildren, i = 0; i < e; i++) {
                    var n = t.getChildAt(i);
                    n.isFolder && this.collapseAll(n);
                }
            }, e.createCell = function (t) {
                this.treeNodeCreateCell ? t.setCell(this.treeNodeCreateCell.runWith(t)) : t.setCell(this._list.itemPool.getObject(this._list.defaultItem)),
                    t.cell.data = t;
                var e = t.cell.getChild("indent");
                null != e && (e.width = (t.level - 1) * this._indent);
                var i = t.cell.getChild("expandButton");
                i && (t.isFolder ? (i.visible = !0, i.onClick(this, this.__clickExpandButton), i.data = t,
                    i.selected = t.expanded) : i.visible = !1), this.treeNodeRender && this.treeNodeRender.runWith(t);
            }, e.afterInserted = function (t) {
                this.createCell(t);
                var e = this.getInsertIndexForNode(t);
                this._list.addChildAt(t.cell, e), this.treeNodeRender && this.treeNodeRender.runWith(t),
                    t.isFolder && t.expanded && this.checkChildren(t, e);
            }, e.getInsertIndexForNode = function (t) {
                var e = t.getPrevSibling();
                null == e && (e = t.parent);
                for (var i = this._list.getChildIndex(e.cell) + 1, n = t.level, r = this._list.numChildren, a = i; a < r; a++) {
                    if (this._list.getChildAt(a).data.level <= n) break;
                    i++;
                }
                return i;
            }, e.afterRemoved = function (t) {
                this.removeNode(t);
            }, e.afterExpanded = function (t) {
                if (t != this._root && this.treeNodeWillExpand && this.treeNodeWillExpand(t), null != t.cell) {
                    if (t != this._root) {
                        this.treeNodeRender && this.treeNodeRender.runWith(t);
                        var e = t.cell.getChild("expandButton");
                        e && (e.selected = !0);
                    }
                    null != t.cell.parent && this.checkChildren(t, this._list.getChildIndex(t.cell));
                }
            }, e.afterCollapsed = function (t) {
                if (t != this._root && this.treeNodeWillExpand && this.treeNodeWillExpand(t), null != t.cell) {
                    if (t != this._root) {
                        this.treeNodeRender && this.treeNodeRender.runWith(t);
                        var e = t.cell.getChild("expandButton");
                        e && (e.selected = !1);
                    }
                    null != t.cell.parent && this.hideFolderNode(t);
                }
            }, e.afterMoved = function (t) {
                t.isFolder ? this.hideFolderNode(t) : this._list.removeChild(t.cell);
                var e = this.getInsertIndexForNode(t);
                this._list.addChildAt(t.cell, e), t.isFolder && t.expanded && this.checkChildren(t, e);
            }, e.checkChildren = function (t, e) {
                for (var i = t.numChildren, n = 0; n < i; n++) {
                    e++;
                    var r = t.getChildAt(n);
                    null == r.cell && this.createCell(r), r.cell.parent || this._list.addChildAt(r.cell, e),
                        r.isFolder && r.expanded && (e = this.checkChildren(r, e));
                }
                return e;
            }, e.hideFolderNode = function (t) {
                for (var e = t.numChildren, i = 0; i < e; i++) {
                    var n = t.getChildAt(i);
                    n.cell && null != n.cell.parent && this._list.removeChild(n.cell), n.isFolder && n.expanded && this.hideFolderNode(n);
                }
            }, e.removeNode = function (t) {
                if (null != t.cell && (null != t.cell.parent && this._list.removeChild(t.cell),
                    this._list.returnToPool(t.cell), t.cell.data = null, t.setCell(null)), t.isFolder) for (var e = t.numChildren, i = 0; i < e; i++) {
                        var n = t.getChildAt(i);
                        this.removeNode(n);
                    }
            }, e.__clickExpandButton = function (t) {
                t.stopPropagation();
                var e = L.cast(t.currentTarget), i = e.parent.data;
                if (null != this._list.scrollPane) {
                    var n = this._list.scrollPane.posY;
                    e.selected ? i.expanded = !0 : i.expanded = !1, this._list.scrollPane.posY = n,
                        this._list.scrollPane.scrollToView(i.cell);
                } else e.selected ? i.expanded = !0 : i.expanded = !1;
            }, e.__clickItem = function (t, e) {
                if (null != this._list.scrollPane) var i = this._list.scrollPane.posY;
                var n = t.data;
                this.treeNodeClick && this.treeNodeClick.runWith([n, e]), null != this._list.scrollPane && (this._list.scrollPane.posY = i,
                    n.cell && this._list.scrollPane.scrollToView(n.cell));
            }, a(0, e, "list", function () {
                return this._list;
            }), a(0, e, "root", function () {
                return this._root;
            }), a(0, e, "indent", function () {
                return this._indent;
            }, function (t) {
                this._indent = t;
            });
        }(), function () {
            var t;
            function e() { }
            return r(e, "fairygui.tween.EaseManager"), e.evaluate = function (i, n, r, a, s) {
                switch (i) {
                    case 0:
                        return n / r;

                    case 1:
                        return 1 - Math.cos(n / r * e._PiOver2);

                    case 2:
                        return Math.sin(n / r * e._PiOver2);

                    case 3:
                        return -.5 * (Math.cos(Math.PI * n / r) - 1);

                    case 4:
                        return (n /= r) * n;

                    case 5:
                        return -(n /= r) * (n - 2);

                    case 6:
                        return (n /= .5 * r) < 1 ? .5 * n * n : -.5 * (--n * (n - 2) - 1);

                    case 7:
                        return (n /= r) * n * n;

                    case 8:
                        return (n = n / r - 1) * n * n + 1;

                    case 9:
                        return (n /= .5 * r) < 1 ? .5 * n * n * n : .5 * ((n -= 2) * n * n + 2);

                    case 10:
                        return (n /= r) * n * n * n;

                    case 11:
                        return -((n = n / r - 1) * n * n * n - 1);

                    case 12:
                        return (n /= .5 * r) < 1 ? .5 * n * n * n * n : -.5 * ((n -= 2) * n * n * n - 2);

                    case 13:
                        return (n /= r) * n * n * n * n;

                    case 14:
                        return (n = n / r - 1) * n * n * n * n + 1;

                    case 15:
                        return (n /= .5 * r) < 1 ? .5 * n * n * n * n * n : .5 * ((n -= 2) * n * n * n * n + 2);

                    case 16:
                        return 0 == n ? 0 : Math.pow(2, 10 * (n / r - 1));

                    case 17:
                        return n == r ? 1 : 1 - Math.pow(2, -10 * n / r);

                    case 18:
                        return 0 == n ? 0 : n == r ? 1 : (n /= .5 * r) < 1 ? .5 * Math.pow(2, 10 * (n - 1)) : .5 * (2 - Math.pow(2, -10 * --n));

                    case 19:
                        return -(Math.sqrt(1 - (n /= r) * n) - 1);

                    case 20:
                        return Math.sqrt(1 - (n = n / r - 1) * n);

                    case 21:
                        return (n /= .5 * r) < 1 ? -.5 * (Math.sqrt(1 - n * n) - 1) : .5 * (Math.sqrt(1 - (n -= 2) * n) + 1);

                    case 22:
                        var o = NaN;
                        return 0 == n ? 0 : 1 == (n /= r) ? 1 : (0 == s && (s = .3 * r), a < 1 ? (a = 1,
                            o = s / 4) : o = s / e._TwoPi * Math.asin(1 / a), -a * Math.pow(2, 10 * (n -= 1)) * Math.sin((n * r - o) * e._TwoPi / s));

                    case 23:
                        var l = NaN;
                        return 0 == n ? 0 : 1 == (n /= r) ? 1 : (0 == s && (s = .3 * r), a < 1 ? (a = 1,
                            l = s / 4) : l = s / e._TwoPi * Math.asin(1 / a), a * Math.pow(2, -10 * n) * Math.sin((n * r - l) * e._TwoPi / s) + 1);

                    case 24:
                        var h = NaN;
                        return 0 == n ? 0 : 2 == (n /= .5 * r) ? 1 : (0 == s && (s = r * (.3 * 1.5)), a < 1 ? (a = 1,
                            h = s / 4) : h = s / e._TwoPi * Math.asin(1 / a), n < 1 ? a * Math.pow(2, 10 * (n -= 1)) * Math.sin((n * r - h) * e._TwoPi / s) * -.5 : a * Math.pow(2, -10 * (n -= 1)) * Math.sin((n * r - h) * e._TwoPi / s) * .5 + 1);

                    case 25:
                        return (n /= r) * n * ((a + 1) * n - a);

                    case 26:
                        return (n = n / r - 1) * n * ((a + 1) * n + a) + 1;

                    case 27:
                        return (n /= .5 * r) < 1 ? n * n * ((1 + (a *= 1.525)) * n - a) * .5 : .5 * ((n -= 2) * n * ((1 + (a *= 1.525)) * n + a) + 2);

                    case 28:
                        return t.easeIn(n, r);

                    case 29:
                        return t.easeOut(n, r);

                    case 30:
                        return t.easeInOut(n, r);

                    default:
                        return -(n /= r) * (n - 2);
                }
            }, n(e, ["_PiOver2", function () {
                return this._PiOver2 = .5 * Math.PI;
            }, "_TwoPi", function () {
                return this._TwoPi = 2 * Math.PI;
            }]), e.__init$ = function () {
                t = function () {
                    function t() { }
                    return r(t, ""), t.easeIn = function (e, i) {
                        return 1 - t.easeOut(i - e, i);
                    }, t.easeOut = function (t, e) {
                        return (t /= e) < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
                    }, t.easeInOut = function (e, i) {
                        return e < .5 * i ? .5 * t.easeIn(2 * e, i) : .5 * t.easeOut(2 * e - i, i) + .5;
                    }, t;
                }();
            }, e;
        }()), Y = (function () {
            function t() { }
            r(t, "fairygui.tween.EaseType"), t.Linear = 0, t.SineIn = 1, t.SineOut = 2, t.SineInOut = 3,
                t.QuadIn = 4, t.QuadOut = 5, t.QuadInOut = 6, t.CubicIn = 7, t.CubicOut = 8, t.CubicInOut = 9,
                t.QuartIn = 10, t.QuartOut = 11, t.QuartInOut = 12, t.QuintIn = 13, t.QuintOut = 14,
                t.QuintInOut = 15, t.ExpoIn = 16, t.ExpoOut = 17, t.ExpoInOut = 18, t.CircIn = 19,
                t.CircOut = 20, t.CircInOut = 21, t.ElasticIn = 22, t.ElasticOut = 23, t.ElasticInOut = 24,
                t.BackIn = 25, t.BackOut = 26, t.BackInOut = 27, t.BounceIn = 28, t.BounceOut = 29,
                t.BounceInOut = 30, t.Custom = 31;
        }(), function () {
            function t() { }
            return r(t, "fairygui.tween.GTween"), t.to = function (t, e, i) {
                return K.createTween()._to(t, e, i);
            }, t.to2 = function (t, e, i, n, r) {
                return K.createTween()._to2(t, e, i, n, r);
            }, t.to3 = function (t, e, i, n, r, a, s) {
                return K.createTween()._to3(t, e, i, n, r, a, s);
            }, t.to4 = function (t, e, i, n, r, a, s, o, l) {
                return K.createTween()._to4(t, e, i, n, r, a, s, o, l);
            }, t.toColor = function (t, e, i) {
                return K.createTween()._toColor(t, e, i);
            }, t.delayedCall = function (t) {
                return K.createTween().setDelay(t);
            }, t.shake = function (t, e, i, n) {
                return K.createTween()._shake(t, e, i, n);
            }, t.isTweening = function (t, e) {
                return K.isTweening(t, e);
            }, t.kill = function (t, e, i) {
                void 0 === e && (e = !1), K.killTweens(t, !1, null);
            }, t.getTween = function (t, e) {
                return K.getTween(t, e);
            }, t.catchCallbackExceptions = !0, t;
        }()), q = function () {
            function t() {
                this._target = null, this._propType = null, this._killed = !1, this._paused = !1,
                    this._delay = NaN, this._duration = NaN, this._breakpoint = NaN, this._easeType = 0,
                    this._easeOvershootOrAmplitude = NaN, this._easePeriod = NaN, this._repeat = 0,
                    this._yoyo = !1, this._timeScale = NaN, this._snapping = !1, this._userData = null,
                    this._onUpdate = null, this._onUpdateCaller = null, this._onStart = null, this._onStartCaller = null,
                    this._onComplete = null, this._onCompleteCaller = null, this._startValue = null,
                    this._endValue = null, this._value = null, this._deltaValue = null, this._valueSize = 0,
                    this._started = !1, this._ended = 0, this._elapsedTime = NaN, this._normalizedTime = NaN,
                    this._startValue = new Z(), this._endValue = new Z(), this._value = new Z(), this._deltaValue = new Z(),
                    this._reset();
            }
            r(t, "fairygui.tween.GTweener");
            var e = t.prototype;
            return e.setDelay = function (t) {
                return this._delay = t, this;
            }, e.setDuration = function (t) {
                return this._duration = t, this;
            }, e.setBreakpoint = function (t) {
                return this._breakpoint = t, this;
            }, e.setEase = function (t) {
                return this._easeType = t, this;
            }, e.setEasePeriod = function (t) {
                return this._easePeriod = t, this;
            }, e.setEaseOvershootOrAmplitude = function (t) {
                return this._easeOvershootOrAmplitude = t, this;
            }, e.setRepeat = function (t, e) {
                return void 0 === e && (e = !1), this._repeat = t, this._yoyo = e, this;
            }, e.setTimeScale = function (t) {
                return this._timeScale = t, this;
            }, e.setSnapping = function (t) {
                return this._snapping = t, this;
            }, e.setTarget = function (t, e) {
                return this._target = t, this._propType = e, this;
            }, e.setUserData = function (t) {
                return this._userData = t, this;
            }, e.onUpdate = function (t, e) {
                return this._onUpdate = t, this._onUpdateCaller = e, this;
            }, e.onStart = function (t, e) {
                return this._onStart = t, this._onStartCaller = e, this;
            }, e.onComplete = function (t, e) {
                return this._onComplete = t, this._onCompleteCaller = e, this;
            }, e.setPaused = function (t) {
                return this._paused = t, this;
            }, e.seek = function (t) {
                if (!this._killed) {
                    if (this._elapsedTime = t, this._elapsedTime < this._delay) {
                        if (!this._started) return;
                        this._elapsedTime = this._delay;
                    }
                    this.update();
                }
            }, e.kill = function (t) {
                void 0 === t && (t = !1), this._killed || (t && (0 == this._ended && (this._breakpoint >= 0 ? this._elapsedTime = this._delay + this._breakpoint : this._repeat >= 0 ? this._elapsedTime = this._delay + this._duration * (this._repeat + 1) : this._elapsedTime = this._delay + 2 * this._duration,
                    this.update()), this.callCompleteCallback()), this._killed = !0);
            }, e._to = function (t, e, i) {
                return this._valueSize = 1, this._startValue.x = t, this._endValue.x = e, this._duration = i,
                    this;
            }, e._to2 = function (t, e, i, n, r) {
                return this._valueSize = 2, this._startValue.x = t, this._endValue.x = i, this._startValue.y = e,
                    this._endValue.y = n, this._duration = r, this;
            }, e._to3 = function (t, e, i, n, r, a, s) {
                return this._valueSize = 3, this._startValue.x = t, this._endValue.x = n, this._startValue.y = e,
                    this._endValue.y = r, this._startValue.z = i, this._endValue.z = a, this._duration = s,
                    this;
            }, e._to4 = function (t, e, i, n, r, a, s, o, l) {
                return this._valueSize = 4, this._startValue.x = t, this._endValue.x = r, this._startValue.y = e,
                    this._endValue.y = a, this._startValue.z = i, this._endValue.z = s, this._startValue.w = n,
                    this._endValue.w = o, this._duration = l, this;
            }, e._toColor = function (t, e, i) {
                return this._valueSize = 4, this._startValue.color = t, this._endValue.color = e,
                    this._duration = i, this;
            }, e._shake = function (t, e, i, n) {
                return this._valueSize = 5, this._startValue.x = t, this._startValue.y = e, this._startValue.w = i,
                    this._duration = n, this._easeType = 0, this;
            }, e._init = function () {
                this._delay = 0, this._duration = 0, this._breakpoint = -1, this._easeType = 5,
                    this._timeScale = 1, this._easePeriod = 0, this._easeOvershootOrAmplitude = 1.70158,
                    this._snapping = !1, this._repeat = 0, this._yoyo = !1, this._valueSize = 0, this._started = !1,
                    this._paused = !1, this._killed = !1, this._elapsedTime = 0, this._normalizedTime = 0,
                    this._ended = 0;
            }, e._reset = function () {
                this._target = null, this._userData = null, this._onStart = this._onUpdate = this._onComplete = null,
                    this._onStartCaller = this._onUpdateCaller = this._onCompleteCaller = null;
            }, e._update = function (t) {
                if (1 != this._timeScale && (t *= this._timeScale), 0 != t) {
                    if (0 != this._ended) return this.callCompleteCallback(), void (this._killed = !0);
                    this._elapsedTime += t, this.update(), 0 != this._ended && (this._killed || (this.callCompleteCallback(),
                        this._killed = !0));
                }
            }, e.update = function () {
                if (this._ended = 0, 0 != this._valueSize) {
                    if (!this._started) {
                        if (this._elapsedTime < this._delay) return;
                        if (this._started = !0, this.callStartCallback(), this._killed) return;
                    }
                    var t = !1, e = this._elapsedTime - this._delay;
                    if (this._breakpoint >= 0 && e >= this._breakpoint && (e = this._breakpoint, this._ended = 2),
                        0 != this._repeat) {
                        var i = Math.floor(e / this._duration);
                        e -= this._duration * i, this._yoyo && (t = i % 2 == 1), this._repeat > 0 && this._repeat - i < 0 && (this._yoyo && (t = this._repeat % 2 == 1),
                            e = this._duration, this._ended = 1);
                    } else e >= this._duration && (e = this._duration, this._ended = 1);
                    if (this._normalizedTime = X.evaluate(this._easeType, t ? this._duration - e : e, this._duration, this._easeOvershootOrAmplitude, this._easePeriod),
                        this._value.setZero(), this._deltaValue.setZero(), 5 == this._valueSize) if (0 == this._ended) {
                            var n = this._startValue.w * (1 - this._normalizedTime), r = (2 * Math.random() - 1) * n, a = (2 * Math.random() - 1) * n;
                            r = r > 0 ? Math.ceil(r) : Math.floor(r), a = a > 0 ? Math.ceil(a) : Math.floor(a),
                                this._deltaValue.x = r, this._deltaValue.y = a, this._value.x = this._startValue.x + r,
                                this._value.y = this._startValue.y + a;
                        } else this._value.x = this._startValue.x, this._value.y = this._startValue.y; else for (var s = 0; s < this._valueSize; s++) {
                            var o = this._startValue.getField(s), l = o + (this._endValue.getField(s) - o) * this._normalizedTime;
                            this._snapping && (l = Math.round(l)), this._deltaValue.setField(s, l - this._value.getField(s)),
                                this._value.setField(s, l);
                        }
                    if (null != this._target && null != this._propType) if ("function" == typeof this._propType) switch (this._valueSize) {
                        case 1:
                            this._propType.call(this._target, this._value.x);
                            break;

                        case 2:
                            this._propType.call(this._target, this._value.x, this._value.y);
                            break;

                        case 3:
                            this._propType.call(this._target, this._value.x, this._value.y, this._value.z);
                            break;

                        case 4:
                            this._propType.call(this._target, this._value.x, this._value.y, this._value.z, this._value.w);
                            break;

                        case 5:
                            this._propType.call(this._target, this._value.color);
                            break;

                        case 6:
                            this._propType.call(this._target, this._value.x, this._value.y);
                    } else 5 == this._valueSize ? this._target[this._propType] = this._value.color : this._target[this._propType] = this._value.x;
                    this.callUpdateCallback();
                } else this._elapsedTime >= this._delay + this._duration && (this._ended = 1);
            }, e.callStartCallback = function () {
                if (null != this._onStart) if (Y.catchCallbackExceptions) try {
                    this._onStart.call(this._onStartCaller, this);
                } catch (t) {
                    console.log("FairyGUI: error in start callback > " + t.message, t.stack);
                } else this._onStart.call(this._onStartCaller, this);
            }, e.callUpdateCallback = function () {
                if (null != this._onUpdate) if (Y.catchCallbackExceptions) try {
                    this._onUpdate.call(this._onUpdateCaller, this);
                } catch (t) {
                    console.log("FairyGUI: error in update callback > " + t.message, t.stack);
                } else this._onUpdate.call(this._onUpdateCaller, this);
            }, e.callCompleteCallback = function () {
                if (null != this._onComplete) if (Y.catchCallbackExceptions) try {
                    this._onComplete.call(this._onCompleteCaller, this);
                } catch (t) {
                    console.log("FairyGUI: error in complete callback > " + t.message, t.stack);
                } else this._onComplete.call(this._onCompleteCaller, this);
            }, a(0, e, "target", function () {
                return this._target;
            }), a(0, e, "delay", function () {
                return this._delay;
            }), a(0, e, "duration", function () {
                return this._duration;
            }), a(0, e, "value", function () {
                return this._value;
            }), a(0, e, "userData", function () {
                return this._userData;
            }), a(0, e, "repeat", function () {
                return this._repeat;
            }), a(0, e, "startValue", function () {
                return this._startValue;
            }), a(0, e, "endValue", function () {
                return this._endValue;
            }), a(0, e, "deltaValue", function () {
                return this._deltaValue;
            }), a(0, e, "normalizedTime", function () {
                return this._normalizedTime;
            }), a(0, e, "completed", function () {
                return 0 != this._ended;
            }), a(0, e, "allCompleted", function () {
                return 1 == this._ended;
            }), t;
        }(), K = function () {
            function t() { }
            return r(t, "fairygui.tween.TweenManager"), t.createTween = function () {
                var e;
                return t._inited || (i.timer.frameLoop(1, null, t.update), t._inited = !0), (e = t._tweenerPool.length > 0 ? t._tweenerPool.pop() : new q())._init(),
                    t._activeTweens[t._totalActiveTweens++] = e, t._totalActiveTweens == t._activeTweens.length && (t._activeTweens.length = t._activeTweens.length + Math.ceil(.5 * t._activeTweens.length)),
                    e;
            }, t.isTweening = function (e, i) {
                if (null == e) return !1;
                for (var n = null == i, r = 0; r < t._totalActiveTweens; r++) {
                    var a = t._activeTweens[r];
                    if (null != a && a.target == e && !a._killed && (n || a._propType == i)) return !0;
                }
                return !1;
            }, t.killTweens = function (e, i, n) {
                if (null == e) return !1;
                for (var r = !1, a = t._totalActiveTweens, s = null == n, o = 0; o < a; o++) {
                    var l = t._activeTweens[o];
                    null == l || l.target != e || l._killed || !s && l._propType != n || (l.kill(i),
                        r = !0);
                }
                return r;
            }, t.getTween = function (e, i) {
                if (null == e) return null;
                for (var n = t._totalActiveTweens, r = null == i, a = 0; a < n; a++) {
                    var s = t._activeTweens[a];
                    if (null != s && s.target == e && !s._killed && (r || s._propType == i)) return s;
                }
                return null;
            }, t.update = function () {
                for (var e = i.timer.delta / 1e3, n = t._totalActiveTweens, r = -1, a = 0; a < n; a++) {
                    var s = t._activeTweens[a];
                    null == s ? -1 == r && (r = a) : s._killed ? (s._reset(), t._tweenerPool.push(s),
                        t._activeTweens[a] = null, -1 == r && (r = a)) : (s._paused || s._update(e), -1 != r && (t._activeTweens[r] = s,
                            t._activeTweens[a] = null, r++));
                }
                if (r >= 0) {
                    if (t._totalActiveTweens != n) {
                        var o = n;
                        for (n = t._totalActiveTweens - n, a = 0; a < n; a++) t._activeTweens[r++] = t._activeTweens[o++];
                    }
                    t._totalActiveTweens = r;
                }
            }, t._tweenerPool = [], t._totalActiveTweens = 0, t._inited = !1, n(t, ["_activeTweens", function () {
                return this._activeTweens = new Array(30);
            }]), t;
        }(), Z = function () {
            function t() {
                this.x = NaN, this.y = NaN, this.z = NaN, this.w = NaN, this.x = this.y = this.z = this.w = 0;
            }
            r(t, "fairygui.tween.TweenValue");
            var e = t.prototype;
            return e.getField = function (t) {
                switch (t) {
                    case 0:
                        return this.x;

                    case 1:
                        return this.y;

                    case 2:
                        return this.z;

                    case 3:
                        return this.w;

                    default:
                        throw new Error("Index out of bounds: " + t);
                }
            }, e.setField = function (t, e) {
                switch (t) {
                    case 0:
                        this.x = e;
                        break;

                    case 1:
                        this.y = e;
                        break;

                    case 2:
                        this.z = e;
                        break;

                    case 3:
                        this.w = e;
                        break;

                    default:
                        throw new Error("Index out of bounds: " + t);
                }
            }, e.setZero = function () {
                this.x = this.y = this.z = this.w = 0;
            }, a(0, e, "color", function () {
                return (this.w << 24) + (this.x << 16) + (this.y << 8) + this.z;
            }, function (t) {
                this.x = (16711680 & t) >> 16, this.y = (65280 & t) >> 8, this.z = 255 & t, this.w = (4278190080 & t) >> 24;
            }), t;
        }(), Q = function () {
            function t() { }
            return r(t, "fairygui.UIConfig", null, "UIConfig$1"), t.defaultFont = "Arial",
                t.windowModalWaiting = null, t.globalModalWaiting = null, t.modalLayerColor = "rgba(33,33,33,0.2)",
                t.buttonSound = null, t.buttonSoundVolumeScale = 1, t.horizontalScrollBar = null,
                t.verticalScrollBar = null, t.defaultScrollStep = 25, t.defaultScrollDecelerationRate = .967,
                t.defaultScrollBarDisplay = 1, t.defaultScrollTouchEffect = !0, t.defaultScrollBounceEffect = !0,
                t.popupMenu = null, t.popupMenu_seperator = null, t.loaderErrorSign = null, t.tooltipsWin = null,
                t.defaultComboBoxVisibleItemCount = 10, t.touchScrollSensitivity = 20, t.touchDragSensitivity = 10,
                t.clickDragSensitivity = 2, t.bringWindowToFrontOnClick = !0, t.frameTimeForAsyncUIConstruction = 2,
                t.textureLinearSampling = !0, t.packageFileExtension = "fui", t;
        }(), J = function () {
            function t() { }
            return r(t, "fairygui.UIObjectFactory"), t.setPackageItemExtension = function (e, i) {
                if (null == e) throw new Error("Invaild url: " + e);
                var n = $.getItemByURL(e);
                null != n && (n.extensionType = i), t.packageItemExtensions[e] = i;
            }, t.setLoaderExtension = function (t) {
                fairygui.UIObjectFactory.loaderType = t;
            }, t.resolvePackageItemExtension = function (e) {
                e.extensionType = t.packageItemExtensions["ui://" + e.owner.id + e.id], e.extensionType || (e.extensionType = t.packageItemExtensions["ui://" + e.owner.name + "/" + e.name]);
            }, t.newObject = function (e) {
                return null != e.extensionType ? new e.extensionType() : t.newObject2(e.objectType);
            }, t.newObject2 = function (t) {
                switch (t) {
                    case 0:
                        return new Tt();

                    case 1:
                        return new xt();

                    case 9:
                        return new ct();

                    case 6:
                        return new bt();

                    case 7:
                        return new Mt();

                    case 8:
                        return new Lt();

                    case 5:
                        return new St();

                    case 10:
                        return new Rt();

                    case 3:
                        return new yt();

                    case 4:
                        return null != fairygui.UIObjectFactory.loaderType ? new fairygui.UIObjectFactory.loaderType() : new Ct();

                    case 12:
                        return new It();

                    case 11:
                        return new At();

                    case 14:
                        return new Dt();

                    case 15:
                        return new Nt();

                    case 16:
                        return new Pt();

                    case 13:
                        return new wt();

                    default:
                        return null;
                }
            }, t.packageItemExtensions = {}, t.loaderType = null, t;
        }(), $ = function () {
            var t;
            function e() {
                this._id = null, this._name = null, this._items = null, this._itemsById = null,
                    this._itemsByName = null, this._customId = null, this._sprites = null, this._items = [],
                    this._itemsById = {}, this._itemsByName = {}, this._sprites = {};
            }
            r(e, "fairygui.UIPackage");
            var n = e.prototype;
            return n.loadPackage = function (e, i) {
                if (1179080009 != e.getUint32()) throw new Error("FairyGUI: old package format found in '" + i + "'");
                e.version = e.getInt32();
                var n = e.readBool();
                if (this._id = e.readUTFString(), this._name = e.readUTFString(), e.skip(20), n) {
                    var r = new Uint8Array(e.buffer, e.pos, e.length - e.pos);
                    r = new Zlib.RawInflate(r).decompress(), e = new at(r);
                }
                var a = e.pos, o = 0, l = 0, h = 0;
                e.seek(a, 4), o = e.getInt32();
                var u, c = s(o);
                for (l = 0; l < o; l++) c[l] = e.readUTFString();
                for (e.stringTable = c, e.seek(a, 1), i += "_", o = e.getUint16(), l = 0; l < o; l++) {
                    switch (h = e.getInt32(), h += e.pos, (u = new k()).owner = this, u.type = e.readByte(),
                    u.id = e.readS(), u.name = e.readS(), e.readS(), u.file = e.readS(), e.readBool(),
                    u.width = e.getInt32(), u.height = e.getInt32(), u.type) {
                        case 0:
                            u.objectType = 0;
                            var d = e.readByte();
                            1 == d ? (u.scale9Grid = new laya.maths.Rectangle(), u.scale9Grid.x = e.getInt32(),
                                u.scale9Grid.y = e.getInt32(), u.scale9Grid.width = e.getInt32(), u.scale9Grid.height = e.getInt32(),
                                u.tileGridIndice = e.getInt32()) : 2 == d && (u.scaleByTile = !0), u.smoothing = e.readBool();
                            break;

                        case 1:
                            u.smoothing = e.readBool(), u.objectType = 1, u.rawData = e.readBuffer();
                            break;

                        case 5:
                            u.rawData = e.readBuffer();
                            break;

                        case 3:
                            var _ = e.readByte();
                            u.objectType = _ > 0 ? _ : 9, u.rawData = e.readBuffer(), J.resolvePackageItemExtension(u);
                            break;

                        case 4:
                        case 2:
                        case 7:
                            u.file = i + u.file;
                    }
                    this._items.push(u), this._itemsById[u.id] = u, null != u.name && (this._itemsByName[u.name] = u),
                        e.pos = h;
                }
                for (e.seek(a, 2), o = e.getUint16(), l = 0; l < o; l++) {
                    h = e.getUint16(), h += e.pos;
                    var f = e.readS();
                    u = this._itemsById[e.readS()];
                    var p = new t();
                    p.atlas = u, p.rect.x = e.getInt32(), p.rect.y = e.getInt32(), p.rect.width = e.getInt32(),
                        p.rect.height = e.getInt32(), p.rotated = e.readBool(), this._sprites[f] = p, e.pos = h;
                }
                if (e.seek(a, 3)) for (o = e.getUint16(), l = 0; l < o; l++) h = e.getInt32(), h += e.pos,
                    (u = this._itemsById[e.readS()]) && 0 == u.type && (u.pixelHitTestData = new tt(),
                        u.pixelHitTestData.load(e)), e.pos = h;
            }, n.loadAllAssets = function () {
                for (var t = this._items.length, e = 0; e < t; e++) {
                    var i = this._items[e];
                    this.getItemAsset(i);
                }
            }, n.unloadAssets = function () {
                for (var t = this._items.length, e = 0; e < t; e++) {
                    var n = this._items[e];
                    4 == n.type && null != n.texture && i.loader.clearTextureRes(n.texture.url);
                }
            }, n.dispose = function () {
                for (var t = this._items.length, e = 0; e < t; e++) {
                    var i = this._items[e];
                    4 == i.type ? null != i.texture && (i.texture.destroy(), i.texture = null) : 2 == i.type && S.destroySound(i.file);
                }
            }, n.createObject = function (t, e) {
                var i = this._itemsByName[t];
                return i ? this.internalCreateObject(i, e) : null;
            }, n.internalCreateObject = function (t, e) {
                var i;
                return null == (i = 3 == t.type && null != e ? new e() : J.newObject(t)) ? null : (fairygui.UIPackage._constructing++,
                    i.packageItem = t, i.constructFromResource(), fairygui.UIPackage._constructing--,
                    i);
            }, n.getItemById = function (t) {
                return this._itemsById[t];
            }, n.getItemByName = function (t) {
                return this._itemsByName[t];
            }, n.getItemAssetByName = function (t) {
                var e = this._itemsByName[t];
                if (null == e) throw "Resource not found -" + t;
                return this.getItemAsset(e);
            }, n.getItemAsset = function (t) {
                switch (t.type) {
                    case 0:
                        if (!t.decoded) {
                            t.decoded = !0;
                            var e = this._sprites[t.id];
                            if (null != e) {
                                var i = this.getItemAsset(e.atlas);
                                t.texture = C.create(i, e.rect.x, e.rect.y, e.rect.width, e.rect.height);
                            } else t.texture = null;
                        }
                        return t.texture;

                    case 4:
                        return t.decoded || (t.decoded = !0, t.texture = I.inst.getRes(t.file)), t.texture;

                    case 5:
                        return t.decoded || (t.decoded = !0, this.loadFont(t)), t.bitmapFont;

                    case 1:
                        return t.decoded || (t.decoded = !0, this.loadMovieClip(t)), t.frames;

                    case 3:
                        return t.rawData;

                    case 7:
                        return t.file ? I.inst.getRes(t.file) : null;

                    default:
                        return null;
                }
            }, n.loadMovieClip = function (t) {
                var e = t.rawData;
                e.seek(0, 0), t.interval = e.getInt32(), t.swing = e.readBool(), t.repeatDelay = e.getInt32(),
                    e.seek(0, 1);
                var i, n, r, a = e.getInt16();
                t.frames = s(a);
                for (var o = NaN, l = NaN, h = 0; h < a; h++) {
                    var u = e.getInt16();
                    if (u += e.pos, n = new D(), o = e.getInt32(), l = e.getInt32(), e.getInt32(), e.getInt32(),
                        n.addDelay = e.getInt32(), null != (i = e.readS()) && null != (r = this._sprites[i])) {
                        var c = this.getItemAsset(r.atlas);
                        n.texture = C.create(c, r.rect.x, r.rect.y, r.rect.width, r.rect.height, o, l, t.width, t.height);
                    }
                    t.frames[h] = n, e.pos = u;
                }
            }, n.loadFont = function (t) {
                var e = new A();
                t.bitmapFont = e;
                var i = t.rawData;
                i.seek(0, 0), e.ttf = i.readBool(), i.readBool(), e.resizable = i.readBool(), i.readBool(),
                    e.size = i.getInt32();
                var n = i.getInt32(), r = i.getInt32(), a = null, s = this._sprites[t.id];
                null != s && (a = this.getItemAsset(s.atlas)), i.seek(0, 1);
                for (var o = null, l = i.getInt32(), h = 0; h < l; h++) {
                    var u = i.getInt16();
                    u += i.pos, o = new R();
                    var c = i.readChar();
                    e.glyphs[c] = o;
                    var d = i.readS(), _ = i.getInt32(), f = i.getInt32();
                    if (o.offsetX = i.getInt32(), o.offsetY = i.getInt32(), o.width = i.getInt32(),
                        o.height = i.getInt32(), o.advance = i.getInt32(), o.channel = i.readByte(), 1 == o.channel ? o.channel = 3 : 2 == o.channel ? o.channel = 2 : 3 == o.channel && (o.channel = 1),
                        e.ttf) o.texture = C.create(a, _ + s.rect.x, f + s.rect.y, o.width, o.height); else {
                        var p = this._itemsById[d];
                        p && (this.getItemAsset(p), o.width = p.width, o.height = p.height, o.texture = p.texture);
                    }
                    e.ttf ? o.lineHeight = r : (0 == o.advance && (o.advance = 0 == n ? o.offsetX + o.width : n),
                        o.lineHeight = o.offsetY < 0 ? o.height : o.offsetY + o.height, o.lineHeight < e.size && (o.lineHeight = e.size)),
                        i.pos = u;
                }
            }, a(0, n, "id", function () {
                return this._id;
            }), a(0, n, "name", function () {
                return this._name;
            }), a(0, n, "customId", function () {
                return this._customId;
            }, function (t) {
                null != this._customId && delete fairygui.UIPackage._packageInstById[this._customId],
                    this._customId = t, null != this._customId && (fairygui.UIPackage._packageInstById[this._customId] = this);
            }), e.getById = function (t) {
                return fairygui.UIPackage._packageInstById[t];
            }, e.getByName = function (t) {
                return fairygui.UIPackage._packageInstByName[t];
            }, e.addPackage = function (t, i) {
                if (!(i || (i = I.inst.getRes(t + "." + Q.packageFileExtension)) && 0 != i.byteLength)) throw new Error("package resource not ready: " + t);
                var n = new at(i), r = new e();
                return r.loadPackage(n, t), fairygui.UIPackage._packageInstById[r.id] = r, fairygui.UIPackage._packageInstByName[r.name] = r,
                    r.customId = t, r;
            }, e.removePackage = function (t) {
                var e = fairygui.UIPackage._packageInstById[t];
                if (e || (e = fairygui.UIPackage._packageInstByName[t]), !e) throw new Error("unknown package: " + t);
                e.dispose(), delete fairygui.UIPackage._packageInstById[e.id], null != e._customId && delete fairygui.UIPackage._packageInstById[e._customId],
                    delete fairygui.UIPackage._packageInstByName[e.name];
            }, e.createObject = function (t, e, i) {
                var n = fairygui.UIPackage.getByName(t);
                return n ? n.createObject(e, i) : null;
            }, e.createObjectFromURL = function (t, e) {
                var i = fairygui.UIPackage.getItemByURL(t);
                return i ? i.owner.internalCreateObject(i, e) : null;
            }, e.getItemURL = function (t, e) {
                var i = fairygui.UIPackage.getByName(t);
                if (!i) return null;
                var n = i._itemsByName[e];
                return n ? "ui://" + i.id + n.id : null;
            }, e.getItemByURL = function (t) {
                var i = t.indexOf("//");
                if (-1 == i) return null;
                var n = t.indexOf("/", i + 2);
                if (-1 == n) {
                    if (t.length > 13) {
                        var r = t.substr(5, 8), a = e.getById(r);
                        if (null != a) {
                            var s = t.substr(13);
                            return a.getItemById(s);
                        }
                    }
                } else {
                    var o = t.substr(i + 2, n - i - 2);
                    if (null != (a = e.getByName(o))) {
                        var l = t.substr(n + 1);
                        return a.getItemByName(l);
                    }
                }
                return null;
            }, e.getItemAssetByURL = function (t) {
                var i = e.getItemByURL(t);
                return null == i ? null : i.owner.getItemAsset(i);
            }, e.normalizeURL = function (t) {
                if (null == t) return null;
                var i = t.indexOf("//");
                if (-1 == i) return null;
                var n = t.indexOf("/", i + 2);
                if (-1 == n) return t;
                var r = t.substr(i + 2, n - i - 2), a = t.substr(n + 1);
                return e.getItemURL(r, a);
            }, e.setStringsSource = function (t) {
                j.loadFromXML(t);
            }, e._constructing = 0, e._packageInstById = {}, e._packageInstByName = {}, e.__init$ = function () {
                t = function () {
                    function t() {
                        this.atlas = null, this.rect = null, this.rotated = !1, this.rect = new y();
                    }
                    return r(t, ""), t;
                }();
            }, e;
        }(), tt = function () {
            function t() {
                this.pixelWidth = 0, this.scale = NaN, this.pixels = null;
            }
            return r(t, "fairygui.utils.PixelHitTestData"), t.prototype.load = function (t) {
                t.getInt32(), this.pixelWidth = t.getInt32(), this.scale = 1 / t.readByte();
                var e = t.getInt32();
                this.pixels = s(e);
                for (var i = 0; i < e; i++) {
                    var n = t.readByte();
                    n < 0 && (n += 256), this.pixels[i] = n;
                }
            }, t;
        }(), et = function () {
            function t() { }
            return r(t, "fairygui.utils.ToolSet"), t.getFileName = function (t) {
                var e = t.lastIndexOf("/");
                return -1 != e && (t = t.substr(e + 1)), -1 != (e = t.lastIndexOf("\\")) && (t = t.substr(e + 1)),
                    -1 != (e = t.lastIndexOf(".")) ? t.substring(0, e) : t;
            }, t.startsWith = function (t, e, i) {
                return void 0 === i && (i = !1), !!t && (!(t.length < e.length) && (t = t.substring(0, e.length),
                    i ? t.toLowerCase() == e.toLowerCase() : t == e));
            }, t.endsWith = function (t, e, i) {
                return void 0 === i && (i = !1), !!t && (!(t.length < e.length) && (t = t.substring(t.length - e.length),
                    i ? t.toLowerCase() == e.toLowerCase() : t == e));
            }, t.trim = function (t) {
                return fairygui.utils.ToolSet.trimLeft(fairygui.utils.ToolSet.trimRight(t));
            }, t.trimLeft = function (t) {
                for (var e = "", i = 0; i < t.length && (" " == (e = t.charAt(i)) || "\n" == e || "\r" == e); i++);
                return t.substr(i);
            }, t.trimRight = function (t) {
                for (var e = "", i = t.length - 1; i >= 0 && (" " == (e = t.charAt(i)) || "\n" == e || "\r" == e); i--);
                return t.substring(0, i + 1);
            }, t.convertToHtmlColor = function (t, e) {
                var i;
                void 0 === e && (e = !1), i = e ? (t >> 24 & 255).toString(16) : "";
                var n = (t >> 16 & 255).toString(16), r = (t >> 8 & 255).toString(16), a = (255 & t).toString(16);
                return 1 == i.length && (i = "0" + i), 1 == n.length && (n = "0" + n), 1 == r.length && (r = "0" + r),
                    1 == a.length && (a = "0" + a), "#" + i + n + r + a;
            }, t.convertFromHtmlColor = function (t, e) {
                return void 0 === e && (e = !1), t.length < 1 ? 0 : ("#" == t.charAt(0) && (t = t.substr(1)),
                    8 == t.length ? (parseInt(t.substr(0, 2), 16) << 24) + parseInt(t.substr(2), 16) : e ? 4278190080 + parseInt(t, 16) : parseInt(t, 16));
            }, t.displayObjectToGObject = function (t) {
                for (; null != t && !(t instanceof laya.display.Stage);) {
                    if (t.$owner) return t.$owner;
                    t = t.parent;
                }
                return null;
            }, t.encodeHTML = function (t) {
                return t ? t.replace("&", "&amp;").replace("<", "&lt;").replace(">", "&gt;").replace("'", "&apos;") : "";
            }, t.parseUBB = function (t) {
                return fairygui.utils.ToolSet.defaultUBBParser.parse(t);
            }, t.removeUBB = function (t) {
                return fairygui.utils.ToolSet.defaultUBBParser.parse(t, !0);
            }, t.clamp = function (t, e, i) {
                return t < e ? t = e : t > i && (t = i), t;
            }, t.clamp01 = function (t) {
                return t > 1 ? t = 1 : t < 0 && (t = 0), t;
            }, t.lerp = function (t, e, i) {
                return t + i * (e - t);
            }, n(t, ["defaultUBBParser", function () {
                return this.defaultUBBParser = new it();
            }]), t;
        }(), it = function () {
            function t() {
                this._text = null, this._readPos = 0, this._handlers = null, this.smallFontSize = 12,
                    this.normalFontSize = 14, this.largeFontSize = 16, this.defaultImgWidth = 0, this.defaultImgHeight = 0,
                    this._handlers = {}, this._handlers.url = this.onTag_URL, this._handlers.img = this.onTag_IMG,
                    this._handlers.b = this.onTag_Simple, this._handlers.i = this.onTag_Simple, this._handlers.u = this.onTag_Simple,
                    this._handlers.sup = this.onTag_Simple, this._handlers.sub = this.onTag_Simple,
                    this._handlers.color = this.onTag_COLOR, this._handlers.font = this.onTag_FONT,
                    this._handlers.size = this.onTag_SIZE;
            }
            r(t, "fairygui.utils.UBBParser");
            var e = t.prototype;
            return e.onTag_URL = function (t, e, i) {
                return e ? "</a>" : null != i ? '<a href="' + i + '" target="_blank">' : '<a href="' + this.getTagText() + '" target="_blank">';
            }, e.onTag_IMG = function (t, e, i) {
                if (e) return null;
                var n = this.getTagText(!0);
                return n ? this.defaultImgWidth ? '<img src="' + n + '" width="' + this.defaultImgWidth + '" height="' + this.defaultImgHeight + '"/>' : '<img src="' + n + '"/>' : null;
            }, e.onTag_Simple = function (t, e, i) {
                return e ? "</" + t + ">" : "<" + t + ">";
            }, e.onTag_COLOR = function (t, e, i) {
                return e ? "</font>" : '<font color="' + i + '">';
            }, e.onTag_FONT = function (t, e, i) {
                return e ? "</font>" : '<font face="' + i + '">';
            }, e.onTag_SIZE = function (t, e, i) {
                return e ? "</font>" : ("normal" == i ? i = "" + this.normalFontSize : "small" == i ? i = "" + this.smallFontSize : "large" == i ? i = "" + this.largeFontSize : i.length && "+" == i.charAt(0) ? i = "" + (this.smallFontSize + parseInt(i.substr(1))) : i.length && "-" == i.charAt(0) && (i = "" + (this.smallFontSize - parseInt(i.substr(1)))),
                    '<font size="' + i + '">');
            }, e.getTagText = function (t) {
                void 0 === t && (t = !1);
                for (var e = this._readPos, i = 0, n = ""; -1 != (i = this._text.indexOf("[", e));) {
                    if (92 != this._text.charCodeAt(i - 1)) {
                        n += this._text.substring(e, i);
                        break;
                    }
                    n += this._text.substring(e, i - 1), n += "[", e = i + 1;
                }
                return -1 == i ? null : (t && (this._readPos = i), n);
            }, e.parse = function (t, e) {
                void 0 === e && (e = !1), this._text = t;
                for (var i, n, r, a, s = 0, o = 0, l = 0, h = !1, u = ""; -1 != (o = this._text.indexOf("[", s));) if (o > 0 && 92 == this._text.charCodeAt(o - 1)) u += this._text.substring(s, o - 1),
                    u += "[", s = o + 1; else {
                    if (u += this._text.substring(s, o), s = o, -1 == (o = this._text.indexOf("]", s))) break;
                    h = "/" == this._text.charAt(s + 1), i = this._text.substring(h ? s + 2 : s + 1, o),
                        this._readPos = o + 1, n = null, r = null, -1 != (l = i.indexOf("=")) && (n = i.substring(l + 1),
                            i = i.substring(0, l)), i = i.toLowerCase(), null != (a = this._handlers[i]) ? e || null != (r = a.call(this, i, h, n)) && (u += r) : u += this._text.substring(s, this._readPos),
                        s = this._readPos;
                }
                return s < this._text.length && (u += this._text.substr(s)), this._text = null,
                    u;
            }, n(t, ["inst", function () {
                return this.inst = new t();
            }]), t;
        }(), nt = function (t) {
            function e() {
                e.__super.call(this), this.reset();
            }
            r(e, "fairygui.utils.ColorMatrix", Array);
            var i = e.prototype;
            return i.reset = function () {
                for (var t = 0; t < e.LENGTH; t++) this[t] = e.IDENTITY_MATRIX[t];
            }, i.invert = function () {
                this.multiplyMatrix([-1, 0, 0, 0, 255, 0, -1, 0, 0, 255, 0, 0, -1, 0, 255, 0, 0, 0, 1, 0]);
            }, i.adjustColor = function (t, e, i, n) {
                this.adjustHue(n), this.adjustContrast(e), this.adjustBrightness(t), this.adjustSaturation(i);
            }, i.adjustBrightness = function (t) {
                t = 255 * this.cleanValue(t, 1), this.multiplyMatrix([1, 0, 0, 0, t, 0, 1, 0, 0, t, 0, 0, 1, 0, t, 0, 0, 0, 1, 0]);
            }, i.adjustContrast = function (t) {
                var e = (t = this.cleanValue(t, 1)) + 1, i = 128 * (1 - e);
                this.multiplyMatrix([e, 0, 0, 0, i, 0, e, 0, 0, i, 0, 0, e, 0, i, 0, 0, 0, 1, 0]);
            }, i.adjustSaturation = function (t) {
                t = this.cleanValue(t, 1);
                var e = 1 - (t += 1), i = .299 * e, n = .587 * e, r = .114 * e;
                this.multiplyMatrix([i + t, n, r, 0, 0, i, n + t, r, 0, 0, i, n, r + t, 0, 0, 0, 0, 0, 1, 0]);
            }, i.adjustHue = function (t) {
                t = this.cleanValue(t, 1), t *= Math.PI;
                var e = Math.cos(t), i = Math.sin(t);
                this.multiplyMatrix([.299 + e * (1 - .299) + -.299 * i, .587 + -.587 * e + -.587 * i, .114 + -.114 * e + .886 * i, 0, 0, .299 + -.299 * e + .143 * i, .587 + e * (1 - .587) + .14 * i, .114 + -.114 * e + -.283 * i, 0, 0, .299 + -.299 * e + i * -(1 - .299), .587 + -.587 * e + .587 * i, .114 + .886 * e + .114 * i, 0, 0, 0, 0, 0, 1, 0]);
            }, i.concat = function (t) {
                t.length == e.LENGTH && this.multiplyMatrix(t);
            }, i.clone = function () {
                var t = new e();
                return t.copyMatrix(this), t;
            }, i.copyMatrix = function (t) {
                for (var i = e.LENGTH, n = 0; n < i; n++) this[n] = t[n];
            }, i.multiplyMatrix = function (t) {
                for (var e = [], i = 0, n = 0; n < 4; ++n) {
                    for (var r = 0; r < 5; ++r) e[i + r] = t[i] * this[r] + t[i + 1] * this[r + 5] + t[i + 2] * this[r + 10] + t[i + 3] * this[r + 15] + (4 == r ? t[i + 4] : 0);
                    i += 5;
                }
                this.copyMatrix(e);
            }, i.cleanValue = function (t, e) {
                return Math.min(e, Math.max(-e, t));
            }, e.create = function (t, i, n, r) {
                var a = new e();
                return a.adjustColor(t, i, n, r), a;
            }, e.LUMA_R = .299, e.LUMA_G = .587, e.LUMA_B = .114, n(e, ["IDENTITY_MATRIX", function () {
                return this.IDENTITY_MATRIX = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0];
            }, "LENGTH", function () {
                return this.LENGTH = e.IDENTITY_MATRIX.length;
            }]), e;
        }(), rt = function (t) {
            function e() {
                this._selectedIndex = 0, this._previousIndex = 0, this._pageIds = null, this._pageNames = null,
                    this._actions = null, this.name = null, this.parent = null, this.autoRadioGroupDepth = !1,
                    this.changing = !1, e.__super.call(this), this._pageIds = [], this._pageNames = [],
                    this._selectedIndex = -1, this._previousIndex = -1;
            }
            r(e, "fairygui.Controller", t);
            var i = e.prototype;
            return i.dispose = function () {
                this.offAll();
            }, i.setSelectedIndex = function (t) {
                if (void 0 === t && (t = 0), this._selectedIndex != t) {
                    if (t > this._pageIds.length - 1) throw "index out of bounds: " + t;
                    this.changing = !0, this._previousIndex = this._selectedIndex, this._selectedIndex = t,
                        this.parent.applyController(this), this.changing = !1;
                }
            }, i.setSelectedPage = function (t) {
                var e = this._pageNames.indexOf(t);
                -1 == e && (e = 0), this.setSelectedIndex(e);
            }, i.getPageName = function (t) {
                return void 0 === t && (t = 0), this._pageNames[t];
            }, i.addPage = function (t) {
                void 0 === t && (t = ""), this.addPageAt(t, this._pageIds.length);
            }, i.addPageAt = function (t, e) {
                void 0 === e && (e = 0);
                var i = "" + fairygui.Controller._nextPageId++;
                e == this._pageIds.length ? (this._pageIds.push(i), this._pageNames.push(t)) : (this._pageIds.splice(e, 0, i),
                    this._pageNames.splice(e, 0, t));
            }, i.removePage = function (t) {
                var e = this._pageNames.indexOf(t);
                -1 != e && (this._pageIds.splice(e, 1), this._pageNames.splice(e, 1), this._selectedIndex >= this._pageIds.length ? this.selectedIndex = this._selectedIndex - 1 : this.parent.applyController(this));
            }, i.removePageAt = function (t) {
                void 0 === t && (t = 0), this._pageIds.splice(t, 1), this._pageNames.splice(t, 1),
                    this._selectedIndex >= this._pageIds.length ? this.selectedIndex = this._selectedIndex - 1 : this.parent.applyController(this);
            }, i.clearPages = function () {
                this._pageIds.length = 0, this._pageNames.length = 0, -1 != this._selectedIndex ? this.selectedIndex = -1 : this.parent.applyController(this);
            }, i.hasPage = function (t) {
                return -1 != this._pageNames.indexOf(t);
            }, i.getPageIndexById = function (t) {
                return this._pageIds.indexOf(t);
            }, i.getPageIdByName = function (t) {
                var e = this._pageNames.indexOf(t);
                return -1 != e ? this._pageIds[e] : null;
            }, i.getPageNameById = function (t) {
                var e = this._pageIds.indexOf(t);
                return -1 != e ? this._pageNames[e] : null;
            }, i.getPageId = function (t) {
                return void 0 === t && (t = 0), this._pageIds[t];
            }, i.runActions = function () {
                if (this._actions) for (var t = this._actions.length, e = 0; e < t; e++) this._actions[e].run(this, this.previousPageId, this.selectedPageId);
            }, i.setup = function (t) {
                var e = t.pos;
                t.seek(e, 0), this.name = t.readS(), this.autoRadioGroupDepth = t.readBool(), t.seek(e, 1);
                var i = 0, n = 0, r = t.getInt16();
                for (i = 0; i < r; i++) this._pageIds.push(t.readS()), this._pageNames.push(t.readS());
                if (t.seek(e, 2), (r = t.getInt16()) > 0) for (null == this._actions && (this._actions = []),
                    i = 0; i < r; i++) {
                    n = t.getInt16(), n += t.pos;
                    var a = b.createAction(t.readByte());
                    a.setup(t), this._actions.push(a), t.pos = n;
                }
                null != this.parent && this._pageIds.length > 0 ? this._selectedIndex = 0 : this._selectedIndex = -1;
            }, a(0, i, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                if (this._selectedIndex != t) {
                    if (t > this._pageIds.length - 1) throw "index out of bounds: " + t;
                    this.changing = !0, this._previousIndex = this._selectedIndex, this._selectedIndex = t,
                        this.parent.applyController(this), this.event("fui_state_changed"), this.changing = !1;
                }
            }), a(0, i, "selectedPage", function () {
                return -1 == this._selectedIndex ? null : this._pageNames[this._selectedIndex];
            }, function (t) {
                var e = this._pageNames.indexOf(t);
                -1 == e && (e = 0), this.selectedIndex = e;
            }), a(0, i, "previsousIndex", function () {
                return this._previousIndex;
            }), a(0, i, "previousPage", function () {
                return -1 == this._previousIndex ? null : this._pageNames[this._previousIndex];
            }), a(0, i, "pageCount", function () {
                return this._pageIds.length;
            }), a(0, i, "selectedPageId", function () {
                return -1 == this._selectedIndex ? null : this._pageIds[this._selectedIndex];
            }, function (t) {
                var e = this._pageIds.indexOf(t);
                this.selectedIndex = e;
            }), a(0, i, "previousPageId", function () {
                return -1 == this._previousIndex ? null : this._pageIds[this._previousIndex];
            }), a(0, i, "oppositePageId", null, function (t) {
                this._pageIds.indexOf(t) > 0 ? this.selectedIndex = 0 : this._pageIds.length > 1 && (this.selectedIndex = 1);
            }), e._nextPageId = 0, e;
        }(c), at = function (t) {
            function e(t, i, n) {
                this.stringTable = null, this.version = 0, void 0 === i && (i = 0), void 0 === n && (n = -1),
                    -1 == n && (n = t.byteLength - i), 0 == i && n == t.byteLength ? e.__super.call(this, t) : (this._u8d_ = new Uint8Array(t, i, n),
                        this._d_ = new DataView(this._u8d_.buffer, i, n), this._length = n), this.endian = "bigEndian";
            }
            r(e, "fairygui.utils.ByteBuffer", t);
            var i = e.prototype;
            return i.skip = function (t) {
                this.pos += t;
            }, i.readBool = function () {
                return 1 == this.getUint8();
            }, i.readS = function () {
                var t = this.getUint16();
                return 65534 == t ? null : 65533 == t ? "" : this.stringTable[t];
            }, i.writeS = function (t) {
                var e = this.getUint16();
                65534 != e && 65533 != e && (this.stringTable[e] = t);
            }, i.readColor = function (t) {
                void 0 === t && (t = !1);
                var e = this.getUint8(), i = this.getUint8(), n = this.getUint8(), r = this.getUint8();
                return (t ? r << 24 : 0) + (e << 16) + (i << 8) + n;
            }, i.readColorS = function (t) {
                void 0 === t && (t = !1);
                var e = this.getUint8(), i = this.getUint8(), n = this.getUint8(), r = this.getUint8();
                if (t && 255 != r) return "rgba(" + e + "," + i + "," + n + "," + r / 255 + ")";
                var a = e.toString(16), s = i.toString(16), o = n.toString(16);
                return 1 == a.length && (a = "0" + a), 1 == s.length && (s = "0" + s), 1 == o.length && (o = "0" + o),
                    "#" + a + s + o;
            }, i.readChar = function () {
                var t = this.getUint16();
                return String.fromCharCode(t);
            }, i.readBuffer = function () {
                var t = this.getUint32(), i = new e(this.buffer, this._pos_, t);
                return i.stringTable = this.stringTable, i.version = this.version, i;
            }, i.seek = function (t, e) {
                var i = this._pos_;
                if (this.pos = t, e < this.getUint8()) {
                    var n = 0;
                    return 1 == this.getUint8() ? (this.pos += 2 * e, n = this.getUint16()) : (this.pos += 4 * e,
                        n = this.getUint32()), n > 0 ? (this.pos = t + n, !0) : (this.pos = i, !1);
                }
                return this.pos = i, !1;
            }, e;
        }(l), st = function (t) {
            function e(t, i) {
                this._child = null, this._reversed = !1, e.__super.call(this), this._child = t,
                    this._reversed = i, this._reversed ? this.unHit = t.hitArea.hit : this.hit = t.hitArea.hit;
            }
            return r(e, "fairygui.utils.ChildHitArea", t), e.prototype.contains = function (t, e) {
                var i;
                return (i = g.TEMP).setTo(0, 0), i = this._child.toParentPoint(i), this._reversed ? !f._isHitGraphic(t - i.x, e - i.y, this.unHit) : f._isHitGraphic(t - i.x, e - i.y, this.hit);
            }, e;
        }(f), ot = function (t) {
            function e(t, i, n) {
                this._data = null, this.offsetX = 0, this.offsetY = 0, this.scaleX = NaN, this.scaleY = NaN,
                    e.__super.call(this), void 0 === i && (i = 0), void 0 === n && (n = 0), this._data = t,
                    this.offsetX = i, this.offsetY = n, this.scaleX = 1, this.scaleY = 1;
            }
            return r(e, "fairygui.utils.PixelHitTest", t), e.prototype.contains = function (t, e) {
                if (t = Math.floor((t / this.scaleX - this.offsetX) * this._data.scale), e = Math.floor((e / this.scaleY - this.offsetY) * this._data.scale),
                    t < 0 || e < 0 || t >= this._data.pixelWidth) return !1;
                var i = e * this._data.pixelWidth + t, n = Math.floor(i / 8), r = i % 8;
                return n >= 0 && n < this._data.pixels.length && 1 == (this._data.pixels[n] >> r & 1);
            }, e;
        }(f), lt = function (t) {
            function e() {
                this.objectId = null, this.controllerName = null, this.targetPage = null, e.__super.call(this);
            }
            r(e, "fairygui.action.ChangePageAction", t);
            var i = e.prototype;
            return i.enter = function (t) {
                var e;
                if (this.controllerName && (e = this.objectId ? t.parent.getChildById(this.objectId) : t.parent)) {
                    var i = e.getController(this.controllerName);
                    i && i != t && !i.changing && (i.selectedPageId = this.targetPage);
                }
            }, i.setup = function (e) {
                t.prototype.setup.call(this, e), this.objectId = e.readS(), this.controllerName = e.readS(),
                    this.targetPage = e.readS();
            }, e;
        }(b), ht = function (t) {
            function e() {
                this.transitionName = null, this.playTimes = 1, this.delay = 0, this.stopOnExit = !1,
                    this._currentTransition = null, e.__super.call(this);
            }
            r(e, "fairygui.action.PlayTransitionAction", t);
            var i = e.prototype;
            return i.enter = function (t) {
                var e = t.parent.getTransition(this.transitionName);
                e && (this._currentTransition && this._currentTransition.playing ? e.changePlayTimes(this.playTimes) : e.play(null, this.playTimes, this.delay),
                    this._currentTransition = e);
            }, i.leave = function (t) {
                this.stopOnExit && this._currentTransition && (this._currentTransition.stop(), this._currentTransition = null);
            }, i.setup = function (e) {
                t.prototype.setup.call(this, e), this.transitionName = e.readS(), this.playTimes = e.getInt32(),
                    this.delay = e.getFloat32(), this.stopOnExit = e.readBool();
            }, e;
        }(b), ut = function (t) {
            function e() {
                this._gearColor = null, this._templateVars = null, this._text = null, e.__super.call(this),
                    this._gearColor = new _t(this);
            }
            r(e, "fairygui.GTextField", t);
            var n = e.prototype;
            return i.imps(n, {
                "fairygui.gears.IColorGear": !0
            }), n.parseTemplate = function (t) {
                for (var e, i, n = 0, r = 0, a = 0, s = ""; -1 != (r = t.indexOf("{", n));) if (r > 0 && 92 == t.charCodeAt(r - 1)) s += t.substring(n, r - 1),
                    s += "{", n = r + 1; else {
                    if (s += t.substring(n, r), n = r, -1 == (r = t.indexOf("}", n))) break;
                    r != n + 1 ? (-1 != (a = (e = t.substring(n + 1, r)).indexOf("=")) ? s += null == (i = this._templateVars[e.substring(0, a)]) ? e.substring(a + 1) : i : null != (i = this._templateVars[e]) && (s += i),
                        n = r + 1) : (s += t.substr(n, 2), n = r + 1);
                }
                return n < t.length && (s += t.substr(n)), s;
            }, n.setVar = function (t, e) {
                return this._templateVars || (this._templateVars = {}), this._templateVars[t] = e,
                    this;
            }, n.flushVars = function () {
                this.text = this._text;
            }, n.handleControllerChanged = function (e) {
                t.prototype.handleControllerChanged.call(this, e), this._gearColor.controller == e && this._gearColor.apply();
            }, n.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5);
                var n = 0;
                this.font = e.readS(), this.fontSize = e.getInt16(), this.color = e.readColorS(),
                    n = e.readByte(), this.align = 0 == n ? "left" : 1 == n ? "center" : "right", n = e.readByte(),
                    this.valign = 0 == n ? "top" : 1 == n ? "middle" : "bottom", this.leading = e.getInt16(),
                    this.letterSpacing = e.getInt16(), this.ubbEnabled = e.readBool(), this.autoSize = e.readByte(),
                    this.underline = e.readBool(), this.italic = e.readBool(), this.bold = e.readBool(),
                    this.singleLine = e.readBool(), e.readBool() && (this.strokeColor = e.readColorS(),
                        this.stroke = e.getFloat32() + 1), e.readBool() && e.skip(12), e.readBool() && (this._templateVars = {});
            }, n.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6);
                var n = e.readS();
                null != n && (this.text = n);
            }, a(0, n, "color", function () {
                return null;
            }, function (t) { }), a(0, n, "font", function () {
                return null;
            }, function (t) { }), a(0, n, "templateVars", function () {
                return this._templateVars;
            }, function (t) {
                null == this._templateVars && null == t || (this._templateVars = t, this.flushVars());
            }), a(0, n, "leading", function () {
                return 0;
            }, function (t) { }), a(0, n, "fontSize", function () {
                return 0;
            }, function (t) { }), a(0, n, "bold", function () {
                return !1;
            }, function (t) { }), a(0, n, "letterSpacing", function () {
                return 0;
            }, function (t) { }), a(0, n, "align", function () {
                return null;
            }, function (t) { }), a(0, n, "valign", function () {
                return null;
            }, function (t) { }), a(0, n, "italic", function () {
                return !1;
            }, function (t) { }), a(0, n, "underline", function () {
                return !1;
            }, function (t) { }), a(0, n, "singleLine", function () {
                return !1;
            }, function (t) { }), a(0, n, "stroke", function () {
                return 0;
            }, function (t) { }), a(0, n, "strokeColor", function () {
                return null;
            }, function (t) { }), a(0, n, "ubbEnabled", function () {
                return !1;
            }, function (t) { }), a(0, n, "autoSize", function () {
                return 0;
            }, function (t) { }), a(0, n, "textWidth", function () {
                return 0;
            }), e;
        }(L), ct = function (t) {
            function e() {
                this._sortingChildCount = 0, this._opaque = !1, this._applyingController = null,
                    this._mask = null, this._margin = null, this._trackBounds = !1, this._boundsChanged = !1,
                    this._childrenRenderOrder = 0, this._apexIndex = 0, this._buildingDisplayList = !1,
                    this._children = null, this._controllers = null, this._transitions = null, this._container = null,
                    this._scrollPane = null, this._alignOffset = null, e.__super.call(this), this._children = [],
                    this._controllers = [], this._transitions = [], this._margin = new F(), this._alignOffset = new g(),
                    this._opaque = !1;
            }
            r(e, "fairygui.GComponent", t);
            var n = e.prototype;
            return n.createDisplayObject = function () {
                t.prototype.createDisplayObject.call(this), this._displayObject.mouseEnabled = !0,
                    this._displayObject.mouseThrough = !0, this._container = this._displayObject;
            }, n.dispose = function () {
                var e = 0, i = 0;
                for (i = this._transitions.length, e = 0; e < i; ++e) {
                    this._transitions[e].dispose();
                }
                for (i = this._controllers.length, e = 0; e < i; ++e) {
                    this._controllers[e].dispose();
                }
                for (null != this.scrollPane && this.scrollPane.dispose(), e = (i = this._children.length) - 1; e >= 0; --e) {
                    var n = this._children[e];
                    n.parent = null, n.dispose();
                }
                this._boundsChanged = !1, this._mask = null, t.prototype.dispose.call(this);
            }, n.addChild = function (t) {
                return this.addChildAt(t, this._children.length), t;
            }, n.addChildAt = function (t, e) {
                if (void 0 === e && (e = 0), !t) throw "child is null";
                var i = this._children.length;
                if (e >= 0 && e <= i) {
                    if (t.parent == this) this.setChildIndex(t, e); else {
                        t.removeFromParent(), t.parent = this;
                        var n = this._children.length;
                        0 != t.sortingOrder ? (this._sortingChildCount++, e = this.getInsertPosForSortingChild(t)) : this._sortingChildCount > 0 && e > n - this._sortingChildCount && (e = n - this._sortingChildCount),
                            e == n ? this._children.push(t) : this._children.splice(e, 0, t), this.childStateChanged(t),
                            this.setBoundsChangedFlag();
                    }
                    return t;
                }
                throw "Invalid child index";
            }, n.getInsertPosForSortingChild = function (t) {
                var e = this._children.length, i = 0;
                for (i = 0; i < e; i++) {
                    var n = this._children[i];
                    if (n != t && t.sortingOrder < n.sortingOrder) break;
                }
                return i;
            }, n.removeChild = function (t, e) {
                void 0 === e && (e = !1);
                var i = this._children.indexOf(t);
                return -1 != i && this.removeChildAt(i, e), t;
            }, n.removeChildAt = function (t, e) {
                if (void 0 === e && (e = !1), t >= 0 && t < this.numChildren) {
                    var n = this._children[t];
                    return n.parent = null, 0 != n.sortingOrder && this._sortingChildCount--, this._children.splice(t, 1),
                        n.group = null, n.inContainer && (this._container.removeChild(n.displayObject),
                            2 == this._childrenRenderOrder && i.timer.callLater(this, this.buildNativeDisplayList)),
                        e && n.dispose(), this.setBoundsChangedFlag(), n;
                }
                throw "Invalid child index";
            }, n.removeChildren = function (t, e, i) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), void 0 === i && (i = !1), (e < 0 || e >= this.numChildren) && (e = this.numChildren - 1);
                for (var n = t; n <= e; ++n) this.removeChildAt(t, i);
            }, n.getChildAt = function (t) {
                if (void 0 === t && (t = 0), t >= 0 && t < this.numChildren) return this._children[t];
                throw "Invalid child index";
            }, n.getChild = function (t) {
                for (var e = this._children.length, i = 0; i < e; ++i) if (this._children[i].name == t) return this._children[i];
                return null;
            }, n.getVisibleChild = function (t) {
                for (var e = this._children.length, i = 0; i < e; ++i) {
                    var n = this._children[i];
                    if (n.internalVisible && n.internalVisible2 && n.name == t) return n;
                }
                return null;
            }, n.getChildInGroup = function (t, e) {
                for (var i = this._children.length, n = 0; n < i; ++n) {
                    var r = this._children[n];
                    if (r.group == e && r.name == t) return r;
                }
                return null;
            }, n.getChildById = function (t) {
                for (var e = this._children.length, i = 0; i < e; ++i) if (this._children[i]._id == t) return this._children[i];
                return null;
            }, n.getChildIndex = function (t) {
                return this._children.indexOf(t);
            }, n.setChildIndex = function (t, e) {
                void 0 === e && (e = 0);
                var i = this._children.indexOf(t);
                if (-1 == i) throw "Not a child of this container";
                if (0 == t.sortingOrder) {
                    var n = this._children.length;
                    this._sortingChildCount > 0 && e > n - this._sortingChildCount - 1 && (e = n - this._sortingChildCount - 1),
                        this._setChildIndex(t, i, e);
                }
            }, n.setChildIndexBefore = function (t, e) {
                var i = this._children.indexOf(t);
                if (-1 == i) throw "Not a child of this container";
                if (0 != t.sortingOrder) return i;
                var n = this._children.length;
                return this._sortingChildCount > 0 && e > n - this._sortingChildCount - 1 && (e = n - this._sortingChildCount - 1),
                    i < e ? this._setChildIndex(t, i, e - 1) : this._setChildIndex(t, i, e);
            }, n._setChildIndex = function (t, e, n) {
                var r = this._children.length;
                if (n > r && (n = r), e == n) return e;
                if (this._children.splice(e, 1), this._children.splice(n, 0, t), t.inContainer) {
                    var a = 0, s = 0;
                    if (0 == this._childrenRenderOrder) {
                        for (s = 0; s < n; s++) this._children[s].inContainer && a++;
                        a == this._container.numChildren && a--, this._container.setChildIndex(t.displayObject, a);
                    } else if (1 == this._childrenRenderOrder) {
                        for (s = r - 1; s > n; s--) this._children[s].inContainer && a++;
                        a == this._container.numChildren && a--, this._container.setChildIndex(t.displayObject, a);
                    } else i.timer.callLater(this, this.buildNativeDisplayList);
                    this.setBoundsChangedFlag();
                }
                return n;
            }, n.swapChildren = function (t, e) {
                var i = this._children.indexOf(t), n = this._children.indexOf(e);
                if (-1 == i || -1 == n) throw "Not a child of this container";
                this.swapChildrenAt(i, n);
            }, n.swapChildrenAt = function (t, e) {
                void 0 === e && (e = 0);
                var i = this._children[t], n = this._children[e];
                this.setChildIndex(i, e), this.setChildIndex(n, t);
            }, n.isAncestorOf = function (t) {
                if (null == t) return !1;
                for (var e = t.parent; e;) {
                    if (e == this) return !0;
                    e = e.parent;
                }
                return !1;
            }, n.addController = function (t) {
                this._controllers.push(t), t.parent = this, this.applyController(t);
            }, n.getControllerAt = function (t) {
                return this._controllers[t];
            }, n.getController = function (t) {
                for (var e = this._controllers.length, i = 0; i < e; ++i) {
                    var n = this._controllers[i];
                    if (n.name == t) return n;
                }
                return null;
            }, n.removeController = function (t) {
                var e = this._controllers.indexOf(t);
                if (-1 == e) throw new Error("controller not exists");
                t.parent = null, this._controllers.splice(e, 1);
                for (var i = this._children.length, n = 0; n < i; n++) {
                    this._children[n].handleControllerChanged(t);
                }
            }, n.childStateChanged = function (t) {
                if (!this._buildingDisplayList) {
                    var e = this._children.length;
                    if (t instanceof fairygui.GGroup) for (var n = 0; n < e; n++) {
                        var r = this._children[n];
                        r.group == t && this.childStateChanged(r);
                    } else if (t.displayObject) if (t.internalVisible && t.displayObject != this._displayObject.mask) {
                        if (!t.displayObject.parent) {
                            var a = 0;
                            if (0 == this._childrenRenderOrder) {
                                for (n = 0; n < e && (r = this._children[n]) != t; n++) null != r.displayObject && null != r.displayObject.parent && a++;
                                this._container.addChildAt(t.displayObject, a);
                            } else if (1 == this._childrenRenderOrder) {
                                for (n = e - 1; n >= 0 && (r = this._children[n]) != t; n--) null != r.displayObject && null != r.displayObject.parent && a++;
                                this._container.addChildAt(t.displayObject, a);
                            } else this._container.addChild(t.displayObject), i.timer.callLater(this, this.buildNativeDisplayList);
                        }
                    } else t.displayObject.parent && (this._container.removeChild(t.displayObject),
                        2 == this._childrenRenderOrder && i.timer.callLater(this, this.buildNativeDisplayList));
                }
            }, n.buildNativeDisplayList = function () {
                var t = this._children.length;
                if (0 != t) {
                    var e, i = 0;
                    switch (this._childrenRenderOrder) {
                        case 0:
                            for (i = 0; i < t; i++) null != (e = this._children[i]).displayObject && e.internalVisible && this._container.addChild(e.displayObject);
                            break;

                        case 1:
                            for (i = t - 1; i >= 0; i--) null != (e = this._children[i]).displayObject && e.internalVisible && this._container.addChild(e.displayObject);
                            break;

                        case 2:
                            for (i = 0; i < this._apexIndex; i++) null != (e = this._children[i]).displayObject && e.internalVisible && this._container.addChild(e.displayObject);
                            for (i = t - 1; i >= this._apexIndex; i--) null != (e = this._children[i]).displayObject && e.internalVisible && this._container.addChild(e.displayObject);
                    }
                }
            }, n.applyController = function (t) {
                this._applyingController = t;
                for (var e = this._children.length, i = 0; i < e; i++) this._children[i].handleControllerChanged(t);
                this._applyingController = null, t.runActions();
            }, n.applyAllControllers = function () {
                for (var t = this._controllers.length, e = 0; e < t; ++e) this.applyController(this._controllers[e]);
            }, n.adjustRadioGroupDepth = function (t, e) {
                var i, n = this._children.length, r = NaN, a = -1, s = -1;
                for (r = 0; r < n; r++) (i = this._children[r]) == t ? a = r : i instanceof fairygui.GButton && i.relatedController == e && r > s && (s = r);
                a < s && (null != this._applyingController && this._children[s].handleControllerChanged(this._applyingController),
                    this.swapChildrenAt(a, s));
            }, n.getTransitionAt = function (t) {
                return this._transitions[t];
            }, n.getTransition = function (t) {
                for (var e = this._transitions.length, i = 0; i < e; ++i) {
                    var n = this._transitions[i];
                    if (n.name == t) return n;
                }
                return null;
            }, n.isChildInView = function (t) {
                return null != this._displayObject.scrollRect ? t.x + t.width >= 0 && t.x <= this.width && t.y + t.height >= 0 && t.y <= this.height : null == this._scrollPane || this._scrollPane.isChildInView(t);
            }, n.getFirstChildInView = function () {
                for (var t = this._children.length, e = 0; e < t; ++e) {
                    var i = this._children[e];
                    if (this.isChildInView(i)) return e;
                }
                return -1;
            }, n.setMask = function (t, e) {
                if (this._mask && this._mask != t && "destination-out" == this._mask.blendMode && (this._mask.blendMode = null),
                    this._mask = t, !this._mask) return this._displayObject.mask = null, void (this._displayObject.hitArea instanceof fairygui.utils.ChildHitArea && (this._displayObject.hitArea = null));
                this._mask.hitArea && (this._displayObject.hitArea = new st(this._mask, e), this._displayObject.mouseThrough = !1,
                    this._displayObject.hitTestPrior = !0), e ? (this._displayObject.mask = null, this._displayObject.cacheAs = "bitmap",
                        this._mask.blendMode = "destination-out") : this._displayObject.mask = this._mask;
            }, n.updateHitArea = function () {
                if (this._displayObject.hitArea instanceof fairygui.utils.PixelHitTest) {
                    var t = this._displayObject.hitArea;
                    0 != this.sourceWidth && (t.scaleX = this.width / this.sourceWidth), 0 != this.sourceHeight && (t.scaleY = this.height / this.sourceHeight);
                } else this._displayObject.hitArea instanceof laya.maths.Rectangle && this._displayObject.hitArea.setTo(0, 0, this.width, this.height);
            }, n.updateMask = function () {
                var t = this._displayObject.scrollRect;
                null == t && (t = new y()), t.x = this._margin.left, t.y = this._margin.top, t.width = this.width - this._margin.right,
                    t.height = this.height - this._margin.bottom, this._displayObject.scrollRect = t;
            }, n.setupScroll = function (t) {
                this._displayObject == this._container && (this._container = new T(), this._displayObject.addChild(this._container)),
                    this._scrollPane = new z(this), this._scrollPane.setup(t);
            }, n.setupOverflow = function (t) {
                1 == t ? (this._displayObject == this._container && (this._container = new T(),
                    this._displayObject.addChild(this._container)), this.updateMask(), this._container.pos(this._margin.left, this._margin.top)) : 0 == this._margin.left && 0 == this._margin.top || (this._displayObject == this._container && (this._container = new T(),
                        this._displayObject.addChild(this._container)), this._container.pos(this._margin.left, this._margin.top));
            }, n.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), this._scrollPane ? this._scrollPane.onOwnerSizeChanged() : null != this._displayObject.scrollRect && this.updateMask(),
                    null != this._displayObject.hitArea && this.updateHitArea();
            }, n.handleGrayedChanged = function () {
                var t = this.getController("grayed");
                if (null == t) for (var e = this.grayed, i = this._children.length, n = 0; n < i; ++n) this._children[n].grayed = e; else t.selectedIndex = this.grayed ? 1 : 0;
            }, n.handleControllerChanged = function (e) {
                t.prototype.handleControllerChanged.call(this, e), null != this._scrollPane && this._scrollPane.handleControllerChanged(e);
            }, n.setBoundsChangedFlag = function () {
                (this._scrollPane || this._trackBounds) && (this._boundsChanged || (this._boundsChanged = !0,
                    i.timer.callLater(this, this.__render)));
            }, n.__render = function () {
                if (this._boundsChanged) {
                    var t = 0, e = this._children.length;
                    for (t = 0; t < e; t++) this._children[t].ensureSizeCorrect();
                    this.updateBounds();
                }
            }, n.ensureBoundsCorrect = function () {
                var t = 0, e = this._children.length;
                for (t = 0; t < e; t++) this._children[t].ensureSizeCorrect();
                this._boundsChanged && this.updateBounds();
            }, n.updateBounds = function () {
                var t = 0, e = 0, i = 0, n = 0, r = this._children.length;
                if (r > 0) {
                    t = Number.POSITIVE_INFINITY, e = Number.POSITIVE_INFINITY;
                    var a = Number.NEGATIVE_INFINITY, s = Number.NEGATIVE_INFINITY, o = 0, l = 0;
                    for (l = 0; l < r; l++) {
                        var h = this._children[l];
                        (o = h.x) < t && (t = o), (o = h.y) < e && (e = o), (o = h.x + h.actualWidth) > a && (a = o),
                            (o = h.y + h.actualHeight) > s && (s = o);
                    }
                    i = a - t, n = s - e;
                }
                this.setBounds(t, e, i, n);
            }, n.setBounds = function (t, e, i, n) {
                this._boundsChanged = !1, this._scrollPane && this._scrollPane.setContentSize(Math.round(t + i), Math.round(e + n));
            }, n.getSnappingPosition = function (t, e, i) {
                i || (i = new g());
                var n = this._children.length;
                if (0 == n) return i.x = 0, i.y = 0, i;
                this.ensureBoundsCorrect();
                var r = null, a = null, s = 0;
                if (0 != e) {
                    for (; s < n; s++) if (e < (r = this._children[s]).y) {
                        if (0 == s) {
                            e = 0;
                            break;
                        }
                        e = e < (a = this._children[s - 1]).y + a.actualHeight / 2 ? a.y : r.y;
                        break;
                    }
                    s == n && (e = r.y);
                }
                if (0 != t) {
                    for (s > 0 && s--; s < n; s++) if (t < (r = this._children[s]).x) {
                        if (0 == s) {
                            t = 0;
                            break;
                        }
                        t = t < (a = this._children[s - 1]).x + a.actualWidth / 2 ? a.x : r.x;
                        break;
                    }
                    s == n && (t = r.x);
                }
                return i.x = t, i.y = e, i;
            }, n.childSortingOrderChanged = function (t, e, i) {
                if (void 0 === i && (i = 0), 0 == i) this._sortingChildCount--, this.setChildIndex(t, this._children.length); else {
                    0 == e && this._sortingChildCount++;
                    var n = this._children.indexOf(t), r = this.getInsertPosForSortingChild(t);
                    n < r ? this._setChildIndex(t, n, r - 1) : this._setChildIndex(t, n, r);
                }
            }, n.constructFromResource = function () {
                this.constructFromResource2(null, 0);
            }, n.constructFromResource2 = function (t, e) {
                this.packageItem.decoded || (this.packageItem.decoded = !0, j.translateComponent(this.packageItem));
                var i = 0, n = 0, r = 0, a = 0, s = NaN, o = NaN, l = 0, h = 0, u = this.packageItem.rawData;
                u.seek(0, 0), this._underConstruct = !0, this.sourceWidth = u.getInt32(), this.sourceHeight = u.getInt32(),
                    this.initWidth = this.sourceWidth, this.initHeight = this.sourceHeight, this.setSize(this.sourceWidth, this.sourceHeight),
                    u.readBool() && (this.minWidth = u.getInt32(), this.maxWidth = u.getInt32(), this.minHeight = u.getInt32(),
                        this.maxHeight = u.getInt32()), u.readBool() && (s = u.getFloat32(), o = u.getFloat32(),
                            this.internalSetPivot(s, o, u.readBool())), u.readBool() && (this._margin.top = u.getInt32(),
                                this._margin.bottom = u.getInt32(), this._margin.left = u.getInt32(), this._margin.right = u.getInt32());
                var c = u.readByte();
                if (2 == c) {
                    var d = u.pos;
                    u.seek(0, 7), this.setupScroll(u), u.pos = d;
                } else this.setupOverflow(c);
                u.readBool() && u.skip(8), this._buildingDisplayList = !0, u.seek(0, 1);
                var _, f = u.getInt16();
                for (i = 0; i < f; i++) {
                    a = u.getInt16(), a += u.pos;
                    var p = new rt();
                    this._controllers.push(p), p.parent = this, p.setup(u), u.pos = a;
                }
                u.seek(0, 2);
                var m = u.getInt16();
                for (i = 0; i < m; i++) {
                    if (n = u.getInt16(), r = u.pos, null != t) _ = t[e + i]; else {
                        u.seek(r, 0);
                        var g, y = u.readByte(), v = u.readS(), S = u.readS(), T = null;
                        if (null != v) T = null != (g = null != S ? $.getById(S) : this.packageItem.owner) ? g.getItemById(v) : null;
                        null != T ? ((_ = J.newObject(T)).packageItem = T, _.constructFromResource()) : _ = J.newObject2(y);
                    }
                    _._underConstruct = !0, _.setup_beforeAdd(u, r), _.parent = this, this._children.push(_),
                        u.pos = r + n;
                }
                for (u.seek(0, 3), this.relations.setup(u, !0), u.seek(0, 2), u.skip(2), i = 0; i < m; i++) a = u.getInt16(),
                    a += u.pos, u.seek(u.pos, 3), this._children[i].relations.setup(u, !1), u.pos = a;
                for (u.seek(0, 2), u.skip(2), i = 0; i < m; i++) a = u.getInt16(), a += u.pos, (_ = this._children[i]).setup_afterAdd(u, u.pos),
                    _._underConstruct = !1, u.pos = a;
                u.seek(0, 4), u.skip(2), this.opaque = u.readBool();
                var E = u.getInt16();
                -1 != E && this.setMask(this.getChildAt(E).displayObject, u.readBool());
                var C = u.readS();
                null != C && null != (T = this.packageItem.owner.getItemById(C)) && null != T.pixelHitTestData && (l = u.getInt32(),
                    h = u.getInt32(), this._displayObject.hitArea = new ot(T.pixelHitTestData, l, h),
                    this._displayObject.mouseThrough = !1, this._displayObject.hitTestPrior = !0), u.seek(0, 5);
                var x = u.getInt16();
                for (i = 0; i < x; i++) {
                    a = u.getInt16(), a += u.pos;
                    var b = new H(this);
                    b.setup(u), this._transitions.push(b), u.pos = a;
                }
                this._transitions.length > 0 && (this.displayObject.on("display", this, this.___added),
                    this.displayObject.on("undisplay", this, this.___removed)), this.applyAllControllers(),
                    this._buildingDisplayList = !1, this._underConstruct = !1, this.buildNativeDisplayList(),
                    this.setBoundsChangedFlag(), 9 != this.packageItem.objectType && this.constructExtension(u),
                    this.constructFromXML(null);
            }, n.constructExtension = function (t) { }, n.constructFromXML = function (t) { }, n.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 4);
                var n = e.getInt16();
                -1 != n && null != this._scrollPane && (this._scrollPane.pageController = this._parent.getControllerAt(n));
                for (var r = e.getInt16(), a = 0; a < r; a++) {
                    var s = this.getController(e.readS()), o = e.readS();
                    s && (s.selectedPageId = o);
                }
            }, n.___added = function () {
                for (var t = this._transitions.length, e = 0; e < t; ++e) this._transitions[e].onOwnerAddedToStage();
            }, n.___removed = function () {
                for (var t = this._transitions.length, e = 0; e < t; ++e) this._transitions[e].onOwnerRemovedFromStage();
            }, a(0, n, "numChildren", function () {
                return this._children.length;
            }), a(0, n, "displayListContainer", function () {
                return this._container;
            }), a(0, n, "childrenRenderOrder", function () {
                return this._childrenRenderOrder;
            }, function (t) {
                this._childrenRenderOrder != t && (this._childrenRenderOrder = t, this.buildNativeDisplayList());
            }), a(0, n, "opaque", function () {
                return this._opaque;
            }, function (t) {
                this._opaque != t && (this._opaque = t, this._opaque ? (null == this._displayObject.hitArea && (this._displayObject.hitArea = new y()),
                    this._displayObject.hitArea instanceof laya.maths.Rectangle && this._displayObject.hitArea.setTo(0, 0, this.width, this.height),
                    this._displayObject.mouseThrough = !1) : (this._displayObject.hitArea instanceof laya.maths.Rectangle && (this._displayObject.hitArea = null),
                        this._displayObject.mouseThrough = !0));
            }), a(0, n, "controllers", function () {
                return this._controllers;
            }), a(0, n, "scrollPane", function () {
                return this._scrollPane;
            }), a(0, n, "margin", function () {
                return this._margin;
            }, function (t) {
                this._margin.copy(t), null != this._displayObject.scrollRect && this._container.pos(this._margin.left + this._alignOffset.x, this._margin.top + this._alignOffset.y),
                    this.handleSizeChanged();
            }), a(0, n, "apexIndex", function () {
                return this._apexIndex;
            }, function (t) {
                this._apexIndex != t && (this._apexIndex = t, 2 == this._childrenRenderOrder && this.buildNativeDisplayList());
            }), a(0, n, "mask", function () {
                return this._mask;
            }, function (t) {
                this.setMask(t, !1);
            }), a(0, n, "viewHeight", function () {
                return null != this._scrollPane ? this._scrollPane.viewHeight : this.height - this._margin.top - this._margin.bottom;
            }, function (t) {
                null != this._scrollPane ? this._scrollPane.viewHeight = t : this.height = t + this._margin.top + this._margin.bottom;
            }), a(0, n, "baseUserData", function () {
                var t = this.packageItem.rawData;
                return t.seek(0, 4), t.readS();
            }), a(0, n, "viewWidth", function () {
                return null != this._scrollPane ? this._scrollPane.viewWidth : this.width - this._margin.left - this._margin.right;
            }, function (t) {
                null != this._scrollPane ? this._scrollPane.viewWidth = t : this.width = t + this._margin.left + this._margin.right;
            }), e;
        }(L), dt = function (t) {
            var e;
            function i(t) {
                this._storage = null, this._default = null, i.__super.call(this, t);
            }
            r(i, "fairygui.gears.GearAnimation", t);
            var n = i.prototype;
            return n.init = function () {
                this._default = new e(this._owner.playing, this._owner.frame), this._storage = {};
            }, n.addStatus = function (t, i) {
                var n;
                null == t ? n = this._default : (n = new e(), this._storage[t] = n), n.playing = i.readBool(),
                    n.frame = i.getInt32();
            }, n.apply = function () {
                this._owner._gearLocked = !0;
                var t = this._storage[this._controller.selectedPageId];
                t || (t = this._default), this._owner.frame = t.frame, this._owner.playing = t.playing,
                    this._owner._gearLocked = !1;
            }, n.updateState = function () {
                var t = this._owner, i = this._storage[this._controller.selectedPageId];
                i || (i = new e(), this._storage[this._controller.selectedPageId] = i), i.frame = t.frame,
                    i.playing = t.playing;
            }, i.__init$ = function () {
                e = function () {
                    function t(t, e) {
                        this.playing = !1, this.frame = NaN, void 0 === t && (t = !0), void 0 === e && (e = 0),
                            this.playing = t, this.frame = e;
                    }
                    return r(t, ""), t;
                }();
            }, i;
        }(P), _t = function (t) {
            var e;
            function i(t) {
                this._storage = null, this._default = null, i.__super.call(this, t);
            }
            r(i, "fairygui.gears.GearColor", t);
            var n = i.prototype;
            return n.init = function () {
                null != this._owner.strokeColor ? this._default = new e(this._owner.color, this._owner.strokeColor) : this._default = new e(this._owner.color, null),
                    this._storage = {};
            }, n.addStatus = function (t, i) {
                var n;
                null == t ? n = this._default : (n = new e(), this._storage[t] = n), n.color = i.readColorS(),
                    n.strokeColor = i.readColorS();
            }, n.apply = function () {
                this._owner._gearLocked = !0;
                var t = this._storage[this._controller.selectedPageId];
                t || (t = this._default), this._owner.color = t.color, null != this._owner.strokeColor && null != t.strokeColor && (this._owner.strokeColor = t.strokeColor),
                    this._owner._gearLocked = !1;
            }, n.updateState = function () {
                var t = this._storage[this._controller.selectedPageId];
                t || (t = new e(null, null), this._storage[this._controller.selectedPageId] = t),
                    t.color = this._owner.color, null != this._owner.strokeColor && (t.strokeColor = this._owner.strokeColor);
            }, i.__init$ = function () {
                e = function () {
                    function t(t, e) {
                        this.color = null, this.strokeColor = null, this.color = t, this.strokeColor = e;
                    }
                    return r(t, ""), t;
                }();
            }, i;
        }(P), ft = function (t) {
            function e(t) {
                this.pages = null, this._visible = 0, this._displayLockToken = 0, e.__super.call(this, t),
                    this._displayLockToken = 1;
            }
            r(e, "fairygui.gears.GearDisplay", t);
            var i = e.prototype;
            return i.init = function () {
                this.pages = null;
            }, i.addLock = function () {
                return this._visible++, this._displayLockToken;
            }, i.releaseLock = function (t) {
                t == this._displayLockToken && this._visible--;
            }, i.apply = function () {
                this._displayLockToken++, this._displayLockToken <= 0 && (this._displayLockToken = 1),
                    null == this.pages || 0 == this.pages.length || -1 != this.pages.indexOf(this._controller.selectedPageId) ? this._visible = 1 : this._visible = 0;
            }, a(0, i, "connected", function () {
                return null == this._controller || this._visible > 0;
            }), e;
        }(P), pt = function (t) {
            function e(t) {
                this._storage = null, this._default = null, e.__super.call(this, t);
            }
            r(e, "fairygui.gears.GearIcon", t);
            var i = e.prototype;
            return i.init = function () {
                this._default = this._owner.icon, this._storage = {};
            }, i.addStatus = function (t, e) {
                null == t ? this._default = e.readS() : this._storage[t] = e.readS();
            }, i.apply = function () {
                this._owner._gearLocked = !0;
                var t = this._storage[this._controller.selectedPageId];
                this._owner.icon = void 0 !== t ? t : this._default, this._owner._gearLocked = !1;
            }, i.updateState = function () {
                this._storage[this._controller.selectedPageId] = this._owner.icon;
            }, e;
        }(P), mt = function (t) {
            var e;
            function i(t) {
                this._storage = null, this._default = null, i.__super.call(this, t);
            }
            r(i, "fairygui.gears.GearLook", t);
            var n = i.prototype;
            return n.init = function () {
                this._default = new e(this._owner.alpha, this._owner.rotation, this._owner.grayed, this._owner.touchable),
                    this._storage = {};
            }, n.addStatus = function (t, i) {
                var n;
                null == t ? n = this._default : (n = new e(), this._storage[t] = n), n.alpha = i.getFloat32(),
                    n.rotation = i.getFloat32(), n.grayed = i.readBool(), n.touchable = i.readBool();
            }, n.apply = function () {
                var t = this._storage[this._controller.selectedPageId];
                if (t || (t = this._default), null == this._tweenConfig || !this._tweenConfig.tween || $._constructing || P.disableAllTweenEffect) this._owner._gearLocked = !0,
                    this._owner.grayed = t.grayed, this._owner.alpha = t.alpha, this._owner.rotation = t.rotation,
                    this._owner.touchable = t.touchable, this._owner._gearLocked = !1; else {
                    if (this._owner._gearLocked = !0, this._owner.grayed = t.grayed, this._owner.touchable = t.touchable,
                        this._owner._gearLocked = !1, null != this._tweenConfig._tweener) {
                        if (this._tweenConfig._tweener.endValue.x == t.alpha && this._tweenConfig._tweener.endValue.y == t.rotation) return;
                        this._tweenConfig._tweener.kill(!0), this._tweenConfig._tweener = null;
                    }
                    var e = t.alpha != this._owner.alpha, i = t.rotation != this._owner.rotation;
                    (e || i) && (this._owner.checkGearController(0, this._controller) && (this._tweenConfig._displayLockToken = this._owner.addDisplayLock()),
                        this._tweenConfig._tweener = Y.to2(this._owner.alpha, this._owner.rotation, t.alpha, t.rotation, this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e ? 1 : 0) + (i ? 2 : 0)).setTarget(this).onUpdate(this.__tweenUpdate, this).onComplete(this.__tweenComplete, this));
                }
            }, n.__tweenUpdate = function (t) {
                var e = t.userData;
                this._owner._gearLocked = !0, 0 != (1 & e) && (this._owner.alpha = t.value.x), 0 != (2 & e) && (this._owner.rotation = t.value.y),
                    this._owner._gearLocked = !1;
            }, n.__tweenComplete = function () {
                0 != this._tweenConfig._displayLockToken && (this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),
                    this._tweenConfig._displayLockToken = 0), this._tweenConfig._tweener = null;
            }, n.updateState = function () {
                var t = this._storage[this._controller.selectedPageId];
                t || (t = new e(), this._storage[this._controller.selectedPageId] = t), t.alpha = this._owner.alpha,
                    t.rotation = this._owner.rotation, t.grayed = this._owner.grayed, t.touchable = this._owner.touchable;
            }, i.__init$ = function () {
                e = function () {
                    function t(t, e, i, n) {
                        this.alpha = NaN, this.rotation = NaN, this.grayed = !1, this.touchable = !1, void 0 === t && (t = 0),
                            void 0 === e && (e = 0), void 0 === i && (i = !1), void 0 === n && (n = !0), this.alpha = t,
                            this.rotation = e, this.grayed = i, this.touchable = n;
                    }
                    return r(t, ""), t;
                }();
            }, i;
        }(P), gt = function (t) {
            var e;
            function i(t) {
                this._storage = null, this._default = null, i.__super.call(this, t);
            }
            r(i, "fairygui.gears.GearSize", t);
            var n = i.prototype;
            return n.init = function () {
                this._default = new e(this._owner.width, this._owner.height, this._owner.scaleX, this._owner.scaleY),
                    this._storage = {};
            }, n.addStatus = function (t, i) {
                var n;
                null == t ? n = this._default : (n = new e(), this._storage[t] = n), n.width = i.getInt32(),
                    n.height = i.getInt32(), n.scaleX = i.getFloat32(), n.scaleY = i.getFloat32();
            }, n.apply = function () {
                var t = this._storage[this._controller.selectedPageId];
                if (t || (t = this._default), null == this._tweenConfig || !this._tweenConfig.tween || $._constructing || P.disableAllTweenEffect) this._owner._gearLocked = !0,
                    this._owner.setSize(t.width, t.height, this._owner.checkGearController(1, this._controller)),
                    this._owner.setScale(t.scaleX, t.scaleY), this._owner._gearLocked = !1; else {
                    if (null != this._tweenConfig._tweener) {
                        if (this._tweenConfig._tweener.endValue.x == t.width && this._tweenConfig._tweener.endValue.y == t.height && this._tweenConfig._tweener.endValue.z == t.scaleX && this._tweenConfig._tweener.endValue.w == t.scaleY) return;
                        this._tweenConfig._tweener.kill(!0), this._tweenConfig._tweener = null;
                    }
                    var e = t.width != this._owner.width || t.height != this._owner.height, i = t.scaleX != this._owner.scaleX || t.scaleY != this._owner.scaleY;
                    (e || i) && (this._owner.checkGearController(0, this._controller) && (this._tweenConfig._displayLockToken = this._owner.addDisplayLock()),
                        this._tweenConfig._tweener = Y.to4(this._owner.width, this._owner.height, this._owner.scaleX, this._owner.scaleY, t.width, t.height, t.scaleX, t.scaleY, this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e ? 1 : 0) + (i ? 2 : 0)).setTarget(this).onUpdate(this.__tweenUpdate, this).onComplete(this.__tweenComplete, this));
                }
            }, n.__tweenUpdate = function (t) {
                var e = t.userData;
                this._owner._gearLocked = !0, 0 != (1 & e) && this._owner.setSize(t.value.x, t.value.y, this._owner.checkGearController(1, this._controller)),
                    0 != (2 & e) && this._owner.setScale(t.value.z, t.value.w), this._owner._gearLocked = !1;
            }, n.__tweenComplete = function () {
                0 != this._tweenConfig._displayLockToken && (this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),
                    this._tweenConfig._displayLockToken = 0), this._tweenConfig._tweener = null;
            }, n.updateState = function () {
                var t = this._storage[this._controller.selectedPageId];
                t || (t = new e(), this._storage[this._controller.selectedPageId] = t), t.width = this._owner.width,
                    t.height = this._owner.height, t.scaleX = this._owner.scaleX, t.scaleY = this._owner.scaleY;
            }, n.updateFromRelations = function (t, e) {
                if (null != this._controller && null != this._storage) {
                    for (var i in this._storage) {
                        var n = this._storage[i];
                        n.width += t, n.height += e;
                    }
                    this._default.width += t, this._default.height += e, this.updateState();
                }
            }, i.__init$ = function () {
                e = function () {
                    function t(t, e, i, n) {
                        this.width = NaN, this.height = NaN, this.scaleX = NaN, this.scaleY = NaN, void 0 === t && (t = 0),
                            void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), this.width = t,
                            this.height = e, this.scaleX = i, this.scaleY = n;
                    }
                    return r(t, ""), t;
                }();
            }, i;
        }(P), yt = function (t) {
            function e() {
                this._type = 0, this._lineSize = NaN, this._lineColor = null, this._fillColor = null,
                    this._cornerRadius = null, this._hitArea = null, e.__super.call(this), this._type = 0,
                    this._lineSize = 1, this._lineColor = "#000000", this._fillColor = "#FFFFFF", this._cornerRadius = null;
            }
            r(e, "fairygui.GGraph", t);
            var n = e.prototype;
            return i.imps(n, {
                "fairygui.gears.IColorGear": !0
            }), n.drawRect = function (t, e, i, n) {
                this._type = 1, this._lineSize = t, this._lineColor = e, this._fillColor = i, this._cornerRadius = n,
                    this.drawCommon();
            }, n.drawEllipse = function (t, e, i) {
                this._type = 2, this._lineSize = t, this._lineColor = e, this._fillColor = i, this.drawCommon();
            }, n.drawCommon = function () {
                this._displayObject.mouseEnabled = this.touchable;
                var t = this._displayObject.graphics;
                t.clear();
                var e = this.width, i = this.height;
                if (0 != e && 0 != i) {
                    var n = this._fillColor, r = this._lineColor;
                    if (v.isWebGL && et.startsWith(n, "rgba")) {
                        var a = n.substring(5, n.lastIndexOf(")")).split(","), s = parseFloat(a[3]);
                        0 == s ? n = null : (n = x.toHexColor((parseInt(a[0]) << 16) + (parseInt(a[1]) << 8) + parseInt(a[2])),
                            this.alpha = s);
                    }
                    if (1 == this._type) if (null != this._cornerRadius) {
                        var o = [["moveTo", this._cornerRadius[0], 0], ["lineTo", e - this._cornerRadius[1], 0], ["arcTo", e, 0, e, this._cornerRadius[1], this._cornerRadius[1]], ["lineTo", e, i - this._cornerRadius[3]], ["arcTo", e, i, e - this._cornerRadius[3], i, this._cornerRadius[3]], ["lineTo", this._cornerRadius[2], i], ["arcTo", 0, i, 0, i - this._cornerRadius[2], this._cornerRadius[2]], ["lineTo", 0, this._cornerRadius[0]], ["arcTo", 0, 0, this._cornerRadius[0], 0, this._cornerRadius[0]], ["closePath"]];
                        t.drawPath(0, 0, o, {
                            fillStyle: n
                        }, this._lineSize > 0 ? {
                            strokeStyle: r,
                            lineWidth: this._lineSize
                        } : null);
                    } else t.drawRect(0, 0, e, i, n, this._lineSize > 0 ? r : null, this._lineSize); else t.drawCircle(e / 2, i / 2, e / 2, n, this._lineSize > 0 ? r : null, this._lineSize);
                    this._displayObject.repaint();
                }
            }, n.replaceMe = function (t) {
                if (!this._parent) throw "parent not set";
                t.name = this.name, t.alpha = this.alpha, t.rotation = this.rotation, t.visible = this.visible,
                    t.touchable = this.touchable, t.grayed = this.grayed, t.setXY(this.x, this.y), t.setSize(this.width, this.height);
                var e = this._parent.getChildIndex(this);
                this._parent.addChildAt(t, e), t.relations.copyFrom(this.relations), this._parent.removeChild(this, !0);
            }, n.addBeforeMe = function (t) {
                if (null == this._parent) throw "parent not set";
                var e = this._parent.getChildIndex(this);
                this._parent.addChildAt(t, e);
            }, n.addAfterMe = function (t) {
                if (null == this._parent) throw "parent not set";
                var e = this._parent.getChildIndex(this);
                e++, this._parent.addChildAt(t, e);
            }, n.setNativeObject = function (t) {
                this._type = 0, this._displayObject.mouseEnabled = this.touchable, this._displayObject.graphics.clear(),
                    this._displayObject.addChild(t);
            }, n.createDisplayObject = function () {
                t.prototype.createDisplayObject.call(this), this._displayObject.mouseEnabled = !1,
                    this._hitArea = new f(), this._hitArea.hit = this._displayObject.graphics, this._displayObject.hitArea = this._hitArea;
            }, n.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), 0 != this._type && this.drawCommon();
            }, n.setup_beforeAdd = function (e, i) {
                if (t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5), this._type = e.readByte(),
                    0 != this._type) {
                    if (this._lineSize = e.getInt32(), this._lineColor = e.readColorS(!0), this._fillColor = e.readColorS(!0),
                        e.readBool()) {
                        this._cornerRadius = [];
                        for (var n = 0; n < 4; n++) this._cornerRadius[n] = e.getFloat32();
                    }
                    this.drawCommon();
                }
            }, a(0, n, "color", function () {
                return this._fillColor;
            }, function (t) {
                this._fillColor = t, 0 != this._type && this.drawCommon();
            }), e;
        }(L), vt = function (t) {
            function e(t) {
                this._storage = null, this._default = null, e.__super.call(this, t);
            }
            r(e, "fairygui.gears.GearText", t);
            var i = e.prototype;
            return i.init = function () {
                this._default = this._owner.text, this._storage = {};
            }, i.addStatus = function (t, e) {
                null == t ? this._default = e.readS() : this._storage[t] = e.readS();
            }, i.apply = function () {
                this._owner._gearLocked = !0;
                var t = this._storage[this._controller.selectedPageId];
                this._owner.text = void 0 !== t ? t : this._default, this._owner._gearLocked = !1;
            }, i.updateState = function () {
                this._storage[this._controller.selectedPageId] = this._owner.text;
            }, e;
        }(P), St = function (t) {
            function e() {
                this._layout = 0, this._lineGap = 0, this._columnGap = 0, this._percentReady = !1,
                    this._boundsChanged = !1, this._updating = 0, e.__super.call(this);
            }
            r(e, "fairygui.GGroup", t);
            var n = e.prototype;
            return n.setBoundsChangedFlag = function (t) {
                void 0 === t && (t = !1), 0 == this._updating && null != this.parent && (t && (this._percentReady = !1),
                    this._boundsChanged || (this._boundsChanged = !0, 0 != this._layout && i.timer.callLater(this, this.ensureBoundsCorrect)));
            }, n.ensureBoundsCorrect = function () {
                this._boundsChanged && this.updateBounds();
            }, n.updateBounds = function () {
                if (i.timer.clear(this, this.ensureBoundsCorrect), this._boundsChanged = !1, null != this.parent) {
                    this.handleLayout();
                    var t, e = this._parent.numChildren, n = 0, r = Number.POSITIVE_INFINITY, a = Number.POSITIVE_INFINITY, s = Number.NEGATIVE_INFINITY, o = Number.NEGATIVE_INFINITY, l = 0, h = !0;
                    for (n = 0; n < e; n++) (t = this._parent.getChildAt(n)).group == this && ((l = t.x) < r && (r = l),
                        (l = t.y) < a && (a = l), (l = t.x + t.width) > s && (s = l), (l = t.y + t.height) > o && (o = l),
                        h = !1);
                    h ? (this._updating = 2, this.setSize(0, 0)) : (this._updating = 1, this.setXY(r, a),
                        this._updating = 2, this.setSize(s - r, o - a)), this._updating = 0;
                }
            }, n.handleLayout = function () {
                var t;
                this._updating |= 1;
                var e = 0, i = 0;
                if (1 == this._layout) {
                    var n = NaN;
                    for (i = this.parent.numChildren, e = 0; e < i; e++) (t = this.parent.getChildAt(e)).group == this && (isNaN(n) ? n = Math.floor(t.x) : t.x = n,
                        0 != t.width && (n += Math.floor(t.width + this._columnGap)));
                    this._percentReady || this.updatePercent();
                } else if (2 == this._layout) {
                    var r = NaN;
                    for (i = this.parent.numChildren, e = 0; e < i; e++) (t = this.parent.getChildAt(e)).group == this && (isNaN(r) ? r = Math.floor(t.y) : t.y = r,
                        0 != t.height && (r += Math.floor(t.height + this._lineGap)));
                    this._percentReady || this.updatePercent();
                }
                this._updating &= 2;
            }, n.updatePercent = function () {
                this._percentReady = !0;
                var t, e = this.parent.numChildren, i = 0, n = 0;
                if (1 == this._layout) {
                    for (i = 0; i < e; i++) (t = this.parent.getChildAt(i)).group == this && (n += t.width);
                    for (i = 0; i < e; i++) (t = this.parent.getChildAt(i)).group == this && (t._sizePercentInGroup = n > 0 ? t.width / n : 0);
                } else {
                    for (i = 0; i < e; i++) (t = this.parent.getChildAt(i)).group == this && (n += t.height);
                    for (i = 0; i < e; i++) (t = this.parent.getChildAt(i)).group == this && (t._sizePercentInGroup = n > 0 ? t.height / n : 0);
                }
            }, n.moveChildren = function (t, e) {
                if (0 == (1 & this._updating) && null != this.parent) {
                    this._updating |= 1;
                    var i, n = this.parent.numChildren, r = 0;
                    for (r = 0; r < n; r++) (i = this.parent.getChildAt(r)).group == this && i.setXY(i.x + t, i.y + e);
                    this._updating &= 2;
                }
            }, n.resizeChildren = function (t, e) {
                if (0 != this._layout && 0 == (2 & this._updating) && null != this.parent) {
                    this._updating |= 2, this._percentReady || this.updatePercent();
                    var i, n = this.parent.numChildren, r = 0, a = 0, s = -1, o = 0, l = 0, h = 0, u = !1;
                    for (r = 0; r < n; r++) (i = this.parent.getChildAt(r)).group == this && (s = r,
                        o++);
                    if (1 == this._layout) {
                        h = l = this.width - (o - 1) * this._columnGap;
                        var c = NaN, d = NaN;
                        for (r = 0; r < n; r++) if ((i = this.parent.getChildAt(r)).group == this) if (isNaN(c) ? c = Math.floor(i.x) : i.x = c,
                            d = s == r ? h : Math.round(i._sizePercentInGroup * l), i.setSize(d, i._rawHeight + e, !0),
                            h -= i.width, s == r) {
                            if (h >= 1) for (a = 0; a <= r; a++) (i = this.parent.getChildAt(a)).group == this && (u ? i.x += h : (d = i.width + h,
                                (0 == i.maxWidth || d < i.maxWidth) && (0 == i.minWidth || d > i.minWidth) && (i.setSize(d, i.height, !0),
                                    u = !0)));
                        } else c += i.width + this._columnGap;
                    } else if (2 == this._layout) {
                        h = l = this.height - (o - 1) * this._lineGap;
                        var _ = NaN, f = NaN;
                        for (r = 0; r < n; r++) if ((i = this.parent.getChildAt(r)).group == this) if (isNaN(_) ? _ = Math.floor(i.y) : i.y = _,
                            f = s == r ? h : Math.round(i._sizePercentInGroup * l), i.setSize(i._rawWidth + t, f, !0),
                            h -= i.height, s == r) {
                            if (h >= 1) for (a = 0; a <= r; a++) (i = this.parent.getChildAt(a)).group == this && (u ? i.y += h : (f = i.height + h,
                                (0 == i.maxHeight || f < i.maxHeight) && (0 == i.minHeight || f > i.minHeight) && (i.setSize(i.width, f, !0),
                                    u = !0)));
                        } else _ += i.height + this._lineGap;
                    }
                    this._updating &= 1;
                }
            }, n.handleAlphaChanged = function () {
                if (!this._underConstruct) for (var t = this._parent.numChildren, e = 0; e < t; e++) {
                    var i = this._parent.getChildAt(e);
                    i.group == this && (i.alpha = this.alpha);
                }
            }, n.handleVisibleChanged = function () {
                if (this._parent) for (var t = this._parent.numChildren, e = 0; e < t; e++) {
                    var i = this._parent.getChildAt(e);
                    i.group == this && i.handleVisibleChanged();
                }
            }, n.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5), this._layout = e.readByte(),
                    this._lineGap = e.getInt32(), this._columnGap = e.getInt32();
            }, n.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), this.visible || this.handleVisibleChanged();
            }, a(0, n, "layout", function () {
                return this._layout;
            }, function (t) {
                this._layout != t && (this._layout = t, this.setBoundsChangedFlag(!0));
            }), a(0, n, "columnGap", function () {
                return this._columnGap;
            }, function (t) {
                this._columnGap != t && (this._columnGap = t, this.setBoundsChangedFlag());
            }), a(0, n, "lineGap", function () {
                return this._lineGap;
            }, function (t) {
                this._lineGap != t && (this._lineGap = t, this.setBoundsChangedFlag());
            }), e;
        }(L), Tt = function (t) {
            function e() {
                this.image = null, this._flip = 0, e.__super.call(this);
            }
            r(e, "fairygui.GImage", t);
            var n = e.prototype;
            return i.imps(n, {
                "fairygui.gears.IColorGear": !0
            }), n.createDisplayObject = function () {
                this._displayObject = this.image = new Bt(), this.image.mouseEnabled = !1, this._displayObject.$owner = this;
            }, n.constructFromResource = function () {
                this.packageItem.load(), this.sourceWidth = this.packageItem.width, this.sourceHeight = this.packageItem.height,
                    this.initWidth = this.sourceWidth, this.initHeight = this.sourceHeight, this.image.scale9Grid = this.packageItem.scale9Grid,
                    this.image.scaleByTile = this.packageItem.scaleByTile, this.image.tileGridIndice = this.packageItem.tileGridIndice,
                    this.image.texture = this.packageItem.texture, this.setSize(this.sourceWidth, this.sourceHeight);
            }, n.handleXYChanged = function () {
                t.prototype.handleXYChanged.call(this), 0 != this._flip && (-1 == this.scaleX && (this.image.x += this.width),
                    -1 == this.scaleY && (this.image.y += this.height));
            }, n.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5), e.readBool() && (this.color = e.readColorS()),
                    this.flip = e.readByte(), this.image.fillMethod = e.readByte(), 0 != this.image.fillMethod && (this.image.fillOrigin = e.readByte(),
                        this.image.fillClockwise = e.readBool(), this.image.fillAmount = e.getFloat32());
            }, a(0, n, "color", function () {
                return this.image.color;
            }, function (t) {
                this.image.color != t && (this.image.color = t, this.updateGear(4));
            }), a(0, n, "fillClockwise", function () {
                return this.image.fillClockwise;
            }, function (t) {
                this.image.fillClockwise = t;
            }), a(0, n, "flip", function () {
                return this._flip;
            }, function (t) {
                if (this._flip != t) {
                    this._flip = t;
                    var e = 1, i = 1;
                    1 != this._flip && 3 != this._flip || (e = -1), 2 != this._flip && 3 != this._flip || (i = -1),
                        this.setScale(e, i), this.handleXYChanged();
                }
            }), a(0, n, "fillMethod", function () {
                return this.image.fillMethod;
            }, function (t) {
                this.image.fillMethod = t;
            }), a(0, n, "fillOrigin", function () {
                return this.image.fillOrigin;
            }, function (t) {
                this.image.fillOrigin = t;
            }), a(0, n, "fillAmount", function () {
                return this.image.fillAmount;
            }, function (t) {
                this.image.fillAmount = t;
            }), e;
        }(L), Et = function (t) {
            function e(t) {
                this._storage = null, this._default = null, e.__super.call(this, t);
            }
            r(e, "fairygui.gears.GearXY", t);
            var i = e.prototype;
            return i.init = function () {
                this._default = new g(this._owner.x, this._owner.y), this._storage = {};
            }, i.addStatus = function (t, e) {
                var i;
                null == t ? i = this._default : (i = new g(), this._storage[t] = i), i.x = e.getInt32(),
                    i.y = e.getInt32();
            }, i.apply = function () {
                var t = this._storage[this._controller.selectedPageId];
                if (t || (t = this._default), null == this._tweenConfig || !this._tweenConfig.tween || $._constructing || P.disableAllTweenEffect) this._owner._gearLocked = !0,
                    this._owner.setXY(t.x, t.y), this._owner._gearLocked = !1; else {
                    if (null != this._tweenConfig._tweener) {
                        if (this._tweenConfig._tweener.endValue.x == t.x && this._tweenConfig._tweener.endValue.y == t.y) return;
                        this._tweenConfig._tweener.kill(!0), this._tweenConfig._tweener = null;
                    }
                    this._owner.x == t.x && this._owner.y == t.y || (this._owner.checkGearController(0, this._controller) && (this._tweenConfig._displayLockToken = this._owner.addDisplayLock()),
                        this._tweenConfig._tweener = Y.to2(this._owner.x, this._owner.y, t.x, t.y, this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setTarget(this).onUpdate(this.__tweenUpdate, this).onComplete(this.__tweenComplete, this));
                }
            }, i.__tweenUpdate = function (t) {
                this._owner._gearLocked = !0, this._owner.setXY(t.value.x, t.value.y), this._owner._gearLocked = !1;
            }, i.__tweenComplete = function () {
                0 != this._tweenConfig._displayLockToken && (this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),
                    this._tweenConfig._displayLockToken = 0), this._tweenConfig._tweener = null;
            }, i.updateState = function () {
                var t = this._storage[this._controller.selectedPageId];
                t || (t = new g(), this._storage[this._controller.selectedPageId] = t), t.x = this._owner.x,
                    t.y = this._owner.y;
            }, i.updateFromRelations = function (t, e) {
                if (null != this._controller && null != this._storage) {
                    for (var i in this._storage) {
                        var n = this._storage[i];
                        n.x += t, n.y += e;
                    }
                    this._default.x += t, this._default.y += e, this.updateState();
                }
            }, e;
        }(P), Ct = function (t) {
            function e() {
                this._url = null, this._align = null, this._valign = null, this._autoSize = !1,
                    this._fill = 0, this._shrinkOnly = !1, this._showErrorSign = !1, this._contentItem = null,
                    this._contentSourceWidth = 0, this._contentSourceHeight = 0, this._contentWidth = 0,
                    this._contentHeight = 0, this._content = null, this._errorSign = null, this._content2 = null,
                    this._updatingLayout = !1, e.__super.call(this), this._url = "", this._fill = 0,
                    this._align = "left", this._valign = "top", this._showErrorSign = !0;
            }
            r(e, "fairygui.GLoader", t);
            var s = e.prototype;
            return i.imps(s, {
                "fairygui.gears.IAnimationGear": !0,
                "fairygui.gears.IColorGear": !0
            }), s.createDisplayObject = function () {
                t.prototype.createDisplayObject.call(this), this._content = new Ft(), this._displayObject.addChild(this._content),
                    this._displayObject.mouseEnabled = !0;
            }, s.dispose = function () {
                null == this._contentItem && null != this._content.texture && this.freeExternal(this._content.texture),
                    null != this._content2 && this._content2.dispose(), t.prototype.dispose.call(this);
            }, s.advance = function (t) {
                this._content.advance(t);
            }, s.loadContent = function () {
                this.clearContent(), this._url && (et.startsWith(this._url, "ui://") ? this.loadFromPackage(this._url) : this.loadExternal());
            }, s.loadFromPackage = function (t) {
                if (this._contentItem = $.getItemByURL(t), null != this._contentItem) if (this._contentItem.load(),
                    this._autoSize && this.setSize(this._contentItem.width, this._contentItem.height),
                    0 == this._contentItem.type) null == this._contentItem.texture ? this.setErrorState() : (this._content.texture = this._contentItem.texture,
                        this._content.scale9Grid = this._contentItem.scale9Grid, this._content.scaleByTile = this._contentItem.scaleByTile,
                        this._content.tileGridIndice = this._contentItem.tileGridIndice, this._contentSourceWidth = this._contentItem.width,
                        this._contentSourceHeight = this._contentItem.height, this.updateLayout()); else if (1 == this._contentItem.type) this._contentSourceWidth = this._contentItem.width,
                            this._contentSourceHeight = this._contentItem.height, this._content.interval = this._contentItem.interval,
                            this._content.swing = this._contentItem.swing, this._content.repeatDelay = this._contentItem.repeatDelay,
                            this._content.frames = this._contentItem.frames, this.updateLayout(); else if (3 == this._contentItem.type) {
                                var e = $.createObjectFromURL(t);
                                e ? e instanceof fairygui.GComponent ? (this._content2 = e.asCom, this._displayObject.addChild(this._content2.displayObject),
                                    this._contentSourceWidth = this._contentItem.width, this._contentSourceHeight = this._contentItem.height,
                                    this.updateLayout()) : (e.dispose(), this.setErrorState()) : this.setErrorState();
                            } else this.setErrorState(); else this.setErrorState();
            }, s.loadExternal = function () {
                I.inst.load(this._url, _.create(this, this.__getResCompleted), null, "image");
            }, s.freeExternal = function (t) { }, s.onExternalLoadSuccess = function (t) {
                this._content.texture = t, this._content.scale9Grid = null, this._content.scaleByTile = !1,
                    this._contentSourceWidth = t.width, this._contentSourceHeight = t.height, this.updateLayout();
            }, s.onExternalLoadFailed = function () {
                this.setErrorState();
            }, s.__getResCompleted = function (t) {
                null != t ? this.onExternalLoadSuccess(t) : this.onExternalLoadFailed();
            }, s.setErrorState = function () {
                this._showErrorSign && (null == this._errorSign && null != Q.loaderErrorSign && (this._errorSign = fairygui.GLoader._errorSignPool.getObject(Q.loaderErrorSign)),
                    null != this._errorSign && (this._errorSign.setSize(this.width, this.height), this._displayObject.addChild(this._errorSign.displayObject)));
            }, s.clearErrorState = function () {
                null != this._errorSign && (this._displayObject.removeChild(this._errorSign.displayObject),
                    fairygui.GLoader._errorSignPool.returnObject(this._errorSign), this._errorSign = null);
            }, s.updateLayout = function () {
                if (null != this._content2 || null != this._content.texture || null != this._content.frames) if (this._contentWidth = this._contentSourceWidth,
                    this._contentHeight = this._contentSourceHeight, this._autoSize && (this._updatingLayout = !0,
                        0 == this._contentWidth && (this._contentWidth = 50), 0 == this._contentHeight && (this._contentHeight = 30),
                        this.setSize(this._contentWidth, this._contentHeight), this._updatingLayout = !1,
                        this._contentWidth == this._width && this._contentHeight == this._height)) null != this._content2 ? (this._content2.setXY(0, 0),
                            this._content2.setScale(1, 1)) : this._content.pos(0, 0); else {
                    var t = 1, e = 1;
                    0 != this._fill && (t = this.width / this._contentSourceWidth, e = this.height / this._contentSourceHeight,
                        1 == t && 1 == e || (2 == this._fill ? t = e : 3 == this._fill ? e = t : 1 == this._fill ? t > e ? t = e : e = t : 5 == this._fill && (t > e ? e = t : t = e),
                            this._shrinkOnly && (t > 1 && (t = 1), e > 1 && (e = 1)), this._contentWidth = this._contentSourceWidth * t,
                            this._contentHeight = this._contentSourceHeight * e)), null != this._content2 ? this._content2.setScale(t, e) : this._content.size(this._contentWidth, this._contentHeight);
                    var i = NaN, n = NaN;
                    i = "center" == this._align ? Math.floor((this.width - this._contentWidth) / 2) : "right" == this._align ? this.width - this._contentWidth : 0,
                        n = "middle" == this._valign ? Math.floor((this.height - this._contentHeight) / 2) : "bottom" == this._valign ? this.height - this._contentHeight : 0,
                        null != this._content2 ? this._content2.setXY(i, n) : this._content.pos(i, n);
                } else this._autoSize && (this._updatingLayout = !0, this.setSize(50, 30), this._updatingLayout = !1);
            }, s.clearContent = function () {
                this.clearErrorState(), null == this._contentItem && null != this._content.texture && this.freeExternal(this._content.texture),
                    this._content.texture = null, this._content.frames = null, null != this._content2 && (this._content2.dispose(),
                        this._content2 = null), this._contentItem = null;
            }, s.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), this._updatingLayout || this.updateLayout();
            }, s.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5);
                var n = 0;
                this._url = e.readS(), n = e.readByte(), this._align = 0 == n ? "left" : 1 == n ? "center" : "right",
                    n = e.readByte(), this._valign = 0 == n ? "top" : 1 == n ? "middle" : "bottom",
                    this._fill = e.readByte(), this._shrinkOnly = e.readBool(), this._autoSize = e.readBool(),
                    this._showErrorSign = e.readBool(), this._content.playing = e.readBool(), this._content.frame = e.getInt32(),
                    e.readBool() && (this.color = e.readColorS()), 0 != e.readByte() && e.skip(6), this._url && this.loadContent();
            }, a(0, s, "frame", function () {
                return this._content.frame;
            }, function (t) {
                this._content.frame != t && (this._content.frame = t, this.updateGear(5));
            }), a(0, s, "url", function () {
                return this._url;
            }, function (t) {
                this._url != t && (this._url = t, this.loadContent(), this.updateGear(7));
            }), a(0, s, "align", function () {
                return this._align;
            }, function (t) {
                this._align != t && (this._align = t, this.updateLayout());
            }), a(0, s, "fill", function () {
                return this._fill;
            }, function (t) {
                this._fill != t && (this._fill = t, this.updateLayout());
            }), a(0, s, "verticalAlign", function () {
                return this._valign;
            }, function (t) {
                this._valign != t && (this._valign = t, this.updateLayout());
            }), a(0, s, "icon", function () {
                return this._url;
            }, function (t) {
                this.url = t;
            }), a(0, s, "content", function () {
                return this._content;
            }), a(0, s, "shrinkOnly", function () {
                return this._shrinkOnly;
            }, function (t) {
                this._shrinkOnly != t && (this._shrinkOnly = t, this.updateLayout());
            }), a(0, s, "showErrorSign", function () {
                return this._showErrorSign;
            }, function (t) {
                this._showErrorSign = t;
            }), a(0, s, "autoSize", function () {
                return this._autoSize;
            }, function (t) {
                this._autoSize != t && (this._autoSize = t, this.updateLayout());
            }), a(0, s, "playing", function () {
                return this._content.playing;
            }, function (t) {
                this._content.playing != t && (this._content.playing = t, this.updateGear(5));
            }), a(0, s, "timeScale", function () {
                return this._content.timeScale;
            }, function (t) {
                this._content.timeScale = t;
            }), a(0, s, "color", function () {
                return this._content.color;
            }, function (t) {
                this._content.color != t && (this._content.color = t, this.updateGear(4));
            }), a(0, s, "component", function () {
                return this._content2;
            }), n(e, ["_errorSignPool", function () {
                return this._errorSignPool = new B();
            }]), e;
        }(L), xt = function (t) {
            function e() {
                this._movieClip = null, e.__super.call(this), this._sizeImplType = 1;
            }
            r(e, "fairygui.GMovieClip", t);
            var n = e.prototype;
            return i.imps(n, {
                "fairygui.gears.IAnimationGear": !0,
                "fairygui.gears.IColorGear": !0
            }), n.createDisplayObject = function () {
                this._displayObject = this._movieClip = new Ft(), this._movieClip.mouseEnabled = !1,
                    this._displayObject.$owner = this;
            }, n.rewind = function () {
                this._movieClip.rewind();
            }, n.syncStatus = function (t) {
                this._movieClip.syncStatus(t._movieClip);
            }, n.advance = function (t) {
                this._movieClip.advance(t);
            }, n.setPlaySettings = function (t, e, i, n, r) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), void 0 === i && (i = 0), void 0 === n && (n = -1),
                    this._movieClip.setPlaySettings(t, e, i, n, r);
            }, n.constructFromResource = function () {
                this.sourceWidth = this.packageItem.width, this.sourceHeight = this.packageItem.height,
                    this.initWidth = this.sourceWidth, this.initHeight = this.sourceHeight, this.setSize(this.sourceWidth, this.sourceHeight),
                    this.packageItem.load(), this._movieClip.interval = this.packageItem.interval, this._movieClip.swing = this.packageItem.swing,
                    this._movieClip.repeatDelay = this.packageItem.repeatDelay, this._movieClip.frames = this.packageItem.frames,
                    this._movieClip.boundsRect = new y(0, 0, this.sourceWidth, this.sourceHeight);
            }, n.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 5), e.readBool() && (this.color = e.readColorS()),
                    e.readByte(), this._movieClip.frame = e.getInt32(), this._movieClip.playing = e.readBool();
            }, a(0, n, "color", function () {
                return "#FFFFFF";
            }, function (t) { }), a(0, n, "playing", function () {
                return this._movieClip.playing;
            }, function (t) {
                this._movieClip.playing != t && (this._movieClip.playing = t, this.updateGear(5));
            }), a(0, n, "timeScale", function () {
                return this._movieClip.timeScale;
            }, function (t) {
                this._movieClip.timeScale = t;
            }), a(0, n, "frame", function () {
                return this._movieClip.frame;
            }, function (t) {
                this._movieClip.frame != t && (this._movieClip.frame = t, this.updateGear(5));
            }), e;
        }(L), bt = function (t) {
            var e, n;
            function s() {
                this.textField = null, this._font = null, this._color = null, this._ubbEnabled = !1,
                    this._singleLine = !1, this._letterSpacing = 0, this._autoSize = 0, this._widthAutoSize = !1,
                    this._heightAutoSize = !1, this._updatingSize = !1, this._textWidth = 0, this._textHeight = 0,
                    this._bitmapFont = null, this._lines = null, s.__super.call(this), this._text = "",
                    this._color = "#000000", this.textField.align = "left", this.textField.font = Q.defaultFont,
                    this._autoSize = 1, this._widthAutoSize = this._heightAutoSize = !0, this.textField._sizeDirty = !1;
            }
            r(s, "fairygui.GBasicTextField", t);
            var o = s.prototype;
            return o.createDisplayObject = function () {
                this._displayObject = this.textField = new n(this), this._displayObject.$owner = this,
                    this._displayObject.mouseEnabled = !1;
            }, o.setAutoSize = function (t) {
                this._autoSize = t, this._widthAutoSize = 1 == t, this._heightAutoSize = 1 == t || 2 == t,
                    this.textField.wordWrap = !this._widthAutoSize && !this._singleLine, this._underConstruct || (this._heightAutoSize ? this._widthAutoSize || (this.textField.width = this.width) : this.textField.size(this.width, this.height));
            }, o.ensureSizeCorrect = function () {
                !this._underConstruct && this.textField._isChanged && this.textField.typeset();
            }, o.typeset = function () {
                null != this._bitmapFont ? this.renderWithBitmapFont() : (this._widthAutoSize || this._heightAutoSize) && this.updateSize();
            }, o.updateSize = function () {
                this._textWidth = Math.ceil(this.textField.textWidth), this._textHeight = Math.ceil(this.textField.textHeight);
                var t = NaN, e = 0;
                this._widthAutoSize ? (t = this._textWidth, this.textField.width != t && (this.textField.width = t,
                    "left" != this.textField.align && this.textField.baseTypeset())) : t = this.width,
                    this._heightAutoSize ? (e = this._textHeight, this._widthAutoSize || this.textField.height != this._textHeight && (this.textField.height = this._textHeight)) : (e = this.height,
                        this._textHeight > e && (this._textHeight = e), this.textField.height != this._textHeight && (this.textField.height = this._textHeight)),
                    this._updatingSize = !0, this.setSize(t, e), this._updatingSize = !1;
            }, o.renderWithBitmapFont = function () {
                var t = this._displayObject.graphics;
                t.clear(), this._lines ? e.returnList(this._lines) : this._lines = [];
                var i, n = this.letterSpacing, r = this.leading - 1, a = this.width - 4, s = 0, o = 0, l = 0, h = 0, u = 0, c = 0, d = 0, _ = 0, f = 0, p = "", m = 2, g = !this._widthAutoSize && !this._singleLine, y = this.fontSize, v = this._bitmapFont.resizable ? y / this._bitmapFont.size : 1;
                this._textWidth = 0, this._textHeight = 0;
                var S = this._text;
                null != this._templateVars && (S = this.parseTemplate(S));
                for (var T = S.length, E = 0; E < T; ++E) {
                    var C = S.charAt(E), x = C.charCodeAt(0);
                    if (10 != x) {
                        if (x >= 65 && x <= 90 || x >= 97 && x <= 122 ? (0 == c && (d = s), c++) : (c > 0 && (_ = s),
                            c = 0), 32 == x) h = Math.ceil(y / 2), u = y; else {
                            var b = this._bitmapFont.glyphs[C];
                            b ? (h = Math.ceil(b.advance * v), u = Math.ceil(b.lineHeight * v)) : (h = 0, u = 0);
                        }
                        if (u > l && (l = u), u > o && (o = u), 0 != s && (s += n), s += h, !g || s <= a) p += C; else {
                            if ((i = e.borrow()).height = o, i.textHeight = l, 0 == p.length) i.text = C; else if (c > 0 && _ > 0) {
                                var I = (p += C).length - c;
                                i.text = et.trimRight(p.substr(0, I)), i.width = _, p = p.substr(I), s -= d;
                            } else i.text = p, i.width = s - (h + n), p = C, s = h, o = u, l = u;
                            i.y = m, m += i.height + r, i.width > this._textWidth && (this._textWidth = i.width),
                                c = 0, d = 0, _ = 0, this._lines.push(i);
                        }
                    } else p += C, (i = e.borrow()).width = s, 0 == l && (0 == f && (f = y), 0 == o && (o = f),
                        l = o), i.height = o, f = o, i.textHeight = l, i.text = p, i.y = m, m += i.height + r,
                        i.width > this._textWidth && (this._textWidth = i.width), this._lines.push(i), p = "",
                        s = 0, o = 0, l = 0, c = 0, d = 0, _ = 0;
                }
                p.length > 0 && ((i = e.borrow()).width = s, 0 == o && (o = f), 0 == l && (l = o),
                    i.height = o, i.textHeight = l, i.text = p, i.y = m, i.width > this._textWidth && (this._textWidth = i.width),
                    this._lines.push(i)), this._textWidth > 0 && (this._textWidth += 4), 0 == this._lines.length ? this._textHeight = 0 : (i = this._lines[this._lines.length - 1],
                        this._textHeight = i.y + i.height + 2);
                var w = NaN, A = 0;
                if (w = this._widthAutoSize ? 0 == this._textWidth ? 0 : this._textWidth : this.width,
                    A = this._heightAutoSize ? 0 == this._textHeight ? 0 : this._textHeight : this.height,
                    this._updatingSize = !0, this.setSize(w, A), this._updatingSize = !1, this.doAlign(),
                    0 != w && 0 != A) {
                    var R = 2, M = 0, D = 0;
                    a = this.width - 4;
                    for (var O = this._lines.length, L = 0; L < O; L++) {
                        i = this._lines[L], R = 2, M = "center" == this.align ? (a - i.width) / 2 : "right" == this.align ? a - i.width : 0,
                            T = i.text.length;
                        for (var P = 0; P < T; P++) 10 != (x = (C = i.text.charAt(P)).charCodeAt(0)) && (32 != x ? null != (b = this._bitmapFont.glyphs[C]) ? (D = (i.height + i.textHeight) / 2 - Math.ceil(b.lineHeight * v),
                            b.texture && t.drawTexture(b.texture, R + M + Math.ceil(b.offsetX * v), i.y + D + Math.ceil(b.offsetY * v), b.texture.width * v, b.texture.height * v),
                            R += n + Math.ceil(b.advance * v)) : R += n : R += this._letterSpacing + Math.ceil(y / 2));
                    }
                }
            }, o.handleSizeChanged = function () {
                this._updatingSize || (this._underConstruct ? this.textField.size(this.width, this.height) : null != this._bitmapFont ? this._widthAutoSize ? this.doAlign() : this.textField.setChanged() : this._widthAutoSize || (this._heightAutoSize ? this.textField.width = this.width : this.textField.size(this.width, this.height)));
            }, o.handleGrayedChanged = function () {
                fairygui.GObject.prototype.handleGrayedChanged.call(this), this.grayed ? this.textField.color = "#AAAAAA" : this.textField.color = this._color;
            }, o.doAlign = function () {
                if ("top" == this.valign || 0 == this._textHeight) this._yOffset = 2; else {
                    var t = this.height - this._textHeight;
                    t < 0 && (t = 0), "middle" == this.valign ? this._yOffset = Math.floor(t / 2) : this._yOffset = Math.floor(t);
                }
                this.handleXYChanged();
            }, o.flushVars = function () {
                this.text = this._text;
            }, a(0, o, "bold", function () {
                return this.textField.bold;
            }, function (t) {
                this.textField.bold = t;
            }), a(0, o, "letterSpacing", function () {
                return this._letterSpacing;
            }, function (t) {
                this._letterSpacing = t;
            }), a(0, o, "align", function () {
                return this.textField.align;
            }, function (t) {
                this.textField.align = t;
            }), a(0, o, "text", function () {
                return this._text;
            }, function (t) {
                if (this._text = t, null == this._text && (this._text = ""), null == this._bitmapFont) {
                    this._widthAutoSize && (this.textField.width = 1e4);
                    var e = this._text;
                    null != this._templateVars && (e = this.parseTemplate(e)), this._ubbEnabled ? this.textField.text = et.removeUBB(et.encodeHTML(e)) : this.textField.text = e;
                } else this.textField.text = "", this.textField.setChanged();
                this.parent && this.parent._underConstruct && this.textField.typeset();
            }), a(0, o, "color", function () {
                return this._color;
            }, function (t) {
                this._color != t && (this._color = t, this._gearColor.controller && this._gearColor.updateState(),
                    this.grayed ? this.textField.color = "#AAAAAA" : this.textField.color = this._color);
            }), a(0, o, "font", function () {
                return this.textField.font;
            }, function (t) {
                if (t && t.indexOf("PingFang SC") > -1) {
                    t = "Arial"
                    t.bold = !1
                }

                this._font = t,



                    et.startsWith(this._font, "ui://") ? this._bitmapFont = $.getItemAssetByURL(this._font) : this._bitmapFont = null,
                    null != this._bitmapFont ? this.textField.setChanged() : this._font ? this.textField.font = this._font : this.textField.font = Q.defaultFont;
            }), a(0, o, "leading", function () {
                return this.textField.leading;
            }, function (t) {
                this.textField.leading = t;
            }), a(0, o, "fontSize", function () {
                return this.textField.fontSize;
            }, function (t) {
                this.textField.fontSize = t;
            }), a(0, o, "valign", function () {
                return this.textField.valign;
            }, function (t) {
                this.textField.valign = t;
            }), a(0, o, "italic", function () {
                return this.textField.italic;
            }, function (t) {
                this.textField.italic = t;
            }), a(0, o, "underline", function () {
                return this.textField.underline;
            }, function (t) {
                this.textField.underline = t;
            }), a(0, o, "singleLine", function () {
                return this._singleLine;
            }, function (t) {
                this._singleLine = t, this.textField.wordWrap = !this._widthAutoSize && !this._singleLine;
            }), a(0, o, "stroke", function () {
                return this.textField.stroke;
            }, function (t) {
                this.textField.stroke = t;
            }), a(0, o, "strokeColor", function () {
                return this.textField.strokeColor;
            }, function (t) {
                this.textField.strokeColor = t, this.updateGear(4);
            }), a(0, o, "ubbEnabled", function () {
                return this._ubbEnabled;
            }, function (t) {
                this._ubbEnabled = t;
            }), a(0, o, "autoSize", function () {
                return this._autoSize;
            }, function (t) {
                this._autoSize != t && this.setAutoSize(t);
            }), a(0, o, "textWidth", function () {
                return this.textField._isChanged && this.textField.typeset(), this._textWidth;
            }), s.GUTTER_X = 2, s.GUTTER_Y = 2, s.__init$ = function () {
                e = function () {
                    function t() {
                        this.width = 0, this.height = 0, this.textHeight = 0, this.text = null, this.y = 0;
                    }
                    return r(t, ""), t.borrow = function () {
                        if (t.pool.length) {
                            var e = t.pool.pop();
                            return e.width = 0, e.height = 0, e.textHeight = 0, e.text = null, e.y = 0, e;
                        }
                        return new t();
                    }, t.returns = function (e) {
                        t.pool.push(e);
                    }, t.returnList = function (e) {
                        for (var i = e.length, n = 0; n < i; n++) {
                            var r = e[n];
                            t.pool.push(r);
                        }
                        e.length = 0;
                    }, t.pool = [], t;
                }(), n = function (t) {
                    function e(t) {
                        this._owner = null, this._lock = !1, this._sizeDirty = !1, e.__super.call(this),
                            this._owner = t;
                    }
                    r(e, "", t);
                    var n = e.prototype;
                    return n.baseTypeset = function () {
                        this._lock = !0, this.typeset(), this._lock = !1;
                    }, n.typeset = function () {
                        this._sizeDirty = !0, t.prototype.typeset.call(this), this._lock || this._owner.typeset(),
                            this._isChanged && (i.timer.clear(this, this.typeset), this._isChanged = !1), this._sizeDirty = !1;
                    }, n.setChanged = function () {
                        this.isChanged = !0;
                    }, a(0, n, "isChanged", null, function (t) {
                        t && !this._sizeDirty && 0 != this._owner.autoSize && this._owner.parent && (this._sizeDirty = !0,
                            this.event("fui_size_delay_change")), i.superSet(E, this, "isChanged", t);
                    }), e;
                }(E);
            }, s;
        }(ut), It = function (t) {
            function e() {
                this._titleObject = null, this._iconObject = null, this._relatedController = null,
                    this._mode = 0, this._selected = !1, this._title = null, this._selectedTitle = null,
                    this._icon = null, this._selectedIcon = null, this._sound = null, this._soundVolumeScale = 0,
                    this._pageOption = null, this._buttonController = null, this._changeStateOnClick = !1,
                    this._linkedPopup = null, this._downEffect = 0, this._downEffectValue = 0, this._downScaled = !1,
                    this._down = !1, this._over = !1, e.__super.call(this), this._mode = 0, this._title = "",
                    this._icon = "", this._sound = Q.buttonSound, this._soundVolumeScale = Q.buttonSoundVolumeScale,
                    this._pageOption = new V(), this._changeStateOnClick = !0, this._downEffectValue = .8;
            }
            r(e, "fairygui.GButton", t);
            var n = e.prototype;
            return n.getTextField = function () {
                return this._titleObject instanceof fairygui.GTextField ? this._titleObject : this._titleObject instanceof fairygui.GLabel || this._titleObject instanceof fairygui.GButton ? this._titleObject.getTextField() : null;
            }, n.fireClick = function (t) {
                void 0 === t && (t = !0), t && 0 == this._mode && (this.setState("over"), i.timer.once(100, this, this.setState, ["down"], !1),
                    i.timer.once(200, this, this.setState, ["up"], !1)), this.__click(O.createEvent("click", this.displayObject));
            }, n.setState = function (t) {
                if (this._buttonController && (this._buttonController.selectedPage = t), 1 == this._downEffect) {
                    var n = this.numChildren;
                    if ("down" == t || "selectedOver" == t || "selectedDisabled" == t) for (var r = 255 * this._downEffectValue, a = x.toHexColor((r << 16) + (r << 8) + r), s = 0; s < n; s++) {
                        var o = this.getChildAt(s);
                        (o instanceof fairygui.GImage || o instanceof fairygui.GLoader || o instanceof fairygui.GMovieClip) && (o.color = a);
                    } else for (s = 0; s < n; s++) ((o = this.getChildAt(s)) instanceof fairygui.GImage || o instanceof fairygui.GLoader || o instanceof fairygui.GMovieClip) && (o.color = "#FFFFFF");
                } else if (2 == this._downEffect) if ("down" == t || "selectedOver" == t || "selectedDisabled" == t) {
                    if (!this._downScaled) {
                        i.Tween.clearTween(this);
                        var l = this._targetScaleX = (this._targetScaleX || this.scaleX) * this._downEffectValue, h = this._targetScaleY = (this._targetScaleY || this.scaleY) * this._downEffectValue;
                        this.setScale(l, h), this._downScaled = !0;
                    }
                } else if (this._downScaled) {
                    i.Tween.clearTween(this);
                    l = this._targetScaleX = (this._targetScaleX || this.scaleX) / this._downEffectValue,
                        h = this._targetScaleY = (this._targetScaleY || this.scaleY) / this._downEffectValue;
                    i.Tween.to(this, {
                        scaleX: l,
                        scaleY: h
                    }, e.scaleOutTime, e.scaleOutEase), this._downScaled = !1;
                }
            }, n.handleControllerChanged = function (e) {
                t.prototype.handleControllerChanged.call(this, e), this._relatedController == e && (this.selected = this._pageOption.id == e.selectedPageId);
            }, n.handleGrayedChanged = function () {
                this._buttonController && this._buttonController.hasPage("disabled") ? this.grayed ? this._selected && this._buttonController.hasPage("selectedDisabled") ? this.setState("selectedDisabled") : this.setState("disabled") : this._selected ? this.setState("down") : this.setState("up") : t.prototype.handleGrayedChanged.call(this);
            }, n.constructExtension = function (t) {
                t.seek(0, 6), this._mode = t.readByte();
                var e = t.readS();
                e && (this._sound = e), this._soundVolumeScale = t.getFloat32(), this._downEffect = t.readByte(),
                    this._downEffectValue = t.getFloat32(), 2 == this._downEffect && this.setPivot(.5, .5, this.pivotAsAnchor),
                    this._buttonController = this.getController("button"), this._titleObject = this.getChild("title"),
                    this._iconObject = this.getChild("icon"), null != this._titleObject && (this._title = this._titleObject.text),
                    null != this._iconObject && (this._icon = this._iconObject.icon), 0 == this._mode && this.setState("up"),
                    this.on("mouseover", this, this.__rollover), this.on("mouseout", this, this.__rollout),
                    this.on("mousedown", this, this.__mousedown), this.on("click", this, this.__click);
            }, n.setup_afterAdd = function (e, i) {
                if (t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6) && e.readByte() == this.packageItem.objectType) {
                    var n, r = 0;
                    null != (n = e.readS()) && (this.title = n), null != (n = e.readS()) && (this.selectedTitle = n),
                        null != (n = e.readS()) && (this.icon = n), null != (n = e.readS()) && (this.selectedIcon = n),
                        e.readBool() && (this.titleColor = e.readColorS()), 0 != (r = e.getInt32()) && (this.titleFontSize = r),
                        (r = e.getInt16()) >= 0 && (this._relatedController = this.parent.getControllerAt(r)),
                        this.pageOption.id = e.readS(), null != (n = e.readS()) && (this._sound = n), e.readBool() && (this._soundVolumeScale = e.getFloat32()),
                        this.selected = e.readBool();
                }
            }, n.__rollover = function () {
                this._buttonController && this._buttonController.hasPage("over") && (this._over = !0,
                    this._down || this.grayed && this._buttonController.hasPage("disabled") || this.setState(this._selected ? "selectedOver" : "over"));
            }, n.__rollout = function () {
                this._buttonController && this._buttonController.hasPage("over") && (this._over = !1,
                    this._down || this.grayed && this._buttonController.hasPage("disabled") || this.setState(this._selected ? "down" : "up"));
            }, n.__mousedown = function (t) {
                this._down = !0, Ot.inst.checkPopups(t.target), i.stage.on("mouseup", this, this.__mouseup),
                    0 == this._mode && (this.grayed && this._buttonController && this._buttonController.hasPage("disabled") ? this.setState("selectedDisabled") : this.setState("down")),
                    null != this._linkedPopup && (this._linkedPopup instanceof fairygui.Window ? this._linkedPopup.toggleStatus() : this.root.togglePopup(this._linkedPopup, this));
            }, n.__mouseup = function () {
                if (this._down) {
                    if (i.stage.off("mouseup", this, this.__mouseup), this._down = !1, null == this._displayObject) return;
                    0 == this._mode && (this.grayed && this._buttonController && this._buttonController.hasPage("disabled") ? this.setState("disabled") : this._over ? this.setState("over") : this.setState("up"));
                }
            }, n.__click = function (t) {
                if (this._sound) {
                    var e = $.getItemByURL(this._sound);
                    e ? Ot.inst.playOneShotSound(e.file) : Ot.inst.playOneShotSound(this._sound);
                }
                1 == this._mode ? this._changeStateOnClick && (this.selected = !this._selected,
                    O.dispatch("fui_state_changed", this.displayObject, t)) : 2 == this._mode ? this._changeStateOnClick && !this._selected && (this.selected = !0,
                        O.dispatch("fui_state_changed", this.displayObject, t)) : this._relatedController && (this._relatedController.selectedPageId = this._pageOption.id);
            }, a(0, n, "relatedController", function () {
                return this._relatedController;
            }, function (t) {
                t != this._relatedController && (this._relatedController = t, this._pageOption.controller = t,
                    this._pageOption.clear());
            }), a(0, n, "icon", function () {
                return this._icon;
            }, function (t) {
                this._icon = t, t = this._selected && this._selectedIcon ? this._selectedIcon : this._icon,
                    null != this._iconObject && (this._iconObject.icon = t), this.updateGear(7);
            }), a(0, n, "titleFontSize", function () {
                var t = this.getTextField();
                return null != t ? t.fontSize : 0;
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.fontSize = t);
            }), a(0, n, "selectedIcon", function () {
                return this._selectedIcon;
            }, function (t) {
                this._selectedIcon = t, t = this._selected && this._selectedIcon ? this._selectedIcon : this._icon,
                    null != this._iconObject && (this._iconObject.icon = t);
            }), a(0, n, "title", function () {
                return this._title;
            }, function (t) {
                this._title = t, this._titleObject && (this._titleObject.text = this._selected && this._selectedTitle ? this._selectedTitle : this._title),
                    this.updateGear(6);
            }), a(0, n, "text", function () {
                return this.title;
            }, function (t) {
                this.title = t;
            }), a(0, n, "selectedTitle", function () {
                return this._selectedTitle;
            }, function (t) {
                this._selectedTitle = t, this._titleObject && (this._titleObject.text = this._selected && this._selectedTitle ? this._selectedTitle : this._title);
            }), a(0, n, "soundVolumeScale", function () {
                return this._soundVolumeScale;
            }, function (t) {
                this._soundVolumeScale = t;
            }), a(0, n, "sound", function () {
                return this._sound;
            }, function (t) {
                this._sound = t;
            }), a(0, n, "titleColor", function () {
                var t = this.getTextField();
                return null != t ? t.color : "#000000";
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.color = t), this.updateGear(4);
            }), a(0, n, "selected", function () {
                return this._selected;
            }, function (t) {
                if (0 != this._mode && this._selected != t) {
                    if (this._selected = t, this.grayed && this._buttonController && this._buttonController.hasPage("disabled") ? this._selected ? this.setState("selectedDisabled") : this.setState("disabled") : this._selected ? this.setState(this._over ? "selectedOver" : "down") : this.setState(this._over ? "over" : "up"),
                        this._selectedTitle && this._titleObject && (this._titleObject.text = this._selected ? this._selectedTitle : this._title),
                        this._selectedIcon) {
                        var e = this._selected ? this._selectedIcon : this._icon;
                        null != this._iconObject && (this._iconObject.icon = e);
                    }
                    this._relatedController && this._parent && !this._parent._buildingDisplayList && (this._selected ? (this._relatedController.selectedPageId = this._pageOption.id,
                        this._relatedController.autoRadioGroupDepth && this._parent.adjustRadioGroupDepth(this, this._relatedController)) : 1 == this._mode && this._relatedController.selectedPageId == this._pageOption.id && (this._relatedController.oppositePageId = this._pageOption.id));
                }
            }), a(0, n, "mode", function () {
                return this._mode;
            }, function (t) {
                this._mode != t && (0 == t && (this.selected = !1), this._mode = t);
            }), a(0, n, "pageOption", function () {
                return this._pageOption;
            }), a(0, n, "changeStateOnClick", function () {
                return this._changeStateOnClick;
            }, function (t) {
                this._changeStateOnClick = t;
            }), a(0, n, "linkedPopup", function () {
                return this._linkedPopup;
            }, function (t) {
                this._linkedPopup = t;
            }), e.UP = "up", e.DOWN = "down", e.OVER = "over", e.SELECTED_OVER = "selectedOver",
                e.DISABLED = "disabled", e.SELECTED_DISABLED = "selectedDisabled", e;
        }(ct), wt = function (t) {
            function e() {
                this.dropdown = null, this._titleObject = null, this._iconObject = null, this._list = null,
                    this._items = null, this._icons = null, this._values = null, this._popupDirection = 0,
                    this._visibleItemCount = 0, this._itemsUpdated = !1, this._selectedIndex = 0, this._buttonController = null,
                    this._selectionController = null, this._down = !1, this._over = !1, e.__super.call(this),
                    this._visibleItemCount = Q.defaultComboBoxVisibleItemCount, this._itemsUpdated = !0,
                    this._selectedIndex = -1, this._items = [], this._values = [];
            }
            r(e, "fairygui.GComboBox", t);
            var n = e.prototype;
            return n.getTextField = function () {
                return this._titleObject instanceof fairygui.GTextField ? this._titleObject : this._titleObject instanceof fairygui.GLabel || this._titleObject instanceof fairygui.GButton ? this._titleObject.getTextField() : null;
            }, n.setState = function (t) {
                this._buttonController && (this._buttonController.selectedPage = t);
            }, n.handleControllerChanged = function (e) {
                t.prototype.handleControllerChanged.call(this, e), this._selectionController == e && (this.selectedIndex = e.selectedIndex);
            }, n.updateSelectionController = function () {
                if (null != this._selectionController && !this._selectionController.changing && this._selectedIndex < this._selectionController.pageCount) {
                    var t = this._selectionController;
                    this._selectionController = null, t.selectedIndex = this._selectedIndex, this._selectionController = t;
                }
            }, n.dispose = function () {
                this.dropdown && (this.dropdown.dispose(), this.dropdown = null), this._selectionController = null,
                    t.prototype.dispose.call(this);
            }, n.constructExtension = function (t) {
                var e;
                if (this._buttonController = this.getController("button"), this._titleObject = this.getChild("title"),
                    this._iconObject = this.getChild("icon"), e = t.readS()) {
                    if (this.dropdown = $.createObjectFromURL(e), !this.dropdown) return void m.print("下拉框必须为元件");
                    if (this.dropdown.name = "this._dropdownObject", this._list = this.dropdown.getChild("list").asList,
                        null == this._list) return void m.print(this.resourceURL + ": 下拉框的弹出元件里必须包含名为list的列表");
                    this._list.on("fui_click_item", this, this.__clickItem), this._list.addRelation(this.dropdown, 14),
                        this._list.removeRelation(this.dropdown, 15), this.dropdown.addRelation(this._list, 15),
                        this.dropdown.removeRelation(this._list, 14), this.dropdown.displayObject.on("undisplay", this, this.__popupWinClosed);
                }
                this.on("mouseover", this, this.__rollover), this.on("mouseout", this, this.__rollout),
                    this.on("mousedown", this, this.__mousedown);
            }, n.setup_afterAdd = function (e, i) {
                if (t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6) && e.readByte() == this.packageItem.objectType) {
                    var n, r = 0, a = 0, s = 0, o = e.getInt16();
                    for (r = 0; r < o; r++) s = e.getInt16(), s += e.pos, this._items[r] = e.readS(),
                        this._values[r] = e.readS(), null != (n = e.readS()) && (null == this._icons && (this._icons = []),
                            this._icons[r] = n), e.pos = s;
                    null != (n = e.readS()) ? (this.text = n, this._selectedIndex = this._items.indexOf(n)) : this._items.length > 0 ? (this._selectedIndex = 0,
                        this.text = this._items[0]) : this._selectedIndex = -1, null != (n = e.readS()) && (this.icon = n),
                        e.readBool() && (this.titleColor = e.readColorS()), (a = e.getInt32()) > 0 && (this._visibleItemCount = a),
                        this._popupDirection = e.readByte(), (a = e.getInt16()) >= 0 && (this._selectionController = this.parent.getControllerAt(a));
                }
            }, n.showDropdown = function () {
                if (this._itemsUpdated) {
                    this._itemsUpdated = !1, this._list.removeChildrenToPool();
                    for (var t = this._items.length, e = 0; e < t; e++) {
                        var i = this._list.addItemFromPool();
                        i.name = e < this._values.length ? this._values[e] : "", i.text = this._items[e],
                            i.icon = null != this._icons && e < this._icons.length ? this._icons[e] : null;
                    }
                    this._list.resizeToFit(this._visibleItemCount);
                }
                this._list.selectedIndex = -1, this.dropdown.width = this.width;
                var n = null;
                2 == this._popupDirection ? n = !0 : 1 == this._popupDirection && (n = !1), this.root.togglePopup(this.dropdown, this, n),
                    this.dropdown.parent && this.setState("down");
            }, n.__popupWinClosed = function () {
                this._over ? this.setState("over") : this.setState("up");
            }, n.__clickItem = function (t, e) {
                i.timer.callLater(this, this.__clickItem2, [this._list.getChildIndex(t), e]);
            }, n.__clickItem2 = function (t, e) {
                this.dropdown.parent instanceof fairygui.GRoot && this.dropdown.parent.hidePopup(),
                    this._selectedIndex = -1, this.selectedIndex = t, O.dispatch("fui_state_changed", this.displayObject, e);
            }, n.__rollover = function () {
                this._over = !0, this._down || this.dropdown && this.dropdown.parent || this.setState("over");
            }, n.__rollout = function () {
                this._over = !1, this._down || this.dropdown && this.dropdown.parent || this.setState("up");
            }, n.__mousedown = function (t) {
                t.target instanceof laya.display.Input || (this._down = !0, Ot.inst.checkPopups(t.target),
                    i.stage.on("mouseup", this, this.__mouseup), this.dropdown && this.showDropdown());
            }, n.__mouseup = function () {
                this._down && (this._down = !1, i.stage.off("mouseup", this, this.__mouseup), this.dropdown && !this.dropdown.parent && (this._over ? this.setState("over") : this.setState("up")));
            }, a(0, n, "text", function () {
                return this._titleObject ? this._titleObject.text : null;
            }, function (t) {
                this._titleObject && (this._titleObject.text = t), this.updateGear(6);
            }), a(0, n, "titleColor", function () {
                var t = this.getTextField();
                return null != t ? t.color : "#000000";
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.color = t), this.updateGear(4);
            }), a(0, n, "titleFontSize", function () {
                var t = this.getTextField();
                return null != t ? t.fontSize : 0;
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.fontSize = t);
            }), a(0, n, "icon", function () {
                return this._iconObject ? this._iconObject.icon : null;
            }, function (t) {
                this._iconObject && (this._iconObject.icon = t), this.updateGear(7);
            }), a(0, n, "icons", function () {
                return this._icons;
            }, function (t) {
                this._icons = t, null != this._icons && -1 != this._selectedIndex && this._selectedIndex < this._icons.length && (this.icon = this._icons[this._selectedIndex]);
            }), a(0, n, "selectionController", function () {
                return this._selectionController;
            }, function (t) {
                this._selectionController = t;
            }), a(0, n, "visibleItemCount", function () {
                return this._visibleItemCount;
            }, function (t) {
                this._visibleItemCount = t;
            }), a(0, n, "popupDirection", function () {
                return this._popupDirection;
            }, function (t) {
                this._popupDirection = t;
            }), a(0, n, "items", function () {
                return this._items;
            }, function (t) {
                t ? this._items = t.concat() : this._items.length = 0, this._items.length > 0 ? (this._selectedIndex >= this._items.length ? this._selectedIndex = this._items.length - 1 : -1 == this._selectedIndex && (this._selectedIndex = 0),
                    this.text = this._items[this._selectedIndex], null != this._icons && this._selectedIndex < this._icons.length && (this.icon = this._icons[this._selectedIndex])) : (this.text = "",
                        null != this._icons && (this.icon = null), this._selectedIndex = -1), this._itemsUpdated = !0;
            }), a(0, n, "values", function () {
                return this._values;
            }, function (t) {
                t ? this._values = t.concat() : this._values.length = 0;
            }), a(0, n, "selectedIndex", function () {
                return this._selectedIndex;
            }, function (t) {
                this._selectedIndex != t && (this._selectedIndex = t, this._selectedIndex >= 0 && this._selectedIndex < this._items.length ? (this.text = this._items[this._selectedIndex],
                    null != this._icons && this._selectedIndex < this._icons.length && (this.icon = this._icons[this._selectedIndex])) : (this.text = "",
                        null != this._icons && (this.icon = null)), this.updateSelectionController());
            }), a(0, n, "value", function () {
                return this._values[this._selectedIndex];
            }, function (t) {
                this.selectedIndex = this._values.indexOf(t);
            }), e;
        }(ct), At = function (t) {
            function e() {
                this._titleObject = null, this._iconObject = null, e.__super.call(this);
            }
            r(e, "fairygui.GLabel", t);
            var n = e.prototype;
            return i.imps(n, {
                "fairygui.gears.IColorGear": !0
            }), n.getTextField = function () {
                return this._titleObject instanceof fairygui.GTextField ? this._titleObject : this._titleObject instanceof fairygui.GLabel || this._titleObject instanceof fairygui.GButton ? this._titleObject.getTextField() : null;
            }, n.constructExtension = function (t) {
                this._titleObject = this.getChild("title"), this._iconObject = this.getChild("icon");
            }, n.setup_afterAdd = function (e, i) {
                if (t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6) && e.readByte() == this.packageItem.objectType) {
                    var n;
                    null != (n = e.readS()) && (this.title = n), null != (n = e.readS()) && (this.icon = n),
                        e.readBool() && (this.titleColor = e.readColorS());
                    var r = e.getInt32();
                    if (0 != r && (this.titleFontSize = r), e.readBool()) {
                        var a = this.getTextField();
                        null != a ? (null != (n = e.readS()) && (a.promptText = n), null != (n = e.readS()) && (a.restrict = n),
                            0 != (r = e.getInt32()) && (a.maxLength = r), 0 != (r = e.getInt32()) && (4 == r ? a.keyboardType = "number" : 3 == r && (a.keyboardType = "url")),
                            e.readBool() && (a.password = !0)) : e.skip(13);
                    }
                }
            }, a(0, n, "color", function () {
                return this.titleColor;
            }, function (t) {
                this.titleColor = t;
            }), a(0, n, "icon", function () {
                return null != this._iconObject ? this._iconObject.icon : null;
            }, function (t) {
                null != this._iconObject && (this._iconObject.icon = t), this.updateGear(7);
            }), a(0, n, "editable", function () {
                return !!(this._titleObject && this._titleObject instanceof fairygui.GTextInput) && this._titleObject.asTextInput.editable;
            }, function (t) {
                this._titleObject && (this._titleObject.asTextInput.editable = t);
            }), a(0, n, "title", function () {
                return this._titleObject ? this._titleObject.text : null;
            }, function (t) {
                this._titleObject && (this._titleObject.text = t), this.updateGear(6);
            }), a(0, n, "text", function () {
                return this.title;
            }, function (t) {
                this.title = t;
            }), a(0, n, "titleColor", function () {
                var t = this.getTextField();
                return null != t ? t.color : "#000000";
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.color = t), this.updateGear(4);
            }), a(0, n, "titleFontSize", function () {
                var t = this.getTextField();
                return null != t ? t.fontSize : 0;
            }, function (t) {
                var e = this.getTextField();
                null != e && (e.fontSize = t);
            }), e;
        }(ct), Rt = function (t) {
            var e;
            function n() {
                this.itemRenderer = null, this.itemProvider = null, this.scrollItemToViewOnClick = !1,
                    this.foldInvisibleItems = !1, this._layout = 0, this._lineCount = 0, this._columnCount = 0,
                    this._lineGap = 0, this._columnGap = 0, this._defaultItem = null, this._autoResizeItem = !1,
                    this._selectionMode = 0, this._align = null, this._verticalAlign = null, this._selectionController = null,
                    this._lastSelectedIndex = 0, this._pool = null, this._virtual = !1, this._loop = !1,
                    this._numItems = 0, this._realNumItems = 0, this._firstIndex = 0, this._curLineItemCount = 0,
                    this._curLineItemCount2 = 0, this._itemSize = null, this._virtualListChanged = 0,
                    this._virtualItems = null, this._eventLocked = !1, this.itemInfoVer = 0, n.__super.call(this),
                    this._trackBounds = !0, this._pool = new B(), this._layout = 0, this._autoResizeItem = !0,
                    this._lastSelectedIndex = -1, this._selectionMode = 0, this.opaque = !0, this.scrollItemToViewOnClick = !0,
                    this._align = "left", this._verticalAlign = "top", this._container = new T(), this._displayObject.addChild(this._container);
            }
            r(n, "fairygui.GList", t);
            var s = n.prototype;
            return s.dispose = function () {
                this._pool.clear(), t.prototype.dispose.call(this);
            }, s.getFromPool = function (t) {
                t || (t = this._defaultItem);
                var e = this._pool.getObject(t);
                return null != e && (e.visible = !0), e;
            }, s.returnToPool = function (t) {
                t.displayObject.cacheAs = "none", this._pool.returnObject(t);
            }, s.addChildAt = function (e, i) {
                if (void 0 === i && (i = 0), t.prototype.addChildAt.call(this, e, i), e instanceof fairygui.GButton) {
                    var n = e;
                    n.selected = !1, n.changeStateOnClick = !1;
                }
                return e.on("click", this, this.__clickItem), e;
            }, s.addItem = function (t) {
                return t || (t = this._defaultItem), this.addChild($.createObjectFromURL(t));
            }, s.addItemFromPool = function (t) {
                return this.addChild(this.getFromPool(t));
            }, s.removeChildAt = function (e, i) {
                void 0 === i && (i = !1);
                var n = t.prototype.removeChildAt.call(this, e);
                return i ? n.dispose() : n.off("click", this, this.__clickItem), n;
            }, s.removeChildToPoolAt = function (e) {
                void 0 === e && (e = 0);
                var i = t.prototype.removeChildAt.call(this, e);
                this.returnToPool(i);
            }, s.removeChildToPool = function (t) {
                this.removeChild(t), this.returnToPool(t);
            }, s.removeChildrenToPool = function (t, e) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), (e < 0 || e >= this._children.length) && (e = this._children.length - 1);
                for (var i = t; i <= e; ++i) this.removeChildToPoolAt(t);
            }, s.getSelection = function () {
                var t = [], e = 0;
                if (this._virtual) for (e = 0; e < this._realNumItems; e++) {
                    var i = this._virtualItems[e];
                    if (i.obj instanceof fairygui.GButton && i.obj.selected || null == i.obj && i.selected) {
                        var n = e;
                        if (this._loop && (n = e % this._numItems, -1 != t.indexOf(n))) continue;
                        t.push(n);
                    }
                } else {
                    var r = this._children.length;
                    for (e = 0; e < r; e++) {
                        var a = this._children[e].asButton;
                        null != a && a.selected && t.push(e);
                    }
                }
                return t;
            }, s.addSelection = function (t, e) {
                if (void 0 === e && (e = !1), 3 != this._selectionMode) {
                    this.checkVirtualList(), 0 == this._selectionMode && this.clearSelection(), e && this.scrollToView(t),
                        this._lastSelectedIndex = t;
                    var i = null;
                    if (this._virtual) {
                        var n = this._virtualItems[t];
                        null != n.obj && (i = n.obj.asButton), n.selected = !0;
                    } else i = this.getChildAt(t).asButton;
                    null == i || i.selected || (i.selected = !0, this.updateSelectionController(t));
                }
            }, s.removeSelection = function (t) {
                if (3 != this._selectionMode) {
                    var e = null;
                    if (this._virtual) {
                        var i = this._virtualItems[t];
                        null != i.obj && (e = i.obj.asButton), i.selected = !1;
                    } else e = this.getChildAt(t).asButton;
                    null != e && (e.selected = !1);
                }
            }, s.clearSelection = function () {
                var t = 0;
                if (this._virtual) for (t = 0; t < this._realNumItems; t++) {
                    var e = this._virtualItems[t];
                    e.obj instanceof fairygui.GButton && (e.obj.selected = !1), e.selected = !1;
                } else {
                    var i = this._children.length;
                    for (t = 0; t < i; t++) {
                        var n = this._children[t].asButton;
                        null != n && (n.selected = !1);
                    }
                }
            }, s.clearSelectionExcept = function (t) {
                var e = 0;
                if (this._virtual) for (e = 0; e < this._realNumItems; e++) {
                    var i = this._virtualItems[e];
                    i.obj != t && (i.obj instanceof fairygui.GButton && (i.obj.selected = !1), i.selected = !1);
                } else {
                    var n = this._children.length;
                    for (e = 0; e < n; e++) {
                        var r = this._children[e].asButton;
                        null != r && r != t && (r.selected = !1);
                    }
                }
            }, s.selectAll = function () {
                this.checkVirtualList();
                var t = -1, e = 0;
                if (this._virtual) for (e = 0; e < this._realNumItems; e++) {
                    var i = this._virtualItems[e];
                    i.obj instanceof fairygui.GButton && !i.obj.selected && (i.obj.selected = !0, t = e),
                        i.selected = !0;
                } else {
                    var n = this._children.length;
                    for (e = 0; e < n; e++) {
                        var r = this._children[e].asButton;
                        null == r || r.selected || (r.selected = !0, t = e);
                    }
                }
                -1 != t && this.updateSelectionController(t);
            }, s.selectNone = function () {
                this.clearSelection();
            }, s.selectReverse = function () {
                this.checkVirtualList();
                var t = -1, e = 0;
                if (this._virtual) for (e = 0; e < this._realNumItems; e++) {
                    var i = this._virtualItems[e];
                    i.obj instanceof fairygui.GButton && (i.obj.selected = !i.obj.selected, i.obj.selected && (t = e)),
                        i.selected = !i.selected;
                } else {
                    var n = this._children.length;
                    for (e = 0; e < n; e++) {
                        var r = this._children[e].asButton;
                        null != r && (r.selected = !r.selected, r.selected && (t = e));
                    }
                }
                -1 != t && this.updateSelectionController(t);
            }, s.handleArrowKey = function (t) {
                void 0 === t && (t = 0);
                var e = this.selectedIndex;
                if (-1 != e) switch (t) {
                    case 1:
                        if (0 == this._layout || 3 == this._layout) --e >= 0 && (this.clearSelection(),
                            this.addSelection(e, !0)); else if (2 == this._layout || 4 == this._layout) {
                                for (var i = this._children[e], n = 0, r = e - 1; r >= 0; r--) {
                                    var a = this._children[r];
                                    if (a.y != i.y) {
                                        i = a;
                                        break;
                                    }
                                    n++;
                                }
                                for (; r >= 0; r--) if ((a = this._children[r]).y != i.y) {
                                    this.clearSelection(), this.addSelection(r + n + 1, !0);
                                    break;
                                }
                            }
                        break;

                    case 3:
                        if (1 == this._layout || 2 == this._layout || 4 == this._layout) ++e < this._children.length && (this.clearSelection(),
                            this.addSelection(e, !0)); else if (3 == this._layout) {
                                i = this._children[e], n = 0;
                                var s = this._children.length;
                                for (r = e + 1; r < s; r++) {
                                    if ((a = this._children[r]).x != i.x) {
                                        i = a;
                                        break;
                                    }
                                    n++;
                                }
                                for (; r < s; r++) if ((a = this._children[r]).x != i.x) {
                                    this.clearSelection(), this.addSelection(r - n - 1, !0);
                                    break;
                                }
                            }
                        break;

                    case 5:
                        if (0 == this._layout || 3 == this._layout) ++e < this._children.length && (this.clearSelection(),
                            this.addSelection(e, !0)); else if (2 == this._layout || 4 == this._layout) {
                                for (i = this._children[e], n = 0, s = this._children.length, r = e + 1; r < s; r++) {
                                    if ((a = this._children[r]).y != i.y) {
                                        i = a;
                                        break;
                                    }
                                    n++;
                                }
                                for (; r < s; r++) if ((a = this._children[r]).y != i.y) {
                                    this.clearSelection(), this.addSelection(r - n - 1, !0);
                                    break;
                                }
                            }
                        break;

                    case 7:
                        if (1 == this._layout || 2 == this._layout || 4 == this._layout) --e >= 0 && (this.clearSelection(),
                            this.addSelection(e, !0)); else if (3 == this._layout) {
                                for (i = this._children[e], n = 0, r = e - 1; r >= 0; r--) {
                                    if ((a = this._children[r]).x != i.x) {
                                        i = a;
                                        break;
                                    }
                                    n++;
                                }
                                for (; r >= 0; r--) if ((a = this._children[r]).x != i.x) {
                                    this.clearSelection(), this.addSelection(r + n + 1, !0);
                                    break;
                                }
                            }
                }
            }, s.__clickItem = function (t) {
                if (null == this._scrollPane || !this._scrollPane.isDragged) {
                    var e = L.cast(t.currentTarget);
                    this.setSelectionOnEvent(e, t), this._scrollPane && this.scrollItemToViewOnClick && this._scrollPane.scrollToView(e, !0),
                        this.displayObject.event("fui_click_item", [e, O.createEvent("fui_click_item", this.displayObject, t)]);
                }
            }, s.setSelectionOnEvent = function (t, e) {
                if (t instanceof fairygui.GButton && 3 != this._selectionMode) {
                    var i = !1, n = t, r = this.childIndexToItemIndex(this.getChildIndex(t));
                    if (0 == this._selectionMode) n.selected || (this.clearSelectionExcept(n), n.selected = !0); else if (e.shiftKey) {
                        if (!n.selected) if (-1 != this._lastSelectedIndex) {
                            var a = Math.min(this._lastSelectedIndex, r), s = Math.max(this._lastSelectedIndex, r);
                            s = Math.min(s, this.numItems - 1);
                            var o = 0;
                            if (this._virtual) for (o = a; o <= s; o++) {
                                var l = this._virtualItems[o];
                                l.obj instanceof fairygui.GButton && (l.obj.selected = !0), l.selected = !0;
                            } else for (o = a; o <= s; o++) {
                                var h = this.getChildAt(o).asButton;
                                null != h && (h.selected = !0);
                            }
                            i = !0;
                        } else n.selected = !0;
                    } else e.ctrlKey || 2 == this._selectionMode ? n.selected = !n.selected : n.selected ? this.clearSelectionExcept(n) : (this.clearSelectionExcept(n),
                        n.selected = !0);
                    i || (this._lastSelectedIndex = r), n.selected && this.updateSelectionController(r);
                }
            }, s.resizeToFit = function (t, e) {
                void 0 === t && (t = 1e6), void 0 === e && (e = 0), this.ensureBoundsCorrect();
                var i = this.numItems;
                if (t > i && (t = i), this._virtual) {
                    var n = Math.ceil(t / this._curLineItemCount);
                    0 == this._layout || 2 == this._layout ? this.viewHeight = n * this._itemSize.y + Math.max(0, n - 1) * this._lineGap : this.viewWidth = n * this._itemSize.x + Math.max(0, n - 1) * this._columnGap;
                } else if (0 == t) 0 == this._layout || 2 == this._layout ? this.viewHeight = e : this.viewWidth = e; else {
                    for (var r = t - 1, a = null; r >= 0 && (a = this.getChildAt(r), this.foldInvisibleItems && !a.visible);) r--;
                    if (r < 0) 0 == this._layout || 2 == this._layout ? this.viewHeight = e : this.viewWidth = e; else {
                        var s = 0;
                        0 == this._layout || 2 == this._layout ? ((s = a.y + a.height) < e && (s = e), this.viewHeight = s) : ((s = a.x + a.width) < e && (s = e),
                            this.viewWidth = s);
                    }
                }
            }, s.getMaxItemWidth = function () {
                for (var t = this._children.length, e = 0, i = 0; i < t; i++) {
                    var n = this.getChildAt(i);
                    n.width > e && (e = n.width);
                }
                return e;
            }, s.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), this.setBoundsChangedFlag(), this._virtual && this.setVirtualListChangedFlag(!0);
            }, s.handleControllerChanged = function (e) {
                t.prototype.handleControllerChanged.call(this, e), this._selectionController == e && (this.selectedIndex = e.selectedIndex);
            }, s.updateSelectionController = function (t) {
                if (null != this._selectionController && !this._selectionController.changing && t < this._selectionController.pageCount) {
                    var e = this._selectionController;
                    this._selectionController = null, e.selectedIndex = t, this._selectionController = e;
                }
            }, s.getSnappingPosition = function (e, i, n) {
                if (this._virtual) {
                    n || (n = new g());
                    var r = NaN, a = 0;
                    return 0 == this._layout || 2 == this._layout ? (r = i, fairygui.GList.pos_param = i,
                        a = this.getIndexOnPos1(!1), i = fairygui.GList.pos_param, a < this._virtualItems.length && r - i > this._virtualItems[a].height / 2 && a < this._realNumItems && (i += this._virtualItems[a].height + this._lineGap)) : 1 == this._layout || 3 == this._layout ? (r = e,
                            fairygui.GList.pos_param = e, a = this.getIndexOnPos2(!1), e = fairygui.GList.pos_param,
                            a < this._virtualItems.length && r - e > this._virtualItems[a].width / 2 && a < this._realNumItems && (e += this._virtualItems[a].width + this._columnGap)) : (r = e,
                                fairygui.GList.pos_param = e, a = this.getIndexOnPos3(!1), e = fairygui.GList.pos_param,
                                a < this._virtualItems.length && r - e > this._virtualItems[a].width / 2 && a < this._realNumItems && (e += this._virtualItems[a].width + this._columnGap)),
                        n.x = e, n.y = i, n;
                }
                return t.prototype.getSnappingPosition.call(this, e, i, n);
            }, s.scrollToView = function (t, e, i) {
                if (void 0 === e && (e = !1), void 0 === i && (i = !1), this._virtual) {
                    if (0 == this._numItems) return;
                    if (this.checkVirtualList(), t >= this._virtualItems.length) throw new Error("Invalid child index: " + t + ">" + this._virtualItems.length);
                    var n;
                    this._loop && (t = Math.floor(this._firstIndex / this._numItems) * this._numItems + t);
                    var r = this._virtualItems[t], a = 0, s = 0;
                    if (0 == this._layout || 2 == this._layout) {
                        for (s = this._curLineItemCount - 1; s < t; s += this._curLineItemCount) a += this._virtualItems[s].height + this._lineGap;
                        n = new y(0, a, this._itemSize.x, r.height);
                    } else if (1 == this._layout || 3 == this._layout) {
                        for (s = this._curLineItemCount - 1; s < t; s += this._curLineItemCount) a += this._virtualItems[s].width + this._columnGap;
                        n = new y(a, 0, r.width, this._itemSize.y);
                    } else {
                        var o = t / (this._curLineItemCount * this._curLineItemCount2);
                        n = new y(o * this.viewWidth + t % this._curLineItemCount * (r.width + this._columnGap), t / this._curLineItemCount % this._curLineItemCount2 * (r.height + this._lineGap), r.width, r.height);
                    }
                    i = !0, null != this._scrollPane && this._scrollPane.scrollToView(n, e, i);
                } else {
                    var l = this.getChildAt(t);
                    null != this._scrollPane ? this._scrollPane.scrollToView(l, e, i) : null != this.parent && null != this.parent.scrollPane && this.parent.scrollPane.scrollToView(l, e, i);
                }
            }, s.getFirstChildInView = function () {
                return this.childIndexToItemIndex(t.prototype.getFirstChildInView.call(this));
            }, s.childIndexToItemIndex = function (t) {
                if (!this._virtual) return t;
                if (4 == this._layout) {
                    for (var e = this._firstIndex; e < this._realNumItems; e++) if (null != this._virtualItems[e].obj && --t < 0) return e;
                    return t;
                }
                return t += this._firstIndex, this._loop && this._numItems > 0 && (t %= this._numItems),
                    t;
            }, s.itemIndexToChildIndex = function (t) {
                if (!this._virtual) return t;
                if (4 == this._layout) return this.getChildIndex(this._virtualItems[t].obj);
                if (this._loop && this._numItems > 0) {
                    var e = this._firstIndex % this._numItems;
                    t >= e ? t -= e : t = this._numItems - e + t;
                } else t -= this._firstIndex;
                return t;
            }, s.setVirtual = function () {
                this._setVirtual(!1);
            }, s.setVirtualAndLoop = function () {
                this._setVirtual(!0);
            }, s._setVirtual = function (t) {
                if (!this._virtual) {
                    if (null == this._scrollPane) throw new Error("Virtual list must be scrollable!");
                    if (t) {
                        if (2 == this._layout || 3 == this._layout) throw new Error("Loop list is not supported for FlowHorizontal or FlowVertical layout!");
                        this._scrollPane.bouncebackEffect = !1;
                    }
                    if (this._virtual = !0, this._loop = t, this._virtualItems = [], this.removeChildrenToPool(),
                        null == this._itemSize) {
                        this._itemSize = new g();
                        var e = this.getFromPool(null);
                        if (null == e) throw new Error("Virtual List must have a default list item resource.");
                        this._itemSize.x = e.width, this._itemSize.y = e.height, this.returnToPool(e);
                    }
                    0 == this._layout || 2 == this._layout ? (this._scrollPane.scrollStep = this._itemSize.y,
                        this._loop && (this._scrollPane._loop = 2)) : (this._scrollPane.scrollStep = this._itemSize.x,
                            this._loop && (this._scrollPane._loop = 1)), this.on("fui_scroll", this, this.__scrolled),
                        this.setVirtualListChangedFlag(!0);
                }
            }, s.refreshVirtualList = function () {
                this.setVirtualListChangedFlag(!1);
            }, s.checkVirtualList = function () {
                0 != this._virtualListChanged && (this._refreshVirtualList(), i.timer.clear(this, this._refreshVirtualList));
            }, s.setVirtualListChangedFlag = function (t) {
                void 0 === t && (t = !1), t ? this._virtualListChanged = 2 : 0 == this._virtualListChanged && (this._virtualListChanged = 1),
                    i.timer.callLater(this, this._refreshVirtualList);
            }, s._refreshVirtualList = function () {
                var t = 2 == this._virtualListChanged;
                this._virtualListChanged = 0, this._eventLocked = !0, t && (0 == this._layout || 1 == this._layout ? this._curLineItemCount = 1 : 2 == this._layout ? this._columnCount > 0 ? this._curLineItemCount = this._columnCount : (this._curLineItemCount = Math.floor((this._scrollPane.viewWidth + this._columnGap) / (this._itemSize.x + this._columnGap)),
                    this._curLineItemCount <= 0 && (this._curLineItemCount = 1)) : 3 == this._layout ? this._lineCount > 0 ? this._curLineItemCount = this._lineCount : (this._curLineItemCount = Math.floor((this._scrollPane.viewHeight + this._lineGap) / (this._itemSize.y + this._lineGap)),
                        this._curLineItemCount <= 0 && (this._curLineItemCount = 1)) : (this._columnCount > 0 ? this._curLineItemCount = this._columnCount : (this._curLineItemCount = Math.floor((this._scrollPane.viewWidth + this._columnGap) / (this._itemSize.x + this._columnGap)),
                            this._curLineItemCount <= 0 && (this._curLineItemCount = 1)), this._lineCount > 0 ? this._curLineItemCount2 = this._lineCount : (this._curLineItemCount2 = Math.floor((this._scrollPane.viewHeight + this._lineGap) / (this._itemSize.y + this._lineGap)),
                                this._curLineItemCount2 <= 0 && (this._curLineItemCount2 = 1))));
                var e = 0, i = 0;
                if (this._realNumItems > 0) {
                    var n = 0, r = Math.ceil(this._realNumItems / this._curLineItemCount) * this._curLineItemCount, a = Math.min(this._curLineItemCount, this._realNumItems);
                    if (0 == this._layout || 2 == this._layout) {
                        for (n = 0; n < r; n += this._curLineItemCount) e += this._virtualItems[n].height + this._lineGap;
                        if (e > 0 && (e -= this._lineGap), this._autoResizeItem) i = this._scrollPane.viewWidth; else {
                            for (n = 0; n < a; n++) i += this._virtualItems[n].width + this._columnGap;
                            i > 0 && (i -= this._columnGap);
                        }
                    } else if (1 == this._layout || 3 == this._layout) {
                        for (n = 0; n < r; n += this._curLineItemCount) i += this._virtualItems[n].width + this._columnGap;
                        if (i > 0 && (i -= this._columnGap), this._autoResizeItem) e = this._scrollPane.viewHeight; else {
                            for (n = 0; n < a; n++) e += this._virtualItems[n].height + this._lineGap;
                            e > 0 && (e -= this._lineGap);
                        }
                    } else {
                        i = Math.ceil(r / (this._curLineItemCount * this._curLineItemCount2)) * this.viewWidth,
                            e = this.viewHeight;
                    }
                }
                this.handleAlign(i, e), this._scrollPane.setContentSize(i, e), this._eventLocked = !1,
                    this.handleScroll(!0);
            }, s.__scrolled = function (t) {
                this.handleScroll(!1);
            }, s.getIndexOnPos1 = function (t) {
                if (this._realNumItems < this._curLineItemCount) return n.pos_param = 0, 0;
                var e = 0, i = NaN, r = NaN;
                if (this.numChildren > 0 && !t) {
                    if ((i = this.getChildAt(0).y) > n.pos_param) {
                        for (e = this._firstIndex - this._curLineItemCount; e >= 0; e -= this._curLineItemCount) if ((i -= this._virtualItems[e].height + this._lineGap) <= n.pos_param) return n.pos_param = i,
                            e;
                        return n.pos_param = 0, 0;
                    }
                    for (e = this._firstIndex; e < this._realNumItems; e += this._curLineItemCount) {
                        if ((r = i + this._virtualItems[e].height + this._lineGap) > n.pos_param) return n.pos_param = i,
                            e;
                        i = r;
                    }
                    return n.pos_param = i, this._realNumItems - this._curLineItemCount;
                }
                for (i = 0, e = 0; e < this._realNumItems; e += this._curLineItemCount) {
                    if ((r = i + this._virtualItems[e].height + this._lineGap) > n.pos_param) return n.pos_param = i,
                        e;
                    i = r;
                }
                return n.pos_param = i, this._realNumItems - this._curLineItemCount;
            }, s.getIndexOnPos2 = function (t) {
                if (this._realNumItems < this._curLineItemCount) return n.pos_param = 0, 0;
                var e = 0, i = NaN, r = NaN;
                if (this.numChildren > 0 && !t) {
                    if ((i = this.getChildAt(0).x) > n.pos_param) {
                        for (e = this._firstIndex - this._curLineItemCount; e >= 0; e -= this._curLineItemCount) if ((i -= this._virtualItems[e].width + this._columnGap) <= n.pos_param) return n.pos_param = i,
                            e;
                        return n.pos_param = 0, 0;
                    }
                    for (e = this._firstIndex; e < this._realNumItems; e += this._curLineItemCount) {
                        if ((r = i + this._virtualItems[e].width + this._columnGap) > n.pos_param) return n.pos_param = i,
                            e;
                        i = r;
                    }
                    return n.pos_param = i, this._realNumItems - this._curLineItemCount;
                }
                for (i = 0, e = 0; e < this._realNumItems; e += this._curLineItemCount) {
                    if ((r = i + this._virtualItems[e].width + this._columnGap) > n.pos_param) return n.pos_param = i,
                        e;
                    i = r;
                }
                return n.pos_param = i, this._realNumItems - this._curLineItemCount;
            }, s.getIndexOnPos3 = function (t) {
                if (this._realNumItems < this._curLineItemCount) return n.pos_param = 0, 0;
                var e = this.viewWidth, i = Math.floor(n.pos_param / e), r = i * (this._curLineItemCount * this._curLineItemCount2), a = i * e, s = 0, o = NaN;
                for (s = 0; s < this._curLineItemCount; s++) {
                    if ((o = a + this._virtualItems[r + s].width + this._columnGap) > n.pos_param) return n.pos_param = a,
                        r + s;
                    a = o;
                }
                return n.pos_param = a, r + this._curLineItemCount - 1;
            }, s.handleScroll = function (t) {
                if (!this._eventLocked) {
                    if (0 == this._layout || 2 == this._layout) {
                        for (var e = 0; this.handleScroll1(t);) if (t = !1, ++e > 20) {
                            console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");
                            break;
                        }
                        this.handleArchOrder1();
                    } else if (1 == this._layout || 3 == this._layout) {
                        for (e = 0; this.handleScroll2(t);) if (t = !1, ++e > 20) {
                            console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");
                            break;
                        }
                        this.handleArchOrder2();
                    } else this.handleScroll3(t);
                    this._boundsChanged = !1;
                }
            }, s.handleScroll1 = function (t) {
                var e = this._scrollPane.scrollingPosY, i = e + this._scrollPane.viewHeight, n = i == this._scrollPane.contentHeight;
                fairygui.GList.pos_param = e;
                var r = this.getIndexOnPos1(t);
                if (e = fairygui.GList.pos_param, r == this._firstIndex && !t) return !1;
                var a = this._firstIndex;
                this._firstIndex = r;
                var s, o, l = r, h = a > r, u = this.numChildren, c = a + u - 1, d = h ? c : a, _ = 0, f = e, p = !1, m = 0, g = 0, y = this.defaultItem, v = 0, S = 0, T = (this._scrollPane.viewWidth - this._columnGap * (this._curLineItemCount - 1)) / this._curLineItemCount;
                for (this.itemInfoVer++; l < this._realNumItems && (n || f < i);) {
                    if ((null == (s = this._virtualItems[l]).obj || t) && (null != this.itemProvider && (null == (y = this.itemProvider.runWith(l % this._numItems)) && (y = this._defaultItem),
                        y = $.normalizeURL(y)), null != s.obj && s.obj.resourceURL != y && (s.obj instanceof fairygui.GButton && (s.selected = s.obj.selected),
                            this.removeChildToPool(s.obj), s.obj = null)), null == s.obj) {
                        if (h) {
                            for (S = d; S >= a; S--) if (null != (o = this._virtualItems[S]).obj && o.updateFlag != this.itemInfoVer && o.obj.resourceURL == y) {
                                o.obj instanceof fairygui.GButton && (o.selected = o.obj.selected), s.obj = o.obj,
                                    o.obj = null, S == d && d--;
                                break;
                            }
                        } else for (S = d; S <= c; S++) if (null != (o = this._virtualItems[S]).obj && o.updateFlag != this.itemInfoVer && o.obj.resourceURL == y) {
                            o.obj instanceof fairygui.GButton && (o.selected = o.obj.selected), s.obj = o.obj,
                                o.obj = null, S == d && d++;
                            break;
                        }
                        null != s.obj ? this.setChildIndex(s.obj, h ? l - r : this.numChildren) : (s.obj = this._pool.getObject(y),
                            h ? this.addChildAt(s.obj, l - r) : this.addChild(s.obj)), s.obj instanceof fairygui.GButton && (s.obj.selected = s.selected),
                            p = !0;
                    } else p = t;
                    p && (this._autoResizeItem && (0 == this._layout || this._columnCount > 0) && s.obj.setSize(T, s.obj.height, !0),
                        this.itemRenderer.runWith([l % this._numItems, s.obj]), l % this._curLineItemCount == 0 && (m += Math.ceil(s.obj.height) - s.height,
                            l == r && a > r && (g = Math.ceil(s.obj.height) - s.height)), s.width = Math.ceil(s.obj.width),
                        s.height = Math.ceil(s.obj.height)), s.updateFlag = this.itemInfoVer, s.obj.setXY(_, f),
                        l == r && (i += s.height), _ += s.width + this._columnGap, l % this._curLineItemCount == this._curLineItemCount - 1 && (_ = 0,
                            f += s.height + this._lineGap), l++;
                }
                for (v = 0; v < u; v++) (s = this._virtualItems[a + v]).updateFlag != this.itemInfoVer && null != s.obj && (s.obj instanceof fairygui.GButton && (s.selected = s.obj.selected),
                    this.removeChildToPool(s.obj), s.obj = null);
                for (u = this._children.length, v = 0; v < u; v++) {
                    var E = this._virtualItems[r + v].obj;
                    this._children[v] != E && this.setChildIndex(E, v);
                }
                return 0 == m && 0 == g || this._scrollPane.changeContentSizeOnScrolling(0, m, 0, g),
                    l > 0 && this.numChildren > 0 && this._container.y < 0 && this.getChildAt(0).y > -this._container.y;
            }, s.handleScroll2 = function (t) {
                var e = this._scrollPane.scrollingPosX, i = e + this._scrollPane.viewWidth, n = e == this._scrollPane.contentWidth;
                fairygui.GList.pos_param = e;
                var r = this.getIndexOnPos2(t);
                if (e = fairygui.GList.pos_param, r == this._firstIndex && !t) return !1;
                var a = this._firstIndex;
                this._firstIndex = r;
                var s, o, l = r, h = a > r, u = this.numChildren, c = a + u - 1, d = h ? c : a, _ = e, f = 0, p = !1, m = 0, g = 0, y = this.defaultItem, v = 0, S = 0, T = (this._scrollPane.viewHeight - this._lineGap * (this._curLineItemCount - 1)) / this._curLineItemCount;
                for (this.itemInfoVer++; l < this._realNumItems && (n || _ < i);) {
                    if ((null == (s = this._virtualItems[l]).obj || t) && (null != this.itemProvider && (null == (y = this.itemProvider.runWith(l % this._numItems)) && (y = this._defaultItem),
                        y = $.normalizeURL(y)), null != s.obj && s.obj.resourceURL != y && (s.obj instanceof fairygui.GButton && (s.selected = s.obj.selected),
                            this.removeChildToPool(s.obj), s.obj = null)), null == s.obj) {
                        if (h) {
                            for (S = d; S >= a; S--) if (null != (o = this._virtualItems[S]).obj && o.updateFlag != this.itemInfoVer && o.obj.resourceURL == y) {
                                o.obj instanceof fairygui.GButton && (o.selected = o.obj.selected), s.obj = o.obj,
                                    o.obj = null, S == d && d--;
                                break;
                            }
                        } else for (S = d; S <= c; S++) if (null != (o = this._virtualItems[S]).obj && o.updateFlag != this.itemInfoVer && o.obj.resourceURL == y) {
                            o.obj instanceof fairygui.GButton && (o.selected = o.obj.selected), s.obj = o.obj,
                                o.obj = null, S == d && d++;
                            break;
                        }
                        null != s.obj ? this.setChildIndex(s.obj, h ? l - r : this.numChildren) : (s.obj = this._pool.getObject(y),
                            h ? this.addChildAt(s.obj, l - r) : this.addChild(s.obj)), s.obj instanceof fairygui.GButton && (s.obj.selected = s.selected),
                            p = !0;
                    } else p = t;
                    p && (this._autoResizeItem && (1 == this._layout || this._lineCount > 0) && s.obj.setSize(s.obj.width, T, !0),
                        this.itemRenderer.runWith([l % this._numItems, s.obj]), l % this._curLineItemCount == 0 && (m += Math.ceil(s.obj.width) - s.width,
                            l == r && a > r && (g = Math.ceil(s.obj.width) - s.width)), s.width = Math.ceil(s.obj.width),
                        s.height = Math.ceil(s.obj.height)), s.updateFlag = this.itemInfoVer, s.obj.setXY(_, f),
                        l == r && (i += s.width), f += s.height + this._lineGap, l % this._curLineItemCount == this._curLineItemCount - 1 && (f = 0,
                            _ += s.width + this._columnGap), l++;
                }
                for (v = 0; v < u; v++) (s = this._virtualItems[a + v]).updateFlag != this.itemInfoVer && null != s.obj && (s.obj instanceof fairygui.GButton && (s.selected = s.obj.selected),
                    this.removeChildToPool(s.obj), s.obj = null);
                for (u = this._children.length, v = 0; v < u; v++) {
                    var E = this._virtualItems[r + v].obj;
                    this._children[v] != E && this.setChildIndex(E, v);
                }
                return 0 == m && 0 == g || this._scrollPane.changeContentSizeOnScrolling(m, 0, g, 0),
                    l > 0 && this.numChildren > 0 && this._container.x < 0 && this.getChildAt(0).x > -this._container.x;
            }, s.handleScroll3 = function (t) {
                var e = this._scrollPane.scrollingPosX;
                fairygui.GList.pos_param = e;
                var i = this.getIndexOnPos3(t);
                if (e = fairygui.GList.pos_param, i != this._firstIndex || t) {
                    var n = this._firstIndex;
                    this._firstIndex = i;
                    var r, a, s = n, o = this._virtualItems.length, l = this._curLineItemCount * this._curLineItemCount2, h = i % this._curLineItemCount, u = this.viewWidth, c = Math.floor(i / l) * l, d = c + 2 * l, _ = !1, f = 0, p = 0, m = this._defaultItem, g = (this._scrollPane.viewWidth - this._columnGap * (this._curLineItemCount - 1)) / this._curLineItemCount, y = (this._scrollPane.viewHeight - this._lineGap * (this._curLineItemCount2 - 1)) / this._curLineItemCount2;
                    for (this.itemInfoVer++, f = c; f < d; f++) if (!(f >= this._realNumItems)) {
                        if (p = f % this._curLineItemCount, f - c < l) {
                            if (p < h) continue;
                        } else if (p > h) continue;
                        (r = this._virtualItems[f]).updateFlag = this.itemInfoVer;
                    }
                    var v = null, S = 0;
                    for (f = c; f < d; f++) if (!(f >= this._realNumItems) && (r = this._virtualItems[f]).updateFlag == this.itemInfoVer) {
                        if (null == r.obj) {
                            for (; s < o;) {
                                if (null != (a = this._virtualItems[s]).obj && a.updateFlag != this.itemInfoVer) {
                                    a.obj instanceof fairygui.GButton && (a.selected = a.obj.selected), r.obj = a.obj,
                                        a.obj = null;
                                    break;
                                }
                                s++;
                            }
                            -1 == S && (S = this.getChildIndex(v) + 1), null == r.obj ? (null != this.itemProvider && (null == (m = this.itemProvider.runWith(f % this._numItems)) && (m = this._defaultItem),
                                m = $.normalizeURL(m)), r.obj = this._pool.getObject(m), this.addChildAt(r.obj, S)) : S = this.setChildIndexBefore(r.obj, S),
                                S++, r.obj instanceof fairygui.GButton && (r.obj.selected = r.selected), _ = !0;
                        } else _ = t, S = -1, v = r.obj;
                        _ && (this._autoResizeItem && (this._curLineItemCount == this._columnCount && this._curLineItemCount2 == this._lineCount ? r.obj.setSize(g, y, !0) : this._curLineItemCount == this._columnCount ? r.obj.setSize(g, r.obj.height, !0) : this._curLineItemCount2 == this._lineCount && r.obj.setSize(r.obj.width, y, !0)),
                            this.itemRenderer.runWith([f % this._numItems, r.obj]), r.width = Math.ceil(r.obj.width),
                            r.height = Math.ceil(r.obj.height));
                    }
                    var T = c / l * u, E = T, C = 0, x = 0;
                    for (f = c; f < d; f++) f >= this._realNumItems || ((r = this._virtualItems[f]).updateFlag == this.itemInfoVer && r.obj.setXY(E, C),
                        r.height > x && (x = r.height), f % this._curLineItemCount == this._curLineItemCount - 1 ? (E = T,
                            C += x + this._lineGap, x = 0, f == c + l - 1 && (E = T += u, C = 0)) : E += r.width + this._columnGap);
                    for (f = s; f < o; f++) (r = this._virtualItems[f]).updateFlag != this.itemInfoVer && null != r.obj && (r.obj instanceof fairygui.GButton && (r.selected = r.obj.selected),
                        this.removeChildToPool(r.obj), r.obj = null);
                }
            }, s.handleArchOrder1 = function () {
                if (2 == this.childrenRenderOrder) {
                    for (var t = this._scrollPane.posY + this.viewHeight / 2, e = Number.POSITIVE_INFINITY, i = 0, n = 0, r = this.numChildren, a = 0; a < r; a++) {
                        var s = this.getChildAt(a);
                        this.foldInvisibleItems && !s.visible || (i = Math.abs(t - s.y - s.height / 2)) < e && (e = i,
                            n = a);
                    }
                    this.apexIndex = n;
                }
            }, s.handleArchOrder2 = function () {
                if (2 == this.childrenRenderOrder) {
                    for (var t = this._scrollPane.posX + this.viewWidth / 2, e = Number.POSITIVE_INFINITY, i = 0, n = 0, r = this.numChildren, a = 0; a < r; a++) {
                        var s = this.getChildAt(a);
                        this.foldInvisibleItems && !s.visible || (i = Math.abs(t - s.x - s.width / 2)) < e && (e = i,
                            n = a);
                    }
                    this.apexIndex = n;
                }
            }, s.handleAlign = function (t, e) {
                var i = 0, n = 0;
                e < this.viewHeight && ("middle" == this._verticalAlign ? n = Math.floor((this.viewHeight - e) / 2) : "bottom" == this._verticalAlign && (n = this.viewHeight - e)),
                    t < this.viewWidth && ("center" == this._align ? i = Math.floor((this.viewWidth - t) / 2) : "right" == this._align && (i = this.viewWidth - t)),
                    i == this._alignOffset.x && n == this._alignOffset.y || (this._alignOffset.setTo(i, n),
                        null != this._scrollPane ? this._scrollPane.adjustMaskContainer() : this._container.pos(this._margin.left + this._alignOffset.x, this._margin.top + this._alignOffset.y));
            }, s.updateBounds = function () {
                if (!this._virtual) {
                    var t, e = 0, i = 0, n = 0, r = 0, a = 0, s = 0, o = 0, l = 0, h = 0, u = 0, c = this._children.length, d = this.viewWidth, _ = this.viewHeight, f = 0, p = 0, m = NaN;
                    if (0 == this._layout) {
                        for (e = 0; e < c; e++) t = this.getChildAt(e), this.foldInvisibleItems && !t.visible || (0 != n && (n += this._lineGap),
                            t.y = n, this._autoResizeItem && t.setSize(d, t.height, !0), n += Math.ceil(t.height),
                            t.width > r && (r = t.width));
                        s = Math.ceil(r), o = n;
                    } else if (1 == this._layout) {
                        for (e = 0; e < c; e++) t = this.getChildAt(e), this.foldInvisibleItems && !t.visible || (0 != i && (i += this._columnGap),
                            t.x = i, this._autoResizeItem && t.setSize(t.width, _, !0), i += Math.ceil(t.width),
                            t.height > a && (a = t.height));
                        s = i, o = Math.ceil(a);
                    } else if (2 == this._layout) if (this._autoResizeItem && this._columnCount > 0) {
                        for (e = 0; e < c; e++) if (t = this.getChildAt(e), (!this.foldInvisibleItems || t.visible) && (f += t.sourceWidth,
                            ++l == this._columnCount || e == c - 1)) {
                            for (m = (d - f - (l - 1) * this._columnGap) / f, i = 0, l = p; l <= e; l++) t = this.getChildAt(l),
                                this.foldInvisibleItems && !t.visible || (t.setXY(i, n), l < e ? (t.setSize(t.sourceWidth + Math.round(t.sourceWidth * m), t.height, !0),
                                    i += Math.ceil(t.width) + this._columnGap) : t.setSize(d - i, t.height, !0), t.height > a && (a = t.height));
                            n += Math.ceil(a) + this._lineGap, a = 0, l = 0, p = e + 1, f = 0;
                        }
                        o = n + Math.ceil(a), s = d;
                    } else {
                        for (e = 0; e < c; e++) t = this.getChildAt(e), this.foldInvisibleItems && !t.visible || (0 != i && (i += this._columnGap),
                            (0 != this._columnCount && l >= this._columnCount || 0 == this._columnCount && i + t.width > d && 0 != a) && (i = 0,
                                n += Math.ceil(a) + this._lineGap, a = 0, l = 0), t.setXY(i, n), (i += Math.ceil(t.width)) > r && (r = i),
                            t.height > a && (a = t.height), l++);
                        o = n + Math.ceil(a), s = Math.ceil(r);
                    } else if (3 == this._layout) if (this._autoResizeItem && this._lineCount > 0) {
                        for (e = 0; e < c; e++) if (t = this.getChildAt(e), (!this.foldInvisibleItems || t.visible) && (f += t.sourceHeight,
                            ++l == this._lineCount || e == c - 1)) {
                            for (m = (_ - f - (l - 1) * this._lineGap) / f, n = 0, l = p; l <= e; l++) t = this.getChildAt(l),
                                this.foldInvisibleItems && !t.visible || (t.setXY(i, n), l < e ? (t.setSize(t.width, t.sourceHeight + Math.round(t.sourceHeight * m), !0),
                                    n += Math.ceil(t.height) + this._lineGap) : t.setSize(t.width, _ - n, !0), t.width > r && (r = t.width));
                            i += Math.ceil(r) + this._columnGap, r = 0, l = 0, p = e + 1, f = 0;
                        }
                        s = i + Math.ceil(r), o = _;
                    } else {
                        for (e = 0; e < c; e++) t = this.getChildAt(e), this.foldInvisibleItems && !t.visible || (0 != n && (n += this._lineGap),
                            (0 != this._lineCount && l >= this._lineCount || 0 == this._lineCount && n + t.height > _ && 0 != r) && (n = 0,
                                i += Math.ceil(r) + this._columnGap, r = 0, l = 0), t.setXY(i, n), (n += Math.ceil(t.height)) > a && (a = n),
                            t.width > r && (r = t.width), l++);
                        s = i + Math.ceil(r), o = Math.ceil(a);
                    } else {
                        var g = 0;
                        if (this._autoResizeItem && this._lineCount > 0 && (g = Math.floor((_ - (this._lineCount - 1) * this._lineGap) / this._lineCount)),
                            this._autoResizeItem && this._columnCount > 0) {
                            for (e = 0; e < c; e++) if (t = this.getChildAt(e), (!this.foldInvisibleItems || t.visible) && (0 == l && (0 != this._lineCount && u >= this._lineCount || 0 == this._lineCount && n + t.height > _) && (h++,
                                n = 0, u = 0), f += t.sourceWidth, ++l == this._columnCount || e == c - 1)) {
                                for (m = (d - f - (l - 1) * this._columnGap) / f, i = 0, l = p; l <= e; l++) t = this.getChildAt(l),
                                    this.foldInvisibleItems && !t.visible || (t.setXY(h * d + i, n), l < e ? (t.setSize(t.sourceWidth + Math.round(t.sourceWidth * m), this._lineCount > 0 ? g : t.height, !0),
                                        i += Math.ceil(t.width) + this._columnGap) : t.setSize(d - i, this._lineCount > 0 ? g : t.height, !0),
                                        t.height > a && (a = t.height));
                                n += Math.ceil(a) + this._lineGap, a = 0, l = 0, p = e + 1, f = 0, u++;
                            }
                        } else for (e = 0; e < c; e++) t = this.getChildAt(e), this.foldInvisibleItems && !t.visible || (0 != i && (i += this._columnGap),
                            this._autoResizeItem && this._lineCount > 0 && t.setSize(t.width, g, !0), (0 != this._columnCount && l >= this._columnCount || 0 == this._columnCount && i + t.width > d && 0 != a) && (i = 0,
                                n += Math.ceil(a) + this._lineGap, a = 0, l = 0, u++, (0 != this._lineCount && u >= this._lineCount || 0 == this._lineCount && n + t.height > _ && 0 != r) && (h++,
                                    n = 0, u = 0)), t.setXY(h * d + i, n), (i += Math.ceil(t.width)) > r && (r = i),
                            t.height > a && (a = t.height), l++);
                        o = h > 0 ? _ : n + Math.ceil(a), s = (h + 1) * d;
                    }
                    this.handleAlign(s, o), this.setBounds(0, 0, s, o);
                }
            }, s.setup_beforeAdd = function (t, e) {
                fairygui.GObject.prototype.setup_beforeAdd.call(this, t, e), t.seek(e, 5);
                var i, n = 0, r = 0, a = 0, s = 0, o = 0;
                this._layout = t.readByte(), this._selectionMode = t.readByte(), s = t.readByte(),
                    this._align = 0 == s ? "left" : 1 == s ? "center" : "right", s = t.readByte(), this._verticalAlign = 0 == s ? "top" : 1 == s ? "middle" : "bottom",
                    this._lineGap = t.getInt16(), this._columnGap = t.getInt16(), this._lineCount = t.getInt16(),
                    this._columnCount = t.getInt16(), this._autoResizeItem = t.readBool(), this._childrenRenderOrder = t.readByte(),
                    this._apexIndex = t.getInt16(), t.readBool() && (this._margin.top = t.getInt32(),
                        this._margin.bottom = t.getInt32(), this._margin.left = t.getInt32(), this._margin.right = t.getInt32());
                var l = t.readByte();
                if (2 == l) {
                    var h = t.pos;
                    t.seek(e, 7), this.setupScroll(t), t.pos = h;
                } else this.setupOverflow(l);
                t.readBool() && t.skip(8), t.seek(e, 8), this._defaultItem = t.readS();
                var u = t.getInt16();
                for (n = 0; n < u; n++) if (o = t.getInt16(), o += t.pos, null != (i = t.readS()) || (i = this.defaultItem)) {
                    var c = this.getFromPool(i);
                    if (null != c && (this.addChild(c), null != (i = t.readS()) && (c.text = i), null != (i = t.readS()) && c instanceof fairygui.GButton && (c.selectedTitle = i),
                        null != (i = t.readS()) && (c.icon = i), null != (i = t.readS()) && c instanceof fairygui.GButton && (c.selectedIcon = i),
                        null != (i = t.readS()) && (c.name = i), c instanceof fairygui.GComponent)) for (a = t.getInt16(),
                            r = 0; r < a; r++) {
                            var d = c.getController(t.readS());
                            i = t.readS(), null != d && (d.selectedPageId = i);
                        }
                    t.pos = o;
                } else t.pos = o;
            }, s.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6);
                var n = e.getInt16();
                -1 != n && (this._selectionController = this.parent.getControllerAt(n));
            }, a(0, s, "layout", function () {
                return this._layout;
            }, function (t) {
                this._layout != t && (this._layout = t, this.setBoundsChangedFlag(), this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "align", function () {
                return this._align;
            }, function (t) {
                this._align != t && (this._align = t, this.setBoundsChangedFlag(), this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "lineCount", function () {
                return this._lineCount;
            }, function (t) {
                this._lineCount != t && (this._lineCount = t, 3 != this._layout && 4 != this._layout || (this.setBoundsChangedFlag(),
                    this._virtual && this.setVirtualListChangedFlag(!0)));
            }), a(0, s, "columnCount", function () {
                return this._columnCount;
            }, function (t) {
                this._columnCount != t && (this._columnCount = t, 2 != this._layout && 4 != this._layout || (this.setBoundsChangedFlag(),
                    this._virtual && this.setVirtualListChangedFlag(!0)));
            }), a(0, s, "lineGap", function () {
                return this._lineGap;
            }, function (t) {
                this._lineGap != t && (this._lineGap = t, this.setBoundsChangedFlag(), this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "columnGap", function () {
                return this._columnGap;
            }, function (t) {
                this._columnGap != t && (this._columnGap = t, this.setBoundsChangedFlag(), this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "verticalAlign", function () {
                return this._verticalAlign;
            }, function (t) {
                this._verticalAlign != t && (this._verticalAlign = t, this.setBoundsChangedFlag(),
                    this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "virtualItemSize", function () {
                return this._itemSize;
            }, function (t) {
                this._virtual && (null == this._itemSize && (this._itemSize = new g()), this._itemSize.setTo(t.x, t.y),
                    this.setVirtualListChangedFlag(!0));
            }), a(0, s, "defaultItem", function () {
                return this._defaultItem;
            }, function (t) {
                this._defaultItem = t;
            }), a(0, s, "autoResizeItem", function () {
                return this._autoResizeItem;
            }, function (t) {
                this._autoResizeItem != t && (this._autoResizeItem = t, this.setBoundsChangedFlag(),
                    this._virtual && this.setVirtualListChangedFlag(!0));
            }), a(0, s, "selectionMode", function () {
                return this._selectionMode;
            }, function (t) {
                this._selectionMode = t;
            }), a(0, s, "selectionController", function () {
                return this._selectionController;
            }, function (t) {
                this._selectionController = t;
            }), a(0, s, "itemPool", function () {
                return this._pool;
            }), a(0, s, "selectedIndex", function () {
                var t = 0;
                if (this._virtual) for (t = 0; t < this._realNumItems; t++) {
                    var e = this._virtualItems[t];
                    if (e.obj instanceof fairygui.GButton && e.obj.selected || null == e.obj && e.selected) return this._loop ? t % this._numItems : t;
                } else {
                    var i = this._children.length;
                    for (t = 0; t < i; t++) {
                        var n = this._children[t].asButton;
                        if (null != n && n.selected) return t;
                    }
                }
                return -1;
            }, function (t) {
                t >= 0 && t < this.numItems ? (0 != this._selectionMode && this.clearSelection(),
                    this.addSelection(t)) : this.clearSelection();
            }), a(0, s, "numItems", function () {
                return this._virtual ? this._numItems : this._children.length;
            }, function (t) {
                var n = 0;
                if (this._virtual) {
                    if (null == this.itemRenderer) throw new Error("Set itemRenderer first!");
                    this._numItems = t, this._loop ? this._realNumItems = 6 * this._numItems : this._realNumItems = this._numItems;
                    var r = this._virtualItems.length;
                    if (this._realNumItems > r) for (n = r; n < this._realNumItems; n++) {
                        var a = new e();
                        a.width = this._itemSize.x, a.height = this._itemSize.y, this._virtualItems.push(a);
                    } else for (n = this._realNumItems; n < r; n++) this._virtualItems[n].selected = !1;
                    0 != this._virtualListChanged && i.timer.clear(this, this._refreshVirtualList),
                        this._refreshVirtualList();
                } else {
                    var s = this._children.length;
                    if (t > s) for (n = s; n < t; n++) null == this.itemProvider ? this.addItemFromPool() : this.addItemFromPool(this.itemProvider.runWith(n)); else this.removeChildrenToPool(t, s);
                    if (null != this.itemRenderer) for (n = 0; n < t; n++) this.itemRenderer.runWith([n, this.getChildAt(n)]);
                }
            }), n.pos_param = NaN, n.__init$ = function () {
                e = function () {
                    function t() {
                        this.width = 0, this.height = 0, this.obj = null, this.updateFlag = 0, this.selected = !1;
                    }
                    return r(t, ""), t;
                }();
            }, n;
        }(ct), Mt = function (t) {
            function e() {
                this.div = null, this._ubbEnabled = !1, this._color = null, e.__super.call(this),
                    this._text = "";
            }
            r(e, "fairygui.GRichTextField", t);
            var i = e.prototype;
            return i.createDisplayObject = function () {
                this._displayObject = this.div = new d(), this._displayObject.mouseEnabled = !0,
                    this._displayObject.$owner = this;
            }, i.handleSizeChanged = function () {
                this.div.size(this.width, this.height);
            }, a(0, i, "bold", function () {
                return this.div.style.bold;
            }, function (t) {
                this.div.style.bold = t;
            }), a(0, i, "align", function () {
                return this.div.style.align;
            }, function (t) {
                this.div.style.align = t;
            }), a(0, i, "text", function () {
                return this._text;
            }, function (t) {
                this._text = t;
                var e = this._text;
                null != this._templateVars && (e = this.parseTemplate(e)), this._ubbEnabled ? this.div.innerHTML = et.parseUBB(e) : this.div.innerHTML = e;
            }), a(0, i, "color", function () {
                return this._color;
            }, function (t) {
                this._color != t && (this._color = t, this.div.style.color = t, this._gearColor.controller && this._gearColor.updateState());
            }), a(0, i, "font", function () {
                return this.div.style.font;
            }, function (t) {
                this.div.style.font = t || Q.defaultFont;
            }), a(0, i, "leading", function () {
                return this.div.style.leading;
            }, function (t) {
                this.div.style.leading = t;
            }), a(0, i, "fontSize", function () {
                return this.div.style.fontSize;
            }, function (t) {
                this.div.style.fontSize = t;
            }), a(0, i, "valign", function () {
                return this.div.style.valign;
            }, function (t) {
                this.div.style.valign = t;
            }), a(0, i, "italic", function () {
                return this.div.style.italic;
            }, function (t) {
                this.div.style.italic = t;
            }), a(0, i, "stroke", function () {
                return this.div.style.stroke;
            }, function (t) {
                this.div.style.stroke = t;
            }), a(0, i, "strokeColor", function () {
                return this.div.style.strokeColor;
            }, function (t) {
                this.div.style.strokeColor = t, this.updateGear(4);
            }), a(0, i, "ubbEnabled", function () {
                return this._ubbEnabled;
            }, function (t) {
                this._ubbEnabled = t;
            }), e;
        }(ut), Dt = function (t) {
            function e() {
                this._max = 0, this._value = 0, this._titleType = 0, this._reverse = !1, this._titleObject = null,
                    this._aniObject = null, this._barObjectH = null, this._barObjectV = null, this._barMaxWidth = 0,
                    this._barMaxHeight = 0, this._barMaxWidthDelta = 0, this._barMaxHeightDelta = 0,
                    this._barStartX = 0, this._barStartY = 0, this._tweening = !1, e.__super.call(this),
                    this._titleType = 0, this._value = 50, this._max = 100;
            }
            r(e, "fairygui.GProgressBar", t);
            var i = e.prototype;
            return i.tweenValue = function (t, e) {
                var i = this;
                if (this._value != t) {
                    this._tweening && (Y.kill(this, !1, this.update), this._tweening = !1);
                    var n = this._value;
                    return this._value = t, this._tweening = !0, Y.to(n, this._value, e).setTarget(this, this.update).setEase(0).onComplete(function () {
                        i._tweening = !1;
                    }, this);
                }
                return null;
            }, i.update = function (t) {
                var e = 0 != this._max ? Math.min(t / this._max, 1) : 0;
                if (this._titleObject) switch (this._titleType) {
                    case 0:
                        this._titleObject.text = Math.round(100 * e) + "%";
                        break;

                    case 1:
                        this._titleObject.text = Math.round(t) + "/" + Math.round(this._max) + " ";
                        break;

                    case 2:
                        this._titleObject.text = "" + Math.round(t);
                        break;

                    case 3:
                        this._titleObject.text = "" + Math.round(this._max);
                }
                var i = this.width - this._barMaxWidthDelta, n = this.height - this._barMaxHeightDelta;
                this._reverse ? (this._barObjectH && (this._barObjectH instanceof fairygui.GImage && 0 != this._barObjectH.fillMethod ? this._barObjectH.fillAmount = 1 - e : (this._barObjectH.width = Math.round(i * e),
                    this._barObjectH.x = this._barStartX + (i - this._barObjectH.width))), this._barObjectV && (this._barObjectV instanceof fairygui.GImage && 0 != this._barObjectV.fillMethod ? this._barObjectV.fillAmount = 1 - e : (this._barObjectV.height = Math.round(n * e),
                        this._barObjectV.y = this._barStartY + (n - this._barObjectV.height)))) : (this._barObjectH && (this._barObjectH instanceof fairygui.GImage && 0 != this._barObjectH.fillMethod ? this._barObjectH.fillAmount = e : this._barObjectH.width = Math.round(i * e)),
                            this._barObjectV && (this._barObjectV instanceof fairygui.GImage && 0 != this._barObjectV.fillMethod ? this._barObjectV.fillAmount = e : this._barObjectV.height = Math.round(n * e))),
                    this._aniObject instanceof fairygui.GMovieClip && (this._aniObject.frame = Math.round(100 * e));
            }, i.constructExtension = function (t) {
                t.seek(0, 6), this._titleType = t.readByte(), this._reverse = t.readBool(), this._titleObject = this.getChild("title"),
                    this._barObjectH = this.getChild("bar"), this._barObjectV = this.getChild("bar_v"),
                    this._aniObject = this.getChild("ani"), this._barObjectH && (this._barMaxWidth = this._barObjectH.width,
                        this._barMaxWidthDelta = this.width - this._barMaxWidth, this._barStartX = this._barObjectH.x),
                    this._barObjectV && (this._barMaxHeight = this._barObjectV.height, this._barMaxHeightDelta = this.height - this._barMaxHeight,
                        this._barStartY = this._barObjectV.y);
            }, i.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), this._barObjectH && (this._barMaxWidth = this.width - this._barMaxWidthDelta),
                    this._barObjectV && (this._barMaxHeight = this.height - this._barMaxHeightDelta),
                    this._underConstruct || this.update(this._value);
            }, i.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6) && e.readByte() == this.packageItem.objectType ? (this._value = e.getInt32(),
                    this._max = e.getInt32(), this.update(this._value)) : this.update(this._value);
            }, i.dispose = function () {
                this._tweening && Y.kill(this), t.prototype.dispose.call(this);
            }, a(0, i, "max", function () {
                return this._max;
            }, function (t) {
                this._max != t && (this._max = t, this.update(this._value));
            }), a(0, i, "titleType", function () {
                return this._titleType;
            }, function (t) {
                this._titleType != t && (this._titleType = t, this.update(this._value));
            }), a(0, i, "value", function () {
                return this._value;
            }, function (t) {
                this._tweening && (Y.kill(this, !0, this.update), this._tweening = !1), this._value != t && (this._value = t,
                    this.update(this._value));
            }), e;
        }(ct), Ot = function (t) {
            function e() {
                this._modalLayer = null, this._popupStack = null, this._justClosedPopups = null,
                    this._modalWaitPane = null, this._focusedObject = null, this._tooltipWin = null,
                    this._defaultTooltipWin = null, this._checkPopups = !1, e.__super.call(this), null == fairygui.GRoot._inst && (fairygui.GRoot._inst = this),
                    this.opaque = !1, this._popupStack = [], this._justClosedPopups = [], this.displayObject.once("display", this, this.__addedToStage);
            }
            r(e, "fairygui.GRoot", t);
            var n = e.prototype;
            return n.showWindow = function (t) {
                this.addChild(t), t.requestFocus(), t.x > this.width ? t.x = this.width - t.width : t.x + t.width < 0 && (t.x = 0),
                    t.y > this.height ? t.y = this.height - t.height : t.y + t.height < 0 && (t.y = 0),
                    this.adjustModalLayer();
            }, n.hideWindow = function (t) {
                t.hide();
            }, n.hideWindowImmediately = function (t) {
                t.parent == this && this.removeChild(t), this.adjustModalLayer();
            }, n.bringToFront = function (t) {
                var e = this.numChildren, i = NaN;
                for (i = null == this._modalLayer.parent || t.modal ? e - 1 : this.getChildIndex(this._modalLayer) - 1; i >= 0; i--) {
                    var n = this.getChildAt(i);
                    if (n == t) return;
                    if (n instanceof fairygui.Window) break;
                }
                i >= 0 && this.setChildIndex(t, i);
            }, n.showModalWait = function (t) {
                null != Q.globalModalWaiting && (null == this._modalWaitPane && (this._modalWaitPane = $.createObjectFromURL(Q.globalModalWaiting)),
                    this._modalWaitPane.setSize(this.width, this.height), this._modalWaitPane.addRelation(this, 24),
                    this.addChild(this._modalWaitPane), this._modalWaitPane.text = t);
            }, n.closeModalWait = function () {
                null != this._modalWaitPane && null != this._modalWaitPane.parent && this.removeChild(this._modalWaitPane);
            }, n.closeAllExceptModals = function () {
                for (var t = this._children.slice(), e = t.length, i = 0; i < e; i++) {
                    var n = t[i];
                    n instanceof fairygui.Window && !n.modal && n.hide();
                }
            }, n.closeAllWindows = function () {
                for (var t = this._children.slice(), e = t.length, i = 0; i < e; i++) {
                    var n = t[i];
                    n instanceof fairygui.Window && n.hide();
                }
            }, n.getTopWindow = function () {
                for (var t = this.numChildren - 1; t >= 0; t--) {
                    var e = this.getChildAt(t);
                    if (e instanceof fairygui.Window) return e;
                }
                return null;
            }, n.showPopup = function (t, e, n) {
                if (this._popupStack.length > 0) {
                    var r = this._popupStack.indexOf(t);
                    if (-1 != r) for (var a = this._popupStack.length - 1; a >= r; a--) this.removeChild(this._popupStack.pop());
                }
                if (this._popupStack.push(t), null != e) for (var s = e; null != s;) {
                    if (s.parent == this) {
                        t.sortingOrder < s.sortingOrder && (t.sortingOrder = s.sortingOrder);
                        break;
                    }
                    s = s.parent;
                }
                var o;
                this.addChild(t), this.adjustModalLayer();
                var l = 0, h = 0;
                e ? (o = e.localToGlobal(), l = e.width, h = e.height) : o = this.globalToLocal(i.stage.mouseX, i.stage.mouseY);
                var u = NaN, c = NaN;
                (u = o.x) + t.width > this.width && (u = u + l - t.width), c = o.y + h, (null == n && c + t.height > this.height || 0 == n) && (c = o.y - t.height - 1) < 0 && (c = 0,
                    u += l / 2), t.x = u, t.y = c;
            }, n.togglePopup = function (t, e, i) {
                -1 == this._justClosedPopups.indexOf(t) && this.showPopup(t, e, i);
            }, n.hidePopup = function (t) {
                if (null != t) {
                    var e = this._popupStack.indexOf(t);
                    if (-1 != e) for (var i = this._popupStack.length - 1; i >= e; i--) this.closePopup(this._popupStack.pop());
                } else {
                    for (i = this._popupStack.length - 1; i >= 0; i--) this.closePopup(this._popupStack[i]);
                    this._popupStack.length = 0;
                }
            }, n.closePopup = function (t) {
                null != t.parent && (t instanceof fairygui.Window ? t.hide() : this.removeChild(t));
            }, n.showTooltips = function (t) {
                if (null == this._defaultTooltipWin) {
                    var e = Q.tooltipsWin;
                    if (!e) return void m.print("UIConfig.tooltipsWin not defined");
                    this._defaultTooltipWin = $.createObjectFromURL(e);
                }
                this._defaultTooltipWin.text = t, this.showTooltipsWin(this._defaultTooltipWin);
            }, n.showTooltipsWin = function (t, e) {
                this.hideTooltips(), this._tooltipWin = t;
                var n = 0, r = 0;
                null == e ? (n = i.stage.mouseX + 10, r = i.stage.mouseY + 20) : (n = e.x, r = e.y);
                var a = this.globalToLocal(n, r);
                n = a.x, r = a.y, n + this._tooltipWin.width > this.width && (n = n - this._tooltipWin.width - 1) < 0 && (n = 10),
                    r + this._tooltipWin.height > this.height && (r = r - this._tooltipWin.height - 1,
                        n - this._tooltipWin.width - 1 > 0 && (n = n - this._tooltipWin.width - 1), r < 0 && (r = 10)),
                    this._tooltipWin.x = n, this._tooltipWin.y = r, this.addChild(this._tooltipWin);
            }, n.hideTooltips = function () {
                null != this._tooltipWin && (this._tooltipWin.parent && this.removeChild(this._tooltipWin),
                    this._tooltipWin = null);
            }, n.getObjectUnderPoint = function (t, e) {
                return null;
            }, n.setFocus = function (t) {
                this._focusedObject != t && (this._focusedObject = t, this.displayObject.event("fui_focus_changed"));
            }, n.playOneShotSound = function (t, e) {
                void 0 === e && (e = 1), et.startsWith(t, "ui://") || S.playSound(t);
            }, n.adjustModalLayer = function () {
                var t = this.numChildren;
                null != this._modalWaitPane && null != this._modalWaitPane.parent && this.setChildIndex(this._modalWaitPane, t - 1);
                for (var e = t - 1; e >= 0; e--) {
                    var i = this.getChildAt(e);
                    if (i instanceof fairygui.Window && i.modal) return void (null == this._modalLayer.parent ? this.addChildAt(this._modalLayer, e) : this.setChildIndexBefore(this._modalLayer, e));
                }
                null != this._modalLayer.parent && this.removeChild(this._modalLayer);
            }, n.__addedToStage = function () {
                i.stage.on("mousedown", this, this.__stageMouseDown), i.stage.on("mouseup", this, this.__stageMouseUp),
                    this._modalLayer = new yt(), this._modalLayer.setSize(this.width, this.height),
                    this._modalLayer.drawRect(0, null, Q.modalLayerColor), this._modalLayer.addRelation(this, 24),
                    this.displayObject.stage.on("resize", this, this.__winResize), this.__winResize();
            }, n.checkPopups = function (t) {
                if (!this._checkPopups && (this._checkPopups = !0, this._justClosedPopups.length = 0,
                    this._popupStack.length > 0)) {
                    for (var e = t; e != this.displayObject.stage && null != e;) {
                        if (e.$owner) {
                            var i = this._popupStack.indexOf(e.$owner);
                            if (-1 != i) {
                                for (var n = this._popupStack.length - 1; n > i; n--) {
                                    var r = this._popupStack.pop();
                                    this.closePopup(r), this._justClosedPopups.push(r);
                                }
                                return;
                            }
                        }
                        e = e.parent;
                    }
                    for (n = this._popupStack.length - 1; n >= 0; n--) r = this._popupStack[n], this.closePopup(r),
                        this._justClosedPopups.push(r);
                    this._popupStack.length = 0;
                }
            }, n.__stageMouseDown = function (t) {
                for (var e = t.target; e != this.displayObject.stage && null != e;) {
                    if (e.$owner) {
                        var i = e.$owner;
                        if (i.touchable && i.focusable) {
                            this.setFocus(i);
                            break;
                        }
                    }
                    e = e.parent;
                }
                null != this._tooltipWin && this.hideTooltips(), this.checkPopups(t.target);
            }, n.__stageMouseUp = function () {
                this._checkPopups = !1;
            }, n.__winResize = function () {
                this.setSize(i.stage.width, i.stage.height);
            }, a(0, n, "focus", function () {
                return this._focusedObject && !this._focusedObject.onStage && (this._focusedObject = null),
                    this._focusedObject;
            }, function (t) {
                if (t && (!t.focusable || !t.onStage)) throw "invalid focus target";
                this.setFocus(t);
            }), a(0, n, "hasAnyPopup", function () {
                return 0 != this._popupStack.length;
            }), a(0, n, "modalLayer", function () {
                return this._modalLayer;
            }), a(0, n, "hasModalWindow", function () {
                return null != this._modalLayer.parent;
            }), a(0, n, "modalWaiting", function () {
                return this._modalWaitPane && this._modalWaitPane.inContainer;
            }), a(0, n, "volumeScale", function () {
                return S.soundVolume;
            }, function (t) {
                S.soundVolume = t;
            }), a(1, e, "inst", function () {
                return null == fairygui.GRoot._inst && new e(), fairygui.GRoot._inst;
            }, fairygui.GComponent._$SET_inst), e._inst = null, e;
        }(ct), Lt = function (t) {
            function e() {
                this.input = null, e.__super.call(this);
            }
            r(e, "fairygui.GTextInput", t);
            var i = e.prototype;
            return i.createDisplayObject = function () {
                this._displayObject = this.input = new p(), this._displayObject.mouseEnabled = !0,
                    this._displayObject.$owner = this;
            }, i.handleSizeChanged = function () {
                this.input.size(this.width, this.height);
            }, i.setup_beforeAdd = function (e, i) {
                t.prototype.setup_beforeAdd.call(this, e, i), e.seek(i, 4);
                var n = e.readS();
                null != n && (this.promptText = n), null != (n = e.readS()) && (this.input.restrict = n);
                var r = e.getInt32();
                0 != r && (this.input.maxChars = r), 0 != (r = e.getInt32()) && (4 == r ? this.keyboardType = "number" : 3 == r && (this.keyboardType = "url")),
                    e.readBool() && (this.password = !0);
            }, a(0, i, "bold", function () {
                return this.input.bold;
            }, function (t) {
                this.input.bold = t;
            }), a(0, i, "align", function () {
                return this.input.align;
            }, function (t) {
                this.input.align = t;
            }), a(0, i, "text", function () {
                return this.input.text;
            }, function (t) {
                this.input.text = t;
            }), a(0, i, "password", function () {
                return "password" == this.input.type;
            }, function (t) {
                this.input.type = t ? "password" : "text";
            }), a(0, i, "color", function () {
                return this.input.color;
            }, function (t) {
                this.input.color = t;
            }), a(0, i, "font", function () {
                return this.input.font;
            }, function (t) {
                this.input.font = t;
            }), a(0, i, "leading", function () {
                return this.input.leading;
            }, function (t) {
                this.input.leading = t;
            }), a(0, i, "maxLength", function () {
                return this.input.maxChars;
            }, function (t) {
                this.input.maxChars = t;
            }), a(0, i, "fontSize", function () {
                return this.input.fontSize;
            }, function (t) {
                this.input.fontSize = t;
            }), a(0, i, "valign", function () {
                return this.input.valign;
            }, function (t) {
                this.input.valign = t;
            }), a(0, i, "italic", function () {
                return this.input.italic;
            }, function (t) {
                this.input.italic = t;
            }), a(0, i, "singleLine", function () {
                return !this.input.multiline;
            }, function (t) {
                this.input.multiline = !t;
            }), a(0, i, "stroke", function () {
                return this.input.stroke;
            }, function (t) {
                this.input.stroke = t;
            }), a(0, i, "strokeColor", function () {
                return this.input.strokeColor;
            }, function (t) {
                this.input.strokeColor = t, this.updateGear(4);
            }), a(0, i, "keyboardType", function () {
                return this.input.type;
            }, function (t) {
                this.input.type = t;
            }), a(0, i, "editable", function () {
                return this.input.editable;
            }, function (t) {
                this.input.editable = t;
            }), a(0, i, "promptText", function () {
                return this.input.prompt;
            }, function (t) {
                this.input.prompt = t;
            }), a(0, i, "restrict", function () {
                return this.input.restrict;
            }, function (t) {
                this.input.restrict = t;
            }), a(0, i, "textWidth", function () {
                return this.input.textWidth;
            }), e;
        }(ut), Pt = function (t) {
            function e() {
                this._grip = null, this._arrowButton1 = null, this._arrowButton2 = null, this._bar = null,
                    this._target = null, this._vertical = !1, this._scrollPerc = 0, this._fixedGripSize = !1,
                    this._dragOffset = null, e.__super.call(this), this._dragOffset = new laya.maths.Point(),
                    this._scrollPerc = 0;
            }
            r(e, "fairygui.GScrollBar", t);
            var s = e.prototype;
            return s.setScrollPane = function (t, e) {
                this._target = t, this._vertical = e;
            }, s.constructExtension = function (t) {
                t.seek(0, 6), this._fixedGripSize = t.readBool(), this._grip = this.getChild("grip"),
                    this._grip ? (this._bar = this.getChild("bar"), this._bar ? (this._arrowButton1 = this.getChild("arrow1"),
                        this._arrowButton2 = this.getChild("arrow2"), this._grip.on("mousedown", this, this.__gripMouseDown),
                        this._arrowButton1 && this._arrowButton1.on("mousedown", this, this.__arrowButton1Click),
                        this._arrowButton2 && this._arrowButton2.on("mousedown", this, this.__arrowButton2Click),
                        this.on("mousedown", this, this.__barMouseDown)) : m.print("需要定义bar")) : m.print("需要定义grip");
            }, s.__gripMouseDown = function (t) {
                this._bar && (t.stopPropagation(), i.stage.on("mousemove", this, this.__gripMouseMove),
                    i.stage.on("mouseup", this, this.__gripMouseUp), this.globalToLocal(i.stage.mouseX, i.stage.mouseY, this._dragOffset),
                    this._dragOffset.x -= this._grip.x, this._dragOffset.y -= this._grip.y);
            }, s.__gripMouseMove = function () {
                var t = this.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.GScrollBar.sScrollbarHelperPoint);
                if (this._vertical) {
                    var e = t.y - this._dragOffset.y;
                    this._target.setPercY((e - this._bar.y) / (this._bar.height - this._grip.height), !1);
                } else {
                    var n = t.x - this._dragOffset.x;
                    this._target.setPercX((n - this._bar.x) / (this._bar.width - this._grip.width), !1);
                }
            }, s.__gripMouseUp = function (t) {
                this._bar && (i.stage.off("mousemove", this, this.__gripMouseMove), i.stage.off("mouseup", this, this.__gripMouseUp));
            }, s.__arrowButton1Click = function (t) {
                t.stopPropagation(), this._vertical ? this._target.scrollUp() : this._target.scrollLeft();
            }, s.__arrowButton2Click = function (t) {
                t.stopPropagation(), this._vertical ? this._target.scrollDown() : this._target.scrollRight();
            }, s.__barMouseDown = function (t) {
                var e = this._grip.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.GScrollBar.sScrollbarHelperPoint);
                this._vertical ? e.y < 0 ? this._target.scrollUp(4) : this._target.scrollDown(4) : e.x < 0 ? this._target.scrollLeft(4) : this._target.scrollRight(4);
            }, a(0, s, "displayPerc", null, function (t) {
                this._vertical ? (this._fixedGripSize || (this._grip.height = t * this._bar.height),
                    this._grip.y = this._bar.y + (this._bar.height - this._grip.height) * this._scrollPerc) : (this._fixedGripSize || (this._grip.width = t * this._bar.width),
                        this._grip.x = this._bar.x + (this._bar.width - this._grip.width) * this._scrollPerc);
            }), a(0, s, "scrollPerc", null, function (t) {
                this._scrollPerc = t, this._vertical ? this._grip.y = this._bar.y + (this._bar.height - this._grip.height) * this._scrollPerc : this._grip.x = this._bar.x + (this._bar.width - this._grip.width) * this._scrollPerc;
            }), a(0, s, "minSize", function () {
                return this._vertical ? (null != this._arrowButton1 ? this._arrowButton1.height : 0) + (null != this._arrowButton2 ? this._arrowButton2.height : 0) : (null != this._arrowButton1 ? this._arrowButton1.width : 0) + (null != this._arrowButton2 ? this._arrowButton2.width : 0);
            }), n(e, ["sScrollbarHelperPoint", function () {
                return this.sScrollbarHelperPoint = new g();
            }]), e;
        }(ct), Nt = function (t) {
            function e() {
                this._max = 0, this._value = 0, this._titleType = 0, this._reverse = !1, this._titleObject = null,
                    this._barObjectH = null, this._barObjectV = null, this._barMaxWidth = 0, this._barMaxHeight = 0,
                    this._barMaxWidthDelta = 0, this._barMaxHeightDelta = 0, this._gripObject = null,
                    this._clickPos = null, this._clickPercent = 0, this._barStartX = 0, this._barStartY = 0,
                    this.changeOnClick = !0, this.canDrag = !0, e.__super.call(this), this._titleType = 0,
                    this._value = 50, this._max = 100, this._clickPos = new laya.maths.Point();
            }
            r(e, "fairygui.GSlider", t);
            var s = e.prototype;
            return s.update = function () {
                var t = Math.min(this._value / this._max, 1);
                this.updateWidthPercent(t);
            }, s.updateWidthPercent = function (t) {
                if (this._titleObject) switch (this._titleType) {
                    case 0:
                        this._titleObject.text = Math.round(100 * t) + "%";
                        break;

                    case 1:
                        this._titleObject.text = this._value + "/" + this._max + " ";
                        break;

                    case 2:
                        this._titleObject.text = "" + this._value;
                        break;

                    case 3:
                        this._titleObject.text = "" + this._max;
                }
                var e = this.width - this._barMaxWidthDelta, i = this.height - this._barMaxHeightDelta;
                this._reverse ? (this._barObjectH && (this._barObjectH.width = Math.round(e * t),
                    this._barObjectH.x = this._barStartX + (e - this._barObjectH.width)), this._barObjectV && (this._barObjectV.height = Math.round(i * t),
                        this._barObjectV.y = this._barStartY + (i - this._barObjectV.height))) : (this._barObjectH && (this._barObjectH.width = Math.round(e * t)),
                            this._barObjectV && (this._barObjectV.height = Math.round(i * t)));
            }, s.constructExtension = function (t) {
                t.seek(0, 6), this._titleType = t.readByte(), this._reverse = t.readBool(), this._titleObject = this.getChild("title"),
                    this._barObjectH = this.getChild("bar"), this._barObjectV = this.getChild("bar_v"),
                    this._gripObject = this.getChild("grip"), this._barObjectH && (this._barMaxWidth = this._barObjectH.width,
                        this._barMaxWidthDelta = this.width - this._barMaxWidth, this._barStartX = this._barObjectH.x),
                    this._barObjectV && (this._barMaxHeight = this._barObjectV.height, this._barMaxHeightDelta = this.height - this._barMaxHeight,
                        this._barStartY = this._barObjectV.y), this._gripObject && this._gripObject.on("mousedown", this, this.__gripMouseDown),
                    this.displayObject.on("mousedown", this, this.__barMouseDown);
            }, s.handleSizeChanged = function () {
                t.prototype.handleSizeChanged.call(this), this._barObjectH && (this._barMaxWidth = this.width - this._barMaxWidthDelta),
                    this._barObjectV && (this._barMaxHeight = this.height - this._barMaxHeightDelta),
                    this._underConstruct || this.update();
            }, s.setup_afterAdd = function (e, i) {
                t.prototype.setup_afterAdd.call(this, e, i), e.seek(i, 6) && e.readByte() == this.packageItem.objectType ? (this._value = e.getInt32(),
                    this._max = e.getInt32(), this.update()) : this.update();
            }, s.__gripMouseDown = function (t) {
                this.canDrag = !0, t.stopPropagation(), this._clickPos = this.globalToLocal(i.stage.mouseX, i.stage.mouseY),
                    this._clickPercent = this._value / this._max, i.stage.on("mousemove", this, this.__gripMouseMove),
                    i.stage.on("mouseup", this, this.__gripMouseUp);
            }, s.__gripMouseMove = function (t) {
                if (this.canDrag) {
                    var e = this.globalToLocal(i.stage.mouseX, i.stage.mouseY, fairygui.GSlider.sSilderHelperPoint), n = e.x - this._clickPos.x, r = e.y - this._clickPos.y;
                    this._reverse && (n = -n, r = -r);
                    var a = NaN;
                    (a = this._barObjectH ? this._clickPercent + n / this._barMaxWidth : this._clickPercent + r / this._barMaxHeight) > 1 ? a = 1 : a < 0 && (a = 0);
                    var s = Math.round(this._max * a);
                    s != this._value && (this._value = s, O.dispatch("fui_state_changed", this.displayObject, t)),
                        this.updateWidthPercent(a);
                }
            }, s.__gripMouseUp = function (t) {
                i.stage.off("mousemove", this, this.__gripMouseMove), i.stage.off("mouseup", this, this.__gripMouseUp);
            }, s.__barMouseDown = function (t) {
                if (this.changeOnClick) {
                    var e = this._gripObject.globalToLocal(t.stageX, t.stageY, fairygui.GSlider.sSilderHelperPoint), i = this._value / this._max, n = NaN;
                    this._barObjectH && (n = (e.x - this._gripObject.width / 2) / this._barMaxWidth),
                        this._barObjectV && (n = (e.y - this._gripObject.height / 2) / this._barMaxHeight),
                        this._reverse ? i -= n : i += n, i > 1 ? i = 1 : i < 0 && (i = 0);
                    var r = Math.round(this._max * i);
                    r != this._value && (this._value = r, O.dispatch("fui_state_changed", this.displayObject, t)),
                        this.updateWidthPercent(i);
                }
            }, a(0, s, "max", function () {
                return this._max;
            }, function (t) {
                this._max != t && (this._max = t, this.update());
            }), a(0, s, "titleType", function () {
                return this._titleType;
            }, function (t) {
                this._titleType = t;
            }), a(0, s, "value", function () {
                return this._value;
            }, function (t) {
                this._value != t && (this._value = t, this.update());
            }), n(e, ["sSilderHelperPoint", function () {
                return this.sSilderHelperPoint = new g();
            }]), e;
        }(ct), Bt = (function (t) {
            function e() {
                this._contentPane = null, this._modalWaitPane = null, this._closeButton = null,
                    this._dragArea = null, this._contentArea = null, this._frame = null, this._modal = !1,
                    this._uiSources = null, this._inited = !1, this._loading = !1, this._requestingCmd = 0,
                    this.bringToFontOnClick = !1, e.__super.call(this), this.focusable = !0, this._uiSources = [],
                    this.bringToFontOnClick = Q.bringWindowToFrontOnClick, this.displayObject.on("display", this, this.__onShown),
                    this.displayObject.on("undisplay", this, this.__onHidden), this.displayObject.on("mousedown", this, this.__mouseDown);
            }
            r(e, "fairygui.Window", t, "Window$2");
            var i = e.prototype;
            i.addUISource = function (t) {
                this._uiSources.push(t);
            }, i.show = function () {
                Ot.inst.showWindow(this);
            }, i.showOn = function (t) {
                t.showWindow(this);
            }, i.hide = function () {
                this.isShowing && this.doHideAnimation();
            }, i.hideImmediately = function () {
                var t = this.parent instanceof fairygui.GRoot ? this.parent : null;
                t || (t = Ot.inst), t.hideWindowImmediately(this);
            }, i.centerOn = function (t, e) {
                void 0 === e && (e = !1), this.setXY(Math.round((t.width - this.width) / 2), Math.round((t.height - this.height) / 2)),
                    e && (this.addRelation(t, 3), this.addRelation(t, 10));
            }, i.toggleStatus = function () {
                this.isTop ? this.hide() : this.show();
            }, i.bringToFront = function () {
                this.root.bringToFront(this);
            }, i.showModalWait = function (t) {
                void 0 === t && (t = 0), 0 != t && (this._requestingCmd = t), Q.windowModalWaiting && (this._modalWaitPane || (this._modalWaitPane = $.createObjectFromURL(Q.windowModalWaiting)),
                    this.layoutModalWaitPane(), this.addChild(this._modalWaitPane));
            }, i.layoutModalWaitPane = function () {
                if (null != this._contentArea) {
                    var t = this._frame.localToGlobal();
                    t = this.globalToLocal(t.x, t.y, t), this._modalWaitPane.setXY(t.x + this._contentArea.x, t.y + this._contentArea.y),
                        this._modalWaitPane.setSize(this._contentArea.width, this._contentArea.height);
                } else this._modalWaitPane.setSize(this.width, this.height);
            }, i.closeModalWait = function (t) {
                return void 0 === t && (t = 0), (0 == t || this._requestingCmd == t) && (this._requestingCmd = 0,
                    this._modalWaitPane && null != this._modalWaitPane.parent && this.removeChild(this._modalWaitPane),
                    !0);
            }, i.init = function () {
                if (!this._inited && !this._loading) if (this._uiSources.length > 0) {
                    this._loading = !1;
                    for (var t = this._uiSources.length, e = 0; e < t; e++) {
                        var i = this._uiSources[e];
                        i.loaded || (i.load(this.__uiLoadComplete, this), this._loading = !0);
                    }
                    this._loading || this._init();
                } else this._init();
            }, i.onInit = function () { }, i.onShown = function () { }, i.onHide = function () { },
                i.doShowAnimation = function () {
                    this.onShown();
                }, i.doHideAnimation = function () {
                    this.hideImmediately();
                }, i.__uiLoadComplete = function () {
                    for (var t = this._uiSources.length, e = 0; e < t; e++) {
                        if (!this._uiSources[e].loaded) return;
                    }
                    this._loading = !1, this._init();
                }, i._init = function () {
                    this._inited = !0, this.onInit(), this.isShowing && this.doShowAnimation();
                }, i.dispose = function () {
                    null != this.parent && this.hideImmediately(), t.prototype.dispose.call(this);
                }, i.closeEventHandler = function () {
                    this.hide();
                }, i.__onShown = function () {
                    this._inited ? this.doShowAnimation() : this.init();
                }, i.__onHidden = function () {
                    this.closeModalWait(), this.onHide();
                }, i.__mouseDown = function () {
                    this.isShowing && this.bringToFontOnClick && this.bringToFront();
                }, i.__dragStart = function (t) {
                    L.cast(t.currentTarget).stopDrag(), this.startDrag();
                }, a(0, i, "contentPane", function () {
                    return this._contentPane;
                }, function (t) {
                    this._contentPane != t && (null != this._contentPane && this.removeChild(this._contentPane),
                        this._contentPane = t, null != this._contentPane && (this.addChild(this._contentPane),
                            this.setSize(this._contentPane.width, this._contentPane.height), this._contentPane.addRelation(this, 24),
                            this._frame = this._contentPane.getChild("frame"), null != this._frame && (this.closeButton = this._frame.getChild("closeButton"),
                                this.dragArea = this._frame.getChild("dragArea"), this.contentArea = this._frame.getChild("contentArea"))));
                }), a(0, i, "isShowing", function () {
                    return null != this.parent;
                }), a(0, i, "isTop", function () {
                    return null != this.parent && this.parent.getChildIndex(this) == this.parent.numChildren - 1;
                }), a(0, i, "modal", function () {
                    return this._modal;
                }, function (t) {
                    this._modal = t;
                }), a(0, i, "dragArea", function () {
                    return this._dragArea;
                }, function (t) {
                    this._dragArea != t && (null != this._dragArea && (this._dragArea.draggable = !1,
                        this._dragArea.off("fui_drag_start", this, this.__dragStart)), this._dragArea = t,
                        null != this._dragArea && (this._dragArea instanceof fairygui.GGraph && this._dragArea.asGraph.drawRect(0, null, null),
                            this._dragArea.draggable = !0, this._dragArea.on("fui_drag_start", this, this.__dragStart)));
                }), a(0, i, "frame", function () {
                    return this._frame;
                }), a(0, i, "closeButton", function () {
                    return this._closeButton;
                }, function (t) {
                    null != this._closeButton && this._closeButton.offClick(this, this.closeEventHandler),
                        this._closeButton = t, null != this._closeButton && this._closeButton.onClick(this, this.closeEventHandler);
                }), a(0, i, "contentArea", function () {
                    return this._contentArea;
                }, function (t) {
                    this._contentArea = t;
                }), a(0, i, "modalWaiting", function () {
                    return this._modalWaitPane && null != this._modalWaitPane.parent;
                });
        }(ct), function (t) {
            function e() {
                this._source = null, this._scaleByTile = !1, this._scale9Grid = null, this._tileGridIndice = 0,
                    this._needRebuild = 0, this._fillMethod = 0, this._fillOrigin = 0, this._fillAmount = 0,
                    this._fillClockwise = !1, this._mask = null, this._color = null, e.__super.call(this),
                    this.mouseEnabled = !1, this._color = "#FFFFFF";
            }
            r(e, "fairygui.display.Image", t, "Image$1");
            var n = e.prototype;
            return n.markChanged = function (t) {
                this._needRebuild ? this._needRebuild |= t : (this._needRebuild = t, i.timer.callLater(this, this.rebuild));
            }, n.rebuild = function () {
                0 != (1 & this._needRebuild) && this.doDraw(), 0 != (2 & this._needRebuild) && 0 != this._fillMethod && this.doFill(),
                    this._needRebuild = 0;
            }, n.doDraw = function () {
                var t = this.width, e = this.height, i = this.graphics, n = this._source;
                if (i.clear(), null != n && 0 != t && 0 != e) if (this._scaleByTile) i.fillTexture(n, 0, 0, t, e); else if (null != this._scale9Grid) {
                    var r = n.width, a = n.height, s = this._scale9Grid.x, o = Math.max(r - this._scale9Grid.right, 0), l = this._scale9Grid.y, h = Math.max(a - this._scale9Grid.bottom, 0), u = NaN;
                    e >= a - this._scale9Grid.height ? (l = this._scale9Grid.y, h = a - this._scale9Grid.bottom) : (u = e * (u = this._scale9Grid.y / (a - this._scale9Grid.bottom)) / (1 + u),
                        l = Math.round(u), h = e - u), t >= r - this._scale9Grid.width ? (s = this._scale9Grid.x,
                            o = r - this._scale9Grid.right) : (u = t * (u = this._scale9Grid.x / (r - this._scale9Grid.right)) / (1 + u),
                                s = Math.round(u), o = t - u);
                    var c = Math.max(t - s - o, 0), d = Math.max(e - l - h, 0);
                    s && l && i.drawImage(fairygui.display.Image.getTexture(n, 0, 0, s, l), 0, 0, s, l),
                        o && l && i.drawImage(fairygui.display.Image.getTexture(n, r - o, 0, o, l), t - o, 0, o, l),
                        s && h && i.drawImage(fairygui.display.Image.getTexture(n, 0, a - h, s, h), 0, e - h, s, h),
                        o && h && i.drawImage(fairygui.display.Image.getTexture(n, r - o, a - h, o, h), t - o, e - h, o, h),
                        c && l && this.drawTexture(0, fairygui.display.Image.getTexture(n, s, 0, r - s - o, l), s, 0, c, l),
                        c && h && this.drawTexture(1, fairygui.display.Image.getTexture(n, s, a - h, r - s - o, h), s, e - h, c, h),
                        d && s && this.drawTexture(2, fairygui.display.Image.getTexture(n, 0, l, s, a - l - h), 0, l, s, d),
                        d && o && this.drawTexture(3, fairygui.display.Image.getTexture(n, r - o, l, o, a - l - h), t - o, l, o, d),
                        c && d && this.drawTexture(4, fairygui.display.Image.getTexture(n, s, l, r - s - o, a - l - h), s, l, c, d);
                } else i.drawImage(n, 0, 0, t, e);
            }, n.drawTexture = function (t, e, i, n, r, a) {
                void 0 === r && (r = 0), void 0 === a && (a = 0), -1 == t || 0 == (this._tileGridIndice & 1 << t) ? this.graphics.drawImage(e, i, n, r, a) : this.graphics.fillTexture(e, i, n, r, a);
            }, n.doFill = function () {
                var t = this.width, e = this.height, i = this._mask.graphics;
                if (i.clear(), 0 != t && 0 != e) {
                    var n = M.fill(t, e, this._fillMethod, this._fillOrigin, this._fillClockwise, this._fillAmount);
                    if (null == n) return this.mask = null, void (this.mask = this._mask);
                    i.drawPoly(0, 0, n, "#FFFFFF");
                }
            }, a(0, n, "width", t.prototype._$get_width, function (t) {
                this._width !== t && (i.superSet(T, this, "width", t), this.markChanged(1));
            }), a(0, n, "fillOrigin", function () {
                return this._fillOrigin;
            }, function (t) {
                this._fillOrigin != t && (this._fillOrigin = t, 0 != this._fillMethod && this.markChanged(2));
            }), a(0, n, "height", t.prototype._$get_height, function (t) {
                this._height !== t && (i.superSet(T, this, "height", t), this.markChanged(1));
            }), a(0, n, "scaleByTile", function () {
                return this._scaleByTile;
            }, function (t) {
                this._scaleByTile != t && (this._scaleByTile = t, this.markChanged(1));
            }), a(0, n, "texture", function () {
                return this._source;
            }, function (t) {
                this._source != t && (this._source = t, 0 == this.width && (this._source ? this.size(this._source.width, this._source.height) : this.size(0, 0)),
                    this.repaint(), this.markChanged(1));
            }), a(0, n, "scale9Grid", function () {
                return this._scale9Grid;
            }, function (t) {
                this._scale9Grid = t, this.markChanged(1);
            }), a(0, n, "tileGridIndice", function () {
                return this._tileGridIndice;
            }, function (t) {
                this._tileGridIndice != t && (this._tileGridIndice = t, this.markChanged(1));
            }), a(0, n, "fillMethod", function () {
                return this._fillMethod;
            }, function (t) {
                this._fillMethod != t && (this._fillMethod = t, 0 != this._fillMethod ? (this._mask || (this._mask = new T(),
                    this._mask.mouseEnabled = !1), this.mask = this._mask, this.markChanged(2)) : this.mask && (this._mask.graphics.clear(),
                        this.mask = null));
            }), a(0, n, "fillClockwise", function () {
                return this._fillClockwise;
            }, function (t) {
                this._fillClockwise != t && (this._fillClockwise = t, 0 != this._fillMethod && this.markChanged(2));
            }), a(0, n, "fillAmount", function () {
                return this._fillAmount;
            }, function (t) {
                this._fillAmount != t && (this._fillAmount = t, 0 != this._fillMethod && this.markChanged(2));
            }), a(0, n, "color", function () {
                return this._color;
            }, function (t) {
                this._color != t && (this._color = t);
            }), e.getTexture = function (t, e, i, n, r) {
                var a;
                return n <= 0 && (n = 1), r <= 0 && (r = 1), t.$_GID || (t.$_GID = x.getGID()),
                    a && a._getSource() || (a = C.createFromTexture(t, e, i, n, r)), a;
            }, e;
        }(T)), Ft = function (t) {
            function e() {
                this.interval = 0, this.swing = !1, this.repeatDelay = 0, this.timeScale = 1, this._playing = !0,
                    this._frameCount = 0, this._frames = null, this._frame = 0, this._start = 0, this._end = 0,
                    this._times = 0, this._endAt = 0, this._status = 0, this._endHandler = null, this._frameElapsed = 0,
                    this._reversed = !1, this._repeatedCount = 0, e.__super.call(this), this.mouseEnabled = !1,
                    this.setPlaySettings(), this.on("display", this, this.__addToStage), this.on("undisplay", this, this.__removeFromStage);
            }
            r(e, "fairygui.display.MovieClip", t, "MovieClip$1");
            var n = e.prototype;
            return n.rewind = function () {
                this._frame = 0, this._frameElapsed = 0, this._reversed = !1, this._repeatedCount = 0,
                    this.drawFrame();
            }, n.syncStatus = function (t) {
                this._frame = t._frame, this._frameElapsed = t._frameElapsed, this._reversed = t._reversed,
                    this._repeatedCount = t._repeatedCount, this.drawFrame();
            }, n.advance = function (t) {
                for (var e = this._frame, i = this._reversed, n = t; ;) {
                    var r = this.interval + this._frames[this._frame].addDelay;
                    if (0 == this._frame && this._repeatedCount > 0 && (r += this.repeatDelay), t < r) {
                        this._frameElapsed = 0;
                        break;
                    }
                    if (t -= r, this.swing ? this._reversed ? (this._frame--, this._frame <= 0 && (this._frame = 0,
                        this._repeatedCount++, this._reversed = !this._reversed)) : (this._frame++, this._frame > this._frameCount - 1 && (this._frame = Math.max(0, this._frameCount - 2),
                            this._repeatedCount++, this._reversed = !this._reversed)) : (this._frame++, this._frame > this._frameCount - 1 && (this._frame = 0,
                                this._repeatedCount++)), this._frame == e && this._reversed == i) {
                        var a = n - t;
                        t -= Math.floor(t / a) * a;
                    }
                }
                this.drawFrame();
            }, n.setPlaySettings = function (t, e, i, n, r) {
                void 0 === t && (t = 0), void 0 === e && (e = -1), void 0 === i && (i = 0), void 0 === n && (n = -1),
                    this._start = t, this._end = e, (-1 == this._end || this._end > this._frameCount - 1) && (this._end = this._frameCount - 1),
                    this._times = i, this._endAt = n, -1 == this._endAt && (this._endAt = this._end),
                    this._status = 0, this._endHandler = r, this.frame = t;
            }, n.update = function () {
                if (this._playing && 0 != this._frameCount && 3 != this._status) {
                    var t = i.timer.delta;
                    t > 100 && (t = 100), 1 != this.timeScale && (t *= this.timeScale), this._frameElapsed += t;
                    var e = this.interval + this._frames[this._frame].addDelay;
                    if (0 == this._frame && this._repeatedCount > 0 && (e += this.repeatDelay), !(this._frameElapsed < e)) {
                        if (this._frameElapsed -= e, this._frameElapsed > this.interval && (this._frameElapsed = this.interval),
                            this.swing ? this._reversed ? (this._frame--, this._frame <= 0 && (this._frame = 0,
                                this._repeatedCount++, this._reversed = !this._reversed)) : (this._frame++, this._frame > this._frameCount - 1 && (this._frame = Math.max(0, this._frameCount - 2),
                                    this._repeatedCount++, this._reversed = !this._reversed)) : (this._frame++, this._frame > this._frameCount - 1 && (this._frame = 0,
                                        this._repeatedCount++)), 1 == this._status) this._frame = this._start, this._frameElapsed = 0,
                                            this._status = 0; else if (2 == this._status) {
                                                if (this._frame = this._endAt, this._frameElapsed = 0, this._status = 3, null != this._endHandler) {
                                                    var n = this._endHandler;
                                                    this._endHandler = null, n.run();
                                                }
                                            } else this._frame == this._end && (this._times > 0 ? (this._times--, 0 == this._times ? this._status = 2 : this._status = 1) : 0 != this._start && (this._status = 1));
                        this.drawFrame();
                    }
                }
            }, n.drawFrame = function () {
                if (this._frameCount > 0 && this._frame < this._frames.length) {
                    var t = this._frames[this._frame];
                    this.texture = t.texture;
                } else this.texture = null;
                this.rebuild();
            }, n.checkTimer = function () {
                this._playing && this._frameCount > 0 && null != this.stage ? i.timer.frameLoop(1, this, this.update) : i.timer.clear(this, this.update);
            }, n.__addToStage = function () {
                this._playing && this._frameCount > 0 && i.timer.frameLoop(1, this, this.update);
            }, n.__removeFromStage = function () {
                i.timer.clear(this, this.update);
            }, a(0, n, "frames", function () {
                return this._frames;
            }, function (t) {
                this._frames = t, this._scaleByTile = !1, this._scale9Grid = null, null != this._frames ? (this._frameCount = this._frames.length,
                    (-1 == this._end || this._end > this._frameCount - 1) && (this._end = this._frameCount - 1),
                    (-1 == this._endAt || this._endAt > this._frameCount - 1) && (this._endAt = this._frameCount - 1),
                    (this._frame < 0 || this._frame > this._frameCount - 1) && (this._frame = this._frameCount - 1),
                    this._frameElapsed = 0, this._repeatedCount = 0, this._reversed = !1) : this._frameCount = 0,
                    this.drawFrame(), this.checkTimer();
            }), a(0, n, "playing", function () {
                return this._playing;
            }, function (t) {
                this._playing != t && (this._playing = t, this.checkTimer());
            }), a(0, n, "frameCount", function () {
                return this._frameCount;
            }), a(0, n, "frame", function () {
                return this._frame;
            }, function (t) {
                this._frame != t && (null != this._frames && t >= this._frameCount && (t = this._frameCount - 1),
                    this._frame = t, this._frameElapsed = 0, this.drawFrame());
            }), e;
        }(Bt);
        i.__init([bt, Rt, w, mt, $, _t, H, X, dt, gt, U]);
    }(window, document, Laya);
}, function (t, e, i) {
    (function (t) {
        !function (e) {
            ("undefined" != typeof window ? window : void 0 !== t ? t : "undefined" != typeof self ? self : this).b3 = function t(e, i, n) {
                function r(s, o) {
                    if (!i[s]) {
                        if (!e[s]) {
                            if (a) return a(s, !0);
                            var l = new Error("Cannot find module '" + s + "'");
                            throw l.code = "MODULE_NOT_FOUND", l;
                        }
                        var h = i[s] = {
                            exports: {}
                        };
                        e[s][0].call(h.exports, function (t) {
                            return r(e[s][1][t] || t);
                        }, h, h.exports, t, e, i, n);
                    }
                    return i[s].exports;
                }
                for (var a = !1, s = 0; s < n.length; s++) r(n[s]);
                return r;
            }({
                1: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n, r = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), a = t("../constants"), s = t("../core/Action"), o = function (t) {
                        function e() {
                            return function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            }(this, e), function (t, e) {
                                if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                                return !e || "object" != typeof e && "function" != typeof e ? t : e;
                            }(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Error"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), r(e, [{
                            key: "tick",
                            value: function (t) {
                                return a.ERROR;
                            }
                        }]), e;
                    }(((n = s) && n.__esModule ? n : {
                        default: n
                    }).default);
                    i.default = o;
                }, {
                    "../constants": 13,
                    "../core/Action": 14
                }],
                2: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n, r = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), a = t("../core/Action"), s = (n = a) && n.__esModule ? n : {
                        default: n
                    }, o = t("../constants"), l = function (t) {
                        function e() {
                            return function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            }(this, e), function (t, e) {
                                if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                                return !e || "object" != typeof e && "function" != typeof e ? t : e;
                            }(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Failer"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), r(e, [{
                            key: "tick",
                            value: function (t) {
                                return o.FAILURE;
                            }
                        }]), e;
                    }(s.default);
                    i.default = l;
                }, {
                    "../constants": 13,
                    "../core/Action": 14
                }],
                3: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n, r = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), a = t("../core/Action"), s = (n = a) && n.__esModule ? n : {
                        default: n
                    }, o = t("../constants"), l = function (t) {
                        function e() {
                            return function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            }(this, e), function (t, e) {
                                if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                                return !e || "object" != typeof e && "function" != typeof e ? t : e;
                            }(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Runner"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), r(e, [{
                            key: "tick",
                            value: function (t) {
                                return o.RUNNING;
                            }
                        }]), e;
                    }(s.default);
                    i.default = l;
                }, {
                    "../constants": 13,
                    "../core/Action": 14
                }],
                4: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n, r = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), a = t("../core/Action"), s = (n = a) && n.__esModule ? n : {
                        default: n
                    }, o = t("../constants"), l = function (t) {
                        function e() {
                            return function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            }(this, e), function (t, e) {
                                if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                                return !e || "object" != typeof e && "function" != typeof e ? t : e;
                            }(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Succeeder"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), r(e, [{
                            key: "tick",
                            value: function (t) {
                                return o.SUCCESS;
                            }
                        }]), e;
                    }(s.default);
                    i.default = l;
                }, {
                    "../constants": 13,
                    "../core/Action": 14
                }],
                5: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Action"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.milliseconds, a = void 0 === i ? 0 : i;
                            n(this, e);
                            var s = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Wait",
                                title: "Wait <milliseconds>ms",
                                properties: {
                                    milliseconds: 0
                                }
                            }));
                            return s.endTime = a, s;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                var e = new Date().getTime();
                                t.blackboard.set("startTime", e, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                return new Date().getTime() - t.blackboard.get("startTime", t.tree.id, this.id) > this.endTime ? h.SUCCESS : h.RUNNING;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Action": 14
                }],
                6: [function (t, e, i) {
                    "use strict";
                    function n(t) {
                        return t && t.__esModule ? t : {
                            default: t
                        };
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var r = t("./Error");
                    Object.defineProperty(i, "Error", {
                        enumerable: !0,
                        get: function () {
                            return n(r).default;
                        }
                    });
                    var a = t("./Failer");
                    Object.defineProperty(i, "Failer", {
                        enumerable: !0,
                        get: function () {
                            return n(a).default;
                        }
                    });
                    var s = t("./Runner");
                    Object.defineProperty(i, "Runner", {
                        enumerable: !0,
                        get: function () {
                            return n(s).default;
                        }
                    });
                    var o = t("./Succeeder");
                    Object.defineProperty(i, "Succeeder", {
                        enumerable: !0,
                        get: function () {
                            return n(o).default;
                        }
                    });
                    var l = t("./Wait");
                    Object.defineProperty(i, "Wait", {
                        enumerable: !0,
                        get: function () {
                            return n(l).default;
                        }
                    });
                }, {
                    "./Error": 1,
                    "./Failer": 2,
                    "./Runner": 3,
                    "./Succeeder": 4,
                    "./Wait": 5
                }],
                7: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    }), i.createUUID = function () {
                        for (var t = [], e = "0123456789abcdef", i = 0; i < 36; i++) t[i] = e.substr(Math.floor(16 * Math.random()), 1);
                        return t[14] = "4", t[19] = e.substr(3 & t[19] | 8, 1), t[8] = t[13] = t[18] = t[23] = "-",
                            t.join("");
                    };
                }, {}],
                8: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Composite"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.children, a = void 0 === i ? [] : i;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                children: a,
                                name: "MemPriority"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("runningChild", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                for (var e = t.blackboard.get("runningChild", t.tree.id, this.id); e < this.children.length; e++) {
                                    var i = this.children[e]._execute(t);
                                    if (i !== h.FAILURE) return i === h.RUNNING && t.blackboard.set("runningChild", e, t.tree.id, this.id),
                                        i;
                                }
                                return h.FAILURE;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Composite": 18
                }],
                9: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Composite"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.children, a = void 0 === i ? [] : i;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "MemSequence",
                                children: a
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("runningChild", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                for (var e = t.blackboard.get("runningChild", t.tree.id, this.id); e < this.children.length; e++) {
                                    var i = this.children[e]._execute(t);
                                    if (i !== h.SUCCESS) return i === h.RUNNING && t.blackboard.set("runningChild", e, t.tree.id, this.id),
                                        i;
                                }
                                return h.SUCCESS;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Composite": 18
                }],
                10: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Composite"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.children, a = void 0 === i ? [] : i;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Priority",
                                children: a
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "tick",
                            value: function (t) {
                                for (var e = 0; e < this.children.length; e++) {
                                    var i = this.children[e]._execute(t);
                                    if (i !== h.FAILURE) return i;
                                }
                                return h.FAILURE;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Composite": 18
                }],
                11: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Composite"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.children, a = void 0 === i ? [] : i;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                name: "Sequence",
                                children: a
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "tick",
                            value: function (t) {
                                for (var e = 0; e < this.children.length; e++) {
                                    var i = this.children[e]._execute(t);
                                    if (i !== h.SUCCESS) return i;
                                }
                                return h.SUCCESS;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Composite": 18
                }],
                12: [function (t, e, i) {
                    "use strict";
                    function n(t) {
                        return t && t.__esModule ? t : {
                            default: t
                        };
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var r = t("./MemPriority");
                    Object.defineProperty(i, "MemPriority", {
                        enumerable: !0,
                        get: function () {
                            return n(r).default;
                        }
                    });
                    var a = t("./MemSequence");
                    Object.defineProperty(i, "MemSequence", {
                        enumerable: !0,
                        get: function () {
                            return n(a).default;
                        }
                    });
                    var s = t("./Priority");
                    Object.defineProperty(i, "Priority", {
                        enumerable: !0,
                        get: function () {
                            return n(s).default;
                        }
                    });
                    var o = t("./Sequence");
                    Object.defineProperty(i, "Sequence", {
                        enumerable: !0,
                        get: function () {
                            return n(o).default;
                        }
                    });
                }, {
                    "./MemPriority": 8,
                    "./MemSequence": 9,
                    "./Priority": 10,
                    "./Sequence": 11
                }],
                13: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    }), i.VERSION = "0.2.2", i.SUCCESS = 1, i.FAILURE = 2, i.RUNNING = 3, i.ERROR = 4,
                        i.COMPOSITE = "composite", i.DECORATOR = "decorator", i.ACTION = "action", i.CONDITION = "condition";
                }, {}],
                14: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = t("../core/BaseNode"), o = (a = s) && a.__esModule ? a : {
                        default: a
                    }, l = t("../constants"), h = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.name, a = void 0 === i ? "Action" : i, s = t.title, o = t.properties;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                category: l.ACTION,
                                name: a,
                                title: s,
                                properties: o
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), e;
                    }(o.default);
                    i.default = h;
                }, {
                    "../constants": 13,
                    "../core/BaseNode": 15
                }],
                15: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var r = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), a = t("../b3.functions"), s = t("../constants"), o = function () {
                        function t() {
                            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = e.category, r = e.name, s = e.title, o = e.description, l = e.properties;
                            n(this, t), this.id = (0, a.createUUID)(), this.category = i || "", this.name = r || "",
                                this.title = s || this.name, this.description = o || "", this.properties = l || {},
                                this.parameters = {};
                        }
                        return r(t, [{
                            key: "_execute",
                            value: function (t) {
                                this._enter(t), t.blackboard.get("isOpen", t.tree.id, this.id) || this._open(t);
                                var e = this._tick(t);
                                return e !== s.RUNNING && this._close(t), this._exit(t), e;
                            }
                        }, {
                            key: "_enter",
                            value: function (t) {
                                t._enterNode(this), this.enter(t);
                            }
                        }, {
                            key: "_open",
                            value: function (t) {
                                t._openNode(this), t.blackboard.set("isOpen", !0, t.tree.id, this.id), this.open(t);
                            }
                        }, {
                            key: "_tick",
                            value: function (t) {
                                return t._tickNode(this), this.tick(t);
                            }
                        }, {
                            key: "_close",
                            value: function (t) {
                                t._closeNode(this), t.blackboard.set("isOpen", !1, t.tree.id, this.id), this.close(t);
                            }
                        }, {
                            key: "_exit",
                            value: function (t) {
                                t._exitNode(this), this.exit(t);
                            }
                        }, {
                            key: "enter",
                            value: function (t) { }
                        }, {
                            key: "open",
                            value: function (t) { }
                        }, {
                            key: "tick",
                            value: function (t) { }
                        }, {
                            key: "close",
                            value: function (t) { }
                        }, {
                            key: "exit",
                            value: function (t) { }
                        }]), t;
                    }();
                    i.default = o;
                }, {
                    "../b3.functions": 7,
                    "../constants": 13
                }],
                16: [function (t, e, i) {
                    "use strict";
                    function n(t) {
                        if (t && t.__esModule) return t;
                        var e = {};
                        if (null != t) for (var i in t) Object.prototype.hasOwnProperty.call(t, i) && (e[i] = t[i]);
                        return e.default = t, e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var r, a = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), s = t("../b3.functions"), o = t("../constants"), l = n(t("../decorators")), h = n(t("../composites")), u = n(t("../actions")), c = t("./Tick"), d = (r = c) && r.__esModule ? r : {
                        default: r
                    }, _ = function () {
                        function t() {
                            (function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            })(this, t), this.id = (0, s.createUUID)(), this.title = "The behavior tree", this.description = "Default description",
                                this.properties = {}, this.root = null, this.debug = null;
                        }
                        return a(t, [{
                            key: "load",
                            value: function (t, e) {
                                e = e || {}, this.title = t.title || this.title, this.description = t.description || this.description,
                                    this.properties = t.properties || this.properties;
                                var i, n, r, a = {};
                                for (i in t.nodes) {
                                    var s;
                                    if ((n = t.nodes[i]).name in e) s = e[n.name]; else if (n.name in l) s = l[n.name]; else if (n.name in h) s = h[n.name]; else {
                                        if (!(n.name in u)) throw new EvalError('BehaviorTree.load: Invalid node name + "' + n.name + '".');
                                        s = u[n.name];
                                    }
                                    (r = new s(n.properties)).id = n.id || r.id, r.title = n.title || r.title, r.description = n.description || r.description,
                                        r.properties = n.properties || r.properties, a[i] = r;
                                }
                                for (i in t.nodes) if (n = t.nodes[i], (r = a[i]).category === o.COMPOSITE && n.children) for (var c = 0; c < n.children.length; c++) {
                                    var d = n.children[c];
                                    r.children.push(a[d]);
                                } else r.category === o.DECORATOR && n.child && (r.child = a[n.child]);
                                this.root = a[t.root];
                            }
                        }, {
                            key: "tick",
                            value: function (t, e) {
                                if (!e) throw "The blackboard parameter is obligatory and must be an instance of b3.Blackboard";
                                var i = new d.default();
                                i.debug = this.debug, i.target = t, i.blackboard = e, i.tree = this;
                                var n, r = this.root._execute(i), a = e.get("openNodes", this.id), s = i._openNodes, o = 0;
                                for (n = 0; n < Math.min(a.length, s.length) && (o = n + 1, a[n] === s[n]); n++);
                                for (n = a.length - 1; n >= o; n--) a[n]._close(i);
                                return e.set("openNodes", s, this.id), e.set("nodeCount", i._nodeCount, this.id),
                                    r;
                            }
                        }]), t;
                    }();
                    i.default = _;
                }, {
                    "../actions": 6,
                    "../b3.functions": 7,
                    "../composites": 12,
                    "../constants": 13,
                    "../decorators": 28,
                    "./Tick": 21
                }],
                17: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), r = function () {
                        function t() {
                            (function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            })(this, t), this._baseMemory = {}, this._treeMemory = {};
                        }
                        return n(t, [{
                            key: "_getTreeMemory",
                            value: function (t) {
                                return this._treeMemory[t] || (this._treeMemory[t] = {
                                    nodeMemory: {},
                                    openNodes: [],
                                    traversalDepth: 0,
                                    traversalCycle: 0
                                }), this._treeMemory[t];
                            }
                        }, {
                            key: "_getNodeMemory",
                            value: function (t, e) {
                                var i = t.nodeMemory;
                                return i[e] || (i[e] = {}), i[e];
                            }
                        }, {
                            key: "_getMemory",
                            value: function (t, e) {
                                var i = this._baseMemory;
                                return t && (i = this._getTreeMemory(t), e && (i = this._getNodeMemory(i, e))),
                                    i;
                            }
                        }, {
                            key: "set",
                            value: function (t, e, i, n) {
                                this._getMemory(i, n)[t] = e;
                            }
                        }, {
                            key: "get",
                            value: function (t, e, i) {
                                return this._getMemory(e, i)[t];
                            }
                        }]), t;
                    }();
                    i.default = r;
                }, {}],
                18: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = t("../core/BaseNode"), o = (a = s) && a.__esModule ? a : {
                        default: a
                    }, l = t("../constants"), h = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.children, a = void 0 === i ? [] : i, s = t.name, o = void 0 === s ? "Composite" : s, h = t.title, u = t.properties;
                            n(this, e);
                            var c = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                category: l.COMPOSITE,
                                name: o,
                                title: h,
                                properties: u
                            }));
                            return c.children = a.slice(0), c;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), e;
                    }(o.default);
                    i.default = h;
                }, {
                    "../constants": 13,
                    "../core/BaseNode": 15
                }],
                19: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = t("./BaseNode"), o = (a = s) && a.__esModule ? a : {
                        default: a
                    }, l = t("../constants"), h = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.name, a = void 0 === i ? "Condition" : i, s = t.title, o = t.properties;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                category: l.CONDITION,
                                name: a,
                                title: s,
                                properties: o
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), e;
                    }(o.default);
                    i.default = h;
                }, {
                    "../constants": 13,
                    "./BaseNode": 15
                }],
                20: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = t("./BaseNode"), o = (a = s) && a.__esModule ? a : {
                        default: a
                    }, l = t("../constants"), h = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.child, a = void 0 === i ? null : i, s = t.name, o = void 0 === s ? "Decorator" : s, h = t.title, u = t.properties;
                            n(this, e);
                            var c = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                category: l.DECORATOR,
                                name: o,
                                title: h,
                                properties: u
                            }));
                            return c.child = a, c;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), e;
                    }(o.default);
                    i.default = h;
                }, {
                    "../constants": 13,
                    "./BaseNode": 15
                }],
                21: [function (t, e, i) {
                    "use strict";
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var n = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), r = function () {
                        function t() {
                            (function (t, e) {
                                if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                            })(this, t), this.tree = null, this.debug = null, this.target = null, this.blackboard = null,
                                this._openNodes = [], this._nodeCount = 0;
                        }
                        return n(t, [{
                            key: "_enterNode",
                            value: function (t) {
                                this._nodeCount++, this._openNodes.push(t);
                            }
                        }, {
                            key: "_openNode",
                            value: function (t) { }
                        }, {
                            key: "_tickNode",
                            value: function (t) {
                                this.debug && console.log(">>>>> ", t.name, t.title);
                            }
                        }, {
                            key: "_closeNode",
                            value: function (t) {
                                this._openNodes.pop();
                            }
                        }, {
                            key: "_exitNode",
                            value: function (t) { }
                        }]), t;
                    }();
                    i.default = r;
                }, {}],
                22: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.child, a = void 0 === i ? null : i;
                            return n(this, e), r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: a,
                                name: "Inverter"
                            }));
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                var e = this.child._execute(t);
                                return e == h.SUCCESS ? e = h.FAILURE : e == h.FAILURE && (e = h.SUCCESS), e;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                23: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.child, a = void 0 === i ? null : i, s = t.maxLoop;
                            n(this, e);
                            var o = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: a,
                                name: "Limiter",
                                title: "Limit <maxLoop> Activations",
                                properties: {
                                    maxLoop: 1
                                }
                            }));
                            if (!s) throw "maxLoop parameter in Limiter decorator is an obligatory parameter";
                            return o.maxLoop = s, o;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("i", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                var e = t.blackboard.get("i", t.tree.id, this.id);
                                if (e < this.maxLoop) {
                                    var i = this.child._execute(t);
                                    return i != h.SUCCESS && i != h.FAILURE || t.blackboard.set("i", e + 1, t.tree.id, this.id),
                                        i;
                                }
                                return h.FAILURE;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                24: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.maxTime, a = t.child, s = void 0 === a ? null : a;
                            n(this, e);
                            var o = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: s,
                                name: "MaxTime",
                                title: "Max <maxTime>ms",
                                properties: {
                                    maxTime: 0
                                }
                            }));
                            if (!i) throw "maxTime parameter in MaxTime decorator is an obligatory parameter";
                            return o.maxTime = i, o;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                var e = new Date().getTime();
                                t.blackboard.set("startTime", e, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                var e = new Date().getTime(), i = t.blackboard.get("startTime", t.tree.id, this.id), n = this.child._execute(t);
                                return e - i > this.maxTime ? h.FAILURE : n;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                25: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.maxLoop, a = void 0 === i ? -1 : i, s = t.child, o = void 0 === s ? null : s;
                            n(this, e);
                            var l = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: o,
                                name: "RepeatUntilFailure",
                                title: "Repeat Until Failure",
                                properties: {
                                    maxLoop: -1
                                }
                            }));
                            return l.maxLoop = a, l;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("i", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                for (var e = t.blackboard.get("i", t.tree.id, this.id), i = h.ERROR; (this.maxLoop < 0 || e < this.maxLoop) && (i = this.child._execute(t)) == h.SUCCESS;) e++;
                                return e = t.blackboard.set("i", e, t.tree.id, this.id), i;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                26: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.maxLoop, a = void 0 === i ? -1 : i, s = t.child, o = void 0 === s ? null : s;
                            n(this, e);
                            var l = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: o,
                                name: "RepeatUntilSuccess",
                                title: "Repeat Until Success",
                                properties: {
                                    maxLoop: -1
                                }
                            }));
                            return l.maxLoop = a, l;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("i", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                for (var e = t.blackboard.get("i", t.tree.id, this.id), i = h.ERROR; (this.maxLoop < 0 || e < this.maxLoop) && (i = this.child._execute(t)) == h.FAILURE;) e++;
                                return e = t.blackboard.set("i", e, t.tree.id, this.id), i;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                27: [function (t, e, i) {
                    "use strict";
                    function n(t, e) {
                        if (!(t instanceof e)) throw new TypeError("Cannot call a class as a function");
                    }
                    function r(t, e) {
                        if (!t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                        return !e || "object" != typeof e && "function" != typeof e ? t : e;
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var a, s = function () {
                        function t(t, e) {
                            for (var i = 0; i < e.length; i++) {
                                var n = e[i];
                                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0),
                                    Object.defineProperty(t, n.key, n);
                            }
                        }
                        return function (e, i, n) {
                            return i && t(e.prototype, i), n && t(e, n), e;
                        };
                    }(), o = t("../core/Decorator"), l = (a = o) && a.__esModule ? a : {
                        default: a
                    }, h = t("../constants"), u = function (t) {
                        function e() {
                            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, i = t.maxLoop, a = void 0 === i ? -1 : i, s = t.child, o = void 0 === s ? null : s;
                            n(this, e);
                            var l = r(this, (e.__proto__ || Object.getPrototypeOf(e)).call(this, {
                                child: o,
                                name: "Repeater",
                                title: "Repeat <maxLoop>x",
                                properties: {
                                    maxLoop: -1
                                }
                            }));
                            return l.maxLoop = a, l;
                        }
                        return function (t, e) {
                            if ("function" != typeof e && null !== e) throw new TypeError("Super expression must either be null or a function, not " + typeof e);
                            t.prototype = Object.create(e && e.prototype, {
                                constructor: {
                                    value: t,
                                    enumerable: !1,
                                    writable: !0,
                                    configurable: !0
                                }
                            }), e && (Object.setPrototypeOf ? Object.setPrototypeOf(t, e) : t.__proto__ = e);
                        }(e, t), s(e, [{
                            key: "open",
                            value: function (t) {
                                t.blackboard.set("i", 0, t.tree.id, this.id);
                            }
                        }, {
                            key: "tick",
                            value: function (t) {
                                if (!this.child) return h.ERROR;
                                for (var e = t.blackboard.get("i", t.tree.id, this.id), i = h.SUCCESS; (this.maxLoop < 0 || e < this.maxLoop) && ((i = this.child._execute(t)) == h.SUCCESS || i == h.FAILURE);) e++;
                                return t.blackboard.set("i", e, t.tree.id, this.id), i;
                            }
                        }]), e;
                    }(l.default);
                    i.default = u;
                }, {
                    "../constants": 13,
                    "../core/Decorator": 20
                }],
                28: [function (t, e, i) {
                    "use strict";
                    function n(t) {
                        return t && t.__esModule ? t : {
                            default: t
                        };
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    });
                    var r = t("./Inverter");
                    Object.defineProperty(i, "Inverter", {
                        enumerable: !0,
                        get: function () {
                            return n(r).default;
                        }
                    });
                    var a = t("./Limiter");
                    Object.defineProperty(i, "Limiter", {
                        enumerable: !0,
                        get: function () {
                            return n(a).default;
                        }
                    });
                    var s = t("./MaxTime");
                    Object.defineProperty(i, "MaxTime", {
                        enumerable: !0,
                        get: function () {
                            return n(s).default;
                        }
                    });
                    var o = t("./RepeatUntilFailure");
                    Object.defineProperty(i, "RepeatUntilFailure", {
                        enumerable: !0,
                        get: function () {
                            return n(o).default;
                        }
                    });
                    var l = t("./RepeatUntilSuccess");
                    Object.defineProperty(i, "RepeatUntilSuccess", {
                        enumerable: !0,
                        get: function () {
                            return n(l).default;
                        }
                    });
                    var h = t("./Repeater");
                    Object.defineProperty(i, "Repeater", {
                        enumerable: !0,
                        get: function () {
                            return n(h).default;
                        }
                    });
                }, {
                    "./Inverter": 22,
                    "./Limiter": 23,
                    "./MaxTime": 24,
                    "./RepeatUntilFailure": 25,
                    "./RepeatUntilSuccess": 26,
                    "./Repeater": 27
                }],
                29: [function (t, e, i) {
                    "use strict";
                    function n(t) {
                        return t && t.__esModule ? t : {
                            default: t
                        };
                    }
                    Object.defineProperty(i, "__esModule", {
                        value: !0
                    }), i.Repeater = i.RepeatUntilSuccess = i.RepeatUntilFailure = i.MaxTime = i.Limiter = i.Inverter = i.Tick = i.Decorator = i.Condition = i.Composite = i.Blackboard = i.BehaviorTree = i.BaseNode = i.Action = i.Sequence = i.Priority = i.MemSequence = i.MemPriority = i.Wait = i.Succeeder = i.Runner = i.Failer = i.Error = i.createUUID = i.CONDITION = i.ACTION = i.DECORATOR = i.COMPOSITE = i.ERROR = i.RUNNING = i.FAILURE = i.SUCCESS = i.VERSION = void 0;
                    var r = t("./constants"), a = t("./b3.functions"), s = n(t("./actions/Error")), o = n(t("./actions/Failer")), l = n(t("./actions/Runner")), h = n(t("./actions/Succeeder")), u = n(t("./actions/Wait")), c = n(t("./composites/MemPriority")), d = n(t("./composites/MemSequence")), _ = n(t("./composites/Priority")), f = n(t("./composites/Sequence")), p = n(t("./core/Action")), m = n(t("./core/BaseNode")), g = n(t("./core/BehaviorTree")), y = n(t("./core/Blackboard")), v = n(t("./core/Composite")), S = n(t("./core/Condition")), T = n(t("./core/Decorator")), E = n(t("./core/Tick")), C = n(t("./decorators/Inverter")), x = n(t("./decorators/Limiter")), b = n(t("./decorators/MaxTime")), I = n(t("./decorators/RepeatUntilFailure")), w = n(t("./decorators/RepeatUntilSuccess")), A = n(t("./decorators/Repeater"));
                    i.VERSION = r.VERSION, i.SUCCESS = r.SUCCESS, i.FAILURE = r.FAILURE, i.RUNNING = r.RUNNING,
                        i.ERROR = r.ERROR, i.COMPOSITE = r.COMPOSITE, i.DECORATOR = r.DECORATOR, i.ACTION = r.ACTION,
                        i.CONDITION = r.CONDITION, i.createUUID = a.createUUID, i.Error = s.default, i.Failer = o.default,
                        i.Runner = l.default, i.Succeeder = h.default, i.Wait = u.default, i.MemPriority = c.default,
                        i.MemSequence = d.default, i.Priority = _.default, i.Sequence = f.default, i.Action = p.default,
                        i.BaseNode = m.default, i.BehaviorTree = g.default, i.Blackboard = y.default, i.Composite = v.default,
                        i.Condition = S.default, i.Decorator = T.default, i.Tick = E.default, i.Inverter = C.default,
                        i.Limiter = x.default, i.MaxTime = b.default, i.RepeatUntilFailure = I.default,
                        i.RepeatUntilSuccess = w.default, i.Repeater = A.default;
                }, {
                    "./actions/Error": 1,
                    "./actions/Failer": 2,
                    "./actions/Runner": 3,
                    "./actions/Succeeder": 4,
                    "./actions/Wait": 5,
                    "./b3.functions": 7,
                    "./composites/MemPriority": 8,
                    "./composites/MemSequence": 9,
                    "./composites/Priority": 10,
                    "./composites/Sequence": 11,
                    "./constants": 13,
                    "./core/Action": 14,
                    "./core/BaseNode": 15,
                    "./core/BehaviorTree": 16,
                    "./core/Blackboard": 17,
                    "./core/Composite": 18,
                    "./core/Condition": 19,
                    "./core/Decorator": 20,
                    "./core/Tick": 21,
                    "./decorators/Inverter": 22,
                    "./decorators/Limiter": 23,
                    "./decorators/MaxTime": 24,
                    "./decorators/RepeatUntilFailure": 25,
                    "./decorators/RepeatUntilSuccess": 26,
                    "./decorators/Repeater": 27
                }]
            }, {}, [29])(29);
        }();
    }).call(this, i(0));
}, function (t, e, i) {
    (function (t) {
        var e, i = this && this.__extends || function (t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
            function n() {
                this.constructor = t;
            }
            t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
        };
        !function (t) {
            !function (t) {
                "use strict";
                var e = ["00", "01", "02", "03", "04", "05", "06", "07", "08", "09", "0a", "0b", "0c", "0d", "0e", "0f", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "1a", "1b", "1c", "1d", "1e", "1f", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "2a", "2b", "2c", "2d", "2e", "2f", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "3a", "3b", "3c", "3d", "3e", "3f", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "4a", "4b", "4c", "4d", "4e", "4f", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "5a", "5b", "5c", "5d", "5e", "5f", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69", "6a", "6b", "6c", "6d", "6e", "6f", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "7a", "7b", "7c", "7d", "7e", "7f", "80", "81", "82", "83", "84", "85", "86", "87", "88", "89", "8a", "8b", "8c", "8d", "8e", "8f", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "9a", "9b", "9c", "9d", "9e", "9f", "a0", "a1", "a2", "a3", "a4", "a5", "a6", "a7", "a8", "a9", "aa", "ab", "ac", "ad", "ae", "af", "b0", "b1", "b2", "b3", "b4", "b5", "b6", "b7", "b8", "b9", "ba", "bb", "bc", "bd", "be", "bf", "c0", "c1", "c2", "c3", "c4", "c5", "c6", "c7", "c8", "c9", "ca", "cb", "cc", "cd", "ce", "cf", "d0", "d1", "d2", "d3", "d4", "d5", "d6", "d7", "d8", "d9", "da", "db", "dc", "dd", "de", "df", "e0", "e1", "e2", "e3", "e4", "e5", "e6", "e7", "e8", "e9", "ea", "eb", "ec", "ed", "ee", "ef", "f0", "f1", "f2", "f3", "f4", "f5", "f6", "f7", "f8", "f9", "fa", "fb", "fc", "fd", "fe", "ff"], i = function () {
                    function t() { }
                    /**
             * Fast UUID generator, RFC4122 version 4 compliant
             * format xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
             *
             * @author Jeff Ward (jcward.com).
             * @license MIT license
             * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
             **/                    return t.randomUUID = function () {
                        var t = 4294967295 * Math.random() | 0, i = 4294967295 * Math.random() | 0, n = 4294967295 * Math.random() | 0, r = 4294967295 * Math.random() | 0;
                        return e[255 & t] + e[t >> 8 & 255] + e[t >> 16 & 255] + e[t >> 24 & 255] + "-" + e[255 & i] + e[i >> 8 & 255] + "-" + e[i >> 16 & 15 | 64] + e[i >> 24 & 255] + "-" + e[63 & n | 128] + e[n >> 8 & 255] + "-" + e[n >> 16 & 255] + e[n >> 24 & 255] + e[255 & r] + e[r >> 8 & 255] + e[r >> 16 & 255] + e[r >> 24 & 255];
                    }, t;
                }();
                t.UUID = i;
            }(t.utils || (t.utils = {}));
        }(e || (e = {})), function (t) {
            t.utils || (t.utils = {});
        }(e || (e = {})), function (t) {
            !function (t) {
                "use strict";
                var e = function (t) {
                    function e(e) {
                        void 0 === e && (e = 64), t.call(this), this.size_ = 0, this.length = e;
                    }
                    return i(e, t), e.prototype.removeAt = function (t) {
                        var e = this[t];
                        return this[t] = this[--this.size_], this[this.size_] = null, e;
                    }, e.prototype.remove = function (t) {
                        var e, i = this.size_;
                        for (e = 0; e < i; e++) if (t == this[e]) return this[e] = this[--this.size_], this[this.size_] = null,
                            !0;
                        return !1;
                    }, e.prototype.removeLast = function () {
                        if (this.size_ > 0) {
                            var t = this[--this.size_];
                            return this[this.size_] = null, t;
                        }
                        return null;
                    }, e.prototype.contains = function (t) {
                        var e, i;
                        for (e = 0, i = this.size_; i > e; e++) if (t === this[e]) return !0;
                        return !1;
                    }, e.prototype.removeAll = function (t) {
                        var e, i, n, r, a = !1;
                        for (e = 0, n = t.size(); e < n; e++) for (r = t.get(e), i = 0; i < this.size_; i++) if (r === this[i]) {
                            this.removeAt(i), i--, a = !0;
                            break;
                        }
                        return a;
                    }, e.prototype.get = function (t) {
                        if (t >= this.length) throw new Error("ArrayIndexOutOfBoundsException");
                        return this[t];
                    }, e.prototype.safeGet = function (t) {
                        return t >= this.length && this.grow(7 * t / 4 + 1), this[t];
                    }, e.prototype.size = function () {
                        return this.size_;
                    }, e.prototype.getCapacity = function () {
                        return this.length;
                    }, e.prototype.isIndexWithinBounds = function (t) {
                        return t < this.getCapacity();
                    }, e.prototype.isEmpty = function () {
                        return 0 == this.size_;
                    }, e.prototype.add = function (t) {
                        this.size_ === this.length && this.grow(), this[this.size_++] = t;
                    }, e.prototype.set = function (t, e) {
                        t >= this.length && this.grow(2 * t), this.size_ = t + 1, this[t] = e;
                    }, e.prototype.grow = function (t) {
                        void 0 === t && (t = 1 + ~~(3 * this.length / 2)), this.length = ~~t;
                    }, e.prototype.ensureCapacity = function (t) {
                        t >= this.length && this.grow(2 * t);
                    }, e.prototype.clear = function () {
                        var t, e;
                        for (t = 0, e = this.size_; t < e; t++) this[t] = null;
                        this.size_ = 0;
                    }, e.prototype.addAll = function (t) {
                        var e;
                        for (e = 0; t.size() > e; e++) this.add(t.get(e));
                    }, e;
                }(Array);
                t.Bag = e;
            }(t.utils || (t.utils = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var i = t.utils.Bag, n = function () {
                    function t(t, e) {
                        void 0 === e && (e = 16), this._listeners = new i(), this._context = t, this._alloc = e,
                            this.active = !1;
                    }
                    return t.prototype.dispatch = function () {
                        for (var t = [], e = 0; e < arguments.length; e++) t[e - 0] = arguments[e];
                        var i = this._listeners, n = i.size();
                        if (!(n <= 0)) for (var r = this._context, a = 0; a < n; a++) i[a].apply(r, t);
                    }, t.prototype.add = function (t) {
                        this._listeners.add(t), this.active = !0;
                    }, t.prototype.remove = function (t) {
                        var e = this._listeners;
                        e.remove(t), this.active = e.size() > 0;
                    }, t.prototype.clear = function () {
                        this._listeners.clear(), this.active = !1;
                    }, t;
                }();
                e.Signal = n;
            }(t.utils || (t.utils = {}));
        }(e || (e = {})), function (t) {
            !function (t) {
                "use strict";
                var e = function () {
                    function t() {
                        t.isHighRes = !!performance, this.reset();
                    }
                    return Object.defineProperty(t.prototype, "isRunning", {
                        get: function () {
                            return this._isRunning;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "startTimeStamp", {
                        get: function () {
                            return this._startTimeStamp;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "elapsed", {
                        get: function () {
                            return this._elapsed;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), t.prototype.start = function () {
                        this._isRunning || (this._startTimeStamp = t.getTimeStamp(), this._isRunning = !0);
                    }, t.prototype.stop = function () {
                        this._isRunning && (this._elapsed += t.getTimeStamp() - this._startTimeStamp, this._isRunning = !1);
                    }, t.prototype.reset = function () {
                        this._elapsed = 0, this._startTimeStamp = 0, this._isRunning = !1;
                    }, t.getTimeStamp = function () {
                        return t.isHighRes ? performance.now() : Date.now();
                    }, t.isHighRes = !1, t;
                }();
                t.Stopwatch = e;
            }(t.utils || (t.utils = {}));
        }(e || (e = {})), function (t) {
            "use strict";
            var e = function () {
                function t(t) {
                    this.message = t;
                }
                return t.prototype.toString = function () {
                    return this.message;
                }, t;
            }();
            t.Exception = e;
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (e) {
                    function n(i, n) {
                        e.call(this, i + "\nEntity already has a component at index (" + n + ") " + t.Pool.componentsEnum[n]);
                    }
                    return i(n, e), n;
                }(t.Exception);
                e.EntityAlreadyHasComponentException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (e) {
                    function n(i, n) {
                        e.call(this, i + "\nEntity does not have a component at index (" + n + ") " + t.Pool.componentsEnum[n]);
                    }
                    return i(n, e), n;
                }(t.Exception);
                e.EntityDoesNotHaveComponentException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e() {
                        t.call(this, "Entity is already released!");
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.EntityIsAlreadyReleasedException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e) {
                        t.call(this, e + "\nEntity is not destroyed yet!");
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.EntityIsNotDestroyedException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e) {
                        t.call(this, e + "\nEntity is not enabled");
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.EntityIsNotEnabledException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e) {
                        t.call(this, e);
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.GroupObserverException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e) {
                        t.call(this, "matcher.indices.length must be 1 but was " + e.indices.length);
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.MatcherException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e, i) {
                        t.call(this, i + "\nPool does not contain entity " + e);
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.PoolDoesNotContainEntityException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                "use strict";
                var n = function (t) {
                    function e(e) {
                        t.call(this, "Multiple entities exist matching " + e);
                    }
                    return i(e, t), e;
                }(t.Exception);
                e.SingleEntityException = n;
            }(t.exceptions || (t.exceptions = {}));
        }(e || (e = {})), function (t) {
            "use strict";
            var e = function (t, e) {
                this.trigger = t, this.eventType = e;
            };
            t.TriggerOnEvent = e;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.exceptions.MatcherException, i = t.TriggerOnEvent;
            !function (t) {
                t[t.OnEntityAdded = 0] = "OnEntityAdded", t[t.OnEntityRemoved = 1] = "OnEntityRemoved",
                    t[t.OnEntityAddedOrRemoved = 2] = "OnEntityAddedOrRemoved";
            }(t.GroupEventType || (t.GroupEventType = {}));
            var n = t.GroupEventType, r = function () {
                function t() {
                    this._id = t.uniqueId++;
                }
                return Object.defineProperty(t.prototype, "id", {
                    get: function () {
                        return this._id;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "indices", {
                    get: function () {
                        return this._indices || (this._indices = this.mergeIndices()), this._indices;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "allOfIndices", {
                    get: function () {
                        return this._allOfIndices;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "anyOfIndices", {
                    get: function () {
                        return this._anyOfIndices;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "noneOfIndices", {
                    get: function () {
                        return this._noneOfIndices;
                    },
                    enumerable: !0,
                    configurable: !0
                }), t.prototype.anyOf = function () {
                    for (var e = [], i = 0; i < arguments.length; i++) e[i - 0] = arguments[i];
                    return "number" == typeof e[0] || "string" == typeof e[0] ? (this._anyOfIndices = t.distinctIndices(e),
                        this._indices = null, this) : this.anyOf.apply(this, t.mergeIndices(e));
                }, t.prototype.noneOf = function () {
                    for (var e = [], i = 0; i < arguments.length; i++) e[i - 0] = arguments[i];
                    return "number" == typeof e[0] || "string" == typeof e[0] ? (this._noneOfIndices = t.distinctIndices(e),
                        this._indices = null, this) : this.noneOf.apply(this, t.mergeIndices(e));
                }, t.prototype.matches = function (t) {
                    var e = null == this._allOfIndices || t.hasComponents(this._allOfIndices), i = null == this._anyOfIndices || t.hasAnyComponent(this._anyOfIndices), n = null == this._noneOfIndices || !t.hasAnyComponent(this._noneOfIndices);
                    return e && i && n;
                }, t.prototype.mergeIndices = function () {
                    var e = [];
                    return null != this._allOfIndices && (e = e.concat(this._allOfIndices)), null != this._anyOfIndices && (e = e.concat(this._anyOfIndices)),
                        null != this._noneOfIndices && (e = e.concat(this._noneOfIndices)), t.distinctIndices(e);
                }, t.prototype.toString = function () {
                    if (null == this._toStringCache) {
                        var e = [];
                        null != this._allOfIndices && t.appendIndices(e, "AllOf", this._allOfIndices), null != this._anyOfIndices && (null != this._allOfIndices && (e[e.length] = "."),
                            t.appendIndices(e, "AnyOf", this._anyOfIndices)), null != this._noneOfIndices && t.appendIndices(e, ".NoneOf", this._noneOfIndices),
                            this._toStringCache = e.join("");
                    }
                    return this._toStringCache;
                }, t.distinctIndices = function (t) {
                    for (var e = {}, i = 0, n = t.length; i < n; i++) {
                        e["" + t[i]] = i;
                    }
                    return [].concat(Object.keys(e));
                }, t.mergeIndices = function (t) {
                    for (var i = [], n = 0, r = t.length; n < r; n++) {
                        var a = t[n];
                        if (1 !== a.indices.length) throw new e(a);
                        i[n] = a.indices[0];
                    }
                    return i;
                }, t.allOf = function () {
                    for (var e = [], i = 0; i < arguments.length; i++) e[i - 0] = arguments[i];
                    if ("number" == typeof e[0] || "string" == typeof e[0]) {
                        var n = new t();
                        n._allOfIndices = t.distinctIndices(e);
                        return n;
                    }
                    return t.allOf.apply(this, t.mergeIndices(e));
                }, t.anyOf = function () {
                    for (var e = [], i = 0; i < arguments.length; i++) e[i - 0] = arguments[i];
                    if ("number" == typeof e[0] || "string" == typeof e[0]) {
                        var n = new t();
                        n._anyOfIndices = t.distinctIndices(e);
                        return n;
                    }
                    return t.anyOf.apply(this, t.mergeIndices(e));
                }, t.appendIndices = function (t, e, i) {
                    var n = t.length;
                    t[n++] = e, t[n++] = "(";
                    for (var r = i.length - 1, a = 0, s = i.length; a < s; a++) t[n++] = "" + i[a],
                        a < r && (t[n++] = ", ");
                    t[n++] = ")";
                }, t.prototype.onEntityAdded = function () {
                    return new i(this, n.OnEntityAdded);
                }, t.prototype.onEntityRemoved = function () {
                    return new i(this, n.OnEntityRemoved);
                }, t.prototype.onEntityAddedOrRemoved = function () {
                    return new i(this, n.OnEntityAddedOrRemoved);
                }, t.uniqueId = 0, t;
            }();
            t.Matcher = r;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.utils.Signal, i = t.exceptions.EntityIsNotEnabledException, n = t.exceptions.EntityIsAlreadyReleasedException, r = t.exceptions.EntityAlreadyHasComponentException, a = t.exceptions.EntityDoesNotHaveComponentException, s = function () {
                function s(i, n) {
                    void 0 === n && (n = 16), this.onEntityReleased = null, this.onComponentAdded = null,
                        this.onComponentRemoved = null, this.onComponentReplaced = null, this.name = "",
                        this.id = "", this.instanceIndex = 0, this._creationIndex = 0, this._isEnabled = !0,
                        this._components = null, this._componentsCache = null, this._componentIndicesCache = null,
                        this._toStringCache = "", this._refCount = 0, this._pool = null, this._componentsEnum = null,
                        this.onEntityReleased = new e(this), this.onComponentAdded = new e(this), this.onComponentRemoved = new e(this),
                        this.onComponentReplaced = new e(this), this._componentsEnum = i, this._pool = t.Pool.instance,
                        this._components = this.initialize(n);
                }
                return Object.defineProperty(s.prototype, "creationIndex", {
                    get: function () {
                        return this._creationIndex;
                    },
                    enumerable: !0,
                    configurable: !0
                }), s.initialize = function (t, e) {
                    s.size = e.entities || 100;
                }, s.dim = function (t, e) {
                    s.alloc = new Array(e);
                    for (var i = 0; i < e; i++) {
                        s.alloc[i] = new Array(t);
                        for (var n = 0; n < t; n++) s.alloc[i][n] = null;
                    }
                }, s.prototype.initialize = function (t) {
                    var e, i = s.size;
                    null == s.alloc && s.dim(t, i);
                    var n = s.alloc;
                    if (this.instanceIndex = s.instanceIndex++, e = n[this.instanceIndex]) return e;
                    console.log("Insufficient memory allocation at ", this.instanceIndex, ". Allocating ", i, " entities.");
                    for (var r = this.instanceIndex, a = r + i; r < a; r++) {
                        n[r] = new Array(t);
                        for (var o = 0; o < t; o++) n[r][o] = null;
                    }
                    return e = n[this.instanceIndex];
                }, s.prototype.addComponent = function (t, e) {
                    if (!this._isEnabled) throw new i("Cannot add component!");
                    if (this.hasComponent(t)) throw new r("Cannot add component at index " + t + " to " + this, t);
                    this._components[t] = e, this._componentsCache = null, this._componentIndicesCache = null,
                        this._toStringCache = null;
                    var n = this.onComponentAdded;
                    return n.active && n.dispatch(this, t, e), this;
                }, s.prototype.removeComponent = function (t) {
                    if (!this._isEnabled) throw new i("Cannot remove component!");
                    if (!this.hasComponent(t)) throw new a("Cannot remove component at index " + t + " from " + this, t);
                    return this._replaceComponent(t, null), this;
                }, s.prototype.replaceComponent = function (t, e) {
                    if (!this._isEnabled) throw new i("Cannot replace component!");
                    return this.hasComponent(t) ? this._replaceComponent(t, e) : null != e && this.addComponent(t, e),
                        this;
                }, s.prototype._replaceComponent = function (t, e) {
                    var i = this._components, n = i[t];
                    if (n === e) (a = this.onComponentReplaced).active && a.dispatch(this, t, n, e); else if (i[t] = e,
                        this._componentsCache = null, null == e) {
                        i[t] = null, this._componentIndicesCache = null, this._toStringCache = null;
                        var r = this.onComponentRemoved;
                        r.active && r.dispatch(this, t, n);
                    } else {
                        var a;
                        (a = this.onComponentReplaced).active && a.dispatch(this, t, n, e);
                    }
                }, s.prototype.getComponent = function (t) {
                    if (!this.hasComponent(t)) throw new a("Cannot get component at index " + t + " from " + this, t);
                    return this._components[t];
                }, s.prototype.getComponents = function () {
                    if (null == this._componentsCache) {
                        for (var t = [], e = this._components, i = 0, n = 0, r = e.length; i < r; i++) {
                            var a = e[i];
                            null != a && (t[n++] = a);
                        }
                        this._componentsCache = t;
                    }
                    return this._componentsCache;
                }, s.prototype.getComponentIndices = function () {
                    if (null == this._componentIndicesCache) {
                        for (var t = [], e = this._components, i = 0, n = 0, r = e.length; i < r; i++) null != e[i] && (t[n++] = i);
                        this._componentIndicesCache = t;
                    }
                    return this._componentIndicesCache;
                }, s.prototype.hasComponent = function (t) {
                    return null != this._components[t];
                }, s.prototype.hasComponents = function (t) {
                    for (var e = this._components, i = 0, n = t.length; i < n; i++) if (null == e[t[i]]) return !1;
                    return !0;
                }, s.prototype.hasAnyComponent = function (t) {
                    for (var e = this._components, i = 0, n = t.length; i < n; i++) if (null != e[t[i]]) return !0;
                    return !1;
                }, s.prototype.removeAllComponents = function () {
                    this._toStringCache = null;
                    for (var t = this._components, e = 0, i = t.length; e < i; e++) null != t[e] && this._replaceComponent(e, null);
                }, s.prototype.destroy = function () {
                    this.removeAllComponents(), this.onComponentAdded.clear(), this.onComponentReplaced.clear(),
                        this.onComponentRemoved.clear(), this._isEnabled = !1;
                }, s.prototype.toString = function () {
                    if (null == this._toStringCache) {
                        for (var t = [], e = this.getComponents(), i = e.length - 1, n = 0, r = 0, a = e.length; n < a; n++) t[r++] = e[n].constructor.name.replace("Component", "") || n + "",
                            n < i && (t[r++] = ", ");
                        this._toStringCache = t.join("");
                    }
                    return this._toStringCache;
                }, s.prototype.addRef = function () {
                    return this._refCount += 1, this;
                }, s.prototype.release = function () {
                    if (this._refCount -= 1, 0 === this._refCount) {
                        var t = this.onEntityReleased;
                        t.active && t.dispatch(this);
                    } else if (this._refCount < 0) throw new n();
                }, s.instanceIndex = 0, s.alloc = null, s.size = 0, s;
            }();
            t.Entity = s;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.utils.Signal, i = t.GroupEventType, n = t.exceptions.SingleEntityException, r = function () {
                function r(t) {
                    this.onEntityAdded = null, this.onEntityRemoved = null, this.onEntityUpdated = null,
                        this._entities = {}, this._matcher = null, this._entitiesCache = null, this._singleEntityCache = null,
                        this._toStringCache = "", this._entities = {}, this.onEntityAdded = new e(this),
                        this.onEntityRemoved = new e(this), this.onEntityUpdated = new e(this), this._matcher = t;
                }
                return Object.defineProperty(r.prototype, "count", {
                    get: function () {
                        return Object.keys(this._entities).length;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(r.prototype, "matcher", {
                    get: function () {
                        return this._matcher;
                    },
                    enumerable: !0,
                    configurable: !0
                }), r.prototype.createObserver = function (e) {
                    return void 0 === e && (e = i.OnEntityAdded), new t.GroupObserver(this, e);
                }, r.prototype.handleEntitySilently = function (t) {
                    this._matcher.matches(t) ? this.addEntitySilently(t) : this.removeEntitySilently(t);
                }, r.prototype.handleEntity = function (t, e, i) {
                    this._matcher.matches(t) ? this.addEntity(t, e, i) : this.removeEntity(t, e, i);
                }, r.prototype.updateEntity = function (t, e, i, n) {
                    if (t.id in this._entities) {
                        var r = this.onEntityRemoved;
                        r.active && r.dispatch(this, t, e, i);
                        var a = this.onEntityAdded;
                        a.active && a.dispatch(this, t, e, n);
                        var s = this.onEntityUpdated;
                        s.active && s.dispatch(this, t, e, i, n);
                    }
                }, r.prototype.addEntitySilently = function (t) {
                    t.id in this._entities || (this._entities[t.id] = t, this._entitiesCache = null,
                        this._singleEntityCache = null, t.addRef());
                }, r.prototype.addEntity = function (t, e, i) {
                    if (!(t.id in this._entities)) {
                        this._entities[t.id] = t, this._entitiesCache = null, this._singleEntityCache = null,
                            t.addRef();
                        var n = this.onEntityAdded;
                        n.active && n.dispatch(this, t, e, i);
                    }
                }, r.prototype.removeEntitySilently = function (t) {
                    t.id in this._entities && (delete this._entities[t.id], this._entitiesCache = null,
                        this._singleEntityCache = null, t.release());
                }, r.prototype.removeEntity = function (t, e, i) {
                    if (t.id in this._entities) {
                        delete this._entities[t.id], this._entitiesCache = null, this._singleEntityCache = null;
                        var n = this.onEntityRemoved;
                        n.active && n.dispatch(this, t, e, i), t.release();
                    }
                }, r.prototype.containsEntity = function (t) {
                    return t.id in this._entities;
                }, r.prototype.getEntities = function () {
                    if (null == this._entitiesCache) for (var t = this._entities, e = Object.keys(t), i = e.length, n = this._entitiesCache = new Array(i), r = 0; r < i; r++) n[r] = t[e[r]];
                    return this._entitiesCache;
                }, r.prototype.getSingleEntity = function () {
                    if (null == this._singleEntityCache) {
                        var t = Object.keys(this._entities), e = t.length;
                        if (1 !== e) {
                            if (0 === e) return null;
                            throw new n(this._matcher);
                        }
                        this._singleEntityCache = this._entities[t[0]];
                    }
                    return this._singleEntityCache;
                }, r.prototype.toString = function () {
                    return null == this._toStringCache && (this._toStringCache = "Group(" + this._matcher + ")"),
                        this._toStringCache;
                }, r;
            }();
            t.Group = r;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.GroupEventType, i = t.exceptions.GroupObserverException, n = function () {
                function t(t, e) {
                    var n = this;
                    if (this._collectedEntities = {}, this._groups = null, this._eventTypes = null,
                        this._addEntityCache = null, this.addEntity = function (t, e, i, r) {
                            e.id in n._collectedEntities || (n._collectedEntities[e.id] = e, e.addRef());
                        }, this._groups = Array.isArray(t) ? t : [t], this._eventTypes = Array.isArray(e) ? e : [e],
                        t.length !== e.length) throw new i("Unbalanced count with groups (" + t.length + ") and event types (" + e.length + ")");
                    this._collectedEntities = {}, this._addEntityCache = this.addEntity, this.activate();
                }
                return Object.defineProperty(t.prototype, "collectedEntities", {
                    get: function () {
                        return this._collectedEntities;
                    },
                    enumerable: !0,
                    configurable: !0
                }), t.prototype.activate = function () {
                    for (var t = 0, i = this._groups.length; t < i; t++) {
                        var n = this._groups[t], r = this._eventTypes[t];
                        if (r === e.OnEntityAdded) n.onEntityAdded.remove(this._addEntityCache), n.onEntityAdded.add(this._addEntityCache); else if (r === e.OnEntityRemoved) n.onEntityRemoved.remove(this._addEntityCache),
                            n.onEntityRemoved.add(this._addEntityCache); else {
                            if (r !== e.OnEntityAddedOrRemoved) throw "Invalid eventType [" + typeof r + ":" + r + "] in GroupObserver::activate";
                            n.onEntityAdded.remove(this._addEntityCache), n.onEntityAdded.add(this._addEntityCache),
                                n.onEntityRemoved.remove(this._addEntityCache), n.onEntityRemoved.add(this._addEntityCache);
                        }
                    }
                }, t.prototype.deactivate = function () {
                    for (var t = 0, e = this._groups.length; t < e; t++) {
                        var i = this._groups[t];
                        i.onEntityAdded.remove(this._addEntityCache), i.onEntityRemoved.remove(this._addEntityCache),
                            this.clearCollectedEntities();
                    }
                }, t.prototype.clearCollectedEntities = function () {
                    for (var t in this._collectedEntities) this._collectedEntities[t].release();
                    this._collectedEntities = {};
                }, t;
            }();
            t.GroupObserver = n;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.utils.UUID, i = t.utils.Bag, n = t.Group, r = t.Entity, a = t.utils.Signal, s = t.exceptions.EntityIsNotDestroyedException, o = t.exceptions.PoolDoesNotContainEntityException;
            function l(t, e) {
                return e in t ? t : null;
            }
            var h = function () {
                function h(t, e, n, r) {
                    var o = this;
                    void 0 === n && (n = !1), void 0 === r && (r = 0), this.onEntityCreated = null,
                        this.onEntityWillBeDestroyed = null, this.onEntityDestroyed = null, this.onGroupCreated = null,
                        this.name = "", this._debug = !1, this._entities = {}, this._groups = {}, this._groupsForIndex = null,
                        this._reusableEntities = new i(), this._retainedEntities = {}, this._componentsEnum = null,
                        this._totalComponents = 0, this._creationIndex = 0, this._entitiesCache = null,
                        this.updateGroupsComponentAddedOrRemoved = function (t, e, i) {
                            var n = o._groupsForIndex[e];
                            if (null != n) for (var r = 0, a = n.size(); r < a; r++) n[r].handleEntity(t, e, i);
                        }, this.updateGroupsComponentReplaced = function (t, e, i, n) {
                            var r = o._groupsForIndex[e];
                            if (null != r) for (var a = 0, s = r.size(); a < s; a++) r[a].updateEntity(t, e, i, n);
                        }, this.onEntityReleased = function (t) {
                            if (t._isEnabled) throw new s("Cannot release entity.");
                            t.onEntityReleased.remove(o._cachedOnEntityReleased), delete o._retainedEntities[t.id],
                                o._reusableEntities.add(t);
                        }, h.instance = this, this.onGroupCreated = new a(this), this.onEntityCreated = new a(this),
                        this.onEntityDestroyed = new a(this), this.onEntityWillBeDestroyed = new a(this),
                        this._debug = n, this._componentsEnum = t, this._totalComponents = e, this._creationIndex = r,
                        this._groupsForIndex = new i(), this._cachedUpdateGroupsComponentAddedOrRemoved = this.updateGroupsComponentAddedOrRemoved,
                        this._cachedUpdateGroupsComponentReplaced = this.updateGroupsComponentReplaced,
                        this._cachedOnEntityReleased = this.onEntityReleased, h.componentsEnum = t, h.totalComponents = e;
                }
                return Object.defineProperty(h.prototype, "totalComponents", {
                    get: function () {
                        return this._totalComponents;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(h.prototype, "count", {
                    get: function () {
                        return Object.keys(this._entities).length;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(h.prototype, "reusableEntitiesCount", {
                    get: function () {
                        return this._reusableEntities.size();
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(h.prototype, "retainedEntitiesCount", {
                    get: function () {
                        return Object.keys(this._retainedEntities).length;
                    },
                    enumerable: !0,
                    configurable: !0
                }), h.setPool = function (t, e) {
                    var i = l(t, "setPool");
                    null != i && i.setPool(e);
                }, h.prototype.createEntity = function (t) {
                    var i = this._reusableEntities.size() > 0 ? this._reusableEntities.removeLast() : new r(this._componentsEnum, this._totalComponents);
                    i._isEnabled = !0, i.name = t, i._creationIndex = this._creationIndex++, i.id = e.randomUUID(),
                        i.addRef(), this._entities[i.id] = i, this._entitiesCache = null, i.onComponentAdded.add(this._cachedUpdateGroupsComponentAddedOrRemoved),
                        i.onComponentRemoved.add(this._cachedUpdateGroupsComponentAddedOrRemoved), i.onComponentReplaced.add(this._cachedUpdateGroupsComponentReplaced),
                        i.onEntityReleased.add(this._cachedOnEntityReleased);
                    var n = this.onEntityCreated;
                    return n.active && n.dispatch(this, i), i;
                }, h.prototype.destroyEntity = function (t) {
                    if (!(t.id in this._entities)) throw new o(t, "Could not destroy entity!");
                    delete this._entities[t.id], this._entitiesCache = null;
                    var e = this.onEntityWillBeDestroyed;
                    e.active && e.dispatch(this, t), t.destroy();
                    var i = this.onEntityDestroyed;
                    i.active && i.dispatch(this, t), 1 === t._refCount ? (t.onEntityReleased.remove(this._cachedOnEntityReleased),
                        this._reusableEntities.add(t)) : this._retainedEntities[t.id] = t, t.release();
                }, h.prototype.destroyAllEntities = function () {
                    for (var t = this.getEntities(), e = 0, i = t.length; e < i; e++) this.destroyEntity(t[e]);
                }, h.prototype.hasEntity = function (t) {
                    return t.id in this._entities;
                }, h.prototype.getEntities = function (t) {
                    if (t) return this.getGroup(t).getEntities();
                    if (null == this._entitiesCache) for (var e = this._entities, i = Object.keys(e), n = i.length, r = this._entitiesCache = new Array(n), a = 0; a < n; a++) r[a] = e[i[a]];
                    return this._entitiesCache;
                }, h.prototype.createSystem = function (e) {
                    "function" == typeof e && (e = new e());
                    h.setPool(e, this);
                    var i = l(e, "trigger");
                    if (null != i) return new t.ReactiveSystem(this, i);
                    var n = l(e, "triggers");
                    return null != n ? new t.ReactiveSystem(this, n) : e;
                }, h.prototype.getGroup = function (t) {
                    var e;
                    if (t.id in this._groups) e = this._groups[t.id]; else {
                        e = new n(t);
                        for (var r = this.getEntities(), a = 0, s = r.length; a < s; a++) e.handleEntitySilently(r[a]);
                        this._groups[t.id] = e;
                        a = 0;
                        for (var o = t.indices.length; a < o; a++) {
                            var l = t.indices[a];
                            null == this._groupsForIndex[l] && (this._groupsForIndex[l] = new i()), this._groupsForIndex[l].add(e);
                        }
                        var h = this.onGroupCreated;
                        h.active && h.dispatch(this, e);
                    }
                    return e;
                }, h.componentsEnum = null, h.totalComponents = 0, h.instance = null, h;
            }();
            t.Pool = h;
        }(e || (e = {})), function (t) {
            "use strict";
            var e = t.GroupObserver;
            function i(t, e) {
                return e in t ? t : null;
            }
            var n = function () {
                function t(t, n) {
                    var r = "triggers" in n ? n.triggers : [n.trigger];
                    this._subsystem = n;
                    var a = i(n, "ensureComponents");
                    null != a && (this._ensureComponents = a.ensureComponents);
                    var s = i(n, "excludeComponents");
                    null != s && (this._excludeComponents = s.excludeComponents), this._clearAfterExecute = null != i(n, "clearAfterExecute");
                    for (var o = r.length, l = new Array(o), h = new Array(o), u = 0; u < o; u++) {
                        var c = r[u];
                        l[u] = t.getGroup(c.trigger), h[u] = c.eventType;
                    }
                    this._observer = new e(l, h), this._buffer = [];
                }
                return Object.defineProperty(t.prototype, "subsystem", {
                    get: function () {
                        return this._subsystem;
                    },
                    enumerable: !0,
                    configurable: !0
                }), t.prototype.activate = function () {
                    this._observer.activate();
                }, t.prototype.deactivate = function () {
                    this._observer.deactivate();
                }, t.prototype.clear = function () {
                    this._observer.clearCollectedEntities();
                }, t.prototype.initialize = function () {
                    this.execute();
                }, t.prototype.execute = function () {
                    var t = this._observer.collectedEntities, e = this._ensureComponents, i = this._excludeComponents, n = this._buffer, r = n.length;
                    if (0 != Object.keys(t).length) {
                        if (e) if (i) for (var a in t) {
                            var s = t[a];
                            e.matches(s) && !i.matches(s) && (n[r++] = s.addRef());
                        } else for (var a in t) {
                            s = t[a];
                            e.matches(s) && (n[r++] = s.addRef());
                        } else if (i) for (var a in t) {
                            s = t[a];
                            i.matches(s) || (n[r++] = s.addRef());
                        } else for (var a in t) {
                            s = t[a];
                            n[r++] = s.addRef();
                        }
                        if (this._observer.clearCollectedEntities(), 0 != n.length) {
                            this._subsystem.execute(n);
                            for (var o = 0, l = n.length; o < l; o++) n[o].release();
                            n.length = 0, this._clearAfterExecute && this._observer.clearCollectedEntities();
                        }
                    }
                }, t;
            }();
            t.ReactiveSystem = n;
        }(e || (e = {})), function (t) {
            "use strict";
            function e(t, e) {
                return e in t ? t : null;
            }
            var i = function () {
                function t() {
                    this._initializeSystems = [], this._executeSystems = [], this._cleanupSystems = [];
                }
                return t.prototype.add = function (t) {
                    "function" == typeof t && (t = new t());
                    var i = e(t, "subsystem"), n = e(t, "initialize");
                    if (null != n) {
                        var r = this._initializeSystems;
                        r[r.length] = n;
                    }
                    var a = e(t, "execute");
                    if (null != a) {
                        var s = this._executeSystems;
                        s[s.length] = a;
                    }
                    var o = e(null != i ? i.subsystem : t, "cleanup");
                    if (null != o) {
                        var l = this._cleanupSystems;
                        l[l.length] = o;
                    }
                    return this;
                }, t.prototype.initialize = function () {
                    for (var t = 0, e = this._initializeSystems.length; t < e; t++) this._initializeSystems[t].initialize();
                }, t.prototype.execute = function () {
                    for (var t = this._executeSystems, e = 0, i = t.length; e < i; e++) t[e].execute();
                }, t.prototype.cleanup = function () {
                    for (var t = this._cleanupSystems, e = 0, i = t.length; e < i; e++) t[e].cleanup();
                }, t.prototype.clearReactiveSystems = function () {
                    for (var t = 0, i = this._executeSystems.length; t < i; t++) {
                        var n = e(this._executeSystems[t], "subsystem");
                        null != n && n.clear();
                        var r = e(this._executeSystems[t], "clearReactiveSystems");
                        null != r && r.clearReactiveSystems();
                    }
                }, t;
            }();
            t.Systems = i;
        }(e || (e = {})), function (t) {
            !function (t) {
                var e = function () {
                    function t(t) {
                        var e = this;
                        this.obj = t, this.obj.name ? this._name = this.obj.name : this._name = "Entity_" + this.obj._creationIndex,
                            Object.defineProperty(this, this._name, {
                                get: function () {
                                    return e.obj.toString();
                                }
                            });
                    }
                    return Object.defineProperty(t.prototype, "name", {
                        get: function () {
                            return this._name;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), t;
                }();
                t.EntityBehavior = e;
            }(t.viewer || (t.viewer = {}));
        }(e || (e = {})), function (t) {
            !function (t) {
                var e = function () {
                    function t(t) {
                        this._pool = t, this._groups = this._pool._groups;
                    }
                    return Object.defineProperty(t.prototype, "name", {
                        get: function () {
                            return "Pool";
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "Pool", {
                        get: function () {
                            return "Pool  (" + this._pool.count + " entities, " + this._pool.reusableEntitiesCount + " reusable, " + Object.keys(this._groups).length + " groups)";
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "entities", {
                        get: function () {
                            return this._pool.count;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "reusable", {
                        get: function () {
                            return this._pool.reusableEntitiesCount;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), t;
                }();
                t.PoolObserver = e;
            }(t.viewer || (t.viewer = {}));
        }(e || (e = {})), function (t) {
            !function (t) {
                var e = function () {
                    function t(t) {
                        this._systems = t;
                    }
                    return Object.defineProperty(t.prototype, "name", {
                        get: function () {
                            return "Systems";
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "Systems", {
                        get: function () {
                            return "Systems  (" + this._systems._initializeSystems.length + " init, " + this._systems._executeSystems.length + " exe ";
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "initialize", {
                        get: function () {
                            return this._systems._initializeSystems.length;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), Object.defineProperty(t.prototype, "execute", {
                        get: function () {
                            return this._systems._executeSystems.length;
                        },
                        enumerable: !0,
                        configurable: !0
                    }), t;
                }();
                t.SystemObserver = e;
            }(t.viewer || (t.viewer = {}));
        }(e || (e = {})), function (t) {
            !function (e) {
                var i = t.Systems, n = t.viewer.EntityBehavior, r = t.viewer.SystemObserver, a = t.viewer.PoolObserver, s = function () {
                    function t() { }
                    return t.init = function (s) {
                        if ((s._debug || "?debug=true" === location.search) && window.dat) {
                            e.gui = new dat.GUI({
                                height: 159,
                                width: 300
                            });
                            var o = new a(s);
                            t._controllers = {}, t._entities = e.gui.addFolder("Entities"), t._pools = e.gui.addFolder("Pools"),
                                t._systems = e.gui.addFolder("Systems"), t._entities.open(), t._pools.open(), t._systems.open(),
                                t._pools.add(o, "entities").listen(), t._pools.add(o, "reusable").listen(), s.onEntityCreated.add(function (e, i) {
                                    var r = new n(i);
                                    t._controllers[i.id] = t._entities.add(r, r.name).listen();
                                }), s.onEntityDestroyed.add(function (e, i) {
                                    var n = t._controllers[i.id];
                                    delete t._controllers[i.id], t._entities.remove(n);
                                });
                            var l = i.prototype.initialize;
                            i.prototype.initialize = function () {
                                l.call(this);
                                var e = new r(this);
                                t._systems.add(e, "initialize").listen(), t._systems.add(e, "execute").listen();
                            }, Object.defineProperty(i.prototype, "name", {
                                get: function () {
                                    return "Systems";
                                }
                            }), Object.defineProperty(i.prototype, "Systems", {
                                get: function () {
                                    return "Systems  (" + this._initializeSystems.length + " init, " + this._executeSystems.length + " exe ";
                                }
                            });
                        }
                    }, t;
                }();
                e.VisualDebugging = s;
            }(t.viewer || (t.viewer = {}));
        }(e || (e = {})), ("undefined" != typeof window ? window : void 0 !== t ? t : "undefined" != typeof self ? self : this).entitas = e;
    }).call(this, i(0));
}, function (t, e, i) {
    (function (t) {
        window = window || t, window.layalib || (window.layalib = function (t, e) {
            (window._layalibs || (window._layalibs = [])).push({
                f: t,
                i: e
            });
        }), window.layalib(function (t, e, i) {
            i.un, i.uns;
            var n = i.static, r = i.class, a = i.getset, s = (i.__newvec, laya.utils.Browser), o = (laya.events.Event,
                laya.events.EventDispatcher), l = laya.resource.HTMLImage, h = laya.utils.Handler, u = laya.display.Input, c = laya.net.Loader, d = laya.net.LocalStorage, _ = laya.maths.Matrix, f = laya.renders.Render, p = laya.utils.RunDriver, m = laya.media.SoundChannel, g = laya.media.SoundManager, y = (laya.display.Stage,
                    laya.net.URL), v = laya.utils.Utils, S = (function () {
                        function t() { }
                        r(t, "laya.wx.mini.MiniLocation"), t.__init__ = function () {
                            x.window.navigator.geolocation.getCurrentPosition = t.getCurrentPosition, x.window.navigator.geolocation.watchPosition = t.watchPosition,
                                x.window.navigator.geolocation.clearWatch = t.clearWatch;
                        }, t.getCurrentPosition = function (t, e, i) {
                            var n;
                            (n = {}).success = function (e) {
                                null != t && t(e);
                            }, n.fail = e, x.window.wx.getLocation(n);
                        }, t.watchPosition = function (e, n, r) {
                            var a;
                            return t._curID++, (a = {}).success = e, a.error = n, t._watchDic[t._curID] = a,
                                i.systemTimer.loop(1e3, null, t._myLoop), t._curID;
                        }, t.clearWatch = function (e) {
                            delete t._watchDic[e], t._hasWatch() || i.systemTimer.clear(null, t._myLoop);
                        }, t._hasWatch = function () {
                            var e;
                            for (e in t._watchDic) if (t._watchDic[e]) return !0;
                            return !1;
                        }, t._myLoop = function () {
                            t.getCurrentPosition(t._mySuccess, t._myError);
                        }, t._mySuccess = function (e) {
                            var i, n = {};
                            for (i in n.coords = e, n.timestamp = s.now(), t._watchDic) t._watchDic[i].success && t._watchDic[i].success(n);
                        }, t._myError = function (e) {
                            var i;
                            for (i in t._watchDic) t._watchDic[i].error && t._watchDic[i].error(e);
                        }, t._watchDic = {}, t._curID = 0;
                    }(), function () {
                        function e() { }
                        return r(e, "laya.wx.mini.MiniFileMgr"), e.isLocalNativeFile = function (t) {
                            for (var e = 0, i = x.nativefiles.length; e < i; e++) if (-1 != t.indexOf(x.nativefiles[e])) return !0;
                            return !1;
                        }, e.getFileInfo = function (t) {
                            var i = t, n = e.filesListObj[i];
                            return null == n ? null : n;
                        }, e.read = function (t, i, n, r, a, s) {
                            var o;
                            void 0 === i && (i = "ascill"), void 0 === r && (r = ""), void 0 === a && (a = !1),
                                void 0 === s && (s = ""), o = "" == r || -1 == r.indexOf("http://") && -1 == r.indexOf("https://") ? t : e.getFileNativePath(t),
                                o = y.getAdptedFilePath(o), e.fs.readFile({
                                    filePath: o,
                                    encoding: i,
                                    success: function (t) {
                                        null != n && n.runWith([0, t]);
                                    },
                                    fail: function (t) {
                                        t && "" != r ? e.downFiles(r, i, n, r, a, s) : null != n && n.runWith([1]);
                                    }
                                });
                        }, e.downFiles = function (t, i, n, r, a, s, o) {
                            void 0 === i && (i = "ascii"), void 0 === r && (r = ""), void 0 === a && (a = !1),
                                void 0 === s && (s = ""), void 0 === o && (o = !0), e.wxdown({
                                    url: t,
                                    success: function (l) {
                                        200 === l.statusCode ? e.readFile(l.tempFilePath, i, n, r, a, s, o) : 403 === l.statusCode ? null != n && n.runWith([0, t]) : null != n && n.runWith([1, l]);
                                    },
                                    fail: function (t) {
                                        null != n && n.runWith([1, t]);
                                    }
                                }).onProgressUpdate(function (t) {
                                    null != n && n.runWith([2, t.progress]);
                                });
                        }, e.readFile = function (t, i, n, r, a, s, o) {
                            void 0 === i && (i = "ascill"), void 0 === r && (r = ""), void 0 === a && (a = !1),
                                void 0 === s && (s = ""), void 0 === o && (o = !0), t = y.getAdptedFilePath(t),
                                e.fs.readFile({
                                    filePath: t,
                                    encoding: i,
                                    success: function (s) {
                                        -1 != t.indexOf("http://") || -1 != t.indexOf("https://") ? (x.autoCacheFile || a) && e.copyFile(t, r, n, i, o) : null != n && n.runWith([0, s]);
                                    },
                                    fail: function (t) {
                                        t && null != n && n.runWith([1, t]);
                                    }
                                });
                        }, e.downOtherFiles = function (t, i, n, r, a) {
                            void 0 === n && (n = ""), void 0 === r && (r = !1), void 0 === a && (a = !0), e.wxdown({
                                url: t,
                                success: function (t) {
                                    200 === t.statusCode ? (x.autoCacheFile || r) && -1 == n.indexOf("qlogo.cn") && -1 == n.indexOf(".php") ? e.copyFile(t.tempFilePath, n, i, "", a) : null != i && i.runWith([0, t.tempFilePath]) : null != i && i.runWith([1, t]);
                                },
                                fail: function (t) {
                                    null != i && i.runWith([1, t]);
                                }
                            });
                        }, e.downLoadFile = function (n, r, a, s) {
                            void 0 === r && (r = ""), void 0 === s && (s = "ascii"), t.navigator.userAgent.indexOf("MiniGame") < 0 ? i.loader.load(n, a) : "image" == r || "sound" == r ? e.downOtherFiles(n, a, n, !0, !1) : e.downFiles(n, s, a, n, !0, r, !1);
                        }, e.copyFile = function (t, i, n, r, a) {
                            void 0 === r && (r = ""), void 0 === a && (a = !0);
                            var s = t.split("/"), o = s[s.length - 1], l = e.getFileInfo(i), h = e.getFileNativePath(o), u = e.getCacheUseSize();
                            l ? l.readyUrl != i ? e.fs.getFileInfo({
                                filePath: t,
                                success: function (t) {
                                    a && u + 4194304 + t.size >= 52428800 && (t.size > x.minClearSize && (x.minClearSize = t.size),
                                        e.onClearCacheRes()), e.deleteFile(o, i, n, r, t.size);
                                },
                                fail: function (t) {
                                    null != n && n.runWith([1, t]);
                                }
                            }) : null != n && n.runWith([0]) : e.fs.getFileInfo({
                                filePath: t,
                                success: function (s) {
                                    a && u + 4194304 + s.size >= 52428800 && (s.size > x.minClearSize && (x.minClearSize = s.size),
                                        e.onClearCacheRes()), e.fs.copyFile({
                                            srcPath: t,
                                            destPath: h,
                                            success: function (t) {
                                                e.onSaveFile(i, o, !0, r, n, s.size);
                                            },
                                            fail: function (t) {
                                                null != n && n.runWith([1, t]);
                                            }
                                        });
                                },
                                fail: function (t) {
                                    null != n && n.runWith([1, t]);
                                }
                            });
                        }, e.onClearCacheRes = function () {
                            var t = x.minClearSize, i = [];
                            for (var n in e.filesListObj) i.push(e.filesListObj[n]);
                            e.sortOn(i, "times", 16);
                            for (var r = 0, a = 1, s = i.length; a < s; a++) {
                                var o = i[a];
                                if (r >= t) break;
                                r += o.size, e.deleteFile("", o.readyUrl);
                            }
                        }, e.sortOn = function (t, e, i) {
                            return void 0 === i && (i = 0), 16 == i ? t.sort(function (t, i) {
                                return t[e] - i[e];
                            }) : 18 == i ? t.sort(function (t, i) {
                                return i[e] - t[e];
                            }) : t.sort(function (t, i) {
                                return t[e] - i[e];
                            });
                        }, e.getFileNativePath = function (t) {
                            return laya.wx.mini.MiniFileMgr.fileNativeDir + "/" + t + " ";
                        }, e.deleteFile = function (t, i, n, r, a) {
                            void 0 === i && (i = ""), void 0 === r && (r = ""), void 0 === a && (a = 0);
                            var s = e.getFileInfo(i), o = e.getFileNativePath(s.md5);
                            e.fs.unlink({
                                filePath: o,
                                success: function (s) {
                                    var o = "" != t;
                                    if ("" != t) {
                                        var l = e.getFileNativePath(t);
                                        e.fs.copyFile({
                                            srcPath: t,
                                            destPath: l,
                                            success: function (a) {
                                                e.onSaveFile(i, t, o, r, n, a.size);
                                            },
                                            fail: function (t) {
                                                null != n && n.runWith([1, t]);
                                            }
                                        });
                                    } else e.onSaveFile(i, t, o, r, n, a);
                                },
                                fail: function (t) { }
                            });
                        }, e.deleteAll = function () {
                            var t = [];
                            for (var i in e.filesListObj) t.push(e.filesListObj[i]);
                            for (var n = 1, r = t.length; n < r; n++) {
                                var a = t[n];
                                e.deleteFile("", a.readyUrl);
                            }
                            laya.wx.mini.MiniFileMgr.filesListObj && laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize && (laya.wx.mini.MiniFileMgr.filesListObj.fileUsedSize = 0),
                                laya.wx.mini.MiniFileMgr.writeFilesList("", JSON.stringify({}), !1);
                        }, e.onSaveFile = function (t, i, n, r, a, o) {
                            void 0 === n && (n = !0), void 0 === r && (r = ""), void 0 === o && (o = 0);
                            var l = t;
                            if (null == e.filesListObj.fileUsedSize && (e.filesListObj.fileUsedSize = 0), n) {
                                e.getFileNativePath(i);
                                e.filesListObj[l] = {
                                    md5: i,
                                    readyUrl: t,
                                    size: o,
                                    times: s.now(),
                                    encoding: r
                                }, e.filesListObj.fileUsedSize = parseInt(e.filesListObj.fileUsedSize) + o, e.writeFilesList(l, JSON.stringify(e.filesListObj), !0),
                                    null != a && a.runWith([0]);
                            } else if (e.filesListObj[l]) {
                                var h = parseInt(e.filesListObj[l].size);
                                e.filesListObj.fileUsedSize = parseInt(e.filesListObj.fileUsedSize) - h, delete e.filesListObj[l],
                                    e.writeFilesList(l, JSON.stringify(e.filesListObj), !1), null != a && a.runWith([0]);
                            }
                        }, e.writeFilesList = function (t, i, n) {
                            var r = e.fileNativeDir + "/" + e.fileListName + " ";
                            e.fs.writeFile({
                                filePath: r,
                                encoding: "utf8",
                                data: i,
                                success: function (t) { },
                                fail: function (t) { }
                            }), !x.isZiYu && x.isPosMsgYu && wx.postMessage({
                                url: t,
                                data: e.filesListObj[t],
                                isLoad: "filenative",
                                isAdd: n
                            });
                        }, e.getCacheUseSize = function () {
                            return e.filesListObj && e.filesListObj.fileUsedSize ? e.filesListObj.fileUsedSize : 0;
                        }, e.existDir = function (t, i) {
                            e.fs.mkdir({
                                dirPath: t,
                                success: function (t) {
                                    null != i && i.runWith([0, {
                                        data: JSON.stringify({})
                                    }]);
                                },
                                fail: function (t) {
                                    -1 != t.errMsg.indexOf("file already exists") ? e.readSync(e.fileListName, "utf8", i) : null != i && i.runWith([1, t]);
                                }
                            });
                        }, e.readSync = function (t, i, n, r) {
                            void 0 === i && (i = "ascill"), void 0 === r && (r = "");
                            var a, s = e.getFileNativePath(t);
                            try {
                                a = e.fs.readFileSync(s, i), null != n && n.runWith([0, {
                                    data: a
                                }]);
                            } catch (t) {
                                null != n && n.runWith([1]);
                            }
                        }, e.setNativeFileDir = function (t) {
                            e.fileNativeDir = wx.env.USER_DATA_PATH + t;
                        }, e.filesListObj = {}, e.fileNativeDir = null, e.fileListName = "layaairfiles.txt",
                            e.ziyuFileData = {}, e.ziyuFileTextureData = {}, e.loadPath = "", e.DESCENDING = 2,
                            e.NUMERIC = 16, n(e, ["fs", function () {
                                return this.fs = wx.getFileSystemManager();
                            }, "wxdown", function () {
                                return this.wxdown = wx.downloadFile;
                            }]), e;
                    }()), T = function () {
                        function t() { }
                        return r(t, "laya.wx.mini.MiniLocalStorage"), t.__init__ = function () {
                            t.items = t;
                        }, t.setItem = function (t, e) {
                            try {
                                wx.setStorageSync(t, e);
                            } catch (i) {
                                wx.setStorage({
                                    key: t,
                                    data: e
                                });
                            }
                        }, t.getItem = function (t) {
                            return wx.getStorageSync(t);
                        }, t.setJSON = function (e, i) {
                            t.setItem(e, i);
                        }, t.getJSON = function (e) {
                            return t.getItem(e);
                        }, t.removeItem = function (t) {
                            wx.removeStorageSync(t);
                        }, t.clear = function () {
                            wx.clearStorageSync();
                        }, t.getStorageInfoSync = function () {
                            try {
                                var t = wx.getStorageInfoSync();
                                return console.log(t.keys), console.log(t.currentSize), console.log(t.limitSize),
                                    t;
                            } catch (t) { }
                            return null;
                        }, t.support = !0, t.items = null, t;
                    }(), E = (function () {
                        function t(t, e) {
                            this.videoend = !1, this.videourl = "", this.videoElement = null, this.onPlayFunc = null,
                                this.onEndedFunC = null, this._duration = NaN, this.position = NaN, void 0 === t && (t = 320),
                                void 0 === e && (e = 240), this.videoElement = x.window.wx.createVideo({
                                    width: t,
                                    height: e,
                                    autoplay: !0
                                });
                        }
                        r(t, "laya.wx.mini.MiniVideo");
                        var e = t.prototype;
                        e.on = function (t, e, i) {
                            "loadedmetadata" == t ? (this.onPlayFunc = i.bind(e), this.videoElement.onPlay = this.onPlayFunction.bind(this)) : "ended" == t && (this.onEndedFunC = i.bind(e),
                                this.videoElement.onEnded = this.onEndedFunction.bind(this)), this.videoElement.onTimeUpdate = this.onTimeUpdateFunc.bind(this);
                        }, e.onTimeUpdateFunc = function (t) {
                            this.position = t.position, this._duration = t.duration;
                        }, e.onPlayFunction = function () {
                            this.videoElement && (this.videoElement.readyState = 200), console.log("=====视频加载完成========"),
                                null != this.onPlayFunc && this.onPlayFunc();
                        }, e.onEndedFunction = function () {
                            this.videoElement && (this.videoend = !0, console.log("=====视频播放完毕========"), null != this.onEndedFunC && this.onEndedFunC());
                        }, e.off = function (t, e, i) {
                            "loadedmetadata" == t ? (this.onPlayFunc = i.bind(e), this.videoElement.offPlay = this.onPlayFunction.bind(this)) : "ended" == t && (this.onEndedFunC = i.bind(e),
                                this.videoElement.offEnded = this.onEndedFunction.bind(this));
                        }, e.load = function (t) {
                            this.videoElement && (this.videoElement.src = t);
                        }, e.play = function () {
                            this.videoElement && (this.videoend = !1, this.videoElement.play());
                        }, e.pause = function () {
                            this.videoElement && (this.videoend = !0, this.videoElement.pause());
                        }, e.size = function (t, e) {
                            this.videoElement && (this.videoElement.width = t, this.videoElement.height = e);
                        }, e.destroy = function () {
                            this.videoElement && this.videoElement.destroy(), this.videoElement = null, this.onEndedFunC = null,
                                this.onPlayFunc = null, this.videoend = !1, this.videourl = null;
                        }, e.reload = function () {
                            this.videoElement && (this.videoElement.src = this.videourl);
                        }, a(0, e, "duration", function () {
                            return this._duration;
                        }), a(0, e, "paused", function () {
                            return !!this.videoElement && this.videoElement.paused;
                        }), a(0, e, "loop", function () {
                            return !!this.videoElement && this.videoElement.loop;
                        }, function (t) {
                            this.videoElement && (this.videoElement.loop = t);
                        }), a(0, e, "currentTime", function () {
                            return this.videoElement ? this.videoElement.initialTime : 0;
                        }, function (t) {
                            this.videoElement && (this.videoElement.initialTime = t);
                        }), a(0, e, "ended", function () {
                            return this.videoend;
                        }), a(0, e, "muted", function () {
                            return !!this.videoElement && this.videoElement.muted;
                        }, function (t) {
                            this.videoElement && (this.videoElement.muted = t);
                        }), a(0, e, "videoWidth", function () {
                            return this.videoElement ? this.videoElement.width : 0;
                        }), a(0, e, "videoHeight", function () {
                            return this.videoElement ? this.videoElement.height : 0;
                        }), a(0, e, "playbackRate", function () {
                            return this.videoElement ? this.videoElement.playbackRate : 0;
                        }, function (t) {
                            this.videoElement && (this.videoElement.playbackRate = t);
                        }), a(0, e, "x", function () {
                            return this.videoElement ? this.videoElement.x : 0;
                        }, function (t) {
                            this.videoElement && (this.videoElement.x = t);
                        }), a(0, e, "y", function () {
                            return this.videoElement ? this.videoElement.y : 0;
                        }, function (t) {
                            this.videoElement && (this.videoElement.y = t);
                        }), a(0, e, "currentSrc", function () {
                            return this.videoElement.src;
                        }), t.__init__ = function () {
                            laya.device.media.Video = t;
                        };
                    }(), function () {
                        function t() { }
                        return r(t, "laya.wx.mini.MiniImage"), t.prototype._loadImage = function (e) {
                            if (x.isZiYu) t.onCreateImage(e, this, !0); else {
                                var i = !1;
                                if (S.isLocalNativeFile(e)) {
                                    if (-1 == e.indexOf("http://usr/") && (-1 != e.indexOf("http://") || -1 != e.indexOf("https://"))) if ("" != S.loadPath) e = e.split(S.loadPath)[1]; else {
                                        var n = "" != y.rootPath ? y.rootPath : y._basePath, r = e;
                                        "" != n && (e = e.split(n)[1]), e || (e = r);
                                    }
                                    if (x.subNativeFiles && 0 == x.subNativeheads.length) for (var a in x.subNativeFiles) {
                                        var s = x.subNativeFiles[a];
                                        x.subNativeheads = x.subNativeheads.concat(s);
                                        for (var o = 0; o < s.length; o++) x.subMaps[s[o]] = a + "/" + s[o];
                                    }
                                    if (x.subNativeFiles && -1 != e.indexOf("/")) {
                                        var l = e.split("/")[0] + "/";
                                        if (l && -1 != x.subNativeheads.indexOf(l)) {
                                            var u = x.subMaps[l];
                                            e = e.replace(l, u);
                                        }
                                    }
                                } else i = !0, e = y.formatURL(e);
                                S.getFileInfo(e) ? t.onCreateImage(e, this, !i) : -1 != e.indexOf("http://usr/") || -1 == e.indexOf("http://") && -1 == e.indexOf("https://") || x.isZiYu ? t.onCreateImage(e, this, !0) : S.downOtherFiles(e, new h(t, t.onDownImgCallBack, [e, this]), e);
                            }
                        }, t.onDownImgCallBack = function (e, i, n, r) {
                            void 0 === r && (r = ""), n ? i.onError(null) : t.onCreateImage(e, i, !1, r);
                        }, t.onCreateImage = function (t, e, i, n) {
                            var r, a;
                            if (void 0 === i && (i = !1), void 0 === n && (n = ""), x.autoCacheFile) if (i) if (x.isZiYu) {
                                var o = y.formatURL(t);
                                r = S.ziyuFileTextureData[o] ? S.ziyuFileTextureData[o] : t;
                            } else r = t; else if ("" != n) r = n; else {
                                var h = S.getFileInfo(t).md5;
                                r = S.getFileNativePath(h);
                            } else r = i ? t : n;
                            function u() {
                                var t = e._imgCache[r];
                                t && (t.onload = null, t.onerror = null, delete e._imgCache[r]);
                            }
                            null == e._imgCache && (e._imgCache = {});
                            var c = function () {
                                u(), e.event("error", "Load image failed");
                            };
                            if ("nativeimage" == e._type) {
                                var d = function () {
                                    u(), e.onLoaded(a);
                                };
                                (a = new s.window.Image()).crossOrigin = "", a.onload = d, a.onerror = c, a.src = r,
                                    e._imgCache[r] = a;
                            } else {
                                var _ = new s.window.Image();
                                d = function () {
                                    (a = l.create(_.width, _.height)).loadImageSource(_, !0), a._setCreateURL(r), u(),
                                        e.onLoaded(a);
                                }, _.crossOrigin = "", _.onload = d, _.onerror = c, _.src = r, e._imgCache[r] = _;
                            }
                        }, t;
                    }()), C = function () {
                        function e() { }
                        return r(e, "laya.wx.mini.MiniInput"), e._createInputElement = function () {
                            u._initInput(u.area = s.createElement("textarea")), u._initInput(u.input = s.createElement("input")),
                                u.inputContainer = s.createElement("div"), u.inputContainer.style.position = "absolute",
                                u.inputContainer.style.zIndex = 1e5, s.container.appendChild(u.inputContainer),
                                u.inputContainer.setPos = function (t, e) {
                                    u.inputContainer.style.left = t + "px", u.inputContainer.style.top = e + "px";
                                }, i.stage.on("resize", null, e._onStageResize), wx.onWindowResize && wx.onWindowResize(function (e) {
                                    t.dispatchEvent && t.dispatchEvent("resize");
                                }), g._soundClass = I, g._musicClass = I;
                            var n = x.systemInfo.model, r = x.systemInfo.system;
                            -1 != n.indexOf("iPhone") && (s.onIPhone = !0, s.onIOS = !0, s.onIPad = !0, s.onAndroid = !1),
                                -1 == r.indexOf("Android") && -1 == r.indexOf("Adr") || (s.onAndroid = !0, s.onIPhone = !1,
                                    s.onIOS = !1, s.onIPad = !1);
                        }, e._onStageResize = function () {
                            // i.stage._canvasTransform.identity().scale(s.width / f.canvas.width / s.pixelRatio, s.height / f.canvas.height / s.pixelRatio);
                        }, e.wxinputFocus = function (t) {
                            var e = u.inputElement.target;
                            e && !e.editable || (x.window.wx.offKeyboardConfirm(), x.window.wx.offKeyboardInput(),
                                x.window.wx.showKeyboard({
                                    defaultValue: e.text,
                                    maxLength: e.maxChars,
                                    multiple: e.multiline,
                                    confirmHold: !0,
                                    confirmType: e.confirmType || "done",
                                    success: function (t) { },
                                    fail: function (t) { }
                                }), x.window.wx.onKeyboardConfirm(function (t) {
                                    var i = t ? t.value : "";
                                    e._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""), e._restrictPattern.test(i) && (i = i.replace(e._restrictPattern, ""))),
                                        e.text = i, e.event("input"), laya.wx.mini.MiniInput.inputEnter(), e.event("confirm");
                                }), x.window.wx.onKeyboardInput(function (t) {
                                    var i = t ? t.value : "";
                                    e.multiline || -1 == i.indexOf("\n") ? (e._restrictPattern && (i = i.replace(/\u2006|\x27/g, ""),
                                        e._restrictPattern.test(i) && (i = i.replace(e._restrictPattern, ""))), e.text = i,
                                        e.event("input")) : laya.wx.mini.MiniInput.inputEnter();
                                }));
                        }, e.inputEnter = function () {
                            u.inputElement.target.focus = !1;
                        }, e.wxinputblur = function () {
                            e.hideKeyboard();
                        }, e.hideKeyboard = function () {
                            x.window.wx.offKeyboardConfirm(), x.window.wx.offKeyboardInput(), x.window.wx.hideKeyboard({
                                success: function (t) {
                                    console.log("隐藏键盘");
                                },
                                fail: function (t) {
                                    console.log("隐藏键盘出错:" + (t ? t.errMsg : ""));
                                }
                            });
                        }, e;
                    }(), x = function () {
                        function e() { }
                        return r(e, "laya.wx.mini.MiniAdpter"), e.getJson = function (t) {
                            return JSON.parse(t);
                        }, e.enable = function () {
                            e.init(i.isWXPosMsg, i.isWXOpenDataContext);
                        }, e.init = function (n, r) {
                            void 0 === n && (n = !1), void 0 === r && (r = !1), e._inited || (e._inited = !0,
                                e.window = t, e.window.hasOwnProperty("wx") && (e.window.navigator.userAgent.indexOf("MiniGame") < 0 || (e.isZiYu = r,
                                    e.isPosMsgYu = n, e.EnvConfig = {}, e.isZiYu || (S.setNativeFileDir("/layaairGame"),
                                        S.existDir(S.fileNativeDir, h.create(e, e.onMkdirCallBack))), e.systemInfo = wx.getSystemInfoSync(),
                                    e.window.focus = function () { }, i._getUrlPath = function () {
                                        return "";
                                    }, e.window.logtime = function (t) { }, e.window.alertTimeLog = function (t) { }, e.window.resetShareInfo = function () { },
                                    e.window.CanvasRenderingContext2D = function () { }, e.window.CanvasRenderingContext2D.prototype = e.window.wx.createCanvas().getContext("2d").__proto__,
                                    e.window.document.body.appendChild = function () { }, e.EnvConfig.pixelRatioInt = 0,
                                    s._pixelRatio = e.pixelRatio(), e._preCreateElement = s.createElement, s.createElement = e.createElement,
                                    p.createShaderCondition = e.createShaderCondition, v.parseXMLFromString = e.parseXMLFromString,
                                    u._createInputElement = C._createInputElement, e.EnvConfig.load = c.prototype.load,
                                    c.prototype.load = b.prototype.load, c.prototype._loadImage = E.prototype._loadImage,
                                    d._baseClass = T, T.__init__(), e.window.wx.onMessage(e._onMessage))));
                        }, e._onMessage = function (t) {
                            switch (t.type) {
                                case "changeMatrix":
                                    i.stage.transform.identity(), i.stage._width = t.w, i.stage._height = t.h, i.stage._canvasTransform = new _(t.a, t.b, t.c, t.d, t.tx, t.ty);
                                    break;

                                case "display":
                                    i.stage.frameRate = t.rate || "fast";
                                    break;

                                case "undisplay":
                                    i.stage.frameRate = "sleep";
                            }
                            "opendatacontext" == t.isLoad ? t.url && (S.ziyuFileData[t.url] = t.atlasdata, S.ziyuFileTextureData[t.imgReadyUrl] = t.imgNativeUrl) : "openJsondatacontext" == t.isLoad ? t.url && (S.ziyuFileData[t.url] = t.atlasdata) : "openJsondatacontextPic" == t.isLoad && (S.ziyuFileTextureData[t.imgReadyUrl] = t.imgNativeUrl);
                        }, e.getUrlEncode = function (t, e) {
                            return "arraybuffer" == e ? "" : "utf8";
                        }, e.downLoadFile = function (t, e, i, n) {
                            void 0 === e && (e = ""), void 0 === n && (n = "utf8"), S.getFileInfo(t) ? null != i && i.runWith([0]) : S.downLoadFile(t, e, i, n);
                        }, e.remove = function (t, e) {
                            S.deleteFile("", t, e, "", 0);
                        }, e.removeAll = function () {
                            S.deleteAll();
                        }, e.hasNativeFile = function (t) {
                            return S.isLocalNativeFile(t);
                        }, e.getFileInfo = function (t) {
                            return S.getFileInfo(t);
                        }, e.getFileList = function () {
                            return S.filesListObj;
                        }, e.exitMiniProgram = function () {
                            e.window.wx.exitMiniProgram();
                        }, e.onMkdirCallBack = function (t, e) {
                            t || (S.filesListObj = JSON.parse(e.data));
                        }, e.pixelRatio = function () {
                            if (!e.EnvConfig.pixelRatioInt) try {
                                return e.EnvConfig.pixelRatioInt = e.systemInfo.pixelRatio, e.systemInfo.pixelRatio;
                            } catch (t) { }
                            return e.EnvConfig.pixelRatioInt;
                        }, e.createElement = function (i) {
                            var n;
                            if ("canvas" == i) return 1 == e.idx ? e.isZiYu ? (n = sharedCanvas).style = {} : n = t.canvas : n = t.wx.createCanvas(),
                                e.idx++, n;
                            if ("textarea" == i || "input" == i) return e.onCreateInput(i);
                            if ("div" == i) {
                                var r = e._preCreateElement(i);
                                return r.contains = function (t) {
                                    return null;
                                }, r.removeChild = function (t) { }, r;
                            }
                            return e._preCreateElement(i);
                        }, e.onCreateInput = function (t) {
                            var i = e._preCreateElement(t);
                            return i.focus = C.wxinputFocus, i.blur = C.wxinputblur, i.style = {}, i.value = 0,
                                i.parentElement = {}, i.placeholder = {}, i.type = {}, i.setColor = function (t) { },
                                i.setType = function (t) { }, i.setFontFace = function (t) { }, i.addEventListener = function (t) { },
                                i.contains = function (t) {
                                    return null;
                                }, i.removeChild = function (t) { }, i;
                        }, e.createShaderCondition = function (t) {
                            var e = this;
                            return function () {
                                return e[t.replace("this.", "")];
                            };
                        }, e.sendAtlasToOpenDataContext = function (t) {
                            if (!laya.wx.mini.MiniAdpter.isZiYu) {
                                var i = c.getRes(y.formatURL(t));
                                if (!i) throw "传递的url没有获取到对应的图集数据信息，请确保图集已经过！";
                                i.meta.image.split(",");
                                if (i.meta && i.meta.image) for (var n = i.meta.image.split(","), r = t.indexOf("/") >= 0 ? "/" : "\\", a = t.lastIndexOf(r), s = a >= 0 ? t.substr(0, a + 1) : "", o = 0, l = n.length; o < l; o++) n[o] = s + n[o]; else n = [t.replace(".json", ".png")];
                                for (o = 0; o < n.length; o++) {
                                    var h = n[o];
                                    e.postInfoToContext(t, h, i);
                                }
                            }
                        }, e.postInfoToContext = function (t, e, i) {
                            var n = {
                                frames: i.frames,
                                meta: i.meta
                            }, r = e, a = S.getFileInfo(y.formatURL(e));
                            if (a) var s = a.md5, o = S.getFileNativePath(s); else o = r;
                            if (!o) throw "获取图集的磁盘url路径不存在！";
                            wx.postMessage({
                                url: t,
                                atlasdata: n,
                                imgNativeUrl: o,
                                imgReadyUrl: r,
                                isLoad: "opendatacontext"
                            });
                        }, e.sendSinglePicToOpenDataContext = function (t) {
                            var e = y.formatURL(t), i = S.getFileInfo(e);
                            if (i) {
                                var n = i.md5, r = S.getFileNativePath(n);
                                t = e;
                            } else r = t;
                            if (!r) throw "获取图集的磁盘url路径不存在！";
                            wx.postMessage({
                                url: t,
                                imgNativeUrl: r,
                                imgReadyUrl: t,
                                isLoad: "openJsondatacontextPic"
                            });
                        }, e.sendJsonDataToDataContext = function (t) {
                            if (!laya.wx.mini.MiniAdpter.isZiYu) {
                                var e = c.getRes(t);
                                if (!e) throw "传递的url没有获取到对应的图集数据信息，请确保图集已经过！";
                                wx.postMessage({
                                    url: t,
                                    atlasdata: e,
                                    isLoad: "openJsondatacontext"
                                });
                            }
                        }, e.EnvConfig = null, e.window = null, e._preCreateElement = null, e._inited = !1,
                            e.systemInfo = null, e.isZiYu = !1, e.isPosMsgYu = !1, e.autoCacheFile = !0, e.minClearSize = 5242880,
                            e.subNativeFiles = null, e.subNativeheads = [], e.subMaps = [], e.AutoCacheDownFile = !1,
                            e.parseXMLFromString = function (e) {
                                var i;
                                e = e.replace(/>\s+</g, "><");
                                try {
                                    i = new t.Parser.DOMParser().parseFromString(e, "text/xml");
                                } catch (t) {
                                    throw "需要引入xml解析库文件";
                                }
                                return i;
                            }, e.idx = 1, n(e, ["nativefiles", function () {
                                return this.nativefiles = ["layaNativeDir", "wxlocal"];
                            }]), e;
                    }(), b = function (t) {
                        function e() {
                            e.__super.call(this);
                        }
                        return r(e, "laya.wx.mini.MiniLoader", t), e.prototype.load = function (t, i, n, r, a) {
                            void 0 === n && (n = !0), void 0 === a && (a = !1);
                            if (this._url = t, t) {
                                if (0 === (t = y.customFormat(t)).indexOf("data:image") ? this._type = i = "image" : this._type = i || (i = c.getTypeFromUrl(this._url)),
                                    this._cache = n, this._data = null, !a && c.loadedMap[y.formatURL(t)]) return this._data = c.loadedMap[y.formatURL(t)],
                                        this.event("progress", 1), void this.event("complete", this._data);
                                if (null != c.parserMap[i]) return this._customParse = !0, void (c.parserMap[i] instanceof laya.utils.Handler ? c.parserMap[i].runWith(this) : c.parserMap[i].call(null, this));
                                var s;
                                switch (i) {
                                    case "atlas":
                                    case "prefab":
                                    case "plf":
                                        s = "json";
                                        break;

                                    case "font":
                                        s = "xml";
                                        break;

                                    case "plfb":
                                        s = "arraybuffer";
                                        break;

                                    default:
                                        s = i;
                                }
                                if (c.preLoadedMap[y.formatURL(t)]) this.onLoaded(c.preLoadedMap[y.formatURL(t)]); else {
                                    var o = x.getUrlEncode(t, s), l = v.getFileExtension(t);
                                    if (-1 != e._fileTypeArr.indexOf(l)) x.EnvConfig.load.call(this, t, i, n, r, a); else {
                                        if (x.isZiYu && !S.ziyuFileData[t] && (t = y.formatURL(t)), x.isZiYu && S.ziyuFileData[t]) {
                                            var u = S.ziyuFileData[t];
                                            return void this.onLoaded(u);
                                        }
                                        if (S.getFileInfo(t)) {
                                            var d = S.getFileInfo(t);
                                            d.encoding = null == d.encoding ? "utf8" : d.encoding, S.readFile(t, d.encoding, new h(e, e.onReadNativeCallBack, [o, t, i, n, r, a, this]), t);
                                        } else {
                                            if (S.isLocalNativeFile(t)) {
                                                if (x.subNativeFiles && 0 == x.subNativeheads.length) for (var _ in x.subNativeFiles) {
                                                    var f = x.subNativeFiles[_];
                                                    x.subNativeheads = x.subNativeheads.concat(f);
                                                    for (var p = 0; p < f.length; p++) x.subMaps[f[p]] = _ + "/" + f[p];
                                                }
                                                if (x.subNativeFiles && -1 != t.indexOf("/")) {
                                                    var m = t.split("/")[0] + "/";
                                                    if (m && -1 != x.subNativeheads.indexOf(m)) {
                                                        var g = x.subMaps[m];
                                                        t = t.replace(m, g);
                                                    }
                                                }
                                                var T = "" != y.rootPath ? y.rootPath : y._basePath, E = t;
                                                return "" != T && (t = t.split(T)[1]), t || (t = E), void S.read(t, o, new h(e, e.onReadNativeCallBack, [o, t, i, n, r, a, this]));
                                            }
                                            var C = y.formatURL(t);
                                            -1 != C.indexOf("http://usr/") || -1 == C.indexOf("http://") && -1 == C.indexOf("https://") || x.AutoCacheDownFile ? S.readFile(t, o, new h(e, e.onReadNativeCallBack, [o, t, i, n, r, a, this]), t) : x.EnvConfig.load.call(this, t, i, n, r, a);
                                        }
                                    }
                                }
                            } else this.onLoaded(null);
                        }, e.onReadNativeCallBack = function (t, e, i, n, r, a, s, o, l) {
                            var h;
                            (void 0 === n && (n = !0), void 0 === a && (a = !1), void 0 === o && (o = 0), o) ? 1 == o && x.EnvConfig.load.call(s, e, i, n, r, a) : (h = "json" == i || "atlas" == i || "prefab" == i || "plf" == i ? x.getJson(l.data) : "xml" == i ? v.parseXMLFromString(l.data) : l.data,
                                !x.isZiYu && x.isPosMsgYu && "arraybuffer" != i && wx.postMessage({
                                    url: e,
                                    data: h,
                                    isLoad: "filedata"
                                }), s.onLoaded(h));
                        }, n(e, ["_fileTypeArr", function () {
                            return this._fileTypeArr = ["png", "jpg", "bmp", "jpeg", "gif"];
                        }]), e;
                    }(o), I = function (t) {
                        function e() {
                            this._sound = null, this.url = null, this.loaded = !1, this.readyUrl = null, e.__super.call(this);
                        }
                        r(e, "laya.wx.mini.MiniSound", t);
                        var i = e.prototype;
                        return i.load = function (t) {
                            if (S.isLocalNativeFile(t)) {
                                if (-1 != t.indexOf("http://") || -1 != t.indexOf("https://")) if ("" != S.loadPath) t = t.split(S.loadPath)[1]; else {
                                    var i = "" != y.rootPath ? y.rootPath : y._basePath;
                                    "" != i && (t = t.split(i)[1]);
                                }
                            } else t = y.formatURL(t);
                            if (this.url = t, this.readyUrl = t, e._audioCache[this.readyUrl]) this.event("complete"); else if (x.autoCacheFile && S.getFileInfo(t)) this.onDownLoadCallBack(t, 0); else if (x.autoCacheFile) if (S.isLocalNativeFile(t)) {
                                var n = t;
                                if ("" != (i = "" != y.rootPath ? y.rootPath : y._basePath) && (t = t.split(i)[1]),
                                    t || (t = n), x.subNativeFiles && 0 == x.subNativeheads.length) for (var r in x.subNativeFiles) {
                                        var a = x.subNativeFiles[r];
                                        x.subNativeheads = x.subNativeheads.concat(a);
                                        for (var s = 0; s < a.length; s++) x.subMaps[a[s]] = r + "/" + a[s];
                                    }
                                if (x.subNativeFiles && -1 != t.indexOf("/")) {
                                    var o = t.split("/")[0] + "/";
                                    if (o && -1 != x.subNativeheads.indexOf(o)) {
                                        var l = x.subMaps[o];
                                        t = t.replace(o, l);
                                    }
                                }
                                this.onDownLoadCallBack(t, 0);
                            } else !S.isLocalNativeFile(t) && -1 == t.indexOf("http://") && -1 == t.indexOf("https://") || -1 != t.indexOf("http://usr/") ? this.onDownLoadCallBack(t, 0) : S.downOtherFiles(t, h.create(this, this.onDownLoadCallBack, [t]), t); else this.onDownLoadCallBack(t, 0);
                        }, i.onDownLoadCallBack = function (t, i) {
                            if (i) this.event("error"); else {
                                var n;
                                if (x.autoCacheFile) {
                                    if (S.isLocalNativeFile(t)) {
                                        var r = "" != y.rootPath ? y.rootPath : y._basePath, a = t;
                                        "" == r || -1 == t.indexOf("http://") && -1 == t.indexOf("https://") || (n = t.split(r)[1]),
                                            n || (n = a);
                                    } else {
                                        var s = S.getFileInfo(t);
                                        if (s && s.md5) {
                                            var o = s.md5;
                                            n = S.getFileNativePath(o);
                                        } else n = t;
                                    }
                                    this._sound = e._createSound(), this._sound.src = this.url = n;
                                } else this._sound = e._createSound(), this._sound.src = t;
                                this._sound.onCanplay(e.bindToThis(this.onCanPlay, this)), this._sound.onError(e.bindToThis(this.onError, this));
                            }
                        }, i.onError = function (t) {
                            try {
                                console.log("-----1---------------minisound-----id:" + e._id), console.log(t);
                            } catch (t) {
                                console.log("-----2---------------minisound-----id:" + e._id), console.log(t);
                            }
                            this.event("error"), this._sound.offError(null);
                        }, i.onCanPlay = function () {
                            this.loaded = !0, this.event("complete"), this._sound.offCanplay(null);
                        }, i.play = function (t, i) {
                            var n;
                            if (void 0 === t && (t = 0), void 0 === i && (i = 0), this.url == g._bgMusic ? (e._musicAudio || (e._musicAudio = e._createSound()),
                                n = e._musicAudio) : n = e._audioCache[this.readyUrl] ? e._audioCache[this.readyUrl]._sound : e._createSound(),
                                !n) return null;
                            if (x.autoCacheFile && S.getFileInfo(this.url)) {
                                var r = S.getFileInfo(this.url).md5;
                                n.src = this.url = S.getFileNativePath(r);
                            } else n.src = this.url;
                            var a = new w(n, this);
                            return a.url = this.url, a.loops = i, a.loop = 0 === i, a.startTime = t, a.play(),
                                g.addChannel(a), a;
                        }, i.dispose = function () {
                            var t = e._audioCache[this.readyUrl];
                            t && (t.src = "", t._sound && (t._sound.destroy(), t._sound = null, t = null), delete e._audioCache[this.readyUrl]);
                        }, a(0, i, "duration", function () {
                            return this._sound.duration;
                        }), e._createSound = function () {
                            // return e._id++, x.window.wx.createInnerAudioContext();
                        }, e.bindToThis = function (t, e) {
                            return t.bind(e);
                        }, e._musicAudio = null, e._id = 0, e._audioCache = {}, e;
                    }(o), w = (function (t) {
                        function e() {
                            e.__super.call(this);
                        }
                        r(e, "laya.wx.mini.MiniAccelerator", t);
                        var i = e.prototype;
                        i.on = function (i, n, r, a) {
                            return t.prototype.on.call(this, i, n, r, a), e.startListen(this.onDeviceOrientationChange),
                                this;
                        }, i.off = function (i, n, r, a) {
                            return void 0 === a && (a = !1), this.hasListener(i) || e.stopListen(), t.prototype.off.call(this, i, n, r, a);
                        }, e.__init__ = function () {
                            try {
                                var t;
                                if (!(t = laya.device.motion.Accelerator)) return;
                                t.prototype.on = e.prototype.on, t.prototype.off = e.prototype.off;
                            } catch (t) { }
                        }, e.startListen = function (t) {
                            if (e._callBack = t, !e._isListening) {
                                e._isListening = !0;
                                try {
                                    wx.onAccelerometerChange(e.onAccelerometerChange);
                                } catch (t) { }
                            }
                        }, e.stopListen = function () {
                            e._isListening = !1;
                            try {
                                wx.stopAccelerometer({});
                            } catch (t) { }
                        }, e.onAccelerometerChange = function (t) {
                            var i;
                            (i = {}).acceleration = t, i.accelerationIncludingGravity = t, i.rotationRate = {},
                                null != e._callBack && e._callBack(i);
                        }, e._isListening = !1, e._callBack = null;
                    }(o), function (t) {
                        function e(t, i) {
                            this._audio = null, this._onEnd = null, this._miniSound = null, e.__super.call(this),
                                this._audio = t, this._miniSound = i, this._onEnd = e.bindToThis(this.__onEnd, this),
                                t.onEnded(this._onEnd);
                        }
                        r(e, "laya.wx.mini.MiniSoundChannel", t);
                        var n = e.prototype;
                        return n.__onEnd = function () {
                            if (I._audioCache[this.url] = this._miniSound, 1 == this.loops) return this.completeHandler && (i.systemTimer.once(10, this, this.__runComplete, [this.completeHandler], !1),
                                this.completeHandler = null), this.stop(), void this.event("complete");
                            this.loops > 0 && this.loops--, this.startTime = 0, this.play();
                        }, n.play = function () {
                            this.isStopped = !1, g.addChannel(this), this._audio.play();
                        }, n.stop = function () {
                            this.isStopped = !0, g.removeChannel(this), this.completeHandler = null, this._audio && (this._audio.stop(),
                                this._audio.offEnded(null), this._miniSound.dispose(), this._audio = null, this._miniSound = null,
                                this._onEnd = null);
                        }, n.pause = function () {
                            this.isStopped = !0, this._audio.pause();
                        }, n.resume = function () {
                            this._audio && (this.isStopped = !1, g.addChannel(this), this._audio.play());
                        }, a(0, n, "startTime", null, function (t) {
                            this._audio && (this._audio.startTime = t);
                        }), a(0, n, "autoplay", function () {
                            return this._audio.autoplay;
                        }, function (t) {
                            this._audio.autoplay = t;
                        }), a(0, n, "position", function () {
                            return this._audio ? this._audio.currentTime : 0;
                        }), a(0, n, "duration", function () {
                            return this._audio ? this._audio.duration : 0;
                        }), a(0, n, "loop", function () {
                            return this._audio.loop;
                        }, function (t) {
                            this._audio.loop = t;
                        }), a(0, n, "volume", function () {
                            return this._audio ? this._audio.volume : 1;
                        }, function (t) {
                            this._audio && (this._audio.volume = t);
                        }), e.bindToThis = function (t, e) {
                            return t.bind(e);
                        }, e;
                    }(m));
        }, 1e3);
    }).call(this, i(0));
}, function (t, e, i) {
    var n, r = this && this.__extends || (n = Object.setPrototypeOf || {
        __proto__: []
    } instanceof Array && function (t, e) {
        t.__proto__ = e;
    } || function (t, e) {
        for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
    }, function (t, e) {
        function i() {
            this.constructor = t;
        }
        n(t, e), t.prototype = null === e ? Object.create(e) : (i.prototype = e.prototype,
            new i());
    });
    !function t(e, i, n) {
        function r(s, o) {
            if (!i[s]) {
                if (!e[s]) {
                    if (a) return a(s, !0);
                    var l = new Error("Cannot find module '" + s + "'");
                    throw l.code = "MODULE_NOT_FOUND", l;
                }
                var h = i[s] = {
                    exports: {}
                };
                e[s][0].call(h.exports, function (t) {
                    return r(e[s][1][t] || t);
                }, h, h.exports, t, e, i, n);
            }
            return i[s].exports;
        }
        for (var a = !1, s = 0; s < n.length; s++) r(n[s]);
        return r;
    }({
        1: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.BagSequence = void 0;
            var n = function () {
                function t(t) {
                    this.elems = t.concat(), this.shuffule(), this.index = 0;
                }
                return t.prototype.getNext = function () {
                    return this.index >= this.elems.length && (this.index = 0, this.shuffule()), this.elems[this.index++];
                }, t.prototype.shuffule = function () {
                    this.elems.sort(function (t, e) {
                        return Math.random() - .5;
                    });
                }, t;
            }();
            i.BagSequence = n;
        }, {}],
        2: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.RecycleScript3D = i.RecycleScript = i.RecycleClass = void 0;
            var n = function () {
                function t() {
                    this.__className = this.__getClassName();
                }
                return t.prototype.__getClassName = function () {
                    return t.__className;
                }, t.__className = "RecycleClass", t;
            }();
            i.RecycleClass = n;
            var a = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e.__className = e.__getClassName(), e;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onReset = function () { }, e.__className = "RecycleScript", e;
            }(Laya.Script);
            i.RecycleScript = a;
            var s = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e.__className = e.__getClassName(), e;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onReset = function () { }, e.__className = "RecycleScript3D", e;
            }(Laya.Script3D);
            i.RecycleScript3D = s;
        }, {}],
        3: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.MisleadBanner = void 0;
            var n = t("./GlobalFuncs"), r = t("./data/UserData"), a = t("./sdk/sdk"), s = t("./data/MjpHelper");
            i.MisleadBanner = function (t, e, i, o) {
                var l = n.default.getBannerRectWithHeight(210);
                a.default.supportBannerAd() && a.default._loadBannerAd(e, l);
                var h = !1;
                if ("wx" === a.default.getPlatform() && a.default.isCensoredRegion() && (h = !0,
                    console.log("ibip:" + h)), 1 === r.default.getInstance().sequenceMisleadButton.getNext() && s.default.enableMisleadBanner() && !h) {
                    var u = Math.floor(3 * Math.random()) + 1, c = t.y, d = 0, _ = function () {
                        ++d >= u && (t.offClick(i, _), t.offClick(i, o), t.onClick(i, o), t.y = c, a.default.supportBannerAd() && a.default.showBannerAd(e, l));
                    };
                    t.y += 150, t.offClick(i, o), t.offClick(i, _), t.onClick(i, _);
                } else a.default.supportBannerAd() && a.default.showBannerAd(e, l), t.offClick(i, o),
                    t.onClick(i, o);
            };
        }, {
            "./GlobalFuncs": 7,
            "./data/MjpHelper": 18,
            "./data/UserData": 20,
            "./sdk/sdk": 327
        }],
        4: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() {
                    this._eventMap = {}, this._events = {}, this._events = {};
                }
                return t.getInstance = function () {
                    return this._instance || (this._instance = new t()), this._instance;
                }, t.prototype.on = function (t, e, i, n) {
                    void 0 === n && (n = null);
                    var r = this._eventMap[t];
                    null == r && (r = [], this._eventMap[t] = r);
                    for (var a = r.length, s = 0; s < a; s++) {
                        var o = r[s];
                        o.method == i && o.caller == e && console.log("名为【{0}】的事件重复注册侦听器", t);
                    }
                    null === i && console.log("注册【{0}】事件的侦听器函数为空", t), r.push(Laya.Handler.create(e, i, n, !1));
                }, t.prototype.off = function (t, e, i) {
                    var n = this._eventMap[t];
                    if (n) {
                        for (var r = n.length - 1; r >= 0; r--) {
                            var a = n[r];
                            if (null === e && null === i || a.method == i && a.caller == e) {
                                n.splice(r, 1), a.recover();
                                break;
                            }
                        }
                        0 == n.length && delete this._eventMap[t];
                    } else console.log("名为【{0}】的事件不存在", t);
                }, t.prototype.emit = function (t) {
                    for (var e = [], i = 1; i < arguments.length; i++) e[i - 1] = arguments[i];
                    var n = this._eventMap[t];
                    if (null == n); else for (var r = n.length, a = r - 1; a >= 0; a--) {
                        var s = n[a];
                        s.runWith(e);
                    }
                }, t.prototype.removeAll = function () {
                    for (var t in this._events) this.off(t, null, null);
                }, t._instance = null, t;
            }().getInstance();
            i.default = n;
        }, {}],
        5: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = 0;
            function r() {
                return "e_" + ++n;
            }
            var a = function () {
                function t() { }
                return t.MJP_ONOFF = r(), t.USER_LOGIN = r(), t.INVITE_PAGE_CHANGE = r(), t.UI_SOME_MODAL_SHOW = r(),
                    t.UI_ALL_MODAL_CLOSE = r(), t.UI_SHOW_MODEL = r(), t.UI_HIDE_MODEL = r(), t.UI_PLAYER_MOVE = r(),
                    t.UI_PLAYER_STOP = r(), t.UI_SKIN_SELECTED = r(), t.UI_SKIN_UNLOCKED = r(), t.UI_SKIN_PREVIEW = r(),
                    t.UI_TRANSFORM_START = r(), t.UI_TRANSFORM_ENDED = r(), t.UI_TRANSFORM_RESUME = r(),
                    t.UI_TRANSFORM_PAUSE = r(), t.UI_ENTER_GAME = r(), t.UI_BACK_TO_HOME = r(), t.UI_SHOW_SKIN = r(),
                    t.UI_HIDE_SKIN = r(), t.UPDATE_MATCH_TIME = r(), t.RESET_GAME = r(), t.START_GAME = r(),
                    t.GAME_READY = r(), t.GAME_START = r(), t.GAME_ENDED = r(), t.GAME_SCORE = r(),
                    t.GAME_COMPLETE = r(), t.GAME_SHOT = r(), t.BALL_HOLD = r(), t.BALL_DROP = r(),
                    t.COMBO_CHANGE = r(), t.COMBO_REWARD = r(), t.BALL_UPDATE = r(), t.LOCK_INPUT = r(),
                    t.SHOW_GUIDE = r(), t.COIN_CHANGE = r(), t.SCORE_CHANGE = r(), t.FRAGMENT_CHANGE = r(),
                    t.CHEST_CHANGE = r(), t.MATCH_START = r(), t.MATCH_ENDED = r(), t.TRY_SKIN = r(),
                    t;
            }();
            i.default = a;
        }, {}],
        6: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.init = function () {
                    Laya.ClassUtils.regClass;
                }, t.width = 750, t.height = 1334, t.scaleMode = "showall", t.screenMode = "none",
                    t.alignV = "middle", t.alignH = "center", t.startScene = "", t.sceneRoot = "", t.debug = !1,
                    t.stat = !1, t.physicsDebug = !1, t.exportSceneToJson = !0, t;
            }();
            i.default = n, n.init();
        }, {}],
        7: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./sdk/sdk"), r = t("./math/MathHelper").default.random().toFixed(14), a = null;
            function s(t) {
                !function () {
                    if (!a) {
                        a = new Uint8Array(16);
                        for (var t = 0; t < 16 && t < r.length; t++) a[t] = r.charCodeAt(t);
                    }
                }();
                for (var e = new Uint8Array(t), i = e.length, n = new Uint8Array(i), s = 0; i > 0;) {
                    for (var o = 0; o < 16 && o < i; o++) {
                        var l = e[s + o];
                        n[s + o] = l ^ a[o];
                    }
                    s += 16, i -= 16;
                }
                return n.buffer;
            }
            Laya.Loader.parserMap.buffer = function (t) {
                t.on("loaded", null, function (e) {
                    var i = s(e);
                    t._cache = !0, t.endLoad(i);
                }), t.load(t.url, Laya.Loader.BUFFER, !1, null, !0);
            };
            var o = null;
            function l() {
                if (o) return o;
                var t = n.default.getSafeArea(),
                    e = new Laya.Rectangle(t.left, t.top, Laya.Browser.clientWidth - t.left - t.right, Laya.Browser.clientHeight - t.top - t.bottom);
                return o = e, e;
            }
            i.default = {
                getSafeArea: l,
                getClientRect: function (t) {
                    !function t(e) {
                        if (e instanceof fairygui.display.Image) {
                            var i = e.rebuild;
                            i && i.call(e);
                        }
                        for (var n = 0, r = e._children; n < r.length; n++) {
                            t(r[n]);
                        }
                    }(t);
                    var e = t.getSelfBounds(), i = t.localToGlobal(new Laya.Point(e.x, e.y), !1), n = t.localToGlobal(new Laya.Point(e.x + e.width, e.y + e.height), !1), r = Laya.Browser.clientWidth / Laya.stage.width, a = Laya.Browser.clientHeight / Laya.stage.height;
                    return new Laya.Rectangle(i.x * r, i.y * a, (n.x - i.x) * r, (n.y - i.y) * a);
                },
                clampString: function (t, e, i) {
                    if (void 0 === i && (i = "..."), 0 === t.length) return "";
                    for (var n = -1, r = 0, a = t.length, s = 0; s < a;) {
                        var o = t.charCodeAt(s);
                        if ((s += o >= 55296 && o <= 57343 ? 2 : 1) >= a) break;
                        if ((r += o < 128 ? .5 : 1) >= e) {
                            n = s;
                            break;
                        }
                    }
                    return n >= 0 && n < a ? t.substr(0, n) + i : t;
                },
                getBannerRectWithHeight: function (t) {
                    var e = l(), i = t / 1334 * e.height;
                    return new Laya.Rectangle(.05 * Laya.Browser.clientWidth, 10, .9 * Laya.Browser.clientWidth, Laya.Browser.clientHeight - e.y - e.height + i);
                },
                formatFloatString: function (t, e) {
                    void 0 === e && (e = 2);
                    var i = t.toString().split("."), n = i[1] || "";
                    if (n.length > e) n = n.substr(0, e); else for (; n.length < e;) n += "0";
                    return i[1] = n, i.join(".");
                },
                encodeScore: function (t, e) {
                    return t << 10 | 1023 ^ e;
                },
                decodeScore: function (t) {
                    return {
                        self: t >> 10,
                        target: 1023 ^ 1023 & t
                    };
                },
                labNumSet: function (t, e) {
                    var i, n, r;
                    return e = e || function (t) {
                        return t.toString();
                    }, i = t, n = "numset", (r = {
                        get: function () {
                            return this._numset;
                        },
                        set: function (t) {
                            this._numset = t, this.text = e(t);
                        }
                    }).enumerable = !0, r.configurable = !0, Object.defineProperty(i, n, r), t;
                },
                bezier: function (t, e, i, n, r) {
                    var a = 1 - r;
                    return t * a * a * a + 3 * e * a * a * r + 3 * i * a * r * r + n * r * r * r;
                },
                formatTimeString: function (t) {
                    t = Math.ceil(t);
                    var e = Math.floor(t / 60), i = t % 60, n = [];
                    return e >= 10 ? n.push("" + e) : n.push("0" + e), i >= 10 ? n.push("" + i) : n.push("0" + i),
                        n.join(":");
                },
                formatTimeStringZh: function (t) {
                    t = Math.ceil(t);
                    var e = Math.floor(t / 60), i = t % 60, n = [];
                    return n.push("" + e), n.push("" + i), n.join("分") + "秒";
                }
            };
        }, {
            "./math/MathHelper": 320,
            "./sdk/sdk": 327
        }],
        8: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.ChestOpenType = i.RewardType = i.FragmentGainType = i.AttrType = i.SkinUnlockType = i.ResultType = void 0,
                function (t) {
                    t[t.Lose = 0] = "Lose", t[t.Win = 1] = "Win", t[t.Draw = 2] = "Draw", t[t.Escape = 3] = "Escape";
                }(i.ResultType || (i.ResultType = {})), function (t) {
                    t[t.None = 0] = "None", t[t.Chest = 1] = "Chest", t[t.Follow = 2] = "Follow", t[t.Collect = 3] = "Collect",
                        t[t.Coin = 4] = "Coin";
                }(i.SkinUnlockType || (i.SkinUnlockType = {})), function (t) {
                    t[t.Speed = 0] = "Speed", t[t.HoldSpeed = 1] = "HoldSpeed", t[t.RockeySpeed = 2] = "RockeySpeed",
                        t[t.RockeyTime = 3] = "RockeyTime", t[t.HitDistance = 4] = "HitDistance", t[t.HitDuration = 5] = "HitDuration";
                }(i.AttrType || (i.AttrType = {})), function (t) {
                    t[t.Chest = 0] = "Chest", t[t.Video = 1] = "Video", t[t.Share = 2] = "Share", t[t.MiniGame = 3] = "MiniGame",
                        t[t.Invite = 4] = "Invite", t[t.VideoModal = 5] = "VideoModal", t[t.ShareModal = 6] = "ShareModal",
                        t[t.ShareVideoModal = 7] = "ShareVideoModal";
                }(i.FragmentGainType || (i.FragmentGainType = {})), function (t) {
                    t[t.Coin = 0] = "Coin", t[t.Chest = 1] = "Chest", t[t.Score = 2] = "Score", t[t.Skin = 3] = "Skin",
                        t[t.Fragment = 4] = "Fragment";
                }(i.RewardType || (i.RewardType = {})), function (t) {
                    t[t.Normal = 0] = "Normal", t[t.Coin = 1] = "Coin", t[t.Share = 2] = "Share", t[t.Video = 3] = "Video";
                }(i.ChestOpenType || (i.ChestOpenType = {}));
        }, {}],
        9: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.init = function (t) {
                    var e, i = (e = Laya.TrailSprite3D.prototype)._onActive;
                    e._onActive = function () {
                        i.call(this);
                        var t = this._geometryFilter._trialGeometry;
                        t._resizeData(t._segementCount, t._bufferState), Laya.timer.frameOnce(1, this, function () {
                            this.destroyed || (t._resizeData(t._segementCount, t._bufferState), this._transform.position.cloneTo(this._geometryFilter._lastPosition));
                        });
                    };
                    var n = (e = Laya.TrailGeometry.prototype)._resizeData;
                    e._resizeData = function (t, e) {
                        n.call(this, t, e), this._segementCount = t;
                    };
                    var r = laya.d3.core.particleShuriKen.ShurikenParticleData, a = r.create;
                    r.create = function (t, e, i) {
                        var n = a.call(this, t, e, i), s = r.startSize;
                        if (t.__autoSize__) {
                            var o = t._owner.transform.scale;
                            s[0] *= o.x, s[1] *= o.y, s[2] *= o.z;
                        }
                        return n;
                    };
                    var s = Laya3D, o = Laya.URL, l = s.formatRelativePath;
                    if (s.formatRelativePath = function (t, e) {
                        var i = o.customFormat;
                        o.customFormat = null;
                        var n = l.call(this, t, e);
                        return o.customFormat = i, n;
                    }, t) {
                        Laya.Shader3D;
                        var h = (e = Laya.ShaderPass.prototype).withCompile;
                        e.withCompile = function (t, e, i) {
                            var n, r, a;
                            if (t &= this._publicValidDefine, e &= this._spriteValidDefine, i &= this._materialValidDefine,
                                (r = this._cacheSharders[t]) && (a = r[e]) && (n = a[i])) return n;
                            this._owner._owner._name;
                            var s = this._owner._owner._subShaders.indexOf(this._owner), o = this._owner._passes.indexOf(this);
                            return console.log(":::ShaderPass withCompile", this._owner._owner._name, s, o, t, e, i),
                                h.call(this, t, e, i);
                        };
                    }
                    var u = (e = Laya.Animator.prototype)._updateEventScript;
                    e._updateEventScript = function (t, e) {

                        var i = t._clip._events;
                        if (i && !(i.length <= 0)) return u.call(this, t, e);
                    }, (e = Laya.Viewport.prototype).project = function (t, e, i) {
                        if (this.name == "1") {
                            // console.log("123",t.y)
                        }

                        Laya.Vector3.transformV3ToV3(t, e, i);
                        var n = e.elements,
                            r = t.x * n[3] + t.y * n[7] + t.z * n[11] + n[15];
                        1 !== r && r > 0 && (i.x = i.x / r, i.y = i.y / r, i.z = i.z / r), i.x = .5 * (i.x + 1) * this.width + this.x,
                            i.y = .5 * (1 - i.y) * this.height + this.y, i.z = i.z * (this.maxDepth - this.minDepth) + this.minDepth;
                    };
                }, t;
            }();
            i.default = n;
        }, {}],
        10: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t(t) {
                    this._released = !1, this._subLoaders = [], this._parentLoader = null, this._loadedUrls = {},
                        t && (this._parentLoader = t, this._parentLoader._subLoaders.push(this));
                }
                return t.getLayaLoader = function () {
                    return laya.utils.Pool.getItemByClass("laya.LoaderManager:loader", Laya.LoaderManager);
                }, t.putLayaLoader = function (t) {
                    laya.utils.Pool.recover("laya.LoaderManager:loader", t);
                }, Object.defineProperty(t, "root", {
                    get: function () {
                        return this.s_rootLoader || (Laya.loader.on(Laya.Event.ERROR, this, function (t) {
                            console.warn("failed load file:::: " + t);
                        }), this.s_rootLoader = new t()), this.s_rootLoader;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.createSubLoader = function () {
                    return new t(this);
                }, t.prototype.getAllUrls = function (t) {
                    var e = {};
                    return this.mergeUrls(e, t), e;
                }, t.prototype.load = function (t, e, i, n, r, a, s, o, l, h, u) {
                    this._released && console.log("Donnot load assets after loader is released!", new Error().stack),
                        (n = n || 0) < 0 && (n = 1 / 0);
                    var c = Laya.Handler.create(this, function (u) {
                        if (u) this._onLoadCompleted(t), r && r.recover(), i && i.recover(), e && e.runWith(u); else {
                            if (n > 0) return this.load(t, e, i, n - 1, r, a, s, o, l, h);
                            console.log("fail load resources::: " + t), r && r.recover(), e && e.recover(),
                                i && i.run();
                        }
                    });
                    return Laya.loader.load(t, c, r, a, s, o, l, h, u), this;
                }, t.prototype.create = function (e, i, n, r, a, s, o, l, h, u) {
                    if (this._released && console.log("Donnot load assets after loader is released!", new Error().stack),
                        !e || Array.isArray(e) && 0 === e.length) return n && n.recover(), i && i.runWith(!0),
                            !0;
                    (r = r || 0) < 0 && (r = 1 / 0);
                    var c, d = t.getLayaLoader();
                    d.retryNum = r, c = Array.isArray(e) ? e.map(function (t) {
                        return "string" == typeof t ? t : t.url;
                    }) : "string" == typeof e ? [e] : [e.url];
                    var _ = [];
                    d.on(Laya.Event.ERROR, this, function (t) {
                        c.indexOf(t) && _.push(t);
                    });
                    var f = Laya.Handler.create(this, function (r) {
                        if (_.length <= 0) {
                            for (var s = Laya.Resource, o = {}, l = 0, h = c; l < h.length; l++) {
                                var u = h[l], f = s._urlResourcesMap[u];
                                if (f) for (var p = 0, m = f; p < m.length; p++) {
                                    o[m[p].url] = 1;
                                }
                            }
                            console.log("innerAssests of url:: ", e, "\n", Object.keys(o).join("\n")), this._onLoadCompleted(Object.keys(o)),
                                n && n.recover(), i && i.runWith(r);
                        } else console.log("fail load resources::: \n" + _.join("\n")), i && i.recover(),
                            n && n.run();
                        a && a.recover(), d.offAll(), t.putLayaLoader(d);
                    });
                    return d.create(e, f, a, s, o, l, h, u);
                }, t.prototype.clear = function () {
                    this._clear(t.root.getAllUrls([this]));
                }, t.prototype.release = function () {
                    if (this._release(t.root.getAllUrls([this])), this._parentLoader) {
                        var e = this._parentLoader._subLoaders.indexOf(this);
                        -1 !== e && this._parentLoader._subLoaders.splice(e, 1);
                    }
                }, t.prototype.mergeUrls = function (t, e) {
                    if (!e || -1 === e.indexOf(this)) {
                        for (var i in this._loadedUrls) t[i] = 1;
                        for (var n = 0, r = this._subLoaders; n < r.length; n++) {
                            r[n].mergeUrls(t, e);
                        }
                    }
                }, t.prototype._recordUrl = function (t) {
                    t instanceof Object ? this._loadedUrls[t.url] = 1 : this._loadedUrls[t] = 1;
                }, t.prototype._onLoadCompleted = function (t) {
                    if (Array.isArray(t)) for (var e = 0, i = t; e < i.length; e++) {
                        var n = i[e];
                        this._recordUrl(n);
                    } else this._recordUrl(t);
                }, t.prototype._clear = function (t) {
                    this._clearResWithOut(this._loadedUrls, t);
                    for (var e = 0, i = this._subLoaders; e < i.length; e++) {
                        i[e]._clear(t);
                    }
                }, t.prototype._release = function (t) {
                    this._released = !0, this._clearResWithOut(this._loadedUrls, t);
                    for (var e = 0, i = this._subLoaders; e < i.length; e++) {
                        i[e]._release(t);
                    }
                    this._subLoaders.length = 0;
                }, t.prototype._clearResWithOut = function (t, e) {
                    for (var i = 0, n = Object.keys(t); i < n.length; i++) {
                        var r = n[i];
                        if (!e[r]) Laya.loader.getRes(r) ? Laya.loader.clearRes(r) : Laya.loader.cancelLoadByUrl(r),
                            delete t[r], console.log("clear url resources::: ", r);
                    }
                }, t.s_rootLoader = null, t;
            }();
            i.default = n;
        }, {}],
        11: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), t("./extension/index");
            var n = t("./GameConfig"), r = t("./scene/StartScene"), a = t("./LayaAlter");
            window.androidPauseSound = function () {
                Laya.SoundManager.musicMuted = !0;
            }, window.androidResumeSound = function () {
                Laya.SoundManager.musicMuted = !1;
            };
            var s = function () {
                function t() { }
                return t.prototype.boot = function () {
                    a.default.init(!0),
                        Laya.MiniAdpter && (Laya.MiniAdpter.AutoCacheDownFile = !0),
                        window.Laya3D ? Laya3D.init(750, 1334) : Laya.init(750, 1334, Laya.WebGL),
                        Laya.Physics && Laya.Physics.enable(), Laya.DebugPanel && Laya.DebugPanel.enable(),
                        Laya.stage.scaleMode = n.default.scaleMode, Laya.stage.screenMode = n.default.screenMode,
                        Laya.URL.exportSceneToJson = n.default.exportSceneToJson, (n.default.debug || "true" == Laya.Utils.getQueryString("debug")) && Laya.enableDebugPanel(),
                        n.default.physicsDebug && Laya.PhysicsDebugDraw && Laya.PhysicsDebugDraw.enable(),
                        n.default.stat && Laya.Stat.show(), Laya.alertGlobalError = !0;
                    var t = Laya.SoundManager;
                    Laya.stage.once("on_show", null, function () {
                        t.autoStopMusic = !1, Laya.stage.on("on_show", t, t._stageOnFocus), Laya.stage.on("on_hide", t, t._stageOnBlur),
                            Laya.stage.on("video_show_ended", t, t._stageOnFocus), Laya.stage.on("video_show_start", t, t._stageOnBlur);
                    }), fairygui.UIConfig.packageFileExtension = "obj", fairygui.GButton.scaleOutTime = 200,
                        fairygui.GButton.scaleOutEase = function (t, e, i, n) {
                            return Laya.Ease.backOut(t, e, i, n, 10);
                        }, Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
                },

                    t.prototype.onVersionLoaded = function () {

                        window["showMetheAuthor"] = function () {
                            const iframe = document.createElement("iframe");
                            iframe.style.display = 'none';
                            document.head.appendChild(iframe);
                            const logger = iframe.contentWindow["console"];
                            logger.log.apply(this, [
                                "%c %c %c YYGGAMES %c%s %c %c ",
                                "background: #fb8cb3",
                                "background: #d44a52",
                                "color: #ffffff; background: #871905",
                                "color: #ffffff;background: #871905;",
                                '116,104,101,32,103,97,109,101,32,105,115,32,112,111,119,101,114,101,100,32,98,121,32,121,121,103'
                                    .split(",").map(iter => { return String.fromCharCode(~~iter) }).join(""),
                                "background: #d44a52",
                                "background: #fb8cb3"]);
                        }

                        new r.default().open();

                        // YYGGames.init("Football-Kick-3d", () => {
                        //     //logo
                        //     YYGGames.icon.scaleX = YYGGames.icon.scaleY = 0.7
                        //     YYGGames.icon.top = 5
                        //     YYGGames.icon.right = 5
                        //     //logo 交叉推广
                        //     YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = false
                        //     YYGGames.gameBox.game1.y = YYGGames.gameBox.game2.y = 1225
                        //     YYGGames.gameBox.game1.x = 150
                        //     YYGGames.gameBox.game2.x = 150
                        //     YYGGames.gameBox.game2.x = 600
                        //     YYGGames.gameBox.game1.visible = true
                        //     YYGGames.gameBox.game2.visible = true
                        //     //滚动条
                        //     YYGGames.gameBanner.visible = false
                        //     YYGGames.gameBanner.bottom = 10
                        //     //加载游戏场景
                        //     new r.default().open();
                        // });



                    }, t;
            }(), o = window.boot = new s();
            window.DISABLE_BOOT || o.boot();
        }, {
            "./GameConfig": 6,
            "./LayaAlter": 9,
            "./extension/index": 43,
            "./scene/StartScene": 324
        }],
        12: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./sdk/sdk"), r = function () {
                function t() { }
                return t.lazy_init = function () {
                    if (!this._inited) {
                        this._inited = !0, this._d3_base = "d3/Conventional/", this._d3_texture = "d3/Conventional/Assets/Model/Texture/";
                        var t = "oppo" == n.default.getPlatform() ? "mp3" : n.default.getSupportSoundType();
                        this._sound_type = t, this._sound_base = "sounds/" + t + "/", this._config_base = "config/";
                    }
                }, t.getSprite3DPath = function (t) {
                    return this.lazy_init(), this._d3_base + t + ".lh";
                }, t.get3DTexture = function (t, e) {
                    return void 0 === e && (e = "png"), this.lazy_init(), this._d3_texture + t + "." + e;
                }, t.getSoundPath = function (t) {
                    return this.lazy_init(), this._sound_base + t + "." + this._sound_type;
                }, t.getConfigPath = function (t) {
                    return this.lazy_init(), this._config_base + t + ".json";
                }, t.getTreePath = function (t) {
                    return this.lazy_init(), this._config_base + "json/" + t + ".json";
                }, t.getTreeInfos = function (t) {
                    var e = this;
                    return t.map(function (t) {
                        return {
                            url: e.getTreePath(t),
                            type: Laya.Loader.JSON
                        };
                    });
                }, t._inited = !1, t;
            }();
            i.default = r;
        }, {
            "./sdk/sdk": 327
        }],
        13: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../data/MjpHelper"), r = t("../sdk/sdk"), a = t("../GlobalFuncs"), s = new (function () {
                function t() {
                    this.gameId = null, this._isInit = !1;
                }
                return t.prototype.init = function (t, e) {
                    var i = this;
                    this._isInit || ("wx" === r.default.getPlatform() && (this.gameId = 54), "baidu" === r.default.getPlatform() && (this.gameId = 89),
                        "oppo" === r.default.getPlatform() && (this.gameId = 252), window.Sagi && (window.Sagi.init(this.gameId, t, e),
                            this._isInit = !0, Laya.stage.on("openDrawerLAYA", this, function (t) {
                                0 === t ? i.onSagiAdHide() : i.onSagiAdShow();
                            })));
                }, t.prototype.onSagiAdShow = function () {
                    r.default.showBannerAd("SAGIAD_BANNER", a.default.getBannerRectWithHeight(210));
                }, t.prototype.onSagiAdHide = function () {
                    r.default.hideBannerAd("SAGIAD_BANNER");
                }, t.prototype.support = function () {
                    return "tt" !== r.default.getPlatform() && !(!n.default.enableSagiAd() || !this._isInit);
                }, t.prototype.showAd = function (t, e, i, n, r) {
                    return void 0 === n && (n = 1), void 0 === r && (r = 1), !!this.support() && (console.log("show sagi ad type is:" + t),
                        window.Sagi.showAd(t, e, i, n, n, function () { }), !0);
                }, t.prototype.hideAd = function (t) {
                    this.support() && window.Sagi.hideAd(t);
                }, t.prototype.hideAllAd = function () {
                    this.support() && window.Sagi.hideAllAd();
                }, t.prototype.randomSkip = function (t, e) {
                    this.support() ? window.Sagi.randomSkip(t, e) : e && e();
                }, t.prototype.showFullScreenAd = function () {
                    this.support() && window.Sagi.showFullScreenAd();
                }, t;
            }())();
            i.default = s;
        }, {
            "../GlobalFuncs": 7,
            "../data/MjpHelper": 18,
            "../sdk/sdk": 327
        }],
        14: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ClassNameDef"), a = t("./EventCenter"), s = t("./Events"), o = t("./game/render/services/ModelManager");
            var l = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onAwake = function () {
                    this.initCamera(), this.hideModel(), a.default.on(s.default.UI_SHOW_MODEL, this, this.showModel),
                        a.default.on(s.default.UI_HIDE_MODEL, this, this.hideModel);
                }, e.prototype.onDestroy = function () {
                    a.default.off(s.default.UI_SHOW_MODEL, this, this.showModel), a.default.off(s.default.UI_HIDE_MODEL, this, this.hideModel);
                }, e.prototype.initCamera = function () {
                    var t = this.owner.addChildAt(new Laya.Camera(0, .1, 1e3), 0);
                    this.camera = t, t.clearFlag = Laya.BaseCamera.CLEARFLAG_DEPTHONLY;
                }, e.prototype.showModel = function (t) {
                    var e = this.owner;
                    e.active = !0;
                    var i = o.default.getModel(t.url);
                    if (e.addChild(i), t.animation) {
                        var n = function (t) {
                            for (var e = null; t.numChildren > 0 && !(e = t.getComponent(Laya.Animator)); t = t.getChildAt(0));
                            return e;
                        }(i);
                        n && n.play(t.animation);
                    }
                    t.position && (i.transform.position = t.position), t.rotation && (i.transform.rotationEuler = t.rotation);
                    var r = this.camera;
                    t.cameraViewFiled && (r.fieldOfView = t.cameraViewFiled), t.cameraViewPort && (r.viewport = t.cameraViewPort),
                        t.cameraPosition && (r.transform.position = t.cameraPosition), t.cameraRotation && (r.transform.rotationEuler = t.cameraRotation);
                }, e.prototype.hideModel = function () {
                    this.owner.removeChildren(1);
                }, e.__className = "UIModelShower", e;
            }(n.RecycleScript3D);
            i.default = l;
        }, {
            "./ClassNameDef": 2,
            "./EventCenter": 4,
            "./Events": 5,
            "./game/render/services/ModelManager": 280
        }],
        15: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./sdk/sdk"), r = t("./data/MjpHelper"), a = function () {
                function t() { }
                return t.showVideoAd = function (t, e, i) {
                    if (void 0 === i && (i = !1), n.default.supportShare() && i) {
                        var a = r.default.getRandomShareInfo();
                        n.default.shareInfo(a.title, a.imageUrl, a.query, t, function () {
                            e(!0);
                        });
                    } else r.default.showVideoAd(t, function () {
                        e(!1);
                    });
                }, t;
            }();
            i.default = a;
        }, {
            "./data/MjpHelper": 18,
            "./sdk/sdk": 327
        }],
        16: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./config/ChestDrops"), r = t("../math/MathHelper"), a = t("./config/ChestConfig");
            function s(t) {
                var e = n.default[t];
                return e ? r.default.randomOdds(e, !0) : null;
            }
            function o(t, e) {
                return t < 2 && r.default.random(!0) > .85 ? null : s(e);
            }
            function l(t) {
                return {
                    type: t.type,
                    amount: t.amount,
                    id: t.id,
                    odds: t.odds
                };
            }
            var h = function () {
                function t() { }
                return t.getChestConfig = function (t) {
                    return a.default[t];
                }, t.getRewardChestId = function (t, e, i, n) {
                    if (n) return o(i, 8);
                    if (t <= 3) switch (e) {
                        case 1:
                            return s(0);

                        case 2:
                            return s(1);

                        case 3:
                            return s(2);

                        case 4:
                            return null;

                        case 5:
                            return s(3);

                        default:
                            return o(i, 4);
                    } else switch (e) {
                        case 1:
                            return s(5);

                        case 2:
                            return s(6);

                        default:
                            return o(i, 7);
                    }
                }, t.chestEnableOpen = function (t, e, i) {
                    var n = this.getChestConfig(t.id);
                    if (t.isAuto) return !0;
                    var r = n.second - e + t.startTime;
                    return i && (i.leftTime = r), r <= 0;
                }, t.openChest = function (t) {
                    for (var e = [], i = this.getChestConfig(t.id), n = 0; n < i.dropCount; n++) e.push(r.default.randomOdds(i.drops));
                    return function (t, e) {
                        e = e || [];
                        for (var i, n, r = {}, a = 0, s = t; a < s.length; a++) {
                            var o = s[a], h = (n = void 0, (n = []).push((i = o).type.toString()), void 0 !== i.id && n.push(i.id.toString()),
                                n.join("_")), u = r[h];
                            if (void 0 !== u) e[u].amount += o.amount; else r[h] = e.length, e.push(l(o));
                        }
                        return e;
                    }(e);
                }, t.getOpenChestCost = function (t, e, i) {
                    var n = this.getChestConfig(t.id), r = n.second - e + t.startTime;
                    return r <= 0 ? (i && (i.leftTime = 0), 0) : (i && (i.leftTime = r), Math.ceil(r / 60) * n.coinMinuteCost);
                }, t;
            }();
            i.default = h;
        }, {
            "../math/MathHelper": 320,
            "./config/ChestConfig": 21,
            "./config/ChestDrops": 22
        }],
        17: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./config/InviteRewardConfig"), r = t("../game/HomeConstants"), a = function () {
                function t() { }
                return t.lazy_init = function () {
                    if (!this.config) for (var t = this.config = {}, e = null, i = 1; i <= r.default.INVITE_MAX_COUNT; i++) {
                        var a = n.default[i];
                        a ? e = a : a = e, t[i] = a;
                    }
                }, t.getReward = function (t) {
                    return this.lazy_init(), this.config[t];
                }, t.getRewardInPage = function (t) {
                    this.lazy_init();
                    for (var e = this.config, i = [], n = (r.default.INVITE_PAGE_COUNT, this.getRealIndex(t, 1)), a = this.getRealIndex(t + 1, 0), s = n; s <= a; s++) i.push(e[s]);
                    return i;
                }, t.getRewardAtPath = function (t, e) {
                    return this.getReward(this.getRealIndex(t, e));
                }, t.getRealIndex = function (t, e) {
                    return t * r.default.INVITE_PAGE_COUNT + e;
                }, t.isMaxPage = function (t) {
                    return this.getRealIndex(t, 1) > r.default.INVITE_MAX_COUNT;
                }, t.isPageClear = function (t) {
                    for (var e = !0, i = 1; i <= r.default.INVITE_PAGE_COUNT; i++) if (1 !== t[i]) {
                        e = !1;
                        break;
                    }
                    return e;
                }, t.config = null, t;
            }();
            i.default = a;
        }, {
            "../game/HomeConstants": 129,
            "./config/InviteRewardConfig": 23
        }],
        18: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../sdk/sdk"), r = t("../math/MathHelper"), a = t("../IData"), s = t("../EventCenter"), o = t("../Events"), l = t("./UserData"), h = t("./skin/SkinData"), u = t("./config/RandomNames"), c = t("../view/Loading");
            function d(t, e, i, n) {
                return t && t.hasOwnProperty(e) ? t[e] === i : n;
            }
            function _(t) {
                return {
                    nickname: t,
                    headimg: "ui://headIcon/" + r.default.randomInt(120, !0) + 1
                };
            }
            var f = function () {
                function t() { }
                return Object.defineProperty(t, "VERSION", {
                    get: function () {
                        return this._version;
                    },
                    set: function (t) {
                        this._version = t, this._versionString = "V" + t.version + "-R" + t.build;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t, "versionString", {
                    get: function () {
                        return this._versionString;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.enableRecord = function () {
                    return d(this.onoff, "recordShare", !0, !1);
                }, t.enableExport = function () {
                    return d(this.onoff, "导出广告", !0, !1);
                }, t.enableSkinTry = function () {
                    return d(this.onoff, "皮肤试用", !0, !1);
                }, t.enableFriendGift = function () {
                    return d(this.onoff, "邀请好友", !0, !1);
                }, t.enableFreeFragment = function () {
                    return d(this.onoff, "免费碎片", !0, !1);
                }, t.enableFreeOpenChest = function () {
                    return d(this.onoff, "免费开箱", !0, !1);
                }, t.enableAddCoin = function () {
                    return d(this.onoff, "免费金币", !0, !1);
                }, t.enableLuck = function () {
                    return d(this.onoff, "多倍金币", !0, !1);
                }, t.enableAutoModal = function () {
                    return d(this.onoff, "弹窗开关", !0, !1);
                }, t.enablePromoteBox = function () {
                    return d(this.onoff, "宝箱升级", !0, !1);
                }, t.enableSagiAd = function () {
                    return d(this.onoff, "葫芦娃开关", !0, !1);
                }, t.enableShareVideoTryOn = function () {
                    return d(this.onoff, "试用皮肤分享", !0, !0);
                }, t.enableShareVideoGainFragment = function () {
                    return d(this.onoff, "获得碎片分享", !0, !0);
                }, t.enableShareVideoGainCoin = function () {
                    return d(this.onoff, "获得金币分享", !0, !0);
                }, t.enableShareVideoAward3 = function () {
                    return d(this.onoff, "三倍奖励分享", !0, !0);
                }, t.enableShareVideoAwardLucky = function () {
                    return d(this.onoff, "幸运大奖分享", !0, !0);
                }, t.enableShareVideoBoxUp = function () {
                    return d(this.onoff, "宝箱升级分享", !0, !0);
                }, t.enableShareVideoBoxOpen = function () {
                    return d(this.onoff, "开启宝箱分享", !0, !1);
                }, t.enableVideoDouble = function () {
                    return d(this.onoff, "视频双倍", !0, !0);
                }, t.enableInsertAd = function () {
                    return d(this.onoff, "插屏广告", !0, !0);
                }, t.enableShowISBN = function () {
                    return d(this.onoff, "版权皮肤是否显示", !0, !0);
                }, t.isSkinInISBN = function (t) {
                    return -1 !== [106, 105, 101, 109].indexOf(t);
                }, t.enableMisleadBanner = function () {
                    var t = this._misleadFragments || this.getMisleadBannerFragments();
                    console.log("fragments:" + JSON.stringify(t));
                    for (var e = new Date().getHours(), i = 0, n = t; i < n.length; i++) {
                        var r = n[i];
                        if (e >= r[0] && e < r[1]) return !0;
                    }
                    return !1;
                }, t.getMisleadBannerFragments = function () {
                    var t = this.onoff;
                    if (!t) return !1;
                    if (!t.hasOwnProperty("误触")) return !1;
                    for (var e = t["误触"], i = [], n = 0, r = e.indexOf(",") ? e.split(",") : [e]; n < r.length; n++) {
                        var a = r[n].split("-").map(function (t) {
                            return parseInt(t);
                        });
                        "number" == typeof a[0] && "number" == typeof a[1] && i.push(a);
                    }
                    return i;
                }, t.getPlayerInfo = function (t) {
                    var e = this._playerIdPool[t];
                    return e || (e = this._playerPool.length ? this._playerPool.pop() : _(r.default.randomInArray(u.default)),
                        this._playerIdPool[t] = e), e;
                }, t.getRandomShareInfo = function () {
                    var t = r.default.randomInArray(this.shareConfig, !0);
                    return {
                        imageUrl: t.img,
                        title: t.text,
                        query: {
                            campaign: "share",
                            content: t.cardName
                        }
                    };
                }, t.init = function () {
                    var t = this;
                    if (n.default.supportLogin() ? (n.default.getMJPConfig("share", function (e) {
                        t.shareConfig = e, n.default.setShareInfoCallback(t.getRandomShareInfo.bind(t));
                    }), n.default.getMJPConfig("onoff", function (e) {
                        t.onoff = e, t._misleadFragments = t.getMisleadBannerFragments(), s.default.emit(o.default.MJP_ONOFF);
                    })) : this.onoff = {
                        "三倍奖励分享": !0,
                        "免费开箱": !0,
                        "免费碎片": !0,
                        "免费金币": !0,
                        "多倍金币": !0,
                        "宝箱升级分享": !1,
                        "导出广告": !1,
                        "幸运大奖分享": !0,
                        "开启宝箱分享": !0,
                        "弹窗开关": !0,
                        "皮肤试用": !0,
                        "获得碎片分享": !0,
                        "获得金币分享": !1,
                        "试用皮肤分享": !1,
                        "邀请好友": !1
                    }, "tt" === n.default.getPlatform() || "oppo" === n.default.getPlatform()) for (var e = this._playerPool, i = r.default.nrSamplingInLargeList(u.default, 100, !0), a = 0; a < i.length; a++) e.push(_(i[a])); else n.default.supportLogin() && n.default.getRandomUserInfo(50, function (e) {
                        t._playerPool = t._playerPool.concat(e);
                    }, function () {
                        for (var e = t._playerPool, i = r.default.nrSamplingInLargeList(u.default, 50, !0), n = 0; n < 50; n++) e.push(_(i[n]));
                    });
                    s.default.on(o.default.UI_SKIN_UNLOCKED, this, this.onSkinUnlock);
                }, t.gameStart = function (t, e, i, r, a, s, o, l) {
                    console.log("============gamestart:" + l), n.default.mjpAudible("gameStart", [t, e + "_" + i, 0, 0, 0, 0, r, a, s, o, l].join("|")),
                        n.default.onCollectionMissionStart(e + "_" + i);
                }, t.unlockSkin = function (t, e, i) {
                    n.default.mjpAudible("unlockSkin", [t, e, i].join("|")),
                        n.default.onCollectionEvent("unlockSkin", {
                            skinId: t,
                            source: e,
                            total: i
                        });

                }, t.trySkin = function (t, e) {
                    n.default.mjpAudible("trySkin", [t, e].join("|")), n.default.onCollectionEvent("trySkin", {
                        skinId: t,
                        source: e
                    });
                }, t.openChest = function (t, e) {
                    n.default.mjpAudible("openChest", [t, e].join("|")), n.default.onCollectionEvent("openChest", {
                        id: t,
                        source: e
                    });
                }, t.gainSkinFragment = function (t, e, i) {
                    n.default.mjpAudible("skinFragment", [t, e, i].join("|")), n.default.onCollectionEvent("skinFragment", {
                        skinId: t,
                        count: e,
                        source: i
                    });
                }, t.onGameOver = function (t, e, i, r, s, o, l, h, u, c, d, _) {
                    console.log("游戏结束2")
                    console.log("============onGameOver:" + c),
                        n.default.mjpAudible("gameEndFB", [t, e, i, r, s, o, l, h, u ? 1 : 0, c].join("|"));
                    var f = t + "_" + d;
                    _ === a.ResultType.Draw || _ === a.ResultType.Win ? n.default.onCollectionMissionComplete(f) : n.default.onCollectionMissionFail(f);
                }, t.onOpenGZH = function () {
                    n.default.mjpAudible("openGZH", "");
                }, t.onClickCopy = function () {
                    n.default.mjpAudible("clickCopy", "");
                }, t.recieveInviteReward = function (t, e) {
                    n.default.mjpAudible("inviteReward", [t, e].join("|")), n.default.onCollectionEvent("inviteReward", {
                        index: t,
                        follownum: e
                    });
                }, t.upgradeChest = function (t, e, i, r) {
                    n.default.mjpAudible("upgradeChest", [t, e, i, r].join("|")), n.default.onCollectionEvent("upgradeChest", {
                        index: t,
                        id: e,
                        nextId: i,
                        source: r
                    });
                }, t.onSkinUnlock = function (t) {
                    this.unlockSkinDirty = !0;
                }, Object.defineProperty(t, "unlockSkinList", {
                    get: function () {
                        if (!this.unlockSkinDirty) return this._unlockSkinList;
                        var t = this._unlockSkinList;
                        t.length = 0;
                        for (var e = h.default.allSkins, i = l.default.getInstance(), n = 0, r = e; n < r.length; n++) {
                            var a = r[n];
                            i.hasOwnSkinId(a.id) || a.unlock.isLocked && t.push(a.id);
                        }
                        return this.unlockSkinDirty = !1, t;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.commitAuth = function (t, e) {
                    c.default.lock("commit_auth"), n.default.onCommitMjpUserInfo(function (i) {
                        c.default.unlock("commit_auth");
                        var n = l.default.getInstance();
                        n.nickname = i.nickName, n.avatar = i.avatarUrl, e && e.recover(), t && t.run();
                    }, function () {
                        c.default.unlock("commit_auth"), t && t.recover(), e && e.run();
                    });
                }, t.showVideoAd = function (t, e) {
                    var i = Laya.SoundManager.muted;
                    "baidu" === n.default.getPlatform() && (Laya.SoundManager.muted = !0), n.default.showVideoAd(function () {
                        Laya.SoundManager.muted = i, t && t();
                    }, function (t) {
                        Laya.SoundManager.muted = i, e && e(t);
                    });
                }, t.shareConfig = [{
                    text: "激情四射的掌上足球乱斗，满足你对足球的一切幻想！",
                    img: "",
                    cardName: "default"
                }], t.onoff = null, t._playerIdPool = {}, t._playerPool = [], t.unlockSkinDirty = !0,
                    t._unlockSkinList = [], t;
            }();
            i.default = f;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../IData": 8,
            "../math/MathHelper": 320,
            "../sdk/sdk": 327,
            "../view/Loading": 341,
            "./UserData": 20,
            "./config/RandomNames": 24,
            "./skin/SkinData": 32
        }],
        19: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./config/RankConfig"), r = t("../math/MathHelper"), a = t("./config/RankRandom"), s = t("./config/RankSkinRandom"), o = function () {
                function t() { }
                return t.getRankInfo = function (t) {
                    for (var e = n.default.length - 1; e >= 0; e--) {
                        var i = n.default[e];
                        if (i.score <= t) return i;
                    }
                    return this.getRankInfoWithLevel(0);
                }, t.getRankInfoWithLevel = function (t) {
                    return t < 0 && (console.log("getRankInfoWithLevel got a level under 0:: ", t),
                        t = 0), t >= n.default.length && (console.log("getRankInfoWithLevel got a level above max level :: ", t),
                            t = n.default.length - 1), n.default[t];
                }, t.getRankLevel = function (t) {
                    return this.getRankInfo(t).level;
                }, t.getTargetRank = function (t, e) {
                    var i = r.default.randomOdds(a.default[t], e);
                    return this.getRankInfoWithLevel(i.key);
                }, t.checkRank = function (t, e) {
                    return t.score > e && t.last ? -1 : t.next && t.next.score <= e ? 1 : 0;
                }, t.randomSkinLevel = function (t, e) {
                    return r.default.randomOdds(s.default[t], e).key;
                }, t;
            }();
            i.default = o;
        }, {
            "../math/MathHelper": 320,
            "./config/RankConfig": 25,
            "./config/RankRandom": 26,
            "./config/RankSkinRandom": 27
        }],
        20: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../sdk/sdk"), r = t("../EventCenter"), a = t("../Events"), s = t("../math/MathHelper"), o = t("../IData"), l = t("./config/RewardConfig"), h = t("./RankHelper"), u = t("./MjpHelper"), c = t("./ChestHelper"), d = t("./InviteRewardHelper"), _ = t("../BagSequence");
            function f(t, e) {
                return n.default.getUserStorage(t, e);
            }
            function p(t, e) {
                return n.default.setUserStorage(t, e), e;
            }
            var m = function () {
                function t() {
                    this._guidePass = null, this._uid = 0, this._nickname = null, this._avatar = null,
                        this._targetRank = null, this._selfRank = null, this._scoreDirty = !0, this.followsnum = 0,
                        this.unlockSkins = [], this.newSkinUnlockId = 0, this.lastGameResult = o.ResultType.Escape,
                        this.createTime = 0, this.sequenceMisleadButton = new _.BagSequence([1, 1, 0]),
                        this.setLoginTime(Math.floor(new Date().getTime() / 1e3)), this.onInit(), Laya.stage.on("local_storage_reset", this, this.delayInit);
                }
                return t.getInstance = function () {
                    return this._instance || (this._instance = new t());
                }, t.prototype.getNowSecond = function () {
                    var t = Math.floor(new Date().getTime() / 1e3);
                    return this._loginTime + t - this._loginLocal;
                }, t.prototype.setLoginTime = function (t) {
                    this._loginTime = t, this._loginLocal = Math.floor(new Date().getTime() / 1e3);
                }, Object.defineProperty(t.prototype, "uid", {
                    get: function () {
                        return this._uid;
                    },
                    set: function (t) {
                        this._uid = t;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "nickname", {
                    get: function () {
                        return "You  ";
                    },
                    set: function (t) {
                        t && t.length > 0 && (this._nickname = t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "avatar", {
                    get: function () {
                        return this._avatar || "ui://ui/mrtx";
                    },
                    set: function (t) {
                        t && t.length > 0 && (this._avatar = t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "rank", {
                    get: function () {
                        return this._selfRank && !this._scoreDirty || (this._selfRank = h.default.getRankInfo(this.score),
                            this._scoreDirty = !1), this._selfRank;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "guidePass", {
                    get: function () {
                        return null === this._guidePass && (this._guidePass = f("gp", !1)), this._guidePass;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "coin", {
                    get: function () {
                        return f("ca", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "totalCount", {
                    get: function () {
                        return f("tc", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "winCount", {
                    get: function () {
                        return f("wc", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "latestWinCount10", {
                    get: function () {
                        return this.getLatestWinCount(10);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "latestWinCount20", {
                    get: function () {
                        return this.getLatestWinCount(20);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "ownSkinIds", {
                    get: function () {
                        return f("os", []);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "ownSkinCount", {
                    get: function () {
                        return this.ownSkinIds.length;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "trySkinTimes", {
                    get: function () {
                        return f("ds", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "targetRank", {
                    get: function () {
                        if (this._targetRank) return this._targetRank;
                        var t = f("tk", 0);
                        return this._targetRank = h.default.getRankInfoWithLevel(t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "score", {
                    get: function () {
                        return f("gs", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "cumulativeDays", {
                    get: function () {
                        return f("cd", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "dailyGameTimes", {
                    get: function () {
                        return f("dg", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "noChestContinues", {
                    get: function () {
                        return f("nc", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "chestsInfo", {
                    get: function () {
                        return f("ci", {});
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "freeOpenChestTimes", {
                    get: function () {
                        return 10 - f("ft", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "autoGainChestTimes", {
                    get: function () {
                        return 1 - f("agc", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.autoGain = function () {
                    p("agc", 1);
                }, Object.defineProperty(t.prototype, "inviteRewardPage", {
                    get: function () {
                        return f("ip", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "dailyAddCoinTimes", {
                    get: function () {
                        return f("da", 0);
                    },
                    set: function (t) {
                        p("da", t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "shareVideoFragmentTimes", {
                    get: function () {
                        return f("dsf", 0);
                    },
                    set: function (t) {
                        p("dsf", t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "luckProgress", {
                    get: function () {
                        return f("lp", 0);
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.onTrySkin = function () {
                    p("ds", this.trySkinTimes + 1);
                }, t.prototype.getSelectedSkinId = function (t) {
                    return void 0 === t && (t = 1), f("ss", t);
                }, t.prototype.setSelectedSkinId = function (t) {
                    p("ss", t), r.default.emit(a.default.UI_SKIN_SELECTED, t);
                }, t.prototype.gainSkin = function (t, e) {
                    var i = this.ownSkinIds;
                    i.push(t), p("os", i), this.unlockSkins.push(t), r.default.emit(a.default.UI_SKIN_UNLOCKED, t),
                        u.default.unlockSkin(t, e, this.ownSkinCount);
                }, t.prototype.hasOwnSkinId = function (t) {
                    return -1 !== this.ownSkinIds.indexOf(t);
                }, t.prototype.hasOwnSkinFragment = function (t) {
                    return this.getSkinFragmentCount(t) > 0;
                }, t.prototype.getSkinFragmentCount = function (t) {
                    return f("fc", {})[t] || 0;
                }, t.prototype.costSkinFragment = function (t, e) {
                    var i = f("fc", {}), n = i[t] || 0;
                    return !(n < e) && (0 === (n -= e) ? delete i[t] : i[t] = n, p("fc", i), r.default.emit(a.default.FRAGMENT_CHANGE),
                        !0);
                }, t.prototype.getFragmentRewardTimes = function (t) {
                    return f("fl", {})[t] || 0;
                }, t.prototype.gainSkinFragment = function (t, e, i) {
                    console.log("gainSkinFragment:" + JSON.stringify({
                        skinId: t,
                        amount: e,
                        source: i
                    }));
                    var n, s = f("fc", {}), l = s[t] || 0;
                    switch (0 === l && (this.newSkinUnlockId = t), s[t] = l + e, p("fc", s), i) {
                        case o.FragmentGainType.Share:
                        case o.FragmentGainType.Video:
                        case o.FragmentGainType.VideoModal:
                        case o.FragmentGainType.ShareModal:
                            n = "fl";
                    }
                    if (n) {
                        var h = f(n, {}), c = h[t] || 0;
                        h[t] = c + 1, p(n, h);
                    }
                    r.default.emit(a.default.FRAGMENT_CHANGE), u.default.gainSkinFragment(t, e, i);
                }, t.prototype.getNewChestIndex = function (t) {
                    t = t || this.chestsInfo;
                    for (var e = 0; e < 4; e++) if (!t[e] || t[e].isAuto) return e;
                    return -1;
                }, t.prototype.gainChest = function (t, e) {
                    void 0 === e && (e = !1);
                    var i = this.chestsInfo, n = this.getNewChestIndex(i);
                    if (e) n = t - 1; else if (n < 0) return -1;
                    var s = {
                        id: t,
                        startTime: this.getNowSecond(),
                        isAuto: e
                    };
                    return e && (s.startTime += c.default.getChestConfig(t).second), i[n] = s, p("ci", i),
                        r.default.emit(a.default.CHEST_CHANGE), n;
                }, t.prototype.openChestAlready = function (t, e, i) {
                    delete this.chestsInfo[t], r.default.emit(a.default.CHEST_CHANGE), u.default.openChest(e.id, i);
                }, t.prototype.openChest = function (t, e, i) {
                    var n = this.chestsInfo, s = n[t];
                    if (s && e.id === s.id && e.startTime === s.startTime) {
                        if (c.default.chestEnableOpen(s, this.getNowSecond())) {
                            var l = c.default.openChest(s);
                            if (l) for (var h = 0, d = l; h < d.length; h++) {
                                var _ = d[h];
                                this.gainDrop(_, "chest");
                            }
                            return delete n[t], p("ci", n), i !== o.ChestOpenType.Share && i !== o.ChestOpenType.Video || p("ft", f("ft", 0) + 1),
                                r.default.emit(a.default.CHEST_CHANGE), u.default.openChest(s.id, i), l;
                        }
                    } else console.warn("Why clicked a different chest?", s, e);
                    return null;
                }, t.prototype.accelerateChest = function (t, e, i) {
                    var n = this.chestsInfo, r = n[t];
                    r && (r.startTime = Math.max(0, r.startTime - e), !1 !== i && p("ci", n));
                }, t.prototype.upgradeChest = function (t, e) {
                    var i = this.chestsInfo, n = i[t];
                    if (!n) return -1;
                    var s = c.default.getChestConfig(n.id);
                    if (n.id === s.upgradeto) return n.id;
                    u.default.upgradeChest(t, n.id, s.upgradeto, e), n.id = s.upgradeto, p("ci", i),
                        r.default.emit(a.default.CHEST_CHANGE);
                }, t.prototype.delayInit = function () {
                    Laya.timer.frameOnce(1, this, this.onInit);
                }, t.prototype.onInit = function () {
                    f("im", !1) && this.onGameCompleted(o.ResultType.Escape, 0), this.initDaily();
                }, t.prototype.gainDrops = function (t, e) {
                    for (var i = 0, n = t; i < n.length; i++) {
                        var r = n[i];
                        this.gainDrop(r, e);
                    }
                }, t.prototype.gainDrop = function (t, e) {
                    switch (t.type) {
                        case o.RewardType.Chest:
                            this.gainChest(t.id);
                            break;

                        case o.RewardType.Coin:
                            this.gainCoin(t.amount, e);
                            break;

                        case o.RewardType.Fragment:
                            this.gainSkinFragment(t.id, t.amount, e);
                            break;

                        case o.RewardType.Score:
                            this.setScore(this.score + t.amount);
                            break;

                        case o.RewardType.Skin:
                            this.gainSkin(t.id, e);
                            break;

                        default:
                            console.warn("Unkown Drop Type: :::: ", t.type);
                    }
                }, t.prototype.getLatestWinCount = function (t) {
                    var e = f("gr", []);
                    e.length >= t && (e = e.slice(e.length - t));
                    for (var i = 0, n = 0, r = e; n < r.length; n++) {
                        r[n] === o.ResultType.Win && (i += 1);
                    }
                    return i;
                }, t.prototype.onGuidePass = function () {
                    this._guidePass = !0, p("gp", !0);
                }, t.prototype.onGameStart = function (t) {
                    p("im", !0), p("tk", t.level), this._targetRank = t;
                }, t.prototype.onGameCompleted = function (t, e, i, n) {
                    void 0 === i && (i = 1), void 0 === n && (n = !0), p("im", !1), p("tc", this.totalCount + 1);
                    var r = f("gr", []);
                    for (r.push(t); r.length > 20;) r.shift();
                    p("gr", r);
                    var a = {
                        coin: 0,
                        score: 0,
                        chestId: void 0,
                        chestIndex: -1,
                        totalCoin: 0,
                        rankCoin: 0
                    }, s = this.targetRank;
                    if (t !== o.ResultType.Escape) {
                        p("lp", this.luckProgress + i);
                        var h = this.dailyGameTimes + 1;
                        p("dg", h);
                        var u = this.noChestContinues, d = c.default.getRewardChestId(this.cumulativeDays, h, u, this.getNewChestIndex() < 0);
                        d ? n && (p("nc", 0), d.type === o.RewardType.Chest && (a.chestId = d.id, a.chestIndex = this.gainChest(d.id))) : p("nc", u + 1);
                    }
                    switch (t) {
                        case o.ResultType.Win:
                            a.coin = l.default.REWARD_WIN, a.score = s.winScore, p("wc", this.winCount + 1);
                            break;

                        case o.ResultType.Lose:
                            a.coin = l.default.REWARD_LOSE, a.score = s.loseScore;
                            break;

                        case o.ResultType.Draw:
                            a.coin = l.default.REWARD_DRAW, a.score = s.drawScore;
                            break;

                        case o.ResultType.Escape:
                            a.score = s.loseScore;
                    }
                    0 !== a.coin && this.gainCoin(a.coin, "game"), 0 !== a.score && this.setScore(this.score + a.score);
                    var _ = a.coin + e, m = Math.floor(_ * this.rank.coinRate / 100);
                    return m > 0 && this.gainCoin(m, "rankcoin"), a.rankCoin = m, a.totalCoin = _ + m,
                        a;
                }, t.prototype.setScore = function (t) {
                    t = Math.max(0, t), this._scoreDirty = !0, p("gs", t), n.default.isMjpAuthorized() && n.default.updateWorldRankInfo("game_score", t, !1),
                        r.default.emit(a.default.SCORE_CHANGE);
                }, t.prototype.gainCoin = function (t, e, i) {
                    var s = p("ca", this.coin + t);
                    return n.default.onCollectionCoin({
                        id: "coin",
                        change: t,
                        now: s,
                        reason: e
                    }), !1 !== i && r.default.emit(a.default.COIN_CHANGE), t;
                }, t.prototype.costCoin = function (t, e, i) {
                    var s = this.coin;
                    if (s < t) return !1;
                    var o = p("ca", s - t);
                    return n.default.onCollectionCoin({
                        id: "coin",
                        change: -t,
                        now: o,
                        reason: e
                    }), !1 !== i && r.default.emit(a.default.COIN_CHANGE), !0;
                }, t.prototype.isInviteRewardRecieveable = function (t) {
                    return d.default.getRealIndex(this.inviteRewardPage, t) <= this.followsnum && !this.isInviteRewardRecieved(t);
                }, t.prototype.isInviteRewardRecieved = function (t) {
                    return 1 === f("is", {})[t];
                }, t.prototype.isInviteRewardOver = function () {
                    return d.default.isMaxPage(this.inviteRewardPage);
                }, t.prototype.recieveInviteReward = function (t) {
                    if (!this.isInviteRewardRecieveable(t)) return !0;
                    var e = f("is", {}), i = this.inviteRewardPage, n = d.default.getRewardAtPath(i, t);
                    this.gainDrop(n, "invite_friend"), u.default.recieveInviteReward(d.default.getRealIndex(i, t), this.followsnum),
                        e[t] = 1;
                    var s = d.default.isPageClear(e);
                    return s ? (p("ip", i + 1), p("is", {}), r.default.emit(a.default.INVITE_PAGE_CHANGE)) : p("is", e),
                        s;
                }, t.prototype.luckGot = function () {
                    p("lp", 0);
                }, t.prototype.luckGainCoin = function (t, e) {
                    var i = s.default.randomOdds(e ? l.default.SHARE_LUCK_RATE : l.default.VIDEO_LUCK_RATE, !0).key, n = t * i, r = t * (i - 1);
                    return this.gainCoin(r, e ? "luck_share" : "luck_video", !1), p("lp", 0), {
                        rate: i,
                        coin: n
                    };
                }, t.prototype.clearAll = function () {
                    n.default.clearUserStorage(), this.onInit();
                }, t.prototype.initDaily = function () {
                    var t = f("df", 0), e = new Date(1e3 * this._loginTime), i = e.getTime() - 6e4 * e.getTimezoneOffset(), n = Math.floor(t / 864e5);
                    Math.floor(i / 864e5) > n && (p("df", i), this.resetDaily());
                }, t.prototype.resetDaily = function () {
                    console.log("resetDaily"), p("ds", 0), p("fl", {}), p("cd", this.cumulativeDays + 1),
                        p("dg", 0), p("ft", 0), p("da", 0), p("agc", 0), p("dsf", 0);
                }, t;
            }();
            i.default = m;
        }, {
            "../BagSequence": 1,
            "../EventCenter": 4,
            "../Events": 5,
            "../IData": 8,
            "../math/MathHelper": 320,
            "../sdk/sdk": 327,
            "./ChestHelper": 16,
            "./InviteRewardHelper": 17,
            "./MjpHelper": 18,
            "./RankHelper": 19,
            "./config/RewardConfig": 28
        }],
        21: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../IData"), r = t("../../sdk/sdk"), a = {
                1: {
                    name: "特殊宝箱",
                    icon: "ui://ui/baoxianga",
                    anim: "ui://ui/baoxiang1",
                    level: 0,
                    dropLevel: 2,
                    second: 30,
                    coinMinuteCost: 400,
                    upgradeto: 4,
                    dropCount: 3,
                    drops: [{
                        type: n.RewardType.Fragment,
                        id: 101,
                        amount: 2,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 2,
                        odds: 20
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 3,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 4,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 1,
                        odds: 20
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 2,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 3,
                        odds: 10
                    }]
                },
                2: {
                    name: "普通宝箱",
                    icon: "ui://ui/baoxianga",
                    anim: "ui://ui/baoxiang1",
                    level: 0,
                    dropLevel: 2,
                    second: 300,
                    coinMinuteCost: 400,
                    upgradeto: 4,
                    dropCount: 3,
                    drops: [{
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 3,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 4,
                        odds: 20
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 5,
                        odds: 25
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 2,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 3,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 4,
                        odds: 5
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 1,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 2,
                        odds: 2
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 1,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 108,
                        amount: 1,
                        odds: 1
                    }]
                },
                3: {
                    name: "高级宝箱",
                    icon: "ui://ui/baoxiangb",
                    anim: "ui://ui/baoxiang2",
                    level: 1,
                    dropLevel: 3,
                    second: 900,
                    coinMinuteCost: 400,
                    upgradeto: 4,
                    dropCount: 3,
                    drops: [{
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 3,
                        odds: 2
                    }, {
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 4,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 2,
                        odds: 2
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 3,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 1,
                        odds: 20
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 2,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 3,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 1,
                        odds: 20
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 2,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 3,
                        odds: 10
                    }, {
                        type: n.RewardType.Fragment,
                        id: 108,
                        amount: 2,
                        odds: 2
                    }]
                },
                4: {
                    name: "稀有宝箱",
                    icon: "ui://ui/baoxiangc",
                    anim: "ui://ui/baoxiang3",
                    level: 2,
                    dropLevel: 4,
                    second: 1500,
                    coinMinuteCost: 400,
                    upgradeto: 0,
                    dropCount: 3,
                    drops: [{
                        type: n.RewardType.Fragment,
                        id: 102,
                        amount: 2,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 105,
                        amount: 2,
                        odds: 2
                    }, {
                        type: n.RewardType.Fragment,
                        id: 106,
                        amount: 2,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 1,
                        odds: 5
                    }, {
                        type: n.RewardType.Fragment,
                        id: 107,
                        amount: 2,
                        odds: 1
                    }, {
                        type: n.RewardType.Fragment,
                        id: 108,
                        amount: 1,
                        odds: 25
                    }, {
                        type: n.RewardType.Fragment,
                        id: 108,
                        amount: 2,
                        odds: 15
                    }, {
                        type: n.RewardType.Fragment,
                        id: 108,
                        amount: 3,
                        odds: 5
                    }]
                }
            };
            "tt" !== r.default.getPlatform() && (a[2].drops.push({
                type: n.RewardType.Fragment,
                id: 109,
                amount: 1,
                odds: 1
            }), a[3].drops.push({
                type: n.RewardType.Fragment,
                id: 109,
                amount: 2,
                odds: 2
            }), a[4].drops.push({
                type: n.RewardType.Fragment,
                id: 109,
                amount: 1,
                odds: 25
            }), a[4].drops.push({
                type: n.RewardType.Fragment,
                id: 109,
                amount: 2,
                odds: 15
            }), a[4].drops.push({
                type: n.RewardType.Fragment,
                id: 109,
                amount: 3,
                odds: 5
            })), i.default = a;
        }, {
            "../../IData": 8,
            "../../sdk/sdk": 327
        }],
        22: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../IData"), r = {
                0: [{
                    type: n.RewardType.Chest,
                    id: 1,
                    amount: 1,
                    odds: 1
                }],
                1: [{
                    type: n.RewardType.Chest,
                    id: 2,
                    amount: 1,
                    odds: 1
                }],
                2: [{
                    type: n.RewardType.Chest,
                    id: 3,
                    amount: 1,
                    odds: 1
                }],
                3: [{
                    type: n.RewardType.Chest,
                    id: 4,
                    amount: 1,
                    odds: 1
                }],
                4: [{
                    type: n.RewardType.Chest,
                    id: 1,
                    amount: 1,
                    odds: 35
                }, {
                    type: n.RewardType.Chest,
                    id: 2,
                    amount: 1,
                    odds: 25
                }, {
                    type: n.RewardType.Chest,
                    id: 3,
                    amount: 1,
                    odds: 30
                }, {
                    type: n.RewardType.Chest,
                    id: 4,
                    amount: 1,
                    odds: 10
                }],
                5: [{
                    type: n.RewardType.Chest,
                    id: 1,
                    amount: 1,
                    odds: 1
                }],
                6: [{
                    type: n.RewardType.Chest,
                    id: 4,
                    amount: 1,
                    odds: 1
                }],
                7: [{
                    type: n.RewardType.Chest,
                    id: 2,
                    amount: 1,
                    odds: 30
                }, {
                    type: n.RewardType.Chest,
                    id: 3,
                    amount: 1,
                    odds: 40
                }, {
                    type: n.RewardType.Chest,
                    id: 4,
                    amount: 1,
                    odds: 30
                }],
                8: [{
                    type: n.RewardType.Chest,
                    id: 2,
                    amount: 1,
                    odds: 20
                }, {
                    type: n.RewardType.Chest,
                    id: 3,
                    amount: 1,
                    odds: 20
                }, {
                    type: n.RewardType.Chest,
                    id: 4,
                    amount: 1,
                    odds: 60
                }]
            };
            i.default = r;
        }, {
            "../../IData": 8
        }],
        23: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../IData"), r = {
                1: {
                    type: n.RewardType.Fragment,
                    amount: 20,
                    id: 103,
                    odds: 0
                },
                2: {
                    type: n.RewardType.Fragment,
                    amount: 30,
                    id: 103,
                    odds: 0
                },
                3: {
                    type: n.RewardType.Fragment,
                    amount: 30,
                    id: 103,
                    odds: 0
                },
                4: {
                    type: n.RewardType.Coin,
                    amount: 12e3,
                    odds: 0
                }
            };
            i.default = r;
        }, {
            "../../IData": 8
        }],
        24: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.default = ["Lolita", "Emily", "Geisha", "Submit", "Baby Doll", "Alisa", "Polite", "Flowers", "Appoint", "Nefertari", "Review",
                "asshead", "Stay", "Acolasia",
                "鹊巢", "苯莒", "卷耳", "傲鸠", "泅渡",
                "伏妖词", "鹤仙姿", "扮仙女", "妄司", "暮倦",
                "折戟", "九命猫", "东京女", "双马尾", "苏璃陌",
                "不及他", "意中人", "养猫人", "我三岁", "棒棒糖",
                "两相知", "神爱温柔", "野却迷人", "挽你眉间",
                "九八野马", "偷得浮生", "美煞众生", "魔法少女",
                "软甜啾", "二智少女", "软糯酥胸", "白芷", "夏九",
                "七颜", "笔芯", "柠栀", "兮子", "软糖", "酒儿",
                "懒猫", "余罪", "北陌", "萌化", "梨涡", "仙女",
                "萝莉病", "谜兔", "走野", "鸢与", "是你", "甜嗑",
                "赤濁", "热鲨", "提赋", "淤浪", "迷你仙", "江城子",
                "三岁铭", "撞了怀", "早乙女", "涫野音", "两个我",
                "野鹿林", "一口甜", "生生漫", "音栖息无", "第几種人",
                "方圜几里", "神仙妹妹", "几味少女", "怀里藏娇", "软的没边",
                "耳根太软", "1只斥鶴", "吃人萝莉", "神都偏爱", "永眠少女", "软的要命", "生气叻つ", "哆哆。", "逗比式i", "小猪猪", "萌个兔", "琉璃娃娃", "烈", "腻",
                "癮", "废", "青", "醉", "孽", "憩", "槿", "悸", "独", "走", "沸", "毁", "帅", "朝", "统", "怹", "狂", "装", "你", "窿", "嚎", "傲", "高", "欢",
                "乐", "野", "骚", "蔍", "曦", "朤", "私", "艺", "美", "酥", "离", "一生正气", "亡灵人", "余情已残", "南邮", "一夕承诺", "孤岛情人", "酒巷清风、",
                "勇不芬离", "深陷绝境", "走位", "为伍", "沦为妻奴", "自由極乐", "键盘书生", "闪躲", "疑信参半", "抱歉", "往事辜负", "视线", "灰度", "情緒人像",
                "不自量", "过分自恋", "奔赴", "你和远方", "勾搭", "单杀", "-退让", "一生无忧", "爱和自由", "情真意切、", "高级玩家", "抵命、", "已系她心",
                "别无苛求", "风月客", "贪杯", "孤山之上", "理想诗人", "千面之人", "青灯有味", "野生动物、", "过活", "人生欠浪", "酒吧老手", "蒋啸天", "殇离别", "苏凉七", "天涯情", "旧时候", "不归人", "断情音", "孤心冷", "小妹妹", "木子李", "荒年旧", "时光凉", "昔日伴", "酒辞悠", "毁心徒", "陆瑾年", "小豆豆", "烈残歌", "似旧时", "空回首", "青苹果", "歪果仁", "凌狐宠", "寄心梦", "勿相离", "残花泽", "千劫尘", "怎安好", "终如初", "钟于你", "李宗杰", "李耀祖", "是与非", "如往昔", "不将就", "重醉梦", "杨永范", "梦未逝", "冷残影", "凝残月", "心悲凉", "赋流云", "孤人眠", "拾碎心", "浪心友", "岳饶冰", "郭可竹", "花陌黎", "久别辞", "情语花", "酒言欢", "好心人", "清欢渡", "谦友迷", "酒似歌", "穷秀才", "坠雨痕", "清笑歌", "假惺惺", "红尘事", "四叶草", "傻孩子", "刘丹丽", "殇雪酒", "小蜜蜂", "辽宁舰", "步月歌", "孙廷彦", "囚心锁", "长相思", "漫悲凉", "王俊凯", "小肥羊", "张先生", "冷场酷", "李梓豪", "卡擦擦", "乐逍遥", "南瓜王", "执酒客", "颖宝宝", "小骚年", "荒年旧", "单身羊", "离岸风", "挽情丝", "终遇你", "泪难收", "无情人", "自然人", "酒当歌", "陈智勇", "小小鹏", "致青春", "长相见", "失心劫", "醉逍遥", "席扶潇", "老顽童", "忆君言", "燕雙鷹", "极个别", "彼岸花", "听风暖", "惜醉颜", "末言雨", "江满样", "冯海良", "厌离别", "陌浮生", "恋土", "庸俗", "山丘", "戏江", "院长", "猎场", "莫离", "文少", "点点", "永平", "微笑", "暗恋", "旧情", "多余", "情殇", "救赎", "腾龙", "良生", "霸道", "回头", "莫逆", "颜熙", "寻欢", "河北", "毒药", "十七", "无趣", "温情", "縌亂", "北念", "寻找", "听风", "嘿嘿", "人渣", "沐北", "管我", "錆酒", "情仙", "北梦", "妄为", "仄言", "寒塘", "哈喽", "王宁", "尐希", "清君", "十一", "也许", "陈晨", "韬哥", "山鬼", "怪咖", "义哥", "俏皮", "残冬", "林熙", "猫性", "狂飙", "爱你", "屍魂", "殊荣", "参商", "冷漠", "酒渣", "劫难", "鬼圣", "痞笑", "小猪", "欲望", "张杰", "渡恶", "倾城", "空痕", "柚子", "情兽", "野病", "泪奔", "无心", "杰杰", "月华", "呵呵", "共勉", "换心", "污啊", "不合", "冷暖", "小生", "城府", "啊呀", "焱焱", "小喜", "断情", "厌倦", "单飞", "小痴", "温火", "罪三生", "逃孽.", "青灯古城", "凉城古巷", "语隔秋烟", "君长安", "时不我予", "风月无骨", "挥袖抚琴", "晚妆楼台", "轻解罗衫", "北暮南城", "眼神轻佻", "两眉聚皱"];
        }, {}],
        25: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            for (var n = [{
                level: 0,
                name: "Black iron 1",
                icon: "ui://ui/dw1",
                score: 0,
                winScore: 20,
                drawScore: 10,
                loseScore: -10,
                fightScore: 5,
                last: null,
                next: null,
                coinRate: 20
            }, {
                level: 1,
                name: "Black iron 2",
                icon: "ui://ui/dw2",
                score: 30,
                winScore: 20,
                drawScore: 10,
                loseScore: -10,
                fightScore: 5,
                last: null,
                next: null,
                coinRate: 40
            }, {
                level: 2,
                name: "Black iron 3",
                icon: "ui://ui/dw3",
                score: 90,
                winScore: 20,
                drawScore: 10,
                loseScore: -10,
                fightScore: 5,
                last: null,
                next: null,
                coinRate: 60
            }, {
                level: 3,
                name: "Silver 1",
                icon: "ui://ui/dw4",
                score: 300,
                winScore: 30,
                drawScore: 15,
                loseScore: -15,
                fightScore: 10,
                last: null,
                next: null,
                coinRate: 80
            }, {
                level: 4,
                name: "Silver 2",
                icon: "ui://ui/dw5",
                score: 600,
                winScore: 30,
                drawScore: 15,
                loseScore: -15,
                fightScore: 10,
                last: null,
                next: null,
                coinRate: 100
            }, {
                level: 5,
                name: "Silver 3",
                icon: "ui://ui/dw6",
                score: 1200,
                winScore: 30,
                drawScore: 15,
                loseScore: -15,
                fightScore: 10,
                last: null,
                next: null,
                coinRate: 120
            }, {
                level: 6,
                name: "Gold 1",
                icon: "ui://ui/dw7",
                score: 2e3,
                winScore: 40,
                drawScore: 20,
                loseScore: -20,
                fightScore: 15,
                last: null,
                next: null,
                coinRate: 130
            }, {
                level: 7,
                name: "Gold 2",
                icon: "ui://ui/dw8",
                score: 3200,
                winScore: 40,
                drawScore: 20,
                loseScore: -20,
                fightScore: 15,
                last: null,
                next: null,
                coinRate: 140
            }, {
                level: 8,
                name: "Gold 3",
                icon: "ui://ui/dw9",
                score: 4200,
                winScore: 40,
                drawScore: 20,
                loseScore: -20,
                fightScore: 15,
                last: null,
                next: null,
                coinRate: 150
            }, {
                level: 9,
                name: "Jade 1",
                icon: "ui://ui/dw10",
                score: 6e3,
                winScore: 50,
                drawScore: 25,
                loseScore: -25,
                fightScore: 20,
                last: null,
                next: null,
                coinRate: 160
            }, {
                level: 10,
                name: "Jade 2",
                icon: "ui://ui/dw11",
                score: 8e3,
                winScore: 50,
                drawScore: 25,
                loseScore: -25,
                fightScore: 20,
                last: null,
                next: null,
                coinRate: 170
            }, {
                level: 11,
                name: "Jade 3",
                icon: "ui://ui/dw12",
                score: 1e4,
                winScore: 50,
                drawScore: 25,
                loseScore: -25,
                fightScore: 20,
                last: null,
                next: null,
                coinRate: 180
            }, {
                level: 12,
                name: "Gem 1",
                icon: "ui://ui/dw13",
                score: 15e3,
                winScore: 60,
                drawScore: 30,
                loseScore: -30,
                fightScore: 25,
                last: null,
                next: null,
                coinRate: 190
            }, {
                level: 13,
                name: "Gem 2",
                icon: "ui://ui/dw14",
                score: 2e4,
                winScore: 60,
                drawScore: 30,
                loseScore: -30,
                fightScore: 25,
                last: null,
                next: null,
                coinRate: 200
            }, {
                level: 14,
                name: "Gem 3",
                icon: "ui://ui/dw15",
                score: 25e3,
                winScore: 60,
                drawScore: 30,
                loseScore: -30,
                fightScore: 25,
                last: null,
                next: null,
                coinRate: 210
            }], r = n.length, a = r - 1, s = 0; s < r; s++) {
                var o = n[s];
                s > 0 && (o.last = n[s - 1]), s < a && (o.next = n[s + 1]);
            }
            i.default = n;
        }, {}],
        26: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            i.default = [[{
                key: 0,
                odds: 80
            }, {
                key: 1,
                odds: 20
            }], [{
                key: 0,
                odds: 20
            }, {
                key: 1,
                odds: 50
            }, {
                key: 2,
                odds: 30
            }], [{
                key: 1,
                odds: 20
            }, {
                key: 2,
                odds: 50
            }, {
                key: 3,
                odds: 30
            }], [{
                key: 2,
                odds: 20
            }, {
                key: 3,
                odds: 50
            }, {
                key: 4,
                odds: 30
            }], [{
                key: 3,
                odds: 20
            }, {
                key: 4,
                odds: 50
            }, {
                key: 5,
                odds: 30
            }], [{
                key: 4,
                odds: 20
            }, {
                key: 5,
                odds: 50
            }, {
                key: 6,
                odds: 30
            }], [{
                key: 5,
                odds: 20
            }, {
                key: 6,
                odds: 50
            }, {
                key: 7,
                odds: 30
            }], [{
                key: 6,
                odds: 20
            }, {
                key: 7,
                odds: 50
            }, {
                key: 8,
                odds: 30
            }], [{
                key: 7,
                odds: 20
            }, {
                key: 8,
                odds: 50
            }, {
                key: 9,
                odds: 30
            }], [{
                key: 8,
                odds: 20
            }, {
                key: 9,
                odds: 50
            }, {
                key: 10,
                odds: 30
            }], [{
                key: 9,
                odds: 20
            }, {
                key: 10,
                odds: 50
            }, {
                key: 11,
                odds: 30
            }], [{
                key: 10,
                odds: 20
            }, {
                key: 11,
                odds: 50
            }, {
                key: 12,
                odds: 30
            }], [{
                key: 11,
                odds: 20
            }, {
                key: 12,
                odds: 50
            }, {
                key: 13,
                odds: 30
            }], [{
                key: 12,
                odds: 20
            }, {
                key: 13,
                odds: 50
            }, {
                key: 14,
                odds: 30
            }], [{
                key: 13,
                odds: 20
            }, {
                key: 14,
                odds: 80
            }]];
        }, {}],
        27: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            i.default = [[{
                key: 1,
                odds: 100
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 0
            }, {
                key: 4,
                odds: 0
            }], [{
                key: 1,
                odds: 50
            }, {
                key: 2,
                odds: 44
            }, {
                key: 3,
                odds: 5
            }, {
                key: 4,
                odds: 1
            }], [{
                key: 1,
                odds: 20
            }, {
                key: 2,
                odds: 60
            }, {
                key: 3,
                odds: 15
            }, {
                key: 4,
                odds: 5
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 65
            }, {
                key: 3,
                odds: 25
            }, {
                key: 4,
                odds: 10
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 60
            }, {
                key: 3,
                odds: 25
            }, {
                key: 4,
                odds: 15
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 50
            }, {
                key: 3,
                odds: 30
            }, {
                key: 4,
                odds: 20
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 30
            }, {
                key: 3,
                odds: 50
            }, {
                key: 4,
                odds: 20
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 20
            }, {
                key: 3,
                odds: 40
            }, {
                key: 4,
                odds: 40
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 10
            }, {
                key: 3,
                odds: 50
            }, {
                key: 4,
                odds: 40
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 50
            }, {
                key: 4,
                odds: 50
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 50
            }, {
                key: 4,
                odds: 50
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 40
            }, {
                key: 4,
                odds: 60
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 30
            }, {
                key: 4,
                odds: 70
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 20
            }, {
                key: 4,
                odds: 80
            }], [{
                key: 1,
                odds: 0
            }, {
                key: 2,
                odds: 0
            }, {
                key: 3,
                odds: 10
            }, {
                key: 4,
                odds: 90
            }]];
        }, {}],
        28: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.REWARD_WIN = 300, t.REWARD_DRAW = 150, t.REWARD_LOSE = 100, t.MAX_COMBO = 1 / 0,
                    t.COMBO_REWARD = [1, 3, 5, 7, 10, 13, 16], t.SHOOT_REWARD = 100, t.ADD_COIN_REWARD = [5e3, 6e3, 7e3, 8e3, 1e4],
                    t.SETTLE_REWARD_RATE = 3, t.VIDEO_LUCK_RATE = [{
                        key: 10,
                        odds: 10
                    }, {
                        key: 9,
                        odds: 30
                    }, {
                        key: 8,
                        odds: 30
                    }, {
                        key: 7,
                        odds: 20
                    }, {
                        key: 6,
                        odds: 10
                    }], t.SHARE_LUCK_RATE = [{
                        key: 10,
                        odds: 5
                    }, {
                        key: 9,
                        odds: 15
                    }, {
                        key: 8,
                        odds: 20
                    }, {
                        key: 7,
                        odds: 30
                    }, {
                        key: 6,
                        odds: 30
                    }], t;
            }();
            i.default = n;
        }, {}],
        29: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../IData"), r = t("../../Path"), a = t("../../sdk/sdk"),
                s = [{
                    id: 1,
                    name: "The Blue Crystal Team",
                    desc: "Plain blue jersey",
                    unlockType: n.SkinUnlockType.None,
                    icon: "ui://ui/human1",
                    fragmentIcon: "ui://ui/human1",
                    model: "human",
                    modelTextures: [{
                        url: r.default.get3DTexture("human1", "png"),
                        path: "human/body"
                    }],
                    level: 1,
                    fightScore: 15,
                    synFragmentCost: 30,
                    rewardGainLimit: 3,
                    shareFragmentReward: 3,
                    videoFragmentReward: 3
                }, {
                    id: 2,
                    name: "The Topaz Team",
                    desc: "The plain yellow jersey",
                    unlockType: n.SkinUnlockType.None,

                    icon: "ui://ui/human2",
                    fragmentIcon: "ui://ui/human2",
                    model: "human",
                    modelTextures: [{
                        url: r.default.get3DTexture("human2", "png"),
                        path: "human/body"
                    }],
                    level: 1,
                    fightScore: 15,
                    synFragmentCost: 30,
                    rewardGainLimit: 3,
                    shareFragmentReward: 3,
                    videoFragmentReward: 3
                }, {
                    id: 3,
                    name: "Team Amber",
                    desc: "Plain orange jersey",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/human3",
                    fragmentIcon: "ui://ui/human3",
                    model: "human",
                    modelTextures: [{
                        url: r.default.get3DTexture("human3", "png"),
                        path: "human/body"
                    }],
                    level: 1,
                    fightScore: 15,
                    synFragmentCost: 30,
                    rewardGainLimit: 3,
                    shareFragmentReward: 3,
                    videoFragmentReward: 3
                }, {
                    id: 4,
                    name: "Diamond Team",
                    desc: "Plain light blue jersey",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/human4",
                    fragmentIcon: "ui://ui/human4",
                    model: "human",
                    modelTextures: [{
                        url: r.default.get3DTexture("human4", "png"),
                        path: "human/body"
                    }],
                    level: 1,
                    fightScore: 15,
                    synFragmentCost: 30,
                    rewardGainLimit: 3,
                    shareFragmentReward: 3,
                    videoFragmentReward: 3
                }, {
                    id: 101,
                    name: "Man of Steel",
                    desc: "Invincible and invincible",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/ironman",
                    fragmentIcon: "ui://ui/pfsp1",
                    model: "ironman",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .5,
                        desc: "8% increase in speed"
                    }],
                    level: 2,
                    fightScore: 30,
                    synFragmentCost: 80,
                    rewardGainLimit: 3,
                    shareFragmentReward: 5,
                    videoFragmentReward: 5
                }, {
                    id: 102,
                    name: "Cat ear sister",
                    desc: "Flexible and happy to bring the breath of youth",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/girl",
                    fragmentIcon: "ui://ui/pfsp2",
                    model: "girl",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .7,
                        desc: "10% increase in speed"
                    }],
                    level: 2,
                    fightScore: 30,
                    synFragmentCost: 80,
                    rewardGainLimit: 3,
                    shareFragmentReward: 5,
                    videoFragmentReward: 5
                }, {
                    id: 103,
                    name: "Ninja",
                    desc: "A trained ninja",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/ninja",
                    fragmentIcon: "ui://ui/pfsp3",
                    model: "ninja",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }, {
                        type: n.AttrType.HitDistance,
                        value: -.5,
                        desc: "Repel distance reduced by 25%"
                    }],
                    level: 3,
                    fightScore: 45,
                    synFragmentCost: 80,
                    rewardGainLimit: 4,
                    shareFragmentReward: 4,
                    videoFragmentReward: 4
                }, {
                    id: 104,
                    name: "Mob in suit",
                    desc: "Authentic social people",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/suitman",
                    fragmentIcon: "ui://ui/pfsp4",
                    model: "suitman",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }],
                    level: 2,
                    fightScore: 30,
                    synFragmentCost: 80,
                    rewardGainLimit: 0,
                    shareFragmentReward: 0,
                    videoFragmentReward: 0
                }, {
                    id: 105,
                    name: "Super Captain",
                    desc: "With a strong will to lead the team to victory",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/head_md",
                    fragmentIcon: "ui://ui/pfsp5",
                    model: "captain",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }, {
                        type: n.AttrType.RockeySpeed,
                        value: .3,
                        desc: "Run speed increased by 5%"
                    }],
                    level: 3,
                    fightScore: 45,
                    synFragmentCost: 60,
                    rewardGainLimit: 3,
                    shareFragmentReward: 6,
                    videoFragmentReward: 6
                }, {
                    id: 106,
                    name: "Thor",
                    desc: "With the speed of lightning and the power of lightning",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/leishen",
                    fragmentIcon: "ui://ui/pfsp6",
                    model: "thor",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }, {
                        type: n.AttrType.RockeyTime,
                        value: 1,
                        desc: "Run duration increased by 1 second"
                    }],
                    level: 3,
                    fightScore: 45,
                    synFragmentCost: 80,
                    rewardGainLimit: 4,
                    shareFragmentReward: 4,
                    videoFragmentReward: 4
                }, {
                    id: 107,
                    name: "Easy bear",
                    desc: "Cute little bear",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/head_xiong",
                    fragmentIcon: "ui://ui/pfsp7",
                    model: "bear",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }, {
                        type: n.AttrType.HoldSpeed,
                        value: .3,
                        desc: "Ball speed increased by 5%"
                    }],
                    level: 4,
                    fightScore: 60,
                    synFragmentCost: 100,
                    rewardGainLimit: 5,
                    shareFragmentReward: 3,
                    videoFragmentReward: 3
                }, {
                    id: 108,
                    name: "Astronaut",
                    desc: "Have a heart that loves football",
                    unlockType: n.SkinUnlockType.Coin,
                    unlockValue: 1000,
                    icon: "ui://ui/jiajialin",
                    fragmentIcon: "ui://ui/pfsp8",
                    model: "astronaut",
                    attrs: [{
                        type: n.AttrType.Speed,
                        value: .9,
                        desc: "15% increase in speed"
                    }, {
                        type: n.AttrType.RockeyTime,
                        value: 1.5,
                        desc: "Run duration increased by 1.5 seconds"
                    }],
                    level: 3,
                    fightScore: 50,
                    synFragmentCost: 80,
                    rewardGainLimit: 4,
                    shareFragmentReward: 4,
                    videoFragmentReward: 4
                }];
            "tt" !== a.default.getPlatform() && s.push({
                id: 109,
                name: "Chua little chicken",
                desc: "Students, it seems, can sing, dance, rap",
                unlockType: n.SkinUnlockType.Coin,
                unlockValue: 1000,
                icon: "ui://ui/caiji",
                fragmentIcon: "ui://ui/pfsp9",
                model: "jimei",
                attrs: [{
                    type: n.AttrType.Speed,
                    value: .9,
                    desc: "15% increase in speed"
                }, {
                    type: n.AttrType.RockeySpeed,
                    value: .5,
                    desc: "Run speed increased by 8%"
                }],
                level: 4,
                fightScore: 60,
                synFragmentCost: 100,
                rewardGainLimit: 5,
                shareFragmentReward: 3,
                videoFragmentReward: 3
            }),

                i.default = s;
        }, {
            "../../IData": 8,
            "../../Path": 12,
            "../../sdk/sdk": 327
        }],
        30: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./IFightData"), r = t("../../Path"), a = t("../UserData"), s = r.default.getSprite3DPath("football"), o = r.default.getSprite3DPath("football_ground"), l = new Laya.Rectangle(-100, -200, 200, 400), h = {
                type: n.FightType.Normel,
                matchTime: 40,
                robotInit1: "normalinit1",
                robotInit2: "normalinit2",
                actorInitInfo: [{
                    isLocal: !0,
                    group: 1,
                    x: 0,
                    y: 8,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 1,
                    x: 10,
                    y: 8,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 1,
                    x: -10,
                    y: 8,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 1,
                    x: 5,
                    y: 20,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 1,
                    x: -5,
                    y: 20,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 0,
                    y: -8,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 10,
                    y: -8,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: -10,
                    y: -8,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 5,
                    y: -20,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: -5,
                    y: -20,
                    forwardX: 0,
                    forwardY: 1
                }],
                relifePointsInfo: [{
                    group: 1,
                    x: 16,
                    y: 37,
                    validArea: l
                }, {
                    group: 1,
                    x: -16,
                    y: 37,
                    validArea: l
                }, {
                    group: 2,
                    x: 16,
                    y: -37,
                    validArea: l
                }, {
                    group: 2,
                    x: -16,
                    y: -37,
                    validArea: l
                }],
                ballUrl: s,
                groundUrl: o
            }, u = (n.FightType.Normel, n.FightType.Normel, {}), c = {
                type: n.FightType.Guide,
                matchTime: -1,
                robotInit1: "guideinit",
                robotInit2: "guideinit",
                actorInitInfo: [{
                    isLocal: !0,
                    group: 1,
                    x: 0,
                    y: 8,
                    forwardX: 0,
                    forwardY: -1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 0,
                    y: -3,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 0,
                    y: -20,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: -8,
                    y: -20,
                    forwardX: 0,
                    forwardY: 1
                }, {
                    isLocal: !1,
                    group: 2,
                    x: 8,
                    y: -20,
                    forwardX: 0,
                    forwardY: 1
                }],
                ballUrl: s,
                groundUrl: o,
                fightScript: "guidefight"
            };
            function d(t, e) {
                e.type = t.type, e.matchTime = t.matchTime, e.robotInit1 = t.robotInit1, e.robotInit2 = t.robotInit2,
                    e.actorInitInfo = t.actorInitInfo, e.relifePointsInfo = t.relifePointsInfo, e.ballUrl = t.ballUrl,
                    e.groundUrl = t.groundUrl, e.fightScript = t.fightScript;
            }
            i.default = {
                allScript: ["ai01", "ai02", "ai03", "ai04", "ai05", "ai06", "ai07", "ai08", "aiguide01", "guidefight", "normalinit", "guideinit"],
                newGuide: function (t) {
                    d(c, t);
                },
                default: function (t) {
                    var e = a.default.getInstance().totalCount;
                    d(u[e + 1] || h, t);
                }
            };
        }, {
            "../../Path": 12,
            "../UserData": 20,
            "./IFightData": 31
        }],
        31: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.FightType = void 0, function (t) {
                t[t.Guide = 0] = "Guide", t[t.Normel = 1] = "Normel";
            }(i.FightType || (i.FightType = {}));
        }, {}],
        32: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../config/SkinConfig"), r = t("../../IData"), a = t("../../math/MathHelper"), s = t("../../Path"), o = t("./UnlockFactory"), l = t("../../sdk/sdk"), h = t("../MjpHelper"), u = function () {
                function t(t) {
                    this.id = t.id, this.name = t.name, this.desc = t.desc, this.icon = t.icon, this.fragmentIcon = t.fragmentIcon,
                        this.model = s.default.getSprite3DPath(t.model), this.modelTextures = t.modelTextures || [],
                        this.mutexIds = t.mutexIds, this.unlockType = t.unlockType, this.unlock = o.default.createUnlock(t.unlockType, t.unlockValue),
                        this.attrs = t.attrs || [], this.level = t.level, this.fightScore = t.fightScore,
                        this.synFragmentCost = t.synFragmentCost, this.rewardGainLimit = t.rewardGainLimit,
                        this.videoFragmentReward = t.videoFragmentReward, this.shareFragmentReward = t.shareFragmentReward;
                }
                return t.updateSkinByPlatform = function (t) {
                    return "wx" === l.default.getPlatform() || "qq" === l.default.getPlatform() || t.unlockType === r.SkinUnlockType.Collect && (t.unlockType = r.SkinUnlockType.None),
                        !0;
                }, t.onOffShow = function (t) {
                    if (h.default.enableShowISBN()); else if (h.default.isSkinInISBN(t.id)) return !1;
                    return !0;
                }, t.load = function (e) {
                    for (var i = [], n = {}, r = [], a = 0, s = e; a < s.length; a++) {
                        var o = s[a];
                        if (this.updateSkinByPlatform(o) && this.onOffShow(o)) {
                            var l = (c = new t(o)).id;
                            r.push(l), i.push(c), n[l] = c;
                        }
                    }
                    for (var h = 0, u = i; h < u.length; h++) {
                        var c;
                        (c = u[h]).setRandomPool(r);
                    }
                    this._skinMap = n, this._allSkins = i;
                }, t.lazy_init = function () {
                    this._skinMap || this.load(n.default);
                }, Object.defineProperty(t, "allSkins", {
                    get: function () {
                        return this.lazy_init(), this._allSkins;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.getAllTextureList = function () {
                    this.lazy_init();
                    for (var t = {}, e = 0, i = this._allSkins; e < i.length; e++) for (var n = 0, r = i[e].modelTextures; n < r.length; n++) {
                        t[r[n].url] = 1;
                    }
                    return Object.keys(t);
                }, t.getAllModelList = function () {
                    this.lazy_init();
                    for (var t = {}, e = 0, i = this._allSkins; e < i.length; e++) {
                        t[i[e].model] = 1;
                    }
                    return Object.keys(t);
                }, t.getSkinData = function (t) {
                    // console.log("皮肤信息：",this._skinMap[t])
                    return this.lazy_init(), this._skinMap[t];
                }, t.randomSkinWithLevel = function (t, e, i) {
                    this.lazy_init();
                    for (var n = [], r = e ? e.randomIds : null, s = 0, o = this._allSkins; s < o.length; s++) {
                        var l = o[s];
                        l.level !== t || r && -1 === r.indexOf(l.id) || n.push(l);
                    }
                    return n.length <= 0 ? (console.warn("randomSkinWithLevel got a empty random pool::: ", t, e),
                        e ? this.getSkinData(e.randomTargetSkinId(i)) : this.getSkinData(a.default.randomInArray([1, 2, 3, 4], i))) : a.default.randomInArray(n, i);
                }, t.prototype.getAttrsDesc = function (t) {
                    return this.attrs.map(function (t) {
                        return t.desc;
                    }).join(t || "，");
                }, t.prototype.setRandomPool = function (t) {
                    for (var e = t.slice(), i = 0, n = (this.mutexIds || []).concat(this.id); i < n.length; i++) {
                        var r = n[i], a = e.indexOf(r);
                        -1 !== a && e.splice(a, 1);
                    }
                    this.randomIds = e;
                }, t.prototype.randomTargetSkinId = function (t) {
                    return a.default.randomInArray(this.randomIds, t);
                }, t._allSkins = null, t._skinMap = null, t;
            }();
            i.default = u;
        }, {
            "../../IData": 8,
            "../../Path": 12,
            "../../math/MathHelper": 320,
            "../../sdk/sdk": 327,
            "../MjpHelper": 18,
            "../config/SkinConfig": 29,
            "./UnlockFactory": 36
        }],
        33: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t(t) {
                    this.isLocked = !0, this.isHide = !1, this.progress = "-/-", this.desc = "\b宝箱解锁";
                }
                return t.prototype.enableUnlock = function () {
                    return !1;
                }, t.prototype.unlockSkin = function (t) { }, t;
            }();
            i.default = n;
        }, {}],
        34: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../UserData"), r = function () {
                function t(t) {
                    if (this.isLocked = !0, this.isHide = !1, "number" != typeof t) throw "Error unlock coin value: need a number ::: " + t;
                    this._cost = t, this.desc = "" + t + " coins ";
                }
                return Object.defineProperty(t.prototype, "progress", {
                    get: function () {
                        return this._cost.toString();
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.enableUnlock = function () {
                    return !0;
                }, t.prototype.unlockSkin = function (t) { }, t;
            }();
            i.default = r;
        }, {
            "../UserData": 20
        }],
        35: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../view/Modal"), r = t("../../view/CollectTipsModal"), a = function () {
                function t(t) {
                    this.desc = "收藏游戏", this.progress = "0/1", this.isLocked = !0, this.isHide = !1;
                }
                return t.prototype.enableUnlock = function () {
                    return !1;
                }, t.prototype.unlockSkin = function (t) {

                    n.default.showModal(r.default, t, this);
                }, t;
            }();
            i.default = a;
        }, {
            "../../view/CollectTipsModal": 335,
            "../../view/Modal": 344
        }],
        36: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../IData"), r = t("./UnlockNone"), a = t("./UnlockCoin"), s = t("./UnlockFollow"), o = t("./UnlockCollect"), l = t("./UnlockChest"), h = function () {
                function t() { }
                return t.createUnlock = function (t, e) {
                    switch (t) {
                        case n.SkinUnlockType.None:
                            return new r.default(null);

                        case n.SkinUnlockType.Chest:
                            return new l.default(e);

                        case n.SkinUnlockType.Follow:
                            return new s.default(e);

                        case n.SkinUnlockType.Collect:
                            return new o.default(e);

                        case n.SkinUnlockType.Coin:
                            return new a.default(e);

                        default:
                            throw "Unknow Skin Unlock Type ====== " + t;
                    }
                }, t;
            }();
            i.default = h;
        }, {
            "../../IData": 8,
            "./UnlockChest": 33,
            "./UnlockCoin": 34,
            "./UnlockCollect": 35,
            "./UnlockFollow": 37,
            "./UnlockNone": 38
        }],
        37: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../UserData"), r = t("../../view/Modal"), a = t("../../view/InviteRewardModal"), s = t("../MjpHelper"), o = function () {
                function t(t) {
                    if (this.desc = "邀请好友", this.isLocked = !0, "number" != typeof t) throw "Error unlock follow value: need a number ::: " + t;
                    this.followLimit = t;
                }
                return Object.defineProperty(t.prototype, "isHide", {
                    get: function () {
                        return !s.default.enableFriendGift();
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "progress", {
                    get: function () {
                        var t = this.followLimit;
                        return Math.min(t, n.default.getInstance().followsnum) + "/" + t + " ";
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.enableUnlock = function () {
                    return n.default.getInstance().followsnum >= this.followLimit;
                }, t.prototype.unlockSkin = function (t) {

                    r.default.showModal(a.default, t, this);
                }, t;
            }();
            i.default = o;
        }, {
            "../../view/InviteRewardModal": 340,
            "../../view/Modal": 344,
            "../MjpHelper": 18,
            "../UserData": 20
        }],
        38: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t(t) {
                    this.desc = " Free ", this.progress = "-/-", this.isLocked = !1, this.isHide = !1;
                }
                return t.prototype.enableUnlock = function () {
                    return !1;
                }, t.prototype.unlockSkin = function (t) { }, t;
            }();
            i.default = n;
        }, {}],
        39: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../game/behaviors/BehaviorNames"), r = t("../Path");
            t("../math/Rect");
            var a = b3.BehaviorTree.prototype;
            a.load;
            r.default.getTreeInfos = function (t) {
                return [{
                    url: this._config_base + "data.obj",
                    type: "buffer"
                }];
            }, a.load = function (t) {
                try {
                    for (var e = new Laya.Byte(t), i = n.default, r = e.getUint16(), a = e.getInt16(), s = {}, o = 0; o < a; o++) {
                        var l = e.getUint16(), h = e.getUTFString(), u = void 0;
                        if (h in i) u = i[h]; else {
                            if (!(h in b3)) throw new EvalError('BehaviorTree.load: Invalid node name + "' + h + '".');
                            u = b3[h];
                        }
                        (f = new u({
                            buff: e
                        })).__child__ = e.getUint16();
                        for (var c = [], d = e.getUint16(), _ = 0; _ < d; _++) c.push(e.getUint16());
                        f.__children__ = c, s[l] = f;
                    }
                    for (var l in s) {
                        var f, p = (f = s[l]).__child__;
                        c = f.__children__;
                        if (f.category === b3.COMPOSITE && c.length > 0) for (var m = f, g = 0, y = c; g < y.length; g++) {
                            var v = y[g];
                            m.children.push(s[v]);
                        } else if (f.category === b3.DECORATOR && p > 0) {
                            f.child = s[p];
                        }
                    }
                    this.root = s[r];
                } catch (e) {
                    throw console.log("Cannot load b3 tree with data :: ", JSON.stringify(t), new Error().stack),
                    e;
                }
            };
        }, {
            "../Path": 12,
            "../game/behaviors/BehaviorNames": 141,
            "../math/Rect": 321
        }],
        40: [function (t, e, i) {
            var n = entitas.Matcher;
            var r = {};
            n.create = function (t) {
                var e = function (t) {
                    var e = t.anyOf || [], i = t.allOf || [], n = t.noneOf || [];
                    return 0 === n.length && e.length + i.length === 1 ? e.join("") + i.join("") : e.join("|") + "_" + i.join("&") + "_" + n.join("!");
                }(t), i = r[e];
                return i || (i = t.allOf ? n.allOf.apply(n, t.allOf) : new n(), t.anyOf && i.anyOf.apply(i, t.anyOf),
                    t.noneOf && i.noneOf.apply(i, t.noneOf), r[e] = i, i);
            }, n.allMathers = r;
        }, {}],
        41: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, r = t("../game/base/BaseComponent"), a = n.prototype;
            function s(t, e, i) {
                i instanceof r.default && i.recycle(e);
            }
            var o = a.createEntity;
            a.createEntity = function (t) {
                var e = o.call(this, t);
                return e.onComponentRemoved.add(s), e;
            }, a.createCollisonEvent = function (t, e, i, n) {
                return this.createEntity("collisonEvent").addCollision(t, e, i, n);
            }, a.createOutofValidEvent = function (t, e, i, n) {
                return this.createEntity("outofValidEvent").addOutofValid(t, e, i, n);
            }, a.createContact = function (t, e) {
                return this.createEntity("contact").addContact(t, e);
            }, a.createGround = function (t) {
                return this.createEntity("ground").addRenderNode().addModel(t);
            }, a.createCamera = function (t, e) {
                return this.createEntity("camera").addRenderNode().addCamera(t, e);
            }, a.createBall = function (t, e, i) {
                return this.createEntity("ball").addRenderNode().addModel(t, e, i).addBall();
            }, a.createModel = function (t, e) {
                return this.createEntity(e || "model").addRenderNode().addModel(t);
            }, a.createPlayer = function () {
                return this.createEntity("player").addRenderNode();
            }, a.createRobot = function () {
                return this.createEntity("robot").addRenderNode();
            }, a.createTimerHandler = function (t, e, i, n, r) {
                return this.createEntity("timerHandler").addTimerHandler(t, e, i, n, r);
            }, a.createTimeScaler = function (t, e, i) {
                return this.createEntity("timeScaler").addTimeScaler(t, e, i);
            }, a.createGameOver = function (t, e) {
                return this.createEntity("gameOver").addGameOver(t, e);
            }, a.createParticle = function (t, e, i, n) {
                var r = this.createEntity("particle");
                return r.addRenderNode().addParticle(t).addPositionOnce(e, i), n && n > 0 && r.addLifeDuration(n),
                    r;
            }, a.createVibration = function (t) {
                return this.createEntity("vibration").addDeviceVibrate(t);
            }, a.createSound = function (t, e, i) {
                // return this.createEntity("sound").addSoundPlayer(t, e, i, !0);
            };
            var l = a.destroyAllEntities;
            a.destroyAllEntities = function () {
                this._isCleaning = !0, l.call(this), this._isCleaning = !1;
            }, Object.defineProperty(a, "isCleaning", {
                get: function () {
                    return this._isCleaning;
                },
                enumerable: !0,
                configurable: !0
            });
        }, {
            "../game/base/BaseComponent": 137
        }],
        42: [function (t, e, i) {
            entitas.Pool, entitas.Entity;
            var n = entitas.Systems.prototype;
            function r(t, e) {
                return e in t ? t : null;
            }
            n.activate = function () {
                for (var t = 0, e = this._executeSystems.length; t < e; t++) {
                    var i = r(this._executeSystems[t], "activate");
                    null != i && i.activate();
                }
            }, n.deactivate = function () {
                for (var t = 0, e = this._executeSystems.length; t < e; t++) {
                    var i = r(this._executeSystems[t], "deactivate");
                    null != i && i.deactivate();
                }
            };
        }, {}],
        43: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), t("./PoolExt"), t("./MatcherExt"), t("./SystemsExt"), t("./BehaviorExt");
        }, {
            "./BehaviorExt": 39,
            "./MatcherExt": 40,
            "./PoolExt": 41,
            "./SystemsExt": 42
        }],
        44: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./UI_mengban"), r = t("./UI_loading"), a = t("./UI_btnQueren"), s = t("./UI_tanchuangty"), o = function () {
                function t() { }
                return t.bindAll = function () {
                    fairygui.UIObjectFactory.setPackageItemExtension(n.default.URL, n.default), fairygui.UIObjectFactory.setPackageItemExtension(r.default.URL, r.default),
                        fairygui.UIObjectFactory.setPackageItemExtension(a.default.URL, a.default), fairygui.UIObjectFactory.setPackageItemExtension(s.default.URL, s.default);
                }, t;
            }();
            i.default = o;
        }, {
            "./UI_btnQueren": 45,
            "./UI_loading": 46,
            "./UI_mengban": 47,
            "./UI_tanchuangty": 48
        }],
        45: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("Common", "btnQueren");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n2 = this.getChildAt(0), this.m_btnQuerena = this.getChildAt(1);
                }, e.URL = "ui://8njvst8hwycl4", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        46: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("Common", "loading");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_jiazaib = this.getChildAt(0),
                        this.m_t1 = this.getTransitionAt(0);
                }, e.URL = "ui://8njvst8hqzvj3b", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        47: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("Common", "mengban");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_mengbanb = this.getChildAt(0);
                }, e.URL = "ui://8njvst8hcqjp6s", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        48: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("Common", "tanchuangty");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_labQr = this.getChildAt(1),
                        this.m_btnQuerenc = this.getChildAt(2);
                }, e.URL = "ui://8njvst8hwycl6z", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        49: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("guide", "Novice");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_ballfw = this.getChildAt(3), this.m_labYdyidong = this.getChildAt(9), this.m_labQtpm = this.getChildAt(10),
                        this.m_animXsydcz = this.getChildAt(11), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://xe81lcmxrhmm0", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        50: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./UI_Novice"),
                r = function () {
                    function t() { }
                    return t.bindAll = function () {
                        fairygui.UIObjectFactory.setPackageItemExtension(n.default.URL, n.default);
                    }, t;
                }();
            i.default = r;
        }, {
            "./UI_Novice": 49
        }],
        51: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "Luck");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n9 = this.getChildAt(0), this.m_n13 = this.getChildAt(1), this.m_n23 = this.getChildAt(2),
                        this.m_n18 = this.getChildAt(3), this.m_listXysz = this.getChildAt(4), this.m_n20 = this.getChildAt(5),
                        this.m_n21 = this.getChildAt(6), this.m_btnFengxb = this.getChildAt(7), this.m_btnShipa = this.getChildAt(8),
                        this.m_btnGbih = this.getChildAt(9), this.m_n32 = this.getChildAt(10), this.m_btn_free = this.getChildAt(11),
                        this.m_t2 = this.getTransitionAt(0), this.m_t3 = this.getTransitionAt(1);
                }, e.URL = "ui://rijcngz1powebi", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        52: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "Playergold");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n53 = this.getChildAt(0), this.m_n62 = this.getChildAt(1),
                        this.m_labJinbei = this.getChildAt(2), this.m_btnJiahao = this.getChildAt(3);
                }, e.URL = "ui://rijcngz1vggk8l", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        53: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "ProgressBar1");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_bar = this.getChildAt(1),
                        this.m_title = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1xv2p8b", e;
            }(fairygui.GProgressBar);
            i.default = n;
        }, {}],
        54: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "ProgressBar2");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_bar = this.getChildAt(1),
                        this.m_title = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1ln3p9m", e;
            }(fairygui.GProgressBar);
            i.default = n;
        }, {}],
        55: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "ProgressBar3");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_bar = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1rwqzbc", e;
            }(fairygui.GProgressBar);
            i.default = n;
        }, {}],
        56: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "ProgressBar4");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_bar = this.getChildAt(1),
                        this.m_title = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1fc1acd", e;
            }(fairygui.GProgressBar);
            i.default = n;
        }, {}],
        57: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "SharingVideo");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_night = this.getChildAt(1),
                        this.m_btnGbb = this.getChildAt(2), this.m_n3 = this.getChildAt(3), this.m_labBxmc = this.getChildAt(4),
                        this.m_btn_share = this.getChildAt(5), this.m_iconPifusuip = this.getChildAt(6),
                        this.m_labJcjq = this.getChildAt(7), this.m_labChuji = this.getChildAt(8), this.m_labSydjs = this.getChildAt(9),
                        this.m_lab_lastTimes = this.getChildAt(10), this.m_Lightb = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1r13oc9", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        58: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "Toast");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n56 = this.getChildAt(0), this.m_labWllj = this.getChildAt(1),
                        this.m_t1 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1qzvj3e", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        59: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "addPlayers");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labPfmc = this.getChildAt(0),
                        this.m_prgSuipian = this.getChildAt(1), this.m_labSpjd = this.getChildAt(2), this.m_lab_num = this.getChildAt(3),
                        this.m_labPifuleix = this.getChildAt(4), this.m_btn_add = this.getChildAt(5), this.m_night = this.getChildAt(6),
                        this.m_labSpjd_2 = this.getChildAt(7), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1fc1acc", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        60: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "animChangjingqiehuan");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n210 = this.getChildAt(0), this.m_n211 = this.getChildAt(1),
                        this.m_animCjqh = this.getTransitionAt(0), this.m_animCjqhb = this.getTransitionAt(1);
                }, e.URL = "ui://rijcngz19bjx6b", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        61: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "baoxiang");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n3 = this.getChildAt(1), this.m_labTimeb = this.getChildAt(2),
                        this.m_labWubaoxiang = this.getChildAt(3), this.m_iconBaoxiang = this.getChildAt(4),
                        this.m_n19 = this.getChildAt(5), this.m_n21 = this.getChildAt(6), this.m_labKqbx = this.getChildAt(7),
                        this.m_labLkkq = this.getChildAt(8), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1g1px9q", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        62: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t),
                    e.createInstance = function () {
                        return fairygui.UIPackage.createObject("ui", "baoxianghuoqu");
                    }, e.prototype.constructFromXML = function (e) {
                        t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                            this.m_n11 = this.getChildAt(0), this.m_night = this.getChildAt(1), this.m_n15 = this.getChildAt(2),
                            this.m_labJxjl = this.getChildAt(3), this.m_iconBaoxiang = this.getChildAt(4), this.m_btnFqsj = this.getChildAt(5),
                            this.m_btnShipsjbx = this.getChildAt(6), this.m_btnFengxsjbx = this.getChildAt(7),
                            this.m_btnShouq = this.getChildAt(8), this.m_night_2 = this.getChildAt(9), this.m_labTsbx = this.getChildAt(10),
                            this.m_iconBaoxiang_next = this.getChildAt(11), this.m_labTsbx_next = this.getChildAt(12),
                            this.m_n32 = this.getChildAt(13), this.m_btn_close = this.getChildAt(14), this.m_t0 = this.getTransitionAt(0);
                    }, e.URL = "ui://rijcngz1lr4wa7", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        63: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "baoxiangjiasu");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_n0 = this.getChildAt(0), this.m_night = this.getChildAt(1),
                        this.m_btnGbb = this.getChildAt(2), this.m_n18 = this.getChildAt(3), this.m_labBxmc = this.getChildAt(4),
                        this.m_btnSpkq = this.getChildAt(5), this.m_btnJbkq = this.getChildAt(6), this.m_labSycs = this.getChildAt(7),
                        this.m_labJbsz = this.getChildAt(8), this.m_n21 = this.getChildAt(9), this.m_btnFxsy = this.getChildAt(10),
                        this.m_iconBaoxiang = this.getChildAt(11), this.m_labSydjs = this.getChildAt(12),
                        this.m_lab_odd = this.getChildAt(13), this.m_lab_dgl1 = this.getChildAt(14), this.m_lab_fragment = this.getChildAt(15),
                        this.m_lab_dgl2 = this.getChildAt(16), this.m_fragment_group = this.getChildAt(17),
                        this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1g1px9w", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        64: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "baoxiangjl");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n10 = this.getChildAt(0), this.m_n9 = this.getChildAt(1), this.m_n8 = this.getChildAt(2),
                        this.m_n0 = this.getChildAt(3), this.m_labJbs = this.getChildAt(4), this.m_iconPifuspJinbi = this.getChildAt(5),
                        this.m_iconPfjibie = this.getChildAt(6), this.m_n12 = this.getChildAt(7), this.m_n11 = this.getChildAt(8),
                        this.m_n13 = this.getChildAt(9), this.m_n14 = this.getChildAt(10), this.m_n5 = this.getChildAt(11),
                        this.m_n4 = this.getChildAt(12), this.m_t0 = this.getTransitionAt(0), this.m_t1 = this.getTransitionAt(1),
                        this.m_t2 = this.getTransitionAt(2);
                }, e.URL = "ui://rijcngz1g1pxa6", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        65: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "baoxiangkaiqi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_night = this.getChildAt(0), this.m_btnSq = this.getChildAt(1), this.m_listBaoxiangkq = this.getChildAt(2),
                        this.m_iconKaixianga = this.getChildAt(3), this.m_btn_video = this.getChildAt(4),
                        this.m_bnt_gain = this.getChildAt(5), this.m_bnt_close = this.getChildAt(6), this.m_btn_share = this.getChildAt(7),
                        this.m_t0 = this.getTransitionAt(0), this.m_t1 = this.getTransitionAt(1);
                }, e.URL = "ui://rijcngz1g1px9x", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        66: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "bisaijc");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_n208 = this.getChildAt(0), this.m_n209 = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1nsll65", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        67: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "bisaijieguo");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n188 = this.getChildAt(0), this.m_n189 = this.getChildAt(1),
                        this.m_n196 = this.getChildAt(2), this.m_labWanjiadui = this.getChildAt(3),
                        this.m_labWanjiadui.text = "You "

                    this.m_labDuishoudui = this.getChildAt(4),
                        this.m_labDuishoudui.text = "Player "
                    this.m_labWofangbf = this.getChildAt(5), this.m_labDuishoubf = this.getChildAt(6);
                }, e.URL = "ui://rijcngz1drld6j", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        68: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnBuy");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n65 = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1kmgmb0", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        69: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnDianjilq");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_iconJinbid = this.getChildAt(1),
                        this.m_labJine = this.getChildAt(2), this.m_labDj = this.getChildAt(3);
                    // this.m_labDj.scaleX 
                    this.m_labDj.scaleX = this.m_labDj.scaleY = 1.3
                    this.m_labDj.text = "Reward"
                }, e.URL = "ui://rijcngz1kmgmb1", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        70: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnError");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n224 = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1cqjp6o", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        71: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnFqsj");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labTsbx = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1v1m3b2", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        72: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnGift");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_n4 = this.getChildAt(1),
                        this.m_labVip = this.getChildAt(2), this.m_n5 = this.getChildAt(3), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1evqxce", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        73: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnLiping");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n218 = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1drld6l", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        74: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnPif");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n67 = this.getChildAt(0), this.m_n61 = this.getChildAt(1),
                        this.m_labSkin = this.getChildAt(2);
                    this.m_labSkin.text = "Skin"

                }, e.URL = "ui://rijcngz1lglf59", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        75: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnQandao");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_n3 = this.getChildAt(1),
                        this.m_labQiandao = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1stvcc1", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        76: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnRmgame");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n244 = this.getChildAt(0), this.m_iconGames = this.getChildAt(1),
                        this.m_title = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1iu3b7p", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        77: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnShareb");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n66 = this.getChildAt(0), this.m_n60 = this.getChildAt(1),
                        this.m_btnShare = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1lglf58", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        78: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnShequ");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n235 = this.getChildAt(0), this.m_n232 = this.getChildAt(1),
                        this.m_labShequ = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1pupc75", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        79: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnTianjiaxcx");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_tianjiaxiaochengxu = this.getChildAt(0), this.m_n238 = this.getChildAt(1),
                        this.m_t1 = this.getTransitionAt(0), this.m_t2 = this.getTransitionAt(1);
                }, e.URL = "ui://rijcngz1xxc27b", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        80: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnTiaozhuan");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_button = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n1 = this.getChildAt(1), this.m_n2 = this.getChildAt(2),
                        this.m_n3 = this.getChildAt(3);
                }, e.URL = "ui://rijcngz1oyqrcu", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        81: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnTop");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n237 = this.getChildAt(0), this.m_n235 = this.getChildAt(1),
                        this.m_labTop = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1pupc76", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        82: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btnVip");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_labVip = this.getChildAt(1),
                        this.m_n3 = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1stvcc2", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        83: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_copy");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_button = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n1 = this.getChildAt(1), this.m_n2 = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1evqxcl", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        84: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_defaultOrange");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1rnk68d", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        85: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_defaultOrangeIcon");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1),
                        this.m_icon = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1kqg88j", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        86: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_defaultOrangeL");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1i4dk8i", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        87: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_defaultOranges");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1rnk68f", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        88: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_defaultVioletIcon");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1),
                        this.m_icon = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1g5gd8h", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        89: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_gain_close");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labXiexie = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1i9rzca", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        90: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_gain_continue");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labXiexie = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1fc1acb", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        91: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_gain_directly");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labXiexie = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1k2kgc9", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        92: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_kaibaoxiang");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1g1px9r", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        93: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_sanbeilq");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_labSanblq = this.getChildAt(1), this.m_labShuzi = this.getChildAt(2),
                        this.m_n21 = this.getChildAt(3), this.m_labXydj = this.getChildAt(4), this.m_n1 = this.getChildAt(5),
                        this.m_n2 = this.getChildAt(6), this.m_n3 = this.getChildAt(7), this.m_n9 = this.getChildAt(8),
                        this.m_n10 = this.getChildAt(9), this.m_n11 = this.getChildAt(10), this.m_n15 = this.getChildAt(11),
                        this.m_n16 = this.getChildAt(12), this.m_n14 = this.getChildAt(13), this.m_icon = this.getChildAt(14),
                        this.m_t0 = this.getTransitionAt(0), this.m_t1 = this.getTransitionAt(1);
                }, e.URL = "ui://rijcngz1v1m3b5", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        94: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_save");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_button = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n1 = this.getChildAt(1), this.m_n2 = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1evqxcn", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        95: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_sharesjbx");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1),
                        this.m_icon = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1v1m3b4", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        96: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_shipingsjbx");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_title = this.getChildAt(1),
                        this.m_icon = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1v1m3b3", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        97: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "btn_start");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_n60 = this.getChildAt(0), this.m_n59 = this.getChildAt(1),
                        this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1j0hp52", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        98: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "duanweitiao");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labDuanwei = this.getChildAt(0),
                        this.m_prgDuan = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1xv2p89", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        99: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "footballkzq");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_imgDi = this.getChildAt(0), this.m_imgWu = this.getChildAt(1),
                        this.m_imgWo = this.getChildAt(2);
                }, e.URL = "ui://rijcngz1iac85x", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        100: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "freesuipian");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_n0 = this.getChildAt(0), this.m_labPfsx = this.getChildAt(1),
                        this.m_labPfmc = this.getChildAt(2), this.m_btnTg = this.getChildAt(3), this.m_night = this.getChildAt(4),
                        this.m_btnFengxsp = this.getChildAt(5), this.m_btnShipsp = this.getChildAt(6), this.m_prgSuipian = this.getChildAt(7),
                        this.m_labSpjd = this.getChildAt(8), this.m_labJrsycs = this.getChildAt(9), this.m_labJcs = this.getChildAt(10),
                        this.m_labPifuleix = this.getChildAt(11), this.m_labZhongji = this.getChildAt(12),
                        this.m_labGaoji = this.getChildAt(13), this.m_labXiyou = this.getChildAt(14), this.m_iconPifusuip = this.getChildAt(15),
                        this.m_txt_add = this.getChildAt(16), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz16v0ybo", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        101: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "guanzhuyouli");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n0 = this.getChildAt(0), this.m_n1 = this.getChildAt(1),
                        this.m_n4 = this.getChildAt(2), this.m_n3 = this.getChildAt(3), this.m_n5 = this.getChildAt(4),
                        this.m_btnClose = this.getChildAt(5), this.m_n11 = this.getChildAt(6), this.m_btnCopyText = this.getChildAt(7),
                        this.m_n44 = this.getChildAt(8), this.m_n45 = this.getChildAt(9), this.m_n47 = this.getChildAt(10),
                        this.m_gameId = this.getChildAt(11), this.m_n27 = this.getChildAt(12), this.m_n31 = this.getChildAt(13),
                        this.m_btnSaveImg = this.getChildAt(14), this.m_n19 = this.getChildAt(15), this.m_n46 = this.getChildAt(16),
                        this.m_n16 = this.getChildAt(17), this.m_n8 = this.getChildAt(18), this.m_n9 = this.getChildAt(19),
                        this.m_n10 = this.getChildAt(20);
                }, e.URL = "ui://rijcngz1evqxcj", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        102: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "home");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_c3 = this.getControllerAt(2), this.m_n340 = this.getChildAt(0),
                        this.m_n340.visible = !1
                    this.m_logo = this.getChildAt(1), this.m_btnShare = this.getChildAt(2), this.m_btnPifu = this.getChildAt(3),
                        this.m_n77 = this.getChildAt(4), this.m_n84 = this.getChildAt(5), this.m_n86 = this.getChildAt(6),
                        this.m_n87 = this.getChildAt(7), this.m_imgFootball = this.getChildAt(8), this.m_n114 = this.getChildAt(9),
                        this.m_btnStart = this.getChildAt(10),
                        this.m_btnStart.width = 300
                    this.m_btnStart.height = 113

                    this.m_btnStart.scaleX = this.m_btnStart.scaleY = 1.3
                    this.m_n163 = this.getChildAt(11), this.m_pipeiwo = this.getChildAt(12),
                        this.m_pipeiaduishou = this.getChildAt(13), this.m_n161 = this.getChildAt(14), this.m_n171 = this.getChildAt(15),
                        this.m_listPifushop = this.getChildAt(16),
                        window.llll = this.m_listPifushop
                    llll.y = 520
                    this.m_btnbackb = this.getChildAt(17),
                        this.m_n184 = this.getChildAt(18), this.m_n186 = this.getChildAt(19), this.m_n185 = this.getChildAt(20),
                        this.m_n187 = this.getChildAt(21), this.m_labSmjlb = this.getChildAt(22), this.m_labBanbenhao = this.getChildAt(23),
                        this.m_labWanjia = this.getChildAt(24),
                        this.m_labWanjia.text = "You "
                    this.m_labDuishou = this.getChildAt(25),
                        this.m_labDuishou.text = "Player "
                    this.m_labWbf = this.getChildAt(26), this.m_labDsbf = this.getChildAt(27), this.m_labGx = this.getChildAt(28),
                        this.m_labTishi = this.getChildAt(29),
                        this.m_labTishi.visible = !1

                    this.m_labPifushangcheng = this.getChildAt(30),
                        this.m_labPifushangcheng.text = "Shop"


                    this.m_labZzxz = this.getChildAt(31),
                        this.m_labZzxz.text = "Match..."

                    this.m_labDuishoub = this.getChildAt(32),
                        this.m_labXunzhaoduishou = this.getChildAt(33),
                        this.m_labXunzhaoduishou.visible = !1
                    this.m_n245 = this.getChildAt(34),
                        this.m_labPifumingchen = this.getChildAt(35), this.m_labPifujieshao = this.getChildAt(36),
                        this.m_labSxjc = this.getChildAt(37),
                        this.m_labSxjc.text = "Up: "
                    this.m_labSxjc.y = 220
                    this.m_labSxjcmx = this.getChildAt(38),
                        this.m_labSxjcmx.y = 249
                    this.m_labPflx = this.getChildAt(39),
                        this.m_labPflx.text = "Level:"
                    this.m_labChuj = this.getChildAt(40),
                        this.m_labChuj.text = "Primary "
                    this.m_labZhongj = this.getChildAt(41),
                        this.m_labZhongj.text = "Medium "

                    this.m_labGaoj = this.getChildAt(42),
                        this.m_labGaoj.text = "High "

                    this.m_labXiy = this.getChildAt(43),
                        this.m_labXiy.text = "Unusual "


                    this.m_n181 = this.getChildAt(44), this.m_cmpBsks = this.getChildAt(45),
                        this.m_bisaijieguoa = this.getChildAt(46), this.m_n207 = this.getChildAt(47), this.m_n208 = this.getChildAt(48),
                        this.m_n209 = this.getChildAt(49), this.m_iconWanjia = this.getChildAt(50), this.m_iconDuishou = this.getChildAt(51),
                        this.m_bisaibifen = this.getChildAt(52), this.m_btnYaoqinghaoli = this.getChildAt(53),
                        this.m_btnZhengbisai = this.getChildAt(54), this.m_btnShequ = this.getChildAt(55),
                        this.m_btnTop = this.getChildAt(56), this.m_btnTianjia = this.getChildAt(57), this.m_btnRmg = this.getChildAt(58),
                        this.m_prgDuanb = this.getChildAt(59), this.m_iconDuanweia = this.getChildAt(60),
                        this.m_iconDuanweid = this.getChildAt(61), this.m_iconDuanweie = this.getChildAt(62),
                        this.m_Playergoldb = this.getChildAt(63), this.m_n272 = this.getChildAt(64), this.m_n302 = this.getChildAt(65),
                        this.m_labDaojishib = this.getChildAt(66), this.m_jifeids = this.getChildAt(67),
                        this.m_n299 = this.getChildAt(68), this.m_labSmjlc = this.getChildAt(69),
                        this.m_labSmjlc.text = "Goal: "

                    this.m_n305 = this.getChildAt(70),
                        this.m_labJianglije = this.getChildAt(71),

                        this.m_labJianglije.y = 810
                    this.m_smjl = this.getChildAt(72), this.m_n303 = this.getChildAt(73),
                        this.m_n310 = this.getChildAt(74), this.m_n300 = this.getChildAt(75), this.m_labTeshujiangli = this.getChildAt(76),
                        this.m_btnJs = this.getChildAt(77),
                        this.m_btnJs.m_title.text = " Buy "


                    this.m_btnFxsyb = this.getChildAt(78),
                        this.m_btnSy = this.getChildAt(79),
                        this.m_btnSy.m_title.text = " Use "



                    this.m_btnHc = this.getChildAt(80),
                        this.m_btnFree = this.getChildAt(81),
                        this.m_btnYqhyou = this.getChildAt(82),
                        this.m_btnTjcxb = this.getChildAt(83), this.m_labSycs = this.getChildAt(84), this.m_n319 = this.getChildAt(85),
                        this.m_labWjid = this.getChildAt(86), this.m_baoxianglana = this.getChildAt(87),
                        this.m_baoxianglanb = this.getChildAt(88), this.m_baoxianglanc = this.getChildAt(89),
                        this.m_baoxiangland = this.getChildAt(90), this.m_n341 = this.getChildAt(91), this.m_prgDuanc = this.getChildAt(92),
                        this.m_iconDuanweif = this.getChildAt(93), this.m_btnDjlq = this.getChildAt(94),
                        this.m_n346 = this.getChildAt(95), this.m_n350 = this.getChildAt(96), this.m_n354 = this.getChildAt(97),
                        this.m_labGrjf = this.getChildAt(98),

                        this.m_labGrjf.text = "Hit "
                    this.m_labShuzia = this.getChildAt(99), this.m_iconJingbie = this.getChildAt(100),
                        this.m_labGrjq = this.getChildAt(101),

                        this.m_labGrjq.text = "Goal "
                    this.m_labShuzib = this.getChildAt(102),
                        this.m_iconJingbif = this.getChildAt(103),


                        this.m_labBsdf = this.getChildAt(104),


                        this.m_labBsdf.text = "Win "
                    this.m_labShuzic = this.getChildAt(105), this.m_iconJingbih = this.getChildAt(106),
                        this.m_labDwjljc = this.getChildAt(107),

                        this.m_prgXydj = this.getChildAt(108),
                        this.m_yaoyaole = this.getChildAt(109), this.m_luckdajiang = this.getChildAt(110),
                        this.m_redhit = this.getChildAt(111), this.m_newmask = this.getChildAt(112), this.m_btnLuck = this.getChildAt(113),
                        this.m_newmask.visible = !1
                    this.m_btnQd = this.getChildAt(114), this.m_btnVip = this.getChildAt(115),
                        this.m_btnGZYL = this.getChildAt(116),
                        this.m_n375 = this.getChildAt(117), this.m_btn_continue = this.getChildAt(118),
                        this.m_btnTiaozhuan = this.getChildAt(119), this.m_t0 = this.getTransitionAt(0),
                        this.m_t1 = this.getTransitionAt(1), this.m_t2 = this.getTransitionAt(2), this.m_t3 = this.getTransitionAt(3),
                        this.m_lianxujifeia = this.getTransitionAt(4), this.m_lianxujifeib = this.getTransitionAt(5),
                        this.m_jinbifangda = this.getTransitionAt(6), this.m_hand = this.getTransitionAt(7);
                }, e.URL = "ui://rijcngz1l4ss28", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        103: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "jflj");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n293 = this.getChildAt(0), this.m_n294 = this.getChildAt(1),
                        this.m_n295 = this.getChildAt(2), this.m_labLjs = this.getChildAt(3);
                }, e.URL = "ui://rijcngz1gf0h91", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        104: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "jiajinbi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n1 = this.getChildAt(1), this.m_labHqjb = this.getChildAt(2),
                        this.m_btnGbc = this.getChildAt(3), this.m_btnLqjbi = this.getChildAt(4), this.m_labSycs = this.getChildAt(5),
                        this.m_labYqxwj = this.getChildAt(6), this.m_iconJinbic = this.getChildAt(7), this.m_btnLqjbfx = this.getChildAt(8);
                }, e.URL = "ui://rijcngz1rwqzb8", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        105: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "jiesuopifu");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n6 = this.getChildAt(0), this.m_n7 = this.getChildAt(1),
                        this.m_btnGbb = this.getChildAt(2), this.m_btnSypf = this.getChildAt(3), this.m_n11 = this.getChildAt(4),
                        this.m_labPfshuxingb = this.getChildAt(5), this.m_labPfmcb = this.getChildAt(6),
                        this.m_night = this.getChildAt(7), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1enrd9o", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        106: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "jifeishuzi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n1 = this.getChildAt(0), this.m_n2 = this.getChildAt(1),
                        this.m_labJbsz = this.getChildAt(2), this.m_jifeijlsz = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1jqa994", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        107: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "luckshuzi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labSzi = this.getChildAt(0),
                        this.m_n3 = this.getChildAt(1);
                }, e.URL = "ui://rijcngz1powebk", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        108: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "pifuhuode");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n2 = this.getChildAt(0), this.m_n0 = this.getChildAt(1),
                        this.m_pifujiangli = this.getChildAt(2),
                        this.m_pifujiangli.visible = !1
                    this.m_btnLjsya = this.getChildAt(3), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1xxc27g", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        109: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "pifushiyongjiemian");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_n0 = this.getChildAt(0), this.m_labPfsx = this.getChildAt(1),
                        this.m_labPfmc = this.getChildAt(2), this.m_btnSpsy = this.getChildAt(3), this.m_btnFxsy = this.getChildAt(4),
                        this.m_btnTg = this.getChildAt(5), this.m_night = this.getChildAt(6), this.m_labJrsycs = this.getChildAt(7),
                        this.m_labJcs = this.getChildAt(8), this.m_labPifuleix = this.getChildAt(9), this.m_labChu = this.getChildAt(10),
                        this.m_labZhong = this.getChildAt(11), this.m_labGao = this.getChildAt(12), this.m_labXi = this.getChildAt(13),
                        this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1xxc27l", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        110: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "pifuxiang");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_button = this.getControllerAt(1), this.m_n173 = this.getChildAt(0), this.m_pifu2 = this.getChildAt(1),
                        this.m_pifu3 = this.getChildAt(2), this.m_n177 = this.getChildAt(3),
                        this.m_labYishiyong = this.getChildAt(4),
                        this.m_labYishiyong.text = "Using"
                    this.m_labYiyy = this.getChildAt(5),
                        this.m_labYiyy.text = "Owned"
                    this.m_labbaoxjs = this.getChildAt(6),
                        this.m_labShuliang = this.getChildAt(7),
                        window.ssss = this.m_labShuliang
                    this.m_iconFifu = this.getChildAt(8), this.m_prgSuipian = this.getChildAt(9), this.m_iconPifujb = this.getChildAt(10),
                        this.m_iconPifujb.visible = !1
                    this.m_n184 = this.getChildAt(11);
                }, e.URL = "ui://rijcngz1hsl35d", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        111: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "qiandao");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_btnGbb = this.getChildAt(1), this.m_n3 = this.getChildAt(2),
                        this.m_labBxmc = this.getChildAt(3), this.m_btnLqjlsp = this.getChildAt(4), this.m_btnLqjlshare = this.getChildAt(5),
                        this.m_n21 = this.getChildAt(6), this.m_n22 = this.getChildAt(7), this.m_n23 = this.getChildAt(8),
                        this.m_n17 = this.getChildAt(9), this.m_n18 = this.getChildAt(10), this.m_n19 = this.getChildAt(11),
                        this.m_n25 = this.getChildAt(12);
                }, e.URL = "ui://rijcngz1stvcbv", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        112: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "qiandaodb");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n0 = this.getChildAt(0), this.m_n3 = this.getChildAt(1), this.m_labTianshu = this.getChildAt(2),
                        this.m_labQdje = this.getChildAt(3), this.m_n1 = this.getChildAt(4), this.m_n2 = this.getChildAt(5);
                }, e.URL = "ui://rijcngz1stvcby", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        113: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "shengmjinbi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n311 = this.getChildAt(0), this.m_shengmengjlcx = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1jqa993", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        114: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "shipingjiangli");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n211 = this.getChildAt(0), this.m_labHuodejinbi = this.getChildAt(1),
                        this.m_n215 = this.getChildAt(2), this.m_n217 = this.getChildAt(3), this.m_n218 = this.getChildAt(4),
                        this.m_n219 = this.getChildAt(5), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1mgea6d", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        115: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "thanks");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_labXiexie = this.getChildAt(0);
                }, e.URL = "ui://rijcngz1xxc27j", e;
            }(fairygui.GButton);
            i.default = n;
        }, {}],
        116: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "tianjiaxcx");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n3 = this.getChildAt(0), this.m_n0 = this.getChildAt(1),
                        this.m_n1 = this.getChildAt(2), this.m_n2 = this.getChildAt(3), this.m_n5 = this.getChildAt(4),
                        this.m_labCzbz = this.getChildAt(5), this.m_btnGbc = this.getChildAt(6), this.m_labAdj = this.getChildAt(7),
                        this.m_labBdj = this.getChildAt(8), this.m_labAysj = this.getChildAt(9), this.m_labBtj = this.getChildAt(10),
                        this.m_labCdj = this.getChildAt(11), this.m_labCgb = this.getChildAt(12), this.m_labDdj = this.getChildAt(13),
                        this.m_labDwd = this.getChildAt(14), this.m_labWdxc = this.getChildAt(15), this.m_labEhd = this.getChildAt(16),
                        this.m_labHdpf = this.getChildAt(17), this.m_btnPfzsb = this.getChildAt(18), this.m_labPfshuxingb = this.getChildAt(19);
                }, e.URL = "ui://rijcngz1xxc27c", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        117: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "top");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_listPaihangb = this.getChildAt(0),
                        this.m_btnYaoqing = this.getChildAt(1), this.m_n243 = this.getChildAt(2), this.m_ranking = this.getChildAt(3),
                        this.m_n239 = this.getChildAt(4), this.m_labWorldlist = this.getChildAt(5), this.m_btnGuanbi = this.getChildAt(6),
                        this.m_labMingci = this.getChildAt(7), this.m_labTouxiang = this.getChildAt(8),
                        this.m_labNichen = this.getChildAt(9), this.m_labJingbi = this.getChildAt(10), this.m_n251 = this.getChildAt(11),
                        this.m_labWeishangb = this.getChildAt(12), this.m_iconWjiatx = this.getChildAt(13),
                        this.m_labWjiamzi = this.getChildAt(14), this.m_labWjiachibil = this.getChildAt(15),
                        this.m_labTishi = this.getChildAt(16), this.m_iconDuanweih = this.getChildAt(17);
                }, e.URL = "ui://rijcngz1741z79", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        118: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "topditiao");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_c2 = this.getControllerAt(1), this.m_gray = this.getChildAt(0), this.m_black = this.getChildAt(1),
                        this.m_iconPhbtx = this.getChildAt(2), this.m_labWjnc = this.getChildAt(3), this.m_labPhbjb = this.getChildAt(4),
                        this.m_labOne = this.getChildAt(5), this.m_labTwo = this.getChildAt(6), this.m_labThree = this.getChildAt(7),
                        this.m_labFour = this.getChildAt(8), this.m_iconDuanweig = this.getChildAt(9);
                }, e.URL = "ui://rijcngz1741z7a", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        119: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "wanjiapipeixinxi");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_pipei = this.getControllerAt(0),
                        this.m_n147 = this.getChildAt(0), this.m_n148 = this.getChildAt(1), this.m_n149 = this.getChildAt(2),
                        this.m_n156 = this.getChildAt(3), this.m_labWofang = this.getChildAt(4), this.m_labDifangmc = this.getChildAt(5),

                        // this.m_labDifangmc.text = "Find..."
                        this.m_labSousuo = this.getChildAt(6),
                        this.m_labSousuo.text = "Match..."
                    this.m_iconWeixintx = this.getChildAt(7),
                        this.m_iconDuanweib = this.getChildAt(8), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1lglf5b", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        120: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "win");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n104 = this.getChildAt(0), this.m_n105 = this.getChildAt(1),
                        this.m_n106 = this.getChildAt(2), this.m_t0 = this.getTransitionAt(0);
                }, e.URL = "ui://rijcngz1j0hp51", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        121: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "xiaokuang");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_n9 = this.getChildAt(0), this.m_n13 = this.getChildAt(1),
                        this.m_labCzbz = this.getChildAt(2), this.m_btnGbc = this.getChildAt(3), this.m_labYqxwj = this.getChildAt(4),
                        this.m_btnLjsya = this.getChildAt(5);
                }, e.URL = "ui://rijcngz1org4ag", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        122: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "yaoqingbang");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_c1 = this.getControllerAt(0),
                        this.m_n7 = this.getChildAt(0), this.m_labJianglmc = this.getChildAt(1), this.m_labWanjiaxuhao = this.getChildAt(2),
                        this.m_iconSuipjinb = this.getChildAt(3), this.m_btnLqjl = this.getChildAt(4), this.m_labYlq = this.getChildAt(5),
                        this.m_labWyq = this.getChildAt(6);
                }, e.URL = "ui://rijcngz1k00iaw", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        123: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t),
                    e.createInstance = function () {
                        return fairygui.UIPackage.createObject("ui", "yaoqinghaoli");
                    }, e.prototype.constructFromXML = function (e) {

                        t.prototype.constructFromXML.call(this, e),
                            this.m_c1 = this.getControllerAt(0),

                            this.m_n233 = this.getChildAt(0),
                            this.m_n235 = this.getChildAt(1),
                            this.m_btnGb = this.getChildAt(2),
                            window.gggg = this.m_btnGb

                        this.m_btnYqhyb = this.getChildAt(3),
                            this.m_btnPfzs = this.getChildAt(4),
                            this.m_n239 = this.getChildAt(5),
                            this.m_n252 = this.getChildAt(6),
                            this.m_labYqshuoming = this.getChildAt(7),
                            this.m_labPfshuxing = this.getChildAt(8),
                            this.m_listYaoqb = this.getChildAt(9),
                            this.m_labYqrs = this.getChildAt(10),
                            this.m_labDyjl = this.getChildAt(11),
                            this.m_labZhuangt = this.getChildAt(12),
                            this.m_btnReceive = this.getChildAt(13);
                        this.m_c1.parent.visible = !1

                    }, e.URL = "ui://rijcngz1cqjp6r", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        124: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("ui", "zhiding");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e),
                        this.m_n0 = this.getChildAt(0),
                        this.m_n3 = this.getChildAt(1),
                        this.m_n4 = this.getChildAt(2), this.m_labCzbz = this.getChildAt(3),
                        this.m_btnGbc = this.getChildAt(4),
                        this.m_labAdj = this.getChildAt(5), this.m_labBdj = this.getChildAt(6),
                        this.m_labAysj = this.getChildAt(7),
                        this.m_labBtj = this.getChildAt(8), this.m_labCdj = this.getChildAt(9),
                        this.m_labCgb = this.getChildAt(10),
                        this.m_labEhd = this.getChildAt(11), this.m_labHdpf = this.getChildAt(12),
                        this.m_btnPfzsb = this.getChildAt(13),
                        this.m_labPfshuxingb = this.getChildAt(14), this.m_n20 = this.getChildAt(15),
                        this.m_iconXcx = this.getChildAt(16),
                        this.m_labGd = this.getChildAt(17), this.m_iconHot = this.getChildAt(18),
                        this.m_labIcondld = this.getChildAt(19);

                }, e.URL = "ui://rijcngz1wfsac3", e;
            }(fairygui.GComponent);
            i.default = n;
        }, {}],
        125: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./UI_freesuipian"), r = t("./UI_top"), a = t("./UI_topditiao"), s = t("./UI_animChangjingqiehuan"), o = t("./UI_btnError"),
                l = t("./UI_yaoqinghaoli"), h = t("./UI_bisaijieguo"), u = t("./UI_btnLiping"), c = t("./UI_jiesuopifu"), d = t("./UI_btnGift"), _ = t("./UI_guanzhuyouli"), f = t("./UI_btn_copy"), p = t("./UI_btn_save"), m = t("./UI_btn_gain_continue"), g = t("./UI_addPlayers"), y = t("./UI_ProgressBar4"), v = t("./UI_baoxiang"), S = t("./UI_btn_kaibaoxiang"), T = t("./UI_baoxiangjiasu"), E = t("./UI_baoxiangkaiqi"), C = t("./UI_baoxiangjl"), x = t("./UI_btn_defaultVioletIcon"), b = t("./UI_jflj"), I = t("./UI_pifuxiang"), w = t("./UI_btn_defaultOrangeL"), A = t("./UI_btn_gain_close"), R = t("./UI_footballkzq"), M = t("./UI_btnRmgame"), D = t("./UI_win"), O = t("./UI_btn_start"), L = t("./UI_shengmjinbi"), P = t("./UI_jifeishuzi"), N = t("./UI_yaoqingbang"), B = t("./UI_btn_gain_directly"), F = t("./UI_btnBuy"), k = t("./UI_btnDianjilq"), V = t("./UI_btn_defaultOrangeIcon"), U = t("./UI_home"), G = t("./UI_btnShareb"), z = t("./UI_btnPif"), H = t("./UI_wanjiapipeixinxi"), j = t("./UI_ProgressBar2"),
                W = t("./UI_baoxianghuoqu"), X = t("./UI_shipingjiangli"), Y = t("./UI_bisaijc"), q = t("./UI_xiaokuang"), K = t("./UI_btnTiaozhuan"), Z = t("./UI_Luck"), Q = t("./UI_luckshuzi"), J = t("./UI_btnShequ"), $ = t("./UI_btnTop"), tt = t("./UI_Toast"), et = t("./UI_SharingVideo"), it = t("./UI_btn_defaultOrange"), nt = t("./UI_btn_defaultOranges"), rt = t("./UI_jiajinbi"), at = t("./UI_ProgressBar3"), st = t("./UI_qiandao"), ot = t("./UI_qiandaodb"), lt = t("./UI_btnQandao"), ht = t("./UI_btnVip"), ut = t("./UI_btnFqsj"), ct = t("./UI_btn_shipingsjbx"), dt = t("./UI_btn_sharesjbx"), _t = t("./UI_btn_sanbeilq"), ft = t("./UI_Playergold"), pt = t("./UI_zhiding"), mt = t("./UI_duanweitiao"), gt = t("./UI_ProgressBar1"), yt = t("./UI_btnTianjiaxcx"), vt = t("./UI_tianjiaxcx"), St = t("./UI_pifuhuode"), Tt = t("./UI_thanks"), Et = t("./UI_pifushiyongjiemian"),
                Ct = function () {
                    function t() { }
                    return t.bindAll = function () {
                        fairygui.UIObjectFactory.setPackageItemExtension(n.default.URL, n.default), fairygui.UIObjectFactory.setPackageItemExtension(r.default.URL, r.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(a.default.URL, a.default), fairygui.UIObjectFactory.setPackageItemExtension(s.default.URL, s.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(o.default.URL, o.default),


                            fairygui.UIObjectFactory.setPackageItemExtension(l.default.URL, l.default),




                            fairygui.UIObjectFactory.setPackageItemExtension(h.default.URL, h.default), fairygui.UIObjectFactory.setPackageItemExtension(u.default.URL, u.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(c.default.URL, c.default), fairygui.UIObjectFactory.setPackageItemExtension(d.default.URL, d.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(_.default.URL, _.default), fairygui.UIObjectFactory.setPackageItemExtension(f.default.URL, f.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(p.default.URL, p.default), fairygui.UIObjectFactory.setPackageItemExtension(m.default.URL, m.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(g.default.URL, g.default), fairygui.UIObjectFactory.setPackageItemExtension(y.default.URL, y.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(v.default.URL, v.default), fairygui.UIObjectFactory.setPackageItemExtension(S.default.URL, S.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(T.default.URL, T.default), fairygui.UIObjectFactory.setPackageItemExtension(E.default.URL, E.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(C.default.URL, C.default), fairygui.UIObjectFactory.setPackageItemExtension(x.default.URL, x.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(b.default.URL, b.default), fairygui.UIObjectFactory.setPackageItemExtension(I.default.URL, I.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(w.default.URL, w.default), fairygui.UIObjectFactory.setPackageItemExtension(A.default.URL, A.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(R.default.URL, R.default), fairygui.UIObjectFactory.setPackageItemExtension(M.default.URL, M.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(D.default.URL, D.default), fairygui.UIObjectFactory.setPackageItemExtension(O.default.URL, O.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(L.default.URL, L.default), fairygui.UIObjectFactory.setPackageItemExtension(P.default.URL, P.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(N.default.URL, N.default), fairygui.UIObjectFactory.setPackageItemExtension(B.default.URL, B.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(F.default.URL, F.default), fairygui.UIObjectFactory.setPackageItemExtension(k.default.URL, k.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(V.default.URL, V.default), fairygui.UIObjectFactory.setPackageItemExtension(U.default.URL, U.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(G.default.URL, G.default), fairygui.UIObjectFactory.setPackageItemExtension(z.default.URL, z.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(H.default.URL, H.default), fairygui.UIObjectFactory.setPackageItemExtension(j.default.URL, j.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(W.default.URL, W.default), fairygui.UIObjectFactory.setPackageItemExtension(X.default.URL, X.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(Y.default.URL, Y.default), fairygui.UIObjectFactory.setPackageItemExtension(q.default.URL, q.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(K.default.URL, K.default), fairygui.UIObjectFactory.setPackageItemExtension(Z.default.URL, Z.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(Q.default.URL, Q.default), fairygui.UIObjectFactory.setPackageItemExtension(J.default.URL, J.default),
                            fairygui.UIObjectFactory.setPackageItemExtension($.default.URL, $.default), fairygui.UIObjectFactory.setPackageItemExtension(tt.default.URL, tt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(et.default.URL, et.default), fairygui.UIObjectFactory.setPackageItemExtension(it.default.URL, it.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(nt.default.URL, nt.default), fairygui.UIObjectFactory.setPackageItemExtension(rt.default.URL, rt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(at.default.URL, at.default), fairygui.UIObjectFactory.setPackageItemExtension(st.default.URL, st.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(ot.default.URL, ot.default), fairygui.UIObjectFactory.setPackageItemExtension(lt.default.URL, lt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(ht.default.URL, ht.default), fairygui.UIObjectFactory.setPackageItemExtension(ut.default.URL, ut.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(ct.default.URL, ct.default), fairygui.UIObjectFactory.setPackageItemExtension(dt.default.URL, dt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(_t.default.URL, _t.default), fairygui.UIObjectFactory.setPackageItemExtension(ft.default.URL, ft.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(pt.default.URL, pt.default), fairygui.UIObjectFactory.setPackageItemExtension(mt.default.URL, mt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(gt.default.URL, gt.default), fairygui.UIObjectFactory.setPackageItemExtension(yt.default.URL, yt.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(vt.default.URL, vt.default), fairygui.UIObjectFactory.setPackageItemExtension(St.default.URL, St.default),
                            fairygui.UIObjectFactory.setPackageItemExtension(Tt.default.URL, Tt.default), fairygui.UIObjectFactory.setPackageItemExtension(Et.default.URL, Et.default);
                    }, t;
                }();
            i.default = Ct;
        }, {
            "./UI_Luck": 51,
            "./UI_Playergold": 52,
            "./UI_ProgressBar1": 53,
            "./UI_ProgressBar2": 54,
            "./UI_ProgressBar3": 55,
            "./UI_ProgressBar4": 56,
            "./UI_SharingVideo": 57,
            "./UI_Toast": 58,
            "./UI_addPlayers": 59,
            "./UI_animChangjingqiehuan": 60,
            "./UI_baoxiang": 61,
            "./UI_baoxianghuoqu": 62,
            "./UI_baoxiangjiasu": 63,
            "./UI_baoxiangjl": 64,
            "./UI_baoxiangkaiqi": 65,
            "./UI_bisaijc": 66,
            "./UI_bisaijieguo": 67,
            "./UI_btnBuy": 68,
            "./UI_btnDianjilq": 69,
            "./UI_btnError": 70,
            "./UI_btnFqsj": 71,
            "./UI_btnGift": 72,
            "./UI_btnLiping": 73,
            "./UI_btnPif": 74,
            "./UI_btnQandao": 75,
            "./UI_btnRmgame": 76,
            "./UI_btnShareb": 77,
            "./UI_btnShequ": 78,
            "./UI_btnTianjiaxcx": 79,
            "./UI_btnTiaozhuan": 80,
            "./UI_btnTop": 81,
            "./UI_btnVip": 82,
            "./UI_btn_copy": 83,
            "./UI_btn_defaultOrange": 84,
            "./UI_btn_defaultOrangeIcon": 85,
            "./UI_btn_defaultOrangeL": 86,
            "./UI_btn_defaultOranges": 87,
            "./UI_btn_defaultVioletIcon": 88,
            "./UI_btn_gain_close": 89,
            "./UI_btn_gain_continue": 90,
            "./UI_btn_gain_directly": 91,
            "./UI_btn_kaibaoxiang": 92,
            "./UI_btn_sanbeilq": 93,
            "./UI_btn_save": 94,
            "./UI_btn_sharesjbx": 95,
            "./UI_btn_shipingsjbx": 96,
            "./UI_btn_start": 97,
            "./UI_duanweitiao": 98,
            "./UI_footballkzq": 99,
            "./UI_freesuipian": 100,
            "./UI_guanzhuyouli": 101,
            "./UI_home": 102,
            "./UI_jflj": 103,
            "./UI_jiajinbi": 104,
            "./UI_jiesuopifu": 105,
            "./UI_jifeishuzi": 106,
            "./UI_luckshuzi": 107,
            "./UI_pifuhuode": 108,
            "./UI_pifushiyongjiemian": 109,
            "./UI_pifuxiang": 110,
            "./UI_qiandao": 111,
            "./UI_qiandaodb": 112,
            "./UI_shengmjinbi": 113,
            "./UI_shipingjiangli": 114,
            "./UI_thanks": 115,
            "./UI_tianjiaxcx": 116,
            "./UI_top": 117,
            "./UI_topditiao": 118,
            "./UI_wanjiapipeixinxi": 119,
            "./UI_win": 120,
            "./UI_xiaokuang": 121,
            "./UI_yaoqingbang": 122,
            "./UI_yaoqinghaoli": 123,
            "./UI_zhiding": 124
        }],
        126: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n, r = t("./base/BaseComponent"), a = t("./collision/components/ContactComponent"), s = t("./collision/components/CollisionEventComponent"), o = t("./render/components/ModelComponent"), l = t("./render/components/CameraComponent"), h = t("./render/components/RenderNodeComponent"), u = t("./movement/components/DirectionMoveComponent"), c = t("./movement/components/SlideComponent"), d = t("./movement/components/FlightComponent"), _ = t("./movement/components/FollowComponent"), f = t("./render/components/RotationComponent"), p = t("./render/components/PositionComponent"), m = t("./render/components/ForwardComponent"), g = t("./render/components/HeightComponent"), y = t("./movement/components/ValidAreaComponet"), v = t("./collision/components/ColliderComponent"), S = t("./game/components/PlayerComponet"), T = t("./game/components/RobotComponent"), E = t("./game/components/ActionComponent"), C = t("./game/components/SpeedLimitComponent"), x = t("./game/components/AnimationComponent"), b = t("./game/components/StateComponent"), I = t("./timer/components/TimerHandlerComponent"), w = t("./render/components/RollingComponent"), A = t("./game/components/GameCollisionComponent"), R = t("./game/components/UnitComponent"), M = t("./game/components/SpeedAnimationComponent"), D = t("./timer/components/LifeDurationComponent"), O = t("./movement/components/BezierMoveComponent"), L = t("./movement/components/OutofValidEventComponent"), P = t("./game/components/MoveInEmitComponent"), N = t("./timer/components/TimeScalerComponent"), B = t("./game/components/GameOverEventComponent"), F = t("./render/components/ColorComponent"), k = t("./render/components/SceneParticleComponent"), V = t("./render/components/ParticlePanelComponent"), U = t("./game/components/RenderUpdaterComponent"), G = t("./sound/components/MusicPlayerCompnonent"), z = t("./sound/components/SoundPlayerCompnonent"), H = t("./game/components/ActionForwardCompenent"), j = t("./render/components/ModelTextureComponent"), W = t("./device/components/DeviceVibrateComponent"), X = t("./render/components/OffsetComponent"), Y = t("./render/components/SimpleAnimationComponent"), q = t("./render/components/SyncPosAndHeightComponent"), K = t("./game/components/BehaviorComponent"), Z = t("./game/components/StrongComponent"), Q = t("./game/components/AutoSkillComponent"), J = t("./game/components/WaitingRelifeComponent"), $ = t("./game/components/AttrBehaviorComponent"), tt = t("./movement/components/FloatToComponent"), et = t("./render/components/StaticRenderComponent"), it = t("./game/components/AttrNumberComponent");
            !function (t) {
                t[t.TimerHandler = 0] = "TimerHandler", t[t.Contact = 1] = "Contact", t[t.Collision = 2] = "Collision",
                    t[t.OutofValid = 3] = "OutofValid", t[t.MusicPlayer = 4] = "MusicPlayer", t[t.SoundPlayer = 5] = "SoundPlayer",
                    t[t.DeviceVibrate = 6] = "DeviceVibrate", t[t.Ball = 7] = "Ball", t[t.Role = 8] = "Role",
                    t[t.Player = 9] = "Player", t[t.Robot = 10] = "Robot", t[t.BallHolder = 11] = "BallHolder",
                    t[t.RelifePoint = 12] = "RelifePoint", t[t.Action = 13] = "Action", t[t.Behavior = 14] = "Behavior",
                    t[t.SpeedLimit = 15] = "SpeedLimit", t[t.ActionForward = 16] = "ActionForward",
                    t[t.Model = 17] = "Model", t[t.Camera = 18] = "Camera", t[t.Particle = 19] = "Particle",
                    t[t.RenderNode = 20] = "RenderNode", t[t.ModelTexture = 21] = "ModelTexture", t[t.Animation = 22] = "Animation",
                    t[t.SpeedAnimation = 23] = "SpeedAnimation", t[t.ParticlePanel = 24] = "ParticlePanel",
                    t[t.AutoSkill = 25] = "AutoSkill", t[t.State = 26] = "State", t[t.DirectionMove = 27] = "DirectionMove",
                    t[t.Slide = 28] = "Slide", t[t.FloatTo = 29] = "FloatTo", t[t.Flight = 30] = "Flight",
                    t[t.Bezier = 31] = "Bezier", t[t.WaitingRelife = 32] = "WaitingRelife", t[t.SimpleAnimation = 33] = "SimpleAnimation",
                    t[t.Follow = 34] = "Follow", t[t.Rolling = 35] = "Rolling", t[t.SyncPosAndHeight = 36] = "SyncPosAndHeight",
                    t[t.Strong = 37] = "Strong", t[t.AttrAISpeed = 38] = "AttrAISpeed", t[t.AttrSpeed = 39] = "AttrSpeed",
                    t[t.AttrHoldSpeed = 40] = "AttrHoldSpeed", t[t.AttrRockeySpeed = 41] = "AttrRockeySpeed",
                    t[t.AttrRockeyTime = 42] = "AttrRockeyTime", t[t.AttrHitDistance = 43] = "AttrHitDistance",
                    t[t.AttrHitDuration = 44] = "AttrHitDuration", t[t.AttrBahavior = 45] = "AttrBahavior",
                    t[t.Rotation = 46] = "Rotation", t[t.Position = 47] = "Position", t[t.Forward = 48] = "Forward",
                    t[t.Height = 49] = "Height", t[t.Color = 50] = "Color", t[t.Offset = 51] = "Offset",
                    t[t.RotationOnce = 52] = "RotationOnce", t[t.PositionOnce = 53] = "PositionOnce",
                    t[t.ForwardOnce = 54] = "ForwardOnce", t[t.HeightOnce = 55] = "HeightOnce", t[t.ColorOnce = 56] = "ColorOnce",
                    t[t.ValidArea = 57] = "ValidArea", t[t.Collider = 58] = "Collider", t[t.MoveInEmit = 59] = "MoveInEmit",
                    t[t.StaticRender = 60] = "StaticRender", t[t.GameCollision = 61] = "GameCollision",
                    t[t.RenderUpdater = 62] = "RenderUpdater", t[t.LifeDuration = 63] = "LifeDuration",
                    t[t.TimeScaler = 64] = "TimeScaler", t[t.GameOver = 65] = "GameOver", t[t.totalComponents = 66] = "totalComponents";
            }(n || (n = {})), r.regist("timerHandler", n.TimerHandler, I.default), r.regist("contact", n.Contact, a.default),
                r.regist("collision", n.Collision, s.default), r.regist("outofValid", n.OutofValid, L.default),
                r.regist("musicPlayer", n.MusicPlayer, G.default), r.regist("soundPlayer", n.SoundPlayer, z.default),
                r.regist("deviceVibrate", n.DeviceVibrate, W.default), r.regist("ball", n.Ball, R.BallComponent),
                r.regist("role", n.Role, R.RoleComponent), r.regist("player", n.Player, S.default),
                r.regist("robot", n.Robot, T.default), r.regist("ballHolder", n.BallHolder, R.BallHolderComponent),
                r.regist("relifePoint", n.RelifePoint, R.RelifePointComponent), r.regist("action", n.Action, E.default),
                r.regist("behavior", n.Behavior, K.default), r.regist("speedLimit", n.SpeedLimit, C.default),
                r.regist("actionForward", n.ActionForward, H.default), r.regist("animation", n.Animation, x.default),
                r.regist("speedAnimation", n.SpeedAnimation, M.default), r.regist("state", n.State, b.default),
                r.regist("strong", n.Strong, Z.default), r.regist("autoSkill", n.AutoSkill, Q.default),
                r.regist("attrSpeed", n.AttrSpeed, it.default), r.regist("attrAISpeed", n.AttrAISpeed, it.default),
                r.regist("attrHoldSpeed", n.AttrHoldSpeed, it.default), r.regist("attrRockeySpeed", n.AttrRockeySpeed, it.default),
                r.regist("attrRockeyTime", n.AttrRockeyTime, it.default), r.regist("attrHitDistance", n.AttrHitDistance, it.default),
                r.regist("attrHitDuration", n.AttrHitDuration, it.default), r.regist("attrBehavior", n.AttrBahavior, $.default),
                r.regist("model", n.Model, o.default), r.regist("camera", n.Camera, l.default),
                r.regist("particle", n.Particle, k.default), r.regist("renderNode", n.RenderNode, h.default),
                r.regist("particlePanel", n.ParticlePanel, V.default), r.regist("modelTexture", n.ModelTexture, j.default),
                r.regist("directionMove", n.DirectionMove, u.default), r.regist("slide", n.Slide, c.default),
                r.regist("floatTo", n.FloatTo, tt.default), r.regist("flight", n.Flight, d.default),
                r.regist("bezier", n.Bezier, O.default), r.regist("waitingRelife", n.WaitingRelife, J.default),
                r.regist("simpleAnimation", n.SimpleAnimation, Y.default), r.regist("follow", n.Follow, _.default),
                r.regist("rolling", n.Rolling, w.default), r.regist("syncPosAndHeight", n.SyncPosAndHeight, q.default),
                r.regist("rotation", n.Rotation, f.default), r.regist("position", n.Position, p.default),
                r.regist("forward", n.Forward, m.default), r.regist("height", n.Height, g.default),
                r.regist("color", n.Color, F.default), r.regist("offset", n.Offset, X.default),
                r.regist("rotationOnce", n.RotationOnce, f.default), r.regist("positionOnce", n.PositionOnce, p.default),
                r.regist("forwardOnce", n.ForwardOnce, m.default), r.regist("heightOnce", n.HeightOnce, g.default),
                r.regist("colorOnce", n.ColorOnce, F.default), r.regist("validArea", n.ValidArea, y.default),
                r.regist("collider", n.Collider, v.default), r.regist("moveInEmit", n.MoveInEmit, P.default),
                r.regist("staticRender", n.StaticRender, et.default), r.regist("gameCollision", n.GameCollision, A.default),
                r.regist("renderUpdater", n.RenderUpdater, U.default), r.regist("lifeDuration", n.LifeDuration, D.default),
                r.regist("timeScaler", n.TimeScaler, N.default), r.regist("gameOver", n.GameOver, B.default),
                i.default = n;
        }, {
            "./base/BaseComponent": 137,
            "./collision/components/ColliderComponent": 192,
            "./collision/components/CollisionEventComponent": 193,
            "./collision/components/ContactComponent": 194,
            "./device/components/DeviceVibrateComponent": 198,
            "./game/components/ActionComponent": 201,
            "./game/components/ActionForwardCompenent": 202,
            "./game/components/AnimationComponent": 203,
            "./game/components/AttrBehaviorComponent": 204,
            "./game/components/AttrNumberComponent": 205,
            "./game/components/AutoSkillComponent": 206,
            "./game/components/BehaviorComponent": 207,
            "./game/components/GameCollisionComponent": 208,
            "./game/components/GameOverEventComponent": 209,
            "./game/components/MoveInEmitComponent": 210,
            "./game/components/PlayerComponet": 211,
            "./game/components/RenderUpdaterComponent": 212,
            "./game/components/RobotComponent": 213,
            "./game/components/SpeedAnimationComponent": 214,
            "./game/components/SpeedLimitComponent": 215,
            "./game/components/StateComponent": 216,
            "./game/components/StrongComponent": 217,
            "./game/components/UnitComponent": 218,
            "./game/components/WaitingRelifeComponent": 219,
            "./movement/components/BezierMoveComponent": 247,
            "./movement/components/DirectionMoveComponent": 248,
            "./movement/components/FlightComponent": 249,
            "./movement/components/FloatToComponent": 250,
            "./movement/components/FollowComponent": 251,
            "./movement/components/OutofValidEventComponent": 252,
            "./movement/components/SlideComponent": 253,
            "./movement/components/ValidAreaComponet": 254,
            "./render/components/CameraComponent": 263,
            "./render/components/ColorComponent": 264,
            "./render/components/ForwardComponent": 265,
            "./render/components/HeightComponent": 266,
            "./render/components/ModelComponent": 267,
            "./render/components/ModelTextureComponent": 268,
            "./render/components/OffsetComponent": 269,
            "./render/components/ParticlePanelComponent": 270,
            "./render/components/PositionComponent": 271,
            "./render/components/RenderNodeComponent": 272,
            "./render/components/RollingComponent": 273,
            "./render/components/RotationComponent": 274,
            "./render/components/SceneParticleComponent": 275,
            "./render/components/SimpleAnimationComponent": 276,
            "./render/components/StaticRenderComponent": 277,
            "./render/components/SyncPosAndHeightComponent": 278,
            "./sound/components/MusicPlayerCompnonent": 304,
            "./sound/components/SoundPlayerCompnonent": 305,
            "./timer/components/LifeDurationComponent": 312,
            "./timer/components/TimeScalerComponent": 313,
            "./timer/components/TimerHandlerComponent": 314
        }],
        127: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../math/ForbiddenZone"),
                r = function () {
                    function t() { }
                    return t.BALL_AREA = new Laya.Rectangle(-15, -45, 30, 90),
                        t.GAME_AREA = new Laya.Rectangle(-17, -50, 34, 100),
                        t.ATTACK_AREA_1 = new n.default(-10.5, -45, 21, 7, !1),
                        t.ATTACK_AREA_2 = new n.default(-10.5, 38, 21, 7, !0),
                        t.GOAL_AREA_1 = new Laya.Rectangle(-3.5, -47.6, 7, 0),
                        t.GOAL_AREA_2 = new Laya.Rectangle(-3.5, 47.6, 7, 0),
                        t.CAMERA_CLEAR_COLOR = new Laya.Vector4(0, 9 / 255, 31 / 255, 1), t.HOLD_MAX_SPEED = 6,
                        t.RUN_MAX_SPEED = 7, t.ROCKET_SPEED = 8, t.SLOW_STANDARD_SPEED = 4, t.FAST_STANDARD_SPEED = 8,
                        t.ROCKET_TIME = 3, t.START_ACCELERATION = 16, t.DEFAULT_ACCELERATION = 20, t.PLAYER_RADIUS = .25,
                        t.BALL_RADIUS = .25, t.FALL_RESUME_DELAY = .5, t.FALL_MIN_DISTANCE = 1.5, t.FALL_MAX_DISTANCE = 2.5,
                        t.FLY_RESUME_DELAY = 2, t.FLY_MIN_DISTANCE = 3.5, t.FLY_MAX_DISTANCE = 6.5,
                        t.CAMERA_FIELDOFVIEW = 86,
                        t.CAMERA_ROTATION_X = -20,
                        t.CAMERA_ROTATION_Y = 0,
                        t.CAMERA_X_OFFSET = 0,

                        //条相机！！！

                        t.CAMERA_Y_OFFSET = 25.4,
                        t.CAMERA_HEIGHT = 13.5,



                        t.CAMERA_WIN_X_OFFSET = 3.3,


                        //1111
                        t.CAMERA_WIN_Y_OFFSET = 25.4,
                        t.CAMERA_WIN_HEIGHT = 13.5,




                        t.CAMERA_WIN_FORWARD_X = .8090169943749475,
                        t.CAMERA_WIN_FORWARD_Y = .587785252292473,
                        t.CAMERA_WIN_ROTATION_X = -13,
                        t.CAMERA_WIN_ROTATION_Y = 0,
                        t.CAMERA_WIN_FILED = 40,
                        t.BALL_ROLLING_RATE = 180, t.BALL_FLY_DURATION_MIN = 2, t.BALL_FLY_DURATION_MAX = 3,
                        t.BALL_FLY_HEIGHT_MIN = 4,
                        t.BALL_FLY_HEIGHT_MAX = 6,
                        t.BALL_FLY_DISTANCE_MIN = 5,
                        t.BALL_FLY_DISTANCE_MAX = 10, t.PLAYER_1_GROUP = 1, t.PLAYER_2_GROUP = 2, t.BALL_GROUP = 16,
                        t.PLAYER_1_MASK = 18, t.PLAYER_2_MASK = 17, t.BALL_MASK = 3, t.RELIFE_DURATION = .5,
                        t.WIN_RUN_DURATION = 4, t.WIN_SLIDE_DISTSQR = 16, t.WIN_SLIDE_DISTANCE = 4, t.COMBO_DURATION = 4,
                        t;
                }();
            i.default = r;
        }, {
            "../math/ForbiddenZone": 319
        }],
        128: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Entity, s = t("../ClassNameDef"), o = t("./base/GameContext"), l = t("./Services"), h = t("./Componets"), u = t("../EventCenter"), c = t("../Events"), d = t("../data/UserData"), _ = t("../data/fight/FightScript"), f = t("./RenderUpdateSystems"), p = t("./LogicUpdateSystems"), m = t("./InputSystems"), g = t("../data/fight/IFightData"), y = t("../data/MjpHelper"), v = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onAwake = function () {
                    var t = this.owner,
                        e = l.default.getInstance();
                    t.addComponentIntance(e.sceneComponent),
                        this.initSystems(),
                        u.default.on(c.default.RESET_GAME, this, this.resetGame),
                        u.default.on(c.default.UI_TRANSFORM_ENDED, this, this.startGame);
                }, e.prototype.onDestroy = function () {
                    n.instance.destroyAllEntities(), this._inputSystems.execute(), this._logicUpdateSystems.execute(),
                        this._renderUpdateSystems.execute(), this._inputSystems.cleanup(), this._logicUpdateSystems.cleanup(),
                        this._renderUpdateSystems.cleanup(), this._inputSystems.deactivate(), this._logicUpdateSystems.deactivate(),
                        this._renderUpdateSystems.deactivate();
                    var t = this.owner, e = l.default.getInstance();
                    t._destroyComponent(e.sceneComponent), u.default.off(c.default.RESET_GAME, this, this.resetGame),
                        u.default.off(c.default.START_GAME, this, this.startGame);
                }, e.prototype.initSystems = function () {
                    var t = this.owner, e = o.default.inst, i = l.default.getInstance();
                    a.initialize(h.default.totalComponents, {
                        entities: 100
                    }), (n.instance || new n(h.default, h.default.totalComponents)).destroyAllEntities(),
                        e.scene = t, this._inputSystems = this._inputSystems || new m.default(e, i), this._logicUpdateSystems = this._logicUpdateSystems || new p.default(e, i),
                        this._renderUpdateSystems = this._renderUpdateSystems || new f.default(e, i), this._inputSystems.activate(),
                        this._logicUpdateSystems.activate(), this._renderUpdateSystems.activate();
                }, e.prototype.resetGame = function (t) {
                    n.instance.destroyAllEntities();
                    var e = o.default.inst;
                    d.default.getInstance().guidePass ? _.default.default(e) : _.default.newGuide(e);
                    var i = !1;
                    if (!e.gameId) {
                        i = !0;
                        var r = entitas.utils.UUID.randomUUID();
                        e.gameId = r, e.type !== g.FightType.Guide && (e.targetRank = t.rank, d.default.getInstance().onGameStart(t.rank));
                    }
                    if (u.default.emit(c.default.GAME_READY, e), Laya.timer.clear(this, this.mainLoop),
                        this._inputSystems.initialize(), this._logicUpdateSystems.initialize(), this._renderUpdateSystems.initialize(),
                        this._renderTime = 0, i) {
                        var a = d.default.getInstance(), s = a.createTime;
                        y.default.gameStart(e.gameId, e.type, e.matchTime, a.totalCount, a.getLatestWinCount(20), a.winCount, e.player1Skin.id, s);
                    }
                }, e.prototype.startGame = function (t) {
                    l.default.getInstance(),
                        o.default.inst;
                    Laya.timer.clear(this, this.mainLoop), Laya.timer.frameLoop(1, this, this.mainLoop);
                }, e.prototype.mainLoop = function () {
                    var t = Laya.timer.delta;
                    this._renderTime += t;
                    var e = this._renderTime - 8, i = o.default.inst;
                    for (i.frameIndex; ;) {
                        if (this._inputSystems.execute(), this._inputSystems.cleanup(), i.gamePause) break;
                        if (this._logicUpdateSystems.execute(), this._logicUpdateSystems.cleanup(), i.gamePause) break;
                        if (i.gameOver) break;
                        if (e <= i.logicTime) break;
                    }
                    this._renderUpdateSystems.execute(), this._renderUpdateSystems.cleanup();
                }, e.prototype.onReset = function () {
                    u.default.off(c.default.RESET_GAME, this, this.resetGame), u.default.off(c.default.UI_TRANSFORM_ENDED, this, this.startGame);
                }, e.__className = "GameController", e;
            }(s.RecycleScript3D);
            i.default = v;
        }, {
            "../ClassNameDef": 2,
            "../EventCenter": 4,
            "../Events": 5,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/fight/FightScript": 30,
            "../data/fight/IFightData": 31,
            "./Componets": 126,
            "./InputSystems": 132,
            "./LogicUpdateSystems": 133,
            "./RenderUpdateSystems": 134,
            "./Services": 135,
            "./base/GameContext": 139
        }],
        129: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.CAMERA_CLEAR_COLOR = new Laya.Vector4(0, 9 / 255, 31 / 255, 1), t.DEFAULT_SKIN = 1,
                    t.INVITE_REWARD_SKIN = 103, t.COLLECT_REWARD_SKIN = 104, t.INVITE_MAX_COUNT = 100,
                    t.INVITE_PAGE_COUNT = 5, t.DAILY_MAX_ADD_COIN_TIMES = 5, t.LUCK_GAME_TIMES = 5,
                    t.CAMERA_FIELDOFVIEW = 30, t.CAMERA_ROTATION_X = -5, t.CAMERA_ROTATION_Y = 0, t.CAMERA_FORWARD_X = .12186934340514748,
                    t.CAMERA_FORWARD_Y = .992546151641322, t.CAMERA_HOME_HEIGHT = 1, t.CAMERA_HOME_X_OFFSET = .55,
                    t.CAMERA_HOME_Y_OFFSET = 6, t.CAMERA_SKIN_HEIGHT = .05, t.CAMERA_SKIN_X_OFFSET = .66,
                    t.CAMERA_SKIN_Y_OFFSET = 9, t.MAX_TRY_SKIN_TIMES = 10, t.MAX_SHARE_TRY_SKIN = 1,
                    t.WX_GZYL_KEY = 100, t.WX_GZYL_AWARD_SKIN_ID = 102, t;
            }();
            i.default = n;
        }, {}],
        130: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Entity, s = t("../ClassNameDef"), o = t("./base/GameContext"), l = t("./Services"), h = t("./Componets"), u = t("./HomeSystems"), c = t("./RenderUpdateSystems"), d = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onAwake = function () {
                    var t = this.owner,
                        e = l.default.getInstance();
                    t.addComponentIntance(e.home),
                        this.initSystems();
                }, e.prototype.onDestroy = function () {
                    n.instance.destroyAllEntities(), this._homeSystems.execute(), this._renderUpdateSystems.execute(),
                        this._homeSystems.cleanup(), this._renderUpdateSystems.cleanup(), this._homeSystems.deactivate(),
                        this._renderUpdateSystems.deactivate();
                    var t = this.owner, e = l.default.getInstance();
                    t._destroyComponent(e.home);
                }, e.prototype.initSystems = function () {
                    var t = this.owner, e = o.default.inst, i = l.default.getInstance();
                    a.initialize(h.default.totalComponents, {
                        entities: 100
                    }), (n.instance || new n(h.default, h.default.totalComponents)).destroyAllEntities(),
                        e.scene = t, this._homeSystems = this._homeSystems || new u.default(e, i), this._renderUpdateSystems = this._renderUpdateSystems || new c.default(e, i),
                        this._homeSystems.activate(), this._renderUpdateSystems.activate(), this._homeSystems.initialize(),
                        this._renderUpdateSystems.initialize();
                }, e.prototype.onUpdate = function () {
                    var t = Laya.timer.delta;
                    o.default.inst.deltaTime = t / 1e3, this._homeSystems.execute(), this._homeSystems.cleanup(),
                        this._renderUpdateSystems.execute(), this._renderUpdateSystems.cleanup();
                }, e.__className = "HomeController", e;
            }(s.RecycleScript3D);
            i.default = d;
        }, {
            "../ClassNameDef": 2,
            "./Componets": 126,
            "./HomeSystems": 131,
            "./RenderUpdateSystems": 134,
            "./Services": 135,
            "./base/GameContext": 139
        }],
        131: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Systems, s = t("./home/systems/InitHomeSystem"), o = t("./movement/systems/SlideMoveSystem"), l = t("./movement/systems/FloatToSystem"), h = function (t) {
                function e(e, i) {
                    var r = t.call(this) || this, a = n.instance;
                    return r.add(a.createSystem(new s.default(e, i))),
                        r.add(a.createSystem(new o.default(e, i))),
                        r.add(a.createSystem(new l.default(e, i))),
                        r;
                }

                return r(e, t), e;
            }(a);
            i.default = h;
        }, {
            "./home/systems/InitHomeSystem": 245,
            "./movement/systems/FloatToSystem": 259,
            "./movement/systems/SlideMoveSystem": 261
        }],
        132: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Systems, s = t("./game/systems/InitGameSystem"), o = t("./game/systems/PlayerInputSystem"), l = t("./game/systems/FightScriptBehviorSystem"), h = t("./game/systems/InitBehaviorSystem"), u = function (t) {
                function e(e, i) {
                    var r = t.call(this) || this, a = n.instance;
                    return r.add(a.createSystem(new s.default(e, i))), r.add(a.createSystem(new h.default(e, i))),
                        r.add(a.createSystem(new o.default(e, i))), r.add(a.createSystem(new l.default(e, i))),
                        r;
                }
                return r(e, t), e;
            }(a);
            i.default = u;
        }, {
            "./game/systems/FightScriptBehviorSystem": 230,
            "./game/systems/InitBehaviorSystem": 232,
            "./game/systems/InitGameSystem": 233,
            "./game/systems/PlayerInputSystem": 237
        }],
        133: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Systems, s = t("./movement/systems/FollowSystem"), o = t("./game/systems/ActionExecuteSystem"), l = t("./collision/systems/CollisionHandlerSystem"), h = t("./game/systems/StateUpdateSystem"), u = t("./timer/systems/TimerSystem"), c = t("./movement/systems/DirectionMoveSystem"), d = t("./collision/systems/SimpleCollisionSystem"), _ = t("./game/systems/RoleCollisionSystem"), f = t("./game/systems/BallCollisionSystem"), p = t("./movement/systems/SlideMoveSystem"), m = t("./timer/systems/LifeDurationSystem"), g = t("./movement/systems/BezierMoveSystem"), y = t("./movement/systems/FlightSystem"), v = t("./game/systems/OutValidHandlerSystem"), S = t("./movement/systems/ValidAreaCheckSystem"), T = t("./game/systems/MoveInEmitSystem"), E = t("./game/systems/GameOverEventSystem"), C = t("./sound/systems/SoundEnterSystem"), x = t("./game/systems/RobotBehaviorSystem"), b = t("./game/systems/AutoSkillSystem"), I = t("./game/systems/RelifeSystem"), w = t("./game/systems/MatchTimerSystem"), A = t("./movement/systems/FloatToSystem"), R = t("./timer/systems/TimeScaleUpdateSystem"), M = function (t) {
                function e(e, i) {
                    var r = t.call(this) || this, a = n.instance;
                    return r.add(a.createSystem(new u.default(e, i))), r.add(a.createSystem(new h.default(e, i))),
                        r.add(a.createSystem(new b.default(e, i))), r.add(a.createSystem(new m.default(e, i))),
                        r.add(a.createSystem(new x.default(e, i))), r.add(a.createSystem(new o.default(e, i))),
                        r.add(a.createSystem(new c.default(e, i))), r.add(a.createSystem(new p.default(e, i))),
                        r.add(a.createSystem(new g.default(e, i))), r.add(a.createSystem(new y.default(e, i))),
                        r.add(a.createSystem(new A.default(e, i))), r.add(a.createSystem(new s.default(e, i))),
                        r.add(a.createSystem(new S.default(e, i))), r.add(a.createSystem(new d.default(e, i))),
                        r.add(a.createSystem(new l.default(e, i))),

                        r.add(a.createSystem(new _.default(e, i))),
                        r.add(a.createSystem(new f.default(e, i))), r.add(a.createSystem(new v.default(e, i))),
                        r.add(a.createSystem(new T.default(e, i))), r.add(a.createSystem(new E.default(e, i))),
                        r.add(a.createSystem(new I.default(e, i))), r.add(a.createSystem(new R.default(e, i))),
                        r.add(a.createSystem(new w.default(e, i))), r.add(a.createSystem(new C.default(e, i))),
                        r;
                }
                return r(e, t), e;
            }(a);
            i.default = M;
        }, {
            "./collision/systems/CollisionHandlerSystem": 196,
            "./collision/systems/SimpleCollisionSystem": 197,
            "./game/systems/ActionExecuteSystem": 225,
            "./game/systems/AutoSkillSystem": 228,
            "./game/systems/BallCollisionSystem": 229,
            "./game/systems/GameOverEventSystem": 231,
            "./game/systems/MatchTimerSystem": 234,
            "./game/systems/MoveInEmitSystem": 235,
            "./game/systems/OutValidHandlerSystem": 236,
            "./game/systems/RelifeSystem": 238,
            "./game/systems/RobotBehaviorSystem": 240,
            "./game/systems/RoleCollisionSystem": 241,
            "./game/systems/StateUpdateSystem": 243,
            "./movement/systems/BezierMoveSystem": 255,
            "./movement/systems/DirectionMoveSystem": 257,
            "./movement/systems/FlightSystem": 258,
            "./movement/systems/FloatToSystem": 259,
            "./movement/systems/FollowSystem": 260,
            "./movement/systems/SlideMoveSystem": 261,
            "./movement/systems/ValidAreaCheckSystem": 262,
            "./sound/systems/SoundEnterSystem": 307,
            "./timer/systems/LifeDurationSystem": 315,
            "./timer/systems/TimeScaleUpdateSystem": 316,
            "./timer/systems/TimerSystem": 317
        }],
        134: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Systems, s = t("./render/systems/SyncRotationSystem"), o = t("./render/systems/SyncPositionSystem"), l = t("./render/systems/SyncForwardSystem"), h = t("./render/systems/SyncHeightSystem"), u = t("./render/systems/ApplyRotationSystem"), c = t("./render/systems/ApplyPositionSystem"), d = t("./render/systems/ApplyHeightSystem"), _ = t("./game/systems/AnimationPlaySystem"), f = t("./render/systems/RollingSystem"), p = t("./game/systems/SpeedAnimationSystem"), m = t("./render/systems/ApplyColorSystem"), g = t("./render/systems/SyncColorSystem"), y = t("./render/systems/SceneParticleFactorySystem"), v = t("./render/systems/CameraCreatorSystem"), S = t("./render/systems/ModelCreatorSystem"), T = t("./render/systems/ParticlePanelSystem"), E = t("./render/systems/ModelDestroyerSystem"), C = t("./render/systems/CameraDestroyerSystem"), x = t("./game/systems/RenderUpdaterSystem"), b = t("./sound/systems/SoundPlayerSystem"), I = t("./game/systems/ActionForwardSystem"), w = t("./render/systems/ModelTextureChangeSystem"), A = t("./device/systems/VibrationExecuteSystem"), R = t("./render/systems/SimpleAnimationSystem"), M = t("./render/systems/SyncPosAndHeightSystem"), D = t("./render/systems/ApplyForwardSystem"), O = t("./render/systems/StaticRenderSystem"), L = t("./movement/systems/CameraFollowSystem"), P = function (t) {
                function e(e, i) {
                    var r = t.call(this) || this, a = n.instance;
                    return r.add(a.createSystem(new x.default(e, i))), r.add(a.createSystem(new I.default(e, i))),
                        r.add(a.createSystem(new v.default(e, i))), r.add(a.createSystem(new S.default(e, i))),
                        r.add(a.createSystem(new w.default(e, i))), r.add(a.createSystem(new T.default(e, i))),
                        r.add(a.createSystem(new E.default(e, i))), r.add(a.createSystem(new C.default(e, i))),
                        r.add(a.createSystem(new y.default(e, i))), r.add(a.createSystem(new b.default(e, i))),
                        r.add(a.createSystem(new A.default(e, i))), r.add(a.createSystem(new p.default(e, i))),
                        r.add(a.createSystem(new _.default(e, i))), r.add(a.createSystem(new R.default(e, i))),
                        r.add(a.createSystem(new f.default(e, i))), r.add(a.createSystem(new M.default(e, i))),
                        r.add(a.createSystem(new L.default(e, i))), r.add(a.createSystem(new u.default(e, i))),
                        r.add(a.createSystem(new c.default(e, i))), r.add(a.createSystem(new D.default(e, i))),
                        r.add(a.createSystem(new d.default(e, i))), r.add(a.createSystem(new m.default(e, i))),
                        r.add(a.createSystem(new s.default(e, i))), r.add(a.createSystem(new o.default(e, i))),
                        r.add(a.createSystem(new l.default(e, i))), r.add(a.createSystem(new h.default(e, i))),
                        r.add(a.createSystem(new g.default(e, i))), r.add(a.createSystem(new O.default(e, i))),
                        r;
                }
                return r(e, t), e;
            }(a);
            i.default = P;
        }, {
            "./device/systems/VibrationExecuteSystem": 200,
            "./game/systems/ActionForwardSystem": 226,
            "./game/systems/AnimationPlaySystem": 227,
            "./game/systems/RenderUpdaterSystem": 239,
            "./game/systems/SpeedAnimationSystem": 242,
            "./movement/systems/CameraFollowSystem": 256,
            "./render/systems/ApplyColorSystem": 283,
            "./render/systems/ApplyForwardSystem": 284,
            "./render/systems/ApplyHeightSystem": 285,
            "./render/systems/ApplyPositionSystem": 286,
            "./render/systems/ApplyRotationSystem": 287,
            "./render/systems/CameraCreatorSystem": 288,
            "./render/systems/CameraDestroyerSystem": 289,
            "./render/systems/ModelCreatorSystem": 290,
            "./render/systems/ModelDestroyerSystem": 291,
            "./render/systems/ModelTextureChangeSystem": 292,
            "./render/systems/ParticlePanelSystem": 293,
            "./render/systems/RollingSystem": 294,
            "./render/systems/SceneParticleFactorySystem": 295,
            "./render/systems/SimpleAnimationSystem": 296,
            "./render/systems/StaticRenderSystem": 297,
            "./render/systems/SyncColorSystem": 298,
            "./render/systems/SyncForwardSystem": 299,
            "./render/systems/SyncHeightSystem": 300,
            "./render/systems/SyncPosAndHeightSystem": 301,
            "./render/systems/SyncPositionSystem": 302,
            "./render/systems/SyncRotationSystem": 303,
            "./sound/systems/SoundPlayerSystem": 308
        }],
        135: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./render/services/LayaRenderService"), r = t("./sound/services/LayaSoundService"), a = t("./collision/services/SimpleCollisionService"), s = t("./game/services/FootBallGameService"), o = t("./game/services/GameSceneService"), l = t("./device/services/SagiteamDeviceService"), h = t("./home/services/HomeService"), u = function () {
                function t() {
                    this._game = new s.default(), this.sceneComponent = new o.default(), this.render = new n.default(),
                        this.sound = new r.default(), this.collision = new a.default(), this.game = this._game,
                        this.handler = this._game, this.input = this.sceneComponent, this.timer = this.sceneComponent,
                        this.device = new l.default(),
                        this.home = new h.default();
                }
                return t.getInstance = function () {
                    return this._instance || (this._instance = new t());
                }, t;
            }();
            i.default = u;
        }, {
            "./collision/services/SimpleCollisionService": 195,
            "./device/services/SagiteamDeviceService": 199,
            "./game/services/FootBallGameService": 220,
            "./game/services/GameSceneService": 222,
            "./home/services/HomeService": 244,
            "./render/services/LayaRenderService": 279,
            "./sound/services/LayaSoundService": 306
        }],
        136: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../Path"), r = function () {
                function t() { }
                return t.initData = function () {
                    for (var t = this.usedStaticTrees, e = n.default.getTreeInfos(t), i = this.dataPool, r = 0; r < e.length; r++) {
                        var a = e[r];
                        if (a.type === Laya.Loader.JSON) i[t[r]] = Laya.Loader.getRes(a.url); else for (var s = new Laya.Byte(Laya.loader.getRes(a.url)), o = s.getUint16(), l = 0; l < o; l++) {
                            var h = s.getUTFString(), u = s.getUint32();
                            i[h] = s.readArrayBuffer(u);
                        }
                    }
                }, t.initTree = function (t) {
                    var e = new b3.BehaviorTree();
                    return e.load(this.getData(t), void 0), this.pool[t] = e, e;
                }, t.init = function () {
                    this.initData();
                    for (var t = 0, e = this.usedStaticTrees; t < e.length; t++) {
                        var i = e[t];
                        this.initTree(i);
                    }
                }, t.getData = function (t) {
                    var e = this.dataPool, i = e[t];
                    if (i) return i;
                    var r = n.default.getTreePath(t);
                    return i = Laya.loader.getRes(r), e[t] = i, i || console.log("Cannot find behavior data with key:::: " + t),
                        i;
                }, t.getTree = function (t) {
                    return this.pool[t] || this.initTree(t);
                }, t.usedStaticTrees = ["guideinit", "normalinit"], t.dataPool = {}, t.pool = {},
                    t;
            }();
            i.default = r;
        }, {
            "../Path": 12
        }],
        137: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.regist = void 0;
            var n = entitas.Entity, r = Laya.getset, a = {};
            function s(t, e) {
                return Laya.Pool.getItemByClass("entitas.component." + t, e);
            }
            i.regist = function (t, e, i) {
                a[e] = t;
                var o = n.prototype, l = t.substr(0, 1).toUpperCase() + t.substr(1);
                o["add" + l] = function () {
                    for (var n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
                    var a = s(t, i);
                    return a.init.apply(a, n), this.addComponent(e, a), this;
                }, o["replace" + l] = function () {
                    for (var n = [], r = 0; r < arguments.length; r++) n[r] = arguments[r];
                    var a = null;
                    return (a = this.hasComponent(e) ? this.getComponent(e) : s(t, i)).init.apply(a, n),
                        this.replaceComponent(e, a), this;
                }, r(!1, o, t, function () {
                    return this.getComponent(e);
                }, null);
            };
            var o = function () {
                function t() { }
                return t.createInstance = function (t) {
                    var e = a[t];
                    return e ? s(e, this) : (console.warn("component with index = " + t + " is not registed!!"),
                        null);
                }, t.prototype.recycle = function (t) {
                    this.onReset(), function (t, e) {
                        var i = a[t];
                        if (!i) return console.warn("component with index = " + t + " is not registed!!");
                        Laya.Pool.recover("entitas.component." + i, e);
                    }(t, this);
                }, t.prototype.init = function () {
                    for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                }, t.prototype.onReset = function () { }, t;
            }();
            i.default = o;
        }, {}],
        138: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t(t, e) {
                    this.context = t, this.services = e;
                }
                return t.prototype.setPool = function (t) {
                    this.pool = t, this.matcher && (this.group = t.getGroup(this.matcher));
                }, t;
            }();
            i.default = n;
        }, {}],
        139: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./UnitContext"), a = t("../GameConstants"), s = t("../Componets"), o = t("../../data/skin/SkinData"), l = t("../../math/MathHelper"), h = t("../../data/fight/IFightData"), u = t("../../data/RankHelper");
            function c(t) {
                t.reset(), Laya.Pool.recover("UnitContext", t);
            }
            var d = function () {
                function t() {
                    this.coin = 0, this.shoot = 0, this.hitFly = 0, this.shootCoin = 0, this.hitFlyCoin = 0;
                }
                return t.prototype.reset = function () {
                    this.coin = 0, this.shoot = 0, this.hitFly = 0, this.shootCoin = 0, this.hitFlyCoin = 0;
                }, t.prototype.clone = function () {
                    return {
                        coin: this.coin,
                        shoot: this.shoot,
                        hitFly: this.hitFly,
                        shootCoin: this.shootCoin,
                        hitFlyCoin: this.hitFlyCoin
                    };
                }, t;
            }(), _ = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e.ballArea = a.default.BALL_AREA, e.gameArea = a.default.GAME_AREA, e.gameOver = !1,
                        e.gamePause = !1, e.isOvertime = !1, e.scene = null, e.enableRelife = !1, e.ground = null,
                        e.combo = null, e.counter = new d(), e.timeScale = 1, e.deltaTime = 0, e.frameIndex = 0,
                        e.totalTime = 0, e.logicTime = 0, e.matchTiming = 0, e.matchTime = -1, e.score1 = 0,
                        e.score2 = 0, e.goalGroup = 0, e.shootCoin = 0, e.matchPause = !1, e.fightScore1 = 0,
                        e.fightScore2 = 0, e.gameId = null, e.ballUrl = null, e.groundUrl = null, e.player1Skin = null,
                        e.player2Skin = null, e.actorInitInfo = null, e.relifePointsInfo = null, e.robotInit1 = null,
                        e.robotInit2 = null, e.fightScript = null, e.type = h.FightType.Normel, e.targetRank = null,
                        e.readyOver = !1, e._roles = [], e._baseMemory = e, e;
                }
                return r(e, t), Object.defineProperty(e, "inst", {
                    get: function () {
                        return this._inst || (this._inst = new e());
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(e.prototype, "gameTime", {
                    get: function () {
                        return 1e3 * this.totalTime;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(e.prototype, "ballPosition", {
                    get: function () {
                        return this.ball.position;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(e.prototype, "ballHolder", {
                    get: function () {
                        var t = this.ball.entity;
                        if (!t.hasComponent(s.default.Follow)) return null;
                        var e = t.follow.target;
                        return e.hasComponent(s.default.Player) ? e.player.id : e.hasComponent(s.default.Robot) ? e.robot.id : null;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(e.prototype, "attackGroup", {
                    get: function () {
                        var t = this.ball.entity;
                        return t.hasComponent(s.default.Follow) ? t.follow.target.role.group : 0;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(e.prototype, "allRoles", {
                    get: function () {
                        return this._roles;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.getBall = function () {
                    return this.ball.entity;
                }, e.prototype.setBall = function (t) {
                    var e = this.addUnit("ball", t);
                    this.ball = e;
                }, e.prototype.addRole = function (t, e) {
                    var i = this.addUnit(t, e);
                    this._roles.push(i);
                }, e.prototype.addUnit = function (t, e) {
                    var i = function (t) {
                        var e = Laya.Pool.getItemByClass("UnitContext", n.default);
                        return e.bind(t), e;
                    }(e);
                    return this._treeMemory[t] = i, i;
                }, e.prototype.reset = function () {
                    this.ball && c(this.ball);
                    for (var t = 0, e = this._roles; t < e.length; t++) {
                        c(e[t]);
                    }
                    var i, n, r;
                    this._treeMemory = {}, this._roles.length = 0, this.ball = null, this.ground = null,
                        this.combo = null, this.shootCoin = 0, this.readyOver = !1, this.matchPause = !0,
                        this.gamePause = !1, this.player1Skin || (this.player1Skin = o.default.getSkinData(l.default.randomInArray([1, 2, 3, 4]))),
                        this.player2Skin || (this.player2Skin = (i = this.targetRank, n = this.player1Skin,
                            r = i ? u.default.randomSkinLevel(i.level, !0) : 1, o.default.randomSkinWithLevel(r, n, !0)));
                }, e.prototype.onGameCompleted = function () {
                    this.gameId = null, this.matchTiming = 0, this.score1 = this.score2 = 0, this.player1Skin = null,
                        this.player2Skin = null, this.targetRank = null, this.counter.reset();
                }, e.prototype.onGameOver = function (t) {
                    this.matchPause = !0, this.gameOver = !0, this.goalGroup = t, t === a.default.PLAYER_1_GROUP ? this.score1 += 1 : t === a.default.PLAYER_2_GROUP && (this.score2 += 1);
                }, e._inst = null, e;
            }(b3.Blackboard);
            i.default = _;
        }, {
            "../../data/RankHelper": 19,
            "../../data/fight/IFightData": 31,
            "../../data/skin/SkinData": 32,
            "../../math/MathHelper": 320,
            "../Componets": 126,
            "../GameConstants": 127,
            "./UnitContext": 140
        }],
        140: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../math/Vec2"), r = t("../GameConstants"), a = t("../Componets"), s = new n.default(), o = function () {
                function t() {
                    this.target = null, this.nodeMemory = {}, this.openNodes = [], this.traversalDepth = 0,
                        this.traversalCycle = 0;
                }
                return Object.defineProperty(t.prototype, "group", {
                    get: function () {
                        return this.entity.role.group;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "attackArea", {
                    get: function () {
                        return this.group === r.default.PLAYER_1_GROUP ? r.default.ATTACK_AREA_1 : r.default.ATTACK_AREA_2;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "position", {
                    get: function () {
                        var t = this.entity.position;
                        return s.set(t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "forward", {
                    get: function () {
                        var t = this.entity.forward;
                        return s.set(t);
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "speed", {
                    get: function () {
                        var t = this.entity;
                        return t.hasComponent(a.default.DirectionMove) ? t.directionMove.speed : -1;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "holding", {
                    get: function () {
                        return this.entity.hasComponent(a.default.BallHolder);
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.bind = function (t) {
                    this.entity = t;
                }, t.prototype.reset = function () {
                    this.entity = null, this.nodeMemory = {}, this.openNodes = [], this.traversalCycle = 0,
                        this.traversalDepth = 0;
                }, t;
            }();
            i.default = o;
        }, {
            "../../math/Vec2": 322,
            "../Componets": 126,
            "../GameConstants": 127
        }],
        141: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./actions/Wait"), r = t("./decorators/MaxTime"), a = t("./actions/Attack"), s = t("./actions/AttackRandom"), o = t("./actions/RobBall"), l = t("./actions/Stop"), h = t("./actions/WaitRandom"), u = t("./actions/MoveTo"), c = t("./actions/MoveRandom"), d = t("./actions/MoveRandomRect"), _ = t("./actions/RandomTurn"), f = t("./actions/ChaseTarget"), p = t("./actions/FindTargetAroundBall"), m = t("./scriptfight/LockInput"), g = t("./scriptfight/UnlockInput"), y = t("./scriptfight/ResumeGame"), v = t("./scriptfight/PauseGame"), S = t("./scriptfight/ShowGuide"), T = t("./scriptfight/SetRobotAI"), E = t("./scriptfight/SetGroupVisible"), C = t("./actions/SetAttrSpeed"), x = t("./conditions/IsHolder"), b = t("./conditions/IsAttaker"), I = t("./conditions/Random"), w = t("./conditions/Remainder"), A = t("./conditions/IsSpeedAbove"), R = t("./conditions/HasEnemyInDistance"), M = t("./conditions/IsBallInDistance"), D = t("./conditions/IsBallInRect"), O = t("./conditions/IsLeftDangerous"), L = t("./conditions/IsGameOver"), P = t("./conditions/IsGroup"), N = t("./conditions/IsOvertime"), B = t("./conditions/IsMatchPause"), F = t("./decorators/GlobalLimit"), k = t("./decorators/SuccessIfError"), V = t("./decorators/FailureIfError"), U = t("./decorators/IsError"), G = t("./decorators/Limiter"), z = t("./decorators/Repeater"), H = t("./userConditions/IsGameCountAbove"), j = t("./userConditions/IsLatestWinCountAbove"), W = t("./userConditions/IsCurrentMatchIndex"), X = t("./userConditions/IsWinScoreAbove"), Y = t("./conditions/IsSelfRankAbove"), q = t("./conditions/IsTargetRankAbove"), K = t("./conditions/FightScoreAbove");
            i.default = {
                Wait: n.default,
                MaxTime: r.default,
                Limiter: G.default,
                Repeater: z.default,
                Attack: a.default,
                AttackRandom: s.default,
                RobBall: o.default,
                Stop: l.default,
                WaitRandom: h.default,
                MoveTo: u.default,
                MoveRandom: c.default,
                MoveRandomRect: d.default,
                RandomTurn: _.default,
                ChaseTarget: f.default,
                FindTargetAroundBall: p.default,
                LockInput: m.default,
                UnlockInput: g.default,
                ResumeGame: y.default,
                PauseGame: v.default,
                ShowGuide: S.default,
                SetRobotAI: T.default,
                SetGroupVisible: E.default,
                SetAttrSpeed: C.default,
                IsHolder: x.default,
                IsAttaker: b.default,
                HasEnemyInDistance: R.default,
                IsBallInDistance: M.default,
                IsBallInRect: D.default,
                IsLeftDangerous: O.default,
                Random: I.default,
                Remainder: w.default,
                IsGameOver: L.default,
                IsSpeedAbove: A.default,
                IsWinScoreAbove: X.default,
                IsGroup: P.default,
                IsOvertime: N.default,
                IsMatchPause: B.default,
                IsSelfRankAbove: Y.default,
                IsTargetRankAbove: q.default,
                IsGameCountAbove: H.default,
                IsLatestWinCountAbove: j.default,
                IsCurrentMatchIndex: W.default,
                FightScoreAbove: K.default,
                GlobalLimit: F.default,
                SuccessIfError: k.default,
                FailureIfError: V.default,
                IsError: U.default
            };
        }, {
            "./actions/Attack": 142,
            "./actions/AttackRandom": 143,
            "./actions/ChaseTarget": 145,
            "./actions/FindTargetAroundBall": 146,
            "./actions/MoveRandom": 147,
            "./actions/MoveRandomRect": 148,
            "./actions/MoveTo": 149,
            "./actions/RandomTurn": 150,
            "./actions/RobBall": 151,
            "./actions/SetAttrSpeed": 152,
            "./actions/Stop": 153,
            "./actions/Wait": 154,
            "./actions/WaitRandom": 155,
            "./conditions/FightScoreAbove": 157,
            "./conditions/HasEnemyInDistance": 158,
            "./conditions/IsAttaker": 159,
            "./conditions/IsBallInDistance": 160,
            "./conditions/IsBallInRect": 161,
            "./conditions/IsGameOver": 162,
            "./conditions/IsGroup": 163,
            "./conditions/IsHolder": 164,
            "./conditions/IsLeftDangerous": 165,
            "./conditions/IsMatchPause": 166,
            "./conditions/IsOvertime": 167,
            "./conditions/IsSelfRankAbove": 168,
            "./conditions/IsSpeedAbove": 169,
            "./conditions/IsTargetRankAbove": 170,
            "./conditions/Random": 171,
            "./conditions/Remainder": 172,
            "./decorators/FailureIfError": 174,
            "./decorators/GlobalLimit": 175,
            "./decorators/IsError": 176,
            "./decorators/Limiter": 177,
            "./decorators/MaxTime": 178,
            "./decorators/Repeater": 179,
            "./decorators/SuccessIfError": 180,
            "./scriptfight/LockInput": 181,
            "./scriptfight/PauseGame": 182,
            "./scriptfight/ResumeGame": 183,
            "./scriptfight/SetGroupVisible": 184,
            "./scriptfight/SetRobotAI": 185,
            "./scriptfight/ShowGuide": 186,
            "./scriptfight/UnlockInput": 187,
            "./userConditions/IsCurrentMatchIndex": 188,
            "./userConditions/IsGameCountAbove": 189,
            "./userConditions/IsLatestWinCountAbove": 190,
            "./userConditions/IsWinScoreAbove": 191
        }],
        142: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseAction"), s = new n.default(), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.getAttackForward = function (t) {
                    var e = t.blackboard.get("attackArea", t.tree.id, null);
                    return s.setXY(0, e.bottom < 0 ? -1 : 1), s;
                }, e.prototype.tick = function (t) {
                    return a.default.moveForward(t, this.getAttackForward(t)), b3.SUCCESS;
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        143: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./Attack"), a = t("../../../math/Vec2"), s = t("../../../math/MathHelper"), o = new a.default(), l = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.range = t.getFloat32();
                }, e.prototype.getAttackForward = function (t) {
                    var e = t.blackboard, i = t.tree.id, n = e.get("group", i, null), r = e.get("position", i, null), a = e.get("attackArea", i, null), l = a.x, h = a.right, u = this.range;
                    return u && (l = Math.max(l, r.x - u), h = Math.min(h, r.x + u)), o.setXY(s.default.randomBetween(l, h), 1 === n ? a.y : a.bottom),
                        o.subSelf(r), o;
                }, e;
            }(n.default);
            i.default = l;
        }, {
            "../../../math/MathHelper": 320,
            "../../../math/Vec2": 322,
            "./Attack": 142
        }],
        144: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Entity, s = entitas.Matcher, o = t("../../interfaces"), l = t("../../Componets"), h = function (t) {
                function e(e) {
                    var i = t.call(this, {
                        name: e.name,
                        title: e.title,
                        properties: e.properties || e
                    }) || this;
                    return e.buff ? (i.initWithBuff(e.buff), e.buff = void 0) : i.initWithProp(e), i.checkProps(),
                        i;
                }
                return r(e, t), e.moveForward = function (t, e) {
                    t.target.replaceAction(o.ActionType.Move, e);
                }, e.stopMove = function (t) {
                    t.target.replaceAction(o.ActionType.Stop);
                }, e.setAttrSpeed = function (t, e) {
                    t.target.replaceAttrAISpeed(e);
                }, e.setAI = function (t, e) {
                    t.target.replaceAttrBehavior(e);
                }, e.setGroupVisible = function (t, e, i) {
                    var r = n.instance.getEntities(s.create({
                        allOf: [l.default.Role]
                    }));
                    if (i) for (var a = 0, o = r; a < o.length; a++) {
                        (c = o[a]).role.group === e && c.replaceRenderNode();
                    } else for (var h = 0, u = r; h < u.length; h++) {
                        var c;
                        (c = u[h]).role.group === e && (c.hasComponent(l.default.RenderNode) && c.removeComponent(l.default.RenderNode));
                    }
                }, e.getEntityTreeId = function (t) {
                    return t && t instanceof a && t.hasComponent(l.default.Behavior) ? t.behavior.behavior.id : null;
                }, e.prototype.initWithBuff = function (t) { }, e.prototype.initWithProp = function (t) { },
                    e.prototype.checkProps = function () { }, e.prototype.tick = function (t) {
                        return b3.SUCCESS;
                    }, e;
            }(b3.Action);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../interfaces": 246
        }],
        145: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseAction"), a = new (t("../../../math/Vec2").default)(), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.distance = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.distanceSqr = this.distance * this.distance, this.distance <= 0) throw "Property distance in ChestTarget must above 0";
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, r = i.get("target", e, null);
                    if (!r) return b3.FAILURE;
                    var s = n.default.getEntityTreeId(r);
                    if (!s) return b3.FAILURE;
                    a.set(i.get("position", s, null));
                    var o = i.get("position", e, null);
                    return a.subSelf(o), a.magSqr() <= this.distanceSqr ? b3.SUCCESS : (a.normalizeSelf(),
                        n.default.moveForward(t, a), b3.RUNNING);
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        146: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseAction"), a = t("../../../math/Vec2"), s = t("../../../math/MathHelper"), o = new a.default(), l = new a.default(), h = new a.default(), u = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.group = t.getUint16(), this.distance = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.distanceSqr = this.distance * this.distance, 1 !== this.group && 2 !== this.group) throw "Property group in FindTargetAroundBall is invalid";
                    if (this.distance <= 0) throw "Property distance in FindTargetAroundBall must above 0";
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, n = this.group, r = this.distanceSqr, a = i.get("allRoles", null, null);
                    l.set(i.get("position", e, null));
                    for (var u = [], c = 0, d = a; c < d.length; c++) {
                        var _ = d[c];
                        n === _.group && (o.set(_.position), l.sub(o, h).magSqr() <= r && u.push(_));
                    }
                    if (u.length > 0) {
                        var f = s.default.randomInArray(u);
                        return i.set("target", f, e, null), b3.SUCCESS;
                    }
                    return b3.FAILURE;
                }, e;
            }(n.default);
            i.default = u;
        }, {
            "../../../math/MathHelper": 320,
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        147: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./MoveTo"), a = t("../../../math/MathHelper"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.minRadius = t.getFloat32(), this.maxRadius = t.getFloat32();
                }, e.prototype.checkProps = function () { }, e.prototype.getTargetPoint = function (t, e) {
                    var i = t.blackboard.get("ballArea", null, null);
                    if (this.maxRadius > 0) {
                        var n = t.blackboard.get("position", t.tree.id, null), r = Math.max(0, this.minRadius), s = a.default.randomBetween(r, this.maxRadius), o = a.default.random(), l = Math.sqrt(1 - o * o), h = s * o + n.x, u = s * l + n.y;
                        h = Math.max(i.x, Math.min(i.right, h)), u = Math.max(i.y, Math.min(i.bottom, h)),
                            e.setXY(h, u);
                    } else {
                        h = i.x + i.width * a.default.random(), u = i.y + i.height * a.default.random();
                        e.setXY(h, u);
                    }
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/MathHelper": 320,
            "./MoveTo": 149
        }],
        148: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./MoveTo"), a = t("../../../math/Rect"), s = t("../../../math/MathHelper"), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.rect = new a.default(t.getFloat32(), t.getFloat32(), t.getFloat32(), t.getFloat32());
                }, e.prototype.getTargetPoint = function (t, e) {
                    var i = this.rect, n = i.x + i.width * s.default.random(), r = i.y + i.height * s.default.random();
                    e.setXY(n, r);
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../../../math/MathHelper": 320,
            "../../../math/Rect": 321,
            "./MoveTo": 149
        }],
        149: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseAction"), s = new n.default(), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.x = t.getFloat32(), this.y = t.getFloat32();
                }, e.prototype.getTargetPoint = function (t, e) {
                    e.setXY(this.x, this.y);
                }, e.prototype.open = function (t) {
                    var e = this.id, i = t.tree.id, r = t.blackboard.get("targetPoint", i, e) || new n.default();
                    this.getTargetPoint(t, r), t.blackboard.set("targetPoint", r, i, e);
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, n = i.get("targetPoint", e, this.id), r = i.get("position", e, null);
                    return n.sub(r, s), s.magSqr() < .1 ? b3.SUCCESS : (a.default.moveForward(t, s),
                        b3.RUNNING);
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        150: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseAction"), a = t("../../../math/Vec2"), s = t("../../../math/MathHelper"), o = new a.default(), l = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.minSine = t.getFloat64(), this.maxSine = t.getFloat64();
                }, e.prototype.checkProps = function () {
                    if (Math.abs(this.maxSine) > 1 || Math.abs(this.minSine) > 1) throw "RandomTurn paramters minRadian or maxRadian is invalid";
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard.get("forward", t.tree.id, null), i = s.default.randomBetween(this.minSine, this.maxSine), r = Math.sqrt(1 - i * i);
                    return n.default.moveForward(t, e.rotateVectorSelf(o.setXY(r, i))), b3.SUCCESS;
                }, e;
            }(n.default);
            i.default = l;
        }, {
            "../../../math/MathHelper": 320,
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        151: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseAction"), s = new n.default(), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard;
                    s.set(i.get("ballPosition", null, null));
                    var n = i.get("position", e, null);
                    return s.subSelf(n), a.default.moveForward(t, s), b3.SUCCESS;
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "./BaseAction": 144
        }],
        152: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseAction"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.speed = t.getFloat32();
                }, e.prototype.tick = function (t) {
                    return n.default.setAttrSpeed(t, this.speed), b3.SUCCESS;
                }, e;
            }(n.default);
            i.default = a;
        }, {
            "./BaseAction": 144
        }],
        153: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseAction"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return n.default.stopMove(t), b3.SUCCESS;
                }, e;
            }(n.default);
            i.default = a;
        }, {
            "./BaseAction": 144
        }],
        154: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.milliseconds = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.milliseconds <= 0) throw 'Property "milliseconds" in Wait must be a number above 0!';
                }, e.prototype.open = function (t) {
                    var e = t.blackboard, i = e.get("gameTime", null, null);
                    e.set("endedTime", i + this.milliseconds, t.tree.id, this.id);
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard;
                    return e.get("gameTime", null, null) > e.get("endedTime", t.tree.id, this.id) ? b3.SUCCESS : b3.RUNNING;
                }, e;
            }(t("./BaseAction").default);
            i.default = n;
        }, {
            "./BaseAction": 144
        }],
        155: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/MathHelper"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.min = t.getFloat32(), this.max = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.max <= 0) throw 'Property "max" in WaitRandom must be a number above 0!';
                }, e.prototype.open = function (t) {
                    var e = t.blackboard, i = e.get("gameTime", null, null);
                    e.set("endedTime", i + n.default.randomBetween(this.min, this.max), t.tree.id, this.id);
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard;
                    return e.get("gameTime", null, null) > e.get("endedTime", t.tree.id, this.id) ? b3.SUCCESS : b3.RUNNING;
                }, e;
            }(t("./BaseAction").default);
            i.default = a;
        }, {
            "../../../math/MathHelper": 320,
            "./BaseAction": 144
        }],
        156: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e(e) {
                    var i = t.call(this, {
                        name: e.name,
                        title: e.title,
                        properties: e.properties || e
                    }) || this;
                    return e.buff ? (i.initWithBuff(e.buff), e.buff = void 0) : i.initWithProp(e), i.checkProps(),
                        i;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) { }, e.prototype.initWithProp = function (t) { },
                    e.prototype.checkProps = function () { }, e;
            }(b3.Condition);
            i.default = n;
        }, {}],
        157: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.group = t.getUint16(), this.fightScore = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (1 !== this.group && 2 !== this.group) throw "Error group in FightScoreAbove";
                }, e.prototype.tick = function (t) {
                    return t.blackboard.get("fightScore" + this.group, null, null) > this.fightScore ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        158: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseCondition"), s = new n.default(), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.distance = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.distance <= 0) throw 'Property "distance" in HasEnemyInDistance must be a number above 0!';
                    this.distanceSqr = this.distance * this.distance;
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, n = i.get("group", e, null);
                    s.set(i.get("position", e, null));
                    for (var r = i.get("allRoles", null, null), a = this.distanceSqr, o = 0, l = r; o < l.length; o++) {
                        var h = l[o];
                        if (n !== h.group) if (h.position.subSelf(s).magSqr() < a) return b3.SUCCESS;
                    }
                    return b3.FAILURE;
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "./BaseCondition": 156
        }],
        159: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, n = i.get("attackGroup", null, null);
                    return i.get("group", e, null) === n ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        160: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseCondition"), s = new n.default(), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.distance = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.distance <= 0) throw 'Property "distance" in IsBallInDistance must be a number above 0!';
                    this.distanceSqr = this.distance * this.distance;
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard;
                    return s.set(i.get("ballPosition", null, null)), i.get("position", e, null).subSelf(s).magSqr() < this.distanceSqr ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "./BaseCondition": 156
        }],
        161: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Rect"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.rect = new n.default(t.getFloat32(), t.getFloat32(), t.getFloat32(), t.getFloat32());
                }, e.prototype.checkProps = function () {
                    if (this.rect.width <= 0 || this.rect.height <= 0) throw 'Property "width" and "height" in IsBallInRect must be a number above 0!';
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard.get("ballPosition", null, null);
                    return this.rect.contains(e.x, e.y) ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = a;
        }, {
            "../../../math/Rect": 321,
            "./BaseCondition": 156
        }],
        162: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.get("gameOver", null, null) ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        163: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.group = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return t.target.role.group === this.group ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        164: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.get("holding", t.tree.id, null) ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        165: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), a = t("./BaseCondition"), s = new n.default(), o = new n.default(), l = new n.default(), h = new n.default(), u = new n.default(), c = new n.default(), d = new n.default(0, 1), _ = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.radius = t.getFloat32(), this.ignoreDot = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (this.radius <= 0) throw 'Property "radius" in IsLeftDangerous must be a number above 0!';
                    this.radiusSqr = this.radius * this.radius;
                }, e.prototype.tick = function (t) {
                    var e = t.tree.id, i = t.blackboard, n = i.get("group", e, null), r = i.get("speed", e, null);
                    l.set(i.get("position", e, null)), h.set(i.get("forward", e, null));
                    for (var a = i.get("allRoles", null, null), _ = this.radiusSqr, f = this.ignoreDot, p = 1 / 0, m = 0, g = a; m < g.length; m++) {
                        var y = g[m];
                        if (n !== y.group && (u.set(y.position), !(l.sub(u, s).magSqr() >= _ || h.dot(s) > f))) {
                            var v = y.speed;
                            if (!(v < 0)) {
                                c.set(y.forward);
                                var S = (s.dot(c) * v - s.dot(h) * r) / s.magSqr();
                                S < 0 || S < p && (p = S, o.set(u));
                            }
                        }
                    }
                    return p !== 1 / 0 ? (o.sub(l, s), h.rotateVectorSelf(d).dot(s) > 0 ? b3.SUCCESS : b3.FAILURE) : b3.ERROR;
                }, e;
            }(a.default);
            i.default = _;
        }, {
            "../../../math/Vec2": 322,
            "./BaseCondition": 156
        }],
        166: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.get("matchPause", null, null) ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        167: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.get("isOvertime", null, null) ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = n;
        }, {
            "../actions/BaseAction": 144
        }],
        168: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./BaseCondition"), a = t("../../../data/UserData"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.level = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return a.default.getInstance().rank.level > this.level ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../data/UserData": 20,
            "./BaseCondition": 156
        }],
        169: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../Componets"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.minSpeed = t.getFloat32();
                }, e.prototype.tick = function (t) {
                    var e = t.target;
                    if (e.hasComponent(n.default.DirectionMove) && e.directionMove.speed > this.minSpeed) return b3.SUCCESS;
                    return b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = a;
        }, {
            "../../Componets": 126,
            "./BaseCondition": 156
        }],
        170: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.level = t.getUint16();
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard.get("targetRank", null, null);
                    return e && e.level > this.level ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        171: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/MathHelper"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.rate = t.getFloat32();
                }, e.prototype.tick = function (t) {
                    return n.default.random() < this.rate ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = a;
        }, {
            "../../../math/MathHelper": 320,
            "./BaseCondition": 156
        }],
        172: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.divisor = t.getUint16(), this.remainder = t.getUint16();
                }, e.prototype.checkProps = function () {
                    if (!this.divisor || this.divisor < 2 || this.remainder >= this.divisor) throw "检查除数与余，不满足条件（除数[" + this.divisor + "]不应小于2，余[" + this.remainder + "]不应大于或等于除数）";
                }, e.prototype.tick = function (t) {
                    var e = this.id, i = t.tree.id, n = t.blackboard.get("i", i, e) || 0;
                    return n += 1, t.blackboard.set("i", n, i, e), n % this.divisor === this.remainder ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("./BaseCondition").default);
            i.default = n;
        }, {
            "./BaseCondition": 156
        }],
        173: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e(e) {
                    var i = t.call(this, {
                        child: e.child,
                        name: e.name,
                        title: e.title,
                        properties: e.properties || e
                    }) || this;
                    return e.buff ? (i.initWithBuff(e.buff), e.buff = void 0) : i.initWithProp(e), i.checkProps(),
                        i;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) { }, e.prototype.initWithProp = function (t) { },
                    e.prototype.checkProps = function () { }, e;
            }(b3.Decorator);
            i.default = n;
        }, {}],
        174: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    if (!this.child) return b3.ERROR;
                    var e = this.child._execute(t);
                    return e == b3.ERROR && (e = b3.FAILURE), e;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        175: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.key = t.getUTFString(), this.limit = t.getUint16();
                }, e.prototype.checkProps = function () {
                    if (!this.limit || !this.key) throw "limit or key parameter in GlobalLimit decorator is an obligatory parameter";
                }, e.prototype.open = function (t) {
                    var e = t.blackboard, i = e.get("total", this.key, null) || 0;
                    e.set("total", i + 1, this.key, null);
                }, e.prototype.close = function (t) {
                    var e = t.blackboard, i = e.get("total", this.key, null) || 0;
                    e.set("total", i - 1, this.key, null);
                }, e.prototype.tick = function (t) {
                    return this.child ? (t.blackboard.get("total", this.key, null) || 0) > this.limit ? b3.FAILURE : this.child._execute(t) : b3.ERROR;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        176: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return this.child ? this.child._execute(t) == b3.ERROR ? b3.SUCCESS : b3.FAILURE : b3.ERROR;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        177: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.maxLoop = t.getInt16();
                }, e.prototype.open = function (t) {
                    var e = t.blackboard, i = t.tree.id, n = this.id;
                    "number" != typeof e.get("i", i, n) && e.set("i", 0, i, n);
                }, e.prototype.tick = function (t) {
                    if (!this.child) return b3.ERROR;
                    var e = t.blackboard.get("i", t.tree.id, this.id);
                    if (e < this.maxLoop) {
                        var i = this.child._execute(t);
                        return i != b3.SUCCESS && i != b3.FAILURE || t.blackboard.set("i", e + 1, t.tree.id, this.id),
                            i;
                    }
                    return b3.FAILURE;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        178: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.maxTime = t.getFloat32();
                }, e.prototype.checkProps = function () {
                    if (!this.maxTime) throw '"maxTime" parameter in MaxTime decorator is an obligatory parameter';
                }, e.prototype.open = function (t) {
                    var e = t.blackboard;
                    e.set("startTime", e.get("gameTime", null, null), t.tree.id, this.id);
                }, e.prototype.tick = function (t) {
                    if (!this.child) return b3.ERROR;
                    var e = t.blackboard, i = e.get("gameTime", null, null), n = e.get("startTime", t.tree.id, this.id), r = this.child._execute(t);
                    return i - n > this.maxTime ? b3.FAILURE : r;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        179: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.maxLoop = t.getInt16();
                }, e.prototype.open = function (t) {
                    t.blackboard.set("i", 0, t.tree.id, this.id);
                }, e.prototype.tick = function (t) {
                    if (!this.child) return b3.ERROR;
                    for (var e = t.blackboard.get("i", t.tree.id, this.id), i = b3.SUCCESS; (this.maxLoop < 0 || e < this.maxLoop) && ((i = this.child._execute(t)) == b3.SUCCESS || i == b3.FAILURE);) e++;
                    return t.blackboard.set("i", e, t.tree.id, this.id), i;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        180: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    if (!this.child) return b3.ERROR;
                    var e = this.child._execute(t);
                    return e == b3.ERROR && (e = b3.SUCCESS), e;
                }, e;
            }(t("./BaseDecorator").default);
            i.default = n;
        }, {
            "./BaseDecorator": 173
        }],
        181: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../EventCenter"), a = t("../../../Events"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return n.default.emit(a.default.LOCK_INPUT, !0), b3.SUCCESS;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = s;
        }, {
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../actions/BaseAction": 144
        }],
        182: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.set("gamePause", !0, null, null), b3.SUCCESS;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = n;
        }, {
            "../actions/BaseAction": 144
        }],
        183: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return t.blackboard.set("gamePause", !1, null, null), b3.SUCCESS;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = n;
        }, {
            "../actions/BaseAction": 144
        }],
        184: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../actions/BaseAction"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.group = t.getUint16(), this.visible = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return n.default.setGroupVisible(t, this.group, 1 === this.visible), b3.SUCCESS;
                }, e;
            }(n.default);
            i.default = a;
        }, {
            "../actions/BaseAction": 144
        }],
        185: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../actions/BaseAction"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.ainame = t.getUTFString();
                }, e.prototype.tick = function (t) {
                    return n.default.setAI(t, this.ainame), b3.SUCCESS;
                }, e;
            }(n.default);
            i.default = a;
        }, {
            "../actions/BaseAction": 144
        }],
        186: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../EventCenter"), a = t("../../../Events"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.guide = t.getUTFString(), this.data = t.getUTFString();
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard;
                    return n.default.emit(a.default.SHOW_GUIDE, this.guide, this.data, e), b3.SUCCESS;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = s;
        }, {
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../actions/BaseAction": 144
        }],
        187: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../EventCenter"), a = t("../../../Events"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.tick = function (t) {
                    return n.default.emit(a.default.LOCK_INPUT, !1), b3.SUCCESS;
                }, e;
            }(t("../actions/BaseAction").default);
            i.default = s;
        }, {
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../actions/BaseAction": 144
        }],
        188: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.currentIndex = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return t.blackboard.get("currentRound", null, null) + 1 === this.currentIndex ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("../conditions/BaseCondition").default);
            i.default = n;
        }, {
            "../conditions/BaseCondition": 156
        }],
        189: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../data/UserData"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.minCount = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return n.default.getInstance().totalCount > this.minCount ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("../conditions/BaseCondition").default);
            i.default = a;
        }, {
            "../../../data/UserData": 20,
            "../conditions/BaseCondition": 156
        }],
        190: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../data/UserData"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.minCount = t.getUint16(), this.latestCount = t.getUint16();
                }, e.prototype.tick = function (t) {
                    return n.default.getInstance().getLatestWinCount(this.latestCount) > this.minCount ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("../conditions/BaseCondition").default);
            i.default = a;
        }, {
            "../../../data/UserData": 20,
            "../conditions/BaseCondition": 156
        }],
        191: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initWithBuff = function (t) {
                    this.score = t.getInt16();
                }, e.prototype.tick = function (t) {
                    var e = t.blackboard;
                    return e.get("score1", null, null) - e.get("score2", null, null) > this.score ? b3.SUCCESS : b3.FAILURE;
                }, e;
            }(t("../conditions/BaseCondition").default);
            i.default = n;
        }, {
            "../conditions/BaseCondition": 156
        }],
        192: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.radius = 0, e.group = 0, e.mask = 0, e.enable = !1, e;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.radius = i, this.group = t, this.mask = e, this.enable = !1 !== n;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        193: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.CollisionType = void 0;
            var n = t("../../base/BaseComponent");
            !function (t) {
                t[t.None = 0] = "None", t[t.CollisionEnter = 1] = "CollisionEnter", t[t.CollisionStay = 2] = "CollisionStay",
                    t[t.CollisionExit = 3] = "CollisionExit";
            }(i.CollisionType || (i.CollisionType = {}));
            var a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.entity = t, this.target = e, this.type = i, this.direction = n;
                }, e.prototype.onReset = function () {
                    this.entity = this.target = null;
                }, e;
            }(n.default);
            i.default = a;
        }, {
            "../../base/BaseComponent": 137
        }],
        194: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.isCollision = !1, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.entityA = t, this.entityB = e, this.isCollision = !1;
                }, e.prototype.onReset = function () {
                    this.entityA = this.entityB = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        195: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../math/Vec2"), r = new n.default(), a = new n.default(), s = function () {
                function t() { }
                return t.prototype.testCollision = function (t, e, i, n, s) {
                    return r.set(t), a.set(e), a.sub(r, s).mag() <= i + n;
                }, t;
            }();
            i.default = s;
        }, {
            "../../../math/Vec2": 322
        }],
        196: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../components/CollisionEventComponent"), l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Collision]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.services.handler, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e].collision;
                        switch (n.type) {
                            case o.CollisionType.CollisionEnter:
                                t.onCollisionEnter(n.entity, n.target, n.direction);
                                break;

                            case o.CollisionType.CollisionStay:
                                t.onCollisionStay(n.entity, n.target, n.direction);
                                break;

                            case o.CollisionType.CollisionExit:
                                t.onCollisionExit(n.entity, n.target, n.direction);
                        }
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = this.pool, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e];
                        t.destroyEntity(n);
                    }
                }, e;
            }(a.default);
            i.default = l;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138,
            "../components/CollisionEventComponent": 193
        }],
        197: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../../math/Vec2"), l = t("../components/CollisionEventComponent"), h = new o.default(), u = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Collider, s.default.Position]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.pool, e = this.group.getEntities(), i = this.services.collision, n = e.length, r = 0; r < n; r++) for (var a = e[r], s = a.collider, o = r + 1; o < n; o++) {
                        var u = e[o], c = u.collider;
                        if (this.shouldCollide(s.mask, c.group)) {
                            var d = a.collider, _ = u.collider, f = !1;
                            d.enable && _.enable && (f = i.testCollision(a.position, u.position, d.radius, _.radius, h)),
                                f && (t.createCollisonEvent(a, u, l.CollisionType.CollisionEnter, h.mul(-1)), t.createCollisonEvent(u, a, l.CollisionType.CollisionEnter, h.clone()));
                        }
                    }
                }, e.prototype.shouldCollide = function (t, e) {
                    return 0 != (t & e);
                }, e;
            }(a.default);
            i.default = u;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138,
            "../components/CollisionEventComponent": 193
        }],
        198: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.longMode = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        199: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../sdk/sdk"), r = function () {
                function t() { }
                return t.prototype.vibrate = function (t) {
                    n.default.deviceVibrate(t);
                }, t;
            }();
            i.default = r;
        }, {
            "../../../sdk/sdk": 327
        }],
        200: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        anyOf: [l.default.DeviceVibrate]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.pool, i = this.services.device, n = !1, r = 0, a = t; r < a.length; r++) {
                        var s = a[r];
                        if (!n) {
                            var o = s.deviceVibrate;
                            i.vibrate(o.longMode);
                        }
                        e.destroyEntity(s), n = !0;
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        201: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.direction = new a.default(), e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.type = t, e && this.direction.set(e).normalizeSelf();
                }, e.prototype.onReset = function () {
                    this.direction.setXY(0, 0);
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        202: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.target = t;
                }, e.prototype.onReset = function () {
                    this.target = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        203: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.speed = 1, e.keepDuration = !1, e;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n, r) {
                    this.type = t, this.speed = i, this.playType = e, this.keepDuration = n || !1, this.path = r;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        204: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.name = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        205: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.value = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        206: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.skills = t;
                }, e.prototype.onReset = function () {
                    for (var t = 0, e = this.skills; t < e.length; t++) {
                        e[t].recyle();
                    }
                    this.skills = void 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        207: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.behavior = new b3.BehaviorTree(), e._enable = !0, e._loaded = !1, e;
                }
                return r(e, t), Object.defineProperty(e.prototype, "enable", {
                    get: function () {
                        return this._loaded && this._enable;
                    },
                    set: function (t) {
                        this._enable = t;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i) {
                    this.behavior.id = t, e && this.load(e), this._enable = !1 !== i;
                }, e.prototype.load = function (t) {
                    this.behavior.load(t, void 0), this._loaded = !0;
                }, e.prototype.onReset = function () {
                    this.behavior.root = null, this._loaded = !1;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        208: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.collisionInfos = t;
                }, e.prototype.onReset = function () {
                    this.collisionInfos = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        209: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.goalGroup = t, this.data = e;
                }, e.prototype.onReset = function () {
                    this.data = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        210: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i) {
                    this.rect = t, this.data = i, this.once = e;
                }, e.prototype.onReset = function () {
                    this.rect = null, this.data = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        211: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.id = t, this.isLocal = e, this.enableAction = !0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        212: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.updater = t;
                }, e.prototype.onReset = function () {
                    this.updater = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        213: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.id = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        214: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.getter = t;
                }, e.prototype.onReset = function () {
                    this.getter = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        215: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.speedLimit = 0, e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.speedLimit = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        216: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../state/StateMachine"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.machine = new a.default(), e;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    var r = this.machine;
                    r.setOwner(t), r.setDefaultState(e);
                    for (var a = 0, s = i; a < s.length; a++) {
                        var o = s[a];
                        r.addState(o);
                    }
                    n && r.setState(n);
                }, e.prototype.onReset = function () {
                    this.machine.clear();
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../base/BaseComponent": 137,
            "../../state/StateMachine": 310
        }],
        217: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.strong = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        218: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.RelifePointComponent = i.BallHolderComponent = i.RoleComponent = i.BallComponent = void 0;
            var n = t("../../base/BaseComponent"), a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e;
            }(n.default);
            i.BallComponent = a;
            var s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.group = t;
                }, e;
            }(n.default);
            i.RoleComponent = s;
            var o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.ball = t;
                }, e.prototype.onReset = function () {
                    this.ball = null;
                }, e;
            }(n.default);
            i.BallHolderComponent = o;
            var l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.locked = !1, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.group = t, this.validArea = e, this.locked = !1;
                }, e.prototype.onReset = function () {
                    this.validArea = null;
                }, e;
            }(n.default);
            i.RelifePointComponent = l;
        }, {
            "../../base/BaseComponent": 137
        }],
        219: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function () { }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        220: [function (t, e, i) {
            "use strict";
            var n;
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var r = entitas.Pool, a = entitas.Matcher, s = t("../../../math/Vec2"), o = t("../../Componets"), l = t("../../GameConstants"), h = t("../../../math/MathHelper"), u = t("../../../math/Rect"), c = t("../../../EventCenter"), d = t("../../../Events"), _ = t("../../interfaces"), f = t("../../../Path"), p = t("../../../data/fight/IFightData"), m = t("../../../data/UserData"), g = t("../../../IData"), y = t("../../state/StateType"), v = t("../../StaticBehaviors"), S = t("../../base/GameContext"), T = t("../../../sdk/sdk"), E = t("../../../data/config/RewardConfig"), C = t("../../../data/MjpHelper"), x = t("../../HomeConstants"), b = new s.default(), I = new s.default(), w = new u.default(), A = ((n = {})[_.AnimationType.Idle] = "idle",
                n[_.AnimationType.SlowRun] = "run_slow", n[_.AnimationType.FastRun] = "run_fast",
                n[_.AnimationType.Hit] = "hit", n[_.AnimationType.Fly] = "fly", n[_.AnimationType.Shot] = "shot",
                n[_.AnimationType.Celebrate] = "celebrate", n[_.AnimationType.SlideTackleStart] = "atk_start",
                n[_.AnimationType.SlideTackleEnded] = "atk_end", n[_.AnimationType.Sit] = "sit",
                n[_.AnimationType.WinRun] = "run_happy", n[_.AnimationType.GroundGoal] = "goal",
                n[_.AnimationType.FlyCoin] = "coin_jump", n);
            function R(t, e) {
                t.hasComponent(e) && t.removeComponent(e);
            }
            function M(t, e, i, n) {
                r.instance.createTimerHandler(t, 1, e, i, n);
            }
            function D() {
                for (var t = 0, e = r.instance.getEntities(a.create({
                    allOf: [o.default.Camera]
                })); t < e.length; t++) {
                    var i = e[t];
                    i.replaceOffset(), i.replaceSimpleAnimation([{
                        from: {
                            x: 0,
                            y: 0,
                            height: 0
                        },
                        to: {
                            x: .5,
                            y: .1,
                            height: -1
                        },
                        duration: .04
                    }, {
                        from: {
                            x: .5,
                            y: .1,
                            height: -1
                        },
                        to: {
                            x: 0,
                            y: 0,
                            height: 0
                        },
                        duration: .06
                    }, {
                        from: {
                            x: 0,
                            y: 0,
                            height: 0
                        },
                        to: {
                            x: .024,
                            y: .05,
                            height: -.5
                        },
                        duration: .06
                    }, {
                        from: {
                            x: .024,
                            y: .05,
                            height: -.5
                        },
                        to: {
                            x: .024,
                            y: -.04,
                            height: .026
                        },
                        duration: .06
                    }, {
                        from: {
                            x: .024,
                            y: -.04,
                            height: .026
                        },
                        to: {
                            x: 0,
                            y: 0,
                            height: 0
                        },
                        duration: .1
                    }]);
                }
            }
            function O(t) {
                return !!t.hasComponent(o.default.Player) && t.player.isLocal;
            }
            function L(t, e) {
                t.hasComponent(o.default.Collider) && (t.collider.enable = e);
            }
            function P(t, e, i) {
                var n = t.position;
                n.x >= e.x && n.x <= e.right ? function (t, e, i, n) {
                    var a = new s.default(h.default.randomBetween(i.x, i.right), i.y).sub(e);
                    R(t, o.default.Follow), R(t, o.default.Bezier), R(t, o.default.Flight), w.set(i),
                        w.height = 100, i.y > 0 && (w.y -= 100), t.replaceValidArea(w, !1), t.replaceSlide(e.x, e.y, a.x, a.y, .3),
                        t.replaceHeight(0);
                    var l = h.default.randomBetween(1.5, 2);
                    t.replaceFloatTo(0, l, .3, Laya.Ease.quadOut);
                    var u = r.instance, c = n.goalGroup;
                    u.createTimerHandler(.3, 1, null, function () {
                        var e = t.position, i = e.y > 0 ? .2 : -.2;
                        t.replaceSlide(e.x, e.y, 0, i, .1, Laya.Ease.quadOut), t.replaceFloatTo(l, 0, .5, Laya.Ease.quadIn),
                            n.ground.replaceAnimation(_.AnimationType.GroundGoal, _.AnimationPlayType.Normal, 1, !1, "football_ground/goal" + c),
                            u.createVibration(!1), D();
                    }), u.createTimerHandler(.4, 1, null, function () {
                        var e = t.position;
                        a.y = -a.y, a.normalizeSelf().mulSelf(h.default.randomBetween(1.5, 2.3)), t.replaceSlide(e.x, e.y, a.x, a.y, 2, Laya.Ease.quadInOut);
                    }), u.createTimerHandler(.8, 1, null, function () {
                        R(t, o.default.FloatTo), t.replaceFlight(.3 * l, .8, 3);
                    });
                }(t, b.set(n), e, i) : function (t, e, i, n) {
                    var a = new s.default(h.default.randomBetween(i.x, i.right), i.y + (i.y > 0 ? -1 : 1)), l = new s.default(Math.max(i.x + 1, Math.min(i.right - 1, a.x)), a.y + (a.y > 0 ? -4 : 4));
                    R(t, o.default.Slide), R(t, o.default.Follow), R(t, o.default.ValidArea), t.replaceBezier(.5, e, a, l),
                        t.replaceHeight(0);
                    var u = h.default.randomBetween(1.5, 2);
                    t.replaceFloatTo(0, u, .5, Laya.Ease.quadOut);
                    var c = a.sub(e), d = r.instance, f = n.goalGroup;
                    d.createTimerHandler(.5, 1, null, function () {
                        var e = t.position, i = e.y > 0 ? .2 : -.2;
                        t.replaceSlide(e.x, e.y, 0, i, .1, Laya.Ease.quadOut), t.replaceFloatTo(u, 0, .5, Laya.Ease.quadIn),
                            n.ground.replaceAnimation(_.AnimationType.GroundGoal, _.AnimationPlayType.Normal, 1, !1, "football_ground/goal" + f),
                            d.createVibration(!1), D();
                    }), d.createTimerHandler(.6, 1, null, function () {
                        var e = t.position;
                        c.setXY(0, c.y > 0 ? -1 : 1), c.mulSelf(h.default.randomBetween(1.5, 2.3)), t.replaceSlide(e.x, e.y, c.x, c.y, 2, Laya.Ease.quadInOut);
                    }), d.createTimerHandler(1, 1, null, function () {
                        R(t, o.default.FloatTo), t.replaceFlight(.3 * u, .8, 3);
                    });
                }(t, b.set(n), e, i), t.replaceParticlePanel([{
                    url: f.default.getSprite3DPath("particle_ballfly1"),
                    path: "football/ball"
                }]), M(.6, null, function () {
                    t._isEnabled && t.replaceParticlePanel([]);
                });
            }
            function N(t) {
                var e = t.ballHolder.ball;
                R(e, o.default.Follow), R(e, o.default.MoveInEmit);
                t.role;
                L(e, !0), t.removeComponent(o.default.BallHolder);
                var i = t.forward, n = e.position;
                e.replaceSlide(n.x, n.y, 2 * i.x, 2 * i.y, 1, Laya.Ease.quadOut), t.state.machine.emit(d.default.BALL_DROP),
                    e.replaceParticlePanel([{
                        url: f.default.getSprite3DPath("particle_football")
                    }]);
            }
            function B(t, e) {
                if (t.hasComponent(o.default.Follow)) {
                    var i = t.follow.target;
                    N(i);
                }
                t.replaceFollow(e, 0, 0, .4), t.replaceHeight(0), R(t, o.default.Slide), R(t, o.default.Flight),
                    e.addBallHolder(t);
                e.role.group;
                (L(t, !1), e.state.machine.emit(d.default.BALL_HOLD), O(e)) && (t.replaceParticlePanel([]),
                    r.instance.createVibration(!1));
            }
            function F(t) {
                var e = [];
                return t.position.y > 0 ? (e.push(new s.default(0, -1)), e.push(new s.default(-2, 0)),
                    e.push(new s.default(2, 0)), e.push(new s.default(-1, .5)), e.push(new s.default(1, .5))) : (e.push(new s.default(0, 1)),
                        e.push(new s.default(-2, -0)), e.push(new s.default(2, -0)), e.push(new s.default(-1, -.5)),
                        e.push(new s.default(1, -.5))), e;
            }
            function k(t, e) {
                t === l.default.PLAYER_1_GROUP ? function (t) {
                    var e = r.instance;
                    if (!t) {
                        var i = e.getEntities(a.create({
                            allOf: [o.default.Role, o.default.Player]
                        }));
                        t = i[0];
                    }
                    for (var n = l.default.PLAYER_1_GROUP, s = null, h = 0, u = e.getEntities(a.create({
                        allOf: [o.default.Role, o.default.State]
                    })); h < u.length; h++) {
                        var c = u[h], d = c.role, _ = c.state;
                        if (d.group === n) {
                            if (t || (t = c), s || (s = F(t)), c.hasComponent(o.default.Player)) c.player.enableAction = !1;
                            if (t === c) _.machine.setState(y.default.WinRun, s.shift()); else {
                                var f = s.pop();
                                _.machine.setState(y.default.WinChase, {
                                    target: t,
                                    x: f.x,
                                    y: f.y
                                });
                            }
                        } else _.machine.setState(y.default.Idle);
                        if (c.hasComponents([o.default.Behavior, o.default.Robot])) c.behavior.enable = !1;
                    }
                    t ? e.createTimerHandler(1, 1, null, function () {
                        for (var i = 0, n = e.getEntities(a.create({
                            allOf: [o.default.Camera]
                        })); i < n.length; i++) {
                            var r = n[i];
                            r.replaceCamera(l.default.CAMERA_WIN_FILED), r.replaceForward(l.default.CAMERA_WIN_FORWARD_X, l.default.CAMERA_WIN_FORWARD_Y),
                                r.replaceFollow(t, l.default.CAMERA_WIN_X_OFFSET, l.default.CAMERA_WIN_Y_OFFSET),
                                r.replaceRotation(l.default.CAMERA_WIN_ROTATION_X, l.default.CAMERA_WIN_ROTATION_Y),
                                r.replaceHeight(l.default.CAMERA_WIN_HEIGHT);
                        }
                    }) : console.log("No Holder win:::: ", new Error().stack);
                }(e) : function (t) {
                    for (var e = r.instance, i = l.default.PLAYER_2_GROUP, n = null, s = 0, h = e.getEntities(a.create({
                        allOf: [o.default.Role, o.default.State]
                    })); s < h.length; s++) {
                        var u = h[s], c = u.role, d = u.state;
                        if (c.group === i) {
                            if (t || (t = u), n || (n = F(t)), u.hasComponent(o.default.Player)) u.player.enableAction = !1;
                            if (t === u) d.machine.setState(y.default.WinRun, n.shift()); else {
                                var _ = n.pop();
                                d.machine.setState(y.default.WinChase, {
                                    target: t,
                                    x: _.x,
                                    y: _.y
                                });
                            }
                        } else d.machine.setState(y.default.Idle);
                        if (u.hasComponents([o.default.Behavior, o.default.Robot])) u.behavior.enable = !1;
                    }
                }(e);
            }
            function V(t) {
                var e = m.default.getInstance(), i = t.counter;
                i.shootCoin && e.gainCoin(i.shootCoin, "shoot", !0), i.hitFlyCoin && e.gainCoin(i.hitFlyCoin, "hitfly", !0);
            }
            function U(t, e, i, n) {
                var r = g.ResultType.Draw;
                t.score1 > t.score2 ? r = g.ResultType.Win : t.score1 < t.score2 && (r = g.ResultType.Lose),
                    e.result = r;
                var a = m.default.getInstance(), s = t.counter;
                e.reward = a.onGameCompleted(r, s.coin, i, n), e.counter = s.clone();
            }
            var G = function () {
                function t() {
                    this._lastTime = 0;
                }
                return t.prototype.clearComboReleaseHandler = function (t) {
                    this.comboReleaseHandler && t.onEntityReleased.remove(this.comboReleaseHandler),
                        this.comboReleaseHandler = null;
                }, t.prototype.onCollisionEnter = function (t, e, i) {
                    if ("ball" !== e.name) if (t.hasComponent(o.default.GameCollision)) {
                        var n = t.gameCollision.collisionInfos;
                        n.push({
                            target: e,
                            direction: i
                        }), t.replaceGameCollision(n);
                    } else t.addGameCollision([{
                        target: e,
                        direction: i
                    }]), "ball" !== t.name && function (t) {
                        var e = 0, i = t.state;
                        if (!i.machine.inState(y.default.Skill_Cast | y.default.Skill_End)) {
                            if (!i.machine.inState(y.default.Hold) && t.hasComponent(o.default.DirectionMove)) {
                                var n = t.directionMove.speed;
                                n > 0 && (e += 1, n > l.default.HOLD_MAX_SPEED && (e += 1, t.hasComponent(o.default.Player) && (e += 1)));
                            }
                            S.default.inst.type === p.FightType.Guide && O(t) && (e = 10), t.replaceStrong(e);
                        }
                    }(t);
                }, t.prototype.onCollisionStay = function (t, e, i) { }, t.prototype.onCollisionExit = function (t, e, i) { },
                    t.prototype.playAnimation = function (t, e, i, n, r) {
                        var a = function (t) {
                            if (!t) return null;
                            for (var e = t.getComponent(Laya.Animator); !(e || t.numChildren <= 0);) e = (t = t.getChildAt(0)).getComponent(Laya.Animator);
                            return e;
                        }(t);
                        if (!a) return console.warn("Model as no Animtor component", t.name);
                        var s = A[e];
                        if (!s) return console.log("unkown animationtype::: ", e);
                        var o = 0;
                        r && (o = a.getCurrentAnimatorPlayState().normalizedTime);
                        a.speed = n || 1, i === _.AnimationPlayType.CrossFade ? a.crossFade(s, .1, 0, o) : a.play(s, 0, o);
                    }, t.prototype.onRoleAction = function (t, e, i) {
                        e === _.ActionType.Stop && t.state.machine.emit(d.default.UI_PLAYER_STOP);
                    }, t.prototype.onBallCollision = function (t, e, i) {
                        if (e.length <= 0) console.warn("no collisions in onBallCollision"); else {
                            b.setXY(0, 0);
                            for (var n = 0, r = e; n < r.length; n++) {
                                var a = r[n];
                                b.addSelf(a.direction);
                                var s = a.target;
                                if (s.state.machine.enableEnter(y.default.Hold)) return B(t, s);
                            }
                            (function (t) {
                                if (!t.hasComponent(o.default.Follow)) return !1;
                                var e = t.follow.target;
                                return !(!e.hasComponent(o.default.State) || !e.state.machine.inState(y.default.Hold)) || (console.warn("Why role is not in Hold but ball follow him ?"),
                                    N(e), !1);
                            })(t) || function (t, e, i) {
                                t.collider.enable = !1;
                                var n = t.position, r = h.default.randomBetween(l.default.BALL_FLY_DURATION_MIN, l.default.BALL_FLY_DURATION_MAX), a = h.default.randomBetween(l.default.BALL_FLY_DISTANCE_MIN, l.default.BALL_FLY_DISTANCE_MAX), s = h.default.randomBetween(l.default.BALL_FLY_HEIGHT_MIN, l.default.BALL_FLY_HEIGHT_MAX);
                                t.replaceSlide(n.x, n.y, e.x * a, e.y * a, r, Laya.Ease.linearNone), t.replaceHeight(0),
                                    t.replaceFlight(s, r), M(r, null, L, [t, !0]);
                            }(t, b.normalize(), e.length);
                        }
                    }, t.prototype.onRoleCollisionBegin = function (t, e, i) {
                        for (var n, a = -1 / 0, s = 0, l = e; s < l.length; s++) {
                            var h = l[s], u = h.target.strong.strong;
                            u > a && (a = u, n = h);
                        }
                        if (n) {
                            var c = t.strong.strong, d = t.state;
                            if (c <= a && (c < a && d.machine.hasState(y.default.Fly) ? d.machine.setState(y.default.Fly, n.direction) : d.machine.setState(y.default.Hit, n.direction),
                                t.hasComponent(o.default.BallHolder))) {
                                var _ = t.ballHolder.ball;
                                if (_.hasComponent(o.default.GameCollision)) {
                                    var p = _.gameCollision;
                                    _.replaceGameCollision(e.concat(p.collisionInfos));
                                } else _.addGameCollision(e.slice());
                                N(t);
                            }
                            if (O(t)) {
                                var m = t.position, g = r.instance;
                                g.createParticle(f.default.getSprite3DPath("particle_hit"), m.x, m.y, 1), g.createVibration(!1),
                                    g.createSound(f.default.getSoundPath("hit")), D();
                            }
                        }
                    }, t.prototype.onRoleCollisionEnded = function (t, e, i) {
                        for (var n = this, a = t.strong, s = a.strong, o = 0, h = e; o < h.length; o++) {
                            var u = h[o].target;
                            if (s > (a = u.strong).strong) if (u.state.machine.inState(y.default.Fly | y.default.WaitingRelife)) {
                                t.state.machine.setState(y.default.Rockey);
                                break;
                            }
                        }
                        if (i.enableRelife && O(t)) {
                            var _ = r.instance, f = i.combo;
                            f && _.hasEntity(f) || (i.combo = f = _.createEntity("combo").addAttrSpeed(0), this.comboReleaseHandler = function () {
                                i.combo = null, c.default.emit(d.default.COMBO_CHANGE, 0), n.clearComboReleaseHandler(f);
                            }, f.onEntityReleased.add(this.comboReleaseHandler));
                            for (var p = f.attrSpeed, g = 0, v = i.counter, S = (m.default.getInstance(), function (t) {
                                var e = t.target.state;
                                if (e.machine.inState(y.default.Fly | y.default.WaitingRelife)) {
                                    var i = p.value + 1;
                                    f.replaceAttrSpeed(i), f.replaceLifeDuration(l.default.COMBO_DURATION), e.machine.emit(d.default.COMBO_CHANGE, i);
                                    var n = function (t) {
                                        var e = Math.min(E.default.MAX_COMBO, t);
                                        return t = Math.min(t, E.default.COMBO_REWARD.length), {
                                            realCombo: e,
                                            coin: E.default.COMBO_REWARD[t - 1]
                                        };
                                    }(i);
                                    g = n.realCombo, v.hitFly += 1, v.hitFlyCoin += n.coin, v.coin += n.coin;
                                    var r = n.coin, a = v.coin;
                                    _.createTimerHandler(.5, 1, null, function () {
                                        c.default.emit(d.default.COMBO_REWARD, r, a);
                                    });
                                }
                            }), T = 0, C = e; T < C.length; T++) {
                                S(C[T]);
                            }
                            g && c.default.emit(d.default.COMBO_CHANGE, g);
                        }
                    }, t.prototype.onBallOutofValid = function (t, e, i, n) {
                        t.hasComponent(o.default.Follow) && N(t.follow.target);
                        t.replaceSlide(e, i, 3 * n.x, 3 * n.y, 1, Laya.Ease.quadOut), L(t, !1), M(.2, null, L, [t, !0]);
                    }, t.prototype.onRoleOutofValid = function (t, e, i, n) { },
                    t.prototype.onEntityMoveIn = function (t, e, i, n) {

                        //射门
                        if (n.readyOver) console.warn("ECS: onEntityMoveIn called more than once, entity is :: ", t.name, t.hasComponent(o.default.State) ? t.state.machine.currentState : "None State"); else {
                            var s, h;
                            if (console.log("onEntityMoveIn ready game over: Entity :: ", t.name, t.hasComponent(o.default.State) ? t.state.machine.currentState : "None State"),
                                n.readyOver = !0, "ball" === t.name) {
                                if (!(s = t).hasComponent(o.default.Follow)) return console.log("Who hold the ball in the fobbiden area??", e);
                                var u = s.follow;
                                h = u.target;
                            } else {
                                if (!(h = t).hasComponent(o.default.BallHolder)) return console.log("Winner is NOT Holder???", t.name);
                                var _ = h.ballHolder;
                                s = _.ball;
                            }
                            var p = i, m = h.state;
                            c.default.emit(d.default.GAME_SHOT, O(h)),
                                m.machine.setState(y.default.Shot, {
                                    duration: .25,
                                    rect: p
                                });
                            var g = h.role;
                            if (g.group === l.default.PLAYER_1_GROUP ? function (t) {
                                for (var e = 0, i = r.instance.getEntities(a.create({
                                    anyOf: [o.default.Camera]
                                })); e < i.length; e++) {
                                    // var n = i[e];
                                    // R(n, o.default.Follow),
                                    //  R(n, o.default.Offset), 
                                    //  R(n, o.default.SimpleAnimation);
                                    // var s = l.default.GOAL_AREA_1, h = t.position;
                                    // b.setXY(0, s.y),
                                    //  I.setXY(h.x, h.y), 
                                    // I.subSelf(b).normalizeSelf().mulSelf(16), b.addSelf(I),
                                    //     n.replaceHeight(7),
                                    //      n.replacePosition(b.x, b.y), 
                                    //     n.replaceForward(I.x, I.y),
                                    //      n.replaceRotation(l.default.CAMERA_ROTATION_X, l.default.CAMERA_ROTATION_Y),
                                    //     n.replaceCamera(60);
                                }
                            }(h) : function (t) {
                                for (var e = 0, i = r.instance.getEntities(a.create({
                                    anyOf: [o.default.Camera]
                                })); e < i.length; e++) {
                                    var n = i[e];
                                    R(n, o.default.Follow),
                                        R(n, o.default.Offset),
                                        R(n, o.default.SimpleAnimation);
                                    var s = l.default.GOAL_AREA_2,
                                        h = t.position;
                                    b.setXY(0, s.y + 4),
                                        I.setXY(h.x, h.y),
                                        b.sub(I, I),
                                        n.replaceHeight(7),
                                        n.replacePosition(b.x, b.y),
                                        n.replaceForward(I.x, I.y),
                                        n.replaceRotation(l.default.CAMERA_ROTATION_X, l.default.CAMERA_ROTATION_Y),
                                        n.replaceCamera(60);
                                }
                            }(h), O(h)) {
                                var v = n.counter, S = E.default.SHOOT_REWARD;
                                v.shoot += 1, v.coin += S, v.shootCoin += S, n.shootCoin = S;
                            } else n.shootCoin = 0;
                            R(s, o.default.Collider),
                                s.replaceParticlePanel([]);
                            var T = r.instance, C = s.position;
                            T.createParticle(f.default.getSprite3DPath("particle_shot"), C.x, C.y, .5), T.createGameOver(g.group, h),
                                T.createTimeScaler(.1), T.createTimerHandler(.125, 1, null, function () {
                                    T.createParticle(f.default.getSprite3DPath("particle_wave"), C.x, C.y, .5), T.createTimeScaler(1, .3),
                                        T.createSound(f.default.getSoundPath("ball_land")), P(s, p, n);
                                }), T.createTimerHandler(.4, 1, null, function () {
                                    k(g.group, h);
                                    var t = r.instance, e = h.position;
                                    t.createParticle(f.default.getSprite3DPath("particle_celebrate"), e.x, e.y);
                                });
                        }
                    },


                    t.prototype.onRoleRelife = function (t, e) {
                        var i = t.state;
                        i.machine.setState(y.default.Normal), i.machine.setState(y.default.RelifeIng, e);
                    }, t.prototype.onNoRelife = function (t) {
                        t.state.machine.setState(y.default.Normal);
                    }, t.prototype.getBehaviorData = function (t) {
                        return v.default.getData(t);
                    }, t.prototype.onGameInited = function (t) {
                        var e = r.instance, i = 0, n = t.score1 - t.score2;
                        i = n >= 3 ? 30 : n >= 1 ? 10 : n >= 0 ? 0 : n >= -2 ? -10 : -30, t.fightScore1 = m.default.getInstance().rank.fightScore - i / 2,
                            t.targetRank ? t.fightScore2 = t.targetRank.fightScore + t.player2Skin.fightScore - t.player1Skin.fightScore + i : t.fightScore2 = 0,
                            console.log(">>>>>>已方战力评分：", t.fightScore1), console.log(">>>>>>对方战力评分：", t.fightScore2);
                        var s = t.robotInit1 ? v.default.getTree(t.robotInit1) : null, h = t.robotInit2 ? v.default.getTree(t.robotInit2) : null;
                        if (s || h) for (var u = 0, _ = e.getEntities(a.create({
                            allOf: [o.default.Robot, o.default.Role]
                        })); u < _.length; u++) {
                            var p = _[u];
                            p.role.group === l.default.PLAYER_1_GROUP ? s && s.tick(p, t) : h && h.tick(p, t);
                        }
                        for (var g = 0, S = e.getEntities(a.create({
                            allOf: [o.default.State]
                        })); g < S.length; g++) {
                            S[g].state.machine.setState(y.default.Idle);
                        }
                        e.createTimerHandler(.5, 1, null, function () {
                            e.createSound(f.default.getSoundPath("start-whistle"));
                        }), e.createTimerHandler(1, 1, null, function () {
                            for (var i, n, r = 0, s = e.getEntities(a.create({
                                anyOf: [o.default.State]
                            })); r < s.length; r++) {
                                var l = s[r];
                                l.state.machine.emit(d.default.GAME_START), !i && O(l) && (i = l);
                            }
                            if (i) {
                                var h = e.getEntities(a.create({
                                    allOf: [o.default.Camera]
                                }))[0];
                                if (h) {
                                    var u = h.renderNode.root, _ = u.viewport, f = new Laya.Vector3(), p = new Laya.Vector3(), m = i.position;
                                    f.x = m.x, f.z = m.y, _.project(f, u.projectionViewMatrix, p), (n = new Laya.Vector2()).x = p.x / _.width * Laya.stage.width,
                                        n.y = p.y / _.height * Laya.stage.height;
                                }
                            }
                            if (Laya.LocalStorage.getItem("firstfirst") == 0
                                || Laya.LocalStorage.getItem("firstfirst") == null) {

                                const jiaoxue = new Laya.Image()
                                jiaoxue.skin = "new/jiaoxue.png"
                                jiaoxue.x = 210
                                jiaoxue.y = 888
                                jiaoxue.scaleX = jiaoxue.scaleY = 1.5
                                window.jiaoxue = jiaoxue
                                Laya.stage.addChild(jiaoxue)
                                Laya.timer.once(1e3, this, h5splash.hideLoading)
                                Laya.stage.once(Laya.Event.MOUSE_DOWN, this, () => {
                                    jiaoxue.visible = !1
                                    Laya.LocalStorage.setItem("firstfirst", 2)
                  
                          
                                    // YYGGames.showInterstitial(() => {
                                    //     jiaoxue.visible = !1
                                    //     Laya.LocalStorage.setItem("firstfirst", 2)
                                    // })
                                })
                                // jiaoxue.on(Laya.Event.MOUSE_DOWN, this, () => {
                                //     YYGGames.showInterstitial(() => {

                                //         Laya.LocalStorage.setItem("firstfirst", 2)
                                //         jiaoxue.visible = !1
                                //     })
                                // })
                            }

                          //  YYGGames.gameBanner.visible = false
                            window.onSoundBtn.visible = !1
                         //   YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = false
                            console.log("emit game start --================="),
                                c.default.emit(d.default.GAME_START, t, n),
                                t.matchPause = !1;
                        });
                    }, t.prototype.onGameOver = function (t, e) {
                        console.log("游戏结束1")
                        var i = !1, n = {
                            result: void 0,
                            reward: void 0,
                            counter: void 0
                        };
                        t.type === p.FightType.Guide ? (i = !0, V(t), U(t, n, x.default.LUCK_GAME_TIMES, !1),
                            m.default.getInstance().onGuidePass()) : 0 === t.matchTime && (i = !0, V(t), U(t, n, 1, !0)),
                            Laya.timer.once(2e3, null, function () {
                                (c.default.emit(d.default.GAME_SCORE, t.score1, t.score2), t.goalGroup === l.default.PLAYER_1_GROUP) && r.instance.createSound(f.default.getSoundPath("cheer"));
                            }), Laya.timer.once(4e3, null, function () {
                                console.log("emit game ended --================="), c.default.emit(d.default.GAME_ENDED, t);
                            }), Laya.timer.once(8e3, null, function () {
                                i ? this.onMatchOver(t, n) : (c.default.emit(d.default.UI_TRANSFORM_START), Laya.timer.once(1e3, this, function () {
                                    c.default.emit(d.default.UI_ENTER_GAME);
                                }));
                            }.bind(this));
                    }, t.prototype.onMatchOver = function (t, e) {
                        e || (e = {
                            reward: void 0,
                            result: void 0,
                            counter: void 0
                        }, V(t), U(t, e, 1, !0), k(e.result, null)), T.default.onCollectionGame({
                            gameType: t.type,
                            duration: t.matchTime,
                            isWin: e.result,
                            commonReason: 0,
                            isLocal: 1,
                            gameId: t.gameId,
                            subParam: 1e4 * t.score1 + t.score2
                        });
                        var i = t.counter, n = e.reward, s = m.default.getInstance().createTime;
                        C.default.onGameOver(t.type, t.gameId, t.score1, t.score2, i.hitFly, i.shoot, i.coin, n && n.chestId || 0, n && n.chestId && n.chestIndex < 0 || !1, s, t.matchTime, e.result),
                            c.default.emit(d.default.MATCH_ENDED, t, e), t.onGameCompleted(), c.default.emit(d.default.GAME_COMPLETE);
                        for (var l = r.instance, h = 0, u = l.getEntities(a.create({
                            allOf: [o.default.State, o.default.Robot]
                        })); h < u.length; h++) {
                            var _ = u[h];
                            _.hasComponent(o.default.MoveInEmit) && (_.removeComponent(o.default.MoveInEmit),
                                console.warn("Role has MoveInEmit Component ::: ", _.name));
                        }
                        l.createSound(f.default.getSoundPath("end-whistle"));
                    }, t.prototype.onMatchTimeUpdate = function (t, e) {
                        (e = Math.floor(e)) !== this._lastTime && (this._lastTime = e, c.default.emit(d.default.UPDATE_MATCH_TIME, t),
                            e <= 10 && r.instance.createSound(f.default.getSoundPath("countdown")));
                    }, t;
            }();
            i.default = G;
        }, {
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../../../IData": 8,
            "../../../Path": 12,
            "../../../data/MjpHelper": 18,
            "../../../data/UserData": 20,
            "../../../data/config/RewardConfig": 28,
            "../../../data/fight/IFightData": 31,
            "../../../math/MathHelper": 320,
            "../../../math/Rect": 321,
            "../../../math/Vec2": 322,
            "../../../sdk/sdk": 327,
            "../../Componets": 126,
            "../../GameConstants": 127,
            "../../HomeConstants": 129,
            "../../StaticBehaviors": 136,
            "../../base/GameContext": 139,
            "../../interfaces": 246,
            "../../state/StateType": 311
        }],
        221: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.SlideTackle = i.SkillBase = void 0;
            var n = entitas.Pool, a = t("../../interfaces"), s = t("../../Componets"), o = t("../../../math/Vec2"), l = t("../../../math/MathHelper"), h = t("../../state/StateType"), u = t("../../GameConstants"), c = t("../../../Path"), d = new o.default(), _ = new o.default(), f = function () {
                function t() {
                    this.cdDuration = 0, this._cdTime = 0;
                }
                return t.create = function () {
                    return Laya.Pool.getItemByClass(this.__classSign, this);
                }, t.cache = function (t) {
                    Laya.Pool.recover(this.__classSign, t);
                }, t.prototype.startCD = function (t) {
                    this._cdTime = t;
                }, t.prototype.isCD = function (t) {
                    return this._cdTime + this.cdDuration <= t;
                }, t.__classSign = "SkillBase", t;
            }();
            i.SkillBase = f;
            var p = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.usableInNormal = !0, e.usableInHold = !1, e.keepNormal = !0, e.keepHold = !1,
                        e.keepRockey = !0, e.enableNormal = !0, e.enableHold = !0, e.enableRockey = !0,
                        e.castDuration = .5, e.endDuration = .1, e.strong = 2, e;
                }
                return r(e, t), e.prototype.castEnable = function (t, e) {
                    if (!this.isCD(e.totalTime)) return !1;
                    if (!t.hasComponent(s.default.DirectionMove)) return !1;
                    if (t.directionMove.speed < u.default.HOLD_MAX_SPEED) return !1;
                    if (!t.state.machine.enableEnter(h.default.Skill_Cast, this)) return !1;
                    var i = e.getBall();
                    if (!i.hasComponent(s.default.Follow)) return !1;
                    var n = i.follow.target, r = n.role, a = t.role;
                    if (r.group === a.group) return !1;
                    var o = n.position, c = t.position;
                    return d.set(o), _.set(c), !(d.subSelf(_).magSqr() > 4) && (this.startCD(e.totalTime),
                        this.cdDuration = l.default.randomBetween(5, 6), !0);
                }, e.prototype.onSkillCastStart = function (t) {
                    (t.replaceAnimation(a.AnimationType.SlideTackleStart, a.AnimationPlayType.CrossFade, 1, !1),
                        t.hasComponent(s.default.Player)) && (t.player.isLocal && n.instance.createSound(c.default.getSoundPath("slide")));
                }, e.prototype.onSkillCastEnded = function (t) {
                    t.replaceAnimation(a.AnimationType.SlideTackleEnded, a.AnimationPlayType.CrossFade, 1, !1);
                }, e.prototype.recyle = function () {
                    this.cdDuration = this._cdTime = 0, e.cache(this);
                }, e.__classSign = "SlideTackle", e;
            }(f);
            i.SlideTackle = p;
        }, {
            "../../../Path": 12,
            "../../../math/MathHelper": 320,
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../GameConstants": 127,
            "../../interfaces": 246,
            "../../state/StateType": 311
        }],
        222: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../ClassNameDef"), a = t("../../../math/Vec2"), s = t("../../../EventCenter"), o = t("../../../Events"), l = t("../../interfaces"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.direction = new a.default(), e.stoped = !0, e.inputLocked = !1, e;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.getPlayerAction = function (t) {
                    return this.inputLocked || this.stoped ? {
                        type: l.ActionType.Stop
                    } : {
                            type: l.ActionType.Move,
                            direction: this.direction
                        };
                }, e.prototype.setTimeScale = function (t) {
                    this.owner.timer.scale = t;
                }, e.prototype.onAwake = function () {
                    s.default.on(o.default.UI_PLAYER_MOVE, this, this.onPlayerMove), s.default.on(o.default.UI_PLAYER_STOP, this, this.onPlayerStop),
                        s.default.on(o.default.LOCK_INPUT, this, this.lockInput);
                }, e.prototype.onDestroy = function () {
                    s.default.off(o.default.UI_PLAYER_MOVE, this, this.onPlayerMove), s.default.off(o.default.UI_PLAYER_STOP, this, this.onPlayerStop),
                        s.default.off(o.default.LOCK_INPUT, this, this.lockInput);
                }, e.prototype.onReset = function () {
                    this.stoped = !0, this.direction.setXY(0, 0);
                }, e.prototype.onPlayerStop = function () {
                    this.stoped = !0;
                }, e.prototype.onPlayerMove = function (t, e) {
                    this.direction.setXY(t, e), this.stoped = !1;
                }, e.prototype.lockInput = function (t) {
                    this.inputLocked = t;
                }, e.__className = "GameSceneService", e;
            }(n.RecycleScript3D);
            i.default = h;
        }, {
            "../../../ClassNameDef": 2,
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../../../math/Vec2": 322,
            "../../interfaces": 246
        }],
        223: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../sdk/sdk"), r = function () {
                function t() {
                    this._videoPath = null, this._recording = !1, this._beginTime = 0;
                }
                return t.instance = function () {
                    return t._instance || (t._instance = new t()), t._instance;
                }, t.prototype._reset = function () {
                    this._unlinkFile(this._videoPath), this._videoPath = null, this._recording = !1;
                }, t.prototype.support = function () {
                    return "tt" === n.default.getPlatform();
                }, t.prototype._unlinkFile = function (t) {
                    t && n.default.unlink(t, function () {
                        console.log("删除文件成功:" + t);
                    }, function (e) {
                        console.log("删除文件失败:" + t, e);
                    });
                }, t.prototype.deleteVideo = function () {
                    var t = this._videoPath;
                    this.support() && t && this._unlinkFile(t);
                }, t.prototype.recordStart = function () {
                    var t = this;
                    this.support() && (this._recording ? console.warn("正在录屏中，不可重复录屏") : n.default.recordStart({
                        duration: 300
                    }, function (e) {
                        console.log("录音开始~"), t._recording = !0, t._beginTime = new Date().getTime();
                    }));
                }, t.prototype.recordStop = function (t) {
                    var e = this;
                    if (this.support()) return this._recording ? void n.default.recordStop(function (i) {
                        console.log("录屏结束"), e._videoPath = i.videoPath, e._recording = !1;
                        var n = !0;
                        new Date().getTime() - e._beginTime < 3200 && (n = !1, e.deleteVideo()), t && t(n);
                    }) : (console.warn("不在录屏中，不可中止"), void (t && t(!1)));
                    t && t(!1);
                }, t.prototype.shareVideo = function (t) {
                    if (this.support()) {
                        var e = this._videoPath;
                        if (!e) return t && t(!1, "null videoPath");
                        n.default.recordShare({
                            title: "抢夺大作战",
                            videoPath: e,
                            videoTopics: ["抢夺大作战"],
                            createChallenge: !0,
                            success: function () {
                                return console.log("分享成功"), t && t(!0);
                            },
                            fail: function (e) {
                                return console.log("分享失败:" + JSON.stringify(e)), t && t(!1, "share fail");
                            }
                        });
                    } else t(!1, "unsupport");
                }, t._instance = null, t;
            }();
            i.default = r;
        }, {
            "../../../sdk/sdk": 327
        }],
        224: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.RoleStateWinSlide = i.RoleStateWinChase = i.RoleStateWinRun = i.RoleStateRelifeIng = i.RoleStateWaitingRelife = i.RoleStateSkillEnd = i.RoleStateSkillCast = i.RoleStateWin = i.RoleStateShot = i.RoleStateFly = i.RoleStateHit = i.RoleStateHold = i.RoleStateRockey = i.RoleStateNormal = i.RoleStateIdle = void 0;
            var n = entitas.Pool, a = t("../../../Path"), s = t("../../../math/Vec2"), o = t("../../../math/MathHelper"), l = t("../../state/StateType"), h = t("../../state/StateBase"), u = t("../../../Events"), c = t("../../GameConstants"), d = t("../../Componets"), _ = t("../../interfaces"), f = t("../../../math/Rect"), p = t("../../base/GameContext"), m = new s.default(), g = new f.default(), y = l.default.Win | l.default.WinChase | l.default.WinRun | l.default.Idle;
            function v(t, e) {
                t.hasComponent(e) && t.removeComponent(e);
            }
            function S(t, e) {
                t.collider.enable = e;
            }
            function T(t, e) {
                t.hasComponents([d.default.Behavior, d.default.Robot]) && (t.behavior.enable = e);
            }
            function E(t, e) {
                if (t <= 0) return {
                    type: _.AnimationType.Idle,
                    playType: _.AnimationPlayType.CrossFade,
                    speed: 1
                };
                if (t > c.default.HOLD_MAX_SPEED) {
                    var i = e === _.AnimationType.SlowRun ? _.AnimationPlayType.CrossFade : _.AnimationPlayType.Normal, n = 1;
                    return {
                        type: _.AnimationType.FastRun,
                        playType: i,
                        speed: n
                    };
                }
                i = e === _.AnimationType.FastRun ? _.AnimationPlayType.CrossFade : _.AnimationPlayType.Normal,
                    n = 1;
                return {
                    type: _.AnimationType.SlowRun,
                    playType: i,
                    speed: n
                };
            }
            function C(t) {
                if (t.hasComponent(d.default.DirectionMove)) {
                    var e = t.directionMove.speed, i = [];
                    e >= c.default.ROCKET_SPEED && i.push({
                        url: a.default.getSprite3DPath("particle_fire")
                    }), e > c.default.HOLD_MAX_SPEED && i.push({
                        url: a.default.getSprite3DPath("particle_speed")
                    }), e > 0 && i.push({
                        url: a.default.getSprite3DPath("particle_smoke")
                    }), t.replaceParticlePanel(i);
                }
            }
            function x(t, e) {
                var i = t.position, n = o.default.randomBetween(c.default.FLY_MAX_DISTANCE, c.default.FLY_MIN_DISTANCE);
                t.replaceSlide(i.x, i.y, e.x * n, e.y * n, c.default.FLY_RESUME_DELAY, Laya.Ease.quadOut);
            }
            function b(t) {
                var e, i;
                t.role.group === c.default.PLAYER_1_GROUP ? (e = c.default.ATTACK_AREA_1, i = c.default.GOAL_AREA_1) : (e = c.default.ATTACK_AREA_2,
                    i = c.default.GOAL_AREA_2), t.replaceMoveInEmit(e, !0, i);
            }
            var I = function (t) {
                function e() {
                    var e = t.call(this, l.default.Idle) || this, i = l.default.Normal | y;
                    return e._unableEnterFlag = l.default.Full ^ i, e;
                }
                return r(e, t), e.prototype.onEnter = function () {
                    var t = this._owner;
                    t.replaceAnimation(_.AnimationType.Idle, _.AnimationPlayType.CrossFade, 1, !1),
                        t.replaceParticlePanel([]);
                }, e.prototype.onExit = function () { }, e.prototype.onEvent = function (t, e) {
                    switch (t) {
                        case u.default.GAME_START:
                            this._machine.setState(l.default.Normal);
                    }
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateIdle", e;
            }(h.default);
            i.RoleStateIdle = I;
            var w = function (t) {
                function e() {
                    var e = t.call(this, l.default.Normal) || this, i = l.default.Hold | l.default.Rockey | l.default.Skill_End | l.default.RelifeIng;
                    return e._needExitFlag = l.default.Full ^ i, e;
                }
                return r(e, t), e.prototype.enableEnter = function (e, i) {
                    return void 0 === i && (i = null), !!t.prototype.enableEnter.call(this, e) && (0 == (e & l.default.Skill_Cast) || i.usableInNormal);
                }, e.prototype.needExit = function (e, i) {
                    return void 0 === i && (i = null), !!t.prototype.needExit.call(this, e) && (e !== l.default.Skill_Cast || !i.keepNormal);
                }, e.prototype.onEnter = function () {
                    var t = this._owner;
                    t.replaceRenderUpdater(C), t.replaceSpeedAnimation(E), t.replaceSpeedLimit(c.default.RUN_MAX_SPEED),
                        t.replaceDirectionMove(c.default.START_ACCELERATION, -c.default.DEFAULT_ACCELERATION),
                        S(t, !0), T(t, !0);
                }, e.prototype.onExit = function () {
                    var t = this._owner;
                    S(t, !1), T(t, !1), v(t, d.default.DirectionMove), v(t, d.default.RenderUpdater),
                        v(t, d.default.SpeedAnimation);
                }, e.prototype.onEvent = function (t, e) {
                    switch (t) {
                        case u.default.BALL_HOLD:
                            this._machine.setState(l.default.Hold);
                    }
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateNormal", e;
            }(h.default);
            i.RoleStateNormal = w;
            var A = function (t) {
                function e() {
                    var e = t.call(this, l.default.Rockey) || this, i = l.default.Skill_End | l.default.Normal;
                    return e._needExitFlag = l.default.Full ^ i, e;
                }
                return r(e, t), e.prototype.needExit = function (e, i) {
                    return void 0 === i && (i = null), !!t.prototype.needExit.call(this, e) && (e !== l.default.Skill_Cast || !i.keepRockey);
                }, e.prototype.onEnter = function () {
                    var t = this._owner, e = c.default.ROCKET_TIME;
                    t.hasComponent(d.default.AttrRockeyTime) && (e += t.attrRockeyTime.value);
                    this._duration = e;
                    var i = c.default.ROCKET_SPEED;
                    t.hasComponent(d.default.AttrRockeySpeed) && (i += t.attrRockeySpeed.value);
                    t.replaceSpeedLimit(i), t.replaceDirectionMove(c.default.DEFAULT_ACCELERATION, -c.default.DEFAULT_ACCELERATION);
                }, e.prototype.onEnterAgain = function () {
                    this._time = 0;
                }, e.prototype.onExit = function () {
                    var t = this._owner;
                    t.replaceSpeedLimit(c.default.RUN_MAX_SPEED), t.hasComponent(d.default.DirectionMove) && t.replaceDirectionMove(c.default.START_ACCELERATION, -c.default.DEFAULT_ACCELERATION);
                }, e.prototype.onEvent = function (t, e) {
                    switch (t) {
                        case u.default.UI_PLAYER_STOP:
                        case u.default.BALL_HOLD:
                            this.enabled = !1;
                    }
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateRockey", e;
            }(h.default);
            i.RoleStateRockey = A;
            var R = function (t) {
                function e() {
                    var e = t.call(this, l.default.Hold) || this;
                    e._unableEnterFlag = l.default.Rockey;
                    var i = l.default.Skill_End | l.default.Normal;
                    return e._needExitFlag = l.default.Full ^ i, e;
                }
                return r(e, t), e.prototype.enableEnter = function (e, i) {
                    return void 0 === i && (i = null), !!t.prototype.enableEnter.call(this, e) && (0 == (e & l.default.Skill_Cast) || i.usableInHold);
                }, e.prototype.needExit = function (e, i) {
                    return void 0 === i && (i = null), !!t.prototype.needExit.call(this, e) && (e !== l.default.Skill_Cast || !i.keepHold);
                }, e.prototype.onEnter = function () {
                    var t = this._owner, e = c.default.HOLD_MAX_SPEED;
                    t.hasComponent(d.default.AttrHoldSpeed) && (e += t.attrHoldSpeed.value);
                    t.replaceSpeedLimit(e), this._machine.inState(l.default.Skill_End | l.default.Skill_Cast) || b(t);
                }, e.prototype.onExit = function () {
                    var t = this._owner;
                    t.replaceSpeedLimit(c.default.RUN_MAX_SPEED), v(t, d.default.MoveInEmit);
                }, e.prototype.onEvent = function (t, e) {
                    switch (t) {
                        case u.default.BALL_DROP:
                            this.enabled = !1;
                    }
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateHold", e;
            }(h.default);
            i.RoleStateHold = R;
            var M = function (t) {
                function e(e) {
                    var i = t.call(this, e || l.default.Hit) || this;
                    return i.direction = null, i._unableEnterFlag = l.default.Full ^ y, i;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.direction = t;
                }, e.prototype.onEnterAgain = function () {
                    this._time = 0;
                }, e.prototype.onEnter = function () {
                    var t = this._owner, e = c.default.FALL_RESUME_DELAY;
                    t.hasComponent(d.default.AttrHitDuration) && (e += t.attrHitDuration.value);
                    this._duration = e, t.replaceParticlePanel([]), t.replaceAnimation(_.AnimationType.Hit, _.AnimationPlayType.CrossFade, 1, !1),
                        v(t, d.default.DirectionMove), v(t, d.default.RenderUpdater), function (t, e) {
                            var i = t.position, n = o.default.randomBetween(c.default.FALL_MIN_DISTANCE, c.default.FALL_MAX_DISTANCE);
                            if (t.hasComponent(d.default.AttrHitDistance)) {
                                var r = t.attrHitDistance;
                                n = Math.max(0, n + r.value);
                            }
                            t.replaceSlide(i.x, i.y, e.x * n, e.y * n, c.default.FALL_RESUME_DELAY, Laya.Ease.quadOut);
                        }(t, this.direction);
                }, e.prototype.onExit = function () {
                    v(this._owner, d.default.Slide), this.direction = null;
                }, e.prototype.recycle = function () {
                    this.direction = null, e.purge(this);
                }, e.__classSign = "RoleStateHit", e;
            }(h.default);
            i.RoleStateHit = M;
            var D = function (t) {
                function e() {
                    var e = t.call(this, l.default.Fly) || this;
                    return e.direction = null, e.shadow = null, e._unableEnterFlag = l.default.Full ^ (y | l.default.WaitingRelife),
                        e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.direction = t;
                }, e.prototype.onEnterAgain = function () {
                    this._time = 0;
                }, e.prototype.onEnter = function () {
                    var t = this._owner;
                    if (t.replaceParticlePanel([]), v(t, d.default.DirectionMove), v(t, d.default.RenderUpdater),
                        p.default.inst.enableRelife) {
                        var e = function (t) {
                            var e = t.model, i = t.modelTexture, r = t.forward, a = t.position, s = n.instance.createEntity("shadow");
                            return s.addModel(e.url, e.heightPath, e.rotationPath).addModelTexture(i.list).addRenderNode().addForward(r.x, r.y).addPosition(a.x, a.y),
                                s;
                        }(t);
                        e.addAnimation(_.AnimationType.Fly, _.AnimationPlayType.Normal, 1, !1), e.addLifeDuration(c.default.FLY_RESUME_DELAY),
                            x(e, this.direction), this.shadow = e, this._duration = 0;
                    } else t.replaceAnimation(_.AnimationType.Fly, _.AnimationPlayType.Normal, 1, !1),
                        x(t, this.direction), this._duration = c.default.FLY_RESUME_DELAY;
                }, e.prototype.onExit = function () {
                    v(this._owner, d.default.Slide), this.direction = null, this.shadow = null;
                }, e.prototype.onUpdate = function () {
                    this._duration >= 0 && this._time > this._duration && this.shadow && this._machine.setState(l.default.WaitingRelife);
                }, e.prototype.onEvent = function (t, e) {
                    switch (t) {
                        case u.default.COMBO_CHANGE:
                            if (e > 0 && this.shadow) {
                                var i = this.shadow, r = n.instance;
                                r.createTimerHandler(.1, 1, null, function () {
                                    var t = i.position;
                                    r.createModel(a.default.getSprite3DPath("coin_model"), "coin").addPositionOnce(t.x, t.y).addLifeDuration(.6).addParticlePanel([{
                                        url: a.default.getSprite3DPath("particle_coin")
                                    }]).addAnimation(_.AnimationType.FlyCoin, _.AnimationPlayType.Normal, 1, !1, "coin_model/coin"),
                                        r.destroyEntity(i), r.createSound(a.default.getSoundPath("poofgoldcoin"));
                                });
                            }
                    }
                }, e.prototype.recycle = function () {
                    this.direction = null, e.purge(this);
                }, e.__classSign = "RoleStateFly", e;
            }(h.default);
            i.RoleStateFly = D;
            var O = function (t) {
                function e() {
                    var e = t.call(this, l.default.Shot) || this;
                    return e.goalArea = null, e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this._duration = t.duration, this.goalArea = t.rect;
                },
                    e.prototype.onEnter = function () {

                        var t = this._owner, e = t.position;
                        m.setXY(-e.x, this.goalArea.y - e.y), m.normalizeSelf(),
                            t.replaceAnimation(_.AnimationType.Shot, _.AnimationPlayType.CrossFade, 1, !1),
                            t.replaceForward(m.x, m.y), v(t, d.default.DirectionMove),
                            v(t, d.default.RenderUpdater),
                            t.addSlide(e.x, e.y, 1 * m.x, 1 * m.y, this._duration + .1, Laya.Ease.quadOut);
                    }, e.prototype.onExit = function () {
                        this.goalArea = null;
                    }, e.prototype.onUpdate = function () {
                        this._time > this._duration && this._machine.setState(l.default.Idle);
                    }, e.prototype.recycle = function () {
                        this.goalArea = null, e.purge(this);
                    }, e.__classSign = "RoleStateShot", e;
            }(h.default);
            i.RoleStateShot = O;
            var L = function (t) {
                function e() {
                    var e = t.call(this, l.default.Win) || this;
                    return e._unableEnterFlag = l.default.Full, e;
                }
                return r(e, t), e.prototype.onEnter = function () {
                    var t = this._owner;
                    t.replaceParticlePanel([]), t.replaceAnimation(_.AnimationType.Celebrate, _.AnimationPlayType.CrossFade, 1, !1),
                        v(t, d.default.DirectionMove), v(t, d.default.RenderUpdater);
                }, e.prototype.onExit = function () { }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateWin", e;
            }(h.default);
            i.RoleStateWin = L;
            var P = function (t) {
                function e() {
                    var e = t.call(this, l.default.Skill_Cast) || this;
                    return e.skill = null, e._unableEnterFlag = l.default.Skill_Cast, e._needExitFlag = l.default.Fly | l.default.Hit | l.default.Skill_End,
                        e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.skill = t;
                }, e.prototype.enableEnter = function (e, i) {
                    return void 0 === i && (i = null), 0 != (e & l.default.Normal) ? this.skill.enableNormal : 0 != (e & l.default.Hold) ? this.skill.enableHold : 0 != (e & l.default.Rockey) ? this.skill.enableRockey : t.prototype.enableEnter.call(this, e, i);
                }, e.prototype.onEnter = function () {
                    var t = this.skill;
                    this._duration = t.castDuration, t.onSkillCastStart(this._owner);
                    var e = this._owner;
                    e.replaceStrong(t.strong), v(e, d.default.SpeedAnimation), v(e, d.default.MoveInEmit);
                }, e.prototype.onExit = function () {
                    var t = this._owner, e = this._machine;
                    e.inState(l.default.Hold) && b(t), e.inState(l.default.Normal) && t.replaceSpeedAnimation(E),
                        this.skill = null;
                }, e.prototype.onUpdate = function () {
                    this._time >= this._duration && this._machine.setState(l.default.Skill_End, this.skill);
                }, e.prototype.recycle = function () {
                    this.skill = null, e.purge(this);
                }, e.__classSign = "RoleStateSkillCast", e;
            }(h.default);
            i.RoleStateSkillCast = P;
            var N = function (t) {
                function e() {
                    var e = t.call(this, l.default.Skill_End) || this;
                    return e.skill = null, e._unableEnterFlag = l.default.Skill_Cast, e._needExitFlag = l.default.Fly | l.default.Hit,
                        e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.skill = t;
                }, e.prototype.enableEnter = function (e, i) {
                    return void 0 === i && (i = null), 0 != (e & l.default.Normal) ? this.skill.enableNormal : 0 != (e & l.default.Hold) ? this.skill.enableHold : 0 != (e & l.default.Rockey) ? this.skill.enableRockey : t.prototype.enableEnter.call(this, e, i);
                }, e.prototype.onEnter = function () {
                    var t = this.skill;
                    this._duration = t.endDuration, t.onSkillCastEnded(this._owner);
                    var e = this._owner;
                    e.replaceStrong(t.strong), v(e, d.default.SpeedAnimation), v(e, d.default.MoveInEmit);
                }, e.prototype.onExit = function () {
                    var t = this._owner, e = this._machine;
                    e.inState(l.default.Hold) && b(t), e.inState(l.default.Normal) && t.replaceSpeedAnimation(E),
                        this.skill = null;
                }, e.prototype.recycle = function () {
                    this.skill = null, e.purge(this);
                }, e.__classSign = "RoleStateSkillEnd", e;
            }(h.default);
            i.RoleStateSkillEnd = N;
            var B = function (t) {
                function e() {
                    var e = t.call(this, l.default.WaitingRelife) || this;
                    return e._unableEnterFlag = l.default.Full ^ (y | l.default.RelifeIng | l.default.Normal),
                        e;
                }
                return r(e, t), e.prototype.onEnter = function () {
                    var t = this._owner;
                    t.addWaitingRelife(), v(t, d.default.RenderNode);
                }, e.prototype.onExit = function () {
                    var t = this._owner;
                    t.addRenderNode(), v(t, d.default.WaitingRelife);
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateWaitingRelife", e;
            }(h.default);
            i.RoleStateWaitingRelife = B;
            var F = function (t) {
                function e() {
                    var e = t.call(this, l.default.RelifeIng) || this;
                    return e.point = null, e.validArea = new f.default(), e._unableEnterFlag = l.default.Full ^ (y | l.default.RelifeIng | l.default.Normal),
                        e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.point = t;
                }, e.prototype.onEnter = function () {
                    this._duration = c.default.RELIFE_DURATION;
                    var t, e = this.point;
                    e.relifePoint.locked = !0, t = e.hasComponent(d.default.Position) ? e.position : e.positionOnce;
                    var i = this._owner;
                    i.replacePosition(t.x, t.y), i.replaceParticlePanel([{
                        url: a.default.getSprite3DPath("particle_revive")
                    }]), v(i, d.default.RenderUpdater), S(i, !1);
                    var n = i.validArea;
                    g.set(n.rect), this.validArea.setTo(t.x, t.y, 0, 0), i.replaceValidArea(this.validArea),
                        this.validArea.set(g);
                }, e.prototype.onExit = function () {
                    this.point.relifePoint.locked = !1;
                    var t = this._owner;
                    t.replaceParticlePanel([]), this._machine.inState(l.default.Normal) && (t.replaceRenderUpdater(C),
                        S(t, !0)), t.replaceValidArea(this.validArea), this.point = null;
                }, e.prototype.recycle = function () {
                    this.point = null, e.purge(this);
                }, e.__classSign = "RoleStateRelifeIng", e;
            }(h.default);
            i.RoleStateRelifeIng = F;
            var k = function (t) {
                function e() {
                    var e = t.call(this, l.default.WinRun) || this;
                    return e.forward = new s.default(), e._unableEnterFlag = l.default.Full ^ (l.default.Idle | l.default.WinSlide),
                        e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.forward.set(t);
                }, e.prototype.onEnter = function () {
                    this._duration = c.default.WIN_RUN_DURATION;
                    var t = this._owner;
                    t.replaceAction(_.ActionType.Move, this.forward), t.replaceParticlePanel([]), t.replaceAnimation(_.AnimationType.WinRun, _.AnimationPlayType.CrossFade, 1, !1),
                        t.replaceSpeedLimit(c.default.HOLD_MAX_SPEED), t.replaceDirectionMove(c.default.START_ACCELERATION, -c.default.DEFAULT_ACCELERATION),
                        v(t, d.default.RenderUpdater);
                }, e.prototype.onExit = function () { }, e.prototype.onUpdate = function () {
                    this._time >= this._duration && this._machine.setState(l.default.WinSlide);
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateWinRun", e;
            }(h.default);
            i.RoleStateWinRun = k;
            var V = function (t) {
                function e(e) {
                    var i = t.call(this, e || l.default.WinChase) || this;
                    return i.offset = new s.default(), i.delay = 0, i._unableEnterFlag = l.default.Full ^ (l.default.Idle | l.default.WinSlide),
                        i;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.target = t.target, this.offset.set(t), this.delay = c.default.WIN_RUN_DURATION + o.default.randomBetween(.1, .5);
                }, e.prototype.moveToTarget = function () {
                    var t = this.target;
                    if (!t) return console.log("moveToTarget:: target is null::: ", this.enabled, new Error().stack),
                        !0;
                    var e = this._owner, i = e.position, n = t.position;
                    m.setXY(n.x - i.x, n.y - i.y).addSelf(this.offset);
                    var r = m.magSqr();
                    return r > 0 && e.replaceAction(_.ActionType.Move, m), this._time > this.delay && r <= c.default.WIN_SLIDE_DISTSQR;
                }, e.prototype.onEnter = function () {
                    this.moveToTarget();
                    var t = this._owner;
                    t.replaceParticlePanel([]), t.replaceAnimation(_.AnimationType.WinRun, _.AnimationPlayType.CrossFade, 1, !1),
                        t.replaceSpeedLimit(c.default.HOLD_MAX_SPEED), t.replaceDirectionMove(c.default.START_ACCELERATION, -c.default.DEFAULT_ACCELERATION),
                        v(t, d.default.RenderUpdater);
                }, e.prototype.onExit = function () {
                    this.target = null;
                }, e.prototype.onUpdate = function () {
                    this.moveToTarget() && this._machine.setState(l.default.WinSlide);
                }, e.prototype.recycle = function () {
                    this.target = null, e.purge(this);
                }, e.__classSign = "RoleStateWinChase", e;
            }(h.default);
            i.RoleStateWinChase = V;
            var U = function (t) {
                function e() {
                    return t.call(this, l.default.WinSlide) || this;
                }
                return r(e, t), e.prototype.onEnter = function () {
                    var t = this._owner, e = t.position, i = t.forward, n = c.default.WIN_SLIDE_DISTANCE;
                    t.replaceParticlePanel([{
                        url: a.default.getSprite3DPath("particle_grass")
                    }]), t.replaceSlide(e.x, e.y, i.x * n, i.y * n, 1, Laya.Ease.quadOut), t.replaceAnimation(_.AnimationType.Celebrate, _.AnimationPlayType.CrossFade, 1, !1),
                        v(t, d.default.DirectionMove);
                }, e.prototype.onExit = function () {
                    var t = this._owner;
                    t.replaceParticlePanel([]), v(t, d.default.Slide);
                }, e.prototype.recycle = function () {
                    e.purge(this);
                }, e.__classSign = "RoleStateWinSlide", e;
            }(h.default);
            i.RoleStateWinSlide = U;
        }, {
            "../../../Events": 5,
            "../../../Path": 12,
            "../../../math/MathHelper": 320,
            "../../../math/Rect": 321,
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../GameConstants": 127,
            "../../base/GameContext": 139,
            "../../interfaces": 246,
            "../../state/StateBase": 309,
            "../../state/StateType": 311
        }],
        225: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = t("../../interfaces"), u = t("../../../math/Vec2"), c = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.Action, l.default.SpeedLimit, l.default.DirectionMove]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.game, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.action, s = r.speedLimit, o = r.directionMove;
                        if (a.type === h.ActionType.Stop) o.maxSpeed = 0; else {
                            var c = s.speedLimit;
                            if (r.hasComponent(l.default.AttrSpeed)) c += r.attrSpeed.value;
                            if (r.hasComponent(l.default.AttrAISpeed)) c += r.attrAISpeed.value;
                            o.maxSpeed = c;
                            var d = a.direction;
                            d.equals(u.default.ZERO) || o.direction.set(d).normalizeSelf();
                        }
                        e.onRoleAction(r, a.type, a.direction);
                    }
                }, e;
            }(o.default);
            i.default = c;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138,
            "../../interfaces": 246
        }],
        226: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../interfaces"), l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.ActionForward, s.default.Forward]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t], n = i.actionForward, r = i.forward, a = n.target;
                        if (a.hasComponent(s.default.Action)) {
                            var l = a.action;
                            if (l.type === o.ActionType.Move) {
                                var h = l.direction;
                                r.x = h.x, r.y = h.y, i.hasComponent(s.default.RenderNode) || i.addRenderNode();
                                continue;
                            }
                        }
                        i.hasComponent(s.default.RenderNode) && i.removeComponent(s.default.RenderNode);
                    }
                }, e;
            }(a.default);
            i.default = l;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138,
            "../../interfaces": 246
        }],
        227: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.Model, l.default.RenderNode, l.default.Animation]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    this.context.scene;
                    for (var e = this.services, i = e.render, n = e.game, r = 0, a = t; r < a.length; r++) {
                        var s = a[r], o = s.renderNode;
                        if (o.root) {
                            var l = s.animation, h = o.root;
                            l.path && (h = i.getChildWithPath(o.root, l.path)), n.playAnimation(h, l.type, l.playType, l.speed, l.keepDuration);
                        } else console.warn("entity as no renderNode instance!", s.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        228: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../state/StateType"), l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.State, s.default.AutoSkill]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        for (var n = i[e], r = void 0, a = 0, s = n.autoSkill.skills; a < s.length; a++) {
                            var l = s[a];
                            if (l.castEnable(n, t)) {
                                r = l;
                                break;
                            }
                        }
                        if (r) n.state.machine.setState(o.default.Skill_Cast, r);
                    }
                }, e;
            }(a.default);
            i.default = l;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138,
            "../../state/StateType": 311
        }],
        229: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [l.default.Ball, l.default.GameCollision]
                    }), e.ensureComponents = e.matcher, e.trigger = new s(e.matcher, a.OnEntityAdded),
                        e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.game, i = this.context, n = 0, r = t; n < r.length; n++) {
                        var a = r[n], s = a.gameCollision;
                        e.onBallCollision(a, s.collisionInfos, i);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        e[t].removeComponent(l.default.GameCollision);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        230: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../Componets"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [a.default.Behavior],
                        noneOf: [a.default.Robot]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.behavior;
                        r.enable && r.behavior.tick(n, t);
                    }
                }, e;
            }(t("../../base/BaseSystem").default);
            i.default = s;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        231: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Matcher, s = t("../../base/BaseSystem"), o = t("../../Componets"), l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = a.create({
                        allOf: [o.default.GameOver]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.context.gameOver = !1;
                }, e.prototype.execute = function () {
                    var t = this.context,
                        e = this.services.game,
                        i = this.group.getEntities();
                    if (t.gameOver) i.length > 0 && console.log("Why got game over entities after game over!");
                    else for (var n = 0, r = i; n < r.length; n++) {
                        var a = r[n];
                        if (t.gameOver) return console.log("Why got game over entities is more then one!");
                        var s = a.gameOver;
                        t.onGameOver(s.goalGroup), e.onGameOver(t, s.data);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = n.instance, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var r = i[e];
                        t.destroyEntity(r);
                    }
                }, e;
            }(s.default);
            i.default = l;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        232: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Behavior, s.default.AttrBahavior]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    for (var t = this.services.game, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.behavior, a = n.attrBehavior;
                        r.load(t.getBehaviorData(a.name)), console.log("============= set entity " + r.behavior.id + ' AI::: "' + a.name + '"');
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        233: [function (t, e, i) {
            "use strict";
            var n;
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var a = t("../../base/BaseSystem"), s = t("../../GameConstants"), o = t("../../interfaces"), l = t("../../../Path"), h = t("../../Componets"), u = t("../../../EventCenter"), c = t("../../../Events"), d = t("../../../math/MathHelper"), _ = t("../../../data/fight/IFightData"), f = t("../../state/StateType"), p = t("../services/RoleStates"), m = t("../services/FootBallSkills"), g = t("../../../IData"), y = t("../../../math/Vec2"), v = t("../components/AttrNumberComponent"), S = new Laya.Vector3(), T = new y.default();
            function E(t, e) {
                if (t.hasComponent(h.default.Camera)) {
                    var i = t.renderNode.root, n = 0;
                    if (e.hasComponent(h.default.Follow)) {
                        var r = e.follow.target;
                        if (r.hasComponent(h.default.Role)) n = r.role.group;
                    }
                    var a = new Laya.Vector3();
                    if (e.hasComponent(h.default.Position)) {
                        var s = e.position;
                        a.x = s.x, a.z = s.y;
                    }
                    if (e.hasComponent(h.default.Height)) {
                        var o = e.height;
                        a.y = o.height;
                    }
                    var l = i.viewport;
                    l.project(a, i.projectionViewMatrix, S);
                    var d = S.x / l.width * Laya.stage.width, _ = S.y / l.height * Laya.stage.height;
                    u.default.emit(c.default.BALL_UPDATE, n, d, _);
                }
            }
            var C = ((n = {})[g.AttrType.Speed] = h.default.AttrSpeed, n[g.AttrType.HoldSpeed] = h.default.AttrHoldSpeed,
                n[g.AttrType.RockeySpeed] = h.default.AttrRockeySpeed, n[g.AttrType.RockeyTime] = h.default.AttrRockeyTime,
                n[g.AttrType.HitDistance] = h.default.AttrHitDistance, n[g.AttrType.HitDuration] = h.default.AttrHitDuration,
                n);
            function x(t, e) {
                t.addModel(e.model).addModelTexture(e.modelTextures);
                for (var i = 0, n = e.attrs || []; i < n.length; i++) {
                    var r = n[i], a = C[r.type];
                    if (a) {
                        var s = v.default.createInstance(a);
                        s.init(r.value), t.addComponent(a, s);
                    } else console.log("cannot find component index with attrType:: ", r.type);
                }
            }
            var b = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initialize = function () {
                    var t = this.pool, e = this.context;
                    this.context.scene;
                    e.player1Skin || this.services.home.initHomeContext(e), e.reset();
                    var i = Math.ceil(new Date().getTime()) % 1e3;
                    d.default.setRandomSeed(i), e.ground = t.createGround(e.groundUrl).addStaticRender();
                    var n = t.createBall(e.ballUrl, "football/ball", "football/ball/ball").
                        addCollider(s.default.BALL_GROUP, s.default.BALL_MASK, s.default.BALL_RADIUS).
                        addValidArea(s.default.BALL_AREA, !0).addPosition(0, 0).
                        addParticlePanel([{
                            url: l.default.getSprite3DPath("particle_football")
                        }]).addRotation(0, 0).addForward(0, 0).addHeight(0).addRolling(s.default.BALL_ROLLING_RATE);
                    e.setBall(n);
                    var r,

                        a = t.createCamera(s.default.CAMERA_FIELDOFVIEW, s.default.CAMERA_CLEAR_COLOR).
                            addPosition(0, 0).addRotationOnce(s.default.CAMERA_ROTATION_X, s.default.CAMERA_ROTATION_Y).
                            addHeightOnce(s.default.CAMERA_HEIGHT);
                    console.log("rrrrrrrrr2")
                    e.type === _.FightType.Guide ? ((r = t.createModel(l.default.getSprite3DPath("direction"), "direction")).addRole(3),
                        r.addPosition(0, 0).addForward(0, 1),
                        a.addRenderUpdater(function (t) {
                            !function (t, e, i) {
                                if (t.hasComponent(h.default.Camera)) {
                                    E(t, e);
                                    var n = s.default.GOAL_AREA_1, r = i.position, a = i.forward;
                                    T.setXY(-r.x, n.y - r.y), T.normalizeSelf(), a.x = T.x, a.y = T.y;
                                }
                            }(t, n, r);
                        })) : a.addRenderUpdater(function (t) {
                            E(t, n);
                        });
                    var u = t.createModel(l.default.getSprite3DPath("ring"), "ring").addPosition(0, 0), c = t.createModel(l.default.getSprite3DPath("arrow"), "arrow").addPosition(0, 0).addForward(0, 0), g = e.player1Skin, y = e.player2Skin;
                    if (e.relifePointsInfo) {
                        for (var v = s.default.BALL_AREA, S = 0, C = e.relifePointsInfo; S < C.length; S++) {
                            var b = C[S];
                            if (t.createModel(l.default.getSprite3DPath("revive"), "relifePoint").addRelifePoint(b.group, b.validArea).addStaticRender().addPositionOnce(b.x, b.y),
                                !v.contains(b.x, b.y)) {
                                var I = t.createModel(l.default.getSprite3DPath("bench"), "bench");
                                b.x > 0 ? T.setXY(-1, 0) : T.setXY(1, 0);
                                var w = b.x - 2 * T.x, A = b.y - 2 * T.y;
                                I.addPositionOnce(w, A).addForwardOnce(T.x, T.y).addStaticRender();
                                for (var R = d.default.randomBetween(1, 3), M = [-1.32, -.66, 0, .66, -1.32], D = 0; D < R; D++) {
                                    var O = t.createEntity("role").addRenderNode();
                                    b.group === s.default.PLAYER_1_GROUP ? O.addModel(g.model).addModelTexture(g.modelTextures) : O.addModel(y.model).addModelTexture(y.modelTextures);
                                    var L = d.default.randomInt(M.length), P = M[L];
                                    M.splice(L, 1), O.addPositionOnce(w + P * T.y, A + P * T.x).addForwardOnce(T.x, T.y).addAnimation(o.AnimationType.Sit, o.AnimationPlayType.Normal, 1);
                                }
                            }
                        }
                        e.enableRelife = !0;
                    } else e.enableRelife = !1;
                    for (var N = 0, B = 0, F = e.actorInitInfo; B < F.length; B++) {
                        N++;
                        var k = void 0;
                        if ((b = F[B]).isLocal) {
                            var V = "self";
                            (k = t.createPlayer()).addPlayer(V, !0), e.fightScript && (k.addBehavior(V), k.addAttrBehavior(e.fightScript)),
                                k.addState(k, f.default.Normal, [p.RoleStateIdle.create(),
                                p.RoleStateNormal.create(),
                                p.RoleStateHold.create(),
                                p.RoleStateRockey.create(),
                                p.RoleStateHit.create(),
                                p.RoleStateShot.create(),
                                p.RoleStateWin.create(),
                                p.RoleStateSkillCast.create(),
                                p.RoleStateSkillEnd.create(),
                                p.RoleStateWinRun.create(),
                                p.RoleStateWinChase.create(),
                                p.RoleStateWinSlide.create()]),
                                r && r.addFollow(k),
                                a.addFollow(k, s.default.CAMERA_X_OFFSET, s.default.CAMERA_Y_OFFSET),
                                e.addRole(V, k),
                                u.addFollow(k),
                                c.addFollow(k).addActionForward(k);
                        } else {
                            k = t.createRobot();
                            V = "robot" + b.group + "_" + N;
                            k.addRobot(V), k.addBehavior(V), k.addState(k, f.default.Normal, [p.RoleStateIdle.create(), p.RoleStateNormal.create(), p.RoleStateHold.create(), p.RoleStateRockey.create(), p.RoleStateHit.create(), p.RoleStateFly.create(),
                            p.RoleStateShot.create(),
                            p.RoleStateWin.create(),
                            p.RoleStateSkillCast.create(),
                            p.RoleStateSkillEnd.create(),
                            p.RoleStateWaitingRelife.create(),
                            p.RoleStateRelifeIng.create(),
                            p.RoleStateWinRun.create(),
                            p.RoleStateWinChase.create(),
                            p.RoleStateWinSlide.create()]),
                                e.addRole(V, k);
                        }
                        b.group === s.default.PLAYER_1_GROUP ? (k.addCollider(s.default.PLAYER_1_GROUP, s.default.PLAYER_1_MASK, s.default.PLAYER_RADIUS),
                            x(k, g)) : (k.addCollider(s.default.PLAYER_2_GROUP, s.default.PLAYER_2_MASK, s.default.PLAYER_RADIUS),
                                x(k, y)), k.addPosition(b.x, b.y).addValidArea(s.default.GAME_AREA).addForward(b.forwardX, b.forwardY).addRole(b.group).addAnimation(o.AnimationType.Idle, o.AnimationPlayType.Normal, 1).addSpeedLimit(s.default.FAST_STANDARD_SPEED).addAutoSkill([m.SlideTackle.create()]);
                    }
                    this.services.game.onGameInited(e);
                }, e;
            }(a.default);
            i.default = b;
        }, {
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../../../IData": 8,
            "../../../Path": 12,
            "../../../data/fight/IFightData": 31,
            "../../../math/MathHelper": 320,
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../GameConstants": 127,
            "../../base/BaseSystem": 138,
            "../../interfaces": 246,
            "../../state/StateType": 311,
            "../components/AttrNumberComponent": 205,
            "../services/FootBallSkills": 221,
            "../services/RoleStates": 224
        }],
        234: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.execute = function () {
                    var t = this.context;
                    if (!t.matchPause) {
                        var e = t.matchTime;
                        if (e > 0) {
                            var i = t.deltaTime;
                            t.matchTiming += i;
                            var n = Math.max(0, e - t.matchTiming);
                            n <= 0 ? (console.log("============ TIME OVER ==============="), t.onGameOver(null),
                                this.services.game.onMatchOver(t)) : this.services.game.onMatchTimeUpdate(t, n);
                        }
                    }
                }, e;
            }(t("../../base/BaseSystem").default);
            i.default = n;
        }, {
            "../../base/BaseSystem": 138
        }],
        235: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Position, s.default.MoveInEmit]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.services.game, e = this.context, i = 0, n = this.group.getEntities(); i < n.length; i++) {
                        var r = n[i],
                            a = r.position,
                            o = r.moveInEmit,
                            l = o.rect;
                        l.contains(a.x, a.y) &&
                            (
                                t.onEntityMoveIn(r, l, o.data, e),
                                o.once && r.hasComponent(s.default.MoveInEmit) && r.removeComponent(s.default.MoveInEmit));
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        236: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.OutofValid]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.services.game, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e].outofValid, r = n.target;
                        "ball" === r.name ? t.onBallOutofValid(r, n.x, n.y, n.direction) : t.onRoleOutofValid(r, n.x, n.y, n.direction);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = this.pool, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e];
                        t.destroyEntity(n);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        237: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Player]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.services.input, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.player;
                        if (r.enableAction) {
                            var a = t.getPlayerAction(r.id);
                            n.replaceAction(a.type, a.direction);
                        }
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        238: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../../math/Vec2"), l = new o.default(), h = new o.default(), u = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.WaitingRelife]
                    }), e.relifeMatcher = n.create({
                        allOf: [s.default.RelifePoint]
                    }), e;
                }
                return r(e, t), e.prototype.setPool = function (e) {
                    t.prototype.setPool.call(this, e), this.relifeGroup = e.getGroup(this.relifeMatcher);
                }, e.prototype.execute = function () {
                    var t = this.services.game, e = this.group.getEntities(), i = this.relifeGroup.getEntities();
                    if (i.length <= 0) for (var n = 0, r = e; n < r.length; n++) {
                        var a = r[n];
                        t.onNoRelife(a);
                    } else {
                        var o = this.context.getBall().position, u = o.x, c = o.y;
                        l.setXY(u, c);
                        for (var d = {}, _ = 0, f = i; _ < f.length; _++) {
                            var p = f[_], m = p.relifePoint;
                            if (!m.locked && m.validArea.contains(u, c)) {
                                (T = d[m.group]) || (d[m.group] = T = []), p.hasComponent(s.default.Position) ? h.set(p.position) : h.set(p.positionOnce);
                                var g = h.subSelf(l).magSqr();
                                T.push({
                                    distance: g,
                                    point: p
                                });
                            }
                        }
                        for (var y in d) {
                            (T = d[y]).sort(function (t, e) {
                                return t.distance - e.distance;
                            });
                        }
                        for (var v = 0, S = e; v < S.length; v++) {
                            var T;
                            if ((T = d[(a = S[v]).role.group]) && !(T.length <= 0)) {
                                var E = T.shift();
                                t.onRoleRelife(a, E.point);
                            }
                        }
                    }
                }, e;
            }(a.default);
            i.default = u;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        239: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.RenderUpdater]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t];
                        i.renderUpdater.updater(i);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        240: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Behavior, s.default.Robot]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    var t = this.context;
                    if (!t.gameOver) for (var e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.behavior;
                        r.enable && r.behavior.tick(n, t);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        241: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [l.default.Role, l.default.GameCollision]
                    }), e.ensureComponents = e.matcher, e.trigger = new s(e.matcher, a.OnEntityAdded),
                        e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context, i = this.services.game, n = 0, r = t; n < r.length; n++) {
                        var a = (l = r[n]).gameCollision;
                        i.onRoleCollisionBegin(l, a.collisionInfos, e);
                    }
                    for (var s = 0, o = t; s < o.length; s++) {
                        var l;
                        a = (l = o[s]).gameCollision;
                        i.onRoleCollisionEnded(l, a.collisionInfos, e);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        e[t].removeComponent(l.default.GameCollision);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        242: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.DirectionMove, s.default.SpeedAnimation, s.default.Animation]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t], n = i.directionMove, r = i.animation, a = i.speedAnimation.getter(n.speed, r.type);
                        a.type === r.type && a.speed === r.speed || i.replaceAnimation(a.type, a.playType, a.speed, !0);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        243: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.State]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        i[e].state.machine.update(t);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        244: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Pool, a = entitas.Matcher, s = t("../../../ClassNameDef"), o = t("../../../data/UserData"), l = t("../../HomeConstants"), h = t("../../../Path"), u = t("../../../data/skin/SkinData"), c = t("../../../EventCenter"), d = t("../../../Events"), _ = t("../../Componets"), f = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e._context = null, c.default.on(d.default.TRY_SKIN, e, e.onTrySkin), c.default.on(d.default.UI_SKIN_SELECTED, e, e.onSelectedSkinId),
                        e;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.purge = function () {
                    c.default.off(d.default.TRY_SKIN, this, this.onTrySkin), c.default.off(d.default.UI_SKIN_SELECTED, this, this.onSelectedSkinId),
                        this._context = null;
                }, e.prototype.initHomeContext = function (t) {
                    var e = o.default.getInstance().getSelectedSkinId(l.default.DEFAULT_SKIN);
                    t.ballUrl = h.default.getSprite3DPath("football"), t.groundUrl = h.default.getSprite3DPath("football_ground"),
                        t.player1Skin = u.default.getSkinData(e), t.player2Skin = null, this._context = t;
                }, e.prototype.onEnable = function () {
                    c.default.on(d.default.UI_SKIN_SELECTED, this, this.onPreviewSkinId), c.default.on(d.default.UI_SKIN_PREVIEW, this, this.onPreviewSkinId),
                        c.default.on(d.default.UI_SHOW_SKIN, this, this.onShowSkinView), c.default.on(d.default.UI_HIDE_SKIN, this, this.onHideSkinView);
                }, e.prototype.onDisable = function () {
                    c.default.off(d.default.UI_SKIN_SELECTED, this, this.onPreviewSkinId), c.default.off(d.default.UI_SKIN_PREVIEW, this, this.onPreviewSkinId),
                        c.default.off(d.default.UI_SHOW_SKIN, this, this.onShowSkinView), c.default.off(d.default.UI_HIDE_SKIN, this, this.onHideSkinView);
                }, e.prototype.onReset = function () { }, e.prototype.onShowSkinView = function (t) {
                    t && this.onPreviewSkinId(t.id);
                    for (var e = n.instance.getEntities(a.create({
                        allOf: [_.default.Camera]
                    })), i = l.default.CAMERA_SKIN_X_OFFSET, r = l.default.CAMERA_SKIN_Y_OFFSET, s = l.default.CAMERA_SKIN_HEIGHT, o = 0, h = e; o < h.length; o++) {
                        var u = h[o], c = u.heightOnce, d = u.positionOnce;
                        u.replaceFloatTo(c.height, s, .5, Laya.Ease.quadOut), u.replaceSlide(d.x, d.y, i - d.x, r - d.y, .5);
                    }
                }, e.prototype.onHideSkinView = function () {
                    this.onPreviewSkinId(o.default.getInstance().getSelectedSkinId(l.default.DEFAULT_SKIN));
                    for (var t = n.instance.getEntities(a.create({
                        allOf: [_.default.Camera]
                    })), e = l.default.CAMERA_HOME_X_OFFSET, i = l.default.CAMERA_HOME_Y_OFFSET, r = l.default.CAMERA_HOME_HEIGHT, s = 0, h = t; s < h.length; s++) {
                        var u = h[s], c = u.heightOnce, d = u.positionOnce;
                        u.replaceFloatTo(c.height, r, .5, Laya.Ease.quadOut), u.replaceSlide(d.x, d.y, e - d.x, i - d.y, .5);
                    }
                }, e.prototype.onSelectedSkinId = function (t) {
                    var e = this._context,
                        i = u.default.getSkinData(t);
                    e.player1Skin = i;
                }, e.prototype.onPreviewSkinId = function (t) {
                    for (var e = u.default.getSkinData(t), i = 0, r = n.instance.getEntities(a.create({
                        allOf: [_.default.Player]
                    })); i < r.length; i++) {
                        var s = r[i];
                        s.replaceModel(e.model), s.replaceModelTexture(e.modelTextures);
                    }
                }, e.prototype.onTrySkin = function (t) {
                    this._context.player1Skin = t;
                }, e.__className = "HomeService", e;
            }(s.RecycleScript3D);
            i.default = f;
        }, {
            "../../../ClassNameDef": 2,
            "../../../EventCenter": 4,
            "../../../Events": 5,
            "../../../Path": 12,
            "../../../data/UserData": 20,
            "../../../data/skin/SkinData": 32,
            "../../Componets": 126,
            "../../HomeConstants": 129
        }],
        245: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseSystem"), a = t("../../interfaces"), s = t("../../HomeConstants"), o = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.initialize = function () {
                    var t = this.pool, e = this.context;
                    this.context.scene;
                    this.services.home.initHomeContext(this.context), e.ground = t.createGround(e.groundUrl);

                    //123
                    console.log("rrrrrrrrr1")
                    t.createBall(e.ballUrl).addPositionOnce(-.4, .4),
                        t.createCamera(s.default.CAMERA_FIELDOFVIEW, s.default.CAMERA_CLEAR_COLOR).
                            addRotationOnce(s.default.CAMERA_ROTATION_X, s.default.CAMERA_ROTATION_Y).
                            addForwardOnce(s.default.CAMERA_FORWARD_X, s.default.CAMERA_FORWARD_Y).
                            addHeightOnce(s.default.CAMERA_HOME_HEIGHT).
                            addPositionOnce(s.default.CAMERA_HOME_X_OFFSET, s.default.CAMERA_HOME_Y_OFFSET);
                    var i = e.player1Skin, n = t.createPlayer();
                    n.addPlayer("self", !0).addModel(i.model).addModelTexture(i.modelTextures).addPositionOnce(0, 0).addForwardOnce(0, 1),
                        n.replaceAnimation(a.AnimationType.Idle, a.AnimationPlayType.Normal, 1);
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../../HomeConstants": 129,
            "../../base/BaseSystem": 138,
            "../../interfaces": 246
        }],
        246: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.AnimationPlayType = i.AnimationType = i.ActionType = void 0, function (t) {
                t[t.Stop = 0] = "Stop", t[t.Move = 1] = "Move";
            }(i.ActionType || (i.ActionType = {})), function (t) {
                t[t.Idle = 0] = "Idle", t[t.SlowRun = 1] = "SlowRun", t[t.FastRun = 2] = "FastRun",
                    t[t.Hit = 3] = "Hit", t[t.Fly = 4] = "Fly", t[t.Shot = 5] = "Shot", t[t.Celebrate = 6] = "Celebrate",
                    t[t.SlideTackleStart = 7] = "SlideTackleStart", t[t.SlideTackleEnded = 8] = "SlideTackleEnded",
                    t[t.Sit = 9] = "Sit", t[t.WinRun = 10] = "WinRun", t[t.GroundGoal = 11] = "GroundGoal",
                    t[t.FlyCoin = 12] = "FlyCoin";
            }(i.AnimationType || (i.AnimationType = {})), function (t) {
                t[t.CrossFade = 0] = "CrossFade", t[t.Normal = 1] = "Normal";
            }(i.AnimationPlayType || (i.AnimationPlayType = {}));
        }, {}],
        247: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = new a.default(), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.startPoint = new a.default(), e.endedPoint = new a.default(), e.ctrl1Point = new a.default(),
                        e.ctrl2Point = new a.default(), e.level = 0, e.updateTime = 0, e.duration = 0, e;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return this.updateTime >= this.duration;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i, n, r) {
                    this.startPoint.set(e), this.endedPoint.set(i), this.ctrl1Point.set(n), r ? (this.ctrl2Point.set(r),
                        this.level = 3) : this.level = 2, this.duration = t, this.updateTime = 0;
                }, e.prototype.update = function (t) {
                    this.updateTime += t;
                    var e = this.updateTime / this.duration;
                    return 2 === this.level ? this.getPoint2(e) : this.getPoint3(e);
                }, e.prototype.getPoint2 = function (t) {
                    var e = this.startPoint, i = this.ctrl1Point, n = this.endedPoint, r = Math.pow(1 - t, 2) * e.x + 2 * t * (1 - t) * i.x + Math.pow(t, 2) * n.x, a = Math.pow(1 - t, 2) * e.y + 2 * t * (1 - t) * i.y + Math.pow(t, 2) * n.y;
                    return s.setXY(r, a), s;
                }, e.prototype.getPoint3 = function (t) {
                    var e = this.startPoint, i = this.ctrl1Point, n = this.ctrl2Point, r = this.endedPoint, a = Math.pow(1 - t, 3) * e.x + 3 * i.x * t * (1 - t) * (1 - t) + 3 * n.x * t * t * (1 - t) + r.x * Math.pow(t, 3), o = Math.pow(1 - t, 3) * e.y + 3 * i.y * t * (1 - t) * (1 - t) + 3 * n.y * t * t * (1 - t) + r.y * Math.pow(t, 3);
                    return s.setXY(a, o), s;
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        248: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.acceleration = 0, e.deceleration = 0, e.maxSpeed = 0, e.direction = new a.default(),
                        e.speed = 0, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.acceleration = t, this.deceleration = e;
                }, e.prototype.onReset = function () {
                    this.speed = 0, this.maxSpeed = 0, this.direction.set(a.default.ZERO);
                }, e.prototype.update = function (t) {
                    var e = this.speed, i = this.maxSpeed, n = 0;
                    e > this.maxSpeed ? n = this.deceleration : e < this.maxSpeed && (n = this.acceleration),
                        0 !== n && (e = Math.max(0, e + t * n), i > 0 && e > i && (e = i), this.speed = e);
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        249: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.baseHeight = 0, e.maxHeight = 0, e.duration = 0, e.updateTime = 0, e.level = 3,
                        e.baseRate = 14, e;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return this.updateTime >= this.duration;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i, n) {
                    switch (this.maxHeight = t, this.duration = e, this.updateTime = 0, this.level = Math.min(3, i || 3),
                    this.baseHeight = n || 0, this.level) {
                        case 3:
                            this.baseRate = 12;
                            break;

                        case 2:
                            this.baseRate = 10;
                            break;

                        case 1:
                        default:
                            this.baseRate = 8;
                    }
                }, e.prototype.update = function (t) {
                    this.updateTime += t;
                    var e = Math.min(1, this.updateTime / this.duration) * this.baseRate;
                    return e = e > 11 ? 0 : e > 10 ? -2 * e * e + 42 * e - 220 : e > 8 ? -1 * e * e + 18 * e - 80 : -.25 * e * e + 2 * e,
                        this.baseHeight + this.maxHeight * e * .25;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        250: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return this.updateTime >= this.duration;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i, n) {
                    this.startHeight = t, this.targetHeight = e, this.duration = i, this.easing = n,
                        this.updateTime = 0;
                }, e.prototype.update = function (t) {
                    if (this.duration <= 0) return this.targetHeight;
                    this.updateTime += t;
                    var e = Math.min(1, this.updateTime / this.duration);
                    this.easing && (e = this.easing(e, 0, 1, 1));
                    var i = this.startHeight;
                    return i + e * (this.targetHeight - i);
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        251: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.target = t, this.offsetX = e || 0, this.offsetY = i || 0, this.radius = n || 0;
                }, e.prototype.onReset = function () {
                    this.target = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        252: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.direction = new a.default(), e;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.target = t, this.x = e, this.y = i, this.direction.set(n);
                }, e.prototype.onReset = function () {
                    this.target = null;
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        253: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.origin = new a.default(), e.offset = new a.default(), e.easing = null,
                        e.duration = 0, e.updateTime = 0, e;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return this.updateTime >= this.duration;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i, n, r, a) {
                    this.origin.setXY(t, e), this.offset.setXY(i, n), this.duration = r, this.easing = a || null,
                        this.updateTime = 0;
                }, e.prototype.update = function (t) {
                    if (this.duration <= 0) return this.origin.add(this.offset);
                    this.updateTime += t;
                    var e = Math.min(1, this.updateTime / this.duration);
                    return this.easing && (e = this.easing(e, 0, 1, 1)), this.origin.add(this.offset.mul(e));
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        254: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Rect"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.rect = new a.default(), e.emit = !1, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.rect.set(t), this.emit = e || !1;
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Rect": 321,
            "../../base/BaseComponent": 137
        }],
        255: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Bezier, s.default.Position]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.bezier, a = n.position, s = r.update(t);
                        a.x = s.x, a.y = s.y;
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t];
                        i.bezier.over && i.removeComponent(s.default.Bezier);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        256: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("./FollowSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Follow, s.default.Position, s.default.Camera]
                    }), e;
                }
                return r(e, t), e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "./FollowSystem": 260
        }],
        257: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../../math/Vec2"), l = new o.default(), h = new o.default(), u = new o.default(0, 1), c = new o.default(.984807753012208, .1736481776669303), d = new o.default(.984807753012208, -.1736481776669303), _ = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.DirectionMove, s.default.Position]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.directionMove;
                        if (!r.direction.equals(o.default.ZERO) && (r.update(t), 0 !== r.speed)) {
                            var a = r.direction, _ = d.x;
                            if (_ && n.hasComponent(s.default.Forward)) {
                                var f = n.forward;
                                if (0 !== f.x || 0 !== f.y) if (h.setXY(f.x, f.y), h.dot(a) > _) h.set(a); else a.sub(h).dot(h.rotateVector(u, l)) > 0 ? h.rotateVectorSelf(c) : h.rotateVectorSelf(d);
                                f.x = h.x, f.y = h.y;
                            } else h.set(a);
                            if (0 !== h.x || 0 !== h.y) {
                                var p = r.speed * t;
                                h.mulSelf(p);
                                var m = n.position;
                                m.x += h.x, m.y += h.y;
                            } else console.warn("玩家无方向？？？？？？？？？？？？？？？？？", n.name);
                        }
                    }
                }, e;
            }(a.default);
            i.default = _;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        258: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Flight, s.default.Height]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.flight, a = n.height, s = r.update(t);
                        a.height = s;
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t];
                        i.flight.over && i.removeComponent(s.default.Flight);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        259: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.FloatTo]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.floatTo.update(t);
                        if (n.hasComponent(s.default.Height)) n.height.height = r; else n.replaceHeightOnce(r);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t];
                        i.floatTo.over && i.removeComponent(s.default.FloatTo);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        260: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Follow, s.default.Position],
                        noneOf: [s.default.Camera]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t], n = i.follow, r = void 0, a = n.target;
                        if (a.hasComponent(s.default.Position)) r = a.position; else {
                            if (!a.hasComponent(s.default.PositionOnce)) continue;
                            r = a.positionOnce;
                        }
                        var o = i.position;
                        o.x = r.x + n.offsetX, o.y = r.y + n.offsetY;
                        var l = n.radius;
                        if (l > 0 && a.hasComponent(s.default.Forward)) {
                            var h = a.forward;
                            o.x += h.x * l, o.y += h.y * l;
                        }
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        261: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Slide]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.slide.update(t);
                        if (n.hasComponent(s.default.Position)) {
                            var a = n.position;
                            a.x = r.x, a.y = r.y;
                        } else n.replacePositionOnce(r.x, r.y);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t];
                        i.slide.over && i.removeComponent(s.default.Slide);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        262: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = new (t("../../../math/Vec2").default)(), l = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.ValidArea, s.default.Position]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.pool, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.position, a = n.validArea, s = r.x, l = r.y, h = a.rect, u = h.x, c = h.right, d = h.top, _ = h.y, f = !1;
                        s < u && (f = !0, o.x = 1, s = u), s > c && (f = !0, o.x = -1, s = c), l < _ && (f = !0,
                            o.y = 1, l = _), l > d && (f = !0, o.y = -1, l = d), f && (r.x = s, r.y = l, a.emit && t.createOutofValidEvent(n, s, l, o));
                    }
                }, e;
            }(a.default);
            i.default = l;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        263: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.fieldOfView = 60, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.fieldOfView = t, this.clearColor = e;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        264: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Color"), s = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.color = t || a.default.WHITE, this.path = e;
                }, e.prototype.onReset = function () {
                    this.color = null;
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Color": 318,
            "../../base/BaseComponent": 137
        }],
        265: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.x = 0, e.y = 0, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.x = t, this.y = e;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        266: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.height = 0, e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.height = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        267: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i) {
                    this.url = t, this.heightPath = e, this.rotationPath = i || e;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        268: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.list = t.slice();
                }, e.prototype.onReset = function () {
                    this.list = void 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        269: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i) {
                    this.x = t || 0, this.y = e || 0, this.height = i || 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        270: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.list = [], e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.list = [].concat(t || []);
                }, e.prototype.onReset = function () {
                    this.list.length = 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        271: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.x = 0, e.y = 0, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.x = t, this.y = e;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        272: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i) {
                    this.root = t || null, this.renderHeightNode = e || this.root, this.renderRotationNode = i || this.root;
                }, e.prototype.onReset = function () {
                    this.root = this.renderHeightNode = this.renderRotationNode = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        273: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../base/BaseComponent"), a = t("../../../math/Vec2"), s = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.lastPos = new a.default(), e;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.rate = t || 180, this.lastPos.setXY(0, 0);
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../../../math/Vec2": 322,
            "../../base/BaseComponent": 137
        }],
        274: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.x = 0, e.y = 0, e;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    this.x = t, this.y = e;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        275: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.url = t;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        276: [function (t, e, i) {
            "use strict";
            function n(t, e, i) {
                if (void 0 !== t) return void 0 === e ? t : (e - t) * i + t;
            }
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e) {
                    e = void 0 === e ? 1 : e, this.frames = t.slice(), this.updateTime = 0, this.frameIndex = 0,
                        this.loop = e;
                }, e.prototype.onReset = function () {
                    this.frames = null;
                }, e.prototype.update = function (t) {
                    for (var e = this.updateTime, i = this.frameIndex, r = this.loop, a = this.frames[i]; a.duration <= e;) {
                        var s = this.frames[i + 1];
                        if (s) i += 1, e -= a.duration, a = s; else {
                            if (1 === r) return a.to;
                            r > 0 && (r -= 1), i = 0, e -= a.duration, a = this.frames[0];
                        }
                    }
                    this.loop = r, this.frameIndex = i, this.updateTime = e + t;
                    var o = e / a.duration;
                    return a.easing && (o = a.easing(o, 0, 1, 1)), function (t, e, i) {
                        if (void 0 === e) return t;
                        var r = {};
                        return r.x = n(t.x, e.x, i), r.y = n(t.y, e.y, i), r.height = n(t.height, t.height, i),
                            r;
                    }(a.from, a.to, o);
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = a;
        }, {
            "../../base/BaseComponent": 137
        }],
        277: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        278: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.target = t, this.offsetX = e || 0, this.offsetY = i || 0, this.dHeight = n || 0;
                }, e.prototype.onReset = function () {
                    this.target = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        279: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ParticleCache"), r = t("./ModelManager"), a = t("./ParticleManager");
            function s(t, e) {
                t instanceof Laya.BlinnPhongMaterial || t instanceof Laya.UnlitMaterial ? t.albedoColor = e : console.log("unknow materail in __setMaterialColor__ :::: ", t.name);
            }
            function o(t, e) {
                if (t instanceof Laya.BlinnPhongMaterial || t instanceof Laya.UnlitMaterial) {
                    var i = Laya.loader.getRes(e), n = i.bitmap || i;
                    n && (t.albedoTexture = n);
                } else console.log("unknow materail in __setMaterialTexutre__ :::: ", t.name);
            }
            function l(t, e) {
                for (var i = 0; i < t.numChildren; i++) {
                    var n = t._children[i];
                    n.isStatic && (n instanceof Laya.RenderableSprite3D && e.push(n), l(n, e));
                }
            }
            var h = function () {
                function t() { }
                return t.prototype.getChildWithPath = function (t, e) {
                    if (!e || e.length <= 0) return t;
                    for (var i = e.split("/"); i.length;) {
                        var n = t.getChildByName(i.shift());
                        if (!n) return console.warn("Cannot find child path = " + e + " in node:: ", t.name),
                            null;
                        t = n;
                    }
                    return t;
                }, t.prototype.transformRotation = function (t, e, i) {
                    var n = t.transform.localRotationEuler || new Laya.Vector3();
                    n.x = e, n.z = i, t.transform.localRotationEuler = n;
                }, t.prototype.transformPosition = function (t, e, i) {
                    var n = t.transform.position;
                    n.x = e, n.z = i, t.transform.position = n;
                }, t.prototype.transformHeight = function (t, e) {
                    var i = t.transform.position;
                    i.y = e, t.transform.position = i;
                }, t.prototype.transformForward = function (t, e, i) {
                    var n = t.transform.localRotationEuler || new Laya.Vector3();
                    n.y = 90 - 180 * Math.atan2(i, e) / Math.PI, t.transform.localRotationEuler = n;
                }, t.prototype.rotateBlend = function (t, e, i) { }, t.prototype.createModel = function (t, e, i) {
                    var n = r.default.getModel(i);
                    return n.name = t, e.addChild(n), n;
                }, t.prototype.destroyModel = function (t, e) {
                    var i = e.getChildByName(t);
                    i && r.default.cacheModel(i);
                }, t.prototype.createCamera = function (t, e, i, n) {
                    var r = new Laya.Camera(0, .1, 100);
                    // if (i == 60)
                    //     return r.clearColor = n || null, r.fieldOfView = 86, r.name = t, e.addChild(r), r;
                    console.log("createCamera", i)

                    return r.clearColor = n || null, r.fieldOfView = i, r.name = t, e.addChild(r), r;
                }, t.prototype.destroyCamera = function (t, e) {
                    var i = e.getChildByName(t);
                    i && i.destroy();
                }, t.prototype.createParticle = function (t, e, i, n) {
                    var r = a.default.getParticle(i, n);
                    return r.name = t, e.addChild(r), r;
                }, t.prototype.destroyParticle = function (t, e) {
                    var i = e.getChildByName(t);
                    i && a.default.cacheParticle(i);
                }, t.prototype.setParticles = function (t, e) {
                    var i = t.getComponent(n.default);
                    i || (i = t.addComponent(n.default)), i.setParticles(e);
                }, t.prototype.clearAllParticles = function (t, e) {
                    var i = e.getChildByName(t);
                    if (i) {
                        var r = i.getComponent(n.default);
                        r && !r.destroyed && r.destroy();
                    }
                }, t.prototype.setNodeActive = function (t, e) {
                    t.active = e || !1;
                }, t.prototype.setNodeColor = function (t, e, i) {
                    if (i && (t = this.getChildWithPath(t, i)), !t) return console.warn("cannot find target node with node:: ", t.name, i);
                    !function t(e, i) {
                        e instanceof Laya.SkinnedMeshSprite3D ? s(e.skinnedMeshRenderer.material, i) : e instanceof Laya.MeshSprite3D && s(e.meshRenderer.material, i);
                        for (var n = 0, r = e._children; n < r.length; n++) {
                            t(r[n], i);
                        }
                    }(t, e);
                }, t.prototype.replaceModelTexture = function (t, e, i) {
                    i && (t = this.getChildWithPath(t, i)), t instanceof Laya.MeshSprite3D ? o(t.meshRenderer.material, e) : t instanceof Laya.SkinnedMeshSprite3D ? o(t.skinnedMeshRenderer.material, e) : console.log("cannot find mesh or skinned mesh node with path: ", i, t.name);
                }, t.prototype.setStaticRenderList = function (t) {
                    for (var e = [], i = 0, n = t; i < n.length; i++) {
                        l(n[i], e);
                    }
                    for (var r = 0, a = Laya.StaticBatchManager._managers; r < a.length; r++) {
                        a[r]._clear();
                    }
                    e.length > 0 && Laya.StaticBatchManager.combine(null, e);
                }, t;
            }();
            i.default = h;
        }, {
            "./ModelManager": 280,
            "./ParticleCache": 281,
            "./ParticleManager": 282
        }],
        280: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.getModel = function (t) {
                    var e = Laya.Pool.getItem(t);
                    if (!e) {
                        var i = Laya.loader.getRes(t);
                        if (!i) return console.log("cannot find model resource with url: ", t), null;
                        -1 === this.s_urlPool.indexOf(t) && this.s_urlPool.push(t), (e = Laya.Sprite3D.instantiate(i)).__url__ = t;
                    }
                    return e;
                }, t.cacheModel = function (t) {
                    var e = t.__url__;
                    if (!e) return t.destroy();
                    t.removeSelf(), Laya.Pool.recover(e, t);
                }, t.clearByUrl = function (t) {
                    Laya.Pool.clearBySign(t);
                    var e = this.s_urlPool.indexOf(t);
                    -1 !== e && this.s_urlPool.splice(e, 1);
                }, t.clearAll = function () {
                    for (var t = 0, e = this.s_urlPool; t < e.length; t++) {
                        var i = e[t];
                        Laya.Pool.clearBySign(i);
                    }
                    this.s_urlPool.length = 0;
                }, t.s_urlPool = [], t;
            }();
            i.default = n;
        }, {}],
        281: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../ClassNameDef"), a = t("./ParticleManager");
            function s(t) {
                return t.url + (t.path || "null") + (t.autoSize ? "true" : "false");
            }
            function o(t, e) {
                if (!e || e.length <= 0) return t;
                for (var i = e.split("/"); i.length;) {
                    var n = t.getChildByName(i.shift());
                    if (!n) return console.warn("Cannot find child path = " + e + " in node:: ", t.name),
                        null;
                    t = n;
                }
                return t;
            }
            function l(t, e) {
                var i = o(t, e.path);
                if (!i) return console.warn("cannot find child with path ", t.name, e.path);
                var n = e.url, r = i.getChildByName(n);
                r || ((r = a.default.getParticle(n, e.autoSize)).name = n, i.addChild(r));
            }
            function h(t, e) {
                var i = o(t, e.path);
                if (!i) return console.warn("cannot find child with path ", t.name, e.path);
                var n = i.getChildByName(e.url);
                n && a.default.cacheParticle(n);
            }
            var u = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.infoMap = {}, e;
                }
                return r(e, t), e.prototype.__getClassName = function () {
                    return e.__className;
                }, e.prototype.onDestroy = function () {
                    var t = this.owner, e = this.infoMap;
                    for (var i in e) {
                        h(t, e[i]), delete e[i];
                    }
                }, e.prototype.setParticles = function (t) {
                    for (var e = this.owner, i = this.infoMap, n = Object.keys(i), r = 0, a = t; r < a.length; r++) {
                        var o = s(_ = a[r]), u = n.indexOf(o);
                        -1 !== u ? n.splice(u, 1) : (l(e, _), i[o] = _);
                    }
                    for (var c = 0, d = n; c < d.length; c++) {
                        var _;
                        h(e, _ = i[o = d[c]]), delete i[o];
                    }
                }, e.__className = "ParticleCache", e;
            }(n.RecycleScript3D);
            i.default = u;
        }, {
            "../../../ClassNameDef": 2,
            "./ParticleManager": 282
        }],
        282: [function (t, e, i) {
            "use strict";
            function n(t, e) {
                for (var i = 0; i < t.numChildren; i++) {
                    var r = t.getChildAt(i);
                    r && r instanceof Laya.ShuriKenParticle3D ? e ? r.particleSystem.play() : r.particleSystem.stop() : n(r, e);
                }
            }
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var a = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.getParticle = function (t, e) {
                    var i = this.getModel(t);
                    return function t(e, i) {
                        for (var n = 0; n < e.numChildren; n++) {
                            var r = e.getChildAt(n);
                            r && r instanceof Laya.ShuriKenParticle3D ? r.particleSystem.__autoSize__ = !!i || void 0 : t(r, i);
                        }
                    }(i, e), n(i, !0), i;
                }, e.cacheParticle = function (t) {
                    t.destroyed || (n(t, !1), this.cacheModel(t));
                }, e;
            }(t("./ModelManager").default);
            i.default = a;
        }, {
            "./ModelManager": 280
        }],
        283: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.ColorOnce, l.default.RenderNode, l.default.Model]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.renderNode;
                        if (a.root) {
                            var s = r.colorOnce;
                            e.setNodeColor(a.root, s.color);
                        } else console.warn("entity as no renderNode instance!", r.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        284: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.ForwardOnce, l.default.RenderNode],
                        anyOf: [l.default.Camera, l.default.Model, l.default.Particle]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.renderNode;
                        if (a.root) {
                            var s = r.forwardOnce;
                            e.transformForward(a.root, s.x, s.y);
                        } else console.warn("entity as no renderNode instance!", r.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        285: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.HeightOnce, l.default.RenderNode],
                        anyOf: [l.default.Camera, l.default.Model, l.default.Particle]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.renderNode;
                        if (a.renderHeightNode) {
                            var s = r.heightOnce.height;
                            if (r.hasComponent(l.default.Offset)) s += r.offset.height;
                            e.transformHeight(a.renderHeightNode, s);
                        } else console.warn("entity as no renderNode instance!", r.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        286: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.PositionOnce, l.default.RenderNode],
                        anyOf: [l.default.Camera, l.default.Model, l.default.Particle]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.renderNode;
                        if (a.root) {
                            var s = r.positionOnce, o = s.x, h = s.y;
                            if (r.hasComponent(l.default.Offset)) {
                                var u = r.offset;
                                o += u.x, h += u.y;
                            }
                            e.transformPosition(a.root, o, h);
                        } else console.warn("entity as no renderNode instance!", r.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        287: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.TriggerOnEvent, s = entitas.GroupEventType, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.RotationOnce, l.default.RenderNode],
                        anyOf: [l.default.Camera, l.default.Model, l.default.Particle]
                    }), e.trigger = new a(e.ensureComponents, s.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) {
                        var r = n[i], a = r.renderNode;
                        if (a.renderRotationNode) {
                            var s = r.rotationOnce;
                            e.transformRotation(a.renderRotationNode, s.x, s.y), r.removeComponent(l.default.RotationOnce);
                        } else console.warn("entity as no renderNode instance!", r.name, new Error().stack);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        288: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.Camera, l.default.RenderNode]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n], s = a.renderNode;
                        i.destroyModel(a.id, e), s.init(null);
                        var o = a.camera,

                            l = i.createCamera(a.id, e, o.fieldOfView);

                        console.log("rrrrrrrrr1")
                        l.viewport.name = "1";
                        window.aaa = l

                        Laya.timer.loop(50, this, () => {

                            l.projectionMatrix.elements[0] = 5.457683086395264
                            l.projectionMatrix.elements[5] = 3.732041597366333


                            l.projectionMatrix.elements[10] = -1.001001000404358
                            l.projectionMatrix.elements[14] = -0.10010010004043579

                            window.aaa._useUserProjectionMatrix = 1;
                        })
                        // setTimeout(()=>{
                        //     l._useUserProjectionMatrix = 1;
                        // },10e3)

                        window.c = l;
                        s.init(l);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        289: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.excludeComponents = n.create({
                        allOf: [l.default.Camera, l.default.RenderNode]
                    }), e.trigger = new s(e.excludeComponents, a.OnEntityRemoved), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n];
                        if (i.destroyCamera(a.id, e), a.hasComponent(l.default.RenderNode)) a.renderNode.init(null);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        290: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.Model, l.default.RenderNode]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n], s = a.renderNode;
                        i.destroyModel(a.id, e), s.init(null);
                        var o = a.model, l = i.createModel(a.id, e, o.url), h = i.getChildWithPath(l, o.heightPath), u = i.getChildWithPath(l, o.rotationPath);
                        s.init(l, h, u);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        291: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.excludeComponents = n.create({
                        allOf: [l.default.Model, l.default.RenderNode]
                    }), e.trigger = new s(e.excludeComponents, a.OnEntityRemoved), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n];
                        if (i.destroyModel(a.id, e), a.hasComponent(l.default.RenderNode)) a.renderNode.init(null);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        292: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        allOf: [l.default.Model, l.default.RenderNode, l.default.ModelTexture]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    this.context.scene;
                    for (var e = this.services.render, i = 0, n = t; i < n.length; i++) for (var r = n[i], a = r.renderNode, s = r.modelTexture.list, o = a.root, l = 0, h = s; l < h.length; l++) {
                        var u = h[l];
                        e.replaceModelTexture(o, u.url, u.path);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        293: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.trigger = new s(n.create({
                        allOf: [l.default.ParticlePanel, l.default.RenderNode]
                    }), a.OnEntityAddedOrRemoved), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n];
                        if (a.hasComponents([l.default.ParticlePanel, l.default.RenderNode])) {
                            var s = a.renderNode, o = a.particlePanel;
                            i.setParticles(s.root, o.list);
                        } else i.clearAllParticles(a.id, e);
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        294: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = t("../../../math/Vec2"), l = new o.default(), h = new o.default(), u = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Rolling, s.default.Position, s.default.Rotation, s.default.Forward]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t], n = i.rolling, r = i.position;
                        l.set(n.lastPos), n.lastPos.set(r).sub(l, h);
                        var a = h.mag();
                        if (!(a <= 0)) {
                            var s = i.forward;
                            s.x = h.x / a, s.y = h.y / a;
                            var o = i.rotation, u = n.rate;
                            o.x += a * u;
                        }
                    }
                }, e;
            }(a.default);
            i.default = u;
        }, {
            "../../../math/Vec2": 322,
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        295: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.trigger = new s(n.create({
                        allOf: [l.default.Particle, l.default.RenderNode]
                    }), a.OnEntityAddedOrRemoved), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.scene, i = this.services.render, n = 0, r = t; n < r.length; n++) {
                        var a = r[n];
                        if (a.hasComponents([l.default.Particle, l.default.RenderNode])) {
                            var s = a.renderNode, o = a.particle, h = i.createParticle(a.id, e, o.url, !1);
                            s.init(h);
                        } else {
                            i.destroyParticle(a.id, e), a.hasComponent(l.default.RenderNode) && a.renderNode.init(null);
                        }
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        296: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.SimpleAnimation]
                    }), e;
                }
                return r(e, t), e.prototype.execute = function () {
                    for (var t = this.context.deltaTime, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.simpleAnimation.update(t);
                        if (r) {
                            var a = r.x, o = r.y, l = r.height;
                            if (void 0 !== a || void 0 !== o) if (n.hasComponent(s.default.Offset)) {
                                var h = n.offset;
                                void 0 !== a && (h.x = a), void 0 !== o && (h.y = o);
                            } else if (n.hasComponent(s.default.Position)) {
                                var u = n.position;
                                void 0 !== a && (u.x = a), void 0 !== o && (u.y = o);
                            } else if (n.hasComponent(s.default.PositionOnce)) {
                                u = n.positionOnce;
                                n.replacePositionOnce(void 0 !== a ? a : u.x, void 0 !== o ? o : u.y);
                            }
                            if (void 0 !== l) if (n.hasComponent(s.default.Offset)) (h = n.offset).height = l; else if (n.hasComponent(s.default.Height)) {
                                n.height.height = l;
                            } else n.hasComponent(s.default.HeightOnce) && n.replaceHeightOnce(l);
                        }
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        297: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.RenderNode, s.default.Model, s.default.StaticRender]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    for (var t = [], e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e].renderNode;
                        t.push(n.root);
                    }
                    this.services.render.setStaticRenderList(t);
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        298: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Color, s.default.RenderNode]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = this.services.render, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.renderNode;
                        if (r.root) {
                            var a = n.color;
                            t.setNodeColor(r.root, a.color);
                        } else console.warn("entity as no renderNode instance!", n.name, new Error().stack);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        299: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Forward, s.default.RenderNode]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = this.services.render, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.renderNode;
                        if (r.root) {
                            var a = n.forward;
                            t.transformForward(r.root, a.x, a.y);
                        } else console.warn("entity as no renderNode instance!", n.name, new Error().stack);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        300: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Height, s.default.RenderNode]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = this.services.render, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.renderNode;
                        if (r.renderHeightNode) {
                            var a = n.height.height;
                            if (n.hasComponent(s.default.Offset)) a += n.offset.height;
                            t.transformHeight(r.renderHeightNode, a);
                        } else console.warn("entity as no renderNode instance!", n.name, new Error().stack);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        301: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Position, s.default.Height, s.default.SyncPosAndHeight]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = 0, e = this.group.getEntities(); t < e.length; t++) {
                        var i = e[t], n = (i.height, i.syncPosAndHeight), r = n.target;
                        if (r.hasComponent(s.default.Position)) {
                            var a = r.position, o = i.position;
                            o.x = a.x + n.offsetX, o.y = a.y + n.offsetY;
                        }
                        if (r.hasComponent(s.default.Height)) {
                            var l = r.height;
                            i.height.height = l.height + n.dHeight;
                        }
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        302: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Position, s.default.RenderNode]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = this.services.render, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.renderNode;
                        if (r.root) {
                            var a = n.position, o = a.x, l = a.y;
                            if (n.hasComponent(s.default.Offset)) {
                                var h = n.offset;
                                o += h.x, l += h.y;
                            }
                            t.transformPosition(r.root, o, l);
                        } else console.warn("entity as no renderNode instance!", n.name, new Error().stack);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        303: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.Rotation, s.default.RenderNode]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.execute();
                }, e.prototype.execute = function () {
                    for (var t = this.services.render, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e], r = n.renderNode;
                        if (r.renderRotationNode) {
                            var a = n.rotation;
                            t.transformRotation(r.renderRotationNode, a.x, a.y);
                        } else console.warn("entity as no renderNode instance!", n.name, new Error().stack);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        304: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i) {
                    this.url = t, this.loop = e || 0, this.volume = i || 1, this.startTime = 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        305: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t, e, i, n) {
                    this.url = t, this.loop = e || 1, this.volume = i || 1, this.startTime = 0, this.autoRelease = n;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        306: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../../../sdk/sdk"), r = t("../../../sdk/sdkConstants"), a = function () {
                function t() { }
                return t.prototype.playMusic = function (t, e, i, n) {
                    // var r = Laya.SoundManager.playMusic(t, e);
                    // if (r) {
                    //     var a = r.duration;
                    //     if (a) {
                    //         var s = Math.floor(n / a);
                    //         if (e > 0 && s > e) return r.stop();
                    //         r.startTime = n % a;
                    //     }
                    //     r.volume = i;
                    // }
                }, t.prototype.stopMusic = function () {
                    // Laya.SoundManager.stopMusic();
                }, t.prototype.playSound = function (t, e, i, a) {

                    if (Laya.LocalStorage.getItem("soundsound") == 0
                        || Laya.LocalStorage.getItem("soundsound") == null) {

                        if ("qq" === n.default.getPlatform()) {
                            var s = window.qq.createInnerAudioContext();
                            s.autoplay = !1, r.default.SUB_PACK_NAME ? s.src = r.default.SUB_PACK_NAME + "/" + t : s.src = t;
                            var o = 0, l = !1;
                            return e > 0 ? (o = e, l = !1, s.loop = !1) : (l = !0, s.loops = !0), s.onCanplay(function () {
                                console.log("播放"), s.play();
                            }), s.onEnded(function () {
                                l && o > 0 ? (o -= 1, s.play()) : s.destroy();
                            }), s.onPlay(function () {
                                console.log("开始播放");
                            }), void s.onError(function (t) {
                                console.log(t.errMsg), console.log(t.errCode);
                            });
                        }
                        if ("oppo" !== n.default.getPlatform()) {
                            var h = Laya.SoundManager.playSound(t, e);
                            if (h) {
                                var u = h.duration;
                                if (u) {
                                    var c = Math.floor(a / u);
                                    if (e > 0 && c >= e) return h.stop();
                                    h.startTime = a % u;
                                }
                                h.volume = i;
                            }
                        }
                    }



                },



                    t.prototype.stopSound = function (t) {
                        Laya.SoundManager.stopSound(t);
                    }, t.prototype.stopAllSound = function () {
                        Laya.SoundManager.stopAllSound();
                    }, t;
            }();
            i.default = a;
        }, {
            "../../../sdk/sdk": 327,
            "../../../sdk/sdkConstants": 329
        }],
        307: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        anyOf: [l.default.SoundPlayer, l.default.MusicPlayer]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.context.totalTime, i = 0, n = t; i < n.length; i++) {
                        var r = n[i];
                        if (r.hasComponent(l.default.MusicPlayer)) r.musicPlayer.startTime = e;
                        if (r.hasComponent(l.default.SoundPlayer)) r.soundPlayer.startTime = e;
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        308: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = entitas.GroupEventType, s = entitas.TriggerOnEvent, o = t("../../base/BaseSystem"), l = t("../../Componets"), h = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.ensureComponents = n.create({
                        anyOf: [l.default.SoundPlayer, l.default.MusicPlayer]
                    }), e.trigger = new s(e.ensureComponents, a.OnEntityAdded), e;
                }
                return r(e, t), e.prototype.execute = function (t) {
                    for (var e = this.pool, i = this.context.totalTime, n = this.services.sound, r = 0, a = t; r < a.length; r++) {
                        var s = a[r];
                        if (s.hasComponent(l.default.MusicPlayer)) {
                            var o = s.musicPlayer;
                            // n.playMusic(o.url, o.loop, o.volume, i - o.startTime);
                        }
                        if (s.hasComponent(l.default.SoundPlayer)) {
                            var h = s.soundPlayer;
                            n.playSound(h.url, h.loop, h.volume, i - h.startTime), h.autoRelease && e.destroyEntity(s);
                        }
                    }
                }, e;
            }(o.default);
            i.default = h;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        309: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./StateType"), r = function () {
                function t(t) {
                    this._enabled = !1, this._owner = null, this._state = n.default.None, this._stateComp = n.default.Full,
                        this._machine = null, this._unableEnterFlag = n.default.None, this._needExitFlag = n.default.Full,
                        this._duration = -1, this._time = 0, this._state = t, this._stateComp = n.default.Full ^ this._state,
                        this.reset();
                }
                return t.create = function () {
                    var t = Laya.Pool.getItemByClass(this.__classSign, this);
                    return t.reset(), t;
                }, t.purge = function (t) {
                    Laya.Pool.recover(this.__classSign, t);
                }, t.prototype.reset = function () {
                    this._enabled = !1, this._time = 0;
                }, t.prototype.stateAddition = function (t) {
                    return t | this._state;
                }, t.prototype.stateMinus = function (t) {
                    return t & this._stateComp;
                }, Object.defineProperty(t.prototype, "enabled", {
                    get: function () {
                        return this._enabled;
                    },
                    set: function (t) {
                        t ? this._enabled ? this.onEnterAgain() : (this._enabled = !0, this._time = 0, this.onEnter()) : this._enabled && (this._enabled = !1,
                            this.onExit());
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "state", {
                    get: function () {
                        return this._state;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.setMachine = function (t) {
                    this._machine = t;
                }, t.prototype.bind = function (t) {
                    null != this._owner && this.unbind(this._owner), this._owner = t;
                }, t.prototype.unbind = function (t) {
                    this._owner = null;
                }, t.prototype.update = function (t) {
                    return this._time += t, this.onUpdate(t), this._duration > 0 && this._time >= this._duration && (this.enabled = !1),
                        this._enabled;
                }, t.prototype.emit = function (t, e) {
                    return this.onEvent(t, e), this._enabled;
                }, t.prototype.recycle = function () {
                    throw "State function recycle need to be overrided";
                }, t.prototype.init = function (t) { }, t.prototype.enableEnter = function (t, e) {
                    return void 0 === e && (e = null), 0 == (this._unableEnterFlag & t);
                }, t.prototype.needExit = function (t, e) {
                    return void 0 === e && (e = null), 0 != (this._needExitFlag & t);
                }, t.prototype.onEnter = function () { }, t.prototype.onEnterAgain = function () { },
                    t.prototype.onExit = function () { }, t.prototype.onUpdate = function (t) { }, t.prototype.onEvent = function (t, e) { },
                    t.__classSign = "StateBase", t;
            }();
            i.default = r;
        }, {
            "./StateType": 311
        }],
        310: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() {
                    this._owner = null, this._statePool = [], this._defaultState = 0, this._currentState = 0;
                }
                return Object.defineProperty(t.prototype, "currentState", {
                    get: function () {
                        return this._currentState;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.setOwner = function (t) {
                    this._owner = t;
                }, t.prototype.setDefaultState = function (t) {
                    this._defaultState = t;
                }, t.prototype.addState = function (t) {
                    for (var e = 0, i = this._statePool; e < i.length; e++) {
                        var n = i[e];
                        if (t.state === n.state) return void console.log("StateMachine has state %d already", t.state);
                    }
                    t.setMachine(this), t.bind(this._owner), this._statePool.push(t);
                }, t.prototype.inState = function (t) {
                    return 0 != (this._currentState & t);
                }, t.prototype.hasState = function (t) {
                    for (var e = 0, i = this._statePool; e < i.length; e++) {
                        if (i[e].state === t) return !0;
                    }
                    return !1;
                }, t.prototype.enableEnter = function (t, e) {
                    void 0 === e && (e = null);
                    for (var i = !0, n = 0, r = this._statePool; n < r.length; n++) {
                        var a = r[n];
                        if (a.enabled && !a.enableEnter(t, e)) {
                            i = !1;
                            break;
                        }
                    }
                    return i;
                }, t.prototype.setState = function (t, e) {
                    if (void 0 === e && (e = null), 0 !== t && 0 !== this._statePool.length) {
                        for (var i = !0, n = 0, r = this._statePool; n < r.length; n++) {
                            if ((h = r[n]).enabled && !h.enableEnter(t, e)) {
                                i = !1;
                                break;
                            }
                        }
                        if (i) {
                            for (var a = 0, s = this._statePool; a < s.length; a++) {
                                (h = s[a]).enabled && h.needExit(t, e) && (this._currentState = h.stateMinus(this._currentState),
                                    h.enabled = !1);
                            }
                            for (var o = 0, l = this._statePool; o < l.length; o++) {
                                var h;
                                0 != (t & (h = l[o]).state) && (this._currentState = h.stateAddition(this._currentState),
                                    h.init(e), h.enabled = !0, h.enabled || (this._currentState = h.stateMinus(this._currentState)));
                            }
                        }
                    }
                }, t.prototype.update = function (t) {
                    for (var e = [], i = 0, n = this._statePool; i < n.length; i++) {
                        (s = n[i]).enabled && e.push(s);
                    }
                    for (var r = 0, a = e; r < a.length; r++) {
                        var s;
                        (s = a[r]).update(t) || (this._currentState = s.stateMinus(this._currentState));
                    }
                    0 === this._currentState && this.onReset();
                }, t.prototype.onReset = function (t) {
                    void 0 === t && (t = null), this._reset(t);
                }, t.prototype.stop = function () {
                    for (var t = 0, e = this._statePool; t < e.length; t++) {
                        var i = e[t];
                        i.enabled && (i.enabled = !1), this._currentState = 0;
                    }
                }, t.prototype.clear = function () {
                    for (var t = 0, e = this._statePool; t < e.length; t++) {
                        var i = e[t];
                        i.unbind(this._owner), i.setMachine(null), i.recycle();
                    }
                    this._statePool.length = 0, this._owner = null, this._currentState = 0;
                }, t.prototype.emit = function (t, e) {
                    if (void 0 === e && (e = null), 0 !== this._currentState) {
                        for (var i = [], n = 0, r = this._statePool; n < r.length; n++) {
                            (o = r[n]).enabled && i.push(o);
                        }
                        for (var a = 0, s = i; a < s.length; a++) {
                            var o;
                            (o = s[a]).emit(t, e) || (this._currentState = o.stateMinus(this._currentState));
                        }
                        0 === this._currentState && this.onReset();
                    }
                }, t.prototype._reset = function (t) {
                    this.setState(this._defaultState, t);
                }, t;
            }();
            i.default = n;
        }, {}],
        311: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.None = 0, t.Full = 65535, t.Idle = 1, t.Normal = 2, t.Hit = 4, t.Fly = 8,
                    t.Shot = 16, t.Win = 32, t.Hold = 64, t.Rockey = 128, t.Skill_Cast = 256, t.Skill_End = 512,
                    t.WaitingRelife = 1024, t.RelifeIng = 2048, t.WinRun = 4096, t.WinChase = 8192,
                    t.WinSlide = 16384, t;
            }();
            i.default = n;
        }, {}],
        312: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.init = function (t) {
                    this.duration = t;
                }, e.prototype.update = function (t) {
                    return this.duration -= t, this.duration <= 0;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        313: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return this.updateTime >= this.duration;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i) {
                    this.scaleTo = t, this.duration = e || 0, this.easing = i, this.updateTime = 0,
                        this.scaleFrom = null;
                }, e.prototype.update = function (t, e) {
                    if (this.duration <= 0) return this.scaleTo;
                    null === this.scaleFrom && (this.scaleFrom = e), this.updateTime += t;
                    var i = Math.min(1, this.updateTime / this.duration);
                    this.easing && (i = this.easing(i, 0, 1, 1));
                    var n = this.scaleFrom;
                    return n + i * (this.scaleTo - n);
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        314: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), Object.defineProperty(e.prototype, "over", {
                    get: function () {
                        return 0 === this.loopCount;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e.prototype.init = function (t, e, i, n, r) {
                    this.interval = t, this.loopCount = e, this.caller = i, this.handler = n, this.args = r,
                        this.targetTime = null;
                }, e.prototype.update = function (t, e) {
                    null === this.targetTime && (this.targetTime = t + this.interval), this.targetTime <= t && (this.run(),
                        this.loopCount > 0 && (this.targetTime += this.interval));
                }, e.prototype.run = function () {
                    this.args instanceof Array ? this.handler.apply(this.caller, this.args) : this.handler.call(this.caller, this.args),
                        this.loopCount > 0 && (this.loopCount -= 1);
                }, e.prototype.onReset = function () {
                    this.caller = null, this.handler = null, this.targetTime = null;
                }, e;
            }(t("../../base/BaseComponent").default);
            i.default = n;
        }, {
            "../../base/BaseComponent": 137
        }],
        315: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.LifeDuration]
                    }), e;
                }
                return r(e, t), e.prototype.cleanup = function () {
                    for (var t = this.pool, e = this.context.deltaTime, i = 0, n = this.group.getEntities(); i < n.length; i++) {
                        var r = n[i];
                        r.lifeDuration.update(e) && t.destroyEntity(r);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        316: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.TimeScaler]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    this.services.timer.setTimeScale(1);
                }, e.prototype.execute = function () {
                    for (var t = this.services.timer, e = this.context, i = e.deltaTime, n = 0, r = this.group.getEntities(); n < r.length; n++) {
                        var a = r[n].timeScaler.update(i, e.timeScale);
                        e.timeScale = a, t.setTimeScale(a);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = this.pool, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e];
                        n.timeScaler.over && t.destroyEntity(n);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        317: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = entitas.Matcher, a = t("../../base/BaseSystem"), s = t("../../Componets"), o = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.matcher = n.create({
                        allOf: [s.default.TimerHandler]
                    }), e;
                }
                return r(e, t), e.prototype.initialize = function () {
                    var t = this.context;
                    t.frameIndex = 0, t.totalTime = 0, t.timeScale = 1, t.logicTime = 0;
                }, e.prototype.execute = function () {
                    var t = this.context;
                    t.frameIndex += 1, t.logicTime += 17;
                    var e = t.totalTime, i = 17 * t.timeScale * .001;
                    t.totalTime = e + i, t.deltaTime = i;
                    for (var n = 0, r = this.group.getEntities(); n < r.length; n++) {
                        r[n].timerHandler.update(e, i);
                    }
                }, e.prototype.cleanup = function () {
                    for (var t = this.pool, e = 0, i = this.group.getEntities(); e < i.length; e++) {
                        var n = i[e];
                        n.timerHandler.over && t.destroyEntity(n);
                    }
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "../../Componets": 126,
            "../../base/BaseSystem": 138
        }],
        318: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.WHITE = new e(1, 1, 1, 1), e.YELLOW = new e(1, 1, 0, 1), e;
            }(Laya.Vector4);
            i.default = n;
        }, {}],
        319: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./Vec2"), a = t("./Rect"), s = new n.default(), o = function (t) {
                function e(e, i, n, r, a) {
                    var s = t.call(this, e, i, n, r) || this;
                    return s.flip = !1, s.flip = a, s;
                }
                return r(e, t), e.prototype.contains = function (e, i) {
                    return !!t.prototype.contains.call(this, e, i) && (e < this.x + this.height ? (s.setXY(this.x + this.height - e, this.y + (this.flip ? 1 : 0) * this.height - i),
                        s.mag() <= this.height) : !(e > this.right - this.height) || (s.setXY(this.right - this.height - e, this.y + (this.flip ? 1 : 0) * this.height - i),
                            s.mag() <= this.height));
                }, e;
            }(a.default);
            i.default = o;
        }, {
            "./Rect": 321,
            "./Vec2": 322
        }],
        320: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = 0, r = Math.pow(2, 32) - 1;
            var a = function () {
                function t() { }
                return t.sum = function (t) {
                    for (var e = 0, i = 0, n = t; i < n.length; i++) {
                        e += n[i];
                    }
                    return e;
                }, t.clamp = function (t, e, i) {
                    return Math.max(Math.min(t, i), e);
                }, t.setRandomSeed = function (t) {
                    n = t;
                }, t.random = function (t) {
                    return t ? Math.random() : (n = (1103515245 * n + 123456789) % r) / r;
                }, t.randomInt = function (t, e) {
                    return Math.floor(this.random(e) * t);
                }, t.randomBetween = function (t, e, i) {
                    return this.random(i) * (e - t) + t;
                }, t.randomInArray = function (t, e) {
                    return t[this.randomInt(t.length, e)];
                }, t.randomFromArray = function (t, e) {
                    var i = this.randomInt(t.length, e);
                    return t.splice(i, 1)[0];
                }, t.nrSamplingInLargeList = function (e, i, n) {
                    if (i <= 0) return [];
                    for (var r = e.length, a = [], s = 0; s < i; s++) {
                        for (var o = t.randomInt(r - s, n), l = 0; l < a.length; l++) {
                            if (!(a[l] <= o)) break;
                            o++;
                        }
                        a.push(o), a.sort(function (t, e) {
                            return t - e;
                        });
                    }
                    return a.map(function (t) {
                        return e[t];
                    });
                }, t.randomOrderList = function (e, i) {
                    for (var n = [], r = e.slice(); r.length > 0;) n.push.apply(n, r.splice(t.randomInt(r.length, i), 1));
                    return n;
                }, t.randomOdds = function (t, e) {
                    if (t.length <= 1) return t[0];
                    for (var i = 0, n = 0, r = t; n < r.length; n++) {
                        i += (l = r[n]).odds || 0;
                    }
                    for (var a = this.randomInt(i, e), s = 0, o = t; s < o.length; s++) {
                        var l;
                        if ((a -= (l = o[s]).odds) <= 0) return l;
                    }
                    return console.warn("why got a null result in random odds?", a, t), t[0];
                }, t;
            }();
            i.default = a;
        }, {}],
        321: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype.set = function (t) {
                    return this.setTo(t.x, t.y, t.width, t.height), this;
                }, Object.defineProperty(e.prototype, "top", {
                    get: function () {
                        return this.bottom;
                    },
                    enumerable: !1,
                    configurable: !0
                }), e;
            }(Laya.Rectangle);
            i.default = n;
        }, {}],
        322: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t(t, e) {
                    this.x = t || 0, this.y = e || 0;
                }
                return t.prototype.clone = function () {
                    return new t(this.x, this.y);
                }, t.prototype.setXY = function (t, e) {
                    return this.x = t, this.y = e, this;
                }, t.prototype.set = function (t) {
                    return this.x = t.x, this.y = t.y, this;
                }, t.prototype.equals = function (t) {
                    return t && this.x === t.x && this.y === t.y;
                }, t.prototype.toString = function () {
                    return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ")";
                }, t.prototype.lerp = function (e, i, n) {
                    n = n || new t();
                    var r = this.x, a = this.y;
                    return n.x = r + (e.x - r) * i, n.y = a + (e.y - a) * i, n;
                }, t.prototype.addSelf = function (t) {
                    return this.x += t.x, this.y += t.y, this;
                }, t.prototype.add = function (e, i) {
                    return (i = i || new t()).x = this.x + e.x, i.y = this.y + e.y, i;
                }, t.prototype.subSelf = function (t) {
                    return this.x -= t.x, this.y -= t.y, this;
                }, t.prototype.sub = function (e, i) {
                    return (i = i || new t()).x = this.x - e.x, i.y = this.y - e.y, i;
                }, t.prototype.mulSelf = function (t) {
                    return this.x *= t, this.y *= t, this;
                }, t.prototype.mul = function (e, i) {
                    return (i = i || new t()).x = this.x * e, i.y = this.y * e, i;
                }, t.prototype.scaleSelf = function (t) {
                    return this.x *= t.x, this.y *= t.y, this;
                }, t.prototype.scale = function (e, i) {
                    return (i = i || new t()).x = this.x * e.x, i.y = this.y * e.y, i;
                }, t.prototype.divSelf = function (t) {
                    return this.x /= t, this.y /= t, this;
                }, t.prototype.div = function (e, i) {
                    return (i = i || new t()).x = this.x / e, i.y = this.y / e, i;
                }, t.prototype.negSelf = function () {
                    return this.x = -this.x, this.y = -this.y, this;
                }, t.prototype.neg = function (e) {
                    return (e = e || new t()).x = -this.x, e.y = -this.y, e;
                }, t.prototype.dot = function (t) {
                    return this.x * t.x + this.y * t.y;
                }, t.prototype.cross = function (t) {
                    return this.y * t.x - this.x * t.y;
                }, t.prototype.mag = function () {
                    return Math.sqrt(this.x * this.x + this.y * this.y);
                }, t.prototype.magSqr = function () {
                    return this.x * this.x + this.y * this.y;
                }, t.prototype.normalizeSelf = function () {
                    var t = this.x * this.x + this.y * this.y;
                    if (1 === t) return this;
                    if (0 === t) return console.warn("Can't normalize zero vector"), this;
                    var e = 1 / Math.sqrt(t);
                    return this.x *= e, this.y *= e, this;
                }, t.prototype.normalize = function (e) {
                    return (e = e || new t()).x = this.x, e.y = this.y, e.normalizeSelf(), e;
                }, t.prototype.rotateVector = function (e, i) {
                    return (i = i || new t()).x = this.x, i.y = this.y, i.rotateVectorSelf(e);
                }, t.prototype.rotateVectorSelf = function (t) {
                    var e = t.x, i = t.y, n = this.x;
                    return this.x = e * n - i * this.y, this.y = i * n + e * this.y, this;
                }, t.ZERO = new t(0, 0), t;
            }();
            i.default = n, window.Vec2 = n;
        }, {}],
        323: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./fairyScene"), a = t("../Path"), s = t("../EventCenter"), o = t("../Events"), l = t("../fgui/ui/uiBinder"), h = t("../view/MainView"), u = t("../view/PlayerControlView"), c = t("../game/GameController"), d = t("../data/skin/SkinData"), _ = t("../data/fight/FightScript"), f = t("../data/UserData"), p = t("../view/GuideView"), m = t("../game/StaticBehaviors"), g = t("../game/HomeController"), y = t("../view/TransformView"), v = t("../UIModelShower"), S = t("../data/RankHelper");
            function T(t, e) {
                return t ? function (i) {
                    t.runWith(e + i * (1 - e));
                } : function (t) { };
            }
            var E = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e._scene3d = null, e;
                }
                return r(e, t),
                    e.prototype.prepareResources = function (t, e) {

                        var i = this.loader;
                        !function (t, e, i) {
                            var n = ["fgui/ui", "fgui/headIcon", "fgui/guide"], r = "." + fairygui.UIConfig.packageFileExtension, a = n.map(function (t) {
                                return {
                                    url: t + r,
                                    type: Laya.Loader.BUFFER
                                };
                            });
                            t.load(a, Laya.Handler.create(null, function () {
                                for (var r = [], a = 0, s = n; a < s.length; a++) for (var o = s[a], l = 0, h = fairygui.UIPackage.addPackage(o)._items; l < h.length; l++) {
                                    var u = h[l];
                                    u.type == fairygui.PackageItemType.Atlas ? r.push({
                                        url: u.file,
                                        type: Laya.Loader.IMAGE
                                    }) : u.type != fairygui.PackageItemType.Sound || Laya.Browser.onMiniGame || r.push({
                                        url: u.file,
                                        type: Laya.Loader.SOUND
                                    });
                                }
                                r.length > 0 ? t.load(r, Laya.Handler.create(null, function () {
                                    e && e();
                                }), null, -1, Laya.Handler.create(null, function (t) {
                                    i && i(.3 + .7 * t);
                                }, null, !1)) : (i && i(1), e());
                            }), null, -1, Laya.Handler.create(null, function (t) {
                                i && i(.3 * t);
                            }, null, !1));
                        }(i, function () {
                            !function (t, e, i) {
                                var n = [a.default.getSprite3DPath("ring"), a.default.getSprite3DPath("arrow"), a.default.getSprite3DPath("bench"), a.default.getSprite3DPath("revive"), a.default.getSprite3DPath("football"), a.default.getSprite3DPath("direction"), a.default.getSprite3DPath("coin_model"), a.default.getSprite3DPath("football_ground"), a.default.getSprite3DPath("particle_hit"), a.default.getSprite3DPath("particle_smoke"), a.default.getSprite3DPath("particle_speed"), a.default.getSprite3DPath("particle_shot"), a.default.getSprite3DPath("particle_wave"), a.default.getSprite3DPath("particle_fire"), a.default.getSprite3DPath("particle_ballfly1"), a.default.getSprite3DPath("particle_celebrate"), a.default.getSprite3DPath("particle_football"), a.default.getSprite3DPath("particle_revive"), a.default.getSprite3DPath("particle_grass"), a.default.getSprite3DPath("particle_coin")].concat(d.default.getAllModelList());
                                t.create(n, Laya.Handler.create(null, function () {
                                    e && e();
                                }), null, -1, i ? Laya.Handler.create(null, i, null, !1) : null);
                            }(i, function () {
                                !function (t, e, i) {
                                    var n = d.default.getAllTextureList().map(function (t) {
                                        return {
                                            url: t,
                                            type: Laya.Loader.IMAGE
                                        };
                                    }).concat(a.default.getTreeInfos(_.default.allScript)).concat(Laya.Browser.onMiniGame ? [] : ["ball_land", "cheer", "countdown", "end-whistle", "hit", "poofgoldcoin", "slide", "start-whistle"].map(function (t) {
                                        return {
                                            url: a.default.getSoundPath(t),
                                            type: Laya.Loader.SOUND
                                        };
                                    }));
                                    t.load(n, Laya.Handler.create(null, function () {
                                        e && e();
                                    }), null, -1, i ? Laya.Handler.create(null, i, null, !1) : null);
                                }(i, function () {
                                    e && e.recover(), t && t.run();
                                }, T(e, 1));
                            }, T(e, .7));
                        }, T(e, .3));
                    }, e.prototype.onPrepared = function () {
                        this._onResourcesCompleted();
                    }, e.prototype.onOpened = function () {
                        l.default.bindAll(), f.default.getInstance().guidePass || p.default.getInstance(),
                            u.default.getInstance(), h.default.show(), y.default.getInstance(), this.addEventListeners()
                        // Laya.SoundManager.playMusic(a.default.getSoundPath("theme")

                        // ), 

                        f.default.getInstance().guidePass || this._gameInit({
                            nickname: "新手陪练",
                            avatar: "ui://headIcon/1",
                            rank: S.default.getRankInfoWithLevel(0)
                        });
                    }, e.prototype.onClosed = function () {
                        this.removeEventListeners();
                    }, e.prototype.addEventListeners = function () {
                        s.default.on(o.default.UI_ENTER_GAME, this, this._gameInit), s.default.on(o.default.UI_BACK_TO_HOME, this, this._homeInit);
                    }, e.prototype.removeEventListeners = function () {
                        s.default.off(o.default.UI_ENTER_GAME, this, this._gameInit), s.default.off(o.default.UI_BACK_TO_HOME, this, this._homeInit);
                    }, e.prototype._onResourcesCompleted = function () {
                        m.default.init();
                        var t = Laya.stage.addChildAt(new Laya.Scene3D(), 0);
                        t.timer = new Laya.Timer(), this._scene3d = t;
                        var e = Laya.stage.addChild(new Laya.Scene3D());
                        e.zOrder = 1e5, e.addComponent(v.default), f.default.getInstance().guidePass && this._homeInit();
                    }, e.prototype._gameInit = function (t) {
                        var e = this._scene3d, i = e.getComponent(g.default), n = e.getComponent(c.default);
                        i && e._destroyComponent(i), n || e.addComponent(c.default), console.log("emit reset game--================="),
                            s.default.emit(o.default.RESET_GAME, t), Laya.timer.frameOnce(1, this, function () {
                                s.default.emit(o.default.UI_TRANSFORM_RESUME), Laya.timer.once(500, this, function () {
                                    s.default.emit(o.default.START_GAME);
                                });
                            });
                    }, e.prototype._homeInit = function () {
                        var t = this._scene3d, e = t.getComponent(g.default), i = t.getComponent(c.default);
                        i && t._destroyComponent(i), e || t.addComponent(g.default);
                    }, e;
            }(n.default);
            i.default = E;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../Path": 12,
            "../UIModelShower": 14,
            "../data/RankHelper": 19,
            "../data/UserData": 20,
            "../data/fight/FightScript": 30,
            "../data/skin/SkinData": 32,
            "../fgui/ui/uiBinder": 125,
            "../game/GameController": 128,
            "../game/HomeController": 130,
            "../game/StaticBehaviors": 136,
            "../view/GuideView": 339,
            "../view/MainView": 343,
            "../view/PlayerControlView": 347,
            "../view/TransformView": 355,
            "./fairyScene": 325
        }],
        324: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./fairyScene"), a = t("../view/StartView"), s = t("../sdk/sdk"), o = t("./GameScene"), l = t("../data/MjpHelper"), h = t("../data/UserData"), u = t("../EventCenter"), c = t("../Events"), d = t("../view/MsgBox"), _ = t("../Loader"), f = t("../fgui/Common/CommonBinder"), p = t("../ThirdParty/SagiAdHelper"), m = function (t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.gameScene = null, e._status = 0, e._loginFailedTimes = 0, e;
                }
                return r(e, t),
                    e.prototype.onOpened = function () {

                        _.default.root.load([{
                            url: "fgui/Common.obj",
                            type: Laya.Loader.BUFFER
                        }, {
                            url: "fgui/Common_atlas0.png",
                            type: Laya.Loader.IMAGE
                        }], Laya.Handler.create(this, function () {
                            f.default.bindAll(), this.loader.load([{
                                url: "fgui/start.obj",
                                type: Laya.Loader.BUFFER
                            }, {
                                url: "fgui/start_atlas0.png",
                                type: Laya.Loader.IMAGE
                            }, {
                                url: "config/version.json",
                                type: Laya.Loader.JSON
                            }], Laya.Handler.create(this, this._showStartView));
                        }));
                    }, e.prototype.onClosed = function () {
                        a.default.purge(), this.loader.release(), this.loader = null;
                    }, e.prototype._showStartView = function () {

                        a.default.show(),
                            a.default.getInstance().setProgress(0),
                            Laya.timer.frameOnce(1, this, this._prepareGameScene);
                    }, e.prototype._prepareGameScene = function () {

                        var t = this;
                        this.gameScene = new o.default();
                        var e = Laya.loader.getRes("config/version.json");
                        l.default.VERSION = e, s.default.init(e.version, !1, !1, !0),
                            this._tryLogin(),

                            s.default.checkResources(function () {

                                t.gameScene.prepareResources(Laya.Handler.create(t, t._tryStartGame, [1]),

                                    Laya.Handler.create(t, t._updateProgress, [.2, 1], !1));

                            },
                                function (e) {

                                    t._updateProgress(0, .2, e);
                                }), l.default.init(),
                            this._preCompileUsedShaders(),
                            Laya.timer.once(1e3, this, this._tryStartGame, [2]);
                    }, e.prototype._updateProgress = function (t, e, i) {

                        var n = t + (e - t) * i;
                        a.default.getInstance().setProgress(n);
                    }, e.prototype._tryLogin = function () {

                        var t = this;
                        // this._onLoginFail.bind(this)
                        t._tryStartGame(4);
                        // s.default.supportLogin() ? s.default.login(function(e, i) {
                        //     console.log("login success ====================== ", e);
                        //     var n = h.default.getInstance(), r = i.headimg, a = i.cache && i.cache.create_time || 0;
                        //     r && r.length > 0 && (n.nickname = i.nickname, n.avatar = i.headimg), n.createTime = a, 
                        //     n.followsnum = i.followsnum || 0, n.uid = e, n.setLoginTime(i.timestamp || Math.floor(new Date().getTime() / 1e3)), 
                        //     p.default.init(i.accesstoken, i.invitecode), "oppo" === s.default.getPlatform() && (console.log("=======> oppo打点!"), 
                        //     s.default.reportMonitor("game_scene", 0)), u.default.emit(c.default.USER_LOGIN), 

                        //     t._tryStartGame(4);
                        // }, 
                        // this._onLoginFail.bind(this)) : this._tryStartGame(4);
                    }, e.prototype._onLoginFail = function () {
                        "tt" == s.default.getPlatform() ? this._tryStartGame(4) : (this._loginFailedTimes += 1,
                            this._loginFailedTimes >= 3 ? d.default.showBox("\b连接服务器失败，请检查网络后重试！", Laya.Handler.create(this, this._tryLogin)) : this._tryLogin());
                    },
                    e.prototype._tryStartGame = function (t) {
                        console.log("打开游戏！！！", t)
                        if (this._status |= t, 7 === this._status) {

                            var e = this.gameScene;
                            e.onPrepared(),
                                Laya.timer.frameOnce(1, this, function () {
                                    e.open(!0);
                                });
                        }
                    }, e.prototype._preCompileUsedShaders = function () {
                        var t = laya.d3.shader.Shader3D.SHADERDEFINE_HIGHPRECISION, e = laya.d3.shader.Shader3D;
                        e.compileShader("Unlit", 0, 0, 0 | t, 0, 2), e.compileShader("Unlit", 0, 0, 0 | t, 0, 0),
                            e.compileShader("Unlit", 0, 0, 0 | t, 0, 3), e.compileShader("Unlit", 0, 0, 0 | t, 64, 2),
                            e.compileShader("Unlit", 0, 0, 0 | t, 64, 3), e.compileShader("Trail", 0, 0, 1 | t, 8, 2),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 71303696, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763208, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 67109e3, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69206152, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763208, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 67666568, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763720, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763744, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69206720, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 71303232, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 71303312, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 71303872, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 71303304, 6), e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763592, 6),
                            e.compileShader("PARTICLESHURIKEN", 0, 0, 1 | t, 69763208, 14);
                    }, e;
            }(n.default);
            i.default = m;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../Loader": 10,
            "../ThirdParty/SagiAdHelper": 13,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../fgui/Common/CommonBinder": 44,
            "../sdk/sdk": 327,
            "../view/MsgBox": 345,
            "../view/StartView": 353,
            "./GameScene": 323,
            "./fairyScene": 325
        }],
        325: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../Loader"), a = function (t) {
                function e() {
                    var e = t.call(this) || this;
                    return e.loader = null, e.loader = n.default.root.createSubLoader(), e;
                }
                return r(e, t), e.prototype.open = function (e, i) {
                    var n = fairygui.GRoot.inst.displayObject;
                    n.removeSelf(), n.zOrder = 1e3, this.addChild(n), t.prototype.open.call(this, e, i);
                }, e;
            }(Laya.Scene);
            i.default = a;
        }, {
            "../Loader": 10
        }],
        326: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = new (function () {
                function t() {
                    this.hexcase = 0, this.b64pad = "";
                }
                return t.prototype.hex_md5 = function (t) {
                    return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)));
                }, t.prototype.b64_md5 = function (t) {
                    return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)));
                }, t.prototype.any_md5 = function (t, e) {
                    return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)), e);
                }, t.prototype.hex_hmac_md5 = function (t, e) {
                    return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
                }, t.prototype.b64_hmac_md5 = function (t, e) {
                    return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
                }, t.prototype.any_hmac_md5 = function (t, e, i) {
                    return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)), i);
                }, t.prototype.md5_vm_test = function () {
                    return "900150983cd24fb0d6963f7d28e17f72" == this.hex_md5("abc").toLowerCase();
                }, t.prototype.rstr_md5 = function (t) {
                    return this.binl2rstr(this.binl_md5(this.rstr2binl(t), 8 * t.length));
                }, t.prototype.rstr_hmac_md5 = function (t, e) {
                    var i = this.rstr2binl(t);
                    i.length > 16 && (i = this.binl_md5(i, 8 * t.length));
                    for (var n = Array(16), r = Array(16), a = 0; a < 16; a++) n[a] = 909522486 ^ i[a],
                        r[a] = 1549556828 ^ i[a];
                    var s = this.binl_md5(n.concat(this.rstr2binl(e)), 512 + 8 * e.length);
                    return this.binl2rstr(this.binl_md5(r.concat(s), 640));
                }, t.prototype.rstr2hex = function (t) {
                    try {
                        this.hexcase;
                    } catch (t) {
                        this.hexcase = 0;
                    }
                    for (var e, i = this.hexcase ? "0123456789ABCDEF" : "0123456789abcdef", n = "", r = 0; r < t.length; r++) e = t.charCodeAt(r),
                        n += i.charAt(e >>> 4 & 15) + i.charAt(15 & e);
                    return n;
                }, t.prototype.rstr2b64 = function (t) {
                    try {
                        this.b64pad;
                    } catch (t) {
                        this.b64pad = "";
                    }
                    for (var e = "", i = t.length, n = 0; n < i; n += 3) for (var r = t.charCodeAt(n) << 16 | (n + 1 < i ? t.charCodeAt(n + 1) << 8 : 0) | (n + 2 < i ? t.charCodeAt(n + 2) : 0), a = 0; a < 4; a++) 8 * n + 6 * a > 8 * t.length ? e += this.b64pad : e += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 6 * (3 - a) & 63);
                    return e;
                }, t.prototype.rstr2any = function (t, e) {
                    var i, n, r, a, s, o = e.length, l = Array(Math.ceil(t.length / 2));
                    for (i = 0; i < l.length; i++) l[i] = t.charCodeAt(2 * i) << 8 | t.charCodeAt(2 * i + 1);
                    var h = Math.ceil(8 * t.length / (Math.log(e.length) / Math.log(2))), u = Array(h);
                    for (n = 0; n < h; n++) {
                        for (s = Array(), a = 0, i = 0; i < l.length; i++) a = (a << 16) + l[i], a -= (r = Math.floor(a / o)) * o,
                            (s.length > 0 || r > 0) && (s[s.length] = r);
                        u[n] = a, l = s;
                    }
                    var c = "";
                    for (i = u.length - 1; i >= 0; i--) c += e.charAt(u[i]);
                    return c;
                }, t.prototype.str2rstr_utf8 = function (t) {
                    for (var e, i, n = "", r = -1; ++r < t.length;) e = t.charCodeAt(r), i = r + 1 < t.length ? t.charCodeAt(r + 1) : 0,
                        55296 <= e && e <= 56319 && 56320 <= i && i <= 57343 && (e = 65536 + ((1023 & e) << 10) + (1023 & i),
                            r++), e <= 127 ? n += String.fromCharCode(e) : e <= 2047 ? n += String.fromCharCode(192 | e >>> 6 & 31, 128 | 63 & e) : e <= 65535 ? n += String.fromCharCode(224 | e >>> 12 & 15, 128 | e >>> 6 & 63, 128 | 63 & e) : e <= 2097151 && (n += String.fromCharCode(240 | e >>> 18 & 7, 128 | e >>> 12 & 63, 128 | e >>> 6 & 63, 128 | 63 & e));
                    return n;
                }, t.prototype.str2rstr_utf16le = function (t) {
                    for (var e = "", i = 0; i < t.length; i++) e += String.fromCharCode(255 & t.charCodeAt(i), t.charCodeAt(i) >>> 8 & 255);
                    return e;
                }, t.prototype.str2rstr_utf16be = function (t) {
                    for (var e = "", i = 0; i < t.length; i++) e += String.fromCharCode(t.charCodeAt(i) >>> 8 & 255, 255 & t.charCodeAt(i));
                    return e;
                }, t.prototype.rstr2binl = function (t) {
                    for (var e = Array(t.length >> 2), i = 0; i < e.length; i++) e[i] = 0;
                    for (i = 0; i < 8 * t.length; i += 8) e[i >> 5] |= (255 & t.charCodeAt(i / 8)) << i % 32;
                    return e;
                }, t.prototype.binl2rstr = function (t) {
                    for (var e = "", i = 0; i < 32 * t.length; i += 8) e += String.fromCharCode(t[i >> 5] >>> i % 32 & 255);
                    return e;
                }, t.prototype.binl_md5 = function (t, e) {
                    t[e >> 5] |= 128 << e % 32, t[14 + (e + 64 >>> 9 << 4)] = e;
                    for (var i = 1732584193, n = -271733879, r = -1732584194, a = 271733878, s = 0; s < t.length; s += 16) {
                        var o = i, l = n, h = r, u = a;
                        i = this.md5_ff(i, n, r, a, t[s + 0], 7, -680876936), a = this.md5_ff(a, i, n, r, t[s + 1], 12, -389564586),
                            r = this.md5_ff(r, a, i, n, t[s + 2], 17, 606105819), n = this.md5_ff(n, r, a, i, t[s + 3], 22, -1044525330),
                            i = this.md5_ff(i, n, r, a, t[s + 4], 7, -176418897), a = this.md5_ff(a, i, n, r, t[s + 5], 12, 1200080426),
                            r = this.md5_ff(r, a, i, n, t[s + 6], 17, -1473231341), n = this.md5_ff(n, r, a, i, t[s + 7], 22, -45705983),
                            i = this.md5_ff(i, n, r, a, t[s + 8], 7, 1770035416), a = this.md5_ff(a, i, n, r, t[s + 9], 12, -1958414417),
                            r = this.md5_ff(r, a, i, n, t[s + 10], 17, -42063), n = this.md5_ff(n, r, a, i, t[s + 11], 22, -1990404162),
                            i = this.md5_ff(i, n, r, a, t[s + 12], 7, 1804603682), a = this.md5_ff(a, i, n, r, t[s + 13], 12, -40341101),
                            r = this.md5_ff(r, a, i, n, t[s + 14], 17, -1502002290), n = this.md5_ff(n, r, a, i, t[s + 15], 22, 1236535329),
                            i = this.md5_gg(i, n, r, a, t[s + 1], 5, -165796510), a = this.md5_gg(a, i, n, r, t[s + 6], 9, -1069501632),
                            r = this.md5_gg(r, a, i, n, t[s + 11], 14, 643717713), n = this.md5_gg(n, r, a, i, t[s + 0], 20, -373897302),
                            i = this.md5_gg(i, n, r, a, t[s + 5], 5, -701558691), a = this.md5_gg(a, i, n, r, t[s + 10], 9, 38016083),
                            r = this.md5_gg(r, a, i, n, t[s + 15], 14, -660478335), n = this.md5_gg(n, r, a, i, t[s + 4], 20, -405537848),
                            i = this.md5_gg(i, n, r, a, t[s + 9], 5, 568446438), a = this.md5_gg(a, i, n, r, t[s + 14], 9, -1019803690),
                            r = this.md5_gg(r, a, i, n, t[s + 3], 14, -187363961), n = this.md5_gg(n, r, a, i, t[s + 8], 20, 1163531501),
                            i = this.md5_gg(i, n, r, a, t[s + 13], 5, -1444681467), a = this.md5_gg(a, i, n, r, t[s + 2], 9, -51403784),
                            r = this.md5_gg(r, a, i, n, t[s + 7], 14, 1735328473), n = this.md5_gg(n, r, a, i, t[s + 12], 20, -1926607734),
                            i = this.md5_hh(i, n, r, a, t[s + 5], 4, -378558), a = this.md5_hh(a, i, n, r, t[s + 8], 11, -2022574463),
                            r = this.md5_hh(r, a, i, n, t[s + 11], 16, 1839030562), n = this.md5_hh(n, r, a, i, t[s + 14], 23, -35309556),
                            i = this.md5_hh(i, n, r, a, t[s + 1], 4, -1530992060), a = this.md5_hh(a, i, n, r, t[s + 4], 11, 1272893353),
                            r = this.md5_hh(r, a, i, n, t[s + 7], 16, -155497632), n = this.md5_hh(n, r, a, i, t[s + 10], 23, -1094730640),
                            i = this.md5_hh(i, n, r, a, t[s + 13], 4, 681279174), a = this.md5_hh(a, i, n, r, t[s + 0], 11, -358537222),
                            r = this.md5_hh(r, a, i, n, t[s + 3], 16, -722521979), n = this.md5_hh(n, r, a, i, t[s + 6], 23, 76029189),
                            i = this.md5_hh(i, n, r, a, t[s + 9], 4, -640364487), a = this.md5_hh(a, i, n, r, t[s + 12], 11, -421815835),
                            r = this.md5_hh(r, a, i, n, t[s + 15], 16, 530742520), n = this.md5_hh(n, r, a, i, t[s + 2], 23, -995338651),
                            i = this.md5_ii(i, n, r, a, t[s + 0], 6, -198630844), a = this.md5_ii(a, i, n, r, t[s + 7], 10, 1126891415),
                            r = this.md5_ii(r, a, i, n, t[s + 14], 15, -1416354905), n = this.md5_ii(n, r, a, i, t[s + 5], 21, -57434055),
                            i = this.md5_ii(i, n, r, a, t[s + 12], 6, 1700485571), a = this.md5_ii(a, i, n, r, t[s + 3], 10, -1894986606),
                            r = this.md5_ii(r, a, i, n, t[s + 10], 15, -1051523), n = this.md5_ii(n, r, a, i, t[s + 1], 21, -2054922799),
                            i = this.md5_ii(i, n, r, a, t[s + 8], 6, 1873313359), a = this.md5_ii(a, i, n, r, t[s + 15], 10, -30611744),
                            r = this.md5_ii(r, a, i, n, t[s + 6], 15, -1560198380), n = this.md5_ii(n, r, a, i, t[s + 13], 21, 1309151649),
                            i = this.md5_ii(i, n, r, a, t[s + 4], 6, -145523070), a = this.md5_ii(a, i, n, r, t[s + 11], 10, -1120210379),
                            r = this.md5_ii(r, a, i, n, t[s + 2], 15, 718787259), n = this.md5_ii(n, r, a, i, t[s + 9], 21, -343485551),
                            i = this.safe_add(i, o), n = this.safe_add(n, l), r = this.safe_add(r, h), a = this.safe_add(a, u);
                    }
                    return [i, n, r, a];
                }, t.prototype.md5_cmn = function (t, e, i, n, r, a) {
                    return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e, t), this.safe_add(n, a)), r), i);
                }, t.prototype.md5_ff = function (t, e, i, n, r, a, s) {
                    return this.md5_cmn(e & i | ~e & n, t, e, r, a, s);
                }, t.prototype.md5_gg = function (t, e, i, n, r, a, s) {
                    return this.md5_cmn(e & n | i & ~n, t, e, r, a, s);
                }, t.prototype.md5_hh = function (t, e, i, n, r, a, s) {
                    return this.md5_cmn(e ^ i ^ n, t, e, r, a, s);
                }, t.prototype.md5_ii = function (t, e, i, n, r, a, s) {
                    return this.md5_cmn(i ^ (e | ~n), t, e, r, a, s);
                }, t.prototype.safe_add = function (t, e) {
                    var i = (65535 & t) + (65535 & e);
                    return (t >> 16) + (e >> 16) + (i >> 16) << 16 | 65535 & i;
                }, t.prototype.bit_rol = function (t, e) {
                    return t << e | t >>> 32 - e;
                }, t;
            }())();
            i.default = n;
        }, {}],
        327: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./sdkConstants"), a = t("./sdkBase"), s = {
                LOGIN: "login",
                NO_LOGIN: "no_login",
                REWARD: "reward",
                PURCHASE: "purchase",
                USE: "use",
                MISSION_START: "mission_start",
                MISSION_COMPLETE: "mission_complete",
                MISSION_FAIL: "mission_fail"
            }, o = "show_fgui", l = "clear_fgui", h = "push_buffer", u = "set_user_id", c = "get_friend_data", d = "update_user_info", _ = "hide_rank";
            function f(t, e) {
                var i = wx.getSystemInfoSync();
                t.width = e.width || i.screenWidth, t.height = e.height || 0, t.left = e.x || 0,
                    t.top = i.screenHeight - (e.y || 0), console.log("============== initStyle ", JSON.stringify(e), t.width, t.height, t.top, t.left);
            }
            function p(t, e) {
                t.top = e.top, t.left = e.left, t.width = e.width, t.height = e.height;
            }
            var m = function (t) {
                function e() {
                    return null !== t && t.apply(this, arguments) || this;
                }
                return r(e, t), e.prototype._create = function () {
                    var t = this, i = n.default.BANNERAD_NAME_UNITIDS[this._name];
                    if (!i || Array.isArray(i) && 0 === i.length) return console.warn("no banner ad unitid at place with name :: ", this._name),
                        null;
                    if (Array.isArray(i)) {
                        var r = (e._loadIndexMap[this._name] || 0) + 1;
                        e._loadIndexMap[this._name] = r, i = i[(r - 1) % i.length];
                    }
                    console.log("show banner with id ::: ", i);
                    var a = {
                        top: 0,
                        left: 0,
                        width: 0,
                        height: 0
                    };
                    f(a, this._rect);
                    var s = wx.createBannerAd({
                        adUnitId: i,
                        style: {
                            left: a.left,
                            top: a.top,
                            width: a.width,
                            height: a.height
                        }
                    });
                    return s.onResize(function (e) {
                        if (console.log("wx.bannerAd.onResize================>>>>>>>>>>>>>", e), t._style) {
                            var i = t._style;
                            return t._style = null, p(s.style, i);
                        }
                        s.style.top = a.top - e.height;
                        var n = t._rect;
                        if (n.height && e.height > n.height && e.width > 300) {
                            s.style.top = a.top - a.height;
                            var r = Math.max(300, e.width / e.height * n.height);
                            s.style.left = a.left + (a.width - r) / 2, s.style.width = r, s.style.height = a.height;
                        }
                    }), s.onLoad(function (e) {
                        console.log("=========== banner onloaded ::: ", i), t._onLoad();
                    }), s.onError(function (e, i) {
                        t._onError({
                            errMsg: e,
                            errCode: i
                        });
                    }), s;
                }, e.prototype._adjust = function (t, e) {
                    var i = {
                        top: 0,
                        left: 0,
                        width: 0,
                        height: 0
                    };
                    f(i, this._rect);
                    var n = t.style;
                    n.width === i.width && n.height === i.height || (n.width === i.width ? (n.width > 300 ? n.width -= 10 : n.width += 10,
                        this._style = i) : p(n, i));
                }, e.prototype._clear = function () {
                    this._banner.hide(), this._banner.destroy(), this._banner = null;
                }, e.prototype._show = function (t) {
                    t.show();
                }, e.prototype._hide = function (t) {
                    t.hide();
                }, e._loadIndexMap = {}, e;
            }(a.Banner), g = new (function (t) {
                function e() {
                    var e = t.call(this, m) || this;
                    return e._supportShortModeVibrate = 0, e._timeoutReqeustIndex = 0, e._timeoutReqeustHandle = {},
                        e._loadedVideoAdName = null, e._videoAdInstance = null, e._insertAdInstance = {},
                        e._videoAdLoadCallback = null, e._videoAdErrorCallback = null, e._videoAdCloseCallback = null,
                        e._cloudStorageInited = !1, e._followStatus = a.FollowStatus.UNKNOWN, e._shareEndHandler = null,
                        e._shareTime = 0, e._shareFailHanle = null, e._eolinkToken = null, e._eolinkUid = "",
                        e._eolinkCid = null, e._eolinkUserData = null, e._eolinkMoregame2Resp = null, e._moreGameInfos = null,
                        e._gameClubButton = null, e._gameClubButtonTab = null, e._gameClubBinder = null,
                        e._gameClubVisible = !0, e._userButtonHides = {}, e._userUnionId = null, e._isAuthorize = !1,
                        e._launchdata = null, e._shareFlag = !0, e._loadVideoTimeOutId = null, e._videoIndexMap = {},
                        e._renderTaskStack = [], e._currentRenderTask = null, e;
                }
                return r(e, t), e.prototype.getPlatform = function () {
                    return "wx";
                }, e.prototype.getSupportSoundType = function () {
                    return "mp3";
                }, e.prototype.getDefaultPng = function () {
                    return n.default.DEBUG ? "sdk_res/white.png" : "sdk_res/black.png";
                },
                    e.prototype.isIphoneX = function () {
                        // var t = wx.getSystemInfoSync();
                        // try {
                        //     var e = t.model;
                        //     if (e && /\biphone\s*(x|1[1-9])/i.test(e)) return !0;
                        // } catch (t) {
                        //     return !1;
                        // }
                        return !1
                    },
                    e.prototype.isIpad = function () {
                        // var t = wx.getSystemInfoSync();
                        // try {
                        //     var e = t.model;
                        //     if (e && e.match(new RegExp("^iPad.*$"))) return !0;
                        // } catch (t) {
                        //     return !1;
                        // }
                        return !1
                    },

                    e.prototype.getDevice = function () {
                        return null
                        // return "wx.getSystemInfoSync().platform";
                    }, e.prototype.supportMoregames = function () {
                        var t = wx.getSystemInfoSync().system;
                        return (!t || -1 === t.indexOf("iOS")) && this._checkSDKVersion("2.2.0");
                    }, e.prototype.supportPlayerCenter = function () {
                        return this._checkSDKVersion("2.0.3");
                    }, e.prototype.supportShare = function () {
                        return !0;
                    }, e.prototype.supportBannerAd = function () {
                        // return !(wx.getSystemInfoSync().screenWidth <= 325) && !!this._checkSDKVersion("2.0.4");
                    }, e.prototype.supportVideoAd = function () {
                        // return this._checkSDKVersion("2.0.4");
                    }, e.prototype.supportInsertAd = function () {
                        // return this._checkSDKVersion("2.6.0");
                    }, e.prototype.supportCollection = function () {
                        return !0;
                    }, e.prototype.supportRanking = function () {
                        return !0;
                    }, e.prototype.getLoginTypes = function () {
                        return n.default.EOLINK_APP ? ["mjp", "platform", "eolink"] : ["mjp", "platform"];
                    }, e.prototype.supportPreviewImage = function () {
                        return !!wx.previewImage;
                    }, e.prototype.supportReward = function () {
                        return !0;
                    }, e.prototype.getLoginType = function () {
                        return "mjp";
                    }, e.prototype.loginWithType = function (t, e, i, n) {
                        console.log("这里？？？？？？")
                        var r = this;
                        switch (t) {
                            case "platform":
                                // wx.login({
                                //     success: function(t) {
                                //         t.code ? (console.warn("微信登陆成功::" + t.code), e && e(t.code, {})) : (console.warn("微信登陆失败::" + t.errMsg), 
                                //         i && i("微信登陆失败"));
                                //     },
                                //     fail: function(t) {
                                //         console.warn("微信登陆失败::" + t.toString()), i && i("微信登陆失败");
                                //     }
                                // });
                                break;

                            case "eolink":
                                if (this._eolinkToken) return;
                                // wx.login({
                                //     success: function(t) {
                                //         if (t.code) {
                                //             var n = r.getLaunchData(), a = null;
                                //             if (n.scene) {
                                //                 var s = decodeURIComponent(n.scene), o = new RegExp("(^|&)cid=([^&]*)(&|$)"), l = s.match(o);
                                //                 null != l && (a = unescape(l[2]));
                                //             } else a = n.cid;
                                //             console.log("====================== eolink login::: ", a), a = a || "", r._eolinkCid = a, 
                                //             r.EOLinkLogin(t.code, a, e, i);
                                //         } else console.warn("微信登陆失败::" + t.errMsg), i && i("微信登陆失败");
                                //     },
                                //     fail: function(t) {
                                //         console.warn("微信登陆失败::" + t.toString()), i && i("微信登陆失败");
                                //     }
                                // });
                                break;

                            case "mjp":
                                // wx.login({
                                //     success: function(t) {
                                //         if (t.code) {
                                //             var n = wx.getLaunchOptionsSync(), a = {};
                                //             if (n.referrerInfo && n.referrerInfo.extraData) for (var s in n.referrerInfo.extraData) n.referrerInfo.extraData.hasOwnProperty(s) && (a[s] = n.referrerInfo.extraData[s]);
                                //             if (n.query.scene && "string" == typeof n.query.scene) for (var o = n.query.scene, l = 0, h = (o = decodeURIComponent(o)).substr(o.lastIndexOf("?") + 1, o.length).split("&"); l < h.length; l++) {
                                //                 var u = h[l];
                                //                 if (u) {
                                //                     var c = u.split("=");
                                //                     a[c[0]] = c[1];
                                //                 }
                                //             }
                                //             if (n.query) for (var s in n.query) n.query.hasOwnProperty(s) && (a[s] = n.query[s]);
                                //             n.referrerInfo && n.referrerInfo.appId && (a.appId = n.referrerInfo.appId), n.scene && (a.wx_scene = n.scene), 
                                //             void 0 === a.share_img && (a.share_img = ""), void 0 === a.share_source ? a.share_source = 0 : a.share_source = parseInt(a.share_source), 
                                //             a.version = r._appVersion;
                                //             var d = JSON.stringify(a);
                                //             console.log("====================== launchOpts Info:::", n), console.log("====================== mjp login::: ", d), 
                                //             r.MJPLogin(t.code, {
                                //                 qrvalue: d
                                //             }, e, i);
                                //         } else console.warn("微信登陆失败::" + t.errMsg), i && i("微信登陆失败");
                                //     },
                                //     fail: function(t) {
                                //         console.warn("微信登陆失败::" + t.toString()), i && i("微信登陆失败");
                                //     }
                                // });
                                break;

                            default:
                                console.warn("unkonw login type with ::: ", t, new Error().stack);
                        }
                    }, e.prototype.getFollowStatus = function () {
                        return this._followStatus;
                    }, e.prototype.setUserId = function (e) {
                        t.prototype.setUserId.call(this, e), this._postMessageToShareData(u, {
                            userId: e
                        });
                    }, e.prototype.checkPubAccountState = function (t) {
                        var e = this;
                        this._userUnionId ? this._accesstoken ? this.MJPLoginByLoginToken(function (e) {
                            t(6 === e.status);
                        }, function (e) {
                            console.log("login bylogintoken fail!!!", e), t(!1);
                        }) : this.loginWithType("mjp", function (e, i) {
                            t(6 === i.status);
                        }, function (e) {
                            console.log("login fail!!!", e), t(!1);
                        }) : this.getUserInfo(function (i, n) {
                            console.log("getUserInfo >>>>>>>>>>>>> ", n), e.MJPCommitAuthorize(i, n, function () {
                                if (e._userUnionId) return e.checkPubAccountState(t);
                                console.log("commit success without user union id"), t(!1);
                            }, function () {
                                console.log("上报玩家授权信息失败: "), t(!1);
                            });
                        }, function (e) {
                            console.log("获取玩家授权信息失败: ", e), t(!1);
                        });
                    }, e.prototype.isMjpAuthorized = function () {
                        return this._isAuthorize;
                    }, e.prototype.onCommitMjpUserInfo = function (t, e) {
                        var i = this;
                        this.getUserInfo(function (e, n) {
                            if (i._isAuthorize) return console.log("commit success without user union id"),
                                t && t(n.userInfo);
                            console.log("getUserInfo >>>>>>>>>>>>> ", n), i.MJPCommitAuthorize(e, n, function () {
                                i._isAuthorize = !0, console.log("上报玩家授权信息成功: ");
                            }, function () {
                                console.log("上报玩家授权信息失败: ");
                            }), i.setPlayerInfo({
                                nickName: n.userInfo.nickName,
                                avatarUrl: n.userInfo.avatarUrl,
                                gender: n.userInfo.gender
                            }), t && t(n.userInfo);
                        }, function (t) {
                            console.log("获取玩家授权信息失败: ", t), e && e(t);
                        });
                    }, e.prototype.onUserNoLogin = function () {
                        // wx.aldSendEvent(s.NO_LOGIN, {
                        //     ct: "NA"
                        // });
                    }, e.prototype.onUserLogin = function (t, e, i, n, r, a) {
                        // wx.aldSendEvent(s.LOGIN, {
                        //     accId: t,
                        //     accNm: e,
                        //     lvl: void 0 === i ? "NA" : i.toString(),
                        //     gsvr: void 0 === n ? "NA" : n,
                        //     age: void 0 === r ? "NA" : r.toString(),
                        //     gendr: void 0 === a ? "NA" : a.toString()
                        // });
                    }, e.prototype.onCollectionTraffic = function () {
                        var t = wx.getLaunchOptionsSync();
                        if (!t) return console.warn("wx.getLaunchOptionsSync failed"), null;
                        var e = {
                            campaign: "",
                            medium: "",
                            source: "",
                            content: "",
                            term: ""
                        };
                        if (t.query && (t.query.utm_campaign && (e.campaign = t.query.utm_campaign), t.query.utm_medium && (e.medium = t.query.utm_medium),
                            t.query.utm_source && (e.source = t.query.utm_source), t.query.utm_content && (e.content = t.query.utm_content),
                            t.query.utm_term && (e.term = t.query.utm_term)), t.referrerInfo && t.referrerInfo.extraData && t.referrerInfo.extraData.utm) for (var i = 0, n = Object.keys(e); i < n.length; i++) {
                                var r = n[i];
                                t.referrerInfo.extraData.utm.hasOwnProperty(r) && (e[r] += t.referrerInfo.extraData.utm[r]);
                            }
                        if ("" === e.campaign && (e.campaign = "NoCampaign"), "" === e.medium && (e.medium = "NoMedium"),
                            "" === e.source && (t.referrerInfo && t.referrerInfo.appId ? e.source = t.referrerInfo.appId : e.source = "NoSource"),
                            "" === e.content) if (t.scene) switch (t.scene) {
                                case 1020:
                                    e.content = "OfficialProfileApps";
                                    break;

                                case 1035:
                                    e.content = "OfficialCustomMenu";
                                    break;

                                case 1036:
                                    e.content = "AppShareCard";
                                    break;

                                case 1037:
                                    e.content = "AppToApp";
                                    break;

                                case 1038:
                                    e.content = "BackToApp";
                                    break;

                                case 1043:
                                    e.content = "OfficialTemplate";
                                    break;

                                default:
                                    e.content = "UnknownScene" + t.scene;
                            } else e.content = "NoContent";
                        "" === e.term && (e.term = "NoTerm");
                        var a = {};
                        return a["c" + e.campaign] = e.medium + "_" + e.source + "_" + e.content + "_" + e.term,
                            this.onCollectionEvent("traffic", a), e;
                    }, e.prototype.onCollectionReward = function (t, e) {
                        // wx.aldSendEvent(s.REWARD, {
                        //     rewd: t.toString(),
                        //     reasn: void 0 === e ? "NA" : e
                        // });
                    }, e.prototype.onCollectionPurchase = function (t, e, i) {
                        // wx.aldSendEvent(s.PURCHASE, {
                        //     iName: t,
                        //     iNum: e.toString(),
                        //     cost: i.toString()
                        // });
                    }, e.prototype.onCollectionUse = function (t, e) {
                        // wx.aldSendEvent(s.USE, {
                        //     iName: t,
                        //     iNum: e.toString()
                        // });
                    }, e.prototype.onCollectionMissionStart = function (t) {
                        // wx.aldSendEvent(s.MISSION_START, {
                        //     mName: t
                        // });
                    }, e.prototype.onCollectionMissionComplete = function (t) {
                        // wx.aldSendEvent(s.MISSION_COMPLETE, {
                        //     mName: t
                        // });
                    }, e.prototype.onCollectionMissionFail = function (t, e) {
                        // wx.aldSendEvent(s.MISSION_FAIL, {
                        //     mName: t,
                        //     reasn: void 0 === e ? "NA" : e
                        // });
                    }, e.prototype.onCollectionEvent = function (t, e) {
                        for (var i in s) {
                            if (s.hasOwnProperty(i)) t === s[i] && console.warn("onCollectionEvent should not use built-in key:", t);
                        }
                        // wx.aldSendEvent(t, e);
                    }, e.prototype.updateRankInfo = function (t, e, i, n, r) {
                        n = n || 1, r = r || 0;
                        var a = {
                            wxgame: {
                                score: e,
                                update_time: Math.floor(new Date().getTime() / 1e3)
                            }
                        };
                        for (var s in (i = i || {}).hasOwnProperty("lid") || (i.lid = this.getUserId()),
                            i) i.hasOwnProperty(s) && (a[s] = i[s]);
                        this._postMessageToShareData(d, {
                            itemKey: t,
                            val: a,
                            order: n,
                            timeMode: r
                        });
                    }, e.prototype.getRankInfo = function (t, e, i) {
                        var n = {
                            itemKey: t,
                            keyList: [t],
                            isReverse: e,
                            timeMode: i,
                            lid: this.getUserId()
                        };
                        this._postMessageToShareData(c, n);
                    }, e.prototype.isShowRank = function (t) {
                        void 0 === t && (t = !1), this._postMessageToShareData(_, t);
                    },

                    e.prototype.setShareInfoCallback = function (t) {
                        // var e = this;
                        // (wx.aldOnShareAppMessage ? wx.aldOnShareAppMessage : wx.onShareAppMessage)(function() {
                        //     var i = t(), n = i.title, r = i.imageUrl, a = i.query;
                        //     a = a || {};
                        //     var s = r.lastIndexOf("/"), o = -1 != s ? r.substring(s + 1, r.length) : "";
                        //     a.share_img = o, void 0 !== a.source ? a.share_source = a.source : a.share_source = 0, 
                        //     e.mjpAudible("share", [ 2, e._isNewUser, e.getUserId(), o, a.share_source ].join("|"));
                        //     var l = e._parseQueryString(a);
                        //     return console.log("=================", n, r, l), {
                        //         title: n,
                        //         imageUrl: r,
                        //         query: l
                        //     };
                        // });
                    },


                    e.prototype.showMoreGames = function () {
                        // wx.navigateToMiniProgram({
                        //     appId: "wx186ea3e4859d2806",
                        //     path: "pages/index/index",
                        //     extraData: {},
                        //     fail: function(t) {
                        //         console.warn("wx.navigateToMiniProgram=================== fail", t);
                        //     }
                        // });
                    }, e.prototype.getMoreGames = function (t) {

                        // var e = this;
                        // if (!this._moreGameInfos) if (n.default.EOLINK_APP) {
                        //     var i = "https://gamebix.oss-cn-shenzhen.aliyuncs.com/chouti_" + n.default.EOLINK_APP + "/";
                        //     this.adapter.http_request(i + n.default.EOLINK_APP + ".json?timestamp=" + new Date().getTime(), null, "GET", "json", function(n) {
                        //         console.log(">>>>>>>>>>+============= ", n);
                        //         var r = null;
                        //         n.hotPat && (r = "ios" === e.getDevice() ? n.hotPat[1] && n.hotPat[1].data : n.hotPat[2] && n.hotPat[2].data), 
                        //         r && Array.isArray(r) && r.length > 0 && (e._moreGameInfos = r.map(function(t) {
                        //             return {
                        //                 id: t.id,
                        //                 mod: t.mod,
                        //                 appid: t.appid,
                        //                 path: 0 === t.mod ? t.path : "",
                        //                 previewUrl: 0 !== t.mod ? i + t.path : void 0,
                        //                 imgUrl: i + t.imgUrl,
                        //                 name: t.name,
                        //                 from: a.MoreGameFrom.EOLINK,
                        //                 red: !0
                        //             };
                        //         }), t(e._moreGameInfos));
                        //     }, function() {
                        //         e.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.GET_MORE_GAME);
                        //     });
                        // } else this.getMJPConfig("moregames", function(i) {
                        //     if (!i || !Array.isArray(i) || i.length <= 0) return console.warn("moregames config is not a valide list value");
                        //     e._moreGameInfos = i.map(function(t) {
                        //         return {
                        //             id: t.id,
                        //             appid: t.appid,
                        //             path: t.path,
                        //             imgUrl: t.imgUrl,
                        //             name: t.name,
                        //             previewUrl: t.previewUrl,
                        //             extra: t.extra,
                        //             from: a.MoreGameFrom.MJP,
                        //             mod: t.mod || 0,
                        //             red: 0 != t.red
                        //         };
                        //     }), t(e._moreGameInfos);
                        // }, function() {
                        //     e.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.GET_MORE_GAME);
                        // });
                    },

                    e.prototype.getMoreGame2 = function (t) {
                        var e = this;
                        n.default.EOLINK_APP && (this._eolinkMoregame2Resp ? t && t(this.getEOLinkNextGameInfo()) : this.getEOLinkMoreGame2(function () {
                            t && t(e.getEOLinkNextGameInfo());
                        }));
                    }, e.prototype.showGameWithInfo = function (t) {
                        var e = this;
                        if (0 === t.mod) {
                            var i = null;
                            t.from === a.MoreGameFrom.EOLINK && -1 != t.path.search(new RegExp("(^|&)?reJ=([^&]*)(&|$)")) && ((i = n.default.EOLINK_APP + this._eolinkUid + Math.round(new Date().getTime() / 1e3) + "").length > 25 && (i = i.substr(i.length - 25, i.length)),
                                t.path += "&ad_id=" + i), this.skipToGame(t.appid, t.path, t.extra || {}, function (n) {
                                    console.log("wx.navigateToMiniProgram successed"), t.red = !1, e.adapter.emit_event(a.SDKEvent.MORE_GAME_INFO_FRESH),
                                        t.from === a.MoreGameFrom.EOLINK && (t.distid && (i ? e.EOLinkTransformStatis(t.distid, t.appid, i) : e.EOLinkTransformStatis(t.distid)),
                                            e.EOLinkAdStatis(t.distid || t.appid)), e._mjpCollection(a.MJPCollectionType.GOTO, {
                                                from: t.from,
                                                appId: t.appid,
                                                path: t.path,
                                                isSuccess: 1,
                                                method: 1
                                            });
                                }, function (i) {
                                    console.warn("wx.navigateToMiniProgram=================== fail", i), e._mjpCollection(a.MJPCollectionType.GOTO, {
                                        from: t.from,
                                        appId: t.appid,
                                        path: t.path,
                                        isSuccess: 0,
                                        method: 1
                                    });
                                });
                        } else t.previewUrl && this.previewImage([t.previewUrl], t.previewUrl, function (i) {
                            console.log("prev successed"), t.red = !1, e.adapter.emit_event(a.SDKEvent.MORE_GAME_INFO_FRESH),
                                t.from === a.MoreGameFrom.EOLINK && e.EOLinkAdStatis(t.appid), e._mjpCollection(a.MJPCollectionType.GOTO, {
                                    from: t.from,
                                    appId: t.appid,
                                    path: "",
                                    isSuccess: 1,
                                    method: 2
                                });
                        }, function () {
                            e._mjpCollection(a.MJPCollectionType.GOTO, {
                                from: t.from,
                                appId: t.appid,
                                path: "",
                                isSuccess: 0,
                                method: 2
                            });
                        });
                    }, e.prototype.loadVideoAd = function (t, e, i) {
                        // var r = this, s = n.default.VIDEOAD_NAME_UNITIDS[t];
                        // if (s && Array.isArray(s)) {
                        //     var o = s.length;
                        //     if (o <= 0) s = null; else {
                        //         var l = this._videoIndexMap[t] || 0;
                        //         s = s[l % o], this._videoIndexMap[t] = l + 1;
                        //     }
                        // }
                        // if (!s) return i && i("当前没有可用的视频");
                        // this._videoAdInstance && this.destroyVideoAd(), null != this._loadVideoTimeOutId && clearTimeout(this._loadVideoTimeOutId), 
                        // this._loadVideoTimeOutId = setTimeout(function() {
                        //     // r.destroyVideoAd(), r._loadVideoTimeOutId = null, r.mjpAudible(a.MJPCollectionType.LOADVIDEOAD, [ r._loadedVideoAdName, 0 ].join("|")), 
                        //     // i && i("视频加载失败");
                        // }, 5e3),
                        //  this._videoAdInstance = wx.createRewardedVideoAd({
                        //激励？s
                        // adUnitId: s
                        // }),
                        //  this._loadedVideoAdName = t, this._videoAdLoadCallback = function() {
                        //     for (var t = [], i = 0; i < arguments.length; i++) t[i] = arguments[i];
                        //     console.log("---------------- load VideoAd success", t), null != r._loadVideoTimeOutId && (clearTimeout(r._loadVideoTimeOutId), 
                        //     r._loadVideoTimeOutId = null), r.mjpAudible(a.MJPCollectionType.LOADVIDEOAD, [ r._loadedVideoAdName, 1 ].join("|")), 
                        //     e && e();
                        // }, this._videoAdErrorCallback = function() {
                        //     for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                        //     console.warn("---------------- load VideoAd error", t), r.destroyVideoAd(), null != r._loadVideoTimeOutId && (clearTimeout(r._loadVideoTimeOutId), 
                        //     r._loadVideoTimeOutId = null), r.mjpAudible(a.MJPCollectionType.LOADVIDEOAD, [ r._loadedVideoAdName, 0 ].join("|")), 
                        //     i && i("视频加载失败", t);
                        // }
                        // this._videoAdInstance.load().then(function() {
                        //     for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                        //     r._videoAdLoadCallback && r._videoAdLoadCallback.apply(null, t);
                        // }).catch(function() {
                        //     for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                        //     r._videoAdErrorCallback && r._videoAdErrorCallback.apply(null, t);
                        // });
                    }, e.prototype.showVideoAd = function (t, e) {

                        // var i, n, r = this;
                        // if (!this._videoAdInstance) return e && e("当前没有可用的视频");
                        // this._videoAdCloseCallback && this._videoAdInstance.offClose(this._videoAdCloseCallback), 
                        // t && (i = function() {
                        //     r.adapter.call_in_next_frame(r, t);
                        // }), e && (n = function(t) {
                        //     r.adapter.call_in_next_frame(r, e, [ t ]);
                        // }), this._videoAdErrorCallback = function() {
                        //     for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                        //     console.warn("---------------- show VideoAd error", t), n && n("视频播放失败");
                        // }, this._videoAdCloseCallback = function(t) {
                        //     console.warn("---------------- show VideoAd close", t), r.adapter.emit_event(a.SDKEvent.VIDEO_SHOW_ENDED), 
                        //     void 0 === t || !0 === t.isEnded ? (i && i(), r._mjpCollection(a.MJPCollectionType.VIDEOAD, {
                        //         adType: r._loadedVideoAdName,
                        //         bSuccess: 1
                        //     })) : (n && n("视频未播放完毕"), r._mjpCollection(a.MJPCollectionType.VIDEOAD, {
                        //         adType: r._loadedVideoAdName,
                        //         bSuccess: 0
                        //     }));
                        // }, this._videoAdInstance.onClose(this._videoAdCloseCallback), this.adapter.emit_event(a.SDKEvent.VIDEO_SHOW_START), 
                        // this._videoAdInstance.show().then().catch(function() {
                        //     for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                        //     r._videoAdCloseCallback && r._videoAdCloseCallback.apply(null, t);
                        // });
                    }, e.prototype.destroyVideoAd = function () {
                        // this._videoAdInstance && (this._videoAdLoadCallback = null, this._videoAdErrorCallback = null, 
                        // this._videoAdCloseCallback && (this._videoAdInstance.offClose(this._videoAdCloseCallback), 
                        // this._videoAdCloseCallback = null), this._videoAdInstance = null);
                    }, e.prototype.deviceVibrate = function (t) {
                        // void 0 === t && (t = !this.supportShortModeVibrate()), t ? wx.vibrateLong() : wx.vibrateShort();
                    }, e.prototype.getLaunchData = function () {
                        // var t = this._launchdata;
                        // t || (this._launchdata = t = wx.getLaunchOptionsSync());
                        // var e = t && t.query || {};
                        // if (t) {
                        //     var i = -1 !== [ 1103, 1104 ].indexOf(t.scene);
                        //     !i && this._checkSDKVersion("2.2.4") && (i = 1001 === t.scene), e.fromMini = i, 
                        //     e.wx_scene = t.scene;
                        // }
                        return null//e;
                    }, e.prototype.shareInfo = function (t, e, i, n, r, a, s) {
                        var o = this;
                        i = i || {};
                        var l = e.lastIndexOf("/"), h = -1 != l ? e.substring(l + 1, e.length) : "";
                        i.share_img = h, void 0 !== i.source ? i.share_source = i.source : i.share_source = 0,
                            this.mjpAudible("share", [1, this._isNewUser, this.getUserId(), h, i.share_source].join("|"));
                        var u, c, d, _ = {
                            title: t,
                            imageUrl: e,
                            query: this._parseQueryString(i),
                            success: void 0,
                            fail: void 0,
                            cancel: void 0
                        };
                        n && (u = function () {
                            o.adapter.call_in_next_frame(o, n);
                        }), r && (c = function (t) {
                            o.adapter.call_in_next_frame(o, r, [t]);
                        }), a && (d = function () {
                            o.adapter.call_in_next_frame(o, a);
                        }), s = s || 1e3, this._shareTime = new Date().getTime(), this._shareEndHandler = function () {
                            o._shareEndHandler = null;
                            var t = new Date().getTime() - o._shareTime;
                            console.log("================== share info cost time ::::: " + t + " (ms) ====================== "),
                                t > 3500 ? u && u() : c && c("分享失败，请重试");
                        }, _.success = function (t) {
                            o._shareEndHandler = null, console.log("==================== >>>> ", t), u && u();
                        }, _.fail = function () {
                            o._shareEndHandler = null, console.log("==================== >>>> fail"), c && c("分享失败");
                        }, _.cancel = function () {
                            o._shareEndHandler = null, console.log("==================== >>>> cancel"), c && c("分享取消");
                        }, this._shareFailHanle = setTimeout(function () {
                            o._shareFailHanle = null, o._shareEndHandler = null, wx.hideLoading({}), console.warn("==================== >>>> 调用分享失败");
                            var t = d || c;
                            t && t("调用分享失败");
                        }, s), wx.showLoading({
                            title: "",
                            mask: !0
                        }), (wx.aldShareAppMessage ? wx.aldShareAppMessage : wx.shareAppMessage)(_);
                    }, e.prototype.shareInfoReal = function (t, e, i, n, r, a, s) {
                        var o = this;
                        i = i || {};
                        var l = e.lastIndexOf("/"), h = -1 != l ? e.substring(l + 1, e.length) : "";
                        i.share_img = h, void 0 !== i.source ? i.share_source = i.source : i.share_source = 0,
                            this.mjpAudible("share", [1, this._isNewUser, this.getUserId(), h, i.share_source].join("|"));
                        var u, c, d, _ = {
                            title: t,
                            imageUrl: e,
                            query: this._parseQueryString(i),
                            success: void 0,
                            fail: void 0,
                            cancel: void 0
                        };
                        n && (u = function () {
                            o.adapter.call_in_next_frame(o, n);
                        }), r && (c = function (t) {
                            o.adapter.call_in_next_frame(o, r, [t]);
                        }), a && (d = function () {
                            o.adapter.call_in_next_frame(o, a);
                        }), s = s || 1e3, this._shareTime = new Date().getTime(), this._shareEndHandler = function () {
                            o._shareEndHandler = null;
                            var t = new Date().getTime() - o._shareTime;
                            (console.log("================== share info cost time ::::: " + t + " (ms) ====================== "),
                                o._shareFlag) ? t > 3500 ? Math.floor(100 * Math.random() + 1) > 30 ? u && u() : (o._shareFlag = !1,
                                    c && c("分享似乎没有成功，请重试")) : (o._shareFlag = !1, c && c("分享失败，请重试")) : (o._shareFlag = !0,
                                        t > 5e3 ? u && u() : c && c("分享失败，请重试"));
                        }, _.success = function (t) {
                            o._shareEndHandler = null, console.log("==================== >>>> ", t), u && u();
                        }, _.fail = function () {
                            o._shareEndHandler = null, console.log("==================== >>>> fail"), c && c("分享失败");
                        }, _.cancel = function () {
                            o._shareEndHandler = null, console.log("==================== >>>> cancel"), c && c("分享取消");
                        }, this._shareFailHanle = setTimeout(function () {
                            o._shareFailHanle = null, o._shareEndHandler = null, wx.hideLoading({}), console.warn("==================== >>>> 调用分享失败");
                            var t = d || c;
                            t && t("调用分享失败");
                        }, s), wx.showLoading({
                            title: "",
                            mask: !0
                        }), (wx.aldShareAppMessage ? wx.aldShareAppMessage : wx.shareAppMessage)(_);
                    }, e.prototype.createPlayerCenterIcon = function (t, e, i, n, r) {
                        var a = this;
                        if (wx.createGameClubButton) {
                            var s = {
                                left: r,
                                top: n,
                                width: t,
                                height: e
                            };
                            this._gameClubButton = wx.createGameClubButton({
                                type: "image",
                                image: i,
                                style: s
                            }), this._gameClubButton.onTap(function () {
                                a.onCollectionEvent("button", {
                                    button: "game_club"
                                });
                            });
                        }
                    }, e.prototype.showPlayerCenterIcon = function () {
                        this._gameClubVisible = !0, null !== this._gameClubButton && (this._gameClubBinder && !this._gameClubBinder.visible || this._gameClubButton.show());
                    }, e.prototype.hidePlayerCenterIcon = function () {
                        this._gameClubVisible = !1, null !== this._gameClubButton && this._gameClubButton.hide();
                    }, e.prototype.bindPlayerCenterIcon = function (t) {
                        var e = this;
                        if (wx.createGameClubButton) {
                            this._gameClubBinder && (this._gameClubBinder.onDestroy(), this._gameClubBinder = null,
                                this._gameClubButton = null, this._gameClubButtonTab = null);
                            var i = this.adapter.get_rect(t), n = a.ButtonBinder.bindNode(t), r = wx.createGameClubButton({
                                type: "image",
                                image: this.getDefaultPng(),
                                style: {
                                    left: i.x,
                                    top: i.y,
                                    width: i.width,
                                    height: i.height,
                                    backgroundColor: "#00000000",
                                    borderColor: "#00000000",
                                    borderWidth: 0,
                                    borderRadius: 0,
                                    textAlign: "center",
                                    fontSize: 20,
                                    lineHeight: 30
                                }
                            });
                            this._gameClubButtonTab = function (t) {
                                e.onCollectionEvent("button", {
                                    button: "game_club"
                                }), n.onTap();
                            }, r.onTap(this._gameClubButtonTab), n.onButtonShow(function () {
                                this._gameClubVisible && r.show();
                            }.bind(this)), n.onButtonHide(function () {
                                r.hide();
                            }), n.onButtonDestroy(function () {
                                n.offButtonShow(), n.offButtonHide(), n.offButtonDestroy(), r.offTap(this._gameClubButtonTab),
                                    this._gameClubButtonTab = null, this._gameClubButton = null, this._gameClubBinder = null,
                                    r.destroy();
                            }.bind(this)), !n.visible && this._gameClubVisible && r.hide(), this._gameClubButton = r,
                                this._gameClubBinder = n;
                        }
                    }, e.prototype.bindUserInfoIcon = function (t, e) {
                        // var i = this;
                        // wx.createUserInfoButton && (this.isMjpAuthorized() || this.checkUserInfoScope(function(n) {
                        //     if (!n) {
                        //         var r = i.adapter.get_rect(t), s = a.ButtonBinder.bindNode(t, e), o = wx.createUserInfoButton({
                        //             type: "image",
                        //             image: i.getDefaultPng(),
                        //             style: {
                        //                 left: r.x,
                        //                 top: r.y,
                        //                 width: r.width,
                        //                 height: r.height,
                        //                 backgroundColor: "#00000000",
                        //                 borderColor: "#00000000",
                        //                 borderWidth: 0,
                        //                 borderRadius: 0,
                        //                 textAlign: "center",
                        //                 fontSize: 20,
                        //                 lineHeight: 30
                        //             },
                        //             withCredentials: !1,
                        //             lang: "zh_CN"
                        //         });
                        //         s.btnUserInfoTab = function(t) {
                        //             var e = !t.userInfo;
                        //             i.onCollectionEvent("button", {
                        //                 button: "cancel"
                        //             }), e || (a.ButtonBinder.binderArr.forEach(function(t, e) {
                        //                 t.binder.onDestroy();
                        //             }), a.ButtonBinder.binderArr = [], i.EOLinkAuthStatis()), i.adapter.emit_event(a.SDKEvent.AUTHORIZE_RESULT, !e), 
                        //             s.onTap(!e);
                        //         }, o.onTap(s.btnUserInfoTab), s.onButtonShow(function() {
                        //             this._userButtonHides[e] || o.show();
                        //         }.bind(i)), s.onButtonHide(function() {
                        //             o.hide();
                        //         }), s.onButtonDestroy(function() {
                        //             s.offButtonShow(), s.offButtonHide(), s.offButtonDestroy(), o.offTap(s.btnUserInfoTab), 
                        //             s.btnUserInfoTab = null, o.destroy();
                        //         }), s.visible && !i._userButtonHides[e] || o.hide();
                        //     }
                        // }));
                    }, e.prototype.showUserInfoIcon = function (t) {
                        var e = this;
                        t.forEach(function (t, i) {
                            e._userButtonHides[t] = !1;
                        }), a.ButtonBinder.binderArr.length < 1 || a.ButtonBinder.binderArr.forEach(function (e, i) {
                            -1 != t.indexOf(e.key) && e.binder.show();
                        });
                    }, e.prototype.hideUserInfoIcon = function (t) {
                        var e = this;
                        t.forEach(function (t, i) {
                            e._userButtonHides[t] = !0;
                        }), a.ButtonBinder.binderArr.length < 1 || a.ButtonBinder.binderArr.forEach(function (e, i) {
                            -1 != t.indexOf(e.key) && e.binder.hide();
                        });
                    }, e.prototype._loadSubpackage = function (t, e, i) {
                        // if (wx.loadSubpackage) {
                        //     var r = wx.loadSubpackage({
                        //         name: n.default.SUB_PACK_NAME,
                        //         success: function(e) {
                        //             console.log(" ------------ loadSubpackage success ------------ "), t && t();
                        //         },
                        //         fail: function(t) {
                        //             console.warn(" ------------ loadSubpackage fail ------------ "), e && e();
                        //         }
                        //     });
                        //     r && r.onProgressUpdate(function(t) {
                        //         i && i(t.progress);
                        //     });
                        // }


                        // else 

                        i && i(1), t && t();
                    }, e.prototype._tryLoadSubpakcage = function (t, e, i, n) {
                        var r = this;
                        t <= 0 ? i && i() : this._loadSubpackage(e, function () {
                            r._tryLoadSubpakcage(t - 1, e, i, n);
                        }, n);
                    }, e.prototype.exit = function () {
                        wx.exitMiniProgram({});
                    }, e.prototype.checkResources = function (t, e) {
                        if (!n.default.SUB_PACK_NAME || n.default.SUB_PACK_NAME.length <= 0) return console.log("================= no sub package resources path to load!!!"),
                            e && e(1), t && t();
                        this._tryLoadSubpakcage(3, t, function () {
                            wx.showModal({
                                title: "提示",
                                content: "资源更新失败，请检查网络后重试",
                                showCancel: !1,
                                confirmText: "确定",
                                success: function (t) {
                                    t.confirm && wx.exitMiniProgram({});
                                },
                                fail: function () { }
                            }, e);
                        });
                    },
                    e.prototype.getSafeArea = function () {
                        // var t = wx.getSystemInfoSync();
                        // if (!this.isProfiledScreen(t)) 
                        // return {
                        //     top: 0,
                        //     left: 0,
                        //     right: 0,
                        //     bottom: 0
                        // };
                        var e, i = t.statusBarHeight || 0;
                        if (i) return t.screenHeight > t.screenWidth ? {
                            top: i,
                            left: 0,
                            right: 0,
                            bottom: i
                        } : {
                                left: i,
                                top: 0,
                                bottom: 0,
                                right: i
                            };
                        if (t.screenHeight > t.screenWidth) {
                            if (t.screenHeight > 2 * t.screenWidth) return {
                                top: e = t.screenHeight / 2 - t.screenWidth,
                                left: 0,
                                right: 0,
                                bottom: e
                            };
                        } else if (t.screenWidth > 2 * t.screenHeight) return {
                            top: 0,
                            left: e = t.screenWidth / 2 - t.screenHeight,
                            right: e,
                            bottom: 0
                        };
                        return {
                            top: 0,
                            left: 0,
                            right: 0,
                            bottom: 0
                        };
                    },

                    e.prototype.skipToGame = function (t, e, i, n, r) {
                        (i = i || {}).gameId = this.gameId, wx.navigateToMiniProgram && wx.navigateToMiniProgram({
                            appId: t,
                            path: e,
                            extraData: i,
                            success: n,
                            fail: r
                        });
                    }, e.prototype.previewImage = function (t, e, i, n) {
                        wx.previewImage ? wx.previewImage({
                            urls: t,
                            current: e || t[0],
                            success: i,
                            fail: n
                        }) : n && n();
                    }, e.prototype._init = function () {
                        var e = this;
                        this._checkUpdate(null), this._checkAldEnable(),
                            // wx.onShow(function(t) {
                            //     console.log("---------------- wx.onShow::: ", t), e._launchdata = t, e._onShow(t), 
                            //     setTimeout(function() {
                            //         e._shareEndHandler && e._shareEndHandler();
                            //     }, 200);
                            // }), 
                            // wx.onHide(function() {
                            //     console.log("---------------- wx.onHide::: "), e._shareFailHanle && (wx.hideLoading({}), 
                            //     clearTimeout(e._shareFailHanle), e._shareFailHanle = null), e._onHide();
                            // }), 
                            // console.log("------------ init:::", wx.getSystemInfoSync()),


                            // wx.showShareMenu({
                            //     withShareTicket: !0,
                            //     success: function() {
                            //         console.log("wx.showShareMenu================success>>>>>>>>>>>>>");
                            //     },
                            //     fail: function() {
                            //         console.log("wx.showShareMenu================fail<<<<<<<<<<<<<<<<");
                            //     }
                            // }),


                            // this.isDebug && wx.setEnableDebug({
                            //     enableDebug: !0
                            // }), 



                            n.default.EOLINK_APP && this.loginWithType("eolink"), t.prototype._init.call(this);
                    }, e.prototype._checkAldEnable = function () {
                        n.default.ALD_ENABLE || (Object.defineProperty(wx, "aldSendEvent", {
                            value: function () {
                                for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                                console.log(">>>>>>>>>>>>>>>>>>>>> fake api:: wx.aldSendEvent");
                            },
                            writable: !1,
                            enumerable: !0,
                            configurable: !0
                        }), Object.defineProperty(wx, "aldOnShareAppMessage", {
                            value: function (t) {
                                console.log(">>>>>>>>>>>>>>>>>>>> fake api:: wx.aldOnShareAppMessage"), wx.updateShareMenu({
                                    withShareTicket: !0,
                                    complete: function () {
                                        console.log("<<<<<<<<<<<<<<<<<<<<< called api:: wx.onShareAppMessage"), wx.onShareAppMessage(t);
                                    }
                                });
                            },
                            writable: !1,
                            enumerable: !0,
                            configurable: !0
                        }), Object.defineProperty(wx, "aldShareAppMessage", {
                            value: function (t) {
                                return console.log(">>>>>>>>>>>>>>>>>>>> fake api:: wx.aldShareAppMessage"), console.log("<<<<<<<<<<<<<<<<<<<<< called api:: wx.shareAppMessage"),
                                    wx.shareAppMessage(t);
                            },
                            writable: !1,
                            enumerable: !0,
                            configurable: !0
                        }));
                    }, e.prototype._checkSDKVersion = function (t) {
                        // var e = wx.getSystemInfoSync();
                        // return e && this._parseVersionToCode(e.SDKVersion) >= this._parseVersionToCode(t);
                    }, e.prototype._parseVersionToCode = function (t) {
                        if (!t) return 0;
                        for (var e = t.split("."), i = 0, n = 0; e.length > 0;) n++, i += parseInt(e.pop(), 10) * Math.pow(100, n);
                        return i;
                    }, e.prototype.enterKefuSystem = function (t) {
                        wx.openCustomerServiceConversation(t);
                    }, e.prototype.saveImageToPhotosAlbum = function (t, e, i) {
                        wx.saveImageToPhotosAlbum({
                            filePath: t,
                            success: function (t) {
                                console.log("save img to photo success."), e && e();
                            },
                            fail: function () {
                                console.log("save img to photo fail."), i && i();
                            }
                        });
                    }, e.prototype.setClipboardData = function (t, e, i) {
                        wx.setClipboardData({
                            data: t,
                            success: function (i) {
                                console.log("setClipboardData success.", t), e && e();
                            },
                            fail: function () {
                                console.log("setClipboardData fail."), i && i();
                            }
                        });
                    },
                    e.prototype._checkUpdate = function (t) {
                        // if ("function" != typeof t && (t = function() {}), !wx.getUpdateManager) 
                        // return t({
                        //     fName: null,
                        //     value: "invalde sdk version"
                        // });
                        // var e = wx.getUpdateManager();
                        // e.onCheckForUpdate(function(e) {
                        //     t({
                        //         fName: "onCheckForUpdate",
                        //         value: e.hasUpdate
                        //     });
                        // }), 
                        // e.onUpdateReady(function() {
                        //     wx.showModal({
                        //         title: "提示",
                        //         content: "发现新版本，是否重启更新？",
                        //         showCancel: !1,
                        //         confirmText: "确定",
                        //         success: function(i) {
                        //             t({
                        //                 fName: "onUpdateReady",
                        //                 value: "success"
                        //             }), i.confirm && e.applyUpdate();
                        //         },
                        //         fail: function() {
                        //             t({
                        //                 fName: "onUpdateReady",
                        //                 value: "fail"
                        //             });
                        //         }
                        //     });
                        // }), 


                        // e.onUpdateFailed(function() {
                        //     t({
                        //         fName: "onUpdateFailed",
                        //         value: "showModal"
                        //     });
                        // });
                    }, e.prototype._parseQueryString = function (t) {
                        var e = [];
                        if (t) for (var i in t) t.hasOwnProperty(i) && (-1 !== ["campaign", "medium", "source", "content", "term"].indexOf(i) ? e.push("utm_" + i + "=" + t[i]) : e.push(i + "=" + t[i]));
                        return this._userId && e.push("lid=" + this._userId), e.join("&");
                    }, e.prototype._postMessageToShareData = function (t, e) {
                        var i = {
                            type: t,
                            params: e
                        };
                        wx.getOpenDataContext().postMessage(i);
                    }, e.prototype.EOLinkLogin = function (t, e, i, r) {
                        var s = this, o = "https://constellation.mamapai.net/user/login";
                        this.adapter.http_request(o, {
                            app: n.default.EOLINK_APP,
                            code: t,
                            cid: e || ""
                        }, "POST", "json", function (t) {
                            console.log("eolink login >>>>>>>>  response:::: ", t), 0 === t.code ? (s._eolinkToken = t.data && t.data.token || null,
                                s._eolinkUid = t.data && t.data.uid || "", i && i(null, t), s.getEOLinkUserData(),
                                s.EOLinkOpenStatis()) : (s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_LOGIN),
                                    r && r("http error::" + t.errorInfo));
                        }, function (t) {
                            s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_LOGIN),
                                console.warn("================ request error:::: " + o + " >>>>" + t), r && r("http error::" + t);
                        });
                    }, e.prototype.EOLinkAuthStatis = function () {
                        var t = this;
                        if (this._eolinkToken && this._eolinkCid) {
                            this.adapter.http_request("https://constellation.mamapai.net/user/update-user-info", {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken,
                                cid: this._eolinkCid
                            }, "POST", "json", function (t) {
                                console.log("授权上报", t);
                            }, function () {
                                t.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_AUTHSTATIS);
                            });
                        }
                    }, e.prototype.getEOLinkNextGameInfo = function () {
                        var t = this._eolinkMoregame2Resp;
                        return t && t.total ? t.seqSlot ? t.list[t.index++ % t.total] : t.list[Math.random() * t.total | 0] : null;
                    }, e.prototype.getEOLinkMoreGame2 = function (t) {
                        var e = this;
                        if (n.default.EOLINK_APP) {
                            var i = "https://gamebix.oss-cn-shenzhen.aliyuncs.com/", r = i + "Gif2End/" + n.default.EOLINK_APP + "_gif.json?timestamp=" + new Date().getTime();
                            this.adapter.http_request(r, null, "GET", "json", function (n) {
                                console.log(">>>>>>>>>>+============= ", n);
                                for (var r = {
                                    index: 0,
                                    total: 0,
                                    autoRefesh: !!n.autoRef,
                                    seqSlot: !!n.seqSlot,
                                    duration: n.bog || 0,
                                    playTimes: n.swTimes || -1,
                                    list: void 0
                                }, s = [], o = 0, l = n.data; o < l.length; o++) {
                                    var h = l[o], u = {
                                        isAnim: 1 == h.mod,
                                        distid: h.distid,
                                        appid: h.appid,
                                        name: h.name,
                                        path: h.path,
                                        interval: h.interval || 1,
                                        from: a.MoreGameFrom.EOLINK,
                                        mod: 0,
                                        duration: r.duration,
                                        playTimes: r.playTimes
                                    };
                                    if (u.isAnim) {
                                        for (var c = [], d = h.count, _ = h.raw, f = 1; f < d; f++) c.push(i + "Gif2End/anim/" + _ + "/" + f + ".png");
                                        u.urls = c;
                                    } else {
                                        var p = i + "Gif2End/img/" + h.raw;
                                        u.imgUrl = p;
                                    }
                                    s.push(u);
                                }
                                r.list = s, r.total = s.length, e._eolinkMoregame2Resp = r, t && t();
                            }, function () {
                                e.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.GET_MORE_GAME2);
                            });
                        }
                    }, e.prototype.getEOLinkUserData = function () {
                        var t = this;
                        if (this._eolinkToken) {
                            this.adapter.http_request("https://constellation.mamapai.net/common/download-data", {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken
                            }, "POST", "json", function (e) {
                                if (console.log("getEOLinkUserData >>>>> ", e), e.data && e.data.data) try {
                                    t._eolinkUserData = JSON.parse(e.data.data);
                                } catch (e) {
                                    t._eolinkUserData = {};
                                } else t._eolinkUserData = {};
                                t._eolinkCid && t.EOLinkRetainStatis();
                            }, function () {
                                t.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.GET_EO_LINK_USERDATA),
                                    t._eolinkUserData = {}, t._eolinkCid && t.EOLinkRetainStatis();
                            });
                        }
                    }, e.prototype.saveEOLinkUserData = function () {
                        var t = this;
                        if (this._eolinkToken) {
                            this._eolinkUserData.td_Stamp = Date.now(), this.adapter.http_request("https://constellation.mamapai.net/common/upload-data", {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken,
                                data: JSON.stringify(this._eolinkUserData)
                            }, "POST", "json", function (t) {
                                console.log("保存用户数据成功: ", t);
                            }, function () {
                                t.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.SAVA_EO_LINK_USERDATA);
                            });
                        }
                    }, e.prototype.EOLinkOpenStatis = function () {
                        var t = this;
                        if (this._eolinkToken) {
                            var e = wx.getLaunchOptionsSync ? wx.getLaunchOptionsSync() : {};
                            this.adapter.http_request("https://constellation.mamapai.net//data-statistics/open-app", {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken,
                                scene: e.scene
                            }, "POST", "json", function (t) {
                                console.log("打开应用上报:", t);
                            }, function () {
                                t.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_OPEN_STATIS);
                            });
                        }
                    }, e.prototype.getTimeSpanAt0 = function () {
                        return new Date(new Date().toDateString()).getTime();
                    }, e.prototype.EOLinkRetainStatis = function () {
                        var t = this;
                        if (this._eolinkToken) {
                            var e = this._eolinkUserData;
                            if ((!e.cidList || !e.td_Stamp || e.td_Stamp && this.getTimeSpanAt0() > e.td_Stamp) && (e.cidList = []),
                                -1 == e.cidList.indexOf(this._eolinkCid)) {
                                e.cidList.push(this._eolinkCid), this.saveEOLinkUserData();
                                this.adapter.http_request("https://constellation.mamapai.net/user/old-user-visit", {
                                    app: n.default.EOLINK_APP,
                                    token: this._eolinkToken,
                                    cid: this._eolinkCid
                                }, "POST", "json", function (t) {
                                    console.log("不同的CID上报:", t);
                                }, function () {
                                    t.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_RETAIN_STATIS);
                                });
                            }
                        }
                    }, e.prototype.EOLinkTransformStatis = function (t, e, i) {
                        void 0 === e && (e = ""), void 0 === i && (i = ""), this._eolinkToken && wx.request({
                            url: "https://constellation.mamapai.net/data-statistics/ad",
                            data: {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken,
                                ad_appid: t,
                                middle_appid: e,
                                ad_id: i
                            },
                            method: "POST",
                            success: function (t) {
                                console.log("EOLinkTransformStatis >>> result: ", t);
                            },
                            fail: function (t) {
                                this.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_TRANSFORM_STATIS),
                                    console.log("EOLinkTransformStatis >>> fail: ", t);
                            }
                        });
                    }, e.prototype.EOLinkAdStatis = function (t) {
                        this._eolinkToken && wx.request({
                            url: "https://constellation.mamapai.net/common/ad-statistics",
                            data: {
                                app: n.default.EOLINK_APP,
                                token: this._eolinkToken,
                                ad_appid: t
                            },
                            method: "POST",
                            success: function (t) {
                                console.log("EOLinkAdStatis >>> result: ", t);
                            },
                            fail: function (t) {
                                this.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.EO_LINK_AD_STATIS),
                                    console.log("EOLinkAdStatis >>> fail: ", t);
                            }
                        });
                    }, e.prototype.MJPLogin = function (t, e, i, r) {
                        var s = this, o = this._getMjpLoginUrl("/wechat/miniapp/login/code", "code=" + t);
                        e.getfollows = 1, e.getcache = 1, e.accesstoken = this.getUserStorage("last_mjp_token", null),
                            this.adapter.http_request(o, e, "POST", "json", function (t) {
                                if (t.error) s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_LOGIN),
                                    console.warn("================ login fail:::: " + t.message), r && r("mjp return error::" + t.message, t.code); else {
                                    if (console.log("================ login success:::: " + JSON.stringify(t)), s._isNewUser = t.newuser,
                                        s.setUserId(t.invitecode), s._onMjpLoginSuccess(t), s._isAuthorize = t.headimg && t.headimg.length > 0,
                                        s._isAuthorize ? s.setPlayerInfo({
                                            nickName: t.nickname,
                                            avatarUrl: t.headimg,
                                            gender: t.gender
                                        }) : console.log("=============== skip setPlayerInfo"), 1 == e.getcache) {
                                        var o = t.cache;
                                        if (void 0 === o) console.log("=============== userinfo is undefined"), s._isRealLogin ? (console.log("=============== real login userinfo is undefined so clearUserStorage"),
                                            s.clearUserStorage()) : s._getUserMjpStorage(); else if (null != o) {
                                                if (!s._storageData) return console.warn("---------------\x3e sdk has not init <----------------");
                                                s._cloudStorageInited = !0;
                                                var l = o.create_time, h = s._storageData.create_time, u = o.update_time, c = s._storageData.update_time;
                                                l && !h || u && !c || l && u && c - h < u - l ? (console.log("=============== have userinfo mjp data to local"),
                                                    s._onUserLocalStorageReset(o), s.flushUserStorage()) : s._isRealLogin ? (console.log("=============== real login mjp data to local"),
                                                        s._onUserLocalStorageReset(o), s.flushUserStorage()) : (console.log("=============== have userinfo local data to mjp"),
                                                            s.flushUserStorage());
                                            } else s._cloudStorageInited = !0, s._isRealLogin ? (console.log("=============== real login userinfo is null so clearUserStorage"),
                                                s.clearUserStorage()) : (console.log("=============== have userinfo local data to mjp"),
                                                    s.flushUserStorage());
                                    }
                                    if (i && i(t.invitecode, t), t.status) switch (t.status) {
                                        case 1:
                                            s._followStatus = a.FollowStatus.NEVER;
                                            break;

                                        case 6:
                                            s._followStatus = a.FollowStatus.FOLLOWED;
                                            break;

                                        case 7:
                                            s._followStatus = a.FollowStatus.UNFOLLOWED;
                                    }
                                }
                            }, function (t) {
                                s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_LOGIN),
                                    console.warn("================ request error:::: " + t), r && r("http error::" + t);
                            });
                    }, e.prototype.MJPCommitAuthorize = function (t, e, i, r) {
                        var s = this, o = this.mjpUrl + "/wechat/miniapp/setuserinfo/?r=" + this.gameId + "&code=" + t + "&timestamp=" + new Date().getTime(), l = {
                            rawData: e.rawData,
                            signature: e.signature,
                            encryptedData: e.encryptedData,
                            iv: e.iv
                        };
                        console.log("MJPCommitAuthorize resuqest url :::: ", o, JSON.stringify(l)), this.adapter.http_request(o, l, "POST", "json", function (t) {
                            t.error ? (s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_COMMIT_AUTHORIZE),
                                console.warn("================ commit fail:::: " + t.message), r && r()) : (console.log("================ commit success:::: " + JSON.stringify(t)),
                                    s._userUnionId = t.unionid, i && i());
                        }, function (t) {
                            s.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_COMMIT_AUTHORIZE),
                                console.warn("================ request error:::: " + t), r && r();
                        });
                    }, e.prototype.MJPLoginByLoginToken = function (t, e) {
                        var i = this;
                        if (!this._accesstoken) return e && e("user has not logined");
                        var r = this.mjpUrl + "/user/get/bylogintoken/?r=" + this.gameId + "&accesstoken=" + this._accesstoken + "&timestamp=" + new Date().getTime();
                        this.adapter.http_request(r, null, "GET", "json", function (r) {
                            r.error ? (i.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_LOGIN_TOKEN),
                                console.warn("================  bylogintoken fail:::: " + r.message), e && e("login bylogintoken request fail")) : (console.log("================  bylogintoken success:::: " + JSON.stringify(r)),
                                    i._userUnionId = r.unionid, t && t(r));
                        }, function (t) {
                            i.adapter.emit_event(a.SDKEvent.REQUEST_FAIL, n.default.REQUEST_FAIL_TYPE.MJP_LOGIN_TOKEN),
                                console.warn("================ request error:::: " + t), e && e("login bylogintoken request error");
                        });
                    }, e.prototype.supportShortModeVibrate = function () {
                        if (this._supportShortModeVibrate) return 1 === this._supportShortModeVibrate;
                        this._supportShortModeVibrate = 1;
                        try {
                            var t = wx.getSystemInfoSync().model;
                            t && /^iphone\s*[1-6]/i.test(t) && (this._supportShortModeVibrate = 2);
                        } catch (t) {
                            console.warn(t);
                        }
                        return 1 === this._supportShortModeVibrate;
                    }, e.prototype.isProfiledScreen = function (t) {
                        t = t || wx.getSystemInfoSync();
                        try {
                            var e = t.model;
                            if (e && /\biphone\s*x/i.test(e)) return !0;
                        } catch (t) {
                            console.warn(t);
                        }
                        if ("android" === t.platform) {
                            var i = t.screenWidth, n = t.screenHeight;
                            return i < n && 2 * i <= n || i > n && 2 * n <= i;
                        }
                        return !1;
                    }, e.prototype.getUserInfo = function (t, e) {
                        // var i = this;
                        // this.requestuserInfoScope(function() {
                        //     i.loginWithType("platform", function(i) {
                        //         wx.getUserInfo({
                        //             withCredentials: !0,
                        //             lang: "zh_CN",
                        //             success: function(e) {
                        //                 t && t(i, e);
                        //             },
                        //             fail: function() {
                        //                 e && e("getUserInfo request fail");
                        //             }
                        //         });
                        //     }, e);
                        // }, e);
                    }, e.prototype.requestuserInfoScope = function (t, e) {
                        wx.createUserInfoButton ? this.checkUserInfoScope(function (i) {
                            i ? t && t() : e && e("no scope.userInfo");
                        }) : wx.authorize({
                            scope: "scope.userInfo",
                            success: function (e) {
                                t && t();
                            },
                            fail: function () {
                                e && e("request scope fail");
                            }
                        });
                    }, e.prototype.checkUserInfoScope = function (t) {
                        wx.getSetting ? wx.getSetting({
                            success: function (e) {
                                console.log("get setting ======= ", e.authSetting), t && t(e.authSetting && !!e.authSetting["scope.userInfo"] || !1);
                            },
                            fail: function () {
                                t && t(!1);
                            }
                        }) : t(!1);
                    }, e.prototype._startTimeoutDelay = function (t, e) {
                        var i = setTimeout(t, e), n = this._timeoutReqeustIndex++;
                        return this._timeoutReqeustHandle[n] = i, n;
                    }, e.prototype._stopTimeoutDelay = function (t) {
                        var e = this._timeoutReqeustHandle[t];
                        return !!e && (clearTimeout(e), delete this._timeoutReqeustHandle[t], !0);
                    }, e.prototype._onShow = function (e) {
                        t.prototype._onShow.call(this, e);
                    }, e.prototype.showInsertAd = function (t, e) {
                        var i = n.default.INSERTAD_NAME_UNITIDS[t];
                        if (!i) return console.log("当前没有可用的插屏");
                        var r = this._insertAdInstance[i];
                        r || (r = this._insertAdInstance[i] = wx.createInterstitialAd({
                            adUnitId: i
                        })), r.show().catch(function (t) {
                            console.log("showInsertAd error!", t), e && e(t);
                        });
                    }, e.prototype.sendSinglePicToOpenDataContext = function (t) {
                        var e = this.adapter.get_file_info(t);
                        e.isLoad = "openJsondatacontextPic", wx.getOpenDataContext().postMessage(e);
                    }, e.prototype.postFGUIPackage = function (t) {
                        if (fairygui && t instanceof fairygui.UIPackage) {
                            for (var e = t._items.length, i = this.adapter.sendSinglePicToOpenDataContext || this.sendSinglePicToOpenDataContext.bind(this), n = 0; n < e; n++) {
                                var r = t._items[n];
                                r.type == fairygui.PackageItemType.Atlas && i(r.file);
                            }
                            var a = t.customId, s = this.adapter.get_file_content(a + "." + fairygui.UIConfig.packageFileExtension);
                            if (!s) return console.warn("Cannot find file content with url:: " + a);
                            var o = new Uint8Array(s);
                            this._postMessageToShareData(h, {
                                length: o.length,
                                data: o,
                                url: a
                            });
                        }
                    }, e.prototype.addOpenContextRenerTask = function (t, e, i, n) {
                        var r = window.sharedCanvas;
                        if (r && e instanceof fairygui.GObject) {
                            if (this._currentRenderTask) {
                                if (this._currentRenderTask.sign === t) {
                                    var a = this._currentRenderTask.postData;
                                    return a.data = n, void this._postMessageToShareData(o, a);
                                }
                                this.adapter.clear_update(this._currentRenderTask.handler), this._currentRenderTask.handler = null,
                                    this.removeTaskInStack(t), this._postMessageToShareData(l, {
                                        sign: t,
                                        last: !1
                                    }), this._renderTaskStack.push(this._currentRenderTask);
                            }
                            var s = this.adapter.get_rect(e), h = e.width, u = e.height;
                            r.width = h, r.height = u;
                            var c = {
                                sign: t,
                                url: i,
                                x: s.x,
                                y: s.y,
                                width: s.width,
                                height: s.height,
                                data: n
                            };
                            this._postMessageToShareData(o, c);
                            var d = this.adapter.sub_render(e, r), _ = this.adapter.frame_update(d);
                            this._currentRenderTask = {
                                sign: t,
                                url: i,
                                handler: _,
                                width: h,
                                height: u,
                                target: e,
                                postData: c
                            };
                        }
                    }, e.prototype.removeOpenContextRenderTask = function (t, e) {
                        if (void 0 === e && (e = !0), this._currentRenderTask && this._currentRenderTask.sign === t) {
                            var i = this._currentRenderTask;
                            this._currentRenderTask = null, this.adapter.clear_update(i.handler), i.handler = null,
                                this._postMessageToShareData(l, {
                                    sign: t,
                                    last: e
                                });
                            for (var n = this._renderTaskStack.pop(); n;) {
                                var r = n.target;
                                if (r.displayObject && !r.displayObject.destroyed && r.displayObject.displayedInStage) return this.addOpenContextRenerTask(n.sign, r, n.url);
                                n = this._renderTaskStack.pop();
                            }
                        } else this.removeTaskInStack(t), this._postMessageToShareData(l, {
                            sign: t,
                            last: e
                        });
                    }, e.prototype.removeTaskInStack = function (t) {
                        for (var e = -1, i = this._renderTaskStack, n = i.length - 1; n >= 0; n--) {
                            if (i[n].sign === t) {
                                e = n;
                                break;
                            }
                        }
                        e < 0 || i.splice(e, 1);
                    }, e;
            }(a.default))();
            window.sdk = g, i.default = g;
        }, {
            "./sdkBase": 328,
            "./sdkConstants": 329
        }],
        328: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.Banner = i.ButtonBinder = i.sdk_adapter = i.MoreGameFrom = i.SDKEvent = i.MJPCollectionType = i.FollowStatus = void 0;
            var n, r = t("./md5"), a = t("./sdkConstants");
            i.ButtonBinder = n;
            var s = fairygui.GObject.prototype, o = s.handleVisibleChanged;
            s.handleVisibleChanged = function () {
                o.call(this), this._displayObject && this._displayObject.event("node_visible");
            };
            var l = s.dispose;
            s.dispose = function () {
                this._displayObject && this._displayObject.event("node_destroy"), l.call(this);
            };
            var h = function () {
                function t(t) {
                    this._owner = null, this._onShow = null, this._onHide = null, this._onDestroy = null,
                        this._visible = !0, this._owner = t, t.displayObject.on("added", this, this.handleButtonVisibleChange),
                        t.displayObject.on("removed", this, this.handleButtonVisibleChange), t.displayObject.on("display", this, this.handleButtonVisibleChange),
                        t.displayObject.on("undisplay", this, this.handleButtonVisibleChange), this.handleButtonVisibleChange();
                }
                return t.bindNode = function (e, i) {
                    if (!(e instanceof fairygui.GObject)) return console.log("ButtonBinder only can add to fairygui.GObject"),
                        null;
                    var n = new t(e);
                    return this.binderArr.push({
                        key: i,
                        binder: n
                    }), n;
                }, t.prototype.handleButtonVisibleChange = function () {
                    if (console.log("handleButtonVisibleChange ======== "), this._owner) {
                        var t = this._owner.displayObject.displayedInStage;
                        this._visible !== t && (t ? this._onShow && this._onShow() : this._onHide && this._onHide(),
                            this._visible = t);
                    }
                }, t.prototype.handleButtonDestroy = function () {
                    console.log("handleButtonDestroy ======== "), this._onDestroy && this._onDestroy(),
                        this._owner = null;
                }, Object.defineProperty(t.prototype, "visible", {
                    get: function () {
                        return this._visible;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.onButtonShow = function (t) {
                    this._onShow = t;
                }, t.prototype.onButtonHide = function (t) {
                    this._onHide = t;
                }, t.prototype.onButtonDestroy = function (t) {
                    this._onDestroy = t;
                }, t.prototype.offButtonShow = function () {
                    this._onShow = null;
                }, t.prototype.offButtonHide = function () {
                    this._onHide = null;
                }, t.prototype.offButtonDestroy = function () {
                    this._onDestroy = null;
                }, t.prototype.show = function () {
                    this.visible && this._onShow && this._onShow();
                }, t.prototype.hide = function () {
                    this._onHide && this._onHide();
                }, t.prototype.onDestroy = function () {
                    this._onDestroy && this._onDestroy();
                }, t.prototype.onTap = function (t) {
                    this._owner && (this._owner.fireClick(), this._owner.displayObject.event("click", t));
                }, t.binderArr = [], t;
            }();
            i.ButtonBinder = n = h;
            var u = function () {
                function t(e, i, n) {
                    this._banner = null, this._rect = null, this._name = null, this._isShow = !1, this._destroyed = !1,
                        this._loaded = !1, this._retryTimes = 0, this._strict_mode = null, this._freshHandler = null,
                        this._refreshDelay = 0, this._name = e, this._rect = i, this._strict_mode = void 0 === n ? a.default.BANNER_STRICT_MODE : n,
                        t._pushBanner(this);
                }
                return t._pushBanner = function (t) {
                    this.s_loadQuece.push(t), this._next();
                }, t._removeBanner = function (t) {
                    var e = this.s_loadQuece.indexOf(t);
                    -1 !== e && this.s_loadQuece.splice(e);
                }, t._next = function () {
                    if (!this.s_buzy) {
                        var t = this.s_loadQuece.shift();
                        t && t.load();
                    }
                }, t.prototype.adjust = function (t) {
                    this._rect = t, this._banner && this._adjust(this._banner, t);
                }, t.prototype._create = function () { }, t.prototype._show = function (t) { }, t.prototype._hide = function (t) { },
                    t.prototype._adjust = function (t, e) { }, t.prototype._clear = function () { }, t.prototype._onLoad = function () {
                        console.log("banner加载成功"), this._loaded = !0, this._retryTimes = 0, this._destroyed ? this.destroy() : this._isShow ? this.show() : this._isShow || this.hide(),
                            t.s_buzy = !1, t._next();
                    }, t.prototype._onError = function (e) {
                        if (console.log("加载失败,error is:: " + JSON.stringify(e)), this._banner && this._clear(),
                            this._retryTimes += 1, this._destroyed || !(this._retryTimes < 3)) return this._loaded = !this._destroyed,
                                t.s_buzy = !1, t._next();
                        this.load();
                    }, t.prototype.setFreshDelay = function (t) {
                        this._refreshDelay = t, this._stopFresh(), this._loaded && this._delayFresh();
                    }, t.prototype.load = function () {
                        if (t.s_buzy = this._strict_mode, this._banner && this._clear(), !(this._banner = this._create())) return t._next();
                    }, t.prototype.show = function () {
                        this._isShow = !0, this._loaded && this._banner && (this._banner.show(), c.emit_event(p.ON_BANNER_SHOW, this._name),
                            this._delayFresh());
                    }, t.prototype.hide = function () {
                        this._stopFresh(), this._isShow = !1, this._loaded && this._banner && this._hide(this._banner);
                    }, t.prototype.destroy = function () {
                        this._stopFresh(), t._removeBanner(this), this._destroyed = !0, this._banner && this._loaded && this._clear();
                    }, t.prototype._delayFresh = function () {
                        var e = this;
                        this._refreshDelay > 0 && (this._stopFresh(), this._freshHandler = setTimeout(function () {
                            t._pushBanner(e);
                        }, this._refreshDelay));
                    }, t.prototype._stopFresh = function () {
                        this._freshHandler && (clearTimeout(this._freshHandler), this._freshHandler = null);
                    }, t.s_buzy = !1, t.s_loadQuece = [], t;
            }();
            i.Banner = u;
            var c = function () {
                function t() { }
                return t.on_key_back = function (t) {
                    var e = window;
                    e.conch && e.conch.setOnBackPressedFunction && e.conch.setOnBackPressedFunction(t);
                }, t.http_request = function (t, e, i, n, r, a, s) {
                    if ("GET" === (i = i || "GET") && e) {
                        var o = null;
                        if ("string" == typeof e) o = e; else {
                            var l = [];
                            for (var h in e) e.hasOwnProperty(h) && l.push(h + "=" + e[h]);
                            o = l.join("&");
                        }
                        o && (-1 !== t.indexOf("?") ? t += "&" + o : t += "?" + o);
                    }
                    console.log("============== http request data", e), console.log("============== http request url:" + t + " method:" + i);
                    var u = Laya.Pool.getItemByClass("laya.net.HttpRequest", Laya.HttpRequest);
                    u.on(Laya.Event.COMPLETE, u, function (t) {
                        r && r(t), this.offAll(Laya.Event.COMPLETE), this.offAll(Laya.Event.ERROR), this.offAll(Laya.Event.PROGRESS),
                            Laya.Pool.recover("laya.net.HttpRequest", this);
                    }), u.on(Laya.Event.ERROR, u, function (t) {
                        a && a(t), this.offAll(Laya.Event.COMPLETE), this.offAll(Laya.Event.ERROR), this.offAll(Laya.Event.PROGRESS),
                            Laya.Pool.recover("laya.net.HttpRequest", this);
                    }), u.on(Laya.Event.PROGRESS, u, function (t) {
                        s && s(t);
                    }), "GET" === i ? u.send(t, null, i.toLowerCase(), n) : u.send(t, e, i.toLowerCase(), n);
                }, t.is_mac = function () {
                    return Laya.Browser.onMac;
                }, t.get_default_sound_type = function () {
                    return Laya.Browser.onMiniGame ? "mp3" : Laya.Browser.onPC ? Laya.Browser.onMac ? "wav" : "mp3" : "wav";
                }, t.clear_local = function () {
                    // Laya.LocalStorage.clear();
                }, t.set_local_item = function (t, e) {

                    e.length > 1e6 && console.warn("set_local_item got a too long string ::: " + e.length);
                    try {
                        console.log("存数据：" + t + "----" + e)
                        Laya.LocalStorage.setItem(t, e);
                    } catch (t) {
                        console.warn("set_local_item fail ::: " + t);
                    }
                }, t.get_local_item = function (t) {
                    try {
                        return Laya.LocalStorage.getItem(t);
                    } catch (t) {
                        return void console.warn("get_local_item fail::: " + t);
                    }
                }, t.call_later = function (t, e) {
                    Laya.timer.callLater(t, e);
                }, t.call_in_next_frame = function (t, e, i) {
                    Laya.timer.frameOnce(1, t, e, i);
                }, t.emit_event = function (t, e) {
                    Laya.stage.event(t, e);
                }, t.get_canvas_size = function () {
                    return 150;
                }, t.get_char_bytes = function () {
                    return 4;
                }, t.render_texture = function () {
                    return new Laya.Texture();
                }, t.get_pixels = function (t, e, i) {
                    return t.setTo(e), t.getPixels(0, 0, i, i);
                }, t.get_frame_size = function () {
                    return {
                        width: Laya.Browser.clientWidth,
                        height: Laya.Browser.clientHeight
                    };
                }, t.jsb_call_ios_static_method = function (t, e) {
                    for (var i = [], n = 2; n < arguments.length; n++) i[n - 2] = arguments[n];
                }, t.jsb_call_static_method = function (t, e, i) {
                    for (var n = [], r = 3; r < arguments.length; r++) n[r - 3] = arguments[r];
                    var a = t.split("/").join("."), s = this._reflections[a];
                    return s || (s = Laya.PlatformClass.createClass(a), this._reflections[a] = s), s.call.apply(s, [e].concat(n));
                }, t.format_url = function (t) {
                    return Laya.URL.formatURL(t);
                }, t.get_file_content = function (t) {
                    return Laya.loader.getRes(t);
                }, t.frame_update = function (t) {
                    return Laya.timer.frameLoop(1, null, t), t;
                }, t.clear_update = function (t) {
                    Laya.timer.clear(null, t);
                }, t.sub_render = function (t, e) {
                    var i = t.displayObject;
                    if (!(i.texture && i.texture instanceof Laya.Texture)) {
                        var n = new Laya.Texture();
                        i.texture = n;
                    }
                    return i.texture.bitmap = new Laya.Texture2D(), function () {
                        i.texture.bitmap.loadImageSource(e);
                    };
                }, t.get_rect = function (t) {
                    if (!(t instanceof fairygui.GObject)) return console.log("sdk_adpter.get_rect need a fairygui.GObject object"),
                        null;
                    var e = t.x, i = t.y, n = t.width, r = t.height;
                    t.pivotAsAnchor && (e -= n * t.pivotX, i -= r * t.pivotY);
                    var a = t.parent.localToGlobal(e, i), s = t.parent.localToGlobal(e + n, i + r), o = Laya.Browser.clientWidth / Laya.stage.width, l = Laya.Browser.clientHeight / Laya.stage.height;
                    return new Laya.Rectangle(a.x * o, a.y * l, (s.x - a.x) * o, (s.y - a.y) * l);
                }, t.get_file_info = function (t) {
                    return {
                        url: t,
                        imgNativeUrl: this.format_url(t),
                        imgReadyUrl: t
                    };
                }, t._keyDown = function (t) {
                    this._key_back_call && this._key_back_call();
                }, t._key_back_call = null, t._reflections = {}, t.sendSinglePicToOpenDataContext = window.Laya && Laya.MiniAdpter && Laya.MiniAdpter.sendSinglePicToOpenDataContext || null,
                    t;
            }();
            i.sdk_adapter = c;
            var d = {
                UNKNOWN: "UNKNOWN",
                NEVER: "NEVER",
                FOLLOWED: "FOLLOWED",
                UNFOLLOWED: "UNFOLLOWED"
            };
            i.FollowStatus = d;
            var _ = {
                LOGOUT: "logout",
                VIDEOAD: "videoad",
                LOADVIDEOAD: "loadvideoad",
                MISSION: "game",
                CHANGE: "change",
                GOTO: "goto"
            };
            i.MJPCollectionType = _;
            var f, p = {
                USER_CHANGE: "user_id_changed",
                STORAGE_RESET: "local_storage_reset",
                MORE_GAME_INFO_FRESH: "more_game_info_fresh",
                CLOSE_SPLASH: "close_splash",
                ON_SHOW: "on_show",
                ON_HIDE: "on_hide",
                ON_BANNER_SHOW: "on_banner_show",
                REQUEST_FAIL: "request_fail",
                VIDEO_SHOW_START: "video_show_start",
                VIDEO_SHOW_ENDED: "video_show_ended",
                AUTHORIZE_RESULT: "authorize_result"
            };
            i.SDKEvent = p, function (t) {
                t[t.MJP = 0] = "MJP", t[t.EOLINK = 1] = "EOLINK";
            }(f || (f = {})), i.MoreGameFrom = f;
            var m = function () {
                function t(t) {
                    this.adapter = c, this.isDebug = !0, this._isRealLogin = !1, this._appVersion = null,
                        this._backPressCallback = null, this._isNewUser = !1, this._userId = null, this._storageData = null,
                        this._gameDataModel = null, this._userStorageKeys = null, this._default_storage_key = "user_default",
                        this._openKeys = ["create_time", "update_time", "private_len", "user_id", "guid", "last_mjp_token"],
                        this._accesstoken = null, this._channel = null, this._showTime = null, this._bannerRefreshDelay = a.default.BANNER_REFRESH_DELAY,
                        this._bannerCls = null, this._loadedBannerAds = {}, this._cloudStorageInited = !1,
                        this._ipData = null, this._timeOutID = null, this._timeDely = 2e4, this._lastFlushTime = 0,
                        this._isTidy = 0, this._logFunc = console.log, this._warnFunc = console.warn, this._errorFunc = console.log,
                        this._bannerCls = t;
                }
                return Object.defineProperty(t.prototype, "gameId", {
                    get: function () {
                        return this.isDebug ? a.default.GAME_ID < 100 ? 1e3 + a.default.GAME_ID : a.default.GAME_ID >= 5e3 ? a.default.GAME_ID - 4e3 : (console.log("不正常的GAME_ID: " + a.default.GAME_ID),
                            a.default.GAME_ID) : a.default.GAME_ID;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpRank", {
                    get: function () {
                        return this.isDebug ? 0 == a.default.RANK_TEST_ID ? "mjprank" : "mjprank" + a.default.RANK_TEST_ID : "mjprank" + a.default.RANK_PROD_ID;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpCache", {
                    get: function () {
                        return this.isDebug ? 0 == a.default.CACHE_TEST_ID ? "mjpcache" : "mjpcache" + a.default.CACHE_TEST_ID : "mjpcache" + a.default.CACHE_PROP_ID;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpPrize", {
                    get: function () {
                        return this.isDebug ? 0 == a.default.PRIZE_TEST_ID ? "mjpprize" : "mjpprize" + a.default.PRIZE_TEST_ID : "mjpprize" + a.default.PRIZE_PROD_ID;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpUrl", {
                    get: function () {
                        return this.isDebug ? a.default.MJP_TEST_URL : a.default.MJP_PROD_URL;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpOrigin", {
                    get: function () {
                        return this.isDebug ? a.default.MJP_TEST_ORIGIN : a.default.MJP_PROD_ORIGIN;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpRankOrigin", {
                    get: function () {
                        return this.isDebug ? a.default.MJP_RANK_TEST_ORIGIN : a.default.MJP_RANK_PROD_ORIGIN;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "mjpPrizeOrigin", {
                    get: function () {
                        return this.isDebug ? a.default.MJP_PRIZE_TEST_ORIGIN : a.default.MJP_PRIZE_PROD_ORIGIN;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "gameSocket", {
                    get: function () {
                        return this.isDebug ? a.default.TEST_GAME_SOCKET : a.default.PROD_GAME_SOCKET;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "pvpSocket", {
                    get: function () {
                        return this.isDebug ? a.default.TEST_PVP_SOCKET : a.default.PROD_PVP_SOCKET;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "guid", {
                    get: function () {
                        var t = this.getUserStorage("guid", null);
                        return null === t && console.warn("get guid error, please init sdk first!!"), t;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "accesstoken", {
                    get: function () {
                        return this._accesstoken;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "isNewUser", {
                    get: function () {
                        return this._isNewUser;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.init = function (t, e, i, n) {
                    void 0 === i && (i = !1), void 0 === n && (n = !1), "boolean" == typeof t ? this.isDebug = t || a.default.DEBUG : (this._appVersion = t || null,
                        this.isDebug = void 0 === e ? a.default.DEBUG : !!e), console.warn(">>>> sdk.debug:", this.isDebug),
                        this.isDebug && (this._default_storage_key += "_debug"), this._isRealLogin = i,
                        this._init(), this.onCollectionLoading(), this._onShow()
                }, t.prototype.setLogLevel = function (t) {
                    switch (t) {
                        case 0:
                            console.log = this._logFunc, console.warn = this._warnFunc, console.log = this._errorFunc;
                            break;

                        case 1:
                            console.log = function () { }, console.warn = this._warnFunc, console.log = this._errorFunc;
                            break;

                        case 2:
                            console.log = function () { }, console.warn = function () { }, console.log = this._errorFunc;
                            break;

                        case 3:
                        default:
                            console.log = function () { }, console.warn = function () { }, console.log = function () { };
                    }
                }, t.prototype.getPlatform = function () {
                    return "test";
                }, t.prototype.getDevice = function () {
                    return this.adapter.is_mac() ? "mac" : "win";
                }, t.prototype.enterKefuSystem = function (t) { }, t.prototype.supportShowFavoriteGuide = function () {
                    return !1;
                }, t.prototype.showFavoriteGuide = function (t, e, i, n, r) {
                    return n && n("平台不支持");
                }, t.prototype.supportReward = function () {
                    return !1;
                }, t.prototype.getAllRewardInfo = function (t, e, i) {
                    var n = this;
                    if (!this._accesstoken || !this._userId) return console.warn("user has not logined"),
                        e && e();
                    i = i || {};
                    var r = this.mjpUrl + "/reward/get/?r=" + this.gameId + "&invitecode=" + this._userId + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                    for (var s in i) r += "&" + s + "=" + i[s];
                    console.log("getAllRewardInfos链接", r), this.adapter.http_request(r, null, "GET", "json", function (i) {
                        return i.error ? (n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_KF_REWARD_STATUS),
                            console.warn("================ getAllRewardInfo fail:::: " + i.message), e && e()) : (console.log("================  getAllRewardInfo success:::: " + JSON.stringify(i)),
                                t && t(i.result));
                    });
                }, t.prototype.setRewardStatus = function (t, e, i) {
                    var n, s = this;
                    if (!this._accesstoken || !this._userId) return console.warn("user has not logined"),
                        i && i();
                    "number" != typeof t && (n = t.rid, t = t.rtype);
                    var o = {
                        status: 1,
                        rtype: t,
                        rid: n
                    }, l = {};
                    for (var h in o) "object" != typeof o[h] && "boolean" != typeof o[h] && null != o[h] && (l[h] = o[h]);
                    var u = new Date().getTime();
                    l.ts = u;
                    var c = Object.keys(l);
                    c.sort(function (t, e) {
                        return t.toLowerCase() > e.toLowerCase() ? 1 : -1;
                    });
                    var d = "";
                    c.forEach(function (t, e) {
                        d += t + "=" + l[t] + "&";
                    }), d = d.substr(0, d.length - 1);
                    var _ = {
                        value: o,
                        accesstoken: this._accesstoken,
                        ts: u,
                        sign: r.default.hex_md5(d)
                    };
                    console.log("加密前:" + d), console.log("加密后:" + r.default.hex_md5(d)), console.log("发送的数据:", JSON.stringify(_));
                    var f = this.mjpUrl + "/reward/set/?r=" + this.gameId;
                    console.log("setRewardStatus链接", f), this.adapter.http_request(f, _, "POST", "json", function (t) {
                        t.error ? (s.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_KF_REWARD),
                            console.warn("================ setRewardStatus fail:::: " + t.message), i && i()) : (console.log("================ setRewardStatus success:::: " + JSON.stringify(t)),
                                e && e());
                    }, function (t) {
                        s.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_KF_REWARD),
                            console.warn("================ request error:::: " + t), i && i();
                    });
                }, t.prototype.saveImageToPhotosAlbum = function (t, e, i) {
                    console.log("该平台暂未支持");
                }, t.prototype.setClipboardData = function (t, e, i) {
                    console.log("该平台暂未支持");
                }, t.prototype.isIphoneX = function () {
                    return !1;
                }, t.prototype.isIpad = function () {
                    return !1;
                }, t.prototype.isCensoredRegion = function () {
                    var t = this._ipData;
                    if (t) {
                        for (var e in a.default.CENSORED_REGION_NAME) {
                            if (t.cid && t.cid == e) return !0;
                            if (t.cname && -1 != t.cname.indexOf(a.default.CENSORED_REGION_NAME[e])) return !0;
                        }
                        return !1;
                    }
                    return console.warn("can't get IpData!"), !1;
                }, t.prototype.reportMonitor = function (t, e) {
                    console.log("平台不支持上报");
                }, t.prototype.supportKeyboardMode = function () {
                    return !1;
                }, t.prototype.supportLogin = function () {
                    return this.getLoginTypes().length > 0;
                }, t.prototype.supportPay = function () {
                    return this.getPayTypes().length > 0;
                }, t.prototype.supportBackExit = function () {
                    return !1;
                }, t.prototype.supportMoregames = function () {
                    return !1;
                }, t.prototype.supportPlayerCenter = function () {
                    return !1;
                }, t.prototype.supportSplash = function () {
                    return !1;
                }, t.prototype.supportShare = function () {
                    return !1;
                }, t.prototype.supportBannerAd = function () {
                    return !1;
                }, t.prototype.supportInsertAd = function () {
                    return !1;
                }, t.prototype.supportVideoAd = function () {
                    return !1;
                }, t.prototype.supportBugly = function () {
                    return !1;
                }, t.prototype.supportCollection = function () {
                    return !1;
                }, t.prototype.supportRanking = function () {
                    return !1;
                }, t.prototype.supportPreviewImage = function () {
                    return !1;
                }, t.prototype.supportHttpLink = function () {
                    return !1;
                }, t.prototype.supportEnterPub = function () {
                    return !1;
                }, t.prototype.supportPlatformLoading = function () {
                    return !1;
                }, t.prototype.supportRecordScreen = function () {
                    return !1;
                }, t.prototype.getLoginTypes = function () {
                    return [];
                }, t.prototype.getLoginType = function () {
                    return "";
                }, t.prototype.loginWithType = function (t, e, i, n) {
                    i && i("平台不支持登陆");
                }, t.prototype.getFollowStatus = function () {
                    return d.UNKNOWN;
                }, t.prototype.login = function (t, e) {
                    return this.loginWithType(this.getLoginType(), t, e);
                }, t.prototype.getPayTypes = function () {
                    return [];
                }, t.prototype.getPayType = function () {
                    return "";
                }, t.prototype.payWithType = function (t, e) {
                    e.fail && e.fail();
                }, t.prototype.pay = function (t) {
                    return this.payWithType(this.getPayType(), t);
                }, t.prototype.onBackPressed = function () { }, t.prototype.setBuglyID = function (t) { },
                    t.prototype.setBuglyTag = function (t) { }, t.prototype.setBuglyMap = function (t) { },
                    t.prototype.addBuglyMap = function (t) { }, t.prototype.testBugly = function () { },
                    t.prototype.isMjpAuthorized = function () {
                        return !0;
                    }, t.prototype.onCommitMjpUserInfo = function (t, e) { }, t.prototype.onUserNoLogin = function () { },
                    t.prototype.onUserLogin = function (t, e, i, n, r, a) { }, t.prototype.onCollectionLoading = function () {
                        var t = this.mjpUrl + "/cf/loading/get/?r=" + this.gameId + "&id=" + this.guid + "&timestamp=" + new Date().getTime();
                        this.adapter.http_request(t, null, "GET", "json", function (t) {
                            console.log("onCollectionLoading >>> response::: " + JSON.stringify(t));
                        }, function (e) {
                            console.warn("get mjp config http request fail::: url = " + t);
                        });
                    }, t.prototype.onCollectionGame = function (t) {
                        for (var e = {}, i = 0, n = ["gameType", "duration", "isWin", "commonReason", "isLocal", "gameId", "subParam", "gameReason", "coin", "actor1", "level1", "actor2", "level2", "actor3", "level3"]; i < n.length; i++) {
                            var r = n[i];
                            e[r] = t[r] || 0;
                        }
                        this._mjpCollection(_.MISSION, e);
                    }, t.prototype.onCollectionCoin = function (t) {
                        var e = {};
                        e.id = t.id, e.change = t.change, e.now = t.now, e.reason = t.reason || 0, this._mjpCollection(_.CHANGE, e);
                    }, t.prototype.onCollectionTraffic = function () {
                        return null;
                    }, t.prototype.onCollectionReward = function (t, e) { }, t.prototype.onCollectionPurchase = function (t, e, i) { },
                    t.prototype.onCollectionUse = function (t, e) { }, t.prototype.onCollectionUserProps = function (t, e) {
                        void 0 === e && (e = null);
                    }, t.prototype.onCollectionMissionStart = function (t) { }, t.prototype.onCollectionMissionComplete = function (t) { },
                    t.prototype.onCollectionMissionFail = function (t, e) { }, t.prototype.onCollectionEvent = function (t, e) { },
                    t.prototype.onCollectionTimeEventStart = function (t, e) { },
                    t.prototype.getIPAndCity = function (t, e) {
                        var i = this;
                        this.adapter.http_request("https://pv.sohu.com/cityjson?ie=utf-8", null, "GET", null, function (n) {
                            if (n.error) i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_IP_AND_CITY),
                                console.warn("================  getIPAndCity fail:::: " + n.message), e && e("getIPAndCity request fail"); else {
                                var r = n.indexOf("{"), s = n.slice(r, -1), o = JSON.parse(s);
                                i._ipData = o, console.log("================ getIPAndCity success:::: " + JSON.stringify(o)),
                                    i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_IP_SUCCESS),
                                    t && t(o);
                            }
                        }, function () {
                            i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_IP_AND_CITY);
                        });
                    }, t.prototype.updateRankInfo = function (t, e, i, n, r) { }, t.prototype.getRankInfo = function (t, e, i) { },
                    t.prototype.isShowRank = function (t) {
                        void 0 === t && (t = !1);
                    }, t.prototype.updateWorldRankInfo = function (t, e, i, n, s, o, l) {
                        var h = this;
                        if (void 0 === i && (i = !1), void 0 === n && (n = 0), void 0 === s && (s = 0),
                            this._accesstoken && this._userId) if (this.isMjpAuthorized()) {
                                var u = new Date().getTime(), c = {
                                    name: t,
                                    accesstoken: this._accesstoken,
                                    invitecode: this._userId,
                                    score: e,
                                    incr: i,
                                    ts: u,
                                    sign: r.default.hex_md5("name=" + t + "&score=" + e + "&ts=" + u),
                                    than: n,
                                    stage: s
                                }, d = this.mjpRankOrigin + "/" + this.mjpRank + "/rlist/item/set/?r=" + this.gameId;
                                console.log("Update World Rank Url:", d), this.adapter.http_request(d, c, "POST", "json", function (t) {
                                    t.error ? (h.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.UPDATE_WORLD_RANKINFO),
                                        console.warn("================ updateWorldRankInfo fail:::: " + t.message), l && l(t.message)) : (console.log("================ updateWorldRankInfo success:::: " + JSON.stringify(t)),
                                            t.index && o && o(t.index));
                                }, function (t) {
                                    h.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.UPDATE_WORLD_RANKINFO),
                                        console.warn("================ request error:::: " + t), l && l(t);
                                });
                            } else console.warn("=========== updateWorld fail! not Autorized!");
                    }, t.prototype.updateGroupRankInfo = function (t, e, i, n) {
                        var s = this;
                        if (void 0 === i && (i = !1), void 0 === n && (n = 0), this._accesstoken && this._userId) {
                            var o = new Date().getTime(), l = {
                                name: t,
                                accesstoken: this._accesstoken,
                                invitecode: this._userId,
                                score: e,
                                incr: i,
                                ts: o,
                                sign: r.default.hex_md5("name=" + t + "&score=" + e + "&ts=" + o),
                                than: n
                            }, h = this.mjpRankOrigin + "/" + this.mjpRank + "/rlist/item/set/?r=" + this.gameId;
                            console.log("update group rank url:", h), this.adapter.http_request(h, l, "POST", "json", function (t) {
                                t.error ? (s.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.UPDATE_WORLD_RANKINFO),
                                    console.warn("================ updateWorldRankInfo fail:::: " + t.message)) : console.log("================ updateWorldRankInfo success:::: " + JSON.stringify(t));
                            }, function (t) {
                                s.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.UPDATE_WORLD_RANKINFO),
                                    console.warn("================ request error:::: " + t);
                            });
                        }
                    }, t.prototype.getWorldRankInfo = function (t, e, i) {
                        var n = this;
                        if (!this._accesstoken || !this._userId) return i && i("user has not logined");
                        var r = this.mjpRankOrigin + "/" + this.mjpRank + "/rlist/get/?r=" + this.gameId + "&name=" + t + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                        console.log("get world rank url:", r), this.adapter.http_request(r, null, "GET", "json", function (t) {
                            if (t.error) n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_WORLD_RANKINFO),
                                console.warn("================  getWorldRankInfo fail:::: " + t.message), i && i("login bylogintoken request fail"); else {
                                if (console.log("================  getWorldRankInfo success:::: " + JSON.stringify(t)),
                                    t.rlist && t.rlist.length > 0 && 5 != t.rlist[0].length) return console.log("================  please choose invitecode score nickname gender headimg in mjpConfig"),
                                        i && i("mjpConfig choose error");
                                var r = [];
                                t.rlist.forEach(function (t, e) {
                                    var i = {
                                        value: t[1],
                                        nickname: t[2],
                                        gender: t[3],
                                        avatarUrl: t[4]
                                    };
                                    t[0] == n._userId && (i.selfFlag = !0), r.push(i);
                                }), e && e(r, t.index);
                            }
                        }, function (t) {
                            n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_WORLD_RANKINFO),
                                console.warn("================ request error:::: " + t), i && i("getWorldRankInfo request error");
                        });
                    }, t.prototype._dayStr2Timestamp = function (t) {
                        var e = t.substring(0, 4), i = t.substring(4, 6), n = t.substring(6, 8);
                        return new Date(e + "-" + i + "-" + n).getTime() - 288e5;
                    }, t.prototype.getGroupRankInfo = function (t, e) {
                        var i = this, n = function (t) {
                            console.log("Get Group Rank Error: " + t);
                        };
                        if (!this._accesstoken || !this._userId) return n("not login."), e({
                            error: -1,
                            data: null
                        });
                        var r = this.mjpRankOrigin + "/" + this.mjpRank + "/rlist/sdg/get/?r=" + this.gameId + "&name=" + t + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                        console.log("group rank url:", r), this.adapter.http_request(r, null, "GET", "json", function (t) {
                            if (t.error) n(t.message), e({
                                error: -1,
                                data: null
                            }); else if (200 == t.code) {
                                for (var r = t.dates, a = t.my_sdg, s = t.ranks, o = r.sort(), l = [], h = 0, u = o.length; h < u; h++) {
                                    var c = o[h];
                                    if (8 !== c.length) return n("日期格式错误，必须为8位格式."), void e({
                                        error: -1,
                                        data: null
                                    });
                                    var d = i._dayStr2Timestamp(c), _ = d + 864e5, f = -1, p = 0, m = a[c];
                                    m && m[0] && (p = m[0], f = m[1] + 1);
                                    for (var g = s[c] || [], y = [], v = 0, S = g.length; v < S; v++) {
                                        var T = g[v], E = {
                                            value: T.score,
                                            nickname: T.nickname,
                                            gender: T.gender,
                                            avatarUrl: T.headimg
                                        };
                                        y.push(E);
                                    }
                                    var C = {
                                        beginTime: d,
                                        endTime: _,
                                        myRank: f,
                                        myValue: p,
                                        list: y
                                    };
                                    l.push(C);
                                }
                                e({
                                    error: 0,
                                    data: l
                                });
                            } else 404 == t.code ? (n("未获取到排行数据"), e({
                                error: 1,
                                data: null
                            })) : (n("获取排行异常 code" + t.code), e({
                                error: -1,
                                data: null
                            }));
                        }, function (t) {
                            n("request error:" + t), e({
                                error: -1,
                                data: null
                            });
                        });
                    }, t.prototype.setPlayerInfo = function (t) {
                        var e = this;
                        if (this._accesstoken && this._userId) {
                            var i = new Date().getTime(), n = {
                                headimg: t.avatarUrl,
                                nickname: t.nickName,
                                accesstoken: this._accesstoken,
                                gender: t.gender,
                                ts: i,
                                sign: r.default.hex_md5("gender=" + t.gender + "&headimg=" + t.avatarUrl + "&nickname=" + t.nickName + "&ts=" + i)
                            }, s = this.mjpUrl + "/user/set/userinfo/?r=" + this.gameId;
                            this.adapter.http_request(s, n, "POST", "json", function (t) {
                                t.error ? (e.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.SET_PLAYER_INFO),
                                    console.warn("================ setPlayerInfo fail:::: " + t.message)) : console.log("================ setPlayerInfo success:::: " + JSON.stringify(t));
                            }, function (t) {
                                e.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.SET_PLAYER_INFO),
                                    console.warn("================ request error:::: " + t);
                            });
                        }
                    }, t.prototype.setShareInfoCallback = function (t) { }, t.prototype.setShortcutCallback = function (t, e, i) { },
                    t.prototype.reportErrorInfo = function (t) {
                        setTimeout(function () {
                            throw new Error("reportErrorInfo " + t);
                        }, 10);
                    }, t.prototype.showMoreGamesModal = function (t, e, i, n) {
                        void 0 === n && (n = []);
                    }, t.prototype.showMoreGames = function () { }, t.prototype.getMoreGames = function (t) { },
                    t.prototype.getMoreGame2 = function (t) { }, t.prototype.showGameWithInfo = function (t) { },
                    t.prototype.setBannerRefreshDelay = function (t) {
                        for (var e in this._bannerRefreshDelay = t || a.default.BANNER_REFRESH_DELAY, this._loadedBannerAds) {
                            this._loadedBannerAds[e].setFreshDelay(this._bannerRefreshDelay);
                        }
                    }, t.prototype.loadBannerAd = function (t, e) {
                        if (this._bannerCls && this.supportBannerAd()) return this._loadBannerAd(t, e);
                    }, t.prototype.showBannerAd = function (t, e) {
                        this._bannerCls && (this.supportBannerAd() && (this.hideAllBannerAds(t), this._loadBannerAd(t, e).show()));
                    }, t.prototype.hideBannerAd = function (t) {
                        var e = this._loadedBannerAds[t];
                        e && (e.destroy(), delete this._loadedBannerAds[t]);
                    }, t.prototype.hideAllBannerAds = function (t) {
                        for (var e in this._loadedBannerAds) t !== e && this.hideBannerAd(e);
                    }, t.prototype._loadBannerAd = function (t, e) {
                        if (this._bannerCls) {
                            var i = this._loadedBannerAds[t];
                            return i || (i = new this._bannerCls(t, e)).setFreshDelay(this._bannerRefreshDelay),
                                this._loadedBannerAds[t] = i, i;
                        }
                    }, t.prototype.loadVideoAd = function (t, e, i) {
                        i && i("平台不支持加载视频广告");
                    }, t.prototype.showVideoAd = function (t, e) {
                        e && e("平台不支持显示视频广告");
                    }, t.prototype.destroyVideoAd = function () { }, t.prototype.showInsertAd = function (t, e) { },
                    t.prototype.hideInsertAd = function (t) { }, t.prototype.showBlockAd = function (t, e, i, n, r) { },
                    t.prototype.hideBlockAd = function () { }, t.prototype.keepSplash = function (t, e) { },
                    t.prototype.deviceVibrate = function (t) { }, t.prototype.getLaunchData = function () {
                        return null;
                    }, t.prototype.shareInfo = function (t, e, i, n, r, a, s, o) {
                        r && r("平台不支持分享");
                    }, t.prototype.shareInfoReal = function (t, e, i, n, r, a, s) {
                        return this.shareInfo(t, e, i, n, r, a, s);
                    }, t.prototype.createPlayerCenterIcon = function (t, e, i, n, r) { }, t.prototype.showPlayerCenterIcon = function () { },
                    t.prototype.hidePlayerCenterIcon = function () { }, t.prototype.bindPlayerCenterIcon = function (t) { },
                    t.prototype.checkAuthorizeUserInfo = function (t) {
                        t(!0);
                    }, t.prototype.authorizeUserInfo = function (t, e) {
                        e(!0);
                    }, t.prototype.bindUserInfoIcon = function (t, e) { }, t.prototype.showUserInfoIcon = function (t) { },
                    t.prototype.hideUserInfoIcon = function (t) { }, t.prototype.getSupportSoundType = function () {
                        return this.adapter.get_default_sound_type();
                    }, t.prototype.setBackPressCallback = function (t) {
                        this._backPressCallback = t;
                    }, t.prototype.exit = function () { }, t.prototype.checkResources = function (t, e) {
                        e && e(1), t && t();
                    }, t.prototype.getSafeArea = function () {
                        var t, e = this.adapter.get_frame_size();
                        if (e.height > e.width) {
                            if (e.height > 2 * e.width) return {
                                top: t = e.height / 2 - e.width,
                                left: 0,
                                right: 0,
                                bottom: t
                            };
                        } else if (e.width > 2 * e.height) return {
                            top: 0,
                            left: t = e.width / 2 - e.height,
                            right: t,
                            bottom: 0
                        };
                        return {
                            top: 0,
                            left: 0,
                            right: 0,
                            bottom: 0
                        };
                    }, t.prototype.getAppInfo = function () {
                        return "";
                    }, t.prototype.getDeviceID = function (t, e) {
                        t && t("");
                    }, t.prototype.getDistinctID = function (t, e) {
                        t && t("");
                    }, t.prototype.getTaInfo = function (t, e) {
                        t && t("");
                    }, t.prototype.openAppraise = function () { }, t.prototype.getMJPConfig = function (t, e, i) {
                        var n = this, r = this.mjpUrl + "/cf/gc/get/?r=" + this.gameId + "&name=" + t + "&timestamp=" + new Date().getTime();
                        console.log(r);
                        var s = {}, o = this.getDevice();
                        o && (s.pf = o.substr(0, 3).toLowerCase()), s.app = this.getPlatform(), this.adapter.http_request(r, s, "GET", "json", function (t) {
                            if (t.error) n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_MJP_CONFIG),
                                console.warn("get mjp config fail::: url = " + r + ", error: " + t.message), i && i("mjp return error::" + t.message); else {
                                var s = t.vo;
                                if (n._appVersion && s instanceof Object && s.default && s.default instanceof Object) {
                                    var o = s[s[n._appVersion] || "default"];
                                    o ? e && e(o) : (console.log("没有相应版本号的配置"), i && i("没有相应版本号的配置"));
                                } else e && e(s);
                            }
                        }, function (t) {
                            n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_MJP_CONFIG),
                                console.warn("get mjp config http request fail::: url = " + r), i && i("http error::" + t);
                        });
                    }, t.prototype.getMJPConfigAll = function (t, e, i) {
                        var n = this, r = this.mjpUrl + "/cf/gc/get/all/?r=" + this.gameId, s = {}, o = this.getDevice();
                        o && (s.pf = o.substr(0, 3).toLowerCase()), s.app = this.getPlatform(), s.names = t,
                            this.adapter.http_request(r, s, "POST", "json", function (s) {
                                if (s.error) n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_MJP_CONFIG),
                                    console.warn("get mjp config fail::: url = " + r + ", error: " + s.message), i && i("mjp return error::" + s.message); else {
                                    for (var o = s.vos, l = {}, h = 0; h < t.length; ++h) {
                                        var u = t[h], c = o["r" + n.gameId + "_" + u];
                                        if (n._appVersion && c instanceof Object && c.default && c.default instanceof Object) {
                                            var d = c[c[n._appVersion] || "default"];
                                            d ? l[u] = d : (console.log("没有相应版本号的配置: ", u), i && i("没有相应版本号的配置: " + u));
                                        }
                                    }
                                    e && e(l);
                                }
                            }, function (t) {
                                n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_MJP_CONFIG),
                                    console.warn("get mjp config http request fail::: url = " + r), i && i("http error::" + t);
                            });
                    }, t.prototype.getRandomUserInfo = function (t, e, i) {
                        // var n = this,
                        //  r = "https://api.sagiteam.cn/mjptool/user/random/?r=5096&num=" + t + "&timestamp=" + new Date().getTime();
                        // this.adapter.http_request(r, {}, "GET", "json", function (t) {
                        //     t.error ? (n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RANDOM_USERINFO),
                        //         i && i("mjp return error::" + t.message)) : e && e(t.users);
                        //         // console.log("randowuseinfo_____",JSON.stringify(t.users))
                        // }, 
                        // function (t) {
                        //     n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RANDOM_USERINFO),
                        //         i && i("http error::" + t);
                        // });



                    }, t.prototype.getTimestamp = function (t, e) {
                        var i = this, n = this.mjpOrigin + "/mjptool/util/timestamp/?r=" + this.gameId + "&accesstoken=" + this._accesstoken + "&timestamp=" + new Date().getTime();
                        this.adapter.http_request(n, {}, "GET", "json", function (r) {
                            r.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_TIME_STAMP),
                                console.warn("[mjp] api fail " + n + " " + JSON.stringify(r)), e ? e("mjp") : t(Date.now())) : t(1e3 * r.timestamp);
                        }, function (r) {
                            i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_TIME_STAMP),
                                console.warn("[mjp] http fail " + n + " " + r), e ? e("http") : t(Date.now());
                        });
                    }, t.prototype.setUserId = function (t) {
                        this._userId = t, this.setUserStorage("user_id", t), this.adapter.emit_event(p.USER_CHANGE);
                    }, t.prototype.getUserId = function () {
                        return this._userId || this.getUserStorage("user_id", void 0);
                    }, t.prototype.checkPubAccountState = function (t) {
                        t(!1);
                    }, t.prototype.enterPubAccountCard = function () { }, t.prototype.linkHttp = function (t) { },
                    t.prototype.setUserStorage = function (t, e, i) {
                        void 0 === i && (i = !0), this._openKeys || console.warn("Need to set open keys::::", new Error().stack),
                            null == this._storageData && (this._storageData = {});
                        var n = this._storageData;
                        if (!this._openKeys || -1 === this._openKeys.indexOf(t)) {
                            var r = n.private;
                            r || (r = {}, n.private = r), r[t] = e, delete n[t];
                        } else n[t] = e;
                        i && this.adapter.call_later(this, this.flushUserStorage);
                    }, t.prototype.flushUserStorage = function (t, e) {
                        var i = this;

                        var n = this._storageData, r = new Date().getTime();
                        // console.log("存数据2：", n)
                        this._cloudStorageInited && (n.update_time = r), n.create_time || (n.create_time = r);
                        for (var a = JSON.stringify(n), s = 0, o = this._userStorageKeys; s < o.length; s++) {
                            var l = o[s];

                            this.adapter.set_local_item(l, a);
                            // console.log("in flushUserStorage this._cloudStorageInited=", a);
                        }
                        // if (this._cloudStorageInited) {
                        //     var h = new Date().getTime(), u = h - this._lastFlushTime;
                        //     this._timeDely - u < 0 ? this._timeDely = 2e4 : this._timeDely - u < 1e3 ? this._timeDely = 1e3 : this._timeDely -= u,
                        //         this._isTidy = 1;
                        //     this._timeOutID && clearTimeout(this._timeOutID), this._timeOutID = null, this._timeOutID = setTimeout(function () {
                        //         i._isTidy = 2, i.retryExcSetUser(3, t, e);
                        //     }, this._timeDely), this._lastFlushTime = h;
                        // }
                    }, t.prototype.retryExcSetUser = function (t, e, i) {
                        var n = this;
                        this._setUserMjpStorage(function () {
                            n._timeOutID && clearTimeout(n._timeOutID), n._timeOutID = null, n._isTidy = 0,
                                e && e(), console.log("数据上传成功!", new Date().getTime());
                        }, function () {
                            return console.log("数据上传失败!", new Date().getTime()), console.log("重试第" + t + "次!"),
                                0 == t ? (console.log("数据上传失败！"), n._timeOutID && clearTimeout(n._timeOutID), n._timeOutID = null,
                                    void (i && i())) : n.retryExcSetUser(t - 1, e, i);
                        });
                    }, t.prototype.clearUserStorage = function () {
                        // this.adapter.clear_local(), this._storageData && this._storageData.private && (this._storageData.private = {}),
                        //     this._onUserLocalStorageReset(this._storageData), this._cloudStorageInited = !0,
                        //     this.retryExcSetUser(0);
                    }, t.prototype.getUserStorage = function (t, e) {
                        if (void 0 === e && (e = null), !this._storageData) return console.warn("---------------\x3e sdk has not init <----------------"),
                            e;
                        var i = this._storageData[t];
                        if (void 0 === i || null == i) {
                            var n = this._storageData.private;
                            n && (i = n[t]);
                        }
                        return null == i ? e : i;
                    }, t.prototype._setUserMjpStorage = function (t, e) {
                        var i = this;
                        if (!this._storageData) return console.warn("---------------\x3e sdk has not init <----------------");
                        if (!this._accesstoken) return console.warn("user has not logined");
                        if (this.isDebug && -1 == a.default.CACHE_TEST_ID || !this.isDebug && -1 == a.default.CACHE_PROP_ID) return console.warn("has not use cache");
                        var n = {};
                        for (var s in this._storageData) "object" != typeof this._storageData[s] && "boolean" != typeof this._storageData[s] && (n[s] = this._storageData[s]);
                        var o = new Date().getTime();
                        n.ts = o;
                        var l = Object.keys(n);
                        l.sort(function (t, e) {
                            return t.toLowerCase() > e.toLowerCase() ? 1 : -1;
                        });
                        var h = "";
                        l.forEach(function (t, e) {
                            h += t + "=" + n[t] + "&";
                        }), h = h.substr(0, h.length - 1);
                        var u = {
                            value: this._storageData,
                            accesstoken: this._accesstoken,
                            ts: o,
                            sign: r.default.hex_md5(h)
                        };
                        this._gameDataModel ? (console.log(">>>> 上报原始数据："), u.value.private = this._gameDataModel.mjpData) : console.log(">>>> 无 gameDataModel："),
                            console.log("加密前:" + h), console.log("加密后:" + r.default.hex_md5(h)), console.log("发送的数据:", JSON.stringify(u));
                        var c = "";
                        this.isDebug && 0 == a.default.CACHE_TEST_ID || !this.isDebug && 0 == a.default.CACHE_PROP_ID ? (c = this.mjpUrl + "/cache/set/?r=" + this.gameId,
                            console.log("isDebug", c)) : (c = this.mjpOrigin + "/" + this.mjpCache + "/user/set/?r=" + this.gameId,
                                console.log("isnot Debug", c)), console.log("setUserMjpStorage链接", c), this.adapter.http_request(c, u, "POST", "json", function (n) {
                                    n.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.SET_USER_MJP_STORAGE),
                                        console.warn("================ setUserMjpStorage fail:::: " + n.message), e && e()) : (console.log("================ setUserMjpStorage success:::: " + JSON.stringify(n)),
                                            t && t());
                                }, function (t) {
                                    i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.SET_USER_MJP_STORAGE),
                                        console.warn("================ request error:::: " + t), e && e();
                                });
                    }, t.prototype._getUserMjpStorage = function () {
                        var t = this;
                        if (!this._storageData) return console.warn("---------------\x3e sdk has not init <----------------");
                        if (!this._accesstoken || !this._userId) return console.warn("user has not logined");
                        if (this.isDebug && -1 == a.default.CACHE_TEST_ID || !this.isDebug && -1 == a.default.CACHE_PROP_ID) return console.warn("has not use cache");
                        var e = "";
                        e = this.isDebug && 0 == a.default.CACHE_TEST_ID || !this.isDebug && 0 == a.default.CACHE_PROP_ID ? this.mjpUrl + "/cache/get/?r=" + this.gameId + "&invitecode=" + this._userId + "&accesstoken=" + encodeURIComponent(this._accesstoken) : this.mjpOrigin + "/" + this.mjpCache + "/user/get/?r=" + this.gameId + "&invitecode=" + this._userId + "&accesstoken=" + encodeURIComponent(this._accesstoken),
                            console.log("getUserMjpStorage链接", e), this.adapter.http_request(e, null, "GET", "json", function (e) {
                                if (e.error) return 404 == e.code ? (console.log("================ mjp not found user and clear local data!"),
                                    t.clearUserStorage()) : t.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_USER_MJP_STORAGE),
                                    console.warn("================ getUserMjpStorage fail:::: " + e.message);
                                if (console.log("================  getUserMjpStorage success:::: " + JSON.stringify(e)),
                                    t._cloudStorageInited = !0, e.value) {
                                    var i = e.value, n = i.create_time, r = t._storageData.create_time, s = i.update_time, o = t._storageData.update_time;
                                    n && !r || s && !o || n && s && o - r < s - n ? (console.log("=============== mjp data to local"),
                                        t._onUserLocalStorageReset(e.value), t.flushUserStorage()) : (console.log("=============== local data to mjp"),
                                            t.flushUserStorage());
                                }
                            }, function (e) {
                                return t.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_USER_MJP_STORAGE),
                                    console.warn("================ request error:::: " + e);
                            });
                    }, t.prototype.fetchFriendOpenData = function (t, e, i, n, r, a) {
                        i && i("平台不支持获取玩家信息");
                    }, t.prototype.fetchUserInfo = function (t, e) { }, t.prototype.skipToGame = function (t, e, i, n, r) { },
                    t.prototype.previewImage = function (t, e, i) { }, t.prototype.formatHeadUrl = function (t) {
                        return t;
                    }, t.prototype.setPlatformLoadingProgress = function (t) { }, t.prototype.onPlatformLoadingComplete = function () { },
                    t.prototype._initUserStorage = function () {
                        var t = this._default_storage_key;
                        if (this._storageData) this.adapter.emit_event(p.STORAGE_RESET, this._storageData.private); else {
                            var e = null, i = this.adapter.get_local_item(t);
                            if (i) try {
                                e = JSON.parse(i);
                            } catch (t) {
                                console.warn(" parse user storage error with string: ", i);
                            }
                            this._userStorageKeys = [t], this._onUserLocalStorageReset(e || {});
                        }
                    }, t.prototype._onUserLocalStorageReset = function (t) {
                        var e = null;
                        this._storageData && (e = this.getUserStorage("guid", null)), this._storageData = t,
                            null === this.getUserStorage("guid", null) && (e = e || function () {
                                for (var t = [], e = 0; e < 8; e++) t.push((65536 * (1 + Math.random()) | 0).toString(16).substring(1));
                                return t.join("");
                            }(), this.setUserStorage("guid", e)), this.adapter.emit_event(p.STORAGE_RESET, t.private);
                    }, Object.defineProperty(t.prototype, "gameDataModel", {
                        set: function (t) {
                            this._gameDataModel = t;
                        },
                        enumerable: !1,
                        configurable: !0
                    }), t.prototype._onBackPressed = function () {
                        this.supportBackExit() ? this.onBackPressed() : this._backPressCallback && this._backPressCallback();
                    }, t.prototype._init = function () {
                        this._initUserStorage(), "native" === this.getPlatform() && this.adapter.on_key_back(this._onBackPressed.bind(this));
                    }, t.prototype._onMjpLoginSuccess = function (t) {
                        this._accesstoken = t.accesstoken, this._channel = t.channel, this.setUserStorage("last_mjp_token", t.accesstoken);
                    }, t.prototype._getMjpLoginUrl = function (t, e) {
                        var i = "" + this.mjpUrl + t + "/?r=" + this.gameId;
                        e && (i += "&" + e), i += "&getfollows=1&id=" + this.guid;
                        var n = this.getUserStorage("last_mjp_token", null);
                        return n && (i += "&accesstoken=" + n), i += "&timestamp=" + new Date().getTime();
                    }, t.prototype._mjpCollection = function (t, e) {
                        var i = this;
                        if (null !== this._accesstoken && null !== this._channel) {
                            (e = e || {}).type = t, e.channel = this._channel, e.accesstoken = this._accesstoken;
                            var n = this.mjpUrl + "/cf/audible/?r=" + this.gameId + "&timestamp=" + new Date().getTime();
                            this.adapter.http_request(n, e, "POST", "json", function (t) {
                                t.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_COLLECTION),
                                    console.warn("mjp collection request fail ::: " + t.code + n)) : console.log("mjp collection request success >>>>>>>> ");
                            }, function (r, s) {
                                i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_COLLECTION),
                                    console.warn("mjp collection request fail::: " + n + " error: " + r), console.log(">>>>>>> ", JSON.stringify(e)),
                                    s && i.adapter.call_later(i, function () {
                                        this._mjpCollection(t, e);
                                    });
                            });
                        } else console.warn("========== cannot collection mjp info without login!!");
                    }, t.prototype.addShort = function (t, e) {
                        t && t();
                    }, t.prototype.checkShort = function (t, e) {
                        t && t();
                    }, t.prototype.mjpAudible = function (t, e) {
                        var i = this;
                        if (null !== this._accesstoken && null !== this._channel) {
                            var n = {};
                            n.type = t, n.channel = this._channel, n.accesstoken = this._accesstoken, n.values = e;
                            var r = this.mjpUrl + "/cf/audible/?r=" + this.gameId + "&timestamp=" + new Date().getTime();
                            this.adapter.http_request(r, n, "POST", "json", function (t) {
                                t.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_AUDIBLE),
                                    console.warn("mjp collection request fail2 ::: " + t.code + r)) : console.log("mjp collection request success2 >>>>>>>> ");
                            }, function (s, o) {
                                i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_AUDIBLE), console.warn("mjp collection request fail2::: " + r + " error: " + s),
                                    console.log(">>>>>>> ", JSON.stringify(n)), o && i.adapter.call_later(i, function () {
                                        this.mjpAudible(t, e);
                                    });
                            });
                        } else console.warn("========== cannot collection mjp info without login!!");
                    }, t.prototype._onShow = function (t) {
                        this._showTime = new Date().getTime(), this.adapter.emit_event(p.ON_SHOW, t);
                    }, t.prototype._onHide = function () {
                        if (this._cloudStorageInited && 0 != this._isTidy && (this._isTidy = 2, this._timeOutID && clearTimeout(this._timeOutID),
                            this.retryExcSetUser(3)), this.adapter.emit_event(p.ON_HIDE), this._showTime) {
                            var t = new Date().getTime() - this._showTime;
                            this._mjpCollection(_.LOGOUT, {
                                logintime: 0,
                                duration: t / 1e3
                            });
                        } else console.warn("Why show time is null when game hide?!");
                    }, t.prototype.recordStart = function (t, e) { }, t.prototype.recordStop = function (t) { },
                    t.prototype.recordPause = function () { }, t.prototype.recordResume = function () { },
                    t.prototype.recordClip = function (t) {
                        return 0;
                    }, t.prototype.recordClipVideo = function (t) { }, t.prototype.recordShare = function (t) { },
                    t.prototype.unlink = function (t, e, i) { }, t.prototype.postFGUIPackage = function (t) { },
                    t.prototype.addOpenContextRenerTask = function (t, e, i, n) { }, t.prototype.removeOpenContextRenderTask = function (t, e) {
                        void 0 === e && (e = !0);
                    }, t.prototype.getPrize = function (t, e, i) {
                        if (!this._accesstoken) return i && i("user has not logined");
                        var n = this.mjpPrizeOrigin + "/" + this.mjpPrize + "/redeem/consume/?r=" + this.gameId;
                        this.adapter.http_request(n, {
                            code: t,
                            accesstoken: this._accesstoken
                        }, "POST", "json", function (t) {
                            console.log("================ prize:::: ", t), t.error ? i && i(t) : e && e(t.prize);
                        }, function (t) {
                            i && i(t);
                        });
                    }, t.prototype.getReleasenote = function (t, e) {
                        var i = this, n = this.mjpUrl + "/cf/releasenote/get/?r=" + this.gameId + "&ver=" + this._appVersion + "&aslist=0";
                        this.adapter.http_request(n, null, "GET", "json", function (n) {
                            return n.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RELEASENOTE),
                                console.warn("================ getReleasenote fail:::: " + n.message), e && e()) : (console.log("================  getReleasenote success:::: " + JSON.stringify(n)),
                                    console.log("================  getReleasenote success:::: " + JSON.stringify(n.vo)),
                                    console.log("================  getReleasenote success:::: " + JSON.stringify(n.vo.msg)),
                                    n.vo.msg ? t && t(n.vo.msg) : void 0);
                        });
                    }, t.prototype.subscribeMsgToMjp = function (t, e) {
                        var i = this, n = {};
                        n.invitecode = this._userId, n.template_id = t, n.ensure = e ? 1 : 0;
                        var r = this.mjpOrigin + "/mjpmp/qq2mini/subscription/ensure/?r=" + this.gameId;
                        this.adapter.http_request(r, n, "POST", "json", function (t) {
                            t.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_SUBSCRIBE),
                                console.warn("mjp subscribe request fail2 ::: " + t.code + r)) : console.log("mjp subscribe request success2 >>>>>>>> ");
                        }, function (s, o) {
                            i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_SUBSCRIBE),
                                console.warn("mjp subscribe request fail2::: " + r + " error: " + s), console.log(">>>>>>> ", JSON.stringify(n)),
                                o && i.adapter.call_later(i, function () {
                                    this.subscribeMsgToMjp(t, e);
                                });
                        });
                    }, t.prototype.getPlayerRedBagsMoney = function (t, e) {
                        var i = this;
                        if (!this._accesstoken || !this._userId) return e && e("user has not logined");
                        var n = this.mjpOrigin + "/mjpmp1/qqwallet/balance/get/?r=" + this.gameId + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                        this.adapter.http_request(n, null, "GET", "json", function (n) {
                            n.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RED_BAGS_MONEY),
                                console.warn("================  getPlayerRedBagsMoney fail:::: " + n.message), e && e("login bylogintoken request fail")) : (console.log("================  getPlayerRedBagsMoney success:::: " + JSON.stringify(n)),
                                    n && t && t(n));
                        }, function (t) {
                            i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RED_BAGS_MONEY),
                                console.warn("================ request error:::: " + t), e && e("getPlayerRedBagsMoney request error");
                        });
                    }, t.prototype.getPlayerRedBagsTaskInfo = function (t, e) {
                        var i = this;
                        if (!this._accesstoken || !this._userId) return e && e("user has not logined");
                        var n = this.mjpOrigin + "/mjpmp1/moneytask/task/get/?r=" + this.gameId + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                        this.adapter.http_request(n, null, "GET", "json", function (n) {
                            n.error ? (i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RED_BAGS_TASK_INFO),
                                console.warn("================  getPlayerRedBagsTaskInfo fail:::: " + n.message),
                                e && e("login bylogintoken request fail")) : (console.log("================  getPlayerRedBagsTaskInfo success:::: " + JSON.stringify(n.tasks)),
                                    n.tasks && t && t(n.tasks));
                        }, function (t) {
                            i.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_RED_BAGS_TASK_INFO),
                                console.warn("================ request error:::: " + t), e && e("getPlayerRedBagsTaskInfo request error");
                        });
                    }, t.prototype.mjpPlayerRedBagsTaskInfo = function (t, e, i) {
                        var n = this;
                        if (!this._accesstoken || !this._userId) return i && i("user has not logined");
                        var s = this.mjpOrigin + "/mjpmp1/moneytask/task/set/?r=" + this.gameId, o = {}, l = new Date().getTime();
                        o.ts = l;
                        for (var h = 0; h < t.length; h++) o["" + t[h]] = t[h];
                        var u = Object.keys(o);
                        u.sort(function (t, e) {
                            return t.toLowerCase() > e.toLowerCase() ? 1 : -1;
                        });
                        var c = "";
                        u.forEach(function (t, e) {
                            c += t + "=" + o[t] + "&";
                        }), c = c.substr(0, c.length - 1);
                        var d = {
                            accesstoken: this._accesstoken,
                            tasks: t,
                            ts: l,
                            sign: r.default.hex_md5(c)
                        };
                        this.adapter.http_request(s, d, "POST", "json", function (t) {
                            t.error ? (n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_RED_BAGS_TASK_INFO),
                                console.warn("mjpPlayerRedBagsTaskInfo request fail2 ::: " + t.code + s)) : (console.log("mjpPlayerRedBagsTaskInfo request success2 >>>>>>>> " + JSON.stringify(t.tasks)),
                                    t.tasks && e && e(t.tasks));
                        }, function (t, e) {
                            n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_RED_BAGS_TASK_INFO),
                                console.warn("mjpPlayerRedBagsTaskInfo request fail2::: " + s + " error: " + t),
                                console.log(">>>>>>> ", JSON.stringify(d));
                        });
                    }, t.prototype.mjpPlayerRedBagsTaskGet = function (t, e, i) {
                        var n = this;
                        if (!this._accesstoken || !this._userId) return i && i("user has not logined");
                        var s = this.mjpOrigin + "/mjpmp1/moneytask/task/finish/?r=" + this.gameId, o = {}, l = new Date().getTime();
                        o.ts = l, o["" + t] = t;
                        var h = Object.keys(o);
                        h.sort(function (t, e) {
                            return t.toLowerCase() > e.toLowerCase() ? 1 : -1;
                        });
                        var u = "";
                        h.forEach(function (t, e) {
                            u += t + "=" + o[t] + "&";
                        }), u = u.substr(0, u.length - 1);
                        var c = {
                            accesstoken: this._accesstoken,
                            taskid: t,
                            ts: l,
                            sign: r.default.hex_md5(u)
                        };
                        this.adapter.http_request(s, c, "POST", "json", function (t) {
                            t.error ? (n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_RED_BAGS_TASK_GET),
                                console.warn("mjpPlayerRedBagsTaskGet request fail2 ::: " + t.code + s)) : (console.log("mjpPlayerRedBagsTaskGet request success2 >>>>>>>> " + JSON.stringify(t)),
                                    t && e && e(t));
                        }, function (t, e) {
                            n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.MJP_RED_BAGS_TASK_GET),
                                console.warn("mjpPlayerRedBagsTaskGet request fail2::: " + s + " error: " + t),
                                console.log(">>>>>>> ", JSON.stringify(c));
                        });
                    }, t.prototype.MJPCashWithDraw = function (t, e, i) { }, t.prototype.cleanPlayerRedBagsData = function (t, e) {
                        if (!this._accesstoken || !this._userId) return e && e("user has not logined");
                        var i = this.mjpOrigin + "/mjpmp1/moneytask/balance/clean/?r=" + this.gameId, n = {
                            accesstoken: this._userId
                        };
                        this.adapter.http_request(i, n, "POST", "json", function (i) {
                            i.error ? (console.warn("================  cleanPlayerRedBagsData fail:::: " + i.message),
                                e && e("login bylogintoken request fail")) : (console.log("================  cleanPlayerRedBagsData success:::: " + JSON.stringify(i)),
                                    i && t && t(i));
                        }, function (t) {
                            console.warn("================ request error:::: " + t), e && e("cleanPlayerRedBagsData request error");
                        });
                    }, t.prototype.getPlayerRankReward = function (t, e, i) {
                        var n = this;
                        if (console.log("getPlayerRankReward 111111111111111111:", t), !this._accesstoken) return i && i("_accesstoken is null!!");
                        var r = this.mjpRankOrigin + "/" + this.mjpRank + "/rlist/check_reward/?r=" + this.gameId + "&name=" + t + "&accesstoken=" + encodeURIComponent(this._accesstoken);
                        console.log("getPlayerRankReward url:", r), this.adapter.http_request(r, null, "GET", "json", function (t) {
                            t.error ? (n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_ENDLESS_AWARD),
                                console.warn("================  getPlayerRankReward fail:::: " + t.message), i && i("login bylogintoken request fail")) : (console.log("================  getPlayerRankReward success:::: " + JSON.stringify(t)),
                                    t.reward_info && e && e(t.reward_info));
                        }, function (t) {
                            n.adapter.emit_event(p.REQUEST_FAIL, a.default.REQUEST_FAIL_TYPE.GET_ENDLESS_AWARD),
                                console.warn("================ request error:::: " + t), i && i("getPlayerRankReward request error");
                        });
                    }, t.prototype.getSystemLanguage = function () {
                        return null;
                    }, t.prototype.setPluginNotifyHandler = function (t) { }, t.prototype.sendEventTo = function (t, e, i) { },
                    t.prototype.openTikPub = function (t, e) {
                        e && e("平台不支持");
                    }, t.prototype.isOnTik = function () {
                        return !1;
                    }, t.prototype.jumpToTikVideoById = function (t, e, i) {
                        e && e();
                    }, t.prototype.reportAnalytics = function (t, e) { }, t.prototype.showShareMenu = function (t, e, i) {
                        e && e("please use tt sdk");
                    }, t.prototype.hideShareMenu = function (t, e, i) {
                        e && e("please use tt sdk");
                    }, t.prototype.initTikVidoeCollection = function () { }, t;
            }();
            i.default = m;
        }, {
            "./md5": 326,
            "./sdkConstants": 329
        }],
        329: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = function () {
                function t() { }
                return t.AUTH_REGIONAL = "5068", t.MJP_TEST_ORIGIN = [][0] || "https://gst.sagiteam.cn",
                    t.MJP_PROD_ORIGIN = [][0] || "https://api.sagiteam.cn", t.MJP_AUTH_PROD_ORIGIN = [][0] || "https://api.sagiteam.cn",
                    t.MJP_RANK_TEST_ORIGIN = [][0] || "https://gst.sagiteam.cn", t.MJP_RANK_PROD_ORIGIN = [][0] || "https://api.sagiteam.cn",
                    t.MJP_PRIZE_TEST_ORIGIN = [][0] || "https://gst.sagiteam.cn", t.MJP_PRIZE_PROD_ORIGIN = [][0] || "https://api2.sagiteam.cn",
                    t.MJP_TEST_URL = t.MJP_TEST_ORIGIN + "/mjpauth1000", t.MJP_PROD_URL = t.MJP_AUTH_PROD_ORIGIN + "/mjpauth" + t.AUTH_REGIONAL,
                    t.TEST_GAME_SOCKET = [][0] || "ws://gst.sagigame.cn:10004", t.PROD_GAME_SOCKET = [][0] || "wss://sp7.sagigame.cn:10009",
                    t.TEST_PVP_SOCKET = [][0] || "ws://gst.sagiteam.cn:10001", t.PROD_PVP_SOCKET = [][0] || "wss://sp7.sagigame.cn:10011",
                    t.GAME_ID = 5068, t.GAME_THEME = "default", t.SUB_PACK_NAME = "resources", t.EOLINK_APP = [][0],
                    t.DEBUG = !1, t.PUB_ACCOUNT = [][0], t.PACKAGE_NAME = [][0], t.APP_ID = [][0], t.FACTORY_ID = [][0],
                    t.BANNER_STRICT_MODE = !1 !== [][0], t.BANNER_REFRESH_DELAY = [][0] || 0, t.ALD_ENABLE = !0,
                    t.RANK_TEST_ID = [][0] || 0, t.RANK_PROD_ID = 2101, t.PRIZE_TEST_ID = [][0] || 0,
                    t.PRIZE_PROD_ID = [][0] || 2401, t.CACHE_TEST_ID = [][0] || 0, t.CACHE_PROP_ID = 2201,
                    t.CENSORED_REGION_NAME = {
                        110000: "北京市",
                        440100: "广东省广州市",
                        440300: "广东省深圳市",
                        510100: "四川省成都市"
                    }, t.BANNERAD_NAME_UNITIDS = {
                        ADD_COIN_BANNER: "adunit-01ea4302bb45fce3",
                        CHEST_OPEN: "adunit-6aa750b68085f525",
                        CHEST_REWARD: "adunit-2b8eb12cfdc1dcc1",
                        CHEST_ACCELERATE: "adunit-671fd1e3cedac7b7",
                        SCORE_BANNER: "adunit-eb4b0fae4893b9ce",
                        HOME_BANNER: "adunit-00fcd80826c02b84",
                        SETTLE_BANNER: "adunit-c92f0ec0de7991bb",
                        MATCH_BANNER: "adunit-61b2e9b201ae22bc",
                        RANK_BANNER: "adunit-0b70422973c0a476",
                        SKIN_BANNER: "adunit-3492032f23cf3704",
                        SAGIAD_BANNER: "adunit-82b1cff245bdeb79",
                        INVITE_REWARD_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        TRY_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        OPENCHEST_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        GOAL_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        LUCKY_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        FRAGMENT_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        ADD_PLAYER_BANNER: ["adunit-94a670b11b554ef1", "adunit-2adb795d3370c676", "adunit-7116124725245c06", "adunit-cb0ec0e051dca707", "adunit-fd7b9abfeb3d59ac", "adunit-d09d4cff416cd93e", "adunit-0c2d1ba07a659db8"],
                        VIDEO_SHARE: "adunit-e22677323eb6fb75"
                    }, t.VIDEOAD_NAME_UNITIDS = {
                        LUCK_SLOT: "adunit-a4901f4de48be352",
                        SETTLE_DOUBLE: "adunit-92b76f7c7d6ca2bd",
                        ADD_COIN: "adunit-3deaa5258d5af228",
                        UPGRADE_CHEST: "adunit-24d8daa284d6597e",
                        OPEN_CHEST: "adunit-3ea225fda3172557",
                        VIDEO_SKIN: "adunit-6cca6a23ded2779e",
                        SKIN_TRY: "adunit-4290b759454bb8ea",
                        AUTO_CHEST: "adunit-194c17fcf0ea5391",
                        CHEST_DOUBLE: "adunit-df481ff310696b2f"
                    }, t.INSERTAD_NAME_UNITIDS = {
                        INTER_HOME: "adunit-502b3a20a14f46b4"
                    }, t.REQUEST_FAIL_TYPE = {
                        SET_USER_MJP_STORAGE: 0,
                        GET_USER_MJP_STORAGE: 1,
                        MJP_LOGIN: 2,
                        MJP_COMMIT_AUTHORIZE: 3,
                        MJP_LOGIN_TOKEN: 4,
                        GET_MORE_GAME: 5,
                        EO_LINK_LOGIN: 6,
                        EO_LINK_AUTHSTATIS: 7,
                        GET_MORE_GAME2: 8,
                        GET_EO_LINK_USERDATA: 9,
                        SAVA_EO_LINK_USERDATA: 10,
                        EO_LINK_OPEN_STATIS: 11,
                        EO_LINK_RETAIN_STATIS: 12,
                        EO_LINK_TRANSFORM_STATIS: 13,
                        EO_LINK_AD_STATIS: 14,
                        MJP_COLLECTION: 15,
                        MJP_AUDIBLE: 16,
                        GET_IP_AND_CITY: 17,
                        UPDATE_WORLD_RANKINFO: 18,
                        GET_WORLD_RANKINFO: 19,
                        SET_PLAYER_INFO: 20,
                        GET_MJP_CONFIG: 21,
                        GET_RANDOM_USERINFO: 22,
                        GET_TIME_STAMP: 23,
                        GET_IP_SUCCESS: 24,
                        GET_KF_REWARD_STATUS: 25,
                        GET_KF_REWARD: 26,
                        GET_RELEASENOTE: 27,
                        MJP_SUBSCRIBE: 28,
                        GET_RED_BAGS_MONEY: 29,
                        GET_RED_BAGS_TASK_INFO: 30,
                        MJP_RED_BAGS_TASK_INFO: 31,
                        MJP_RED_BAGS_TASK_GET: 32,
                        GET_ENDLESS_AWARD: 33
                    }, t;
            }();
            i.default = n;
        }, {}],
        330: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_jiajinbi"), s = t("../data/UserData"), o = t("./Toast"), l = t("../game/HomeConstants"), h = t("../sdk/sdk"), u = t("../data/MjpHelper"), c = t("../data/config/RewardConfig"), d = t("../GlobalFuncs");
            function _(t) {
                var e = c.default.ADD_COIN_REWARD;
                return e[Math.min(t, e.length - 1)];
            }
            var f = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGbc.onClick(this, this.hide), t.m_btnLqjbi.onClick(this, this.onClickVideo),
                        t.m_btnLqjbfx.onClick(this, this.onClickShare);
                }, e.prototype.setData = function (t) {
                    var e = this._root, i = s.default.getInstance().dailyAddCoinTimes, n = _(i);
                    e.m_iconJinbic.url = "ui://ui/jinbi", e.m_labYqxwj.text = n.toString(), e.m_labSycs.text = "剩余次数：" + (l.default.DAILY_MAX_ADD_COIN_TIMES - i),
                        e.m_c1.selectedIndex = t ? 1 : 0;
                }, e.prototype.onShow = function () {
                    h.default.showBannerAd("ADD_COIN_BANNER", d.default.getBannerRectWithHeight(210));
                }, e.prototype.onHide = function () {
                    h.default.hideBannerAd("ADD_COIN_BANNER");
                }, e.prototype.onClickVideo = function () {
                    var t = this;
                    if (s.default.getInstance().dailyAddCoinTimes > l.default.DAILY_MAX_ADD_COIN_TIMES) return o.default.toast("今日次数已达上限，请明日再来"),
                        this.hide();
                    u.default.showVideoAd(function () {
                        t.gainCoin(!1), t.hide();
                    }, function () {
                        o.default.toast("视频未播放结束，无法获得金币");
                    });
                }, e.prototype.onClickShare = function () {
                    var t = this;
                    if (s.default.getInstance().dailyAddCoinTimes > l.default.DAILY_MAX_ADD_COIN_TIMES) return o.default.toast("今日次数已达上限，请明日再来"),
                        this.hide();
                    var e = u.default.getRandomShareInfo();
                    e.query.source = "addcoin", h.default.shareInfo(e.title, e.imageUrl, e.query, function () {
                        t.gainCoin(!0), t.hide();
                    }, function (t) {
                        console.log("share fail reason:" + t), o.default.toast("分享失败，无法获得金币");
                    });
                }, e.prototype.gainCoin = function (t) {
                    var e = s.default.getInstance(), i = e.dailyAddCoinTimes, n = _(i);
                    e.dailyAddCoinTimes = i + 1, e.gainCoin(n, "add_coin_" + (t ? "share" : "video"), !0),
                        o.default.toast("获得金币 * " + n);
                }, e;
            }(n.default);
            i.default = f;
        }, {
            "../GlobalFuncs": 7,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/config/RewardConfig": 28,
            "../fgui/ui/UI_jiajinbi": 104,
            "../game/HomeConstants": 129,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        331: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../sdk/sdk"), s = t("./Toast"), o = t("../EventCenter"), l = t("../Events"), h = t("../fgui/ui/UI_addPlayers"), u = t("../CommonUIBehaviors"), c = t("../data/UserData"), d = function (t) {
                function e() {
                    var e = t.call(this, ["ui"], h.default, null, !1, !0, !0) || this;
                    return e.modelInfo = {
                        url: null,
                        modelTextures: null,
                        animation: "run_slow",
                        position: new Laya.Vector3(0, 0, 0),
                        rotation: new Laya.Vector3(0, -45, 0),
                        cameraViewFiled: 30,
                        cameraPosition: new Laya.Vector3(10, 1, 3.3),
                        cameraRotation: new Laya.Vector3(-5, 0, 0),
                        cameraViewPort: null
                        //xiangji1
                    }, e;
                }
                return r(e, t), e.prototype.setData = function (t, e) {
                    this.onSuccess = e, this.skin = t, this.modelInfo.url = t.model, this.modelInfo.modelTextures = t.modelTextures,
                        o.default.emit(l.default.UI_SHOW_MODEL, this.modelInfo), this._root.m_labPfmc.text = t.name;
                }, e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btn_add.onClick(this, this.onAddClick);
                    var e = t.m_night, i = e.width, n = e.height, r = e.x, a = e.y;
                    e.pivotAsAnchor && (r -= i * e.pivotX, a -= n * e.pivotY);
                    var s = t.localToGlobal(r, a), o = t.localToGlobal(r + i, a + n);
                    this.modelInfo.cameraViewPort = new Laya.Viewport(s.x, s.y, o.x - s.x, o.y - s.y),
                        this.root.m_btn_add.onClick(this, this.onAddClick), this.root.m_prgSuipian.update(100);
                }, e.prototype.onAddClick = function () {
                    this.addNum++, this.refreshAddNum();
                }, e.prototype.onShow = function () {
                    u.MisleadBanner(this.root.m_btn_add, "ADD_PLAYER_BANNER", this, function () { }),
                        this.addNum = 0, this.refreshAddNum(), this.startCountDown(), this.root.m_btn_add.visible = !0;
                }, e.prototype.refreshAddNum = function () {
                    this.root.m_lab_num.text = this.addNum.toString();
                }, e.prototype.startCountDown = function () {
                    this.stopCountDown(), this.targetFrame = 150, this.nowFrame = 0, Laya.timer.frameLoop(1, this, this.frameUpdate);
                }, e.prototype.stopCountDown = function () {
                    Laya.timer.clear(this, this.frameUpdate);
                }, e.prototype.frameUpdate = function () {
                    this.nowFrame++, this.root.m_prgSuipian.update((this.targetFrame - this.nowFrame) / this.targetFrame * 100),
                        this.nowFrame >= this.targetFrame && this.onCoundDown();
                }, e.prototype.onCoundDown = function () {
                    this.stopCountDown(), s.default.toast("下一局游戏将额外增加" + this.addNum + "人"), this.root.m_btn_add.visible = !1,
                        Laya.timer.frameOnce(90, this, this.hide);
                }, e.prototype.onHide = function () {
                    a.default.hideBannerAd("ADD_PLAYER_BANNER"), o.default.emit(l.default.UI_HIDE_MODEL),
                        c.default.getInstance().luckGot(), this.onSuccess && (this.onSuccess.run(), this.onSuccess = null);
                }, e.prototype.onBtnSkip = function () { }, e;
            }(n.default);
            i.default = d;
        }, {
            "../CommonUIBehaviors": 3,
            "../EventCenter": 4,
            "../Events": 5,
            "../data/UserData": 20,
            "../fgui/ui/UI_addPlayers": 59,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        332: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../fgui/ui/UI_baoxiangjiasu"), a = t("./ViewBase"), s = t("../IData"), o = t("../data/UserData"), l = t("./Toast"), h = t("../sdk/sdk"), u = t("../data/MjpHelper"), c = t("./Modal"), d = t("./ChestOpenModal"), _ = t("../GlobalFuncs"), f = t("../data/ChestHelper"), p = t("../data/skin/SkinData"), m = function (t) {
                function e() {
                    return t.call(this, ["ui"], n.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGbb.onClick(this, this.hide), t.m_btnFxsy.onClick(this, this.onClickShareOpen),
                        t.m_btnSpkq.onClick(this, this.onClickVideoOpen), t.m_btnJbkq.onClick(this, this.onClickCoinOpen);
                }, e.prototype.setData = function (t, e, i) {
                    this.chest = t, this.chestIndex = e;
                    var n = f.default.getChestConfig(t.id), r = this._root;
                    r.m_labBxmc.text = n.name, r.m_iconBaoxiang.url = n.icon, r.m_labSycs.text = "剩余次数：" + o.default.getInstance().freeOpenChestTimes,
                        h.default.supportShare() || 0 === i && (i = 2), r.m_c1.selectedIndex = i, r.m_c2.selectedIndex = n.dropLevel - 1,
                        this.updateTimer(), this.showFragmentText(t);
                }, e.prototype.onShow = function () {
                    this.startTimer(), h.default.showBannerAd("CHEST_ACCELERATE", _.default.getBannerRectWithHeight(210));
                }, e.prototype.onHide = function () {
                    h.default.hideBannerAd("CHEST_ACCELERATE"), this.stopTimer(), this.chest = null;
                }, e.prototype.showFragmentText = function (t) {
                    t.id;
                    for (var e = [], i = 0, n = 0, r = f.default.getChestConfig(t.id).drops.map(function (t) {
                        return t.id;
                    }); n < r.length; n++) {
                        var a = r[n];
                        o.default.getInstance().hasOwnSkinId(a) || e.push(a);
                    }
                    e.length && (i = e[Math.floor(Math.random() * e.length)]);
                    var s = this._root;
                    if (s.m_fragment_group.visible = !!i, i) {
                        var l = 60 + Math.floor(30 * Math.random()), h = p.default.getSkinData(i).name;
                        s.m_lab_odd.text = l + "%", s.m_lab_fragment.text = "" + h;
                    }
                }, e.prototype.stopTimer = function () {
                    Laya.timer.clear(this, this.updateTimer);
                }, e.prototype.startTimer = function () {
                    this.stopTimer(), Laya.timer.loop(1e3, this, this.updateTimer);
                }, e.prototype.onClickVideoOpen = function () {
                    var t = this;
                    if (this.chest) {
                        var e = o.default.getInstance();
                        if (e.freeOpenChestTimes <= 0) return l.default.toast("今日次数已达上限，请明日再来");
                        this.stopTimer(), u.default.showVideoAd(function () {
                            e.accelerateChest(t.chestIndex, 1 / 0, !1), t.openChest(s.ChestOpenType.Video);
                        }, function () {
                            t.startTimer(), l.default.toast("视频未播放结束，无法开启");
                        });
                    }
                }, e.prototype.onClickShareOpen = function () {
                    var t = this;
                    if (this.chest) {
                        var e = o.default.getInstance();
                        if (e.freeOpenChestTimes <= 0) return l.default.toast("今日次数已达上限，请明日再来");
                        var i = u.default.getRandomShareInfo();
                        i.query.source = "openchest", this.stopTimer(), h.default.shareInfo(i.title, i.imageUrl, i.query, function () {
                            e.accelerateChest(t.chestIndex, 1 / 0, !1), t.openChest(s.ChestOpenType.Share);
                        }, function () {
                            t.startTimer(), l.default.toast("分享失败，无法开启");
                        });
                    }
                }, e.prototype.onClickCoinOpen = function () {
                    if (this.chest) {
                        var t = o.default.getInstance(), e = f.default.getOpenChestCost(this.chest, t.getNowSecond());
                        if (!t.costCoin(e, "openchest")) return this.onCoinNotEnough();
                        t.accelerateChest(this.chestIndex, 1 / 0, !1), this.openChest(s.ChestOpenType.Coin);
                    }
                }, e.prototype.updateTimer = function () {
                    var t = {
                        leftTime: 0
                    }, e = f.default.getOpenChestCost(this.chest, o.default.getInstance().getNowSecond(), t), i = this._root;
                    i.m_labJbsz.text = e + "", i.m_labSydjs.text = "开启剩余倒计时：" + _.default.formatTimeStringZh(t.leftTime);
                }, e.prototype.openChest = function (t) {
                    c.default.showModal(d.default, this.chestIndex, this.chest, t), this.hide();
                }, e.prototype.onCoinNotEnough = function () {
                    return l.default.toast("金币不足，无法开启宝箱");
                }, e;
            }(a.default);
            i.default = m;
        }, {
            "../GlobalFuncs": 7,
            "../IData": 8,
            "../data/ChestHelper": 16,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/skin/SkinData": 32,
            "../fgui/ui/UI_baoxiangjiasu": 63,
            "../sdk/sdk": 327,
            "./ChestOpenModal": 333,
            "./Modal": 344,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        333: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_baoxiangkaiqi"), s = t("../IData"), o = t("../GlobalFuncs"), l = t("../fgui/ui/UI_baoxiangjl"), h = t("../data/skin/SkinData"), u = t("../sdk/sdk"), c = t("../data/ChestHelper"), d = t("../data/UserData"), _ = t("./Toast"), f = t("./Loading"), p = t("../VideoHelper"), m = t("../data/MjpHelper"), g = t("../CommonUIBehaviors"), y = new fairygui.GObjectPool(), v = new Laya.Point(), S = new Laya.Point();
            function T(t, e) {
                var i = t.m_iconPifuspJinbi, n = t.m_iconPfjibie, r = t.m_labJbs, a = t.m_c1;
                switch (e.type) {
                    case s.RewardType.Coin:
                        i.url = "ui://ui/jinbi", r.text = "x" + e.amount, n.url = null, a.selectedIndex = 0,
                            t.data = null;
                        break;

                    case s.RewardType.Skin:
                        var o = h.default.getSkinData(e.id);
                        i.url = o.icon, r.text = "", n.url = "ui://ui/pfjb" + o.level, a.selectedIndex = o.level - 1,
                            t.data = t.getTransitionAt(o.level - 2);
                        break;

                    case s.RewardType.Fragment:
                        o = h.default.getSkinData(e.id);
                        i.url = o.fragmentIcon, r.text = "x" + e.amount, n.url = "ui://ui/pfjb" + o.level,
                            a.selectedIndex = o.level - 1, t.data = t.getTransitionAt(o.level - 2);
                }
            }
            var E = function (t) {
                function e() {
                    var e = t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                    return e.isAuto = !1, e.chestIndex = -1, e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnSq.onClick(this, this.onClickSq), t.m_btn_video.onClick(this, this.onClickVideo),
                        t.m_btn_share.onClick(this, this.onClickShare), t.m_bnt_gain.onClick(this, this.onClickGain),
                        t.m_bnt_close.onClick(this, this.onClickClose), this.panel = t.addChild(new fairygui.GComponent());
                }, e.prototype.setData = function (t, e, i) {
                    this.chestIndex = t, this.source = i, this.chestInfo = e, e.isAuto ? this.drops = c.default.openChest(e) : this.drops = d.default.getInstance().openChest(t, e, i);
                    var n = c.default.getChestConfig(e.id);
                    this._root.m_iconKaixianga.url = n.anim, this.isAuto = e.isAuto;
                }, e.prototype.onShow = function () {
                    var t = this, e = this._root, i = e.m_listBaoxiangkq, n = this.drops;
                    i.removeChildrenToPool(), m.default.enableVideoDouble() ? (e.visible = !1, this.isAuto ? (e.m_c1.selectedIndex = 1,
                        f.default.lock("load_video"), u.default.loadVideoAd("AUTO_CHEST", function () {
                            f.default.unlock("load_video"), e.visible = !0, t.setVideoEnable(!0);
                        }, function () {
                            f.default.unlock("load_video"), t.setVideoEnable(!1), e.visible = !0;
                        }), e.m_btn_share.title = "领取", e.m_btn_video.title = "领取") : (e.m_c1.selectedIndex = 2,
                            e.m_btn_video.title = "双倍领取", e.m_btn_share.title = "双倍领取", f.default.lock("load_video"),
                            u.default.loadVideoAd("CHEST_DOUBLE", function () {
                                f.default.unlock("load_video"), e.visible = !0, t.setVideoEnable(!0);
                            }, function () {
                                f.default.unlock("load_video"), t.setVideoEnable(!1), e.visible = !0;
                            }))) : e.m_c1.selectedIndex = 0;
                    for (var r = 0; r < n.length; r++) {
                        var a = n[r], s = i.addItemFromPool();
                        T(s, a), s.visible = !1;
                    }
                    this.showOpenAnimation(Laya.Handler.create(this, this.showItemFlyAnimation)), e.m_btnSq.visible = !1,
                        e.m_bnt_close.visible ? g.MisleadBanner(e.m_bnt_close, "CHEST_OPEN", this, this.onClickClose) : g.MisleadBanner(e.m_bnt_gain, "CHEST_OPEN", this, this.onClickGain);
                }, e.prototype.setVideoEnable = function (t) {
                    u.default.supportShare() ? (this._root.m_btn_video.visible = t, this._root.m_btn_share.visible = !t) : (this._root.m_btn_video.visible = !0,
                        this._root.m_btn_share.visible = !1);
                }, e.prototype.onClickShare = function () {
                    this.dealClickVideo(!0);
                }, e.prototype.onClickVideo = function () {
                    this.dealClickVideo(!1);
                }, e.prototype.dealClickVideo = function (t) {
                    var e = this;
                    this.isAuto ? p.default.showVideoAd(function () {
                        d.default.getInstance().openChestAlready(e.chestIndex, e.chestInfo, s.ChestOpenType.Video),
                            d.default.getInstance().gainDrops(e.drops, "chest"), _.default.toast("成功领取碎片!"),
                            e.hide();
                    }, function (t) {
                        t ? _.default.toast("分享失败，无法获得") : _.default.toast("视频未播放结束，无法获得");
                    }, t) : p.default.showVideoAd(function () {
                        d.default.getInstance().gainDrops(e.drops, "chest_double"), _.default.toast("已获得双倍奖励!"),
                            e.hide();
                    }, function (t) {
                        t ? _.default.toast("分享失败，无法获得双倍") : _.default.toast("视频未播放结束，无法获得双倍");
                    }, t);
                }, e.prototype.onClickGain = function () {
                    _.default.toast("成功领取碎片!"), this.hide();
                }, e.prototype.onClickClose = function () {
                    this.hide();
                }, e.prototype.onClickSq = function () {
                    m.default.enableVideoDouble() || this.isAuto && (d.default.getInstance().openChestAlready(this.chestIndex, this.chestInfo, s.ChestOpenType.Video),
                        d.default.getInstance().gainDrops(this.drops, "chest")), _.default.toast("成功领取碎片!"),
                        this.hide();
                }, e.prototype.onHide = function () {
                    u.default.hideBannerAd("CHEST_OPEN");
                    for (var t = this.panel, e = t.numChildren - 1; e >= 0; e--) {
                        var i = t.getChildAt(e);
                        Laya.Tween.clearAll(i), i.removeFromParent(), y.returnObject(i);
                    }
                    this.drops = null;
                }, e.prototype.showOpenAnimation = function (t) {
                    this._root.m_t1.play(t);
                }, e.prototype.showItemFlyAnimation = function () {
                    var t = this._root, e = t.m_listBaoxiangkq, i = this.panel, n = t.m_iconKaixianga.x, r = t.m_iconKaixianga.y, a = t.localToGlobal(n, r, v);
                    a = i.globalToLocal(a.x, a.y, S), n = a.x, r = a.y;
                    for (var s = this.drops, h = function (t) {
                        var a = s[t], h = e.getChildAt(e.itemIndexToChildIndex(t)), u = y.getObject(l.default.URL);
                        T(u, a), u.x = n - u.width / 2, u.y = r - u.height / 2, i.addChild(u), u.visible = !1,
                            function (t, e, i, n, r) {
                                var a = t.localToGlobal(0, 0, v);
                                a = e.parent.globalToLocal(a.x, a.y, a);
                                var s = e.x, l = a.x, h = l > s + 50 ? s + 200 : l < s - 50 ? s - 200 : l, u = h, c = e.y, d = a.y, _ = .5 * (c + d), f = d, p = {
                                    flyTime: 1,
                                    update: Laya.Handler.create(e, function () {
                                        var t = e.flyTime || 0;
                                        e.x = o.default.bezier(s, h, u, l, t), e.y = o.default.bezier(c, _, f, d, t);
                                    }, null, !1)
                                };
                                e.flyTime = 0, Laya.timer.once(n, e, function () {
                                    r && r.run(), Laya.Tween.to(e, p, i, Laya.Ease.quadIn, Laya.Handler.create(e, function () {
                                        e.removeFromParent(), y.returnObject(e), p.update.recover(), t.visible = !0;
                                    }), 0, !0);
                                });
                            }(h, u, 1e3, 200 * t + 100, Laya.Handler.create(u, function () {
                                u.visible = !0, u.data instanceof fairygui.Transition && u.data.play();
                            }));
                    }, u = 0; u < s.length; u++) h(u);
                    Laya.timer.once(1100 + 200 * s.length, this, function () {
                        t.m_btnSq.visible = !0;
                    });
                }, e;
            }(n.default);
            i.default = E;
        }, {
            "../CommonUIBehaviors": 3,
            "../GlobalFuncs": 7,
            "../IData": 8,
            "../VideoHelper": 15,
            "../data/ChestHelper": 16,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/skin/SkinData": 32,
            "../fgui/ui/UI_baoxiangjl": 64,
            "../fgui/ui/UI_baoxiangkaiqi": 65,
            "../sdk/sdk": 327,
            "./Loading": 341,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        334: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_baoxianghuoqu"), s = t("./Toast"), o = t("../sdk/sdk"), l = t("../data/ChestHelper"), h = t("../data/MjpHelper"), u = t("../data/UserData"), c = t("../CommonUIBehaviors"), d = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnShouq.onClick(this, this.onClickReceive), t.m_btnFqsj.onClick(this, this.onClickReceive),
                        t.m_btnShipsjbx.onClick(this, this.onClickVideo), t.m_btnFengxsjbx.onClick(this, this.onClickShare),
                        t.m_btn_close.onClick(this, this.onClickClose);
                    this.root.visible = !1
                }, e.prototype.onShow = function () {
                    this.root.m_btn_close.visible ? c.MisleadBanner(this.root.m_btn_close, "CHEST_REWARD", this, this.onClickClose) : this.root.m_btnFqsj.visible && c.MisleadBanner(this.root.m_btnFqsj, "CHEST_REWARD", this, this.onClickReceive);
                    this.root.visible = !1


                }, e.prototype.onHide = function () {
                    o.default.hideBannerAd("CHEST_REWARD");
                }, e.prototype.setData = function (t, e) {
                    this.chestIndex = e;
                    var i = l.default.getChestConfig(t), n = this._root;
                    if (n.m_iconBaoxiang.url = i.icon, n.m_labTsbx.text = i.name, this.chest = i, e < 0 || !i.upgradeto || !h.default.enablePromoteBox()) n.m_c1.selectedIndex = 2; else {
                        var r = l.default.getChestConfig(i.upgradeto);
                        n.m_iconBaoxiang_next.url = r.icon, n.m_labTsbx_next.text = r.name, h.default.enableShareVideoBoxUp() ? n.m_c1.selectedIndex = 0 : n.m_c1.selectedIndex = 1;
                    }
                }, e.prototype.onClickReceive = function () {
                    this.chestIndex < 0 ? s.default.toast("宝箱开启栏已满，请先开启已有宝箱") : s.default.toast("恭喜获得" + this.chest.name),
                        this.hide();
                }, e.prototype.onClickVideo = function () {
                    var t = this, e = u.default.getInstance();
                    o.default.loadVideoAd("UPGRADE_CHEST", function () {
                        h.default.showVideoAd(function () {
                            e.upgradeChest(t.chestIndex, "video"), s.default.toast("恭喜获得稀有宝箱"), t.hide();
                        }, function () {
                            s.default.toast("视频未播放结束，无法升级宝箱");
                        });
                    }, function () {
                        return t._root.m_c1.selectedIndex = 1, t.onClickShare();
                    });
                }, e.prototype.onClickClose = function () {
                    this.hide();
                }, e.prototype.onClickShare = function () {
                    var t = this, e = u.default.getInstance(), i = h.default.getRandomShareInfo();
                    i.query.source = "upgradechest", o.default.shareInfo(i.title, i.imageUrl, i.query, function () {
                        e.upgradeChest(t.chestIndex, "share"), s.default.toast("恭喜获得稀有宝箱"), t.hide();
                    }, function () {
                        s.default.toast("分享失败，无法升级宝箱");
                    });
                }, e;
            }(n.default);
            i.default = d;
        }, {
            "../CommonUIBehaviors": 3,
            "../data/ChestHelper": 16,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../fgui/ui/UI_baoxianghuoqu": 62,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        335: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_tianjiaxcx"), s = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    this._root.m_btnGbc.onClick(this, this.hide);
                }, e.prototype.setData = function (t) {

                    this.updateSkinInfo(t);
                }, e.prototype.updateSkinInfo = function (t) {
                    // var e = this._root, i = e.m_btnPfzsb;
                    // i.m_iconFifu.url = t.icon,
                    //     // i.m_labYiyy.text = t.name,

                    //     i.m_c1.selectedIndex = 0,
                    //     i.m_iconPifujb.url = "ui://ui/pfjb" + t.level, e.m_labPfshuxingb.text = t.getAttrsDesc("、");
                }, e;
            }(n.default);
            i.default = s;
        }, {
            "../fgui/ui/UI_tianjiaxcx": 116,
            "./ViewBase": 356
        }],
        336: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../fgui/ui/UI_zhiding"), a = function (t) {
                function e() {
                    return t.call(this, ["ui"], n.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    this._root.m_btnGbc.onClick(this, this.hide);
                }, e.prototype.setData = function (t) {
                    this.updateSkinInfo(t);
                }, e.prototype.updateSkinInfo = function (t) {
                    // var e = this._root, i = e.m_btnPfzsb;
                    // i.m_iconFifu.url = t.icon,
                    // //  i.m_labYiyy.text = t.name,
                    //   i.m_c1.selectedIndex = 0,
                    //     i.m_iconPifujb.url = "ui://ui/pfjb" + t.level, e.m_labPfshuxingb.text = t.getAttrsDesc("、");
                }, e;
            }(t("./ViewBase").default);
            i.default = a;
        }, {
            "../fgui/ui/UI_zhiding": 124,
            "./ViewBase": 356
        }],
        337: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_freesuipian"), s = t("../IData"), o = t("../EventCenter"), l = t("../Events"), h = t("../data/UserData"), u = t("./Loading"), c = t("../sdk/sdk"), d = t("./Toast"), _ = t("../data/MjpHelper"), f = t("../VideoHelper"), p = t("../CommonUIBehaviors"), m = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnTg.onClick(this, this.hide), t.m_btnShipsp.onClick(this, this.onClickVideo),
                        t.m_btnFengxsp.onClick(this, this.onClickShare);
                }, e.prototype.onShow = function () {
                    p.MisleadBanner(this.root.m_btnTg, "FRAGMENT_BANNER", this, this.hide);
                }, e.prototype.onHide = function () {
                    c.default.hideBannerAd("FRAGMENT_BANNER"), o.default.emit(l.default.UI_HIDE_MODEL),
                        this.skin = null;
                }, e.prototype.setData = function (t, e) {
                    var i = h.default.getInstance(), n = this._root, r = t.id;
                    n.m_labPfmc.text = t.name, n.m_labPfsx.text = "皮肤属性：" + t.getAttrsDesc("、") + " ",
                        n.m_labJcs.text = t.rewardGainLimit - i.getFragmentRewardTimes(r) + "次",
                        n.m_prgSuipian.max = t.synFragmentCost, n.m_prgSuipian.value = i.getSkinFragmentCount(r),
                        n.m_btnShipsp.title = "  免费", n.m_btnFengxsp.title = "  免费", n.m_c1.selectedIndex = e ? 1 : 0,
                        n.m_c2.selectedIndex = t.level - 2, 0 == n.m_c1.selectedIndex ? n.m_txt_add.text = "+" + t.videoFragmentReward : n.m_txt_add.text = "+" + t.shareFragmentReward,
                        n.m_iconPifusuip.url = t.fragmentIcon, this.skin = t;
                }, e.prototype.onClickVideo = function () {
                    var t = this;
                    u.default.lock("show_video");
                    var e = this.skin;
                    f.default.showVideoAd(function () {
                        u.default.unlock("show_video");
                        var i = e.videoFragmentReward;
                        h.default.getInstance().gainSkinFragment(e.id, i, s.FragmentGainType.VideoModal),
                            d.default.toast("观看视频成功，获取" + e.name + "皮肤碎片*" + i), t.hide();
                    }, function (t) {
                        u.default.unlock("show_video"), t ? d.default.toast("分享未完成，无法获得皮肤碎片") : d.default.toast("视频未播放完成，无法获得皮肤碎片");
                    });
                }, e.prototype.onClickShare = function () {
                    var t = this, e = _.default.getRandomShareInfo();
                    e.query.source = "fragment_modal";
                    var i = this.skin;
                    u.default.lock("open_share"), c.default.shareInfo(e.title, e.imageUrl, e.query, function () {
                        u.default.unlock("open_share");
                        var e = i.shareFragmentReward;
                        h.default.getInstance().gainSkinFragment(i.id, e, s.FragmentGainType.ShareModal),
                            d.default.toast("分享成功，获取" + i.name + "皮肤碎片*" + e), t.hide();
                    }, function () {
                        u.default.unlock("open_share"), d.default.toast("分享失败，请重新分享");
                    });
                }, e;
            }(n.default);
            i.default = m;
        }, {
            "../CommonUIBehaviors": 3,
            "../EventCenter": 4,
            "../Events": 5,
            "../IData": 8,
            "../VideoHelper": 15,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../fgui/ui/UI_freesuipian": 100,
            "../sdk/sdk": 327,
            "./Loading": 341,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        338: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../fgui/ui/UI_guanzhuyouli"), a = t("./ViewBase"), s = t("./Toast"), o = t("../data/UserData"), l = t("../sdk/sdk"), h = t("../data/MjpHelper"), u = function (t) {
                function e() {
                    var e = t.call(this, ["ui"], n.default, null, !1, !0, !0) || this;
                    return e._gameId = "", e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this, e = this._root;
                    this._gameId = l.default.gameId + "-" + o.default.getInstance().uid, e.m_gameId.text = this._gameId,
                        e.m_btnClose.onClick(this, this.hide), e.m_btnCopyText.onClick(this, function () {
                            h.default.onClickCopy(), l.default.setClipboardData(t._gameId, function () { }, function () {
                                s.default.toast("复制失败~");
                            });
                        }), e.m_btnSaveImg.onClick(this, function () {
                            l.default.saveImageToPhotosAlbum("sagi_team.png", function () {
                                s.default.toast("图片保存成功~");
                            }, function () {
                                s.default.toast("图片保存失败~");
                            });
                        });
                }, e.prototype.onShow = function () {
                    h.default.onOpenGZH();
                }, e;
            }(a.default);
            i.default = u;
        }, {
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../fgui/ui/UI_guanzhuyouli": 101,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        339: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/guide/UI_Novice"), s = t("../fgui/guide/guideBinder"), o = t("../EventCenter"), l = t("../Events"), h = function (t) {
                function e() {
                    var e = t.call(this, ["guide"], a.default, s.default) || this;
                    return e.viewRect = new Laya.Rectangle(0, 80, Laya.stage.width, Laya.stage.height - 80 - 220), e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    o.default.on(l.default.GAME_READY, this, this.show), o.default.on(l.default.GAME_ENDED, this, this.hide);
                    var t = this._root;
                    this.viewRect = new Laya.Rectangle(0, 0, t.width, t.height - 220);
                    this._root.visible = !1
                }, e.prototype.onDestroy = function () {
                    o.default.off(l.default.GAME_READY, this, this.show), o.default.off(l.default.GAME_ENDED, this, this.hide);
                }, e.prototype.onShow = function () {
                    o.default.on(l.default.SHOW_GUIDE, this, this.showGuide), o.default.on(l.default.BALL_UPDATE, this, this.updateBallState);
                    this._root.visible = !1
                }, e.prototype.onHide = function () {
                    o.default.off(l.default.SHOW_GUIDE, this, this.showGuide), o.default.off(l.default.BALL_UPDATE, this, this.updateBallState);
                }, e.prototype.showGuide = function (t, e, i) {
                    var n = this._root.m_c1;
                    t += "", n.selectedPage !== t && (n.selectedPage = t);
                }, e.prototype.updateBallState = function (t, e, i) {
                    var n = this._root, r = (this.viewRect, n.m_ballfw), a = n.globalToLocal(e, i);
                    this.viewRect.contains(a.x, a.y) ? (r.visible = !0, r.setXY(a.x, a.y)) : r.visible = !1;
                }, e;
            }(n.default);
            i.default = h;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../fgui/guide/UI_Novice": 49,
            "../fgui/guide/guideBinder": 50,
            "./ViewBase": 356
        }],
        340: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../EventCenter"), s = t("../Events"), o = t("./Toast"), l = t("../sdk/sdk"), h = t("../data/MjpHelper"), u = t("../data/UserData"), c = t("../IData"),
                d = t("../fgui/ui/UI_yaoqinghaoli"), _ = t("../data/InviteRewardHelper"), f = t("../data/skin/SkinData"), p = t("../data/ChestHelper"), m = t("../CommonUIBehaviors"), g = t("../ThirdParty/SagiAdHelper");
            function y(t, e, i, n, r) {
                e = e || t.data, t.m_labWanjiaxuhao.text = e.toString(), t.data = e;
                var a = t.m_c1;
                a.selectedIndex = r ? 2 : n ? 0 : 1;
                var s = t.m_labJianglmc, o = t.m_iconSuipjinb;
                switch (i.type) {
                    case c.RewardType.Coin:
                        o.url = "ui://ui/jinbi", s.text = "金币 * " + i.amount;
                        break;

                    case c.RewardType.Skin:
                        var l = f.default.getSkinData(i.id);
                        o.url = l.icon, s.text = l.name + "皮肤";
                        break;

                    case c.RewardType.Fragment:
                        l = f.default.getSkinData(i.id);
                        o.url = l.fragmentIcon, s.text = l.name + "碎片 * " + i.amount;
                        break;

                    case c.RewardType.Chest:
                        var h = p.default.getChestConfig(i.id);
                        o.url = h.icon, s.text = h.name + " * " + i.amount;
                }
            }
            var v = function (t) {
                function e() {
                    return t.call(this, ["ui"], d.default, null, !1, !0, !0) || this;
                }
                return r(e, t),
                    e.prototype.onCreate = function () {
                        var t = this._root;
                        t.visible = !1
                        t.m_btnGb.onClick(this, () => {
                            console.log("asdasd")
                        }),
                            t.m_btnYqhyb.onClick(this, this.onClickShare),
                            t.m_c1.selectedIndex = 0;
                        window.gggg.parent.visible = !1
                        Laya.timer.once(5, this, () => {
                            //主页回调
                            console.log("guanle！！！！！！！！！！！！！！！！！！！s")
                            window.gggg.parent.visible = !1
                            Laya.timer.once(1e3, this, () => {
                                setTimeout(() => {
                                    // window.aaa._useUserProjectionMatrix = 1;
                                }, 1e3)

                                h5splash.hideLoading()
                            })
                        })
                    }, e.prototype.onDestroy = function () { },
                    e.prototype.setData = function (t, e) {
                        // console.log("setData", e.isLocked)
                        this.unlock = e,
                            this.rewardSkin = t,
                            this._root.m_labPfshuxing.text = "皮肤加成：" + t.getAttrsDesc("、") + " ",
                            this.updateSkinInfo(t);
                    },
                    e.prototype.onShow = function () {

                        m.MisleadBanner(this.root.m_btnGb, "INVITE_REWARD_BANNER", this, this.hide),
                            g.default.showAd(12, Laya.stage.width - 100, 140, 1.2, 1.2),
                            g.default.showAd(8, Laya.stage.width / 2, Laya.stage.height / 2, .8, .8),
                            a.default.on(s.default.USER_LOGIN, this, this.onUserLogin),
                            this.updateInviteRewards();
                    },
                    e.prototype.onHide = function () {
                        l.default.hideBannerAd("INVITE_REWARD_BANNER"), g.default.hideAd(12), g.default.hideAd(8),
                            a.default.off(s.default.USER_LOGIN, this, this.onUserLogin);
                    },
                    e.prototype.onUserLogin = function () {
                        this.updateInviteRewards();
                    },
                    e.prototype.updateSkinInfo = function (t) {

                        // var e = this._root.m_btnPfzs;
                        // e.m_iconFifu.url = t.icon, 
                        // // e.m_labYiyy.text = t.name,
                        //  e.m_iconPifujb.url = "ui://ui/pfjb" + t.level,
                        //     e.m_c1.selectedIndex = 0;
                    },
                    e.prototype.onClickShare = function () {

                        var t = h.default.getRandomShareInfo();
                        t.query.source = "invite_skin_" + this.rewardSkin.id, l.default.shareInfo(t.title, t.imageUrl, t.query);
                    },
                    e.prototype.updateInviteRewards = function () {
                        var t = u.default.getInstance(), e = t.inviteRewardPage;
                        if (_.default.isMaxPage(e)) return this.hide();
                        var i = _.default.getRewardInPage(e), n = this._root.m_listYaoqb;
                        n.removeChildrenToPool();
                        for (var r = i.length, a = 1; a <= r; a++) {
                            var s = i[a - 1], o = n.addItemFromPool();
                            y(o, _.default.getRealIndex(e, a), s, t.isInviteRewardRecieveable(a), t.isInviteRewardRecieved(a));
                            var l = o.m_btnLqjl;
                            l.offClick(this, this.gainReward), l.onClick(this, this.gainReward, [o, a, s]);
                        }
                    },
                    e.prototype.gainReward = function (t, e, i) {
                        var n = u.default.getInstance();
                        if (n.isInviteRewardRecieveable(e)) switch (n.recieveInviteReward(e) ? this.updateInviteRewards() : y(t, null, i, !1, !0),
                            i.type) {
                                case c.RewardType.Coin:
                                    o.default.toast("恭喜获得金币 * " + i.amount);
                                    break;

                                case c.RewardType.Skin:
                                    var r = f.default.getSkinData(i.id);
                                    o.default.toast("恭喜获得" + r.name + "皮肤");
                                    break;

                                case c.RewardType.Fragment:
                                    r = f.default.getSkinData(i.id);
                                    o.default.toast("恭喜获得" + r.name + "皮肤碎片 * " + i.amount);
                                    break;

                                case c.RewardType.Chest:
                                    var a = p.default.getChestConfig(i.id);
                                    o.default.toast("恭喜获得" + a.name + " * " + i.amount);
                            }
                    }, e;
            }(n.default);
            i.default = v;
        }, {
            "../CommonUIBehaviors": 3,
            "../EventCenter": 4,
            "../Events": 5,
            "../IData": 8,
            "../ThirdParty/SagiAdHelper": 13,
            "../data/ChestHelper": 16,
            "../data/InviteRewardHelper": 17,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/skin/SkinData": 32,
            "../fgui/ui/UI_yaoqinghaoli": 123,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        341: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/Common/UI_loading"), s = function (t) {
                function e() {
                    var e = t.call(this, ["Common"], a.default, null) || this;
                    return e._root.displayObject.zOrder = n.default.ZORDER_LOADING, e;
                }
                return r(e, t), e.lock = function (t, e) {
                    this._lockStack.push({
                        key: t,
                        tips: e
                    }), this.show(e);
                }, e.unlock = function (t) {
                    for (var e = this._lockStack, i = e.length - 1; i >= 0; i--) {
                        if (e[i].key === t) {
                            e.splice(i, 1);
                            break;
                        }
                    }
                    if (e.length > 0) {
                        var n = e[e.length - 1];
                        this.show(n.tips);
                    } else this.hide();
                }, e.prototype.setData = function (t) { }, e._lockStack = [], e;
            }(n.default);
            i.default = s;
        }, {
            "../fgui/Common/UI_loading": 46,
            "./ViewBase": 356
        }],
        342: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_Luck"), s = t("../data/UserData"), o = t("../sdk/sdk"), l = t("./Toast"), h = t("../data/MjpHelper"), u = t("./Loading"), c = t("../data/config/RewardConfig"), d = t("../EventCenter"), _ = t("../Events"), f = t("../GlobalFuncs"), p = fairygui.ScrollPane.easeFunc, m = function (t) {
                function e() {
                    var e = t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                    return e.base = 0, e.indexMap = {}, e.destStart = 0, e.isGuide = !1, e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGbih.onClick(this, this.onCloseClick), t.m_btnShipa.onClick(this, this.onClickVideo),
                        t.m_btnFengxb.onClick(this, this.onClickShare), t.m_btn_free.onClick(this, this.onClickFree);
                    var e = t.m_listXysz;
                    e.removeChildrenToPool();
                    var i = c.default.SHARE_LUCK_RATE, n = this.indexMap, r = i.length, a = Math.ceil(30 / r);
                    this.destStart = a * r;
                    for (var s = 0; s <= a; s++) for (var o = 0; o < r; o++) {
                        var l = i[o];
                        e.addItemFromPool().m_labSzi.text = l.key + "", 0 === s && (n[l.key] = o);
                    }
                    e.displayObject.on("fui_scroll", this, function () {
                        e.scrollPane._tweenDuration.setTo(3, 3);
                    });
                }, e.prototype.setData = function (t, e, i) {
                    void 0 === i && (i = !1);
                    var n = this._root;
                    this.base = t, this.onSuccess = e, n.m_btnGbih.visible = !0, n.m_btnShipa.visible = !0,
                        n.m_btnFengxb.visible = !0, n.m_listXysz.scrollToView(0, !1), h.default.enableShareVideoAwardLucky() ? n.m_c1.selectedIndex = 0 : n.m_c1.selectedIndex = 1,
                        this.isGuide = i, i && (n.m_c1.selectedIndex = 2);
                }, e.prototype.onShow = function () {
                    fairygui.ScrollPane.easeFunc = function (t, e) {
                        return Laya.Ease.quadInOut(t, 0, 1, e);
                    }, o.default.showBannerAd("LUCKY_BANNER", f.default.getBannerRectWithHeight(210)),
                        this.root.m_btn_free.enabled = !0;
                }, e.prototype.onHide = function () {
                    o.default.hideBannerAd("LUCKY_BANNER"), fairygui.ScrollPane.easeFunc = p, this.onSuccess && (this.onSuccess.recover(),
                        this.onSuccess = null);
                }, e.prototype.onCloseClick = function () {
                    this.isGuide && this.onSuccess && (this.onSuccess.run(), this.onSuccess = null),
                        this.hide();
                }, e.prototype.onClickVideo = function () {
                    var t = this;
                    s.default.getInstance();
                    u.default.lock("luck_slot"), o.default.loadVideoAd("LUCK_SLOT", function () {
                        h.default.showVideoAd(function () {
                            u.default.unlock("luck_slot"), t.gainRewards(!1);
                        }, function () {
                            u.default.unlock("luck_slot"), l.default.toast("视频未播放结束，无法获取幸运大奖");
                        });
                    }, function () {
                        return u.default.unlock("luck_slot"), t._root.m_c1.selectedIndex = 1, t.onClickShare();
                    });
                }, e.prototype.onClickShare = function () {
                    var t = this, e = (s.default.getInstance(), h.default.getRandomShareInfo());
                    e.query.source = "upgradechest", o.default.shareInfo(e.title, e.imageUrl, e.query, function () {
                        t.gainRewards(!0);
                    }, function () {
                        l.default.toast("分享失败，无法获取幸运大奖");
                    });
                }, e.prototype.onClickFree = function () {
                    this.gainRewards(!0), this.root.m_btn_free.enabled = !1;
                }, e.prototype.gainRewards = function (t) {
                    var e = this._root;
                    e.m_btnGbih.visible = !1, e.m_btnShipa.visible = !1, e.m_btnFengxb.visible = !1;
                    var i = s.default.getInstance().luckGainCoin(this.base, t), n = i.rate, r = i.coin;
                    e.m_t3.play(Laya.Handler.create(this, function () {
                        e.m_listXysz.scrollToView((this.indexMap[n] || 0) + this.destStart, !0), Laya.timer.once(3300, this, function () {
                            l.default.toast("Coins + " + r + " "), d.default.emit(_.default.COIN_CHANGE), Laya.timer.once(2e3, this, function () {
                                this.onSuccess && (this.onSuccess.run(), this.onSuccess = null), this.hide();
                            });
                        });
                    }));
                }, e;
            }(n.default);
            i.default = m;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../GlobalFuncs": 7,
            "../data/MjpHelper": 18,
            "../data/UserData": 20,
            "../data/config/RewardConfig": 28,
            "../fgui/ui/UI_Luck": 51,
            "../sdk/sdk": 327,
            "./Loading": 341,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        343: [function (t, e, i) {
            "use strict";
            var n;
            Object.defineProperty(i, "__esModule", {
                value: !0
            }), i.MainViewState = void 0;
            var a = t("./ViewBase"), s = t("../fgui/ui/UI_home"), o = t("../EventCenter"), l = t("../Events"), h = t("../IData"),
                u = t("../data/UserData"), c = t("../data/fight/IFightData"), d = t("../game/GameConstants"), _ = t("../math/MathHelper"), f = t("../data/skin/SkinData"),
                p = t("../game/HomeConstants"), m = t("../sdk/sdk"), g = t("../data/MjpHelper"),
                y = t("./Modal"), v = t("./InviteRewardModal"), S = t("./Loading"), T = t("../data/config/RandomNames"),

                E = t("../GlobalFuncs"), C = t("./RankModal"), x = t("./CollectTipsModal"),
                b = t("./RewardSkinModal"),
                I = t("./SkinTryModal"), w = t("./SimpleMovieHelper"), A = t("./Toast"),
                R = t("../data/RankHelper"), M = t("../fgui/ui/UI_shengmjinbi"), D = t("../fgui/ui/UI_jifeishuzi"), O = t("./ChestOpenModal"), L = t("./ChestAccelerateModal"), P = t("./ChestRewardModal"), N = t("./NoChestTipsModal"), B = t("../data/ChestHelper"), F = t("./AddCoinModal"), k = t("../data/config/RewardConfig"), V = t("./LuckSlotModal"), U = t("./FreeFragmentModal"), G = t("./CollectTipsQQModal"), z = t("../ThirdParty/SagiAdHelper"), H = t("../CommonUIBehaviors"), j = t("./AddPlayerModal"), W = t("./SharingVideoModal"), X = t("../data/config/ChestConfig"), Y = t("../game/game/services/RecordService"), q = t("./GongZhongHaoModal");
            (n = {})[1] = "一", n[2] = "二", n[3] = "三", n[4] = "四", n[5] = "五";
            function K(t, e, i, n, r) {
                t.data = e, t.m_iconFifu.url = e.icon, t.m_iconPifujb.url = "ui://ui/pfjb" + e.level;
                var a = t.m_c1;
                if (n) a.selectedIndex = 3; else if (i) a.selectedIndex = 0; else if (r <= 0) a.selectedIndex = 2,
                    t.m_labbaoxjs.text = e.unlock.desc; else {
                    a.selectedIndex = 4;
                    var s = t.m_prgSuipian;
                    s.max = e.synFragmentCost, s.value = r;
                }
            }
            function Z(t, e, i) {
                t.m_labWofangbf.text = e + "", t.m_labDuishoubf.text = i + "";
            }
            function Q(t, e, i) {
                t.m_labWanjiadui.text = " You ", t.m_labDuishoudui.text = " Player ";
            }
            function J(t, e, i) {
                t.m_pipei.selectedIndex = i,
                    0 === i ? (
                        t.m_labWofang.text = " You ",
                        t.m_labDifangmc.text = "")
                        : (t.m_labWofang.text = "",
                            t.m_labDifangmc.text = " Player "),
                    t.m_iconWeixintx.url = e.avatar, t.m_iconDuanweib.url = e.rank.icon;
            }
            function $(t, e) {
                return {
                    nickname: t,
                    avatar: e,
                    rank: R.default.getTargetRank(u.default.getInstance().rank.level, !0)
                };
            }
            function tt(t, e, i, n) {
                t.url = i.icon, e.m_labDuanwei.text = i.name + " ";
                var r = e.m_prgDuan;
                r.max = i.next ? i.next.score - i.score : 1,
                    r.value = (n - i.score);
            }
            function et(t, e, i, n, r, a) {
                var s = e.m_prgDuan, o = R.default.checkRank(i, n);
                0 === o ? Laya.Tween.to(s, {
                    value: n - i.score
                }, 500, Laya.Ease.quadOut, Laya.Handler.create(null, function () {
                    tt(t, e, i, n), a && a();
                })) : o > 0 ? Laya.Tween.to(s, {
                    value: s.max
                }, 300, Laya.Ease.linearNone, Laya.Handler.create(null, function () {
                    i = i.next, tt(t, e, i, i.score), r ? r(!0, i, Laya.Handler.create(null, et, [t, e, i, n, r, a])) : et(t, e, i, n, r, a);
                })) : Laya.Tween.to(s, {
                    value: s.max
                }, .3, Laya.Ease.linearNone, Laya.Handler.create(null, function () {
                    i = i.last, tt(t, e, i, i.next.score), r ? r(!1, i, Laya.Handler.create(null, et, [t, e, i, n, r, a])) : et(t, e, i, n, r, a);
                }));
            }
            var it, nt = new fairygui.GObjectPool();
            function rt(t, e, i) {
                t.visible = !1, Laya.timer.once(e, t, function () {
                    t.visible = !0, i && i.play();
                });
            }
            function at(t, e, i, n, r) {
                t.flyTime = 0;
                var a = t.x, s = e, o = (s - a) * (Math.random() - .5) * .8 + a, l = (s - a) * (1 - .3 * Math.random()) + a, h = t.y, u = i, c = (u - h) * Math.random() * .6 + h, d = (u - h) * (1 - .3 * Math.random()) + h, _ = {
                    flyTime: 1,
                    update: Laya.Handler.create(t, function () {
                        var e = t.flyTime || 0;
                        t.x = E.default.bezier(a, o, l, s, e), t.y = E.default.bezier(h, c, d, u, e);
                    }, null, !1)
                };
                Laya.Tween.to(t, _, r, Laya.Ease.quadIn, Laya.Handler.create(t, function () {
                    t.removeFromParent(), nt.returnObject(t), _.update.recover();
                }), n, !0);
            }
            function st(t, e) {
                if (t.data = e || null, e) {
                    var i = B.default.getChestConfig(e.id);
                    t.m_iconBaoxiang.url = i.icon;
                } else t.m_c1.selectedIndex = 2;
            }
            function ot(t, e) {
                var i = t.data;
                if (i) {
                    var n = {
                        leftTime: 0
                    };
                    B.default.chestEnableOpen(i, e, n) ? (t.m_c1.selectedIndex = 0, t.m_t0.playing || t.m_t0.play(null, -1)) : (t.m_c1.selectedIndex = 1,
                        t.m_labTimeb.text = E.default.formatTimeStringZh(n.leftTime), t.m_t0.playing && t.m_t0.stop(!0));
                }
            }
            !function (t) {
                t[t.dating = 0] = "dating", t[t.datingxinshou = 1] = "datingxinshou", t[t.bisai = 2] = "bisai",
                    t[t.xsjiesuan = 3] = "xsjiesuan", t[t.jiesuanwin = 4] = "jiesuanwin", t[t.jiesuanfail = 5] = "jiesuanfail",
                    t[t.bisaixiaojie = 6] = "bisaixiaojie", t[t.pipei = 7] = "pipei", t[t.pifu = 8] = "pifu",
                    t[t.bisaijc = 9] = "bisaijc", t[t.jiesuandraw = 10] = "jiesuandraw", t[t.bisai2 = 11] = "bisai2",
                    t[t.jiesuanwinGuide = 12] = "jiesuanwinGuide";
            }(it = i.MainViewState || (i.MainViewState = {}));
            var lt = function (t) {
                function e() {
                    var e = t.call(this, ["headIcon", "ui"], s.default, null) || this;
                    return e._firstShow = !0, e._gameIndex = 1, e._skinDirty = !0, e._authRetryTimes = 0,
                        e.bindedUserButton = !1, e.lastTrySkinId = null, e.oldRankInfo = null, e.videoLoadState = -1,
                        e.vidoeRetryTimes = 0, e.clickStartGameTimes = 0, e.clickReceiveTimes = 0, //m.default.onUserNoLogin(), 
                        e;
                }
                return r(e, t),
                    e.prototype.setData = function (t) {
                        t || (t = u.default.getInstance().guidePass ? it.dating : it.datingxinshou), this._root.m_c1.selectedIndex = t,
                            this.state = t, this.updateBannerState(), this.updateSagiAD(!1), t === it.dating ? (this.updateStartButtonState(),
                                this.showMoreGameInfo(),
                                this.showSomeModals()) :
                                t === it.pifu ? (this._skinDirty = !1,
                                    this.updateDefaultSkin(),
                                    u.default.getInstance().newSkinUnlockId = 0,
                                    g.default.enableFreeFragment()
                                    && m.default.supportVideoAd()
                                    && this.loadSkinVideo()) :
                                    this.clearMoreGameInfo(),
                            this.updateSkinRedState(), this._lastState = t, this.state === it.bisaixiaojie && H.MisleadBanner(this.root.m_btn_continue, "GOAL_BANNER", this, this.onGoalContinue);
                    }, e.prototype.changeState = function (t) {
                        Laya.timer.once(10, this, this.setData, [t]);
                    }, e.prototype.onCreate = function () {
                        this.initUI(), this.updateMJPStatus(), this.addListeners(), this.onEnterForceGround(),
                            this.updateUserId(), Laya.stage.on("on_show", this, this.onEnterForceGround), Laya.stage.on("user_id_changed", this, this.updateUserId);
                    }, e.prototype.onDestroy = function () {
                        this.removeListeners();
                    }, e.prototype.onShow = function () {
                        Laya.timer.once(1e3, this, () => {


                            h5splash.hideLoading()
                        })
                        console.log("打开主页？？？")

                        this.onSoundBtn = new Laya.Image()
                        // this.onSoundBtn.skin = "new/jiaoxue.png"
                        this.onSoundBtn.x = 20
                        this.onSoundBtn.y = 150
                        this.onSoundBtn.scaleX = this.onSoundBtn.scaleY = .6
                        window.onSoundBtn = this.onSoundBtn
                        Laya.stage.addChild(this.onSoundBtn)

                        if (Laya.LocalStorage.getItem("soundsound") == 0
                            || Laya.LocalStorage.getItem("soundsound") == null) {
                            this.issoundOff = false;
                            Laya.SoundManager.playMusic("new/bgm.mp3")
                            this.onSoundBtn.skin = "new/start_soundon.png";
                        }
                        else {
                            this.issoundOff = true;
                            Laya.SoundManager.stopMusic("new/bgm.mp3")
                            this.onSoundBtn.skin = "new/start_soundoff.png";
                        };

                        this.onSoundBtn.on(Laya.Event.CLICK, this, () => {
                            this.issoundOff = !this.issoundOff;
                            if (!this.issoundOff) {
                                Laya.LocalStorage.setItem("soundsound", 0);
                                Laya.SoundManager.playMusic("new/bgm.mp3")
                                this.onSoundBtn.skin = "new/start_soundon.png";
                            }
                            else {
                                Laya.LocalStorage.setItem("soundsound", 1);
                                Laya.SoundManager.stopMusic("new/bgm.mp3");
                                this.onSoundBtn.skin = "new/start_soundoff.png";
                            }
                        });


                        m.default.isMjpAuthorized() && m.default.hideUserInfoIcon(["home_rank", "home_start", "guide_completed"]),
                            this.autoGainChest();
                    }, e.prototype.onGoalContinue = function () {
                        o.default.emit(l.default.UI_TRANSFORM_START),
                            Laya.timer.once(1e3, this, function () {
                                o.default.emit(l.default.UI_ENTER_GAME);
                            });
                    }, e.prototype.onHide = function () {
                        m.default.hideBannerAd("GOAL_BANNER");
                    }, e.prototype.initUI = function () {
                        // console.log("qqqq")
                        var t = this._root;
                        t.m_btnVip.visible = !1, t.m_btnQd.visible = !1, t.m_btnPifu.onClick(this, this.onBtnHomeSkin),
                            t.m_btnShare.onClick(this, this.onBtnHomeShare), t.m_btnTop.onClick(this, this.onBtnHomeRank),
                            t.m_btnYaoqinghaoli.onClick(this, this.onBtnHomeInviteReward), t.m_btnTiaozhuan.onClick(this, this.onBtnHomeNewGame),
                            t.m_btnTop.visible = !1, t.m_btnbackb.onClick(this, this.onBtnSkinBack),
                            t.m_btnStart.onClick(this, this.onBtnHomeStart), "qq" === m.default.getPlatform() ? (t.m_btnTianjia.m_c1.selectedIndex = 1,
                                t.m_btnTianjia.onClick(this, this.onBtnHomeCollectQQ)) : (t.m_btnTianjia.m_c1.selectedIndex = 0,
                                    t.m_btnTianjia.onClick(this, this.onBtnHomeCollect)), "wx" === m.default.getPlatform() ? (t.m_btnGZYL.visible = !0,
                                        t.m_btnGZYL.onClick(this, function () {
                                            y.default.showModal(q.default);
                                        })) : t.m_btnGZYL.visible = !1, t.m_btnZhengbisai.onClick(this, this.onBtnAuthAndStart),
                            m.default.bindUserInfoIcon(t.m_btnZhengbisai, "guide_completed"),
                            t.m_btnJs.onClick(this, this.onClickUnlockSkin),
                            t.m_btnSy.onClick(this, this.onClickUseSkin),
                            t.m_btnHc.onClick(this, this.onClickSynthesis),
                            t.m_btnFree.onClick(this, this.onClickSkinVideo), t.m_btnFxsyb.onClick(this, this.onClickSkinShare),
                            t.m_Playergoldb.onClick(this, this.onClickAddCoin), "tt" == m.default.getPlatform() && (t.m_Playergoldb.y += window.tt.getSystemInfoSync().safeArea.top),
                            m.default.bindUserInfoIcon(t.m_btnTop, "home_rank"), m.default.supportPlayerCenter() ? (t.m_btnShequ.visible = !1,
                                t.m_btnTiaozhuan.visible = !1, m.default.bindPlayerCenterIcon(t.m_btnShequ)) : t.m_btnShequ.visible = !1,
                            "tt" == m.default.getPlatform() && m.default.supportMoregames() ? (t.m_btnShequ.visible = !1,
                                t.m_btnTiaozhuan.visible = !0) : t.m_btnTiaozhuan.visible = !1, t.m_labBanbenhao.text = "",
                            t.m_btnRmg.visible = !1, t.m_cmpBsks.opaque = !1, t.m_imgFootball.opaque = !1, t.m_btnShare.visible = !1;
                        t.m_baoxianglana.visible = !1
                        t.m_baoxianglanb.visible = !1
                        t.m_baoxianglanc.visible = !1
                        t.m_baoxiangland.visible = !1

                        for (var e = [t.m_baoxianglana, t.m_baoxianglanb, t.m_baoxianglanc, t.m_baoxiangland], i = 0; i < 4; i++) {
                            var n = e[i];
                            n.onClick(this, this.onClickChestItem, [n, i]);
                        }
                        this.chestCmps = e, this.updateCoinAmount(), this.updateSelfRank(), this.updateAllChest(),
                            this.viewRect = new Laya.Rectangle(0, 0, t.width, t.height - 220);
                    }, e.prototype.addListeners = function () {
                        o.default.on(l.default.MJP_ONOFF, this, this.updateMJPStatus),
                            o.default.on(l.default.COMBO_CHANGE, this, this.showCombo),
                            o.default.on(l.default.COMBO_REWARD, this, this.showComboCoin),
                            o.default.on(l.default.UI_SOME_MODAL_SHOW, this, this.onSomeModalShow),
                            o.default.on(l.default.UI_ALL_MODAL_CLOSE, this, this.onAllModalClose),
                            o.default.on(l.default.UPDATE_MATCH_TIME, this, this.updateMatchTime),
                            o.default.on(l.default.UI_SKIN_UNLOCKED, this, this.onSkinUnlcked),
                            o.default.on(l.default.FRAGMENT_CHANGE, this, this.onGetSkinFragment),
                            o.default.on(l.default.UI_SKIN_SELECTED, this, this.updateAllSkinState),
                            o.default.on(l.default.INVITE_PAGE_CHANGE, this, this.updateInviteReward),
                            o.default.on(l.default.GAME_READY, this, this.updateMatchInfo),
                            o.default.on(l.default.GAME_SCORE, this, this.updateMatchScore),
                            o.default.on(l.default.GAME_START, this, this.showGameView),
                            o.default.on(l.default.GAME_ENDED, this, this.showGameResult),
                            o.default.on(l.default.MATCH_ENDED, this, this.showMatchResult),
                            o.default.on(l.default.BALL_UPDATE, this, this.updateBallState),
                            o.default.on(l.default.COIN_CHANGE, this, this.updateCoinAmount),
                            o.default.on(l.default.SCORE_CHANGE, this, this.updateSelfRank),
                            o.default.on(l.default.CHEST_CHANGE, this, this.updateAllChest), Laya.stage.on("openBtnClose", this, this.onShowSagi);
                    }, e.prototype.removeListeners = function () {
                        o.default.off(l.default.MJP_ONOFF, this, this.updateMJPStatus), o.default.off(l.default.COMBO_CHANGE, this, this.showCombo),
                            o.default.off(l.default.COMBO_REWARD, this, this.showComboCoin), o.default.off(l.default.UI_SOME_MODAL_SHOW, this, this.onSomeModalShow),
                            o.default.off(l.default.UI_ALL_MODAL_CLOSE, this, this.onAllModalClose), o.default.off(l.default.UPDATE_MATCH_TIME, this, this.updateMatchTime),
                            o.default.off(l.default.UI_SKIN_UNLOCKED, this, this.onSkinUnlcked), o.default.off(l.default.FRAGMENT_CHANGE, this, this.onGetSkinFragment),
                            o.default.off(l.default.UI_SKIN_SELECTED, this, this.updateAllSkinState), o.default.off(l.default.INVITE_PAGE_CHANGE, this, this.updateInviteReward),
                            o.default.off(l.default.GAME_READY, this, this.updateMatchInfo), o.default.off(l.default.GAME_SCORE, this, this.updateMatchScore),
                            o.default.off(l.default.GAME_START, this, this.showGameView), o.default.off(l.default.GAME_ENDED, this, this.showGameResult),
                            o.default.off(l.default.MATCH_ENDED, this, this.showMatchResult), o.default.off(l.default.BALL_UPDATE, this, this.updateBallState),
                            o.default.off(l.default.COIN_CHANGE, this, this.updateCoinAmount), o.default.off(l.default.SCORE_CHANGE, this, this.updateSelfRank),
                            o.default.off(l.default.CHEST_CHANGE, this, this.updateAllChest), o.default.off("openBtnClose", this, this.onShowSagi);
                    }, e.prototype.onBtnHomeStart = function () {
                 

                        window.onSoundBtn.visible = !1
                        this.onEnterGame()
                        // YYGGames.showInterstitial(() => {

                        //     //开始游戏 插屏
                        //     YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = false
                        //     window.onSoundBtn.visible = !1
                        //     // var t = this;
                        //     // this.clickStartGameTimes > 0 ? z.default.randomSkip(function () {
                        //     //     t.onEnterGame();
                        //     // }, function () {
                        //     //     t.onEnterGame();
                        //     // }) : (this.clickStartGameTimes++, this.onEnterGame());
                        //     this.onEnterGame()
                        // })





                    }, e.prototype.onEnterGame = function () {
                        var t = u.default.getInstance();
                        t.guidePass ? (console.log("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),
                            Y.default.instance().recordStop(function () {
                                Y.default.instance().recordStart();
                            }),
                            this.tryUseSkin(Laya.Handler.create(this, function (e, i) {
                                e && (t.onTrySkin(), g.default.trySkin(e.id, i), o.default.emit(l.default.TRY_SKIN, e)),
                                    this.matchingTarget(Laya.Handler.create(this, this.startGameWithTarget));
                            })))
                            :
                            this.startGameWithTarget({
                                nickname: "新手陪练",
                                avatar: "ui://headIcon/1",
                                rank: R.default.getRankInfoWithLevel(0)
                            });
                    }, e.prototype.onBtnHomeNewGame = function () {
                        m.default.showMoreGamesModal();
                    }, e.prototype.onBtnHomeSkin = function () {

                        
                        window.onSoundBtn.visible = !1
                        o.default.emit(l.default.UI_BACK_TO_HOME),
                            o.default.emit(l.default.UI_SHOW_SKIN);
                        var t = f.default.getSkinData(u.default.getInstance().getSelectedSkinId(p.default.DEFAULT_SKIN));

                        console.log("存储的皮肤：：：", t)
                        t && (this.setSelectedSkinInList(t.id), this.selectedSkin(t)), this.changeState(it.pifu);
                        //插屏
                        // YYGGames.showInterstitial(() => {

                        //     YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = false
                        //     window.onSoundBtn.visible = !1
                        //     o.default.emit(l.default.UI_BACK_TO_HOME),
                        //         o.default.emit(l.default.UI_SHOW_SKIN);
                        //     var t = f.default.getSkinData(u.default.getInstance().getSelectedSkinId(p.default.DEFAULT_SKIN));

                        //     console.log("存储的皮肤：：：", t)
                        //     t && (this.setSelectedSkinInList(t.id), this.selectedSkin(t)), this.changeState(it.pifu);
                        // })
                    }, e.prototype.onBtnHomeRank = function (t) {
                        var e = this;
                        "wx" !== m.default.getPlatform() && "baidu" != m.default.getPlatform() ? t ? !0 === t ? g.default.commitAuth(Laya.Handler.create(y.default, y.default.showModal, [C.default]), Laya.Handler.create(A.default, A.default.toast, ["授权失败，无法进入排行榜"])) : m.default.isMjpAuthorized() ? y.default.showModal(C.default) : this.authorize("home_rank", function (t) {
                            t ? "tt" == m.default.getPlatform() ? e.onBtnHomeRank(!0) : y.default.showModal(C.default) : A.default.toast("未授权玩家无法进入排行榜");
                        }) : m.default.isMjpAuthorized() ? this.onBtnHomeRank(!0) : this.authorize("home_rank", function (t) {
                            t ? e.onBtnHomeRank(!0) : A.default.toast("未授权玩家无法进入排行榜");
                        }) : !1 === t ? A.default.toast("未授权玩家无法进入排行榜") : !0 === t ? g.default.commitAuth(Laya.Handler.create(y.default, y.default.showModal, [C.default]), Laya.Handler.create(A.default, A.default.toast, ["授权失败,无法进入排行榜"])) : y.default.showModal(C.default);
                    }, e.prototype.onBtnHomeShare = function () {
                        var t = g.default.getRandomShareInfo();
                        t.query.source = "home", m.default.shareInfo(t.title, t.imageUrl, t.query);
                    }, e.prototype.onBtnHomeInviteReward = function () {
                        var t = f.default.getSkinData(p.default.INVITE_REWARD_SKIN);
                        y.default.showModal(v.default, t, t.unlock);
                    }, e.prototype.onBtnHomeCollect = function () {
                        y.default.showModal(x.default, f.default.getSkinData(p.default.COLLECT_REWARD_SKIN));
                    }, e.prototype.onBtnHomeCollectQQ = function () {
                        y.default.showModal(G.default, f.default.getSkinData(p.default.COLLECT_REWARD_SKIN));
                    }, e.prototype.onBtnBack = function () {
                        o.default.emit(l.default.UI_BACK_TO_HOME), this.changeState(it.dating);
                    }, e.prototype.onBtnSkinBack = function () {
                        window.onSoundBtn.visible = !0
                        // YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = !0
                        o.default.emit(l.default.UI_HIDE_SKIN), this.changeState(it.dating);
                    }, e.prototype.onBtnContinue = function () {
                        this.onBtnHomeStart();
                    }, e.prototype.authorize = function (t, e) {
                        m.default.authorizeUserInfo(t, function (t) {
                            console.log("authorize result:" + t), e(t);
                        });
                    }, e.prototype.onBtnAuthAndStart = function (t) {
                        // var e = this;
                        // console.log("onBtnAuthAndStart:"), "wx" !== m.default.getPlatform() ? "oppo" !== m.default.getPlatform() ? t ? (console.log("onBtnAuthAndStart:" + t), 
                        // m.default.isMjpAuthorized() ? (console.log("onBtnAuthAndStart is MjpAuthorized:" + !0), 
                        // g.default.commitAuth(Laya.Handler.create(this, this.onBtnHomeStart), Laya.Handler.create(this, this.onBtnHomeStart))) : (console.log("onBtnAuthAndStart is MjpAuthorized:" + !1), 
                        // this.authorize("auth_start", function(t) {
                        //     t ? g.default.commitAuth(Laya.Handler.create(e, e.onBtnHomeStart), 
                        //     Laya.Handler.create(e, e.onBtnHomeStart)) : 
                        //     e.onBtnHomeStart();
                        // }))) : m.default.isMjpAuthorized() ? this.onBtnHomeStart() : this.authorize("auth_start", function(t) {
                        //     e.onBtnHomeStart();
                        // }) :
                        //  this.onBtnHomeStart() :
                        //   t ? g.default.commitAuth(Laya.Handler.create(this, this.onBtnHomeStart),
                        //    Laya.Handler.create(this, this.onBtnHomeStart)) : 
                        //    this.onBtnHomeStart();
                        this.onBtnHomeStart();
                    },


                    e.prototype.updateMJPStatus = function () {
                        var t = this._root;
                        if (this.updateInviteReward(), t.m_Playergoldb.m_btnJiahao.visible = !0,
                            g.default.enableExport()) this.showMoreGameInfo(); else {
                            var e = t.m_btnRmg;
                            e.visible && (e.visible = !1);
                        }
                        if (this.initSkinList(), !g.default.enableShowISBN()) for (var i in X.default) for (var n = X.default[i].drops, r = n.length - 1; r >= 0; r--) {
                            var a = n[r].id;
                            g.default.isSkinInISBN(a) && (n[r].odds = 0);
                        }
                    }, e.prototype.updateStartButtonState = function () {
                        var t = this._root.m_btnStart;
                        t.offClick(this, this.onBtnHomeStart), t.offClick(this, this.onBtnAuthAndStart),
                            u.default.getInstance().guidePass && !m.default.isMjpAuthorized() ? (t.onClick(this, this.onBtnAuthAndStart),
                                this.bindedUserButton || m.default.bindUserInfoIcon(t, "home_start")) : t.onClick(this, this.onBtnHomeStart);
                    }, e.prototype.updateInviteReward = function () {
                        var t = this._root, e = u.default.getInstance(), i = p.default.COLLECT_REWARD_SKIN;
                        "wx" === m.default.getPlatform() || "qq" === m.default.getPlatform() ?
                            t.m_btnTianjia.visible = !1 && !e.hasOwnSkinFragment(i) : t.m_btnTianjia.visible = !1,
                            t.m_btnYaoqinghaoli.visible = !1;
                    }, e.prototype.startGameWithTarget = function (t) {
                        this._gameIndex += 1, this.updatePlayerInfo(u.default.getInstance(), t), o.default.emit(l.default.UI_TRANSFORM_START),
                            Laya.timer.once(1e3, this, function () {
                                o.default.emit(l.default.UI_ENTER_GAME, t), o.default.emit(l.default.MATCH_START);
                            });
                    }, e.prototype.updatePlayerInfo = function (t, e) {
                        var i = this._root;
                        i.m_labWanjia.text = E.default.clampString(t.nickname, 4), i.m_labDuishou.text = " Player ",
                            i.m_iconDuanweid.url = t.rank.icon, i.m_iconDuanweie.url = e.rank.icon, i.m_iconWanjia.url = t.avatar,
                            i.m_iconDuishou.url = e.avatar,

                            Q(i.m_bisaibifen, t, e), Q(i.m_bisaijieguoa, t, e);
                        var n = u.default.getInstance();
                        this.oldRankInfo = n.rank, tt(i.m_iconDuanweif, i.m_prgDuanc, n.rank, n.score);
                    }, e.prototype.showGameView = function (t, e) {
                        this.localPlayerOrigin = e ? this._root.globalToLocal(e.x, e.y) : this._root.globalToLocal(375, 667),
                            console.log("t.type", t.type),
                            this.changeState(t.type === c.FightType.Guide ? it.bisai2 : it.bisai);
                    }, e.prototype.updateMatchInfo = function (t) {
                        this.updateMatchTime(t), this.updateMatchScore(t.score1, t.score2);
                        var e = this._root;
                        Z(e.m_bisaijieguoa, t.score1, t.score2), Z(e.m_bisaibifen, t.score1, t.score2),
                            e.m_jifeids.visible = !1, e.m_labTeshujiangli.text = t.counter.coin.toString() + " ",
                            t.score1 + t.score2 !== 0 ? e.m_cmpBsks.m_c2.selectedIndex = 0 : e.m_cmpBsks.m_c2.selectedIndex = 1,
                            this.changeState(it.bisaijc);
                    }, e.prototype.updateMatchTime = function (t, e) {
                        if (e = e || this._root.m_labDaojishib, t.matchTime < 0) e.text = "--:-- "; else {
                            var i = Math.floor(t.matchTime - t.matchTiming);
                            e.text = E.default.formatTimeString(i) + " ", i <= 10 && this._root.m_t1.play();
                        }
                    }, e.prototype.updateBallState = function (t, e, i) {
                        var n = this._root, r = n.m_imgFootball, a = n.globalToLocal(e, i), s = this.viewRect;
                        if (s.contains(a.x, a.y)) r.visible = !1; else {
                            r.visible = !0;
                            var o = r.width / 2, l = r.height / 2;
                            switch (r.x = _.default.clamp(a.x, s.x + o, s.right - o), r.y = _.default.clamp(a.y, s.y + l, s.bottom - l),
                            r.rotation = 180 * Math.atan2(a.y - r.y, a.x - r.x) / Math.PI - 90, t) {
                                case d.default.PLAYER_1_GROUP:
                                    r.m_c2.selectedIndex = 0;
                                    break;

                                case d.default.PLAYER_2_GROUP:
                                    r.m_c2.selectedIndex = 1;
                                    break;

                                default:
                                    r.m_c2.selectedIndex = 2;
                            }
                        }
                    }, e.prototype.updateMatchScore = function (t, e) {
                        var i = this._root;
                        i.m_labWbf.text = t.toString() + " ", i.m_labDsbf.text = e.toString() + " ";
                    },

                    e.prototype.showGameResult = function (t) {
                        //结算

                        console.log("结算211")

                        this.updateMatchTime(t), Laya.timer.clear(this, this.updateMatchTime);
                        var e, i = this._root;
                        this.updateMatchTime(t, i.m_labSmjlb),
                            Z(i.m_bisaibifen, t.score1, t.score2), t.shootCoin ? ((e = E.default.labNumSet(i.m_labJianglije, function (t) {
                                return t.toFixed(0) + " ";
                            })).numset = t.shootCoin, i.m_smjl.visible = !0) :
                                i.m_smjl.visible = !1, Laya.timer.once(1e3, this, function () {
                                    Z(i.m_bisaijieguoa, t.score1, t.score2), e && (Laya.Tween.to(e, {
                                        numset: 0
                                    }, 200), function (t, e, i, n, r, a, s) {
                                        for (var o = e.x, l = e.y, h = 2 * Math.PI / r, u = [], c = a - 400, d = 0; d < r; d++) u.push(d * c / r);
                                        for (d = 0; d < r; d++) {
                                            var f = nt.getObject(M.default.URL), p = h * d, m = _.default.randomBetween(50, 100, !0);
                                            f.x = i + Math.cos(p) * m, f.y = n + Math.sin(p) * m, t.addChild(f), rt(f, _.default.randomFromArray(u, !0), f.m_shengmengjlcx),
                                                at(f, o, l, a, s);
                                        }
                                    }(i, i.m_labTeshujiangli, e.x, e.y, Math.floor(t.shootCoin / 20), 600, 800));
                                }), Laya.timer.once(2500, this, function () {
                                    i.m_labTeshujiangli.text = t.counter.coin.toString() + " ", i.m_jinbifangda.play();
                                }), this.changeState(it.bisaixiaojie);
                    },



                    e.prototype.showVideoShare = function (t, e) {
                        var i = this;
                        if (void 0 === e && (e = !1), "tt" === m.default.getPlatform()) {
                            var n = W.default.getValidSkin();
                            n && !t && Y.default.instance().recordStop(function (t) {
                                t && (g.default.enableRecord() ? Y.default.instance().shareVideo(function (t, e) {
                                    console.log("分享结果:" + t, e), t ? u.default.getInstance().gainSkinFragment(n.id, 10, h.FragmentGainType.ShareVideoModal) : A.default.toast("分享失败~"),
                                        Y.default.instance().deleteVideo(), i.hide();
                                }) : y.default.showModal(W.default, n));
                            });
                        }
                    }, e.prototype.showInsertAd = function () {
                        console.log("show insertAd"), m.default.supportInsertAd() && g.default.enableInsertAd() && m.default.showInsertAd("INTER_HOME");
                    }, e.prototype.showMatchResult = function (t, e) {
                        var i = this;
                        if (t.type === c.FightType.Guide)
                            this.changeState(it.jiesuanwinGuide),
                                u.default.getInstance().lastGameResult = e.result;
                        else
                            switch (e.result) {
                                case h.ResultType.Win:
                                    this.changeState(it.jiesuanwin), u.default.getInstance().lastGameResult = e.result;
                                    break;

                                case h.ResultType.Lose:
                                    this.changeState(it.jiesuanfail), u.default.getInstance().lastGameResult = e.result;
                                    break;

                                case h.ResultType.Draw:
                                    this.changeState(it.jiesuandraw), u.default.getInstance().lastGameResult = e.result;
                            }
                        var n = "ui://ui/jinbi", r = this._root;
                        r.m_iconJingbie.url = n, r.m_iconJingbif.url = n, r.m_iconJingbih.url = n, r.m_labShuzia.text = e.counter.hitFlyCoin.toString() + " ",
                            r.m_labShuzib.text = e.counter.shootCoin.toString() + " ",
                            r.m_labShuzic.text = e.reward.coin.toString() + " ";
                        var a = e.reward.totalCoin;
                        r.m_btnDjlq.m_iconJinbid.url = n, r.m_btnDjlq.m_labJine.text = a.toString() + " ", r.m_btnDjlq.offClick(this, null),
                            window.zzzz = r.m_btnDjlq
                        zzzz.getChildAt(3).x = 165
                        r.m_btnDjlq.y = 800
                        r.m_btnDjlq.onClick(this, function () {

                            window.onSoundBtn.visible = !0
                  
                            var t = this;
                            this.clickReceiveTimes++
                            A.default.toast("Get " + a + " coins"),
                                this.onBtnBack()
                            //插屏
                            // YYGGames.showInterstitial(() => {

                            //     window.onSoundBtn.visible = !0
                            //     YYGGames.gameBox.game1.visible = YYGGames.gameBox.game2.visible = !0
                            //     YYGGames.gameBanner.visible = !1
                            //     var t = this;
                            //     this.clickReceiveTimes++
                            //     A.default.toast("Get " + a + " coins"),
                            //         this.onBtnBack()
                            //     //     return this.clickReceiveTimes++, this.clickReceiveTimes > 2 ? (this.clickReceiveTimes = 0,
                            //     //         z.default.randomSkip(function () { }, function () {
                            //     //             return A.default.toast("Get " + a + " coins"), t.onBtnBack();
                            //     //         })) : (A.default.toast("Get " + a + " coins"), this.onBtnBack());
                            // })



                        });
                        var s = u.default.getInstance();
                        r.m_labDwjljc.text = "Rank " + s.rank.coinRate + "%";
                        var o = 100 * s.luckProgress / p.default.LUCK_GAME_TIMES,
                            l = t.type === c.FightType.Guide;
                        r.m_prgXydj.value = o;
                        var d = r.m_btnLuck;
                        d.visible = !1
                        if (d.offClick(this, null), o >= 100) d.m_c1.selectedIndex = 0,
                            d.onClick(this, function () {
                                if (l || !g.default.enableMisleadBanner())
                                    y.default.showModal(V.default, a,
                                        Laya.Handler.create(this, this.onBtnBack), l);
                                else {
                                    var t = u.default.getInstance().getSelectedSkinId();
                                    y.default.showModal(j.default, f.default.getSkinData(t), Laya.Handler.create(this, this.onBtnBack));
                                }
                            }); else {
                            d.m_c1.selectedIndex = 1;
                            var _ = a * (k.default.SETTLE_REWARD_RATE - 1), v = a * k.default.SETTLE_REWARD_RATE;
                            d.m_labShuzi.text = v.toString();
                            var T = g.default.enableShareVideoAward3();
                            m.default.supportShare() ? d.icon = T ? "ui://ui/sp" : "ui://ui/share" : d.icon = "ui://ui/sp";
                            var E = function () {
                                if (m.default.supportShare()) {
                                    var t = g.default.getRandomShareInfo();
                                    t.query.source = "settle_double", m.default.shareInfo(t.title, t.imageUrl, t.query, function () {
                                        S.default.unlock("settle_double"), s.gainCoin(_, "video_double"), A.default.toast("成功领取" + v + "金币"),
                                            i.onBtnBack();
                                    }, function () {
                                        S.default.unlock("settle_double"), A.default.toast("分享失败，无法领取");
                                    });
                                }
                            }, C = function () {
                                S.default.unlock("settle_double"), g.default.showVideoAd(function () {
                                    s.gainCoin(_, "video_double"), A.default.toast("成功领取" + v + "金币"), i.onBtnBack();
                                }, function () {
                                    S.default.unlock("settle_double"), A.default.toast("视频播放失败，无法领取");
                                });
                            };
                            d.onClick(this, function () {
                                S.default.lock("settle_double"), m.default.supportShare() ? T ? m.default.loadVideoAd("SETTLE_DOUBLE", function () {
                                    C();
                                }, function () {
                                    d.icon = "ui://ui/share", E();
                                }) : E() : m.default.loadVideoAd("SETTLE_DOUBLE", function () {
                                    C();
                                }, function () {
                                    S.default.unlock("settle_double"), A.default.show("没有视频，无法获得三倍奖励");
                                });
                            });
                        }
                        if (this.oldRankInfo ? et(r.m_iconDuanweif, r.m_prgDuanc, this.oldRankInfo, s.score, function (t, e, i) {
                            t && A.default.toast("Rank rise to " + e.name + " "), i.run();
                        }, function () {
                            i.oldRankInfo = s.rank, tt(r.m_iconDuanweif, r.m_prgDuanc, s.rank, s.score);
                        }) : (this.oldRankInfo = s.rank, tt(r.m_iconDuanweif, r.m_prgDuanc, s.rank, s.score)),
                            this.setResultClickable(!1, !1),
                            t.type === c.FightType.Guide ?
                                this.setResultClickable(!0, !0) :
                                Laya.timer.once(1500, this, this.setResultClickable, [!0, !1]),
                            e.reward.chestId) {
                            var x = e.reward.chestId,
                                b = e.reward.chestIndex;
                            Laya.timer.once(1400, this, function () {
                                y.default.showModal(P.default, x, b);
                            });
                        }
                        l || this.showInsertAd(), this.showVideoShare(l, !1);


                    },


                    e.prototype.setResultClickable = function (t, e) {
                        var i = this._root;
                        // YYGGames.gameBanner.visible = t
                        i.m_btnDjlq.visible = t;
                        var n = t && (e || g.default.enableLuck());
                        i.m_luckdajiang.visible = n,
                            i.m_yaoyaole.visible = !1,
                            i.m_prgXydj.visible = !1;
                    }, e.prototype.updateCoinAmount = function () {
                        this._root.m_Playergoldb.m_labJinbei.text = " " + u.default.getInstance().coin.toString() + " ";
                    }, e.prototype.updateSelfRank = function () {
                        var t = this._root, e = u.default.getInstance();
                        tt(t.m_iconDuanweia, t.m_prgDuanb, e.rank, e.score);
                    }, e.prototype.tryUseSkin = function (t) {
                        // if (g.default.enableSkinTry()) {
                        //     var e = u.default.getInstance().trySkinTimes, i = p.default.MAX_TRY_SKIN_TIMES, n = u.default.getInstance().lastGameResult;
                        //     if ((n === h.ResultType.Draw || n === h.ResultType.Lose) && e < i) {
                        //         var r = g.default.unlockSkinList.slice();
                        //         if (r.length > 0) {
                        //             var a = _.default.randomFromArray(r, !0);
                        //             a === this.lastTrySkinId && r.length > 0 && (a = _.default.randomFromArray(r, !0)),
                        //                 this.lastTrySkinId = a;
                        //             var s = !1;
                        //             s = !g.default.enableShareVideoTryOn() || e < p.default.MAX_SHARE_TRY_SKIN, m.default.supportShare() || (s = !1);
                        //             var o = i - e + "次";
                        //             return y.default.showModal(I.default, f.default.getSkinData(a), t, o, s);
                        //         }
                        //     }
                        // }
                        // return t && t.run();
                        t.run();
                    }, e.prototype.matchingTarget = function (t) {
                        var e = this;
                        this.matchState = 0,
                            this.matchTarget = null;
                        var i = this._root,
                            n = i.m_pipeiwo,
                            r = i.m_pipeiaduishou;
                        J(n, u.default.getInstance(), 0),
                            r.m_pipei.selectedIndex = 2,
                            Laya.timer.once(_.default.randomBetween(2e3, 4e3), this, this.onMatchedTarget, [1, t])
                        // "oppo" == m.default.getPlatform() ? 
                        // (this.matchTarget = $(_.default.randomInArray(T.default, !0), 
                        // "ui://headIcon/" + (_.default.randomInt(100, !0) + 1)),
                        //     this.onMatchedTarget(2, t)) :
                        //  m.default.getRandomUserInfo(1, function (i) {
                        var n = { "headimg": "https://h5.sagigame.net/avatar/img47.jpg", "nickname": "Krazy L" }
                        // console.log("qweqweqweqwe",nn)
                        // var n = JSON.parse(nn)

                        e.matchTarget = $(n.nickname, n.headimg),
                            e.onMatchedTarget(2, t);
                        // },
                        //  function () {
                        // e.matchTarget = $(_.default.randomInArray(T.default, !0), "ui://headIcon/" + (_.default.randomInt(100, !0) + 1)),
                        //     e.onMatchedTarget(2, t);
                        // }),
                        this.changeState(it.pipei);
                    }, e.prototype.onMatchedTarget = function (t, e) {
                        if (this.matchState |= t, 3 === this.matchState) {
                            var i = this.matchTarget;
                            J(this._root.m_pipeiaduishou, i, 1), Laya.timer.once(1e3, this, function () {
                                e.runWith(i);
                            });
                        }
                    }, e.prototype.initSkinList = function () {
                        var t = this._root.m_listPifushop;
                        t.displayObject.off(fairygui.Events.CLICK_ITEM, this, this.onClickSkinItem),
                            t.removeChildrenToPool(),
                            t.selectionMode = fairygui.ListSelectionMode.Single;
                        for (var e = u.default.getInstance(), i = f.default.allSkins,
                            n = e.getSelectedSkinId(p.default.DEFAULT_SKIN), r = 0; r < i.length; r++) {
                            var a = i[r], s = a.id;
                            if (!g.default.enableShowISBN() && g.default.isSkinInISBN(s));
                            else {
                                var o = e.hasOwnSkinId(s) || !a.unlock.isLocked,
                                    l = e.getSkinFragmentCount(s);
                                if (a.unlock.isHide && !o && l <= 0) continue;
                                K(t.addItemFromPool(), a, o, n === a.id, l);
                            }
                        }
                        t.displayObject.on(fairygui.Events.CLICK_ITEM, this, this.onClickSkinItem);
                    }, e.prototype.updateDefaultSkin = function () {
                        for (var t = null, e = -1, i = u.default.getInstance(), n = i.getSelectedSkinId(p.default.DEFAULT_SKIN), r = 0, a = 0, s = this._root.m_listPifushop, o = 0; o < s.numItems; o++) {
                            var l = s.itemIndexToChildIndex(o), h = s.getChildAt(l).data, c = h.id, d = 0;
                            a < (d = i.hasOwnSkinId(c) || !h.unlock.isLocked ? n === c ? c : 0 : i.getSkinFragmentCount(c) >= h.synFragmentCost ? 1e6 + c : i.newSkinUnlockId > 0 && c === i.newSkinUnlockId ? 1e5 + c : i.getSkinFragmentCount(c) > 0 && (h.shareFragmentReward > 0 || h.videoFragmentReward > 0) ? 1e4 + c : 0) && (a = d,
                                r = o, n = c);
                        }
                        e < 0 && (e = r, t = f.default.getSkinData(n)), s.selectedIndex = e, s.scrollToView(e, !1),
                            this.selectedSkin(t);
                    }, e.prototype.onClickSkinItem = function (t) {
                        var e = t.data;
                        this.selectedSkin(e);

                        console.log("解锁了皮肤！！！", e.id)
                        this.updateSelectedSkinState(e)

                    }, e.prototype.selectedSkin = function (t) {
                        console.log("选择了皮肤！！！", t.id)
                        "number" == typeof t && (t = f.default.getSkinData(t)),


                            this._selectedSkin !== t && (this._selectedSkin = t,
                                o.default.emit(l.default.UI_SKIN_PREVIEW, t.id), this.updateSelectedSkinState(t));
                    }, e.prototype.updateSelectedSkinState = function (t) {
                        var e = u.default.getInstance(),
                            i = this._root;
                        i.m_labPifumingchen.text = t.name,
                            i.m_labPifujieshao.text = t.desc + " ",
                            i.m_c3.selectedIndex = t.level - 1;
                        i.m_labPifumingchen.fontSize = 22

                        var n = t.attrs;
                        n && n.length > 0 ? (i.m_labSxjc.visible = !0,
                            i.m_labSxjcmx.text = t.getAttrsDesc("、") + " ") : (
                                i.m_labSxjc.visible = !1,
                                i.m_labSxjc.text = "Up:",
                                i.m_labSxjcmx.text = "");
                        var r = t.id, a = e.getSkinFragmentCount(r),
                            s = i.m_c2
                        console.log("sssss", this._root)
                        e.getSelectedSkinId(p.default.DEFAULT_SKIN) === r ?
                            s.selectedIndex = 2 :
                            e.hasOwnSkinId(r) ||
                                !t.unlock.isLocked ?
                                s.selectedIndex = 1 : a <= 0 ?
                                    t.unlockType === h.SkinUnlockType.Chest ?
                                        s.selectedIndex = 2 :
                                        s.selectedIndex = 0 :
                                    a >= t.synFragmentCost ?
                                        s.selectedIndex = 3
                                        : g.default.enableFreeFragment() ?
                                            g.default.enableShareVideoGainFragment()
                                                ? m.default.supportVideoAd() &&
                                                    1 === this.videoLoadState ?
                                                    s.selectedIndex = 4 :
                                                    0 === this.videoLoadState
                                                        ? s.selectedIndex = 2 :
                                                        s.selectedIndex = 5 :
                                                s.selectedIndex = 5 :
                                            s.selectedIndex = 2,
                            i.m_labSycs.text = "剩余次数：" + Math.max(0, t.rewardGainLimit - e.getFragmentRewardTimes(r)),
                            i.m_btnFree.title = "免费碎片+" + t.videoFragmentReward,
                            i.m_btnFxsyb.title = "免费碎片+" + t.shareFragmentReward;
                    }, e.prototype.onSkinButtonClick = function () {

                        if (this._selectedSkin) {
                            var t = u.default.getInstance(), e = (this._root, this._selectedSkin), i = e.id;
                            t.getSelectedSkinId(p.default.DEFAULT_SKIN) !== i && (t.hasOwnSkinId(i) || !e.unlock.isLocked ? t.setSelectedSkinId(i)
                                :
                                e.unlock.unlockSkin(e));
                        }
                    }, e.prototype.onClickUnlockSkin = function () {

                        if (this._selectedSkin) {


                            if (u.default.getInstance().coin >= 1000) {
                                //金币解锁逻辑
                                var t = this._selectedSkin;
                                t.id;
                                t.unlock.isLocked = !1
                                // t.unlock.unlockSkin(t);
                                // setData
                                this.onSkinUnlcked()
                                u.default.getInstance().gainSkin(t.id, "synthesis")
                                u.default.getInstance().gainCoin(-1000)
                            } else {
                                console.log("trasldjklaksjd:", this._root)
                                // this._root.m_listPifushop.getChildAt(1).m_labYishiyong.text = "kajsdasd"
                                A.default.toast("Not enough coins");
                            }
                            // this.updateAllSkinState()
                        }
                    }, e.prototype.onClickUseSkin = function () {
                        if (this._selectedSkin) {
                            var t = u.default.getInstance(),
                                e = this._selectedSkin,
                                i = e.id;
                            t.getSelectedSkinId(p.default.DEFAULT_SKIN) !== i
                                &&
                                (!t.hasOwnSkinId(i)
                                    &&
                                    e.unlock.isLocked
                                    ||
                                    t.setSelectedSkinId(i)
                                );

                        }
                    }, e.prototype.onClickSynthesis = function () {
                        if (this._selectedSkin) {
                            var t = u.default.getInstance(), e = this._selectedSkin, i = e.id;
                            if (!t.costSkinFragment(i, e.synFragmentCost)) return A.default.toast("去收集更多的皮肤碎片吧！");
                            t.gainSkin(i, "synthesis");
                        }
                    }, e.prototype.onClickSkinVideo = function () {
                        var t = this;
                        if (this._selectedSkin) {
                            var e = u.default.getInstance(), i = this._selectedSkin, n = i.id;
                            if (e.getFragmentRewardTimes(n) >= i.rewardGainLimit) return A.default.toast("今日次数已达上限，请明日再来");
                            g.default.showVideoAd(function () {
                                var r = i.videoFragmentReward;
                                e.gainSkinFragment(n, r, h.FragmentGainType.Video), A.default.toast("观看视频成功，获取" + i.name + "皮肤碎片*" + r),
                                    t.loadSkinVideo(0);
                            }, function () {
                                A.default.toast("视频未播放完成，无法获得皮肤碎片");
                            });
                        }
                    }, e.prototype.onClickSkinShare = function () {
                        if (this._selectedSkin) {
                            var t = u.default.getInstance(), e = this._selectedSkin, i = e.id;
                            if (t.getFragmentRewardTimes(i) >= e.rewardGainLimit) return A.default.toast("今日次数已达上限，请明日再来");
                            var n = g.default.getRandomShareInfo();
                            n.query.source = "home", m.default.shareInfo(n.title, n.imageUrl, n.query, function () {
                                var n = e.shareFragmentReward;
                                t.gainSkinFragment(i, n, h.FragmentGainType.Share), A.default.toast("分享成功，获取" + e.name + "皮肤碎片*" + n);
                            }, function () {
                                A.default.toast("分享失败，请重新分享");
                            });
                        }
                    }, e.prototype.onClickAddCoin = function () {

                        console.log("金币：", u.default.getInstance())
                            u.default.getInstance().gainCoin(1000)

                       
                        //激励
                        // YYGGames.showReward(() => {

                        //     console.log("金币：", u.default.getInstance())
                        //     u.default.getInstance().gainCoin(1000)
                        // })
                        // u.default.getInstance().coin+=1000

                        // S.default.unlock("load_video"), F.default.getInstance().onClickVideo();
                        // if (g.default.enableAddCoin()) {
                        //     if (u.default.getInstance().dailyAddCoinTimes >= p.default.DAILY_MAX_ADD_COIN_TIMES) 
                        //     return A.default.toast("今日次数已达上限，请明日再来");
                        //     m.default.destroyVideoAd(),
                        //      S.default.lock("load_video"), 
                        //      g.default.enableShareVideoGainCoin() ? 
                        //      m.default.loadVideoAd("ADD_COIN", function () {
                        //         S.default.unlock("load_video"), F.default.getInstance().onClickVideo();
                        //     }, function () {
                        //         S.default.unlock("load_video"), F.default.getInstance().onClickShare();
                        //     }) : m.default.loadVideoAd("ADD_COIN", function () {
                        //         S.default.unlock("load_video"), F.default.getInstance().onClickVideo();
                        //     }, function () {
                        //         S.default.unlock("load_video"), A.default.toast("当前没有视频，无法获得免费金币.");
                        //     });
                        // }
                    }, e.prototype.changeVideoLoadState = function (t) {
                        t !== this.videoLoadState && (this.videoLoadState = t, this._selectedSkin && this.updateSelectedSkinState(this._selectedSkin));
                    }, e.prototype.loadSkinVideo = function (t) {
                        var e = this;
                        this.changeVideoLoadState(t || 0), m.default.destroyVideoAd(), m.default.loadVideoAd("VIDEO_SKIN", function () {
                            e.vidoeRetryTimes = 0, e.changeVideoLoadState(1);
                        }, function () {
                            e.changeVideoLoadState(2), e.vidoeRetryTimes++ < 3 && e.loadSkinVideo(2);
                        });
                    }, e.prototype.updateAllSkinState = function () {
                        this._selectedSkin && this.updateSelectedSkinState(this._selectedSkin);
                        for (var t = this._root.m_listPifushop,
                            e = t.numItems,
                            i = u.default.getInstance(),
                            n = i.getSelectedSkinId(p.default.DEFAULT_SKIN), r = 0; r < e; r++) {
                            var a = t.getChildAt(t.itemIndexToChildIndex(r)),
                                s = a.data,
                                o = s.id;

                            K(a, s, i.hasOwnSkinId(o) || !s.unlock.isLocked, n === o, i.getSkinFragmentCount(o));
                        }
                    }, e.prototype.setSelectedSkinInList = function (t) {
                        for (var e = this._root.m_listPifushop, i = e.numItems, n = 0; n < i; n++) {
                            if (e.getChildAt(e.itemIndexToChildIndex(n)).data.id === t) {
                                e.selectedIndex = n;
                                break;
                            }
                        }
                    }, e.prototype.onSomeModalShow = function () {
                        m.default.hidePlayerCenterIcon(), m.default.hideUserInfoIcon(["home_rank", "home_start", "guide_completed"]),
                            this.updateSagiAD(!0);
                    }, e.prototype.onAllModalClose = function () {
                        m.default.showPlayerCenterIcon(), m.default.showUserInfoIcon(["home_rank", "home_start", "guide_completed"]),
                            this.updateSagiAD(!1);
                    }, e.prototype.onShowSagi = function (t) {
                        t && m.default.hideAllBannerAds();
                    }, e.prototype.updateInsertState = function () {
                        // console.log("===========laststate:" + this._lastState, "this.state:" + this.state),
                        //     -1 !== [it.jiesuandraw, it.jiesuanfail, it.jiesuanwin, it.jiesuanwinGuide].indexOf(this._lastState)
                        //      && this.state == it.dating && (console.log("show insertAd"),
                        //         m.default.supportInsertAd() && g.default.enableInsertAd() && m.default.showInsertAd("INTER_HOME"));
                    }, e.prototype.updateBannerState = function () {
                        var t, e = !1;
                        switch (this.state) {
                            case it.jiesuanwin:
                            case it.jiesuandraw:
                            case it.jiesuanfail:
                                t = "SETTLE_BANNER", e = !0;
                                break;

                            case it.pipei:
                                t = "MATCH_BANNER";
                                break;

                            case it.bisaixiaojie:
                                t = "SCORE_BANNER";

                            case it.pifu:
                                t = "SKIN_BANNER";
                        }
                        t ? e && z.default.support() || m.default.showBannerAd(t, E.default.getBannerRectWithHeight(200)) : m.default.hideAllBannerAds();
                    }, e.prototype.updateSagiAD = function (t) {
                        this.state === it.dating ? t ? (z.default.hideAd(0), z.default.hideAd(9), z.default.hideAd(12),
                            z.default.hideAd(3)) : (z.default.showAd(9, Laya.stage.width / 2, Laya.stage.height / 2 + 325, .8, .8),
                                z.default.showAd(0, 70, Laya.stage.height / 2 + 170), z.default.showAd(3, 0, Laya.stage.height / 2 - 300),
                                z.default.showAd(12, 20, Laya.stage.height / 2 - 500, 1.2, 1.2)) : (z.default.hideAd(0),
                                    z.default.hideAd(9), z.default.hideAd(3), z.default.hideAd(12), this.state === it.bisaijc ? t ? z.default.hideAd(9) : z.default.showAd(9, Laya.stage.width / 2, Laya.stage.height / 2 + 300) : z.default.hideAd(9)),
                            this.state === it.bisai ? t ? z.default.hideAd(10) : z.default.showAd(10, Laya.stage.width - 80, Laya.stage.height / 2 - 507) : z.default.hideAd(10),
                            this.state === it.jiesuanfail || this.state === it.jiesuandraw || this.state === it.jiesuanwin ? t ? (z.default.hideAd(5),
                                z.default.hideAd(8), z.default.hideAd(12)) : (z.default.showAd(5, Laya.stage.width / 2, Laya.stage.height - 140, .9, .9),
                                    z.default.showAd(8, Laya.stage.width / 2, Laya.stage.height / 2, .7, .7), z.default.showAd(12, Laya.stage.width - 100, 140, 1.2, 1.2)) : (z.default.hideAd(5),
                                        z.default.hideAd(8));
                    }, e.prototype.updateSkinRedState = function () {
                        var t = this._root.m_redhit, e = !1;
                        if (this._skinDirty) {
                            var i = u.default.getInstance();
                            if (i.newSkinUnlockId > 0) e = !0; else for (var n = 0, r = f.default.allSkins; n < r.length; n++) {
                                var a = r[n], s = a.id;
                                if (a.unlock.isLocked && !i.hasOwnSkinId(s) && i.getSkinFragmentCount(s) >= a.synFragmentCost) {
                                    e = !0;
                                    break;
                                }
                            }
                        }
                        t.visible = !1;
                    }, e.prototype.tryShowUnlockSkins = function () {
                        if (-1 === [it.dating, it.pifu].indexOf(this.state)) return !1;
                        var t = u.default.getInstance().unlockSkins;
                        if (t.length <= 0) return !1;
                        for (var e = [], i = 0, n = t; i < n.length; i++) {
                            var r = n[i];
                            e.push([b.default, f.default.getSkinData(r)]);
                        }
                        return t.length = 0, y.default.showModalSequence(e), !0;
                    }, e.prototype.onSkinUnlcked = function () {
                        this._skinDirty = !0, this.updateSkinRedState(),
                            this.updateInviteReward(),
                            this.updateAllSkinState()
                        // this.tryShowUnlockSkins();
                    }, e.prototype.onEnterForceGround = function () {
                        var t = m.default.getLaunchData();
                        if (console.log("onEnterForceGround>>>>>>>>>>>>>>> ", JSON.stringify(t)), t && t.fromMini) {
                            var e = u.default.getInstance(), i = p.default.COLLECT_REWARD_SKIN, n = f.default.getSkinData(i), r = n.synFragmentCost;
                            e.hasOwnSkinId(i) || e.hasOwnSkinFragment(i) || (e.gainSkinFragment(i, r, h.FragmentGainType.Chest),
                                A.default.toast("成功获取" + n.name + "皮肤碎片 * " + r + "！"));
                        }
                        "wx" == m.default.getPlatform() && this.checkGZYL();
                    }, e.prototype.checkGZYL = function () {
                        var t = this, e = function (e) {
                            t._root.m_btnGZYL.visible = !1;
                        };
                        e(!1), m.default.getAllRewardInfo(function (t) {
                            for (var i in e(!0), t) {
                                var n = t[i];
                                switch (n.rtype) {
                                    case p.default.WX_GZYL_KEY:
                                        e(!1), console.log("关注公共号返回的状态：", n.status), 0 == n.status ? m.default.setRewardStatus(100, function () {
                                            u.default.getInstance().hasOwnSkinId(p.default.WX_GZYL_AWARD_SKIN_ID) || u.default.getInstance().gainSkin(p.default.WX_GZYL_AWARD_SKIN_ID, "gongzonghao");
                                        }) : console.log("奖励已领取~");
                                }
                            }
                        }, function () {
                            e(!1);
                        });
                    }, e.prototype.showMoreGameInfo = function () {
                        var t = this;
                        g.default.enableExport() && (Laya.timer.clear(this, this.showMoreGameInfo), m.default.getMoreGame2(function (e) {
                            var i = t._root.m_btnRmg, n = i.m_iconGames;
                            i.visible = !0, e.isAnim && e.urls ? (w.default.setFrames(n, e.urls.map(function (t) {
                                return {
                                    url: t
                                };
                            }), e.interval), w.default.setPlaySettings(n, 0, -1, e.playTimes, -1, Laya.Handler.create(t, t.showMoreGameInfo))) : (w.default.clearFrames(n, e.imgUrl),
                                Laya.timer.once(e.duration, t, t.showMoreGameInfo)), i.text = e.name, i.offClick(t, t.onClickMoreGames),
                                i.onClick(t, t.onClickMoreGames, [e]);
                        }));
                    }, e.prototype.clearMoreGameInfo = function () {
                        var t = this._root.m_btnRmg;
                        t.visible = !1, w.default.clearFrames(t.m_iconGames), t.offClick(this, this.onClickMoreGames);
                    }, e.prototype.onClickMoreGames = function (t) {
                        m.default.showGameWithInfo(t);
                    }, e.prototype.showCombo = function (t) {
                        var e = this._root, i = e.m_jifeids;
                        t ? (i.visible = !0, i.m_labLjs.text = t.toString(), e.m_lianxujifeib.stop(), e.m_lianxujifeia.play()) : (e.m_lianxujifeia.stop(),
                            e.m_lianxujifeib.play(Laya.Handler.create(i, function () {
                                i.visible = !1;
                            })));
                    }, e.prototype.showComboCoin = function (t, e) {
                        var i = this._root;
                        i.m_labTeshujiangli.text = e.toString() + " ", i.m_jinbifangda.play();
                        var n = nt.getObject(D.default.URL);
                        n.x = this.localPlayerOrigin.x, n.y = this.localPlayerOrigin.y - 100, i.addChild(n),
                            n.m_labJbsz.text = t.toString(), n.m_jifeijlsz.play(Laya.Handler.create(this, function () {
                                n.removeFromParent(), nt.returnObject(n);
                            }));
                    }, e.prototype.updateUserId = function () {
                        var t = m.default.getUserId();
                        this._root.m_labWjid.text = t ? t.toString() : "";
                    }, e.prototype.updateAllChest = function () {
                        for (var t = u.default.getInstance(), e = t.chestsInfo, i = t.getNowSecond(), n = this.chestCmps, r = 0; r < 4; r++) {
                            var a = n[r];
                            st(a, e[r]), ot(a, i);
                        }
                        Laya.timer.clear(this, this.updateAllChestTime), Laya.timer.loop(1e3, this, this.updateAllChestTime);
                    }, e.prototype.updateAllChestTime = function () {
                        for (var t = u.default.getInstance().getNowSecond(), e = this.chestCmps, i = 0; i < 4; i++) {
                            ot(e[i], t);
                        }
                    }, e.prototype.onClickChestItem = function (t, e) {
                        var i = t.data;
                        if (i) {
                            var n = u.default.getInstance().getNowSecond();
                            B.default.chestEnableOpen(i, n) ? y.default.showModal(O.default, e, i, h.ChestOpenType.Normal) : g.default.enableFreeOpenChest() ? g.default.enableShareVideoBoxOpen() ? u.default.getInstance().freeOpenChestTimes <= 0 ? y.default.showModal(L.default, t.data, e, 0) : (S.default.lock("load_video"),
                                m.default.destroyVideoAd(), m.default.loadVideoAd("OPEN_CHEST", function () {
                                    S.default.unlock("load_video"), y.default.showModal(L.default, t.data, e, 1);
                                }, function () {
                                    S.default.unlock("load_video"), y.default.showModal(L.default, t.data, e, 0);
                                })) : y.default.showModal(L.default, t.data, e, 0) : y.default.showModal(L.default, t.data, e, 2);
                        } else y.default.showModal(N.default, Laya.Handler.create(this, this.onBtnAuthAndStart));
                    }, e.prototype.showSomeModals = function () {
                        if (this._firstShow) {
                            var t = [];
                            if (g.default.enableFriendGift()) {
                                var e = f.default.getSkinData(p.default.INVITE_REWARD_SKIN);
                                t.push([v.default, e, e.unlock]);
                            }
                            t.length && y.default.showModalSequence(t), this._firstShow = !1;
                        } else if (g.default.enableAutoModal() && this._gameIndex >= 2) {
                            this._gameIndex = 0;
                            for (var i = f.default.allSkins, n = [], r = u.default.getInstance(), a = 0, s = i; a < s.length; a++) {
                                if ((e = s[a]).unlock.isLocked && !e.unlock.isHide) {
                                    var o = e.id;
                                    if (!(r.hasOwnSkinId(o) || r.getFragmentRewardTimes(o) >= e.rewardGainLimit)) {
                                        var l = r.getSkinFragmentCount(o);
                                        l <= 0 || l >= e.synFragmentCost || n.push(e);
                                    }
                                }
                            }
                            if (n.length > 0) {
                                n.sort(function (t, e) {
                                    return t.level !== e.level ? e.level - t.level : e.id - t.id;
                                });
                                var h = n[0];
                                m.default.destroyVideoAd(), g.default.enableShareVideoGainFragment() ? m.default.loadVideoAd("VIDEO_SKIN", function () {
                                    y.default.showModal(U.default, h, !1);
                                }, function () {
                                    y.default.showModal(U.default, h, !0);
                                }) : y.default.showModal(U.default, h, !0);
                            }
                        }
                    }, e.prototype.autoGainChest = function () {
                        if (!(u.default.getInstance().autoGainChestTimes <= 0)) {
                            u.default.getInstance().autoGain();
                            var t = u.default.getInstance();
                            t.gainChest(1, !0), t.gainChest(2, !0), t.gainChest(3, !0), t.gainChest(4, !0);
                        }
                    }, e.prototype.onGetSkinFragment = function () {
                        this._skinDirty = !0, this.updateSkinRedState(), this.updateAllSkinState(), this.updateInviteReward();
                    }, e;
            }(a.default);
            i.default = lt;
        }, {
            "../CommonUIBehaviors": 3,
            "../EventCenter": 4,
            "../Events": 5,
            "../GlobalFuncs": 7,
            "../IData": 8,
            "../ThirdParty/SagiAdHelper": 13,
            "../data/ChestHelper": 16,
            "../data/MjpHelper": 18,
            "../data/RankHelper": 19,
            "../data/UserData": 20,
            "../data/config/ChestConfig": 21,
            "../data/config/RandomNames": 24,
            "../data/config/RewardConfig": 28,
            "../data/fight/IFightData": 31,
            "../data/skin/SkinData": 32,
            "../fgui/ui/UI_home": 102,
            "../fgui/ui/UI_jifeishuzi": 106,
            "../fgui/ui/UI_shengmjinbi": 113,
            "../game/GameConstants": 127,
            "../game/HomeConstants": 129,
            "../game/game/services/RecordService": 223,
            "../math/MathHelper": 320,
            "../sdk/sdk": 327,
            "./AddCoinModal": 330,
            "./AddPlayerModal": 331,
            "./ChestAccelerateModal": 332,
            "./ChestOpenModal": 333,
            "./ChestRewardModal": 334,
            "./CollectTipsModal": 335,
            "./CollectTipsQQModal": 336,
            "./FreeFragmentModal": 337,
            "./GongZhongHaoModal": 338,
            "./InviteRewardModal": 340,
            "./Loading": 341,
            "./LuckSlotModal": 342,
            "./Modal": 344,
            "./NoChestTipsModal": 346,
            "./RankModal": 348,
            "./RewardSkinModal": 349,
            "./SharingVideoModal": 350,
            "./SimpleMovieHelper": 351,
            "./SkinTryModal": 352,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        344: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../EventCenter"), s = t("../Events"), o = function (t) {
                function e() {
                    var e = t.call(this, [], fairygui.GComponent, null) || this;
                    return e._root.displayObject.zOrder = n.default.ZORDER_MODAL, e;
                }
                return r(e, t), e.showModal = function (t) {
                    for (var e = [], i = 1; i < arguments.length; i++) e[i - 1] = arguments[i];
                    var n = this.getInstance();
                    n.show();
                    var r = n.findModalInRoot(t);
                    r ? n.bringToFront(r._root) : ((r = new t()).addTo(n._root), r.setHideHandler(Laya.Handler.create(n, n.onModalHide, [r], !1))),
                        n.onModalShow(r), r.setData.apply(r, e), r.show();
                }, e.showModalSequence = function (t) {
                    this.s_modalSequence = t, this._nextModal();
                }, e._nextModal = function () {
                    if (this.s_modalSequence.length > 0) {
                        var t = this.s_modalSequence.shift();
                        this.showModal.apply(this, t);
                    }
                }, e.prototype.bringToFront = function (t) {
                    var e = this._root.numChildren;
                    this._root.getChildIndex(t) !== e - 1 && this._root.setChildIndex(t, e - 1);
                }, e.prototype.findModalInRoot = function (t) {
                    for (var e = 0; e < this._root.numChildren; e++) {
                        var i = this._root.getChildAt(e), n = i.__modal__;
                        if (n && n instanceof t) {
                            if (i.visible && !n.isSingleInst) continue;
                            return n;
                        }
                    }
                    return null;
                }, e.prototype.onModalShow = function (t) {
                    a.default.emit(s.default.UI_SOME_MODAL_SHOW);
                }, e.prototype.onModalHide = function (t) {
                    if (e.s_modalSequence.length > 0) return e._nextModal();
                    for (var i = !0, n = 0; n < this._root.numChildren; n++) {
                        if (this._root.getChildAt(n).visible) {
                            i = !1;
                            break;
                        }
                    }
                    i && a.default.emit(s.default.UI_ALL_MODAL_CLOSE);
                }, e.s_modalSequence = [], e;
            }(n.default);
            i.default = o;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "./ViewBase": 356
        }],
        345: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("./Modal"), s = t("../fgui/Common/UI_tanchuangty"), o = function (t) {
                function e() {
                    return t.call(this, ["Common"], s.default, null, !1, !0, !1) || this;
                }
                return r(e, t), e.showBox = function (t, e) {
                    a.default.showModal(this, {
                        desc: t,
                        confirm: e
                    });
                }, e.prototype.onCreate = function () {
                    this._root.m_btnQuerenc.onClick(this, this.onBtnConfirm);
                }, e.prototype.onDestroy = function () {
                    this.confirm = null, this.cancel = null;
                }, e.prototype.setData = function (t) {
                    this.confirm = t.confirm, this.cancel = null, this._root.m_labQr.text = t.desc || "";
                }, e.prototype.onBtnConfirm = function () {
                    this.hide(), this.confirm && (this.confirm.run(), this.confirm.recover(), this.confirm = null);
                }, e.prototype.onBtnCancel = function () {
                    this.hide(), this.cancel && (this.cancel.run(), this.cancel.recover(), this.cancel = null);
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../fgui/Common/UI_tanchuangty": 48,
            "./Modal": 344,
            "./ViewBase": 356
        }],
        346: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_xiaokuang"), s = t("../sdk/sdk"), o = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGbc.onClick(this, this.hide), t.m_btnLjsya.onClick(this, this.onClickStartGame),
                        s.default.bindUserInfoIcon(t.m_btnLjsya, "no_chest");
                }, e.prototype.setData = function (t) {
                    this.handler = t;
                }, e.prototype.onShow = function () {
                    s.default.showUserInfoIcon(["no_chest"]);
                }, e.prototype.onHide = function () {
                    this.handler && (this.handler.recover(), this.handler = null), s.default.hideUserInfoIcon(["no_chest"]);
                }, e.prototype.onClickStartGame = function (t) {
                    this.handler && (this.handler.runWith(t), this.handler = null), this.hide();
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../fgui/ui/UI_xiaokuang": 121,
            "../sdk/sdk": 327,
            "./ViewBase": 356
        }],
        347: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../EventCenter"), s = t("../Events"), o = function (t) {
                function e() {
                    var e = t.call(this, ["ui"], fairygui.GComponent, null) || this;
                    return e._curTouchId = null, e._movedOut = !1, e._originPos = new Laya.Vector2(),
                        e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.opaque = !0, this.fullToRootSize(t), a.default.on(s.default.GAME_READY, this, this.show),
                        a.default.on(s.default.GAME_ENDED, this, this.hide);
                }, e.prototype.onShow = function () {
                    var t = this._root;
                    t.on("mousedown", this, this.onMouseDown), t.on("mousemove", this, this.onMouseMove),
                        t.on("mouseup", this, this.onMouseUp), t.on("mouseout", this, this.onMouseOut);
                }, e.prototype.onHide = function () {
                    this._curTouchId = null;
                    var t = this._root;
                    t.off("mousedown", this, this.onMouseDown), t.off("mousemove", this, this.onMouseMove),
                        t.off("mouseup", this, this.onMouseUp), t.off("mouseout", this, this.onMouseOut);
                }, e.prototype.onDestroy = function () {
                    a.default.off(s.default.GAME_READY, this, this.show), a.default.off(s.default.GAME_ENDED, this, this.hide);
                }, e.prototype.onMouseDown = function (t) {
                    t.target === this._root.displayObject && (null === this._curTouchId || this._movedOut) && (this._curTouchId = t.touchId,
                        this._originPos.x = t.stageX, this._originPos.y = t.stageY, this._movedOut = !1);
                }, e.prototype.onMouseUp = function (t) {
                    t.target === this._root.displayObject && t.touchId == this._curTouchId && (this._curTouchId = null,
                        a.default.emit(s.default.UI_PLAYER_STOP));
                }, e.prototype.onMouseOut = function (t) {
                    t.touchId == this._curTouchId && (this._movedOut = !0);
                }, e.prototype.onMouseMove = function (t) {
                    if (t.target === this._root.displayObject && t.touchId == this._curTouchId) {
                        var e = t.stageX - this._originPos.x, i = t.stageY - this._originPos.y;
                        this._movedOut = !1, a.default.emit(s.default.UI_PLAYER_MOVE, e, i);
                    }
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "./ViewBase": 356
        }],
        348: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_top"), s = t("../data/MjpHelper"), o = t("../sdk/sdk"), l = t("./Loading"), h = t("./Toast"), u = t("../data/UserData"), c = t("../GlobalFuncs"), d = t("../data/RankHelper");
            function _(t, e) {
                var i = e.rank;
                if (t.m_c1.selectedIndex = Math.min(3, i - 1), t.m_c2.selectedIndex = i % 2, t.m_labFour.text = i.toString(),
                    e.selfFlag) {
                    var n = u.default.getInstance();
                    t.m_labWjnc.text = c.default.clampString(n.nickname, 5), t.m_iconPhbtx.url = n.avatar;
                } else if (e.avatarUrl) t.m_labWjnc.text = c.default.clampString(e.nickname, 5),
                    t.m_iconPhbtx.url = e.avatarUrl; else {
                    var r = s.default.getPlayerInfo(e.nickname);
                    t.m_labWjnc.text = c.default.clampString(r.nickname, 5), t.m_iconPhbtx.url = r.headimg;
                }
                var a = d.default.getRankInfo(e.value);
                t.m_labPhbjb.text = a.name, t.m_iconDuanweig.url = a.icon;
            }
            var f = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGuanbi.onClick(this, this.hide), t.m_btnYaoqing.onClick(this, this.onBtnClickShare);
                }, e.prototype.onDestroy = function () { }, e.prototype.onShow = function () {
                    var t = this, e = this._root.m_listPaihangb;
                    e.removeChildrenToPool(), this.updateSelfInfo(null), this.requestRankInfo(function (i) {
                        t.updateRankList(e, i);
                    }), o.default.showBannerAd("RANK_BANNER", c.default.getBannerRectWithHeight(210));
                }, e.prototype.onHide = function () {
                    o.default.hideBannerAd("RANK_BANNER");
                }, e.prototype.onBtnClickShare = function () {
                    var t = s.default.getRandomShareInfo();
                    t.query.source = "rank", o.default.shareInfo(t.title, t.imageUrl, t.query);
                }, e.prototype.requestRankInfo = function (t) {
                    l.default.lock("update_ranking"), o.default.getWorldRankInfo("game_score", function (e) {
                        l.default.unlock("update_ranking"), t(e);
                    }, function () {
                        l.default.unlock("update_ranking"), h.default.toast("加载排行榜失败，请稍后重试");
                    });
                }, e.prototype.updateRankList = function (t, e) {
                    for (var i, n = 0; n < e.length; n++) {
                        var r = t.addItemFromPool(), a = e[n];
                        a.rank = n + 1, _(r, a), a.selfFlag && (i = a);
                    }
                    this.updateSelfInfo(i);
                }, e.prototype.updateSelfInfo = function (t) {
                    var e = u.default.getInstance(), i = this._root;
                    i.m_labWeishangb.text = t ? t.rank.toString() : "未上榜", i.m_labWjiamzi.text = c.default.clampString(e.nickname, 5),
                        i.m_iconWjiatx.url = e.avatar;
                    var n = d.default.getRankInfo(t ? t.value : e.score);
                    i.m_labWjiachibil.text = n.name, i.m_iconDuanweih.url = n.icon;
                }, e;
            }(n.default);
            i.default = f;
        }, {
            "../GlobalFuncs": 7,
            "../data/MjpHelper": 18,
            "../data/RankHelper": 19,
            "../data/UserData": 20,
            "../fgui/ui/UI_top": 117,
            "../sdk/sdk": 327,
            "./Loading": 341,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        349: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_pifuhuode"), s = t("../data/UserData"), o = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.prototype.setData = function (t) {
                    this.skin = t, this.updateSkinInfo(t);
                }, e.prototype.onCreate = function () {
                    this._root.m_btnLjsya.onClick(this, this.onClickUse);
                }, e.prototype.updateSkinInfo = function (t) {
                    // var e = this._root.m_pifujiangli;
                    // e.m_iconFifu.url = t.icon,
                    // //  e.m_labYiyy.text = t.name, 
                    //  e.m_iconPifujb.url = "ui://ui/pfjb" + t.level,
                    //     e.m_c1.selectedIndex = 0;
                }, e.prototype.onClickUse = function () {
                    console.log("dianjile:", this.skin.id)
                    s.default.getInstance().setSelectedSkinId(this.skin.id), this.hide();
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "../data/UserData": 20,
            "../fgui/ui/UI_pifuhuode": 108,
            "./ViewBase": 356
        }],
        350: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../IData"), s = t("../EventCenter"), o = t("../Events"), l = t("../data/UserData"), h = t("../sdk/sdk"), u = t("./Toast"), c = t("../fgui/ui/UI_SharingVideo"), d = t("../GlobalFuncs"), _ = t("../data/skin/SkinData"), f = t("../game/game/services/RecordService"), p = function (t) {
                function e() {
                    return t.call(this, ["ui"], c.default, null, !1, !0, !0) || this;
                }
                return r(e, t), e.getValidSkin = function () {
                    for (var t = _.default.allSkins, e = [], i = l.default.getInstance(), n = 0, r = t; n < r.length; n++) {
                        var a;
                        if ((a = r[n]).unlock.isLocked && !a.unlock.isHide) {
                            var s = a.id;
                            if (!i.hasOwnSkinId(s)) if (!(i.getFragmentRewardTimes(s) >= a.rewardGainLimit)) i.getSkinFragmentCount(s) >= a.synFragmentCost || e.push(a);
                        }
                    }
                    return e.length > 0 ? (e.sort(function (t, e) {
                        return t.level !== e.level ? e.level - t.level : e.id - t.id;
                    }), a = e[0]) : null;
                }, e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnGbb.onClick(this, this.hide), t.m_btn_share.onClick(this, this.onClickShare);
                }, e.prototype.onShow = function () {
                    h.default.showBannerAd("VIDEO_SHARE", d.default.getBannerRectWithHeight(210));
                }, e.prototype.onHide = function () {
                    h.default.hideBannerAd("VIDEO_SHARE"), s.default.emit(o.default.UI_HIDE_MODEL),
                        this.skin = null;
                }, e.prototype.setData = function (t, e) {
                    l.default.getInstance();
                    var i = this._root;
                    t.id;
                    i.m_iconPifusuip.url = t.fragmentIcon, this.shareHandler = e, this.skin = t;
                    var n = this.getLastTimes();
                    i.m_lab_lastTimes.text = "今日分享可领取 " + n + " 次奖励";
                }, e.prototype.getLastTimes = function () {
                    var t = 10 - l.default.getInstance().shareVideoFragmentTimes;
                    return t = Math.max(0, t);
                }, e.prototype.addShareTimes = function () {
                    this.getLastTimes() > 0 && l.default.getInstance().shareVideoFragmentTimes++;
                }, e.prototype.onClickShare = function () {
                    var t = this;
                    f.default.instance().shareVideo(function (e, i) {
                        (console.log("分享结果:" + e, i), e) ? t.getLastTimes() > 0 && (t.addShareTimes(), l.default.getInstance().gainSkinFragment(t.skin.id, 10, a.FragmentGainType.ShareVideoModal)) : u.default.toast("分享失败~");
                        f.default.instance().deleteVideo(), t.hide();
                    });
                }, e;
            }(n.default);
            i.default = p;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../GlobalFuncs": 7,
            "../IData": 8,
            "../data/UserData": 20,
            "../data/skin/SkinData": 32,
            "../fgui/ui/UI_SharingVideo": 57,
            "../game/game/services/RecordService": 223,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        351: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../Loader");
            function r(t) {
                var e, i, n, r, a, s, o = t.substr(5).split("/");
                return o.length > 1 ? (a = o[0], s = o[1], fairygui.UIPackage.getByName(a).getItemAssetByName(s)) : (e = t.substr(5, 8),
                    i = t.substr(13), n = fairygui.UIPackage.getById(e), (r = n.getItemById(i)) && n.getItemAsset(r) || null);
            }
            function a(t, e, i, n, a) {
                var s = function (t) {
                    for (var e = [], i = 0, n = t; i < n.length; i++) {
                        var a = n[i];
                        0 === a.url.indexOf("ui://") ? e.push({
                            addDelay: a.addDelay || 0,
                            texture: r(a.url)
                        }) : e.push({
                            addDelay: a.addDelay || 0,
                            texture: Laya.loader.getRes(a.url)
                        });
                    }
                    return e;
                }(e), o = t.content;
                o.frames = s, o.interval = i, o.swing = a || !1, o.repeatDelay = n || 0;
                var l = function (t) {
                    for (var e = 0, i = 0, n = 0, r = t; n < r.length; n++) {
                        var a = r[n];
                        a.texture && (e = Math.max(e, a.texture.width), i = Math.max(e, a.texture.height));
                    }
                    return {
                        width: e,
                        height: i
                    };
                }(s), h = l.width, u = l.height, c = t;
                c._contentSourceWidth = h || t.width, c._contentSourceHeight = u || t.height, c.updateLayout(),
                    t.playing = !0;
            }
            function s(t) {
                t.clearContent();
                var e = t.content;
                e._endHandler && (e._endHandler.recover(), e._endHandler = null), t.playing = !1;
            }
            var o = function () {
                function t() { }
                return t.lazy_init = function () {
                    this.inited || (this.loader = n.default.root.createSubLoader(), this.inited = !0);
                }, t.setFrames = function (t, e, i, n, r) {
                    t.isMovieClip || s(t), t.isMovieClip = !0;
                    var o = function (t) {
                        for (var e = [], i = 0, n = t; i < n.length; i++) {
                            var r = n[i];
                            0 !== r.url.indexOf("ui://") && e.push({
                                url: r.url,
                                type: "image"
                            });
                        }
                        return e;
                    }(e);
                    o.length <= 0 ? a(t, e, i, n, r) : (this.lazy_init(), this.loader.load(o, Laya.Handler.create(t, a, [t, e, i, n, r]), null, 3));
                }, t.setPlaySettings = function (t, e, i, n, r, a) {
                    t.isMovieClip ? t.content.setPlaySettings(e, i, n, r, a) : a && a.recover();
                }, t.clearFrames = function (t, e) {
                    t.isMovieClip && s(t), t.url = e || null, t.isMovieClip = void 0;
                }, t;
            }();
            i.default = o;
        }, {
            "../Loader": 10
        }],
        352: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_pifushiyongjiemian"), s = t("../data/MjpHelper"), o = t("../sdk/sdk"), l = t("./Toast"), h = t("../EventCenter"), u = t("../Events"), c = t("../GlobalFuncs"), d = function (t) {
                function e() {
                    // var e = t.call(this, ["ui"], a.default, null, !1, !0, !0) || this;
                    // return e.modelInfo = {
                    //     url: null,
                    //     modelTextures: null,
                    //     animation: "run_slow",
                    //     position: new Laya.Vector3(0, 0, 0),
                    //     rotation: new Laya.Vector3(0, -45, 0),
                    //     cameraViewFiled: 30,
                    //     cameraPosition: new Laya.Vector3(10, 1, 3.3),
                    //     cameraRotation: new Laya.Vector3(-5, 0, 0),
                    //     cameraViewPort: null
                    //     //xiangji2
                    // }, e.noVideo = !1, e;
                }
                return r(e, t), e.prototype.setData = function (t, e, i, n) {
                    this.callback = e, this.skin = t, this.modelInfo.url = t.model, this.modelInfo.modelTextures = t.modelTextures,
                        h.default.emit(u.default.UI_SHOW_MODEL, this.modelInfo);
                    var r = this._root;
                    r.m_labJcs.text = i, r.m_labPfmc.text = t.name, r.m_labPfsx.text = "皮肤加成：" + t.getAttrsDesc("、") + " ",
                        r.m_c1.selectedIndex = n || this.noVideo ? 1 : 0, r.m_c2.selectedIndex = t.level - 1;
                }, e.prototype.onCreate = function () {
                    var t = this._root;
                    t.m_btnFxsy.onClick(this, this.onBtnShare), t.m_btnSpsy.onClick(this, this.onBtnVideo),
                        t.m_btnTg.onClick(this, this.onBtnSkip), t.m_c1.selectedIndex = 0;
                    var e = t.m_night, i = e.width, n = e.height, r = e.x, a = e.y;
                    "oppo" != o.default.getPlatform() && e.pivotAsAnchor && (r -= i * e.pivotX, a -= n * e.pivotY);
                    var s = t.localToGlobal(r, a), l = t.localToGlobal(r + i, a + n);
                    this.modelInfo.cameraViewPort = new Laya.Viewport(s.x, s.y, l.x - s.x, l.y - s.y);
                }, e.prototype.onShow = function () {
                    o.default.showBannerAd("TRY_BANNER", c.default.getBannerRectWithHeight(210));
                }, e.prototype.onHide = function () {
                    o.default.hideBannerAd("TRY_BANNER"), h.default.emit(u.default.UI_HIDE_MODEL);
                }, e.prototype.onBtnShare = function () {
                    var t = this, e = s.default.getRandomShareInfo();
                    e.query.source = "skin_try", o.default.shareInfo(e.title, e.imageUrl, e.query, function () {
                        l.default.toast("成功获得试用，开始匹配"), t.executeCallbackAndHide([t.skin, "share"]);
                    }, function () {
                        l.default.toast("分享失败，未获得试用，开始匹配"), t.executeCallbackAndHide(null);
                    });
                }, e.prototype.onBtnVideo = function () {
                    var t = this;
                    o.default.loadVideoAd("SKIN_TRY", function () {
                        s.default.showVideoAd(function () {
                            l.default.toast("成功获得试用，开始匹配"), t.executeCallbackAndHide([t.skin, "video"]);
                        }, function () {
                            l.default.toast("未观看完整视频，未获得试用，开始匹配"), t.executeCallbackAndHide(null);
                        });
                    }, function () {
                        t.noVideo = !0, t._root.m_c1.selectedIndex = 1, l.default.toast("今日视频次数已达上限");
                    });
                }, e.prototype.onBtnSkip = function () {
                    this.executeCallbackAndHide(null);
                }, e.prototype.executeCallbackAndHide = function (t) {
                    this.callback && (this.callback.runWith(t), this.callback.recover(), this.callback = null),
                        this.hide();
                }, e;
            }(n.default);
            i.default = d;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../GlobalFuncs": 7,
            "../data/MjpHelper": 18,
            "../fgui/ui/UI_pifushiyongjiemian": 109,
            "../sdk/sdk": 327,
            "./Toast": 354,
            "./ViewBase": 356
        }],
        353: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = function (t) {
                function e() {
                    return t.call(this) || this;
                }
                return r(e, t), e.createInstance = function () {
                    return fairygui.UIPackage.createObject("start", "StartView");
                }, e.prototype.constructFromXML = function (e) {
                    t.prototype.constructFromXML.call(this, e), this.m_bottom = this.getChild("bottom"),
                        this.m_progress = this.getChild("progress");
                }, e.URL = "ui://start/StartView", e;
            }(fairygui.GComponent), s = function () {
                function t() { }
                return t.bindAll = function () {
                    fairygui.UIObjectFactory.setPackageItemExtension(a.URL, a);
                }, t;
            }(), o = function (t) {
                function e() {
                    var e = t.call(this, "start", a, s) || this;
                    return e._targetValue = -1, e;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    var t = this._root;
                    t.displayObject.zOrder = n.default.ZORDER_START, this.fullToRootSize(t.m_bottom),
                        t.m_progress.max = 100, t.m_progress.value = 0;
                }, e.prototype.setProgress = function (t) {
                    this._root.m_progress.visible = !0;
                    var e = Math.floor(100 * t);
                    this._targetValue >= e || (this._targetValue = e, Laya.Tween.to(this._root.m_progress, {
                        value: e
                    }, 1e3));
                }, e;
            }(n.default);
            i.default = o;
        }, {
            "./ViewBase": 356
        }],
        354: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_Toast"), s = function (t) {
                function e() {
                    var e = t.call(this, "ui", fairygui.GComponent, null) || this;
                    window.rrzzs = e._root.displayObject
                    return e._root.displayObject.zOrder = n.default.ZORDER_TOAST, e._root.enabled = !1,
                        e;
                }
                return r(e, t),
                    e.toast = function (t, e) {
                        var i = this;
                        void 0 === e && (e = 50), setTimeout(function () {
                            var e = i._getToast();
                            e.m_labWllj.text = t, e.m_t1.play();
                            window.rrzzs.x = 0
                        }, e);
                    }, e._getToast = function () {
                        var t = laya.utils.Pool.getItem(this.TOAST_SIGN);
                        if (!t) {
                            var e = this.getInstance();
                            e.show(), t = e.newToast();

                        }
                        return t.visible = !0, t;
                    }, e._cacheToast = function (t) {

                        t.visible = !1,
                            laya.utils.Pool.recover(this.TOAST_SIGN, t);
                    }, e.prototype.newToast = function () {

                        var t = a.default.createInstance();

                        return t.addRelation(this._root, fairygui.RelationType.Width),
                            t.addRelation(this._root, fairygui.RelationType.Middle_Middle),
                            t.width = this._root.width, this._root.addChild(t), t;
                    }, e.TOAST_SIGN = "toast_sign", e;
            }(n.default);
            i.default = s;
        }, {
            "../fgui/ui/UI_Toast": 58,
            "./ViewBase": 356
        }],
        355: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("./ViewBase"), a = t("../fgui/ui/UI_animChangjingqiehuan"), s = t("../EventCenter"), o = t("../Events"), l = function (t) {
                function e() {
                    return t.call(this, ["ui"], a.default, null) || this;
                }
                return r(e, t), e.prototype.onCreate = function () {
                    this._root.opaque = !1, this.fullToRootSize(this._root), s.default.on(o.default.UI_TRANSFORM_START, this, this.show),
                        s.default.on(o.default.UI_TRANSFORM_RESUME, this, this.resume), s.default.on(o.default.GAME_START, this, this.hide);
                }, e.prototype.onDestroy = function () {
                    s.default.off(o.default.UI_TRANSFORM_START, this, this.show), s.default.off(o.default.UI_TRANSFORM_RESUME, this, this.resume),
                        s.default.off(o.default.GAME_START, this, this.hide);
                }, e.prototype.onShow = function () {
                    this._root.m_animCjqh.play(Laya.Handler.create(this, this.onFadeIn));
                }, e.prototype.onHide = function () { }, e.prototype.resume = function () {
                    this._root.m_animCjqhb.play(Laya.Handler.create(this, this.onFadeOut));
                }, e.prototype.onFadeIn = function () {
                    s.default.emit(o.default.UI_TRANSFORM_PAUSE);
                }, e.prototype.onFadeOut = function () {
                    s.default.emit(o.default.UI_TRANSFORM_ENDED), this.hide();
                }, e;
            }(n.default);
            i.default = l;
        }, {
            "../EventCenter": 4,
            "../Events": 5,
            "../fgui/ui/UI_animChangjingqiehuan": 60,
            "./ViewBase": 356
        }],
        356: [function (t, e, i) {
            "use strict";
            Object.defineProperty(i, "__esModule", {
                value: !0
            });
            var n = t("../GlobalFuncs"), r = t("../fgui/Common/UI_mengban"), a = function () {
                function t(t, e, i, n, r, a) {
                    void 0 === n && (n = !1), void 0 === r && (r = !1), void 0 === a && (a = !0), this._root = null,
                        this._hideHandler = null, this._isModal = !1, this._isSingleInst = !0, t instanceof Array || (t = [t]),
                        r && t.push("Common");
                    for (var s = n ? "" : "fgui/", o = 0, l = t; o < l.length; o++) {
                        var h = s + l[o];
                        fairygui.UIPackage.getByName(h) || fairygui.UIPackage.addPackage(h);
                    }
                    i && i.bindAll(), this._isModal = r, this._isSingleInst = a, r ? this.initModel(e) : this.initView(e),
                        this._root.visible = !1;
                }
                return t.getInstance = function () {
                    return this._instance || (this._instance = new this()), this._instance;
                }, t.purge = function () {
                    this._instance && (this._instance.destroy(), this._instance = null);
                }, t.show = function () {
                    for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                    var i = this,
                        n = i._instance;
                    n || (n = i._instance = new i()),
                        n.setData.apply(n, t), n.show();
                }, t.hide = function () {
                    this._instance && this._instance.hide();
                }, Object.defineProperty(t.prototype, "isSingleInst", {
                    get: function () {
                        return this._isSingleInst;
                    },
                    enumerable: !1,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "root", {
                    get: function () {
                        return this._root;
                    },
                    enumerable: !1,
                    configurable: !0
                }), t.prototype.initView = function (t) {
                    var e = fairygui.GRoot.inst, i = t.createInstance ? t.createInstance() :
                        new t(),
                        r = n.default.getSafeArea(),
                        a = e.width / Laya.Browser.clientWidth, s = e.height / Laya.Browser.clientHeight;
                    i.setXY(r.x * a, r.y * s),
                        i.setSize(r.width * a, r.height * s),
                        i.removeRelation(e),
                        i.addRelation(e, fairygui.RelationType.Size, !1),
                        i.addRelation(e, fairygui.RelationType.Left_Left, !1),
                        i.addRelation(e, fairygui.RelationType.Top_Top, !1),
                        e.addChild(i),
                        this._root = i,
                        this.onCreate();
                }, t.prototype.show = function () {
                    if (!this._root) return console.log("---------- root is null::: \n" + new Error().stack);
                    this._root.visible || (this._root.visible = !0, this.onShow());
                }, t.prototype.hide = function () {
                    if (!this._root) return console.log("---------- root is null::: \n" + new Error().stack);
                    this._root.visible && (this._root.visible = !1, this.onHide()), this._hideHandler && this._hideHandler.run();
                }, t.prototype.destroy = function () {
                    if (this._isModal && console.warn("need modal view destroy?", new Error().stack),
                        !this._root) return console.log("---------- root is null::: \n" + new Error().stack);
                    this.hide(), this.onDestroy(), this._hideHandler && (this._hideHandler.recover(),
                        this._hideHandler = null), this._root.dispose(), this._root = null;
                }, t.prototype.fullToRootSize = function (t) {
                    var e = fairygui.GRoot.inst, i = t.parent.globalToLocal();
                    t.setSize(e.width, e.height), t.setXY(i.x, i.y), t.removeRelation(e), t.addRelation(e, fairygui.RelationType.Size, !1),
                        t.addRelation(e, fairygui.RelationType.Center_Center, !1), t.addRelation(e, fairygui.RelationType.Middle_Middle, !1);
                }, t.prototype.onShow = function () { }, t.prototype.onHide = function () { }, t.prototype.onCreate = function () { },
                    t.prototype.onDestroy = function () { }, t.prototype.setData = function () {
                        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                    }, t.prototype.setHideHandler = function (t) {
                        this._hideHandler = t;
                    }, t.prototype.initModel = function (t) {
                        var e = t.createInstance ? t.createInstance() : new t();
                        e.__modal__ = this;
                        var i = fairygui.GRoot.inst;
                        e.addRelation(i, fairygui.RelationType.Center_Center, !1);
                        var n = r.default.createInstance();
                        e.addChildAt(n, 0);
                        var a = n.parent.globalToLocal();
                        n.setSize(2 * i.width, 2 * i.height), n.setXY(a.x - .5 * i.width, a.y - .5 * i.height),
                            n.removeRelation(i), n.addRelation(i, fairygui.RelationType.Size, !0), n.addRelation(i, fairygui.RelationType.Center_Center, !0),
                            n.addRelation(i, fairygui.RelationType.Middle_Middle, !0), this._root = e;
                    }, t.prototype.addTo = function (t) {
                        t.addChild(this._root), this._root.center(), this.onCreate();
                    }, t.ZORDER_START = 8, t.ZORDER_LOADING = 100, t.ZORDER_TOAST = 10, t.ZORDER_MODAL = 9,
                    t;
            }();
            i.default = a;
        }, {
            "../GlobalFuncs": 7,
            "../fgui/Common/UI_mengban": 47
        }]
    }, {}, [11]);
}]);