window.Laya=function(n){"use strict";class s{}s.animationInterval=50;s.isAntialias=false;s.isAlpha=false;s.premultipliedAlpha=true;s.isStencil=true;s.preserveDrawingBuffer=false;s.webGL2D_MeshAllocMaxMem=true;s.is2DPixelArtGame=false;s.useWebGL2=true;s.useRetinalCanvas=false;window.Config=s;class T{static regClass(t){T.__classMap[t.name]=t}}T.Laya=null;T.Timer=null;T.WorkerLoader=null;T.Dragging=null;T.GraphicsBounds=null;T.Sprite=null;T.TextRender=null;T.TextAtlas=null;T.timer=null;T.systemTimer=null;T.startTimer=null;T.updateTimer=null;T.lateTimer=null;T.physicsTimer=null;T.stage=null;T.Loader=null;T.loader=null;T.TTFLoader=null;T.SoundManager=null;T.WebAudioSound=null;T.AudioSound=null;T.ShaderCompile=null;T.ClassUtils=null;T.SceneUtils=null;T.Context=null;T.Render=null;T.MouseManager=null;T.Text=null;T.Browser=null;T.WebGL=null;T.Pool=null;T.Utils=null;T.Graphics=null;T.Submit=null;T.Stage=null;T.Resource=null;T.__classMap={};class p{static getPoolBySign(t){return p._poolDic[t]||(p._poolDic[t]=[])}static clearBySign(t){if(p._poolDic[t])p._poolDic[t].length=0}static recover(t,e){if(e[p.POOLSIGN])return;e[p.POOLSIGN]=true;p.getPoolBySign(t).push(e)}static recoverByClass(t){if(t){var e=t["__className"]||t.constructor._$gid;if(e)p.recover(e,t)}}static _getClassSign(t){var e=t["__className"]||t["_$gid"];if(!e){t["_$gid"]=e=p._CLSID+"";p._CLSID++}return e}static createByClass(t){return p.getItemByClass(p._getClassSign(t),t)}static getItemByClass(t,e){if(!p._poolDic[t])return new e;var o=p.getPoolBySign(t);if(o.length){var i=o.pop();i[p.POOLSIGN]=false}else{i=new e}return i}static getItemByCreateFun(t,e,o=null){var i=p.getPoolBySign(t);var a=i.length?i.pop():e.call(o);a[p.POOLSIGN]=false;return a}static getItem(t){var e=p.getPoolBySign(t);var o=e.length?e.pop():null;if(o){o[p.POOLSIGN]=false}return o}}p._CLSID=0;p.POOLSIGN="__InPool";p._poolDic={};class k{static create(t){var e=p.getItemByClass("AlphaCmd",k);e.alpha=t;return e}recover(){p.recover("AlphaCmd",this)}run(t,e,o){t.alpha(this.alpha)}get cmdID(){return k.ID}}k.ID="Alpha";class O{static create(t,e,o,i,a,r,s){var n=p.getItemByClass("DrawCircleCmd",O);n.x=t;n.y=e;n.radius=o;n.fillColor=i;n.lineColor=a;n.lineWidth=r;n.vid=s;return n}recover(){this.fillColor=null;this.lineColor=null;p.recover("DrawCircleCmd",this)}run(t,e,o){t._drawCircle(this.x+e,this.y+o,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return O.ID}}O.ID="DrawCircle";class N{static create(t,e,o,i,a){var r=p.getItemByClass("DrawCurvesCmd",N);r.x=t;r.y=e;r.points=o;r.lineColor=i;r.lineWidth=a;return r}recover(){this.points=null;this.lineColor=null;p.recover("DrawCurvesCmd",this)}run(t,e,o){t.drawCurves(this.x+e,this.y+o,this.points,this.lineColor,this.lineWidth)}get cmdID(){return N.ID}}N.ID="DrawCurves";class W{static create(t,e,o,i,a){var r=p.getItemByClass("DrawImageCmd",W);r.texture=t;t._addReference();r.x=e;r.y=o;r.width=i;r.height=a;return r}recover(){this.texture._removeReference();this.texture=null;p.recover("DrawImageCmd",this)}run(t,e,o){t.drawTexture(this.texture,this.x+e,this.y+o,this.width,this.height)}get cmdID(){return W.ID}}W.ID="DrawImage";class U{static create(t,e,o,i,a,r,s){var n=p.getItemByClass("DrawLineCmd",U);n.fromX=t;n.fromY=e;n.toX=o;n.toY=i;n.lineColor=a;n.lineWidth=r;n.vid=s;return n}recover(){p.recover("DrawLineCmd",this)}run(t,e,o){t._drawLine(e,o,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return U.ID}}U.ID="DrawLine";class X{static create(t,e,o,i,a,r){var s=p.getItemByClass("DrawLinesCmd",X);s.x=t;s.y=e;s.points=o;s.lineColor=i;s.lineWidth=a;s.vid=r;return s}recover(){this.points=null;this.lineColor=null;p.recover("DrawLinesCmd",this)}run(t,e,o){t._drawLines(this.x+e,this.y+o,this.points,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return X.ID}}X.ID="DrawLines";class H{static create(t,e,o,i,a){var r=p.getItemByClass("DrawPathCmd",H);r.x=t;r.y=e;r.paths=o;r.brush=i;r.pen=a;return r}recover(){this.paths=null;this.brush=null;this.pen=null;p.recover("DrawPathCmd",this)}run(t,e,o){t._drawPath(this.x+e,this.y+o,this.paths,this.brush,this.pen)}get cmdID(){return H.ID}}H.ID="DrawPath";class Y{static create(t,e,o,i,a,r,s,n,b){var x=p.getItemByClass("DrawPieCmd",Y);x.x=t;x.y=e;x.radius=o;x._startAngle=i;x._endAngle=a;x.fillColor=r;x.lineColor=s;x.lineWidth=n;x.vid=b;return x}recover(){this.fillColor=null;this.lineColor=null;p.recover("DrawPieCmd",this)}run(t,e,o){t._drawPie(this.x+e,this.y+o,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}get cmdID(){return Y.ID}get startAngle(){return this._startAngle*180/Math.PI}set startAngle(t){this._startAngle=t*Math.PI/180}get endAngle(){return this._endAngle*180/Math.PI}set endAngle(t){this._endAngle=t*Math.PI/180}}Y.ID="DrawPie";class q{static create(t,e,o,i,a,r,s,n){var b=p.getItemByClass("DrawPolyCmd",q);b.x=t;b.y=e;b.points=o;b.fillColor=i;b.lineColor=a;b.lineWidth=r;b.isConvexPolygon=s;b.vid=n;return b}recover(){this.points=null;this.fillColor=null;this.lineColor=null;p.recover("DrawPolyCmd",this)}run(t,e,o){t._drawPoly(this.x+e,this.y+o,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}get cmdID(){return q.ID}}q.ID="DrawPoly";class j{static create(t,e,o,i,a,r,s){var n=p.getItemByClass("DrawRectCmd",j);n.x=t;n.y=e;n.width=o;n.height=i;n.fillColor=a;n.lineColor=r;n.lineWidth=s;return n}recover(){this.fillColor=null;this.lineColor=null;p.recover("DrawRectCmd",this)}run(t,e,o){t.drawRect(this.x+e,this.y+o,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}get cmdID(){return j.ID}}j.ID="DrawRect";class w{constructor(t=1,e=0,o=0,i=1,a=0,r=0,s=0){this._bTransform=false;if(w._createFun!=null){return w._createFun(t,e,o,i,a,r,s)}this.a=t;this.b=e;this.c=o;this.d=i;this.tx=a;this.ty=r;this._checkTransform()}identity(){this.a=this.d=1;this.b=this.tx=this.ty=this.c=0;this._bTransform=false;return this}_checkTransform(){return this._bTransform=this.a!==1||this.b!==0||this.c!==0||this.d!==1}setTranslate(t,e){this.tx=t;this.ty=e;return this}translate(t,e){this.tx+=t;this.ty+=e;return this}scale(t,e){this.a*=t;this.d*=e;this.c*=t;this.b*=e;this.tx*=t;this.ty*=e;this._bTransform=true;return this}rotate(t){var e=Math.cos(t);var o=Math.sin(t);var i=this.a;var a=this.c;var r=this.tx;this.a=i*e-this.b*o;this.b=i*o+this.b*e;this.c=a*e-this.d*o;this.d=a*o+this.d*e;this.tx=r*e-this.ty*o;this.ty=r*o+this.ty*e;this._bTransform=true;return this}skew(t,e){var o=Math.tan(t);var i=Math.tan(e);var a=this.a;var r=this.b;this.a+=i*this.c;this.b+=i*this.d;this.c+=o*a;this.d+=o*r;return this}invertTransformPoint(t){var e=this.a;var o=this.b;var i=this.c;var a=this.d;var r=this.tx;var s=e*a-o*i;var n=a/s;var b=-o/s;var x=-i/s;var l=e/s;var _=(i*this.ty-a*r)/s;var h=-(e*this.ty-o*r)/s;return t.setTo(n*t.x+x*t.y+_,b*t.x+l*t.y+h)}transformPoint(t){return t.setTo(this.a*t.x+this.c*t.y+this.tx,this.b*t.x+this.d*t.y+this.ty)}transformPointN(t){return t.setTo(this.a*t.x+this.c*t.y,this.b*t.x+this.d*t.y)}getScaleX(){return this.b===0?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}getScaleY(){return this.c===0?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}invert(){var t=this.a;var e=this.b;var o=this.c;var i=this.d;var a=this.tx;var r=t*i-e*o;this.a=i/r;this.b=-e/r;this.c=-o/r;this.d=t/r;this.tx=(o*this.ty-i*a)/r;this.ty=-(t*this.ty-e*a)/r;return this}setTo(t,e,o,i,a,r){this.a=t,this.b=e,this.c=o,this.d=i,this.tx=a,this.ty=r;return this}concat(t){var e=this.a;var o=this.c;var i=this.tx;this.a=e*t.a+this.b*t.c;this.b=e*t.b+this.b*t.d;this.c=o*t.a+this.d*t.c;this.d=o*t.b+this.d*t.d;this.tx=i*t.a+this.ty*t.c+t.tx;this.ty=i*t.b+this.ty*t.d+t.ty;return this}static mul(t,e,o){var i=t.a,a=t.b,r=t.c,s=t.d,n=t.tx,b=t.ty;var x=e.a,l=e.b,_=e.c,h=e.d,d=e.tx,p=e.ty;if(l!==0||_!==0){o.a=i*x+a*_;o.b=i*l+a*h;o.c=r*x+s*_;o.d=r*l+s*h;o.tx=x*n+_*b+d;o.ty=l*n+h*b+p}else{o.a=i*x;o.b=a*h;o.c=r*x;o.d=s*h;o.tx=x*n+d;o.ty=h*b+p}return o}static mul16(t,e,o){var i=t.a,a=t.b,r=t.c,s=t.d,n=t.tx,b=t.ty;var x=e.a,l=e.b,_=e.c,h=e.d,d=e.tx,p=e.ty;if(l!==0||_!==0){o[0]=i*x+a*_;o[1]=i*l+a*h;o[4]=r*x+s*_;o[5]=r*l+s*h;o[12]=x*n+_*b+d;o[13]=l*n+h*b+p}else{o[0]=i*x;o[1]=a*h;o[4]=r*x;o[5]=s*h;o[12]=x*n+d;o[13]=h*b+p}return o}scaleEx(t,e){var o=this.a,i=this.b,a=this.c,r=this.d;if(i!==0||a!==0){this.a=t*o;this.b=t*i;this.c=e*a;this.d=e*r}else{this.a=t*o;this.b=0*r;this.c=0*o;this.d=e*r}this._bTransform=true}rotateEx(t){var e=Math.cos(t);var o=Math.sin(t);var i=this.a,a=this.b,r=this.c,s=this.d;if(a!==0||r!==0){this.a=e*i+o*r;this.b=e*a+o*s;this.c=-o*i+e*r;this.d=-o*a+e*s}else{this.a=e*i;this.b=o*s;this.c=-o*i;this.d=e*s}this._bTransform=true}clone(){var t=w.create();t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;t._bTransform=this._bTransform;return t}copyTo(t){t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;t._bTransform=this._bTransform;return t}toString(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}destroy(){this.recover()}recover(){p.recover("Matrix",this.identity())}static create(){return p.getItemByClass("Matrix",w)}}w.EMPTY=new w;w.TEMP=new w;w._createFun=null;class K{constructor(t=0,e=0){this.x=t;this.y=e}static create(){return p.getItemByClass("Point",K)}setTo(t,e){this.x=t;this.y=e;return this}reset(){this.x=this.y=0;return this}recover(){p.recover("Point",this.reset())}distance(t,e){return Math.sqrt((this.x-t)*(this.x-t)+(this.y-e)*(this.y-e))}toString(){return this.x+","+this.y}normalize(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t>0){var e=1/t;this.x*=e;this.y*=e}}copy(t){return this.setTo(t.x,t.y)}}K.TEMP=new K;K.EMPTY=new K;class B{constructor(t=0,e=0,o=0,i=0){this.x=t;this.y=e;this.width=o;this.height=i}get right(){return this.x+this.width}get bottom(){return this.y+this.height}setTo(t,e,o,i){this.x=t;this.y=e;this.width=o;this.height=i;return this}reset(){this.x=this.y=this.width=this.height=0;return this}recover(){if(this==B.TEMP||this==B.EMPTY){console.log("recover Temp or Empty:",this);return}p.recover("Rectangle",this.reset())}static create(){return p.getItemByClass("Rectangle",B)}copyFrom(t){this.x=t.x;this.y=t.y;this.width=t.width;this.height=t.height;return this}contains(t,e){if(this.width<=0||this.height<=0)return false;if(t>=this.x&&t<this.right){if(e>=this.y&&e<this.bottom){return true}}return false}intersects(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)}intersection(t,e=null){if(!this.intersects(t))return null;e||(e=new B);e.x=Math.max(this.x,t.x);e.y=Math.max(this.y,t.y);e.width=Math.min(this.right,t.right)-e.x;e.height=Math.min(this.bottom,t.bottom)-e.y;return e}union(t,e=null){e||(e=new B);this.clone(e);if(t.width<=0||t.height<=0)return e;e.addPoint(t.x,t.y);e.addPoint(t.right,t.bottom);return this}clone(t=null){t||(t=new B);t.x=this.x;t.y=this.y;t.width=this.width;t.height=this.height;return t}toString(){return this.x+","+this.y+","+this.width+","+this.height}equals(t){if(!t||t.x!==this.x||t.y!==this.y||t.width!==this.width||t.height!==this.height)return false;return true}addPoint(t,e){this.x>t&&(this.width+=this.x-t,this.x=t);this.y>e&&(this.height+=this.y-e,this.y=e);if(this.width<t-this.x)this.width=t-this.x;if(this.height<e-this.y)this.height=e-this.y;return this}_getBoundPoints(){var t=B._temB;t.length=0;if(this.width==0||this.height==0)return t;t.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);return t}static _getBoundPointS(t,e,o,i){var a=B._temA;a.length=0;if(o==0||i==0)return a;a.push(t,e,t+o,e,t,e+i,t+o,e+i);return a}static _getWrapRec(t,e=null){if(!t||t.length<1)return e?e.setTo(0,0,0,0):B.TEMP.setTo(0,0,0,0);e=e?e:B.create();var o,i=t.length,a,r,s,n,b=K.TEMP;a=s=99999;r=n=-a;for(o=0;o<i;o+=2){b.x=t[o];b.y=t[o+1];a=a<b.x?a:b.x;s=s<b.y?s:b.y;r=r>b.x?r:b.x;n=n>b.y?n:b.y}return e.setTo(a,s,r-a,n-s)}isEmpty(){if(this.width<=0||this.height<=0)return true;return false}}B.EMPTY=new B;B.TEMP=new B;B._temB=[];B._temA=[];class c{}c.ARRAY_BUFFER_TYPE_DATA=0;c.ARRAY_BUFFER_TYPE_CMD=1;c.ARRAY_BUFFER_REF_REFERENCE=0;c.ARRAY_BUFFER_REF_COPY=1;c.UPLOAD_SHADER_UNIFORM_TYPE_ID=0;c.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1;class Z{constructor(t=null,e=null,o=null,i=false){this.once=false;this._id=0;this.setTo(t,e,o,i)}setTo(t,e,o,i){this._id=Z._gid++;this.caller=t;this.method=e;this.args=o;this.once=i;return this}run(){if(this.method==null)return null;var t=this._id;var e=this.method.apply(this.caller,this.args);this._id===t&&this.once&&this.recover();return e}runWith(t){if(this.method==null)return null;var e=this._id;if(t==null)var o=this.method.apply(this.caller,this.args);else if(!this.args&&!t.unshift)o=this.method.call(this.caller,t);else if(this.args)o=this.method.apply(this.caller,this.args.concat(t));else o=this.method.apply(this.caller,t);this._id===e&&this.once&&this.recover();return o}clear(){this.caller=null;this.method=null;this.args=null;return this}recover(){if(this._id>0){this._id=0;Z._pool.push(this.clear())}}static create(t,e,o=null,i=true){if(Z._pool.length)return Z._pool.pop().setTo(t,e,o,i);return new Z(t,e,o,i)}}Z._pool=[];Z._gid=1;class e{hasListener(t){var e=this._events&&this._events[t];return!!e}event(t,e=null){if(!this._events||!this._events[t])return false;var o=this._events[t];if(o.run){if(o.once)delete this._events[t];e!=null?o.runWith(e):o.run()}else{for(var i=0,a=o.length;i<a;i++){var r=o[i];if(r){e!=null?r.runWith(e):r.run()}if(!r||r.once){o.splice(i,1);i--;a--}}if(o.length===0&&this._events)delete this._events[t]}return true}on(t,e,o,i=null){return this._createListener(t,e,o,i,false)}once(t,e,o,i=null){return this._createListener(t,e,o,i,true)}_createListener(t,e,o,i,a,r=true){r&&this.off(t,e,o,a);var s=Q.create(e||this,o,i,a);this._events||(this._events={});var n=this._events;if(!n[t])n[t]=s;else{if(!n[t].run)n[t].push(s);else n[t]=[n[t],s]}return this}off(t,e,o,i=false){if(!this._events||!this._events[t])return this;var a=this._events[t];if(a!=null){if(a.run){if((!e||a.caller===e)&&(o==null||a.method===o)&&(!i||a.once)){delete this._events[t];a.recover()}}else{var r=0;for(var s=0,n=a.length;s<n;s++){var b=a[s];if(!b){r++;continue}if(b&&(!e||b.caller===e)&&(o==null||b.method===o)&&(!i||b.once)){r++;a[s]=null;b.recover()}}if(r===n)delete this._events[t]}}return this}offAll(t=null){var e=this._events;if(!e)return this;if(t){this._recoverHandlers(e[t]);delete e[t]}else{for(var o in e){this._recoverHandlers(e[o])}this._events=null}return this}offAllCaller(t){if(t&&this._events){for(var e in this._events){this.off(e,t,null)}}return this}_recoverHandlers(t){if(!t)return;if(t.run){t.recover()}else{for(var e=t.length-1;e>-1;e--){if(t[e]){t[e].recover();t[e]=null}}}}isMouseEvent(t){return e.MOUSE_EVENTS[t]||false}}e.MOUSE_EVENTS={rightmousedown:true,rightmouseup:true,rightclick:true,mousedown:true,mouseup:true,mousemove:true,mouseover:true,mouseout:true,click:true,doubleclick:true};class Q extends Z{constructor(t,e,o,i){super(t,e,o,i)}recover(){if(this._id>0){this._id=0;Q._pool.push(this.clear())}}static create(t,e,o=null,i=true){if(Q._pool.length)return Q._pool.pop().setTo(t,e,o,i);return new Q(t,e,o,i)}}Q._pool=[];class M{constructor(t){this._url=M.formatURL(t);this._path=M.getPath(t)}get url(){return this._url}get path(){return this._path}static set basePath(t){M._basePath=T.Laya._getUrlPath();M._basePath=M.formatURL(t)}static get basePath(){return M._basePath}static formatURL(t){if(!t)return"null path";if(t.indexOf(":")>0)return t;if(M.customFormat!=null)t=M.customFormat(t);if(t.indexOf(":")>0)return t;var e=t.charAt(0);if(e==="."){return M._formatRelativePath(M._basePath+t)}else if(e==="~"){return M.rootPath+t.substring(1)}else if(e==="d"){if(t.indexOf("data:image")===0)return t}else if(e==="/"){return t}return M._basePath+t}static _formatRelativePath(t){var e=t.split("/");for(var o=0,i=e.length;o<i;o++){if(e[o]==".."){e.splice(o-1,2);o-=2}}return e.join("/")}static getPath(t){var e=t.lastIndexOf("/");return e>0?t.substr(0,e+1):""}static getFileName(t){var e=t.lastIndexOf("/");return e>0?t.substr(e+1):t}static getAdptedFilePath(t){if(!M.exportSceneToJson||!t)return t;var e,o;o=M._adpteTypeList.length;var i;for(e=0;e<o;e++){i=M._adpteTypeList[e];t=t.replace(i[0],i[1])}return t}}M.version={};M.exportSceneToJson=false;M._basePath="";M.rootPath="";M.customFormat=function(t){var e=M.version[t];if(!window.conch&&e)t+="?v="+e;return t};M._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]];class $ extends e{constructor(){super();this._id=0;this._url=null;this._cpuMemory=0;this._gpuMemory=0;this._destroyed=false;this._referenceCount=0;this.lock=false;this.name=null;this._id=++$._uniqueIDCounter;this._destroyed=false;this._referenceCount=0;$._idResourcesMap[this.id]=this;this.lock=false}static get cpuMemory(){return $._cpuMemory}static get gpuMemory(){return $._gpuMemory}static _addCPUMemory(t){$._cpuMemory+=t}static _addGPUMemory(t){$._gpuMemory+=t}static _addMemory(t,e){$._cpuMemory+=t;$._gpuMemory+=e}static getResourceByID(t){return $._idResourcesMap[t]}static getResourceByURL(t,e=0){return $._urlResourcesMap[t][e]}static destroyUnusedResources(){for(var t in $._idResourcesMap){var e=$._idResourcesMap[t];if(!e.lock&&e._referenceCount===0)e.destroy()}}get id(){return this._id}get url(){return this._url}get cpuMemory(){return this._cpuMemory}get gpuMemory(){return this._gpuMemory}get destroyed(){return this._destroyed}get referenceCount(){return this._referenceCount}_setCPUMemory(t){var e=t-this._cpuMemory;this._cpuMemory=t;$._addCPUMemory(e)}_setGPUMemory(t){var e=t-this._gpuMemory;this._gpuMemory=t;$._addGPUMemory(e)}_setCreateURL(t){t=M.formatURL(t);if(this._url!==t){var e;if(this._url){e=$._urlResourcesMap[this._url];e.splice(e.indexOf(this),1);e.length===0&&delete $._urlResourcesMap[this._url]}if(t){e=$._urlResourcesMap[t];e||($._urlResourcesMap[t]=e=[]);e.push(this)}this._url=t}}_addReference(t=1){this._referenceCount+=t}_removeReference(t=1){this._referenceCount-=t}_clearReference(){this._referenceCount=0}_recoverResource(){}_disposeResource(){}_activeResource(){}destroy(){if(this._destroyed)return;this._destroyed=true;this.lock=false;this._disposeResource();delete $._idResourcesMap[this.id];var t;if(this._url){t=$._urlResourcesMap[this._url];if(t){t.splice(t.indexOf(this),1);t.length===0&&delete $._urlResourcesMap[this._url]}var e=T.Loader.getRes(this._url);e==this&&delete T.Loader.loadedMap[this._url]}}}$._uniqueIDCounter=0;$._idResourcesMap={};$._urlResourcesMap={};$._cpuMemory=0;$._gpuMemory=0;class o extends ${get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}constructor(){super();this._width=-1;this._height=-1}_getSource(){throw"Bitmap: must override it."}}class u{static __init__(){var t=c.instance;u._depthFunc=t.LESS;u._sFactor=t.ONE;u._dFactor=t.ZERO;u._srcAlpha=t.ONE;u._dstAlpha=t.ZERO;u._activedTextureID=t.TEXTURE0;u._glTextureIDs=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3,t.TEXTURE4,t.TEXTURE5,t.TEXTURE6,t.TEXTURE7]}static useProgram(t,e){if(u._useProgram===e)return false;t.useProgram(e);u._useProgram=e;return true}static setDepthTest(t,e){e!==u._depthTest&&(u._depthTest=e,e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST))}static setDepthMask(t,e){e!==u._depthMask&&(u._depthMask=e,t.depthMask(e))}static setDepthFunc(t,e){e!==u._depthFunc&&(u._depthFunc=e,t.depthFunc(e))}static setBlend(t,e){e!==u._blend&&(u._blend=e,e?t.enable(t.BLEND):t.disable(t.BLEND))}static setBlendFunc(t,e,o){(e!==u._sFactor||o!==u._dFactor)&&(u._sFactor=u._srcAlpha=e,u._dFactor=u._dstAlpha=o,t.blendFunc(e,o))}static setBlendFuncSeperate(t,e,o,i,a){if(e!==u._sFactor||o!==u._dFactor||i!==u._srcAlpha||a!==u._dstAlpha){u._sFactor=e;u._dFactor=o;u._srcAlpha=i;u._dstAlpha=a;t.blendFuncSeparate(e,o,i,a)}}static setCullFace(t,e){e!==u._cullFace&&(u._cullFace=e,e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE))}static setFrontFace(t,e){e!==u._frontFace&&(u._frontFace=e,t.frontFace(e))}static activeTexture(t,e){if(u._activedTextureID!==e){t.activeTexture(e);u._activedTextureID=e}}static bindTexture(t,e,o){if(u._activeTextures[u._activedTextureID-t.TEXTURE0]!==o){t.bindTexture(e,o);u._activeTextures[u._activedTextureID-t.TEXTURE0]=o}}static __init_native(){if(!T.Render.supportWebGLPlusRendering)return;var t=u;t.activeTexture=t.activeTextureForNative;t.bindTexture=t.bindTextureForNative}static useProgramForNative(t,e){t.useProgram(e);return true}static setDepthTestForNative(t,e){if(e)t.enable(t.DEPTH_TEST);else t.disable(t.DEPTH_TEST)}static setDepthMaskForNative(t,e){t.depthMask(e)}static setDepthFuncForNative(t,e){t.depthFunc(e)}static setBlendForNative(t,e){if(e)t.enable(t.BLEND);else t.disable(t.BLEND)}static setBlendFuncForNative(t,e,o){t.blendFunc(e,o)}static setCullFaceForNative(t,e){if(e)t.enable(t.CULL_FACE);else t.disable(t.CULL_FACE)}static setFrontFaceForNative(t,e){t.frontFace(e)}static activeTextureForNative(t,e){t.activeTexture(e)}static bindTextureForNative(t,e,o){t.bindTexture(e,o)}static bindVertexArrayForNative(t,e){t.bindVertexArray(e)}}u.mainContext=null;u._activeTextures=new Array(8);u._useProgram=null;u._depthTest=true;u._depthMask=true;u._blend=false;u._cullFace=false;class v extends o{constructor(t,e){super();this._wrapModeU=v.WARPMODE_REPEAT;this._wrapModeV=v.WARPMODE_REPEAT;this._filterMode=v.FILTERMODE_BILINEAR;this._readyed=false;this._width=-1;this._height=-1;this._format=t;this._mipmap=e;this._anisoLevel=1;this._glTexture=c.instance.createTexture()}get mipmap(){return this._mipmap}get format(){return this._format}get wrapModeU(){return this._wrapModeU}set wrapModeU(t){if(this._wrapModeU!==t){this._wrapModeU=t;this._width!==-1&&this._setWarpMode(c.instance.TEXTURE_WRAP_S,t)}}get wrapModeV(){return this._wrapModeV}set wrapModeV(t){if(this._wrapModeV!==t){this._wrapModeV=t;this._height!==-1&&this._setWarpMode(c.instance.TEXTURE_WRAP_T,t)}}get filterMode(){return this._filterMode}set filterMode(t){if(t!==this._filterMode){this._filterMode=t;this._width!==-1&&this._height!==-1&&this._setFilterMode(t)}}get anisoLevel(){return this._anisoLevel}set anisoLevel(t){if(t!==this._anisoLevel){this._anisoLevel=Math.max(1,Math.min(16,t));this._width!==-1&&this._height!==-1&&this._setAnisotropy(t)}}get mipmapCount(){return this._mipmapCount}get defaulteTexture(){throw"BaseTexture:must override it."}_getFormatByteCount(){switch(this._format){case v.FORMAT_R8G8B8:return 3;case v.FORMAT_R8G8B8A8:return 4;case v.FORMAT_ALPHA8:return 1;default:throw"Texture2D: unknown format."}}_isPot(t){return(t&t-1)===0}_getGLFormat(){var t;var e=c.instance;var o=c.layaGPUInstance;switch(this._format){case v.FORMAT_R8G8B8:t=e.RGB;break;case v.FORMAT_R8G8B8A8:t=e.RGBA;break;case v.FORMAT_ALPHA8:t=e.ALPHA;break;case v.FORMAT_DXT1:if(o._compressedTextureS3tc)t=o._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;else throw"BaseTexture: not support DXT1 format.";break;case v.FORMAT_DXT5:if(o._compressedTextureS3tc)t=o._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;else throw"BaseTexture: not support DXT5 format.";break;case v.FORMAT_ETC1RGB:if(o._compressedTextureEtc1)t=o._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;else throw"BaseTexture: not support ETC1RGB format.";break;case v.FORMAT_PVRTCRGB_2BPPV:if(o._compressedTexturePvrtc)t=o._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGB_2BPPV format.";break;case v.FORMAT_PVRTCRGBA_2BPPV:if(o._compressedTexturePvrtc)t=o._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";break;case v.FORMAT_PVRTCRGB_4BPPV:if(o._compressedTexturePvrtc)t=o._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGB_4BPPV format.";break;case v.FORMAT_PVRTCRGBA_4BPPV:if(o._compressedTexturePvrtc)t=o._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;else throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";break;default:throw"BaseTexture: unknown texture format."}return t}_setFilterMode(t){var e=c.instance;u.bindTexture(e,this._glTextureType,this._glTexture);switch(t){case v.FILTERMODE_POINT:if(this._mipmap)e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST);else e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.NEAREST);break;case v.FILTERMODE_BILINEAR:if(this._mipmap)e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST);else e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case v.FILTERMODE_TRILINEAR:if(this._mipmap)e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR);else e.texParameteri(this._glTextureType,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(this._glTextureType,e.TEXTURE_MAG_FILTER,e.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}_setWarpMode(t,e){var o=c.instance;u.bindTexture(o,this._glTextureType,this._glTexture);if(this._isPot(this._width)&&this._isPot(this._height)){switch(e){case v.WARPMODE_REPEAT:o.texParameteri(this._glTextureType,t,o.REPEAT);break;case v.WARPMODE_CLAMP:o.texParameteri(this._glTextureType,t,o.CLAMP_TO_EDGE);break}}else{o.texParameteri(this._glTextureType,t,o.CLAMP_TO_EDGE)}}_setAnisotropy(t){var e=c.layaGPUInstance._extTextureFilterAnisotropic;if(e){t=Math.max(t,1);var o=c.instance;u.bindTexture(o,this._glTextureType,this._glTexture);t=Math.min(o.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT),t);o.texParameterf(this._glTextureType,e.TEXTURE_MAX_ANISOTROPY_EXT,t)}}_disposeResource(){if(this._glTexture){c.instance.deleteTexture(this._glTexture);this._glTexture=null;this._setGPUMemory(0)}}_getSource(){if(this._readyed)return this._glTexture;else return null}generateMipmap(){if(this._isPot(this.width)&&this._isPot(this.height))c.instance.generateMipmap(this._glTextureType)}}v.WARPMODE_REPEAT=0;v.WARPMODE_CLAMP=1;v.FILTERMODE_POINT=0;v.FILTERMODE_BILINEAR=1;v.FILTERMODE_TRILINEAR=2;v.FORMAT_R8G8B8=0;v.FORMAT_R8G8B8A8=1;v.FORMAT_ALPHA8=2;v.FORMAT_DXT1=3;v.FORMAT_DXT5=4;v.FORMAT_ETC1RGB=5;v.FORMAT_PVRTCRGB_2BPPV=9;v.FORMAT_PVRTCRGBA_2BPPV=10;v.FORMAT_PVRTCRGB_4BPPV=11;v.FORMAT_PVRTCRGBA_4BPPV=12;v.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14;v.FORMAT_DEPTH_16=0;v.FORMAT_STENCIL_8=1;v.FORMAT_DEPTHSTENCIL_16_8=2;v.FORMAT_DEPTHSTENCIL_NONE=3;class tt extends v{constructor(t=0,e=0,o=v.FORMAT_R8G8B8A8,i=true,a=false){super(o,i);var r=c.instance;this._glTextureType=r.TEXTURE_2D;this._width=t;this._height=e;this._canRead=a;this._setWarpMode(r.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(r.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);if(this._mipmap){this._mipmapCount=Math.max(Math.ceil(Math.log2(t))+1,Math.ceil(Math.log2(e))+1);for(var s=0;s<this._mipmapCount;s++)this._setPixels(null,s,Math.max(t>>s,1),Math.max(e>>s,1));this._setGPUMemory(t*e*4*(1+1/3))}else{this._mipmapCount=1;this._setGPUMemory(t*e*4)}}static __init__(){var t=new Uint8Array(3);t[0]=128;t[1]=128;t[2]=128;tt.grayTexture=new tt(1,1,v.FORMAT_R8G8B8,false,false);tt.grayTexture.setPixels(t);tt.grayTexture.lock=true;t[0]=255;t[1]=255;t[2]=255;tt.whiteTexture=new tt(1,1,v.FORMAT_R8G8B8,false,false);tt.whiteTexture.setPixels(t);tt.whiteTexture.lock=true;t[0]=0;t[1]=0;t[2]=0;tt.blackTexture=new tt(1,1,v.FORMAT_R8G8B8,false,false);tt.blackTexture.setPixels(t);tt.blackTexture.lock=true}static _parse(t,e=null,o=null){var i=o?new tt(o[0],o[1],o[2],o[3],o[4]):new tt(0,0);if(e){i.wrapModeU=e.wrapModeU;i.wrapModeV=e.wrapModeV;i.filterMode=e.filterMode;i.anisoLevel=e.anisoLevel}switch(i._format){case v.FORMAT_R8G8B8:case v.FORMAT_R8G8B8A8:i.loadImageSource(t);break;case v.FORMAT_DXT1:case v.FORMAT_DXT5:case v.FORMAT_ETC1RGB:case v.FORMAT_PVRTCRGB_2BPPV:case v.FORMAT_PVRTCRGBA_2BPPV:case v.FORMAT_PVRTCRGB_4BPPV:case v.FORMAT_PVRTCRGBA_4BPPV:i.setCompressData(t);break;default:throw"Texture2D:unkonwn format."}return i}static load(t,e){T.loader.create(t,e,null,T.Loader.TEXTURE2D)}get defaulteTexture(){return tt.grayTexture}_setPixels(t,e,o,i){var a=c.instance;var r=this._glTextureType;var s=this._getGLFormat();u.bindTexture(a,r,this._glTexture);if(this.format===v.FORMAT_R8G8B8){a.pixelStorei(a.UNPACK_ALIGNMENT,1);a.texImage2D(r,e,s,o,i,0,s,a.UNSIGNED_BYTE,t);a.pixelStorei(a.UNPACK_ALIGNMENT,4)}else{a.texImage2D(r,e,s,o,i,0,s,a.UNSIGNED_BYTE,t)}}_calcualatesCompressedDataSize(t,e,o){switch(t){case v.FORMAT_DXT1:case v.FORMAT_ETC1RGB:return(e+3>>2)*(o+3>>2)*8;case v.FORMAT_DXT5:return(e+3>>2)*(o+3>>2)*16;case v.FORMAT_PVRTCRGB_4BPPV:case v.FORMAT_PVRTCRGBA_4BPPV:return Math.floor((Math.max(e,8)*Math.max(o,8)*4+7)/8);case v.FORMAT_PVRTCRGB_2BPPV:case v.FORMAT_PVRTCRGBA_2BPPV:return Math.floor((Math.max(e,16)*Math.max(o,8)*2+7)/8);default:return 0}}_pharseDDS(t){const e=827611204;const o=894720068;const i=4;const a=131072;const r=542327876;const s=31;const n=0;const b=1;const x=2;const l=3;const _=4;const h=7;const d=20;const p=21;var c=new Int32Array(t,0,s);if(c[n]!=r)throw"Invalid magic number in DDS header";if(!(c[d]&i))throw"Unsupported format, must contain a FourCC code";var u=c[p];switch(this._format){case v.FORMAT_DXT1:if(u!==e)throw"the FourCC code is not same with texture format.";break;case v.FORMAT_DXT5:if(u!==o)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var y=1;if(c[x]&a){y=Math.max(1,c[h]);if(!this._mipmap)throw"the mipmap is not same with Texture2D."}else{if(this._mipmap)throw"the mipmap is not same with Texture2D."}var m=c[_];var f=c[l];this._width=m;this._height=f;var g=c[b]+4;this._upLoadCompressedTexImage2D(t,m,f,y,g,0)}_pharseKTX(t){const e=13;const o=4;const i=7;const a=6;const r=11;const s=12;var n=new Uint8Array(t,0,12);if(n[0]!=171||n[1]!=75||n[2]!=84||n[3]!=88||n[4]!=32||n[5]!=49||n[6]!=49||n[7]!=187||n[8]!=13||n[9]!=10||n[10]!=26||n[11]!=10)throw"Invalid fileIdentifier in KTX header";var b=new Int32Array(n.buffer,n.length,e);var x=b[o];switch(x){case c.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL:this._format=v.FORMAT_ETC1RGB;break;default:throw"unknown texture format."}var l=b[r];var _=b[a];var h=b[i];this._width=_;this._height=h;var d=64+b[s];this._upLoadCompressedTexImage2D(t,_,h,l,d,4)}_pharsePVR(t){const e=0;const o=1;const i=2;const a=3;const r=55727696;const s=13;const n=0;const b=2;const x=6;const l=7;const _=11;const h=12;var d=new Int32Array(t,0,s);if(d[n]!=r)throw"Invalid magic number in PVR header";var p=d[b];switch(p){case e:this._format=v.FORMAT_PVRTCRGB_2BPPV;break;case i:this._format=v.FORMAT_PVRTCRGB_4BPPV;break;case o:this._format=v.FORMAT_PVRTCRGBA_2BPPV;break;case a:this._format=v.FORMAT_PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var c=d[_];var u=d[l];var y=d[x];this._width=u;this._height=y;var m=d[h]+52;this._upLoadCompressedTexImage2D(t,u,y,c,m,0)}_upLoadCompressedTexImage2D(t,e,o,i,a,r){var s=c.instance;var n=this._glTextureType;u.bindTexture(s,n,this._glTexture);var b=this._getGLFormat();var x=a;for(var l=0;l<i;l++){x+=r;var _=this._calcualatesCompressedDataSize(this._format,e,o);var h=new Uint8Array(t,x,_);s.compressedTexImage2D(n,l,b,e,o,0,h);e=Math.max(e>>1,1);o=Math.max(o>>1,1);x+=_}var d=x;this._setGPUMemory(d);this._readyed=true;this._activeResource()}loadImageSource(t,e=false){var o=c.instance;var i=t.width;var a=t.height;this._width=i;this._height=a;if(!(this._isPot(i)&&this._isPot(a)))this._mipmap=false;this._setWarpMode(o.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(o.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);u.bindTexture(o,this._glTextureType,this._glTexture);var r=this._getGLFormat();if(T.Render.isConchApp){if(t.setPremultiplyAlpha){t.setPremultiplyAlpha(e)}o.texImage2D(this._glTextureType,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t)}else{e&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);o.texImage2D(this._glTextureType,0,r,r,o.UNSIGNED_BYTE,t);e&&o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false)}if(this._mipmap){o.generateMipmap(this._glTextureType);this._setGPUMemory(i*a*4*(1+1/3))}else{this._setGPUMemory(i*a*4)}if(this._canRead){if(T.Render.isConchApp){this._pixels=new Uint8Array(t._nativeObj.getImageData(0,0,i,a))}else{T.Browser.canvas.size(i,a);T.Browser.canvas.clear();T.Browser.context.drawImage(t,0,0,i,a);this._pixels=new Uint8Array(T.Browser.context.getImageData(0,0,i,a).data.buffer)}}this._readyed=true;this._activeResource()}setPixels(t,e=0){if(!t)throw"Texture2D:pixels can't be null.";var o=Math.max(this._width>>e,1);var i=Math.max(this._height>>e,1);var a=o*i*this._getFormatByteCount();if(t.length<a)throw"Texture2D:pixels length should at least "+a+".";this._setPixels(t,e,o,i);if(this._canRead)this._pixels=t;this._readyed=true;this._activeResource()}setSubPixels(t,e,o,i,a,r=0){if(!a)throw"Texture2D:pixels can't be null.";var s=c.instance;var n=this._glTextureType;u.bindTexture(s,n,this._glTexture);var b=this._getGLFormat();if(this._format===v.FORMAT_R8G8B8){s.pixelStorei(s.UNPACK_ALIGNMENT,1);s.texSubImage2D(n,r,t,e,o,i,b,s.UNSIGNED_BYTE,a);s.pixelStorei(s.UNPACK_ALIGNMENT,4)}else{s.texSubImage2D(n,r,t,e,o,i,b,s.UNSIGNED_BYTE,a)}this._readyed=true;this._activeResource()}setCompressData(t){switch(this._format){case v.FORMAT_DXT1:case v.FORMAT_DXT5:this._pharseDDS(t);break;case v.FORMAT_ETC1RGB:this._pharseKTX(t);break;case v.FORMAT_PVRTCRGB_2BPPV:case v.FORMAT_PVRTCRGBA_2BPPV:case v.FORMAT_PVRTCRGB_4BPPV:case v.FORMAT_PVRTCRGBA_4BPPV:this._pharsePVR(t);break;default:throw"Texture2D:unkonwn format."}}_recoverResource(){}getPixels(){if(this._canRead)return this._pixels;else throw new Error("Texture2D: must set texture canRead is true.")}}tt.TEXTURE2D="TEXTURE2D";tt.grayTexture=null;tt.whiteTexture=null;tt.blackTexture=null;class et extends ${constructor(){super()}}class x{static mat2MatArray(t,e){var o=t;var i=e;i[0]=o.a;i[1]=o.b;i[2]=x.EMPTYMAT4_ARRAY[2];i[3]=x.EMPTYMAT4_ARRAY[3];i[4]=o.c;i[5]=o.d;i[6]=x.EMPTYMAT4_ARRAY[6];i[7]=x.EMPTYMAT4_ARRAY[7];i[8]=x.EMPTYMAT4_ARRAY[8];i[9]=x.EMPTYMAT4_ARRAY[9];i[10]=x.EMPTYMAT4_ARRAY[10];i[11]=x.EMPTYMAT4_ARRAY[11];i[12]=o.tx;i[13]=o.ty;i[14]=x.EMPTYMAT4_ARRAY[14];i[15]=x.EMPTYMAT4_ARRAY[15];return e}static restoreTempArray(){x.TEMPMAT4_ARRAY[0]=1;x.TEMPMAT4_ARRAY[1]=0;x.TEMPMAT4_ARRAY[4]=0;x.TEMPMAT4_ARRAY[5]=1;x.TEMPMAT4_ARRAY[12]=0;x.TEMPMAT4_ARRAY[13]=0}static clear(){x.worldScissorTest=false;x.worldAlpha=1}}x._MAXSIZE=99999999;x.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];x.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];x.worldMatrix4=x.TEMPMAT4_ARRAY;x.worldMatrix=new w;x.matWVP=null;x.worldAlpha=1;x.worldScissorTest=false;x.width=0;x.height=0;class ot extends v{constructor(t,e,o=v.FORMAT_R8G8B8,i=v.FORMAT_DEPTH_16){super(o,false);this._mgrKey=0;this._glTextureType=c.instance.TEXTURE_2D;this._width=t;this._height=e;this._depthStencilFormat=i;this._create(t,e);this.lock=true}static get currentActive(){return ot._currentActive}get depthStencilFormat(){return this._depthStencilFormat}get defaulteTexture(){return tt.grayTexture}getIsReady(){return true}get sourceWidth(){return this._width}get sourceHeight(){return this._height}get offsetX(){return 0}get offsetY(){return 0}_create(t,e){var o=c.instance;this._frameBuffer=o.createFramebuffer();u.bindTexture(o,this._glTextureType,this._glTexture);var i=this._getGLFormat();o.texImage2D(this._glTextureType,0,i,t,e,0,i,o.UNSIGNED_BYTE,null);this._setGPUMemory(t*e*4);o.bindFramebuffer(o.FRAMEBUFFER,this._frameBuffer);o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this._glTexture,0);if(this._depthStencilFormat!==v.FORMAT_DEPTHSTENCIL_NONE){this._depthStencilBuffer=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,this._depthStencilBuffer);switch(this._depthStencilFormat){case v.FORMAT_DEPTH_16:o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,t,e);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this._depthStencilBuffer);break;case v.FORMAT_STENCIL_8:o.renderbufferStorage(o.RENDERBUFFER,o.STENCIL_INDEX8,t,e);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthStencilBuffer);break;case v.FORMAT_DEPTHSTENCIL_16_8:o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,t,e);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,this._depthStencilBuffer);break;default:}}o.bindFramebuffer(o.FRAMEBUFFER,null);o.bindRenderbuffer(o.RENDERBUFFER,null);this._setWarpMode(o.TEXTURE_WRAP_S,this._wrapModeU);this._setWarpMode(o.TEXTURE_WRAP_T,this._wrapModeV);this._setFilterMode(this._filterMode);this._setAnisotropy(this._anisoLevel);this._readyed=true;this._activeResource()}generateMipmap(){if(this._isPot(this.width)&&this._isPot(this.height)){this._mipmap=true;c.instance.generateMipmap(this._glTextureType);this._setFilterMode(this._filterMode);this._setGPUMemory(this.width*this.height*4*(1+1/3))}else{this._mipmap=false;this._setGPUMemory(this.width*this.height*4)}}static pushRT(){ot.rtStack.push({rt:ot._currentActive,w:x.width,h:x.height})}static popRT(){var t=c.instance;var e=ot.rtStack.pop();if(e){if(ot._currentActive!=e.rt){c.instance.bindFramebuffer(t.FRAMEBUFFER,e.rt?e.rt._frameBuffer:null);ot._currentActive=e.rt}t.viewport(0,0,e.w,e.h);x.width=e.w;x.height=e.h}}start(){var t=c.instance;c.instance.bindFramebuffer(t.FRAMEBUFFER,this._frameBuffer);this._lastRT=ot._currentActive;ot._currentActive=this;this._readyed=true;t.viewport(0,0,this._width,this._height);this._lastWidth=x.width;this._lastHeight=x.height;x.width=this._width;x.height=this._height;et.activeShader=null}end(){var t=c.instance;t.bindFramebuffer(t.FRAMEBUFFER,null);ot._currentActive=null;this._readyed=true}restore(){var t=c.instance;if(this._lastRT!=ot._currentActive){c.instance.bindFramebuffer(t.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null);ot._currentActive=this._lastRT}this._readyed=true;t.viewport(0,0,this._lastWidth,this._lastHeight);x.width=this._lastWidth;x.height=this._lastHeight;et.activeShader=null}clear(t=0,e=0,o=0,i=1){var a=c.instance;a.clearColor(t,e,o,i);var r=a.COLOR_BUFFER_BIT;switch(this._depthStencilFormat){case a.DEPTH_COMPONENT16:r|=a.DEPTH_BUFFER_BIT;break;case a.STENCIL_INDEX8:r|=a.STENCIL_BUFFER_BIT;break;case a.DEPTH_STENCIL:r|=a.DEPTH_BUFFER_BIT;r|=a.STENCIL_BUFFER_BIT;break}a.clear(r)}getData(t,e,o,i){if(T.Render.isConchApp&&window.conchConfig.threadMode==2){throw"native 2 thread mode use getDataAsync"}var a=c.instance;a.bindFramebuffer(a.FRAMEBUFFER,this._frameBuffer);var r=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;if(!r){a.bindFramebuffer(a.FRAMEBUFFER,null);return null}var s=new Uint8Array(this._width*this._height*4);var n=this._getGLFormat();a.readPixels(t,e,o,i,n,a.UNSIGNED_BYTE,s);a.bindFramebuffer(a.FRAMEBUFFER,null);return s}getDataAsync(t,e,o,i,a){var r=c.instance;r.bindFramebuffer(r.FRAMEBUFFER,this._frameBuffer);r.readPixelsAsync(t,e,o,i,r.RGBA,r.UNSIGNED_BYTE,function(t){a(new Uint8Array(t))});r.bindFramebuffer(r.FRAMEBUFFER,null)}recycle(){}_disposeResource(){if(this._frameBuffer){var t=c.instance;t.deleteTexture(this._glTexture);t.deleteFramebuffer(this._frameBuffer);t.deleteRenderbuffer(this._depthStencilBuffer);this._glTexture=null;this._frameBuffer=null;this._depthStencilBuffer=null;this._setGPUMemory(0)}}}ot.rtStack=[];ot.defuv=[0,0,1,0,1,1,0,1];ot.flipyuv=[0,1,1,1,1,0,0,0];class it{static getRT(t,e){t=t|0;e=e|0;if(t>=1e4){console.error("getRT error! w too big")}var o;o=new ot(t,e,v.FORMAT_R8G8B8A8,-1);return o}static releaseRT(t){t._disposeResource();return}}it.dict={};class I{static _init_(t){I.fns=[I.BlendNormal,I.BlendAdd,I.BlendMultiply,I.BlendScreen,I.BlendOverlay,I.BlendLight,I.BlendMask,I.BlendDestinationOut];I.targetFns=[I.BlendNormalTarget,I.BlendAddTarget,I.BlendMultiplyTarget,I.BlendScreenTarget,I.BlendOverlayTarget,I.BlendLightTarget,I.BlendMask,I.BlendDestinationOut]}static BlendNormal(t){u.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA)}static BlendAdd(t){u.setBlendFunc(t,t.ONE,t.DST_ALPHA)}static BlendMultiply(t){u.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA)}static BlendScreen(t){u.setBlendFunc(t,t.ONE,t.ONE)}static BlendOverlay(t){u.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR)}static BlendLight(t){u.setBlendFunc(t,t.ONE,t.ONE)}static BlendNormalTarget(t){u.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA)}static BlendAddTarget(t){u.setBlendFunc(t,t.ONE,t.DST_ALPHA)}static BlendMultiplyTarget(t){u.setBlendFunc(t,t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA)}static BlendScreenTarget(t){u.setBlendFunc(t,t.ONE,t.ONE)}static BlendOverlayTarget(t){u.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_COLOR)}static BlendLightTarget(t){u.setBlendFunc(t,t.ONE,t.ONE)}static BlendMask(t){u.setBlendFunc(t,t.ZERO,t.SRC_ALPHA)}static BlendDestinationOut(t){u.setBlendFunc(t,t.ZERO,t.ZERO)}}I.activeBlendFunction=null;I.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"];I.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1};I.NORMAL="normal";I.ADD="add";I.MULTIPLY="multiply";I.SCREEN="screen";I.OVERLAY="overlay";I.LIGHT="light";I.MASK="mask";I.DESTINATIONOUT="destination-out";I.LIGHTER="lighter";I.fns=[];I.targetFns=[];class i{constructor(t,e,o){this._value=0;this._name2int=t;this._int2name=e;this._int2nameMap=o}add(t){if(typeof t=="string"){this._value|=this._name2int[t]}else{this._value|=t}return this._value}addInt(t){this._value|=t;return this._value}remove(t){if(typeof t=="string"){this._value&=~this._name2int[t]}else{this._value&=~t}return this._value}isDefine(t){return(this._value&t)===t}getValue(){return this._value}setValue(t){this._value=t}toNameDic(){var t=this._int2nameMap[this._value];return t?t:i._toText(this._value,this._int2name,this._int2nameMap)}static _reg(t,e,o,i){o[t]=e;i[e]=t}static _toText(t,e,o){var i=o[t];if(i)return i;var a={};var r=1;for(var s=0;s<32;s++){r=1<<s;if(r>t)break;if(t&r){var n=e[r];n&&(a[n]="")}}o[t]=a;return a}static _toInt(t,e){var o=t.split(".");var i=0;for(var a=0,r=o.length;a<r;a++){var s=e[o[a]];if(!s)throw new Error("Defines to int err:"+t+"/"+o[a]);i|=s}return i}}class D extends i{constructor(){super(D.__name2int,D.__int2name,D.__int2nameMap)}static __init__(){D.reg("TEXTURE2D",D.TEXTURE2D);D.reg("PRIMITIVE",D.PRIMITIVE);D.reg("GLOW_FILTER",D.FILTERGLOW);D.reg("BLUR_FILTER",D.FILTERBLUR);D.reg("COLOR_FILTER",D.FILTERCOLOR);D.reg("COLOR_ADD",D.COLORADD);D.reg("WORLDMAT",D.WORLDMAT);D.reg("FILLTEXTURE",D.FILLTEXTURE);D.reg("FSHIGHPRECISION",D.SHADERDEFINE_FSHIGHPRECISION);D.reg("MVP3D",D.MVP3D)}static reg(t,e){this._reg(t,e,D.__name2int,D.__int2name)}static toText(t,e,o){return this._toText(t,e,o)}static toInt(t){return this._toInt(t,D.__name2int)}}D.TEXTURE2D=1;D.PRIMITIVE=4;D.FILTERGLOW=8;D.FILTERBLUR=16;D.FILTERCOLOR=32;D.COLORADD=64;D.WORLDMAT=128;D.FILLTEXTURE=256;D.SKINMESH=512;D.SHADERDEFINE_FSHIGHPRECISION=1024;D.MVP3D=2048;D.NOOPTMASK=D.FILTERGLOW|D.FILTERBLUR|D.FILTERCOLOR|D.FILLTEXTURE;D.__name2int={};D.__int2name=[];D.__int2nameMap=[];class m{static show(t=0,e=0){m._StatRender.show(t,e)}static enable(){m._StatRender.enable()}static hide(){m._StatRender.hide()}static clear(){m.trianglesFaces=m.renderBatches=m.savedRenderBatches=m.shaderCall=m.spriteRenderUseCacheCount=m.frustumCulling=m.octreeNodeCulling=m.canvasNormal=m.canvasBitmap=m.canvasReCache=0}static set onclick(t){m._StatRender.set_onclick(t)}}m.FPS=0;m.loopCount=0;m.shaderCall=0;m.renderBatches=0;m.savedRenderBatches=0;m.trianglesFaces=0;m.spriteCount=0;m.spriteRenderUseCacheCount=0;m.frustumCulling=0;m.octreeNodeCulling=0;m.canvasNormal=0;m.canvasBitmap=0;m.canvasReCache=0;m.renderSlow=false;m._fpsData=[];m._timer=0;m._count=0;m._StatRender=null;class at{constructor(){this._strsToID={};this._idToStrs=[];this._length=0}add(t){var e=this._strsToID[t];if(e!=null)return e;this._idToStrs[this._length]=t;return this._strsToID[t]=this._length++}getID(t){var e=this._strsToID[t];return e==null?-1:e}getName(t){var e=this._idToStrs[t];return e==null?undefined:e}}class rt extends et{constructor(t,e,o=null,i=null,a=null){super();this._attribInfo=null;this.customCompile=false;this._curActTexIndex=0;this.tag={};this._program=null;this._params=null;this._paramsMap={};if(!t||!e)throw"Shader Error";this._attribInfo=a;this._id=++rt._count;this._vs=t;this._ps=e;this._nameMap=i?i:{};o!=null&&(rt.sharders[o]=this);this.recreateResource();this.lock=true}static getShader(t){return rt.sharders[t]}static create(t,e,o=null,i=null,a=null){return new rt(t,e,o,i,a)}static withCompile(t,e,o,i){if(o&&rt.sharders[o])return rt.sharders[o];var a=rt._preCompileShader[rt.SHADERNAME2ID*t];if(!a)throw new Error("withCompile shader err!"+t);return a.createShader(e,o,i,null)}static withCompile2D(t,e,o,i,a,r=null){if(i&&rt.sharders[i])return rt.sharders[i];var s=rt._preCompileShader[rt.SHADERNAME2ID*t+e];if(!s)throw new Error("withCompile shader err!"+t+" "+e);return s.createShader(o,i,a,r)}static addInclude(t,e){T.ShaderCompile.addInclude(t,e)}static preCompile(t,e,o,i){var a=rt.SHADERNAME2ID*t;rt._preCompileShader[a]=new T.ShaderCompile(e,o,i)}static preCompile2D(t,e,o,i,a){var r=rt.SHADERNAME2ID*t+e;rt._preCompileShader[r]=new T.ShaderCompile(o,i,a)}recreateResource(){this._compile();this._setGPUMemory(0)}_disposeResource(){u.mainContext.deleteShader(this._vshader);u.mainContext.deleteShader(this._pshader);u.mainContext.deleteProgram(this._program);this._vshader=this._pshader=this._program=null;this._params=null;this._paramsMap={};this._setGPUMemory(0);this._curActTexIndex=0}_compile(){if(!this._vs||!this._ps||this._params)return;this._reCompile=true;this._params=[];var t;if(this.customCompile)t=T.ShaderCompile.preGetParams(this._vs,this._ps);var e=u.mainContext;this._program=e.createProgram();this._vshader=rt._createShader(e,this._vs,e.VERTEX_SHADER);this._pshader=rt._createShader(e,this._ps,e.FRAGMENT_SHADER);e.attachShader(this._program,this._vshader);e.attachShader(this._program,this._pshader);var o,i,a,r;var s=this._attribInfo?this._attribInfo.length:0;for(i=0;i<s;i+=2){e.bindAttribLocation(this._program,this._attribInfo[i+1],this._attribInfo[i])}e.linkProgram(this._program);if(!this.customCompile&&!e.getProgramParameter(this._program,e.LINK_STATUS)){throw e.getProgramInfoLog(this._program)}var n=this.customCompile?t.uniforms.length:e.getProgramParameter(this._program,e.ACTIVE_UNIFORMS);for(i=0;i<n;i++){var b=this.customCompile?t.uniforms[i]:e.getActiveUniform(this._program,i);r=e.getUniformLocation(this._program,b.name);o={vartype:"uniform",glfun:null,ivartype:1,location:r,name:b.name,type:b.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};if(o.name.indexOf("[0]")>0){o.name=o.name.substr(0,o.name.length-3);o.isArray=true;o.location=e.getUniformLocation(this._program,o.name)}this._params.push(o)}for(i=0,a=this._params.length;i<a;i++){o=this._params[i];o.indexOfParams=i;o.index=1;o.value=[o.location,null];o.codename=o.name;o.name=this._nameMap[o.codename]?this._nameMap[o.codename]:o.codename;this._paramsMap[o.name]=o;o._this=this;o.uploadedValue=[];switch(o.type){case e.INT:o.fun=o.isArray?this._uniform1iv:this._uniform1i;break;case e.FLOAT:o.fun=o.isArray?this._uniform1fv:this._uniform1f;break;case e.FLOAT_VEC2:o.fun=o.isArray?this._uniform_vec2v:this._uniform_vec2;break;case e.FLOAT_VEC3:o.fun=o.isArray?this._uniform_vec3v:this._uniform_vec3;break;case e.FLOAT_VEC4:o.fun=o.isArray?this._uniform_vec4v:this._uniform_vec4;break;case e.SAMPLER_2D:o.fun=this._uniform_sampler2D;break;case e.SAMPLER_CUBE:o.fun=this._uniform_samplerCube;break;case e.FLOAT_MAT4:o.glfun=e.uniformMatrix4fv;o.fun=this._uniformMatrix4fv;break;case e.BOOL:o.fun=this._uniform1i;break;case e.FLOAT_MAT2:case e.FLOAT_MAT3:throw new Error("compile shader err!");default:throw new Error("compile shader err!")}}}static _createShader(t,e,o){var i=t.createShader(o);t.shaderSource(i,e);t.compileShader(i);if(t.getShaderParameter(i,t.COMPILE_STATUS)){return i}else{console.log(t.getShaderInfoLog(i));return null}}getUniform(t){return this._paramsMap[t]}_uniform1f(t,e){var o=t.uploadedValue;if(o[0]!==e){u.mainContext.uniform1f(t.location,o[0]=e);return 1}return 0}_uniform1fv(t,e){if(e.length<4){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]||o[3]!==e[3]){u.mainContext.uniform1fv(t.location,e);o[0]=e[0];o[1]=e[1];o[2]=e[2];o[3]=e[3];return 1}return 0}else{u.mainContext.uniform1fv(t.location,e);return 1}}_uniform_vec2(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]){u.mainContext.uniform2f(t.location,o[0]=e[0],o[1]=e[1]);return 1}return 0}_uniform_vec2v(t,e){if(e.length<2){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]||o[3]!==e[3]){u.mainContext.uniform2fv(t.location,e);o[0]=e[0];o[1]=e[1];o[2]=e[2];o[3]=e[3];return 1}return 0}else{u.mainContext.uniform2fv(t.location,e);return 1}}_uniform_vec3(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]){u.mainContext.uniform3f(t.location,o[0]=e[0],o[1]=e[1],o[2]=e[2]);return 1}return 0}_uniform_vec3v(t,e){u.mainContext.uniform3fv(t.location,e);return 1}_uniform_vec4(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]||o[3]!==e[3]){u.mainContext.uniform4f(t.location,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3]);return 1}return 0}_uniform_vec4v(t,e){u.mainContext.uniform4fv(t.location,e);return 1}_uniformMatrix2fv(t,e){u.mainContext.uniformMatrix2fv(t.location,false,e);return 1}_uniformMatrix3fv(t,e){u.mainContext.uniformMatrix3fv(t.location,false,e);return 1}_uniformMatrix4fv(t,e){u.mainContext.uniformMatrix4fv(t.location,false,e);return 1}_uniform1i(t,e){var o=t.uploadedValue;if(o[0]!==e){u.mainContext.uniform1i(t.location,o[0]=e);return 1}return 0}_uniform1iv(t,e){u.mainContext.uniform1iv(t.location,e);return 1}_uniform_ivec2(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]){u.mainContext.uniform2i(t.location,o[0]=e[0],o[1]=e[1]);return 1}return 0}_uniform_ivec2v(t,e){u.mainContext.uniform2iv(t.location,e);return 1}_uniform_vec3i(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]){u.mainContext.uniform3i(t.location,o[0]=e[0],o[1]=e[1],o[2]=e[2]);return 1}return 0}_uniform_vec3vi(t,e){u.mainContext.uniform3iv(t.location,e);return 1}_uniform_vec4i(t,e){var o=t.uploadedValue;if(o[0]!==e[0]||o[1]!==e[1]||o[2]!==e[2]||o[3]!==e[3]){u.mainContext.uniform4i(t.location,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3]);return 1}return 0}_uniform_vec4vi(t,e){u.mainContext.uniform4iv(t.location,e);return 1}_uniform_sampler2D(t,e){var o=u.mainContext;var i=t.uploadedValue;if(i[0]==null){i[0]=this._curActTexIndex;o.uniform1i(t.location,this._curActTexIndex);u.activeTexture(o,o.TEXTURE0+this._curActTexIndex);u.bindTexture(o,o.TEXTURE_2D,e);this._curActTexIndex++;return 1}else{u.activeTexture(o,o.TEXTURE0+i[0]);u.bindTexture(o,o.TEXTURE_2D,e);return 0}}_uniform_samplerCube(t,e){var o=u.mainContext;var i=t.uploadedValue;if(i[0]==null){i[0]=this._curActTexIndex;o.uniform1i(t.location,this._curActTexIndex);u.activeTexture(o,o.TEXTURE0+this._curActTexIndex);u.bindTexture(o,o.TEXTURE_CUBE_MAP,e);this._curActTexIndex++;return 1}else{u.activeTexture(o,o.TEXTURE0+i[0]);u.bindTexture(o,o.TEXTURE_CUBE_MAP,e);return 0}}_noSetValue(t){console.log("no....:"+t.name)}uploadOne(t,e){u.useProgram(u.mainContext,this._program);var o=this._paramsMap[t];o.fun.call(this,o,e)}uploadTexture2D(t){var e=u;if(e._activeTextures[0]!==t){e.bindTexture(u.mainContext,c.instance.TEXTURE_2D,t);e._activeTextures[0]=t}}upload(t,e=null){et.activeShader=et.bindShader=this;var o=u.mainContext;u.useProgram(o,this._program);if(this._reCompile){e=this._params;this._reCompile=false}else{e=e||this._params}var i,a,r=e.length,s=0;for(var n=0;n<r;n++){i=e[n];if((a=t[i.name])!==null)s+=i.fun.call(this,i,a)}m.shaderCall+=s}uploadArray(t,e,o){et.activeShader=this;et.bindShader=this;u.useProgram(u.mainContext,this._program);var i=this._params,a;var r,s=0;for(var n=e-2;n>=0;n-=2){r=this._paramsMap[t[n]];if(!r)continue;a=t[n+1];if(a!=null){o&&o[r.name]&&o[r.name].bind();s+=r.fun.call(this,r,a)}}m.shaderCall+=s}getParams(){return this._params}setAttributesLocation(t){this._attribInfo=t}}rt._count=0;rt._preCompileShader={};rt.SHADERNAME2ID=2e-4;rt.nameKey=new at;rt.sharders=new Array(32);class st extends rt{constructor(t,e,o=null,i=null,a=null){super(t,e,o,i,a);this._params2dQuick2=null;this._shaderValueWidth=0;this._shaderValueHeight=0}_disposeResource(){super._disposeResource();this._params2dQuick2=null}upload2dQuick2(t){this.upload(t,this._params2dQuick2||this._make2dQuick2())}_make2dQuick2(){if(!this._params2dQuick2){this._params2dQuick2=[];var t=this._params,e;for(var o=0,i=t.length;o<i;o++){e=t[o];if(e.name!=="size")this._params2dQuick2.push(e)}}return this._params2dQuick2}static create(t,e,o=null,i=null,a=null){return new st(t,e,o,i,a)}}class nt{constructor(t,e){this.defines=new D;this.size=[0,0];this.alpha=1;this.ALPHA=1;this.subID=0;this.ref=1;this._cacheID=0;this.clipMatDir=[T.Context._MAXSIZE,0,0,T.Context._MAXSIZE];this.clipMatPos=[0,0];this.clipOff=[0,0];this.mainID=t;this.subID=e;this.textureHost=null;this.texture=null;this.color=null;this.colorAdd=null;this.u_mmat2=null;this._cacheID=t|e;this._inClassCache=nt._cache[this._cacheID];if(t>0&&!this._inClassCache){this._inClassCache=nt._cache[this._cacheID]=[];this._inClassCache._length=0}this.clear()}static _initone(t,e){nt._typeClass[t]=e;nt._cache[t]=[];nt._cache[t]._length=0}static __init__(){}setValue(t){}_ShaderWithCompile(){var t=rt.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,st.create,this._attribLocation);return t}upload(){var t=x;x.worldMatrix4===x.TEMPMAT4_ARRAY||this.defines.addInt(D.WORLDMAT);this.mmat=t.worldMatrix4;if(x.matWVP){this.defines.addInt(D.MVP3D);this.u_MvpMatrix=x.matWVP.elements}var e=rt.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();if(e._shaderValueWidth!==t.width||e._shaderValueHeight!==t.height){this.size[0]=t.width;this.size[1]=t.height;e._shaderValueWidth=t.width;e._shaderValueHeight=t.height;e.upload(this,null)}else{e.upload(this,e._params2dQuick2||e._make2dQuick2())}}setFilters(t){this.filters=t;if(!t)return;var e=t.length,o;for(var i=0;i<e;i++){o=t[i];if(o){this.defines.add(o.type);o.action.setValue(this)}}}clear(){this.defines._value=this.subID+(T.WebGL.shaderHighPrecision?D.SHADERDEFINE_FSHIGHPRECISION:0);this.clipOff[0]=0}release(){if(--this.ref<1){this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this);this.clear();this.filters=null;this.ref=1;this.clipOff[0]=0}}static create(t,e){var o=nt._cache[t|e];if(o._length)return o[--o._length];else return new nt._typeClass[t|e](e)}}nt._cache=[];nt._typeClass=[];nt.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];class bt{constructor(){this.clear()}clear(){this.submitType=-1;this.blendShader=this.other=0}copyFrom(t){this.other=t.other;this.blendShader=t.blendShader;this.submitType=t.submitType}copyFrom2(t,e,o){this.other=o;this.submitType=e}equal3_2(t,e,o){return this.submitType===e&&this.other===o&&this.blendShader===t.blendShader}equal4_2(t,e,o){return this.submitType===e&&this.other===o&&this.blendShader===t.blendShader}equal_3(t){return this.submitType===t.submitType&&this.blendShader===t.blendShader}equal(t){return this.other===t.other&&this.submitType===t.submitType&&this.blendShader===t.blendShader}}class xt{constructor(){this._ref=1;this._key=new bt}renderSubmit(){this.fun.apply(this._this,this.args);return 1}getRenderType(){return 0}releaseRender(){if(--this._ref<1){var t=xt.POOL;t[t._length++]=this}}static create(t,e,o){var i=xt.POOL._length?xt.POOL[--xt.POOL._length]:new xt;i.fun=e;i.args=t;i._this=o;i._ref=1;i._key.clear();return i}}xt.POOL=[];{xt.POOL._length=0}class lt{constructor(){}get type(){return-1}}lt.BLUR=16;lt.COLOR=32;lt.GLOW=8;lt._filter=function(t,e,o,i){var a=e;var r=this._next;if(r){var s=t.filters,n=s.length;if(n==1&&s[0].type==lt.COLOR){e.save();e.setColorFilter(s[0]);r._fun.call(r,t,e,o,i);e.restore();return}var b=nt.create(D.TEXTURE2D,0);var x;var l=K.TEMP;var _=a._curMat;var h=w.create();_.copyTo(h);var d=0;var p=0;var c=false;var u=null;var y=t._cacheStyle.filterCache||null;if(!y||t.getRepaint()!=0){c=t._isHaveGlowFilter();if(c){d=50;p=25}x=new B;x.copyFrom(t.getSelfBounds());x.x+=t.x;x.y+=t.y;x.x-=t.pivotX+4;x.y-=t.pivotY+4;var m=x.x;var f=x.y;x.width+=d+8;x.height+=d+8;l.x=x.x*h.a+x.y*h.c;l.y=x.y*h.d+x.x*h.b;x.x=l.x;x.y=l.y;l.x=x.width*h.a+x.height*h.c;l.y=x.height*h.d+x.width*h.b;x.width=l.x;x.height=l.y;if(x.width<=0||x.height<=0){return}y&&it.releaseRT(y);u=it.getRT(x.width,x.height);var g=y=it.getRT(x.width,x.height);t._getCacheStyle().filterCache=y;a.pushRT();a.useRT(u);var v=t.x-m+p;var S=t.y-f+p;r._fun.call(r,t,e,v,S);a.useRT(g);for(var C=0;C<n;C++){if(C!=0){a.useRT(u);a.drawTarget(g,0,0,x.width,x.height,w.TEMP.identity(),b,null,I.TOINT.overlay);a.useRT(g)}var P=s[C];switch(P.type){case lt.BLUR:P._glRender&&P._glRender.render(u,e,x.width,x.height,P);break;case lt.GLOW:P._glRender&&P._glRender.render(u,e,x.width,x.height,P);break;case lt.COLOR:a.setColorFilter(P);a.drawTarget(u,0,0,x.width,x.height,w.EMPTY.identity(),nt.create(D.TEXTURE2D,0));a.setColorFilter(null);break}}a.popRT()}else{c=t._cacheStyle.hasGlowFilter||false;if(c){d=50;p=25}x=t.getBounds();if(x.width<=0||x.height<=0){return}x.width+=d;x.height+=d;l.x=x.x*h.a+x.y*h.c;l.y=x.y*h.d+x.x*h.b;x.x=l.x;x.y=l.y;l.x=x.width*h.a+x.height*h.c;l.y=x.height*h.d+x.width*h.b;x.width=l.x;x.height=l.y}o=o-p-t.x;i=i-p-t.y;l.setTo(o,i);h.transformPoint(l);o=l.x+x.x;i=l.y+x.y;a._drawRenderTexture(y,o,i,x.width,x.height,w.TEMP.identity(),1,ot.defuv);if(u){var A=xt.create([u],function(t){t.destroy()},this);u=null;e.addRenderObject(A)}h.destroy()}};class f{static toRadian(t){return t*f._pi2}static toAngle(t){return t*f._pi}static toHexColor(t){if(t<0||isNaN(t))return null;var e=t.toString(16);while(e.length<6)e="0"+e;return"#"+e}static getGID(){return f._gid++}static concatArray(t,e){if(!e)return t;if(!t)return e;var o,i=e.length;for(o=0;o<i;o++){t.push(e[o])}return t}static clearArray(t){if(!t)return t;t.length=0;return t}static copyArray(t,e){t||(t=[]);if(!e)return t;t.length=e.length;var o,i=e.length;for(o=0;o<i;o++){t[o]=e[o]}return t}static getGlobalRecByPoints(t,e,o,i,a){var r;r=K.create().setTo(e,o);r=t.localToGlobal(r);var s;s=K.create().setTo(i,a);s=t.localToGlobal(s);var n=B._getWrapRec([r.x,r.y,s.x,s.y]);r.recover();s.recover();return n}static getGlobalPosAndScale(t){return f.getGlobalRecByPoints(t,0,0,1,1)}static bind(t,e){var o=t;o=t.bind(e);return o}static updateOrder(t){if(!t||t.length<2)return false;var e=1,o,i=t.length,a,r;while(e<i){o=e;r=t[o];a=t[o]._zOrder;while(--o>-1){if(t[o]._zOrder>a)t[o+1]=t[o];else break}t[o+1]=r;e++}return true}static transPointList(t,e,o){var i,a=t.length;for(i=0;i<a;i+=2){t[i]+=e;t[i+1]+=o}}static parseInt(t,e=0){var o=parseInt(t,e);if(isNaN(o))return 0;return o}static getFileExtension(t){f._extReg.lastIndex=t.lastIndexOf(".");var e=f._extReg.exec(t);if(e&&e.length>1){return e[1].toLowerCase()}return null}static getTransformRelativeToWindow(t,e,o){var i=f.gStage;var a=f.getGlobalPosAndScale(t);var r=i._canvasTransform.clone();var s=r.tx;var n=r.ty;r.rotate(-Math.PI/180*i.canvasDegree);r.scale(i.clientScaleX,i.clientScaleY);var b=i.canvasDegree%180!=0;var x,l;if(b){x=o+a.y;l=e+a.x;x*=r.d;l*=r.a;if(i.canvasDegree==90){x=s-x;l+=n}else{x+=s;l=n-l}}else{x=e+a.x;l=o+a.y;x*=r.a;l*=r.d;x+=s;l+=n}l+=i["_safariOffsetY"];var _,h;if(b){_=r.d*a.height;h=r.a*a.width}else{_=r.a*a.width;h=r.d*a.height}return{x:x,y:l,scaleX:_,scaleY:h}}static fitDOMElementInArea(t,e,o,i,a,r){if(!t._fitLayaAirInitialized){t._fitLayaAirInitialized=true;t.style.transformOrigin=t.style.webKittransformOrigin="left top";t.style.position="absolute"}var s=f.getTransformRelativeToWindow(e,o,i);t.style.transform=t.style.webkitTransform="scale("+s.scaleX+","+s.scaleY+") rotate("+f.gStage.canvasDegree+"deg)";t.style.width=a+"px";t.style.height=r+"px";t.style.left=s.x+"px";t.style.top=s.y+"px"}static isOkTextureList(t){if(!t)return false;var e,o=t.length;var i;for(e=0;e<o;e++){i=t[e];if(!i||!i._getSource())return false}return true}static isOKCmdList(t){if(!t)return false;var e,o=t.length;var i;for(e=0;e<o;e++){i=t[e]}return true}static getQueryString(t){if(T.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)");var o=window.location.search.substr(1).match(e);if(o!=null)return unescape(o[2]);return null}}f.gStage=null;f._gid=1;f._pi=180/Math.PI;f._pi2=Math.PI/180;f._extReg=/\.(\w+)\??/g;f.parseXMLFromString=function(t){var e;t=t.replace(/>\s+</g,"><");e=(new DOMParser).parseFromString(t,"text/xml");if(e.firstChild.textContent.indexOf("This page contains the following errors")>-1){throw new Error(e.firstChild.firstChild.textContent)}return e};class g{constructor(t){this.arrColor=[];if(t==null){this.strColor="#00000000";this.numColor=0;this.arrColor=[0,0,0,0];return}var e,o;var i;if(typeof t=="string"){if(t.indexOf("rgba(")>=0||t.indexOf("rgb(")>=0){var a=t;var r,s;r=a.indexOf("(");s=a.indexOf(")");a=a.substring(r+1,s);this.arrColor=a.split(",");o=this.arrColor.length;for(e=0;e<o;e++){this.arrColor[e]=parseFloat(this.arrColor[e]);if(e<3){this.arrColor[e]=Math.round(this.arrColor[e])}}if(this.arrColor.length==4){i=((this.arrColor[0]*256+this.arrColor[1])*256+this.arrColor[2])*256+Math.round(this.arrColor[3]*255)}else{i=(this.arrColor[0]*256+this.arrColor[1])*256+this.arrColor[2]}this.strColor=t}else{this.strColor=t;t.charAt(0)==="#"&&(t=t.substr(1));o=t.length;if(o===3||o===4){var n="";for(e=0;e<o;e++){n+=t[e]+t[e]}t=n}i=parseInt(t,16)}}else{i=t;this.strColor=f.toHexColor(i)}if(this.strColor.indexOf("rgba")>=0||this.strColor.length===9){this.arrColor=[((4278190080&i)>>>24)/255,((16711680&i)>>16)/255,((65280&i)>>8)/255,(255&i)/255];this.numColor=(4278190080&i)>>>24|(i&16711680)>>8|(i&65280)<<8|(i&255)<<24}else{this.arrColor=[((16711680&i)>>16)/255,((65280&i)>>8)/255,(255&i)/255,1];this.numColor=4278190080|(i&16711680)>>16|i&65280|(i&255)<<16}this.arrColor.__id=++g._COLODID}static _initDefault(){g._DEFAULT={};for(var t in g._COLOR_MAP)g._SAVE[t]=g._DEFAULT[t]=new g(g._COLOR_MAP[t]);return g._DEFAULT}static _initSaveMap(){g._SAVE_SIZE=0;g._SAVE={};for(var t in g._DEFAULT)g._SAVE[t]=g._DEFAULT[t]}static create(t){var e=t+"";var o=g._SAVE[e];if(o!=null)return o;if(g._SAVE_SIZE<1e3)g._initSaveMap();return g._SAVE[e]=new g(t)}}g._SAVE={};g._SAVE_SIZE=0;g._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"};g._DEFAULT=g._initDefault();g._COLODID=1;class _t extends lt{constructor(t=null){super();if(!t)t=this._copyMatrix(_t.IDENTITY_MATRIX);this._mat=new Float32Array(16);this._alpha=new Float32Array(4);this.setByMatrix(t)}gray(){return this.setByMatrix(_t.GRAY_MATRIX)}color(t=0,e=0,o=0,i=1){return this.setByMatrix([1,0,0,0,t,0,1,0,0,e,0,0,1,0,o,0,0,0,1,i])}setColor(t){var e=g.create(t).arrColor;var o=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(o)}setByMatrix(t){if(this._matrix!=t)this._copyMatrix(t);var e=0;var o=0;for(var i=0;i<20;i++){if(i%5!=4){this._mat[e++]=t[i]}else{this._alpha[o++]=t[i]}}return this}get type(){return lt.COLOR}adjustColor(t,e,o,i){this.adjustHue(i);this.adjustContrast(e);this.adjustBrightness(t);this.adjustSaturation(o);return this}adjustBrightness(t){t=this._clampValue(t,100);if(t==0||isNaN(t))return this;return this._multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}adjustContrast(t){t=this._clampValue(t,100);if(t==0||isNaN(t))return this;var e;if(t<0){e=127+t/100*127}else{e=t%1;if(e==0){e=_t.DELTA_INDEX[t]}else{e=_t.DELTA_INDEX[t<<0]*(1-e)+_t.DELTA_INDEX[(t<<0)+1]*e}e=e*127+127}var o=e/127;var i=(127-e)*.5;return this._multiplyMatrix([o,0,0,0,i,0,o,0,0,i,0,0,o,0,i,0,0,0,1,0,0,0,0,0,1])}adjustSaturation(t){t=this._clampValue(t,100);if(t==0||isNaN(t))return this;var e=1+(t>0?3*t/100:t/100);var o=1-e;var i=.3086*o;var a=.6094*o;var r=.082*o;return this._multiplyMatrix([i+e,a,r,0,0,i,a+e,r,0,0,i,a,r+e,0,0,0,0,0,1,0,0,0,0,0,1])}adjustHue(t){t=this._clampValue(t,180)/180*Math.PI;if(t==0||isNaN(t))return this;var e=Math.cos(t);var o=Math.sin(t);var i=.213;var a=.715;var r=.072;return this._multiplyMatrix([i+e*(1-i)+o*-i,a+e*-a+o*-a,r+e*-r+o*(1-r),0,0,i+e*-i+o*.143,a+e*(1-a)+o*.14,r+e*-r+o*-.283,0,0,i+e*-i+o*-(1-i),a+e*-a+o*a,r+e*(1-r)+o*r,0,0,0,0,0,1,0,0,0,0,0,1])}reset(){return this.setByMatrix(this._copyMatrix(_t.IDENTITY_MATRIX))}_multiplyMatrix(t){var e=[];this._matrix=this._fixMatrix(this._matrix);for(var o=0;o<5;o++){for(var i=0;i<5;i++){e[i]=this._matrix[i+o*5]}for(i=0;i<5;i++){var a=0;for(var r=0;r<5;r++){a+=t[i+r*5]*e[r]}this._matrix[i+o*5]=a}}return this.setByMatrix(this._matrix)}_clampValue(t,e){return Math.min(e,Math.max(-e,t))}_fixMatrix(t=null){if(t==null)return _t.IDENTITY_MATRIX;if(t.length<_t.LENGTH)t=t.slice(0,t.length).concat(_t.IDENTITY_MATRIX.slice(t.length,_t.LENGTH));else if(t.length>_t.LENGTH)t=t.slice(0,_t.LENGTH);return t}_copyMatrix(t){var e=_t.LENGTH;if(!this._matrix)this._matrix=[];for(var o=0;o<e;o++){this._matrix[o]=t[o]}return this._matrix}}_t.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];_t.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0];_t.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];_t.LENGTH=25;class ht{constructor(){this.colorFlt=null;this.uv=null}static create(t,e,o,i,a,r,s,n,b,x){var l=p.getItemByClass("DrawTextureCmd",ht);l.texture=t;t._addReference();l.x=e;l.y=o;l.width=i;l.height=a;l.matrix=r;l.alpha=s;l.color=n;l.blendMode=b;l.uv=x;if(n){l.colorFlt=new _t;l.colorFlt.setColor(n)}return l}recover(){this.texture._removeReference();this.texture=null;this.matrix=null;p.recover("DrawTextureCmd",this)}run(t,e,o){t.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,e,o,this.alpha,this.blendMode,this.colorFlt,this.uv)}get cmdID(){return ht.ID}}ht.ID="DrawTexture";class dt{static create(t,e,o,i,a,r,s,n){var b=p.getItemByClass("FillTextureCmd",dt);b.texture=t;b.x=e;b.y=o;b.width=i;b.height=a;b.type=r;b.offset=s;b.other=n;return b}recover(){this.texture=null;this.offset=null;this.other=null;p.recover("FillTextureCmd",this)}run(t,e,o){t.fillTexture(this.texture,this.x+e,this.y+o,this.width,this.height,this.type,this.offset,this.other)}get cmdID(){return dt.ID}}dt.ID="FillTexture";class pt{static create(){var t=p.getItemByClass("RestoreCmd",pt);return t}recover(){p.recover("RestoreCmd",this)}run(t,e,o){t.restore()}get cmdID(){return pt.ID}}pt.ID="Restore";class ct{static create(t,e,o){var i=p.getItemByClass("RotateCmd",ct);i.angle=t;i.pivotX=e;i.pivotY=o;return i}recover(){p.recover("RotateCmd",this)}run(t,e,o){t._rotate(this.angle,this.pivotX+e,this.pivotY+o)}get cmdID(){return ct.ID}}ct.ID="Rotate";class ut{static create(t,e,o,i){var a=p.getItemByClass("ScaleCmd",ut);a.scaleX=t;a.scaleY=e;a.pivotX=o;a.pivotY=i;return a}recover(){p.recover("ScaleCmd",this)}run(t,e,o){t._scale(this.scaleX,this.scaleY,this.pivotX+e,this.pivotY+o)}get cmdID(){return ut.ID}}ut.ID="Scale";class yt{static create(t,e,o){var i=p.getItemByClass("TransformCmd",yt);i.matrix=t;i.pivotX=e;i.pivotY=o;return i}recover(){this.matrix=null;p.recover("TransformCmd",this)}run(t,e,o){t._transform(this.matrix,this.pivotX+e,this.pivotY+o)}get cmdID(){return yt.ID}}yt.ID="Transform";class mt{static create(t,e){var o=p.getItemByClass("TranslateCmd",mt);o.tx=t;o.ty=e;return o}recover(){p.recover("TranslateCmd",this)}run(t,e,o){t.translate(this.tx,this.ty)}get cmdID(){return mt.ID}}mt.ID="Translate";class ft{constructor(){this._controlPoints=[new K,new K,new K];this._calFun=this.getPoint2}_switchPoint(t,e){var o=this._controlPoints.shift();o.setTo(t,e);this._controlPoints.push(o)}getPoint2(t,e){var o=this._controlPoints[0];var i=this._controlPoints[1];var a=this._controlPoints[2];var r=Math.pow(1-t,2)*o.x+2*t*(1-t)*i.x+Math.pow(t,2)*a.x;var s=Math.pow(1-t,2)*o.y+2*t*(1-t)*i.y+Math.pow(t,2)*a.y;e.push(r,s)}getPoint3(t,e){var o=this._controlPoints[0];var i=this._controlPoints[1];var a=this._controlPoints[2];var r=this._controlPoints[3];var s=Math.pow(1-t,3)*o.x+3*i.x*t*(1-t)*(1-t)+3*a.x*t*t*(1-t)+r.x*Math.pow(t,3);var n=Math.pow(1-t,3)*o.y+3*i.y*t*(1-t)*(1-t)+3*a.y*t*t*(1-t)+r.y*Math.pow(t,3);e.push(s,n)}insertPoints(t,e){var o;t=t>0?t:5;var i;i=1/t;for(o=0;o<=1;o+=i){this._calFun(o,e)}}getBezierPoints(t,e=5,o=2){var i,a;a=t.length;if(a<(o+1)*2)return[];var r=[];switch(o){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}while(this._controlPoints.length<=o){this._controlPoints.push(K.create())}for(i=0;i<o*2;i+=2){this._switchPoint(t[i],t[i+1])}for(i=o*2;i<a;i+=2){this._switchPoint(t[i],t[i+1]);if(i/2%o==0)this.insertPoints(e,r)}return r}}ft.I=new ft;class gt{static multiply(t,e,o){return(t.x-o.x)*(e.y-o.y)-(e.x-o.x)*(t.y-o.y)}static dis(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)}static _getPoints(t,e=false,o=null){if(!gt._mPointList)gt._mPointList=[];while(gt._mPointList.length<t)gt._mPointList.push(new K);if(!o)o=[];o.length=0;if(e){gt.getFrom(o,gt._mPointList,t)}else{gt.getFromR(o,gt._mPointList,t)}return o}static getFrom(t,e,o){var i;for(i=0;i<o;i++){t.push(e[i])}return t}static getFromR(t,e,o){var i;for(i=0;i<o;i++){t.push(e.pop())}return t}static pListToPointList(t,e=false){var o,i=t.length/2,a=gt._getPoints(i,e,gt._tempPointList);for(o=0;o<i;o++){a[o].setTo(t[o+o],t[o+o+1])}return a}static pointListToPlist(t){var e,o=t.length,i=gt._temPList,a;i.length=0;for(e=0;e<o;e++){a=t[e];i.push(a.x,a.y)}return i}static scanPList(t){return f.copyArray(t,gt.pointListToPlist(gt.scan(gt.pListToPointList(t,true))))}static scan(t){var e,o,i=0,a,r=t.length,s;var n={};var b;s=gt._temArr;s.length=0;r=t.length;for(e=r-1;e>=0;e--){a=t[e];b=a.x+"_"+a.y;if(!(b in n)){n[b]=true;s.push(a)}}r=s.length;f.copyArray(t,s);for(e=1;e<r;e++)if(t[e].y<t[i].y||t[e].y==t[i].y&&t[e].x<t[i].x)i=e;a=t[0];t[0]=t[i];t[i]=a;for(e=1;e<r-1;e++){i=e;for(o=e+1;o<r;o++)if(gt.multiply(t[o],t[i],t[0])>0||gt.multiply(t[o],t[i],t[0])==0&&gt.dis(t[0],t[o])<gt.dis(t[0],t[i]))i=o;a=t[e];t[e]=t[i];t[i]=a}s=gt._temArr;s.length=0;if(t.length<3){return f.copyArray(s,t)}s.push(t[0],t[1],t[2]);for(e=3;e<r;e++){while(s.length>=2&&gt.multiply(t[e],s[s.length-1],s[s.length-2])>=0)s.pop();t[e]&&s.push(t[e])}return s}}gt._tempPointList=[];gt._temPList=[];gt._temArr=[];class vt{constructor(t){this.setValue(t)}static create(t){if(t){var e=t instanceof g?t:g.create(t);return e._drawStyle||(e._drawStyle=new vt(t))}return vt.DEFAULT}setValue(t){if(t){this._color=t instanceof g?t:g.create(t)}else this._color=g.create("#000000")}reset(){this._color=g.create("#000000")}toInt(){return this._color.numColor}equal(t){if(typeof t=="string")return this._color.strColor===t;if(t instanceof g)return this._color.numColor===t.numColor;return false}toColorStr(){return this._color.strColor}}vt.DEFAULT=new vt("#000000");class St{constructor(){this._lastOriX=0;this._lastOriY=0;this.paths=[];this._curPath=null}beginPath(t){this.paths.length=1;this._curPath=this.paths[0]=new Ct;this._curPath.convex=t}closePath(){this._curPath.loop=true}newPath(){this._curPath=new Ct;this.paths.push(this._curPath)}addPoint(t,e){this._curPath.path.push(t,e)}push(t,e){if(!this._curPath){this._curPath=new Ct;this.paths.push(this._curPath)}else if(this._curPath.path.length>0){this._curPath=new Ct;this.paths.push(this._curPath)}var o=this._curPath;o.path=t.slice();o.convex=e}reset(){this.paths.length=0}}class Ct{constructor(){this.path=[];this.loop=false;this.convex=false}}class A{constructor(t=A.TYPE_2D){this.clipInfoID=-1;this._mesh=null;this._blendFn=null;this._id=0;this._renderType=0;this._parent=null;this._key=new bt;this._startIdx=0;this._numEle=0;this._ref=1;this.shaderValue=null;this._renderType=t;this._id=++A.ID}static __init__(){var t=A.RENDERBASE=new A(-1);t.shaderValue=new nt(0,0);t.shaderValue.ALPHA=1;t._ref=4294967295}getID(){return this._id}getRenderType(){return this._renderType}toString(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}renderSubmit(){return 1}releaseRender(){}}A.TYPE_2D=1e4;A.TYPE_CANVAS=10003;A.TYPE_CMDSETRT=10004;A.TYPE_CUSTOM=10005;A.TYPE_BLURRT=10006;A.TYPE_CMDDESTORYPRERT=10007;A.TYPE_DISABLESTENCIL=10008;A.TYPE_OTHERIBVB=10009;A.TYPE_PRIMITIVE=10010;A.TYPE_RT=10011;A.TYPE_BLUR_RT=10012;A.TYPE_TARGET=10013;A.TYPE_CHANGE_VALUE=10014;A.TYPE_SHAPE=10015;A.TYPE_TEXTURE=10016;A.TYPE_FILLTEXTURE=10017;A.KEY_ONCE=-1;A.KEY_FILLRECT=1;A.KEY_DRAWTEXTURE=2;A.KEY_VG=3;A.KEY_TRIANGLES=4;A.ID=1;A.preRender=null;class b{constructor(){}static _createArray(){var t=[];t._length=0;return t}static _init(){var t=b._namemap={};t[b.TYPE_ALPHA]="ALPHA";t[b.TYPE_FILESTYLE]="fillStyle";t[b.TYPE_FONT]="font";t[b.TYPE_LINEWIDTH]="lineWidth";t[b.TYPE_STROKESTYLE]="strokeStyle";t[b.TYPE_ENABLEMERGE]="_mergeID";t[b.TYPE_MARK]=t[b.TYPE_TRANSFORM]=t[b.TYPE_TRANSLATE]=[];t[b.TYPE_TEXTBASELINE]="textBaseline";t[b.TYPE_TEXTALIGN]="textAlign";t[b.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType";t[b.TYPE_SHADER]="shader";t[b.TYPE_FILTERS]="filters";t[b.TYPE_COLORFILTER]="_colorFiler";return t}isSaveMark(){return false}restore(t){this._dataObj[this._valueName]=this._value;b.POOL[b.POOL._length++]=this;this._newSubmit&&(t._curSubmit=A.RENDERBASE)}static save(t,e,o,i){if((t._saveMark._saveuse&e)!==e){t._saveMark._saveuse|=e;var a=b.POOL;var r=a._length>0?a[--a._length]:new b;r._value=o[r._valueName=b._namemap[e]];r._dataObj=o;r._newSubmit=i;var s=t._save;s[s._length++]=r}}}b.TYPE_ALPHA=1;b.TYPE_FILESTYLE=2;b.TYPE_FONT=8;b.TYPE_LINEWIDTH=256;b.TYPE_STROKESTYLE=512;b.TYPE_MARK=1024;b.TYPE_TRANSFORM=2048;b.TYPE_TRANSLATE=4096;b.TYPE_ENABLEMERGE=8192;b.TYPE_TEXTBASELINE=16384;b.TYPE_TEXTALIGN=32768;b.TYPE_GLOBALCOMPOSITEOPERATION=65536;b.TYPE_CLIPRECT=131072;b.TYPE_CLIPRECT_STENCIL=262144;b.TYPE_IBVB=524288;b.TYPE_SHADER=1048576;b.TYPE_FILTERS=2097152;b.TYPE_FILTERS_TYPE=4194304;b.TYPE_COLORFILTER=8388608;b.POOL=b._createArray();b._namemap=b._init();class Pt{constructor(){this._globalClipMatrix=new w;this._clipInfoID=-1;this._clipRect=new B;this.incache=false}isSaveMark(){return false}restore(t){this._globalClipMatrix.copyTo(t._globalClipMatrix);this._clipRect.clone(t._clipRect);t._clipInfoID=this._clipInfoID;Pt.POOL[Pt.POOL._length++]=this;t._clipInCache=this.incache}static save(t){if((t._saveMark._saveuse&b.TYPE_CLIPRECT)==b.TYPE_CLIPRECT)return;t._saveMark._saveuse|=b.TYPE_CLIPRECT;var e=Pt.POOL;var o=e._length>0?e[--e._length]:new Pt;t._globalClipMatrix.copyTo(o._globalClipMatrix);t._clipRect.clone(o._clipRect);o._clipInfoID=t._clipInfoID;o.incache=t._clipInCache;var i=t._save;i[i._length++]=o}}Pt.POOL=b._createArray();class At{constructor(){this._saveuse=0}isSaveMark(){return true}restore(t){t._saveMark=this._preSaveMark;At.POOL[At.POOL._length++]=this}static Create(t){var e=At.POOL;var o=e._length>0?e[--e._length]:new At;o._saveuse=0;o._preSaveMark=t._saveMark;t._saveMark=o;return o}}At.POOL=b._createArray();class Bt{constructor(){this._matrix=new w}isSaveMark(){return false}restore(t){t._curMat=this._savematrix;Bt.POOL[Bt.POOL._length++]=this}static save(t){var e=t._saveMark;if((e._saveuse&b.TYPE_TRANSFORM)===b.TYPE_TRANSFORM)return;e._saveuse|=b.TYPE_TRANSFORM;var o=Bt.POOL;var i=o._length>0?o[--o._length]:new Bt;i._savematrix=t._curMat;t._curMat=t._curMat.copyTo(i._matrix);var a=t._save;a[a._length++]=i}}Bt.POOL=b._createArray();class wt{constructor(){this._mat=new w}isSaveMark(){return false}restore(t){this._mat.copyTo(t._curMat);wt.POOL[wt.POOL._length++]=this}static save(t){var e=wt.POOL;var o=e._length>0?e[--e._length]:new wt;t._curMat.copyTo(o._mat);var i=t._save;i[i._length++]=o}}wt.POOL=b._createArray();class Tt{}Tt.loopStTm=0;Tt.loopCount=0;class Mt{constructor(){this._byteLength=0;this._glBuffer=c.instance.createBuffer()}get bufferUsage(){return this._bufferUsage}_bindForVAO(){}bind(){return false}destroy(){if(this._glBuffer){c.instance.deleteBuffer(this._glBuffer);this._glBuffer=null}}}class It extends Mt{constructor(){super();this._maxsize=0;this._upload=true;this._uploadSize=0;this._bufferSize=0;this._u8Array=null}static __int__(t){}get bufferLength(){return this._buffer.byteLength}set byteLength(t){this.setByteLength(t)}setByteLength(t){if(this._byteLength!==t){t<=this._bufferSize||this._resizeBuffer(t*2+256,true);this._byteLength=t}}needSize(t){var e=this._byteLength;if(t){var o=this._byteLength+t;o<=this._bufferSize||this._resizeBuffer(o<<1,true);this._byteLength=o}return e}_bufferData(){this._maxsize=Math.max(this._maxsize,this._byteLength);if(Tt.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this._buffer=this._buffer.slice(0,this._maxsize+64);this._bufferSize=this._buffer.byteLength;this._checkArrayUse()}this._maxsize=this._byteLength}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;c.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)}c.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}_bufferSubData(t=0,e=0,o=0){this._maxsize=Math.max(this._maxsize,this._byteLength);if(Tt.loopCount%30==0){if(this._buffer.byteLength>this._maxsize+64){this._buffer=this._buffer.slice(0,this._maxsize+64);this._bufferSize=this._buffer.byteLength;this._checkArrayUse()}this._maxsize=this._byteLength}if(this._uploadSize<this._buffer.byteLength){this._uploadSize=this._buffer.byteLength;c.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)}if(e||o){var i=this._buffer.slice(e,o);c.instance.bufferSubData(this._bufferType,t,i)}else{c.instance.bufferSubData(this._bufferType,t,this._buffer)}}_checkArrayUse(){}_bind_uploadForVAO(){if(!this._upload)return false;this._upload=false;this._bindForVAO();this._bufferData();return true}_bind_upload(){if(!this._upload)return false;this._upload=false;this.bind();this._bufferData();return true}_bind_subUpload(t=0,e=0,o=0){if(!this._upload)return false;this._upload=false;this.bind();this._bufferSubData(t,e,o);return true}_resizeBuffer(t,e){var o=this._buffer;if(t<=o.byteLength)return this;var i=this._u8Array;if(e&&o&&o.byteLength>0){var a=new ArrayBuffer(t);var r=i&&i.buffer==o?i:new Uint8Array(o);i=this._u8Array=new Uint8Array(a);i.set(r,0);o=this._buffer=a}else{o=this._buffer=new ArrayBuffer(t);this._u8Array=null}this._checkArrayUse();this._upload=true;this._bufferSize=o.byteLength;return this}append(t){this._upload=true;var e,o;e=t.byteLength;if(t instanceof Uint8Array){this._resizeBuffer(this._byteLength+e,true);o=new Uint8Array(this._buffer,this._byteLength)}else if(t instanceof Uint16Array){this._resizeBuffer(this._byteLength+e,true);o=new Uint16Array(this._buffer,this._byteLength)}else if(t instanceof Float32Array){this._resizeBuffer(this._byteLength+e,true);o=new Float32Array(this._buffer,this._byteLength)}o.set(t,0);this._byteLength+=e;this._checkArrayUse()}appendU16Array(t,e){this._resizeBuffer(this._byteLength+e*2,true);var o=new Uint16Array(this._buffer,this._byteLength,e);if(e==6){o[0]=t[0];o[1]=t[1];o[2]=t[2];o[3]=t[3];o[4]=t[4];o[5]=t[5]}else if(e>=100){o.set(new Uint16Array(t.buffer,0,e))}else{for(var i=0;i<e;i++){o[i]=t[i]}}this._byteLength+=e*2;this._checkArrayUse()}appendEx(t,e){this._upload=true;var o,i;o=t.byteLength;this._resizeBuffer(this._byteLength+o,true);i=new e(this._buffer,this._byteLength);i.set(t,0);this._byteLength+=o;this._checkArrayUse()}appendEx2(t,e,o,i=1){this._upload=true;var a,r;a=o*i;this._resizeBuffer(this._byteLength+a,true);r=new e(this._buffer,this._byteLength);var s;for(s=0;s<o;s++){r[s]=t[s]}this._byteLength+=a;this._checkArrayUse()}getBuffer(){return this._buffer}setNeedUpload(){this._upload=true}getNeedUpload(){return this._upload}upload(){var t=c.instance;var e=this._bind_upload();t.bindBuffer(this._bufferType,null);if(this._bufferType==t.ARRAY_BUFFER)Mt._bindedVertexBuffer=null;if(this._bufferType==t.ELEMENT_ARRAY_BUFFER)Mt._bindedIndexBuffer=null;et.activeShader=null;return e}subUpload(t=0,e=0,o=0){var i=c.instance;var a=this._bind_subUpload();i.bindBuffer(this._bufferType,null);if(this._bufferType==i.ARRAY_BUFFER)Mt._bindedVertexBuffer=null;if(this._bufferType==i.ELEMENT_ARRAY_BUFFER)Mt._bindedIndexBuffer=null;et.activeShader=null;return a}_disposeResource(){this._upload=true;this._uploadSize=0}clear(){this._byteLength=0;this._upload=true}}It.FLOAT32=4;It.SHORT=2;class Dt extends It{constructor(t,e){super();this._vertexStride=t;this._bufferUsage=e;this._bufferType=c.instance.ARRAY_BUFFER;this._buffer=new ArrayBuffer(8);this._floatArray32=new Float32Array(this._buffer);this._uint32Array=new Uint32Array(this._buffer)}get vertexStride(){return this._vertexStride}getFloat32Array(){return this._floatArray32}appendArray(t){var e=this._byteLength>>2;this.setByteLength(this._byteLength+t.length*4);var o=this.getFloat32Array();o.set(t,e);this._upload=true}_checkArrayUse(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}deleteBuffer(){super._disposeResource()}_bindForVAO(){var t=c.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer)}bind(){if(Mt._bindedVertexBuffer!==this._glBuffer){var t=c.instance;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer);Mt._bindedVertexBuffer=this._glBuffer;return true}return false}destroy(){super.destroy();this._byteLength=0;this._upload=true;this._buffer=null;this._floatArray32=null}}Dt.create=function(t,e=35048){return new Dt(t,e)};class Lt extends It{constructor(t=35044){super();this._bufferUsage=t;this._bufferType=c.instance.ELEMENT_ARRAY_BUFFER;this._buffer=new ArrayBuffer(8)}_checkArrayUse(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}getUint16Array(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}_bindForVAO(){var t=c.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer)}bind(){if(Mt._bindedIndexBuffer!==this._glBuffer){var t=c.instance;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._glBuffer);Mt._bindedIndexBuffer=this._glBuffer;return true}return false}destory(){this._uint16Array=null;this._buffer=null}disposeResource(){this._disposeResource()}}Lt.create=function(t=35044){return new Lt(t)};class Et{constructor(){this._nativeVertexArrayObject=c.layaGPUInstance.createVertexArray()}bind(){if(Et._curBindedBufferState!==this){c.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject);Et._curBindedBufferState=this}}unBind(){if(Et._curBindedBufferState===this){c.layaGPUInstance.bindVertexArray(null);Et._curBindedBufferState=null}else{throw"BufferState: must call bind() function first."}}destroy(){c.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}bindForNative(){c.instance.bindVertexArray(this._nativeVertexArrayObject);Et._curBindedBufferState=this}unBindForNative(){c.instance.bindVertexArray(null);Et._curBindedBufferState=null}}class Vt extends Et{constructor(){super()}}class Rt{constructor(t,e,o){this._stride=0;this.vertNum=0;this.indexNum=0;this._applied=false;this._quadNum=0;this.canReuse=false;this._stride=t;this._vb=new Dt(t,c.instance.DYNAMIC_DRAW);if(e){this._vb._resizeBuffer(e,false)}else{s.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(64*1024*t,false)}this._ib=new Lt;if(o){this._ib._resizeBuffer(o,false)}}cloneWithNewVB(){var t=new Rt(this._stride,0,0);t._ib=this._ib;t._quadNum=this._quadNum;t._attribInfo=this._attribInfo;return t}cloneWithNewVBIB(){var t=new Rt(this._stride,0,0);t._attribInfo=this._attribInfo;return t}getVBW(){this._vb.setNeedUpload();return this._vb}getVBR(){return this._vb}getIBR(){return this._ib}getIBW(){this._ib.setNeedUpload();return this._ib}createQuadIB(t){this._quadNum=t;this._ib._resizeBuffer(t*6*2,false);this._ib.byteLength=this._ib.bufferLength;var e=this._ib.getUint16Array();var o=0;var i=0;for(var a=0;a<t;a++){e[o++]=i;e[o++]=i+2;e[o++]=i+1;e[o++]=i;e[o++]=i+3;e[o++]=i+2;i+=4}this._ib.setNeedUpload()}setAttributes(t){this._attribInfo=t;if(this._attribInfo.length%3!=0){throw"Mesh2D setAttributes error!"}}configVAO(t){if(this._applied)return;this._applied=true;if(!this._vao){this._vao=new Vt}this._vao.bind();this._vb._bindForVAO();this._ib.setNeedUpload();this._ib._bind_uploadForVAO();var e=this._attribInfo.length/3;var o=0;for(var i=0;i<e;i++){var a=this._attribInfo[o+1];var r=this._attribInfo[o];var s=this._attribInfo[o+2];t.enableVertexAttribArray(i);t.vertexAttribPointer(i,a,r,false,this._stride,s);o+=3}this._vao.unBind()}useMesh(t){this._applied||this.configVAO(t);this._vao.bind();this._vb.bind();this._ib._bind_upload()||this._ib.bind();this._vb._bind_upload()||this._vb.bind()}getEleNum(){return this._ib.getBuffer().byteLength/2}releaseMesh(){}destroy(){}clearVB(){this._vb.clear()}}Rt._gvaoid=0;class Gt extends Rt{constructor(){super(Gt.const_stride,4,4);this.canReuse=true;this.setAttributes(Gt._fixattriInfo);if(!Gt._fixib){this.createQuadIB(Gt._maxIB);Gt._fixib=this._ib}else{this._ib=Gt._fixib;this._quadNum=Gt._maxIB}}static __int__(){Gt._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}static getAMesh(t){var e=null;if(Gt._POOL.length){e=Gt._POOL.pop()}else e=new Gt;t&&e._vb._resizeBuffer(64*1024*Gt.const_stride,false);return e}releaseMesh(){this._vb.setByteLength(0);this.vertNum=0;this.indexNum=0;Gt._POOL.push(this)}destroy(){this._vb.destroy();this._vb.deleteBuffer()}addQuad(t,e,o,i){var a=this._vb;var r=a._byteLength>>2;a.setByteLength(r+Gt.const_stride<<2);var s=a._floatArray32||a.getFloat32Array();var n=a._uint32Array;var b=r;var x=i?255:0;s[b++]=t[0];s[b++]=t[1];s[b++]=e[0];s[b++]=e[1];n[b++]=o;n[b++]=x;s[b++]=t[2];s[b++]=t[3];s[b++]=e[2];s[b++]=e[3];n[b++]=o;n[b++]=x;s[b++]=t[4];s[b++]=t[5];s[b++]=e[4];s[b++]=e[5];n[b++]=o;n[b++]=x;s[b++]=t[6];s[b++]=t[7];s[b++]=e[6];s[b++]=e[7];n[b++]=o;n[b++]=x;a._upload=true}}Gt.const_stride=24;Gt._maxIB=16*1024;Gt._POOL=[];class Ft extends Rt{constructor(){super(Ft.const_stride,4,4);this.canReuse=true;this.setAttributes(Ft._fixattriInfo)}static __init__(){Ft._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}static getAMesh(t){var e;if(Ft._POOL.length){e=Ft._POOL.pop()}else e=new Ft;t&&e._vb._resizeBuffer(64*1024*Ft.const_stride,false);return e}addData(t,e,o,i,a){var r=this._vb;var s=this._ib;var n=t.length>>1;var b=r.needSize(n*Ft.const_stride);var x=b>>2;var l=r._floatArray32||r.getFloat32Array();var _=r._uint32Array;var h=0;var d=i.a;var p=i.b;var c=i.c;var u=i.d;var y=i.tx;var m=i.ty;var f=0;for(f=0;f<n;f++){var g=t[h],v=t[h+1];l[x]=g*d+v*c+y;l[x+1]=g*p+v*u+m;l[x+2]=e[h];l[x+3]=e[h+1];_[x+4]=a;_[x+5]=255;x+=6;h+=2}r.setNeedUpload();var S=this.vertNum;var C=o.length;var P=s.needSize(o.byteLength);var A=s.getUint16Array();var B=P>>1;if(S>0){var w=B+C;var T=0;for(f=B;f<w;f++,T++){A[f]=o[T]+S}}else{A.set(o,B)}s.setNeedUpload();this.vertNum+=n;this.indexNum+=o.length}releaseMesh(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.vertNum=0;this.indexNum=0;Ft._POOL.push(this)}destroy(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer()}}Ft.const_stride=24;Ft._POOL=[];class Jt extends Rt{constructor(){super(Jt.const_stride,4,4);this.canReuse=true;this.setAttributes(Jt._fixattriInfo)}static __init__(){Jt._fixattriInfo=[5126,2,0,5121,4,8]}static getAMesh(t){var e;if(Jt._POOL.length){e=Jt._POOL.pop()}else e=new Jt;t&&e._vb._resizeBuffer(64*1024*Jt.const_stride,false);return e}addVertAndIBToMesh(t,e,o,i){var a=this._vb.needSize(e.length/2*Jt.const_stride);var r=a>>2;var s=this._vb._floatArray32||this._vb.getFloat32Array();var n=this._vb._uint32Array;var b=0;var x=e.length/2;for(var l=0;l<x;l++){s[r++]=e[b];s[r++]=e[b+1];b+=2;n[r++]=o}this._vb.setNeedUpload();this._ib.append(new Uint16Array(i));this._ib.setNeedUpload();this.vertNum+=x;this.indexNum+=i.length}releaseMesh(){this._vb.setByteLength(0);this._ib.setByteLength(0);this.vertNum=0;this.indexNum=0;Jt._POOL.push(this)}destroy(){this._ib.destroy();this._vb.destroy();this._ib.disposeResource();this._vb.deleteBuffer()}}Jt.const_stride=12;Jt._POOL=[];class kt{constructor(t,e){this.submitStartPos=0;this.submitEndPos=0;this.context=null;this.touches=[];this.submits=[];this.sprite=null;this.meshlist=[];this.cachedClipInfo=new w;this.oldTx=0;this.oldTy=0;this.invMat=new w;this.context=t;this.sprite=e;t._globalClipMatrix.copyTo(this.cachedClipInfo)}startRec(){if(this.context._charSubmitCache._enbale){this.context._charSubmitCache.enable(false,this.context);this.context._charSubmitCache.enable(true,this.context)}this.context._incache=true;this.touches.length=0;this.context.touches=this.touches;this.context._globalClipMatrix.copyTo(this.cachedClipInfo);this.submits.length=0;this.submitStartPos=this.context._submits._length;for(var t=0,e=this.meshlist.length;t<e;t++){var o=this.meshlist[t];o.canReuse?o.releaseMesh():o.destroy()}this.meshlist.length=0;this._mesh=Gt.getAMesh(false);this._pathMesh=Jt.getAMesh(false);this._triangleMesh=Ft.getAMesh(false);this.meshlist.push(this._mesh);this.meshlist.push(this._pathMesh);this.meshlist.push(this._triangleMesh);this.context._curSubmit=A.RENDERBASE;this._oldMesh=this.context._mesh;this._oldPathMesh=this.context._pathMesh;this._oldTriMesh=this.context._triangleMesh;this._oldMeshList=this.context.meshlist;this.context._mesh=this._mesh;this.context._pathMesh=this._pathMesh;this.context._triangleMesh=this._triangleMesh;this.context.meshlist=this.meshlist;this.oldTx=this.context._curMat.tx;this.oldTy=this.context._curMat.ty;this.context._curMat.tx=0;this.context._curMat.ty=0;this.context._curMat.copyTo(this.invMat);this.invMat.invert()}endRec(){if(this.context._charSubmitCache._enbale){this.context._charSubmitCache.enable(false,this.context);this.context._charSubmitCache.enable(true,this.context)}var t=this.context._submits;this.submitEndPos=t._length;var e=this.submitEndPos-this.submitStartPos;for(var o=0;o<e;o++){this.submits.push(t[this.submitStartPos+o])}t._length-=e;this.context._mesh=this._oldMesh;this.context._pathMesh=this._oldPathMesh;this.context._triangleMesh=this._oldTriMesh;this.context.meshlist=this._oldMeshList;this.context._curSubmit=A.RENDERBASE;this.context._curMat.tx=this.oldTx;this.context._curMat.ty=this.oldTy;this.context.touches=null;this.context._incache=false}isCacheValid(){var t=this.context._globalClipMatrix;if(t.a!=this.cachedClipInfo.a||t.b!=this.cachedClipInfo.b||t.c!=this.cachedClipInfo.c||t.d!=this.cachedClipInfo.d||t.tx!=this.cachedClipInfo.tx||t.ty!=this.cachedClipInfo.ty)return false;return true}flushsubmit(){var e=A.RENDERBASE;this.submits.forEach(function(t){if(t==A.RENDERBASE)return;A.preRender=e;e=t;t.renderSubmit()})}releaseMem(){}}kt.matI=new w;var Ot="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}";var Nt="/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#ifdef FSHIGHPRECISION\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;\r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}";var Wt="attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}";var Ut="precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}";var zt="attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}";var Xt="precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}";class Ht{constructor(){this.ALPHA=1;this.defines=new D;this.shaderType=0;this.fillStyle=vt.DEFAULT;this.strokeStyle=vt.DEFAULT}destroy(){this.defines=null;this.filters=null}static __init__(){rt.preCompile2D(0,D.TEXTURE2D,Ot,Nt,null);rt.preCompile2D(0,D.PRIMITIVE,Wt,Ut,null);rt.preCompile2D(0,D.SKINMESH,zt,Xt,null)}}class Yt{constructor(){var t=c.instance;this.ib=Lt.create(t.DYNAMIC_DRAW);this.vb=Dt.create(8)}static getInstance(){return Yt.instance=Yt.instance||new Yt}addSkinMesh(t){t.getData2(this.vb,this.ib,this.vb._byteLength/32)}reset(){this.vb.clear();this.ib.clear()}}class qt{static createLine2(t,e,o,i,a,r){if(t.length<4)return null;var s=qt.tempData.length>t.length+2?qt.tempData:new Array(t.length+2);s[0]=t[0];s[1]=t[1];var n=2;var b=0;var x=t.length;for(b=2;b<x;b+=2){if(Math.abs(t[b]-t[b-2])+Math.abs(t[b+1]-t[b-1])>.01){s[n++]=t[b];s[n++]=t[b+1]}}if(r&&Math.abs(t[0]-s[n-2])+Math.abs(t[1]-s[n-1])>.01){s[n++]=t[0];s[n++]=t[1]}var l=a;x=n/2;var _=o/2;var h,d,p,c,u,y,m,f;var g,v,S,C;var P,A,B,w,T,M;var I,D;p=s[0];c=s[1];u=s[2];y=s[3];g=-(c-y);v=p-u;D=Math.sqrt(g*g+v*v);g=g/D*_;v=v/D*_;l.push(p-g,c-v,p+g,c+v);for(b=1;b<x-1;b++){p=s[(b-1)*2];c=s[(b-1)*2+1];u=s[b*2];y=s[b*2+1];m=s[(b+1)*2];f=s[(b+1)*2+1];g=-(c-y);v=p-u;D=Math.sqrt(g*g+v*v);g=g/D*_;v=v/D*_;S=-(y-f);C=u-m;D=Math.sqrt(S*S+C*C);S=S/D*_;C=C/D*_;P=-v+c-(-v+y);A=-g+u-(-g+p);B=(-g+p)*(-v+y)-(-g+u)*(-v+c);w=-C+f-(-C+y);T=-S+u-(-S+m);M=(-S+m)*(-C+y)-(-S+u)*(-C+f);I=P*T-w*A;if(Math.abs(I)<.1){I+=10.1;l.push(u-g,y-v,u+g,y+v);continue}h=(A*M-T*B)/I;d=(w*B-P*M)/I;l.push(h,d,u-(h-u),y-(d-y))}p=s[n-4];c=s[n-3];u=s[n-2];y=s[n-1];g=-(c-y);v=p-u;D=Math.sqrt(g*g+v*v);g=g/D*_;v=v/D*_;l.push(u-g,y-v,u+g,y+v);for(b=1;b<x;b++){e.push(i+(b-1)*2,i+(b-1)*2+1,i+b*2+1,i+b*2+1,i+b*2,i+(b-1)*2)}return l}static createLineTriangle(t,e,o,i,a,r,s){var n=t.slice();var b=n.length;var x=n[0],l=n[1];var _=n[2],h=n[2];var d=0;var p=0;var c=0,u=0;var y=b/2;if(y<=1)return;if(y==2){return}var m=new Array(y*4);var f=0;var g=0;for(var v=0;v<y-1;v++){x=n[g++],l=n[g++];_=n[g++],h=n[g++];c=_-x,u=h-l;if(c!=0&&u!=0){d=Math.sqrt(c*c+u*u);if(d>.001){p=f*4;m[p]=x;m[p+1]=l;m[p+2]=c/d;m[p+3]=u/d;f++}}}if(i){x=n[b-2],l=n[b-1];_=n[0],h=n[1];c=_-x,u=h-l;if(c!=0&&u!=0){d=Math.sqrt(c*c+u*u);if(d>.001){p=f*4;m[p]=x;m[p+1]=l;m[p+2]=c/d;m[p+3]=u/d;f++}}}else{p=f*4;m[p]=x;m[p+1]=l;m[p+2]=c/d;m[p+3]=u/d;f++}g=0;for(v=0;v<y;v++){x=n[g],l=n[g+1];_=n[g+2],h=n[g+3];var S=n[g+4],C=n[g+5]}}}qt.tempData=new Array(256);class jt{constructor(t,e,o){this.i=t;this.x=e;this.y=o;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}}class S{static earcut(t,e,o){o=o||2;var i=e&&e.length,a=i?e[0]*o:t.length,r=S.linkedList(t,0,a,o,true),s=[];if(!r)return s;var n,b,x,l,_,h,d;if(i)r=S.eliminateHoles(t,e,r,o);if(t.length>80*o){n=x=t[0];b=l=t[1];for(var p=o;p<a;p+=o){_=t[p];h=t[p+1];if(_<n)n=_;if(h<b)b=h;if(_>x)x=_;if(h>l)l=h}d=Math.max(x-n,l-b);d=d!==0?1/d:0}S.earcutLinked(r,s,o,n,b,d);return s}static linkedList(t,e,o,i,a){var r,s;if(a===S.signedArea(t,e,o,i)>0){for(r=e;r<o;r+=i)s=S.insertNode(r,t[r],t[r+1],s)}else{for(r=o-i;r>=e;r-=i)s=S.insertNode(r,t[r],t[r+1],s)}if(s&&S.equals(s,s.next)){S.removeNode(s);s=s.next}return s}static filterPoints(t,e){if(!t)return t;if(!e)e=t;var o=t,i;do{i=false;if(!o.steiner&&(S.equals(o,o.next)||S.area(o.prev,o,o.next)===0)){S.removeNode(o);o=e=o.prev;if(o===o.next)break;i=true}else{o=o.next}}while(i||o!==e);return e}static earcutLinked(t,e,o,i,a,r,s=null){if(!t)return;if(!s&&r)S.indexCurve(t,i,a,r);var n=t,b,x;while(t.prev!==t.next){b=t.prev;x=t.next;if(r?S.isEarHashed(t,i,a,r):S.isEar(t)){e.push(b.i/o);e.push(t.i/o);e.push(x.i/o);S.removeNode(t);t=x.next;n=x.next;continue}t=x;if(t===n){if(!s){S.earcutLinked(S.filterPoints(t,null),e,o,i,a,r,1)}else if(s===1){t=S.cureLocalIntersections(t,e,o);S.earcutLinked(t,e,o,i,a,r,2)}else if(s===2){S.splitEarcut(t,e,o,i,a,r)}break}}}static isEar(t){var e=t.prev,o=t,i=t.next;if(S.area(e,o,i)>=0)return false;var a=t.next.next;while(a!==t.prev){if(S.pointInTriangle(e.x,e.y,o.x,o.y,i.x,i.y,a.x,a.y)&&S.area(a.prev,a,a.next)>=0)return false;a=a.next}return true}static isEarHashed(t,e,o,i){var a=t.prev,r=t,s=t.next;if(S.area(a,r,s)>=0)return false;var n=a.x<r.x?a.x<s.x?a.x:s.x:r.x<s.x?r.x:s.x,b=a.y<r.y?a.y<s.y?a.y:s.y:r.y<s.y?r.y:s.y,x=a.x>r.x?a.x>s.x?a.x:s.x:r.x>s.x?r.x:s.x,l=a.y>r.y?a.y>s.y?a.y:s.y:r.y>s.y?r.y:s.y;var _=S.zOrder(n,b,e,o,i),h=S.zOrder(x,l,e,o,i);var d=t.nextZ;while(d&&d.z<=h){if(d!==t.prev&&d!==t.next&&S.pointInTriangle(a.x,a.y,r.x,r.y,s.x,s.y,d.x,d.y)&&S.area(d.prev,d,d.next)>=0)return false;d=d.nextZ}d=t.prevZ;while(d&&d.z>=_){if(d!==t.prev&&d!==t.next&&S.pointInTriangle(a.x,a.y,r.x,r.y,s.x,s.y,d.x,d.y)&&S.area(d.prev,d,d.next)>=0)return false;d=d.prevZ}return true}static cureLocalIntersections(t,e,o){var i=t;do{var a=i.prev,r=i.next.next;if(!S.equals(a,r)&&S.intersects(a,i,i.next,r)&&S.locallyInside(a,r)&&S.locallyInside(r,a)){e.push(a.i/o);e.push(i.i/o);e.push(r.i/o);S.removeNode(i);S.removeNode(i.next);i=t=r}i=i.next}while(i!==t);return i}static splitEarcut(t,e,o,i,a,r){var s=t;do{var n=s.next.next;while(n!==s.prev){if(s.i!==n.i&&S.isValidDiagonal(s,n)){var b=S.splitPolygon(s,n);s=S.filterPoints(s,s.next);b=S.filterPoints(b,b.next);S.earcutLinked(s,e,o,i,a,r);S.earcutLinked(b,e,o,i,a,r);return}n=n.next}s=s.next}while(s!==t)}static eliminateHoles(t,e,o,i){var a=[],r,s,n,b,x;for(r=0,s=e.length;r<s;r++){n=e[r]*i;b=r<s-1?e[r+1]*i:t.length;x=S.linkedList(t,n,b,i,false);if(x===x.next)x.steiner=true;a.push(S.getLeftmost(x))}a.sort(S.compareX);for(r=0;r<a.length;r++){S.eliminateHole(a[r],o);o=S.filterPoints(o,o.next)}return o}static compareX(t,e){return t.x-e.x}static eliminateHole(t,e){e=S.findHoleBridge(t,e);if(e){var o=S.splitPolygon(e,t);S.filterPoints(o,o.next)}}static findHoleBridge(t,e){var o=e,i=t.x,a=t.y,r=-Infinity,s;do{if(a<=o.y&&a>=o.next.y&&o.next.y!==o.y){var n=o.x+(a-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(n<=i&&n>r){r=n;if(n===i){if(a===o.y)return o;if(a===o.next.y)return o.next}s=o.x<o.next.x?o:o.next}}o=o.next}while(o!==e);if(!s)return null;if(i===r)return s.prev;var b=s,x=s.x,l=s.y,_=Infinity,h;o=s.next;while(o!==b){if(i>=o.x&&o.x>=x&&i!==o.x&&S.pointInTriangle(a<l?i:r,a,x,l,a<l?r:i,a,o.x,o.y)){h=Math.abs(a-o.y)/(i-o.x);if((h<_||h===_&&o.x>s.x)&&S.locallyInside(o,t)){s=o;_=h}}o=o.next}return s}static indexCurve(t,e,o,i){var a=t;do{if(a.z===null)a.z=S.zOrder(a.x,a.y,e,o,i);a.prevZ=a.prev;a.nextZ=a.next;a=a.next}while(a!==t);a.prevZ.nextZ=null;a.prevZ=null;S.sortLinked(a)}static sortLinked(t){var e,o,i,a,r,s,n,b,x=1;do{o=t;t=null;r=null;s=0;while(o){s++;i=o;n=0;for(e=0;e<x;e++){n++;i=i.nextZ;if(!i)break}b=x;while(n>0||b>0&&i){if(n!==0&&(b===0||!i||o.z<=i.z)){a=o;o=o.nextZ;n--}else{a=i;i=i.nextZ;b--}if(r)r.nextZ=a;else t=a;a.prevZ=r;r=a}o=i}r.nextZ=null;x*=2}while(s>1);return t}static zOrder(t,e,o,i,a){t=32767*(t-o)*a;e=32767*(e-i)*a;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;return t|e<<1}static getLeftmost(t){var e=t,o=t;do{if(e.x<o.x)o=e;e=e.next}while(e!==t);return o}static pointInTriangle(t,e,o,i,a,r,s,n){return(a-s)*(e-n)-(t-s)*(r-n)>=0&&(t-s)*(i-n)-(o-s)*(e-n)>=0&&(o-s)*(r-n)-(a-s)*(i-n)>=0}static isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!S.intersectsPolygon(t,e)&&S.locallyInside(t,e)&&S.locallyInside(e,t)&&S.middleInside(t,e)}static area(t,e,o){return(e.y-t.y)*(o.x-e.x)-(e.x-t.x)*(o.y-e.y)}static equals(t,e){return t.x===e.x&&t.y===e.y}static intersects(t,e,o,i){if(S.equals(t,e)&&S.equals(o,i)||S.equals(t,i)&&S.equals(o,e))return true;return S.area(t,e,o)>0!==S.area(t,e,i)>0&&S.area(o,i,t)>0!==S.area(o,i,e)>0}static intersectsPolygon(t,e){var o=t;do{if(o.i!==t.i&&o.next.i!==t.i&&o.i!==e.i&&o.next.i!==e.i&&S.intersects(o,o.next,t,e))return true;o=o.next}while(o!==t);return false}static locallyInside(t,e){return S.area(t.prev,t,t.next)<0?S.area(t,e,t.next)>=0&&S.area(t,t.prev,e)>=0:S.area(t,e,t.prev)<0||S.area(t,t.next,e)<0}static middleInside(t,e){var o=t,i=false,a=(t.x+e.x)/2,r=(t.y+e.y)/2;do{if(o.y>r!==o.next.y>r&&o.next.y!==o.y&&a<(o.next.x-o.x)*(r-o.y)/(o.next.y-o.y)+o.x)i=!i;o=o.next}while(o!==t);return i}static splitPolygon(t,e){var o=new jt(t.i,t.x,t.y),i=new jt(e.i,e.x,e.y),a=t.next,r=e.prev;t.next=e;e.prev=t;o.next=a;a.prev=o;i.next=o;o.prev=i;r.next=i;i.prev=r;return i}static insertNode(t,e,o,i){var a=new jt(t,e,o);if(!i){a.prev=a;a.next=a}else{a.next=i.next;a.prev=i;i.next.prev=a;i.next=a}return a}static removeNode(t){t.next.prev=t.prev;t.prev.next=t.next;if(t.prevZ)t.prevZ.nextZ=t.nextZ;if(t.nextZ)t.nextZ.prevZ=t.prevZ}static signedArea(t,e,o,i){var a=0;for(var r=e,s=o-i;r<o;r+=i){a+=(t[s]-t[r])*(t[r+1]+t[s+1]);s=r}return a}}class Kt{}Kt.BYTES_PE=4;Kt.BYTES_PIDX=2;Kt.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Kt.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];Kt.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];Kt._TMPARRAY=[];Kt._OFFSETX=0;Kt._OFFSETY=0;class Zt extends A{constructor(t=A.TYPE_2D){super(t)}renderSubmit(){if(this._numEle===0||!this._mesh||this._numEle==0)return 1;var t=this.shaderValue.textureHost;if(t){var e=t._getSource();if(!e)return 1;this.shaderValue.texture=e}var o=u.mainContext;this._mesh.useMesh(o);this.shaderValue.upload();if(I.activeBlendFunction!==this._blendFn){u.setBlend(o,true);this._blendFn(o);I.activeBlendFunction=this._blendFn}o.drawElements(o.TRIANGLES,this._numEle,o.UNSIGNED_SHORT,this._startIdx);m.renderBatches++;m.trianglesFaces+=this._numEle/3;return 1}releaseRender(){if(A.RENDERBASE==this)return;if(--this._ref<1){Zt.POOL[Zt._poolSize++]=this;this.shaderValue.release();this.shaderValue=null;this._mesh=null;this._parent&&(this._parent.releaseRender(),this._parent=null)}}static create(t,e,o){var i=Zt._poolSize?Zt.POOL[--Zt._poolSize]:new Zt;i._ref=1;i._mesh=e;i._key.clear();i._startIdx=e.indexNum*Kt.BYTES_PIDX;i._numEle=0;var a=t._nBlendType;i._blendFn=t._targets?I.targetFns[a]:I.fns[a];i.shaderValue=o;i.shaderValue.setValue(t._shader2D);var r=t._shader2D.filters;r&&i.shaderValue.setFilters(r);return i}static createShape(t,e,o,i){var a=Zt._poolSize?Zt.POOL[--Zt._poolSize]:new Zt;a._mesh=e;a._numEle=o;a._startIdx=e.indexNum*2;a._ref=1;a.shaderValue=i;a.shaderValue.setValue(t._shader2D);var r=t._nBlendType;a._key.blendShader=r;a._blendFn=t._targets?I.targetFns[r]:I.fns[r];return a}}Zt._poolSize=0;Zt.POOL=[];class Qt extends A{constructor(){super(A.TYPE_2D);this._matrix=new w;this._matrix4=Kt.defaultMatrix4.concat();this.shaderValue=new nt(0,0)}static create(t,e,o){var i=!Qt.POOL._length?new Qt:Qt.POOL[--Qt.POOL._length];i.canv=t;i._ref=1;i._numEle=0;var a=i.shaderValue;a.alpha=e;a.defines.setValue(0);o&&o.length&&a.setFilters(o);return i}renderSubmit(){var t=x.worldAlpha;var e=x.worldMatrix4;var o=x.worldMatrix;var i=x.worldFilters;var a=x.worldShaderDefines;var r=this.shaderValue;var s=this._matrix;var n=this._matrix4;var b=w.TEMP;w.mul(s,o,b);n[0]=b.a;n[1]=b.b;n[4]=b.c;n[5]=b.d;n[12]=b.tx;n[13]=b.ty;x.worldMatrix=b.clone();x.worldMatrix4=n;x.worldAlpha=x.worldAlpha*r.alpha;if(r.filters&&r.filters.length){x.worldFilters=r.filters;x.worldShaderDefines=r.defines}this.canv["flushsubmit"]();x.worldAlpha=t;x.worldMatrix4=e;x.worldMatrix.destroy();x.worldMatrix=o;x.worldFilters=i;x.worldShaderDefines=a;return 1}releaseRender(){if(--this._ref<1){var t=Qt.POOL;this._mesh=null;t[t._length++]=this}}getRenderType(){return A.TYPE_CANVAS}}Qt.POOL=[];{Qt.POOL._length=0}class $t{constructor(){this.blendType=0;this._ref=1;this._key=new bt}renderSubmit(){var t=u.mainContext;this._mesh.useMesh(t);var e=this.srcRT;if(e){this.shaderValue.texture=e._getSource();this.shaderValue.upload();this.blend();m.renderBatches++;m.trianglesFaces+=this._numEle/3;t.drawElements(t.TRIANGLES,this._numEle,t.UNSIGNED_SHORT,this._startIdx)}return 1}blend(){if(I.activeBlendFunction!==I.fns[this.blendType]){var t=u.mainContext;t.enable(t.BLEND);I.fns[this.blendType](t);I.activeBlendFunction=I.fns[this.blendType]}}getRenderType(){return 0}releaseRender(){if(--this._ref<1){var t=$t.POOL;t[t._length++]=this}}static create(t,e,o,i){var a=$t.POOL._length?$t.POOL[--$t.POOL._length]:new $t;a._mesh=e;a.srcRT=i;a._startIdx=e.indexNum*Kt.BYTES_PIDX;a._ref=1;a._key.clear();a._numEle=0;a.blendType=t._nBlendType;a._key.blendShader=a.blendType;a.shaderValue=o;a.shaderValue.setValue(t._shader2D);if(t._colorFiler){var r=t._colorFiler;o.defines.add(r.type);o.colorMat=r._mat;o.colorAlpha=r._alpha}return a}}$t.POOL=[];{$t.POOL._length=0}class te extends A{constructor(t=A.TYPE_2D){super(t)}releaseRender(){if(--this._ref<1){te.POOL[te._poolSize++]=this;this.shaderValue.release();this._mesh=null;this._parent&&(this._parent.releaseRender(),this._parent=null)}}renderSubmit(){if(this._numEle===0)return 1;var t=this.shaderValue.textureHost;if(t){var e=t?t._getSource():null;if(!e)return 1}var o=u.mainContext;this._mesh.useMesh(o);var i=A.preRender;var a=A.preRender._key;if(this._key.blendShader===0&&(this._key.submitType===a.submitType&&this._key.blendShader===a.blendShader)&&et.activeShader&&A.preRender.clipInfoID==this.clipInfoID&&i.shaderValue.defines._value===this.shaderValue.defines._value&&(this.shaderValue.defines._value&D.NOOPTMASK)==0){et.activeShader.uploadTexture2D(e)}else{if(I.activeBlendFunction!==this._blendFn){u.setBlend(o,true);this._blendFn(o);I.activeBlendFunction=this._blendFn}this.shaderValue.texture=e;this.shaderValue.upload()}o.drawElements(o.TRIANGLES,this._numEle,o.UNSIGNED_SHORT,this._startIdx);m.renderBatches++;m.trianglesFaces+=this._numEle/3;return 1}static create(t,e,o){var i=te._poolSize?te.POOL[--te._poolSize]:new te(A.TYPE_TEXTURE);i._mesh=e;i._key.clear();i._key.submitType=A.KEY_DRAWTEXTURE;i._ref=1;i._startIdx=e.indexNum*Kt.BYTES_PIDX;i._numEle=0;var a=t._nBlendType;i._key.blendShader=a;i._blendFn=t._targets?I.targetFns[a]:I.fns[a];i.shaderValue=o;if(t._colorFiler){var r=t._colorFiler;o.defines.add(r.type);o.colorMat=r._mat;o.colorAlpha=r._alpha}return i}}te._poolSize=0;te.POOL=[];class ee{constructor(){this._data=[];this._ndata=0;this._clipid=-1;this._clipMatrix=new w;this._enbale=false}clear(){this._tex=null;this._imgId=-1;this._ndata=0;this._enbale=false;this._colorFiler=null}destroy(){this.clear();this._data.length=0;this._data=null}add(t,e,o,i,a,r){if(this._ndata>0&&(this._tex!=e||this._imgId!=o||this._clipid>=0&&this._clipid!=t._clipInfoID)){this.submit(t)}this._clipid=t._clipInfoID;t._globalClipMatrix.copyTo(this._clipMatrix);this._tex=e;this._imgId=o;this._colorFiler=t._colorFiler;this._data[this._ndata]=i;this._data[this._ndata+1]=a;this._data[this._ndata+2]=r;this._ndata+=3}getPos(){if(ee.__nPosPool==0)return new Array(8);return ee.__posPool[--ee.__nPosPool]}enable(t,e){if(t===this._enbale)return;this._enbale=t;this._enbale||this.submit(e)}submit(t){var e=this._ndata;if(!e)return;var o=t._mesh;var i=t._colorFiler;t._colorFiler=this._colorFiler;var a=te.create(t,o,nt.create(D.TEXTURE2D,0));t._submits[t._submits._length++]=t._curSubmit=a;a.shaderValue.textureHost=this._tex;a._key.other=this._imgId;t._colorFiler=i;t._copyClipInfo(a,this._clipMatrix);a.clipInfoID=this._clipid;for(var r=0;r<e;r+=3){o.addQuad(this._data[r],this._data[r+1],this._data[r+2],true);ee.__posPool[ee.__nPosPool++]=this._data[r]}e/=3;a._numEle+=e*6;o.indexNum+=e*6;o.vertNum+=e*4;t._drawCount+=e;this._ndata=0;if(Tt.loopCount%100==0)this._data.length=0}}ee.__posPool=[];ee.__nPosPool=0;class oe{constructor(t=0,e=0,o=0){this.atlasID=0;this._width=0;this._height=0;this._texCount=0;this._rowInfo=null;this._cells=null;this._used=0;this._cells=null;this._rowInfo=null;this.atlasID=o;this._init(t,e)}addRect(t,e,o,i){if(!this._get(e,o,i))return false;this._fill(i.x,i.y,e,o,t);this._texCount++;return true}_release(){this._cells=null;this._rowInfo=null}_init(t,e){this._width=t;this._height=e;this._release();if(this._width==0)return false;this._cells=new Uint8Array(this._width*this._height*3);this._rowInfo=new Uint8Array(this._height);this._used=0;this._clear();return true}_get(t,e,o){if(t>this._width||e>this._height){return false}var i=-1;var a=-1;var r=this._width;var s=this._height;var n=this._cells;for(var b=0;b<s;b++){if(this._rowInfo[b]<t)continue;for(var x=0;x<r;){var l=(b*r+x)*3;if(n[l]!=0||n[l+1]<t||n[l+2]<e){x+=n[l+1];continue}i=x;a=b;for(var _=0;_<t;_++){if(n[3*_+l+2]<e){i=-1;break}}if(i<0){x+=n[l+1];continue}o.x=i;o.y=a;return true}}return false}_fill(t,e,o,i,a){var r=this._width;var s=this._height;this._check(t+o<=r&&e+i<=s);for(var n=e;n<i+e;++n){this._check(this._rowInfo[n]>=o);this._rowInfo[n]-=o;for(var b=0;b<o;b++){var x=(t+n*r+b)*3;this._check(this._cells[x]==0);this._cells[x]=a;this._cells[x+1]=o;this._cells[x+2]=i}}if(t>0){for(n=0;n<i;++n){var l=0;for(b=t-1;b>=0;--b,++l){if(this._cells[((e+n)*r+b)*3]!=0)break}for(b=l;b>0;--b){this._cells[((e+n)*r+t-b)*3+1]=b;this._check(b>0)}}}if(e>0){for(b=t;b<t+o;++b){l=0;for(n=e-1;n>=0;--n,l++){if(this._cells[(b+n*r)*3]!=0)break}for(n=l;n>0;--n){this._cells[(b+(e-n)*r)*3+2]=n;this._check(n>0)}}}this._used+=o*i/(this._width*this._height)}_check(t){if(t==false){console.log("xtexMerger 错误啦")}}_clear(){this._texCount=0;for(var t=0;t<this._height;t++){this._rowInfo[t]=this._width}for(var e=0;e<this._height;e++){for(var o=0;o<this._width;o++){var i=(e*this._width+o)*3;this._cells[i]=0;this._cells[i+1]=this._width-o;this._cells[i+2]=this._width-e}}}}class C extends ${constructor(t,e){super();this._texW=0;this._texH=0;this.__destroyed=false;this._discardTm=0;this.genID=0;this.bitmap={id:0,_glTexture:null};this.curUsedCovRate=0;this.curUsedCovRateAtlas=0;this.lastTouchTm=0;this.ri=null;this._texW=t||C.gTextRender.atlasWidth;this._texH=e||C.gTextRender.atlasWidth;this.bitmap.id=this.id;this.lock=true}recreateResource(){if(this._source)return;var t=c.instance;var e=this._source=t.createTexture();this.bitmap._glTexture=e;u.bindTexture(t,t.TEXTURE_2D,e);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this._texW,this._texH,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);if(C.gTextRender.debugUV){this.fillWhite()}}addChar(t,e,o,i=null){if(C.gTextRender.isWan1Wan){return this.addCharCanvas(t,e,o,i)}!this._source&&this.recreateResource();var a=c.instance;u.bindTexture(a,a.TEXTURE_2D,this._source);!T.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);var r=t.data;if(t.data instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);a.texSubImage2D(a.TEXTURE_2D,0,e,o,t.width,t.height,a.RGBA,a.UNSIGNED_BYTE,r);!T.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);var s;var n;var b;var x;if(T.Render.isConchApp){s=e/this._texW;n=o/this._texH;b=(e+t.width)/this._texW;x=(o+t.height)/this._texH}else{s=(e+1)/this._texW;n=o/this._texH;b=(e+t.width-1)/this._texW;x=(o+t.height-1)/this._texH}i=i||new Array(8);i[0]=s,i[1]=n;i[2]=b,i[3]=n;i[4]=b,i[5]=x;i[6]=s,i[7]=x;return i}addCharCanvas(t,e,o,i=null){!this._source&&this.recreateResource();var a=c.instance;u.bindTexture(a,a.TEXTURE_2D,this._source);!T.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);a.texSubImage2D(a.TEXTURE_2D,0,e,o,a.RGBA,a.UNSIGNED_BYTE,t);!T.Render.isConchApp&&a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);var r;var s;var n;var b;if(T.Render.isConchApp){r=e/this._texW;s=o/this._texH;n=(e+t.width)/this._texW;b=(o+t.height)/this._texH}else{r=(e+1)/this._texW;s=(o+1)/this._texH;n=(e+t.width-1)/this._texW;b=(o+t.height-1)/this._texH}i=i||new Array(8);i[0]=r,i[1]=s;i[2]=n,i[3]=s;i[4]=n,i[5]=b;i[6]=r,i[7]=b;return i}fillWhite(){!this._source&&this.recreateResource();var t=c.instance;var e=new Uint8Array(this._texW*this._texH*4);e.fill(255);t.texSubImage2D(t.TEXTURE_2D,0,0,0,this._texW,this._texH,t.RGBA,t.UNSIGNED_BYTE,e)}discard(){if(this._texW!=C.gTextRender.atlasWidth||this._texH!=C.gTextRender.atlasWidth){this.destroy();return}this.genID++;if(C.poolLen>=C.pool.length){C.pool=C.pool.concat(new Array(10))}this._discardTm=Tt.loopStTm;C.pool[C.poolLen++]=this}static getTextTexture(t,e){if(t!=C.gTextRender.atlasWidth||t!=C.gTextRender.atlasWidth)return new C(t,e);if(C.poolLen>0){var o=C.pool[--C.poolLen];if(C.poolLen>0)C.clean();return o}return new C(t,e)}destroy(){this.__destroyed=true;var t=c.instance;this._source&&t.deleteTexture(this._source);this._source=null}static clean(){var t=Tt.loopStTm;if(C.cleanTm===0)C.cleanTm=t;if(t-C.cleanTm>=C.gTextRender.checkCleanTextureDt){for(var e=0;e<C.poolLen;e++){var o=C.pool[e];if(t-o._discardTm>=C.gTextRender.destroyUnusedTextureDt){o.destroy();C.pool[e]=C.pool[C.poolLen-1];C.poolLen--;e--}}C.cleanTm=t}}touchRect(t,e){if(this.lastTouchTm!=e){this.curUsedCovRate=0;this.curUsedCovRateAtlas=0;this.lastTouchTm=e}var o=C.gTextRender.atlasWidth*C.gTextRender.atlasWidth;var i=T.TextAtlas.atlasGridW*T.TextAtlas.atlasGridW;this.curUsedCovRate+=t.bmpWidth*t.bmpHeight/o;this.curUsedCovRateAtlas+=Math.ceil(t.bmpWidth/T.TextAtlas.atlasGridW)*Math.ceil(t.bmpHeight/T.TextAtlas.atlasGridW)/(o/i)}get texture(){return this}_getSource(){return this._source}drawOnScreen(t,e){}}C.gTextRender=null;C.pool=new Array(10);C.poolLen=0;C.cleanTm=0;class ie{constructor(){this.texWidth=1024;this.texHeight=1024;this.protectDist=1;this.texture=null;this.charMaps={};this.texHeight=this.texWidth=T.TextRender.atlasWidth;this.texture=C.getTextTexture(this.texWidth,this.texHeight);if(this.texWidth/ie.atlasGridW>256){ie.atlasGridW=Math.ceil(this.texWidth/256)}this.atlasgrid=new oe(this.texWidth/ie.atlasGridW,this.texHeight/ie.atlasGridW,this.texture.id)}setProtecteDist(t){this.protectDist=t}getAEmpty(t,e,o){var i=this.atlasgrid.addRect(1,Math.ceil(t/ie.atlasGridW),Math.ceil(e/ie.atlasGridW),o);if(i){o.x*=ie.atlasGridW;o.y*=ie.atlasGridW}return i}get usedRate(){return this.atlasgrid._used}destroy(){for(var t in this.charMaps){var e=this.charMaps[t];e.deleted=true}this.texture.discard()}printDebugInfo(){}}ie.atlasGridW=16;class L{setTo(t,e,o){this.type=t;this.currentTarget=e;this.target=o;return this}stopPropagation(){this._stoped=true}get touches(){if(!this.nativeEvent)return null;var t=this.nativeEvent.touches;if(t){var e=T.stage;for(var o=0,i=t.length;o<i;o++){var a=t[o];var r=K.TEMP;r.setTo(a.clientX,a.clientY);e._canvasTransform.invertTransformPoint(r);e.transform.invertTransformPoint(r);a.stageX=r.x;a.stageY=r.y}}return t}get altKey(){return this.nativeEvent.altKey}get ctrlKey(){return this.nativeEvent.ctrlKey}get shiftKey(){return this.nativeEvent.shiftKey}get charCode(){return this.nativeEvent.charCode}get keyLocation(){return this.nativeEvent.location||this.nativeEvent.keyLocation}get stageX(){return T.stage.mouseX}get stageY(){return T.stage.mouseY}}L.EMPTY=new L;L.MOUSE_DOWN="mousedown";L.MOUSE_UP="mouseup";L.CLICK="click";L.RIGHT_MOUSE_DOWN="rightmousedown";L.RIGHT_MOUSE_UP="rightmouseup";L.RIGHT_CLICK="rightclick";L.MOUSE_MOVE="mousemove";L.MOUSE_OVER="mouseover";L.MOUSE_OUT="mouseout";L.MOUSE_WHEEL="mousewheel";L.ROLL_OVER="mouseover";L.ROLL_OUT="mouseout";L.DOUBLE_CLICK="doubleclick";L.CHANGE="change";L.CHANGED="changed";L.RESIZE="resize";L.ADDED="added";L.REMOVED="removed";L.DISPLAY="display";L.UNDISPLAY="undisplay";L.ERROR="error";L.COMPLETE="complete";L.LOADED="loaded";L.READY="ready";L.PROGRESS="progress";L.INPUT="input";L.RENDER="render";L.OPEN="open";L.MESSAGE="message";L.CLOSE="close";L.KEY_DOWN="keydown";L.KEY_PRESS="keypress";L.KEY_UP="keyup";L.FRAME="enterframe";L.DRAG_START="dragstart";L.DRAG_MOVE="dragmove";L.DRAG_END="dragend";L.ENTER="enter";L.SELECT="select";L.BLUR="blur";L.FOCUS="focus";L.VISIBILITY_CHANGE="visibilitychange";L.FOCUS_CHANGE="focuschange";L.PLAYED="played";L.PAUSED="paused";L.STOPPED="stopped";L.START="start";L.END="end";L.COMPONENT_ADDED="componentadded";L.COMPONENT_REMOVED="componentremoved";L.RELEASED="released";L.LINK="link";L.LABEL="label";L.FULL_SCREEN_CHANGE="fullscreenchange";L.DEVICE_LOST="devicelost";L.TRANSFORM_CHANGED="transformchanged";L.ANIMATION_CHANGED="animationchanged";L.TRAIL_FILTER_CHANGE="trailfilterchange";L.TRIGGER_ENTER="triggerenter";L.TRIGGER_STAY="triggerstay";L.TRIGGER_EXIT="triggerexit";class ae extends e{constructor(t=null,e=null,o=0,i=0){super();this.uvrect=[0,0,1,1];this._destroyed=false;this._referenceCount=0;this.$_GID=0;this.offsetX=0;this.offsetY=0;this._w=0;this._h=0;this.sourceWidth=0;this.sourceHeight=0;this.url=null;this.scaleRate=1;this.setTo(t,e,o,i)}static moveUV(t,e,o){for(var i=0;i<8;i+=2){o[i]+=t;o[i+1]+=e}return o}static create(t,e,o,i,a,r=0,s=0,n=0,b=0){return ae._create(t,e,o,i,a,r,s,n,b)}static _create(t,e,o,i,a,r=0,s=0,n=0,b=0,x=null){var l=t instanceof ae;var _=l?t.uv:ae.DEF_UV;var h=l?t.bitmap:t;if(h.width&&e+i>h.width)i=h.width-e;if(h.height&&o+a>h.height)a=h.height-o;var d;if(x){d=x;d.setTo(h,null,n||i,b||a)}else{d=new ae(h,null,n||i,b||a)}d.width=i;d.height=a;d.offsetX=r;d.offsetY=s;var p=1/h.width;var c=1/h.height;e*=p;o*=c;i*=p;a*=c;var u=d.uv[0],y=d.uv[1],m=d.uv[4],f=d.uv[5];var g=m-u,v=f-y;var S=ae.moveUV(_[0],_[1],[e,o,e+i,o,e+i,o+a,e,o+a]);d.uv=new Float32Array([u+S[0]*g,y+S[1]*v,m-(1-S[2])*g,y+S[3]*v,m-(1-S[4])*g,f-(1-S[5])*v,u+S[6]*g,f-(1-S[7])*v]);var C=h.scaleRate;if(C&&C!=1){d.sourceWidth/=C;d.sourceHeight/=C;d.width/=C;d.height/=C;d.scaleRate=C}else{d.scaleRate=1}return d}static createFromTexture(t,e,o,i,a){var r=t.scaleRate;if(r!=1){e*=r;o*=r;i*=r;a*=r}var s=B.TEMP.setTo(e-t.offsetX,o-t.offsetY,i,a);var n=s.intersection(ae._rect1.setTo(0,0,t.width,t.height),ae._rect2);if(n)var b=ae.create(t,n.x,n.y,n.width,n.height,n.x-s.x,n.y-s.y,i,a);else return null;return b}get uv(){return this._uv}set uv(t){this.uvrect[0]=Math.min(t[0],t[2],t[4],t[6]);this.uvrect[1]=Math.min(t[1],t[3],t[5],t[7]);this.uvrect[2]=Math.max(t[0],t[2],t[4],t[6])-this.uvrect[0];this.uvrect[3]=Math.max(t[1],t[3],t[5],t[7])-this.uvrect[1];this._uv=t}get width(){if(this._w)return this._w;if(!this.bitmap)return 0;return this.uv&&this.uv!==ae.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width}set width(t){this._w=t;this.sourceWidth||(this.sourceWidth=t)}get height(){if(this._h)return this._h;if(!this.bitmap)return 0;return this.uv&&this.uv!==ae.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height}set height(t){this._h=t;this.sourceHeight||(this.sourceHeight=t)}get bitmap(){return this._bitmap}set bitmap(t){this._bitmap&&this._bitmap._removeReference(this._referenceCount);this._bitmap=t;t&&t._addReference(this._referenceCount)}get destroyed(){return this._destroyed}_addReference(){this._bitmap&&this._bitmap._addReference();this._referenceCount++}_removeReference(){this._bitmap&&this._bitmap._removeReference();this._referenceCount--}_getSource(t=null){if(this._destroyed||!this._bitmap)return null;this.recoverBitmap(t);return this._bitmap.destroyed?null:this.bitmap._getSource()}_onLoaded(t,e){if(!e);else if(e==this);else if(e instanceof ae){var o=e;ae._create(e,0,0,o.width,o.height,0,0,o.sourceWidth,o.sourceHeight,this)}else{this.bitmap=e;this.sourceWidth=this._w=e.width;this.sourceHeight=this._h=e.height}t&&t.run();this.event(L.READY,this)}getIsReady(){return this._destroyed?false:this._bitmap?true:false}setTo(t=null,e=null,o=0,i=0){this.bitmap=t;this.sourceWidth=o;this.sourceHeight=i;if(t){this._w=t.width;this._h=t.height;this.sourceWidth=this.sourceWidth||t.width;this.sourceHeight=this.sourceHeight||t.height}this.uv=e||ae.DEF_UV}load(t,e=null){if(!this._destroyed)T.loader.load(t,Z.create(this,this._onLoaded,[e]),null,"htmlimage",1,false,null,true)}getTexturePixels(t,e,o,i){var a,r,s;var n=this.bitmap;var b=n.width;var x=n.height;if(t+o>b)o-=t+o-b;if(e+i>x)i-=e+i-x;if(o<=0||i<=0)return null;var l=o*4;var _=null;try{_=n.getPixels()}catch(t){}if(_){if(t==0&&e==0&&o==b&&i==x)return _;var h=new Uint8Array(o*i*4);l=b*4;a=t*4;r=(e+i-1)*l+t*4;for(s=i-1;s>=0;s--){h.set(v.slice(r,r+o*4),a);a+=l;r-=l}return h}var d=new T.Context;d.size(o,i);d.asBitmap=true;var p=null;if(t!=0||e!=0||o!=b||i!=x){p=this._uv.slice();var c=p[0];var u=p[1];var y=p[2]-c;var m=p[7]-u;var f=y/b;var g=m/x;p=[c+t*f,u+e*g,c+(t+o)*f,u+e*g,c+(t+o)*f,u+(e+i)*g,c+t*f,u+(e+i)*g]}d._drawTextureM(this,0,0,o,i,null,1,p);d._targets.start();d.flush();d._targets.end();d._targets.restore();var v=d._targets.getData(0,0,o,i);d.destroy();h=new Uint8Array(o*i*4);a=0;r=(i-1)*l;for(s=i-1;s>=0;s--){h.set(v.slice(r,r+l),a);a+=l;r-=l}return h}getPixels(t,e,o,i){if(window.conch){return this._nativeObj.getImageData(t,e,o,i)}else{return this.getTexturePixels(t,e,o,i)}}recoverBitmap(e=null){var t=this._bitmap.url;if(!this._destroyed&&(!this._bitmap||this._bitmap.destroyed)&&t){T.loader.load(t,Z.create(this,function(t){this.bitmap=t;e&&e()}),null,"htmlimage",1,false,null,true)}}disposeBitmap(){if(!this._destroyed&&this._bitmap){this._bitmap.destroy()}}destroy(t=false){if(!this._destroyed){this._destroyed=true;var e=this._bitmap;if(e){e._removeReference(this._referenceCount);if(e.referenceCount===0||t)e.destroy();e=null}if(this.url&&this===T.loader.getRes(this.url))T.loader.clearRes(this.url)}}}ae.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]);ae.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]);ae.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]);ae._rect1=new B;ae._rect2=new B;class re{constructor(t){this._font="14px Arial";this._family="Arial";this._size=14;this._italic=false;this._bold=false;this._id=re._gfontID++;this.setFont(t||this._font)}static Parse(t){if(t===re._lastFont){return re._lastFontInfo}var e=re._cache[t];if(!e){e=re._cache[t]=new re(t)}re._lastFont=t;re._lastFontInfo=e;return e}setFont(t){this._font=t;var e=t.split(" ");var o=e.length;if(o<2){if(o==1){if(e[0].indexOf("px")>0){this._size=parseInt(e[0])}}return}var i=-1;for(var a=0;a<o;a++){if(e[a].indexOf("px")>0||e[a].indexOf("pt")>0){i=a;this._size=parseInt(e[a]);if(this._size<=0){console.error("font parse error:"+t);this._size=14}break}}var r=i+1;var s=e[r];r++;for(;r<o;r++){s+=" "+e[r]}this._family=s.split(",")[0];this._italic=e.indexOf("italic")>=0;this._bold=e.indexOf("bold")>=0}}re.EMPTY=new re(null);re._cache={};re._gfontID=0;re._lastFont="";class se{constructor(){this.save=[];this.toUpperCase=null;this.width=-1;this.pageChars=[];this.startID=0;this.startIDStroke=0;this.lastGCCnt=0;this.splitRender=false}setText(t){this.changed=true;this._text=t;this.width=-1;this.cleanCache()}toString(){return this._text}get length(){return this._text?this._text.length:0}charCodeAt(t){return this._text?this._text.charCodeAt(t):NaN}charAt(t){return this._text?this._text.charAt(t):null}cleanCache(){this.pageChars.forEach(function(t){var e=t.tex;var o=t.words;if(t.words.length==1&&e&&e.ri){e.destroy()}});this.pageChars=[];this.startID=0}}class ne{constructor(){this.char="";this.deleted=false;this.uv=new Array(8);this.pos=0;this.orix=0;this.oriy=0;this.touchTick=0;this.isSpace=false}touch(){var t=Tt.loopCount;if(this.touchTick!=t){this.tex.touchRect(this,t)}this.touchTick=t}}class be{constructor(){this.fontsz=16}getWidth(t,e){return 0}scale(t,e){}get canvasWidth(){return 0}set canvasWidth(t){}getCharBmp(t,e,o,i,a,r,s,n,b,x,l=null){return null}}class E{static __init__(){var t=window.Laya||T.Laya;if(E._window)return E._window;var e=E._window=window;var o=E._document=e.document;var i=E.userAgent=e.navigator.userAgent;if(i.indexOf("AlipayMiniGame")>-1&&"my"in E.window){window.aliMiniGame(t,t);window.aliPayMiniGame(t,t);if(!t["ALIMiniAdapter"]){console.error("请先添加阿里小游戏适配库")}else{t["ALIMiniAdapter"].enable()}}if(i.indexOf("OPPO")==-1&&i.indexOf("MiniGame")>-1&&"wx"in E.window){if("qq"in E.window){window.qqMiniGame(t,t);if(!t["QQMiniAdapter"]){console.error("请引入手机QQ小游戏的适配库：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")}else{t["QQMiniAdapter"].enable()}}else{window.wxMiniGame(t,t);if(!t["MiniAdpter"]){console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")}else{t["MiniAdpter"].enable()}}}if(i.indexOf("SwanGame")>-1){window.bdMiniGame(t,t);if(!t["BMiniAdapter"]){console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")}else{t["BMiniAdapter"].enable()}}if(i.indexOf("QuickGame")>-1){window.miMiniGame(t,t);if(!t["KGMiniAdapter"]){console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")}else{t["KGMiniAdapter"].enable()}}if(i.indexOf("OPPO")>-1&&i.indexOf("MiniGame")>-1){window.qgMiniGame(t,t);if(!t["QGMiniAdapter"]){console.error("请先添加OPPO小游戏适配库")}else{t["QGMiniAdapter"].enable()}}if(i.indexOf("VVGame")>-1){window.vvMiniGame(t,t);if(!t["VVMiniAdapter"]){console.error("请先添加VIVO小游戏适配库")}else{t["VVMiniAdapter"].enable()}}e.trace=console.log;e.requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)};var a=o.body.style;a.margin=0;a.overflow="hidden";a["-webkit-user-select"]="none";a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)";var r=o.getElementsByTagName("meta");var s=0,n=false,b="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";while(s<r.length){var x=r[s];if(x.name=="viewport"){x.content=b;n=true;break}s++}if(!n){x=o.createElement("meta");x.name="viewport",x.content=b;o.getElementsByTagName("head")[0].appendChild(x)}E.onMobile=window.isConchApp?true:i.indexOf("Mobile")>-1;E.onIOS=!!i.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);E.onIPhone=i.indexOf("iPhone")>-1;E.onMac=i.indexOf("Mac OS X")>-1;E.onIPad=i.indexOf("iPad")>-1;E.onAndroid=i.indexOf("Android")>-1||i.indexOf("Adr")>-1;E.onWP=i.indexOf("Windows Phone")>-1;E.onQQBrowser=i.indexOf("QQBrowser")>-1;E.onMQQBrowser=i.indexOf("MQQBrowser")>-1||i.indexOf("Mobile")>-1&&i.indexOf("QQ")>-1;E.onIE=!!e.ActiveXObject||"ActiveXObject"in e;E.onWeiXin=i.indexOf("MicroMessenger")>-1;E.onSafari=i.indexOf("Safari")>-1;E.onPC=!E.onMobile;E.onMiniGame=i.indexOf("MiniGame")>-1;E.onBDMiniGame=i.indexOf("SwanGame")>-1;E.onLayaRuntime=!!E.window.conch;if(i.indexOf("OPPO")>-1&&i.indexOf("MiniGame")>-1){E.onQGMiniGame=true;E.onMiniGame=false}else if("qq"in E.window&&i.indexOf("MiniGame")>-1){E.onQQMiniGame=true;E.onMiniGame=false}E.onVVMiniGame=i.indexOf("VVGame")>-1;E.onKGMiniGame=i.indexOf("QuickGame")>-1;if(i.indexOf("AlipayMiniGame")>-1){E.onAlipayMiniGame=true;E.onMiniGame=false}return e}static createElement(t){E.__init__();return E._document.createElement(t)}static getElementById(t){E.__init__();return E._document.getElementById(t)}static removeElement(t){if(t&&t.parentNode)t.parentNode.removeChild(t)}static now(){return Date.now()}static get clientWidth(){E.__init__();return E._window.innerWidth||E._document.body.clientWidth}static get clientHeight(){E.__init__();return E._window.innerHeight||E._document.body.clientHeight||E._document.documentElement.clientHeight}static get width(){E.__init__();return(T.stage&&T.stage.canvasRotation?E.clientHeight:E.clientWidth)*E.pixelRatio}static get height(){E.__init__();return(T.stage&&T.stage.canvasRotation?E.clientWidth:E.clientHeight)*E.pixelRatio}static get pixelRatio(){if(E._pixelRatio<0){E.__init__();if(E.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")>-1)E._pixelRatio=2;else{E._pixelRatio=E._window.devicePixelRatio||1;if(E._pixelRatio<1)E._pixelRatio=1}}return E._pixelRatio}static get container(){if(!E._container){E.__init__();E._container=E.createElement("div");E._container.id="layaContainer";E._document.body.appendChild(E._container)}return E._container}static set container(t){E._container=t}static get window(){return E._window||E.__init__()}static get document(){E.__init__();return E._document}}E._pixelRatio=-1;E.mainCanvas=null;E.hanzi=new RegExp("^[一-龥]$");E.fontMap=[];E.measureText=function(t,e){var o=E.hanzi.test(t);if(o&&E.fontMap[e]){return E.fontMap[e]}var i=E.context;i.font=e;var a=i.measureText(t);if(o)E.fontMap[e]=a;return a};class xe extends be{constructor(t,e,o=true,i=true,a=false){super();this.ctx=null;this.lastScaleX=1;this.lastScaleY=1;this.needResetScale=false;this.maxTexW=0;this.maxTexH=0;this.scaleFontSize=true;this.showDbgInfo=false;this.supportImageData=true;this.maxTexW=t;this.maxTexH=e;this.scaleFontSize=o;this.supportImageData=i;this.showDbgInfo=a;if(!xe.canvas){xe.canvas=E.createElement("canvas");xe.canvas.width=1024;xe.canvas.height=512;xe.canvas.style.left="-10000px";xe.canvas.style.position="absolute";document.body.appendChild(xe.canvas);this.ctx=xe.canvas.getContext("2d")}}get canvasWidth(){return xe.canvas.width}set canvasWidth(t){if(xe.canvas.width==t)return;xe.canvas.width=t;if(t>2048){console.warn("画文字设置的宽度太大，超过2048了")}this.ctx.setTransform(1,0,0,1,0,0);this.ctx.scale(this.lastScaleX,this.lastScaleY)}getWidth(t,e){if(!this.ctx)return 0;if(this.ctx._lastFont!=t){this.ctx.font=t;this.ctx._lastFont=t}return this.ctx.measureText(e).width}scale(t,e){if(!this.supportImageData){this.lastScaleX=t;this.lastScaleY=e;return}if(this.lastScaleX!=t||this.lastScaleY!=e){this.ctx.setTransform(t,0,0,e,0,0);this.lastScaleX=t;this.lastScaleY=e}}getCharBmp(t,e,o,i,a,r,s,n,b,x,l=null){if(!this.supportImageData)return this.getCharCanvas(t,e,o,i,a,r,s,n,b,x);var _=this.ctx;var h=this.fontsz;if(_.font!=e){_.font=e;_._lastFont=e}r.width=_.measureText(t).width;var d=r.width*this.lastScaleX;var p=r.height*this.lastScaleY;d+=(s+b)*this.lastScaleX;p+=(n+x)*this.lastScaleY;d=Math.ceil(d);p=Math.ceil(p);d=Math.min(d,xe.canvas.width);p=Math.min(p,xe.canvas.height);var c=d+o*2+1;var u=p+o*2+1;if(l){c=Math.max(c,l[0]+l[2]+1);u=Math.max(u,l[1]+l[3]+1)}_.clearRect(0,0,c,u);_.save();_.textBaseline="middle";if(o>0){_.strokeStyle=a;_.lineWidth=o;_.strokeText(t,s,n+h/2)}if(i){_.fillStyle=i;_.fillText(t,s,n+h/2)}if(this.showDbgInfo){_.strokeStyle="#ff0000";_.strokeRect(1,1,d-2,p-2);_.strokeStyle="#00ff00";_.strokeRect(s,n,r.width,r.height)}if(l){if(l[2]==-1)l[2]=Math.ceil((r.width+o*2)*this.lastScaleX)}var y=l?_.getImageData(l[0],l[1],l[2],l[3]):_.getImageData(0,0,d,p);_.restore();r.bmpWidth=y.width;r.bmpHeight=y.height;return y}getCharCanvas(t,e,o,i,a,r,s,n,b,x){var l=this.ctx;if(l.font!=e){l.font=e;l._lastFont=e}r.width=l.measureText(t).width;var _=r.width*this.lastScaleX;var h=r.height*this.lastScaleY;_+=(s+b)*this.lastScaleX;h+=(n+x)*this.lastScaleY+1;_=Math.min(_,this.maxTexW);h=Math.min(h,this.maxTexH);xe.canvas.width=Math.min(_+1,this.maxTexW);xe.canvas.height=Math.min(h+1,this.maxTexH);l.font=e;l.clearRect(0,0,_+1+o,h+1+o);l.setTransform(1,0,0,1,0,0);l.save();if(this.scaleFontSize){l.scale(this.lastScaleX,this.lastScaleY)}l.translate(s,n);l.textAlign="left";var d=this.fontsz;l.textBaseline="middle";if(o>0){l.strokeStyle=a;l.fillStyle=i;l.lineWidth=o;if(l.fillAndStrokeText){l.fillAndStrokeText(t,0,d/2)}else{l.strokeText(t,0,d/2);l.fillText(t,0,d/2)}}else if(i){l.fillStyle=i;l.fillText(t,0,d/2)}if(this.showDbgInfo){l.strokeStyle="#ff0000";l.strokeRect(0,0,_,h);l.strokeStyle="#00ff00";l.strokeRect(0,0,r.width,r.height)}l.restore();r.bmpWidth=xe.canvas.width;r.bmpHeight=xe.canvas.height;return xe.canvas}}xe.canvas=null;class le extends be{constructor(){super();this.lastFont=""}getWidth(t,e){if(!window.conchTextCanvas)return 0;window.conchTextCanvas.font=t;this.lastFont=t;return window.conchTextCanvas.measureText(e).width}scale(t,e){}getCharBmp(t,e,o,i,a,r,s,n,b,x,l=null){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=e;this.lastFont=e;var _=r.width=window.conchTextCanvas.measureText(t).width;var h=r.height;_+=s+b;h+=n+x;var d=g.create(a);var p=d.numColor;var c=g.create(i);var u=c.numColor;var y=window.conchTextCanvas.getTextBitmapData(t,u,o>2?2:o,p);r.bmpWidth=y.width;r.bmpHeight=y.height;return y}}class V{constructor(){this.fontSizeInfo={};this.charRender=null;this.mapFont={};this.fontID=0;this.mapColor=[];this.colorID=0;this.fontScaleX=1;this.fontScaleY=1;this._curStrPos=0;this.textAtlases=[];this.isoTextures=[];this.lastFont=null;this.fontSizeW=0;this.fontSizeH=0;this.fontSizeOffX=0;this.fontSizeOffY=0;this.renderPerChar=true;this.tmpAtlasPos=new K;this.textureMem=0;T.TextAtlas=ie;var t=false;var e=T.Laya["MiniAdpter"];if(e&&e.systemInfo&&e.systemInfo.system){t=e.systemInfo.system.toLowerCase()==="ios 10.1.1"}if(T.Browser.onMiniGame&&!t)V.isWan1Wan=true;this.charRender=T.Render.isConchApp?new le:new xe(V.atlasWidth,V.atlasWidth,V.scaleFontWithCtx,!V.isWan1Wan,false);V.textRenderInst=this;T.Laya["textRender"]=this;V.atlasWidth2=V.atlasWidth*V.atlasWidth}setFont(t){if(this.lastFont==t)return;this.lastFont=t;var e=this.getFontSizeInfo(t._family);var o=e>>24;var i=e>>16&255;var a=e>>8&255;var r=e&255;var s=t._size/V.standardFontSize;this.fontSizeOffX=Math.ceil(o*s);this.fontSizeOffY=Math.ceil(i*s);this.fontSizeW=Math.ceil(a*s);this.fontSizeH=Math.ceil(r*s);if(t._font.indexOf("italic")>=0){this.fontStr=t._font.replace("italic","")}else{this.fontStr=t._font}}getNextChar(t){var e=t.length;var o=this._curStrPos;if(o>=e)return null;var i=o;var a=0;for(;i<e;i++){var r=t.charCodeAt(i);if(r>>>11==27){if(a==1)break;a=1;i++}else if(r===65038||r===65039);else if(r==8205){a=2}else{if(a==0)a=1;else if(a==1)break}}this._curStrPos=i;return t.substring(o,i)}filltext(t,e,o,i,a,r,s,n,b,x=0){if(e.length<=0)return;var l=re.Parse(a);var _=0;switch(b){case"center":_=T.Context.ENUM_TEXTALIGN_CENTER;break;case"right":_=T.Context.ENUM_TEXTALIGN_RIGHT;break}this._fast_filltext(t,e,null,o,i,l,r,s,n,_,x)}fillWords(t,e,o,i,a,r,s,n){if(!e)return;if(e.length<=0)return;var b=re.Parse(a);this._fast_filltext(t,null,e,o,i,b,r,s,n,0,0)}_fast_filltext(t,e,o,i,a,r,s,n,b,x,l=0){if(e&&e.length<1)return;if(o&&o.length<1)return;if(b<0)b=0;this.setFont(r);this.fontScaleX=this.fontScaleY=1;if(!T.Render.isConchApp&&V.scaleFontWithCtx){var _=1;var h=1;if(T.Render.isConchApp){_=t._curMat.getScaleX();h=t._curMat.getScaleY()}else{_=t.getMatScaleX();h=t.getMatScaleY()}if(_<1e-4||h<.1)return;if(_>1)this.fontScaleX=_;if(h>1)this.fontScaleY=h}r._italic&&(t._italicDeg=13);var d=e;var p=!o&&e instanceof se;var c=e;var u=!!o;var y=p?d.pageChars:[];var m=0;if(p){c=d._text;m=d.width;if(m<0){m=d.width=this.charRender.getWidth(this.fontStr,c)}}else{m=c?this.charRender.getWidth(this.fontStr,c):0}switch(x){case T.Context.ENUM_TEXTALIGN_CENTER:i-=m/2;break;case T.Context.ENUM_TEXTALIGN_RIGHT:i-=m;break}if(d&&y){if(this.hasFreedText(y)){y=d.pageChars=[]}}var f=null;var g=this.renderPerChar=!p||V.forceSplitRender||u||p&&d.splitRender;if(!y||y.length<1){if(g){var v=0;var S=0;this._curStrPos=0;var C;while(true){if(u){var P=o[this._curStrPos++];if(P){C=P.char;v=P.x;S=P.y}else{C=null}}else{C=this.getNextChar(c)}if(!C)break;f=this.getCharRenderInfo(C,r,s,n,b,false);if(!f){break}if(f.isSpace);else{var A=y[f.tex.id];if(!A){var B={texgen:f.tex.genID,tex:f.tex,words:[]};y[f.tex.id]=B;A=B.words}else{A=A.words}if(T.Render.isConchApp){A.push({ri:f,x:v,y:S,w:f.bmpWidth/this.fontScaleX,h:f.bmpHeight/this.fontScaleY})}else{A.push({ri:f,x:v+1/this.fontScaleX,y:S,w:(f.bmpWidth-2)/this.fontScaleX,h:(f.bmpHeight-1)/this.fontScaleY})}v+=f.width}}}else{var w=V.noAtlas||m*this.fontScaleX>V.atlasWidth;f=this.getCharRenderInfo(c,r,s,n,b,w);if(T.Render.isConchApp){y[0]={texgen:f.tex.genID,tex:f.tex,words:[{ri:f,x:0,y:0,w:f.bmpWidth/this.fontScaleX,h:f.bmpHeight/this.fontScaleY}]}}else{y[0]={texgen:f.tex.genID,tex:f.tex,words:[{ri:f,x:1/this.fontScaleX,y:0/this.fontScaleY,w:(f.bmpWidth-2)/this.fontScaleX,h:(f.bmpHeight-1)/this.fontScaleY}]}}}}this._drawResortedWords(t,i,a,y);t._italicDeg=0}_drawResortedWords(e,o,i,t){var a=e._charSubmitCache&&e._charSubmitCache._enbale;var r=e._curMat;var s=t.length;for(var n=0;n<s;n++){var b=t[n];if(!b)continue;var x=b.words;var l=x.length;if(l<=0)continue;var _=t[n].tex;for(var h=0;h<l;h++){var d=x[h];var p=d.ri;if(p.isSpace)continue;p.touch();e.drawTexAlign=true;if(T.Render.isConchApp){e._drawTextureM(_.texture,o+d.x-p.orix,i+d.y-p.oriy,d.w,d.h,null,1,p.uv)}else{let t=_;e._inner_drawTexture(t.texture,t.id,o+d.x-p.orix,i+d.y-p.oriy,d.w,d.h,r,p.uv,1,a)}if(e.touches){e.touches.push(p)}}}}hasFreedText(t){var e=t.length;for(var o=0;o<e;o++){var i=t[o];if(!i)continue;var a=i.tex;if(a.__destroyed||a.genID!=i.texgen){return true}}return false}getCharRenderInfo(t,e,o,i,a,r=false){var s=this.mapFont[e._family];if(s==undefined){this.mapFont[e._family]=s=this.fontID++}var n=t+"_"+s+"_"+e._size+"_"+o;if(a>0)n+="_"+i+a;if(e._bold)n+="P";if(this.fontScaleX!=1||this.fontScaleY!=1){n+=(this.fontScaleX*20|0)+"_"+(this.fontScaleY*20|0)}var b=0;var x=this.textAtlases.length;var l=null;var _=null;if(!r){for(b=0;b<x;b++){_=this.textAtlases[b];l=_.charMaps[n];if(l){l.touch();return l}}}l=new ne;this.charRender.scale(this.fontScaleX,this.fontScaleY);l.char=t;l.height=e._size;var h=T.Render.isConchApp?0:e._size/3|0;var d=null;var p=Math.ceil(this.charRender.getWidth(this.fontStr,t)*this.fontScaleX);if(p>this.charRender.canvasWidth){this.charRender.canvasWidth=Math.min(2048,p+h*2)}if(r){this.charRender.fontsz=e._size;d=this.charRender.getCharBmp(t,this.fontStr,a,o,i,l,h,h,h,h,null);var c=C.getTextTexture(d.width,d.height);c.addChar(d,0,0,l.uv);l.tex=c;l.orix=h;l.oriy=h;c.ri=l;this.isoTextures.push(c)}else{var u=t.length;var y=a*1;var m=Math.ceil((this.fontSizeW+y*2)*this.fontScaleX);var f=Math.ceil((this.fontSizeH+y*2)*this.fontScaleY);V.imgdtRect[0]=(h-this.fontSizeOffX-y)*this.fontScaleX|0;V.imgdtRect[1]=(h-this.fontSizeOffY-y)*this.fontScaleY|0;if(this.renderPerChar||u==1){V.imgdtRect[2]=Math.max(p,m);V.imgdtRect[3]=Math.max(p,f)}else{V.imgdtRect[2]=-1;V.imgdtRect[3]=f}this.charRender.fontsz=e._size;d=this.charRender.getCharBmp(t,this.fontStr,a,o,i,l,h,h,h,h,V.imgdtRect);_=this.addBmpData(d,l);if(V.isWan1Wan){l.orix=h;l.oriy=h}else{l.orix=this.fontSizeOffX+y;l.oriy=this.fontSizeOffY+y}_.charMaps[n]=l}return l}addBmpData(t,e){var o=t.width;var i=t.height;var a=this.textAtlases.length;var r=null;var s=false;for(var n=0;n<a;n++){r=this.textAtlases[n];s=r.getAEmpty(o,i,this.tmpAtlasPos);if(s){break}}if(!s){r=new ie;this.textAtlases.push(r);s=r.getAEmpty(o,i,this.tmpAtlasPos);if(!s){throw"err1"}this.cleanAtlases()}if(s){r.texture.addChar(t,this.tmpAtlasPos.x,this.tmpAtlasPos.y,e.uv);e.tex=r.texture}return r}GC(){var t=0;var e=this.textAtlases.length;var o=0;var i=V.destroyAtlasDt;var a=0;var r=0;var s=Tt.loopCount;var n=-1;var b=0;var x=null;var l=null;for(;t<e;t++){l=this.textAtlases[t];x=l.texture;if(x){a+=x.curUsedCovRate;r+=x.curUsedCovRateAtlas;var _=l.usedRate-x.curUsedCovRateAtlas;if(b<_){b=_;n=t}}o=s-l.texture.lastTouchTm;if(o>i){V.showLog&&console.log("TextRender GC delete atlas "+x?l.texture.id:"unk");l.destroy();this.textAtlases[t]=this.textAtlases[e-1];e--;t--;n=-1}}this.textAtlases.length=e;e=this.isoTextures.length;for(t=0;t<e;t++){x=this.isoTextures[t];o=s-x.lastTouchTm;if(o>V.destroyUnusedTextureDt){x.ri.deleted=true;x.ri.tex=null;x.destroy();this.isoTextures[t]=this.isoTextures[e-1];e--;t--}}this.isoTextures.length=e;var h=this.textAtlases.length>1&&this.textAtlases.length-r>=2;if(V.atlasWidth*V.atlasWidth*4*this.textAtlases.length>V.cleanMem||h||V.simClean){V.simClean=false;V.showLog&&console.log("清理使用率低的贴图。总使用率:",r,":",this.textAtlases.length,"最差贴图:"+n);if(n>=0){l=this.textAtlases[n];l.destroy();this.textAtlases[n]=this.textAtlases[this.textAtlases.length-1];this.textAtlases.length=this.textAtlases.length-1}}C.clean()}cleanAtlases(){}getCharBmp(t){}checkBmpLine(t,e,o,i){if(this.bmpData32.buffer!=t.data.buffer){this.bmpData32=new Uint32Array(t.data.buffer)}var a=t.width*e+o;for(var r=o;r<i;r++){if(this.bmpData32[a++]!=0)return true}return false}updateBbx(t,e,o=false){var i=t.width;var a=t.height;var r=0;var s=e[1];var n=0;var b=s;if(this.checkBmpLine(t,s,0,i)){while(true){b=(s+n)/2|0;if(b+1>=s){e[1]=b;break}if(this.checkBmpLine(t,b,0,i)){s=b}else{n=b}}}if(e[3]>a)e[3]=a;else{b=s=e[3];n=a;if(this.checkBmpLine(t,s,0,i)){while(true){b=(s+n)/2|0;if(b-1<=s){e[3]=b;break}if(this.checkBmpLine(t,b,0,i)){s=b}else{n=b}}}}if(o)return;var x=e[0];var l=i*e[1];for(b=e[1];b<e[3];b++){for(r=0;r<x;r++){if(this.bmpData32[l+r]!=0){x=r;break}}l+=i}e[0]=x;var _=e[2];l=i*e[1];for(b=e[1];b<e[3];b++){for(r=_;r<i;r++){if(this.bmpData32[l+r]!=0){_=r;break}}l+=i}e[2]=_}getFontSizeInfo(t){var e=this.fontSizeInfo[t];if(e!=undefined)return e;var o="bold "+V.standardFontSize+"px "+t;if(V.isWan1Wan){this.fontSizeW=this.charRender.getWidth(o,"有")*1.5;this.fontSizeH=V.standardFontSize*1.5;var i=this.fontSizeW<<8|this.fontSizeH;this.fontSizeInfo[t]=i;return i}V.pixelBBX[0]=V.standardFontSize/2;V.pixelBBX[1]=V.standardFontSize/2;V.pixelBBX[2]=V.standardFontSize;V.pixelBBX[3]=V.standardFontSize;var a=16;var r=16;var s=16;var n=16;this.charRender.scale(1,1);V.tmpRI.height=V.standardFontSize;this.charRender.fontsz=V.standardFontSize;var b=this.charRender.getCharBmp("g",o,0,"red",null,V.tmpRI,a,r,s,n);if(T.Render.isConchApp){b.data=new Uint8ClampedArray(b.data)}this.bmpData32=new Uint32Array(b.data.buffer);this.updateBbx(b,V.pixelBBX,false);b=this.charRender.getCharBmp("有",o,0,"red",null,V.tmpRI,r,r,s,n);if(T.Render.isConchApp){b.data=new Uint8ClampedArray(b.data)}this.bmpData32=new Uint32Array(b.data.buffer);if(V.pixelBBX[2]<a+V.tmpRI.width)V.pixelBBX[2]=a+V.tmpRI.width;this.updateBbx(b,V.pixelBBX,false);if(T.Render.isConchApp){a=0;r=0}var x=Math.max(a-V.pixelBBX[0],0);var l=Math.max(r-V.pixelBBX[1],0);var _=V.pixelBBX[2]-V.pixelBBX[0];var h=V.pixelBBX[3]-V.pixelBBX[1];var d=x<<24|l<<16|_<<8|h;this.fontSizeInfo[t]=d;return d}printDbgInfo(){console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+V.atlasWidth+"x"+V.atlasWidth," 用canvas:",V.isWan1Wan);console.log("图集占用空间:"+V.atlasWidth*V.atlasWidth*4/1024/1024*this.textAtlases.length+"M");console.log("缓存用到的字体:");for(var t in this.mapFont){var e=this.getFontSizeInfo(t);var o=e>>24;var i=e>>16&255;var a=e>>8&255;var r=e&255;console.log("    "+t," off:",o,i," size:",a,r)}var s=0;console.log("缓存数据:");var n=0;var b=0;this.textAtlases.forEach(function(t){var e=t.texture.id;var o=Tt.loopCount-t.texture.lastTouchTm;var i=o>0?""+o+"帧以前":"当前帧";n+=t.texture.curUsedCovRate;b+=t.texture.curUsedCovRateAtlas;console.log("--图集(id:"+e+",当前使用率:"+(t.texture.curUsedCovRate*1e3|0)+"‰","当前图集使用率:",(t.texture.curUsedCovRateAtlas*100|0)+"%","图集使用率:",t.usedRate*100|0,"%, 使用于:"+i+")--:");for(var a in t.charMaps){var r=t.charMaps[a];console.log("     off:",r.orix,r.oriy," bmp宽高:",r.bmpWidth,r.bmpHeight,"无效:",r.deleted,"touchdt:",Tt.loopCount-r.touchTick,"位置:",r.uv[0]*V.atlasWidth|0,r.uv[1]*V.atlasWidth|0,"字符:",r.char,"key:",a);s++}});console.log("独立贴图文字("+this.isoTextures.length+"个):");this.isoTextures.forEach(function(t){console.log("    size:",t._texW,t._texH,"touch间隔:",Tt.loopCount-t.lastTouchTm,"char:",t.ri.char)});console.log("总缓存:",s,"总使用率:",n,"总当前图集使用率:",b)}showAtlas(t,o,e,i,a,r){if(!this.textAtlases[t]){console.log("没有这个图集");return null}var s=new T.Sprite;var n=this.textAtlases[t].texture;var b={width:V.atlasWidth,height:V.atlasWidth,sourceWidth:V.atlasWidth,sourceHeight:V.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return true},_addReference:function(){},_removeReference:function(){},_getSource:function(){return n._getSource()},bitmap:{id:n.id},_uv:ae.DEF_UV};s.size=function(t,e){this.width=t;this.height=e;s.graphics.clear();s.graphics.drawRect(0,0,s.width,s.height,o);s.graphics.drawTexture(b,0,0,s.width,s.height);return this};s.graphics.drawRect(0,0,a,r,o);s.graphics.drawTexture(b,0,0,a,r);s.pos(e,i);T.stage.addChild(s);return s}filltext_native(t,e,o,i,a,r,s,n,b,x,l=0){if(e&&e.length<=0)return;if(o&&o.length<1)return;var _=re.Parse(r);var h=0;switch(x){case"center":h=T.Context.ENUM_TEXTALIGN_CENTER;break;case"right":h=T.Context.ENUM_TEXTALIGN_RIGHT;break}return this._fast_filltext(t,e,o,i,a,_,s,n,b,h,l)}}V.useOldCharBook=false;V.atlasWidth=2048;V.noAtlas=false;V.forceSplitRender=false;V.forceWholeRender=false;V.scaleFontWithCtx=true;V.standardFontSize=32;V.destroyAtlasDt=10;V.checkCleanTextureDt=2e3;V.destroyUnusedTextureDt=3e3;V.cleanMem=100*1024*1024;V.isWan1Wan=false;V.showLog=false;V.debugUV=false;V.atlasWidth2=2048*2048;V.tmpRI=new ne;V.pixelBBX=[0,0,0,0];V.textRenderInst=null;V.imgdtRect=[0,0,0,0];V.simClean=false;C.gTextRender=V;class z{constructor(){this._tmpMatrix=new w;this._drawTexToDrawTri_Vert=new Float32Array(8);this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]);this._tempUV=new Float32Array(8);this._drawTriUseAbsMatrix=false;this._id=++z._COUNT;this._other=null;this._renderNextSubmitIndex=0;this._path=null;this._drawCount=1;this._width=z._MAXSIZE;this._height=z._MAXSIZE;this._renderCount=0;this._isConvexCmd=true;this._submits=null;this._curSubmit=null;this._submitKey=new bt;this._mesh=null;this._pathMesh=null;this._triangleMesh=null;this.meshlist=[];this._transedPoints=new Array(8);this._temp4Points=new Array(8);this._clipRect=z.MAXCLIPRECT;this._globalClipMatrix=new w(z._MAXSIZE,0,0,z._MAXSIZE,0,0);this._clipInCache=false;this._clipInfoID=0;this._clipID_Gen=0;this._curMat=null;this._lastMatScaleX=1;this._lastMatScaleY=1;this._lastMat_a=1;this._lastMat_b=0;this._lastMat_c=0;this._lastMat_d=1;this._nBlendType=0;this._save=null;this._targets=null;this._charSubmitCache=null;this._saveMark=null;this._shader2D=new Ht;this.sprite=null;this._italicDeg=0;this._lastTex=null;this._fillColor=0;this._flushCnt=0;this.defTexture=null;this._colorFiler=null;this.drawTexAlign=false;this._incache=false;this.isMain=false;z._contextcount++;z._textRender=z._textRender||new V;if(!this.defTexture){var t=new tt(2,2);t.setPixels(new Uint8Array(16));t.lock=true;this.defTexture=new ae(t)}this._lastTex=this.defTexture;this.clear()}static __init__(){z.MAXCLIPRECT=new B(0,0,z._MAXSIZE,z._MAXSIZE);_e.DEFAULT=new _e}drawImage(...t){}getImageData(...t){}measureText(t){return null}setTransform(...t){}$transform(t,e,o,i,a,r){}get lineJoin(){return null}set lineJoin(t){}get lineCap(){return null}set lineCap(t){}get miterLimit(){return null}set miterLimit(t){}clearRect(t,e,o,i){}_drawRect(t,e,o,i,a){m.renderBatches++;a&&(this.fillStyle=a);this.fillRect(t,e,o,i,null)}drawTexture2(t,e,o,i,a,r){}transformByMatrix(t,e,o){this.transform(t.a,t.b,t.c,t.d,t.tx+e,t.ty+o)}saveTransform(t){this.save()}restoreTransform(t){this.restore()}drawRect(t,e,o,i,a,r,s){var n=this;if(a!=null){n.fillStyle=a;n.fillRect(t,e,o,i)}if(r!=null){n.strokeStyle=r;n.lineWidth=s;n.strokeRect(t,e,o,i)}}alpha(t){this.globalAlpha*=t}_transform(t,e,o){this.translate(e,o);this.transform(t.a,t.b,t.c,t.d,t.tx,t.ty);this.translate(-e,-o)}_rotate(t,e,o){this.translate(e,o);this.rotate(t);this.translate(-e,-o)}_scale(t,e,o,i){this.translate(o,i);this.scale(t,e);this.translate(-o,-i)}_drawLine(t,e,o,i,a,r,s,n,b){this.beginPath();this.strokeStyle=s;this.lineWidth=n;this.moveTo(t+o,e+i);this.lineTo(t+a,e+r);this.stroke()}_drawLines(t,e,o,i,a,r){this.beginPath();this.strokeStyle=i;this.lineWidth=a;var s=o.length;this.addPath(o.slice(),false,false,t,e);this.stroke()}drawCurves(t,e,o,i,a){this.beginPath();this.strokeStyle=i;this.lineWidth=a;this.moveTo(t+o[0],e+o[1]);var r=2,s=o.length;while(r<s){this.quadraticCurveTo(t+o[r++],e+o[r++],t+o[r++],e+o[r++])}this.stroke()}_fillAndStroke(t,e,o,i=false){if(t!=null){this.fillStyle=t;this.fill()}if(e!=null&&o>0){this.strokeStyle=e;this.lineWidth=o;this.stroke()}}_drawCircle(t,e,o,i,a,r,s){m.renderBatches++;this.beginPath(true);this.arc(t,e,o,0,z.PI2);this.closePath();this._fillAndStroke(i,a,r)}_drawPie(t,e,o,i,a,r,s,n,b){this.beginPath();this.moveTo(t,e);this.arc(t,e,o,i,a);this.closePath();this._fillAndStroke(r,s,n)}_drawPoly(t,e,o,i,a,r,s,n){var b=o.length;this.beginPath();this.addPath(o.slice(),true,s,t,e);this.closePath();this._fillAndStroke(i,a,r,s)}_drawPath(t,e,o,i,a){this.beginPath();for(var r=0,s=o.length;r<s;r++){var n=o[r];switch(n[0]){case"moveTo":this.moveTo(t+n[1],e+n[2]);break;case"lineTo":this.lineTo(t+n[1],e+n[2]);break;case"arcTo":this.arcTo(t+n[1],e+n[2],t+n[3],e+n[4],n[5]);break;case"closePath":this.closePath();break}}if(i!=null){this.fillStyle=i.fillStyle;this.fill()}if(a!=null){this.strokeStyle=a.strokeStyle;this.lineWidth=a.lineWidth||1;this.lineJoin=a.lineJoin;this.lineCap=a.lineCap;this.miterLimit=a.miterLimit;this.stroke()}}static set2DRenderConfig(){var t=c.instance;u.setBlend(t,true);u.setBlendFunc(t,t.ONE,t.ONE_MINUS_SRC_ALPHA);u.setDepthTest(t,false);u.setCullFace(t,false);u.setDepthMask(t,true);u.setFrontFace(t,t.CCW);t.viewport(0,0,x.width,x.height)}clearBG(t,e,o,i){var a=u.mainContext;a.clearColor(t,e,o,i);a.clear(a.COLOR_BUFFER_BIT)}_getSubmits(){return this._submits}_releaseMem(t=false){if(!this._submits)return;this._curMat.destroy();this._curMat=null;this._shader2D.destroy();this._shader2D=null;this._charSubmitCache.clear();for(var e=0,o=this._submits._length;e<o;e++){this._submits[e].releaseRender()}this._submits.length=0;this._submits._length=0;this._submits=null;this._curSubmit=null;this._path=null;this._save=null;var i;for(e=0,i=this.meshlist.length;e<i;e++){var a=this.meshlist[e];a.destroy()}this.meshlist.length=0;this.sprite=null;if(!t){this._targets&&this._targets.destroy();this._targets=null}}destroy(t=false){--z._contextcount;this.sprite=null;this._releaseMem(t);this._charSubmitCache.destroy();this._mesh.destroy();if(!t){this._targets&&this._targets.destroy();this._targets=null}}clear(){if(!this._submits){this._other=_e.DEFAULT;this._curMat=w.create();this._charSubmitCache=new ee;this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(this._mesh);this._pathMesh=Jt.getAMesh(this.isMain);this.meshlist.push(this._pathMesh);this._triangleMesh=Ft.getAMesh(this.isMain);this.meshlist.push(this._triangleMesh);this._submits=[];this._save=[At.Create(this)];this._save.length=10;this._shader2D=new Ht}this._submitKey.clear();this._mesh.clearVB();this._renderCount++;this._drawCount=1;this._other=_e.DEFAULT;this._other.lineWidth=this._shader2D.ALPHA=1;this._nBlendType=0;this._clipRect=z.MAXCLIPRECT;this._curSubmit=A.RENDERBASE;A.RENDERBASE._ref=16777215;A.RENDERBASE._numEle=0;this._shader2D.fillStyle=this._shader2D.strokeStyle=vt.DEFAULT;for(var t=0,e=this._submits._length;t<e;t++)this._submits[t].releaseRender();this._submits._length=0;this._curMat.identity();this._other.clear();this._saveMark=this._save[0];this._save._length=1}size(t,e){if(this._width!=t||this._height!=e){this._width=t;this._height=e;if(this._targets){this._targets.destroy();this._targets=new ot(t,e,v.FORMAT_R8G8B8A8,-1)}if(this.isMain){u.mainContext.viewport(0,0,t,e);x.width=t;x.height=e}}if(t===0&&e===0)this._releaseMem()}set asBitmap(t){if(t){this._targets||(this._targets=new ot(this._width,this._height,v.FORMAT_R8G8B8A8,-1));if(!this._width||!this._height)throw Error("asBitmap no size!")}else{this._targets&&this._targets.destroy();this._targets=null}}getMatScaleX(){if(this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b)return this._lastMatScaleX;this._lastMatScaleX=this._curMat.getScaleX();this._lastMat_a=this._curMat.a;this._lastMat_b=this._curMat.b;return this._lastMatScaleX}getMatScaleY(){if(this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d)return this._lastMatScaleY;this._lastMatScaleY=this._curMat.getScaleY();this._lastMat_c=this._curMat.c;this._lastMat_d=this._curMat.d;return this._lastMatScaleY}setFillColor(t){this._fillColor=t}getFillColor(){return this._fillColor}set fillStyle(t){if(!this._shader2D.fillStyle.equal(t)){b.save(this,b.TYPE_FILESTYLE,this._shader2D,false);this._shader2D.fillStyle=vt.create(t);this._submitKey.other=-this._shader2D.fillStyle.toInt()}}get fillStyle(){return this._shader2D.fillStyle}set globalAlpha(t){t=Math.floor(t*1e3)/1e3;if(t!=this._shader2D.ALPHA){b.save(this,b.TYPE_ALPHA,this._shader2D,false);this._shader2D.ALPHA=t}}get globalAlpha(){return this._shader2D.ALPHA}set textAlign(t){this._other.textAlign===t||(this._other=this._other.make(),b.save(this,b.TYPE_TEXTALIGN,this._other,false),this._other.textAlign=t)}get textAlign(){return this._other.textAlign}set textBaseline(t){this._other.textBaseline===t||(this._other=this._other.make(),b.save(this,b.TYPE_TEXTBASELINE,this._other,false),this._other.textBaseline=t)}get textBaseline(){return this._other.textBaseline}set globalCompositeOperation(t){var e=I.TOINT[t];e==null||this._nBlendType===e||(b.save(this,b.TYPE_GLOBALCOMPOSITEOPERATION,this,true),this._curSubmit=A.RENDERBASE,this._nBlendType=e)}get globalCompositeOperation(){return I.NAMES[this._nBlendType]}set strokeStyle(t){this._shader2D.strokeStyle.equal(t)||(b.save(this,b.TYPE_STROKESTYLE,this._shader2D,false),this._shader2D.strokeStyle=vt.create(t),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}get strokeStyle(){return this._shader2D.strokeStyle}translate(t,e){if(t!==0||e!==0){wt.save(this);if(this._curMat._bTransform){Bt.save(this);this._curMat.tx+=t*this._curMat.a+e*this._curMat.c;this._curMat.ty+=t*this._curMat.b+e*this._curMat.d}else{this._curMat.tx=t;this._curMat.ty=e}}}set lineWidth(t){this._other.lineWidth===t||(this._other=this._other.make(),b.save(this,b.TYPE_LINEWIDTH,this._other,false),this._other.lineWidth=t)}get lineWidth(){return this._other.lineWidth}save(){this._save[this._save._length++]=At.Create(this)}restore(){var t=this._save._length;var e=this._nBlendType;if(t<1)return;for(var o=t-1;o>=0;o--){var i=this._save[o];i.restore(this);if(i.isSaveMark()){this._save._length=o;return}}if(e!=this._nBlendType){this._curSubmit=A.RENDERBASE}}set font(t){this._other=this._other.make();b.save(this,b.TYPE_FONT,this._other,false)}fillText(t,e,o,i,a,r){this._fillText(t,null,e,o,i,a,null,0,null)}_fillText(t,e,o,i,a,r,s,n,b,x=0){if(t)z._textRender.filltext(this,t,o,i,a,r,s,n,b,x);else if(e)z._textRender.fillWords(this,e,o,i,a,r,s,n)}_fast_filltext(t,e,o,i,a,r,s,n,b=0){z._textRender._fast_filltext(this,t,null,e,o,i,a,r,s,n,b)}fillWords(t,e,o,i,a){this._fillText(null,t,e,o,i,a,null,-1,null,0)}fillBorderWords(t,e,o,i,a,r,s){this._fillBorderText(null,t,e,o,i,a,r,s,null)}drawText(t,e,o,i,a,r){this._fillText(t,null,e,o,i,g.create(a).strColor,null,-1,r)}strokeWord(t,e,o,i,a,r,s){this._fillText(t,null,e,o,i,null,g.create(a).strColor,r||1,s)}fillBorderText(t,e,o,i,a,r,s,n){this._fillBorderText(t,null,e,o,i,g.create(a).strColor,g.create(r).strColor,s,n)}_fillBorderText(t,e,o,i,a,r,s,n,b){this._fillText(t,e,o,i,a,r,s,n||1,b)}_fillRect(t,e,o,i,a){var r=this._curSubmit;var s=r&&(r._key.submitType===A.KEY_DRAWTEXTURE&&r._key.blendShader===this._nBlendType);if(this._mesh.vertNum+4>z._MAXVERTNUM){this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(this._mesh);s=false}s&&(s=s&&this.isSameClipInfo(r));this.transformQuad(t,e,o,i,0,this._curMat,this._transedPoints);if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,ae.NO_UV,a,false);if(!s){r=this._curSubmit=te.create(this,this._mesh,nt.create(D.TEXTURE2D,0));this._submits[this._submits._length++]=r;this._copyClipInfo(r,this._globalClipMatrix);r.shaderValue.textureHost=this._lastTex;r._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1;r._renderType=A.TYPE_TEXTURE}this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4}}fillRect(t,e,o,i,a){var r=a?vt.create(a):this._shader2D.fillStyle;var s=this.mixRGBandAlpha(r.toInt());this._fillRect(t,e,o,i,s)}fillTexture(t,e,o,i,a,r,s,n){if(!t._getSource()){this.sprite&&T.systemTimer.callLater(this,this._repaintSprite);return}this._fillTexture(t,t.width,t.height,t.uvrect,e,o,i,a,r,s.x,s.y)}_fillTexture(t,e,o,i,a,r,s,n,b,x,l){var _=this._curSubmit;if(this._mesh.vertNum+4>z._MAXVERTNUM){this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(this._mesh)}var h=true;var d=true;switch(b){case"repeat":break;case"repeat-x":d=false;break;case"repeat-y":h=false;break;case"no-repeat":h=d=false;break;default:break}var p=this._temp4Points;var c=0;var u=0;var y=0,m=0,f=0,g=0;if(x<0){y=a;c=-x%e/e}else{y=a+x}if(l<0){m=r;u=-l%o/o}else{m=r+l}f=a+s;g=r+n;!h&&(f=Math.min(f,a+x+e));!d&&(g=Math.min(g,r+l+o));if(f<a||g<r)return;if(y>f||m>g)return;var v=(f-a-x)/e;var S=(g-r-l)/o;this.transformQuad(y,m,f-y,g-m,0,this._curMat,this._transedPoints);p[0]=c;p[1]=u;p[2]=v;p[3]=u;p[4]=v;p[5]=S;p[6]=c;p[7]=S;if(!this.clipedOff(this._transedPoints)){var C=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA);this._mesh.addQuad(this._transedPoints,p,C,true);var P=nt.create(D.TEXTURE2D,0);P.defines.add(D.FILLTEXTURE);P.u_TexRange=i;_=this._curSubmit=te.create(this,this._mesh,P);this._submits[this._submits._length++]=_;this._copyClipInfo(_,this._globalClipMatrix);_.shaderValue.textureHost=t;_._renderType=A.TYPE_TEXTURE;this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4}this.breakNextMerge()}setColorFilter(t){b.save(this,b.TYPE_COLORFILTER,this,true);this._colorFiler=t;this._curSubmit=A.RENDERBASE}drawTexture(t,e,o,i,a){this._drawTextureM(t,e,o,i,a,null,1,null)}drawTextures(t,e,o,i){if(!t._getSource()){this.sprite&&T.systemTimer.callLater(this,this._repaintSprite);return}var a=e.length/2;var r=0;var s=t.bitmap.id;for(var n=0;n<a;n++){this._inner_drawTexture(t,s,e[r++]+o,e[r++]+i,0,0,null,null,1,false)}}_drawTextureAddSubmit(t,e){var o=null;o=te.create(this,this._mesh,nt.create(D.TEXTURE2D,0));this._submits[this._submits._length++]=o;o.shaderValue.textureHost=e;o._key.other=t;o._renderType=A.TYPE_TEXTURE;this._curSubmit=o}_drawTextureM(t,e,o,i,a,r,s,n){var b=this.sprite;if(!t._getSource(function(){if(b){b.repaint()}})){return false}return this._inner_drawTexture(t,t.bitmap.id,e,o,i,a,r,n,s,false)}_drawRenderTexture(t,e,o,i,a,r,s,n){return this._inner_drawTexture(t,-1,e,o,i,a,r,n,1,false)}submitDebugger(){this._submits[this._submits._length++]=xt.create([],function(){debugger},this)}_copyClipInfo(t,e){var o=t.shaderValue.clipMatDir;o[0]=e.a;o[1]=e.b;o[2]=e.c;o[3]=e.d;var i=t.shaderValue.clipMatPos;i[0]=e.tx;i[1]=e.ty;t.clipInfoID=this._clipInfoID;if(this._clipInCache){t.shaderValue.clipOff[0]=1}}isSameClipInfo(t){return t.clipInfoID===this._clipInfoID}_useNewTex2DSubmit(t,e){if(this._mesh.vertNum+e>z._MAXVERTNUM){this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(this._mesh)}var o=te.create(this,this._mesh,nt.create(D.TEXTURE2D,0));this._submits[this._submits._length++]=this._curSubmit=o;o.shaderValue.textureHost=t;this._copyClipInfo(o,this._globalClipMatrix)}_drawTexRect(t,e,o,i,a){this.transformQuad(t,e,o,i,this._italicDeg,this._curMat,this._transedPoints);var r=this._transedPoints;r[0]=r[0]+.5|0;r[1]=r[1]+.5|0;r[2]=r[2]+.5|0;r[3]=r[3]+.5|0;r[4]=r[4]+.5|0;r[5]=r[5]+.5|0;r[6]=r[6]+.5|0;r[7]=r[7]+.5|0;if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,a,this._fillColor,true);this._curSubmit._numEle+=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4}}drawCallOptimize(t){this._charSubmitCache.enable(t,this);return t}_inner_drawTexture(t,e,o,i,a,r,s,n,b,x){var l=this._curSubmit._key;n=n||t._uv;if(l.submitType===A.KEY_TRIANGLES&&l.other===e){var _=this._drawTexToDrawTri_Vert;_[0]=o;_[1]=i;_[2]=o+a,_[3]=i,_[4]=o+a,_[5]=i+r,_[6]=o,_[7]=i+r;this._drawTriUseAbsMatrix=true;var h=this._tempUV;h[0]=n[0];h[1]=n[1];h[2]=n[2];h[3]=n[3];h[4]=n[4];h[5]=n[5];h[6]=n[6];h[7]=n[7];this.drawTriangles(t,0,0,_,h,this._drawTexToDrawTri_Index,s,b,null,null);this._drawTriUseAbsMatrix=false;return true}var d=this._mesh;var p=this._curSubmit;var c=x?this._charSubmitCache.getPos():this._transedPoints;this.transformQuad(o,i,a||t.width,r||t.height,this._italicDeg,s||this._curMat,c);if(this.drawTexAlign){var u=Math.round;c[0]=u(c[0]);c[1]=u(c[1]);c[2]=u(c[2]);c[3]=u(c[3]);c[4]=u(c[4]);c[5]=u(c[5]);c[6]=u(c[6]);c[7]=u(c[7]);this.drawTexAlign=false}var y=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*b);if(x){this._charSubmitCache.add(this,t,e,c,n,y);return true}this._drawCount++;var m=e>=0&&l.submitType===A.KEY_DRAWTEXTURE&&l.other===e;m&&(m=m&&this.isSameClipInfo(p));this._lastTex=t;if(d.vertNum+4>z._MAXVERTNUM){d=this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(d);m=false}{d.addQuad(c,n,y,true);if(!m){this._submits[this._submits._length++]=this._curSubmit=p=te.create(this,d,nt.create(D.TEXTURE2D,0));p.shaderValue.textureHost=t;p._key.other=e;this._copyClipInfo(p,this._globalClipMatrix)}p._numEle+=6;d.indexNum+=6;d.vertNum+=4;return true}return false}transform4Points(t,e,o){var i=e.tx;var a=e.ty;var r=e.a;var s=e.b;var n=e.c;var b=e.d;var x=t[0];var l=t[1];var _=t[2];var h=t[3];var d=t[4];var p=t[5];var c=t[6];var u=t[7];if(e._bTransform){o[0]=x*r+l*n+i;o[1]=x*s+l*b+a;o[2]=_*r+h*n+i;o[3]=_*s+h*b+a;o[4]=d*r+p*n+i;o[5]=d*s+p*b+a;o[6]=c*r+u*n+i;o[7]=c*s+u*b+a}else{o[0]=x+i;o[1]=l+a;o[2]=_+i;o[3]=h+a;o[4]=d+i;o[5]=p+a;o[6]=c+i;o[7]=u+a}}clipedOff(t){if(this._clipRect.width<=0||this._clipRect.height<=0)return true;return false}transformQuad(t,e,o,i,a,r,s){var n=0;if(a!=0){n=Math.tan(a*Math.PI/180)*i}var b=t+o;var x=e+i;var l=r.tx;var _=r.ty;var h=r.a;var d=r.b;var p=r.c;var c=r.d;var u=t+n;var y=e;var m=b+n;var f=e;var g=b;var v=x;var S=t;var C=x;if(r._bTransform){s[0]=u*h+y*p+l;s[1]=u*d+y*c+_;s[2]=m*h+f*p+l;s[3]=m*d+f*c+_;s[4]=g*h+v*p+l;s[5]=g*d+v*c+_;s[6]=S*h+C*p+l;s[7]=S*d+C*c+_}else{s[0]=u+l;s[1]=y+_;s[2]=m+l;s[3]=f+_;s[4]=g+l;s[5]=v+_;s[6]=S+l;s[7]=C+_}}pushRT(){this.addRenderObject(xt.create(null,ot.pushRT,this))}popRT(){this.addRenderObject(xt.create(null,ot.popRT,this));this.breakNextMerge()}useRT(t){function e(t){if(!t){throw"error useRT"}else{t.start();t.clear(0,0,0,0)}}this.addRenderObject(xt.create([t],e,this));this.breakNextMerge()}RTRestore(t){function e(t){t.restore()}this.addRenderObject(xt.create([t],e,this));this.breakNextMerge()}breakNextMerge(){this._curSubmit=A.RENDERBASE}_repaintSprite(){this.sprite&&this.sprite.repaint()}drawTextureWithTransform(t,e,o,i,a,r,s,n,b,x,l=null,_){var h=null;var d=this._curMat;if(x){h=this.globalCompositeOperation;this.globalCompositeOperation=x}var p=this._colorFiler;if(l){this.setColorFilter(l)}if(!r){this._drawTextureM(t,e+s,o+n,i,a,d,b,_);if(x){this.globalCompositeOperation=h}if(l){this.setColorFilter(p)}return}var c=this._tmpMatrix;c.a=r.a;c.b=r.b;c.c=r.c;c.d=r.d;c.tx=r.tx+s;c.ty=r.ty+n;c._bTransform=r._bTransform;if(r&&d._bTransform){w.mul(c,d,c);r=c;r._bTransform=true}else{c.tx+=d.tx;c.ty+=d.ty;r=c}this._drawTextureM(t,e,o,i,a,r,b,_);if(x){this.globalCompositeOperation=h}if(l){this.setColorFilter(p)}}_flushToTarget(t,e){x.worldScissorTest=false;var o=c.instance;o.disable(o.SCISSOR_TEST);var i=x.worldAlpha;var a=x.worldMatrix4;var r=x.worldMatrix;x.worldMatrix=w.EMPTY;x.restoreTempArray();x.worldMatrix4=x.TEMPMAT4_ARRAY;x.worldAlpha=1;et.activeShader=null;e.start();if(t._submits._length>0)e.clear(0,0,0,0);t._curSubmit=A.RENDERBASE;t.flush();t.clear();e.restore();t._curSubmit=A.RENDERBASE;et.activeShader=null;x.worldAlpha=i;x.worldMatrix4=a;x.worldMatrix=r}drawCanvas(t,e,o,i,a){if(!t)return;var r=t.context;var s;if(r._targets){if(r._submits._length>0){s=xt.create([r,r._targets],this._flushToTarget,this);this._submits[this._submits._length++]=s}this._drawRenderTexture(r._targets,e,o,i,a,null,1,ot.flipyuv);this._curSubmit=A.RENDERBASE}else{var n=t;if(n.touches){n.touches.forEach(function(t){t.touch()})}s=Qt.create(t,this._shader2D.ALPHA,this._shader2D.filters);this._submits[this._submits._length++]=s;s._key.clear();var b=s._matrix;this._curMat.copyTo(b);var x=b.tx,l=b.ty;b.tx=b.ty=0;b.transformPoint(K.TEMP.setTo(e,o));b.translate(K.TEMP.x+x,K.TEMP.y+l);w.mul(n.invMat,b,b);this._curSubmit=A.RENDERBASE}}drawTarget(t,e,o,i,a,r,s,n=null,b=-1){this._drawCount++;if(this._mesh.vertNum+4>z._MAXVERTNUM){this._mesh=Gt.getAMesh(this.isMain);this.meshlist.push(this._mesh)}this.transformQuad(e,o,i,a,0,r||this._curMat,this._transedPoints);if(!this.clipedOff(this._transedPoints)){this._mesh.addQuad(this._transedPoints,n||ae.DEF_UV,4294967295,true);var x=this._curSubmit=$t.create(this,this._mesh,s,t);x.blendType=b==-1?this._nBlendType:b;this._copyClipInfo(x,this._globalClipMatrix);x._numEle=6;this._mesh.indexNum+=6;this._mesh.vertNum+=4;this._submits[this._submits._length++]=x;this._curSubmit=A.RENDERBASE;return true}this._curSubmit=A.RENDERBASE;return false}drawTriangles(t,e,o,i,a,r,s,n,b,x){if(!t._getSource()){if(this.sprite){T.systemTimer.callLater(this,this._repaintSprite)}return}this._drawCount++;var l=this._tmpMatrix;var _=this._triangleMesh;var h=null;var d=false;if(b){h=this._colorFiler;this._colorFiler=b;this._curSubmit=A.RENDERBASE;d=h!=b}var p=t.bitmap;var c=this._curSubmit._key;var u=c.submitType===A.KEY_TRIANGLES&&c.other===p.id&&c.blendShader==this._nBlendType;if(_.vertNum+i.length/2>z._MAXVERTNUM){_=this._triangleMesh=Ft.getAMesh(this.isMain);this.meshlist.push(_);u=false}if(!u){var y=this._curSubmit=te.create(this,_,nt.create(D.TEXTURE2D,0));y.shaderValue.textureHost=t;y._renderType=A.TYPE_TEXTURE;y._key.submitType=A.KEY_TRIANGLES;y._key.other=p.id;this._copyClipInfo(y,this._globalClipMatrix);this._submits[this._submits._length++]=y}var m=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*n);if(!this._drawTriUseAbsMatrix){if(!s){l.a=1;l.b=0;l.c=0;l.d=1;l.tx=e;l.ty=o}else{l.a=s.a;l.b=s.b;l.c=s.c;l.d=s.d;l.tx=s.tx+e;l.ty=s.ty+o}w.mul(l,this._curMat,l);_.addData(i,a,r,l,m)}else{_.addData(i,a,r,s,m)}this._curSubmit._numEle+=r.length;if(d){this._colorFiler=h;this._curSubmit=A.RENDERBASE}}transform(t,e,o,i,a,r){Bt.save(this);w.mul(w.TEMP.setTo(t,e,o,i,a,r),this._curMat,this._curMat);this._curMat._checkTransform()}_transformByMatrix(t,e,o){t.setTranslate(e,o);w.mul(t,this._curMat,this._curMat);t.setTranslate(0,0);this._curMat._bTransform=true}setTransformByMatrix(t){t.copyTo(this._curMat)}rotate(t){Bt.save(this);this._curMat.rotateEx(t)}scale(t,e){Bt.save(this);this._curMat.scaleEx(t,e)}clipRect(t,e,o,i){Pt.save(this);if(this._clipRect==z.MAXCLIPRECT){this._clipRect=new B(t,e,o,i)}else{this._clipRect.width=o;this._clipRect.height=i;this._clipRect.x=t;this._clipRect.y=e}this._clipID_Gen++;this._clipID_Gen%=1e4;this._clipInfoID=this._clipID_Gen;var a=this._globalClipMatrix;var r=a.tx;var s=a.ty;var n=r+a.a;var b=s+a.d;if(this._clipRect.width>=z._MAXSIZE){a.a=a.d=z._MAXSIZE;a.b=a.c=a.tx=a.ty=0}else{if(this._curMat._bTransform){a.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx;a.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty;a.a=this._clipRect.width*this._curMat.a;a.b=this._clipRect.width*this._curMat.b;a.c=this._clipRect.height*this._curMat.c;a.d=this._clipRect.height*this._curMat.d}else{a.tx=this._clipRect.x+this._curMat.tx;a.ty=this._clipRect.y+this._curMat.ty;a.a=this._clipRect.width;a.b=a.c=0;a.d=this._clipRect.height}if(this._incache){this._clipInCache=true}}if(a.a>0&&a.d>0){var x=a.tx+a.a;var l=a.ty+a.d;if(x<=r||l<=s||a.tx>=n||a.ty>=b){a.a=-.1;a.d=-.1}else{if(a.tx<r){a.a-=r-a.tx;a.tx=r}if(x>n){a.a-=x-n}if(a.ty<s){a.d-=s-a.ty;a.ty=s}if(l>b){a.d-=l-b}if(a.a<=0)a.a=-.1;if(a.d<=0)a.d=-.1}}}drawMesh(t,e,o,i,a,r,s,n,b=0){}addRenderObject(t){this._submits[this._submits._length++]=t}submitElement(t,e){var o=this.isMain;var i=this._submits;var a=i._length;e<0&&(e=i._length);var r=A.RENDERBASE;while(t<e){this._renderNextSubmitIndex=t+1;if(i[t]===A.RENDERBASE){t++;continue}A.preRender=r;r=i[t];t+=r.renderSubmit()}return a}flush(){this._clipID_Gen=0;var t=this.submitElement(0,this._submits._length);this._path&&this._path.reset();Yt.instance&&Yt.getInstance().reset();this._curSubmit=A.RENDERBASE;for(var e=0,o=this.meshlist.length;e<o;e++){var i=this.meshlist[e];i.canReuse?i.releaseMesh():i.destroy()}this.meshlist.length=0;this._mesh=Gt.getAMesh(this.isMain);this._pathMesh=Jt.getAMesh(this.isMain);this._triangleMesh=Ft.getAMesh(this.isMain);this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh);this._flushCnt++;if(this._flushCnt%60==0&&this.isMain){if(V.textRenderInst){V.textRenderInst.GC()}}return t}beginPath(t=false){var e=this._getPath();e.beginPath(t)}closePath(){this._path.closePath()}addPath(t,e,o,i,a){var r=0;for(var s=0,n=t.length/2;s<n;s++){var b=t[r]+i,x=t[r+1]+a;t[r]=b;t[r+1]=x;r+=2}this._getPath().push(t,o)}fill(){var t=this._curMat;var e=this._getPath();var o=this._curSubmit;var i=o._key.submitType===A.KEY_VG&&o._key.blendShader===this._nBlendType;i&&(i=i&&this.isSameClipInfo(o));if(!i){this._curSubmit=this.addVGSubmit(this._pathMesh)}var a=this.mixRGBandAlpha(this.fillStyle.toInt());var r=0;var s;for(var n=0,b=e.paths.length;n<b;n++){var x=e.paths[n];var l=x.path.length/2;if(l<3||l==3&&!x.convex)continue;var _=x.path.concat();var h=0;var d,p;var c,u;if(t._bTransform){for(h=0;h<l;h++){d=h<<1;p=d+1;c=_[d];u=_[p];_[d]=t.a*c+t.c*u+t.tx;_[p]=t.b*c+t.d*u+t.ty}}else{for(h=0;h<l;h++){d=h<<1;p=d+1;c=_[d];u=_[p];_[d]=c+t.tx;_[p]=u+t.ty}}if(this._pathMesh.vertNum+l>z._MAXVERTNUM){this._curSubmit._numEle+=r;r=0;this._pathMesh=Jt.getAMesh(this.isMain);this._curSubmit=this.addVGSubmit(this._pathMesh)}var y=this._pathMesh.vertNum;if(x.convex){var m=l-2;s=new Array(m*3);var f=0;for(var g=0;g<m;g++){s[f++]=y;s[f++]=g+1+y;s[f++]=g+2+y}}else{s=S.earcut(_,null,2);if(y>0){for(var v=0;v<s.length;v++){s[v]+=y}}}this._pathMesh.addVertAndIBToMesh(this,_,a,s);r+=s.length}this._curSubmit._numEle+=r}addVGSubmit(t){var e=Zt.createShape(this,t,0,nt.create(D.PRIMITIVE,0));e._key.submitType=A.KEY_VG;this._submits[this._submits._length++]=e;this._copyClipInfo(e,this._globalClipMatrix);return e}stroke(){if(this.lineWidth>0){var t=this.mixRGBandAlpha(this.strokeStyle._color.numColor);var e=this._getPath();var o=this._curSubmit;var i=o._key.submitType===A.KEY_VG&&o._key.blendShader===this._nBlendType;i&&(i=i&&this.isSameClipInfo(o));if(!i){this._curSubmit=this.addVGSubmit(this._pathMesh)}var a=0;for(var r=0,s=e.paths.length;r<s;r++){var n=e.paths[r];if(n.path.length<=0)continue;var b=[];var x=[];var l=n.path.length*2;if(l<2)continue;if(this._pathMesh.vertNum+l>z._MAXVERTNUM){this._curSubmit._numEle+=a;a=0;this._pathMesh=Jt.getAMesh(this.isMain);this.meshlist.push(this._pathMesh);this._curSubmit=this.addVGSubmit(this._pathMesh)}qt.createLine2(n.path,b,this.lineWidth,this._pathMesh.vertNum,x,n.loop);var _=x.length/2;var h=this._curMat;var d=0;var p,c;var u,y;if(h._bTransform){for(d=0;d<_;d++){p=d<<1;c=p+1;u=x[p];y=x[c];x[p]=h.a*u+h.c*y+h.tx;x[c]=h.b*u+h.d*y+h.ty}}else{for(d=0;d<_;d++){p=d<<1;c=p+1;u=x[p];y=x[c];x[p]=u+h.tx;x[c]=y+h.ty}}this._pathMesh.addVertAndIBToMesh(this,x,t,b);a+=b.length}this._curSubmit._numEle+=a}}moveTo(t,e){var o=this._getPath();o.newPath();o._lastOriX=t;o._lastOriY=e;o.addPoint(t,e)}lineTo(t,e){var o=this._getPath();if(Math.abs(t-o._lastOriX)<.001&&Math.abs(e-o._lastOriY)<.001)return;o._lastOriX=t;o._lastOriY=e;o.addPoint(t,e)}arcTo(t,e,G,F,o){var i=0;var a=0,r=0;var s=this._path._lastOriX-t;var n=this._path._lastOriY-e;var b=Math.sqrt(s*s+n*n);if(b<=1e-6){return}var x=s/b;var l=n/b;var _=G-t;var h=F-e;var J=_*_+h*h;var d=Math.sqrt(J);if(d<=1e-6){return}var p=_/d;var c=h/d;var u=x+p;var y=l+c;var m=Math.sqrt(u*u+y*y);if(m<=1e-6){return}var f=u/m;var g=y/m;var k=Math.acos(f*x+g*l);var v=Math.PI/2-k;b=o/Math.tan(v);var S=b*x+t;var C=b*l+e;var P=Math.sqrt(b*b+o*o);var A=t+f*P;var O=e+g*P;var N=x*c-l*p;var B=0;var w=0;var T=0;if(N>=0){B=v*2;var M=B/z.SEGNUM;w=Math.sin(M);T=Math.cos(M)}else{B=-v*2;M=B/z.SEGNUM;w=Math.sin(M);T=Math.cos(M)}var I=this._path._lastOriX,D=this._path._lastOriY;var L=S,E=C;if(Math.abs(L-this._path._lastOriX)>.1||Math.abs(E-this._path._lastOriY)>.1){a=L;r=E;I=L;D=E;this._path.addPoint(a,r)}var V=S-A;var R=C-O;for(i=0;i<z.SEGNUM;i++){var W=V*T+R*w;var U=-V*w+R*T;a=W+A;r=U+O;if(Math.abs(I-a)>.1||Math.abs(D-r)>.1){this._path.addPoint(a,r);I=a;D=r}V=W;R=U}}arc(t,e,o,i,a,r=false,s=true){var n=0,b=0;var x=0,l=0,_=0,h=0;var d,p;b=a-i;if(!r){if(Math.abs(b)>=Math.PI*2){b=Math.PI*2}else{while(b<0){b+=Math.PI*2}}}else{if(Math.abs(b)>=Math.PI*2){b=-Math.PI*2}else{while(b>0){b-=Math.PI*2}}}var c=this.getMatScaleX();var u=this.getMatScaleY();var y=o*(c>u?c:u);var m=2*Math.PI*y;p=Math.max(m/10,10)|0;var f=this._getPath();for(d=0;d<=p;d++){n=i+b*(d/p);x=Math.cos(n);l=Math.sin(n);_=t+x*o;h=e+l*o;if(_!=this._path._lastOriX||h!=this._path._lastOriY){f.addPoint(_,h)}}x=Math.cos(a);l=Math.sin(a);_=t+x*o;h=e+l*o;if(_!=this._path._lastOriX||h!=this._path._lastOriY){f.addPoint(_,h)}}quadraticCurveTo(t,e,o,i){var a=ft.I;var r=a.getBezierPoints([this._path._lastOriX,this._path._lastOriY,t,e,o,i],30,2);for(var s=0,n=r.length/2;s<n;s++){this.lineTo(r[s*2],r[s*2+1])}this.lineTo(o,i)}mixRGBandAlpha(t){return this._mixRGBandAlpha(t,this._shader2D.ALPHA)}_mixRGBandAlpha(t,e){if(e>=1){return t}var o=(t&4278190080)>>>24;if(o!=0){o*=e}else{o=e*255}return t&16777215|o<<24}strokeRect(t,e,o,i,a){if(this.lineWidth>0){var r=this.mixRGBandAlpha(this.strokeStyle._color.numColor);var s=this.lineWidth/2;this._fillRect(t-s,e-s,o+this.lineWidth,this.lineWidth,r);this._fillRect(t-s,e-s+i,o+this.lineWidth,this.lineWidth,r);this._fillRect(t-s,e+s,this.lineWidth,i-this.lineWidth,r);this._fillRect(t-s+o,e+s,this.lineWidth,i-this.lineWidth,r)}}clip(){}drawParticle(t,e,o){o.x=t;o.y=e;this._submits[this._submits._length++]=o}_getPath(){return this._path||(this._path=new St)}get canvas(){return this._canvas}_fillTexture_h(t,e,o,i,a,r,s,n){var b=r;var x=Math.floor(n/i);var l=n%i;for(var _=0;_<x;_++){this._inner_drawTexture(t,e,b,s,i,a,this._curMat,o,1,false);b+=i}if(l>0){var h=o[2]-o[0];var d=o[0]+h*(l/i);var p=z.tmpuv1;p[0]=o[0];p[1]=o[1];p[2]=d;p[3]=o[3];p[4]=d;p[5]=o[5];p[6]=o[6];p[7]=o[7];this._inner_drawTexture(t,e,b,s,l,a,this._curMat,p,1,false)}}_fillTexture_v(t,e,o,i,a,r,s,n){var b=s;var x=Math.floor(n/a);var l=n%a;for(var _=0;_<x;_++){this._inner_drawTexture(t,e,r,b,i,a,this._curMat,o,1,false);b+=a}if(l>0){var h=o[7]-o[1];var d=o[1]+h*(l/a);var p=z.tmpuv1;p[0]=o[0];p[1]=o[1];p[2]=o[2];p[3]=o[3];p[4]=o[4];p[5]=d;p[6]=o[6];p[7]=d;this._inner_drawTexture(t,e,r,b,i,l,this._curMat,p,1,false)}}drawTextureWithSizeGrid(t,e,o,i,a,r,s,n){if(!t._getSource())return;e+=s;o+=n;var b=t.uv,x=t.bitmap.width,l=t.bitmap.height;var _=r[0];var h=r[3];var d=_/l;var p=h/x;var c=r[1];var u=r[2];var y=c/x;var m=u/l;var f=r[4];var g=false;if(i==x){h=c=0}if(a==l){_=u=0}if(h+c>i){var v=i;g=true;i=h+c;this.save();this.clipRect(0+e,0+o,v,a)}var S=t.bitmap.id;var C=this._curMat;var P=this._tempUV;var A=b[0];var B=b[1];var w=b[4];var T=b[5];var M=A;var I=B;var D=w;var L=T;if(h&&_){D=A+p;L=B+d;P[0]=A,P[1]=B,P[2]=D,P[3]=B,P[4]=D,P[5]=L,P[6]=A,P[7]=L;this._inner_drawTexture(t,S,e,o,h,_,C,P,1,false)}if(c&&_){M=w-y;I=B;D=w;L=B+d;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;this._inner_drawTexture(t,S,i-c+e,0+o,c,_,C,P,1,false)}if(h&&u){M=A;I=T-m;D=A+p;L=T;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;this._inner_drawTexture(t,S,0+e,a-u+o,h,u,C,P,1,false)}if(c&&u){M=w-y;I=T-m;D=w;L=T;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;this._inner_drawTexture(t,S,i-c+e,a-u+o,c,u,C,P,1,false)}if(_){M=A+p;I=B;D=w-y;L=B+d;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;if(f){this._fillTexture_h(t,S,P,t.width-h-c,_,h+e,o,i-h-c)}else{this._inner_drawTexture(t,S,h+e,o,i-h-c,_,C,P,1,false)}}if(u){M=A+p;I=T-m;D=w-y;L=T;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;if(f){this._fillTexture_h(t,S,P,t.width-h-c,u,h+e,a-u+o,i-h-c)}else{this._inner_drawTexture(t,S,h+e,a-u+o,i-h-c,u,C,P,1,false)}}if(h){M=A;I=B+d;D=A+p;L=T-m;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;if(f){this._fillTexture_v(t,S,P,h,t.height-_-u,e,_+o,a-_-u)}else{this._inner_drawTexture(t,S,e,_+o,h,a-_-u,C,P,1,false)}}if(c){M=w-y;I=B+d;D=w;L=T-m;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;if(f){this._fillTexture_v(t,S,P,c,t.height-_-u,i-c+e,_+o,a-_-u)}else{this._inner_drawTexture(t,S,i-c+e,_+o,c,a-_-u,C,P,1,false)}}M=A+p;I=B+d;D=w-y;L=T-m;P[0]=M,P[1]=I,P[2]=D,P[3]=I,P[4]=D,P[5]=L,P[6]=M,P[7]=L;if(f){var E=z.tmpUVRect;E[0]=M;E[1]=I;E[2]=D-M;E[3]=L-I;this._fillTexture(t,t.width-h-c,t.height-_-u,E,h+e,_+o,i-h-c,a-_-u,"repeat",0,0)}else{this._inner_drawTexture(t,S,h+e,_+o,i-h-c,a-_-u,C,P,1,false)}if(g)this.restore()}}z.ENUM_TEXTALIGN_DEFAULT=0;z.ENUM_TEXTALIGN_CENTER=1;z.ENUM_TEXTALIGN_RIGHT=2;z._SUBMITVBSIZE=32e3;z._MAXSIZE=99999999;z._MAXVERTNUM=65535;z.MAXCLIPRECT=null;z._COUNT=0;z.SEGNUM=32;z._contextcount=0;z.PI2=2*Math.PI;z._textRender=null;z.tmpuv1=[0,0,0,0,0,0,0,0];z.tmpUV=[0,0,0,0,0,0,0,0];z.tmpUVRect=[0,0,0,0];class _e{constructor(){this.lineWidth=1}clear(){this.lineWidth=1;this.textAlign=this.textBaseline=null}make(){return this===_e.DEFAULT?new _e:this}}class he{static _uint8ArraySlice(){var t=this;var e=t.length;var o=new Uint8Array(t.length);for(var i=0;i<e;i++)o[i]=t[i];return o}static _float32ArraySlice(){var t=this;var e=t.length;var o=new Float32Array(t.length);for(var i=0;i<e;i++)o[i]=t[i];return o}static _uint16ArraySlice(...t){var e=this;var o;var i;var a;if(t.length===0){o=e.length;i=new Uint16Array(o);for(a=0;a<o;a++)i[a]=e[a]}else if(t.length===2){var r=t[0];var s=t[1];if(s>r){o=s-r;i=new Uint16Array(o);for(a=r;a<s;a++)i[a-r]=e[a]}else{i=new Uint16Array(0)}}return i}static _nativeRender_enable(){}static enable(){return true}static inner_enable(){Float32Array.prototype.slice||(Float32Array.prototype.slice=he._float32ArraySlice);Uint16Array.prototype.slice||(Uint16Array.prototype.slice=he._uint16ArraySlice);Uint8Array.prototype.slice||(Uint8Array.prototype.slice=he._uint8ArraySlice);return true}static onStageResize(t,e){if(u.mainContext==null)return;u.mainContext.viewport(0,0,t,e);x.width=t;x.height=e}}he._isWebGL2=false;he.isNativeRender_enable=false;class de{constructor(){}}(function(){var a={};function o(t){if(window.console&&window.console.error){window.console.error(t)}}function e(t){if(window.console&&window.console.log){window.console.log(t)}}function h(t,e){a[t]=true;if(e!==undefined){o(e)}}function i(o){var i=o.getError;o.getError=function(){var t;do{t=i.apply(o);if(t!=o.NO_ERROR){a[t]=true}}while(t!=o.NO_ERROR);for(var e in a){if(a[e]){delete a[e];return parseInt(e)}}return o.NO_ERROR}}var r=function t(e){var o=e.gl;this.ext=e;this.isAlive=true;this.hasBeenBound=false;this.elementArrayBuffer=null;this.attribs=new Array(e.maxVertexAttribs);for(var i=0;i<this.attribs.length;i++){var a=new t.VertexAttrib(o);this.attribs[i]=a}this.maxAttrib=0};r.VertexAttrib=function t(e){this.enabled=false;this.buffer=null;this.size=4;this.type=e.FLOAT;this.normalized=false;this.stride=16;this.offset=0;this.cached="";this.recache()};r.VertexAttrib.prototype.recache=function t(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var s=function t(r){var x=this;this.gl=r;i(r);var l=this.original={getParameter:r.getParameter,enableVertexAttribArray:r.enableVertexAttribArray,disableVertexAttribArray:r.disableVertexAttribArray,bindBuffer:r.bindBuffer,getVertexAttrib:r.getVertexAttrib,vertexAttribPointer:r.vertexAttribPointer};r.getParameter=function t(e){if(e==x.VERTEX_ARRAY_BINDING_OES){if(x.currentVertexArrayObject==x.defaultVertexArrayObject){return null}else{return x.currentVertexArrayObject}}return l.getParameter.apply(this,arguments)};r.enableVertexAttribArray=function t(e){var o=x.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,e);var i=o.attribs[e];i.enabled=true;return l.enableVertexAttribArray.apply(this,arguments)};r.disableVertexAttribArray=function t(e){var o=x.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,e);var i=o.attribs[e];i.enabled=false;return l.disableVertexAttribArray.apply(this,arguments)};r.bindBuffer=function t(e,o){switch(e){case r.ARRAY_BUFFER:x.currentArrayBuffer=o;break;case r.ELEMENT_ARRAY_BUFFER:x.currentVertexArrayObject.elementArrayBuffer=o;break}return l.bindBuffer.apply(this,arguments)};r.getVertexAttrib=function t(e,o){var i=x.currentVertexArrayObject;var a=i.attribs[e];switch(o){case r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return a.buffer;case r.VERTEX_ATTRIB_ARRAY_ENABLED:return a.enabled;case r.VERTEX_ATTRIB_ARRAY_SIZE:return a.size;case r.VERTEX_ATTRIB_ARRAY_STRIDE:return a.stride;case r.VERTEX_ATTRIB_ARRAY_TYPE:return a.type;case r.VERTEX_ATTRIB_ARRAY_NORMALIZED:return a.normalized;default:return l.getVertexAttrib.apply(this,arguments)}};r.vertexAttribPointer=function t(e,o,i,a,r,s){var n=x.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,e);var b=n.attribs[e];b.buffer=x.currentArrayBuffer;b.size=o;b.type=i;b.normalized=a;b.stride=r;b.offset=s;b.recache();return l.vertexAttribPointer.apply(this,arguments)};if(r.instrumentExtension){r.instrumentExtension(this,"OES_vertex_array_object")}r.canvas.addEventListener("webglcontextrestored",function(){e("OESVertexArrayObject emulation library context restored");x.reset_()},true);this.reset_()};s.prototype.VERTEX_ARRAY_BINDING_OES=34229;s.prototype.reset_=function t(){var e=this.vertexArrayObjects!==undefined;if(e){for(var o=0;o<this.vertexArrayObjects.length;++o){this.vertexArrayObjects.isAlive=false}}var i=this.gl;this.maxVertexAttribs=i.getParameter(i.MAX_VERTEX_ATTRIBS);this.defaultVertexArrayObject=new r(this);this.currentVertexArrayObject=null;this.currentArrayBuffer=null;this.vertexArrayObjects=[this.defaultVertexArrayObject];this.bindVertexArrayOES(null)};s.prototype.createVertexArrayOES=function t(){var e=new r(this);this.vertexArrayObjects.push(e);return e};s.prototype.deleteVertexArrayOES=function t(e){e.isAlive=false;this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1);if(this.currentVertexArrayObject==e){this.bindVertexArrayOES(null)}};s.prototype.isVertexArrayOES=function t(e){if(e&&e instanceof r){if(e.hasBeenBound&&e.ext==this){return true}}return false};s.prototype.bindVertexArrayOES=function t(e){var o=this.gl;if(e&&!e.isAlive){h(o.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}var i=this.original;var a=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject;this.currentVertexArrayObject.hasBeenBound=true;var r=this.currentVertexArrayObject;if(a==r){return}if(!a||r.elementArrayBuffer!=a.elementArrayBuffer){i.bindBuffer.call(o,o.ELEMENT_ARRAY_BUFFER,r.elementArrayBuffer)}var s=this.currentArrayBuffer;var n=Math.max(a?a.maxAttrib:0,r.maxAttrib);for(var b=0;b<=n;b++){var x=r.attribs[b];var l=a?a.attribs[b]:null;if(!a||x.enabled!=l.enabled){if(x.enabled){i.enableVertexAttribArray.call(o,b)}else{i.disableVertexAttribArray.call(o,b)}}if(x.enabled){var _=false;if(!a||x.buffer!=l.buffer){if(s!=x.buffer){i.bindBuffer.call(o,o.ARRAY_BUFFER,x.buffer);s=x.buffer}_=true}if(_||x.cached!=l.cached){i.vertexAttribPointer.call(o,b,x.size,x.type,x.normalized,x.stride,x.offset)}}}if(this.currentArrayBuffer!=s){i.bindBuffer.call(o,o.ARRAY_BUFFER,this.currentArrayBuffer)}};window._setupVertexArrayObject=function(t){var o=t.getSupportedExtensions;t.getSupportedExtensions=function t(){var e=o.call(this)||[];if(e.indexOf("OES_vertex_array_object")<0){e.push("OES_vertex_array_object")}return e};var i=t.getExtension;t.getExtension=function t(e){var o=i.call(this,e);if(o){return o}if(e!=="OES_vertex_array_object"){return null}if(!this.__OESVertexArrayObject){console.log("Setup OES_vertex_array_object polyfill");this.__OESVertexArrayObject=new s(this)}return this.__OESVertexArrayObject}};window._forceSetupVertexArrayObject=function(t){var o=t.getSupportedExtensions;t.getSupportedExtensions=function t(){var e=o.call(this)||[];if(e.indexOf("OES_vertex_array_object")<0){e.push("OES_vertex_array_object")}return e};var i=t.getExtension;t.getExtension=function t(e){if(e==="OES_vertex_array_object"){if(!this.__OESVertexArrayObject){console.log("Setup OES_vertex_array_object polyfill");this.__OESVertexArrayObject=new s(this)}return this.__OESVertexArrayObject}else{var o=i.call(this,e);if(o){return o}else{return null}}}}})();class pe{constructor(t,e){this._gl=null;this._vaoExt=null;this._angleInstancedArrays=null;this._isWebGL2=false;this._oesTextureHalfFloat=null;this._extTextureFilterAnisotropic=null;this._compressedTextureS3tc=null;this._compressedTexturePvrtc=null;this._compressedTextureEtc1=null;this._gl=t;this._isWebGL2=e;try{var o=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);o.precision?he.shaderHighPrecision=true:he.shaderHighPrecision=false}catch(t){}if(!e){var i=pe._forceSupportVAOPlatform();if(!T.Render.isConchApp){if(window._setupVertexArrayObject){if(i)window._forceSetupVertexArrayObject(t);else window._setupVertexArrayObject(t)}}this._vaoExt=this._getExtension("OES_vertex_array_object");if(!i)this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays");this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float");this._getExtension("OES_texture_half_float_linear")}else{this._getExtension("EXT_color_buffer_float")}this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic");this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc");this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc");this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1")}static _forceSupportVAOPlatform(){let t=T.Browser;return t.onMiniGame&&t.onIOS||t.onBDMiniGame||t.onQGMiniGame}_getExtension(t){var e=pe._extentionVendorPrefixes;for(var o in e){var i=this._gl.getExtension(e[o]+t);if(i)return i}return null}createVertexArray(){if(this._isWebGL2)return this._gl.createVertexArray();else return this._vaoExt.createVertexArrayOES()}bindVertexArray(t){if(this._isWebGL2)this._gl.bindVertexArray(t);else this._vaoExt.bindVertexArrayOES(t)}deleteVertexArray(t){if(this._isWebGL2)this._gl.deleteVertexArray(t);else this._vaoExt.deleteVertexArrayOES(t)}isVertexArray(t){if(this._isWebGL2)this._gl.isVertexArray(t);else this._vaoExt.isVertexArrayOES(t)}drawElementsInstanced(t,e,o,i,a){if(this._isWebGL2)this._gl.drawElementsInstanced(t,e,o,i,a);else this._angleInstancedArrays.drawElementsInstancedANGLE(t,e,o,i,a)}drawArraysInstanced(t,e,o,i){if(this._isWebGL2)this._gl.drawArraysInstanced(t,e,o,i);else this._angleInstancedArrays.drawArraysInstancedANGLE(t,e,o,i)}vertexAttribDivisor(t,e){if(this._isWebGL2)this._gl.vertexAttribDivisor(t,e);else this._angleInstancedArrays.vertexAttribDivisorANGLE(t,e)}supportInstance(){if(this._isWebGL2||this._angleInstancedArrays)return true;else return false}}pe._extentionVendorPrefixes=["","WEBKIT_","MOZ_"];class y{constructor(t,e,o){this._timeId=0;y._mainCanvas=o;y._mainCanvas.source.id="layaCanvas";y._mainCanvas.source.width=t;y._mainCanvas.source.height=e;if(y.isConchApp){document.body.appendChild(y._mainCanvas.source)}this.initRender(y._mainCanvas,t,e);window.requestAnimationFrame(i);function i(t){T.stage._loop();window.requestAnimationFrame(i)}T.stage.on("visibilitychange",this,this._onVisibilitychange)}_onVisibilitychange(){if(!T.stage.isVisibility){this._timeId=window.setInterval(this._enterFrame,1e3)}else if(this._timeId!=0){window.clearInterval(this._timeId)}}initRender(t,e,o){function i(t){var e;var o=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];if(!s.useWebGL2||E.onBDMiniGame){o.shift()}for(var i=0;i<o.length;i++){try{e=t.getContext(o[i],{stencil:s.isStencil,alpha:s.isAlpha,antialias:s.isAntialias,premultipliedAlpha:s.premultipliedAlpha,preserveDrawingBuffer:s.preserveDrawingBuffer})}catch(t){}if(e){o[i]==="webgl2"&&(he._isWebGL2=true);return e}}return null}var a=c.instance=u.mainContext=i(y._mainCanvas.source);if(!a)return false;c.instance=a;c.layaGPUInstance=new pe(a,he._isWebGL2);t.size(e,o);z.__init__();A.__init__();var r=new z;r.isMain=true;y._context=r;t._setContext(r);D.__init__();nt.__init__();Ht.__init__();It.__int__(a);I._init_(a);return true}_enterFrame(t=null){T.stage._loop()}static get context(){return y._context}static get canvas(){return y._mainCanvas.source}}y.supportWebGLPlusCulling=false;y.supportWebGLPlusAnimation=false;y.supportWebGLPlusRendering=false;y.isConchApp=false;{y.isConchApp=window.conch!=null;if(y.isConchApp){y.supportWebGLPlusCulling=false;y.supportWebGLPlusAnimation=true;y.supportWebGLPlusRendering=true}else if(window.qq!=null&&window.qq.webglPlus!=null){y.supportWebGLPlusCulling=false;y.supportWebGLPlusAnimation=true;y.supportWebGLPlusRendering=true}}class ce{static create(t,e,o,i,a,r,s,n,b,x){var l=p.getItemByClass("DrawTrianglesCmd",ce);l.texture=t;l.x=e;l.y=o;l.vertices=i;l.uvs=a;l.indices=r;l.matrix=s;l.alpha=n;if(b){l.color=new _t;var _=g.create(b).arrColor;l.color.color(_[0]*255,_[1]*255,_[2]*255,_[3]*255)}l.blendMode=x;return l}recover(){this.texture=null;this.vertices=null;this.uvs=null;this.indices=null;this.matrix=null;p.recover("DrawTrianglesCmd",this)}run(t,e,o){t.drawTriangles(this.texture,this.x+e,this.y+o,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode)}get cmdID(){return ce.ID}}ce.ID="DrawTriangles";class ue{constructor(){}static create(t,e,o,i,a,r){var s=p.getItemByClass("Draw9GridTexture",ue);s.texture=t;t._addReference();s.x=e;s.y=o;s.width=i;s.height=a;s.sizeGrid=r;return s}recover(){this.texture._removeReference();p.recover("Draw9GridTexture",this)}run(t,e,o){t.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,e,o)}get cmdID(){return ue.ID}}ue.ID="Draw9GridTexture";class ye{constructor(){this._cacheBoundsType=false}destroy(){this._graphics=null;this._cacheBoundsType=false;if(this._temp)this._temp.length=0;if(this._rstBoundPoints)this._rstBoundPoints.length=0;if(this._bounds)this._bounds.recover();this._bounds=null;p.recover("GraphicsBounds",this)}static create(){return p.getItemByClass("GraphicsBounds",ye)}reset(){this._temp&&(this._temp.length=0)}getBounds(t=false){if(!this._bounds||!this._temp||this._temp.length<1||t!=this._cacheBoundsType){this._bounds=B._getWrapRec(this.getBoundPoints(t),this._bounds)}this._cacheBoundsType=t;return this._bounds}getBoundPoints(t=false){if(!this._temp||this._temp.length<1||t!=this._cacheBoundsType)this._temp=this._getCmdPoints(t);this._cacheBoundsType=t;return this._rstBoundPoints=f.copyArray(this._rstBoundPoints,this._temp)}_getCmdPoints(t=false){var e=this._graphics.cmds;var o;o=this._temp||(this._temp=[]);o.length=0;if(!e&&this._graphics._one!=null){ye._tempCmds.length=0;ye._tempCmds.push(this._graphics._one);e=ye._tempCmds}if(!e)return o;var i=ye._tempMatrixArrays;i.length=0;var a=ye._initMatrix;a.identity();var r=ye._tempMatrix;var s;var n;for(var b=0,x=e.length;b<x;b++){s=e[b];switch(s.cmdID){case k.ID:i.push(a);a=a.clone();break;case pt.ID:a=i.pop();break;case ut.ID:r.identity();r.translate(-s.pivotX,-s.pivotY);r.scale(s.scaleX,s.scaleY);r.translate(s.pivotX,s.pivotY);this._switchMatrix(a,r);break;case ct.ID:r.identity();r.translate(-s.pivotX,-s.pivotY);r.rotate(s.angle);r.translate(s.pivotX,s.pivotY);this._switchMatrix(a,r);break;case mt.ID:r.identity();r.translate(s.tx,s.ty);this._switchMatrix(a,r);break;case yt.ID:r.identity();r.translate(-s.pivotX,-s.pivotY);r.concat(s.matrix);r.translate(s.pivotX,s.pivotY);this._switchMatrix(a,r);break;case W.ID:case dt.ID:ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),a);break;case ht.ID:a.copyTo(r);if(s.matrix)r.concat(s.matrix);ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),r);break;case W.ID:n=s.texture;if(t){if(s.width&&s.height){ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),a)}else{ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,n.width,n.height),a)}}else{var l=(s.width||n.sourceWidth)/n.width;var _=(s.height||n.sourceHeight)/n.height;var h=l*n.sourceWidth;var d=_*n.sourceHeight;var p=n.offsetX>0?n.offsetX:0;var c=n.offsetY>0?n.offsetY:0;p*=l;c*=_;ye._addPointArrToRst(o,B._getBoundPointS(s.x-p,s.y-c,h,d),a)}break;case dt.ID:if(s.width&&s.height){ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),a)}else{n=s.texture;ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,n.width,n.height),a)}break;case ht.ID:var u;if(s.matrix){a.copyTo(r);r.concat(s.matrix);u=r}else{u=a}if(t){if(s.width&&s.height){ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),u)}else{n=s.texture;ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,n.width,n.height),u)}}else{n=s.texture;l=(s.width||n.sourceWidth)/n.width;_=(s.height||n.sourceHeight)/n.height;h=l*n.sourceWidth;d=_*n.sourceHeight;p=n.offsetX>0?n.offsetX:0;c=n.offsetY>0?n.offsetY:0;p*=l;c*=_;ye._addPointArrToRst(o,B._getBoundPointS(s.x-p,s.y-c,h,d),u)}break;case j.ID:ye._addPointArrToRst(o,B._getBoundPointS(s.x,s.y,s.width,s.height),a);break;case O.ID:ye._addPointArrToRst(o,B._getBoundPointS(s.x-s.radius,s.y-s.radius,s.radius+s.radius,s.radius+s.radius),a);break;case U.ID:ye._tempPoints.length=0;var y;y=s.lineWidth*.5;if(s.fromX==s.toX){ye._tempPoints.push(s.fromX+y,s.fromY,s.toX+y,s.toY,s.fromX-y,s.fromY,s.toX-y,s.toY)}else if(s.fromY==s.toY){ye._tempPoints.push(s.fromX,s.fromY+y,s.toX,s.toY+y,s.fromX,s.fromY-y,s.toX,s.toY-y)}else{ye._tempPoints.push(s.fromX,s.fromY,s.toX,s.toY)}ye._addPointArrToRst(o,ye._tempPoints,a);break;case N.ID:ye._addPointArrToRst(o,ft.I.getBezierPoints(s.points),a,s.x,s.y);break;case X.ID:case q.ID:ye._addPointArrToRst(o,s.points,a,s.x,s.y);break;case H.ID:ye._addPointArrToRst(o,this._getPathPoints(s.paths),a,s.x,s.y);break;case Y.ID:ye._addPointArrToRst(o,this._getPiePoints(s.x,s.y,s.radius,s.startAngle,s.endAngle),a);break;case ce.ID:ye._addPointArrToRst(o,this._getTriAngBBXPoints(s.vertices),a);break;case ue.ID:ye._addPointArrToRst(o,this._getDraw9GridBBXPoints(s),a);break}}if(o.length>200){o=f.copyArray(o,B._getWrapRec(o)._getBoundPoints())}else if(o.length>8)o=gt.scanPList(o);return o}_switchMatrix(t,e){e.concat(t);e.copyTo(t)}static _addPointArrToRst(t,e,o,i=0,a=0){var r,s;s=e.length;for(r=0;r<s;r+=2){ye._addPointToRst(t,e[r]+i,e[r+1]+a,o)}}static _addPointToRst(t,e,o,i){var a=K.TEMP;a.setTo(e?e:0,o?o:0);i.transformPoint(a);t.push(a.x,a.y)}_getPiePoints(t,e,o,i,a){var r=ye._tempPoints;ye._tempPoints.length=0;var s=Math.PI/180;var n=a-i;if(n>=360||n<=-360){r.push(t-o,e-o);r.push(t+o,e-o);r.push(t+o,e+o);r.push(t-o,e+o);return r}r.push(t,e);var b=n%360;if(b<0)b+=360;var x=i+b;var l=i*s;var _=x*s;r.push(t+o*Math.cos(l),e+o*Math.sin(l));r.push(t+o*Math.cos(_),e+o*Math.sin(_));var h=Math.ceil(i/90)*90;var d=Math.floor(x/90)*90;for(var p=h;p<=d;p+=90){var c=p*s;r.push(t+o*Math.cos(c),e+o*Math.sin(c))}return r}_getTriAngBBXPoints(t){var e=t.length;if(e<2)return[];var o=t[0];var i=t[1];var a=o;var r=i;for(var s=2;s<e;){var n=t[s++];var b=t[s++];if(o>n)o=n;if(i>b)i=b;if(a<n)a=n;if(r<b)r=b}return[o,i,a,i,a,r,o,r]}_getDraw9GridBBXPoints(t){var e=0;var o=0;var i=t.width;var a=t.height;return[e,o,i,o,i,a,e,a]}_getPathPoints(t){var e,o;var i=ye._tempPoints;i.length=0;o=t.length;var a;for(e=0;e<o;e++){a=t[e];if(a.length>1){i.push(a[1],a[2]);if(a.length>3){i.push(a[3],a[4])}}}return i}}ye._tempMatrix=new w;ye._initMatrix=new w;ye._tempPoints=[];ye._tempMatrixArrays=[];ye._tempCmds=[];class P{}P.ALPHA=1;P.TRANSFORM=2;P.BLEND=4;P.CANVAS=8;P.FILTERS=16;P.MASK=32;P.CLIP=64;P.STYLE=128;P.TEXTURE=256;P.GRAPHICS=512;P.LAYAGL3D=1024;P.CUSTOM=2048;P.ONECHILD=4096;P.CHILDS=8192;P.REPAINT_NONE=0;P.REPAINT_NODE=1;P.REPAINT_CACHE=2;P.REPAINT_ALL=3;class me{static create(t,e,o,i){var a=p.getItemByClass("ClipRectCmd",me);a.x=t;a.y=e;a.width=o;a.height=i;return a}recover(){p.recover("ClipRectCmd",this)}run(t,e,o){t.clipRect(this.x+e,this.y+o,this.width,this.height)}get cmdID(){return me.ID}}me.ID="ClipRect";class fe{static create(t,e){var o=p.getItemByClass("DrawTexturesCmd",fe);o.texture=t;t._addReference();o.pos=e;return o}recover(){this.texture._removeReference();this.texture=null;this.pos=null;p.recover("DrawTexturesCmd",this)}run(t,e,o){t.drawTextures(this.texture,this.pos,e,o)}get cmdID(){return fe.ID}}fe.ID="DrawTextures";class ge{static create(t,e,o,i,a,r,s,n){var b=p.getItemByClass("FillBorderTextCmd",ge);b.text=t;b.x=e;b.y=o;b.font=i;b.fillColor=a;b.borderColor=r;b.lineWidth=s;b.textAlign=n;return b}recover(){p.recover("FillBorderTextCmd",this)}run(t,e,o){t.fillBorderText(this.text,this.x+e,this.y+o,this.font,this.fillColor,this.borderColor,this.lineWidth,this.textAlign)}get cmdID(){return ge.ID}}ge.ID="FillBorderText";class ve{static create(t,e,o,i,a,r,s){var n=p.getItemByClass("FillBorderWordsCmd",ve);n.words=t;n.x=e;n.y=o;n.font=i;n.fillColor=a;n.borderColor=r;n.lineWidth=s;return n}recover(){this.words=null;p.recover("FillBorderWordsCmd",this)}run(t,e,o){t.fillBorderWords(this.words,this.x+e,this.y+o,this.font,this.fillColor,this.borderColor,this.lineWidth)}get cmdID(){return ve.ID}}ve.ID="FillBorderWords";class Se{constructor(){this._textIsWorldText=false;this._fontColor=4294967295;this._strokeColor=0;this._fontObj=Se._defFontObj;this._nTexAlign=0}static create(t,e,o,i,a,r){var s=p.getItemByClass("FillTextCmd",Se);s.text=t;s._textIsWorldText=t instanceof se;s.x=e;s.y=o;s.font=i;s.color=a;s.textAlign=r;return s}recover(){p.recover("FillTextCmd",this)}run(t,e,o){if(T.stage.isGlobalRepaint()){this._textIsWorldText&&this._text.cleanCache()}if(this._textIsWorldText){t._fast_filltext(this._text,this.x+e,this.y+o,this._fontObj,this._color,null,0,this._nTexAlign,0)}else{t.drawText(this._text,this.x+e,this.y+o,this._font,this._color,this._textAlign)}}get cmdID(){return Se.ID}get text(){return this._text}set text(t){this._text=t;this._textIsWorldText=t instanceof se;this._textIsWorldText&&this._text.cleanCache()}get font(){return this._font}set font(t){this._font=t;this._fontObj=re.Parse(t);this._textIsWorldText&&this._text.cleanCache()}get color(){return this._color}set color(t){this._color=t;this._fontColor=g.create(t).numColor;this._textIsWorldText&&this._text.cleanCache()}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t;switch(t){case"center":this._nTexAlign=T.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=T.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=T.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}Se.ID="FillText";Se._defFontObj=new re(null);class Ce{static create(t,e,o,i,a){var r=p.getItemByClass("FillWordsCmd",Ce);r.words=t;r.x=e;r.y=o;r.font=i;r.color=a;return r}recover(){this.words=null;p.recover("FillWordsCmd",this)}run(t,e,o){t.fillWords(this.words,this.x+e,this.y+o,this.font,this.color)}get cmdID(){return Ce.ID}}Ce.ID="FillWords";class Pe{static create(){var t=p.getItemByClass("SaveCmd",Pe);return t}recover(){p.recover("SaveCmd",this)}run(t,e,o){t.save()}get cmdID(){return Pe.ID}}Pe.ID="Save";class Ae{static create(t,e,o,i,a,r,s){var n=p.getItemByClass("StrokeTextCmd",Ae);n.text=t;n.x=e;n.y=o;n.font=i;n.color=a;n.lineWidth=r;n.textAlign=s;return n}recover(){p.recover("StrokeTextCmd",this)}run(t,e,o){t.strokeWord(this.text,this.x+e,this.y+o,this.font,this.color,this.lineWidth,this.textAlign)}get cmdID(){return Ae.ID}}Ae.ID="StrokeText";class Be{constructor(){}static regCacheByFunction(t,e){Be.unRegCacheByFunction(t,e);var o;o={tryDispose:t,getCacheList:e};Be._cacheList.push(o)}static unRegCacheByFunction(t,e){var o,i;i=Be._cacheList.length;for(o=0;o<i;o++){if(Be._cacheList[o].tryDispose==t&&Be._cacheList[o].getCacheList==e){Be._cacheList.splice(o,1);return}}}static forceDispose(){var t,e=Be._cacheList.length;for(t=0;t<e;t++){Be._cacheList[t].tryDispose(true)}}static beginCheck(t=15e3){T.systemTimer.loop(t,null,Be._checkLoop)}static stopCheck(){T.systemTimer.clear(null,Be._checkLoop)}static _checkLoop(){var t=Be._cacheList;if(t.length<1)return;var e=T.Browser.now();var o;var i;i=o=t.length;while(o>0){Be._index++;Be._index=Be._index%i;t[Be._index].tryDispose(false);if(T.Browser.now()-e>Be.loopTimeLimit)break;o--}}}Be.loopTimeLimit=2;Be._cacheList=[];Be._index=0;class we{constructor(){this.useDic={};this.shapeDic={};this.shapeLineDic={};this._id=0;this._checkKey=false;this._freeIdArray=[];Be.regCacheByFunction(this.startDispose.bind(this),this.getCacheList.bind(this))}static getInstance(){return we.instance=we.instance||new we}getId(){return this._id++}addShape(t,e){this.shapeDic[t]=e;if(!this.useDic[t]){this.useDic[t]=true}}addLine(t,e){this.shapeLineDic[t]=e;if(!this.shapeLineDic[t]){this.shapeLineDic[t]=true}}getShape(t){if(this._checkKey){if(this.useDic[t]!=null){this.useDic[t]=true}}}deleteShape(t){if(this.shapeDic[t]){this.shapeDic[t]=null;delete this.shapeDic[t]}if(this.shapeLineDic[t]){this.shapeLineDic[t]=null;delete this.shapeLineDic[t]}if(this.useDic[t]!=null){delete this.useDic[t]}}getCacheList(){var t;var e=[];for(t in this.shapeDic){e.push(this.shapeDic[t])}for(t in this.shapeLineDic){e.push(this.shapeLineDic[t])}return e}startDispose(t){var e;for(e in this.useDic){this.useDic[e]=false}this._checkKey=true}endDispose(){if(this._checkKey){var t;for(t in this.useDic){if(!this.useDic[t]){this.deleteShape(t)}}this._checkKey=false}}}class Te{constructor(){this._sp=null;this._one=null;this._render=this._renderEmpty;this._cmds=null;this._vectorgraphArray=null;this._graphicBounds=null;this.autoDestroy=false;this._createData()}_createData(){}_clearData(){}_destroyData(){}destroy(){this.clear(true);if(this._graphicBounds)this._graphicBounds.destroy();this._graphicBounds=null;this._vectorgraphArray=null;if(this._sp){this._sp._renderType=0;this._sp._setRenderType(0);this._sp=null}this._destroyData()}clear(t=true){if(t){var e=this._one;if(this._cmds){var o,i=this._cmds.length;for(o=0;o<i;o++){e=this._cmds[o];e.recover()}this._cmds.length=0}else if(e){e.recover()}}else{this._cmds=null}this._one=null;this._render=this._renderEmpty;this._clearData();if(this._sp){this._sp._renderType&=~P.GRAPHICS;this._sp._setRenderType(this._sp._renderType)}this._repaint();if(this._vectorgraphArray){for(o=0,i=this._vectorgraphArray.length;o<i;o++){we.getInstance().deleteShape(this._vectorgraphArray[o])}this._vectorgraphArray.length=0}}_clearBoundsCache(){if(this._graphicBounds)this._graphicBounds.reset()}_initGraphicBounds(){if(!this._graphicBounds){this._graphicBounds=ye.create();this._graphicBounds._graphics=this}}_repaint(){this._clearBoundsCache();this._sp&&this._sp.repaint()}_isOnlyOne(){return!this._cmds||this._cmds.length===0}get cmds(){return this._cmds}set cmds(t){if(this._sp){this._sp._renderType|=P.GRAPHICS;this._sp._setRenderType(this._sp._renderType)}this._cmds=t;this._render=this._renderAll;this._repaint()}getBounds(t=false){this._initGraphicBounds();return this._graphicBounds.getBounds(t)}getBoundPoints(t=false){this._initGraphicBounds();return this._graphicBounds.getBoundPoints(t)}drawImage(t,e=0,o=0,i=0,a=0){if(!t)return null;if(!i)i=t.sourceWidth;if(!a)a=t.sourceHeight;if(t.getIsReady()){var r=i/t.sourceWidth;var s=a/t.sourceHeight;i=t.width*r;a=t.height*s;if(i<=0||a<=0)return null;e+=t.offsetX*r;o+=t.offsetY*s}if(this._sp){this._sp._renderType|=P.GRAPHICS;this._sp._setRenderType(this._sp._renderType)}var n=W.create.call(this,t,e,o,i,a);if(this._one==null){this._one=n;this._render=this._renderOneImg}else{this._saveToCmd(null,n)}this._repaint();return n}drawTexture(t,e=0,o=0,i=0,a=0,r=null,s=1,n=null,b=null,x){if(!t||s<.01)return null;if(!t.getIsReady())return null;if(!i)i=t.sourceWidth;if(!a)a=t.sourceHeight;if(t.getIsReady()){var l=i/t.sourceWidth;var _=a/t.sourceHeight;i=t.width*l;a=t.height*_;if(i<=0||a<=0)return null;e+=t.offsetX*l;o+=t.offsetY*_}if(this._sp){this._sp._renderType|=P.GRAPHICS;this._sp._setRenderType(this._sp._renderType)}var h=ht.create.call(this,t,e,o,i,a,r,s,n,b,x);this._repaint();return this._saveToCmd(null,h)}drawTextures(t,e){if(!t)return null;return this._saveToCmd(y._context.drawTextures,fe.create.call(this,t,e))}drawTriangles(t,e,o,i,a,r,s=null,n=1,b=null,x=null){return this._saveToCmd(y._context.drawTriangles,ce.create.call(this,t,e,o,i,a,r,s,n,b,x))}fillTexture(t,e,o,i=0,a=0,r="repeat",s=null){if(t&&t.getIsReady())return this._saveToCmd(y._context._fillTexture,dt.create.call(this,t,e,o,i,a,r,s||K.EMPTY,{}));else return null}_saveToCmd(t,e){if(this._sp){this._sp._renderType|=P.GRAPHICS;this._sp._setRenderType(this._sp._renderType)}if(this._one==null){this._one=e;this._render=this._renderOne}else{this._render=this._renderAll;(this._cmds||(this._cmds=[])).length===0&&this._cmds.push(this._one);this._cmds.push(e)}this._repaint();return e}clipRect(t,e,o,i){return this._saveToCmd(y._context.clipRect,me.create.call(this,t,e,o,i))}fillText(t,e,o,i,a,r){return this._saveToCmd(y._context.fillText,Se.create.call(this,t,e,o,i||T.Text.defaultFontStr(),a,r))}fillBorderText(t,e,o,i,a,r,s,n){return this._saveToCmd(y._context.fillBorderText,ge.create.call(this,t,e,o,i||T.Text.defaultFontStr(),a,r,s,n))}fillWords(t,e,o,i,a){return this._saveToCmd(y._context.fillWords,Ce.create.call(this,t,e,o,i||T.Text.defaultFontStr(),a))}fillBorderWords(t,e,o,i,a,r,s){return this._saveToCmd(y._context.fillBorderWords,ve.create.call(this,t,e,o,i||T.Text.defaultFontStr(),a,r,s))}strokeText(t,e,o,i,a,r,s){return this._saveToCmd(y._context.fillBorderText,Ae.create.call(this,t,e,o,i||T.Text.defaultFontStr(),a,r,s))}alpha(t){return this._saveToCmd(y._context.alpha,k.create.call(this,t))}transform(t,e=0,o=0){return this._saveToCmd(y._context._transform,yt.create.call(this,t,e,o))}rotate(t,e=0,o=0){return this._saveToCmd(y._context._rotate,ct.create.call(this,t,e,o))}scale(t,e,o=0,i=0){return this._saveToCmd(y._context._scale,ut.create.call(this,t,e,o,i))}translate(t,e){return this._saveToCmd(y._context.translate,mt.create.call(this,t,e))}save(){return this._saveToCmd(y._context._save,Pe.create.call(this))}restore(){return this._saveToCmd(y._context.restore,pt.create.call(this))}replaceText(t){this._repaint();var e=this._cmds;if(!e){if(this._one&&this._isTextCmd(this._one)){this._one.text=t;return true}}else{for(var o=e.length-1;o>-1;o--){if(this._isTextCmd(e[o])){e[o].text=t;return true}}}return false}_isTextCmd(t){var e=t.cmdID;return e==Se.ID||e==Ae.ID||e==ge.ID}replaceTextColor(t){this._repaint();var e=this._cmds;if(!e){if(this._one&&this._isTextCmd(this._one)){this._setTextCmdColor(this._one,t)}}else{for(var o=e.length-1;o>-1;o--){if(this._isTextCmd(e[o])){this._setTextCmdColor(e[o],t)}}}}_setTextCmdColor(t,e){var o=t.cmdID;switch(o){case Se.ID:case Ae.ID:t.color=e;break;case ge.ID:case ve.ID:case ge.ID:t.fillColor=e;break}}loadImage(t,e=0,o=0,i=0,a=0,r=null){var s=T.Loader.getRes(t);if(!s){s=new ae;s.load(t);T.Loader.cacheRes(t,s);s.once(L.READY,this,this.drawImage,[s,e,o,i,a])}else{if(!s.getIsReady()){s.once(L.READY,this,this.drawImage,[s,e,o,i,a])}else this.drawImage(s,e,o,i,a)}if(r!=null){s.getIsReady()?r.call(this._sp):s.on(L.READY,this._sp,r)}}_renderEmpty(t,e,o,i){}_renderAll(t,e,o,i){var a=this._cmds;for(var r=0,s=a.length;r<s;r++){a[r].run(e,o,i)}}_renderOne(t,e,o,i){e.sprite=t;this._one.run(e,o,i)}_renderOneImg(t,e,o,i){e.sprite=t;this._one.run(e,o,i)}drawLine(t,e,o,i,a,r=1){var s=r<1||r%2===0?0:.5;return this._saveToCmd(y._context._drawLine,U.create.call(this,t+s,e+s,o+s,i+s,a,r,0))}drawLines(t,e,o,i,a=1){if(!o||o.length<4)return null;var r=a<1||a%2===0?0:.5;return this._saveToCmd(y._context._drawLines,X.create.call(this,t+r,e+r,o,i,a,0))}drawCurves(t,e,o,i,a=1){return this._saveToCmd(y._context.drawCurves,N.create.call(this,t,e,o,i,a))}drawRect(t,e,o,i,a,r=null,s=1){var n=s>=1&&r?s/2:0;var b=r?s:0;return this._saveToCmd(y._context.drawRect,j.create.call(this,t+n,e+n,o-b,i-b,a,r,s))}drawCircle(t,e,o,i,a=null,r=1){var s=r>=1&&a?r/2:0;return this._saveToCmd(y._context._drawCircle,O.create.call(this,t,e,o-s,i,a,r,0))}drawPie(t,e,o,i,a,r,s=null,n=1){var b=n>=1&&s?n/2:0;var x=s?n:0;return this._saveToCmd(y._context._drawPie,Y.create.call(this,t+b,e+b,o-x,f.toRadian(i),f.toRadian(a),r,s,n,0))}drawPoly(t,e,o,i,a=null,r=1){var s=false;if(o.length>6){s=false}else{s=true}var n=r>=1&&a?r%2===0?0:.5:0;return this._saveToCmd(y._context._drawPoly,q.create.call(this,t+n,e+n,o,i,a,r,s,0))}drawPath(t,e,o,i=null,a=null){return this._saveToCmd(y._context._drawPath,H.create.call(this,t,e,o,i,a))}draw9Grid(t,e=0,o=0,i=0,a=0,r=null){this._saveToCmd(null,ue.create(t,e,o,i,a,r))}}class R{}R.NOT_ACTIVE=1;R.ACTIVE_INHIERARCHY=2;R.AWAKED=4;R.NOT_READY=8;R.DISPLAY=16;R.HAS_ZORDER=32;R.HAS_MOUSE=64;R.DISPLAYED_INSTAGE=128;R.DRAWCALL_OPTIMIZE=256;class Me{contains(t,e){if(!Me._isHitGraphic(t,e,this.hit))return false;return!Me._isHitGraphic(t,e,this.unHit)}static _isHitGraphic(t,e,o){if(!o)return false;var i=o.cmds;if(!i&&o._one){i=Me._cmds;i.length=1;i[0]=o._one}if(!i)return false;var a,r;r=i.length;var s;for(a=0;a<r;a++){s=i[a];if(!s)continue;switch(s.cmdID){case"Translate":t-=s.tx;e-=s.ty}if(Me._isHitCmd(t,e,s))return true}return false}static _isHitCmd(t,e,o){if(!o)return false;var i=false;switch(o.cmdID){case"DrawRect":Me._rect.setTo(o.x,o.y,o.width,o.height);i=Me._rect.contains(t,e);break;case"DrawCircle":var a;t-=o.x;e-=o.y;a=t*t+e*e;i=a<o.radius*o.radius;break;case"DrawPoly":t-=o.x;e-=o.y;i=Me._ptInPolygon(t,e,o.points);break}return i}static _ptInPolygon(t,e,o){var i=Me._ptPoint;i.setTo(t,e);var a=0;var r,s,n,b;var x;x=o.length;for(var l=0;l<x;l+=2){r=o[l];s=o[l+1];n=o[(l+2)%x];b=o[(l+3)%x];if(s==b)continue;if(i.y<Math.min(s,b))continue;if(i.y>=Math.max(s,b))continue;var _=(i.y-s)*(n-r)/(b-s)+r;if(_>i.x)a++}return a%2==1}get hit(){if(!this._hit)this._hit=new T.Graphics;return this._hit}set hit(t){this._hit=t}get unHit(){if(!this._unHit)this._unHit=new T.Graphics;return this._unHit}set unHit(t){this._unHit=t}}Me._cmds=[];Me._rect=new B;Me._ptPoint=new K;class d{static regClass(t,e){d._classMap[t]=e}static regShortClassName(t){for(var e=0;e<t.length;e++){var o=t[e];var i=o.name;d._classMap[i]=o}}static getRegClass(t){return d._classMap[t]}static getClass(t){var e=d._classMap[t]||d._classMap["Laya."+t]||t;var o=T.Laya;if(typeof e=="string")return T.__classMap[e]||o[t];return e}static getInstance(t){var e=d.getClass(t);if(e)return new e;else console.warn("[error] Undefined class:",t);return null}static createByJson(t,e=null,o=null,i=null,a=null){if(typeof t=="string")t=JSON.parse(t);var r=t.props;if(!e){e=a?a.runWith(t):d.getInstance(r.runtime||t.type);if(!e)return null}var s=t.child;if(s){for(var n=0,b=s.length;n<b;n++){var x=s[n];if((x.props.name==="render"||x.props.renderType==="render")&&e["_$set_itemRender"])e.itemRender=x;else{if(x.type=="Graphic"){d._addGraphicsToSprite(x,e)}else if(d._isDrawType(x.type)){d._addGraphicToSprite(x,e,true)}else{var l=d.createByJson(x,null,o,i,a);if(x.type==="Script"){if("owner"in l){l["owner"]=e}else if("target"in l){l["target"]=e}}else if(x.props.renderType=="mask"){e.mask=l}else{e.addChild(l)}}}}}if(r){for(var _ in r){var h=r[_];if(_==="var"&&o){o[h]=e}else if(h instanceof Array&&e[_]instanceof Function){e[_].apply(e,h)}else{e[_]=h}}}if(i&&t.customProps){i.runWith([e,t])}if(e["created"])e.created();return e}static _addGraphicsToSprite(t,e){var o=t.child;if(!o||o.length<1)return;var i=d._getGraphicsFromSprite(t,e);var a=0;var r=0;if(t.props){a=d._getObjVar(t.props,"x",0);r=d._getObjVar(t.props,"y",0)}if(a!=0&&r!=0){i.translate(a,r)}var s,n;n=o.length;for(s=0;s<n;s++){d._addGraphicToGraphics(o[s],i)}if(a!=0&&r!=0){i.translate(-a,-r)}}static _addGraphicToSprite(t,e,o=false){var i=o?d._getGraphicsFromSprite(t,e):e.graphics;d._addGraphicToGraphics(t,i)}static _getGraphicsFromSprite(t,e){if(!t||!t.props)return e.graphics;var o=t.props.renderType;if(o==="hit"||o==="unHit"){var i=e._style.hitArea||(e.hitArea=new Me);if(!i[o]){i[o]=new Te}var a=i[o]}if(!a)a=e.graphics;return a}static _getTransformData(t){var e;if("pivotX"in t||"pivotY"in t){e=e||new w;e.translate(-d._getObjVar(t,"pivotX",0),-d._getObjVar(t,"pivotY",0))}var o=d._getObjVar(t,"scaleX",1),i=d._getObjVar(t,"scaleY",1);var a=d._getObjVar(t,"rotation",0);var r=d._getObjVar(t,"skewX",0);var s=d._getObjVar(t,"skewY",0);if(o!=1||i!=1||a!=0){e=e||new w;e.scale(o,i);e.rotate(a*.0174532922222222)}return e}static _addGraphicToGraphics(t,e){var o;o=t.props;if(!o)return;var i;i=d.DrawTypeDic[t.type];if(!i)return;var a=e;var r=d._getParams(o,i[1],i[2],i[3]);var s=d._tM;if(s||d._alpha!=1){a.save();if(s)a.transform(s);if(d._alpha!=1)a.alpha(d._alpha)}a[i[0]].apply(a,r);if(s||d._alpha!=1){a.restore()}}static _adptLineData(t){t[2]=parseFloat(t[0])+parseFloat(t[2]);t[3]=parseFloat(t[1])+parseFloat(t[3]);return t}static _adptTextureData(t){t[0]=T.Loader.getRes(t[0]);return t}static _adptLinesData(t){t[2]=d._getPointListByStr(t[2]);return t}static _isDrawType(t){if(t==="Image")return false;return t in d.DrawTypeDic}static _getParams(t,e,o=0,i=null){var a=d._temParam;a.length=e.length;var r,s;s=e.length;for(r=0;r<s;r++){a[r]=d._getObjVar(t,e[r][0],e[r][1])}d._alpha=d._getObjVar(t,"alpha",1);var n;n=d._getTransformData(t);if(n){if(!o)o=0;n.translate(a[o],a[o+1]);a[o]=a[o+1]=0;d._tM=n}else{d._tM=null}if(i&&d[i]){a=d[i](a)}return a}static _getPointListByStr(t){var e=t.split(",");var o,i;i=e.length;for(o=0;o<i;o++){e[o]=parseFloat(e[o])}return e}static _getObjVar(t,e,o){if(e in t){return t[e]}return o}}d.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};d._temParam=[];d._classMap={};class Ie extends e{constructor(){super();this._bits=0;this._children=Ie.ARRAY_EMPTY;this._extUIChild=Ie.ARRAY_EMPTY;this._parent=null;this.name="";this.destroyed=false;this.createGLBuffer()}createGLBuffer(){}_setBit(t,e){if(t===R.DISPLAY){var o=this._getBit(t);if(o!=e)this._updateDisplayedInstage()}if(e)this._bits|=t;else this._bits&=~t}_getBit(t){return(this._bits&t)!=0}_setUpNoticeChain(){if(this._getBit(R.DISPLAY))this._setBitUp(R.DISPLAY)}_setBitUp(t){var e=this;e._setBit(t,true);e=e._parent;while(e){if(e._getBit(t))return;e._setBit(t,true);e=e._parent}}on(t,e,o,i=null){if(t===L.DISPLAY||t===L.UNDISPLAY){if(!this._getBit(R.DISPLAY))this._setBitUp(R.DISPLAY)}return this._createListener(t,e,o,i,false)}once(t,e,o,i=null){if(t===L.DISPLAY||t===L.UNDISPLAY){if(!this._getBit(R.DISPLAY))this._setBitUp(R.DISPLAY)}return this._createListener(t,e,o,i,true)}destroy(t=true){this.destroyed=true;this._destroyAllComponent();this._parent&&this._parent.removeChild(this);if(this._children){if(t)this.destroyChildren();else this.removeChildren()}this.onDestroy();this._children=null;this.offAll()}onDestroy(){}destroyChildren(){if(this._children){for(var t=0,e=this._children.length;t<e;t++){this._children[0].destroy(true)}}}addChild(t){if(!t||this.destroyed||t===this)return t;if(t._zOrder)this._setBit(R.HAS_ZORDER,true);if(t._parent===this){var e=this.getChildIndex(t);if(e!==this._children.length-1){this._children.splice(e,1);this._children.push(t);this._childChanged()}}else{t._parent&&t._parent.removeChild(t);this._children===Ie.ARRAY_EMPTY&&(this._children=[]);this._children.push(t);t._setParent(this);this._childChanged()}return t}addInputChild(t){if(this._extUIChild==Ie.ARRAY_EMPTY){this._extUIChild=[t]}else{if(this._extUIChild.indexOf(t)>=0){return null}this._extUIChild.push(t)}return null}removeInputChild(t){var e=this._extUIChild.indexOf(t);if(e>=0){this._extUIChild.splice(e,1)}}addChildren(...t){var e=0,o=t.length;while(e<o){this.addChild(t[e++])}}addChildAt(t,e){if(!t||this.destroyed||t===this)return t;if(t._zOrder)this._setBit(R.HAS_ZORDER,true);if(e>=0&&e<=this._children.length){if(t._parent===this){var o=this.getChildIndex(t);this._children.splice(o,1);this._children.splice(e,0,t);this._childChanged()}else{t._parent&&t._parent.removeChild(t);this._children===Ie.ARRAY_EMPTY&&(this._children=[]);this._children.splice(e,0,t);t._setParent(this)}return t}else{throw new Error("appendChildAt:The index is out of bounds")}}getChildIndex(t){return this._children.indexOf(t)}getChildByName(t){var e=this._children;if(e){for(var o=0,i=e.length;o<i;o++){var a=e[o];if(a.name===t)return a}}return null}getChildAt(t){return this._children[t]||null}setChildIndex(t,e){var o=this._children;if(e<0||e>=o.length){throw new Error("setChildIndex:The index is out of bounds.")}var i=this.getChildIndex(t);if(i<0)throw new Error("setChildIndex:node is must child of this object.");o.splice(i,1);o.splice(e,0,t);this._childChanged();return t}_childChanged(t=null){}removeChild(t){if(!this._children)return t;var e=this._children.indexOf(t);return this.removeChildAt(e)}removeSelf(){this._parent&&this._parent.removeChild(this);return this}removeChildByName(t){var e=this.getChildByName(t);e&&this.removeChild(e);return e}removeChildAt(t){var e=this.getChildAt(t);if(e){this._children.splice(t,1);e._setParent(null)}return e}removeChildren(t=0,e=2147483647){if(this._children&&this._children.length>0){var o=this._children;if(t===0&&e>=o.length-1){var i=o;this._children=Ie.ARRAY_EMPTY}else{i=o.splice(t,e-t)}for(var a=0,r=i.length;a<r;a++){i[a]._setParent(null)}}return this}replaceChild(t,e){var o=this._children.indexOf(e);if(o>-1){this._children.splice(o,1,t);e._setParent(null);t._setParent(this);return t}return null}get numChildren(){return this._children.length}get parent(){return this._parent}_setParent(t){if(this._parent!==t){if(t){this._parent=t;this._onAdded();this.event(L.ADDED);if(this._getBit(R.DISPLAY)){this._setUpNoticeChain();t.displayedInStage&&this._displayChild(this,true)}t._childChanged(this)}else{this._onRemoved();this.event(L.REMOVED);this._parent._childChanged();if(this._getBit(R.DISPLAY))this._displayChild(this,false);this._parent=t}}}get displayedInStage(){if(this._getBit(R.DISPLAY))return this._getBit(R.DISPLAYED_INSTAGE);this._setBitUp(R.DISPLAY);return this._getBit(R.DISPLAYED_INSTAGE)}_updateDisplayedInstage(){var t;t=this;var e=T.stage;var o=false;while(t){if(t._getBit(R.DISPLAY)){o=t._getBit(R.DISPLAYED_INSTAGE);break}if(t===e||t._getBit(R.DISPLAYED_INSTAGE)){o=true;break}t=t._parent}this._setBit(R.DISPLAYED_INSTAGE,o)}_setDisplay(t){if(this._getBit(R.DISPLAYED_INSTAGE)!==t){this._setBit(R.DISPLAYED_INSTAGE,t);if(t)this.event(L.DISPLAY);else this.event(L.UNDISPLAY)}}_displayChild(t,e){var o=t._children;if(o){for(var i=0,a=o.length;i<a;i++){var r=o[i];if(!r._getBit(R.DISPLAY))continue;if(r._children.length>0){this._displayChild(r,e)}else{r._setDisplay(e)}}}t._setDisplay(e)}contains(t){if(t===this)return true;while(t){if(t._parent===this)return true;t=t._parent}return false}timerLoop(t,e,o,i=null,a=true,r=false){var s=this.scene?this.scene.timer:T.timer;s.loop(t,e,o,i,a,r)}timerOnce(t,e,o,i=null,a=true){var r=this.scene?this.scene.timer:T.timer;r._create(false,false,t,e,o,i,a)}frameLoop(t,e,o,i=null,a=true){var r=this.scene?this.scene.timer:T.timer;r._create(true,true,t,e,o,i,a)}frameOnce(t,e,o,i=null,a=true){var r=this.scene?this.scene.timer:T.timer;r._create(true,false,t,e,o,i,a)}clearTimer(t,e){var o=this.scene?this.scene.timer:T.timer;o.clear(t,e)}callLater(t,e=null){var o=this.scene?this.scene.timer:T.timer;o.callLater(this,t,e)}runCallLater(t){var e=this.scene?this.scene.timer:T.timer;e.runCallLater(this,t)}get scene(){return this._scene}get active(){return!this._getBit(R.NOT_READY)&&!this._getBit(R.NOT_ACTIVE)}set active(t){t=!!t;if(!this._getBit(R.NOT_ACTIVE)!==t){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){if(t)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";else throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event."}else{this._setBit(R.NOT_ACTIVE,!t);if(this._parent){if(this._parent.activeInHierarchy){if(t)this._processActive();else this._processInActive()}}}}}get activeInHierarchy(){return this._getBit(R.ACTIVE_INHIERARCHY)}_onActive(){m.spriteCount++}_onInActive(){m.spriteCount--}_onActiveInScene(){}_onInActiveInScene(){}_parse(t,e){}_setBelongScene(t){if(!this._scene){this._scene=t;this._onActiveInScene();for(var e=0,o=this._children.length;e<o;e++)this._children[e]._setBelongScene(t)}}_setUnBelongScene(){if(this._scene!==this){this._onInActiveInScene();this._scene=null;for(var t=0,e=this._children.length;t<e;t++)this._children[t]._setUnBelongScene()}}onAwake(){}onEnable(){}_processActive(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._activeHierarchy(this._activeChangeScripts);this._activeScripts()}_activeHierarchy(t){this._setBit(R.ACTIVE_INHIERARCHY,true);if(this._components){for(var e=0,o=this._components.length;e<o;e++){var i=this._components[e];i._setActive(true);i._isScript()&&i._enabled&&t.push(i)}}this._onActive();for(e=0,o=this._children.length;e<o;e++){var a=this._children[e];!a._getBit(R.NOT_ACTIVE)&&a._activeHierarchy(t)}if(!this._getBit(R.AWAKED)){this._setBit(R.AWAKED,true);this.onAwake()}this.onEnable()}_activeScripts(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].onEnable();this._activeChangeScripts.length=0}_processInActive(){this._activeChangeScripts||(this._activeChangeScripts=[]);this._inActiveHierarchy(this._activeChangeScripts);this._inActiveScripts()}_inActiveHierarchy(t){this._onInActive();if(this._components){for(var e=0,o=this._components.length;e<o;e++){var i=this._components[e];i._setActive(false);i._isScript()&&i._enabled&&t.push(i)}}this._setBit(R.ACTIVE_INHIERARCHY,false);for(e=0,o=this._children.length;e<o;e++){var a=this._children[e];a&&!a._getBit(R.NOT_ACTIVE)&&a._inActiveHierarchy(t)}this.onDisable()}_inActiveScripts(){for(var t=0,e=this._activeChangeScripts.length;t<e;t++)this._activeChangeScripts[t].onDisable();this._activeChangeScripts.length=0}onDisable(){}_onAdded(){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event."}else{var t=this._parent.scene;t&&this._setBelongScene(t);this._parent.activeInHierarchy&&this.active&&this._processActive()}}_onRemoved(){if(this._activeChangeScripts&&this._activeChangeScripts.length!==0){throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event."}else{this._parent.activeInHierarchy&&this.active&&this._processInActive();this._parent.scene&&this._setUnBelongScene()}}_addComponentInstance(t){this._components=this._components||[];this._components.push(t);t.owner=this;t._onAdded();if(this.activeInHierarchy){t._setActive(true);t._isScript()&&t._enabled&&t.onEnable()}}_destroyComponent(t){if(this._components){for(var e=0,o=this._components.length;e<o;e++){var i=this._components[e];if(i===t){i._destroy();this._components.splice(e,1);break}}}}_destroyAllComponent(){if(this._components){for(var t=0,e=this._components.length;t<e;t++){var o=this._components[t];o._destroy()}this._components.length=0}}_cloneTo(t,e,o){var i=t;if(this._components){for(var a=0,r=this._components.length;a<r;a++){var s=i.addComponent(this._components[a].constructor);this._components[a]._cloneTo(s)}}}addComponentIntance(t){if(t.owner)throw"Node:the component has belong to other node.";if(t.isSingleton&&this.getComponent(t.constructor))throw"Node:the component is singleton,can't add the second one.";this._addComponentInstance(t);return t}addComponent(t){var e=p.createByClass(t);e._destroyed=false;if(e.isSingleton&&this.getComponent(t))throw"无法实例"+t+"组件"+"，"+t+"组件已存在！";this._addComponentInstance(e);return e}getComponent(t){if(this._components){for(var e=0,o=this._components.length;e<o;e++){var i=this._components[e];if(i instanceof t)return i}}return null}getComponents(t){var e;if(this._components){for(var o=0,i=this._components.length;o<i;o++){var a=this._components[o];if(a instanceof t){e=e||[];e.push(a)}}}return e}get timer(){return this.scene?this.scene.timer:T.timer}}Ie.ARRAY_EMPTY=[];d.regClass("laya.display.Node",Ie);d.regClass("Laya.Node",Ie);class De{reset(){if(this.bounds)this.bounds.recover();if(this.userBounds)this.userBounds.recover();this.bounds=null;this.userBounds=null;this.temBM=null;return this}recover(){p.recover("BoundsStyle",this.reset())}static create(){return p.getItemByClass("BoundsStyle",De)}}class Le extends o{get source(){return this._source}_getSource(){return this._source}constructor(t=false){super();if(t)this._source=E.createElement("canvas");else{this._source=this}this.lock=true}clear(){this._ctx&&this._ctx.clear&&this._ctx.clear();if(this._texture){this._texture.destroy();this._texture=null}}destroy(){super.destroy();this._setCPUMemory(0);this._ctx&&this._ctx.destroy&&this._ctx.destroy();this._ctx=null}release(){}get context(){if(this._ctx)return this._ctx;if(this._source==this){this._ctx=new T.Context}else{this._ctx=this._source.getContext(T.Render.isConchApp?"layagl":"2d")}this._ctx._canvas=this;return this._ctx}_setContext(t){this._ctx=t}getContext(t,e=null){return this.context}getMemSize(){return 0}size(t,e){if(this._width!=t||this._height!=e||this._source&&(this._source.width!=t||this._source.height!=e)){this._width=t;this._height=e;this._setCPUMemory(t*e*4);this._ctx&&this._ctx.size&&this._ctx.size(t,e);if(this._source){this._source.height=e;this._source.width=t}if(this._texture){this._texture.destroy();this._texture=null}}}getTexture(){if(!this._texture){var t=new tt;t.loadImageSource(this.source);this._texture=new ae(t)}return this._texture}toBase64(t,e){if(this._source){if(T.Render.isConchApp){var o=window;if(o.conchConfig.threadMode==2){throw"native 2 thread mode use toBase64Async"}var i=this._ctx._targets.sourceWidth;var a=this._ctx._targets.sourceHeight;var r=this._ctx._targets.getData(0,0,i,a);return o.conchToBase64FlipY?o.conchToBase64FlipY(t,e,r.buffer,i,a):o.conchToBase64(t,e,r.buffer,i,a)}else{return this._source.toDataURL(t,e)}}return null}toBase64Async(i,a,r){var s=this._ctx._targets.sourceWidth;var n=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,s,n,function(t){let e=window;var o=e.conchToBase64FlipY?e.conchToBase64FlipY(i,a,t.buffer,s,n):e.conchToBase64(i,a,t.buffer,s,n);r(o)})}}class Ee{constructor(){this.reset()}needBitmapCache(){return this.cacheForFilters||!!this.mask}needEnableCanvasRender(){return this.userSetCache!="none"||this.cacheForFilters||!!this.mask}releaseContext(){if(this.canvas&&this.canvas.size){p.recover("CacheCanvas",this.canvas);this.canvas.size(0,0);try{this.canvas.width=0;this.canvas.height=0}catch(t){}}this.canvas=null}createContext(){if(!this.canvas){this.canvas=p.getItem("CacheCanvas")||new Le(false);var t=this.canvas.context;if(!t){t=this.canvas.getContext("2d")}}}releaseFilterCache(){var t=this.filterCache;if(t){t.destroy();t.recycle();this.filterCache=null}}recover(){if(this===Ee.EMPTY)return;p.recover("SpriteCache",this.reset())}reset(){this.releaseContext();this.releaseFilterCache();this.cacheAs="none";this.enableCanvasRender=false;this.userSetCache="none";this.cacheForFilters=false;this.staticCache=false;this.reCache=true;this.mask=null;this.maskParent=null;this.filterCache=null;this.filters=null;this.hasGlowFilter=false;if(this.cacheRect)this.cacheRect.recover();this.cacheRect=null;return this}static create(){return p.getItemByClass("SpriteCache",Ee)}_calculateCacheRect(t,e,o,i){var a=t._cacheStyle;if(!a.cacheRect)a.cacheRect=B.create();var r;if(e==="bitmap"){r=t.getSelfBounds();r.width=r.width+Ee.CANVAS_EXTEND_EDGE*2;r.height=r.height+Ee.CANVAS_EXTEND_EDGE*2;r.x=r.x-t.pivotX;r.y=r.y-t.pivotY;r.x=r.x-Ee.CANVAS_EXTEND_EDGE;r.y=r.y-Ee.CANVAS_EXTEND_EDGE;r.x=Math.floor(r.x+o)-o;r.y=Math.floor(r.y+i)-i;r.width=Math.floor(r.width);r.height=Math.floor(r.height);a.cacheRect.copyFrom(r)}else{a.cacheRect.setTo(-t._style.pivotX,-t._style.pivotY,1,1)}r=a.cacheRect;if(t._style.scrollRect){var s=t._style.scrollRect;r.x-=s.x;r.y-=s.y}Ee._scaleInfo.setTo(1,1);return Ee._scaleInfo}}Ee.EMPTY=new Ee;Ee._scaleInfo=new K;Ee.CANVAS_EXTEND_EDGE=16;class Ve{constructor(){this.reset()}reset(){this.scaleX=this.scaleY=1;this.skewX=this.skewY=0;this.pivotX=this.pivotY=this.rotation=0;this.alpha=1;if(this.scrollRect)this.scrollRect.recover();this.scrollRect=null;if(this.viewport)this.viewport.recover();this.viewport=null;this.hitArea=null;this.dragging=null;this.blendMode=null;return this}recover(){if(this===Ve.EMPTY)return;p.recover("SpriteStyle",this.reset())}static create(){return p.getItemByClass("SpriteStyle",Ve)}}Ve.EMPTY=new Ve;class Re{static __init__(){Re.map[P.ALPHA|P.TRANSFORM|P.GRAPHICS]=Re.alpha_transform_drawLayaGL;Re.map[P.ALPHA|P.GRAPHICS]=Re.alpha_drawLayaGL;Re.map[P.TRANSFORM|P.GRAPHICS]=Re.transform_drawLayaGL;Re.map[P.TRANSFORM|P.CHILDS]=Re.transform_drawNodes;Re.map[P.ALPHA|P.TRANSFORM|P.TEXTURE]=Re.alpha_transform_drawTexture;Re.map[P.ALPHA|P.TEXTURE]=Re.alpha_drawTexture;Re.map[P.TRANSFORM|P.TEXTURE]=Re.transform_drawTexture;Re.map[P.GRAPHICS|P.CHILDS]=Re.drawLayaGL_drawNodes}static transform_drawTexture(t,e,o,i){var a=t._style;var r=t.texture;e.saveTransform(Re.curMat);e.transformByMatrix(t.transform,o,i);e.drawTexture(r,-t.pivotX,-t.pivotY,t._width||r.width,t._height||r.height);e.restoreTransform(Re.curMat)}static alpha_drawTexture(t,e,o,i){var a=t._style;var r;var s=t.texture;if((r=a.alpha)>.01||t._needRepaint()){var n=e.globalAlpha;e.globalAlpha*=r;e.drawTexture(s,o-a.pivotX+s.offsetX,i-a.pivotY+s.offsetY,t._width||s.width,t._height||s.height);e.globalAlpha=n}}static alpha_transform_drawTexture(t,e,o,i){var a=t._style;var r;var s=t.texture;if((r=a.alpha)>.01||t._needRepaint()){var n=e.globalAlpha;e.globalAlpha*=r;e.saveTransform(Re.curMat);e.transformByMatrix(t.transform,o,i);e.drawTexture(s,-a.pivotX+s.offsetX,-a.pivotY+s.offsetY,t._width||s.width,t._height||s.height);e.restoreTransform(Re.curMat);e.globalAlpha=n}}static alpha_transform_drawLayaGL(t,e,o,i){var a=t._style;var r;if((r=a.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=r;e.saveTransform(Re.curMat);e.transformByMatrix(t.transform,o,i);t._graphics&&t._graphics._render(t,e,-a.pivotX,-a.pivotY);e.restoreTransform(Re.curMat);e.globalAlpha=s}}static alpha_drawLayaGL(t,e,o,i){var a=t._style;var r;if((r=a.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=r;t._graphics&&t._graphics._render(t,e,o-a.pivotX,i-a.pivotY);e.globalAlpha=s}}static transform_drawLayaGL(t,e,o,i){var a=t._style;e.saveTransform(Re.curMat);e.transformByMatrix(t.transform,o,i);t._graphics&&t._graphics._render(t,e,-a.pivotX,-a.pivotY);e.restoreTransform(Re.curMat)}static transform_drawNodes(t,e,o,i){var a=t._getBit(R.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(true);var r=t._style;e.saveTransform(Re.curMat);e.transformByMatrix(t.transform,o,i);o=-r.pivotX;i=-r.pivotY;var s=t._children,n=s.length,b;if(r.viewport){var x=r.viewport;var l=x.x;var _=x.y;var h=x.right;var d=x.bottom;var p,c;for(u=0;u<n;++u){if((b=s[u])._visible&&((p=b._x)<h&&p+b.width>l&&(c=b._y)<d&&c+b.height>_)){b.render(e,o,i)}}}else{for(var u=0;u<n;++u)(b=s[u])._visible&&b.render(e,o,i)}e.restoreTransform(Re.curMat);a&&e.drawCallOptimize(false)}static drawLayaGL_drawNodes(t,e,o,i){var a=t._getBit(R.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(true);var r=t._style;o=o-r.pivotX;i=i-r.pivotY;t._graphics&&t._graphics._render(t,e,o,i);var s=t._children,n=s.length,b;if(r.viewport){var x=r.viewport;var l=x.x;var _=x.y;var h=x.right;var d=x.bottom;var p,c;for(u=0;u<n;++u){if((b=s[u])._visible&&((p=b._x)<h&&p+b.width>l&&(c=b._y)<d&&c+b.height>_)){b.render(e,o,i)}}}else{for(var u=0;u<n;++u)(b=s[u])._visible&&b.render(e,o,i)}a&&e.drawCallOptimize(false)}}Re.map={};Re.curMat=new w;class Ge{constructor(t,e){if(Re.map[t]){this._fun=Re.map[t];this._next=Ge.NORENDER;return}this._next=e||Ge.NORENDER;switch(t){case 0:this._fun=this._no;return;case P.ALPHA:this._fun=this._alpha;return;case P.TRANSFORM:this._fun=this._transform;return;case P.BLEND:this._fun=this._blend;return;case P.CANVAS:this._fun=this._canvas;return;case P.MASK:this._fun=this._mask;return;case P.CLIP:this._fun=this._clip;return;case P.STYLE:this._fun=this._style;return;case P.GRAPHICS:this._fun=this._graphics;return;case P.CHILDS:this._fun=this._children;return;case P.CUSTOM:this._fun=this._custom;return;case P.TEXTURE:this._fun=this._texture;return;case P.FILTERS:this._fun=lt._filter;return;case Ge.INIT:this._fun=Ge._initRenderFun;return}this.onCreate(t)}static __init__(){Re.__init__();var t,e;var o;o=new Ge(Ge.INIT,null);e=Ge.renders.length=P.CHILDS*2;for(t=0;t<e;t++)Ge.renders[t]=o;Ge.renders[0]=new Ge(0,null)}static _initRenderFun(t,e,o,i){var a=t._renderType;var r=Ge.renders[a]=Ge._getTypeRender(a);r._fun(t,e,o,i)}static _getTypeRender(t){if(Re.map[t])return new Ge(t,null);var e=null;var o=P.CHILDS;while(o>0){if(o&t)e=new Ge(o,e);o=o>>1}return e}onCreate(t){}_style(t,e,o,i){var a=t._style;if(a.render!=null)a.render(t,e,o,i);var r=this._next;r._fun.call(r,t,e,o,i)}_no(t,e,o,i){}_custom(t,e,o,i){t.customRender(e,o,i);this._next._fun.call(this._next,t,e,o-t.pivotX,i-t.pivotY)}_clip(t,e,o,i){var a=this._next;if(a==Ge.NORENDER)return;var r=t._style.scrollRect;e.save();e.clipRect(o,i,r.width,r.height);a._fun.call(a,t,e,o-r.x,i-r.y);e.restore()}_texture(t,e,o,i){var a=t.texture;if(a._getSource())e.drawTexture(a,o-t.pivotX+a.offsetX,i-t.pivotY+a.offsetY,t._width||a.width,t._height||a.height);var r=this._next;if(r!=Ge.NORENDER)r._fun.call(r,t,e,o,i)}_graphics(t,e,o,i){var a=t._style;var r=t._graphics;r&&r._render(t,e,o-a.pivotX,i-a.pivotY);var s=this._next;if(s!=Ge.NORENDER)s._fun.call(s,t,e,o,i)}_image(t,e,o,i){var a=t._style;e.drawTexture2(o,i,a.pivotX,a.pivotY,t.transform,t._graphics._one)}_image2(t,e,o,i){var a=t._style;e.drawTexture2(o,i,a.pivotX,a.pivotY,t.transform,t._graphics._one)}_alpha(t,e,o,i){var a=t._style;var r;if((r=a.alpha)>.01||t._needRepaint()){var s=e.globalAlpha;e.globalAlpha*=r;var n=this._next;n._fun.call(n,t,e,o,i);e.globalAlpha=s}}_transform(t,e,o,i){var a=t.transform,r=this._next;var s=t._style;if(a&&r!=Ge.NORENDER){e.save();e.transform(a.a,a.b,a.c,a.d,a.tx+o,a.ty+i);r._fun.call(r,t,e,0,0);e.restore()}else{if(r!=Ge.NORENDER)r._fun.call(r,t,e,o,i)}}_children(t,e,o,i){var a=t._style;var r=t._children,s=r.length,n;o=o-t.pivotX;i=i-t.pivotY;var b=t._getBit(R.DRAWCALL_OPTIMIZE)&&e.drawCallOptimize(true);if(a.viewport){var x=a.viewport;var l=x.x;var _=x.y;var h=x.right;var d=x.bottom;var p,c;for(u=0;u<s;++u){if((n=r[u])._visible&&((p=n._x)<h&&p+n.width>l&&(c=n._y)<d&&c+n.height>_)){n.render(e,o,i)}}}else{for(var u=0;u<s;++u)(n=r[u])._visible&&n.render(e,o,i)}b&&e.drawCallOptimize(false)}_canvas(t,e,o,i){var a=t._cacheStyle;var r=this._next;if(!a.enableCanvasRender){r._fun.call(r,t,e,o,i);return}a.cacheAs==="bitmap"?m.canvasBitmap++:m.canvasNormal++;var s=false;var n=false;if(a.canvas){var b=a.canvas;var x=b.context;var l=b.touches;if(l){for(var _=0;_<l.length;_++){if(l[_].deleted){n=true;break}}}s=b.isCacheValid&&!b.isCacheValid()}if(t._needRepaint()||!a.canvas||n||s||T.stage.isGlobalRepaint()){if(a.cacheAs==="normal"){if(e._targets){r._fun.call(r,t,e,o,i);return}else{this._canvas_webgl_normal_repaint(t,e)}}else{this._canvas_repaint(t,e,o,i)}}var h=a.cacheRect;e.drawCanvas(a.canvas,o+h.x,i+h.y,h.width,h.height)}_canvas_repaint(t,e,o,i){var a=t._cacheStyle;var r=this._next;var s;var n=a.canvas;var b;var x;var l;var _=a.cacheAs;var h,d;var p,c;var u;u=a._calculateCacheRect(t,_,o,i);p=u.x;c=u.y;l=a.cacheRect;h=l.width*p;d=l.height*c;b=l.x;x=l.y;if(_==="bitmap"&&(h>2048||d>2048)){console.warn("cache bitmap size larger than 2048,cache ignored");a.releaseContext();r._fun.call(r,t,e,o,i);return}if(!n){a.createContext();n=a.canvas}s=n.context;s.sprite=t;(n.width!=h||n.height!=d)&&n.size(h,d);if(_==="bitmap")s.asBitmap=true;else if(_==="normal")s.asBitmap=false;s.clear();if(p!=1||c!=1){var y=s;y.save();y.scale(p,c);r._fun.call(r,t,s,-b,-x);y.restore();t._applyFilters()}else{y=s;r._fun.call(r,t,s,-b,-x);t._applyFilters()}if(a.staticCache)a.reCache=false;m.canvasReCache++}_canvas_webgl_normal_repaint(t,e){var o=t._cacheStyle;var i=this._next;var a=o.canvas;var r=o.cacheAs;var s=o._calculateCacheRect(t,r,0,0);if(!a){a=o.canvas=new kt(e,t)}var n=a.context;a["startRec"]();i._fun.call(i,t,n,t.pivotX,t.pivotY);t._applyFilters();m.canvasReCache++;a["endRec"]()}_blend(t,e,o,i){var a=t._style;var r=this._next;if(a.blendMode){e.save();e.globalCompositeOperation=a.blendMode;r._fun.call(r,t,e,o,i);e.restore()}else{r._fun.call(r,t,e,o,i)}}_mask(t,e,o,i){var a=this._next;var r=t.mask;var s=e;if(r){s.save();var n=s.globalCompositeOperation;var b=new B;b.copyFrom(r.getBounds());b.width=Math.round(b.width);b.height=Math.round(b.height);b.x=Math.round(b.x);b.y=Math.round(b.y);if(b.width>0&&b.height>0){var x=b.width;var l=b.height;var _=it.getRT(x,l);s.breakNextMerge();s.pushRT();s.addRenderObject(xt.create([s,_,x,l],Ge.tmpTarget,this));r.render(s,-b.x,-b.y);s.breakNextMerge();s.popRT();s.save();s.clipRect(o+b.x-t.getStyle().pivotX,i+b.y-t.getStyle().pivotY,x,l);a._fun.call(a,t,s,o,i);s.restore();n=s.globalCompositeOperation;s.addRenderObject(xt.create(["mask"],Ge.setBlendMode,this));var h=nt.create(D.TEXTURE2D,0);var d=ae.INV_UV;s.drawTarget(_,o+b.x-t.getStyle().pivotX,i+b.y-t.getStyle().pivotY,x,l,w.TEMP.identity(),h,d,6);s.addRenderObject(xt.create([_],Ge.recycleTarget,this));s.addRenderObject(xt.create([n],Ge.setBlendMode,this))}s.restore()}else{a._fun.call(a,t,e,o,i)}}static tmpTarget(t,e,o,i){e.start();e.clear(0,0,0,0)}static recycleTarget(t){it.releaseRT(t)}static setBlendMode(t){var e=u.mainContext;I.targetFns[I.TOINT[t]](e)}}Ge.INIT=69905;Ge.renders=[];Ge.NORENDER=new Ge(0,null);Ge.tempUV=new Array(8);class Fe extends Ie{constructor(){super();this._x=0;this._y=0;this._width=0;this._height=0;this._visible=true;this._mouseState=0;this._zOrder=0;this._renderType=0;this._transform=null;this._tfChanged=false;this._repaint=P.REPAINT_NONE;this._texture=null;this._style=Ve.EMPTY;this._cacheStyle=Ee.EMPTY;this._boundStyle=null;this._graphics=null;this.mouseThrough=false;this.autoSize=false;this.hitTestPrior=false}destroy(t=true){super.destroy(t);this._style&&this._style.recover();this._cacheStyle&&this._cacheStyle.recover();this._boundStyle&&this._boundStyle.recover();this._style=null;this._cacheStyle=null;this._boundStyle=null;this._transform=null;if(this._graphics&&this._graphics.autoDestroy){this._graphics.destroy()}this._graphics=null;this.texture=null}updateZOrder(){f.updateOrder(this._children)&&this.repaint()}_getBoundsStyle(){if(!this._boundStyle)this._boundStyle=De.create();return this._boundStyle}_setCustomRender(){}set customRenderEnable(t){if(t){this._renderType|=P.CUSTOM;this._setRenderType(this._renderType);this._setCustomRender()}}get cacheAs(){return this._cacheStyle.cacheAs}_setCacheAs(t){}set cacheAs(t){if(t===this._cacheStyle.userSetCache)return;if(this.mask&&t==="normal")return;this._setCacheAs(t);this._getCacheStyle().userSetCache=t;this._checkCanvasEnable();this.repaint()}_checkCanvasEnable(){var t=this._cacheStyle.needEnableCanvasRender();this._getCacheStyle().enableCanvasRender=t;if(t){if(this._cacheStyle.needBitmapCache()){this._cacheStyle.cacheAs="bitmap"}else{this._cacheStyle.cacheAs=this._cacheStyle.userSetCache}this._cacheStyle.reCache=true;this._renderType|=P.CANVAS}else{this._cacheStyle.cacheAs="none";this._cacheStyle.releaseContext();this._renderType&=~P.CANVAS}this._setCacheAs(this._cacheStyle.cacheAs);this._setRenderType(this._renderType)}get staticCache(){return this._cacheStyle.staticCache}set staticCache(t){this._getCacheStyle().staticCache=t;if(!t)this.reCache()}reCache(){this._cacheStyle.reCache=true;this._repaint|=P.REPAINT_CACHE}getRepaint(){return this._repaint}_setX(t){this._x=t}_setY(t){this._y=t}_setWidth(t,e){}_setHeight(t,e){}get x(){return this._x}set x(t){if(this.destroyed)return;if(this._x!==t){this._setX(t);this.parentRepaint(P.REPAINT_CACHE);var e=this._cacheStyle.maskParent;if(e){e.repaint(P.REPAINT_CACHE)}}}get y(){return this._y}set y(t){if(this.destroyed)return;if(this._y!==t){this._setY(t);this.parentRepaint(P.REPAINT_CACHE);var e=this._cacheStyle.maskParent;if(e){e.repaint(P.REPAINT_CACHE)}}}get width(){return this.get_width()}set width(t){this.set_width(t)}set_width(t){if(this._width!==t){this._width=t;this._setWidth(this.texture,t);this._setTranformChange()}}get_width(){if(!this.autoSize)return this._width||(this.texture?this.texture.width:0);if(this.texture)return this.texture.width;if(!this._graphics&&this._children.length===0)return 0;return this.getSelfBounds().width}get height(){return this.get_height()}set height(t){this.set_height(t)}set_height(t){if(this._height!==t){this._height=t;this._setHeight(this.texture,t);this._setTranformChange()}}get_height(){if(!this.autoSize)return this._height||(this.texture?this.texture.height:0);if(this.texture)return this.texture.height;if(!this._graphics&&this._children.length===0)return 0;return this.getSelfBounds().height}get displayWidth(){return this.width*this.scaleX}get displayHeight(){return this.height*this.scaleY}setSelfBounds(t){this._getBoundsStyle().userBounds=t}getBounds(){return this._getBoundsStyle().bounds=B._getWrapRec(this._boundPointsToParent())}getSelfBounds(){if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds;if(!this._graphics&&this._children.length===0&&!this._texture)return B.TEMP.setTo(0,0,this.width,this.height);return this._getBoundsStyle().bounds=B._getWrapRec(this._getBoundPointsM(false))}_boundPointsToParent(t=false){var e=0,o=0;if(this._style){e=this.pivotX;o=this.pivotY;t=t||this._style.rotation!==0;if(this._style.scrollRect){e+=this._style.scrollRect.x;o+=this._style.scrollRect.y}}var i=this._getBoundPointsM(t);if(!i||i.length<1)return i;if(i.length!=8){i=t?gt.scanPList(i):B._getWrapRec(i,B.TEMP)._getBoundPoints()}if(!this.transform){f.transPointList(i,this._x-e,this._y-o);return i}var a=K.TEMP;var r,s=i.length;for(r=0;r<s;r+=2){a.x=i[r];a.y=i[r+1];this.toParentPoint(a);i[r]=a.x;i[r+1]=a.y}return i}getGraphicBounds(t=false){if(!this._graphics)return B.TEMP.setTo(0,0,0,0);return this._graphics.getBounds(t)}_getBoundPointsM(t=false){if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(!this._boundStyle)this._getBoundsStyle();if(!this._boundStyle.temBM)this._boundStyle.temBM=[];if(this._style.scrollRect){var e=f.clearArray(this._boundStyle.temBM);var o=B.TEMP;o.copyFrom(this._style.scrollRect);f.concatArray(e,o._getBoundPoints());return e}var i;if(this._graphics){i=this._graphics.getBoundPoints()}else{i=f.clearArray(this._boundStyle.temBM);if(this._texture){o=B.TEMP;o.setTo(0,0,this.width||this._texture.width,this.height||this._texture.height);f.concatArray(i,o._getBoundPoints())}}var a;var r;var s;s=this._children;for(var n=0,b=s.length;n<b;n++){a=s[n];if(a instanceof Fe&&a._visible===true){r=a._boundPointsToParent(t);if(r)i=i?f.concatArray(i,r):r}}return i}_getCacheStyle(){this._cacheStyle===Ee.EMPTY&&(this._cacheStyle=Ee.create());return this._cacheStyle}getStyle(){this._style===Ve.EMPTY&&(this._style=Ve.create());return this._style}setStyle(t){this._style=t}get scaleX(){return this._style.scaleX}set scaleX(t){this.set_scaleX(t)}_setScaleX(t){this._style.scaleX=t}get scaleY(){return this._style.scaleY}set scaleY(t){this.set_scaleY(t)}_setScaleY(t){this._style.scaleY=t}set_scaleX(t){var e=this.getStyle();if(e.scaleX!==t){this._setScaleX(t);this._setTranformChange()}}get_scaleX(){return this._style.scaleX}set_scaleY(t){var e=this.getStyle();if(e.scaleY!==t){this._setScaleY(t);this._setTranformChange()}}get_scaleY(){return this._style.scaleY}get rotation(){return this._style.rotation}set rotation(t){var e=this.getStyle();if(e.rotation!==t){this._setRotation(t);this._setTranformChange()}}_setRotation(t){this._style.rotation=t}get skewX(){return this._style.skewX}set skewX(t){var e=this.getStyle();if(e.skewX!==t){this._setSkewX(t);this._setTranformChange()}}_setSkewX(t){this._style.skewX=t}get skewY(){return this._style.skewY}set skewY(t){var e=this.getStyle();if(e.skewY!==t){this._setSkewY(t);this._setTranformChange()}}_setSkewY(t){this._style.skewY=t}_createTransform(){return w.create()}_adjustTransform(){this._tfChanged=false;var t=this._style;var e=t.scaleX,o=t.scaleY;var i=t.skewX;var a=t.skewY;var r=t.rotation;var s=this._transform||(this._transform=this._createTransform());if(r||e!==1||o!==1||i!==0||a!==0){s._bTransform=true;var n=(r-i)*.0174532922222222;var b=(r+a)*.0174532922222222;var x=Math.cos(b);var l=Math.sin(b);var _=Math.sin(n);var h=Math.cos(n);s.a=e*x;s.b=e*l;s.c=-o*_;s.d=o*h;s.tx=s.ty=0}else{s.identity();this._renderType&=~P.TRANSFORM;this._setRenderType(this._renderType)}return s}_setTransform(t){}get transform(){return this._tfChanged?this._adjustTransform():this._transform}set transform(t){this.set_transform(t)}get_transform(){return this._tfChanged?this._adjustTransform():this._transform}set_transform(t){this._tfChanged=false;var e=this._transform||(this._transform=this._createTransform());t.copyTo(e);this._setTransform(e);if(t){this._x=e.tx;this._y=e.ty;e.tx=e.ty=0}if(t)this._renderType|=P.TRANSFORM;else{this._renderType&=~P.TRANSFORM}this._setRenderType(this._renderType);this.parentRepaint()}_setPivotX(t){var e=this.getStyle();e.pivotX=t}_getPivotX(){return this._style.pivotX}_setPivotY(t){var e=this.getStyle();e.pivotY=t}_getPivotY(){return this._style.pivotY}get pivotX(){return this._getPivotX()}set pivotX(t){this._setPivotX(t);this.repaint()}get pivotY(){return this._getPivotY()}set pivotY(t){this._setPivotY(t);this.repaint()}_setAlpha(t){if(this._style.alpha!==t){var e=this.getStyle();e.alpha=t;if(t!==1)this._renderType|=P.ALPHA;else this._renderType&=~P.ALPHA;this._setRenderType(this._renderType);this.parentRepaint()}}_getAlpha(){return this._style.alpha}get alpha(){return this._getAlpha()}set alpha(t){t=t<0?0:t>1?1:t;this._setAlpha(t)}get visible(){return this.get_visible()}set visible(t){this.set_visible(t)}get_visible(){return this._visible}set_visible(t){if(this._visible!==t){this._visible=t;this.parentRepaint(P.REPAINT_ALL)}}_setBlendMode(t){}get blendMode(){return this._style.blendMode}set blendMode(t){this._setBlendMode(t);this.getStyle().blendMode=t;if(t&&t!="source-over")this._renderType|=P.BLEND;else this._renderType&=~P.BLEND;this._setRenderType(this._renderType);this.parentRepaint()}get graphics(){if(!this._graphics){this.graphics=new Te;this._graphics.autoDestroy=true}return this._graphics}_setGraphics(t){}_setGraphicsCallBack(){}set graphics(t){if(this._graphics)this._graphics._sp=null;this._graphics=t;if(t){this._setGraphics(t);this._renderType|=P.GRAPHICS;t._sp=this}else{this._renderType&=~P.GRAPHICS}this._setRenderType(this._renderType);this.repaint()}get scrollRect(){return this._style.scrollRect}_setScrollRect(t){}set scrollRect(t){this.getStyle().scrollRect=t;this._setScrollRect(t);this.repaint();if(t){this._renderType|=P.CLIP}else{this._renderType&=~P.CLIP}this._setRenderType(this._renderType)}pos(t,e,o=false){if(this._x!==t||this._y!==e){if(this.destroyed)return this;if(o){this._setX(t);this._setY(e);this.parentRepaint(P.REPAINT_CACHE);var i=this._cacheStyle.maskParent;if(i){i.repaint(P.REPAINT_CACHE)}}else{this.x=t;this.y=e}}return this}pivot(t,e){this.pivotX=t;this.pivotY=e;return this}size(t,e){this.width=t;this.height=e;return this}scale(t,e,o=false){var i=this.getStyle();if(i.scaleX!=t||i.scaleY!=e){if(this.destroyed)return this;if(o){this._setScaleX(t);this._setScaleY(e);this._setTranformChange()}else{this.scaleX=t;this.scaleY=e}}return this}skew(t,e){this.skewX=t;this.skewY=e;return this}render(t,e,o){Ge.renders[this._renderType]._fun(this,t,e+this._x,o+this._y);this._repaint=0}drawToCanvas(t,e,o,i){return Fe.drawToCanvas(this,this._renderType,t,e,o,i)}drawToTexture(t,e,o,i){return Fe.drawToTexture(this,this._renderType,t,e,o,i)}drawToTexture3D(t,e,o){throw"not implement"}customRender(t,e,o){this._repaint=P.REPAINT_ALL}_applyFilters(){}get filters(){return this._cacheStyle.filters}_setColorFilter(t){}set filters(t){t&&t.length===0&&(t=null);if(this._cacheStyle.filters==t)return;this._getCacheStyle().filters=t?t.slice():null;if(t&&t.length){this._setColorFilter(t[0]);this._renderType|=P.FILTERS}else{this._setColorFilter(null);this._renderType&=~P.FILTERS}this._setRenderType(this._renderType);if(t&&t.length>0){if(!this._getBit(R.DISPLAY))this._setBitUp(R.DISPLAY);if(!(t.length==1&&t[0]instanceof _t)){this._getCacheStyle().cacheForFilters=true;this._checkCanvasEnable()}}else{if(this._cacheStyle.cacheForFilters){this._cacheStyle.cacheForFilters=false;this._checkCanvasEnable()}}this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter();this.repaint()}_isHaveGlowFilter(){var t,e;if(this.filters){for(t=0;t<this.filters.length;t++){if(this.filters[t].type==lt.GLOW){return true}}}for(t=0,e=this._children.length;t<e;t++){if(this._children[t]._isHaveGlowFilter()){return true}}return false}localToGlobal(t,e=false,o=null){if(e===true){t=new K(t.x,t.y)}var i=this;o=o||T.stage;while(i&&!i.destroyed){if(i==o)break;t=i.toParentPoint(t);i=i.parent}return t}globalToLocal(t,e=false,o=null){if(e){t=new K(t.x,t.y)}var i=this;var a=[];o=o||T.stage;while(i&&!i.destroyed){if(i==o)break;a.push(i);i=i.parent}var r=a.length-1;while(r>=0){i=a[r];t=i.fromParentPoint(t);r--}return t}toParentPoint(t){if(!t)return t;t.x-=this.pivotX;t.y-=this.pivotY;if(this.transform){this._transform.transformPoint(t)}t.x+=this._x;t.y+=this._y;var e=this._style.scrollRect;if(e){t.x-=e.x;t.y-=e.y}return t}fromParentPoint(t){if(!t)return t;t.x-=this._x;t.y-=this._y;var e=this._style.scrollRect;if(e){t.x+=e.x;t.y+=e.y}if(this.transform){this._transform.invertTransformPoint(t)}t.x+=this.pivotX;t.y+=this.pivotY;return t}fromStagePoint(t){return t}on(t,e,o,i=null){if(this._mouseState!==1&&this.isMouseEvent(t)){this.mouseEnabled=true;this._setBit(R.HAS_MOUSE,true);if(this._parent){this._onDisplay()}return this._createListener(t,e,o,i,false)}return super.on(t,e,o,i)}once(t,e,o,i=null){if(this._mouseState!==1&&this.isMouseEvent(t)){this.mouseEnabled=true;this._setBit(R.HAS_MOUSE,true);if(this._parent){this._onDisplay()}return this._createListener(t,e,o,i,true)}return super.once(t,e,o,i)}_onDisplay(t){if(this._mouseState!==1){var e=this;e=e.parent;while(e&&e._mouseState!==1){if(e._getBit(R.HAS_MOUSE))break;e.mouseEnabled=true;e._setBit(R.HAS_MOUSE,true);e=e.parent}}}_setParent(t){super._setParent(t);if(t&&this._getBit(R.HAS_MOUSE)){this._onDisplay()}}loadImage(t,e=null){if(!t){this.texture=null;i.call(this)}else{var o=T.Loader.getRes(t);if(!o){o=new ae;o.load(t);T.Loader.cacheRes(t,o)}this.texture=o;if(!o.getIsReady())o.once(L.READY,this,i);else i.call(this)}function i(){this.repaint(P.REPAINT_ALL);e&&e.run()}return this}static fromImage(t){return(new Fe).loadImage(t)}repaint(t=P.REPAINT_CACHE){if(!(this._repaint&t)){this._repaint|=t;this.parentRepaint(t)}if(this._cacheStyle&&this._cacheStyle.maskParent){this._cacheStyle.maskParent.repaint(t)}}_needRepaint(){return this._repaint&P.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}_childChanged(t=null){if(this._children.length)this._renderType|=P.CHILDS;else this._renderType&=~P.CHILDS;this._setRenderType(this._renderType);if(t&&this._getBit(R.HAS_ZORDER))T.systemTimer.callLater(this,this.updateZOrder);this.repaint(P.REPAINT_ALL)}parentRepaint(t=P.REPAINT_CACHE){var e=this._parent;if(e&&!(e._repaint&t)){e._repaint|=t;e.parentRepaint(t)}}get stage(){return T.stage}get hitArea(){return this._style.hitArea}set hitArea(t){this.getStyle().hitArea=t}_setMask(t){}get mask(){return this._cacheStyle.mask}set mask(t){if(t&&this.mask&&this.mask._cacheStyle.maskParent)return;this._getCacheStyle().mask=t;this._setMask(t);this._checkCanvasEnable();if(t){t._getCacheStyle().maskParent=this}else{if(this.mask){this.mask._getCacheStyle().maskParent=null}}this._renderType|=P.MASK;this._setRenderType(this._renderType);this.parentRepaint(P.REPAINT_ALL)}get mouseEnabled(){return this._mouseState>1}set mouseEnabled(t){this._mouseState=t?2:1}startDrag(t=null,e=false,o=0,i=300,a=null,r=false,s=.92){this._style.dragging||(this.getStyle().dragging=new T.Dragging);this._style.dragging.start(this,t,e,o,i,a,r,s)}stopDrag(){this._style.dragging&&this._style.dragging.stop()}_setDisplay(t){if(!t){if(this._cacheStyle){this._cacheStyle.releaseContext();this._cacheStyle.releaseFilterCache();if(this._cacheStyle.hasGlowFilter){this._cacheStyle.hasGlowFilter=false}}}super._setDisplay(t)}hitTestPoint(t,e){var o=this.globalToLocal(K.TEMP.setTo(t,e));t=o.x;e=o.y;var i=this._style.hitArea?this._style.hitArea:this._width>0&&this._height>0?B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds();return i.contains(t,e)}getMousePoint(){return this.globalToLocal(K.TEMP.setTo(T.stage.mouseX,T.stage.mouseY))}get globalScaleX(){var t=1;var e=this;while(e){if(e===T.stage)break;t*=e.scaleX;e=e.parent}return t}get globalRotation(){var t=0;var e=this;while(e){if(e===T.stage)break;t+=e.rotation;e=e.parent}return t}get globalScaleY(){var t=1;var e=this;while(e){if(e===T.stage)break;t*=e.scaleY;e=e.parent}return t}get mouseX(){return this.getMousePoint().x}get mouseY(){return this.getMousePoint().y}get zOrder(){return this._zOrder}set zOrder(t){if(this._zOrder!=t){this._zOrder=t;if(this._parent){t&&this._parent._setBit(R.HAS_ZORDER,true);T.systemTimer.callLater(this._parent,this.updateZOrder)}}}get texture(){return this._texture}_setTexture(t){}set texture(t){if(typeof t=="string"){this.loadImage(t)}else if(this._texture!=t){this._texture&&this._texture._removeReference();this._texture=t;t&&t._addReference();this._setTexture(t);this._setWidth(this._texture,this.width);this._setHeight(this._texture,this.height);if(t)this._renderType|=P.TEXTURE;else this._renderType&=~P.TEXTURE;this._setRenderType(this._renderType);this.repaint()}}get viewport(){return this._style.viewport}set viewport(t){if(typeof t=="string"){var e;e=t.split(",");if(e.length>3){t=new B(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]))}}this.getStyle().viewport=t}_setRenderType(t){}_setTranformChange(){this._tfChanged=true;this._renderType|=P.TRANSFORM;this.parentRepaint(P.REPAINT_CACHE)}_setBgStyleColor(t,e,o,i,a){}_setBorderStyleColor(t,e,o,i,a,r){}captureMouseEvent(t){T.MouseManager.instance.setCapture(this,t)}releaseMouseEvent(){T.MouseManager.instance.releaseCapture()}set drawCallOptimize(t){this._setBit(R.DRAWCALL_OPTIMIZE,t)}get drawCallOptimize(){return this._getBit(R.DRAWCALL_OPTIMIZE)}}Fe.drawToCanvas=function(t,e,o,i,a,r){a-=t.x;r-=t.y;a|=0;r|=0;o|=0;i|=0;var s=new z;s.size(o,i);s.asBitmap=true;s._targets.start();Ge.renders[e]._fun(t,s,a,r);s.flush();s._targets.end();s._targets.restore();var n=s._targets.getData(0,0,o,i);s.destroy();var b=new ImageData(o,i);var x=o*4;var l=b.data;var _=i-1;var h=_*x;var d=0;for(;_>=0;_--){l.set(n.subarray(d,d+x),h);h-=x;d+=x}var p=new Le(true);p.size(o,i);var c=p.getContext("2d");c.putImageData(b,0,0);return p};Fe.drawToTexture=function(t,e,o,i,a,r){a-=t.x;r-=t.y;a|=0;r|=0;o|=0;i|=0;var s=new z;s.size(o,i);s.asBitmap=true;s._targets.start();Ge.renders[e]._fun(t,s,a,r);s.flush();s._targets.end();s._targets.restore();var n=new ae(s._targets,ae.INV_UV);s.destroy(true);return n};d.regClass("laya.display.Sprite",Fe);d.regClass("Laya.Sprite",Fe);class Je extends Ve{constructor(){super(...arguments);this.italic=false}reset(){super.reset();this.italic=false;this.align="left";this.wordWrap=false;this.leading=0;this.padding=[0,0,0,0];this.bgColor=null;this.borderColor=null;this.asPassword=false;this.stroke=0;this.strokeColor="#000000";this.bold=false;this.underline=false;this.underlineColor=null;this.currBitmapFont=null;return this}recover(){if(this===Je.EMPTY)return;p.recover("TextStyle",this.reset())}static create(){return p.getItemByClass("TextStyle",Je)}render(t,e,o,i){(this.bgColor||this.borderColor)&&e.drawRect(o,i,t.width,t.height,this.bgColor,this.borderColor,1)}}Je.EMPTY=new Je;class G extends Fe{constructor(){super();this._textWidth=0;this._textHeight=0;this._lines=[];this._lineWidths=[];this._startX=0;this._startY=0;this._charSize={};this._valign="top";this._fontSize=G.defaultFontSize;this._font=G.defaultFont;this._color="#000000";this._singleCharRender=false;this.overflow=G.VISIBLE;this._style=Je.EMPTY}static defaultFontStr(){return G.defaultFontSize+"px "+G.defaultFont}getStyle(){this._style===Je.EMPTY&&(this._style=Je.create());return this._style}_getTextStyle(){if(this._style===Je.EMPTY){this._style=Je.create()}return this._style}static registerBitmapFont(t,e){G._bitmapFonts||(G._bitmapFonts={});G._bitmapFonts[t]=e}static unregisterBitmapFont(t,e=true){if(G._bitmapFonts&&G._bitmapFonts[t]){var o=G._bitmapFonts[t];if(e)o.destroy();delete G._bitmapFonts[t]}}destroy(t=true){super.destroy(t);this._clipPoint=null;this._lines=null;this._lineWidths=null;this._words&&this._words.forEach(function(t){t.cleanCache()});this._words=null;this._charSize=null}_getBoundPointsM(t=false){var e=B.TEMP;e.setTo(0,0,this.width,this.height);return e._getBoundPoints()}getGraphicBounds(t=false){var e=B.TEMP;e.setTo(0,0,this.width,this.height);return e}get width(){if(this._width)return this._width;return this.textWidth+this.padding[1]+this.padding[3]}set width(t){if(t!=this._width){super.set_width(t);this.isChanged=true;if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1)}}}_getCSSStyle(){return this._style}get height(){if(this._height)return this._height;return this.textHeight}set height(t){if(t!=this._height){super.set_height(t);this.isChanged=true;if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1)}}}get textWidth(){this._isChanged&&T.systemTimer.runCallLater(this,this.typeset);return this._textWidth}get textHeight(){this._isChanged&&T.systemTimer.runCallLater(this,this.typeset);return this._textHeight}get text(){return this._text||""}get_text(){return this._text||""}set_text(t){if(this._text!==t){this.lang(t+"");this.isChanged=true;this.event(L.CHANGE);if(this.borderColor){this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1)}}}set text(t){this.set_text(t)}lang(t,e=null,o=null,i=null,a=null,r=null,s=null,n=null,b=null,x=null,l=null){t=G.langPacks&&G.langPacks[t]?G.langPacks[t]:t;if(arguments.length<2){this._text=t}else{for(var _=0,h=arguments.length;_<h;_++){t=t.replace("{"+_+"}",arguments[_+1])}this._text=t}}get font(){return this._font}set font(t){if(this._style.currBitmapFont){this._getTextStyle().currBitmapFont=null;this.scale(1,1)}if(G._bitmapFonts&&G._bitmapFonts[t]){this._getTextStyle().currBitmapFont=G._bitmapFonts[t]}this._font=t;this.isChanged=true}get fontSize(){return this._fontSize}set fontSize(t){if(this._fontSize!=t){this._fontSize=t;this.isChanged=true}}get bold(){return this._style.bold}set bold(t){this._getTextStyle().bold=t;this.isChanged=true}get color(){return this._color}set color(t){this.set_color(t)}get_color(){return this._color}set_color(t){if(this._color!=t){this._color=t;if(!this._isChanged&&this._graphics){this._graphics.replaceTextColor(this.color)}else{this.isChanged=true}}}get italic(){return this._style.italic}set italic(t){this._getTextStyle().italic=t;this.isChanged=true}get align(){return this._style.align}set align(t){this._getTextStyle().align=t;this.isChanged=true}get valign(){return this._valign}set valign(t){this._valign=t;this.isChanged=true}get wordWrap(){return this._style.wordWrap}set wordWrap(t){this._getTextStyle().wordWrap=t;this.isChanged=true}get leading(){return this._style.leading}set leading(t){this._getTextStyle().leading=t;this.isChanged=true}get padding(){return this._style.padding}set padding(t){if(typeof t=="string"){var e;e=t.split(",");var o,i;i=e.length;while(e.length<4){e.push(0)}for(o=0;o<i;o++){e[o]=parseFloat(e[o])||0}t=e}this._getTextStyle().padding=t;this.isChanged=true}get bgColor(){return this._style.bgColor}set bgColor(t){this.set_bgColor(t)}set_bgColor(t){this._getTextStyle().bgColor=t;this._renderType|=P.STYLE;this._setBgStyleColor(0,0,this.width,this.height,t);this._setRenderType(this._renderType);this.isChanged=true}get_bgColor(){return this._style.bgColor}get borderColor(){return this._style.borderColor}set borderColor(t){this._getTextStyle().borderColor=t;this._renderType|=P.STYLE;this._setBorderStyleColor(0,0,this.width,this.height,t,1);this._setRenderType(this._renderType);this.isChanged=true}get stroke(){return this._style.stroke}set stroke(t){this._getTextStyle().stroke=t;this.isChanged=true}get strokeColor(){return this._style.strokeColor}set strokeColor(t){this._getTextStyle().strokeColor=t;this.isChanged=true}set isChanged(t){if(this._isChanged!==t){this._isChanged=t;t&&T.systemTimer.callLater(this,this.typeset)}}_getContextFont(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(T.Browser.onIPhone?G.fontFamilyMap[this.font]||this.font:this.font)}_isPassWordMode(){var t=this._style;var e=t.asPassword;if("prompt"in this&&this["prompt"]==this._text)e=false;return e}_getPassWordTxt(t){var e=t.length;var o;o="";for(var i=e;i>0;i--){o+="●"}return o}_renderText(){var t=this.padding;var e=this._lines.length;if(this.overflow!=G.VISIBLE){e=Math.min(e,Math.floor((this.height-t[0]-t[2])/(this.leading+this._charSize.height))+1)}var o=this.scrollY/(this._charSize.height+this.leading)|0;var i=this.graphics;i.clear(true);var a=this._getContextFont();T.Browser.context.font=a;var r=t[3];var s="left";var n=this._lines;var b=this.leading+this._charSize.height;var x=this._style.currBitmapFont;if(x){b=this.leading+x.getMaxHeight()}var l=t[0];if(!x&&this._width>0&&this._textWidth<=this._width){if(this.align=="right"){s="right";r=this._width-t[1]}else if(this.align=="center"){s="center";r=this._width*.5+t[3]-t[1]}}if(this._height>0){var _=this._textHeight>this._height?"top":this.valign;if(_==="middle")l=(this._height-e*b)*.5+t[0]-t[2];else if(_==="bottom")l=this._height-e*b-t[2]}var h=this._style;if(x&&x.autoScaleSize){var d=x.fontSize/this.fontSize}if(this._clipPoint){i.save();if(x&&x.autoScaleSize){var p;var c;this._width?p=this._width-t[3]-t[1]:p=this._textWidth;this._height?c=this._height-t[0]-t[2]:c=this._textHeight;p*=d;c*=d;i.clipRect(t[3],t[0],p,c)}else{i.clipRect(t[3],t[0],this._width?this._width-t[3]-t[1]:this._textWidth,this._height?this._height-t[0]-t[2]:this._textHeight)}this.repaint()}var u=h.asPassword;if("prompt"in this&&this["prompt"]==this._text)u=false;var y=0,m=0;var f=Math.min(this._lines.length,e+o)||1;for(var g=o;g<f;g++){var v=n[g];var S;if(u){var C=v.length;v="";for(var P=C;P>0;P--){v+="●"}}if(v==null)v="";y=r-(this._clipPoint?this._clipPoint.x:0);m=l+b*g-(this._clipPoint?this._clipPoint.y:0);this.underline&&this._drawUnderline(s,y,m,g);if(x){var A=this.width;if(x.autoScaleSize){A=this.width*d}x._drawText(v,this,y,m,this.align,A)}else{this._words||(this._words=[]);if(this._words.length>g-o){S=this._words[g-o]}else{S=new se;this._words.push(S)}S.setText(v);S.splitRender=this._singleCharRender;h.stroke?i.fillBorderText(S,y,m,a,this.color,h.strokeColor,h.stroke,s):i.fillText(S,y,m,a,this.color,s)}}if(x&&x.autoScaleSize){var B=1/d;this.scale(B,B)}if(this._clipPoint)i.restore();this._startX=r;this._startY=l}_drawUnderline(t,e,o,i){var a=this._lineWidths[i];switch(t){case"center":e-=a/2;break;case"right":e-=a;break;case"left":default:break}o+=this._charSize.height;this._graphics.drawLine(e,o,e+a,o,this.underlineColor||this.color,1)}typeset(){this._isChanged=false;if(!this._text){this._clipPoint=null;this._textWidth=this._textHeight=0;this.graphics.clear(true);return}if(T.Render.isConchApp){window.conchTextCanvas.font=this._getContextFont()}else{T.Browser.context.font=this._getContextFont()}this._lines.length=0;this._lineWidths.length=0;if(this._isPassWordMode()){this._parseLines(this._getPassWordTxt(this._text))}else this._parseLines(this._text);this._evalTextSize();if(this._checkEnabledViewportOrNot())this._clipPoint||(this._clipPoint=new K(0,0));else this._clipPoint=null;this._renderText()}_evalTextSize(){var t,e;t=Math.max.apply(this,this._lineWidths);if(this._style.currBitmapFont)e=this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2];else e=this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];if(t!=this._textWidth||e!=this._textHeight){this._textWidth=t;this._textHeight=e}}_checkEnabledViewportOrNot(){return this.overflow==G.SCROLL&&(this._width>0&&this._textWidth>this._width||this._height>0&&this._textHeight>this._height)}changeText(t){if(this._text!==t){this.lang(t+"");if(this._graphics&&this._graphics.replaceText(this._text));else{this.typeset()}}}_parseLines(t){var e=this.wordWrap||this.overflow==G.HIDDEN;if(e){var o=this._getWordWrapWidth()}var i=this._style.currBitmapFont;if(i){this._charSize.width=i.getMaxWidth();this._charSize.height=i.getMaxHeight()}else{var a=null;if(T.Render.isConchApp){a=window.conchTextCanvas.measureText(G._testWord)}else{a=T.Browser.context.measureText(G._testWord)}if(!a)a={width:100};this._charSize.width=a.width;this._charSize.height=a.height||this.fontSize}var r=t.replace(/\r\n/g,"\n").split("\n");for(var s=0,n=r.length;s<n;s++){var b=r[s];if(e)this._parseLine(b,o);else{this._lineWidths.push(this._getTextWidth(b));this._lines.push(b)}}}_parseLine(t,e){var o=this._lines;var i=0;var a=0;var r=0;var s=0;a=this._getTextWidth(t);if(a<=e){o.push(t);this._lineWidths.push(a);return}a=this._charSize.width;i=Math.floor(e/a);i==0&&(i=1);a=this._getTextWidth(t.substring(0,i));r=a;for(var n=i,b=t.length;n<b;n++){a=this._getTextWidth(t.charAt(n));r+=a;if(r>e){if(this.wordWrap){var x=t.substring(s,n);if(x.charCodeAt(x.length-1)<255){var l=/(?:\w|-)+$/.exec(x);if(l){n=l.index+s;if(l.index==0)n+=x.length;else x=t.substring(s,n)}}o.push(x);this._lineWidths.push(r-a);s=n;if(n+i<b){n+=i;a=this._getTextWidth(t.substring(s,n));r=a;n--}else{o.push(t.substring(s,b));this._lineWidths.push(this._getTextWidth(o[o.length-1]));s=-1;break}}else if(this.overflow==G.HIDDEN){o.push(t.substring(0,n));this._lineWidths.push(this._getTextWidth(o[o.length-1]));return}}}if(this.wordWrap&&s!=-1){o.push(t.substring(s,b));this._lineWidths.push(this._getTextWidth(o[o.length-1]))}}_getTextWidth(t){var e=this._style.currBitmapFont;if(e)return e.getTextWidth(t);else{if(T.Render.isConchApp){return window.conchTextCanvas.measureText(t).width}else return T.Browser.context.measureText(t).width}}_getWordWrapWidth(){var t=this.padding;var e;var o=this._style.currBitmapFont;if(o&&o.autoScaleSize)e=this._width*(o.fontSize/this.fontSize);else e=this._width;if(e<=0){e=this.wordWrap?100:T.Browser.width}e<=0&&(e=100);return e-t[3]-t[1]}getCharPoint(t,e=null){this._isChanged&&T.systemTimer.runCallLater(this,this.typeset);var o=0,i=this._lines,a=0;for(var r=0,s=i.length;r<s;r++){o+=i[r].length;if(t<o){var n=r;break}a=o}var b=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;T.Browser.context.font=b;var x=this._getTextWidth(this._text.substring(a,t));var l=e||new K;return l.setTo(this._startX+x-(this._clipPoint?this._clipPoint.x:0),this._startY+n*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}set scrollX(t){if(this.overflow!=G.SCROLL||(this.textWidth<this._width||!this._clipPoint))return;t=t<this.padding[3]?this.padding[3]:t;var e=this._textWidth-this._width;t=t>e?e:t;this._clipPoint.x=t;this._renderText()}get scrollX(){if(!this._clipPoint)return 0;return this._clipPoint.x}set scrollY(t){if(this.overflow!=G.SCROLL||(this.textHeight<this._height||!this._clipPoint))return;t=t<this.padding[0]?this.padding[0]:t;var e=this._textHeight-this._height;t=t>e?e:t;this._clipPoint.y=t;this._renderText()}get scrollY(){if(!this._clipPoint)return 0;return this._clipPoint.y}get maxScrollX(){return this.textWidth<this._width?0:this._textWidth-this._width}get maxScrollY(){return this.textHeight<this._height?0:this._textHeight-this._height}get lines(){if(this._isChanged)this.typeset();return this._lines}get underlineColor(){return this._style.underlineColor}set underlineColor(t){this._getTextStyle().underlineColor=t;if(!this._isChanged)this._renderText()}get underline(){return this._style.underline}set underline(t){this._getTextStyle().underline=t}set singleCharRender(t){this._singleCharRender=t}get singleCharRender(){return this._singleCharRender}}G.VISIBLE="visible";G.SCROLL="scroll";G.HIDDEN="hidden";G.defaultFontSize=12;G.defaultFont="Arial";G.isComplexText=false;G.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"};G._testWord="游";G.CharacterCache=true;G.RightToLeft=false;T.regClass(G);d.regClass("laya.display.Text",G);d.regClass("Laya.Text",G);class l extends G{constructor(){super();this._multiline=false;this._editable=true;this._maxChars=1e5;this._type="text";this._prompt="";this._promptColor="#A9A9A9";this._originColor="#000000";this._content="";l.IOS_IFRAME=T.Browser.onIOS&&T.Browser.window.top!=T.Browser.window.self;this._width=100;this._height=20;this.multiline=false;this.overflow=G.SCROLL;this.on(L.MOUSE_DOWN,this,this._onMouseDown);this.on(L.UNDISPLAY,this,this._onUnDisplay)}static __init__(){l._createInputElement();if(T.Browser.onMobile){var t=false;if(T.Browser.onMiniGame||T.Browser.onBDMiniGame||T.Browser.onQGMiniGame||T.Browser.onKGMiniGame||T.Browser.onVVMiniGame||T.Browser.onAlipayMiniGame||T.Browser.onQQMiniGame){t=true}T.Render.canvas.addEventListener(l.IOS_IFRAME?t?"touchend":"click":"touchend",l._popupInputMethod)}}static _popupInputMethod(t){if(!l.isInputting)return;var e=l.inputElement;e.focus()}static _createInputElement(){l._initInput(l.area=T.Browser.createElement("textarea"));l._initInput(l.input=T.Browser.createElement("input"));l.inputContainer=T.Browser.createElement("div");l.inputContainer.style.position="absolute";l.inputContainer.style.zIndex=1e5;T.Browser.container.appendChild(l.inputContainer);l.inputContainer.setPos=function(t,e){l.inputContainer.style.left=t+"px";l.inputContainer.style.top=e+"px"}}static _initInput(e){var t=e.style;t.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;";t.resize="none";t.backgroundColor="transparent";t.border="none";t.outline="none";t.zIndex=1;e.addEventListener("input",l._processInputting);e.addEventListener("mousemove",l._stopEvent);e.addEventListener("mousedown",l._stopEvent);e.addEventListener("touchmove",l._stopEvent);e.setFontFace=function(t){e.style.fontFamily=t};if(!T.Render.isConchApp){e.setColor=function(t){e.style.color=t};e.setFontSize=function(t){e.style.fontSize=t+"px"}}}static _processInputting(t){var e=l.inputElement.target;if(!e)return;var o=l.inputElement.value;if(e._restrictPattern){o=o.replace(/\u2006|\x27/g,"");if(e._restrictPattern.test(o)){o=o.replace(e._restrictPattern,"");l.inputElement.value=o}}e._text=o;e.event(L.INPUT)}static _stopEvent(t){if(t.type=="touchmove")t.preventDefault();t.stopPropagation&&t.stopPropagation()}setSelection(t,e){this.focus=true;l.inputElement.selectionStart=t;l.inputElement.selectionEnd=e}get multiline(){return this._multiline}set multiline(t){this._multiline=t;this.valign=t?"top":"middle"}get nativeInput(){return this._multiline?l.area:l.input}_onUnDisplay(t=null){this.focus=false}_onMouseDown(t){this.focus=true}_syncInputTransform(){var t=this.nativeInput;var e=f.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]);var o=this._width-this.padding[1]-this.padding[3];var i=this._height-this.padding[0]-this.padding[2];if(T.Render.isConchApp){t.setScale(e.scaleX,e.scaleY);t.setSize(o,i);t.setPos(e.x,e.y)}else{l.inputContainer.style.transform=l.inputContainer.style.webkitTransform="scale("+e.scaleX+","+e.scaleY+") rotate("+T.stage.canvasDegree+"deg)";t.style.width=o+"px";t.style.height=i+"px";l.inputContainer.style.left=e.x+"px";l.inputContainer.style.top=e.y+"px"}}select(){this.nativeInput.select()}get focus(){return this._focus}set focus(t){var e=this.nativeInput;if(this._focus!==t){if(t){if(e.target){e.target._focusOut()}else{this._setInputMethod()}e.target=this;this._focusIn()}else{e.target=null;this._focusOut();T.Browser.document.body.scrollTop=0;e.blur();if(T.Render.isConchApp)e.setPos(-1e4,-1e4);else if(l.inputContainer.contains(e))l.inputContainer.removeChild(e)}}}_setInputMethod(){l.input.parentElement&&l.inputContainer.removeChild(l.input);l.area.parentElement&&l.inputContainer.removeChild(l.area);l.inputElement=this._multiline?l.area:l.input;l.inputContainer.appendChild(l.inputElement);if(G.RightToLeft){l.inputElement.style.direction="rtl"}}_focusIn(){l.isInputting=true;var t=this.nativeInput;this._focus=true;var e=t.style;e.whiteSpace=this.wordWrap?"pre-wrap":"nowrap";this._setPromptColor();t.readOnly=!this._editable;if(T.Render.isConchApp){t.setType(this._type);t.setForbidEdit(!this._editable)}t.maxLength=this._maxChars;var o=this.padding;t.value=this._content;t.placeholder=this._prompt;T.stage.off(L.KEY_DOWN,this,this._onKeyDown);T.stage.on(L.KEY_DOWN,this,this._onKeyDown);T.stage.focus=this;this.event(L.FOCUS);if(T.Browser.onPC)t.focus();if(!T.Browser.onMiniGame&&!T.Browser.onBDMiniGame&&!T.Browser.onQGMiniGame&&!T.Browser.onKGMiniGame&&!T.Browser.onVVMiniGame&&!T.Browser.onAlipayMiniGame&&!T.Browser.onQQMiniGame){var i=this._text;this._text=null}this.typeset();t.setColor(this._originColor);t.setFontSize(this.fontSize);t.setFontFace(T.Browser.onIPhone?G.fontFamilyMap[this.font]||this.font:this.font);if(T.Render.isConchApp){t.setMultiAble&&t.setMultiAble(this._multiline)}e.lineHeight=this.leading+this.fontSize+"px";e.fontStyle=this.italic?"italic":"normal";e.fontWeight=this.bold?"bold":"normal";e.textAlign=this.align;e.padding="0 0";this._syncInputTransform();if(!T.Render.isConchApp&&T.Browser.onPC)T.systemTimer.frameLoop(1,this,this._syncInputTransform)}_setPromptColor(){l.promptStyleDOM=T.Browser.getElementById("promptStyle");if(!l.promptStyleDOM){l.promptStyleDOM=T.Browser.createElement("style");l.promptStyleDOM.setAttribute("id","promptStyle");T.Browser.document.head.appendChild(l.promptStyleDOM)}l.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {"+"color:"+this._promptColor+"}"+"input:-moz-placeholder, textarea:-moz-placeholder {"+"color:"+this._promptColor+"}"+"input::-moz-placeholder, textarea::-moz-placeholder {"+"color:"+this._promptColor+"}"+"input:-ms-input-placeholder, textarea:-ms-input-placeholder {"+"color:"+this._promptColor+"}"}_focusOut(){l.isInputting=false;this._focus=false;this._text=null;this._content=this.nativeInput.value;if(!this._content){super.set_text(this._prompt);super.set_color(this._promptColor)}else{super.set_text(this._content);super.set_color(this._originColor)}T.stage.off(L.KEY_DOWN,this,this._onKeyDown);T.stage.focus=null;this.event(L.BLUR);this.event(L.CHANGE);if(T.Render.isConchApp)this.nativeInput.blur();T.Browser.onPC&&T.systemTimer.clear(this,this._syncInputTransform)}_onKeyDown(t){if(t.keyCode===13){if(T.Browser.onMobile&&!this._multiline)this.focus=false;this.event(L.ENTER)}}set text(t){super.set_color(this._originColor);t+="";if(this._focus){this.nativeInput.value=t||"";this.event(L.CHANGE)}else{if(!this._multiline)t=t.replace(/\r?\n/g,"");this._content=t;if(t)super.set_text(t);else{super.set_text(this._prompt);super.set_color(this.promptColor)}}}get text(){if(this._focus)return this.nativeInput.value;else return this._content||""}changeText(t){this._content=t;if(this._focus){this.nativeInput.value=t||"";this.event(L.CHANGE)}else super.changeText(t)}set color(t){if(this._focus)this.nativeInput.setColor(t);super.set_color(this._content?t:this._promptColor);this._originColor=t}get color(){return super.color}set bgColor(t){super.set_bgColor(t);if(T.Render.isConchApp)this.nativeInput.setBgColor(t)}get bgColor(){return super.bgColor}get restrict(){if(this._restrictPattern){return this._restrictPattern.source}return""}set restrict(t){if(t){t="[^"+t+"]";if(t.indexOf("^^")>-1)t=t.replace("^^","");this._restrictPattern=new RegExp(t,"g")}else this._restrictPattern=null}set editable(t){this._editable=t;if(T.Render.isConchApp){l.input.setForbidEdit(!t)}}get editable(){return this._editable}get maxChars(){return this._maxChars}set maxChars(t){if(t<=0)t=1e5;this._maxChars=t}get prompt(){return this._prompt}set prompt(t){if(!this._text&&t)super.set_color(this._promptColor);this.promptColor=this._promptColor;if(this._text)super.set_text(this._text==this._prompt?t:this._text);else super.set_text(t);this._prompt=G.langPacks&&G.langPacks[t]?G.langPacks[t]:t}get promptColor(){return this._promptColor}set promptColor(t){this._promptColor=t;if(!this._content)super.set_color(t)}get type(){return this._type}set type(t){if(t==="password")this._getTextStyle().asPassword=true;else this._getTextStyle().asPassword=false;this._type=t}}l.TYPE_TEXT="text";l.TYPE_PASSWORD="password";l.TYPE_EMAIL="email";l.TYPE_URL="url";l.TYPE_NUMBER="number";l.TYPE_RANGE="range";l.TYPE_DATE="date";l.TYPE_MONTH="month";l.TYPE_WEEK="week";l.TYPE_TIME="time";l.TYPE_DATE_TIME="datetime";l.TYPE_DATE_TIME_LOCAL="datetime-local";l.TYPE_SEARCH="search";l.IOS_IFRAME=false;l.inputHeight=45;l.isInputting=false;d.regClass("laya.display.Input",l);d.regClass("Laya.Input",l);class ke{constructor(){this.preOvers=[];this.preDowns=[];this.preRightDowns=[];this.enable=true;this._event=new L;this._lastClickTime=0}_clearTempArrs(){ke._oldArr.length=0;ke._newArr.length=0;ke._tEleArr.length=0}getTouchFromArr(t,e){var o,i;i=e.length;var a;for(o=0;o<i;o++){a=e[o];if(a.id==t){return a}}return null}removeTouchFromArr(t,e){var o;for(o=e.length-1;o>=0;o--){if(e[o].id==t){e.splice(o,1)}}}createTouchO(t,e){var o;o=p.getItem("TouchData")||{};o.id=e;o.tar=t;return o}onMouseDown(t,e,o=false){if(!this.enable)return;var i;var a;var r;i=this.getTouchFromArr(e,this.preOvers);r=this.getEles(t,null,ke._tEleArr);if(!i){a=this.createTouchO(t,e);this.preOvers.push(a)}else{i.tar=t}if(E.onMobile)this.sendEvents(r,L.MOUSE_OVER);var s;s=o?this.preDowns:this.preRightDowns;i=this.getTouchFromArr(e,s);if(!i){a=this.createTouchO(t,e);s.push(a)}else{i.tar=t}this.sendEvents(r,o?L.MOUSE_DOWN:L.RIGHT_MOUSE_DOWN);this._clearTempArrs()}sendEvents(t,e){var o,i;i=t.length;this._event._stoped=false;var a;a=t[0];for(o=0;o<i;o++){var r=t[o];if(r.destroyed)return;r.event(e,this._event.setTo(e,r,a));if(this._event._stoped)break}}getEles(t,e=null,o=null){if(!o){o=[]}else{o.length=0}while(t&&t!=e){o.push(t);t=t.parent}return o}checkMouseOutAndOverOfMove(t,e,o=0){if(e==t)return;var i;var a;var r,s;if(e.contains(t)){a=this.getEles(t,e,ke._tEleArr);this.sendEvents(a,L.MOUSE_OVER)}else if(t.contains(e)){a=this.getEles(e,t,ke._tEleArr);this.sendEvents(a,L.MOUSE_OUT)}else{a=ke._tEleArr;a.length=0;var n;n=this.getEles(e,null,ke._oldArr);var b;b=this.getEles(t,null,ke._newArr);s=n.length;var x;for(r=0;r<s;r++){i=n[r];x=b.indexOf(i);if(x>=0){b.splice(x,b.length-x);break}else{a.push(i)}}if(a.length>0){this.sendEvents(a,L.MOUSE_OUT)}if(b.length>0){this.sendEvents(b,L.MOUSE_OVER)}}}onMouseMove(t,e){if(!this.enable)return;var o;o=this.getTouchFromArr(e,this.preOvers);var i;if(!o){i=this.getEles(t,null,ke._tEleArr);this.sendEvents(i,L.MOUSE_OVER);this.preOvers.push(this.createTouchO(t,e))}else{this.checkMouseOutAndOverOfMove(t,o.tar);o.tar=t;i=this.getEles(t,null,ke._tEleArr)}this.sendEvents(i,L.MOUSE_MOVE);this._clearTempArrs()}getLastOvers(){ke._tEleArr.length=0;if(this.preOvers.length>0&&this.preOvers[0].tar){return this.getEles(this.preOvers[0].tar,null,ke._tEleArr)}ke._tEleArr.push(T.stage);return ke._tEleArr}stageMouseOut(){var t;t=this.getLastOvers();this.preOvers.length=0;this.sendEvents(t,L.MOUSE_OUT)}onMouseUp(t,e,o=false){if(!this.enable)return;var i;var a;var r;var s,n;var b;var x;var l=E.onMobile;a=this.getEles(t,null,ke._tEleArr);this.sendEvents(a,o?L.MOUSE_UP:L.RIGHT_MOUSE_UP);var _;_=o?this.preDowns:this.preRightDowns;i=this.getTouchFromArr(e,_);if(!i);else{var h;var d=E.now();h=d-this._lastClickTime<300;this._lastClickTime=d;if(t==i.tar){x=a}else{r=this.getEles(i.tar,null,ke._oldArr);x=ke._newArr;x.length=0;n=r.length;for(s=0;s<n;s++){b=r[s];if(a.indexOf(b)>=0){x.push(b)}}}if(x.length>0){this.sendEvents(x,o?L.CLICK:L.RIGHT_CLICK)}if(o&&h){this.sendEvents(x,L.DOUBLE_CLICK)}this.removeTouchFromArr(e,_);i.tar=null;p.recover("TouchData",i)}i=this.getTouchFromArr(e,this.preOvers);if(!i);else{if(l){x=this.getEles(i.tar,null,x);if(x&&x.length>0){this.sendEvents(x,L.MOUSE_OUT)}this.removeTouchFromArr(e,this.preOvers);i.tar=null;p.recover("TouchData",i)}}this._clearTempArrs()}}ke.I=new ke;ke._oldArr=[];ke._newArr=[];ke._tEleArr=[];class Oe{constructor(){this.mouseX=0;this.mouseY=0;this.disableMouseEvent=false;this.mouseDownTime=0;this.mouseMoveAccuracy=2;this._event=new L;this._captureSp=null;this._captureChain=[];this._captureExlusiveMode=false;this._hitCaputreSp=false;this._point=new K;this._rect=new B;this._lastMoveTimer=0;this._prePoint=new K;this._touchIDs={};this._curTouchID=NaN;this._id=1}__init__(t,e){this._stage=t;var o=this;e.oncontextmenu=function(t){if(Oe.enabled)return false};e.addEventListener("mousedown",function(t){if(Oe.enabled){if(!E.onIE)t.preventDefault();o.mouseDownTime=E.now();o.runEvent(t)}});e.addEventListener("mouseup",function(t){if(Oe.enabled){t.preventDefault();o.mouseDownTime=-E.now();o.runEvent(t)}},true);e.addEventListener("mousemove",function(t){if(Oe.enabled){t.preventDefault();var e=E.now();if(e-o._lastMoveTimer<10)return;o._lastMoveTimer=e;o.runEvent(t)}},true);e.addEventListener("mouseout",function(t){if(Oe.enabled)o.runEvent(t)});e.addEventListener("mouseover",function(t){if(Oe.enabled)o.runEvent(t)});e.addEventListener("touchstart",function(t){if(Oe.enabled){if(!Oe._isFirstTouch&&!l.isInputting)t.preventDefault();o.mouseDownTime=E.now();o.runEvent(t)}});e.addEventListener("touchend",function(t){if(Oe.enabled){if(!Oe._isFirstTouch&&!l.isInputting)t.preventDefault();Oe._isFirstTouch=false;o.mouseDownTime=-E.now();o.runEvent(t)}else{o._curTouchID=NaN}},true);e.addEventListener("touchmove",function(t){if(Oe.enabled){t.preventDefault();o.runEvent(t)}},true);e.addEventListener("touchcancel",function(t){if(Oe.enabled){t.preventDefault();o.runEvent(t)}else{o._curTouchID=NaN}},true);e.addEventListener("mousewheel",function(t){if(Oe.enabled)o.runEvent(t)});e.addEventListener("DOMMouseScroll",function(t){if(Oe.enabled)o.runEvent(t)})}initEvent(t,e=null){var o=this;o._event._stoped=false;o._event.nativeEvent=e||t;o._target=null;this._point.setTo(t.pageX||t.clientX,t.pageY||t.clientY);if(this._stage._canvasTransform){this._stage._canvasTransform.invertTransformPoint(this._point);o.mouseX=this._point.x;o.mouseY=this._point.y}o._event.touchId=t.identifier||0;this._tTouchID=o._event.touchId;var i;i=ke.I._event;i._stoped=false;i.nativeEvent=o._event.nativeEvent;i.touchId=o._event.touchId}checkMouseWheel(t){this._event.delta=t.wheelDelta?t.wheelDelta*.025:-t.detail;var e=ke.I.getLastOvers();for(var o=0,i=e.length;o<i;o++){var a=e[o];a.event(L.MOUSE_WHEEL,this._event.setTo(L.MOUSE_WHEEL,a,this._target))}}onMouseMove(t){ke.I.onMouseMove(t,this._tTouchID)}onMouseDown(t){if(l.isInputting&&T.stage.focus&&T.stage.focus["focus"]&&!T.stage.focus.contains(this._target)){var e=T.stage.focus["_tf"]||T.stage.focus;var o=t["_tf"]||t;if(o instanceof l&&o.multiline==e.multiline)e["_focusOut"]();else e.focus=false}ke.I.onMouseDown(t,this._tTouchID,this._isLeftMouse)}onMouseUp(t){ke.I.onMouseUp(t,this._tTouchID,this._isLeftMouse)}check(t,e,o,i){this._point.setTo(e,o);t.fromParentPoint(this._point);e=this._point.x;o=this._point.y;var a=t._style.scrollRect;if(a){this._rect.setTo(a.x,a.y,a.width,a.height);if(!this._rect.contains(e,o))return false}if(!this.disableMouseEvent){if(t.hitTestPrior&&!t.mouseThrough&&!this.hitTest(t,e,o)){return false}for(var r=t._children.length-1;r>-1;r--){var s=t._children[r];if(!s.destroyed&&s._mouseState>1&&s._visible){if(this.check(s,e,o,i))return true}}for(r=t._extUIChild.length-1;r>=0;r--){var n=t._extUIChild[r];if(!n.destroyed&&n._mouseState>1&&n._visible){if(this.check(n,e,o,i))return true}}}var b=t.hitTestPrior&&!t.mouseThrough&&!this.disableMouseEvent?true:this.hitTest(t,e,o);if(b){this._target=t;i.call(this,t);if(this._target==this._hitCaputreSp){this._hitCaputreSp=true}}else if(i===this.onMouseUp&&t===this._stage){this._target=this._stage;i.call(this,this._target)}return b}hitTest(t,e,o){var i=false;if(t.scrollRect){e-=t._style.scrollRect.x;o-=t._style.scrollRect.y}var a=t._style.hitArea;if(a&&a._hit){return a.contains(e,o)}if(t.width>0&&t.height>0||t.mouseThrough||a){if(!t.mouseThrough){i=(a?a:this._rect.setTo(0,0,t.width,t.height)).contains(e,o)}else{i=t.getGraphicBounds().contains(e,o)}}return i}_checkAllBaseUI(t,e,o){var i=this.handleExclusiveCapture(this.mouseX,this.mouseY,o);if(i)return true;i=this.check(this._stage,this.mouseX,this.mouseY,o);return this.handleCapture(this.mouseX,this.mouseY,o)||i}check3DUI(t,e,o){var i=this._stage._3dUI;var a=0;var r=false;for(;a<i.length;a++){var s=i[a];this._stage._curUIBase=s;if(!s.destroyed&&s._mouseState>1&&s._visible){r=r||this.check(s,this.mouseX,this.mouseY,o)}}this._stage._curUIBase=this._stage;return r}handleExclusiveCapture(t,e,o){if(this._captureExlusiveMode&&this._captureSp&&this._captureChain.length>0){var i;this._point.setTo(t,e);for(var a=0;a<this._captureChain.length;a++){i=this._captureChain[a];i.fromParentPoint(this._point)}this._target=i;o.call(this,i);return true}return false}handleCapture(t,e,o){if(!this._hitCaputreSp&&this._captureSp&&this._captureChain.length>0){var i;this._point.setTo(t,e);for(var a=0;a<this._captureChain.length;a++){i=this._captureChain[a];i.fromParentPoint(this._point)}this._target=i;o.call(this,i);return true}return false}runEvent(t){var e,o,i;if(t.type!=="mousemove")this._prePoint.x=this._prePoint.y=-1e6;switch(t.type){case"mousedown":this._touchIDs[0]=this._id++;if(!Oe._isTouchRespond){this._isLeftMouse=t.button===0;this.initEvent(t);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown)}else Oe._isTouchRespond=false;break;case"mouseup":this._isLeftMouse=t.button===0;this.initEvent(t);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":if(Math.abs(this._prePoint.x-t.clientX)+Math.abs(this._prePoint.y-t.clientY)>=this.mouseMoveAccuracy){this._prePoint.x=t.clientX;this._prePoint.y=t.clientY;this.initEvent(t);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove)}break;case"touchstart":Oe._isTouchRespond=true;this._isLeftMouse=true;var a=t.changedTouches;for(e=0,o=a.length;e<o;e++){i=a[e];if(Oe.multiTouchEnabled||isNaN(this._curTouchID)){this._curTouchID=i.identifier;if(this._id%200===0)this._touchIDs={};this._touchIDs[i.identifier]=this._id++;this.initEvent(i,t);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown)}}break;case"touchend":case"touchcancel":Oe._isTouchRespond=true;this._isLeftMouse=true;var r=t.changedTouches;for(e=0,o=r.length;e<o;e++){i=r[e];if(Oe.multiTouchEnabled||i.identifier==this._curTouchID){this._curTouchID=NaN;this.initEvent(i,t);var s;s=this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);if(!s){this.onMouseUp(null)}}}break;case"touchmove":var n=t.changedTouches;for(e=0,o=n.length;e<o;e++){i=n[e];if(Oe.multiTouchEnabled||i.identifier==this._curTouchID){this.initEvent(i,t);this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove)}}break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(t);break;case"mouseout":ke.I.stageMouseOut();break;case"mouseover":this._stage.event(L.MOUSE_OVER,this._event.setTo(L.MOUSE_OVER,this._stage,this._stage));break}}setCapture(t,e=false){this._captureSp=t;this._captureExlusiveMode=e;this._captureChain.length=0;this._captureChain.push(t);var o=t;while(true){if(o==T.stage)break;if(o==T.stage._curUIBase)break;o=o.parent;if(!o)break;this._captureChain.splice(0,0,o)}}releaseCapture(){console.log("release capture");this._captureSp=null}}Oe.instance=new Oe;Oe.enabled=true;Oe.multiTouchEnabled=true;Oe._isFirstTouch=true;class Ne{constructor(){this._pool=[];this._map=[];this._laters=[]}_update(){var t=this._laters;var e=t.length;if(e>0){for(var o=0,i=e-1;o<=i;o++){var a=t[o];this._map[a.key]=null;if(a.method!==null){a.run();a.clear()}this._pool.push(a);o===i&&(i=t.length-1)}t.length=0}}_getHandler(t,e){var o=t?t.$_GID||(t.$_GID=T.Utils.getGID()):0;var i=e.$_TID||(e.$_TID=T.Timer._mid++*1e5);return this._map[o+i]}callLater(t,e,o=null){if(this._getHandler(t,e)==null){if(this._pool.length)var i=this._pool.pop();else i=new We;i.caller=t;i.method=e;i.args=o;var a=t?t.$_GID:0;var r=e["$_TID"];i.key=a+r;this._map[i.key]=i;this._laters.push(i)}}runCallLater(t,e){var o=this._getHandler(t,e);if(o&&o.method!=null){this._map[o.key]=null;o.run();o.clear()}}}Ne.I=new Ne;class We{clear(){this.caller=null;this.method=null;this.args=null}run(){var t=this.caller;if(t&&t.destroyed)return this.clear();var e=this.method;var o=this.args;if(e==null)return;o?e.apply(t,o):e.call(t)}}class Ue{}Ue.createShaderCondition=function(t){var e="(function() {return "+t+";})";return window.Laya._runScript(e)};Ue.changeWebGLSize=function(t,e){he.onStageResize(t,e)};class F extends Fe{constructor(){super();this.offset=new K;this._frameRate="fast";this.designWidth=0;this.designHeight=0;this.canvasRotation=false;this.canvasDegree=0;this.renderingEnabled=true;this.screenAdaptationEnabled=true;this._canvasTransform=new w;this._screenMode="none";this._scaleMode="noscale";this._alignV="top";this._alignH="left";this._bgColor="black";this._mouseMoveTime=0;this._renderCount=0;this._safariOffsetY=0;this._frameStartTime=0;this._previousOrientation=E.window.orientation;this._wgColor=[0,0,0,1];this._scene3Ds=[];this._globalRepaintSet=false;this._globalRepaintGet=false;this._3dUI=[];this._curUIBase=null;this.useRetinalCanvas=false;super.set_transform(this._createTransform());this.mouseEnabled=true;this.hitTestPrior=true;this.autoSize=false;this._setBit(R.DISPLAYED_INSTAGE,true);this._setBit(R.ACTIVE_INHIERARCHY,true);this._isFocused=true;this._isVisibility=true;this.useRetinalCanvas=s.useRetinalCanvas;var t=E.window;var e=this;t.addEventListener("focus",function(){this._isFocused=true;e.event(L.FOCUS);e.event(L.FOCUS_CHANGE)});t.addEventListener("blur",function(){this._isFocused=false;e.event(L.BLUR);e.event(L.FOCUS_CHANGE);if(e._isInputting())l["inputElement"].target.focus=false});var o="visibilityState",i="visibilitychange";var a=t.document;if(typeof a.hidden!=="undefined"){i="visibilitychange";o="visibilityState"}else if(typeof a.mozHidden!=="undefined"){i="mozvisibilitychange";o="mozVisibilityState"}else if(typeof a.msHidden!=="undefined"){i="msvisibilitychange";o="msVisibilityState"}else if(typeof a.webkitHidden!=="undefined"){i="webkitvisibilitychange";o="webkitVisibilityState"}t.document.addEventListener(i,r);function r(){if(E.document[o]=="hidden"){this._isVisibility=false;if(e._isInputting())l["inputElement"].target.focus=false}else{this._isVisibility=true}this.renderingEnabled=this._isVisibility;e.event(L.VISIBILITY_CHANGE)}t.addEventListener("resize",function(){var t=E.window.orientation;if(t!=null&&t!=this._previousOrientation&&e._isInputting()){l["inputElement"].target.focus=false}this._previousOrientation=t;if(e._isInputting())return;if(E.onSafari)e._safariOffsetY=(E.window.__innerHeight||E.document.body.clientHeight||E.document.documentElement.clientHeight)-E.window.innerHeight;e._resetCanvas()});t.addEventListener("orientationchange",function(t){e._resetCanvas()});this.on(L.MOUSE_MOVE,this,this._onmouseMove);if(E.onMobile)this.on(L.MOUSE_DOWN,this,this._onmouseMove)}_isInputting(){return E.onMobile&&l.isInputting}set width(t){this.designWidth=t;super.set_width(t);T.systemTimer.callLater(this,this._changeCanvasSize)}get width(){return super.get_width()}set height(t){this.designHeight=t;super.set_height(t);T.systemTimer.callLater(this,this._changeCanvasSize)}get height(){return super.get_height()}set transform(t){super.set_transform(t)}get transform(){if(this._tfChanged)this._adjustTransform();return this._transform=this._transform||this._createTransform()}get isFocused(){return this._isFocused}get isVisibility(){return this._isVisibility}_changeCanvasSize(){this.setScreenSize(E.clientWidth*E.pixelRatio,E.clientHeight*E.pixelRatio)}_resetCanvas(){if(!this.screenAdaptationEnabled)return;this._changeCanvasSize()}setScreenSize(t,e){var o=false;if(this._screenMode!==F.SCREEN_NONE){var i=t/e<1?F.SCREEN_VERTICAL:F.SCREEN_HORIZONTAL;o=i!==this._screenMode;if(o){var a=e;e=t;t=a}}this.canvasRotation=o;var r=y._mainCanvas;var s=r.source.style;var n=this._canvasTransform.identity();var b=this._scaleMode;var x=t/this.designWidth;var l=e/this.designHeight;var _=this.useRetinalCanvas?t:this.designWidth;var h=this.useRetinalCanvas?e:this.designHeight;var d=t;var p=e;var c=E.pixelRatio;this._width=this.designWidth;this._height=this.designHeight;switch(b){case F.SCALE_NOSCALE:x=l=1;d=this.designWidth;p=this.designHeight;break;case F.SCALE_SHOWALL:x=l=Math.min(x,l);_=d=Math.round(this.designWidth*x);h=p=Math.round(this.designHeight*l);break;case F.SCALE_NOBORDER:x=l=Math.max(x,l);d=Math.round(this.designWidth*x);p=Math.round(this.designHeight*l);break;case F.SCALE_FULL:x=l=1;this._width=_=t;this._height=h=e;break;case F.SCALE_FIXED_WIDTH:l=x;this._height=h=Math.round(e/x);break;case F.SCALE_FIXED_HEIGHT:x=l;this._width=_=Math.round(t/l);break;case F.SCALE_FIXED_AUTO:if(t/e<this.designWidth/this.designHeight){l=x;this._height=h=Math.round(e/x)}else{x=l;this._width=_=Math.round(t/l)}break}if(this.useRetinalCanvas){_=t;h=e}x*=this.scaleX;l*=this.scaleY;if(x===1&&l===1){this.transform.identity()}else{this.transform.a=this._formatData(x/(d/_));this.transform.d=this._formatData(l/(p/h))}r.size(_,h);Ue.changeWebGLSize(_,h);n.scale(d/_/c,p/h/c);if(this._alignH===F.ALIGN_LEFT)this.offset.x=0;else if(this._alignH===F.ALIGN_RIGHT)this.offset.x=t-d;else this.offset.x=(t-d)*.5/c;if(this._alignV===F.ALIGN_TOP)this.offset.y=0;else if(this._alignV===F.ALIGN_BOTTOM)this.offset.y=e-p;else this.offset.y=(e-p)*.5/c;this.offset.x=Math.round(this.offset.x);this.offset.y=Math.round(this.offset.y);n.translate(this.offset.x,this.offset.y);if(this._safariOffsetY)n.translate(0,this._safariOffsetY);this.canvasDegree=0;if(o){if(this._screenMode===F.SCREEN_HORIZONTAL){n.rotate(Math.PI/2);n.translate(e/c,0);this.canvasDegree=90}else{n.rotate(-Math.PI/2);n.translate(0,t/c);this.canvasDegree=-90}}n.a=this._formatData(n.a);n.d=this._formatData(n.d);n.tx=this._formatData(n.tx);n.ty=this._formatData(n.ty);super.set_transform(this.transform);s.transformOrigin=s.webkitTransformOrigin=s.msTransformOrigin=s.mozTransformOrigin=s.oTransformOrigin="0px 0px 0px";s.transform=s.webkitTransform=s.msTransform=s.mozTransform=s.oTransform="matrix("+n.toString()+")";if(this._safariOffsetY)n.translate(0,-this._safariOffsetY);n.translate(parseInt(s.left)||0,parseInt(s.top)||0);this.visible=true;this._repaint|=P.REPAINT_CACHE;this.event(L.RESIZE)}_formatData(t){if(Math.abs(t)<1e-6)return 0;if(Math.abs(1-t)<.001)return t>0?1:-1;return t}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode=t;T.systemTimer.callLater(this,this._changeCanvasSize)}get alignH(){return this._alignH}set alignH(t){this._alignH=t;T.systemTimer.callLater(this,this._changeCanvasSize)}get alignV(){return this._alignV}set alignV(t){this._alignV=t;T.systemTimer.callLater(this,this._changeCanvasSize)}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t;if(t)this._wgColor=g.create(t).arrColor;else this._wgColor=null;if(t){y.canvas.style.background=t}else{y.canvas.style.background="none"}}get mouseX(){return Math.round(Oe.instance.mouseX/this.clientScaleX)}get mouseY(){return Math.round(Oe.instance.mouseY/this.clientScaleY)}getMousePoint(){return K.TEMP.setTo(this.mouseX,this.mouseY)}get clientScaleX(){return this._transform?this._transform.getScaleX():1}get clientScaleY(){return this._transform?this._transform.getScaleY():1}get screenMode(){return this._screenMode}set screenMode(t){this._screenMode=t}repaint(t=P.REPAINT_CACHE){this._repaint|=t}parentRepaint(t=P.REPAINT_CACHE){}_loop(){this._globalRepaintGet=this._globalRepaintSet;this._globalRepaintSet=false;this.render(y._context,0,0);return true}getFrameTm(){return this._frameStartTime}_onmouseMove(t){this._mouseMoveTime=E.now()}getTimeFromFrameStart(){return E.now()-this._frameStartTime}set visible(t){if(this.visible!==t){super.set_visible(t);var e=y._mainCanvas.source.style;e.visibility=t?"visible":"hidden"}}get visible(){return super.visible}render(t,e,o){if(window.conch){this.renderToNative(t,e,o);return}F._dbgSprite.graphics.clear();if(this._frameRate===F.FRAME_SLEEP){var i=E.now();if(i-this._frameStartTime>=1e3)this._frameStartTime=i;else return}else{if(!this._visible){this._renderCount++;if(this._renderCount%5===0){Ne.I._update();m.loopCount++;Tt.loopCount=m.loopCount;this._updateTimers()}return}this._frameStartTime=E.now();Tt.loopStTm=this._frameStartTime}this._renderCount++;var a=this._frameRate===F.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?F.FRAME_FAST:F.FRAME_SLOW:this._frameRate;var r=a!==F.FRAME_SLOW;var s=this._renderCount%2===0;m.renderSlow=!r;if(!r&&!s)return;Ne.I._update();m.loopCount++;Tt.loopCount=m.loopCount;if(this.renderingEnabled){for(var n=0,b=this._scene3Ds.length;n<b;n++)this._scene3Ds[n]._update();t.clear();super.render(t,e,o);m._StatRender.renderNotCanvas(t,e,o)}F._dbgSprite.render(t,0,0);if(this.renderingEnabled){F.clear(this._bgColor);t.flush();we.instance&&we.getInstance().endDispose()}this._updateTimers()}renderToNative(t,e,o){this._renderCount++;if(!this._visible){if(this._renderCount%5===0){Ne.I._update();m.loopCount++;Tt.loopCount=m.loopCount;this._updateTimers()}return}Ne.I._update();m.loopCount++;Tt.loopCount=m.loopCount;if(this.renderingEnabled){for(var i=0,a=this._scene3Ds.length;i<a;i++)this._scene3Ds[i]._update();t.clear();super.render(t,e,o);m._StatRender.renderNotCanvas(t,e,o)}if(this.renderingEnabled){F.clear(this._bgColor);t.flush();we.instance&&we.getInstance().endDispose()}this._updateTimers()}_updateTimers(){T.systemTimer._update();T.startTimer._update();T.physicsTimer._update();T.updateTimer._update();T.lateTimer._update();T.timer._update()}set fullScreenEnabled(t){var e=E.document;var o=y.canvas;if(t){o.addEventListener("mousedown",this._requestFullscreen);o.addEventListener("touchstart",this._requestFullscreen);e.addEventListener("fullscreenchange",this._fullScreenChanged);e.addEventListener("mozfullscreenchange",this._fullScreenChanged);e.addEventListener("webkitfullscreenchange",this._fullScreenChanged);e.addEventListener("msfullscreenchange",this._fullScreenChanged)}else{o.removeEventListener("mousedown",this._requestFullscreen);o.removeEventListener("touchstart",this._requestFullscreen);e.removeEventListener("fullscreenchange",this._fullScreenChanged);e.removeEventListener("mozfullscreenchange",this._fullScreenChanged);e.removeEventListener("webkitfullscreenchange",this._fullScreenChanged);e.removeEventListener("msfullscreenchange",this._fullScreenChanged)}}get frameRate(){if(!T.Render.isConchApp){return this._frameRate}else{return this._frameRateNative}}set frameRate(t){if(!T.Render.isConchApp){this._frameRate=t}else{var e=window.conch;switch(t){case F.FRAME_FAST:e.config.setLimitFPS(60);break;case F.FRAME_MOUSE:e.config.setMouseFrame(2e3);break;case F.FRAME_SLOW:e.config.setSlowFrame(true);break;case F.FRAME_SLEEP:e.config.setLimitFPS(1);break}this._frameRateNative=t}}_requestFullscreen(){var t=E.document.documentElement;if(t.requestFullscreen){t.requestFullscreen()}else if(t.mozRequestFullScreen){t.mozRequestFullScreen()}else if(t.webkitRequestFullscreen){t.webkitRequestFullscreen()}else if(t.msRequestFullscreen){t.msRequestFullscreen()}}_fullScreenChanged(){T.stage.event(L.FULL_SCREEN_CHANGE)}exitFullscreen(){var t=E.document;if(t.exitFullscreen){t.exitFullscreen()}else if(t.mozCancelFullScreen){t.mozCancelFullScreen()}else if(t.webkitExitFullscreen){t.webkitExitFullscreen()}}isGlobalRepaint(){return this._globalRepaintGet}setGlobalRepaint(){this._globalRepaintSet=true}add3DUI(t){var e=t.rootView;if(this._3dUI.indexOf(e)>=0)return;this._3dUI.push(e)}remove3DUI(t){var e=t.rootView;var o=this._3dUI.indexOf(e);if(o>=0){this._3dUI.splice(o,1);return true}return false}}F.SCALE_NOSCALE="noscale";F.SCALE_EXACTFIT="exactfit";F.SCALE_SHOWALL="showall";F.SCALE_NOBORDER="noborder";F.SCALE_FULL="full";F.SCALE_FIXED_WIDTH="fixedwidth";F.SCALE_FIXED_HEIGHT="fixedheight";F.SCALE_FIXED_AUTO="fixedauto";F.ALIGN_LEFT="left";F.ALIGN_RIGHT="right";F.ALIGN_CENTER="center";F.ALIGN_TOP="top";F.ALIGN_MIDDLE="middle";F.ALIGN_BOTTOM="bottom";F.SCREEN_NONE="none";F.SCREEN_HORIZONTAL="horizontal";F.SCREEN_VERTICAL="vertical";F.FRAME_FAST="fast";F.FRAME_SLOW="slow";F.FRAME_MOUSE="mouse";F.FRAME_SLEEP="sleep";F._dbgSprite=new Fe;F.clear=function(t){z.set2DRenderConfig();var e=c.instance;x.worldScissorTest&&e.disable(e.SCISSOR_TEST);var o=y.context;var i=o._submits._length==0||s.preserveDrawingBuffer?g.create(t).arrColor:window.Laya.stage._wgColor;if(i)o.clearBG(i[0],i[1],i[2],i[3]);else o.clearBG(0,0,0,0);x.clear()};d.regClass("laya.display.Stage",F);d.regClass("Laya.Stage",F);class ze{static __init__(){ze._addEvent("keydown");ze._addEvent("keypress");ze._addEvent("keyup")}static _addEvent(e){T.Browser.document.addEventListener(e,function(t){ze._dispatch(t,e)},true)}static _dispatch(t,e){if(!ze.enabled)return;ze._event._stoped=false;ze._event.nativeEvent=t;ze._event.keyCode=t.keyCode||t.which||t.charCode;if(e==="keydown")ze._pressKeys[ze._event.keyCode]=true;else if(e==="keyup")ze._pressKeys[ze._event.keyCode]=null;var o=T.stage.focus&&T.stage.focus.event!=null&&T.stage.focus.displayedInStage?T.stage.focus:T.stage;var i=o;while(i){i.event(e,ze._event.setTo(e,i,o));i=i.parent}}static hasKeyDown(t){return ze._pressKeys[t]}}ze._pressKeys={};ze.enabled=true;ze._event=new L;class Xe extends e{constructor(){super(...arguments);this.isStopped=false}set volume(t){}get volume(){return 1}get position(){return 0}get duration(){return 0}play(){}stop(){if(this.completeHandler)this.completeHandler.run()}pause(){}resume(){}__runComplete(t){if(t){t.run()}}}class He extends Xe{constructor(t){super();this._audio=null;this._onEnd=this.__onEnd.bind(this);this._resumePlay=this.__resumePlay.bind(this);t.addEventListener("ended",this._onEnd);this._audio=t}__onEnd(t){if(this.loops==1){if(this.completeHandler){T.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null}this.stop();this.event(L.COMPLETE);return}if(this.loops>0){this.loops--}this.startTime=0;this.play()}__resumePlay(){if(this._audio)this._audio.removeEventListener("canplay",this._resumePlay);if(this.isStopped)return;try{this._audio.currentTime=this.startTime;E.container.appendChild(this._audio);this._audio.play()}catch(t){this.event(L.ERROR)}}play(){this.isStopped=false;try{this._audio.playbackRate=T.SoundManager.playbackRate;this._audio.currentTime=this.startTime}catch(t){this._audio.addEventListener("canplay",this._resumePlay);return}T.SoundManager.addChannel(this);E.container.appendChild(this._audio);if("play"in this._audio)this._audio.play()}get position(){if(!this._audio)return 0;return this._audio.currentTime}get duration(){if(!this._audio)return 0;return this._audio.duration}stop(){super.stop();this.isStopped=true;T.SoundManager.removeChannel(this);this.completeHandler=null;if(!this._audio)return;if("pause"in this._audio)if(T.Render.isConchApp){this._audio.stop()}this._audio.pause();this._audio.removeEventListener("ended",this._onEnd);this._audio.removeEventListener("canplay",this._resumePlay);if(!T.Browser.onIE){if(this._audio!=T.AudioSound._musicAudio){T.Pool.recover("audio:"+this.url,this._audio)}}E.removeElement(this._audio);this._audio=null;if(T.SoundManager.autoReleaseSound)T.SoundManager.disposeSoundLater(this.url)}pause(){this.isStopped=true;T.SoundManager.removeChannel(this);if("pause"in this._audio)this._audio.pause();if(T.SoundManager.autoReleaseSound)T.SoundManager.disposeSoundLater(this.url)}resume(){if(!this._audio)return;this.isStopped=false;T.SoundManager.addChannel(this);if("play"in this._audio)this._audio.play()}set volume(t){if(!this._audio)return;this._audio.volume=t}get volume(){if(!this._audio)return 1;return this._audio.volume}}class Ye extends e{constructor(){super(...arguments);this.loaded=false}dispose(){var t=Ye._audioCache[this.url];p.clearBySign("audio:"+this.url);if(t){if(!y.isConchApp){t.src=""}delete Ye._audioCache[this.url]}}static _initMusicAudio(){if(Ye._musicAudio)return;if(!Ye._musicAudio)Ye._musicAudio=E.createElement("audio");if(!y.isConchApp){E.document.addEventListener("mousedown",Ye._makeMusicOK)}}static _makeMusicOK(){E.document.removeEventListener("mousedown",Ye._makeMusicOK);if(!Ye._musicAudio.src){Ye._musicAudio.src="";Ye._musicAudio.load()}else{Ye._musicAudio.play()}}load(t){t=M.formatURL(t);this.url=t;let e=t.replace(M._basePath,"");if(window.fileObj[e]){t=window.fileObj[e]}var o;if(t==T.SoundManager._bgMusic){Ye._initMusicAudio();o=Ye._musicAudio;if(o.src!=t){Ye._audioCache[o.src]=null;o=null}}else{o=Ye._audioCache[t]}if(o&&o.readyState>=2){this.event(L.COMPLETE);return}if(!o){if(t==T.SoundManager._bgMusic){Ye._initMusicAudio();o=Ye._musicAudio}else{o=E.createElement("audio")}Ye._audioCache[t]=o;o.src=t}o.addEventListener("canplaythrough",a);o.addEventListener("error",r);var i=this;function a(){s();i.loaded=true;i.event(L.COMPLETE)}function r(){o.load=null;s();i.event(L.ERROR)}function s(){o.removeEventListener("canplaythrough",a);o.removeEventListener("error",r)}this.audio=o;if(o.load){o.load()}else{r()}}play(t=0,e=0){if(!this.url)return null;var o;if(this.url==T.SoundManager._bgMusic){o=Ye._musicAudio}else{o=Ye._audioCache[this.url]}if(!o)return null;var i;i=p.getItem("audio:"+this.url);if(y.isConchApp){if(!i){i=E.createElement("audio");i.src=this.url}}else{if(this.url==T.SoundManager._bgMusic){Ye._initMusicAudio();i=Ye._musicAudio;i.src=this.url}else{i=i?i:o.cloneNode(true)}}var a=new He(i);a.url=this.url;a.loops=e;a.startTime=t;a.play();T.SoundManager.addChannel(a);return a}get duration(){var t;t=Ye._audioCache[this.url];if(!t)return 0;return t.duration}}Ye._audioCache={};class qe extends Xe{constructor(){super();this.bufferSource=null;this._currentTime=0;this._volume=1;this._startTime=0;this._pauseTime=0;this.context=T.WebAudioSound.ctx;this._onPlayEnd=f.bind(this.__onPlayEnd,this);if(this.context["createGain"]){this.gain=this.context["createGain"]()}else{this.gain=this.context["createGainNode"]()}}play(){T.SoundManager.addChannel(this);this.isStopped=false;this._clearBufferSource();if(!this.audioBuffer)return;if(this.startTime>=this.duration)return stop();var t=this.context;var e=this.gain;var o=t.createBufferSource();this.bufferSource=o;o.buffer=this.audioBuffer;o.connect(e);if(e)e.disconnect();e.connect(t.destination);o.onended=this._onPlayEnd;this._startTime=E.now();if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,qe.SetTargetDelay)}else this.gain.gain.value=this._volume;if(this.loops==0){o.loop=true}if(o.playbackRate.setTargetAtTime){o.playbackRate.setTargetAtTime(T.SoundManager.playbackRate,this.context.currentTime,qe.SetTargetDelay)}else o.playbackRate.value=T.SoundManager.playbackRate;o.start(0,this.startTime);this._currentTime=0}__onPlayEnd(){if(this.loops==1){if(this.completeHandler){T.timer.once(10,this,this.__runComplete,[this.completeHandler],false);this.completeHandler=null}this.stop();this.event(L.COMPLETE);return}if(this.loops>0){this.loops--}this.startTime=0;this.play()}get position(){if(this.bufferSource){return(E.now()-this._startTime)/1e3+this.startTime}return 0}get duration(){if(this.audioBuffer){return this.audioBuffer.duration}return 0}_clearBufferSource(){if(this.bufferSource){var t=this.bufferSource;if(t.stop){t.stop(0)}else{t.noteOff(0)}t.disconnect(0);t.onended=null;if(!qe._tryCleanFailed)this._tryClearBuffer(t);this.bufferSource=null}}_tryClearBuffer(t){if(!E.onMac){try{t.buffer=null}catch(t){qe._tryCleanFailed=true}return}try{t.buffer=T.WebAudioSound._miniBuffer}catch(t){qe._tryCleanFailed=true}}stop(){super.stop();this._clearBufferSource();this.audioBuffer=null;if(this.gain)this.gain.disconnect();this.isStopped=true;T.SoundManager.removeChannel(this);this.completeHandler=null;if(T.SoundManager.autoReleaseSound)T.SoundManager.disposeSoundLater(this.url)}pause(){if(!this.isStopped){this._pauseTime=this.position}this._clearBufferSource();if(this.gain)this.gain.disconnect();this.isStopped=true;T.SoundManager.removeChannel(this);if(T.SoundManager.autoReleaseSound)T.SoundManager.disposeSoundLater(this.url)}resume(){this.startTime=this._pauseTime;this.play()}set volume(t){this._volume=t;if(this.isStopped){return}if(this.gain.gain.setTargetAtTime){this.gain.gain.setTargetAtTime(t,this.context.currentTime,qe.SetTargetDelay)}else this.gain.gain.value=t}get volume(){return this._volume}}qe._tryCleanFailed=false;qe.SetTargetDelay=.001;class a extends e{constructor(){super(...arguments);this.loaded=false;this._disposed=false}static decode(){if(a.buffs.length<=0||a.isDecoding){return}a.isDecoding=true;a.tInfo=a.buffs.shift();a.ctx.decodeAudioData(a.tInfo["buffer"],a._done,a._fail)}static _done(t){a.e.event("loaded:"+a.tInfo.url,t);a.isDecoding=false;a.decode()}static _fail(){a.e.event("err:"+a.tInfo.url,null);a.isDecoding=false;a.decode()}static _playEmptySound(){if(a.ctx==null){return}var t=a.ctx.createBufferSource();t.buffer=a._miniBuffer;t.connect(a.ctx.destination);t.start(0,0,0)}static _unlock(){if(a._unlocked){return}a._playEmptySound();if(a.ctx.state=="running"){window.document.removeEventListener("mousedown",a._unlock,true);window.document.removeEventListener("touchend",a._unlock,true);window.document.removeEventListener("touchstart",a._unlock,true);a._unlocked=true}}static initWebAudio(){if(a.ctx.state!="running"){a._unlock();window.document.addEventListener("mousedown",a._unlock,true);window.document.addEventListener("touchend",a._unlock,true);window.document.addEventListener("touchstart",a._unlock,true)}}load(t){var e=this;t=M.formatURL(t);let o=t.replace(M._basePath,"");if(window.fileObj[o]){t=window.fileObj[o]}this.url=t;this.audioBuffer=a._dataCache[t];if(this.audioBuffer){this._loaded(this.audioBuffer);return}a.e.on("loaded:"+t,this,this._loaded);a.e.on("err:"+t,this,this._err);if(a.__loadingSound[t]){return}a.__loadingSound[t]=true;var i=new XMLHttpRequest;i.open("GET",t,true);i.responseType="arraybuffer";i.onload=function(){if(e._disposed){e._removeLoadEvents();return}e.data=i.response;a.buffs.push({buffer:e.data,url:e.url});a.decode()};i.onerror=function(t){e._err()};i.send()}_err(){this._removeLoadEvents();a.__loadingSound[this.url]=false;this.event(L.ERROR)}_loaded(t){this._removeLoadEvents();if(this._disposed){return}this.audioBuffer=t;a._dataCache[this.url]=this.audioBuffer;this.loaded=true;this.event(L.COMPLETE)}_removeLoadEvents(){a.e.off("loaded:"+this.url,this,this._loaded);a.e.off("err:"+this.url,this,this._err)}__playAfterLoaded(){if(!this.__toPlays)return;var t,e;var o;o=this.__toPlays;e=o.length;var i;for(t=0;t<e;t++){i=o[t];if(i[2]&&!i[2].isStopped){this.play(i[0],i[1],i[2])}}this.__toPlays.length=0}play(t=0,e=0,o=null){o=o?o:new qe;if(!this.audioBuffer){if(this.url){if(!this.__toPlays)this.__toPlays=[];this.__toPlays.push([t,e,o]);this.once(L.COMPLETE,this,this.__playAfterLoaded);this.load(this.url)}}o.url=this.url;o.loops=e;o["audioBuffer"]=this.audioBuffer;o.startTime=t;o.play();T.SoundManager.addChannel(o);return o}get duration(){if(this.audioBuffer){return this.audioBuffer.duration}return 0}dispose(){this._disposed=true;delete a._dataCache[this.url];delete a.__loadingSound[this.url];this.audioBuffer=null;this.data=null;this.__toPlays=[]}}a._dataCache={};a.webAudioEnabled=window["AudioContext"]||window["webkitAudioContext"]||window["mozAudioContext"];a.ctx=a.webAudioEnabled?new(window["AudioContext"]||window["webkitAudioContext"]||window["mozAudioContext"]):undefined;a.buffs=[];a.isDecoding=false;a._miniBuffer=a.ctx?a.ctx.createBuffer(1,1,22050):undefined;a.e=new e;a._unlocked=false;a.__loadingSound={};class _{static __init__(){var t=T.Browser.window;var e=t["AudioContext"]||t["webkitAudioContext"]||t["mozAudioContext"]?true:false;if(e)a.initWebAudio();_._soundClass=e?a:Ye;Ye._initMusicAudio();_._musicClass=Ye;return e}static addChannel(t){if(_._channels.indexOf(t)>=0)return;_._channels.push(t)}static removeChannel(t){var e;for(e=_._channels.length-1;e>=0;e--){if(_._channels[e]==t){_._channels.splice(e,1)}}}static disposeSoundLater(t){_._lastSoundUsedTimeDic[t]=T.Browser.now();if(!_._isCheckingDispose){_._isCheckingDispose=true;T.timer.loop(5e3,null,_._checkDisposeSound)}}static _checkDisposeSound(){var t;var e=T.Browser.now();var o=false;for(t in _._lastSoundUsedTimeDic){if(e-_._lastSoundUsedTimeDic[t]>3e4){delete _._lastSoundUsedTimeDic[t];_.disposeSoundIfNotUsed(t)}else{o=true}}if(!o){_._isCheckingDispose=false;T.timer.clear(null,_._checkDisposeSound)}}static disposeSoundIfNotUsed(t){var e;for(e=_._channels.length-1;e>=0;e--){if(_._channels[e].url==t){return}}_.destroySound(t)}static set autoStopMusic(t){T.stage.off(L.BLUR,null,_._stageOnBlur);T.stage.off(L.FOCUS,null,_._stageOnFocus);T.stage.off(L.VISIBILITY_CHANGE,null,_._visibilityChange);_._autoStopMusic=t;if(t){T.stage.on(L.BLUR,null,_._stageOnBlur);T.stage.on(L.FOCUS,null,_._stageOnFocus);T.stage.on(L.VISIBILITY_CHANGE,null,_._visibilityChange)}}static get autoStopMusic(){return _._autoStopMusic}static _visibilityChange(){if(T.stage.isVisibility){_._stageOnFocus()}else{_._stageOnBlur()}}static _stageOnBlur(){_._isActive=false;if(_._musicChannel){if(!_._musicChannel.isStopped){_._blurPaused=true;_._musicChannel.pause()}}_.stopAllSound();T.stage.once(L.MOUSE_DOWN,null,_._stageOnFocus)}static _recoverWebAudio(){if(a.ctx&&a.ctx.state!="running"&&a.ctx.resume)a.ctx.resume()}static _stageOnFocus(){_._isActive=true;_._recoverWebAudio();T.stage.off(L.MOUSE_DOWN,null,_._stageOnFocus);if(_._blurPaused){if(_._musicChannel&&_._musicChannel.isStopped){_._blurPaused=false;_._musicChannel.resume()}}}static set muted(t){if(t==_._muted)return;if(t){_.stopAllSound()}_.musicMuted=t;_._muted=t}static get muted(){return _._muted}static set soundMuted(t){_._soundMuted=t}static get soundMuted(){return _._soundMuted}static set musicMuted(t){if(t==_._musicMuted)return;if(t){if(_._bgMusic){if(_._musicChannel&&!_._musicChannel.isStopped){if(T.Render.isConchApp){if(_._musicChannel._audio)_._musicChannel._audio.muted=true}else{_._musicChannel.pause()}}else{_._musicChannel=null}}else{_._musicChannel=null}_._musicMuted=t}else{_._musicMuted=t;if(_._bgMusic){if(_._musicChannel){if(T.Render.isConchApp){if(_._musicChannel._audio)_._musicChannel._audio.muted=false}else{_._musicChannel.resume()}}}}}static get musicMuted(){return _._musicMuted}static get useAudioMusic(){return _._useAudioMusic}static set useAudioMusic(t){_._useAudioMusic=t;if(t){_._musicClass=Ye}else{_._musicClass=null}}static playSound(t,e=1,o=null,i=null,a=0){if(!_._isActive||!t)return null;if(_._muted)return null;_._recoverWebAudio();t=M.formatURL(t);if(t==_._bgMusic){if(_._musicMuted)return null}else{if(T.Render.isConchApp){var r=f.getFileExtension(t);if(r!="wav"&&r!="ogg"){alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document.");return null}}if(_._soundMuted)return null}var s;if(!T.Browser.onBDMiniGame&&!T.Browser.onMiniGame&&!T.Browser.onKGMiniGame&&!T.Browser.onQGMiniGame&&!T.Browser.onVVMiniGame&&!T.Browser.onAlipayMiniGame&&!T.Browser.onQQMiniGame){s=T.loader.getRes(t)}if(!i)i=_._soundClass;if(!s){s=new i;s.load(t);if(!T.Browser.onBDMiniGame&&!T.Browser.onMiniGame&&!T.Browser.onKGMiniGame&&!T.Browser.onQGMiniGame&&!T.Browser.onVVMiniGame&&!T.Browser.onAlipayMiniGame&&!T.Browser.onQQMiniGame){T.Loader.cacheRes(t,s)}}var n;n=s.play(a,e);if(!n)return null;n.url=t;n.volume=t==_._bgMusic?_.musicVolume:_.soundVolume;n.completeHandler=o;return n}static destroySound(t){var e=T.loader.getRes(t);if(e){T.Loader.clearRes(t);e.dispose()}}static playMusic(t,e=0,o=null,i=0){t=M.formatURL(t);_._bgMusic=t;if(_._musicChannel)_._musicChannel.stop();return _._musicChannel=_.playSound(t,e,o,_._musicClass,i)}static stopSound(t){t=M.formatURL(t);var e;var o;for(e=_._channels.length-1;e>=0;e--){o=_._channels[e];if(o.url==t){o.stop()}}}static stopAll(){_._bgMusic=null;var t;var e;for(t=_._channels.length-1;t>=0;t--){e=_._channels[t];e.stop()}}static stopAllSound(){var t;var e;for(t=_._channels.length-1;t>=0;t--){e=_._channels[t];if(e.url!=_._bgMusic){e.stop()}}}static stopMusic(){if(_._musicChannel)_._musicChannel.stop();_._bgMusic=null}static setSoundVolume(t,e=null){if(e){e=M.formatURL(e);_._setVolume(e,t)}else{_.soundVolume=t;var o;var i;for(o=_._channels.length-1;o>=0;o--){i=_._channels[o];if(i.url!=_._bgMusic){i.volume=t}}}}static setMusicVolume(t){_.musicVolume=t;_._setVolume(_._bgMusic,t)}static _setVolume(t,e){t=M.formatURL(t);var o;var i;for(o=_._channels.length-1;o>=0;o--){i=_._channels[o];if(i.url==t){i.volume=e}}}}_.musicVolume=1;_.soundVolume=1;_.playbackRate=1;_._useAudioMusic=true;_._muted=false;_._soundMuted=false;_._musicMuted=false;_._bgMusic=null;_._musicChannel=null;_._channels=[];_._blurPaused=false;_._isActive=true;_._lastSoundUsedTimeDic={};_._isCheckingDispose=false;_.autoReleaseSound=true;class je extends e{constructor(){super(...arguments);this._http=new XMLHttpRequest}send(t,e=null,o="get",i="text",a=null){this._responseType=i;this._data=null;if(E.onVVMiniGame||E.onQGMiniGame||E.onQQMiniGame){t=encodeURI(t)}let r=t.replace(M._basePath,"");if(window.fileObj[r]){let t=window.fileObj[r];try{if(this._responseType==="json"){this._data=JSON.parse(t)}else if(this._responseType==="xml"){this._data=f.parseXMLFromString(t)}else{this._data=t}}catch(t){console.error("有报错了")}this.event(L.COMPLETE,this._data instanceof Array?[this._data]:this._data);return}this._url=t;var s=this;var n=this._http;t=M.getAdptedFilePath(t);n.open(o,t,true);if(a){for(var b=0;b<a.length;b++){n.setRequestHeader(a[b++],a[b])}}else if(!window.conch){if(!e||typeof e=="string")n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");else n.setRequestHeader("Content-Type","application/json")}let x=i!=="arraybuffer"?"text":"arraybuffer";n.responseType=x;if(n.dataType){n.dataType=x}n.onerror=function(t){s._onError(t)};n.onabort=function(t){s._onAbort(t)};n.onprogress=function(t){s._onProgress(t)};n.onload=function(t){s._onLoad(t)};n.send(e)}_onProgress(t){if(t&&t.lengthComputable)this.event(L.PROGRESS,t.loaded/t.total)}_onAbort(t){this.error("Request was aborted by user")}_onError(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}_onLoad(t){var e=this._http;var o=e.status!==undefined?e.status:200;if(o===200||o===204||o===0){this.complete()}else{this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}}error(t){this.clear();console.warn(this.url,t);this.event(L.ERROR,t)}complete(){this.clear();var e=true;try{if(this._responseType==="json"){this._data=JSON.parse(this._http.responseText)}else if(this._responseType==="xml"){this._data=f.parseXMLFromString(this._http.responseText)}else{this._data=this._http.response||this._http.responseText}}catch(t){e=false;this.error(t.message)}e&&this.event(L.COMPLETE,this._data instanceof Array?[this._data]:this._data)}clear(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}get url(){return this._url}get data(){return this._data}get http(){return this._http}}class Ke{constructor(){this._fontCharDic={};this._fontWidthMap={};this._maxWidth=0;this._spaceWidth=10;this.fontSize=12;this.autoScaleSize=false;this.letterSpacing=0}loadFont(t,e){this._path=t;this._complete=e;if(!t||t.indexOf(".fnt")===-1){console.error('Bitmap font configuration information must be a ".fnt" file');return}T.loader.load([{url:t,type:T.Loader.XML},{url:t.replace(".fnt",".png"),type:T.Loader.IMAGE}],Z.create(this,this._onLoaded))}_onLoaded(){this.parseFont(T.Loader.getRes(this._path),T.Loader.getRes(this._path.replace(".fnt",".png")));this._complete&&this._complete.run()}parseFont(t,e){if(t==null||e==null)return;this._texture=e;var o=1;var i=t.getElementsByTagName("info");if(!i[0].getAttributeNode){return this.parseFont2(t,e)}this.fontSize=parseInt(i[0].getAttributeNode("size").nodeValue);var a=i[0].getAttributeNode("padding").nodeValue;var r=a.split(",");this._padding=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];var s=t.getElementsByTagName("char");var n=0;for(n=0;n<s.length;n++){var b=s[n];var x=parseInt(b.getAttributeNode("id").nodeValue);var l=parseInt(b.getAttributeNode("xoffset").nodeValue)/o;var _=parseInt(b.getAttributeNode("yoffset").nodeValue)/o;var h=parseInt(b.getAttributeNode("xadvance").nodeValue)/o;var d=new B;d.x=parseInt(b.getAttributeNode("x").nodeValue);d.y=parseInt(b.getAttributeNode("y").nodeValue);d.width=parseInt(b.getAttributeNode("width").nodeValue);d.height=parseInt(b.getAttributeNode("height").nodeValue);var p=ae.create(e,d.x,d.y,d.width,d.height,l,_);this._maxWidth=Math.max(this._maxWidth,h+this.letterSpacing);this._fontCharDic[x]=p;this._fontWidthMap[x]=h}}parseFont2(t,e){if(t==null||e==null)return;this._texture=e;var o=1;var i=t.getElementsByTagName("info");this.fontSize=parseInt(i[0].attributes["size"].nodeValue);var a=i[0].attributes["padding"].nodeValue;var r=a.split(",");this._padding=[parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];var s=t.getElementsByTagName("char");var n=0;for(n=0;n<s.length;n++){var b=s[n].attributes;var x=parseInt(b["id"].nodeValue);var l=parseInt(b["xoffset"].nodeValue)/o;var _=parseInt(b["yoffset"].nodeValue)/o;var h=parseInt(b["xadvance"].nodeValue)/o;var d=new B;d.x=parseInt(b["x"].nodeValue);d.y=parseInt(b["y"].nodeValue);d.width=parseInt(b["width"].nodeValue);d.height=parseInt(b["height"].nodeValue);var p=ae.create(e,d.x,d.y,d.width,d.height,l,_);this._maxWidth=Math.max(this._maxWidth,h+this.letterSpacing);this._fontCharDic[x]=p;this._fontWidthMap[x]=h}}getCharTexture(t){return this._fontCharDic[t.charCodeAt(0)]}destroy(){if(this._texture){for(var t in this._fontCharDic){var e=this._fontCharDic[t];if(e)e.destroy()}this._texture.destroy();this._fontCharDic=null;this._fontWidthMap=null;this._texture=null;this._complete=null;this._padding=null}}setSpaceWidth(t){this._spaceWidth=t}getCharWidth(t){var e=t.charCodeAt(0);if(this._fontWidthMap[e])return this._fontWidthMap[e]+this.letterSpacing;if(t===" ")return this._spaceWidth+this.letterSpacing;return 0}getTextWidth(t){var e=0;for(var o=0,i=t.length;o<i;o++){e+=this.getCharWidth(t.charAt(o))}return e}getMaxWidth(){return this._maxWidth}getMaxHeight(){return this.fontSize}_drawText(t,e,o,i,a,r){var s=this.getTextWidth(t);var n;var b=0;a==="center"&&(b=(r-s)/2);a==="right"&&(b=r-s);var x=0;for(var l=0,_=t.length;l<_;l++){n=this.getCharTexture(t.charAt(l));if(n){e.graphics.drawImage(n,o+x+b,i);x+=this.getCharWidth(t.charAt(l))}}}}d.regClass("laya.display.BitmapFont",Ke);d.regClass("Laya.BitmapFont",Ke);class Ze{create(){if(this.json)return T.SceneUtils.createByData(null,this.json);return null}}class Qe{constructor(t=null){this._xd_=true;this._allocated_=8;this._pos_=0;this._length=0;if(t){this._u8d_=new Uint8Array(t);this._d_=new DataView(this._u8d_.buffer);this._length=this._d_.byteLength}else{this._resizeBuffer(this._allocated_)}}static getSystemEndian(){if(!Qe._sysEndian){var t=new ArrayBuffer(2);new DataView(t).setInt16(0,256,true);Qe._sysEndian=new Int16Array(t)[0]===256?Qe.LITTLE_ENDIAN:Qe.BIG_ENDIAN}return Qe._sysEndian}get buffer(){var t=this._d_.buffer;if(t.byteLength===this._length)return t;return t.slice(0,this._length)}get endian(){return this._xd_?Qe.LITTLE_ENDIAN:Qe.BIG_ENDIAN}set endian(t){this._xd_=t===Qe.LITTLE_ENDIAN}set length(t){if(this._allocated_<t)this._resizeBuffer(this._allocated_=Math.floor(Math.max(t,this._allocated_*2)));else if(this._allocated_>t)this._resizeBuffer(this._allocated_=t);this._length=t}get length(){return this._length}_resizeBuffer(e){try{var t=new Uint8Array(e);if(this._u8d_!=null){if(this._u8d_.length<=e)t.set(this._u8d_);else t.set(this._u8d_.subarray(0,e))}this._u8d_=t;this._d_=new DataView(t.buffer)}catch(t){throw"Invalid typed array length:"+e}}getString(){return this.readString()}readString(){return this._rUTF(this.getUint16())}getFloat32Array(t,e){return this.readFloat32Array(t,e)}readFloat32Array(t,e){var o=t+e;o=o>this._length?this._length:o;var i=new Float32Array(this._d_.buffer.slice(t,o));this._pos_=o;return i}getUint8Array(t,e){return this.readUint8Array(t,e)}readUint8Array(t,e){var o=t+e;o=o>this._length?this._length:o;var i=new Uint8Array(this._d_.buffer.slice(t,o));this._pos_=o;return i}getInt16Array(t,e){return this.readInt16Array(t,e)}readInt16Array(t,e){var o=t+e;o=o>this._length?this._length:o;var i=new Int16Array(this._d_.buffer.slice(t,o));this._pos_=o;return i}getFloat32(){return this.readFloat32()}readFloat32(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var t=this._d_.getFloat32(this._pos_,this._xd_);this._pos_+=4;return t}getFloat64(){return this.readFloat64()}readFloat64(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var t=this._d_.getFloat64(this._pos_,this._xd_);this._pos_+=8;return t}writeFloat32(t){this._ensureWrite(this._pos_+4);this._d_.setFloat32(this._pos_,t,this._xd_);this._pos_+=4}writeFloat64(t){this._ensureWrite(this._pos_+8);this._d_.setFloat64(this._pos_,t,this._xd_);this._pos_+=8}getInt32(){return this.readInt32()}readInt32(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var t=this._d_.getInt32(this._pos_,this._xd_);this._pos_+=4;return t}getUint32(){return this.readUint32()}readUint32(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var t=this._d_.getUint32(this._pos_,this._xd_);this._pos_+=4;return t}writeInt32(t){this._ensureWrite(this._pos_+4);this._d_.setInt32(this._pos_,t,this._xd_);this._pos_+=4}writeUint32(t){this._ensureWrite(this._pos_+4);this._d_.setUint32(this._pos_,t,this._xd_);this._pos_+=4}getInt16(){return this.readInt16()}readInt16(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var t=this._d_.getInt16(this._pos_,this._xd_);this._pos_+=2;return t}getUint16(){return this.readUint16()}readUint16(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var t=this._d_.getUint16(this._pos_,this._xd_);this._pos_+=2;return t}writeUint16(t){this._ensureWrite(this._pos_+2);this._d_.setUint16(this._pos_,t,this._xd_);this._pos_+=2}writeInt16(t){this._ensureWrite(this._pos_+2);this._d_.setInt16(this._pos_,t,this._xd_);this._pos_+=2}getUint8(){return this.readUint8()}readUint8(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}writeUint8(t){this._ensureWrite(this._pos_+1);this._d_.setUint8(this._pos_,t);this._pos_++}_getUInt8(t){return this._readUInt8(t)}_readUInt8(t){return this._d_.getUint8(t)}_getUint16(t){return this._readUint16(t)}_readUint16(t){return this._d_.getUint16(t,this._xd_)}_getMatrix(){return this._readMatrix()}_readMatrix(){var t=new w(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());return t}_rUTF(t){var e=this._pos_+t,o,i,a,r=String.fromCharCode;var s=this._u8d_;var n=[];var b=0;n.length=1e3;while(this._pos_<e){o=s[this._pos_++];if(o<128){if(o!=0)n[b++]=r(o)}else if(o<224){n[b++]=r((o&63)<<6|s[this._pos_++]&127)}else if(o<240){i=s[this._pos_++];n[b++]=r((o&31)<<12|(i&127)<<6|s[this._pos_++]&127)}else{i=s[this._pos_++];a=s[this._pos_++];n[b++]=r((o&15)<<18|(i&127)<<12|a<<6&127|s[this._pos_++]&127)}}n.length=b;return n.join("")}getCustomString(t){return this.readCustomString(t)}readCustomString(t){var e="",o=0,i,a,r=String.fromCharCode;var s=this._u8d_;while(t>0){i=s[this._pos_];if(i<128){e+=r(i);this._pos_++;t--}else{o=i-128;this._pos_++;t-=o;while(o>0){i=s[this._pos_++];a=s[this._pos_++];e+=r(a<<8|i);o--}}}return e}get pos(){return this._pos_}set pos(t){this._pos_=t}get bytesAvailable(){return this._length-this._pos_}clear(){this._pos_=0;this.length=0}__getBuffer(){return this._d_.buffer}writeUTFBytes(t){t=t+"";for(var e=0,o=t.length;e<o;e++){var i=t.charCodeAt(e);if(i<=127){this.writeByte(i)}else if(i<=2047){this._ensureWrite(this._pos_+2);this._u8d_.set([192|i>>6,128|i&63],this._pos_);this._pos_+=2}else if(i<=65535){this._ensureWrite(this._pos_+3);this._u8d_.set([224|i>>12,128|i>>6&63,128|i&63],this._pos_);this._pos_+=3}else{this._ensureWrite(this._pos_+4);this._u8d_.set([240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63],this._pos_);this._pos_+=4}}}writeUTFString(t){var e=this.pos;this.writeUint16(1);this.writeUTFBytes(t);var o=this.pos-e-2;this._d_.setUint16(e,o,this._xd_)}readUTFString(){return this.readUTFBytes(this.getUint16())}getUTFString(){return this.readUTFString()}readUTFBytes(t=-1){if(t===0)return"";var e=this.bytesAvailable;if(t>e)throw"readUTFBytes error - Out of bounds";t=t>0?t:e;return this._rUTF(t)}getUTFBytes(t=-1){return this.readUTFBytes(t)}writeByte(t){this._ensureWrite(this._pos_+1);this._d_.setInt8(this._pos_,t);this._pos_+=1}readByte(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}getByte(){return this.readByte()}_ensureWrite(t){if(this._length<t)this._length=t;if(this._allocated_<t)this.length=t}writeArrayBuffer(t,e=0,o=0){if(e<0||o<0)throw"writeArrayBuffer error - Out of bounds";if(o==0)o=t.byteLength-e;this._ensureWrite(this._pos_+o);var i=new Uint8Array(t);this._u8d_.set(i.subarray(e,e+o),this._pos_);this._pos_+=o}readArrayBuffer(t){var e;e=this._u8d_.buffer.slice(this._pos_,this._pos_+t);this._pos_=this._pos_+t;return e}}Qe.BIG_ENDIAN="bigEndian";Qe.LITTLE_ENDIAN="littleEndian";Qe._sysEndian=null;class J extends e{constructor(){super(...arguments);this._customParse=false}static getTypeFromUrl(t){var e=f.getFileExtension(t);if(e)return J.typeMap[e];console.warn("Not recognize the resources suffix",t);return"text"}load(t,e=null,o=true,i=null,a=false,r=T.WorkerLoader.enable){if(!t){this.onLoaded(null);return}J.setGroup(t,"666");this._url=t;if(t.indexOf("data:image")===0)e=J.IMAGE;else t=M.formatURL(t);this._type=e||(e=J.getTypeFromUrl(this._url));this._cache=o;this._useWorkerLoader=r;this._data=null;if(r)T.WorkerLoader.enableWorkerLoader();if(!a&&J.loadedMap[t]){this._data=J.loadedMap[t];this.event(L.PROGRESS,1);this.event(L.COMPLETE,this._data);return}if(i)J.setGroup(t,i);if(J.parserMap[e]!=null){this._customParse=true;if(J.parserMap[e]instanceof Z)J.parserMap[e].runWith(this);else J.parserMap[e].call(null,this);return}this._loadResourceFilter(e,t)}_loadResourceFilter(t,e){this._loadResource(t,e)}_loadResource(t,e){switch(t){case J.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(e);break;case J.SOUND:this._loadSound(e);break;case J.TTF:this._loadTTF(e);break;case J.ATLAS:case J.PREFAB:case J.PLF:this._loadHttpRequestWhat(e,J.JSON);break;case J.FONT:this._loadHttpRequestWhat(e,J.XML);break;case J.PLFB:this._loadHttpRequestWhat(e,J.BUFFER);break;default:this._loadHttpRequestWhat(e,t)}}_loadHttpRequest(t,e,o,i,a,r,s,n){if(E.onVVMiniGame){this._http=new je}else{if(!this._http)this._http=new je}this._http.on(L.PROGRESS,a,r);this._http.on(L.COMPLETE,o,i);this._http.on(L.ERROR,s,n);this._http.send(t,null,"get",e)}_loadHtmlImage(e,t,o,i,a){var r;function s(){var t=r;t.onload=null;t.onerror=null;delete J._imgCache[e]}var n=function(){s();a.call(i)};var b=function(){s();o.call(t,r)};r=new E.window.Image;r.crossOrigin="";r.onload=b;r.onerror=n;let x=e.replace(M._basePath,"");if(window.fileObj[x]){r.src=window.fileObj[x]}else{r.src=e}J._imgCache[e]=r}_loadHttpRequestWhat(t,e){if(J.preLoadedMap[t])this.onLoaded(J.preLoadedMap[t]);else this._loadHttpRequest(t,e,this,this.onLoaded,this,this.onProgress,this,this.onError)}_loadTTF(t){t=M.formatURL(t);var e=new T.TTFLoader;e.complete=Z.create(this,this.onLoaded);e.load(t)}_loadImage(i){var a=this;i=M.formatURL(i);var t;var e=function(){a.event(L.ERROR,"Load image failed")};if(this._type==="nativeimage"){t=function(t){a.onLoaded(t)};this._loadHtmlImage(i,this,t,this,e)}else{var r=f.getFileExtension(i);if(r==="ktx"||r==="pvr"){t=function(t){var e;switch(r){case"ktx":e=5;break;case"pvr":e=12;break}var o=new tt(0,0,e,false,false);o.wrapModeU=v.WARPMODE_CLAMP;o.wrapModeV=v.WARPMODE_CLAMP;o.setCompressData(t);o._setCreateURL(i);a.onLoaded(o)};this._loadHttpRequest(i,J.BUFFER,this,t,null,null,this,e)}else{t=function(t){var e=new tt(t.width,t.height,1,false,false);e.wrapModeU=v.WARPMODE_CLAMP;e.wrapModeV=v.WARPMODE_CLAMP;e.loadImageSource(t,true);e._setCreateURL(i);a.onLoaded(e)};this._loadHtmlImage(i,this,t,this,e)}}}_loadSound(t){var e=new _._soundClass;var o=this;e.on(L.COMPLETE,this,i);e.on(L.ERROR,this,a);e.load(t);function i(){r();o.onLoaded(e)}function a(){r();e.dispose();o.event(L.ERROR,"Load sound failed")}function r(){e.offAll()}}onProgress(t){if(this._type===J.ATLAS)this.event(L.PROGRESS,t*.3);else this.event(L.PROGRESS,t)}onError(t){this.event(L.ERROR,t)}onLoaded(t=null){var e=this._type;if(e==J.PLFB){this.parsePLFBData(t);this.complete(t)}else if(e==J.PLF){this.parsePLFData(t);this.complete(t)}else if(e===J.IMAGE){var o=new ae(t);o.url=this._url;this.complete(o)}else if(e===J.SOUND||e==="htmlimage"||e==="nativeimage"){this.complete(t)}else if(e===J.ATLAS){if(!(t instanceof tt)){if(!this._data){this._data=t;if(t.meta&&t.meta.image){var i=t.meta.image.split(",");var a=this._url.indexOf("/")>=0?"/":"\\";var r=this._url.lastIndexOf(a);var s=r>=0?this._url.substr(0,r+1):"";var n;if(E.onAndroid&&t.meta.compressTextureAndroid){n=".ktx"}if(E.onIOS&&t.meta.compressTextureIOS){n=".pvr"}for(var b=0,x=i.length;b<x;b++){if(n){i[b]=s+i[b].replace(".png",n)}else{i[b]=s+i[b]}}}else{i=[this._url.replace(".json",".png")]}i.reverse();t.toLoads=i;t.pics=[]}this.event(L.PROGRESS,.3+1/i.length*.6);return this._loadResourceFilter(J.IMAGE,i.pop())}else{this._data.pics.push(t);if(this._data.toLoads.length>0){this.event(L.PROGRESS,.3+1/this._data.toLoads.length*.6);return this._loadResourceFilter(J.IMAGE,this._data.toLoads.pop())}var l=this._data.frames;var _=this._url.split("?")[0];var h=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:_.substring(0,_.lastIndexOf("."))+"/";var d=this._data.pics;var p=M.formatURL(this._url);var c=J.atlasMap[p]||(J.atlasMap[p]=[]);c.dir=h;var u=1;if(this._data.meta&&this._data.meta.scale&&this._data.meta.scale!=1){u=parseFloat(this._data.meta.scale);for(var y in l){var m=l[y];var f=d[m.frame.idx?m.frame.idx:0];var g=M.formatURL(h+y);f.scaleRate=u;var v;v=ae._create(f,m.frame.x,m.frame.y,m.frame.w,m.frame.h,m.spriteSourceSize.x,m.spriteSourceSize.y,m.sourceSize.w,m.sourceSize.h,J.getRes(g));J.cacheRes(g,v);v.url=g;c.push(g)}}else{for(y in l){m=l[y];f=d[m.frame.idx?m.frame.idx:0];g=M.formatURL(h+y);v=ae._create(f,m.frame.x,m.frame.y,m.frame.w,m.frame.h,m.spriteSourceSize.x,m.spriteSourceSize.y,m.sourceSize.w,m.sourceSize.h,J.getRes(g));J.cacheRes(g,v);v.url=g;c.push(g)}}delete this._data.pics;this.complete(this._data)}}else if(e===J.FONT){if(!t._source){this._data=t;this.event(L.PROGRESS,.5);return this._loadImage(this._url.replace(".fnt",".png"))}else{var S=new Ke;S.parseFont(this._data,new ae(t));var C=this._url.split(".fnt")[0].split("/");var P=C[C.length-1];G.registerBitmapFont(P,S);this._data=S;this.complete(this._data)}}else if(e===J.PREFAB){var A=new Ze;A.json=t;this.complete(A)}else{this.complete(t)}}parsePLFData(t){var e;var o;var i;for(e in t){i=t[e];switch(e){case"json":case"text":for(o in i){J.preLoadedMap[M.formatURL(o)]=i[o]}break;default:for(o in i){J.preLoadedMap[M.formatURL(o)]=i[o]}}}}parsePLFBData(t){var e;e=new Qe(t);var o,i;i=e.getInt32();for(o=0;o<i;o++){this.parseOnePLFBFile(e)}}parseOnePLFBFile(t){var e;var o;var i;o=t.getUTFString();e=t.getInt32();i=t.readArrayBuffer(e);J.preLoadedMap[M.formatURL(o)]=i}complete(t){this._data=t;if(this._customParse){this.event(L.LOADED,t instanceof Array?[t]:t)}else{J._loaders.push(this);if(!J._isWorking)J.checkNext()}}static checkNext(){J._isWorking=true;var t=E.now();var e=t;while(J._startIndex<J._loaders.length){e=E.now();J._loaders[J._startIndex].endLoad();J._startIndex++;if(E.now()-t>J.maxTimeOut){console.warn("loader callback cost a long time:"+(E.now()-t)+" url="+J._loaders[J._startIndex-1].url);T.systemTimer.frameOnce(1,null,J.checkNext);return}}J._loaders.length=0;J._startIndex=0;J._isWorking=false}endLoad(t=null){t&&(this._data=t);if(this._cache)J.cacheRes(this._url,this._data);this.event(L.PROGRESS,1);this.event(L.COMPLETE,this.data instanceof Array?[this.data]:this.data)}get url(){return this._url}get type(){return this._type}get cache(){return this._cache}get data(){return this._data}static clearRes(t){t=M.formatURL(t);var e=J.getAtlas(t);if(e){for(var o=0,i=e.length;o<i;o++){var a=e[o];var r=J.getRes(a);delete J.loadedMap[a];if(r)r.destroy()}e.length=0;delete J.atlasMap[t];delete J.loadedMap[t]}else{var s=J.loadedMap[t];if(s){delete J.loadedMap[t];if(s instanceof ae&&s.bitmap)s.destroy()}}}static clearTextureRes(t){t=M.formatURL(t);var e=J.getAtlas(t);if(e&&e.length>0){e.forEach(function(t){var e=J.getRes(t);if(e instanceof ae){e.disposeBitmap()}})}else{var o=J.getRes(t);if(o instanceof ae){o.disposeBitmap()}}}static getRes(t){return J.loadedMap[M.formatURL(t)]}static getAtlas(t){return J.atlasMap[M.formatURL(t)]}static cacheRes(t,e){t=M.formatURL(t);if(J.loadedMap[t]!=null){}else{J.loadedMap[t]=e}}static setGroup(t,e){if(!J.groupMap[e])J.groupMap[e]=[];J.groupMap[e].push(t)}static clearResByGroup(t){if(!J.groupMap[t])return;var e=J.groupMap[t],o,i=e.length;for(o=0;o<i;o++){J.clearRes(e[o])}e.length=0}}J.TEXT="text";J.JSON="json";J.PREFAB="prefab";J.XML="xml";J.BUFFER="arraybuffer";J.IMAGE="image";J.SOUND="sound";J.ATLAS="atlas";J.FONT="font";J.TTF="ttf";J.PLF="plf";J.PLFB="plfb";J.HIERARCHY="HIERARCHY";J.MESH="MESH";J.MATERIAL="MATERIAL";J.TEXTURE2D="TEXTURE2D";J.TEXTURECUBE="TEXTURECUBE";J.ANIMATIONCLIP="ANIMATIONCLIP";J.AVATAR="AVATAR";J.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA";J.TERRAINRES="TERRAIN";J.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer"};J.parserMap={};J.maxTimeOut=100;J.groupMap={};J.loadedMap={};J.atlasMap={};J.preLoadedMap={};J._imgCache={};J._loaders=[];J._isWorking=false;J._startIndex=0;class $e{static enable(t,e=null){T.loader.load(t,Z.create(null,$e._onInfoLoaded,[e]),null,J.JSON)}static _onInfoLoaded(t,e){var o;var i;var a;var r,s;for(o in e){a=e[o];i=a[0];a=a[1];s=a.length;for(r=0;r<s;r++){$e._fileLoadDic[i+a[r]]=o}}t&&t.run()}static getFileLoadPath(t){return $e._fileLoadDic[t]||t}}$e._fileLoadDic={};class to extends e{constructor(){super();this.retryNum=1;this.retryDelay=0;this.maxLoader=5;this._loaders=[];this._loaderCount=0;this._resInfos=[];this._infoPool=[];this._maxPriority=5;this._failRes={};this._statInfo={count:1,loaded:1};for(var t=0;t<this._maxPriority;t++)this._resInfos[t]=[]}getProgress(){return this._statInfo.loaded/this._statInfo.count}resetProgress(){this._statInfo.count=this._statInfo.loaded=1}create(t,e=null,o=null,i=null,a=null,r=null,s=1,n=true){this._create(t,true,e,o,i,a,r,s,n)}_create(t,e,o=null,i=null,a=null,r=null,s=null,n=1,b=true){if(t instanceof Array){var x=true;var l=t;var _=l.length;var h=0;if(i){var d=Z.create(i.caller,i.method,i.args,false)}for(var p=0;p<_;p++){var c=l[p];if(typeof c=="string")c=l[p]={url:c};c.progress=0}for(p=0;p<_;p++){c=l[p];var u=i?Z.create(null,function(t,e){t.progress=e;var o=0;for(var i=0;i<_;i++){var a=l[i];o+=a.progress}var r=o/_;d.runWith(r)},[c],false):null;var y=i||o?Z.create(null,function(t,e=null){h++;t.progress=1;e||(x=false);if(h===_&&o){o.runWith(x)}},[c]):null;this._createOne(c.url,e,y,u,c.type||a,c.constructParams||r,c.propertyParams||s,c.priority||n,b)}}else{this._createOne(t,e,o,i,a,r,s,n,b)}}_createOne(e,o,i=null,t=null,a=null,r=null,s=null,n=1,b=true){var x=this.getRes(e);if(!x){var l=f.getFileExtension(e);a||(a=to.createMap[l]?to.createMap[l][0]:null);if(!a){this.load(e,i,t,a,n,b);return}var _=J.parserMap;if(!_[a]){this.load(e,i,t,a,n,b);return}this._createLoad(e,Z.create(null,function(t){if(t){if(!o&&t instanceof $)t._addReference();t._setCreateURL(e)}i&&i.runWith(t);T.loader.event(e)}),t,a,r,s,n,b,true)}else{if(!o&&x instanceof $)x._addReference();t&&t.runWith(1);i&&i.runWith(x)}}load(t,e=null,o=null,i=null,a=1,r=true,s=null,n=false,b=T.WorkerLoader.enable){if(t instanceof Array)return this._loadAssets(t,e,o,i,a,r,s);var x=J.getRes(t);if(!n&&x!=null){T.systemTimer.frameOnce(1,this,function(){o&&o.runWith(1);e&&e.runWith(x instanceof Array?[x]:x);this._loaderCount||this.event(L.COMPLETE)})}else{var l;l=t;t=$e.getFileLoadPath(t);if(t!=l&&i!=="nativeimage"){i=J.ATLAS}else{l=null}var _=to._resMap[t];if(!_){_=this._infoPool.length?this._infoPool.pop():new eo;_.url=t;_.type=i;_.cache=r;_.group=s;_.ignoreCache=n;_.useWorkerLoader=b;_.originalUrl=l;e&&_.on(L.COMPLETE,e.caller,e.method,e.args);o&&_.on(L.PROGRESS,o.caller,o.method,o.args);to._resMap[t]=_;a=a<this._maxPriority?a:this._maxPriority-1;this._resInfos[a].push(_);this._statInfo.count++;this.event(L.PROGRESS,this.getProgress());this._next()}else{if(e){if(l){e&&_._createListener(L.COMPLETE,this,this._resInfoLoaded,[l,e],false,false)}else{e&&_._createListener(L.COMPLETE,e.caller,e.method,e.args,false,false)}}o&&_._createListener(L.PROGRESS,o.caller,o.method,o.args,false,false)}}return this}_resInfoLoaded(t,e){e.runWith(J.getRes(t))}_createLoad(t,e=null,o=null,i=null,a=null,r=null,s=1,n=true,b=false){if(t instanceof Array)return this._loadAssets(t,e,o,i,s,n);var x=J.getRes(t);if(x!=null){T.systemTimer.frameOnce(1,this,function(){o&&o.runWith(1);e&&e.runWith(x);this._loaderCount||this.event(L.COMPLETE)})}else{var l=to._resMap[t];if(!l){l=this._infoPool.length?this._infoPool.pop():new eo;l.url=t;l.type=i;l.cache=false;l.ignoreCache=b;l.originalUrl=null;l.group=null;l.createCache=n;l.createConstructParams=a;l.createPropertyParams=r;e&&l.on(L.COMPLETE,e.caller,e.method,e.args);o&&l.on(L.PROGRESS,o.caller,o.method,o.args);to._resMap[t]=l;s=s<this._maxPriority?s:this._maxPriority-1;this._resInfos[s].push(l);this._statInfo.count++;this.event(L.PROGRESS,this.getProgress());this._next()}else{e&&l._createListener(L.COMPLETE,e.caller,e.method,e.args,false,false);o&&l._createListener(L.PROGRESS,o.caller,o.method,o.args,false,false)}}return this}_next(){if(this._loaderCount>=this.maxLoader)return;for(var t=0;t<this._maxPriority;t++){var e=this._resInfos[t];while(e.length>0){var o=e.shift();if(o)return this._doLoad(o)}}this._loaderCount||this.event(L.COMPLETE)}_doLoad(e){this._loaderCount++;var o=this._loaders.length?this._loaders.pop():new J;o.on(L.COMPLETE,null,a);o.on(L.PROGRESS,null,function(t){e.event(L.PROGRESS,t)});o.on(L.ERROR,null,function(t){a(null)});var i=this;function a(t=null){o.offAll();o._data=null;o._customParse=false;i._loaders.push(o);i._endLoad(e,t instanceof Array?[t]:t);i._loaderCount--;i._next()}o._constructParams=e.createConstructParams;o._propertyParams=e.createPropertyParams;o._createCache=e.createCache;o.load(e.url,e.type,e.cache,e.group,e.ignoreCache,e.useWorkerLoader)}_endLoad(t,e){var o=t.url;if(e==null){var i=this._failRes[o]||0;if(i<this.retryNum){console.warn("[warn]Retry to load:",o);this._failRes[o]=i+1;T.systemTimer.once(this.retryDelay,this,this._addReTry,[t],false);return}else{J.clearRes(o);console.warn("[error]Failed to load:",o);this.event(L.ERROR,o)}}if(this._failRes[o])this._failRes[o]=0;delete to._resMap[o];if(t.originalUrl){e=J.getRes(t.originalUrl)}t.event(L.COMPLETE,e);t.offAll();this._infoPool.push(t);this._statInfo.loaded++;this.event(L.PROGRESS,this.getProgress())}_addReTry(t){this._resInfos[this._maxPriority-1].push(t);this._next()}clearRes(t){J.clearRes(t)}clearTextureRes(t){J.clearTextureRes(t)}getRes(t){return J.getRes(t)}cacheRes(t,e){J.cacheRes(t,e)}setGroup(t,e){J.setGroup(t,e)}clearResByGroup(t){J.clearResByGroup(t)}static cacheRes(t,e){J.cacheRes(t,e)}clearUnLoaded(){for(var t=0;t<this._maxPriority;t++){var e=this._resInfos[t];for(var o=e.length-1;o>-1;o--){var i=e[o];if(i){i.offAll();this._infoPool.push(i)}}e.length=0}this._loaderCount=0;to._resMap={}}cancelLoadByUrls(t){if(!t)return;for(var e=0,o=t.length;e<o;e++){this.cancelLoadByUrl(t[e])}}cancelLoadByUrl(t){for(var e=0;e<this._maxPriority;e++){var o=this._resInfos[e];for(var i=o.length-1;i>-1;i--){var a=o[i];if(a&&a.url===t){o[i]=null;a.offAll();this._infoPool.push(a)}}}if(to._resMap[t])delete to._resMap[t]}_loadAssets(t,o=null,s=null,e=null,i=1,a=true,r=null){var n=t.length;var b=0;var x=0;var l=[];var _=true;for(var h=0;h<n;h++){var d=t[h];if(typeof d=="string")d={url:d,type:e,size:1,priority:i};if(!d.size)d.size=1;d.progress=0;x+=d.size;l.push(d);var p=s?Z.create(null,y,[d],false):null;var c=o||s?Z.create(null,u,[d]):null;this.load(d.url,c,p,d.type,d.priority||1,a,d.group||r,false,d.useWorkerLoader)}function u(t,e=null){b++;t.progress=1;if(!e)_=false;if(b===n&&o){o.runWith(_)}}function y(t,e){if(s!=null){t.progress=e;var o=0;for(var i=0;i<l.length;i++){var a=l[i];o+=a.size*a.progress}var r=o/x;s.runWith(r)}}return this}decodeBitmaps(t){var e,o=t.length;var i;i=T.Render._context;for(e=0;e<o;e++){var a;a=J.getAtlas(t[e]);if(a){this._decodeTexture(a[0],i)}else{var r;r=this.getRes(t[e]);if(r&&r instanceof ae){this._decodeTexture(r,i)}}}}_decodeTexture(t,e){var o=t.bitmap;if(!t||!o)return;var i=o.source||o.image;if(!i)return;if(i instanceof HTMLImageElement){e.drawImage(i,0,0,1,1);var a=e.getImageData(0,0,1,1)}}}to._resMap={};to.createMap={atlas:[null,J.ATLAS]};class eo extends e{}class oo{static __init__(){if(!oo._baseClass){oo._baseClass=io;io.init()}oo.items=oo._baseClass.items;oo.support=oo._baseClass.support;return oo.support}static setItem(t,e){oo._baseClass.setItem(t,e)}static getItem(t){return oo._baseClass.getItem(t)}static setJSON(t,e){oo._baseClass.setJSON(t,e)}static getJSON(t){return oo._baseClass.getJSON(t)}static removeItem(t){oo._baseClass.removeItem(t)}static clear(){oo._baseClass.clear()}}oo.support=false;class io{static init(){try{io.support=true;io.items=window.localStorage;io.setItem("laya","1");io.removeItem("laya")}catch(t){io.support=false}if(!io.support)console.log("LocalStorage is not supprot or browser is private mode.")}static setItem(t,e){try{io.support&&io.items.setItem(t,e)}catch(t){console.warn("set localStorage failed",t)}}static getItem(t){return io.support?io.items.getItem(t):null}static setJSON(t,e){try{io.support&&io.items.setItem(t,JSON.stringify(e))}catch(t){console.warn("set localStorage failed",t)}}static getJSON(t){return JSON.parse(io.support?io.items.getItem(t):null)}static removeItem(t){io.support&&io.items.removeItem(t)}static clear(){io.support&&io.items.clear()}}io.support=false;class ao{load(t){this._url=t;var e=t.split(".ttf")[0].split("/");this.fontName=e[e.length-1];if(T.Render.isConchApp){this._loadConch()}else if(window.FontFace){this._loadWithFontFace()}else{this._loadWithCSS()}}_loadConch(){this._http=new je;this._http.on(L.ERROR,this,this._onErr);this._http.on(L.COMPLETE,this,this._onHttpLoaded);this._http.send(this._url,null,"get",J.BUFFER)}_onHttpLoaded(t=null){window["conchTextCanvas"].setFontFaceFromBuffer(this.fontName,t);this._clearHttp();this._complete()}_clearHttp(){if(this._http){this._http.off(L.ERROR,this,this._onErr);this._http.off(L.COMPLETE,this,this._onHttpLoaded);this._http=null}}_onErr(){this._clearHttp();if(this.err){this.err.runWith("fail:"+this._url);this.err=null}}_complete(){T.systemTimer.clear(this,this._complete);T.systemTimer.clear(this,this._checkComplete);if(this._div&&this._div.parentNode){this._div.parentNode.removeChild(this._div);this._div=null}if(this.complete){this.complete.runWith(this);this.complete=null}}_checkComplete(){if(T.Browser.measureText(ao._testString,this._fontTxt).width!=this._txtWidth){this._complete()}}_loadWithFontFace(){var t=new window.FontFace(this.fontName,"url('"+this._url+"')");document.fonts.add(t);var e=this;t.loaded.then(function(){e._complete()});t.load()}_createDiv(){this._div=E.createElement("div");this._div.innerHTML="laya";var t=this._div.style;t.fontFamily=this.fontName;t.position="absolute";t.left="-100px";t.top="-100px";document.body.appendChild(this._div)}_loadWithCSS(){var t=E.createElement("style");t.type="text/css";document.body.appendChild(t);t.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}";this._fontTxt="40px "+this.fontName;this._txtWidth=E.measureText(ao._testString,this._fontTxt).width;var e=this;t.onload=function(){T.systemTimer.once(1e4,e,this._complete)};T.systemTimer.loop(20,this,this._checkComplete);this._createDiv()}}ao._testString="LayaTTFFont";class ro{static linearNone(t,e,o,i){return o*t/i+e}static linearIn(t,e,o,i){return o*t/i+e}static linearInOut(t,e,o,i){return o*t/i+e}static linearOut(t,e,o,i){return o*t/i+e}static bounceIn(t,e,o,i){return o-ro.bounceOut(i-t,0,o,i)+e}static bounceInOut(t,e,o,i){if(t<i*.5)return ro.bounceIn(t*2,0,o,i)*.5+e;else return ro.bounceOut(t*2-i,0,o,i)*.5+o*.5+e}static bounceOut(t,e,o,i){if((t/=i)<1/2.75)return o*(7.5625*t*t)+e;else if(t<2/2.75)return o*(7.5625*(t-=1.5/2.75)*t+.75)+e;else if(t<2.5/2.75)return o*(7.5625*(t-=2.25/2.75)*t+.9375)+e;else return o*(7.5625*(t-=2.625/2.75)*t+.984375)+e}static backIn(t,e,o,i,a=1.70158){return o*(t/=i)*t*((a+1)*t-a)+e}static backInOut(t,e,o,i,a=1.70158){if((t/=i*.5)<1)return o*.5*(t*t*(((a*=1.525)+1)*t-a))+e;return o/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+e}static backOut(t,e,o,i,a=1.70158){return o*((t=t/i-1)*t*((a+1)*t+a)+1)+e}static elasticIn(t,e,o,i,a=0,r=0){var s;if(t==0)return e;if((t/=i)==1)return e+o;if(!r)r=i*.3;if(!a||o>0&&a<o||o<0&&a<-o){a=o;s=r/4}else s=r/ro.PI2*Math.asin(o/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*ro.PI2/r))+e}static elasticInOut(t,e,o,i,a=0,r=0){var s;if(t==0)return e;if((t/=i*.5)==2)return e+o;if(!r)r=i*(.3*1.5);if(!a||o>0&&a<o||o<0&&a<-o){a=o;s=r/4}else s=r/ro.PI2*Math.asin(o/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*ro.PI2/r))+e;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*ro.PI2/r)*.5+o+e}static elasticOut(t,e,o,i,a=0,r=0){var s;if(t==0)return e;if((t/=i)==1)return e+o;if(!r)r=i*.3;if(!a||o>0&&a<o||o<0&&a<-o){a=o;s=r/4}else s=r/ro.PI2*Math.asin(o/a);return a*Math.pow(2,-10*t)*Math.sin((t*i-s)*ro.PI2/r)+o+e}static strongIn(t,e,o,i){return o*(t/=i)*t*t*t*t+e}static strongInOut(t,e,o,i){if((t/=i*.5)<1)return o*.5*t*t*t*t*t+e;return o*.5*((t-=2)*t*t*t*t+2)+e}static strongOut(t,e,o,i){return o*((t=t/i-1)*t*t*t*t+1)+e}static sineInOut(t,e,o,i){return-o*.5*(Math.cos(Math.PI*t/i)-1)+e}static sineIn(t,e,o,i){return-o*Math.cos(t/i*ro.HALF_PI)+o+e}static sineOut(t,e,o,i){return o*Math.sin(t/i*ro.HALF_PI)+e}static quintIn(t,e,o,i){return o*(t/=i)*t*t*t*t+e}static quintInOut(t,e,o,i){if((t/=i*.5)<1)return o*.5*t*t*t*t*t+e;return o*.5*((t-=2)*t*t*t*t+2)+e}static quintOut(t,e,o,i){return o*((t=t/i-1)*t*t*t*t+1)+e}static quartIn(t,e,o,i){return o*(t/=i)*t*t*t+e}static quartInOut(t,e,o,i){if((t/=i*.5)<1)return o*.5*t*t*t*t+e;return-o*.5*((t-=2)*t*t*t-2)+e}static quartOut(t,e,o,i){return-o*((t=t/i-1)*t*t*t-1)+e}static cubicIn(t,e,o,i){return o*(t/=i)*t*t+e}static cubicInOut(t,e,o,i){if((t/=i*.5)<1)return o*.5*t*t*t+e;return o*.5*((t-=2)*t*t+2)+e}static cubicOut(t,e,o,i){return o*((t=t/i-1)*t*t+1)+e}static quadIn(t,e,o,i){return o*(t/=i)*t+e}static quadInOut(t,e,o,i){if((t/=i*.5)<1)return o*.5*t*t+e;return-o*.5*(--t*(t-2)-1)+e}static quadOut(t,e,o,i){return-o*(t/=i)*(t-2)+e}static expoIn(t,e,o,i){return t==0?e:o*Math.pow(2,10*(t/i-1))+e-o*.001}static expoInOut(t,e,o,i){if(t==0)return e;if(t==i)return e+o;if((t/=i*.5)<1)return o*.5*Math.pow(2,10*(t-1))+e;return o*.5*(-Math.pow(2,-10*--t)+2)+e}static expoOut(t,e,o,i){return t==i?e+o:o*(-Math.pow(2,-10*t/i)+1)+e}static circIn(t,e,o,i){return-o*(Math.sqrt(1-(t/=i)*t)-1)+e}static circInOut(t,e,o,i){if((t/=i*.5)<1)return-o*.5*(Math.sqrt(1-t*t)-1)+e;return o*.5*(Math.sqrt(1-(t-=2)*t)+1)+e}static circOut(t,e,o,i){return o*Math.sqrt(1-(t=t/i-1)*t)+e}}ro.HALF_PI=Math.PI*.5;ro.PI2=Math.PI*2;class so{constructor(){this.gid=0;this.repeat=1;this._count=0}static to(t,e,o,i=null,a=null,r=0,s=false,n=true){return p.getItemByClass("tween",so)._create(t,e,o,i,a,r,s,true,n,true)}static from(t,e,o,i=null,a=null,r=0,s=false,n=true){return p.getItemByClass("tween",so)._create(t,e,o,i,a,r,s,false,n,true)}to(t,e,o,i=null,a=null,r=0,s=false){return this._create(t,e,o,i,a,r,s,true,false,true)}from(t,e,o,i=null,a=null,r=0,s=false){return this._create(t,e,o,i,a,r,s,false,false,true)}_create(t,e,o,i,a,r,s,n,b,x){if(!t)throw new Error("Tween:target is null");this._target=t;this._duration=o;this._ease=i||e.ease||so.easeNone;this._complete=a||e.complete;this._delay=r;this._props=[];this._usedTimer=0;this._startTimer=E.now();this._usedPool=b;this._delayParam=null;this.update=e.update;var l=t.$_GID||(t.$_GID=f.getGID());if(!so.tweenMap[l]){so.tweenMap[l]=[this]}else{if(s)so.clearTween(t);so.tweenMap[l].push(this)}if(x){if(r<=0)this.firstStart(t,e,n);else{this._delayParam=[t,e,n];T.timer.once(r,this,this.firstStart,this._delayParam)}}else{this._initProps(t,e,n)}return this}firstStart(t,e,o){this._delayParam=null;if(t.destroyed){this.clear();return}this._initProps(t,e,o);this._beginLoop()}_initProps(t,e,o){for(var i in e){if(typeof t[i]=="number"){var a=o?t[i]:e[i];var r=o?e[i]:t[i];this._props.push([i,a,r-a]);if(!o)t[i]=a}}}_beginLoop(){T.timer.frameLoop(1,this,this._doEase)}_doEase(){this._updateEase(E.now())}_updateEase(t){var e=this._target;if(!e)return;if(e.destroyed)return so.clearTween(e);var o=this._usedTimer=t-this._startTimer-this._delay;if(o<0)return;if(o>=this._duration)return this.complete();var i=o>0?this._ease(o,0,1,this._duration):0;var a=this._props;for(var r=0,s=a.length;r<s;r++){var n=a[r];e[n[0]]=n[1]+i*n[2]}if(this.update)this.update.run()}set progress(t){var e=t*this._duration;this._startTimer=E.now()-this._delay-e}complete(){if(!this._target)return;T.timer.runTimer(this,this.firstStart);var t=this._target;var e=this._props;var o=this._complete;for(var i=0,a=e.length;i<a;i++){var r=e[i];t[r[0]]=r[1]+r[2]}if(this.update)this.update.run();this._count++;if(this.repeat!=0&&this._count>=this.repeat){this.clear();o&&o.run()}else{this.restart()}}pause(){T.timer.clear(this,this._beginLoop);T.timer.clear(this,this._doEase);T.timer.clear(this,this.firstStart);var t=E.now();var e;e=t-this._startTimer-this._delay;if(e<0){this._usedTimer=e}}setStartTime(t){this._startTimer=t}static clearAll(t){if(!t||!t.$_GID)return;var e=so.tweenMap[t.$_GID];if(e){for(var o=0,i=e.length;o<i;o++){e[o]._clear()}e.length=0}}static clear(t){t.clear()}static clearTween(t){so.clearAll(t)}clear(){if(this._target){this._remove();this._clear()}}_clear(){this.pause();T.timer.clear(this,this.firstStart);this._complete=null;this._target=null;this._ease=null;this._props=null;this._delayParam=null;if(this._usedPool){this.update=null;p.recover("tween",this)}}recover(){this._usedPool=true;this._clear()}_remove(){var t=so.tweenMap[this._target.$_GID];if(t){for(var e=0,o=t.length;e<o;e++){if(t[e]===this){t.splice(e,1);break}}}}restart(){this.pause();this._usedTimer=0;this._startTimer=E.now();if(this._delayParam){T.timer.once(this._delay,this,this.firstStart,this._delayParam);return}var t=this._props;for(var e=0,o=t.length;e<o;e++){var i=t[e];this._target[i[0]]=i[1]}T.timer.once(this._delay,this,this._beginLoop)}resume(){if(this._usedTimer>=this._duration)return;this._startTimer=E.now()-this._usedTimer-this._delay;if(this._delayParam){if(this._usedTimer<0){T.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam)}else{this.firstStart.apply(this,this._delayParam)}}else{this._beginLoop()}}static easeNone(t,e,o,i){return o*t/i+e}}so.tweenMap=[];class no{constructor(){this.ratio=.92;this.maxOffset=60;this._dragging=false;this._clickOnly=true}start(t,e,o,i,a,r,s,n=.92){this.clearTimer();this.target=t;this.area=e;this.hasInertia=o;this.elasticDistance=e?i:0;this.elasticBackTime=a;this.data=r;this._disableMouseEvent=s;this.ratio=n;this._parent=t.parent;this._clickOnly=true;this._dragging=true;this._elasticRateX=this._elasticRateY=1;this._lastX=this._parent.mouseX;this._lastY=this._parent.mouseY;T.stage.on(L.MOUSE_UP,this,this.onStageMouseUp);T.stage.on(L.MOUSE_OUT,this,this.onStageMouseUp);T.systemTimer.frameLoop(1,this,this.loop)}clearTimer(){T.systemTimer.clear(this,this.loop);T.systemTimer.clear(this,this.tweenMove);if(this._tween){this._tween.recover();this._tween=null}}stop(){if(this._dragging){Oe.instance.disableMouseEvent=false;T.stage.off(L.MOUSE_UP,this,this.onStageMouseUp);T.stage.off(L.MOUSE_OUT,this,this.onStageMouseUp);this._dragging=false;this.target&&this.area&&this.backToArea();this.clear()}}loop(){var t=this._parent.getMousePoint();var e=t.x;var o=t.y;var i=e-this._lastX;var a=o-this._lastY;if(this._clickOnly){if(Math.abs(i*T.stage._canvasTransform.getScaleX())>1||Math.abs(a*T.stage._canvasTransform.getScaleY())>1){this._clickOnly=false;this._offsets||(this._offsets=[]);this._offsets.length=0;this.target.event(L.DRAG_START,this.data);Oe.instance.disableMouseEvent=this._disableMouseEvent}else return}else{this._offsets.push(i,a)}if(i===0&&a===0)return;this._lastX=e;this._lastY=o;this.target.x+=i*this._elasticRateX;this.target.y+=a*this._elasticRateY;this.area&&this.checkArea();this.target.event(L.DRAG_MOVE,this.data)}checkArea(){if(this.elasticDistance<=0){this.backToArea()}else{if(this.target._x<this.area.x){var t=this.area.x-this.target._x}else if(this.target._x>this.area.x+this.area.width){t=this.target._x-this.area.x-this.area.width}else{t=0}this._elasticRateX=Math.max(0,1-t/this.elasticDistance);if(this.target._y<this.area.y){var e=this.area.y-this.target.y}else if(this.target._y>this.area.y+this.area.height){e=this.target._y-this.area.y-this.area.height}else{e=0}this._elasticRateY=Math.max(0,1-e/this.elasticDistance)}}backToArea(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width);this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}onStageMouseUp(t){Oe.instance.disableMouseEvent=false;T.stage.off(L.MOUSE_UP,this,this.onStageMouseUp);T.stage.off(L.MOUSE_OUT,this,this.onStageMouseUp);T.systemTimer.clear(this,this.loop);if(this._clickOnly||!this.target)return;if(this.hasInertia){if(this._offsets.length<1){this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY)}this._offsetX=this._offsetY=0;var e=this._offsets.length;var o=Math.min(e,6);var i=this._offsets.length-o;for(var a=e-1;a>i;a--){this._offsetY+=this._offsets[a--];this._offsetX+=this._offsets[a]}this._offsetX=this._offsetX/o*2;this._offsetY=this._offsetY/o*2;if(Math.abs(this._offsetX)>this.maxOffset)this._offsetX=this._offsetX>0?this.maxOffset:-this.maxOffset;if(Math.abs(this._offsetY)>this.maxOffset)this._offsetY=this._offsetY>0?this.maxOffset:-this.maxOffset;T.systemTimer.frameLoop(1,this,this.tweenMove)}else if(this.elasticDistance>0){this.checkElastic()}else{this.clear()}}checkElastic(){var t=NaN;var e=NaN;if(this.target.x<this.area.x)t=this.area.x;else if(this.target._x>this.area.x+this.area.width)t=this.area.x+this.area.width;if(this.target.y<this.area.y)e=this.area.y;else if(this.target._y>this.area.y+this.area.height)e=this.area.y+this.area.height;if(!isNaN(t)||!isNaN(e)){var o={};if(!isNaN(t))o.x=t;if(!isNaN(e))o.y=e;this._tween=so.to(this.target,o,this.elasticBackTime,ro.sineOut,Z.create(this,this.clear),0,false,false)}else{this.clear()}}tweenMove(){this._offsetX*=this.ratio*this._elasticRateX;this._offsetY*=this.ratio*this._elasticRateY;this.target.x+=this._offsetX;this.target.y+=this._offsetY;this.area&&this.checkArea();this.target.event(L.DRAG_MOVE,this.data);if(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5){T.systemTimer.clear(this,this.tweenMove);if(this.elasticDistance>0)this.checkElastic();else this.clear()}}clear(){if(this.target){this.clearTimer();var t=this.target;this.target=null;this._parent=null;t.event(L.DRAG_END,this.data)}}}class bo{constructor(){this._id=f.getGID();this._resetComp()}get id(){return this._id}get enabled(){return this._enabled}set enabled(t){if(this._enabled!=t){this._enabled=t;if(this.owner){if(t)this.owner.activeInHierarchy&&this._onEnable();else this.owner.activeInHierarchy&&this._onDisable()}}}get isSingleton(){return true}get destroyed(){return this._destroyed}_isScript(){return false}_resetComp(){this._indexInList=-1;this._enabled=true;this._awaked=false;this.owner=null}_getIndexInList(){return this._indexInList}_setIndexInList(t){this._indexInList=t}_onAdded(){}_onAwake(){}_onEnable(){}_onDisable(){}_onDestroy(){}onReset(){}_parse(t){}_cloneTo(t){}_setActive(t){if(t){if(!this._awaked){this._awaked=true;this._onAwake()}this._enabled&&this._onEnable()}else{this._enabled&&this._onDisable()}}destroy(){if(this.owner)this.owner._destroyComponent(this)}_destroy(){if(this.owner.activeInHierarchy&&this._enabled){this._setActive(false);this._isScript()&&this.onDisable()}this._onDestroy();this._destroyed=true;if(this.onReset!==bo.prototype.onReset){this.onReset();this._resetComp();p.recoverByClass(this)}else{this._resetComp()}}}class xo extends Fe{constructor(){super();this.wrapMode=0;this._interval=s.animationInterval;this._isReverse=false;this._frameRateChanged=false;this._setBitUp(R.DISPLAY)}play(t=0,e=true,o=""){this._isPlaying=true;this._actionName=o;this.index=typeof t=="string"?this._getFrameByLabel(t):t;this.loop=e;this._isReverse=this.wrapMode===xo.WRAP_REVERSE;if(this.index==0&&this._isReverse){this.index=this.count-1}if(this.interval>0)this.timerLoop(this.interval,this,this._frameLoop,null,true,true)}get interval(){return this._interval}set interval(t){if(this._interval!=t){this._frameRateChanged=true;this._interval=t;if(this._isPlaying&&t>0){this.timerLoop(t,this,this._frameLoop,null,true,true)}}}_getFrameByLabel(t){for(var e=0;e<this._count;e++){var o=this._labels[e];if(o&&o.indexOf(t)>-1)return e}return 0}_frameLoop(){if(this._isReverse){this._index--;if(this._index<0){if(this.loop){if(this.wrapMode==xo.WRAP_PINGPONG){this._index=this._count>0?1:0;this._isReverse=false}else{this._index=this._count-1}this.event(L.COMPLETE)}else{this._index=0;this.stop();this.event(L.COMPLETE);return}}}else{this._index++;if(this._index>=this._count){if(this.loop){if(this.wrapMode==xo.WRAP_PINGPONG){this._index=this._count-2>=0?this._count-2:0;this._isReverse=true}else{this._index=0}this.event(L.COMPLETE)}else{this._index--;this.stop();this.event(L.COMPLETE);return}}}this.index=this._index}_setControlNode(t){if(this._controlNode){this._controlNode.off(L.DISPLAY,this,this._resumePlay);this._controlNode.off(L.UNDISPLAY,this,this._resumePlay)}this._controlNode=t;if(t&&t!=this){t.on(L.DISPLAY,this,this._resumePlay);t.on(L.UNDISPLAY,this,this._resumePlay)}}_setDisplay(t){super._setDisplay(t);this._resumePlay()}_resumePlay(){if(this._isPlaying){if(this._controlNode.displayedInStage)this.play(this._index,this.loop,this._actionName);else this.clearTimer(this,this._frameLoop)}}stop(){this._isPlaying=false;this.clearTimer(this,this._frameLoop)}get isPlaying(){return this._isPlaying}addLabel(t,e){if(!this._labels)this._labels={};if(!this._labels[e])this._labels[e]=[];this._labels[e].push(t)}removeLabel(t){if(!t)this._labels=null;else if(this._labels){for(var e in this._labels){this._removeLabelFromList(this._labels[e],t)}}}_removeLabelFromList(t,e){if(!t)return;for(var o=t.length-1;o>=0;o--){if(t[o]==e){t.splice(o,1)}}}gotoAndStop(t){this.index=typeof t=="string"?this._getFrameByLabel(t):t;this.stop()}get index(){return this._index}set index(t){this._index=t;this._displayToIndex(t);if(this._labels&&this._labels[t]){var e=this._labels[t];for(var o=0,i=e.length;o<i;o++){this.event(L.LABEL,e[o])}}}_displayToIndex(t){}get count(){return this._count}clear(){this.stop();this._labels=null;return this}}xo.WRAP_POSITIVE=0;xo.WRAP_REVERSE=1;xo.WRAP_PINGPONG=2;d.regClass("laya.display.AnimationBase",xo);d.regClass("Laya.AnimationBase",xo);class lo{static subtractVector3(t,e,o){o[0]=t[0]-e[0];o[1]=t[1]-e[1];o[2]=t[2]-e[2]}static lerp(t,e,o){return t*(1-o)+e*o}static scaleVector3(t,e,o){o[0]=t[0]*e;o[1]=t[1]*e;o[2]=t[2]*e}static lerpVector3(t,e,o,i){var a=t[0],r=t[1],s=t[2];i[0]=a+o*(e[0]-a);i[1]=r+o*(e[1]-r);i[2]=s+o*(e[2]-s)}static lerpVector4(t,e,o,i){var a=t[0],r=t[1],s=t[2],n=t[3];i[0]=a+o*(e[0]-a);i[1]=r+o*(e[1]-r);i[2]=s+o*(e[2]-s);i[3]=n+o*(e[3]-n)}static slerpQuaternionArray(t,e,o,i,a,r,s){var n=t[e+0],b=t[e+1],x=t[e+2],l=t[e+3],_=o[i+0],h=o[i+1],d=o[i+2],p=o[i+3];var c,u,y,m,f;u=n*_+b*h+x*d+l*p;if(u<0){u=-u;_=-_;h=-h;d=-d;p=-p}if(1-u>1e-6){c=Math.acos(u);y=Math.sin(c);m=Math.sin((1-a)*c)/y;f=Math.sin(a*c)/y}else{m=1-a;f=a}r[s+0]=m*n+f*_;r[s+1]=m*b+f*h;r[s+2]=m*x+f*d;r[s+3]=m*l+f*p;return r}static getRotation(t,e,o,i){return Math.atan2(i-e,o-t)/Math.PI*180}static sortBigFirst(t,e){if(t==e)return 0;return e>t?1:-1}static sortSmallFirst(t,e){if(t==e)return 0;return e>t?-1:1}static sortNumBigFirst(t,e){return parseFloat(e)-parseFloat(t)}static sortNumSmallFirst(t,e){return parseFloat(t)-parseFloat(e)}static sortByKey(o,t=false,e=true){var i;if(t){i=e?lo.sortNumBigFirst:lo.sortBigFirst}else{i=e?lo.sortNumSmallFirst:lo.sortSmallFirst}return function(t,e){return i(t[o],e[o])}}}class _o extends xo{constructor(){super();if(_o._sortIndexFun===null){_o._sortIndexFun=lo.sortByKey("index",false,true)}}_setUp(t,e){this._targetDic=t;this._animationData=e;this.interval=1e3/e.frameRate;if(e.parsed){this._count=e.count;this._labels=e.labels;this._usedFrames=e.animationNewFrames}else{this._usedFrames=[];this._calculateDatas();e.parsed=true;e.labels=this._labels;e.count=this._count;e.animationNewFrames=this._usedFrames}}clear(){super.clear();this._targetDic=null;this._animationData=null;return this}_displayToIndex(t){if(!this._animationData)return;if(t<0)t=0;if(t>this._count)t=this._count;var e=this._animationData.nodes,o,i=e.length;for(o=0;o<i;o++){this._displayNodeToFrame(e[o],t)}}_displayNodeToFrame(t,e,o=null){if(!o)o=this._targetDic;var i=o[t.target];if(!i){return}var a=t.frames,r,s,n;var b=t.keys,x,l=b.length;for(x=0;x<l;x++){r=b[x];s=a[r];if(s.length>e){n=s[e]}else{n=s[s.length-1]}i[r]=n}var _=t.funkeys;l=_.length;var h;if(l==0)return;for(x=0;x<l;x++){r=_[x];h=a[r];if(h[e]!==undefined){i[r]&&i[r].apply(i,h[e])}}}_calculateDatas(){if(!this._animationData)return;var t=this._animationData.nodes,e,o=t.length,i;this._count=0;for(e=0;e<o;e++){i=t[e];this._calculateKeyFrames(i)}this._count+=1}_calculateKeyFrames(t){var e=t.keyframes,o,i,a=t.target;if(!t.frames)t.frames={};if(!t.keys)t.keys=[];else t.keys.length=0;if(!t.funkeys)t.funkeys=[];else t.funkeys.length=0;if(!t.initValues)t.initValues={};for(o in e){var r=o.indexOf("()")!=-1;i=e[o];if(r)o=o.substr(0,o.length-2);if(!t.frames[o]){t.frames[o]=[]}if(!r){if(this._targetDic&&this._targetDic[a]){t.initValues[o]=this._targetDic[a][o]}i.sort(_o._sortIndexFun);t.keys.push(o);this._calculateNodePropFrames(i,t.frames[o],o,a)}else{t.funkeys.push(o);var s=t.frames[o];for(var n=0;n<i.length;n++){var b=i[n];s[b.index]=b.value;if(b.index>this._count)this._count=b.index}}}}resetNodes(){if(!this._targetDic)return;if(!this._animationData)return;var t=this._animationData.nodes,e,o=t.length;var i;var a;for(e=0;e<o;e++){i=t[e];a=i.initValues;if(!a)continue;var r=this._targetDic[i.target];if(!r)continue;var s;for(s in a){r[s]=a[s]}}}_calculateNodePropFrames(t,e,o,i){var a,r=t.length-1;e.length=t[r].index+1;for(a=0;a<r;a++){this._dealKeyFrame(t[a]);this._calculateFrameValues(t[a],t[a+1],e)}if(r==0){e[0]=t[0].value;if(this._usedFrames)this._usedFrames[t[0].index]=true}this._dealKeyFrame(t[a])}_dealKeyFrame(t){if(t.label&&t.label!="")this.addLabel(t.label,t.index)}_calculateFrameValues(t,e,o){var i,a;var r=t.index,s=e.index;var n=t.value;var b=e.value-t.value;var x=s-r;var l=this._usedFrames;if(s>this._count)this._count=s;if(t.tween){a=ro[t.tweenMethod];if(a==null)a=ro.linearNone;for(i=r;i<s;i++){o[i]=a(i-r,n,b,x);if(l)l[i]=true}}else{for(i=r;i<s;i++){o[i]=n}}if(l){l[t.index]=true;l[e.index]=true}o[e.index]=e.value}}d.regClass("laya.display.FrameAnimation",_o);d.regClass("Laya.FrameAnimation",_o);var ho=!!WeakMap;class po{constructor(){this._obj=po.supportWeakMap?new E.window.WeakMap:{};if(!po.supportWeakMap)po._maps.push(this)}static __init__(){po.I=new po;if(!po.supportWeakMap)T.systemTimer.loop(po.delInterval,null,po.clearCache)}static clearCache(){for(var t=0,e=po._maps.length;t<e;t++){var o=po._maps[t];o._obj={}}}set(t,e){if(t==null)return;if(po.supportWeakMap){var o=t;if(typeof t=="string"||typeof t=="number"){o=po._keys[t];if(!o)o=po._keys[t]={k:t}}this._obj.set(o,e)}else{if(typeof t=="string"||typeof t=="number"){this._obj[t]=e}else{t.$_GID||(t.$_GID=f.getGID());this._obj[t.$_GID]=e}}}get(t){if(t==null)return null;if(po.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?po._keys[t]:t;if(!e)return null;return this._obj.get(e)}else{if(typeof t=="string"||typeof t=="number")return this._obj[t];return this._obj[t.$_GID]}}del(t){if(t==null)return;if(po.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?po._keys[t]:t;if(!e)return;this._obj.delete(e)}else{if(typeof t=="string"||typeof t=="number")delete this._obj[t];else delete this._obj[this._obj.$_GID]}}has(t){if(t==null)return false;if(po.supportWeakMap){var e=typeof t=="string"||typeof t=="number"?po._keys[t]:t;return this._obj.has(e)}else{if(typeof t=="string"||typeof t=="number")return this._obj[t]!=null;return this._obj[this._obj.$_GID]!=null}}}po.supportWeakMap=ho;po.delInterval=10*60*1e3;po._keys={};po._maps=[];class co{static __init(){co._funMap=new po}static getBindFun(t){var e=co._funMap.get(t);if(e==null){var o='"'+t+'"';o=o.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"');var i="(function(data){if(data==null)return;with(data){try{\nreturn "+o+"\n}catch(e){}}})";e=window.Laya._runScript(i);co._funMap.set(t,e)}return e}static createByData(t,e){var o=yo.create();t=co.createComp(e,t,t,null,o);t._setBit(R.NOT_READY,true);if("_idMap"in t){t["_idMap"]=o._idMap}if(e.animations){var i=[];var a=e.animations;var r,s=a.length;var n;var b;for(r=0;r<s;r++){n=new _o;b=a[r];n._setUp(o._idMap,b);t[b.name]=n;n._setControlNode(t);switch(b.action){case 1:n.play(0,false);break;case 2:n.play(0,true);break}i.push(n)}t._aniList=i}if(t._$componentType==="Scene"&&t._width>0&&e.props.hitTestPrior==null&&!t.mouseThrough)t.hitTestPrior=true;o.beginLoad(t);return t}static createInitTool(){return yo.create()}static createComp(t,e=null,o=null,i=null,a=null){if(t.type=="Scene3D"||t.type=="Sprite3D"){var r=[];var s=T.Laya["Utils3D"]._createSceneByJsonForMaker(t,r,a);if(t.type=="Sprite3D")T.Laya["StaticBatchManager"].combine(s,r);else T.Laya["StaticBatchManager"].combine(null,r);return s}e=e||co.getCompInstance(t);if(!e){if(t.props&&t.props.runtime)console.warn("runtime not found:"+t.props.runtime);else console.warn("can not create:"+t.type);return null}var n=t.child;if(n){var b=e["_$componentType"]=="List";for(var x=0,l=n.length;x<l;x++){var _=n[x];if("itemRender"in e&&(_.props.name=="render"||_.props.renderType==="render")){e["itemRender"]=_}else if(_.type=="Graphic"){T.ClassUtils._addGraphicsToSprite(_,e)}else if(T.ClassUtils._isDrawType(_.type)){T.ClassUtils._addGraphicToSprite(_,e,true)}else{if(b){var h=[];var d=co.createComp(_,null,o,h,a);if(h.length)d["_$bindData"]=h}else{d=co.createComp(_,null,o,i,a)}if(_.type=="Script"){if(d instanceof bo){e._addComponentInstance(d)}else{if("owner"in d){d["owner"]=e}else if("target"in d){d["target"]=e}}}else if(_.props.renderType=="mask"||_.props.name=="mask"){e.mask=d}else{d instanceof Ie&&e.addChild(d)}}}}var p=t.props;for(var c in p){var u=p[c];if(typeof u=="string"&&(u.indexOf("@node:")>=0||u.indexOf("@Prefab:")>=0)){if(a){a.addNodeRef(e,c,u)}}else co.setCompValue(e,c,u,o,i)}if(e._afterInited){e._afterInited()}if(t.compId&&a&&a._idMap){a._idMap[t.compId]=e}return e}static setCompValue(t,e,o,i=null,a=null){if(typeof o=="string"&&o.indexOf("${")>-1){co._sheet||(co._sheet=T.ClassUtils.getClass("laya.data.Table"));if(!co._sheet){console.warn("Can not find class Sheet");return}if(a){a.push(t,e,o)}else if(i){if(o.indexOf("].")==-1){o=o.replace(".","[0].")}var r=new uo(t,e,o);r.exe(i);var s,n;var b=o.replace(/\[.*?\]\./g,".");while((s=co._parseWatchData.exec(b))!=null){var x=s[1];while((n=co._parseKeyWord.exec(x))!=null){var l=n[0];var _=i._watchMap[l]||(i._watchMap[l]=[]);_.push(r);co._sheet.I.notifer.on(l,i,i.changeData,[l])}_=i._watchMap[x]||(i._watchMap[x]=[]);_.push(r);co._sheet.I.notifer.on(x,i,i.changeData,[x])}}return}if(e==="var"&&i){i[o]=t}else{t[e]=o==="true"?true:o==="false"?false:o}}static getCompInstance(t){if(t.type=="UIView"){if(t.props&&t.props.pageData){return co.createByData(null,t.props.pageData)}}var e=t.props&&t.props.runtime||t.type;var o=T.ClassUtils.getClass(e);if(!o)throw"Can not find class "+e;if(t.type==="Script"&&o.prototype._doAwake){var i=p.createByClass(o);i._destroyed=false;return i}if(t.props&&"renderType"in t.props&&t.props["renderType"]=="instance"){if(!o["instance"])o["instance"]=new o;return o["instance"]}return new o}}co._parseWatchData=/\${(.*?)}/g;co._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;class uo{constructor(t,e,o){this.comp=t;this.prop=e;this.value=o}exe(t){var e=co.getBindFun(this.value);this.comp[this.prop]=e.call(this,t)}}class yo{reset(){this._nodeRefList=null;this._initList=null;this._idMap=null;this._loadList=null;this._scene=null}recover(){this.reset();p.recover("InitTool",this)}static create(){var t=p.getItemByClass("InitTool",yo);t._idMap=[];return t}addLoadRes(t,e=null){if(!this._loadList)this._loadList=[];if(!e){this._loadList.push(t)}else{this._loadList.push({url:t,type:e})}}addNodeRef(t,e,o){if(!this._nodeRefList)this._nodeRefList=[];this._nodeRefList.push([t,e,o]);if(o.indexOf("@Prefab:")>=0){this.addLoadRes(o.replace("@Prefab:",""),J.PREFAB)}}setNodeRef(){if(!this._nodeRefList)return;if(!this._idMap){this._nodeRefList=null;return}var t,e;e=this._nodeRefList.length;var o;for(t=0;t<e;t++){o=this._nodeRefList[t];o[0][o[1]]=this.getReferData(o[2])}this._nodeRefList=null}getReferData(t){if(t.indexOf("@Prefab:")>=0){var e;e=J.getRes(t.replace("@Prefab:",""));return e}else if(t.indexOf("@arr:")>=0){t=t.replace("@arr:","");var o;o=t.split(",");var i,a;var r;a=o.length;for(i=0;i<a;i++){r=o[i];if(r){o[i]=this._idMap[r.replace("@node:","")]}else{o[i]=null}}return o}else{return this._idMap[t.replace("@node:","")]}}addInitItem(t){if(!this._initList)this._initList=[];this._initList.push(t)}doInits(){if(!this._initList)return;this._initList=null}finish(){this.setNodeRef();this.doInits();this._scene._setBit(R.NOT_READY,false);if(this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active)this._scene._processActive();this._scene.event("onViewCreated");this.recover()}beginLoad(t){this._scene=t;if(!this._loadList||this._loadList.length<1){this.finish()}else{T.loader.load(this._loadList,Z.create(this,this.finish))}}}class mo{show(t=0,e=0){}enable(){}hide(){}set_onclick(t){}isCanvasRender(){return true}renderNotCanvas(t,e,o){}}class fo extends mo{constructor(){super(...arguments);this._show=false;this._useCanvas=false;this._height=100;this._view=[]}show(t=0,e=0){if(!E.onMiniGame&&!T.Render.isConchApp&&!E.onBDMiniGame&&!E.onKGMiniGame&&!E.onQGMiniGame&&!E.onQQMiniGame)this._useCanvas=true;this._show=true;m._fpsData.length=60;this._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"};this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"};this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"};this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"};this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"};this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"};this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"};if(!y.is3DMode){this._view[0].title="FPS(WebGL)";this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"}}else{this._view[0].title="FPS(3D)";this._view[7]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"};this._view[8]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"};this._view[9]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}}if(this._useCanvas){this.createUIPre(t,e)}else this.createUI(t,e);this.enable()}createUIPre(t,e){var o=E.pixelRatio;this._width=o*180;this._vx=o*120;this._height=o*(this._view.length*12+3*o)+4;fo._fontSize=12*o;for(var i=0;i<this._view.length;i++){this._view[i].x=4;this._view[i].y=i*fo._fontSize+2*o}if(!this._canvas){this._canvas=new Le(true);this._canvas.size(this._width,this._height);this._ctx=this._canvas.getContext("2d");this._ctx.textBaseline="top";this._ctx.font=fo._fontSize+"px Arial";this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+t+"px;top:"+e+"px;width:"+this._width/o+"px;height:"+this._height/o+"px;"}if(!E.onKGMiniGame){E.container.appendChild(this._canvas.source)}this._first=true;this.loop();this._first=false}createUI(t,e){var o=this._sp;var i=E.pixelRatio;if(!o){o=new Fe;this._leftText=new G;this._leftText.pos(5,5);this._leftText.color="#ffffff";o.addChild(this._leftText);this._txt=new G;this._txt.pos(80*i,5);this._txt.color="#ffffff";o.addChild(this._txt);this._sp=o}o.pos(t,e);var a="";for(var r=0;r<this._view.length;r++){var s=this._view[r];a+=s.title+"\n"}this._leftText.text=a;var n=i*138;var b=i*(this._view.length*12+3*i)+4;this._txt.fontSize=fo._fontSize*i;this._leftText.fontSize=fo._fontSize*i;o.size(n,b);o.graphics.clear();o.graphics.alpha(.5);o.graphics.drawRect(0,0,n,b,"#999999");o.graphics.alpha(2);this.loop()}enable(){T.systemTimer.frameLoop(1,this,this.loop)}hide(){this._show=false;T.systemTimer.clear(this,this.loop);if(this._canvas){E.removeElement(this._canvas.source)}}set_onclick(t){if(this._sp){this._sp.on("click",this._sp,t)}if(this._canvas){this._canvas.source.onclick=t;this._canvas.source.style.pointerEvents=""}}loop(){m._count++;var t=E.now();if(t-m._timer<1e3)return;var e=m._count;m.FPS=Math.round(e*1e3/(t-m._timer));if(this._show){m.trianglesFaces=Math.round(m.trianglesFaces/e);if(!this._useCanvas){m.renderBatches=Math.round(m.renderBatches/e)-1}else{m.renderBatches=Math.round(m.renderBatches/e)}m.savedRenderBatches=Math.round(m.savedRenderBatches/e);m.shaderCall=Math.round(m.shaderCall/e);m.spriteRenderUseCacheCount=Math.round(m.spriteRenderUseCacheCount/e);m.canvasNormal=Math.round(m.canvasNormal/e);m.canvasBitmap=Math.round(m.canvasBitmap/e);m.canvasReCache=Math.ceil(m.canvasReCache/e);m.frustumCulling=Math.round(m.frustumCulling/e);m.octreeNodeCulling=Math.round(m.octreeNodeCulling/e);var o=m.FPS>0?Math.floor(1e3/m.FPS).toString():" ";m._fpsStr=m.FPS+(m.renderSlow?" slow":"")+" "+o;m._spriteStr=m.spriteCount+(m.spriteRenderUseCacheCount?"/"+m.spriteRenderUseCacheCount:"");m._canvasStr=m.canvasReCache+"/"+m.canvasNormal+"/"+m.canvasBitmap;m.cpuMemory=$.cpuMemory;m.gpuMemory=$.gpuMemory;if(this._useCanvas){this.renderInfoPre()}else this.renderInfo();m.clear()}m._count=0;m._timer=t}renderInfoPre(){var t=0;var e;var o;if(this._canvas){var i=this._ctx;i.clearRect(this._first?0:this._vx,0,this._width,this._height);for(t=0;t<this._view.length;t++){e=this._view[t];if(this._first){i.fillStyle="white";i.fillText(e.title,e.x,e.y)}i.fillStyle=e.color;o=m[e.value];e.units=="M"&&(o=Math.floor(o/(1024*1024)*100)/100+" M");i.fillText(o+"",e.x+this._vx,e.y)}}}renderInfo(){var t="";for(var e=0;e<this._view.length;e++){var o=this._view[e];var i=m[o.value];o.units=="M"&&(i=Math.floor(i/(1024*1024)*100)/100+" M");o.units=="K"&&(i=Math.floor(i/1024*100)/100+" K");t+=i+"\n"}this._txt.text=t}isCanvasRender(){return this._useCanvas}renderNotCanvas(t,e,o){this._show&&this._sp&&this._sp.render(t,0,0)}}fo._fontSize=12;class go{constructor(t=true){this.scale=1;this.currTimer=Date.now();this.currFrame=0;this._delta=0;this._lastTimer=Date.now();this._map=[];this._handlers=[];this._temp=[];this._count=0;t&&go.gSysTimer&&go.gSysTimer.frameLoop(1,this,this._update)}get delta(){return this._delta}_update(){if(this.scale<=0){this._lastTimer=Date.now();this._delta=0;return}var t=this.currFrame=this.currFrame+this.scale;var e=Date.now();var o=e-this._lastTimer>3e4;this._delta=(e-this._lastTimer)*this.scale;var i=this.currTimer=this.currTimer+this._delta;this._lastTimer=e;var a=this._handlers;this._count=0;for(var r=0,s=a.length;r<s;r++){var n=a[r];if(n.method!==null){var b=n.userFrame?t:i;if(b>=n.exeTime){if(n.repeat){if(!n.jumpFrame||o){n.exeTime+=n.delay;n.run(false);if(b>n.exeTime){n.exeTime+=Math.ceil((b-n.exeTime)/n.delay)*n.delay}}else{while(b>=n.exeTime){n.exeTime+=n.delay;n.run(false)}}}else{n.run(true)}}}else{this._count++}}if(this._count>30||t%200===0)this._clearHandlers()}_clearHandlers(){var t=this._handlers;for(var e=0,o=t.length;e<o;e++){var i=t[e];if(i.method!==null)this._temp.push(i);else this._recoverHandler(i)}this._handlers=this._temp;t.length=0;this._temp=t}_recoverHandler(t){if(this._map[t.key]==t)this._map[t.key]=null;t.clear();go._pool.push(t)}_create(t,e,o,i,a,r,s){if(!o){a.apply(i,r);return null}if(s){var n=this._getHandler(i,a);if(n){n.repeat=e;n.userFrame=t;n.delay=o;n.caller=i;n.method=a;n.args=r;n.exeTime=o+(t?this.currFrame:this.currTimer+Date.now()-this._lastTimer);return n}}n=go._pool.length>0?go._pool.pop():new vo;n.repeat=e;n.userFrame=t;n.delay=o;n.caller=i;n.method=a;n.args=r;n.exeTime=o+(t?this.currFrame:this.currTimer+Date.now()-this._lastTimer);this._indexHandler(n);this._handlers.push(n);return n}_indexHandler(t){var e=t.caller;var o=t.method;var i=e?e.$_GID||(e.$_GID=T.Utils.getGID()):0;var a=o.$_TID||(o.$_TID=go._mid++*1e5);t.key=i+a;this._map[t.key]=t}once(t,e,o,i=null,a=true){this._create(false,false,t,e,o,i,a)}loop(t,e,o,i=null,a=true,r=false){var s=this._create(false,true,t,e,o,i,a);if(s)s.jumpFrame=r}frameOnce(t,e,o,i=null,a=true){this._create(true,false,t,e,o,i,a)}frameLoop(t,e,o,i=null,a=true){this._create(true,true,t,e,o,i,a)}toString(){return" handlers:"+this._handlers.length+" pool:"+go._pool.length}clear(t,e){var o=this._getHandler(t,e);if(o){this._map[o.key]=null;o.key=0;o.clear()}}clearAll(t){if(!t)return;for(var e=0,o=this._handlers.length;e<o;e++){var i=this._handlers[e];if(i.caller===t){this._map[i.key]=null;i.key=0;i.clear()}}}_getHandler(t,e){var o=t?t.$_GID||(t.$_GID=T.Utils.getGID()):0;var i=e.$_TID||(e.$_TID=go._mid++*1e5);return this._map[o+i]}callLater(t,e,o=null){Ne.I.callLater(t,e,o)}runCallLater(t,e){Ne.I.runCallLater(t,e)}runTimer(t,e){var o=this._getHandler(t,e);if(o&&o.method!=null){this._map[o.key]=null;o.run(true)}}pause(){this.scale=0}resume(){this.scale=1}}go.gSysTimer=null;go._pool=[];go._mid=1;class vo{clear(){this.caller=null;this.method=null;this.args=null}run(t){var e=this.caller;if(e&&e.destroyed)return this.clear();var o=this.method;var i=this.args;t&&this.clear();if(o==null)return;i?o.apply(e,i):o.call(e)}}class So extends nt{constructor(t){super(D.SKINMESH,0);this.offsetX=300;this.offsetY=0;var e=u.mainContext;var o=8*Kt.BYTES_PE;this.position=[2,e.FLOAT,false,o,0];this.texcoord=[2,e.FLOAT,false,o,2*Kt.BYTES_PE];this.color=[4,e.FLOAT,false,o,4*Kt.BYTES_PE]}}class Co extends nt{constructor(t){super(D.PRIMITIVE,0);this._attribLocation=["position",0,"attribColor",1]}}class Po extends nt{constructor(t=0){super(D.TEXTURE2D,t);this.strength=0;this.blurInfo=null;this.colorMat=null;this.colorAlpha=null;this._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2]}clear(){this.texture=null;this.shader=null;this.defines._value=this.subID+(he.shaderHighPrecision?D.SHADERDEFINE_FSHIGHPRECISION:0)}}class Ao{constructor(t){this.codes={};this.funs={};this.curUseID=-1;this.funnames="";this.script=t;var e=0,o,i;while(true){e=t.indexOf("#begin",e);if(e<0)break;i=e+5;while(true){i=t.indexOf("#end",i);if(i<0)break;if(t.charAt(i+4)==="i")i+=5;else break}if(i<0){throw"add include err,no #end:"+t}o=t.indexOf("\n",e);var a=T.ShaderCompile.splitToWords(t.substr(e,o-e),null);if(a[1]=="code"){this.codes[a[2]]=t.substr(o+1,i-o-1)}else if(a[1]=="function"){o=t.indexOf("function",e);o+="function".length;this.funs[a[3]]=t.substr(o+1,i-o-1);this.funnames+=a[3]+";"}e=i+1}}getWith(t=null){var e=t?this.codes[t]:this.script;if(!e){throw"get with error:"+t}return e}getFunsScript(t){var e="";for(var o in this.funs){if(t.indexOf(o+";")>=0){e+=this.funs[o]}}return e}}class Bo{constructor(t){this.childs=[];this.text="";this.useFuns="";this.z=0;this.includefiles=t}setParent(t){t.childs.push(this);this.z=t.z+1;this.parent=t}setCondition(t,e){if(t){this.conditionType=e;t=t.replace(/(\s*$)/g,"");this.condition=function(){return this[t]};this.condition.__condition=t}}toscript(t,e){return this._toscript(t,e,++Bo.__id)}_toscript(i,a,r){if(this.childs.length<1&&!this.text)return a;var t=a.length;if(this.condition){var e=!!this.condition.call(i);this.conditionType===T.ShaderCompile.IFDEF_ELSE&&(e=!e);if(!e)return a}this.text&&a.push(this.text);this.childs.length>0&&this.childs.forEach(function(t,e,o){t._toscript(i,a,r)});if(this.includefiles.length>0&&this.useFuns.length>0){var o;for(var s=0,n=this.includefiles.length;s<n;s++){if(this.includefiles[s].curUseID==r){continue}o=this.includefiles[s].file.getFunsScript(this.useFuns);if(o.length>0){this.includefiles[s].curUseID=r;a[0]=o+a[0]}}}return a}}Bo.__id=1;class wo{constructor(t,e,o){this.defs={};let i=this;function a(t){t=t.replace(wo._clearCR,"");var e=[];var o=new Bo(e);i._compileToTree(o,t.split("\n"),0,e,i.defs);return o}var r=Date.now();this._VS=a(t);this._PS=a(e);this._nameMap=o;if(Date.now()-r>2)console.log("ShaderCompile use time:"+(Date.now()-r)+"  size:"+t.length+"/"+e.length)}static __init__(){var t=c.instance;wo.shaderParamsMap={float:t.FLOAT,int:t.INT,bool:t.BOOL,vec2:t.FLOAT_VEC2,vec3:t.FLOAT_VEC3,vec4:t.FLOAT_VEC4,ivec2:t.INT_VEC2,ivec3:t.INT_VEC3,ivec4:t.INT_VEC4,bvec2:t.BOOL_VEC2,bvec3:t.BOOL_VEC3,bvec4:t.BOOL_VEC4,mat2:t.FLOAT_MAT2,mat3:t.FLOAT_MAT3,mat4:t.FLOAT_MAT4,sampler2D:t.SAMPLER_2D,samplerCube:t.SAMPLER_CUBE}}static _parseOne(t,e,o,i,a,r){var s={type:wo.shaderParamsMap[o[i+1]],name:o[i+2],size:isNaN(parseInt(o[i+3]))?1:parseInt(o[i+3])};if(r){if(a=="attribute"){t.push(s)}else{e.push(s)}}if(o[i+3]==":"){s.type=o[i+4];i+=2}i+=2;return i}static addInclude(t,e){if(!e||e.length===0)throw new Error("add shader include file err:"+t);if(wo.includes[t])throw new Error("add shader include file err, has add:"+t);wo.includes[t]=new Ao(e)}static preGetParams(t,e){var o=[t,e];var i={};var a=[];var r=[];var s={};var n=[];i.attributes=a;i.uniforms=r;i.defines=s;var b,x;for(var l=0;l<2;l++){o[l]=o[l].replace(wo._removeAnnotation,"");var _=o[l].match(wo._reg);var h;for(b=0,x=_.length;b<x;b++){var d=_[b];if(d!="attribute"&&d!="uniform"){if(d=="#define"){d=_[++b];n[d]=1;continue}else if(d=="#ifdef"){h=_[++b];var p=s[h]=s[h]||[];for(b++;b<x;b++){d=_[b];if(d!="attribute"&&d!="uniform"){if(d=="#else"){for(b++;b<x;b++){d=_[b];if(d!="attribute"&&d!="uniform"){if(d=="#endif"){break}continue}b=wo._parseOne(a,r,_,b,d,!n[h])}}continue}b=wo._parseOne(a,r,_,b,d,n[h])}}continue}b=wo._parseOne(a,r,_,b,d,true)}}return i}static splitToWords(t,e){var o=[];var i;var a=-1;var r;for(var s=0,n=t.length;s<n;s++){i=t.charAt(s);if(" \t=+-*/&%!<>()'\",;".indexOf(i)>=0){if(a>=0&&s-a>1){r=t.substr(a,s-a);o.push(r)}if(i=='"'||i=="'"){var b=t.indexOf(i,s+1);if(b<0){throw"Sharder err:"+t}o.push(t.substr(s+1,b-s-1));s=b;a=-1;continue}if(i=="("&&e&&o.length>0){r=o[o.length-1]+";";if("vec4;main;".indexOf(r)<0)e.useFuns+=r}a=-1;continue}if(a<0)a=s}if(a<n&&n-a>1){r=t.substr(a,n-a);o.push(r)}return o}_compileToTree(t,e,o,i,a){var r,s;var n,b,x;var l,_,h;var d,p,c;for(d=o;d<e.length;d++){n=e[d];if(n.length<1)continue;l=n.indexOf("//");if(l===0)continue;if(l>=0)n=n.substr(0,l);r=h||new Bo(i);h=null;r.text=n;r.noCompile=true;if((l=n.indexOf("#"))>=0){b="#";for(c=l+1,p=n.length;c<p;c++){var u=n.charAt(c);if(u===" "||u==="\t"||u==="?")break;b+=u}r.name=b;switch(b){case"#ifdef":case"#ifndef":r.src=n;r.noCompile=n.match(/[!&|()=<>]/)!=null;if(!r.noCompile){_=n.replace(/^\s*/,"").split(/\s+/);r.setCondition(_[1],b==="#ifdef"?wo.IFDEF_YES:wo.IFDEF_ELSE);r.text="//"+r.text}else{console.log("function():Boolean{return "+n.substr(l+r.name.length)+"}")}r.setParent(t);t=r;if(a){_=n.substr(c).split(wo._splitToWordExps3);for(c=0;c<_.length;c++){n=_[c];n.length&&(a[n]=true)}}continue;case"#if":r.src=n;r.noCompile=true;r.setParent(t);t=r;if(a){_=n.substr(c).split(wo._splitToWordExps3);for(c=0;c<_.length;c++){n=_[c];n.length&&n!="defined"&&(a[n]=true)}}continue;case"#else":r.src=n;t=t.parent;s=t.childs[t.childs.length-1];r.noCompile=s.noCompile;if(!r.noCompile){r.condition=s.condition;r.conditionType=s.conditionType==wo.IFDEF_YES?wo.IFDEF_ELSE:wo.IFDEF_YES;r.text="//"+r.text+" "+s.text+" "+r.conditionType}r.setParent(t);t=r;continue;case"#endif":t=t.parent;s=t.childs[t.childs.length-1];r.noCompile=s.noCompile;if(!r.noCompile){r.text="//"+r.text}r.setParent(t);continue;case"#include":_=wo.splitToWords(n,null);var y=wo.includes[_[1]];if(!y){throw"ShaderCompile error no this include file:"+_[1]}if((l=_[0].indexOf("?"))<0){r.setParent(t);n=y.getWith(_[2]=="with"?_[3]:null);this._compileToTree(r,n.split("\n"),0,i,a);r.text="";continue}r.setCondition(_[0].substr(l+1),wo.IFDEF_YES);r.text=y.getWith(_[2]=="with"?_[3]:null);break;case"#import":_=wo.splitToWords(n,null);x=_[1];i.push({node:r,file:wo.includes[x],ofs:r.text.length});continue}}else{s=t.childs[t.childs.length-1];if(s&&!s.name){i.length>0&&wo.splitToWords(n,s);h=r;s.text+="\n"+n;continue}i.length>0&&wo.splitToWords(n,r)}r.setParent(t)}}createShader(t,e,o,i){var a={};var r="";if(t){for(var s in t){r+="#define "+s+"\n";a[s]=true}}var n=this._VS.toscript(a,[]);var b=this._PS.toscript(a,[]);return(o||rt.create)(r+n.join("\n"),r+b.join("\n"),e,this._nameMap,i)}}wo.IFDEF_NO=0;wo.IFDEF_YES=1;wo.IFDEF_ELSE=2;wo.IFDEF_PARENT=3;wo._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g");wo._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g");wo._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g");wo.includes={};wo._clearCR=new RegExp("\r","g");wo._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g");class To extends e{constructor(){super();this.worker=new Worker(To.workerPath);let e=this;this.worker.onmessage=function(t){e.workerMessage(t.data)}}static __init__(){if(To._preLoadFun!=null)return false;if(!Worker)return false;To._preLoadFun=J["prototype"]["_loadImage"];J["prototype"]["_loadImage"]=To["prototype"]["_loadImage"];if(!To.I)To.I=new To;return true}static workerSupported(){return Worker?true:false}static enableWorkerLoader(){if(!To._tryEnabled){To.enable=true;To._tryEnabled=true}}static set enable(t){if(To._enable!=t){To._enable=t;if(t&&To._preLoadFun==null)To._enable=To.__init__()}}static get enable(){return To._enable}workerMessage(t){if(t){switch(t.type){case"Image":this.imageLoaded(t);break;case"Disable":To.enable=false;break}}}imageLoaded(t){if(!t.dataType||t.dataType!="imageBitmap"){this.event(t.url,null);return}var e=t.imageBitmap;var o=new tt;o.loadImageSource(e);console.log("load:",t.url);this.event(t.url,o)}loadImage(t){this.worker.postMessage(t)}_loadImage(e){var o=this;if(!this._useWorkerLoader||!To._enable){To._preLoadFun.call(o,e);return}e=M.formatURL(e);function i(){To.I.off(e,o,t)}var t=function(t){i();if(t){o["onLoaded"](t)}else{To._preLoadFun.call(o,e)}};To.I.on(e,o,t);To.I.loadImage(e)}}To.workerPath="libs/workerloader.js";To._enable=false;To._tryEnabled=false;class Mo{static set cursor(t){Mo._style.cursor=t}static get cursor(){return Mo._style.cursor}static __init__(){}static hide(){if(Mo.cursor!="none"){Mo._preCursor=Mo.cursor;Mo.cursor="none"}}static show(){if(Mo.cursor=="none"){if(Mo._preCursor){Mo.cursor=Mo._preCursor}else{Mo.cursor="auto"}}}}class Io extends Rt{constructor(t){super(Io.const_stride,t*4*Io.const_stride,4);this.canReuse=true;this.setAttributes(Io._fixattriInfo);this.createQuadIB(t);this._quadNum=t}static __init__(){var t=c.instance;Io._fixattriInfo=[t.FLOAT,4,0,t.FLOAT,3,16,t.FLOAT,3,28,t.FLOAT,4,40,t.FLOAT,4,56,t.FLOAT,3,72,t.FLOAT,2,84,t.FLOAT,4,92,t.FLOAT,1,108,t.FLOAT,1,112]}setMaxParticleNum(t){this._vb._resizeBuffer(t*4*Io.const_stride,false);this.createQuadIB(t)}static getAMesh(t){if(Io._POOL.length){var e=Io._POOL.pop();e.setMaxParticleNum(t);return e}return new Io(t)}releaseMesh(){this._vb.setByteLength(0);this.vertNum=0;this.indexNum=0;Io._POOL.push(this)}destroy(){this._ib.destroy();this._vb.destroy();this._vb.deleteBuffer()}}Io.const_stride=116;Io._POOL=[];class Do extends o{}Do.create=function(t,e,o){var i=new tt(t,e,o,false,false);i.wrapModeU=v.WARPMODE_CLAMP;i.wrapModeV=v.WARPMODE_CLAMP;return i};class h{static __init(t){t.forEach(function(t){t.__init$&&t.__init$()})}static init(t,e,...o){if(h._isinit)return;h._isinit=true;ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=h._arrayBufferSlice);E.__init__();var i=E.mainCanvas=new Le(true);var a=i.source.style;a.position="absolute";a.top=a.left="0px";a.background="#000000";if(!E.onKGMiniGame&&!E.onAlipayMiniGame){E.container.appendChild(i.source)}E.canvas=new Le(true);E.context=E.canvas.getContext("2d");E.supportWebAudio=_.__init__();E.supportLocalStorage=oo.__init__();h.systemTimer=new go(false);n.systemTimer=go.gSysTimer=h.systemTimer;h.startTimer=new go(false);h.physicsTimer=new go(false);h.updateTimer=new go(false);h.lateTimer=new go(false);h.timer=new go(false);n.startTimer=T.startTimer=h.startTimer;n.lateTimer=T.lateTimer=h.lateTimer;n.updateTimer=T.updateTimer=h.updateTimer;T.systemTimer=h.systemTimer;n.timer=T.timer=h.timer;n.physicsTimer=T.physicsTimer=h.physicsTimer;h.loader=new to;T.Laya=h;n.loader=T.loader=h.loader;po.__init__();co.__init();Mo.__init__();he.inner_enable();for(var r=0,s=o.length;r<s;r++){if(o[r]&&o[r].enable){o[r].enable()}}if(T.Render.isConchApp){h.enableNative()}h.enableWebGLPlus();Be.beginCheck();n.stage=h.stage=new F;T.stage=h.stage;f.gStage=h.stage;M.rootPath=M._basePath=h._getUrlPath();Gt.__int__();Jt.__init__();Ft.__init__();h.render=new y(0,0,E.mainCanvas);n.render=h.render;h.stage.size(t,e);window.stage=h.stage;u.__init__();Io.__init__();wo.__init__();Ge.__init__();ze.__init__();Oe.instance.__init__(h.stage,y.canvas);l.__init__();_.autoStopMusic=true;m._StatRender=new fo;nt._initone(D.TEXTURE2D,Po);nt._initone(D.TEXTURE2D|D.FILTERGLOW,Po);nt._initone(D.PRIMITIVE,Co);nt._initone(D.SKINMESH,So);return y.canvas}static _getUrlPath(){var t=E.window.location;var e=t.pathname;e=e.charAt(2)==":"?e.substring(1):e;return M.getPath(t.protocol=="file:"?e:t.protocol+"//"+t.host+t.pathname)}static _arrayBufferSlice(t,e){var o=this;var i=new Uint8Array(o,t,e-t);var a=new Uint8Array(i.length);a.set(i);return a.buffer}static set alertGlobalError(t){var r=0;if(t){E.window.onerror=function(t,e,o,i,a){if(r++<5&&a)this.alert("出错啦，请把此信息截图给研发商\n"+t+"\n"+a.stack)}}else{E.window.onerror=null}}static _runScript(t){return E.window[h._evcode](t)}static enableDebugPanel(t="libs/laya.debugtool.js"){if(!h["DebugPanel"]){var e=E.createElement("script");e.onload=function(){h["DebugPanel"].enable()};e.src=t;E.document.body.appendChild(e)}else{h["DebugPanel"].enable()}}static enableWebGLPlus(){u.__init_native()}static enableNative(){if(h.isNativeRender_enable)return;h.isNativeRender_enable=true;rt.prototype.uploadTexture2D=function(t){var e=c.instance;e.bindTexture(e.TEXTURE_2D,t)};x.width=E.window.innerWidth;x.height=E.window.innerHeight;E.measureText=function(t,e){window["conchTextCanvas"].font=e;return window["conchTextCanvas"].measureText(t)};F.clear=function(t){z.set2DRenderConfig();var e=g.create(t).arrColor;var o=c.instance;if(e)o.clearColor(e[0],e[1],e[2],e[3]);o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT|o.STENCIL_BUFFER_BIT);x.clear()};Fe.drawToCanvas=Fe.drawToTexture=function(t,e,o,i,a,r){a-=t.x;r-=t.y;a|=0;r|=0;o|=0;i|=0;var s=new Le(false);var n=s.getContext("2d");s.size(o,i);n.asBitmap=true;n._targets.start();Ge.renders[e]._fun(t,n,a,r);n.flush();n._targets.end();n._targets.restore();return s};Object["defineProperty"](ot.prototype,"uv",{get:function(){return this._uv},set:function(t){this._uv=t}});Le.prototype.getTexture=function(){if(!this._texture){this._texture=this.context._targets;this._texture.uv=ot.flipyuv;this._texture.bitmap=this._texture}return this._texture}}}h.stage=null;h.systemTimer=null;h.startTimer=null;h.physicsTimer=null;h.updateTimer=null;h.lateTimer=null;h.timer=null;h.loader=null;h.version="2.2.0";h._isinit=false;h.isWXOpenDataContext=false;h.isWXPosMsg=false;h.__classmap=null;h.Config=s;h.TextRender=V;h.EventDispatcher=e;h.SoundChannel=Xe;h.Stage=F;h.Render=y;h.Browser=E;h.Sprite=Fe;h.Node=Ie;h.Context=z;h.WebGL=he;h.Handler=Z;h.RunDriver=Ue;h.Utils=f;h.Input=l;h.Loader=J;h.LocalStorage=oo;h.SoundManager=_;h.URL=M;h.Event=L;h.Matrix=w;h.HTMLImage=Do;h.Laya=h;h._evcode="eva"+"l";h.isNativeRender_enable=false;h.__classmap=T.__classMap;T.Timer=go;T.Dragging=no;T.GraphicsBounds=ye;T.Sprite=Fe;T.TextRender=V;T.Loader=J;T.TTFLoader=ao;T.WebAudioSound=a;T.SoundManager=_;T.ShaderCompile=wo;T.ClassUtils=d;T.SceneUtils=co;T.Context=z;T.Render=y;T.MouseManager=Oe;T.Text=G;T.Browser=E;T.WebGL=he;T.AudioSound=Ye;T.Pool=p;T.Utils=f;T.Graphics=Te;T.Submit=Zt;T.Stage=F;T.Resource=$;T.WorkerLoader=To;var Lo=window._layalibs;if(Lo){Lo.sort(function(t,e){return t.i-e.i});for(var Eo=0;Eo<Lo.length;Eo++){Lo[Eo].f(window,window.document,h)}}let Vo=window;if(Vo.Laya){Vo.Laya.Laya=h;Object.assign(Vo.Laya,h)}else Vo.Laya=h;var Ro=h.__init;var Go=h.init;var Fo=h.version;var Jo;var ko;var Oo=h.alertGlobalError;var No=h.enableDebugPanel;function Wo(o,i){for(var a=0,t=i.length;a<t;a+=2){if(i[a]=="length")o.length=i[a+1].call(o);else{function e(){var e=i[a];var t=i[a+1];Object.defineProperty(o,e,{get:function(){delete this[e];return this[e]=t.call(this)},set:function(t){delete this[e];this[e]=t},enumerable:true,configurable:true})}e()}}}class Uo extends bo{get isSingleton(){return false}constructor(){super()}onAwake(){}onEnable(){}onStart(){}onUpdate(){}onLateUpdate(){}onDisable(){}onDestroy(){}}class zo extends bo{get isSingleton(){return false}_onAwake(){this.onAwake();if(this.onStart!==zo.prototype.onStart){T.startTimer.callLater(this,this.onStart)}}_onEnable(){var t=zo.prototype;if(this.onTriggerEnter!==t.onTriggerEnter){this.owner.on(L.TRIGGER_ENTER,this,this.onTriggerEnter)}if(this.onTriggerStay!==t.onTriggerStay){this.owner.on(L.TRIGGER_STAY,this,this.onTriggerStay)}if(this.onTriggerExit!==t.onTriggerExit){this.owner.on(L.TRIGGER_EXIT,this,this.onTriggerExit)}if(this.onMouseDown!==t.onMouseDown){this.owner.on(L.MOUSE_DOWN,this,this.onMouseDown)}if(this.onMouseUp!==t.onMouseUp){this.owner.on(L.MOUSE_UP,this,this.onMouseUp)}if(this.onClick!==t.onClick){this.owner.on(L.CLICK,this,this.onClick)}if(this.onStageMouseDown!==t.onStageMouseDown){T.stage.on(L.MOUSE_DOWN,this,this.onStageMouseDown)}if(this.onStageMouseUp!==t.onStageMouseUp){T.stage.on(L.MOUSE_UP,this,this.onStageMouseUp)}if(this.onStageClick!==t.onStageClick){T.stage.on(L.CLICK,this,this.onStageClick)}if(this.onStageMouseMove!==t.onStageMouseMove){T.stage.on(L.MOUSE_MOVE,this,this.onStageMouseMove)}if(this.onDoubleClick!==t.onDoubleClick){this.owner.on(L.DOUBLE_CLICK,this,this.onDoubleClick)}if(this.onRightClick!==t.onRightClick){this.owner.on(L.RIGHT_CLICK,this,this.onRightClick)}if(this.onMouseMove!==t.onMouseMove){this.owner.on(L.MOUSE_MOVE,this,this.onMouseMove)}if(this.onMouseOver!==t.onMouseOver){this.owner.on(L.MOUSE_OVER,this,this.onMouseOver)}if(this.onMouseOut!==t.onMouseOut){this.owner.on(L.MOUSE_OUT,this,this.onMouseOut)}if(this.onKeyDown!==t.onKeyDown){T.stage.on(L.KEY_DOWN,this,this.onKeyDown)}if(this.onKeyPress!==t.onKeyPress){T.stage.on(L.KEY_PRESS,this,this.onKeyPress)}if(this.onKeyUp!==t.onKeyUp){T.stage.on(L.KEY_UP,this,this.onKeyUp)}if(this.onUpdate!==t.onUpdate){T.updateTimer.frameLoop(1,this,this.onUpdate)}if(this.onLateUpdate!==t.onLateUpdate){T.lateTimer.frameLoop(1,this,this.onLateUpdate)}if(this.onPreRender!==t.onPreRender){T.lateTimer.frameLoop(1,this,this.onPreRender)}}_onDisable(){this.owner.offAllCaller(this);T.stage.offAllCaller(this);T.startTimer.clearAll(this);T.updateTimer.clearAll(this);T.lateTimer.clearAll(this)}_isScript(){return true}_onDestroy(){this.onDestroy()}onAwake(){}onEnable(){}onStart(){}onTriggerEnter(t,e,o){}onTriggerStay(t,e,o){}onTriggerExit(t,e,o){}onMouseDown(t){}onMouseUp(t){}onClick(t){}onStageMouseDown(t){}onStageMouseUp(t){}onStageClick(t){}onStageMouseMove(t){}onDoubleClick(t){}onRightClick(t){}onMouseMove(t){}onMouseOver(t){}onMouseOut(t){}onKeyDown(t){}onKeyPress(t){}onKeyUp(t){}onUpdate(){}onLateUpdate(){}onPreRender(){}onPostRender(){}onDisable(){}onDestroy(){}}class Xo extends _o{constructor(){super(...arguments);this._nodeIDAniDic={}}_parseNodeList(t){if(!this._nodeList)this._nodeList=[];this._nodeDefaultProps[t.compId]=t.props;if(t.compId)this._nodeList.push(t.compId);var e=t.child;if(e){var o,i=e.length;for(o=0;o<i;o++){this._parseNodeList(e[o])}}}_calGraphicData(t){this._setUp(null,t);this._createGraphicData();if(this._nodeIDAniDic){var e;for(e in this._nodeIDAniDic){this._nodeIDAniDic[e]=null}}}_createGraphicData(){var t=[];var e,o=this.count;var i=this._usedFrames;if(!i)i=[];var a;for(e=0;e<o;e++){if(i[e]||!a){a=this._createFrameGraphic(e)}t.push(a)}this._gList=t}_createFrameGraphic(t){var e=new Te;if(!Xo._rootMatrix)Xo._rootMatrix=new w;this._updateNodeGraphic(this._rootNode,t,Xo._rootMatrix,e);return e}_updateNodeGraphic(t,e,o,i,a=1){var r;r=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]);if(!r.resultTransform)r.resultTransform=new w;var s;s=r.resultTransform;w.mul(r.transform,o,s);var n;var b=r.alpha*a;if(b<.01)return;if(r.skin){n=this._getTextureByUrl(r.skin);if(n){if(s._checkTransform()){i.drawTexture(n,0,0,r.width,r.height,s,b);r.resultTransform=null}else{i.drawTexture(n,s.tx,s.ty,r.width,r.height,null,b)}}}var x=t.child;if(!x)return;var l,_;_=x.length;for(l=0;l<_;l++){this._updateNodeGraphic(x[l],e,s,i,b)}}_updateNoChilds(t,e){if(!t.skin)return;var o=this._getTextureByUrl(t.skin);if(!o)return;var i=t.transform;i._checkTransform();var a;a=!i._bTransform;if(!a){e.drawTexture(o,0,0,t.width,t.height,i.clone(),t.alpha)}else{e.drawTexture(o,i.tx,i.ty,t.width,t.height,null,t.alpha)}}_updateNodeGraphic2(t,e,o){var i;i=this._nodeGDic[t.compId]=this._getNodeGraphicData(t.compId,e,this._nodeGDic[t.compId]);if(!t.child){this._updateNoChilds(i,o);return}var a=i.transform;a._checkTransform();var r;r=!a._bTransform;var s;s=r&&(a.tx!=0||a.ty!=0);var n;n=a._bTransform||i.alpha!=1;if(n)o.save();if(i.alpha!=1)o.alpha(i.alpha);if(!r)o.transform(a.clone());else if(s)o.translate(a.tx,a.ty);var b=t.child;var x;if(i.skin){x=this._getTextureByUrl(i.skin);if(x){o.drawImage(x,0,0,i.width,i.height)}}if(b){var l,_;_=b.length;for(l=0;l<_;l++){this._updateNodeGraphic2(b[l],e,o)}}if(n){o.restore()}else{if(!r){o.transform(a.clone().invert())}else if(s){o.translate(-a.tx,-a.ty)}}}_calculateKeyFrames(t){super._calculateKeyFrames(t);this._nodeIDAniDic[t.target]=t}getNodeDataByID(t){return this._nodeIDAniDic[t]}_getParams(t,e,o,i){var a=Xo._temParam;a.length=e.length;var r,s=e.length;for(r=0;r<s;r++){a[r]=this._getObjVar(t,e[r][0],o,e[r][1],i)}return a}_getObjVar(t,e,o,i,a){if(e in t){var r=t[e];if(o>=r.length)o=r.length-1;return t[e][o]}if(e in a){return a[e]}return i}_getNodeGraphicData(t,e,o){if(!o)o=new Ho;if(!o.transform){o.transform=new w}else{o.transform.identity()}var i=this.getNodeDataByID(t);if(!i)return o;var a=i.frames;var r=this._getParams(a,Xo._drawTextureCmd,e,this._nodeDefaultProps[t]);var s=r[0];var n,b;var x=r[5],l=r[6];var _=r[13],h=r[14];var d=r[7],p=r[8];var c=r[9];var u=r[11],y=r[12];n=r[3];b=r[4];if(n==0||b==0)s=null;if(n==-1)n=0;if(b==-1)b=0;var m;o.skin=s;o.width=n;o.height=b;if(s){m=this._getTextureByUrl(s);if(m){if(!n)n=m.sourceWidth;if(!b)b=m.sourceHeight}else{console.warn("lost skin:",s,",you may load pics first")}}o.alpha=r[10];var f=o.transform;if(_!=0){x=_*n}if(h!=0){l=h*b}if(x!=0||l!=0){f.translate(-x,-l)}var g=null;if(c||d!==1||p!==1||u||y){g=Xo._tempMt;g.identity();g._bTransform=true;var v=(c-u)*.0174532922222222;var S=(c+y)*.0174532922222222;var C=Math.cos(S);var P=Math.sin(S);var A=Math.sin(v);var B=Math.cos(v);g.a=d*C;g.b=d*P;g.c=-p*A;g.d=p*B;g.tx=g.ty=0}if(g){f=w.mul(f,g,f)}f.translate(r[1],r[2]);return o}_getTextureByUrl(t){return J.getRes(t)}setAniData(t,e=null){if(t.animations){this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=t;this._parseNodeList(t);var o={};var i=[];var a=t.animations;var r,s=a.length;var n;for(r=0;r<s;r++){n=a[r];this._labels=null;if(e&&e!=n.name){continue}if(!n)continue;try{this._calGraphicData(n)}catch(t){console.warn("parse animation fail:"+n.name+",empty animation created");this._gList=[]}var b={};b.interval=1e3/n["frameRate"];b.frames=this._gList;b.labels=this._labels;b.name=n.name;i.push(b);o[n.name]=b}this.animationList=i;this.animationDic=o}Xo._temParam.length=0}parseByData(t){var e,o;e=t.nodeRoot;o=t.aniO;delete t.nodeRoot;delete t.aniO;this._nodeDefaultProps={};this._nodeGDic={};if(this._nodeList)this._nodeList.length=0;this._rootNode=e;this._parseNodeList(e);this._labels=null;try{this._calGraphicData(o)}catch(t){console.warn("parse animation fail:"+o.name+",empty animation created");this._gList=[]}var i=t;i.interval=1e3/o["frameRate"];i.frames=this._gList;i.labels=this._labels;i.name=o.name;return i}setUpAniData(t){if(t.animations){var e={};var o=[];var i=t.animations;var a,r=i.length;var s;for(a=0;a<r;a++){s=i[a];if(!s)continue;var n={};n.name=s.name;n.aniO=s;n.nodeRoot=t;o.push(n);e[s.name]=n}this.animationList=o;this.animationDic=e}}_clear(){this.animationList=null;this.animationDic=null;this._gList=null;this._nodeGDic=null}static parseAnimationByData(t){if(!Xo._I)Xo._I=new Xo;var e;e=Xo._I.parseByData(t);Xo._I._clear();return e}static parseAnimationData(t){if(!Xo._I)Xo._I=new Xo;Xo._I.setUpAniData(t);var e;e={};e.animationList=Xo._I.animationList;e.animationDic=Xo._I.animationDic;Xo._I._clear();return e}}Xo._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]];Xo._temParam=[];Xo._tempMt=new w;class Ho{constructor(){this.alpha=1}}class Yo extends xo{constructor(){super();this._setControlNode(this)}destroy(t=true){this.stop();super.destroy(t);this._frames=null;this._labels=null}play(t=0,e=true,o=""){if(o)this._setFramesFromCache(o,true);super.play(t,e,o)}_setFramesFromCache(t,e=false){if(this._url)t=this._url+"#"+t;if(t&&Yo.framesMap[t]){var o=Yo.framesMap[t];if(o instanceof Array){this._frames=Yo.framesMap[t];this._count=this._frames.length}else{if(o.nodeRoot){Yo.framesMap[t]=Xo.parseAnimationByData(o);o=Yo.framesMap[t]}this._frames=o.frames;this._count=this._frames.length;if(!this._frameRateChanged)this._interval=o.interval;this._labels=this._copyLabels(o.labels)}return true}else{if(e)console.log("ani not found:",t)}return false}_copyLabels(t){if(!t)return null;var e;e={};var o;for(o in t){e[o]=f.copyArray([],t[o])}return e}_frameLoop(){if(this._visible&&this._style.alpha>.01&&this._frames){super._frameLoop()}}_displayToIndex(t){if(this._frames)this.graphics=this._frames[t]}get frames(){return this._frames}set frames(t){this._frames=t;if(t){this._count=t.length;if(this._actionName)this._setFramesFromCache(this._actionName,true);this.index=this._index}}set source(t){if(t.indexOf(".ani")>-1)this.loadAnimation(t);else if(t.indexOf(".json")>-1||t.indexOf("als")>-1||t.indexOf("atlas")>-1)this.loadAtlas(t);else this.loadImages(t.split(","))}set autoAnimation(t){this.play(0,true,t)}set autoPlay(t){if(t)this.play();else this.stop()}clear(){super.clear();this.stop();this.graphics=null;this._frames=null;this._labels=null;return this}loadImages(t,e=""){this._url="";if(!this._setFramesFromCache(e)){this.frames=Yo.framesMap[e]?Yo.framesMap[e]:Yo.createFrames(t,e)}return this}loadAtlas(e,o=null,i=""){this._url="";var a=this;if(!a._setFramesFromCache(i)){function t(t){if(e===t){a.frames=Yo.framesMap[i]?Yo.framesMap[i]:Yo.createFrames(e,i);if(o)o.run()}}if(J.getAtlas(e))t(e);else T.loader.load(e,Z.create(null,t,[e]),null,J.ATLAS)}return this}loadAnimation(t,e=null,o=null){this._url=t;var i=this;if(!this._actionName)this._actionName="";if(!i._setFramesFromCache(this._actionName)){if(!o||J.getAtlas(o)){this._loadAnimationData(t,e,o)}else{T.loader.load(o,Z.create(this,this._loadAnimationData,[t,e,o]),null,J.ATLAS)}}else{i._setFramesFromCache(this._actionName,true);this.index=0;if(e)e.run()}return this}_loadAnimationData(n,b=null,t=null){if(t&&!J.getAtlas(t)){console.warn("atlas load fail:"+t);return}var x=this;function e(t){if(!J.getRes(t)){if(Yo.framesMap[n+"#"]){x._setFramesFromCache(this._actionName,true);x.index=0;x._resumePlay();if(b)b.run()}return}if(n===t){var e;if(!Yo.framesMap[n+"#"]){var o=Xo.parseAnimationData(J.getRes(n));if(!o)return;var i=o.animationList;var a,r=i.length;var s;for(a=0;a<r;a++){e=i[a];Yo.framesMap[n+"#"+e.name]=e;if(!s)s=e}if(s){Yo.framesMap[n+"#"]=s;x._setFramesFromCache(x._actionName,true);x.index=0}x._resumePlay()}else{x._setFramesFromCache(x._actionName,true);x.index=0;x._resumePlay()}if(b)b.run()}J.clearRes(n)}if(J.getRes(n))e(n);else T.loader.load(n,Z.create(null,e,[n]),null,J.JSON)}static createFrames(t,e){var o;if(typeof t=="string"){var i=J.getAtlas(t);if(i&&i.length){o=[];for(var a=0,r=i.length;a<r;a++){var s=new Te;s.drawImage(J.getRes(i[a]),0,0);o.push(s)}}}else if(t instanceof Array){o=[];for(a=0,r=t.length;a<r;a++){s=new Te;s.loadImage(t[a],0,0);o.push(s)}}if(e)Yo.framesMap[e]=o;return o}static clearCache(t){var e=Yo.framesMap;var o;var i=t+"#";for(o in e){if(o===t||o.indexOf(i)===0){delete Yo.framesMap[o]}}}}Yo.framesMap={};T.regClass(Yo);d.regClass("laya.display.Animation",Yo);d.regClass("Laya.Animation",Yo);class qo extends _o{constructor(){super(...arguments);this._initData={}}set target(t){if(this._target)this._target.off(qo.EFFECT_BEGIN,this,this._onOtherBegin);this._target=t;if(this._target)this._target.on(qo.EFFECT_BEGIN,this,this._onOtherBegin);this._addEvent()}get target(){return this._target}_onOtherBegin(t){if(t===this)return;this.stop()}set playEvent(t){this._playEvent=t;if(!t)return;this._addEvent()}_addEvent(){if(!this._target||!this._playEvent)return;this._setControlNode(this._target);this._target.on(this._playEvent,this,this._onPlayAction)}_onPlayAction(){this.play(0,false)}play(t=0,e=true,o=""){if(!this._target)return;this._target.event(qo.EFFECT_BEGIN,[this]);this._recordInitData();super.play(t,e,o)}_recordInitData(){if(!this._aniKeys)return;var t,e;e=this._aniKeys.length;var o;for(t=0;t<e;t++){o=this._aniKeys[t];this._initData[o]=this._target[o]}}set effectClass(t){this._effectClass=d.getClass(t);if(this._effectClass){var e=this._effectClass["uiView"];if(e){var o=e["animations"];if(o&&o[0]){var i=o[0];this._setUp({},i);if(i.nodes&&i.nodes[0]){this._aniKeys=i.nodes[0].keys}}}}}set effectData(t){if(t){var e=t["animations"];if(e&&e[0]){var o=e[0];this._setUp({},o);if(o.nodes&&o.nodes[0]){this._aniKeys=o.nodes[0].keys}}}}_displayToIndex(t){if(!this._animationData)return;if(t<0)t=0;if(t>this._count)t=this._count;var e=this._animationData.nodes,o,i=e.length;i=i>1?1:i;for(o=0;o<i;o++){this._displayNodeToFrame(e[o],t)}}_displayNodeToFrame(t,e,o=null){if(!this._target)return;var i=this._target;var a=t.frames,r,s,n;var b=t.keys,x,l=b.length;var _=t.secondFrames;var h;var d;var p;var c;var u;for(x=0;x<l;x++){r=b[x];s=a[r];h=_[r];if(h==-1){n=this._initData[r]}else{if(e<h){p=t.keyframes[r];c=p[0];if(c.tween){d=ro[c.tweenMethod];if(d==null)d=ro.linearNone;u=p[1];n=d(e,this._initData[r],u.value-this._initData[r],u.index)}else{n=this._initData[r]}}else{if(s.length>e)n=s[e];else n=s[s.length-1]}}i[r]=n}}_calculateKeyFrames(t){super._calculateKeyFrames(t);var e=t.keyframes,o,i,a=t.target;var r={};t.secondFrames=r;for(o in e){i=e[o];if(i.length<=1)r[o]=-1;else r[o]=i[1].index}}}qo.EFFECT_BEGIN="effectbegin";d.regClass("laya.display.EffectAnimation",qo);d.regClass("Laya.EffectAnimation",qo);class jo extends e{constructor(){super();this._completeHandler=new Z(this,this.onOneLoadComplete);this.reset()}reset(){this._toLoadList=[];this._isLoading=false;this.totalCount=0}get leftCount(){if(this._isLoading)return this._toLoadList.length+1;return this._toLoadList.length}get loadedCount(){return this.totalCount-this.leftCount}load(t,e=false,o=true){if(t instanceof Array){var i,a;a=t.length;for(i=0;i<a;i++){this._addToLoadList(t[i],e)}}else{this._addToLoadList(t,e)}if(o)this._checkNext()}_addToLoadList(t,e=false){if(this._toLoadList.indexOf(t)>=0)return;if(J.getRes(t))return;if(e){this._toLoadList.push({url:t})}else this._toLoadList.push(t);this.totalCount++}_checkNext(){if(!this._isLoading){if(this._toLoadList.length==0){this.event(L.COMPLETE);return}var t;t=this._toLoadList.pop();if(typeof t=="string"){this.loadOne(t)}else{this.loadOne(t.url,true)}}}loadOne(t,e=false){this._curUrl=t;var o=f.getFileExtension(this._curUrl);if(e){T.loader.create(t,this._completeHandler)}else if(jo.LoadableExtensions[o]){T.loader.load(t,this._completeHandler,null,jo.LoadableExtensions[o])}else if(t!=$e.getFileLoadPath(t)||jo.No3dLoadTypes[o]||!to.createMap[o]){T.loader.load(t,this._completeHandler)}else{T.loader.create(t,this._completeHandler)}}onOneLoadComplete(){this._isLoading=false;if(!J.getRes(this._curUrl)){console.log("Fail to load:",this._curUrl)}var t=f.getFileExtension(this._curUrl);if(jo.LoadableExtensions[t]){var e;e=J.getRes(this._curUrl);if(e&&e instanceof Ze){e=e.json}if(e){if(e.loadList){this.load(e.loadList,false,false)}if(e.loadList3D){this.load(e.loadList3D,true,false)}}}if(t=="sk"){this.load(this._curUrl.replace(".sk",".png"),false,false)}this.event(L.PROGRESS,this.getProgress());this._checkNext()}getProgress(){return this.loadedCount/this.totalCount}}jo.LoadableExtensions={scene:J.JSON,scene3d:J.JSON,ani:J.JSON,ui:J.JSON,prefab:J.PREFAB};jo.No3dLoadTypes={png:true,jpg:true,txt:true};class Ko extends Fe{constructor(t=true){super();this.autoDestroyAtClosed=false;this.url=null;this._viewCreated=false;this._$componentType="Scene";this._setBit(R.NOT_READY,true);Ko.unDestroyedScenes.push(this);this._scene=this;if(t)this.createChildren()}createChildren(){}loadScene(t){var e=t.indexOf(".")>-1?t:t+".scene";var o=T.loader.getRes(e);if(o){this.createView(o)}else{T.loader.resetProgress();var i=new jo;i.on(L.COMPLETE,this,this._onSceneLoaded,[e]);i.load(e)}}_onSceneLoaded(t){this.createView(T.Loader.getRes(t))}createView(t){if(t&&!this._viewCreated){this._viewCreated=true;co.createByData(this,t)}}getNodeByID(t){if(this._idMap)return this._idMap[t];return null}open(t=true,e=null){if(t)Ko.closeAll();Ko.root.addChild(this);this.onOpened(e)}onOpened(t){}close(t=null){this.onClosed(t);if(this.autoDestroyAtClosed)this.destroy();else this.removeSelf()}onClosed(t=null){}destroy(t=true){this._idMap=null;super.destroy(t);var e=Ko.unDestroyedScenes;for(var o=e.length-1;o>-1;o--){if(e[o]===this){e.splice(o,1);return}}}set scaleX(t){if(super.get_scaleX()==t)return;super.set_scaleX(t);this.event(L.RESIZE)}get scaleX(){return super.scaleX}set scaleY(t){if(super.get_scaleY()==t)return;super.set_scaleY(t);this.event(L.RESIZE)}get scaleY(){return super.scaleY}get width(){if(this._width)return this._width;var t=0;for(var e=this.numChildren-1;e>-1;e--){var o=this.getChildAt(e);if(o._visible){t=Math.max(o._x+o.width*o.scaleX,t)}}return t}set width(t){if(super.get_width()==t)return;super.set_width(t);this.callLater(this._sizeChanged)}get height(){if(this._height)return this._height;var t=0;for(var e=this.numChildren-1;e>-1;e--){var o=this.getChildAt(e);if(o._visible){t=Math.max(o._y+o.height*o.scaleY,t)}}return t}set height(t){if(super.get_height()==t)return;super.set_height(t);this.callLater(this._sizeChanged)}_sizeChanged(){this.event(L.RESIZE)}static get root(){if(!Ko._root){Ko._root=T.stage.addChild(new Fe);Ko._root.name="root";T.stage.on("resize",null,()=>{Ko._root.size(T.stage.width,T.stage.height);Ko._root.event(L.RESIZE)});Ko._root.size(T.stage.width,T.stage.height);Ko._root.event(L.RESIZE)}return Ko._root}get timer(){return this._timer||T.timer}set timer(t){this._timer=t}static load(a,r=null,e=null){T.loader.resetProgress();var s=new jo;s.on(L.PROGRESS,null,n);s.once(L.COMPLETE,null,t);s.load(a);function n(t){if(Ko._loadPage)Ko._loadPage.event("progress",t);e&&e.runWith(t)}function t(){s.off(L.PROGRESS,null,n);var t=T.Loader.getRes(a);if(!t)throw"Can not find scene:"+a;if(!t.props)throw"Scene data is error:"+a;var e=t.props.runtime?t.props.runtime:t.type;var o=T.ClassUtils.getClass(e);if(t.props.renderType=="instance"){var i=o.instance||(o.instance=new o)}else{i=new o}if(i&&i instanceof Ie){i.url=a;if(!i._getBit(R.NOT_READY)){r&&r.runWith(i)}else{i.on("onViewCreated",null,function(){r&&r.runWith(i)});i.createView(t)}Ko.hideLoadingPage()}else{throw"Can not find scene:"+e}}}static open(t,e=true,o=null,i=null,a=null){if(o instanceof Z){var r=i;i=o;o=r}Ko.showLoadingPage();Ko.load(t,Z.create(null,this._onSceneLoaded,[e,i,o]),a)}static _onSceneLoaded(t,e,o,i){i.open(t,o);if(e)e.runWith(i)}static close(t,e=""){var o=false;var i=Ko.unDestroyedScenes;for(var a=0,r=i.length;a<r;a++){var s=i[a];if(s&&s.parent&&s.url===t&&s.name==e){s.close();o=true}}return o}static closeAll(){var t=Ko.root;for(var e=0,o=t.numChildren;e<o;e++){var i=t.getChildAt(0);if(i instanceof Ko)i.close();else i.removeSelf()}}static destroy(t,e=""){var o=false;var i=Ko.unDestroyedScenes;for(var a=0,r=i.length;a<r;a++){var s=i[a];if(s.url===t&&s.name==e){s.destroy();o=true}}return o}static gc(){$.destroyUnusedResources()}static setLoadingPage(t){if(Ko._loadPage!=t){Ko._loadPage=t}}static showLoadingPage(t=null,e=500){if(Ko._loadPage){T.systemTimer.clear(null,Ko._showLoading);T.systemTimer.clear(null,Ko._hideLoading);T.systemTimer.once(e,null,Ko._showLoading,[t],false)}}static _showLoading(t){T.stage.addChild(Ko._loadPage);Ko._loadPage.onOpened(t)}static _hideLoading(){Ko._loadPage.close()}static hideLoadingPage(t=500){if(Ko._loadPage){T.systemTimer.clear(null,Ko._showLoading);T.systemTimer.clear(null,Ko._hideLoading);T.systemTimer.once(t,null,Ko._hideLoading)}}}Ko.unDestroyedScenes=[];T.regClass(Ko);d.regClass("laya.display.Scene",Ko);d.regClass("Laya.Scene",Ko);class Zo{constructor(){this._paramData=null}static create(t,e,o,i,a){return null}recover(){this._graphicsCmdEncoder=null;p.recover("DrawCanvasCmd",this)}get cmdID(){return Zo.ID}}Zo.ID="DrawCanvasCmd";Zo._DRAW_IMAGE_CMD_ENCODER_=null;Zo._PARAM_TEXTURE_POS_=2;Zo._PARAM_VB_POS_=5;class Qo{static create(t){var e=p.getItemByClass("DrawParticleCmd",Qo);e._templ=t;return e}recover(){this._templ=null;p.recover("DrawParticleCmd",this)}run(t,e,o){t.drawParticle(e,o,this._templ)}get cmdID(){return Qo.ID}}Qo.ID="DrawParticleCmd";class $o{constructor(){}paramChanged(){h.systemTimer.callLater(this,this.buildFilter)}buildFilter(){if(this._target){this.addFilter(this._target)}}addFilter(t){if(!t)return;if(!t.filters){t.filters=[this._filter]}else{var e;e=t.filters;if(e.indexOf(this._filter)<0){e.push(this._filter);t.filters=f.copyArray([],e)}}}removeFilter(t){if(!t)return;t.filters=null}set target(t){if(this._target!=t){this._target=t;this.paramChanged()}}}class ti{render(t,e,o,i,a){var r=nt.create(D.TEXTURE2D,0);this.setShaderInfo(r,a,t.width,t.height);e.drawTarget(t,0,0,o,i,w.EMPTY.identity(),r)}setShaderInfo(t,e,o,i){t.defines.add(lt.BLUR);var a=t;ti.blurinfo[0]=o;ti.blurinfo[1]=i;a.blurInfo=ti.blurinfo;var r=e.strength/3;var s=r*r;e.strength_sig2_2sig2_gauss1[0]=e.strength;e.strength_sig2_2sig2_gauss1[1]=s;e.strength_sig2_2sig2_gauss1[2]=2*s;e.strength_sig2_2sig2_gauss1[3]=1/(2*Math.PI*s);a.strength_sig2_2sig2_gauss1=e.strength_sig2_2sig2_gauss1}}ti.blurinfo=new Array(2);class ei extends lt{constructor(t=4){super();this.strength_sig2_2sig2_gauss1=[];this.strength=t;this._glRender=new ti}get type(){return lt.BLUR}getStrenth_sig2_2sig2_native(){if(!this.strength_sig2_native){this.strength_sig2_native=new Float32Array(4)}var t=this.strength/3;var e=t*t;this.strength_sig2_native[0]=this.strength;this.strength_sig2_native[1]=e;this.strength_sig2_native[2]=2*e;this.strength_sig2_native[3]=1/(2*Math.PI*e);return this.strength_sig2_native}}class oi extends $o{constructor(){super();this._strength=4;this._filter=new ei(this.strength)}buildFilter(){this._filter=new ei(this.strength);super.buildFilter()}get strength(){return this._strength}set strength(t){this._strength=t}}class ii{constructor(){this._curState=0;this.effectScale=1.5;this.tweenTime=300}set target(t){this._tar=t;t.on(L.MOUSE_DOWN,this,this.toChangedState);t.on(L.MOUSE_UP,this,this.toInitState);t.on(L.MOUSE_OUT,this,this.toInitState)}toChangedState(){this._curState=1;if(this._curTween)so.clear(this._curTween);this._curTween=so.to(this._tar,{scaleX:this.effectScale,scaleY:this.effectScale},this.tweenTime,ro[this.effectEase],Z.create(this,this.tweenComplete))}toInitState(){if(this._curState==2)return;if(this._curTween)so.clear(this._curTween);this._curState=2;this._curTween=so.to(this._tar,{scaleX:1,scaleY:1},this.tweenTime,ro[this.backEase],Z.create(this,this.tweenComplete))}tweenComplete(){this._curState=0;this._curTween=null}}class ai extends $o{constructor(){super();this._brightness=0;this._contrast=0;this._saturation=0;this._hue=0;this._red=0;this._green=0;this._blue=0;this._alpha=0;this._filter=new _t}buildFilter(){this._filter.reset();this._filter.color(this.red,this.green,this.blue,this.alpha);this._filter.adjustHue(this.hue);this._filter.adjustContrast(this.contrast);this._filter.adjustBrightness(this.brightness);this._filter.adjustSaturation(this.saturation);super.buildFilter()}get brightness(){return this._brightness}set brightness(t){this._brightness=t;this.paramChanged()}get contrast(){return this._contrast}set contrast(t){this._contrast=t;this.paramChanged()}get saturation(){return this._saturation}set saturation(t){this._saturation=t;this.paramChanged()}get hue(){return this._hue}set hue(t){this._hue=t;this.paramChanged()}get red(){return this._red}set red(t){this._red=t;this.paramChanged()}get green(){return this._green}set green(t){this._green=t;this.paramChanged()}get blue(){return this._blue}set blue(t){this._blue=t;this.paramChanged()}get color(){return this._color}set color(t){this._color=t;var e;e=g.create(t);this._red=e.arrColor[0]*255;this._green=e.arrColor[1]*255;this._blue=e.arrColor[2]*255;this.paramChanged()}get alpha(){return this._alpha}set alpha(t){this._alpha=t;this.paramChanged()}}class ri extends bo{constructor(){super(...arguments);this.duration=1e3;this.delay=0;this.repeat=0;this.autoDestroyAtComplete=true}_onAwake(){this.target=this.target||this.owner;if(this.autoDestroyAtComplete)this._comlete=Z.create(this.target,this.target.destroy,null,false);if(this.eventName)this.owner.on(this.eventName,this,this._exeTween);else this._exeTween()}_exeTween(){this._tween=this._doTween();this._tween.repeat=this.repeat}_doTween(){return null}onReset(){this.duration=1e3;this.delay=0;this.repeat=0;this.ease=null;this.target=null;if(this.eventName){this.owner.off(this.eventName,this,this._exeTween);this.eventName=null}if(this._comlete){this._comlete.recover();this._comlete=null}if(this._tween){this._tween.clear();this._tween=null}}}class si extends ri{_doTween(){this.target.alpha=0;return so.to(this.target,{alpha:1},this.duration,ro[this.ease],this._comlete,this.delay)}}class ni extends ri{_doTween(){this.target.alpha=1;return so.to(this.target,{alpha:0},this.duration,ro[this.ease],this._comlete,this.delay)}}class bi{setShaderInfo(t,e,o,i){t.defines.add(i.type);var a=t;a.u_blurInfo1=i._sv_blurInfo1;var r=i._sv_blurInfo2;r[0]=e;r[1]=o;a.u_blurInfo2=r;a.u_color=i.getColor()}render(t,e,o,i,a){var r=o,s=i;var n=nt.create(D.TEXTURE2D,0);this.setShaderInfo(n,r,s,a);var b=nt.create(D.TEXTURE2D,0);var x=w.TEMP.identity();e.drawTarget(t,0,0,r,s,x,n);e.drawTarget(t,0,0,r,s,x,b)}}class xi extends lt{constructor(t,e=4,o=6,i=6){super();this._elements=new Float32Array(9);this._sv_blurInfo1=new Array(4);this._sv_blurInfo2=[0,0,1,0];this._color=new g(t);this.blur=Math.min(e,20);this.offX=o;this.offY=i;this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=this.blur;this._sv_blurInfo1[2]=o;this._sv_blurInfo1[3]=-i;this._glRender=new bi}get type(){return ei.GLOW}get offY(){return this._elements[6]}set offY(t){this._elements[6]=t;this._sv_blurInfo1[3]=-t}get offX(){return this._elements[5]}set offX(t){this._elements[5]=t;this._sv_blurInfo1[2]=t}getColor(){return this._color.arrColor}get blur(){return this._elements[4]}set blur(t){this._elements[4]=t;this._sv_blurInfo1[0]=this._sv_blurInfo1[1]=t}getColorNative(){if(!this._color_native){this._color_native=new Float32Array(4)}var t=this.getColor();this._color_native[0]=t[0];this._color_native[1]=t[1];this._color_native[2]=t[2];this._color_native[3]=t[3];return this._color_native}getBlurInfo1Native(){if(!this._blurInof1_native){this._blurInof1_native=new Float32Array(4)}this._blurInof1_native[0]=this._blurInof1_native[1]=this.blur;this._blurInof1_native[2]=this.offX;this._blurInof1_native[3]=this.offY;return this._blurInof1_native}getBlurInfo2Native(){if(!this._blurInof2_native){this._blurInof2_native=new Float32Array(4)}this._blurInof2_native[2]=1;return this._blurInof2_native}}class li extends $o{constructor(){super();this._color="#ff0000";this._blur=4;this._offX=6;this._offY=6;this._filter=new xi(this._color)}buildFilter(){this._filter=new xi(this.color,this.blur,this.offX,this.offY);super.buildFilter()}get color(){return this._color}set color(t){this._color=t;this.paramChanged()}get blur(){return this._blur}set blur(t){this._blur=t;this.paramChanged()}get offX(){return this._offX}set offX(t){this._offX=t;this.paramChanged()}get offY(){return this._offY}set offY(t){this._offY=t;this.paramChanged()}}class _i{}_i.STANDARD=0;_i.LEFT=1;_i.RIGHT=2;_i.NUM_PAD=3;class t{}t.NUMBER_0=48;t.NUMBER_1=49;t.NUMBER_2=50;t.NUMBER_3=51;t.NUMBER_4=52;t.NUMBER_5=53;t.NUMBER_6=54;t.NUMBER_7=55;t.NUMBER_8=56;t.NUMBER_9=57;t.A=65;t.B=66;t.C=67;t.D=68;t.E=69;t.F=70;t.G=71;t.H=72;t.I=73;t.J=74;t.K=75;t.L=76;t.M=77;t.N=78;t.O=79;t.P=80;t.Q=81;t.R=82;t.S=83;t.T=84;t.U=85;t.V=86;t.W=87;t.X=88;t.Y=89;t.Z=90;t.F1=112;t.F2=113;t.F3=114;t.F4=115;t.F5=116;t.F6=117;t.F7=118;t.F8=119;t.F9=120;t.F10=121;t.F11=122;t.F12=123;t.F13=124;t.F14=125;t.F15=126;t.NUMPAD=21;t.NUMPAD_0=96;t.NUMPAD_1=97;t.NUMPAD_2=98;t.NUMPAD_3=99;t.NUMPAD_4=100;t.NUMPAD_5=101;t.NUMPAD_6=102;t.NUMPAD_7=103;t.NUMPAD_8=104;t.NUMPAD_9=105;t.NUMPAD_ADD=107;t.NUMPAD_DECIMAL=110;t.NUMPAD_DIVIDE=111;t.NUMPAD_ENTER=108;t.NUMPAD_MULTIPLY=106;t.NUMPAD_SUBTRACT=109;t.SEMICOLON=186;t.EQUAL=187;t.COMMA=188;t.MINUS=189;t.PERIOD=190;t.SLASH=191;t.BACKQUOTE=192;t.LEFTBRACKET=219;t.BACKSLASH=220;t.RIGHTBRACKET=221;t.QUOTE=222;t.ALTERNATE=18;t.BACKSPACE=8;t.CAPS_LOCK=20;t.COMMAND=15;t.CONTROL=17;t.DELETE=46;t.ENTER=13;t.ESCAPE=27;t.PAGE_UP=33;t.PAGE_DOWN=34;t.END=35;t.HOME=36;t.LEFT=37;t.UP=38;t.RIGHT=39;t.DOWN=40;t.SHIFT=16;t.SPACE=32;t.TAB=9;t.INSERT=45;class hi{constructor(t,e,o,i){this._idata=[]}getArrayData(){return this._idata}getPtrID(){return 0}beginEncoding(){}endEncoding(){}clearEncoding(){this._idata.length=0}getCount(){return this._idata.length}add_ShaderValue(t){this._idata.push(t)}addShaderUniform(t){this.add_ShaderValue(t)}}class di{static uploadShaderUniforms(t,e,o,i){var a=o._data;var r=e.getArrayData();var s=0;for(var n=0,b=r.length;n<b;n++){var x=r[n];if(i||x.textureID!==-1){var l=a[x.dataOffset];if(l!=null)s+=x.fun.call(x.caller,x,l)}}return s}static uploadCustomUniform(t,e,o,i){var a=0;var r=e[o];if(r&&i!=null)a+=r.fun.call(r.caller,r,i);return a}static uploadShaderUniformsForNative(t,e,o){return c.instance.uploadShaderUniforms(e,o._data,o._runtimeCopyValues.length>0?c.UPLOAD_SHADER_UNIFORM_TYPE_DATA:c.UPLOAD_SHADER_UNIFORM_TYPE_ID)}}class r{constructor(){}static getMCDName(t){return r._typeToNameDic[t]}static showRenderTypeInfo(t,e=false){if(!e&&r.showedDic[t])return;r.showedDic[t]=true;if(!r._rendertypeToStrDic[t]){var o=[];var i;i=1;while(i<=t){if(i&t){o.push(r.getMCDName(i&t))}i=i<<1}r._rendertypeToStrDic[t]=o.join(",")}console.log("cmd:",r._rendertypeToStrDic[t])}static __init__(){r._typeToNameDic[P.ALPHA]="ALPHA";r._typeToNameDic[P.TRANSFORM]="TRANSFORM";r._typeToNameDic[P.TEXTURE]="TEXTURE";r._typeToNameDic[P.GRAPHICS]="GRAPHICS";r._typeToNameDic[P.ONECHILD]="ONECHILD";r._typeToNameDic[P.CHILDS]="CHILDS";r._typeToNameDic[P.TRANSFORM|P.ALPHA]="TRANSFORM|ALPHA";r._typeToNameDic[P.CANVAS]="CANVAS";r._typeToNameDic[P.BLEND]="BLEND";r._typeToNameDic[P.FILTERS]="FILTERS";r._typeToNameDic[P.MASK]="MASK";r._typeToNameDic[P.CLIP]="CLIP";r._typeToNameDic[P.LAYAGL3D]="LAYAGL3D"}render(t,e,o){r._addType(this._renderType);r.showRenderTypeInfo(this._renderType);Ge.renders[this._renderType]._fun(this,t,e+this._x,o+this._y);this._repaint=0}_stageRender(t,e,o){r._countStart();r._PreStageRender.call(T.stage,t,e,o);r._countEnd()}static _countStart(){var t;for(t in r._countDic){r._countDic[t]=0}}static _countEnd(){r._i++;if(r._i>60){r.showCountInfo();r._i=0}}static _addType(t){if(!r._countDic[t]){r._countDic[t]=1}else{r._countDic[t]+=1}}static showCountInfo(){console.log("===================");var t;for(t in r._countDic){console.log("count:"+r._countDic[t]);r.showRenderTypeInfo(t,true)}}static enableQuickTest(){r.__init__();Fe["prototype"]["render"]=r["prototype"]["render"];r._PreStageRender=F["prototype"]["render"];F["prototype"]["render"]=r["prototype"]["_stageRender"]}}r.showedDic={};r._rendertypeToStrDic={};r._typeToNameDic={};r._countDic={};r._i=0;class pi extends e{load(t){}play(t=0,e=0){return null}get duration(){return 0}dispose(){}}class ci extends Fe{constructor(){super();this.visible=false;this.on(L.ADDED,this,this._onParentChange);this.on(L.REMOVED,this,this._onParentChange)}_onParentChange(){this.target=this.parent}play(t=1,e=null){if(isNaN(t)){t=1}if(!this.url)return;this.stop();this._channel=_.playSound(this.url,t,e)}stop(){if(this._channel&&!this._channel.isStopped){this._channel.stop()}this._channel=null}_setPlayAction(t,e,o,i=true){if(!this[o])return;if(!t)return;if(i){t.on(e,this,this[o])}else{t.off(e,this,this[o])}}_setPlayActions(t,e,o,i=true){if(!t)return;if(!e)return;var a=e.split(",");var r,s;s=a.length;for(r=0;r<s;r++){this._setPlayAction(t,a[r],o,i)}}set playEvent(t){this._playEvents=t;if(!t)return;if(this._tar){this._setPlayActions(this._tar,t,"play")}}set target(t){if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",false);this._setPlayActions(this._tar,this._stopEvents,"stop",false)}this._tar=t;if(this._tar){this._setPlayActions(this._tar,this._playEvents,"play",true);this._setPlayActions(this._tar,this._stopEvents,"stop",true)}}set stopEvent(t){this._stopEvents=t;if(!t)return;if(this._tar){this._setPlayActions(this._tar,t,"stop")}}}class ui{static enable(t,e,o=2){ui.type=o;T.loader.load(t,Z.create(null,ui.onManifestLoaded,[e]),null,J.JSON)}static onManifestLoaded(t,e){ui.manifest=e;M.customFormat=ui.addVersionPrefix;t.run();if(!e){console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")}}static addVersionPrefix(t){t=M.getAdptedFilePath(t);if(ui.manifest&&ui.manifest[t]){if(ui.type==ui.FILENAME_VERSION)return ui.manifest[t];return ui.manifest[t]+"/"+t}return t}}ui.FOLDER_VERSION=1;ui.FILENAME_VERSION=2;ui.type=ui.FOLDER_VERSION;class yi extends e{constructor(t=null,e=0,o=null,i=null){super();this.disableInput=false;this.protocols=[];this._byteClass=o?o:Qe;this.protocols=i;this.endian=yi.BIG_ENDIAN;if(t&&e>0&&e<65535)this.connect(t,e)}get input(){return this._input}get output(){return this._output}get connected(){return this._connected}get endian(){return this._endian}set endian(t){this._endian=t;if(this._input!=null)this._input.endian=t;if(this._output!=null)this._output.endian=t}connect(t,e){var o="ws://"+t+":"+e;this.connectByUrl(o)}connectByUrl(t){if(this._socket!=null)this.close();this._socket&&this.cleanSocket();if(!this.protocols||this.protocols.length==0){this._socket=new E.window.WebSocket(t)}else{this._socket=new E.window.WebSocket(t,this.protocols)}this._socket.binaryType="arraybuffer";this._output=new this._byteClass;this._output.endian=this.endian;this._input=new this._byteClass;this._input.endian=this.endian;this._addInputPosition=0;this._socket.onopen=t=>{this._onOpen(t)};this._socket.onmessage=t=>{this._onMessage(t)};this._socket.onclose=t=>{this._onClose(t)};this._socket.onerror=t=>{this._onError(t)}}cleanSocket(){this.close();this._connected=false;this._socket.onopen=null;this._socket.onmessage=null;this._socket.onclose=null;this._socket.onerror=null;this._socket=null}close(){if(this._socket!=null){try{this._socket.close()}catch(t){}}}_onOpen(t){this._connected=true;this.event(L.OPEN,t)}_onMessage(t){if(!t||!t.data)return;var e=t.data;if(this.disableInput&&e){this.event(L.MESSAGE,e);return}if(this._input.length>0&&this._input.bytesAvailable<1){this._input.clear();this._addInputPosition=0}var o=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0);this._input.pos=this._addInputPosition;if(e){if(typeof e=="string"){this._input.writeUTFBytes(e)}else{this._input.writeArrayBuffer(e)}this._addInputPosition=this._input.pos;this._input.pos=o}this.event(L.MESSAGE,e)}_onClose(t){this._connected=false;this.event(L.CLOSE,t)}_onError(t){this.event(L.ERROR,t)}send(t){this._socket.send(t)}flush(){if(this._output&&this._output.length>0){var e;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(t){e=t}this._output.endian=this.endian;this._output.clear();if(e)this.event(L.ERROR,e)}}}yi.LITTLE_ENDIAN="littleEndian";yi.BIG_ENDIAN="bigEndian";class mi{static changeDefinition(t,e){window.Laya[t]=e;var o=t+"=classObj";window["eval"](o)}}class fi{constructor(){this.reset()}setData(t,e,o,i){this.char=t;this.charNum=t.charCodeAt(0);this.x=this.y=0;this.width=e;this.height=o;this.style=i;this.isWord=!fi._isWordRegExp.test(t);return this}reset(){this.x=this.y=this.width=this.height=0;this.isWord=false;this.char=null;this.charNum=0;this.style=null;return this}recover(){p.recover("HTMLChar",this.reset())}static create(){return p.getItemByClass("HTMLChar",fi)}_isChar(){return true}_getCSSStyle(){return this.style}}fi._isWordRegExp=new RegExp("[\\w.]","");class gi{static enable(){if(!gi._logdiv){gi._logdiv=E.createElement("div");gi._logdiv.style.cssText="border:white;padding:4px;overflow-y:auto;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;";E.document.body.appendChild(gi._logdiv);gi._btn=E.createElement("button");gi._btn.innerText="Hide";gi._btn.style.cssText="z-index:1000001;position: absolute;left:10px;top:10px;";gi._btn.onclick=gi.toggle;E.document.body.appendChild(gi._btn)}}static toggle(){var t=gi._logdiv.style;if(t.display===""){gi._btn.innerText="Show";t.display="none"}else{gi._btn.innerText="Hide";t.display=""}}static print(t){if(gi._logdiv){if(gi._count>=gi.maxCount)gi.clear();gi._count++;gi._logdiv.innerText+=t+"\n";if(gi.autoScrollToBottom){if(gi._logdiv.scrollHeight-gi._logdiv.scrollTop-gi._logdiv.clientHeight<50){gi._logdiv.scrollTop=gi._logdiv.scrollHeight}}}}static clear(){gi._logdiv.innerText="";gi._count=0}}gi._count=0;gi.maxCount=50;gi.autoScrollToBottom=true;let vi=300;class Si{constructor(t,e,o,i){this.scale=1;this.datas=new Array(vi);this.datapos=0;this.id=t;this.color=e;this.name=o;this.scale=i}addData(t){this.datas[this.datapos]=t;this.datapos++;this.datapos%=vi}}class Ci extends Fe{constructor(){super();this.datas=[];this.xdata=new Array(Ci.DATANUM);this.ydata=new Array(Ci.DATANUM);this.hud_width=800;this.hud_height=200;this.gMinV=0;this.gMaxV=100;this.textSpace=40;this.sttm=0;Ci.inst=this;this._renderType|=P.CUSTOM;this._setRenderType(this._renderType);this._setCustomRender();this.addDataDef(0,16777215,"frame",1);this.addDataDef(1,65280,"update",1);this.addDataDef(2,16711680,"flush",1);Ci._now=performance?performance.now.bind(performance):Date.now}now(){return Ci._now()}start(){this.sttm=Ci._now()}end(t){var e=Ci._now()-this.sttm;this.updateValue(t,e)}config(t,e){this.hud_width=t;this.hud_height=e}addDataDef(t,e,o,i){this.datas[t]=new Si(t,e,o,i)}updateValue(t,e){this.datas[t].addData(e)}v2y(t){var e=this._y+this.hud_height*(1-(t-this.gMinV)/this.gMaxV);return this._y+this.hud_height*(1-(t-this.gMinV)/this.gMaxV)}drawHLine(t,e,o,i){var a=this._x;var r=this._x+this.hud_width;var s=this.v2y(e);t.fillText(i,a,s-6,null,"green",null);a+=this.textSpace;t.fillStyle=o;t.fillRect(a,s,this._x+this.hud_width,1,null)}customRender(t,e,o){var i=performance.now();if(Ci._lastTm<=0)Ci._lastTm=i;this.updateValue(0,i-Ci._lastTm);Ci._lastTm=i;t.save();t.fillRect(this._x,this._y,this.hud_width,this.hud_height+4,"#000000cc");t.globalAlpha=.9;this.drawHLine(t,0,"green","    0");this.drawHLine(t,10,"green","  10");this.drawHLine(t,16.667,"red"," ");this.drawHLine(t,20,"green","50|20");this.drawHLine(t,16.667*2,"yellow","");this.drawHLine(t,16.667*3,"yellow","");this.drawHLine(t,16.667*4,"yellow","");this.drawHLine(t,50,"green","20|50");this.drawHLine(t,100,"green","10|100");for(var a=0,r=this.datas.length;a<r;a++){var s=this.datas[a];if(!s)continue;var n=s.datas.length;var b=(this.hud_width-this.textSpace)/n;var x=s.datapos;var l=this._x+this.textSpace;t.fillStyle=s.color;for(var _=n;x<_;x++){var h=this.v2y(s.datas[x]*s.scale);t.fillRect(l,h,b,this.hud_height+this._y-h,null);l+=b}for(x=0;x<s.datapos;x++){h=this.v2y(s.datas[x]*s.scale);t.fillRect(l,h,b,this.hud_height+this._y-h,null);l+=b}}t.restore()}}Ci._lastTm=0;Ci._now=null;Ci.DATANUM=300;Ci.drawTexTm=0;class Pi{constructor(){this.maxCount=1e3}getCacheList(){return p.getPoolBySign(this.sign)}tryDispose(t){var e;e=p.getPoolBySign(this.sign);if(e.length>this.maxCount){e.splice(this.maxCount,e.length-this.maxCount)}}static addPoolCacheManager(t,e=100){var o;o=new Pi;o.sign=t;o.maxCount=e;Be.regCacheByFunction(f.bind(o.tryDispose,o),f.bind(o.getCacheList,o))}}class Ai extends e{constructor(){super(...arguments);this._tweenDic={};this._tweenDataList=[];this._currTime=0;this._lastTime=0;this._startTime=0;this._index=0;this._gidIndex=0;this._firstTweenDic={};this._startTimeSort=false;this._endTimeSort=false;this._loopKey=false;this.scale=1;this._frameRate=60;this._frameIndex=0;this._total=0}static to(t,e,o,i=null,a=0){return(new Ai).to(t,e,o,i,a)}static from(t,e,o,i=null,a=0){return(new Ai).from(t,e,o,i,a)}to(t,e,o,i=null,a=0){return this._create(t,e,o,i,a,true)}from(t,e,o,i=null,a=0){return this._create(t,e,o,i,a,false)}_create(t,e,o,i,a,r){var s=p.getItemByClass("tweenData",Bi);s.isTo=r;s.type=0;s.target=t;s.duration=o;s.data=e;s.startTime=this._startTime+a;s.endTime=s.startTime+s.duration;s.ease=i;this._startTime=Math.max(s.endTime,this._startTime);this._tweenDataList.push(s);this._startTimeSort=true;this._endTimeSort=true;return this}addLabel(t,e){var o=p.getItemByClass("tweenData",Bi);o.type=1;o.data=t;o.endTime=o.startTime=this._startTime+e;this._labelDic||(this._labelDic={});this._labelDic[t]=o;this._tweenDataList.push(o);return this}removeLabel(t){if(this._labelDic&&this._labelDic[t]){var e=this._labelDic[t];if(e){var o=this._tweenDataList.indexOf(e);if(o>-1){this._tweenDataList.splice(o,1)}}delete this._labelDic[t]}}gotoTime(t){if(this._tweenDataList==null||this._tweenDataList.length==0)return;var e;var o;for(var i in this._firstTweenDic){o=this._firstTweenDic[i];if(o){for(var a in o){if(a in o.diyTarget){o.diyTarget[a]=o[a]}}}}for(i in this._tweenDic){e=this._tweenDic[i];e.clear();delete this._tweenDic[i]}this._index=0;this._gidIndex=0;this._currTime=t;this._lastTime=E.now();var r;if(this._endTweenDataList==null||this._endTimeSort){this._endTimeSort=false;this._endTweenDataList=r=this._tweenDataList.concat();function s(t,e){if(t.endTime>e.endTime){return 1}else if(t.endTime<e.endTime){return-1}else{return 0}}r.sort(s)}else{r=this._endTweenDataList}var n;for(var b=0,x=r.length;b<x;b++){n=r[b];if(n.type==0){if(t>=n.endTime){this._index=Math.max(this._index,b+1);var l=n.data;if(n.isTo){for(var _ in l){n.target[_]=l[_]}}}else{break}}}for(b=0,x=this._tweenDataList.length;b<x;b++){n=this._tweenDataList[b];if(n.type==0){if(t>=n.startTime&&t<n.endTime){this._index=Math.max(this._index,b+1);this._gidIndex++;e=p.getItemByClass("tween",so);e._create(n.target,n.data,n.duration,n.ease,Z.create(this,this._animComplete,[this._gidIndex]),0,false,n.isTo,true,false);e.setStartTime(this._currTime-(t-n.startTime));e._updateEase(this._currTime);e.gid=this._gidIndex;this._tweenDic[this._gidIndex]=e}}}}gotoLabel(t){if(this._labelDic==null)return;var e=this._labelDic[t];if(e)this.gotoTime(e.startTime)}pause(){T.timer.clear(this,this._update)}resume(){this.play(this._currTime,this._loopKey)}play(t=0,e=false){if(!this._tweenDataList)return;if(this._startTimeSort){this._startTimeSort=false;function o(t,e){if(t.startTime>e.startTime){return 1}else if(t.startTime<e.startTime){return-1}else{return 0}}this._tweenDataList.sort(o);for(var i=0,a=this._tweenDataList.length;i<a;i++){var r=this._tweenDataList[i];if(r!=null&&r.type==0){var s=r.target;var n=s.$_GID||(s.$_GID=f.getGID());var b=null;if(this._firstTweenDic[n]==null){b={};b.diyTarget=s;this._firstTweenDic[n]=b}else{b=this._firstTweenDic[n]}for(var x in r.data){if(b[x]==null){b[x]=s[x]}}}}}if(typeof t=="string"){this.gotoLabel(t)}else{this.gotoTime(t)}this._loopKey=e;this._lastTime=E.now();T.timer.frameLoop(1,this,this._update)}_update(){if(this._currTime>=this._startTime){if(this._loopKey){this._complete();if(!this._tweenDataList)return;this.gotoTime(0)}else{for(var t in this._tweenDic){a=this._tweenDic[t];a.complete()}this._complete();this.pause();return}}var e=E.now();var o=e-this._lastTime;var i=this._currTime+=o*this.scale;this._lastTime=e;for(t in this._tweenDic){a=this._tweenDic[t];a._updateEase(i)}var a;if(this._tweenDataList.length!=0&&this._index<this._tweenDataList.length){var r=this._tweenDataList[this._index];if(i>=r.startTime){this._index++;if(r.type==0){this._gidIndex++;a=p.getItemByClass("tween",so);a._create(r.target,r.data,r.duration,r.ease,Z.create(this,this._animComplete,[this._gidIndex]),0,false,r.isTo,true,false);a.setStartTime(i);a.gid=this._gidIndex;this._tweenDic[this._gidIndex]=a;a._updateEase(i)}else{this.event(L.LABEL,r.data)}}}}_animComplete(t){var e=this._tweenDic[t];if(e)delete this._tweenDic[t]}_complete(){this.event(L.COMPLETE)}get index(){return this._frameIndex}set index(t){this._frameIndex=t;this.gotoTime(this._frameIndex/this._frameRate*1e3)}get total(){this._total=Math.floor(this._startTime/1e3*this._frameRate);return this._total}reset(){var t;if(this._labelDic){for(t in this._labelDic){delete this._labelDic[t]}}var e;for(t in this._tweenDic){e=this._tweenDic[t];e.clear();delete this._tweenDic[t]}for(t in this._firstTweenDic){delete this._firstTweenDic[t]}this._endTweenDataList=null;if(this._tweenDataList&&this._tweenDataList.length){var o,i;i=this._tweenDataList.length;for(o=0;o<i;o++){if(this._tweenDataList[o])this._tweenDataList[o].destroy()}}this._tweenDataList.length=0;this._currTime=0;this._lastTime=0;this._startTime=0;this._index=0;this._gidIndex=0;this.scale=1;T.timer.clear(this,this._update)}destroy(){this.reset();this._labelDic=null;this._tweenDic=null;this._tweenDataList=null;this._firstTweenDic=null}}class Bi{constructor(){this.type=0;this.isTo=true}destroy(){this.target=null;this.ease=null;this.data=null;this.isTo=true;this.type=0;p.recover("tweenData",this)}}class wi{constructor(){}}class Ti{characterMapContains(t){for(var e=0;e<Ti.charsMap.length;++e){if(Ti.charsMap[e][0]===t){return true}}return false}getCharRep(t){for(var e=0;e<Ti.charsMap.length;++e){if(Ti.charsMap[e][0]===t){return Ti.charsMap[e]}}return false}getCombCharRep(t,e){for(var o=0;o<Ti.combCharsMap.length;++o){if(Ti.combCharsMap[o][0][0]===t&&Ti.combCharsMap[o][0][1]===e){return Ti.combCharsMap[o]}}return false}isTransparent(t){for(var e=0;e<Ti.transChars.length;++e){if(Ti.transChars[e]===t){return true}}return false}getOriginalCharsFromCode(t){var e;for(e=0;e<Ti.charsMap.length;++e){if(Ti.charsMap[e].indexOf(t)>-1){return String.fromCharCode(Ti.charsMap[e][0])}}for(e=0;e<Ti.combCharsMap.length;++e){if(Ti.combCharsMap[e].indexOf(t)>-1){return String.fromCharCode(Ti.combCharsMap[e][0][0])+String.fromCharCode(Ti.combCharsMap[e][0][1])}}return String.fromCharCode(t)}convertArabic(t){var e,o,i="";for(var a=0;a<t.length;++a){var r=t.charCodeAt(a);if(this.characterMapContains(r)){var s=null,n=null,b=a-1,x=a+1;for(;b>=0;--b){if(!this.isTransparent(t.charCodeAt(b))){break}}s=b>=0?t.charCodeAt(b):null;e=s?this.getCharRep(s):false;if(!e||e[2]==null&&e[3]==null){s=null}for(;x<t.length;++x){if(!this.isTransparent(t.charCodeAt(x))){break}}n=x<t.length?t.charCodeAt(x):null;e=n?this.getCharRep(n):false;if(!e||e[3]==null&&e[4]==null){n=null}if(r===1604&&n!=null&&(n===1570||n===1571||n===1573||n===1575)){o=this.getCombCharRep(r,n);if(s!=null){i+=String.fromCharCode(o[4])}else{i+=String.fromCharCode(o[1])}++a;continue}e=this.getCharRep(r);if(s!=null&&n!=null&&e[3]!=null){i+=String.fromCharCode(e[3]);continue}else if(s!=null&&e[4]!=null){i+=String.fromCharCode(e[4]);continue}else if(n!=null&&e[2]!=null){i+=String.fromCharCode(e[2]);continue}else{i+=String.fromCharCode(e[1])}}else{i+=String.fromCharCode(r)}}return i}convertArabicBack(t){var e="",o;var i;for(i=0;i<t.length;++i){o=t.charCodeAt(i);e+=this.getOriginalCharsFromCode(o)}return e}}Ti.charsMap=[[1569,65152,null,null,null],[1570,65153,null,null,65154],[1571,65155,null,null,65156],[1572,65157,null,null,65158],[1573,65159,null,null,65160],[1574,65161,65163,65164,65162],[1575,65165,null,null,65166],[1576,65167,65169,65170,65168],[1577,65171,null,null,65172],[1578,65173,65175,65176,65174],[1579,65177,65179,65180,65178],[1580,65181,65183,65184,65182],[1581,65185,65187,65188,65186],[1582,65189,65191,65192,65190],[1583,65193,null,null,65194],[1584,65195,null,null,65196],[1585,65197,null,null,65198],[1586,65199,null,null,65200],[1587,65201,65203,65204,65202],[1588,65205,65207,65208,65206],[1589,65209,65211,65212,65210],[1590,65213,65215,65216,65214],[1591,65217,65219,65220,65218],[1592,65221,65223,65224,65222],[1593,65225,65227,65228,65226],[1594,65229,65231,65232,65230],[1600,1600,1600,1600,1600],[1601,65233,65235,65236,65234],[1602,65237,65239,65240,65238],[1603,65241,65243,65244,65242],[1604,65245,65247,65248,65246],[1605,65249,65251,65252,65250],[1606,65253,65255,65256,65254],[1607,65257,65259,65260,65258],[1608,65261,null,null,65262],[1609,65263,null,null,65264],[1610,65265,65267,65268,65266],[1662,64342,64344,64345,64343],[1740,64508,64510,64511,64509],[1670,64378,64380,64381,64379],[1705,64398,64400,64401,64399],[1711,64402,64404,64405,64403],[1688,64394,null,null,64395]];Ti.combCharsMap=[[[1604,1570],65269,null,null,65270],[[1604,1571],65271,null,null,65272],[[1604,1573],65273,null,null,65274],[[1604,1575],65275,null,null,65276]];Ti.transChars=[1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773];class Mi{static ArrayMul(t,e,o){if(!t){Mi.copyArray(e,o);return}if(!e){Mi.copyArray(t,o);return}var i,a,r,s;for(var n=0;n<4;n++){i=t[n];a=t[n+4];r=t[n+8];s=t[n+12];o[n]=i*e[0]+a*e[1]+r*e[2]+s*e[3];o[n+4]=i*e[4]+a*e[5]+r*e[6]+s*e[7];o[n+8]=i*e[8]+a*e[9]+r*e[10]+s*e[11];o[n+12]=i*e[12]+a*e[13]+r*e[14]+s*e[15]}}static copyArray(t,e){if(!t)return;if(!e)return;for(var o=0;o<t.length;o++){e[o]=t[o]}}}n.AlphaCmd=k;n.Animation=Yo;n.AnimationBase=xo;n.ArabicReshaper=Ti;n.AtlasGrid=oe;n.AtlasInfoManager=$e;n.AudioSound=Ye;n.AudioSoundChannel=He;n.BasePoly=qt;n.BaseShader=et;n.BaseTexture=v;n.Bezier=ft;n.Bitmap=o;n.BitmapFont=Ke;n.BlendMode=I;n.BlurFilter=ei;n.BlurFilterGLRender=ti;n.BlurFilterSetter=oi;n.BoundsStyle=De;n.Browser=E;n.Buffer=Mt;n.Buffer2D=It;n.BufferState2D=Vt;n.BufferStateBase=Et;n.ButtonEffect=ii;n.Byte=Qe;n.CONST3D2D=Kt;n.CacheManger=Be;n.CacheStyle=Ee;n.CallLater=Ne;n.CharRenderInfo=ne;n.CharRender_Canvas=xe;n.CharRender_Native=le;n.CharSubmitCache=ee;n.ClassUtils=d;n.ClipRectCmd=me;n.ColorFilter=_t;n.ColorFilterSetter=ai;n.ColorUtils=g;n.CommandEncoder=hi;n.CommonScript=Uo;n.Component=bo;n.Config=s;n.Const=R;n.Context=z;n.Dragging=no;n.Draw9GridTexture=ue;n.DrawCanvasCmd=Zo;n.DrawCircleCmd=O;n.DrawCurvesCmd=N;n.DrawImageCmd=W;n.DrawLineCmd=U;n.DrawLinesCmd=X;n.DrawParticleCmd=Qo;n.DrawPathCmd=H;n.DrawPieCmd=Y;n.DrawPolyCmd=q;n.DrawRectCmd=j;n.DrawStyle=vt;n.DrawTextureCmd=ht;n.DrawTexturesCmd=fe;n.DrawTrianglesCmd=ce;n.Earcut=S;n.EarcutNode=jt;n.Ease=ro;n.EffectAnimation=qo;n.EffectBase=ri;n.Event=L;n.EventDispatcher=e;n.FadeIn=si;n.FadeOut=ni;n.FillBorderTextCmd=ge;n.FillBorderWordsCmd=ve;n.FillTextCmd=Se;n.FillTextureCmd=dt;n.FillWordsCmd=Ce;n.Filter=lt;n.FilterSetterBase=$o;n.FontInfo=re;n.FrameAnimation=_o;n.GlowFilter=xi;n.GlowFilterGLRender=bi;n.GlowFilterSetter=li;n.GrahamScan=gt;n.GraphicAnimation=Xo;n.Graphics=Te;n.GraphicsBounds=ye;n.HTMLCanvas=Le;n.HTMLChar=fi;n.HTMLImage=Do;n.Handler=Z;n.HitArea=Me;n.HttpRequest=je;n.ICharRender=be;n.ILaya=T;n.IStatRender=mo;n.IndexBuffer2D=Lt;n.InlcudeFile=Ao;n.Input=l;n.KeyBoardManager=ze;n.KeyLocation=_i;n.Keyboard=t;n.Laya=h;n.LayaGL=c;n.LayaGLQuickRunner=Re;n.LayaGLRunner=di;n.LayaGPU=pe;n.Loader=J;n.LoaderManager=to;n.LocalStorage=oo;n.Log=gi;n.MathUtil=lo;n.MatirxArray=Mi;n.Matrix=w;n.Mesh2D=Rt;n.MeshParticle2D=Io;n.MeshQuadTexture=Gt;n.MeshTexture=Ft;n.MeshVG=Jt;n.Mouse=Mo;n.MouseManager=Oe;n.Node=Ie;n.Path=St;n.PerfData=Si;n.PerfHUD=Ci;n.Point=K;n.Pool=p;n.PoolCache=Pi;n.Prefab=Ze;n.PrimitiveSV=Co;n.QuickTestTool=r;n.Rectangle=B;n.Render=y;n.RenderInfo=Tt;n.RenderSprite=Ge;n.RenderState2D=x;n.RenderTexture2D=ot;n.Resource=$;n.ResourceVersion=ui;n.RestoreCmd=pt;n.RotateCmd=ct;n.RunDriver=Ue;n.SaveBase=b;n.SaveClipRect=Pt;n.SaveCmd=Pe;n.SaveMark=At;n.SaveTransform=Bt;n.SaveTranslate=wt;n.ScaleCmd=ut;n.Scene=Ko;n.SceneLoader=jo;n.SceneUtils=co;n.Script=zo;n.Shader=rt;n.Shader2D=Ht;n.Shader2X=st;n.ShaderCompile=wo;n.ShaderDefines2D=D;n.ShaderDefinesBase=i;n.ShaderNode=Bo;n.ShaderValue=wi;n.SkinMeshBuffer=Yt;n.SkinSV=So;n.Socket=yi;n.Sound=pi;n.SoundChannel=Xe;n.SoundManager=_;n.SoundNode=ci;n.Sprite=Fe;n.SpriteConst=P;n.SpriteStyle=Ve;n.Stage=F;n.Stat=m;n.StatUI=fo;n.StringKey=at;n.StrokeTextCmd=Ae;n.Submit=Zt;n.SubmitBase=A;n.SubmitCMD=xt;n.SubmitCanvas=Qt;n.SubmitKey=bt;n.SubmitTarget=$t;n.SubmitTexture=te;n.System=mi;n.TTFLoader=ao;n.Text=G;n.TextAtlas=ie;n.TextRender=V;n.TextStyle=Je;n.TextTexture=C;n.Texture=ae;n.Texture2D=tt;n.TextureSV=Po;n.TimeLine=Ai;n.Timer=go;n.TouchManager=ke;n.TransformCmd=yt;n.TranslateCmd=mt;n.Tween=so;n.URL=M;n.Utils=f;n.Value2D=nt;n.VectorGraphManager=we;n.VertexArrayObject=de;n.VertexBuffer2D=Dt;n.WeakObject=po;n.WebAudioSound=a;n.WebAudioSoundChannel=qe;n.WebGL=he;n.WebGLCacheAsNormalCanvas=kt;n.WebGLContext=u;n.WebGLRTMgr=it;n.WordText=se;n.WorkerLoader=To;n.__init=Ro;n._static=Wo;n.alertGlobalError=Oo;n.enableDebugPanel=No;n.init=Go;n.isWXOpenDataContext=Jo;n.isWXPosMsg=ko;n.version=Fo;n.static=Wo;return n}({});(function(t,b){"use strict";class r{}r.touchScrollEnable=true;r.mouseWheelEnable=true;r.showButtons=true;r.popupBgColor="#000000";r.popupBgAlpha=.5;r.closeDialogOnSide=true;window.UIConfig=r;class s{}s.defaultSizeGrid=[4,4,4,4,0];s.labelColor="#000000";s.labelPadding=[2,2,2,2];s.inputLabelPadding=[1,1,1,3];s.buttonStateNum=3;s.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"];s.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"];s.scrollBarMinNum=15;s.scrollBarDelayTime=500;class e extends b.Graphics{constructor(){super(...arguments);this.autoCacheCmd=true;this._width=0;this._height=0;this.uv=null}destroy(){super.destroy();this._source=null;this._sizeGrid=null;this._offset=null}get sizeGrid(){return this._sizeGrid}set sizeGrid(t){this._sizeGrid=t.map(t=>{return+t});this._setChanged()}get width(){if(this._width)return this._width;if(this._source)return this._source.sourceWidth;return 0}set width(t){if(this._width!=t){this._width=t;this._setChanged()}}get height(){if(this._height)return this._height;if(this._source)return this._source.sourceHeight;return 0}set height(t){if(this._height!=t){this._height=t;this._setChanged()}}get source(){return this._source}set source(t){if(t){this._source=t;this._setChanged()}else{this._source=null;this.clear()}}_setChanged(){if(!this._isChanged){this._isChanged=true;b.ILaya.timer.callLater(this,this.changeSource)}}changeSource(){this._isChanged=false;var t=this._source;if(!t||!t.bitmap)return;var e=this.width;var o=this.height;var i=this._sizeGrid;var a=t.sourceWidth;var r=t.sourceHeight;if(!i||a===e&&r===o){this.clear();this.drawTexture(t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,e,o,null,1,null,null,this.uv)}else{this.clear();this.draw9Grid(t,0,0,e,o,i);this._repaint();return}this._repaint()}drawBitmap(t,e,o,i,a=0,r=0){if(a<.1||r<.1)return;if(t&&(e.width!=a||e.height!=r))this.fillTexture(e,o,i,a,r);else this.drawImage(e,o,i,a,r)}static getTexture(t,e,o,i,a){if(i<=0)i=1;if(a<=0)a=1;t.$_GID||(t.$_GID=b.Utils.getGID());var r;if(!r||!r._getSource()){r=b.Texture.createFromTexture(t,e,o,i,a)}return r}}b.ClassUtils.regClass("laya.ui.AutoBitmap",e);b.ClassUtils.regClass("Laya.AutoBitmap",e);class o extends b.Component{constructor(){super(...arguments);this._top=NaN;this._bottom=NaN;this._left=NaN;this._right=NaN;this._centerX=NaN;this._centerY=NaN}onReset(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}_onEnable(){if(this.owner.parent)this._onAdded();else this.owner.once(b.Event.ADDED,this,this._onAdded)}_onDisable(){this.owner.off(b.Event.ADDED,this,this._onAdded);if(this.owner.parent)this.owner.parent.off(b.Event.RESIZE,this,this._onParentResize)}_onAdded(){if(this.owner.parent)this.owner.parent.on(b.Event.RESIZE,this,this._onParentResize);this.resetLayoutX();this.resetLayoutY()}_onParentResize(){if(this.resetLayoutX()||this.resetLayoutY())this.owner.event(b.Event.RESIZE)}resetLayoutX(){var t=this.owner;if(!t)return false;var e=t.parent;if(e){if(!isNaN(this.centerX)){t.x=Math.round((e.width-t.displayWidth)*.5+this.centerX+t.pivotX*t.scaleX)}else if(!isNaN(this.left)){t.x=Math.round(this.left+t.pivotX*t.scaleX);if(!isNaN(this.right)){var o=(e._width-this.left-this.right)/(t.scaleX||.01);if(o!=t.width){t.width=o;return true}}}else if(!isNaN(this.right)){t.x=Math.round(e.width-t.displayWidth-this.right+t.pivotX*t.scaleX)}}return false}resetLayoutY(){var t=this.owner;if(!t)return false;var e=t.parent;if(e){if(!isNaN(this.centerY)){t.y=Math.round((e.height-t.displayHeight)*.5+this.centerY+t.pivotY*t.scaleY)}else if(!isNaN(this.top)){t.y=Math.round(this.top+t.pivotY*t.scaleY);if(!isNaN(this.bottom)){var o=(e._height-this.top-this.bottom)/(t.scaleY||.01);if(o!=t.height){t.height=o;return true}}}else if(!isNaN(this.bottom)){t.y=Math.round(e.height-t.displayHeight-this.bottom+t.pivotY*t.scaleY)}}return false}resetLayout(){if(this.owner){this.resetLayoutX();this.resetLayoutY()}}get top(){return this._top}set top(t){if(this._top!=t){this._top=t;this.resetLayoutY()}}get bottom(){return this._bottom}set bottom(t){if(this._bottom!=t){this._bottom=t;this.resetLayoutY()}}get left(){return this._left}set left(t){if(this._left!=t){this._left=t;this.resetLayoutX()}}get right(){return this._right}set right(t){if(this._right!=t){this._right=t;this.resetLayoutX()}}get centerX(){return this._centerX}set centerX(t){if(this._centerX!=t){this._centerX=t;this.resetLayoutX()}}get centerY(){return this._centerY}set centerY(t){if(this._centerY!=t){this._centerY=t;this.resetLayoutY()}}}o.EMPTY=null;b.ILaya.regClass(o);o.EMPTY=new o;b.ClassUtils.regClass("laya.ui.Widget",o);b.ClassUtils.regClass("Laya.Widget",o);class i extends b.Event{}i.SHOW_TIP="showtip";i.HIDE_TIP="hidetip";b.ILaya.regClass(i);b.ClassUtils.regClass("laya.ui.UIEvent",i);b.ClassUtils.regClass("Laya.UIEvent",i);class x{static fillArray(t,e,o=null){var i=t.concat();if(e){var a=e.split(",");for(var r=0,s=Math.min(i.length,a.length);r<s;r++){var n=a[r];i[r]=n=="true"?true:n=="false"?false:n;if(o!=null)i[r]=o(n)}}return i}static toColor(t){return b.Utils.toHexColor(t)}static gray(t,e=true){if(e){x.addFilter(t,x.grayFilter)}else{x.clearFilter(t,b.ColorFilter)}}static addFilter(t,e){var o=t.filters||[];o.push(e);t.filters=o}static clearFilter(t,e){var o=t.filters;if(o!=null&&o.length>0){for(var i=o.length-1;i>-1;i--){var a=o[i];if(a instanceof e)o.splice(i,1)}t.filters=o}}static _getReplaceStr(t){return x.escapeSequence[t]}static adptString(t){return t.replace(/\\(\w)/g,x._getReplaceStr)}static getBindFun(t){if(!x._funMap){x._funMap=new b.WeakObject}var e=x._funMap.get(t);if(e==null){var o='"'+t+'"';o=o.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"');var i="(function(data){if(data==null)return;with(data){try{\nreturn "+o+"\n}catch(e){}}})";e=window.Laya._runScript(i);x._funMap.set(t,e)}return e}}x.grayFilter=new b.ColorFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]);x.escapeSequence={"\\n":"\n","\\t":"\t"};x._funMap=null;b.ClassUtils.regClass("laya.ui.UIUtils",x);b.ClassUtils.regClass("Laya.UIUtils",x);class a extends b.Sprite{constructor(t=true){super();this._anchorX=NaN;this._anchorY=NaN;this._widget=o.EMPTY;if(t){this.preinitialize();this.createChildren();this.initialize()}}destroy(t=true){super.destroy(t);this._dataSource=null;this._tag=null;this._toolTip=null}preinitialize(){}createChildren(){}initialize(){}get width(){return this.get_width()}get_width(){if(this._width)return this._width;return this.measureWidth()}measureWidth(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var o=this.getChildAt(e);if(o._visible){t=Math.max(o._x+o.width*o.scaleX,t)}}return t}commitMeasure(){}get height(){return this.get_height()}get_height(){if(this._height)return this._height;return this.measureHeight()}measureHeight(){var t=0;this.commitMeasure();for(var e=this.numChildren-1;e>-1;e--){var o=this.getChildAt(e);if(o._visible){t=Math.max(o._y+o.height*o.scaleY,t)}}return t}get dataSource(){return this.get_dataSource()}get_dataSource(){return this._dataSource}set dataSource(t){this.set_dataSource(t)}set_dataSource(t){this._dataSource=t;for(var e in this._dataSource){if(e in this&&!(typeof this[e]=="function")){this[e]=this._dataSource[e]}}}get top(){return this.get_top()}get_top(){return this._widget.top}set top(t){this.set_top(t)}set_top(t){if(t!=this._widget.top){this._getWidget().top=t}}get bottom(){return this.get_bottom()}get_bottom(){return this._widget.bottom}set bottom(t){this.set_bottom(t)}set_bottom(t){if(t!=this._widget.bottom){this._getWidget().bottom=t}}get left(){return this._widget.left}set left(t){if(t!=this._widget.left){this._getWidget().left=t}}get right(){return this._widget.right}set right(t){if(t!=this._widget.right){this._getWidget().right=t}}get centerX(){return this._widget.centerX}set centerX(t){if(t!=this._widget.centerX){this._getWidget().centerX=t}}get centerY(){return this._widget.centerY}set centerY(t){if(t!=this._widget.centerY){this._getWidget().centerY=t}}_sizeChanged(){if(!isNaN(this._anchorX))this.pivotX=this.anchorX*this.width;if(!isNaN(this._anchorY))this.pivotY=this.anchorY*this.height;this.event(b.Event.RESIZE);if(this._widget!==o.EMPTY)this._widget.resetLayout()}get tag(){return this._tag}set tag(t){this._tag=t}get toolTip(){return this._toolTip}set toolTip(t){if(this._toolTip!=t){this._toolTip=t;if(t!=null){this.on(b.Event.MOUSE_OVER,this,this.onMouseOver);this.on(b.Event.MOUSE_OUT,this,this.onMouseOut)}else{this.off(b.Event.MOUSE_OVER,this,this.onMouseOver);this.off(b.Event.MOUSE_OUT,this,this.onMouseOut)}}}onMouseOver(t){b.ILaya.stage.event(i.SHOW_TIP,this._toolTip)}onMouseOut(t){b.ILaya.stage.event(i.HIDE_TIP,this._toolTip)}get gray(){return this._gray}set gray(t){if(t!==this._gray){this._gray=t;x.gray(this,t)}}get disabled(){return this._disabled}set disabled(t){if(t!==this._disabled){this.gray=this._disabled=t;this.mouseEnabled=!t}}_getWidget(){this._widget===o.EMPTY&&(this._widget=this.addComponent(o));return this._widget}set scaleX(t){this.set_scaleX(t)}set_scaleX(t){if(super.get_scaleX()==t)return;super.set_scaleX(t);this.event(b.Event.RESIZE)}get scaleX(){return super.scaleX}set scaleY(t){this.set_scaleY(t)}set_scaleY(t){if(super.get_scaleY()==t)return;super.set_scaleY(t);this.event(b.Event.RESIZE)}get scaleY(){return super.scaleY}onCompResize(){this._sizeChanged()}set width(t){this.set_width(t)}set_width(t){if(super.get_width()==t)return;super.set_width(t);this.callLater(this._sizeChanged)}set height(t){this.set_height(t)}set_height(t){if(super.get_height()==t)return;super.set_height(t);this.callLater(this._sizeChanged)}get anchorX(){return this.get_anchorX()}get_anchorX(){return this._anchorX}set anchorX(t){this.set_anchorX(t)}set_anchorX(t){if(this._anchorX!=t){this._anchorX=t;this.callLater(this._sizeChanged)}}get anchorY(){return this.get_anchorY()}get_anchorY(){return this._anchorY}set anchorY(t){this.set_anchorY(t)}set_anchorY(t){if(this._anchorY!=t){this._anchorY=t;this.callLater(this._sizeChanged)}}_childChanged(t=null){this.callLater(this._sizeChanged);super._childChanged(t)}}b.ILaya.regClass(a);b.ClassUtils.regClass("laya.ui.UIComponent",a);b.ClassUtils.regClass("Laya.UIComponent",a);class n extends a{constructor(t=null){super();this.skin=t}destroy(t=true){super.destroy(true);this._bitmap&&this._bitmap.destroy();this._bitmap=null}dispose(){this.destroy(true);b.ILaya.loader.clearRes(this._skin)}createChildren(){this.graphics=this._bitmap=new e;this._bitmap.autoCacheCmd=false}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(t){var e=b.Loader.getRes(t);if(e){this.source=e;this.onCompResize()}else b.ILaya.loader.load(this._skin,b.Handler.create(this,this.setSource,[this._skin]),null,b.Loader.IMAGE,1,true,this._group)}else{this.source=null}}}get source(){return this._bitmap.source}set source(t){if(!this._bitmap)return;this._bitmap.source=t;this.event(b.Event.LOADED);this.repaint()}get group(){return this._group}set group(t){if(t&&this._skin)b.Loader.setGroup(this._skin,t);this._group=t}setSource(t,e=null){if(t===this._skin&&e){this.source=e;this.onCompResize()}}measureWidth(){return this._bitmap.width}measureHeight(){return this._bitmap.height}set width(t){super.width=t;this._bitmap.width=t==0?1e-7:t}get width(){return super.width}set height(t){super.height=t;this._bitmap.height=t==0?1e-7:t}get height(){return super.height}get sizeGrid(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null}set sizeGrid(t){this._bitmap.sizeGrid=x.fillArray(s.defaultSizeGrid,t,Number)}set dataSource(t){this._dataSource=t;if(typeof t=="string")this.skin=t;else super.dataSource=t}get dataSource(){return super.dataSource}}b.ILaya.regClass(n);b.ClassUtils.regClass("laya.ui.Image",n);b.ClassUtils.regClass("Laya.Image",n);class G extends n{constructor(t=null){super();this.advsListArr=[];this.resUrl="https://unioncdn.layabox.com/config/iconlist.json";this._http=new b.Browser.window.XMLHttpRequest;this._data=[];this._resquestTime=36e4;this._playIndex=0;this._lunboTime=5e3;this.skin=t;this.setLoadUrl();this.init();this.size(120,120)}setLoadUrl(){}init(){if(this.isSupportJump()){if(b.Browser.onMiniGame||b.Browser.onBDMiniGame){b.ILaya.timer.loop(this._resquestTime,this,this.onGetAdvsListData)}this.onGetAdvsListData();this.initEvent()}else this.visible=false}initEvent(){this.on(b.Event.CLICK,this,this.onAdvsImgClick)}onAdvsImgClick(){var t=this.getCurrentAppidObj();if(t)this.jumptoGame()}revertAdvsData(){if(this.advsListArr[this._playIndex]){this.visible=true;this.skin=this.advsListArr[this._playIndex]}}isSupportJump(){if(b.Browser.onMiniGame){var t=window.wx.navigateToMiniProgram instanceof Function;return t}else if(b.Browser.onBDMiniGame)return true;return false}jumptoGame(){var t=this.advsListArr[this._playIndex];var e=parseInt(t.gameid);var o=t.extendInfo;var i=t.path;if(b.Browser.onMiniGame){if(this.isSupportJump()){window.wx.navigateToMiniProgram({appId:this._appid,path:"",extraData:"",envVersion:"release",success:function t(){console.log("-------------跳转成功--------------")},fail:function t(){console.log("-------------跳转失败--------------")},complete:function t(){console.log("-------------跳转接口调用成功--------------");this.updateAdvsInfo()}.bind(this)})}}else if(b.Browser.onBDMiniGame);else{this.visible=false}}updateAdvsInfo(){this.visible=false;this.onLunbo();b.ILaya.timer.loop(this._lunboTime,this,this.onLunbo)}onLunbo(){if(this._playIndex>=this.advsListArr.length-1)this._playIndex=0;else this._playIndex+=1;this.visible=true;this.revertAdvsData()}getCurrentAppidObj(){return this.advsListArr[this._playIndex]}onGetAdvsListData(){var e=this;var t=G.randRange(1e4,1e6);var o=this.resUrl+"?"+t;this._http.open("get",o,true);this._http.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this._http.responseType="text";this._http.onerror=function(t){e._onError(t)};this._http.onload=function(t){e._onLoad(t)};this._http.send(null)}static randRange(t,e){return Math.floor(Math.random()*(e-t+1))+t}_onError(t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}_onLoad(t){var e=this._http;var o=e.status!==undefined?e.status:200;if(o===200||o===204||o===0){this.complete()}else{this.error("["+e.status+"]"+e.statusText+":"+e.responseURL)}}error(t){this.event(b.Event.ERROR,t)}complete(){try{this._data=this._http.response||this._http.responseText;this._data=JSON.parse(this._data);this.advsListArr=this._data.list;this._appid=this._data.appid;this.updateAdvsInfo();this.revertAdvsData()}catch(t){this.error(t.message)}}getAdvsQArr(t){var e=[];var o=b.LocalStorage.getJSON("gameObj");for(var i in t){var a=t[i];if(o&&o[a.gameid]&&!a.isQiangZhi)continue;e.push(a)}return e}clear(){var t=this._http;t.onerror=t.onabort=t.onprogress=t.onload=null}destroy(t=true){b.ILaya.timer.clear(this,this.onLunbo);super.destroy(true);this.clear();b.ILaya.timer.clear(this,this.onGetAdvsListData)}}b.ClassUtils.regClass("laya.ui.AdvImage",G);b.ClassUtils.regClass("Laya.AdvImage",G);class d extends a{set dataSource(t){this._dataSource=t;for(var e in t){var o=this.getChildByName(e);if(o)o.dataSource=t[e];else if(e in this&&!(this[e]instanceof Function))this[e]=t[e]}}get dataSource(){return super.dataSource}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t;if(t){this._onResize(null);this.on(b.Event.RESIZE,this,this._onResize)}else{this.graphics.clear();this.off(b.Event.RESIZE,this,this._onResize)}}_onResize(t){this.graphics.clear();this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}b.ILaya.regClass(d);b.ClassUtils.regClass("laya.ui.Box",d);b.ClassUtils.regClass("Laya.Box",d);class l extends a{constructor(t=null,e=""){super();this._labelColors=s.buttonLabelColors;this._state=0;this._autoSize=true;this._stateNum=s.buttonStateNum;this._stateChanged=false;this.skin=t;this.label=e}destroy(t=true){super.destroy(t);this._bitmap&&this._bitmap.destroy();this._text&&this._text.destroy(t);this._bitmap=null;this._text=null;this._clickHandler=null;this._labelColors=this._sources=this._strokeColors=null}createChildren(){this.graphics=this._bitmap=new e}createText(){if(!this._text){this._text=new b.Text;this._text.overflow=b.Text.HIDDEN;this._text.align="center";this._text.valign="middle";this._text.width=this._width;this._text.height=this._height}}initialize(){if(this._mouseState!==1){this.mouseEnabled=true;this._setBit(b.Const.HAS_MOUSE,true)}this._createListener(b.Event.MOUSE_OVER,this,this.onMouse,null,false,false);this._createListener(b.Event.MOUSE_OUT,this,this.onMouse,null,false,false);this._createListener(b.Event.MOUSE_DOWN,this,this.onMouse,null,false,false);this._createListener(b.Event.MOUSE_UP,this,this.onMouse,null,false,false);this._createListener(b.Event.CLICK,this,this.onMouse,null,false,false)}onMouse(t){if(this.toggle===false&&this._selected)return;if(t.type===b.Event.CLICK){this.toggle&&(this.selected=!this._selected);this._clickHandler&&this._clickHandler.run();return}!this._selected&&(this.state=l.stateMap[t.type])}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(t){if(!b.Loader.getRes(t)){b.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1)}else{this._skinLoaded()}}else{this._skinLoaded()}}}_skinLoaded(){this.callLater(this.changeClips);this._setStateChanged();this._sizeChanged();this.event(b.Event.LOADED)}get stateNum(){return this._stateNum}set stateNum(t){if(typeof t=="string"){t=parseInt(t)}if(this._stateNum!=t){this._stateNum=t<1?1:t>3?3:t;this.callLater(this.changeClips)}}changeClips(){var t=b.Loader.getRes(this._skin);if(!t){console.log("lose skin",this._skin);return}var e=t.sourceWidth;var o=t.sourceHeight/this._stateNum;t.$_GID||(t.$_GID=b.Utils.getGID());var i=t.$_GID+"-"+this._stateNum;var a=b.WeakObject.I.get(i);if(!b.Utils.isOkTextureList(a)){a=null}if(a)this._sources=a;else{this._sources=[];if(this._stateNum===1){this._sources.push(t)}else{for(var r=0;r<this._stateNum;r++){this._sources.push(b.Texture.createFromTexture(t,0,o*r,e,o))}}b.WeakObject.I.set(i,this._sources)}if(this._autoSize){this._bitmap.width=this._width||e;this._bitmap.height=this._height||o;if(this._text){this._text.width=this._bitmap.width;this._text.height=this._bitmap.height}}else{this._text&&(this._text.x=e)}}measureWidth(){this.runCallLater(this.changeClips);if(this._autoSize)return this._bitmap.width;this.runCallLater(this.changeState);return this._bitmap.width+(this._text?this._text.width:0)}measureHeight(){this.runCallLater(this.changeClips);return this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}get label(){return this._text?this._text.text:null}set label(t){if(!this._text&&!t)return;this.createText();if(this._text.text!=t){t&&!this._text.parent&&this.addChild(this._text);this._text.text=(t+"").replace(/\\n/g,"\n");this._setStateChanged()}}get selected(){return this._selected}set selected(t){if(this._selected!=t){this._selected=t;this.state=this._selected?2:0;this.event(b.Event.CHANGE)}}get state(){return this._state}set state(t){if(this._state!=t){this._state=t;this._setStateChanged()}}changeState(){this._stateChanged=false;this.runCallLater(this.changeClips);var t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[t]);if(this.label){this._text.color=this._labelColors[t];if(this._strokeColors)this._text.strokeColor=this._strokeColors[t]}}get labelColors(){return this._labelColors.join(",")}set labelColors(t){this._labelColors=x.fillArray(s.buttonLabelColors,t,String);this._setStateChanged()}get strokeColors(){return this._strokeColors?this._strokeColors.join(","):""}set strokeColors(t){this._strokeColors=x.fillArray(s.buttonLabelColors,t,String);this._setStateChanged()}get labelPadding(){this.createText();return this._text.padding.join(",")}set labelPadding(t){this.createText();this._text.padding=x.fillArray(s.labelPadding,t,Number)}get labelSize(){this.createText();return this._text.fontSize}set labelSize(t){this.createText();this._text.fontSize=t}get labelStroke(){this.createText();return this._text.stroke}set labelStroke(t){this.createText();this._text.stroke=t}get labelStrokeColor(){this.createText();return this._text.strokeColor}set labelStrokeColor(t){this.createText();this._text.strokeColor=t}get labelBold(){this.createText();return this._text.bold}set labelBold(t){this.createText();this._text.bold=t}get labelFont(){this.createText();return this._text.font}set labelFont(t){this.createText();this._text.font=t}get labelAlign(){this.createText();return this._text.align}set labelAlign(t){this.createText();this._text.align=t}get clickHandler(){return this._clickHandler}set clickHandler(t){this._clickHandler=t}get text(){this.createText();return this._text}get sizeGrid(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null}set sizeGrid(t){this._bitmap.sizeGrid=x.fillArray(s.defaultSizeGrid,t,Number)}set width(t){super.set_width(t);if(this._autoSize){this._bitmap.width=t;this._text&&(this._text.width=t)}}get width(){return super.get_width()}set height(t){super.set_height(t);if(this._autoSize){this._bitmap.height=t;this._text&&(this._text.height=t)}}get height(){return super.get_height()}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.label=t+"";else super.set_dataSource(t)}get dataSource(){return super.get_dataSource()}get iconOffset(){return this._bitmap._offset?this._bitmap._offset.join(","):null}set iconOffset(t){if(t)this._bitmap._offset=x.fillArray([1,1],t,Number);else this._bitmap._offset=[]}_setStateChanged(){if(!this._stateChanged){this._stateChanged=true;this.callLater(this.changeState)}}}l.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0};b.ILaya.regClass(l);b.ClassUtils.regClass("laya.ui.Button",l);b.ClassUtils.regClass("Laya.Button",l);class _ extends l{constructor(t=null,e=""){super(t,e);this.toggle=true;this._autoSize=false}preinitialize(){super.preinitialize();this.toggle=true;this._autoSize=false}initialize(){super.initialize();this.createText();this._text.align="left";this._text.valign="top";this._text.width=0}set dataSource(t){this._dataSource=t;if(t instanceof Boolean)this.selected=t;else if(typeof t=="string")this.selected=t==="true";else super.dataSource=t}get dataSource(){return super.dataSource}}b.ILaya.regClass(_);b.ClassUtils.regClass("laya.ui.CheckBox",_);b.ClassUtils.regClass("Laya.CheckBox",_);class h extends a{constructor(t=null,e=1,o=1){super();this._clipX=1;this._clipY=1;this._clipWidth=0;this._clipHeight=0;this._interval=50;this._index=0;this._toIndex=-1;this._clipX=e;this._clipY=o;this.skin=t}destroy(t=true){super.destroy(true);this._bitmap&&this._bitmap.destroy();this._bitmap=null;this._sources=null}dispose(){this.destroy(true);b.ILaya.loader.clearRes(this._skin)}createChildren(){this.graphics=this._bitmap=new e}_onDisplay(t){if(this._isPlaying){if(this._getBit(b.Const.DISPLAYED_INSTAGE))this.play();else this.stop()}else if(this._autoPlay){this.play()}}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(t){if(!b.Loader.getRes(t)){b.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1)}else{this._skinLoaded()}}else{this._bitmap.source=null}}}_skinLoaded(){this._setClipChanged();this._sizeChanged();this.event(b.Event.LOADED)}get clipX(){return this._clipX}set clipX(t){this._clipX=t||1;this._setClipChanged()}get clipY(){return this._clipY}set clipY(t){this._clipY=t||1;this._setClipChanged()}get clipWidth(){return this._clipWidth}set clipWidth(t){this._clipWidth=t;this._setClipChanged()}get clipHeight(){return this._clipHeight}set clipHeight(t){this._clipHeight=t;this._setClipChanged()}changeClip(){this._clipChanged=false;if(!this._skin)return;var t=b.Loader.getRes(this._skin);if(t){this.loadComplete(this._skin,t)}else{b.ILaya.loader.load(this._skin,b.Handler.create(this,this.loadComplete,[this._skin]))}}loadComplete(t,e){if(t===this._skin&&e){var o=this._clipWidth||Math.ceil(e.sourceWidth/this._clipX);var i=this._clipHeight||Math.ceil(e.sourceHeight/this._clipY);var a=this._skin+o+i;var r=b.WeakObject.I.get(a);if(!b.Utils.isOkTextureList(r)){r=null}if(r)this._sources=r;else{this._sources=[];for(var s=0;s<this._clipY;s++){for(var n=0;n<this._clipX;n++){this._sources.push(b.Texture.createFromTexture(e,o*n,i*s,o,i))}}b.WeakObject.I.set(a,this._sources)}this.index=this._index;this.event(b.Event.LOADED);this.onCompResize()}}get sources(){return this._sources}set sources(t){this._sources=t;this.index=this._index;this.event(b.Event.LOADED)}get group(){return this._group}set group(t){if(t&&this._skin)b.Loader.setGroup(this._skin,t);this._group=t}set width(t){super.width=t;this._bitmap.width=t}get width(){return super.width}set height(t){super.height=t;this._bitmap.height=t}get height(){return super.height}measureWidth(){this.runCallLater(this.changeClip);return this._bitmap.width}measureHeight(){this.runCallLater(this.changeClip);return this._bitmap.height}get sizeGrid(){if(this._bitmap.sizeGrid)return this._bitmap.sizeGrid.join(",");return null}set sizeGrid(t){this._bitmap.sizeGrid=x.fillArray(s.defaultSizeGrid,t,Number)}get index(){return this._index}set index(t){this._index=t;this._bitmap&&this._sources&&(this._bitmap.source=this._sources[t]);this.event(b.Event.CHANGE)}get total(){this.runCallLater(this.changeClip);return this._sources?this._sources.length:0}get autoPlay(){return this._autoPlay}set autoPlay(t){if(this._autoPlay!=t){this._autoPlay=t;t?this.play():this.stop()}}get interval(){return this._interval}set interval(t){if(this._interval!=t){this._interval=t;if(this._isPlaying)this.play()}}get isPlaying(){return this._isPlaying}set isPlaying(t){this._isPlaying=t}play(t=0,e=-1){this._isPlaying=true;this.index=t;this._toIndex=e;this._index++;b.ILaya.timer.loop(this.interval,this,this._loop);this.on(b.Event.DISPLAY,this,this._onDisplay);this.on(b.Event.UNDISPLAY,this,this._onDisplay)}_loop(){if(this._visible&&this._sources){this._index++;if(this._toIndex>-1&&this._index>=this._toIndex)this.stop();else if(this._index>=this._sources.length)this._index=0;this.index=this._index}}stop(){this._isPlaying=false;b.ILaya.timer.clear(this,this._loop);this.event(b.Event.COMPLETE)}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.index=parseInt(t);else super.dataSource=t}get dataSource(){return super.dataSource}get bitmap(){return this._bitmap}_setClipChanged(){if(!this._clipChanged){this._clipChanged=true;this.callLater(this.changeClip)}}}b.ILaya.regClass(h);b.ClassUtils.regClass("laya.ui.Clip",h);b.ClassUtils.regClass("Laya.Clip",h);class p extends a{constructor(){super(...arguments);this._gridSize=11;this._bgColor="#ffffff";this._borderColor="#000000";this._inputColor="#000000";this._inputBgColor="#efefef";this._colors=[];this._selectedColor="#000000"}destroy(t=true){super.destroy(t);this._colorPanel&&this._colorPanel.destroy(t);this._colorButton&&this._colorButton.destroy(t);this._colorPanel=null;this._colorTiles=null;this._colorBlock=null;this._colorInput=null;this._colorButton=null;this._colors=null;this.changeHandler=null}createChildren(){this.addChild(this._colorButton=new l);this._colorPanel=new d;this._colorPanel.size(230,166);this._colorPanel.addChild(this._colorTiles=new b.Sprite);this._colorPanel.addChild(this._colorBlock=new b.Sprite);this._colorPanel.addChild(this._colorInput=new b.Input)}initialize(){this._colorButton.on(b.Event.CLICK,this,this.onColorButtonClick);this._colorBlock.pos(5,5);this._colorInput.pos(60,5);this._colorInput.size(60,20);this._colorInput.on(b.Event.CHANGE,this,this.onColorInputChange);this._colorInput.on(b.Event.KEY_DOWN,this,this.onColorFieldKeyDown);this._colorTiles.pos(5,30);this._colorTiles.on(b.Event.MOUSE_MOVE,this,this.onColorTilesMouseMove);this._colorTiles.on(b.Event.CLICK,this,this.onColorTilesClick);this._colorTiles.size(20*this._gridSize,12*this._gridSize);this._colorPanel.on(b.Event.MOUSE_DOWN,this,this.onPanelMouseDown);this.bgColor=this._bgColor}onPanelMouseDown(t){t.stopPropagation()}changePanel(){this._panelChanged=false;var t=this._colorPanel.graphics;t.clear(true);t.drawRect(0,0,230,166,this._bgColor,this._borderColor);this.drawBlock(this._selectedColor);this._colorInput.borderColor=this._borderColor;this._colorInput.bgColor=this._inputBgColor;this._colorInput.color=this._inputColor;t=this._colorTiles.graphics;t.clear(true);var e=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935];for(var o=0;o<12;o++){for(var i=0;i<20;i++){var a;if(i===0)a=e[o];else if(i===1)a=0;else a=(((o*3+i/6)%3<<0)+(o/6<<0)*3)*51<<16|i%6*51<<8|(o<<0)%6*51;var r=x.toColor(a);this._colors.push(r);var s=i*this._gridSize;var n=o*this._gridSize;t.drawRect(s,n,this._gridSize,this._gridSize,r,"#000000")}}}onColorButtonClick(t){if(this._colorPanel.parent)this.close();else this.open()}open(){let t=b.ILaya.stage;var e=this.localToGlobal(new b.Point);var o=e.x+this._colorPanel.width<=t.width?e.x:t.width-this._colorPanel.width;var i=e.y+this._colorButton.height;i=i+this._colorPanel.height<=t.height?i:e.y-this._colorPanel.height;this._colorPanel.pos(o,i);this._colorPanel.zOrder=1001;t.addChild(this._colorPanel);t.on(b.Event.MOUSE_DOWN,this,this.removeColorBox)}close(){b.ILaya.stage.off(b.Event.MOUSE_DOWN,this,this.removeColorBox);this._colorPanel.removeSelf()}removeColorBox(t=null){this.close()}onColorFieldKeyDown(t){if(t.keyCode==13){if(this._colorInput.text)this.selectedColor=this._colorInput.text;else this.selectedColor=null;this.close();t.stopPropagation()}}onColorInputChange(t=null){if(this._colorInput.text)this.drawBlock(this._colorInput.text);else this.drawBlock("#FFFFFF")}onColorTilesClick(t){this.selectedColor=this.getColorByMouse();this.close()}onColorTilesMouseMove(t){this._colorInput.focus=false;var e=this.getColorByMouse();this._colorInput.text=e;this.drawBlock(e)}getColorByMouse(){var t=this._colorTiles.getMousePoint();var e=Math.floor(t.x/this._gridSize);var o=Math.floor(t.y/this._gridSize);return this._colors[o*20+e]}drawBlock(t){var e=this._colorBlock.graphics;e.clear(true);var o=t?t:"#ffffff";e.drawRect(0,0,50,20,o,this._borderColor);t||e.drawLine(0,0,50,20,"#ff0000")}get selectedColor(){return this._selectedColor}set selectedColor(t){if(this._selectedColor!=t){this._selectedColor=this._colorInput.text=t;this.drawBlock(t);this.changeColor();this.changeHandler&&this.changeHandler.runWith(this._selectedColor);this.event(b.Event.CHANGE,b.Event.EMPTY.setTo(b.Event.CHANGE,this,this))}}get skin(){return this._colorButton.skin}set skin(t){this._colorButton.once(b.Event.LOADED,this,this.changeColor);this._colorButton.skin=t}changeColor(){var t=this.graphics;t.clear(true);var e=this._selectedColor||"#000000";t.drawRect(0,0,this._colorButton.width,this._colorButton.height,e)}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t;this._setPanelChanged()}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t;this._setPanelChanged()}get inputColor(){return this._inputColor}set inputColor(t){this._inputColor=t;this._setPanelChanged()}get inputBgColor(){return this._inputBgColor}set inputBgColor(t){this._inputBgColor=t;this._setPanelChanged()}_setPanelChanged(){if(!this._panelChanged){this._panelChanged=true;this.callLater(this.changePanel)}}}b.ILaya.regClass(p);b.ClassUtils.regClass("laya.ui.ColorPicker",p);b.ClassUtils.regClass("Laya.ColorPicker",p);class c extends a{constructor(t=""){super();this.text=t}destroy(t=true){super.destroy(t);this._tf=null}createChildren(){this.addChild(this._tf=new b.Text)}get text(){return this._tf.text}set text(t){if(this._tf.text!=t){if(t)t=x.adptString(t+"");this._tf.text=t;this.event(b.Event.CHANGE);if(!this._width||!this._height)this.onCompResize()}}changeText(t){this._tf.changeText(t)}get wordWrap(){return this._tf.wordWrap}set wordWrap(t){this._tf.wordWrap=t}get color(){return this._tf.color}set color(t){this._tf.color=t}get font(){return this._tf.font}set font(t){this._tf.font=t}get align(){return this._tf.align}set align(t){this._tf.align=t}get valign(){return this._tf.valign}set valign(t){this._tf.valign=t}get bold(){return this._tf.bold}set bold(t){this._tf.bold=t}get italic(){return this._tf.italic}set italic(t){this._tf.italic=t}get leading(){return this._tf.leading}set leading(t){this._tf.leading=t}get fontSize(){return this._tf.fontSize}set fontSize(t){this._tf.fontSize=t}get padding(){return this._tf.padding.join(",")}set padding(t){this._tf.padding=x.fillArray(s.labelPadding,t,Number)}get bgColor(){return this._tf.bgColor}set bgColor(t){this._tf.bgColor=t}get borderColor(){return this._tf.borderColor}set borderColor(t){this._tf.borderColor=t}get stroke(){return this._tf.stroke}set stroke(t){this._tf.stroke=t}get strokeColor(){return this._tf.strokeColor}set strokeColor(t){this._tf.strokeColor=t}get textField(){return this._tf}measureWidth(){return this._tf.width}measureHeight(){return this._tf.height}get width(){if(this._width||this._tf.text)return super.width;return 0}set width(t){super.width=t;this._tf.width=t}get height(){if(this._height||this._tf.text)return super.height;return 0}set height(t){super.height=t;this._tf.height=t}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.text=t+"";else super.dataSource=t}get dataSource(){return super.dataSource}get overflow(){return this._tf.overflow}set overflow(t){this._tf.overflow=t}get underline(){return this._tf.underline}set underline(t){this._tf.underline=t}get underlineColor(){return this._tf.underlineColor}set underlineColor(t){this._tf.underlineColor=t}}b.ILaya.regClass(c);b.ClassUtils.regClass("laya.ui.Label",c);b.ClassUtils.regClass("Laya.Label",c);class u extends a{constructor(t=null){super();this.isVertical=true;this.showLabel=true;this._max=100;this._min=0;this._tick=1;this._value=0;if(!u.label){u.label=new c}this.skin=t}destroy(t=true){super.destroy(t);this._bg&&this._bg.destroy(t);this._bar&&this._bar.destroy(t);this._progress&&this._progress.destroy(t);this._bg=null;this._bar=null;this._progress=null;this.changeHandler=null}createChildren(){this.addChild(this._bg=new n);this.addChild(this._bar=new l)}initialize(){this._bar.on(b.Event.MOUSE_DOWN,this,this.onBarMouseDown);this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0";if(this._progress)this._progress.sizeGrid=this._bar.sizeGrid;this.allowClickBack=true}onBarMouseDown(t){var e=b.ILaya;this._globalSacle||(this._globalSacle=new b.Point);this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01);this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width;this._tx=e.stage.mouseX;this._ty=e.stage.mouseY;e.stage.on(b.Event.MOUSE_MOVE,this,this.mouseMove);e.stage.once(b.Event.MOUSE_UP,this,this.mouseUp);e.stage.once(b.Event.MOUSE_OUT,this,this.mouseUp);this.showValueText()}showValueText(){if(this.showLabel){var t=u.label;this.addChild(t);t.textField.changeText(this._value+"");if(this.isVertical){t.x=this._bar._x+20;t.y=(this._bar.height-t.height)*.5+this._bar._y}else{t.y=this._bar._y-20;t.x=(this._bar.width-t.width)*.5+this._bar._x}}}hideValueText(){u.label&&u.label.removeSelf()}mouseUp(t){let e=b.ILaya.stage;e.off(b.Event.MOUSE_MOVE,this,this.mouseMove);e.off(b.Event.MOUSE_UP,this,this.mouseUp);e.off(b.Event.MOUSE_OUT,this,this.mouseUp);this.sendChangeEvent(b.Event.CHANGED);this.hideValueText()}mouseMove(t){let e=b.ILaya.stage;var o=this._value;if(this.isVertical){this._bar.y+=(e.mouseY-this._ty)/this._globalSacle.y;if(this._bar._y>this._maxMove)this._bar.y=this._maxMove;else if(this._bar._y<0)this._bar.y=0;this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min;if(this._progress)this._progress.height=this._bar._y+.5*this._bar.height}else{this._bar.x+=(e.mouseX-this._tx)/this._globalSacle.x;if(this._bar._x>this._maxMove)this._bar.x=this._maxMove;else if(this._bar._x<0)this._bar.x=0;this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min;if(this._progress)this._progress.width=this._bar._x+.5*this._bar.width}this._tx=e.mouseX;this._ty=e.mouseY;if(this._tick!=0){var i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*i)/i}if(this._value!=o){this.sendChangeEvent()}this.showValueText()}sendChangeEvent(t=b.Event.CHANGE){this.event(t);this.changeHandler&&this.changeHandler.runWith(this._value)}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(this._skin&&!b.Loader.getRes(this._skin)){b.ILaya.loader.load([this._skin,this._skin.replace(".png","$bar.png")],b.Handler.create(this,this._skinLoaded))}else{this._skinLoaded()}}}_skinLoaded(){this._bg.skin=this._skin;this._bar.skin=this._skin.replace(".png","$bar.png");var t=this._skin.replace(".png","$progress.png");if(b.Loader.getRes(t)){if(!this._progress){this.addChild(this._progress=new n);this._progress.sizeGrid=this._bar.sizeGrid;this.setChildIndex(this._progress,1)}this._progress.skin=t}this.setBarPoint();this.callLater(this.changeValue);this._sizeChanged();this.event(b.Event.LOADED)}setBarPoint(){if(this.isVertical)this._bar.x=Math.round((this._bg.width-this._bar.width)*.5);else this._bar.y=Math.round((this._bg.height-this._bar.height)*.5)}measureWidth(){return Math.max(this._bg.width,this._bar.width)}measureHeight(){return Math.max(this._bg.height,this._bar.height)}_sizeChanged(){super._sizeChanged();if(this.isVertical)this._bg.height=this.height;else this._bg.width=this.width;this.setBarPoint();this.changeValue()}get sizeGrid(){return this._bg.sizeGrid}set sizeGrid(t){this._bg.sizeGrid=t;this._bar.sizeGrid=t;if(this._progress)this._progress.sizeGrid=this._bar.sizeGrid}setSlider(t,e,o){this._value=-1;this._min=t;this._max=e>t?e:t;this.value=o<t?t:o>e?e:o}get tick(){return this._tick}set tick(t){if(this._tick!=t){this._tick=t;this.callLater(this.changeValue)}}changeValue(){if(this.tick!=0){var t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t}this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var e=this._max-this._min;if(e===0)e=1;if(this.isVertical){this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height);if(this._progress)this._progress.height=this._bar._y+.5*this._bar.height}else{this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width);if(this._progress)this._progress.width=this._bar._x+.5*this._bar.width}}get max(){return this._max}set max(t){if(this._max!=t){this._max=t;this.callLater(this.changeValue)}}get min(){return this._min}set min(t){if(this._min!=t){this._min=t;this.callLater(this.changeValue)}}get value(){return this._value}set value(t){if(this._value!=t){var e=this._value;this._value=t;this.changeValue();if(this._value!=e){this.sendChangeEvent()}}}get allowClickBack(){return this._allowClickBack}set allowClickBack(t){if(this._allowClickBack!=t){this._allowClickBack=t;if(t)this._bg.on(b.Event.MOUSE_DOWN,this,this.onBgMouseDown);else this._bg.off(b.Event.MOUSE_DOWN,this,this.onBgMouseDown)}}onBgMouseDown(t){var e=this._bg.getMousePoint();if(this.isVertical)this.value=e.y/(this.height-this._bar.height)*(this._max-this._min)+this._min;else this.value=e.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else super.dataSource=t}get dataSource(){return super.dataSource}get bar(){return this._bar}}u.label=null;b.ILaya.regClass(u);b.ClassUtils.regClass("laya.ui.Slider",u);b.ClassUtils.regClass("Laya.Slider",u);class y extends a{constructor(t=null){super();this.rollRatio=.97;this.scaleBar=true;this.autoHide=false;this.elasticDistance=0;this.elasticBackTime=500;this._showButtons=r.showButtons;this._scrollSize=1;this._thumbPercent=1;this._lastOffset=0;this._checkElastic=false;this._isElastic=false;this._hide=false;this._clickOnly=true;this._touchScrollEnable=r.touchScrollEnable;this._mouseWheelEnable=r.mouseWheelEnable;this.skin=t;this.max=1}destroy(t=true){this.stopScroll();this.target=null;super.destroy(t);this.upButton&&this.upButton.destroy(t);this.downButton&&this.downButton.destroy(t);this.slider&&this.slider.destroy(t);this.upButton=this.downButton=null;this.slider=null;this.changeHandler=null;this._offsets=null}createChildren(){this.addChild(this.slider=new u);this.addChild(this.upButton=new l);this.addChild(this.downButton=new l)}initialize(){this.slider.showLabel=false;this.slider.tick=0;this.slider.on(b.Event.CHANGE,this,this.onSliderChange);this.slider.setSlider(0,0,0);this.upButton.on(b.Event.MOUSE_DOWN,this,this.onButtonMouseDown);this.downButton.on(b.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}onSliderChange(){if(this._value!=this.slider.value)this.value=this.slider.value}onButtonMouseDown(t){var e=t.currentTarget===this.upButton;this.slide(e);b.ILaya.timer.once(s.scrollBarDelayTime,this,this.startLoop,[e]);b.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp)}startLoop(t){b.ILaya.timer.frameLoop(1,this,this.slide,[t])}slide(t){if(t)this.value-=this._scrollSize;else this.value+=this._scrollSize}onStageMouseUp(t){b.ILaya.timer.clear(this,this.startLoop);b.ILaya.timer.clear(this,this.slide)}get skin(){return this._skin}set skin(t){if(t==" ")return;if(this._skin!=t){this._skin=t;if(this._skin&&!b.Loader.getRes(this._skin)){b.ILaya.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],b.Handler.create(this,this._skinLoaded))}else{this._skinLoaded()}}}_skinLoaded(){this.slider.skin=this._skin;this.callLater(this.changeScrollBar);this._sizeChanged();this.event(b.Event.LOADED)}changeScrollBar(){this.upButton.visible=this._showButtons;this.downButton.visible=this._showButtons;if(this._showButtons){this.upButton.skin=this._skin.replace(".png","$up.png");this.downButton.skin=this._skin.replace(".png","$down.png")}if(this.slider.isVertical)this.slider.y=this._showButtons?this.upButton.height:0;else this.slider.x=this._showButtons?this.upButton.width:0;this.resetPositions();this.repaint()}_sizeChanged(){super._sizeChanged();this.repaint();this.resetPositions();this.event(b.Event.CHANGE);this.changeHandler&&this.changeHandler.runWith(this.value)}resetPositions(){if(this.slider.isVertical)this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0);else this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0);this.resetButtonPosition()}resetButtonPosition(){if(this.slider.isVertical)this.downButton.y=this.slider._y+this.slider.height;else this.downButton.x=this.slider._x+this.slider.width}measureWidth(){if(this.slider.isVertical)return this.slider.width;return 100}measureHeight(){if(this.slider.isVertical)return 100;return this.slider.height}setScroll(t,e,o){this.runCallLater(this._sizeChanged);this.slider.setSlider(t,e,o);this.slider.bar.visible=e>0;if(!this._hide&&this.autoHide)this.visible=false}get max(){return this.slider.max}set max(t){this.slider.max=t}get min(){return this.slider.min}set min(t){this.slider.min=t}get value(){return this._value}set value(t){if(t!==this._value){this._value=t;if(!this._isElastic){if(this.slider["_value"]!=t){this.slider["_value"]=t;this.slider.changeValue()}this._value=this.slider["_value"]}this.event(b.Event.CHANGE);this.changeHandler&&this.changeHandler.runWith(this._value)}}get isVertical(){return this.slider.isVertical}set isVertical(t){this.slider.isVertical=t}get sizeGrid(){return this.slider.sizeGrid}set sizeGrid(t){this.slider.sizeGrid=t}get scrollSize(){return this._scrollSize}set scrollSize(t){this._scrollSize=t}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else super.dataSource=t}get dataSource(){return super.dataSource}get thumbPercent(){return this._thumbPercent}set thumbPercent(t){this.runCallLater(this.changeScrollBar);this.runCallLater(this._sizeChanged);t=t>=1?.99:t;this._thumbPercent=t;if(this.scaleBar){if(this.slider.isVertical)this.slider.bar.height=Math.max(this.slider.height*t,s.scrollBarMinNum);else this.slider.bar.width=Math.max(this.slider.width*t,s.scrollBarMinNum)}}get target(){return this._target}set target(t){if(this._target){this._target.off(b.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel);this._target.off(b.Event.MOUSE_DOWN,this,this.onTargetMouseDown)}this._target=t;if(t){this._mouseWheelEnable&&this._target.on(b.Event.MOUSE_WHEEL,this,this.onTargetMouseWheel);this._touchScrollEnable&&this._target.on(b.Event.MOUSE_DOWN,this,this.onTargetMouseDown)}}get hide(){return this._hide}set hide(t){this._hide=t;this.visible=!t}get showButtons(){return this._showButtons}set showButtons(t){this._showButtons=t;this.callLater(this.changeScrollBar)}get touchScrollEnable(){return this._touchScrollEnable}set touchScrollEnable(t){this._touchScrollEnable=t;this.target=this._target}get mouseWheelEnable(){return this._mouseWheelEnable}set mouseWheelEnable(t){this._mouseWheelEnable=t;this.target=this._target}onTargetMouseWheel(t){this.value-=t.delta*this._scrollSize;this.target=this._target}onTargetMouseDown(t){if(this.isLockedFun&&!this.isLockedFun(t))return;this.event(b.Event.END);this._clickOnly=true;this._lastOffset=0;this._checkElastic=false;this._lastPoint||(this._lastPoint=new b.Point);this._lastPoint.setTo(b.ILaya.stage.mouseX,b.ILaya.stage.mouseY);b.ILaya.timer.clear(this,this.tweenMove);b.Tween.clearTween(this);b.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp2);b.ILaya.stage.once(b.Event.MOUSE_OUT,this,this.onStageMouseUp2);b.ILaya.timer.frameLoop(1,this,this.loop)}startDragForce(){this._clickOnly=true;this._lastOffset=0;this._checkElastic=false;this._lastPoint||(this._lastPoint=new b.Point);this._lastPoint.setTo(b.ILaya.stage.mouseX,b.ILaya.stage.mouseY);b.ILaya.timer.clear(this,this.tweenMove);b.Tween.clearTween(this);b.ILaya.stage.once(b.Event.MOUSE_UP,this,this.onStageMouseUp2);b.ILaya.stage.once(b.Event.MOUSE_OUT,this,this.onStageMouseUp2);b.ILaya.timer.frameLoop(1,this,this.loop)}cancelDragOp(){b.ILaya.stage.off(b.Event.MOUSE_UP,this,this.onStageMouseUp2);b.ILaya.stage.off(b.Event.MOUSE_OUT,this,this.onStageMouseUp2);b.ILaya.timer.clear(this,this.tweenMove);b.ILaya.timer.clear(this,this.loop);this._target.mouseEnabled=true}checkTriggers(t=false){if(this.value>=0&&this.value-this._lastOffset<=0){if(this.triggerDownDragLimit&&this.triggerDownDragLimit(t)){this.cancelDragOp();this.value=0;return true}}if(this.value<=this.max&&this.value-this._lastOffset>=this.max){if(this.triggerUpDragLimit&&this.triggerUpDragLimit(t)){this.cancelDragOp();this.value=this.max;return true}}return false}get lastOffset(){return this._lastOffset}startTweenMoveForce(t){this._lastOffset=t;b.ILaya.timer.frameLoop(1,this,this.tweenMove,[200])}loop(){var t=b.ILaya.stage.mouseY;var e=b.ILaya.stage.mouseX;this._lastOffset=this.isVertical?t-this._lastPoint.y:e-this._lastPoint.x;if(this._clickOnly){if(Math.abs(this._lastOffset*(this.isVertical?b.ILaya.stage._canvasTransform.getScaleY():b.ILaya.stage._canvasTransform.getScaleX()))>1){this._clickOnly=false;if(this.checkTriggers())return;this._offsets||(this._offsets=[]);this._offsets.length=0;this._target.mouseEnabled=false;if(!this.hide&&this.autoHide){this.alpha=1;this.visible=true}this.event(b.Event.START)}else return}else{if(this.checkTriggers())return}this._offsets.push(this._lastOffset);this._lastPoint.x=e;this._lastPoint.y=t;if(this._lastOffset===0)return;if(!this._checkElastic){if(this.elasticDistance>0){if(!this._checkElastic&&this._lastOffset!=0){if(this._lastOffset>0&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max){this._isElastic=true;this._checkElastic=true}else{this._isElastic=false}}}else{this._checkElastic=true}}if(this._isElastic){if(this._value<=this.min){if(this._lastOffset>0){this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance)}else{this.value-=this._lastOffset*.5;if(this._value>=this.min)this._checkElastic=false}}else if(this._value>=this.max){if(this._lastOffset<0){this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)}else{this.value-=this._lastOffset*.5;if(this._value<=this.max)this._checkElastic=false}}}else{this.value-=this._lastOffset}}onStageMouseUp2(t){b.ILaya.stage.off(b.Event.MOUSE_UP,this,this.onStageMouseUp2);b.ILaya.stage.off(b.Event.MOUSE_OUT,this,this.onStageMouseUp2);b.ILaya.timer.clear(this,this.loop);if(this._clickOnly){if(this._value>=this.min&&this._value<=this.max)return}this._target.mouseEnabled=true;if(this._isElastic){if(this._value<this.min){b.Tween.to(this,{value:this.min},this.elasticBackTime,b.Ease.sineOut,b.Handler.create(this,this.elasticOver))}else if(this._value>this.max){b.Tween.to(this,{value:this.max},this.elasticBackTime,b.Ease.sineOut,b.Handler.create(this,this.elasticOver))}}else{if(!this._offsets)return;if(this._offsets.length<1){this._offsets[0]=this.isVertical?b.ILaya.stage.mouseY-this._lastPoint.y:b.ILaya.stage.mouseX-this._lastPoint.x}var e=0;var o=Math.min(this._offsets.length,3);for(var i=0;i<o;i++){e+=this._offsets[this._offsets.length-1-i]}this._lastOffset=e/o;e=Math.abs(this._lastOffset);if(e<2){this.event(b.Event.END);return}if(e>250)this._lastOffset=this._lastOffset>0?250:-250;var a=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150)));b.ILaya.timer.frameLoop(1,this,this.tweenMove,[a])}}elasticOver(){this._isElastic=false;if(!this.hide&&this.autoHide){b.Tween.to(this,{alpha:0},500)}this.event(b.Event.END)}tweenMove(t){this._lastOffset*=this.rollRatio;if(this.checkTriggers(true)){return}var e;if(t>0){if(this._lastOffset>0&&this.value<=this.min){this._isElastic=true;e=-(this.min-t-this.value)*.5;if(this._lastOffset>e)this._lastOffset=e}else if(this._lastOffset<0&&this.value>=this.max){this._isElastic=true;e=-(this.max+t-this.value)*.5;if(this._lastOffset<e)this._lastOffset=e}}this.value-=this._lastOffset;if(Math.abs(this._lastOffset)<.1){b.ILaya.timer.clear(this,this.tweenMove);if(this._isElastic){if(this._value<this.min){b.Tween.to(this,{value:this.min},this.elasticBackTime,b.Ease.sineOut,b.Handler.create(this,this.elasticOver))}else if(this._value>this.max){b.Tween.to(this,{value:this.max},this.elasticBackTime,b.Ease.sineOut,b.Handler.create(this,this.elasticOver))}else{this.elasticOver()}return}this.event(b.Event.END);if(!this.hide&&this.autoHide){b.Tween.to(this,{alpha:0},500)}}}stopScroll(){this.onStageMouseUp2(null);b.ILaya.timer.clear(this,this.tweenMove);b.Tween.clearTween(this)}get tick(){return this.slider.tick}set tick(t){this.slider.tick=t}}b.ILaya.regClass(y);b.ClassUtils.regClass("laya.ui.ScrollBar",y);b.ClassUtils.regClass("Laya.ScrollBar",y);class m extends y{}b.ILaya.regClass(m);b.ClassUtils.regClass("laya.ui.VScrollBar",m);b.ClassUtils.regClass("Laya.VScrollBar",m);class f extends y{initialize(){super.initialize();this.slider.isVertical=false}}b.ILaya.regClass(f);b.ClassUtils.regClass("laya.ui.HScrollBar",f);b.ClassUtils.regClass("Laya.HScrollBar",f);class g extends d{constructor(){super(...arguments);this.selectEnable=false;this.totalPage=0;this._$componentType="List";this._repeatX=0;this._repeatY=0;this._repeatX2=0;this._repeatY2=0;this._spaceX=0;this._spaceY=0;this._cells=[];this._startIndex=0;this._selectedIndex=-1;this._page=0;this._isVertical=true;this._cellSize=20;this._cellOffset=0;this._createdLine=0;this._offset=new b.Point;this._usedCache=null;this._elasticEnabled=false;this._preLen=0}destroy(t=true){this._content&&this._content.destroy(t);this._scrollBar&&this._scrollBar.destroy(t);super.destroy(t);this._content=null;this._scrollBar=null;this._itemRender=null;this._cells=null;this._array=null;this.selectHandler=this.renderHandler=this.mouseHandler=null}createChildren(){this.addChild(this._content=new d)}set cacheAs(t){super.cacheAs=t;if(this._scrollBar){this._usedCache=null;if(t!=="none")this._scrollBar.on(b.Event.START,this,this.onScrollStart);else this._scrollBar.off(b.Event.START,this,this.onScrollStart)}}get cacheAs(){return super.cacheAs}onScrollStart(){this._usedCache||(this._usedCache=super.cacheAs);super.cacheAs="none";this._scrollBar.once(b.Event.END,this,this.onScrollEnd)}onScrollEnd(){super.cacheAs=this._usedCache}get content(){return this._content}get vScrollBarSkin(){return this._scrollBar?this._scrollBar.skin:null}set vScrollBarSkin(t){this._removePreScrollBar();var e=new m;e.name="scrollBar";e.right=0;e.skin=t;e.elasticDistance=this._elasticEnabled?200:0;this.scrollBar=e;this.addChild(e);this._setCellChanged()}_removePreScrollBar(){var t=this.removeChildByName("scrollBar");if(t)t.destroy(true)}get hScrollBarSkin(){return this._scrollBar?this._scrollBar.skin:null}set hScrollBarSkin(t){this._removePreScrollBar();var e=new f;e.name="scrollBar";e.bottom=0;e.skin=t;e.elasticDistance=this._elasticEnabled?200:0;this.scrollBar=e;this.addChild(e);this._setCellChanged()}get scrollBar(){return this._scrollBar}set scrollBar(t){if(this._scrollBar!=t){this._scrollBar=t;if(t){this._isVertical=this._scrollBar.isVertical;this.addChild(this._scrollBar);this._scrollBar.on(b.Event.CHANGE,this,this.onScrollBarChange)}}}get itemRender(){return this._itemRender}set itemRender(t){if(this._itemRender!=t){this._itemRender=t;for(var e=this._cells.length-1;e>-1;e--){this._cells[e].destroy()}this._cells.length=0;this._setCellChanged()}}set width(t){if(t!=this._width){super.width=t;this._setCellChanged()}}get width(){return super.width}set height(t){if(t!=this._height){super.height=t;this._setCellChanged()}}get height(){return super.height}get repeatX(){return this._repeatX>0?this._repeatX:this._repeatX2>0?this._repeatX2:1}set repeatX(t){this._repeatX=t;this._setCellChanged()}get repeatY(){return this._repeatY>0?this._repeatY:this._repeatY2>0?this._repeatY2:1}set repeatY(t){this._repeatY=t;this._setCellChanged()}get spaceX(){return this._spaceX}set spaceX(t){this._spaceX=t;this._setCellChanged()}get spaceY(){return this._spaceY}set spaceY(t){this._spaceY=t;this._setCellChanged()}changeCells(){this._cellChanged=false;if(this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var t=this._getOneCell();var e=t.width+this._spaceX||1;var o=t.height+this._spaceY||1;if(this._width>0)this._repeatX2=this._isVertical?Math.round(this._width/e):Math.ceil(this._width/e);if(this._height>0)this._repeatY2=this._isVertical?Math.ceil(this._height/o):Math.round(this._height/o);var i=this._width?this._width:e*this.repeatX-this._spaceX;var a=this._height?this._height:o*this.repeatY-this._spaceY;this._cellSize=this._isVertical?o:e;this._cellOffset=this._isVertical?o*Math.max(this._repeatY2,this._repeatY)-a-this._spaceY:e*Math.max(this._repeatX2,this._repeatX)-i-this._spaceX;if(this._isVertical&&this.vScrollBarSkin)this._scrollBar.height=a;else if(!this._isVertical&&this.hScrollBarSkin)this._scrollBar.width=i;this.setContentSize(i,a);var r=this._isVertical?this.repeatX:this.repeatY;var s=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r,s);this._createdLine=s;if(this._array){this.array=this._array;this.runCallLater(this.renderItems)}}}_getOneCell(){if(this._cells.length===0){var t=this.createItem();this._offset.setTo(t._x,t._y);if(this.cacheContent)return t;this._cells.push(t)}return this._cells[0]}_createItems(t,e,o){var i=this._content;var a=this._getOneCell();var r=a.width+this._spaceX;var s=a.height+this._spaceY;if(this.cacheContent){var n=new d;n.cacheAs="normal";n.pos((this._isVertical?0:t)*r,(this._isVertical?t:0)*s);this._content.addChild(n);i=n}else{var b=[];for(var x=this._cells.length-1;x>-1;x--){var l=this._cells[x];l.removeSelf();b.push(l)}this._cells.length=0}for(var _=t;_<o;_++){for(var h=0;h<e;h++){if(b&&b.length){a=b.pop()}else{a=this.createItem()}a.x=(this._isVertical?h:_)*r-i._x;a.y=(this._isVertical?_:h)*s-i._y;a.name="item"+(_*e+h);i.addChild(a);this.addCell(a)}}}createItem(){var t=[];if(typeof this._itemRender=="function"){var e=new this._itemRender}else{e=b.SceneUtils.createComp(this._itemRender,null,null,t)}if(t.length==0&&e["_watchMap"]){var o=e["_watchMap"];for(var i in o){var a=o[i];for(var r=0;r<a.length;r++){var s=a[r];t.push(s.comp,s.prop,s.value)}}}if(t.length)e["_$bindData"]=t;return e}addCell(t){t.on(b.Event.CLICK,this,this.onCellMouse);t.on(b.Event.RIGHT_CLICK,this,this.onCellMouse);t.on(b.Event.MOUSE_OVER,this,this.onCellMouse);t.on(b.Event.MOUSE_OUT,this,this.onCellMouse);t.on(b.Event.MOUSE_DOWN,this,this.onCellMouse);t.on(b.Event.MOUSE_UP,this,this.onCellMouse);this._cells.push(t)}_afterInited(){this.initItems()}initItems(){if(!this._itemRender&&this.getChildByName("item0")!=null){this.repeatX=1;var t;t=0;for(var e=0;e<1e4;e++){var o=this.getChildByName("item"+e);if(o){this.addCell(o);t++;continue}break}this.repeatY=t}}setContentSize(t,e){this._content.width=t;this._content.height=e;if(this._scrollBar||this._offset.x!=0||this._offset.y!=0){this._content._style.scrollRect||(this._content.scrollRect=b.Rectangle.create());this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,t,e);this._content.scrollRect=this._content.scrollRect}this.event(b.Event.RESIZE)}onCellMouse(t){if(t.type===b.Event.MOUSE_DOWN)this._isMoved=false;var e=t.currentTarget;var o=this._startIndex+this._cells.indexOf(e);if(o<0)return;if(t.type===b.Event.CLICK||t.type===b.Event.RIGHT_CLICK){if(this.selectEnable&&!this._isMoved)this.selectedIndex=o;else this.changeCellState(e,true,0)}else if((t.type===b.Event.MOUSE_OVER||t.type===b.Event.MOUSE_OUT)&&this._selectedIndex!==o){this.changeCellState(e,t.type===b.Event.MOUSE_OVER,0)}this.mouseHandler&&this.mouseHandler.runWith([t,o])}changeCellState(t,e,o){var i=t.getChildByName("selectBox");if(i){this.selectEnable=true;i.visible=e;i.index=o}}_sizeChanged(){super._sizeChanged();this.setContentSize(this.width,this.height);if(this._scrollBar)this.callLater(this.onScrollBarChange)}onScrollBarChange(t=null){this.runCallLater(this.changeCells);var e=this._scrollBar.value;var o=this._isVertical?this.repeatX:this.repeatY;var i=this._isVertical?this.repeatY:this.repeatX;var a=Math.floor(e/this._cellSize);if(!this.cacheContent){var r=a*o;var s=0;if(r>this._startIndex){s=r-this._startIndex;var n=true;var b=this._startIndex+o*(i+1);this._isMoved=true}else if(r<this._startIndex){s=this._startIndex-r;n=false;b=this._startIndex-1;this._isMoved=true}for(var x=0;x<s;x++){if(n){var l=this._cells.shift();this._cells[this._cells.length]=l;var _=b+x}else{l=this._cells.pop();this._cells.unshift(l);_=b-x}var h=Math.floor(_/o)*this._cellSize;this._isVertical?l.y=h:l.x=h;this.renderItem(l,_)}this._startIndex=r;this.changeSelectStatus()}else{s=i+1;if(this._createdLine-a<s){this._createItems(this._createdLine,o,this._createdLine+s);this.renderItems(this._createdLine*o,0);this._createdLine+=s}}var d=this._content._style.scrollRect;if(this._isVertical){d.y=e-this._offset.y;d.x=-this._offset.x}else{d.y=-this._offset.y;d.x=e-this._offset.x}this._content.scrollRect=d}posCell(t,e){if(!this._scrollBar)return;var o=this._isVertical?this.repeatX:this.repeatY;var i=this._isVertical?this.repeatY:this.repeatX;var a=Math.floor(e/o)*this._cellSize;this._isVertical?t._y=a:t.x=a}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if(this._selectedIndex!=t){this._selectedIndex=t;this.changeSelectStatus();this.event(b.Event.CHANGE);this.selectHandler&&this.selectHandler.runWith(t);this.startIndex=this._startIndex}}changeSelectStatus(){for(var t=0,e=this._cells.length;t<e;t++){this.changeCellState(this._cells[t],this._selectedIndex===this._startIndex+t,1)}}get selectedItem(){return this._selectedIndex!=-1?this._array[this._selectedIndex]:null}set selectedItem(t){this.selectedIndex=this._array.indexOf(t)}get selection(){return this.getCell(this._selectedIndex)}set selection(t){this.selectedIndex=this._startIndex+this._cells.indexOf(t)}get startIndex(){return this._startIndex}set startIndex(t){this._startIndex=t>0?t:0;this.callLater(this.renderItems)}renderItems(t=0,e=0){for(var o=t,i=e||this._cells.length;o<i;o++){this.renderItem(this._cells[o],this._startIndex+o)}this.changeSelectStatus()}renderItem(t,e){if(this._array&&e>=0&&e<this._array.length){t.visible=true;if(t["_$bindData"]){t["_dataSource"]=this._array[e];this._bindData(t,this._array[e])}else t.dataSource=this._array[e];if(!this.cacheContent){this.posCell(t,e)}if(this.hasListener(b.Event.RENDER))this.event(b.Event.RENDER,[t,e]);if(this.renderHandler)this.renderHandler.runWith([t,e])}else{t.visible=false;t.dataSource=null}}_bindData(t,e){var o=t._$bindData;for(var i=0,a=o.length;i<a;i++){var r=o[i++];var s=o[i++];var n=o[i];var b=x.getBindFun(n);r[s]=b.call(this,e)}}get array(){return this._array}set array(t){this.runCallLater(this.changeCells);this._array=t||[];this._preLen=this._array.length;var e=this._array.length;this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY));this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1;this.startIndex=this._startIndex;if(this._scrollBar){this._scrollBar.stopScroll();var o=this._isVertical?this.repeatX:this.repeatY;var i=this._isVertical?this.repeatY:this.repeatX;var a=Math.ceil(e/o);var r=this._cellOffset>0?this.totalPage+1:this.totalPage;if(r>1&&a>=i){this._scrollBar.scrollSize=this._cellSize;this._scrollBar.thumbPercent=i/a;this._scrollBar.setScroll(0,(a-i)*this._cellSize+this._cellOffset,this._scrollBar.value);this._scrollBar.target=this._content}else{this._scrollBar.setScroll(0,0,0);this._scrollBar.target=this._content}}}updateArray(t){this._array=t;var e;if(this._array){e=this._preLen-this._startIndex;if(e>=0)this.renderItems(e);this._preLen=this._array.length}if(this._scrollBar){var o=t.length;var i=this._isVertical?this.repeatX:this.repeatY;var a=this._isVertical?this.repeatY:this.repeatX;var r=Math.ceil(o/i);if(r>=a){this._scrollBar.thumbPercent=a/r;this._scrollBar.slider["_max"]=(r-a)*this._cellSize+this._cellOffset}}}get page(){return this._page}set page(t){this._page=t;if(this._array){this._page=t>0?t:0;this._page=this._page<this.totalPage?this._page:this.totalPage-1;this.startIndex=this._page*this.repeatX*this.repeatY}}get length(){return this._array?this._array.length:0}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.array=t;else super.dataSource=t}get dataSource(){return super.dataSource}get cells(){this.runCallLater(this.changeCells);return this._cells}get elasticEnabled(){return this._elasticEnabled}set elasticEnabled(t){this._elasticEnabled=t;if(this._scrollBar){this._scrollBar.elasticDistance=t?200:0}}refresh(){this.array=this._array}getItem(t){if(t>-1&&t<this._array.length){return this._array[t]}return null}changeItem(t,e){if(t>-1&&t<this._array.length){this._array[t]=e;if(t>=this._startIndex&&t<this._startIndex+this._cells.length){this.renderItem(this.getCell(t),t)}}}setItem(t,e){this.changeItem(t,e)}addItem(t){this._array.push(t);this.array=this._array}addItemAt(t,e){this._array.splice(e,0,t);this.array=this._array}deleteItem(t){this._array.splice(t,1);this.array=this._array}getCell(t){this.runCallLater(this.changeCells);if(t>-1&&this._cells){return this._cells[(t-this._startIndex)%this._cells.length]}return null}scrollTo(t){if(this._scrollBar){var e=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(t/e)*this._cellSize}else{this.startIndex=t}}tweenTo(t,e=200,o=null){if(this._scrollBar){this._scrollBar.stopScroll();var i=this._isVertical?this.repeatX:this.repeatY;b.Tween.to(this._scrollBar,{value:Math.floor(t/i)*this._cellSize},e,null,o,0,true)}else{this.startIndex=t;if(o)o.run()}}_setCellChanged(){if(!this._cellChanged){this._cellChanged=true;this.callLater(this.changeCells)}}commitMeasure(){this.runCallLater(this.changeCells)}}b.ILaya.regClass(g);b.ClassUtils.regClass("laya.ui.List",g);b.ClassUtils.regClass("Laya.List",g);class v extends a{constructor(t=null,e=null){super();this._visibleNum=6;this._itemColors=s.comboBoxItemColors;this._itemSize=12;this._labels=[];this._selectedIndex=-1;this.itemRender=null;this.skin=t;this.labels=e}destroy(t=true){super.destroy(t);this._button&&this._button.destroy(t);this._list&&this._list.destroy(t);this._button=null;this._list=null;this._itemColors=null;this._labels=null;this._selectHandler=null}createChildren(){this.addChild(this._button=new l);this._button.text.align="left";this._button.labelPadding="0,0,0,5";this._button.on(b.Event.MOUSE_DOWN,this,this.onButtonMouseDown)}_createList(){this._list=new g;if(this._scrollBarSkin)this._list.vScrollBarSkin=this._scrollBarSkin;this._setListEvent(this._list)}_setListEvent(t){this._list.selectEnable=true;this._list.on(b.Event.MOUSE_DOWN,this,this.onListDown);this._list.mouseHandler=b.Handler.create(this,this.onlistItemMouse,null,false);if(this._list.scrollBar)this._list.scrollBar.on(b.Event.MOUSE_DOWN,this,this.onScrollBarDown)}onListDown(t){t.stopPropagation()}onScrollBarDown(t){t.stopPropagation()}onButtonMouseDown(t){this.callLater(this.switchTo,[!this._isOpen])}get skin(){return this._button.skin}set skin(t){if(this._button.skin!=t){this._button.skin=t;this._listChanged=true}}measureWidth(){return this._button.width}measureHeight(){return this._button.height}changeList(){this._listChanged=false;var t=this.width-2;var e=this._itemColors[2];this._itemHeight=this._itemSize+6;this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:t,height:this._itemHeight,fontSize:this._itemSize,color:e}}]};this._list.repeatY=this._visibleNum;this._list.refresh()}onlistItemMouse(t,e){var o=t.type;if(o===b.Event.MOUSE_OVER||o===b.Event.MOUSE_OUT){if(this._isCustomList)return;var i=this._list.getCell(e);if(!i)return;var a=i.getChildByName("label");if(a){if(o===b.Event.ROLL_OVER){a.bgColor=this._itemColors[0];a.color=this._itemColors[1]}else{a.bgColor=null;a.color=this._itemColors[2]}}}else if(o===b.Event.CLICK){this.selectedIndex=e;this.isOpen=false}}switchTo(t){this.isOpen=t}changeOpen(){this.isOpen=!this._isOpen}set width(t){super.width=t;this._button.width=this._width;this._itemChanged=true;this._listChanged=true}get width(){return super.width}set height(t){super.height=t;this._button.height=this._height}get height(){return super.height}get labels(){return this._labels.join(",")}set labels(t){if(this._labels.length>0)this.selectedIndex=-1;if(t)this._labels=t.split(",");else this._labels.length=0;this._itemChanged=true}changeItem(){this._itemChanged=false;this._listHeight=this._labels.length>0?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight;if(!this._isCustomList){var t=this._list.graphics;t.clear(true);t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}var e=this._list.array||[];e.length=0;for(var o=0,i=this._labels.length;o<i;o++){e.push({label:this._labels[o]})}this._list.height=this._listHeight;this._list.array=e}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if(this._selectedIndex!=t){this._selectedIndex=t;if(this._labels.length>0)this.changeSelected();else this.callLater(this.changeSelected);this.event(b.Event.CHANGE,[b.Event.EMPTY.setTo(b.Event.CHANGE,this,this)]);this._selectHandler&&this._selectHandler.runWith(this._selectedIndex)}}changeSelected(){this._button.label=this.selectedLabel}get selectHandler(){return this._selectHandler}set selectHandler(t){this._selectHandler=t}get selectedLabel(){return this._selectedIndex>-1&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null}set selectedLabel(t){this.selectedIndex=this._labels.indexOf(t)}get visibleNum(){return this._visibleNum}set visibleNum(t){this._visibleNum=t;this._listChanged=true}get itemColors(){return String(this._itemColors)}set itemColors(t){this._itemColors=x.fillArray(this._itemColors,t,String);this._listChanged=true}get itemSize(){return this._itemSize}set itemSize(t){this._itemSize=t;this._listChanged=true}get isOpen(){return this._isOpen}set isOpen(t){if(this._isOpen!=t){this._isOpen=t;this._button.selected=this._isOpen;if(this._isOpen){this._list||this._createList();this._listChanged&&!this._isCustomList&&this.changeList();this._itemChanged&&this.changeItem();var e=this.localToGlobal(b.Point.TEMP.setTo(0,0));var o=e.y+this._button.height;o=o+this._listHeight<=b.ILaya.stage.height?o:e.y-this._listHeight;this._list.pos(e.x,o);this._list.zOrder=1001;b.ILaya.stage.addChild(this._list);b.ILaya.stage.once(b.Event.MOUSE_DOWN,this,this.removeList);b.ILaya.stage.on(b.Event.MOUSE_WHEEL,this,this._onStageMouseWheel);this._list.selectedIndex=this._selectedIndex}else{this._list&&this._list.removeSelf()}}}_onStageMouseWheel(t){if(!this._list||this._list.contains(t.target))return;this.removeList(null)}removeList(t){b.ILaya.stage.off(b.Event.MOUSE_DOWN,this,this.removeList);b.ILaya.stage.off(b.Event.MOUSE_WHEEL,this,this._onStageMouseWheel);this.isOpen=false}get scrollBarSkin(){return this._scrollBarSkin}set scrollBarSkin(t){this._scrollBarSkin=t}get sizeGrid(){return this._button.sizeGrid}set sizeGrid(t){this._button.sizeGrid=t}get scrollBar(){return this.list.scrollBar}get button(){return this._button}get list(){this._list||this._createList();return this._list}set list(t){if(t){t.removeSelf();this._isCustomList=true;this._list=t;this._setListEvent(t);this._itemHeight=t.getCell(0).height+t.spaceY}}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.labels=t.join(",");else super.dataSource=t}get dataSource(){return super.dataSource}get labelColors(){return this._button.labelColors}set labelColors(t){if(this._button.labelColors!=t){this._button.labelColors=t}}get labelPadding(){return this._button.text.padding.join(",")}set labelPadding(t){this._button.text.padding=x.fillArray(s.labelPadding,t,Number)}get labelSize(){return this._button.text.fontSize}set labelSize(t){this._button.text.fontSize=t}get labelBold(){return this._button.text.bold}set labelBold(t){this._button.text.bold=t}get labelFont(){return this._button.text.font}set labelFont(t){this._button.text.font=t}get stateNum(){return this._button.stateNum}set stateNum(t){this._button.stateNum=t}}b.ILaya.regClass(v);b.ClassUtils.regClass("laya.ui.ComboBox",v);b.ClassUtils.regClass("Laya.ComboBox",v);class S extends a{constructor(t=null){super();this._value=.5;this.skin=t}destroy(t=true){super.destroy(t);this._bg&&this._bg.destroy(t);this._bar&&this._bar.destroy(t);this._bg=this._bar=null;this.changeHandler=null}createChildren(){this.addChild(this._bg=new n);this.addChild(this._bar=new n);this._bar._bitmap.autoCacheCmd=false}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(this._skin&&!b.Loader.getRes(this._skin)){b.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1)}else{this._skinLoaded()}}}_skinLoaded(){this._bg.skin=this._skin;this._bar.skin=this._skin.replace(".png","$bar.png");this.callLater(this.changeValue);this._sizeChanged();this.event(b.Event.LOADED)}measureWidth(){return this._bg.width}measureHeight(){return this._bg.height}get value(){return this._value}set value(t){if(this._value!=t){t=t>1?1:t<0?0:t;this._value=t;this.callLater(this.changeValue);this.event(b.Event.CHANGE);this.changeHandler&&this.changeHandler.runWith(t)}}changeValue(){if(this.sizeGrid){var t=this.sizeGrid.split(",");var e=Number(t[3]);var o=Number(t[1]);var i=this.width-e-o;var a=i*this._value;this._bar.width=e+o+a;this._bar.visible=this._bar.width>e+o}else{this._bar.width=this.width*this._value}}get bar(){return this._bar}get bg(){return this._bg}get sizeGrid(){return this._bg.sizeGrid}set sizeGrid(t){this._bg.sizeGrid=this._bar.sizeGrid=t}set width(t){super.width=t;this._bg.width=this._width;this.callLater(this.changeValue)}get width(){return super.width}set height(t){super.height=t;this._bg.height=this._height;this._bar.height=this._height}get height(){return super.height}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.value=Number(t);else super.dataSource=t}get dataSource(){return super.dataSource}}b.ILaya.regClass(S);b.ClassUtils.regClass("laya.ui.ProgressBar",S);b.ClassUtils.regClass("Laya.ProgressBar",S);class C extends l{constructor(t=null,e=""){super(t,e);this.toggle=false;this._autoSize=false}destroy(t=true){super.destroy(t);this._value=null}preinitialize(){super.preinitialize();this.toggle=false;this._autoSize=false}initialize(){super.initialize();this.createText();this._text.align="left";this._text.valign="top";this._text.width=0;this.on(b.Event.CLICK,this,this.onClick)}onClick(t){this.selected=true}get value(){return this._value!=null?this._value:this.label}set value(t){this._value=t}}b.ILaya.regClass(C);b.ClassUtils.regClass("laya.ui.Radio",C);b.ClassUtils.regClass("Laya.Radio",C);class P extends d{constructor(t=null,e=null){super();this._selectedIndex=-1;this._direction="horizontal";this._space=0;this.skin=e;this.labels=t}preinitialize(){this.mouseEnabled=true}destroy(t=true){super.destroy(t);this._items&&(this._items.length=0);this._items=null;this.selectHandler=null}addItem(t,e=true){var o=t;var i=this._items.length;o.name="item"+i;this.addChild(o);this.initItems();if(e&&i>0){var a=this._items[i-1];if(this._direction=="horizontal"){o.x=a._x+a.width+this._space}else{o.y=a._y+a.height+this._space}}else{if(e){o.x=0;o.y=0}}return i}delItem(t,e=true){var o=this._items.indexOf(t);if(o!=-1){var i=t;this.removeChild(i);for(var a=o+1,r=this._items.length;a<r;a++){var s=this._items[a];s.name="item"+(a-1);if(e){if(this._direction=="horizontal"){s.x-=i.width+this._space}else{s.y-=i.height+this._space}}}this.initItems();if(this._selectedIndex>-1){var n;n=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1;this._selectedIndex=-1;this.selectedIndex=n}}}_afterInited(){this.initItems()}initItems(){this._items||(this._items=[]);this._items.length=0;for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(e==null)break;this._items.push(e);e.selected=t===this._selectedIndex;e.clickHandler=b.Handler.create(this,this.itemClick,[t],false)}}itemClick(t){this.selectedIndex=t}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if(this._selectedIndex!=t){this.setSelect(this._selectedIndex,false);this._selectedIndex=t;this.setSelect(t,true);this.event(b.Event.CHANGE);this.selectHandler&&this.selectHandler.runWith(this._selectedIndex)}}setSelect(t,e){if(this._items&&t>-1&&t<this._items.length)this._items[t].selected=e}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(this._skin&&!b.Loader.getRes(this._skin)){b.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1)}else{this._skinLoaded()}}}_skinLoaded(){this._setLabelChanged();this.event(b.Event.LOADED)}get labels(){return this._labels}set labels(t){if(this._labels!=t){this._labels=t;this.removeChildren();this._setLabelChanged();if(this._labels){var e=this._labels.split(",");for(var o=0,i=e.length;o<i;o++){var a=this.createItem(this._skin,e[o]);a.name="item"+o;this.addChild(a)}}this.initItems()}}createItem(t,e){return null}get labelColors(){return this._labelColors}set labelColors(t){if(this._labelColors!=t){this._labelColors=t;this._setLabelChanged()}}get labelStroke(){return this._labelStroke}set labelStroke(t){if(this._labelStroke!=t){this._labelStroke=t;this._setLabelChanged()}}get labelStrokeColor(){return this._labelStrokeColor}set labelStrokeColor(t){if(this._labelStrokeColor!=t){this._labelStrokeColor=t;this._setLabelChanged()}}get strokeColors(){return this._strokeColors}set strokeColors(t){if(this._strokeColors!=t){this._strokeColors=t;this._setLabelChanged()}}get labelSize(){return this._labelSize}set labelSize(t){if(this._labelSize!=t){this._labelSize=t;this._setLabelChanged()}}get stateNum(){return this._stateNum}set stateNum(t){if(this._stateNum!=t){this._stateNum=t;this._setLabelChanged()}}get labelBold(){return this._labelBold}set labelBold(t){if(this._labelBold!=t){this._labelBold=t;this._setLabelChanged()}}get labelFont(){return this._labelFont}set labelFont(t){if(this._labelFont!=t){this._labelFont=t;this._setLabelChanged()}}get labelPadding(){return this._labelPadding}set labelPadding(t){if(this._labelPadding!=t){this._labelPadding=t;this._setLabelChanged()}}get direction(){return this._direction}set direction(t){this._direction=t;this._setLabelChanged()}get space(){return this._space}set space(t){this._space=t;this._setLabelChanged()}changeLabels(){this._labelChanged=false;if(this._items){var t=0;for(var e=0,o=this._items.length;e<o;e++){var i=this._items[e];this._skin&&(i.skin=this._skin);this._labelColors&&(i.labelColors=this._labelColors);this._labelSize&&(i.labelSize=this._labelSize);this._labelStroke&&(i.labelStroke=this._labelStroke);this._labelStrokeColor&&(i.labelStrokeColor=this._labelStrokeColor);this._strokeColors&&(i.strokeColors=this._strokeColors);this._labelBold&&(i.labelBold=this._labelBold);this._labelPadding&&(i.labelPadding=this._labelPadding);this._labelAlign&&(i.labelAlign=this._labelAlign);this._stateNum&&(i.stateNum=this._stateNum);this._labelFont&&(i.labelFont=this._labelFont);if(this._direction==="horizontal"){i.y=0;i.x=t;t+=i.width+this._space}else{i.x=0;i.y=t;t+=i.height+this._space}}}this._sizeChanged()}commitMeasure(){this.runCallLater(this.changeLabels)}get items(){return this._items}get selection(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null}set selection(t){this.selectedIndex=this._items.indexOf(t)}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string")this.selectedIndex=parseInt(t);else if(t instanceof Array)this.labels=t.join(",");else super.dataSource=t}get dataSource(){return super.dataSource}_setLabelChanged(){if(!this._labelChanged){this._labelChanged=true;this.callLater(this.changeLabels)}}}b.ILaya.regClass(P);b.ClassUtils.regClass("laya.ui.UIGroup",P);b.ClassUtils.regClass("Laya.UIGroup",P);class A extends P{createItem(t,e){return new C(t,e)}}b.ILaya.regClass(A);b.ClassUtils.regClass("laya.ui.RadioGroup",A);b.ClassUtils.regClass("Laya.RadioGroup",A);class B extends P{createItem(t,e){return new l(t,e)}}b.ILaya.regClass(B);b.ClassUtils.regClass("laya.ui.Tab",B);b.ClassUtils.regClass("Laya.Tab",B);class w extends d{constructor(){super(...arguments);this._setIndexHandler=b.Handler.create(this,this.setIndex,null,false)}setItems(t){this.removeChildren();var e=0;for(var o=0,i=t.length;o<i;o++){var a=t[o];if(a){a.name="item"+e;this.addChild(a);e++}}this.initItems()}addItem(t){t.name="item"+this._items.length;this.addChild(t);this.initItems()}_afterInited(){this.initItems()}initItems(){this._items=[];for(var t=0;t<1e4;t++){var e=this.getChildByName("item"+t);if(e==null){break}this._items.push(e);e.visible=t==this._selectedIndex}}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if(this._selectedIndex!=t){this.setSelect(this._selectedIndex,false);this._selectedIndex=t;this.setSelect(this._selectedIndex,true)}}setSelect(t,e){if(this._items&&t>-1&&t<this._items.length){this._items[t].visible=e}}get selection(){return this._selectedIndex>-1&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null}set selection(t){this.selectedIndex=this._items.indexOf(t)}get setIndexHandler(){return this._setIndexHandler}set setIndexHandler(t){this._setIndexHandler=t}setIndex(t){this.selectedIndex=t}get items(){return this._items}set dataSource(t){this._dataSource=t;if(typeof t=="number"||typeof t=="string"){this.selectedIndex=parseInt(t)}else{for(var e in this._dataSource){if(e in this){this[e]=this._dataSource[e]}}}}get dataSource(){return super.dataSource}}b.ILaya.regClass(w);b.ClassUtils.regClass("laya.ui.ViewStack",w);b.ClassUtils.regClass("Laya.ViewStack",w);class T extends c{constructor(t=""){super();this.text=t;this.skin=this.skin}preinitialize(){this.mouseEnabled=true}destroy(t=true){super.destroy(t);this._bg&&this._bg.destroy();this._bg=null}createChildren(){this.addChild(this._tf=new b.Input);this._tf.padding=s.inputLabelPadding;this._tf.on(b.Event.INPUT,this,this._onInput);this._tf.on(b.Event.ENTER,this,this._onEnter);this._tf.on(b.Event.BLUR,this,this._onBlur);this._tf.on(b.Event.FOCUS,this,this._onFocus)}_onFocus(){this.event(b.Event.FOCUS,this)}_onBlur(){this.event(b.Event.BLUR,this)}_onInput(){this.event(b.Event.INPUT,this)}_onEnter(){this.event(b.Event.ENTER,this)}initialize(){this.width=128;this.height=22}get bg(){return this._bg}set bg(t){this.graphics=this._bg=t}get skin(){return this._skin}set skin(t){if(this._skin!=t){this._skin=t;if(this._skin&&!b.Loader.getRes(this._skin)){b.ILaya.loader.load(this._skin,b.Handler.create(this,this._skinLoaded),null,b.Loader.IMAGE,1)}else{this._skinLoaded()}}}_skinLoaded(){this._bg||(this.graphics=this._bg=new e);this._bg.source=b.Loader.getRes(this._skin);this._width&&(this._bg.width=this._width);this._height&&(this._bg.height=this._height);this._sizeChanged();this.event(b.Event.LOADED)}get sizeGrid(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null}set sizeGrid(t){this._bg||(this.graphics=this._bg=new e);this._bg.sizeGrid=x.fillArray(s.defaultSizeGrid,t,Number)}set text(t){if(this._tf.text!=t){t=t+"";this._tf.text=t;this.event(b.Event.CHANGE)}}get text(){return super.text}set width(t){super.width=t;this._bg&&(this._bg.width=t)}get width(){return super.width}set height(t){super.height=t;this._bg&&(this._bg.height=t)}get height(){return super.height}get multiline(){return this._tf.multiline}set multiline(t){this._tf.multiline=t}set editable(t){this._tf.editable=t}get editable(){return this._tf.editable}select(){this._tf.select()}get restrict(){return this._tf.restrict}set restrict(t){this._tf.restrict=t}get prompt(){return this._tf.prompt}set prompt(t){this._tf.prompt=t}get promptColor(){return this._tf.promptColor}set promptColor(t){this._tf.promptColor=t}get maxChars(){return this._tf.maxChars}set maxChars(t){this._tf.maxChars=t}get focus(){return this._tf.focus}set focus(t){this._tf.focus=t}get type(){return this._tf.type}set type(t){this._tf.type=t}setSelection(t,e){this._tf.setSelection(t,e)}}b.ILaya.regClass(T);b.ClassUtils.regClass("laya.ui.TextInput",T);b.ClassUtils.regClass("Laya.TextInput",T);class M extends T{constructor(t=""){super(t);this.on(b.Event.CHANGE,this,this._onTextChange)}_onTextChange(){this.callLater(this.changeScroll)}destroy(t=true){super.destroy(t);this._vScrollBar&&this._vScrollBar.destroy();this._hScrollBar&&this._hScrollBar.destroy();this._vScrollBar=null;this._hScrollBar=null}initialize(){this.width=180;this.height=150;this._tf.wordWrap=true;this.multiline=true}set width(t){super.width=t;this.callLater(this.changeScroll)}get width(){return super.width}set height(t){super.height=t;this.callLater(this.changeScroll)}get height(){return super.height}get vScrollBarSkin(){return this._vScrollBar?this._vScrollBar.skin:null}set vScrollBarSkin(t){if(this._vScrollBar==null){this.addChild(this._vScrollBar=new m);this._vScrollBar.on(b.Event.CHANGE,this,this.onVBarChanged);this._vScrollBar.target=this._tf;this.callLater(this.changeScroll)}this._vScrollBar.skin=t}get hScrollBarSkin(){return this._hScrollBar?this._hScrollBar.skin:null}set hScrollBarSkin(t){if(this._hScrollBar==null){this.addChild(this._hScrollBar=new f);this._hScrollBar.on(b.Event.CHANGE,this,this.onHBarChanged);this._hScrollBar.mouseWheelEnable=false;this._hScrollBar.target=this._tf;this.callLater(this.changeScroll)}this._hScrollBar.skin=t}onVBarChanged(t){if(this._tf.scrollY!=this._vScrollBar.value){this._tf.scrollY=this._vScrollBar.value}}onHBarChanged(t){if(this._tf.scrollX!=this._hScrollBar.value){this._tf.scrollX=this._hScrollBar.value}}get vScrollBar(){return this._vScrollBar}get hScrollBar(){return this._hScrollBar}get maxScrollY(){return this._tf.maxScrollY}get scrollY(){return this._tf.scrollY}get maxScrollX(){return this._tf.maxScrollX}get scrollX(){return this._tf.scrollX}changeScroll(){var t=this._vScrollBar&&this._tf.maxScrollY>0;var e=this._hScrollBar&&this._tf.maxScrollX>0;var o=t?this._width-this._vScrollBar.width:this._width;var i=e?this._height-this._hScrollBar.height:this._height;var a=this._tf.padding||s.labelPadding;this._tf.width=o;this._tf.height=i;if(this._vScrollBar){this._vScrollBar.x=this._width-this._vScrollBar.width-a[2];this._vScrollBar.y=a[1];this._vScrollBar.height=this._height-(e?this._hScrollBar.height:0)-a[1]-a[3];this._vScrollBar.scrollSize=1;this._vScrollBar.thumbPercent=i/Math.max(this._tf.textHeight,i);this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY);this._vScrollBar.visible=t}if(this._hScrollBar){this._hScrollBar.x=a[0];this._hScrollBar.y=this._height-this._hScrollBar.height-a[3];this._hScrollBar.width=this._width-(t?this._vScrollBar.width:0)-a[0]-a[2];this._hScrollBar.scrollSize=Math.max(o*.033,1);this._hScrollBar.thumbPercent=o/Math.max(this._tf.textWidth,o);this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX);this._hScrollBar.visible=e}}scrollTo(t){this.commitMeasure();this._tf.scrollY=t}}b.ILaya.regClass(M);b.ClassUtils.regClass("laya.ui.TextArea",M);b.ClassUtils.regClass("Laya.TextArea",M);class F extends d{constructor(){super(...arguments);this._oldW=0;this._oldH=0}onEnable(){b.ILaya.stage.on("resize",this,this.onResize);this.onResize()}onDisable(){b.ILaya.stage.off("resize",this,this.onResize)}onResize(){let t=b.ILaya.stage;if(this.width>0&&this.height>0){var e=Math.min(t.width/this._oldW,t.height/this._oldH);super.width=t.width;super.height=t.height;this.scale(e,e)}}set width(t){super.width=t;this._oldW=t}get width(){return super.width}set height(t){super.height=t;this._oldH=t}get height(){return super.height}}b.ILaya.regClass(F);b.ClassUtils.regClass("laya.ui.ScaleBox",F);b.ClassUtils.regClass("Laya.ScaleBox",F);class J extends u{constructor(t=null){super(t);this.isVertical=false}}b.ILaya.regClass(J);b.ClassUtils.regClass("laya.ui.HSlider",J);b.ClassUtils.regClass("Laya.HSlider",J);class k extends d{constructor(){super();this._usedCache=null;this._elasticEnabled=false;this.width=this.height=100}destroy(t=true){super.destroy(t);this._content&&this._content.destroy(t);this._vScrollBar&&this._vScrollBar.destroy(t);this._hScrollBar&&this._hScrollBar.destroy(t);this._vScrollBar=null;this._hScrollBar=null;this._content=null}destroyChildren(){this._content.destroyChildren()}createChildren(){super.addChild(this._content=new d)}addChild(t){t.on(b.Event.RESIZE,this,this.onResize);this._setScrollChanged();return this._content.addChild(t)}onResize(){this._setScrollChanged()}addChildAt(t,e){t.on(b.Event.RESIZE,this,this.onResize);this._setScrollChanged();return this._content.addChildAt(t,e)}removeChild(t){t.off(b.Event.RESIZE,this,this.onResize);this._setScrollChanged();return this._content.removeChild(t)}removeChildAt(t){this.getChildAt(t).off(b.Event.RESIZE,this,this.onResize);this._setScrollChanged();return this._content.removeChildAt(t)}removeChildren(t=0,e=2147483647){this._content.removeChildren(t,e);this._setScrollChanged();return this}getChildAt(t){return this._content.getChildAt(t)}getChildByName(t){return this._content.getChildByName(t)}getChildIndex(t){return this._content.getChildIndex(t)}get numChildren(){return this._content.numChildren}changeScroll(){this._scrollChanged=false;var t=this.contentWidth||1;var e=this.contentHeight||1;var o=this._vScrollBar;var i=this._hScrollBar;var a=o&&e>this._height;var r=i&&t>this._width;var s=a?this._width-o.width:this._width;var n=r?this._height-i.height:this._height;if(o){o.x=this._width-o.width;o.y=0;o.height=this._height-(r?i.height:0);o.scrollSize=Math.max(this._height*.033,1);o.thumbPercent=n/e;o.setScroll(0,e-n,o.value)}if(i){i.x=0;i.y=this._height-i.height;i.width=this._width-(a?o.width:0);i.scrollSize=Math.max(this._width*.033,1);i.thumbPercent=s/t;i.setScroll(0,t-s,i.value)}}_sizeChanged(){super._sizeChanged();this.setContentSize(this._width,this._height)}get contentWidth(){var t=0;for(var e=this._content.numChildren-1;e>-1;e--){var o=this._content.getChildAt(e);t=Math.max(o._x+o.width*o.scaleX-o.pivotX,t)}return t}get contentHeight(){var t=0;for(var e=this._content.numChildren-1;e>-1;e--){var o=this._content.getChildAt(e);t=Math.max(o._y+o.height*o.scaleY-o.pivotY,t)}return t}setContentSize(t,e){var o=this._content;o.width=t;o.height=e;o._style.scrollRect||(o.scrollRect=b.Rectangle.create());o._style.scrollRect.setTo(0,0,t,e);o.scrollRect=o.scrollRect}set width(t){super.width=t;this._setScrollChanged()}get width(){return super.width}set height(t){super.height=t;this._setScrollChanged()}get height(){return super.height}get vScrollBarSkin(){return this._vScrollBar?this._vScrollBar.skin:null}set vScrollBarSkin(t){if(this._vScrollBar==null){super.addChild(this._vScrollBar=new m);this._vScrollBar.on(b.Event.CHANGE,this,this.onScrollBarChange,[this._vScrollBar]);this._vScrollBar.target=this._content;this._vScrollBar.elasticDistance=this._elasticEnabled?200:0;this._setScrollChanged()}this._vScrollBar.skin=t}get hScrollBarSkin(){return this._hScrollBar?this._hScrollBar.skin:null}set hScrollBarSkin(t){if(this._hScrollBar==null){super.addChild(this._hScrollBar=new f);this._hScrollBar.on(b.Event.CHANGE,this,this.onScrollBarChange,[this._hScrollBar]);this._hScrollBar.target=this._content;this._hScrollBar.elasticDistance=this._elasticEnabled?200:0;this._setScrollChanged()}this._hScrollBar.skin=t}get vScrollBar(){return this._vScrollBar}get hScrollBar(){return this._hScrollBar}get content(){return this._content}onScrollBarChange(t){var e=this._content._style.scrollRect;if(e){var o=Math.round(t.value);t.isVertical?e.y=o:e.x=o;this._content.scrollRect=e}}scrollTo(t=0,e=0){if(this.vScrollBar)this.vScrollBar.value=e;if(this.hScrollBar)this.hScrollBar.value=t}refresh(){this.changeScroll()}set cacheAs(t){super.cacheAs=t;this._usedCache=null;if(t!=="none"){this._hScrollBar&&this._hScrollBar.on(b.Event.START,this,this.onScrollStart);this._vScrollBar&&this._vScrollBar.on(b.Event.START,this,this.onScrollStart)}else{this._hScrollBar&&this._hScrollBar.off(b.Event.START,this,this.onScrollStart);this._vScrollBar&&this._vScrollBar.off(b.Event.START,this,this.onScrollStart)}}get cacheAs(){return super.cacheAs}get elasticEnabled(){return this._elasticEnabled}set elasticEnabled(t){this._elasticEnabled=t;if(this._vScrollBar){this._vScrollBar.elasticDistance=t?200:0}if(this._hScrollBar){this._hScrollBar.elasticDistance=t?200:0}}onScrollStart(){this._usedCache||(this._usedCache=super.cacheAs);super.cacheAs="none";this._hScrollBar&&this._hScrollBar.once(b.Event.END,this,this.onScrollEnd);this._vScrollBar&&this._vScrollBar.once(b.Event.END,this,this.onScrollEnd)}onScrollEnd(){super.cacheAs=this._usedCache}_setScrollChanged(){if(!this._scrollChanged){this._scrollChanged=true;this.callLater(this.changeScroll)}}}b.ILaya.regClass(k);b.ClassUtils.regClass("laya.ui.Panel",k);b.ClassUtils.regClass("Laya.Panel",k);class O extends u{}b.ILaya.regClass(O);b.ClassUtils.regClass("laya.ui.VSlider",O);b.ClassUtils.regClass("Laya.VSlider",O);class N extends d{constructor(){super();this._spaceLeft=10;this._spaceBottom=0;this._keepStatus=true;this.width=this.height=200}destroy(t=true){super.destroy(t);this._list&&this._list.destroy(t);this._list=null;this._source=null;this._renderHandler=null}createChildren(){this.addChild(this._list=new g);this._list.renderHandler=b.Handler.create(this,this.renderItem,null,false);this._list.repeatX=1;this._list.on(b.Event.CHANGE,this,this.onListChange)}onListChange(t=null){this.event(b.Event.CHANGE)}get keepStatus(){return this._keepStatus}set keepStatus(t){this._keepStatus=t}get array(){return this._list.array}set array(t){if(this._keepStatus&&this._list.array&&t){this.parseOpenStatus(this._list.array,t)}this._source=t;this._list.array=this.getArray()}get source(){return this._source}get list(){return this._list}get itemRender(){return this._list.itemRender}set itemRender(t){this._list.itemRender=t}get scrollBarSkin(){return this._list.vScrollBarSkin}set scrollBarSkin(t){this._list.vScrollBarSkin=t}get scrollBar(){return this._list.scrollBar}get mouseHandler(){return this._list.mouseHandler}set mouseHandler(t){this._list.mouseHandler=t}get renderHandler(){return this._renderHandler}set renderHandler(t){this._renderHandler=t}get spaceLeft(){return this._spaceLeft}set spaceLeft(t){this._spaceLeft=t}get spaceBottom(){return this._list.spaceY}set spaceBottom(t){this._list.spaceY=t}get selectedIndex(){return this._list.selectedIndex}set selectedIndex(t){this._list.selectedIndex=t}get selectedItem(){return this._list.selectedItem}set selectedItem(t){this._list.selectedItem=t}set width(t){super.width=t;this._list.width=t}get width(){return super.width}set height(t){super.height=t;this._list.height=t}get height(){return super.height}getArray(){var e=[];for(let t of this._source){if(this.getParentOpenStatus(t)){t.x=this._spaceLeft*this.getDepth(t);e.push(t)}}return e}getDepth(t,e=0){if(t.nodeParent==null)return e;else return this.getDepth(t.nodeParent,e+1)}getParentOpenStatus(t){var e=t.nodeParent;if(e==null){return true}else{if(e.isOpen){if(e.nodeParent!=null)return this.getParentOpenStatus(e);else return true}else{return false}}}renderItem(t,e){var o=t.dataSource;if(o){t.left=o.x;var i=t.getChildByName("arrow");if(i){if(o.hasChild){i.visible=true;i.index=o.isOpen?1:0;i.tag=e;i.off(b.Event.CLICK,this,this.onArrowClick);i.on(b.Event.CLICK,this,this.onArrowClick)}else{i.visible=false}}var a=t.getChildByName("folder");if(a){if(a.clipY==2){a.index=o.isDirectory?0:1}else{a.index=o.isDirectory?o.isOpen?1:0:2}}this._renderHandler&&this._renderHandler.runWith([t,e])}}onArrowClick(t){var e=t.currentTarget;var o=e.tag;this._list.array[o].isOpen=!this._list.array[o].isOpen;this.event(b.Event.OPEN);this._list.array=this.getArray()}setItemState(t,e){if(!this._list.array[t])return;this._list.array[t].isOpen=e;this._list.array=this.getArray()}fresh(){this._list.array=this.getArray();this.repaint()}set dataSource(t){this._dataSource=t;super.dataSource=t}get dataSource(){return super.dataSource}set xml(t){var e=[];this.parseXml(t.childNodes[0],e,null,true);this.array=e}parseXml(t,e,o,i){var a;var r=t.childNodes;var s=r.length;if(!i){a={};var n=t.attributes;for(let t of n){var b=t.nodeName;var x=t.nodeValue;a[b]=x=="true"?true:x=="false"?false:x}a.nodeParent=o;if(s>0)a.isDirectory=true;a.hasChild=s>0;e.push(a)}for(var l=0;l<s;l++){var _=r[l];this.parseXml(_,e,a,false)}}parseOpenStatus(t,e){for(var o=0,i=e.length;o<i;o++){var a=e[o];if(a.isDirectory){for(var r=0,s=t.length;r<s;r++){var n=t[r];if(n.isDirectory&&this.isSameParent(n,a)&&a.label==n.label){a.isOpen=n.isOpen;break}}}}}isSameParent(t,e){if(t.nodeParent==null&&e.nodeParent==null)return true;else if(t.nodeParent==null||e.nodeParent==null)return false;else{if(t.nodeParent.label==e.nodeParent.label)return this.isSameParent(t.nodeParent,e.nodeParent);else return false}}get selectedPath(){if(this._list.selectedItem){return this._list.selectedItem.path}return null}filter(t){if(Boolean(t)){var e=[];this.getFilterSource(this._source,e,t);this._list.array=e}else{this._list.array=this.getArray()}}getFilterSource(e,o,i){i=i.toLocaleLowerCase();for(let t of e){if(!t.isDirectory&&String(t.label).toLowerCase().indexOf(i)>-1){t.x=0;o.push(t)}if(t.child&&t.child.length>0){this.getFilterSource(t.child,o,i)}}}}b.ILaya.regClass(N);b.ClassUtils.regClass("laya.ui.Tree",N);b.ClassUtils.regClass("Laya.Tree",N);class I extends d{constructor(){super(...arguments);this._space=0;this._align="none";this._itemChanged=false}addChild(t){t.on(b.Event.RESIZE,this,this.onResize);this._setItemChanged();return super.addChild(t)}onResize(t){this._setItemChanged()}addChildAt(t,e){t.on(b.Event.RESIZE,this,this.onResize);this._setItemChanged();return super.addChildAt(t,e)}removeChildAt(t){this.getChildAt(t).off(b.Event.RESIZE,this,this.onResize);this._setItemChanged();return super.removeChildAt(t)}refresh(){this._setItemChanged()}changeItems(){this._itemChanged=false}get space(){return this._space}set space(t){this._space=t;this._setItemChanged()}get align(){return this._align}set align(t){this._align=t;this._setItemChanged()}sortItem(t){if(t)t.sort(function(t,e){return t.y-e.y})}_setItemChanged(){if(!this._itemChanged){this._itemChanged=true;this.callLater(this.changeItems)}}}b.ILaya.regClass(I);b.ClassUtils.regClass("laya.ui.LayoutBox",I);b.ClassUtils.regClass("Laya.LayoutBox",I);class D extends I{sortItem(t){if(t)t.sort(function(t,e){return t.x-e.x})}set height(t){if(this._height!=t){super.height=t;this.callLater(this.changeItems)}}get height(){return super.height}changeItems(){this._itemChanged=false;var t=[];var e=0;for(var o=0,i=this.numChildren;o<i;o++){var a=this.getChildAt(o);if(a){t.push(a);e=this._height?this._height:Math.max(e,a.height*a.scaleY)}}this.sortItem(t);var r=0;for(o=0,i=t.length;o<i;o++){a=t[o];a.x=r;r+=a.width*a.scaleX+this._space;if(this._align==D.TOP){a.y=0}else if(this._align==D.MIDDLE){a.y=(e-a.height*a.scaleY)*.5}else if(this._align==D.BOTTOM){a.y=e-a.height*a.scaleY}}this._sizeChanged()}}D.NONE="none";D.TOP="top";D.MIDDLE="middle";D.BOTTOM="bottom";b.ILaya.regClass(D);b.ClassUtils.regClass("laya.ui.HBox",D);b.ClassUtils.regClass("Laya.HBox",D);class L extends I{set width(t){if(this._width!=t){super.width=t;this.callLater(this.changeItems)}}get width(){return super.width}changeItems(){this._itemChanged=false;var t=[];var e=0;for(var o=0,i=this.numChildren;o<i;o++){var a=this.getChildAt(o);if(a){t.push(a);e=this._width?this._width:Math.max(e,a.width*a.scaleX)}}this.sortItem(t);var r=0;for(o=0,i=t.length;o<i;o++){a=t[o];a.y=r;r+=a.height*a.scaleY+this._space;if(this._align==L.LEFT){a.x=0}else if(this._align==L.CENTER){a.x=(e-a.width*a.scaleX)*.5}else if(this._align==L.RIGHT){a.x=e-a.width*a.scaleX}}this._sizeChanged()}}L.NONE="none";L.LEFT="left";L.CENTER="center";L.RIGHT="right";b.ILaya.regClass(L);b.ClassUtils.regClass("laya.ui.VBox",L);b.ClassUtils.regClass("Laya.VBox",L);class W extends h{constructor(t=null,e=null){super();this._valueArr="";this._indexMap=null;this._sheet=null;this._direction="horizontal";this._spaceX=0;this._spaceY=0;this._align="left";this._wordsW=0;this._wordsH=0;if(t)this.skin=t;if(e)this.sheet=e}createChildren(){this._bitmap=new e;this.on(b.Event.LOADED,this,this._onClipLoaded)}_onClipLoaded(){this.callLater(this.changeValue)}get sheet(){return this._sheet}set sheet(t){t+="";this._sheet=t;var e=t.split(" ");this._clipX=String(e[0]).length;this.clipY=e.length;this._indexMap={};for(var o=0;o<this._clipY;o++){var i=e[o].split("");for(var a=0,r=i.length;a<r;a++){this._indexMap[i[a]]=o*this._clipX+a}}}get value(){if(!this._valueArr)return"";return this._valueArr}set value(t){t+="";this._valueArr=t;this.callLater(this.changeValue)}get direction(){return this._direction}set direction(t){this._direction=t;this.callLater(this.changeValue)}get spaceX(){return this._spaceX}set spaceX(t){this._spaceX=t;if(this._direction==="horizontal")this.callLater(this.changeValue)}get spaceY(){return this._spaceY}set spaceY(t){this._spaceY=t;if(!(this._direction==="horizontal"))this.callLater(this.changeValue)}set align(t){this._align=t;this.callLater(this.changeValue)}get align(){return this._align}changeValue(){if(!this._sources)return;if(!this._valueArr)return;this.graphics.clear(true);var t;t=this._sources[0];if(!t)return;var e=this._direction==="horizontal";if(e){this._wordsW=this._valueArr.length*(t.sourceWidth+this.spaceX);this._wordsH=t.sourceHeight}else{this._wordsW=t.sourceWidth;this._wordsH=(t.sourceHeight+this.spaceY)*this._valueArr.length}var o=0;if(this._width){switch(this._align){case"center":o=.5*(this._width-this._wordsW);break;case"right":o=this._width-this._wordsW;break;default:o=0}}for(var i=0,a=this._valueArr.length;i<a;i++){var r=this._indexMap[this._valueArr.charAt(i)];if(!this.sources[r])continue;t=this.sources[r];if(e)this.graphics.drawImage(t,o+i*(t.sourceWidth+this.spaceX),0,t.sourceWidth,t.sourceHeight);else this.graphics.drawImage(t,0+o,i*(t.sourceHeight+this.spaceY),t.sourceWidth,t.sourceHeight)}if(!this._width){this._widget.resetLayoutX();this.callLater(this._sizeChanged)}if(!this._height){this._widget.resetLayoutY();this.callLater(this._sizeChanged)}}set width(t){super.width=t;this.callLater(this.changeValue)}get width(){return super.width}set height(t){super.height=t;this.callLater(this.changeValue)}get height(){return super.height}measureWidth(){return this._wordsW}measureHeight(){return this._wordsH}destroy(t=true){this._valueArr=null;this._indexMap=null;this.graphics.clear(true);this.removeSelf();this.off(b.Event.LOADED,this,this._onClipLoaded);super.destroy(t)}}b.ILaya.regClass(W);b.ClassUtils.regClass("laya.ui.FontClip",W);b.ClassUtils.regClass("Laya.FontClip",W);class E extends b.Scene{constructor(){super(false);this._watchMap={};this._anchorX=NaN;this._anchorY=NaN;this._widget=o.EMPTY;this.createChildren()}static __init__(){b.ILaya.ClassUtils.regShortClassName([w,l,M,p,d,F,_,h,v,a,f,J,n,c,g,k,S,C,A,y,u,B,T,E,m,O,N,D,L,b.Animation,b.Text,W])}static regComponent(t,e){b.ILaya.ClassUtils.regClass(t,e)}static regViewRuntime(t,e){b.ILaya.ClassUtils.regClass(t,e)}static regUI(t,e){b.ILaya.loader.cacheRes(t,e)}destroy(t=true){this._watchMap=null;super.destroy(t)}changeData(t){var e=this._watchMap[t];if(!e)return;for(var o=0,i=e.length;o<i;o++){var a=e[o];a.exe(this)}}get top(){return this._widget.top}set top(t){if(t!=this._widget.top){this._getWidget().top=t}}get bottom(){return this._widget.bottom}set bottom(t){if(t!=this._widget.bottom){this._getWidget().bottom=t}}get left(){return this._widget.left}set left(t){if(t!=this._widget.left){this._getWidget().left=t}}get right(){return this._widget.right}set right(t){if(t!=this._widget.right){this._getWidget().right=t}}get centerX(){return this._widget.centerX}set centerX(t){if(t!=this._widget.centerX){this._getWidget().centerX=t}}get centerY(){return this._widget.centerY}set centerY(t){if(t!=this._widget.centerY){this._getWidget().centerY=t}}get anchorX(){return this._anchorX}set anchorX(t){if(this._anchorX!=t){this._anchorX=t;this.callLater(this._sizeChanged)}}get anchorY(){return this._anchorY}set anchorY(t){if(this._anchorY!=t){this._anchorY=t;this.callLater(this._sizeChanged)}}_sizeChanged(){if(!isNaN(this._anchorX))this.pivotX=this.anchorX*this.width;if(!isNaN(this._anchorY))this.pivotY=this.anchorY*this.height;this.event(b.Event.RESIZE)}_getWidget(){this._widget===o.EMPTY&&(this._widget=this.addComponent(o));return this._widget}loadUI(t){var e=E.uiMap[t];E.uiMap&&this.createView(e)}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource=t;for(var e in t){var o=this.getChildByName(e);if(o instanceof a)o.dataSource=t[e];else if(e in this&&!(this[e]instanceof Function))this[e]=t[e]}}}E.uiMap={};b.ILaya.regClass(E);b.ClassUtils.regClass("laya.ui.View",E);b.ClassUtils.regClass("Laya.View",E);class U{}U.Dialog=null;class z extends b.Sprite{constructor(){super();this.maskLayer=new b.Sprite;this.popupEffect=function(t){t.scale(1,1);t._effectTween=b.Tween.from(t,{x:b.ILaya.stage.width/2,y:b.ILaya.stage.height/2,scaleX:0,scaleY:0},300,b.Ease.backOut,b.Handler.create(this,this.doOpen,[t]),0,false,false)};this.closeEffect=function(t){t._effectTween=b.Tween.to(t,{x:b.ILaya.stage.width/2,y:b.ILaya.stage.height/2,scaleX:0,scaleY:0},300,b.Ease.strongOut,b.Handler.create(this,this.doClose,[t]),0,false,false)};this.popupEffectHandler=new b.Handler(this,this.popupEffect);this.closeEffectHandler=new b.Handler(this,this.closeEffect);this.mouseEnabled=this.maskLayer.mouseEnabled=true;this.zOrder=1e3;b.ILaya.stage.addChild(this);b.ILaya.stage.on(b.Event.RESIZE,this,this._onResize);if(r.closeDialogOnSide)this.maskLayer.on("click",this,this._closeOnSide);this._onResize(null)}_closeOnSide(){var t=this.getChildAt(this.numChildren-1);if(t instanceof U.Dialog)t.close()}setLockView(t){if(!this.lockLayer){this.lockLayer=new d;this.lockLayer.mouseEnabled=true;this.lockLayer.size(b.ILaya.stage.width,b.ILaya.stage.height)}this.lockLayer.removeChildren();if(t){t.centerX=t.centerY=0;this.lockLayer.addChild(t)}}_onResize(t=null){var e=this.maskLayer.width=b.ILaya.stage.width;var o=this.maskLayer.height=b.ILaya.stage.height;if(this.lockLayer)this.lockLayer.size(e,o);this.maskLayer.graphics.clear(true);this.maskLayer.graphics.drawRect(0,0,e,o,r.popupBgColor);this.maskLayer.alpha=r.popupBgAlpha;for(var i=this.numChildren-1;i>-1;i--){var a=this.getChildAt(i);if(a.isPopupCenter)this._centerDialog(a)}}_centerDialog(t){t.x=Math.round((b.ILaya.stage.width-t.width>>1)+t.pivotX);t.y=Math.round((b.ILaya.stage.height-t.height>>1)+t.pivotY)}open(t,e=false,o=false){if(e)this._closeAll();this._clearDialogEffect(t);if(t.isPopupCenter)this._centerDialog(t);this.addChild(t);if(t.isModal||this._getBit(b.Const.HAS_ZORDER))b.ILaya.timer.callLater(this,this._checkMask);if(o&&t.popupEffect!=null)t.popupEffect.runWith(t);else this.doOpen(t);this.event(b.Event.OPEN)}_clearDialogEffect(t){if(t._effectTween){b.Tween.clear(t._effectTween);t._effectTween=null}}doOpen(t){t.onOpened(t._param)}lock(t){if(this.lockLayer){if(t)this.addChild(this.lockLayer);else this.lockLayer.removeSelf()}}close(t){this._clearDialogEffect(t);if(t.isShowEffect&&t.closeEffect!=null)t.closeEffect.runWith([t]);else this.doClose(t);this.event(b.Event.CLOSE)}doClose(t){t.removeSelf();t.isModal&&this._checkMask();t.closeHandler&&t.closeHandler.runWith(t.closeType);t.onClosed(t.closeType);if(t.autoDestroyAtClosed)t.destroy()}closeAll(){this._closeAll();this.event(b.Event.CLOSE)}_closeAll(){for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.close!=null){this.doClose(e)}}}getDialogsByGroup(t){var e=[];for(var o=this.numChildren-1;o>-1;o--){var i=this.getChildAt(o);if(i&&i.group===t){e.push(i)}}return e}closeByGroup(t){var e=[];for(var o=this.numChildren-1;o>-1;o--){var i=this.getChildAt(o);if(i&&i.group===t){i.close();e.push(i)}}return e}_checkMask(){this.maskLayer.removeSelf();for(var t=this.numChildren-1;t>-1;t--){var e=this.getChildAt(t);if(e&&e.isModal){this.addChildAt(this.maskLayer,t);return}}}}b.ClassUtils.regClass("laya.ui.DialogManager",z);b.ClassUtils.regClass("Laya.DialogManager",z);class V extends E{constructor(){super();this.isShowEffect=true;this.isPopupCenter=true;this.popupEffect=V.manager.popupEffectHandler;this.closeEffect=V.manager.closeEffectHandler;this._dealDragArea();this.on(b.Event.CLICK,this,this._onClick)}static get manager(){return V._manager=V._manager||new z}static set manager(t){V._manager=t}_dealDragArea(){var t=this.getChildByName("drag");if(t){this.dragArea=t._x+","+t._y+","+t.width+","+t.height;t.removeSelf()}}get dragArea(){if(this._dragArea)return this._dragArea.toString();return null}set dragArea(t){if(t){var e=x.fillArray([0,0,0,0],t,Number);this._dragArea=new b.Rectangle(e[0],e[1],e[2],e[3]);this.on(b.Event.MOUSE_DOWN,this,this._onMouseDown)}else{this._dragArea=null;this.off(b.Event.MOUSE_DOWN,this,this._onMouseDown)}}_onMouseDown(t){var e=this.getMousePoint();if(this._dragArea.contains(e.x,e.y))this.startDrag();else this.stopDrag()}_onClick(t){var e=t.target;if(e){switch(e.name){case V.CLOSE:case V.CANCEL:case V.SURE:case V.NO:case V.OK:case V.YES:this.close(e.name);return}}}open(t=true,e=null){this._dealDragArea();this._param=e;V.manager.open(this,t,this.isShowEffect);V.manager.lock(false)}close(t=null){this.closeType=t;V.manager.close(this)}destroy(t=true){this.closeHandler=null;this.popupEffect=null;this.closeEffect=null;this._dragArea=null;super.destroy(t)}show(t=false,e=true){this._open(false,t,e)}popup(t=false,e=true){this._open(true,t,e)}_open(t,e,o){this.isModal=t;this.isShowEffect=o;V.manager.lock(true);this.open(e)}get isPopup(){return this.parent!=null}set zOrder(t){super.zOrder=t;V.manager._checkMask()}get zOrder(){return super.zOrder}static setLockView(t){V.manager.setLockView(t)}static lock(t){V.manager.lock(t)}static closeAll(){V.manager.closeAll()}static getDialogsByGroup(t){return V.manager.getDialogsByGroup(t)}static closeByGroup(t){return V.manager.closeByGroup(t)}}V.CLOSE="close";V.CANCEL="cancel";V.SURE="sure";V.NO="no";V.YES="yes";V.OK="ok";U.Dialog=V;b.ILaya.regClass(V);b.ClassUtils.regClass("laya.ui.Dialog",V);b.ClassUtils.regClass("Laya.Dialog",V);class R extends a{constructor(){super();this._tipBox=new a;this._tipBox.addChild(this._tipText=new b.Text);this._tipText.x=this._tipText.y=5;this._tipText.color=R.tipTextColor;this._defaultTipHandler=this._showDefaultTip;b.ILaya.stage.on(i.SHOW_TIP,this,this._onStageShowTip);b.ILaya.stage.on(i.HIDE_TIP,this,this._onStageHideTip);this.zOrder=1100}_onStageHideTip(t){b.ILaya.timer.clear(this,this._showTip);this.closeAll();this.removeSelf()}_onStageShowTip(t){b.ILaya.timer.once(R.tipDelay,this,this._showTip,[t],true)}_showTip(t){if(typeof t=="string"){var e=String(t);if(Boolean(e)){this._defaultTipHandler(e)}}else if(t instanceof b.Handler){t.run()}else if(t instanceof Function){t.apply()}{b.ILaya.stage.on(b.Event.MOUSE_MOVE,this,this._onStageMouseMove);b.ILaya.stage.on(b.Event.MOUSE_DOWN,this,this._onStageMouseDown)}this._onStageMouseMove(null)}_onStageMouseDown(t){this.closeAll()}_onStageMouseMove(t){this._showToStage(this,R.offsetX,R.offsetY)}_showToStage(t,e=0,o=0){var i=t.getBounds();t.x=b.ILaya.stage.mouseX+e;t.y=b.ILaya.stage.mouseY+o;if(t._x+i.width>b.ILaya.stage.width){t.x-=i.width+e}if(t._y+i.height>b.ILaya.stage.height){t.y-=i.height+o}}closeAll(){b.ILaya.timer.clear(this,this._showTip);b.ILaya.stage.off(b.Event.MOUSE_MOVE,this,this._onStageMouseMove);b.ILaya.stage.off(b.Event.MOUSE_DOWN,this,this._onStageMouseDown);this.removeChildren()}showDislayTip(t){this.addChild(t);this._showToStage(this);b.ILaya.stage.addChild(this)}_showDefaultTip(t){this._tipText.text=t;var e=this._tipBox.graphics;e.clear(true);e.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,R.tipBackColor);this.addChild(this._tipBox);this._showToStage(this);b.ILaya.stage.addChild(this)}get defaultTipHandler(){return this._defaultTipHandler}set defaultTipHandler(t){this._defaultTipHandler=t}}R.offsetX=10;R.offsetY=15;R.tipTextColor="#ffffff";R.tipBackColor="#111111";R.tipDelay=200;b.ILaya.regClass(R);b.ClassUtils.regClass("laya.ui.TipManager",R);b.ClassUtils.regClass("Laya.TipManager",R);class X{static __init__(){}}class H extends a{constructor(){super();this._width=this._height=200;var t=new b.Texture;t.bitmap=new b.Texture2D;this.texture=t}onEnable(){this.postMsg({type:"display",rate:b.Laya.stage.frameRate});if(window.wx&&window.sharedCanvas)b.Laya.timer.frameLoop(1,this,this._onLoop)}onDisable(){this.postMsg({type:"undisplay"});b.Laya.timer.clear(this,this._onLoop)}_onLoop(){this.texture.bitmap.loadImageSource(window.sharedCanvas)}set width(t){super.width=t;if(window.sharedCanvas)window.sharedCanvas.width=t;this.callLater(this._postMsg)}get width(){return super.width}set height(t){super.height=t;if(window.sharedCanvas)window.sharedCanvas.height=t;this.callLater(this._postMsg)}get height(){return super.width}set x(t){super.x=t;this.callLater(this._postMsg)}get x(){return super.x}set y(t){super.y=t;this.callLater(this._postMsg)}get y(){return super.y}_postMsg(){var t=new b.Matrix;t.translate(this.x,this.y);var e=b.Laya.stage;t.scale(e._canvasTransform.getScaleX()*this.globalScaleX*e.transform.getScaleX(),e._canvasTransform.getScaleY()*this.globalScaleY*e.transform.getScaleY());this.postMsg({type:"changeMatrix",a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty,w:this.width,h:this.height})}postMsg(t){if(window.wx&&window.wx.getOpenDataContext){var e=window.wx.getOpenDataContext();e.postMessage(t)}}}b.ILaya.regClass(H);b.ClassUtils.regClass("laya.ui.WXOpenDataViewer",H);b.ClassUtils.regClass("Laya.WXOpenDataViewer",H);t.AdvImage=G;t.AutoBitmap=e;t.Box=d;t.Button=l;t.CheckBox=_;t.Clip=h;t.ColorPicker=p;t.ComboBox=v;t.Dialog=V;t.DialogManager=z;t.FontClip=W;t.HBox=D;t.HScrollBar=f;t.HSlider=J;t.IUI=U;t.Image=n;t.Label=c;t.LayoutBox=I;t.List=g;t.Panel=k;t.ProgressBar=S;t.Radio=C;t.RadioGroup=A;t.ScaleBox=F;t.ScrollBar=y;t.Slider=u;t.Styles=s;t.Tab=B;t.TextArea=M;t.TextInput=T;t.TipManager=R;t.Tree=N;t.UIComponent=a;t.UIConfig=r;t.UIEvent=i;t.UIGroup=P;t.UILib=X;t.UIUtils=x;t.VBox=L;t.VScrollBar=m;t.VSlider=O;t.View=E;t.ViewStack=w;t.WXOpenDataViewer=H;t.Widget=o})(window.Laya=window.Laya||{},Laya);var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(t){return void 0!==t};goog.exportPath_=function(t,e,o){t=t.split(".");o=o||goog.global;t[0]in o||!o.execScript||o.execScript("var "+t[0]);for(var i;t.length&&(i=t.shift());)!t.length&&goog.isDef(e)?o[i]=e:o=o[i]?o[i]:o[i]={}};goog.define=function(t,e){var o=e;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,t)?o=goog.global.CLOSURE_UNCOMPILED_DEFINES[t]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,t)&&(o=goog.global.CLOSURE_DEFINES[t]));goog.exportPath_(t,o)};goog.DEBUG=!1;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(t){if(!COMPILED&&goog.isProvided_(t))throw Error('Namespace "'+t+'" already declared.');goog.constructNamespace_(t)};goog.constructNamespace_=function(t,e){if(!COMPILED){delete goog.implicitNamespaces_[t];for(var o=t;(o=o.substring(0,o.lastIndexOf(".")))&&!goog.getObjectByName(o);)goog.implicitNamespaces_[o]=!0}goog.exportPath_(t,e)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;goog.module=function(t){if(!goog.isString(t)||!t||-1==t.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+t+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=t;if(!COMPILED){if(goog.isProvided_(t))throw Error('Namespace "'+t+'" already declared.');delete goog.implicitNamespaces_[t]}};goog.module.get=function(t){return goog.module.getInternal_(t)};goog.module.getInternal_=function(t){if(!COMPILED)return goog.isProvided_(t)?t in goog.loadedModules_?goog.loadedModules_[t]:goog.getObjectByName(t):null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.setTestOnly=function(t){if(goog.DISALLOW_TEST_ONLY_CODE)throw t=t||"",Error("Importing test-only code into non-debug environment"+(t?": "+t:"."))};goog.forwardDeclare=function(t){};COMPILED||(goog.isProvided_=function(t){return t in goog.loadedModules_||!goog.implicitNamespaces_[t]&&goog.isDefAndNotNull(goog.getObjectByName(t))},goog.implicitNamespaces_={"goog.module":!0});goog.getObjectByName=function(t,e){for(var o=t.split("."),i=e||goog.global,a;a=o.shift();)if(goog.isDefAndNotNull(i[a]))i=i[a];else return null;return i};goog.globalize=function(t,e){var o=e||goog.global,i;for(i in t)o[i]=t[i]};goog.addDependency=function(t,e,o,i){if(goog.DEPENDENCIES_ENABLED){var a;t=t.replace(/\\/g,"/");for(var r=goog.dependencies_,s=0;a=e[s];s++)r.nameToPath[a]=t,r.pathIsModule[t]=!!i;for(i=0;e=o[i];i++)t in r.requires||(r.requires[t]={}),r.requires[t][e]=!0}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(t){goog.global.console&&goog.global.console.error(t)};goog.require=function(t){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(t);if(goog.isProvided_(t))return goog.isInModuleLoader_()?goog.module.getInternal_(t):null;if(goog.ENABLE_DEBUG_LOADER){var e=goog.getPathFromDeps_(t);if(e)return goog.writeScripts_(e),null}t="goog.require could not find: "+t;goog.logToConsole_(t);throw Error(t)}};goog.basePath="";goog.nullFunction=function(){};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(t){t.getInstance=function(){if(t.instance_)return t.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=t);return t.instance_=new t}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var t=goog.global.document;return null!=t&&"write"in t},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var t=goog.global.document.getElementsByTagName("SCRIPT"),e=t.length-1;0<=e;--e){var o=t[e].src,i=o.lastIndexOf("?"),i=-1==i?o.length:i;if("base.js"==o.substr(i-7,7)){goog.basePath=o.substr(0,i-7);break}}},goog.importScript_=function(t,e){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(t,e)&&(goog.dependencies_.written[t]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importModule_=function(t){goog.importScript_("",'goog.retrieveAndExecModule_("'+t+'");')&&(goog.dependencies_.written[t]=!0)},goog.queuedModules_=[],goog.wrapModule_=function(t,e){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+t+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+t+"\n"},goog.loadQueuedModules_=function(){var t=goog.queuedModules_.length;if(0<t){var e=goog.queuedModules_;goog.queuedModules_=[];for(var o=0;o<t;o++)goog.maybeProcessDeferredPath_(e[o])}},goog.maybeProcessDeferredDep_=function(t){goog.isDeferredModule_(t)&&goog.allDepsAreAvailable_(t)&&(t=goog.getPathFromDeps_(t),goog.maybeProcessDeferredPath_(goog.basePath+t))},goog.isDeferredModule_=function(t){return(t=goog.getPathFromDeps_(t))&&goog.dependencies_.pathIsModule[t]?goog.basePath+t in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(t){if((t=goog.getPathFromDeps_(t))&&t in goog.dependencies_.requires)for(var e in goog.dependencies_.requires[t])if(!goog.isProvided_(e)&&!goog.isDeferredModule_(e))return!1;return!0},goog.maybeProcessDeferredPath_=function(t){if(t in goog.dependencies_.deferred){var e=goog.dependencies_.deferred[t];delete goog.dependencies_.deferred[t];goog.globalEval(e)}},goog.loadModuleFromUrl=function(t){goog.retrieveAndExecModule_(t)},goog.loadModule=function(t){var e=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1};var o;if(goog.isFunction(t))o=t.call(goog.global,{});else if(goog.isString(t))o=goog.loadModuleFromSource_.call(goog.global,t);else throw Error("Invalid module definition");var i=goog.moduleLoaderState_.moduleName;if(!goog.isString(i)||!i)throw Error('Invalid module name "'+i+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(i,o):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(o);goog.loadedModules_[i]=o}finally{goog.moduleLoaderState_=e}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptSrcNode_=function(t){goog.global.document.write('<script type="text/javascript" src="'+t+'"><\/script>')},goog.appendScriptSrcNode_=function(t){var e=goog.global.document,o=e.createElement("script");o.type="text/javascript";o.src=t;o.defer=!1;o.async=!1;e.head.appendChild(o)},goog.writeScriptTag_=function(t,e){if(goog.inHtmlDocument_()){var o=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==o.readyState){if(/\bdeps.js$/.test(t))return!1;throw Error('Cannot write "'+t+'" after document load')}var i=goog.IS_OLD_IE_;void 0===e?i?(i=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",o.write('<script type="text/javascript" src="'+t+'"'+i+"><\/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(t):goog.writeScriptSrcNode_(t):o.write('<script type="text/javascript">'+e+"<\/script>");return!0}return!1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(t,e){"complete"==t.readyState&&goog.lastNonModuleScriptIndex_==e&&goog.loadQueuedModules_();return!0},goog.writeScripts_=function(t){function o(t){if(!(t in r.written||t in r.visited)){r.visited[t]=!0;if(t in r.requires)for(var e in r.requires[t])if(!goog.isProvided_(e))if(e in r.nameToPath)o(r.nameToPath[e]);else throw Error("Undefined nameToPath for "+e);t in a||(a[t]=!0,i.push(t))}}var i=[],a={},r=goog.dependencies_;o(t);for(t=0;t<i.length;t++){var e=i[t];goog.dependencies_.written[e]=!0}var s=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(t=0;t<i.length;t++)if(e=i[t])r.pathIsModule[e]?goog.importModule_(goog.basePath+e):goog.importScript_(goog.basePath+e);else throw goog.moduleLoaderState_=s,Error("Undefined script input");goog.moduleLoaderState_=s},goog.getPathFromDeps_=function(t){return t in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[t]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.normalizePath_=function(t){t=t.split("/");for(var e=0;e<t.length;)"."==t[e]?t.splice(e,1):e&&".."==t[e]&&t[e-1]&&".."!=t[e-1]?t.splice(--e,2):e++;return t.join("/")};goog.loadFileSync_=function(t){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(t);var e=new goog.global.XMLHttpRequest;e.open("get",t,!1);e.send();return e.responseText};goog.retrieveAndExecModule_=function(t){if(!COMPILED){var e=t;t=goog.normalizePath_(t);var o=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,i=goog.loadFileSync_(t);if(null!=i)i=goog.wrapModule_(t,i),goog.IS_OLD_IE_?(goog.dependencies_.deferred[e]=i,goog.queuedModules_.push(e)):o(t,i);else throw Error("load of "+t+"failed")}};goog.typeOf=function(t){var e=typeof t;if("object"==e)if(t){if(t instanceof Array)return"array";if(t instanceof Object)return e;var o=Object.prototype.toString.call(t);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==e&&"undefined"==typeof t.call)return"object";return e};goog.isNull=function(t){return null===t};goog.isDefAndNotNull=function(t){return null!=t};goog.isArray=function(t){return"array"==goog.typeOf(t)};goog.isArrayLike=function(t){var e=goog.typeOf(t);return"array"==e||"object"==e&&"number"==typeof t.length};goog.isDateLike=function(t){return goog.isObject(t)&&"function"==typeof t.getFullYear};goog.isString=function(t){return"string"==typeof t};goog.isBoolean=function(t){return"boolean"==typeof t};goog.isNumber=function(t){return"number"==typeof t};goog.isFunction=function(t){return"function"==goog.typeOf(t)};goog.isObject=function(t){var e=typeof t;return"object"==e&&null!=t||"function"==e};goog.getUid=function(t){return t[goog.UID_PROPERTY_]||(t[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(t){return!!t[goog.UID_PROPERTY_]};goog.removeUid=function(t){null!==t&&"removeAttribute"in t&&t.removeAttribute(goog.UID_PROPERTY_);try{delete t[goog.UID_PROPERTY_]}catch(t){}};goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(t){var e=goog.typeOf(t);if("object"==e||"array"==e){if(t.clone)return t.clone();var e="array"==e?[]:{},o;for(o in t)e[o]=goog.cloneObject(t[o]);return e}return t};goog.bindNative_=function(t,e,o){return t.call.apply(t.bind,arguments)};goog.bindJs_=function(e,o,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(t,i);return e.apply(o,t)}}return function(){return e.apply(o,arguments)}};goog.bind=function(t,e,o){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(e,t){var o=Array.prototype.slice.call(arguments,1);return function(){var t=o.slice();t.push.apply(t,arguments);return e.apply(this,t)}};goog.mixin=function(t,e){for(var o in e)t[o]=e[o]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};goog.globalEval=function(t){if(goog.global.execScript)goog.global.execScript(t,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(t){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(t);else{var e=goog.global.document,o=e.createElement("SCRIPT");o.type="text/javascript";o.defer=!1;o.appendChild(e.createTextNode(t));e.body.appendChild(o);e.body.removeChild(o)}}else throw Error("goog.globalEval not available")};goog.evalWorksForGlobals_=null;goog.getCssName=function(t,e){var i=function(t){return goog.cssNameMapping_[t]||t},o=function(t){t=t.split("-");for(var e=[],o=0;o<t.length;o++)e.push(i(t[o]));return e.join("-")},o=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?i:o:function(t){return t};return e?t+"-"+o(e):o(t)};goog.setCssNameMapping=function(t,e){goog.cssNameMapping_=t;goog.cssNameMappingStyle_=e};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(t,o){o&&(t=t.replace(/\{\$([^}]+)}/g,function(t,e){return null!=o&&e in o?o[e]:t}));return t};goog.getMsgWithFallback=function(t,e){return t};goog.exportSymbol=function(t,e,o){goog.exportPath_(t,e,o)};goog.exportProperty=function(t,e,o){t[e]=o};goog.inherits=function(t,r){function e(){}e.prototype=r.prototype;t.superClass_=r.prototype;t.prototype=new e;t.prototype.constructor=t;t.base=function(t,e,o){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return r.prototype[e].apply(t,i)}};goog.base=function(t,e,o){var i=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!i)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(i.superClass_){for(var a=Array(arguments.length-1),r=1;r<arguments.length;r++)a[r-1]=arguments[r];return i.superClass_.constructor.apply(t,a)}a=Array(arguments.length-2);for(r=2;r<arguments.length;r++)a[r-2]=arguments[r];for(var r=!1,s=t.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[e]===i)r=!0;else if(r)return s.prototype[e].apply(t,a);if(t[e]===i)return t.constructor.prototype[e].apply(t,a);throw Error("goog.base called from a method of one name to a method of a different name")};goog.scope=function(t){t.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);goog.defineClass=function(t,e){var o=e.constructor,i=e.statics;o&&o!=Object.prototype.constructor||(o=function(){throw Error("cannot instantiate an interface (no constructor defined).")});o=goog.defineClass.createSealingConstructor_(o,t);t&&goog.inherits(o,t);delete e.constructor;delete e.statics;goog.defineClass.applyProperties_(o.prototype,e);null!=i&&(i instanceof Function?i(o):goog.defineClass.applyProperties_(o,i));return o};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;goog.defineClass.createSealingConstructor_=function(e,t){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(t&&t.prototype&&t.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return e;var o=function(){var t=e.apply(this,arguments)||this;t[goog.UID_PROPERTY_]=t[goog.UID_PROPERTY_];this.constructor===o&&Object.seal(t);return t};return o}return e};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.defineClass.applyProperties_=function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);for(var i=0;i<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;i++)o=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i],Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])};goog.tagUnsealableClass=function(t){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(t.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";var box2d={b2Settings:{}};Object.defineProperty||(Object.defineProperty=function(t,e,o){Object.__defineGetter__&&("get"in o?t.__defineGetter__(e,o.get):"value"in o&&t.__defineGetter__(e,o.value));Object.__defineSetter__&&("set"in o?t.__defineSetter__(e,o.set):"value"in o&&t.__defineSetter__(e,o.value));return t});box2d.DEBUG=!0;goog.exportSymbol("box2d.DEBUG",box2d.DEBUG);box2d.ENABLE_ASSERTS=box2d.DEBUG;goog.exportSymbol("box2d.ENABLE_ASSERTS",box2d.ENABLE_ASSERTS);box2d.b2Assert=function(t,e,o){if(box2d.DEBUG&&!t)throw Error()};goog.exportSymbol("box2d.b2Assert",box2d.b2Assert);box2d.b2_maxFloat=1e37;goog.exportSymbol("box2d.b2_maxFloat",box2d.b2_maxFloat);box2d.b2_epsilon=1e-5;goog.exportSymbol("box2d.b2_epsilon",box2d.b2_epsilon);box2d.b2_epsilon_sq=box2d.b2_epsilon*box2d.b2_epsilon;goog.exportSymbol("box2d.b2_epsilon_sq",box2d.b2_epsilon_sq);box2d.b2_pi=Math.PI;goog.exportSymbol("box2d.b2_pi",box2d.b2_pi);box2d.b2_maxManifoldPoints=2;goog.exportSymbol("box2d.b2_maxManifoldPoints",box2d.b2_maxManifoldPoints);box2d.b2_maxPolygonVertices=8;goog.exportSymbol("box2d.b2_maxPolygonVertices",box2d.b2_maxPolygonVertices);box2d.b2_aabbExtension=.1;goog.exportSymbol("box2d.b2_aabbExtension",box2d.b2_aabbExtension);box2d.b2_aabbMultiplier=2;goog.exportSymbol("box2d.b2_aabbMultiplier",box2d.b2_aabbMultiplier);box2d.b2_linearSlop=.008;goog.exportSymbol("box2d.b2_linearSlop",box2d.b2_linearSlop);box2d.b2_angularSlop=2/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_angularSlop",box2d.b2_angularSlop);box2d.b2_polygonRadius=2*box2d.b2_linearSlop;goog.exportSymbol("box2d.b2_polygonRadius",box2d.b2_polygonRadius);box2d.b2_maxSubSteps=8;goog.exportSymbol("box2d.b2_maxSubSteps",box2d.b2_maxSubSteps);box2d.b2_maxTOIContacts=32;goog.exportSymbol("box2d.b2_maxTOIContacts",box2d.b2_maxTOIContacts);box2d.b2_velocityThreshold=1;goog.exportSymbol("box2d.b2_velocityThreshold",box2d.b2_velocityThreshold);box2d.b2_maxLinearCorrection=.2;goog.exportSymbol("box2d.b2_maxLinearCorrection",box2d.b2_maxLinearCorrection);box2d.b2_maxAngularCorrection=8/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_maxAngularCorrection",box2d.b2_maxAngularCorrection);box2d.b2_maxTranslation=2;goog.exportSymbol("box2d.b2_maxTranslation",box2d.b2_maxTranslation);box2d.b2_maxTranslationSquared=box2d.b2_maxTranslation*box2d.b2_maxTranslation;goog.exportSymbol("box2d.b2_maxTranslationSquared",box2d.b2_maxTranslationSquared);box2d.b2_maxRotation=.5*box2d.b2_pi;goog.exportSymbol("box2d.b2_maxRotation",box2d.b2_maxRotation);box2d.b2_maxRotationSquared=box2d.b2_maxRotation*box2d.b2_maxRotation;goog.exportSymbol("box2d.b2_maxRotationSquared",box2d.b2_maxRotationSquared);box2d.b2_baumgarte=.2;goog.exportSymbol("box2d.b2_baumgarte",box2d.b2_baumgarte);box2d.b2_toiBaumgarte=.75;goog.exportSymbol("box2d.b2_toiBaumgarte",box2d.b2_toiBaumgarte);box2d.b2_invalidParticleIndex=-1;goog.exportSymbol("box2d.b2_invalidParticleIndex",box2d.b2_invalidParticleIndex);box2d.b2_maxParticleIndex=2147483647;goog.exportSymbol("box2d.b2_maxParticleIndex",box2d.b2_maxParticleIndex);box2d.b2_particleStride=.75;goog.exportSymbol("box2d.b2_particleStride",box2d.b2_particleStride);box2d.b2_minParticleWeight=1;goog.exportSymbol("box2d.b2_minParticleWeight",box2d.b2_minParticleWeight);box2d.b2_maxParticlePressure=.25;goog.exportSymbol("box2d.b2_maxParticlePressure",box2d.b2_maxParticlePressure);box2d.b2_maxParticleForce=.5;goog.exportSymbol("box2d.b2_maxParticleForce",box2d.b2_maxParticleForce);box2d.b2_maxTriadDistance=2;goog.exportSymbol("box2d.b2_maxTriadDistance",box2d.b2_maxTriadDistance);box2d.b2_maxTriadDistanceSquared=box2d.b2_maxTriadDistance*box2d.b2_maxTriadDistance;goog.exportSymbol("box2d.b2_maxTriadDistanceSquared",box2d.b2_maxTriadDistanceSquared);box2d.b2_minParticleSystemBufferCapacity=256;goog.exportSymbol("box2d.b2_minParticleSystemBufferCapacity",box2d.b2_minParticleSystemBufferCapacity);box2d.b2_barrierCollisionTime=2.5;goog.exportSymbol("box2d.b2_barrierCollisionTime",box2d.b2_barrierCollisionTime);box2d.b2_timeToSleep=.5;goog.exportSymbol("box2d.b2_timeToSleep",box2d.b2_timeToSleep);box2d.b2_linearSleepTolerance=.01;goog.exportSymbol("box2d.b2_linearSleepTolerance",box2d.b2_linearSleepTolerance);box2d.b2_angularSleepTolerance=2/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_angularSleepTolerance",box2d.b2_angularSleepTolerance);box2d.b2Alloc=function(t){return null};goog.exportSymbol("box2d.b2Alloc",box2d.b2Alloc);box2d.b2Free=function(t){};goog.exportSymbol("box2d.b2Free",box2d.b2Free);box2d.b2Log=function(t){goog.global.console.log.apply(null,arguments)};goog.exportSymbol("box2d.b2Log",box2d.b2Log);box2d.b2Version=function(t,e,o){this.major=t||0;this.minor=e||0;this.revision=o||0};goog.exportSymbol("box2d.b2Version",box2d.b2Version);box2d.b2Version.prototype.major=0;goog.exportProperty(box2d.b2Version.prototype,"major",box2d.b2Version.prototype.major);box2d.b2Version.prototype.minor=0;goog.exportProperty(box2d.b2Version.prototype,"minor",box2d.b2Version.prototype.minor);box2d.b2Version.prototype.revision=0;goog.exportProperty(box2d.b2Version.prototype,"revision",box2d.b2Version.prototype.revision);box2d.b2Version.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision};goog.exportProperty(box2d.b2Version.prototype,"toString",box2d.b2Version.prototype.toString);box2d.b2_version=new box2d.b2Version(2,3,2);goog.exportSymbol("box2d.b2_version",box2d.b2_version);box2d.b2_changelist=313;goog.exportSymbol("box2d.b2_changelist",box2d.b2_changelist);box2d.b2ParseInt=function(t){return parseInt(t,10)};goog.exportSymbol("box2d.b2ParseInt",box2d.b2ParseInt);box2d.b2ParseUInt=function(t){return box2d.b2Abs(parseInt(t,10))};goog.exportSymbol("box2d.b2ParseUInt",box2d.b2ParseUInt);box2d.b2MakeArray=function(t,e){t="number"===typeof t?t:0;var o=[];if("function"===typeof e)for(var i=0;i<t;++i)o.push(e(i));else for(i=0;i<t;++i)o.push(null);return o};goog.exportSymbol("box2d.b2MakeArray",box2d.b2MakeArray);box2d.b2MakeNumberArray=function(t){return box2d.b2MakeArray(t,function(t){return 0})};goog.exportSymbol("box2d.b2MakeNumberArray",box2d.b2MakeNumberArray);box2d.b2Color=function(t,e,o,i){this.r=t;this.g=e;this.b=o;this.a="number"===typeof i?i:1};goog.exportSymbol("box2d.b2Color",box2d.b2Color);box2d.b2Color.prototype.r=.5;goog.exportProperty(box2d.b2Color.prototype,"r",box2d.b2Color.prototype.r);box2d.b2Color.prototype.g=.5;goog.exportProperty(box2d.b2Color.prototype,"g",box2d.b2Color.prototype.g);box2d.b2Color.prototype.b=.5;goog.exportProperty(box2d.b2Color.prototype,"b",box2d.b2Color.prototype.b);box2d.b2Color.prototype.a=1;goog.exportProperty(box2d.b2Color.prototype,"a",box2d.b2Color.prototype.a);box2d.b2Color.prototype.SetRGB=function(t,e,o){this.r=t;this.g=e;this.b=o;return this};goog.exportProperty(box2d.b2Color.prototype,"SetRGB",box2d.b2Color.prototype.SetRGB);box2d.b2Color.prototype.MakeStyleString=function(t){return box2d.b2Color.MakeStyleString(Math.round(Math.max(0,Math.min(255,255*this.r))),Math.round(Math.max(0,Math.min(255,255*this.g))),Math.round(Math.max(0,Math.min(255,255*this.b))),"undefined"===typeof t?this.a:Math.max(0,Math.min(1,t)))};goog.exportProperty(box2d.b2Color.prototype,"MakeStyleString",box2d.b2Color.prototype.MakeStyleString);box2d.b2Color.MakeStyleString=function(t,e,o,i){return 1>i?"rgba("+t+","+e+","+o+","+i+")":"rgb("+t+","+e+","+o+")"};goog.exportProperty(box2d.b2Color,"MakeStyleString",box2d.b2Color.MakeStyleString);box2d.b2Color.RED=new box2d.b2Color(1,0,0);goog.exportProperty(box2d.b2Color,"RED",box2d.b2Color.RED);box2d.b2Color.GREEN=new box2d.b2Color(0,1,0);goog.exportProperty(box2d.b2Color,"GREEN",box2d.b2Color.GREEN);box2d.b2Color.BLUE=new box2d.b2Color(0,0,1);goog.exportProperty(box2d.b2Color,"BLUE",box2d.b2Color.BLUE);box2d.b2DrawFlags={e_none:0,e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,e_controllerBit:32,e_particleBit:64,e_all:65535};goog.exportSymbol("box2d.b2DrawFlags",box2d.b2DrawFlags);goog.exportProperty(box2d.b2DrawFlags,"e_none",box2d.b2DrawFlags.e_none);goog.exportProperty(box2d.b2DrawFlags,"e_shapeBit",box2d.b2DrawFlags.e_shapeBit);goog.exportProperty(box2d.b2DrawFlags,"e_jointBit",box2d.b2DrawFlags.e_jointBit);goog.exportProperty(box2d.b2DrawFlags,"e_aabbBit",box2d.b2DrawFlags.e_aabbBit);goog.exportProperty(box2d.b2DrawFlags,"e_pairBit",box2d.b2DrawFlags.e_pairBit);goog.exportProperty(box2d.b2DrawFlags,"e_centerOfMassBit",box2d.b2DrawFlags.e_centerOfMassBit);goog.exportProperty(box2d.b2DrawFlags,"e_controllerBit",box2d.b2DrawFlags.e_controllerBit);goog.exportProperty(box2d.b2DrawFlags,"e_particleBit",box2d.b2DrawFlags.e_particleBit);goog.exportProperty(box2d.b2DrawFlags,"e_all",box2d.b2DrawFlags.e_all);box2d.b2Draw=function(){};goog.exportSymbol("box2d.b2Draw",box2d.b2Draw);box2d.b2Draw.prototype.m_drawFlags=box2d.b2DrawFlags.e_none;goog.exportProperty(box2d.b2Draw.prototype,"m_drawFlags",box2d.b2Draw.prototype.m_drawFlags);box2d.b2Draw.prototype.SetFlags=function(t){this.m_drawFlags=t};goog.exportProperty(box2d.b2Draw.prototype,"SetFlags",box2d.b2Draw.prototype.SetFlags);box2d.b2Draw.prototype.GetFlags=function(){return this.m_drawFlags};goog.exportProperty(box2d.b2Draw.prototype,"GetFlags",box2d.b2Draw.prototype.GetFlags);box2d.b2Draw.prototype.AppendFlags=function(t){this.m_drawFlags|=t};goog.exportProperty(box2d.b2Draw.prototype,"AppendFlags",box2d.b2Draw.prototype.AppendFlags);box2d.b2Draw.prototype.ClearFlags=function(t){this.m_drawFlags&=~t};goog.exportProperty(box2d.b2Draw.prototype,"ClearFlags",box2d.b2Draw.prototype.ClearFlags);box2d.b2Draw.prototype.PushTransform=function(t){};goog.exportProperty(box2d.b2Draw.prototype,"PushTransform",box2d.b2Draw.prototype.PushTransform);box2d.b2Draw.prototype.PopTransform=function(t){};goog.exportProperty(box2d.b2Draw.prototype,"PopTransform",box2d.b2Draw.prototype.PopTransform);box2d.b2Draw.prototype.DrawPolygon=function(t,e,o){};goog.exportProperty(box2d.b2Draw.prototype,"DrawPolygon",box2d.b2Draw.prototype.DrawPolygon);box2d.b2Draw.prototype.DrawSolidPolygon=function(t,e,o){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidPolygon",box2d.b2Draw.prototype.DrawSolidPolygon);box2d.b2Draw.prototype.DrawCircle=function(t,e,o){};goog.exportProperty(box2d.b2Draw.prototype,"DrawCircle",box2d.b2Draw.prototype.DrawCircle);box2d.b2Draw.prototype.DrawSolidCircle=function(t,e,o,i){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidCircle",box2d.b2Draw.prototype.DrawSolidCircle);box2d.b2Draw.prototype.DrawParticles=function(t,e,o,i){};goog.exportProperty(box2d.b2Draw.prototype,"DrawParticles",box2d.b2Draw.prototype.DrawParticles);box2d.b2Draw.prototype.DrawSegment=function(t,e,o){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSegment",box2d.b2Draw.prototype.DrawSegment);box2d.b2Draw.prototype.DrawTransform=function(t){};goog.exportProperty(box2d.b2Draw.prototype,"DrawTransform",box2d.b2Draw.prototype.DrawTransform);box2d.b2GrowableStack=function(t){this.m_stack=Array(t)};goog.exportSymbol("box2d.b2GrowableStack",box2d.b2GrowableStack);box2d.b2GrowableStack.prototype.m_stack=null;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_stack",box2d.b2GrowableStack.prototype.m_stack);box2d.b2GrowableStack.prototype.m_count=0;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_count",box2d.b2GrowableStack.prototype.m_count);box2d.b2GrowableStack.prototype.Reset=function(){this.m_count=0;return this};goog.exportProperty(box2d.b2GrowableStack.prototype,"Reset",box2d.b2GrowableStack.prototype.Reset);box2d.b2GrowableStack.prototype.Push=function(t){this.m_stack[this.m_count]=t;++this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"Push",box2d.b2GrowableStack.prototype.Push);box2d.b2GrowableStack.prototype.Pop=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_count);--this.m_count;var t=this.m_stack[this.m_count];this.m_stack[this.m_count]=null;return t};goog.exportProperty(box2d.b2GrowableStack.prototype,"Pop",box2d.b2GrowableStack.prototype.Pop);box2d.b2GrowableStack.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"GetCount",box2d.b2GrowableStack.prototype.GetCount);box2d.b2Math={};box2d.b2_pi_over_180=box2d.b2_pi/180;goog.exportSymbol("box2d.b2_pi_over_180",box2d.b2_pi_over_180);box2d.b2_180_over_pi=180/box2d.b2_pi;goog.exportSymbol("box2d.b2_180_over_pi",box2d.b2_180_over_pi);box2d.b2_two_pi=2*box2d.b2_pi;goog.exportSymbol("box2d.b2_two_pi",box2d.b2_two_pi);box2d.b2Abs=Math.abs;goog.exportSymbol("box2d.b2Abs",box2d.b2Abs);box2d.b2Min=Math.min;goog.exportSymbol("box2d.b2Min",box2d.b2Min);box2d.b2Max=Math.max;goog.exportSymbol("box2d.b2Max",box2d.b2Max);box2d.b2Clamp=function(t,e,o){return Math.min(Math.max(t,e),o)};goog.exportSymbol("box2d.b2Clamp",box2d.b2Clamp);box2d.b2Wrap=function(t,e,o){return e<o?t<e?o-(e-t)%(o-e):e+(t-e)%(o-e):e===o?e:t};goog.exportSymbol("box2d.b2Wrap",box2d.b2Wrap);box2d.b2WrapAngle=function(t){return 0>t?(t-box2d.b2_pi)%box2d.b2_two_pi+box2d.b2_pi:(t+box2d.b2_pi)%box2d.b2_two_pi-box2d.b2_pi};goog.exportSymbol("box2d.b2WrapAngle",box2d.b2WrapAngle);box2d.b2Swap=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);var o=t[0];t[0]=e[0];e[0]=o};goog.exportSymbol("box2d.b2Swap",box2d.b2Swap);box2d.b2IsValid=function(t){return isFinite(t)};goog.exportSymbol("box2d.b2IsValid",box2d.b2IsValid);box2d.b2Sq=function(t){return t*t};goog.exportSymbol("box2d.b2Sq",box2d.b2Sq);box2d.b2InvSqrt=function(t){return 1/Math.sqrt(t)};goog.exportSymbol("box2d.b2InvSqrt",box2d.b2InvSqrt);box2d.b2Sqrt=function(t){return Math.sqrt(t)};goog.exportSymbol("box2d.b2Sqrt",box2d.b2Sqrt);box2d.b2Pow=function(t,e){return Math.pow(t,e)};goog.exportSymbol("box2d.b2Pow",box2d.b2Pow);box2d.b2DegToRad=function(t){return t*box2d.b2_pi_over_180};goog.exportSymbol("box2d.b2DegToRad",box2d.b2DegToRad);box2d.b2RadToDeg=function(t){return t*box2d.b2_180_over_pi};goog.exportSymbol("box2d.b2RadToDeg",box2d.b2RadToDeg);box2d.b2Cos=function(t){return Math.cos(t)};goog.exportSymbol("box2d.b2Cos",box2d.b2Cos);box2d.b2Sin=function(t){return Math.sin(t)};goog.exportSymbol("box2d.b2Sin",box2d.b2Sin);box2d.b2Acos=function(t){return Math.acos(t)};goog.exportSymbol("box2d.b2Acos",box2d.b2Acos);box2d.b2Asin=function(t){return Math.asin(t)};goog.exportSymbol("box2d.b2Asin",box2d.b2Asin);box2d.b2Atan2=function(t,e){return Math.atan2(t,e)};goog.exportSymbol("box2d.b2Atan2",box2d.b2Atan2);box2d.b2NextPowerOfTwo=function(t){t|=t>>1&2147483647;t|=t>>2&1073741823;t|=t>>4&268435455;t|=t>>8&16777215;return(t|t>>16&65535)+1};goog.exportSymbol("box2d.b2NextPowerOfTwo",box2d.b2NextPowerOfTwo);box2d.b2IsPowerOfTwo=function(t){return 0<t&&0===(t&t-1)};goog.exportSymbol("box2d.b2IsPowerOfTwo",box2d.b2IsPowerOfTwo);box2d.b2Random=function(){return 2*Math.random()-1};goog.exportSymbol("box2d.b2Random",box2d.b2Random);box2d.b2RandomRange=function(t,e){return(e-t)*Math.random()+t};goog.exportSymbol("box2d.b2RandomRange",box2d.b2RandomRange);box2d.b2Vec2=function(t,e){this.x=t||0;this.y=e||0};goog.exportSymbol("box2d.b2Vec2",box2d.b2Vec2);box2d.b2Vec2.prototype.x=0;goog.exportProperty(box2d.b2Vec2.prototype,"x",box2d.b2Vec2.prototype.x);box2d.b2Vec2.prototype.y=0;goog.exportProperty(box2d.b2Vec2.prototype,"y",box2d.b2Vec2.prototype.y);box2d.b2Vec2_zero=new box2d.b2Vec2;goog.exportSymbol("box2d.b2Vec2_zero",box2d.b2Vec2_zero);box2d.b2Vec2.ZERO=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"ZERO",box2d.b2Vec2.ZERO);box2d.b2Vec2.UNITX=new box2d.b2Vec2(1,0);goog.exportProperty(box2d.b2Vec2,"UNITX",box2d.b2Vec2.UNITX);box2d.b2Vec2.UNITY=new box2d.b2Vec2(0,1);goog.exportProperty(box2d.b2Vec2,"UNITY",box2d.b2Vec2.UNITY);box2d.b2Vec2.s_t0=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t0",box2d.b2Vec2.s_t0);box2d.b2Vec2.s_t1=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t1",box2d.b2Vec2.s_t1);box2d.b2Vec2.s_t2=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t2",box2d.b2Vec2.s_t2);box2d.b2Vec2.s_t3=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t3",box2d.b2Vec2.s_t3);box2d.b2Vec2.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2Vec2})};goog.exportProperty(box2d.b2Vec2,"MakeArray",box2d.b2Vec2.MakeArray);box2d.b2Vec2.prototype.Clone=function(){return new box2d.b2Vec2(this.x,this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"Clone",box2d.b2Vec2.prototype.Clone);box2d.b2Vec2.prototype.SetZero=function(){this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SetZero",box2d.b2Vec2.prototype.SetZero);box2d.b2Vec2.prototype.Set=function(t,e){this.x=t;this.y=e;return this};goog.exportProperty(box2d.b2Vec2.prototype,"Set",box2d.b2Vec2.prototype.Set);box2d.b2Vec2.prototype.Copy=function(t){this.x=t.x;this.y=t.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"Copy",box2d.b2Vec2.prototype.Copy);box2d.b2Vec2.prototype.SelfAdd=function(t){this.x+=t.x;this.y+=t.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAdd",box2d.b2Vec2.prototype.SelfAdd);box2d.b2Vec2.prototype.SelfAddXY=function(t,e){this.x+=t;this.y+=e;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAddXY",box2d.b2Vec2.prototype.SelfAddXY);box2d.b2Vec2.prototype.SelfSub=function(t){this.x-=t.x;this.y-=t.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSub",box2d.b2Vec2.prototype.SelfSub);box2d.b2Vec2.prototype.SelfSubXY=function(t,e){this.x-=t;this.y-=e;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSubXY",box2d.b2Vec2.prototype.SelfSubXY);box2d.b2Vec2.prototype.SelfMul=function(t){this.x*=t;this.y*=t;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMul",box2d.b2Vec2.prototype.SelfMul);box2d.b2Vec2.prototype.SelfMulAdd=function(t,e){this.x+=t*e.x;this.y+=t*e.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulAdd",box2d.b2Vec2.prototype.SelfMulAdd);box2d.b2Vec2.prototype.SelfMulSub=function(t,e){this.x-=t*e.x;this.y-=t*e.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulSub",box2d.b2Vec2.prototype.SelfMulSub);box2d.b2Vec2.prototype.Dot=function(t){return this.x*t.x+this.y*t.y};goog.exportProperty(box2d.b2Vec2.prototype,"Dot",box2d.b2Vec2.prototype.Dot);box2d.b2Vec2.prototype.Cross=function(t){return this.x*t.y-this.y*t.x};goog.exportProperty(box2d.b2Vec2.prototype,"Cross",box2d.b2Vec2.prototype.Cross);box2d.b2Vec2.prototype.Length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)};goog.exportProperty(box2d.b2Vec2.prototype,"Length",box2d.b2Vec2.prototype.Length);box2d.b2Vec2.prototype.LengthSquared=function(){var t=this.x,e=this.y;return t*t+e*e};goog.exportProperty(box2d.b2Vec2.prototype,"LengthSquared",box2d.b2Vec2.prototype.LengthSquared);box2d.b2Vec2.prototype.Normalize=function(){var t=this.Length();if(t>=box2d.b2_epsilon){var e=1/t;this.x*=e;this.y*=e}return t};goog.exportProperty(box2d.b2Vec2.prototype,"Normalize",box2d.b2Vec2.prototype.Normalize);box2d.b2Vec2.prototype.SelfNormalize=function(){this.Normalize();return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfNormalize",box2d.b2Vec2.prototype.SelfNormalize);box2d.b2Vec2.prototype.SelfRotate=function(t,e){var o=this.x,i=this.y;this.x=t*o-e*i;this.y=e*o+t*i;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotate",box2d.b2Vec2.prototype.SelfRotate);box2d.b2Vec2.prototype.SelfRotateAngle=function(t){return this.SelfRotate(Math.cos(t),Math.sin(t))};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotateAngle",box2d.b2Vec2.prototype.SelfRotateAngle);box2d.b2Vec2.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"IsValid",box2d.b2Vec2.prototype.IsValid);box2d.b2Vec2.prototype.SelfMin=function(t){this.x=Math.min(this.x,t.x);this.y=Math.min(this.y,t.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMin",box2d.b2Vec2.prototype.SelfMin);box2d.b2Vec2.prototype.SelfMax=function(t){this.x=Math.max(this.x,t.x);this.y=Math.max(this.y,t.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMax",box2d.b2Vec2.prototype.SelfMax);box2d.b2Vec2.prototype.SelfAbs=function(){this.x=Math.abs(this.x);this.y=Math.abs(this.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAbs",box2d.b2Vec2.prototype.SelfAbs);box2d.b2Vec2.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfNeg",box2d.b2Vec2.prototype.SelfNeg);box2d.b2Vec2.prototype.SelfSkew=function(){var t=this.x;this.x=-this.y;this.y=t;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSkew",box2d.b2Vec2.prototype.SelfSkew);box2d.b2Abs_V2=function(t,e){e.x=Math.abs(t.x);e.y=Math.abs(t.y);return e};goog.exportSymbol("box2d.b2Abs_V2",box2d.b2Abs_V2);box2d.b2Min_V2_V2=function(t,e,o){o.x=Math.min(t.x,e.x);o.y=Math.min(t.y,e.y);return o};goog.exportSymbol("box2d.b2Min_V2_V2",box2d.b2Min_V2_V2);box2d.b2Max_V2_V2=function(t,e,o){o.x=Math.max(t.x,e.x);o.y=Math.max(t.y,e.y);return o};goog.exportSymbol("box2d.b2Max_V2_V2",box2d.b2Max_V2_V2);box2d.b2Clamp_V2_V2_V2=function(t,e,o,i){i.x=Math.min(Math.max(t.x,e.x),o.x);i.y=Math.min(Math.max(t.y,e.y),o.y);return i};goog.exportSymbol("box2d.b2Clamp_V2_V2_V2",box2d.b2Clamp_V2_V2_V2);box2d.b2Dot_V2_V2=function(t,e){return t.x*e.x+t.y*e.y};goog.exportSymbol("box2d.b2Dot_V2_V2",box2d.b2Dot_V2_V2);box2d.b2Cross_V2_V2=function(t,e){return t.x*e.y-t.y*e.x};goog.exportSymbol("box2d.b2Cross_V2_V2",box2d.b2Cross_V2_V2);box2d.b2Cross_V2_S=function(t,e,o){var i=t.x;o.x=e*t.y;o.y=-e*i;return o};goog.exportSymbol("box2d.b2Cross_V2_S",box2d.b2Cross_V2_S);box2d.b2Cross_S_V2=function(t,e,o){var i=e.x;o.x=-t*e.y;o.y=t*i;return o};goog.exportSymbol("box2d.b2Cross_S_V2",box2d.b2Cross_S_V2);box2d.b2Add_V2_V2=function(t,e,o){o.x=t.x+e.x;o.y=t.y+e.y;return o};goog.exportSymbol("box2d.b2Add_V2_V2",box2d.b2Add_V2_V2);box2d.b2Sub_V2_V2=function(t,e,o){o.x=t.x-e.x;o.y=t.y-e.y;return o};goog.exportSymbol("box2d.b2Sub_V2_V2",box2d.b2Sub_V2_V2);box2d.b2Add_V2_S=function(t,e,o){o.x=t.x+e;o.y=t.y+e;return o};goog.exportSymbol("box2d.b2Add_V2_S",box2d.b2Add_V2_S);box2d.b2Sub_V2_S=function(t,e,o){o.x=t.x-e;o.y=t.y-e;return o};goog.exportSymbol("box2d.b2Sub_V2_S",box2d.b2Sub_V2_S);box2d.b2Mul_S_V2=function(t,e,o){o.x=e.x*t;o.y=e.y*t;return o};goog.exportSymbol("box2d.b2Mul_S_V2",box2d.b2Mul_S_V2);box2d.b2Mul_V2_S=function(t,e,o){o.x=t.x*e;o.y=t.y*e;return o};goog.exportSymbol("box2d.b2Mul_V2_S",box2d.b2Mul_V2_S);box2d.b2Div_V2_S=function(t,e,o){o.x=t.x/e;o.y=t.y/e;return o};goog.exportSymbol("box2d.b2Div_V2_S",box2d.b2Div_V2_S);box2d.b2AddMul_V2_S_V2=function(t,e,o,i){i.x=t.x+e*o.x;i.y=t.y+e*o.y;return i};goog.exportSymbol("box2d.b2AddMul_V2_S_V2",box2d.b2AddMul_V2_S_V2);box2d.b2SubMul_V2_S_V2=function(t,e,o,i){i.x=t.x-e*o.x;i.y=t.y-e*o.y;return i};goog.exportSymbol("box2d.b2SubMul_V2_S_V2",box2d.b2SubMul_V2_S_V2);box2d.b2AddCross_V2_S_V2=function(t,e,o,i){var a=o.x;i.x=t.x-e*o.y;i.y=t.y+e*a;return i};goog.exportSymbol("box2d.b2AddCross_V2_S_V2",box2d.b2AddCross_V2_S_V2);box2d.b2Mid_V2_V2=function(t,e,o){o.x=.5*(t.x+e.x);o.y=.5*(t.y+e.y);return o};goog.exportSymbol("box2d.b2Mid_V2_V2",box2d.b2Mid_V2_V2);box2d.b2Ext_V2_V2=function(t,e,o){o.x=.5*(e.x-t.x);o.y=.5*(e.y-t.y);return o};goog.exportSymbol("box2d.b2Ext_V2_V2",box2d.b2Ext_V2_V2);box2d.b2Distance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)};goog.exportSymbol("box2d.b2Distance",box2d.b2Distance);box2d.b2DistanceSquared=function(t,e){var o=t.x-e.x,i=t.y-e.y;return o*o+i*i};goog.exportSymbol("box2d.b2DistanceSquared",box2d.b2DistanceSquared);box2d.b2Vec3=function(t,e,o){this.x=t||0;this.y=e||0;this.z=o||0};goog.exportSymbol("box2d.b2Vec3",box2d.b2Vec3);box2d.b2Vec3.prototype.x=0;goog.exportProperty(box2d.b2Vec3.prototype,"x",box2d.b2Vec3.prototype.x);box2d.b2Vec3.prototype.y=0;goog.exportProperty(box2d.b2Vec3.prototype,"y",box2d.b2Vec3.prototype.y);box2d.b2Vec3.prototype.z=0;goog.exportProperty(box2d.b2Vec3.prototype,"z",box2d.b2Vec3.prototype.z);box2d.b2Vec3.ZERO=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"ZERO",box2d.b2Vec3.ZERO);box2d.b2Vec3.s_t0=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"s_t0",box2d.b2Vec3.s_t0);box2d.b2Vec3.prototype.Clone=function(){return new box2d.b2Vec3(this.x,this.y,this.z)};goog.exportProperty(box2d.b2Vec3.prototype,"Clone",box2d.b2Vec3.prototype.Clone);box2d.b2Vec3.prototype.SetZero=function(){this.z=this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SetZero",box2d.b2Vec3.prototype.SetZero);box2d.b2Vec3.prototype.Set=function(t,e,o){this.x=t;this.y=e;this.z=o;return this};goog.exportProperty(box2d.b2Vec3.prototype,"Set",box2d.b2Vec3.prototype.Set);box2d.b2Vec3.prototype.Copy=function(t){this.x=t.x;this.y=t.y;this.z=t.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"Copy",box2d.b2Vec3.prototype.Copy);box2d.b2Vec3.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfNeg",box2d.b2Vec3.prototype.SelfNeg);box2d.b2Vec3.prototype.SelfAdd=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAdd",box2d.b2Vec3.prototype.SelfAdd);box2d.b2Vec3.prototype.SelfAddV2=function(t,e){this.x+=t.x;this.y+=t.y;this.z+=e;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAddV2",box2d.b2Vec3.prototype.SelfAddV2);box2d.b2Vec3.prototype.SelfAddXYZ=function(t,e,o){this.x+=t;this.y+=e;this.z+=o;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAddXYZ",box2d.b2Vec3.prototype.SelfAddXYZ);box2d.b2Vec3.prototype.SelfSub=function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSub",box2d.b2Vec3.prototype.SelfSub);box2d.b2Vec3.prototype.SelfSubV2=function(t,e){this.x-=t.x;this.y-=t.y;this.z-=e;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSubV2",box2d.b2Vec3.prototype.SelfSubV2);box2d.b2Vec3.prototype.SelfSubXYZ=function(t,e,o){this.x-=t;this.y-=e;this.z-=o;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSubXYZ",box2d.b2Vec3.prototype.SelfSubXYZ);box2d.b2Vec3.prototype.SelfMul=function(t){this.x*=t.x;this.y*=t.y;this.z*=t.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMul",box2d.b2Vec3.prototype.SelfMul);box2d.b2Vec3.prototype.SelfMulV2=function(t,e){this.x*=t.x;this.y*=t.y;this.z*=e;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulV2",box2d.b2Vec3.prototype.SelfMulV2);box2d.b2Vec3.prototype.SelfMulXYZ=function(t,e,o){this.x*=t;this.y*=e;this.z*=o;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulXYZ",box2d.b2Vec3.prototype.SelfMulXYZ);box2d.b2Vec3.prototype.SelfMulScalar=function(t){this.x*=t;this.y*=t;this.z*=t;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulScalar",box2d.b2Vec3.prototype.SelfMulScalar);box2d.b2Vec3.prototype.Length=function(){var t=this.x,e=this.y,o=this.z;return Math.sqrt(t*t+e*e+o*o)};goog.exportProperty(box2d.b2Vec3.prototype,"Length",box2d.b2Vec3.prototype.Length);box2d.b2Vec3.prototype.LengthSquared=function(){var t=this.x,e=this.y,o=this.z;return t*t+e*e+o*o};goog.exportProperty(box2d.b2Vec3.prototype,"LengthSquared",box2d.b2Vec3.prototype.LengthSquared);box2d.b2Vec3.prototype.Normalize=function(){var t=this.Length();if(t>=box2d.b2_epsilon){var e=1/t;this.x*=e;this.y*=e;this.z*=e}return t};goog.exportProperty(box2d.b2Vec3.prototype,"Normalize",box2d.b2Vec3.prototype.Normalize);box2d.b2Vec3.prototype.SelfNormalize=function(){this.Normalize();return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfNormalize",box2d.b2Vec3.prototype.SelfNormalize);box2d.b2Add_V3_V3=function(t,e,o){o.x=t.x+e.x;o.y=t.y+e.y;o.z=t.z+e.z;return o};goog.exportSymbol("box2d.b2Add_V3_V3",box2d.b2Add_V3_V3);box2d.b2Sub_V3_V3=function(t,e,o){o.x=t.x+e.x;o.y=t.y+e.y;o.z=t.z+e.z;return o};goog.exportSymbol("box2d.b2Sub_V3_V3",box2d.b2Sub_V3_V3);box2d.b2Dot_V3_V3=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z};goog.exportSymbol("box2d.b2Dot_V3_V3",box2d.b2Dot_V3_V3);box2d.b2Cross_V3_V3=function(t,e,o){var i=t.x,a=t.y;t=t.z;var r=e.x,s=e.y;e=e.z;o.x=a*e-t*s;o.y=t*r-i*e;o.z=i*s-a*r;return o};goog.exportSymbol("box2d.b2Cross_V3_V3",box2d.b2Cross_V3_V3);box2d.b2Vec4=function(t,e,o,i){this.x=t||0;this.y=e||0;this.z=o||0;this.w=i||0};goog.exportSymbol("box2d.b2Vec4",box2d.b2Vec4);box2d.b2Vec4.prototype.x=0;goog.exportProperty(box2d.b2Vec4.prototype,"x",box2d.b2Vec4.prototype.x);box2d.b2Vec4.prototype.y=0;goog.exportProperty(box2d.b2Vec4.prototype,"y",box2d.b2Vec4.prototype.y);box2d.b2Vec4.prototype.z=0;goog.exportProperty(box2d.b2Vec4.prototype,"z",box2d.b2Vec4.prototype.z);box2d.b2Vec4.prototype.w=0;goog.exportProperty(box2d.b2Vec4.prototype,"w",box2d.b2Vec4.prototype.w);box2d.b2Vec4.ZERO=new box2d.b2Vec4(0,0,0,0);goog.exportProperty(box2d.b2Vec4,"ZERO",box2d.b2Vec4.ZERO);box2d.b2Vec4.s_t0=new box2d.b2Vec4;goog.exportProperty(box2d.b2Vec4,"s_t0",box2d.b2Vec4.s_t0);box2d.b2Vec4.prototype.Clone=function(){return new box2d.b2Vec4(this.x,this.y,this.z,this.w)};goog.exportProperty(box2d.b2Vec4.prototype,"Clone",box2d.b2Vec4.prototype.Clone);box2d.b2Vec4.prototype.SetZero=function(){this.w=this.z=this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec4.prototype,"SetZero",box2d.b2Vec4.prototype.SetZero);box2d.b2Vec4.prototype.Set=function(t,e,o,i){this.x=t;this.y=e;this.z=o;this.w=i;return this};goog.exportProperty(box2d.b2Vec4.prototype,"Set",box2d.b2Vec4.prototype.Set);box2d.b2Vec4.prototype.Copy=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w;return this};goog.exportProperty(box2d.b2Vec4.prototype,"Copy",box2d.b2Vec4.prototype.Copy);box2d.b2Mat22=function(){this.ex=new box2d.b2Vec2(1,0);this.ey=new box2d.b2Vec2(0,1)};goog.exportSymbol("box2d.b2Mat22",box2d.b2Mat22);box2d.b2Mat22.prototype.ex=null;goog.exportProperty(box2d.b2Mat22.prototype,"ex",box2d.b2Mat22.prototype.ex);box2d.b2Mat22.prototype.ey=null;goog.exportProperty(box2d.b2Mat22.prototype,"ey",box2d.b2Mat22.prototype.ey);box2d.b2Mat22.IDENTITY=new box2d.b2Mat22;goog.exportProperty(box2d.b2Mat22,"IDENTITY",box2d.b2Mat22.IDENTITY);box2d.b2Mat22.prototype.Clone=function(){return(new box2d.b2Mat22).Copy(this)};goog.exportProperty(box2d.b2Mat22.prototype,"Clone",box2d.b2Mat22.prototype.Clone);box2d.b2Mat22.prototype.SetAngle=function(t){var e=Math.cos(t);t=Math.sin(t);this.ex.Set(e,t);this.ey.Set(-t,e);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetAngle",box2d.b2Mat22.prototype.SetAngle);box2d.b2Mat22.prototype.Copy=function(t){this.ex.Copy(t.ex);this.ey.Copy(t.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"Copy",box2d.b2Mat22.prototype.Copy);box2d.b2Mat22.prototype.SetIdentity=function(){this.ex.Set(1,0);this.ey.Set(0,1);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetIdentity",box2d.b2Mat22.prototype.SetIdentity);box2d.b2Mat22.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetZero",box2d.b2Mat22.prototype.SetZero);box2d.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)};goog.exportProperty(box2d.b2Mat22.prototype,"GetAngle",box2d.b2Mat22.prototype.GetAngle);box2d.b2Mat22.prototype.GetInverse=function(t){var e=this.ex.x,o=this.ey.x,i=this.ex.y,a=this.ey.y,r=e*a-o*i;0!==r&&(r=1/r);t.ex.x=r*a;t.ey.x=-r*o;t.ex.y=-r*i;t.ey.y=r*e;return t};goog.exportProperty(box2d.b2Mat22.prototype,"GetInverse",box2d.b2Mat22.prototype.GetInverse);box2d.b2Mat22.prototype.Solve=function(t,e,o){var i=this.ex.x,a=this.ey.x,r=this.ex.y,s=this.ey.y,n=i*s-a*r;0!==n&&(n=1/n);o.x=n*(s*t-a*e);o.y=n*(i*e-r*t);return o};goog.exportProperty(box2d.b2Mat22.prototype,"Solve",box2d.b2Mat22.prototype.Solve);box2d.b2Mat22.prototype.SelfAbs=function(){this.ex.SelfAbs();this.ey.SelfAbs();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAbs",box2d.b2Mat22.prototype.SelfAbs);box2d.b2Mat22.prototype.SelfInv=function(){return this.GetInverse(this)};goog.exportProperty(box2d.b2Mat22.prototype,"SelfInv",box2d.b2Mat22.prototype.SelfInv);box2d.b2Mat22.prototype.SelfAdd=function(t){this.ex.SelfAdd(t.ex);this.ey.SelfAdd(t.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAdd",box2d.b2Mat22.prototype.SelfAdd);box2d.b2Mat22.prototype.SelfSub=function(t){this.ex.SelfSub(t.ex);this.ey.SelfSub(t.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfSub",box2d.b2Mat22.prototype.SelfSub);box2d.b2Abs_M22=function(t,e){var o=t.ex,i=t.ey;e.ex.x=box2d.b2Abs(o.x);e.ex.y=box2d.b2Abs(o.y);e.ey.x=box2d.b2Abs(i.x);e.ey.y=box2d.b2Abs(i.y);return e};goog.exportSymbol("box2d.b2Abs_M22",box2d.b2Abs_M22);box2d.b2Mul_M22_V2=function(t,e,o){var i=t.ex;t=t.ey;var a=e.x;e=e.y;o.x=i.x*a+t.x*e;o.y=i.y*a+t.y*e;return o};goog.exportSymbol("box2d.b2Mul_M22_V2",box2d.b2Mul_M22_V2);box2d.b2MulT_M22_V2=function(t,e,o){var i=t.ex;t=t.ey;var a=e.x;e=e.y;o.x=i.x*a+i.y*e;o.y=t.x*a+t.y*e;return o};goog.exportSymbol("box2d.b2MulT_M22_V2",box2d.b2MulT_M22_V2);box2d.b2Add_M22_M22=function(t,e,o){var i=t.ex;t=t.ey;var a=e.ex;e=e.ey;o.ex.x=i.x+a.x;o.ex.y=i.y+a.y;o.ey.x=t.x+e.x;o.ey.y=t.y+e.y;return o};goog.exportSymbol("box2d.b2Add_M22_M22",box2d.b2Add_M22_M22);box2d.b2Mul_M22_M22=function(t,e,o){var i=t.ex.x,a=t.ex.y,r=t.ey.x;t=t.ey.y;var s=e.ex.x,n=e.ex.y,b=e.ey.x;e=e.ey.y;o.ex.x=i*s+r*n;o.ex.y=a*s+t*n;o.ey.x=i*b+r*e;o.ey.y=a*b+t*e;return o};goog.exportSymbol("box2d.b2Mul_M22_M22",box2d.b2Mul_M22_M22);box2d.b2MulT_M22_M22=function(t,e,o){var i=t.ex.x,a=t.ex.y,r=t.ey.x;t=t.ey.y;var s=e.ex.x,n=e.ex.y,b=e.ey.x;e=e.ey.y;o.ex.x=i*s+a*n;o.ex.y=r*s+t*n;o.ey.x=i*b+a*e;o.ey.y=r*b+t*e;return o};goog.exportSymbol("box2d.b2MulT_M22_M22",box2d.b2MulT_M22_M22);box2d.b2Mat33=function(){this.ex=new box2d.b2Vec3(1,0,0);this.ey=new box2d.b2Vec3(0,1,0);this.ez=new box2d.b2Vec3(0,0,1)};goog.exportSymbol("box2d.b2Mat33",box2d.b2Mat33);box2d.b2Mat33.prototype.ex=null;goog.exportProperty(box2d.b2Mat33.prototype,"ex",box2d.b2Mat33.prototype.ex);box2d.b2Mat33.prototype.ey=null;goog.exportProperty(box2d.b2Mat33.prototype,"ey",box2d.b2Mat33.prototype.ey);box2d.b2Mat33.prototype.ez=null;goog.exportProperty(box2d.b2Mat33.prototype,"ez",box2d.b2Mat33.prototype.ez);box2d.b2Mat33.IDENTITY=new box2d.b2Mat33;goog.exportProperty(box2d.b2Mat33,"IDENTITY",box2d.b2Mat33.IDENTITY);box2d.b2Mat33.prototype.Clone=function(){return(new box2d.b2Mat33).Copy(this)};goog.exportProperty(box2d.b2Mat33.prototype,"Clone",box2d.b2Mat33.prototype.Clone);box2d.b2Mat33.prototype.Copy=function(t){this.ex.Copy(t.ex);this.ey.Copy(t.ey);this.ez.Copy(t.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"Copy",box2d.b2Mat33.prototype.Copy);box2d.b2Mat33.prototype.SetIdentity=function(){this.ex.Set(1,0,0);this.ey.Set(0,1,0);this.ez.Set(0,0,1);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetIdentity",box2d.b2Mat33.prototype.SetIdentity);box2d.b2Mat33.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();this.ez.SetZero();return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetZero",box2d.b2Mat33.prototype.SetZero);box2d.b2Mat33.prototype.SelfAdd=function(t){this.ex.SelfAdd(t.ex);this.ey.SelfAdd(t.ey);this.ez.SelfAdd(t.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SelfAdd",box2d.b2Mat33.prototype.SelfAdd);box2d.b2Mat33.prototype.Solve33=function(t,e,o,i){var a=this.ex.x,r=this.ex.y,s=this.ex.z,n=this.ey.x,b=this.ey.y,x=this.ey.z,l=this.ez.x,_=this.ez.y,h=this.ez.z,d=a*(b*h-x*_)+r*(x*l-n*h)+s*(n*_-b*l);0!==d&&(d=1/d);i.x=d*(t*(b*h-x*_)+e*(x*l-n*h)+o*(n*_-b*l));i.y=d*(a*(e*h-o*_)+r*(o*l-t*h)+s*(t*_-e*l));i.z=d*(a*(b*o-x*e)+r*(x*t-n*o)+s*(n*e-b*t));return i};goog.exportProperty(box2d.b2Mat33.prototype,"Solve33",box2d.b2Mat33.prototype.Solve33);box2d.b2Mat33.prototype.Solve22=function(t,e,o){var i=this.ex.x,a=this.ey.x,r=this.ex.y,s=this.ey.y,n=i*s-a*r;0!==n&&(n=1/n);o.x=n*(s*t-a*e);o.y=n*(i*e-r*t);return o};goog.exportProperty(box2d.b2Mat33.prototype,"Solve22",box2d.b2Mat33.prototype.Solve22);box2d.b2Mat33.prototype.GetInverse22=function(t){var e=this.ex.x,o=this.ey.x,i=this.ex.y,a=this.ey.y,r=e*a-o*i;0!==r&&(r=1/r);t.ex.x=r*a;t.ey.x=-r*o;t.ex.z=0;t.ex.y=-r*i;t.ey.y=r*e;t.ey.z=0;t.ez.x=0;t.ez.y=0;t.ez.z=0};goog.exportProperty(box2d.b2Mat33.prototype,"GetInverse22",box2d.b2Mat33.prototype.GetInverse22);box2d.b2Mat33.prototype.GetSymInverse33=function(t){var e=box2d.b2Dot_V3_V3(this.ex,box2d.b2Cross_V3_V3(this.ey,this.ez,box2d.b2Vec3.s_t0));0!==e&&(e=1/e);var o=this.ex.x,i=this.ey.x,a=this.ez.x,r=this.ey.y,s=this.ez.y,n=this.ez.z;t.ex.x=e*(r*n-s*s);t.ex.y=e*(a*s-i*n);t.ex.z=e*(i*s-a*r);t.ey.x=t.ex.y;t.ey.y=e*(o*n-a*a);t.ey.z=e*(a*i-o*s);t.ez.x=t.ex.z;t.ez.y=t.ey.z;t.ez.z=e*(o*r-i*i)};goog.exportProperty(box2d.b2Mat33.prototype,"GetSymInverse33",box2d.b2Mat33.prototype.GetSymInverse33);box2d.b2Mul_M33_V3=function(t,e,o){var i=e.x,a=e.y;e=e.z;o.x=t.ex.x*i+t.ey.x*a+t.ez.x*e;o.y=t.ex.y*i+t.ey.y*a+t.ez.y*e;o.z=t.ex.z*i+t.ey.z*a+t.ez.z*e;return o};goog.exportSymbol("box2d.b2Mul_M33_V3",box2d.b2Mul_M33_V3);box2d.b2Mul_M33_X_Y_Z=function(t,e,o,i,a){a.x=t.ex.x*e+t.ey.x*o+t.ez.x*i;a.y=t.ex.y*e+t.ey.y*o+t.ez.y*i;a.z=t.ex.z*e+t.ey.z*o+t.ez.z*i;return a};goog.exportSymbol("box2d.b2Mul_M33_X_Y_Z",box2d.b2Mul_M33_X_Y_Z);box2d.b2Mul22_M33_V2=function(t,e,o){var i=e.x;e=e.y;o.x=t.ex.x*i+t.ey.x*e;o.y=t.ex.y*i+t.ey.y*e;return o};goog.exportSymbol("box2d.b2Mul22_M33_V2",box2d.b2Mul22_M33_V2);box2d.b2Mul_M33_X_Y=function(t,e,o,i){i.x=t.ex.x*e+t.ey.x*o;i.y=t.ex.y*e+t.ey.y*o;return i};goog.exportSymbol("box2d.b2Mul_M33_X_Y",box2d.b2Mul_M33_X_Y);box2d.b2Rot=function(t){t&&(this.angle=t,this.s=Math.sin(t),this.c=Math.cos(t))};goog.exportSymbol("box2d.b2Rot",box2d.b2Rot);box2d.b2Rot.prototype.angle=0;goog.exportProperty(box2d.b2Rot.prototype,"angle",box2d.b2Rot.prototype.angle);box2d.b2Rot.prototype.s=0;goog.exportProperty(box2d.b2Rot.prototype,"s",box2d.b2Rot.prototype.s);box2d.b2Rot.prototype.c=1;goog.exportProperty(box2d.b2Rot.prototype,"c",box2d.b2Rot.prototype.c);box2d.b2Rot.IDENTITY=new box2d.b2Rot;goog.exportProperty(box2d.b2Rot,"IDENTITY",box2d.b2Rot.IDENTITY);box2d.b2Rot.prototype.Clone=function(){return(new box2d.b2Rot).Copy(this)};goog.exportProperty(box2d.b2Rot.prototype,"Clone",box2d.b2Rot.prototype.Clone);box2d.b2Rot.prototype.Copy=function(t){this.angle=t.angle;this.s=t.s;this.c=t.c;return this};goog.exportProperty(box2d.b2Rot.prototype,"Copy",box2d.b2Rot.prototype.Copy);box2d.b2Rot.prototype.Set=function(t){Math.abs(this.angle-t)>=box2d.b2_epsilon&&(this.angle=t,this.s=Math.sin(t),this.c=Math.cos(t));return this};goog.exportProperty(box2d.b2Rot.prototype,"Set",box2d.b2Rot.prototype.Set);box2d.b2Rot.prototype.SetAngle=box2d.b2Rot.prototype.Set;goog.exportProperty(box2d.b2Rot.prototype,"SetAngle",box2d.b2Rot.prototype.SetAngle);box2d.b2Rot.prototype.SetIdentity=function(){this.s=this.angle=0;this.c=1;return this};goog.exportProperty(box2d.b2Rot.prototype,"SetIdentity",box2d.b2Rot.prototype.SetIdentity);box2d.b2Rot.prototype.GetAngle=function(){return this.angle};goog.exportProperty(box2d.b2Rot.prototype,"GetAngle",box2d.b2Rot.prototype.GetAngle);box2d.b2Rot.prototype.GetXAxis=function(t){t.x=this.c;t.y=this.s;return t};goog.exportProperty(box2d.b2Rot.prototype,"GetXAxis",box2d.b2Rot.prototype.GetXAxis);box2d.b2Rot.prototype.GetYAxis=function(t){t.x=-this.s;t.y=this.c;return t};goog.exportProperty(box2d.b2Rot.prototype,"GetYAxis",box2d.b2Rot.prototype.GetYAxis);box2d.b2Mul_R_R=function(t,e,o){var i=t.c,a=t.s,r=e.c,s=e.s;o.s=a*r+i*s;o.c=i*r-a*s;o.angle=box2d.b2WrapAngle(t.angle+e.angle);return o};goog.exportSymbol("box2d.b2Mul_R_R",box2d.b2Mul_R_R);box2d.b2MulT_R_R=function(t,e,o){var i=t.c,a=t.s,r=e.c,s=e.s;o.s=i*s-a*r;o.c=i*r+a*s;o.angle=box2d.b2WrapAngle(t.angle-e.angle);return o};goog.exportSymbol("box2d.b2MulT_R_R",box2d.b2MulT_R_R);box2d.b2Mul_R_V2=function(t,e,o){var i=t.c;t=t.s;var a=e.x;e=e.y;o.x=i*a-t*e;o.y=t*a+i*e;return o};goog.exportSymbol("box2d.b2Mul_R_V2",box2d.b2Mul_R_V2);box2d.b2MulT_R_V2=function(t,e,o){var i=t.c;t=t.s;var a=e.x;e=e.y;o.x=i*a+t*e;o.y=-t*a+i*e;return o};goog.exportSymbol("box2d.b2MulT_R_V2",box2d.b2MulT_R_V2);box2d.b2Transform=function(){this.p=new box2d.b2Vec2;this.q=new box2d.b2Rot};goog.exportSymbol("box2d.b2Transform",box2d.b2Transform);box2d.b2Transform.prototype.p=null;goog.exportProperty(box2d.b2Transform.prototype,"p",box2d.b2Transform.prototype.p);box2d.b2Transform.prototype.q=null;goog.exportProperty(box2d.b2Transform.prototype,"q",box2d.b2Transform.prototype.q);box2d.b2Transform.IDENTITY=new box2d.b2Transform;goog.exportProperty(box2d.b2Transform,"IDENTITY",box2d.b2Transform.IDENTITY);box2d.b2Transform.prototype.Clone=function(){return(new box2d.b2Transform).Copy(this)};goog.exportProperty(box2d.b2Transform.prototype,"Clone",box2d.b2Transform.prototype.Clone);box2d.b2Transform.prototype.Copy=function(t){this.p.Copy(t.p);this.q.Copy(t.q);return this};goog.exportProperty(box2d.b2Transform.prototype,"Copy",box2d.b2Transform.prototype.Copy);box2d.b2Transform.prototype.SetIdentity=function(){this.p.SetZero();this.q.SetIdentity();return this};goog.exportProperty(box2d.b2Transform.prototype,"SetIdentity",box2d.b2Transform.prototype.SetIdentity);box2d.b2Transform.prototype.Set=function(t,e){return this.SetPositionRotationAngle(t,e)};box2d.b2Transform.prototype.SetPositionRotation=function(t,e){this.p.Copy(t);this.q.Copy(e);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionRotation",box2d.b2Transform.prototype.SetPositionRotation);box2d.b2Transform.prototype.SetPositionRotationAngle=function(t,e){this.p.Copy(t);this.q.SetAngle(e);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionRotationAngle",box2d.b2Transform.prototype.SetPositionRotationAngle);box2d.b2Transform.prototype.SetPosition=function(t){this.p.Copy(t);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPosition",box2d.b2Transform.prototype.SetPosition);box2d.b2Transform.prototype.SetPositionXY=function(t,e){this.p.Set(t,e);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionXY",box2d.b2Transform.prototype.SetPositionXY);box2d.b2Transform.prototype.SetRotation=function(t){this.q.Copy(t);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotation",box2d.b2Transform.prototype.SetRotation);box2d.b2Transform.prototype.SetRotationAngle=function(t){this.q.SetAngle(t);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotationAngle",box2d.b2Transform.prototype.SetRotationAngle);box2d.b2Transform.prototype.GetPosition=function(){return this.p};goog.exportProperty(box2d.b2Transform.prototype,"GetPosition",box2d.b2Transform.prototype.GetPosition);box2d.b2Transform.prototype.GetRotation=function(){return this.q};goog.exportProperty(box2d.b2Transform.prototype,"GetRotation",box2d.b2Transform.prototype.GetRotation);box2d.b2Transform.prototype.GetRotationAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetRotationAngle",box2d.b2Transform.prototype.GetRotationAngle);box2d.b2Transform.prototype.GetAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetAngle",box2d.b2Transform.prototype.GetAngle);box2d.b2Mul_X_V2=function(t,e,o){var i=t.q.c,a=t.q.s,r=e.x;e=e.y;o.x=i*r-a*e+t.p.x;o.y=a*r+i*e+t.p.y;return o};goog.exportSymbol("box2d.b2Mul_X_V2",box2d.b2Mul_X_V2);box2d.b2MulT_X_V2=function(t,e,o){var i=t.q.c,a=t.q.s,r=e.x-t.p.x;t=e.y-t.p.y;o.x=i*r+a*t;o.y=-a*r+i*t;return o};goog.exportSymbol("box2d.b2MulT_X_V2",box2d.b2MulT_X_V2);box2d.b2Mul_X_X=function(t,e,o){box2d.b2Mul_R_R(t.q,e.q,o.q);box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(t.q,e.p,o.p),t.p,o.p);return o};goog.exportSymbol("box2d.b2Mul_X_X",box2d.b2Mul_X_X);box2d.b2MulT_X_X=function(t,e,o){box2d.b2MulT_R_R(t.q,e.q,o.q);box2d.b2MulT_R_V2(t.q,box2d.b2Sub_V2_V2(e.p,t.p,o.p),o.p);return o};goog.exportSymbol("box2d.b2MulT_X_X",box2d.b2MulT_X_X);box2d.b2Sweep=function(){this.localCenter=new box2d.b2Vec2;this.c0=new box2d.b2Vec2;this.c=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Sweep",box2d.b2Sweep);box2d.b2Sweep.prototype.localCenter=null;goog.exportProperty(box2d.b2Sweep.prototype,"localCenter",box2d.b2Sweep.prototype.localCenter);box2d.b2Sweep.prototype.c0=null;goog.exportProperty(box2d.b2Sweep.prototype,"c0",box2d.b2Sweep.prototype.c0);box2d.b2Sweep.prototype.c=null;goog.exportProperty(box2d.b2Sweep.prototype,"c",box2d.b2Sweep.prototype.c);box2d.b2Sweep.prototype.a0=0;goog.exportProperty(box2d.b2Sweep.prototype,"a0",box2d.b2Sweep.prototype.a0);box2d.b2Sweep.prototype.a=0;goog.exportProperty(box2d.b2Sweep.prototype,"a",box2d.b2Sweep.prototype.a);box2d.b2Sweep.prototype.alpha0=0;goog.exportProperty(box2d.b2Sweep.prototype,"alpha0",box2d.b2Sweep.prototype.alpha0);box2d.b2Sweep.prototype.Clone=function(){return(new box2d.b2Sweep).Copy(this)};goog.exportProperty(box2d.b2Sweep.prototype,"Clone",box2d.b2Sweep.prototype.Clone);box2d.b2Sweep.prototype.Copy=function(t){this.localCenter.Copy(t.localCenter);this.c0.Copy(t.c0);this.c.Copy(t.c);this.a0=t.a0;this.a=t.a;this.alpha0=t.alpha0;return this};goog.exportProperty(box2d.b2Sweep.prototype,"Copy",box2d.b2Sweep.prototype.Copy);box2d.b2Sweep.prototype.GetTransform=function(t,e){var o=1-e;t.p.x=o*this.c0.x+e*this.c.x;t.p.y=o*this.c0.y+e*this.c.y;t.q.SetAngle(o*this.a0+e*this.a);t.p.SelfSub(box2d.b2Mul_R_V2(t.q,this.localCenter,box2d.b2Vec2.s_t0));return t};goog.exportProperty(box2d.b2Sweep.prototype,"GetTransform",box2d.b2Sweep.prototype.GetTransform);box2d.b2Sweep.prototype.Advance=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>this.alpha0);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.x+=e*(this.c.x-this.c0.x);this.c0.y+=e*(this.c.y-this.c0.y);this.a0+=e*(this.a-this.a0);this.alpha0=t};goog.exportProperty(box2d.b2Sweep.prototype,"Advance",box2d.b2Sweep.prototype.Advance);box2d.b2Sweep.prototype.Normalize=function(){this.a0=box2d.b2WrapAngle(this.a0);this.a=box2d.b2WrapAngle(this.a)};goog.exportProperty(box2d.b2Sweep.prototype,"Normalize",box2d.b2Sweep.prototype.Normalize);box2d.b2Dot=function(t,e){if(t instanceof box2d.b2Vec2&&e instanceof box2d.b2Vec2)return box2d.b2Dot_V2_V2(t,e);if(t instanceof box2d.b2Vec3&&e instanceof box2d.b2Vec3)return box2d.b2Dot_V3_V3(t,e);throw Error()};goog.exportSymbol("box2d.b2Dot",box2d.b2Dot);box2d.b2Cross=function(t,e,o){if(t instanceof box2d.b2Vec2&&e instanceof box2d.b2Vec2)return box2d.b2Cross_V2_V2(t,e);if(t instanceof box2d.b2Vec2&&"number"===typeof e&&o instanceof box2d.b2Vec2)return box2d.b2Cross_V2_S(t,e,o);if("number"===typeof t&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Cross_S_V2(t,e,o);if(t instanceof box2d.b2Vec3&&e instanceof box2d.b2Vec3&&o instanceof box2d.b2Vec3)return box2d.b2Cross_V3_V3(t,e,o);throw Error()};goog.exportSymbol("box2d.b2Cross",box2d.b2Cross);box2d.b2Add=function(t,e,o){if(t instanceof box2d.b2Vec2&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Add_V2_V2(t,e,o);if(t instanceof box2d.b2Vec3&&e instanceof box2d.b2Vec3&&o instanceof box2d.b2Vec3)return box2d.b2Add_V3_V3(t,e,o);throw Error()};goog.exportSymbol("box2d.b2Add",box2d.b2Add);box2d.b2Sub=function(t,e,o){if(t instanceof box2d.b2Vec2&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Sub_V2_V2(t,e,o);if(t instanceof box2d.b2Vec3&&e instanceof box2d.b2Vec3&&o instanceof box2d.b2Vec3)return box2d.b2Sub_V3_V3(t,e,o);throw Error()};goog.exportSymbol("box2d.b2Sub",box2d.b2Sub);box2d.b2Mul=function(t,e,o){if(t instanceof box2d.b2Mat22&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Mul_M22_V2(t,e,o);if(t instanceof box2d.b2Mat22&&e instanceof box2d.b2Mat22&&o instanceof box2d.b2Mat22)return box2d.b2Mul_M22_M22(t,e,o);if(t instanceof box2d.b2Mat33&&e instanceof box2d.b2Vec3&&o instanceof box2d.b2Vec3)return box2d.b2Mul_M33_V3(t,e,o);if(t instanceof box2d.b2Rot&&e instanceof box2d.b2Rot&&o instanceof box2d.b2Rot)return box2d.b2Mul_R_R(t,e,o);if(t instanceof box2d.b2Rot&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Mul_R_V2(t,e,o);if(t instanceof box2d.b2Transform&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2Mul_X_V2(t,e,o);if(t instanceof box2d.b2Transform&&e instanceof box2d.b2Transform&&o instanceof box2d.b2Transform)return box2d.b2Mul_X_X(t,e,o);throw Error()};goog.exportSymbol("box2d.b2Mul",box2d.b2Mul);box2d.b2Mul22=function(t,e,o){if(t instanceof box2d.b2Mat33&&e instanceof box2d.b2Vec2)return box2d.b2Mul22_M33_V2(t,e,o);throw Error()};goog.exportSymbol("box2d.b2Mul22",box2d.b2Mul22);box2d.b2MulT=function(t,e,o){if(t instanceof box2d.b2Mat22&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2MulT_M22_V2(t,e,o);if(t instanceof box2d.b2Mat22&&e instanceof box2d.b2Mat22&&o instanceof box2d.b2Mat22)return box2d.b2MulT_M22_M22(t,e,o);if(t instanceof box2d.b2Rot&&e instanceof box2d.b2Rot&&o instanceof box2d.b2Rot)return box2d.b2MulT_R_R(t,e,o);if(t instanceof box2d.b2Rot&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2MulT_R_V2(t,e,o);if(t instanceof box2d.b2Transform&&e instanceof box2d.b2Vec2&&o instanceof box2d.b2Vec2)return box2d.b2MulT_X_V2(t,e,o);if(t instanceof box2d.b2Transform&&e instanceof box2d.b2Transform&&o instanceof box2d.b2Transform)return box2d.b2MulT_X_X(t,e,o);throw Error()};goog.exportSymbol("box2d.b2MulT",box2d.b2MulT);box2d.b2DistanceProxy=function(){this.m_buffer=box2d.b2Vec2.MakeArray(2)};goog.exportSymbol("box2d.b2DistanceProxy",box2d.b2DistanceProxy);box2d.b2DistanceProxy.prototype.m_buffer=null;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_buffer",box2d.b2DistanceProxy.prototype.m_buffer);box2d.b2DistanceProxy.prototype.m_vertices=null;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_vertices",box2d.b2DistanceProxy.prototype.m_vertices);box2d.b2DistanceProxy.prototype.m_count=0;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_count",box2d.b2DistanceProxy.prototype.m_count);box2d.b2DistanceProxy.prototype.m_radius=0;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_radius",box2d.b2DistanceProxy.prototype.m_radius);box2d.b2DistanceProxy.prototype.Reset=function(){this.m_vertices=null;this.m_radius=this.m_count=0;return this};goog.exportProperty(box2d.b2DistanceProxy.prototype,"Reset",box2d.b2DistanceProxy.prototype.Reset);box2d.b2DistanceProxy.prototype.SetShape=function(t,e){t.SetupDistanceProxy(this,e)};goog.exportProperty(box2d.b2DistanceProxy.prototype,"SetShape",box2d.b2DistanceProxy.prototype.SetShape);box2d.b2DistanceProxy.prototype.GetSupport=function(t){for(var e=0,o=box2d.b2Dot_V2_V2(this.m_vertices[0],t),i=1;i<this.m_count;++i){var a=box2d.b2Dot_V2_V2(this.m_vertices[i],t);a>o&&(e=i,o=a)}return e};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupport",box2d.b2DistanceProxy.prototype.GetSupport);box2d.b2DistanceProxy.prototype.GetSupportVertex=function(t,e){for(var o=0,i=box2d.b2Dot_V2_V2(this.m_vertices[0],t),a=1;a<this.m_count;++a){var r=box2d.b2Dot_V2_V2(this.m_vertices[a],t);r>i&&(o=a,i=r)}return e.Copy(this.m_vertices[o])};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupportVertex",box2d.b2DistanceProxy.prototype.GetSupportVertex);box2d.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertexCount",box2d.b2DistanceProxy.prototype.GetVertexCount);box2d.b2DistanceProxy.prototype.GetVertex=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=t&&t<this.m_count);return this.m_vertices[t]};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertex",box2d.b2DistanceProxy.prototype.GetVertex);box2d.b2SimplexCache=function(){this.indexA=box2d.b2MakeNumberArray(3);this.indexB=box2d.b2MakeNumberArray(3)};goog.exportSymbol("box2d.b2SimplexCache",box2d.b2SimplexCache);box2d.b2SimplexCache.prototype.metric=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"metric",box2d.b2SimplexCache.prototype.metric);box2d.b2SimplexCache.prototype.count=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"count",box2d.b2SimplexCache.prototype.count);box2d.b2SimplexCache.prototype.indexA=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexA",box2d.b2SimplexCache.prototype.indexA);box2d.b2SimplexCache.prototype.indexB=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexB",box2d.b2SimplexCache.prototype.indexB);box2d.b2SimplexCache.prototype.Reset=function(){this.count=this.metric=0;return this};goog.exportProperty(box2d.b2SimplexCache.prototype,"Reset",box2d.b2SimplexCache.prototype.Reset);box2d.b2DistanceInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.transformA=new box2d.b2Transform;this.transformB=new box2d.b2Transform};goog.exportSymbol("box2d.b2DistanceInput",box2d.b2DistanceInput);box2d.b2DistanceInput.prototype.proxyA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyA",box2d.b2DistanceInput.prototype.proxyA);box2d.b2DistanceInput.prototype.proxyB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyB",box2d.b2DistanceInput.prototype.proxyB);box2d.b2DistanceInput.prototype.transformA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformA",box2d.b2DistanceInput.prototype.transformA);box2d.b2DistanceInput.prototype.transformB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformB",box2d.b2DistanceInput.prototype.transformB);box2d.b2DistanceInput.prototype.useRadii=!1;goog.exportProperty(box2d.b2DistanceInput.prototype,"useRadii",box2d.b2DistanceInput.prototype.useRadii);box2d.b2DistanceInput.prototype.Reset=function(){this.proxyA.Reset();this.proxyB.Reset();this.transformA.SetIdentity();this.transformB.SetIdentity();this.useRadii=!1;return this};goog.exportProperty(box2d.b2DistanceInput.prototype,"Reset",box2d.b2DistanceInput.prototype.Reset);box2d.b2DistanceOutput=function(){this.pointA=new box2d.b2Vec2;this.pointB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2DistanceOutput",box2d.b2DistanceOutput);box2d.b2DistanceOutput.prototype.pointA=null;goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointA",box2d.b2DistanceOutput.prototype.pointA);box2d.b2DistanceOutput.prototype.pointB=null;goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointB",box2d.b2DistanceOutput.prototype.pointB);box2d.b2DistanceOutput.prototype.distance=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"distance",box2d.b2DistanceOutput.prototype.distance);box2d.b2DistanceOutput.prototype.iterations=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"iterations",box2d.b2DistanceOutput.prototype.iterations);box2d.b2DistanceOutput.prototype.Reset=function(){this.pointA.SetZero();this.pointB.SetZero();this.iterations=this.distance=0;return this};goog.exportProperty(box2d.b2DistanceOutput.prototype,"Reset",box2d.b2DistanceOutput.prototype.Reset);box2d.b2_gjkCalls=0;goog.exportSymbol("box2d.b2_gjkCalls",box2d.b2_gjkCalls);box2d.b2_gjkIters=0;goog.exportSymbol("box2d.b2_gjkIters",box2d.b2_gjkIters);box2d.b2_gjkMaxIters=0;goog.exportSymbol("box2d.b2_gjkMaxIters",box2d.b2_gjkMaxIters);box2d.b2SimplexVertex=function(){this.wA=new box2d.b2Vec2;this.wB=new box2d.b2Vec2;this.w=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SimplexVertex",box2d.b2SimplexVertex);box2d.b2SimplexVertex.prototype.wA=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wA",box2d.b2SimplexVertex.prototype.wA);box2d.b2SimplexVertex.prototype.wB=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wB",box2d.b2SimplexVertex.prototype.wB);box2d.b2SimplexVertex.prototype.w=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"w",box2d.b2SimplexVertex.prototype.w);box2d.b2SimplexVertex.prototype.a=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"a",box2d.b2SimplexVertex.prototype.a);box2d.b2SimplexVertex.prototype.indexA=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexA",box2d.b2SimplexVertex.prototype.indexA);box2d.b2SimplexVertex.prototype.indexB=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexB",box2d.b2SimplexVertex.prototype.indexB);box2d.b2SimplexVertex.prototype.Copy=function(t){this.wA.Copy(t.wA);this.wB.Copy(t.wB);this.w.Copy(t.w);this.a=t.a;this.indexA=t.indexA;this.indexB=t.indexB;return this};goog.exportProperty(box2d.b2SimplexVertex.prototype,"Copy",box2d.b2SimplexVertex.prototype.Copy);box2d.b2Simplex=function(){this.m_v1=new box2d.b2SimplexVertex;this.m_v2=new box2d.b2SimplexVertex;this.m_v3=new box2d.b2SimplexVertex;this.m_vertices=Array(3);this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};goog.exportSymbol("box2d.b2Simplex",box2d.b2Simplex);box2d.b2Simplex.prototype.m_v1=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v1",box2d.b2Simplex.prototype.m_v1);box2d.b2Simplex.prototype.m_v2=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v2",box2d.b2Simplex.prototype.m_v2);box2d.b2Simplex.prototype.m_v3=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v3",box2d.b2Simplex.prototype.m_v3);box2d.b2Simplex.prototype.m_vertices=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_vertices",box2d.b2Simplex.prototype.m_vertices);box2d.b2Simplex.prototype.m_count=0;goog.exportProperty(box2d.b2Simplex.prototype,"m_count",box2d.b2Simplex.prototype.m_count);box2d.b2Simplex.prototype.ReadCache=function(t,e,o,i,a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=t.count&&3>=t.count);this.m_count=t.count;for(var r=this.m_vertices,s=0;s<this.m_count;++s){var n=r[s];n.indexA=t.indexA[s];n.indexB=t.indexB[s];var b=e.GetVertex(n.indexA),x=i.GetVertex(n.indexB);box2d.b2Mul_X_V2(o,b,n.wA);box2d.b2Mul_X_V2(a,x,n.wB);box2d.b2Sub_V2_V2(n.wB,n.wA,n.w);n.a=0}1<this.m_count&&(t=t.metric,s=this.GetMetric(),s<.5*t||2*t<s||s<box2d.b2_epsilon)&&(this.m_count=0);0===this.m_count&&(n=r[0],n.indexA=0,n.indexB=0,b=e.GetVertex(0),x=i.GetVertex(0),box2d.b2Mul_X_V2(o,b,n.wA),box2d.b2Mul_X_V2(a,x,n.wB),box2d.b2Sub_V2_V2(n.wB,n.wA,n.w),this.m_count=n.a=1)};goog.exportProperty(box2d.b2Simplex.prototype,"ReadCache",box2d.b2Simplex.prototype.ReadCache);box2d.b2Simplex.prototype.WriteCache=function(t){t.metric=this.GetMetric();t.count=this.m_count;for(var e=this.m_vertices,o=0;o<this.m_count;++o)t.indexA[o]=e[o].indexA,t.indexB[o]=e[o].indexB};goog.exportProperty(box2d.b2Simplex.prototype,"WriteCache",box2d.b2Simplex.prototype.WriteCache);box2d.b2Simplex.prototype.GetSearchDirection=function(t){switch(this.m_count){case 1:return t.Copy(this.m_v1.w).SelfNeg();case 2:var e=box2d.b2Sub_V2_V2(this.m_v2.w,this.m_v1.w,t);return 0<box2d.b2Cross_V2_V2(e,box2d.b2Vec2.s_t0.Copy(this.m_v1.w).SelfNeg())?box2d.b2Cross_S_V2(1,e,t):box2d.b2Cross_V2_S(e,1,t);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),t.SetZero()}};goog.exportProperty(box2d.b2Simplex.prototype,"GetSearchDirection",box2d.b2Simplex.prototype.GetSearchDirection);box2d.b2Simplex.prototype.GetClosestPoint=function(t){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),t.SetZero();case 1:return t.Copy(this.m_v1.w);case 2:return t.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:return t.SetZero();default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),t.SetZero()}};goog.exportProperty(box2d.b2Simplex.prototype,"GetClosestPoint",box2d.b2Simplex.prototype.GetClosestPoint);box2d.b2Simplex.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);break;case 1:t.Copy(this.m_v1.wA);e.Copy(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}};goog.exportProperty(box2d.b2Simplex.prototype,"GetWitnessPoints",box2d.b2Simplex.prototype.GetWitnessPoints);box2d.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0;case 1:return 0;case 2:return box2d.b2Distance(this.m_v1.w,this.m_v2.w);case 3:return box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(this.m_v2.w,this.m_v1.w,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(this.m_v3.w,this.m_v1.w,box2d.b2Vec2.s_t1));default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2Simplex.prototype,"GetMetric",box2d.b2Simplex.prototype.GetMetric);box2d.b2Simplex.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,o=box2d.b2Sub_V2_V2(e,t,box2d.b2Simplex.s_e12),t=-box2d.b2Dot_V2_V2(t,o);0>=t?this.m_count=this.m_v1.a=1:(e=box2d.b2Dot_V2_V2(e,o),0>=e?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):(o=1/(e+t),this.m_v1.a=e*o,this.m_v2.a=t*o,this.m_count=2))};goog.exportProperty(box2d.b2Simplex.prototype,"Solve2",box2d.b2Simplex.prototype.Solve2);box2d.b2Simplex.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,o=this.m_v3.w,i=box2d.b2Sub_V2_V2(e,t,box2d.b2Simplex.s_e12),a=box2d.b2Dot_V2_V2(t,i),r=box2d.b2Dot_V2_V2(e,i),a=-a,s=box2d.b2Sub_V2_V2(o,t,box2d.b2Simplex.s_e13),n=box2d.b2Dot_V2_V2(t,s),b=box2d.b2Dot_V2_V2(o,s),n=-n,x=box2d.b2Sub_V2_V2(o,e,box2d.b2Simplex.s_e23),l=box2d.b2Dot_V2_V2(e,x),x=box2d.b2Dot_V2_V2(o,x),l=-l,s=box2d.b2Cross_V2_V2(i,s),i=s*box2d.b2Cross_V2_V2(e,o),o=s*box2d.b2Cross_V2_V2(o,t),t=s*box2d.b2Cross_V2_V2(t,e);0>=a&&0>=n?this.m_count=this.m_v1.a=1:0<r&&0<a&&0>=t?(b=1/(r+a),this.m_v1.a=r*b,this.m_v2.a=a*b,this.m_count=2):0<b&&0<n&&0>=o?(r=1/(b+n),this.m_v1.a=b*r,this.m_v3.a=n*r,this.m_count=2,this.m_v2.Copy(this.m_v3)):0>=r&&0>=l?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):0>=b&&0>=x?(this.m_count=this.m_v3.a=1,this.m_v1.Copy(this.m_v3)):0<x&&0<l&&0>=i?(r=1/(x+l),this.m_v2.a=x*r,this.m_v3.a=l*r,this.m_count=2,this.m_v1.Copy(this.m_v3)):(r=1/(i+o+t),this.m_v1.a=i*r,this.m_v2.a=o*r,this.m_v3.a=t*r,this.m_count=3)};goog.exportProperty(box2d.b2Simplex.prototype,"Solve3",box2d.b2Simplex.prototype.Solve3);box2d.b2Simplex.s_e12=new box2d.b2Vec2;box2d.b2Simplex.s_e13=new box2d.b2Vec2;box2d.b2Simplex.s_e23=new box2d.b2Vec2;box2d.b2ShapeDistance=function(t,e,o){++box2d.b2_gjkCalls;var i=o.proxyA,a=o.proxyB,r=o.transformA,s=o.transformB,n=box2d.b2Distance.s_simplex;n.ReadCache(e,i,r,a,s);for(var b=n.m_vertices,x=box2d.b2Distance.s_saveA,l=box2d.b2Distance.s_saveB,_=0,h=0;20>h;){for(var _=n.m_count,d=0;d<_;++d)x[d]=b[d].indexA,l[d]=b[d].indexB;switch(n.m_count){case 1:break;case 2:n.Solve2();break;case 3:n.Solve3();break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}if(3===n.m_count)break;var p=n.GetClosestPoint(box2d.b2Distance.s_p);p.LengthSquared();d=n.GetSearchDirection(box2d.b2Distance.s_d);if(d.LengthSquared()<box2d.b2_epsilon_sq)break;p=b[n.m_count];p.indexA=i.GetSupport(box2d.b2MulT_R_V2(r.q,box2d.b2Vec2.s_t0.Copy(d).SelfNeg(),box2d.b2Distance.s_supportA));box2d.b2Mul_X_V2(r,i.GetVertex(p.indexA),p.wA);p.indexB=a.GetSupport(box2d.b2MulT_R_V2(s.q,d,box2d.b2Distance.s_supportB));box2d.b2Mul_X_V2(s,a.GetVertex(p.indexB),p.wB);box2d.b2Sub_V2_V2(p.wB,p.wA,p.w);++h;++box2d.b2_gjkIters;for(var c=!1,d=0;d<_;++d)if(p.indexA===x[d]&&p.indexB===l[d]){c=!0;break}if(c)break;++n.m_count}box2d.b2_gjkMaxIters=box2d.b2Max(box2d.b2_gjkMaxIters,h);n.GetWitnessPoints(t.pointA,t.pointB);t.distance=box2d.b2Distance(t.pointA,t.pointB);t.iterations=h;n.WriteCache(e);o.useRadii&&(e=i.m_radius,a=a.m_radius,t.distance>e+a&&t.distance>box2d.b2_epsilon?(t.distance-=e+a,o=box2d.b2Sub_V2_V2(t.pointB,t.pointA,box2d.b2Distance.s_normal),o.Normalize(),t.pointA.SelfMulAdd(e,o),t.pointB.SelfMulSub(a,o)):(p=box2d.b2Mid_V2_V2(t.pointA,t.pointB,box2d.b2Distance.s_p),t.pointA.Copy(p),t.pointB.Copy(p),t.distance=0))};goog.exportSymbol("box2d.b2ShapeDistance",box2d.b2ShapeDistance);box2d.b2Distance.s_simplex=new box2d.b2Simplex;box2d.b2Distance.s_saveA=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_saveB=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_p=new box2d.b2Vec2;box2d.b2Distance.s_d=new box2d.b2Vec2;box2d.b2Distance.s_normal=new box2d.b2Vec2;box2d.b2Distance.s_supportA=new box2d.b2Vec2;box2d.b2Distance.s_supportB=new box2d.b2Vec2;box2d.b2Collision={};box2d.b2ContactFeatureType={e_vertex:0,e_face:1};goog.exportSymbol("box2d.b2ContactFeatureType",box2d.b2ContactFeatureType);goog.exportProperty(box2d.b2ContactFeatureType,"e_vertex",box2d.b2ContactFeatureType.e_vertex);goog.exportProperty(box2d.b2ContactFeatureType,"e_face",box2d.b2ContactFeatureType.e_face);box2d.b2ContactFeature=function(){};goog.exportSymbol("box2d.b2ContactFeature",box2d.b2ContactFeature);box2d.b2ContactFeature.prototype._key=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_key",box2d.b2ContactFeature.prototype._key);box2d.b2ContactFeature.prototype._key_invalid=!1;goog.exportProperty(box2d.b2ContactFeature.prototype,"_key_invalid",box2d.b2ContactFeature.prototype._key_invalid);box2d.b2ContactFeature.prototype._indexA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexA",box2d.b2ContactFeature.prototype._indexA);box2d.b2ContactFeature.prototype._indexB=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexB",box2d.b2ContactFeature.prototype._indexB);box2d.b2ContactFeature.prototype._typeA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeA",box2d.b2ContactFeature.prototype._typeA);box2d.b2ContactFeature.prototype._typeB=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeB",box2d.b2ContactFeature.prototype._typeB);Object.defineProperty(box2d.b2ContactFeature.prototype,"key",{enumerable:!1,configurable:!0,get:function(){this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24);return this._key},set:function(t){this._key=t;this._indexA=this._key&255;this._indexB=this._key>>8&255;this._typeA=this._key>>16&255;this._typeB=this._key>>24&255}});Object.defineProperty(box2d.b2ContactFeature.prototype,"indexA",{enumerable:!1,configurable:!0,get:function(){return this._indexA},set:function(t){this._indexA=t;this._key_invalid=!0}});Object.defineProperty(box2d.b2ContactFeature.prototype,"indexB",{enumerable:!1,configurable:!0,get:function(){return this._indexB},set:function(t){this._indexB=t;this._key_invalid=!0}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeA",{enumerable:!1,configurable:!0,get:function(){return this._typeA},set:function(t){this._typeA=t;this._key_invalid=!0}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeB",{enumerable:!1,configurable:!0,get:function(){return this._typeB},set:function(t){this._typeB=t;this._key_invalid=!0}});box2d.b2ContactID=function(){this.cf=new box2d.b2ContactFeature};goog.exportSymbol("box2d.b2ContactID",box2d.b2ContactID);box2d.b2ContactID.prototype.cf=null;goog.exportProperty(box2d.b2ContactID.prototype,"cf",box2d.b2ContactID.prototype.cf);box2d.b2ContactID.prototype.key=0;goog.exportProperty(box2d.b2ContactID.prototype,"key",box2d.b2ContactID.prototype.key);Object.defineProperty(box2d.b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this.cf.key},set:function(t){this.cf.key=t}});box2d.b2ContactID.prototype.Copy=function(t){this.key=t.key;return this};goog.exportProperty(box2d.b2ContactID.prototype,"Copy",box2d.b2ContactID.prototype.Copy);box2d.b2ContactID.prototype.Clone=function(){return(new box2d.b2ContactID).Copy(this)};goog.exportProperty(box2d.b2ContactID.prototype,"Clone",box2d.b2ContactID.prototype.Clone);box2d.b2ManifoldPoint=function(){this.localPoint=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ManifoldPoint",box2d.b2ManifoldPoint);box2d.b2ManifoldPoint.prototype.localPoint=null;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"localPoint",box2d.b2ManifoldPoint.prototype.localPoint);box2d.b2ManifoldPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"normalImpulse",box2d.b2ManifoldPoint.prototype.normalImpulse);box2d.b2ManifoldPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"tangentImpulse",box2d.b2ManifoldPoint.prototype.tangentImpulse);box2d.b2ManifoldPoint.prototype.id=null;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"id",box2d.b2ManifoldPoint.prototype.id);box2d.b2ManifoldPoint.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2ManifoldPoint})};goog.exportProperty(box2d.b2ManifoldPoint,"MakeArray",box2d.b2ManifoldPoint.MakeArray);box2d.b2ManifoldPoint.prototype.Reset=function(){this.localPoint.SetZero();this.tangentImpulse=this.normalImpulse=0;this.id.key=0};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Reset",box2d.b2ManifoldPoint.prototype.Reset);box2d.b2ManifoldPoint.prototype.Copy=function(t){this.localPoint.Copy(t.localPoint);this.normalImpulse=t.normalImpulse;this.tangentImpulse=t.tangentImpulse;this.id.Copy(t.id);return this};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Copy",box2d.b2ManifoldPoint.prototype.Copy);box2d.b2ManifoldType={e_unknown:-1,e_circles:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2ManifoldType",box2d.b2ManifoldType);goog.exportProperty(box2d.b2ManifoldType,"e_unknown",box2d.b2ManifoldType.e_unknown);goog.exportProperty(box2d.b2ManifoldType,"e_circles",box2d.b2ManifoldType.e_circles);goog.exportProperty(box2d.b2ManifoldType,"e_faceA",box2d.b2ManifoldType.e_faceA);goog.exportProperty(box2d.b2ManifoldType,"e_faceB",box2d.b2ManifoldType.e_faceB);box2d.b2Manifold=function(){this.points=box2d.b2ManifoldPoint.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};goog.exportSymbol("box2d.b2Manifold",box2d.b2Manifold);box2d.b2Manifold.prototype.points=null;goog.exportProperty(box2d.b2Manifold.prototype,"points",box2d.b2Manifold.prototype.points);box2d.b2Manifold.prototype.localNormal=null;goog.exportProperty(box2d.b2Manifold.prototype,"localNormal",box2d.b2Manifold.prototype.localNormal);box2d.b2Manifold.prototype.localPoint=null;goog.exportProperty(box2d.b2Manifold.prototype,"localPoint",box2d.b2Manifold.prototype.localPoint);box2d.b2Manifold.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2Manifold.prototype,"type",box2d.b2Manifold.prototype.type);box2d.b2Manifold.prototype.pointCount=0;goog.exportProperty(box2d.b2Manifold.prototype,"pointCount",box2d.b2Manifold.prototype.pointCount);box2d.b2Manifold.prototype.Reset=function(){for(var t=0,e=box2d.b2_maxManifoldPoints;t<e;++t)this.points[t].Reset();this.localNormal.SetZero();this.localPoint.SetZero();this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};goog.exportProperty(box2d.b2Manifold.prototype,"Reset",box2d.b2Manifold.prototype.Reset);box2d.b2Manifold.prototype.Copy=function(t){this.pointCount=t.pointCount;for(var e=0,o=box2d.b2_maxManifoldPoints;e<o;++e)this.points[e].Copy(t.points[e]);this.localNormal.Copy(t.localNormal);this.localPoint.Copy(t.localPoint);this.type=t.type;return this};goog.exportProperty(box2d.b2Manifold.prototype,"Copy",box2d.b2Manifold.prototype.Copy);box2d.b2Manifold.prototype.Clone=function(){return(new box2d.b2Manifold).Copy(this)};goog.exportProperty(box2d.b2Manifold.prototype,"Clone",box2d.b2Manifold.prototype.Clone);box2d.b2WorldManifold=function(){this.normal=new box2d.b2Vec2;this.points=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.separations=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2WorldManifold",box2d.b2WorldManifold);box2d.b2WorldManifold.prototype.normal=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"normal",box2d.b2WorldManifold.prototype.normal);box2d.b2WorldManifold.prototype.points=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"points",box2d.b2WorldManifold.prototype.points);box2d.b2WorldManifold.prototype.separations=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"separations",box2d.b2WorldManifold.prototype.separations);box2d.b2WorldManifold.prototype.Initialize=function(t,e,o,i,a){if(0!==t.pointCount)switch(t.type){case box2d.b2ManifoldType.e_circles:this.normal.Set(1,0);e=box2d.b2Mul_X_V2(e,t.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointA);t=box2d.b2Mul_X_V2(i,t.points[0].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointB);box2d.b2DistanceSquared(e,t)>box2d.b2_epsilon_sq&&box2d.b2Sub_V2_V2(t,e,this.normal).SelfNormalize();var r=box2d.b2AddMul_V2_S_V2(e,o,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),s=box2d.b2SubMul_V2_S_V2(t,a,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2Mid_V2_V2(r,s,this.points[0]);this.separations[0]=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(s,r,box2d.b2Vec2.s_t0),this.normal);break;case box2d.b2ManifoldType.e_faceA:box2d.b2Mul_R_V2(e.q,t.localNormal,this.normal);for(var n=box2d.b2Mul_X_V2(e,t.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),b=0,x=t.pointCount;b<x;++b){var l=box2d.b2Mul_X_V2(i,t.points[b].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),r=o-box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(l,n,box2d.b2Vec2.s_t0),this.normal),r=box2d.b2AddMul_V2_S_V2(l,r,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),s=box2d.b2SubMul_V2_S_V2(l,a,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2Mid_V2_V2(r,s,this.points[b]);this.separations[b]=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(s,r,box2d.b2Vec2.s_t0),this.normal)}break;case box2d.b2ManifoldType.e_faceB:box2d.b2Mul_R_V2(i.q,t.localNormal,this.normal);n=box2d.b2Mul_X_V2(i,t.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint);b=0;for(x=t.pointCount;b<x;++b)l=box2d.b2Mul_X_V2(e,t.points[b].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),r=a-box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(l,n,box2d.b2Vec2.s_t0),this.normal),s=box2d.b2AddMul_V2_S_V2(l,r,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB),r=box2d.b2SubMul_V2_S_V2(l,o,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),box2d.b2Mid_V2_V2(r,s,this.points[b]),this.separations[b]=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(r,s,box2d.b2Vec2.s_t0),this.normal);this.normal.SelfNeg()}};goog.exportProperty(box2d.b2WorldManifold.prototype,"Initialize",box2d.b2WorldManifold.prototype.Initialize);box2d.b2WorldManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2PointState={b2_nullState:0,b2_addState:1,b2_persistState:2,b2_removeState:3};goog.exportSymbol("box2d.b2PointState",box2d.b2PointState);goog.exportProperty(box2d.b2PointState,"b2_nullState   ",box2d.b2PointState.b2_nullState);goog.exportProperty(box2d.b2PointState,"b2_addState    ",box2d.b2PointState.b2_addState);goog.exportProperty(box2d.b2PointState,"b2_persistState",box2d.b2PointState.b2_persistState);goog.exportProperty(box2d.b2PointState,"b2_removeState ",box2d.b2PointState.b2_removeState);box2d.b2GetPointStates=function(t,e,o,i){for(var a=0,r=o.pointCount;a<r;++a){var s=o.points[a].id,s=s.key;t[a]=box2d.b2PointState.b2_removeState;for(var n=0,b=i.pointCount;n<b;++n)if(i.points[n].id.key===s){t[a]=box2d.b2PointState.b2_persistState;break}}for(r=box2d.b2_maxManifoldPoints;a<r;++a)t[a]=box2d.b2PointState.b2_nullState;a=0;for(r=i.pointCount;a<r;++a)for(s=i.points[a].id,s=s.key,e[a]=box2d.b2PointState.b2_addState,n=0,b=o.pointCount;n<b;++n)if(o.points[n].id.key===s){e[a]=box2d.b2PointState.b2_persistState;break}for(r=box2d.b2_maxManifoldPoints;a<r;++a)e[a]=box2d.b2PointState.b2_nullState};goog.exportSymbol("box2d.b2GetPointStates",box2d.b2GetPointStates);box2d.b2ClipVertex=function(){this.v=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ClipVertex",box2d.b2ClipVertex);box2d.b2ClipVertex.prototype.v=null;goog.exportProperty(box2d.b2ClipVertex.prototype,"v",box2d.b2ClipVertex.prototype.v);box2d.b2ClipVertex.prototype.id=null;goog.exportProperty(box2d.b2ClipVertex.prototype,"id",box2d.b2ClipVertex.prototype.id);box2d.b2ClipVertex.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2ClipVertex})};goog.exportProperty(box2d.b2ClipVertex,"MakeArray",box2d.b2ClipVertex.MakeArray);box2d.b2ClipVertex.prototype.Copy=function(t){this.v.Copy(t.v);this.id.Copy(t.id);return this};goog.exportProperty(box2d.b2ClipVertex.prototype,"Copy",box2d.b2ClipVertex.prototype.Copy);box2d.b2RayCastInput=function(){this.p1=new box2d.b2Vec2;this.p2=new box2d.b2Vec2;this.maxFraction=1};goog.exportSymbol("box2d.b2RayCastInput",box2d.b2RayCastInput);box2d.b2RayCastInput.prototype.p1=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p1",box2d.b2RayCastInput.prototype.p1);box2d.b2RayCastInput.prototype.p2=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p2",box2d.b2RayCastInput.prototype.p2);box2d.b2RayCastInput.prototype.maxFraction=1;goog.exportProperty(box2d.b2RayCastInput.prototype,"maxFraction",box2d.b2RayCastInput.prototype.maxFraction);box2d.b2RayCastInput.prototype.Copy=function(t){this.p1.Copy(t.p1);this.p2.Copy(t.p2);this.maxFraction=t.maxFraction;return this};goog.exportProperty(box2d.b2RayCastInput.prototype,"Copy",box2d.b2RayCastInput.prototype.Copy);box2d.b2RayCastOutput=function(){this.normal=new box2d.b2Vec2;this.fraction=0};goog.exportSymbol("box2d.b2RayCastOutput",box2d.b2RayCastOutput);box2d.b2RayCastOutput.prototype.normal=null;goog.exportProperty(box2d.b2RayCastOutput.prototype,"normal",box2d.b2RayCastOutput.prototype.normal);box2d.b2RayCastOutput.prototype.fraction=0;goog.exportProperty(box2d.b2RayCastOutput.prototype,"fraction",box2d.b2RayCastOutput.prototype.fraction);box2d.b2RayCastOutput.prototype.Copy=function(t){this.normal.Copy(t.normal);this.fraction=t.fraction;return this};goog.exportProperty(box2d.b2RayCastOutput.prototype,"Copy",box2d.b2RayCastOutput.prototype.Copy);box2d.b2AABB=function(){this.lowerBound=new box2d.b2Vec2;this.upperBound=new box2d.b2Vec2;this.m_out_center=new box2d.b2Vec2;this.m_out_extent=new box2d.b2Vec2};goog.exportSymbol("box2d.b2AABB",box2d.b2AABB);box2d.b2AABB.prototype.lowerBound=null;goog.exportProperty(box2d.b2AABB.prototype,"lowerBound",box2d.b2AABB.prototype.lowerBound);box2d.b2AABB.prototype.upperBound=null;goog.exportProperty(box2d.b2AABB.prototype,"upperBound",box2d.b2AABB.prototype.upperBound);box2d.b2AABB.prototype.m_out_center=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_center",box2d.b2AABB.prototype.m_out_center);box2d.b2AABB.prototype.m_out_extent=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_extent",box2d.b2AABB.prototype.m_out_extent);box2d.b2AABB.prototype.Clone=function(){return(new box2d.b2AABB).Copy(this)};goog.exportProperty(box2d.b2AABB.prototype,"Clone",box2d.b2AABB.prototype.Clone);box2d.b2AABB.prototype.Copy=function(t){this.lowerBound.Copy(t.lowerBound);this.upperBound.Copy(t.upperBound);return this};goog.exportProperty(box2d.b2AABB.prototype,"Copy",box2d.b2AABB.prototype.Copy);box2d.b2AABB.prototype.IsValid=function(){var t=this.upperBound.y-this.lowerBound.y;return t=(t=0<=this.upperBound.x-this.lowerBound.x&&0<=t)&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};goog.exportProperty(box2d.b2AABB.prototype,"IsValid",box2d.b2AABB.prototype.IsValid);box2d.b2AABB.prototype.GetCenter=function(){return box2d.b2Mid_V2_V2(this.lowerBound,this.upperBound,this.m_out_center)};goog.exportProperty(box2d.b2AABB.prototype,"GetCenter",box2d.b2AABB.prototype.GetCenter);box2d.b2AABB.prototype.GetExtents=function(){return box2d.b2Ext_V2_V2(this.lowerBound,this.upperBound,this.m_out_extent)};goog.exportProperty(box2d.b2AABB.prototype,"GetExtents",box2d.b2AABB.prototype.GetExtents);box2d.b2AABB.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))};goog.exportProperty(box2d.b2AABB.prototype,"GetPerimeter",box2d.b2AABB.prototype.GetPerimeter);box2d.b2AABB.prototype.Combine=function(t,e){switch(arguments.length){case 1:return this.Combine1(t);case 2:return this.Combine2(t,e||new box2d.b2AABB);default:throw Error()}};box2d.b2AABB.prototype.Combine1=function(t){this.lowerBound.x=box2d.b2Min(this.lowerBound.x,t.lowerBound.x);this.lowerBound.y=box2d.b2Min(this.lowerBound.y,t.lowerBound.y);this.upperBound.x=box2d.b2Max(this.upperBound.x,t.upperBound.x);this.upperBound.y=box2d.b2Max(this.upperBound.y,t.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine1",box2d.b2AABB.prototype.Combine1);box2d.b2AABB.prototype.Combine2=function(t,e){this.lowerBound.x=box2d.b2Min(t.lowerBound.x,e.lowerBound.x);this.lowerBound.y=box2d.b2Min(t.lowerBound.y,e.lowerBound.y);this.upperBound.x=box2d.b2Max(t.upperBound.x,e.upperBound.x);this.upperBound.y=box2d.b2Max(t.upperBound.y,e.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine2",box2d.b2AABB.prototype.Combine2);box2d.b2AABB.Combine=function(t,e,o){o.Combine2(t,e);return o};goog.exportProperty(box2d.b2AABB,"Combine",box2d.b2AABB.Combine);box2d.b2AABB.prototype.Contains=function(t){var e;return e=(e=(e=(e=this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y};goog.exportProperty(box2d.b2AABB.prototype,"Contains",box2d.b2AABB.prototype.Contains);box2d.b2AABB.prototype.RayCast=function(t,e){var o=-box2d.b2_maxFloat,i=box2d.b2_maxFloat,a=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,n=e.p2.y-e.p1.y,b=box2d.b2Abs(s),x=box2d.b2Abs(n),l=t.normal;if(b<box2d.b2_epsilon){if(a<this.lowerBound.x||this.upperBound.x<a)return!1}else if(b=1/s,s=(this.lowerBound.x-a)*b,a=(this.upperBound.x-a)*b,b=-1,s>a&&(b=s,s=a,a=b,b=1),s>o&&(l.x=b,l.y=0,o=s),i=box2d.b2Min(i,a),o>i)return!1;if(x<box2d.b2_epsilon){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else if(b=1/n,s=(this.lowerBound.y-r)*b,a=(this.upperBound.y-r)*b,b=-1,s>a&&(b=s,s=a,a=b,b=1),s>o&&(l.x=0,l.y=b,o=s),i=box2d.b2Min(i,a),o>i)return!1;if(0>o||e.maxFraction<o)return!1;t.fraction=o;return!0};goog.exportProperty(box2d.b2AABB.prototype,"RayCast",box2d.b2AABB.prototype.RayCast);box2d.b2AABB.prototype.TestOverlap=function(t){var e=t.lowerBound.y-this.upperBound.y,o=this.lowerBound.y-t.upperBound.y;return 0<t.lowerBound.x-this.upperBound.x||0<e||0<this.lowerBound.x-t.upperBound.x||0<o?!1:!0};goog.exportProperty(box2d.b2AABB.prototype,"TestOverlap",box2d.b2AABB.prototype.TestOverlap);box2d.b2TestOverlap_AABB=function(t,e){var o=e.lowerBound.y-t.upperBound.y,i=t.lowerBound.y-e.upperBound.y;return 0<e.lowerBound.x-t.upperBound.x||0<o||0<t.lowerBound.x-e.upperBound.x||0<i?!1:!0};goog.exportSymbol("box2d.b2TestOverlap_AABB",box2d.b2TestOverlap_AABB);box2d.b2ClipSegmentToLine=function(t,e,o,i,a){var r=0,s=e[0];e=e[1];var n=box2d.b2Dot_V2_V2(o,s.v)-i;o=box2d.b2Dot_V2_V2(o,e.v)-i;0>=n&&t[r++].Copy(s);0>=o&&t[r++].Copy(e);0>n*o&&(o=n/(n-o),i=t[r].v,i.x=s.v.x+o*(e.v.x-s.v.x),i.y=s.v.y+o*(e.v.y-s.v.y),t=t[r].id,t.cf.indexA=a,t.cf.indexB=s.id.cf.indexB,t.cf.typeA=box2d.b2ContactFeatureType.e_vertex,t.cf.typeB=box2d.b2ContactFeatureType.e_face,++r);return r};goog.exportSymbol("box2d.b2ClipSegmentToLine",box2d.b2ClipSegmentToLine);box2d.b2TestOverlap_Shape=function(t,e,o,i,a,r){var s=box2d.b2TestOverlap_Shape.s_input.Reset();s.proxyA.SetShape(t,e);s.proxyB.SetShape(o,i);s.transformA.Copy(a);s.transformB.Copy(r);s.useRadii=!0;t=box2d.b2TestOverlap_Shape.s_simplexCache.Reset();t.count=0;e=box2d.b2TestOverlap_Shape.s_output.Reset();box2d.b2ShapeDistance(e,t,s);return e.distance<10*box2d.b2_epsilon};goog.exportSymbol("box2d.b2TestOverlap_Shape",box2d.b2TestOverlap_Shape);box2d.b2TestOverlap_Shape.s_input=new box2d.b2DistanceInput;box2d.b2TestOverlap_Shape.s_simplexCache=new box2d.b2SimplexCache;box2d.b2TestOverlap_Shape.s_output=new box2d.b2DistanceOutput;box2d.b2TestOverlap=function(t,e,o,i,a,r){if(t instanceof box2d.b2AABB&&e instanceof box2d.b2AABB)return box2d.b2TestOverlap_AABB(t,e);if(t instanceof box2d.b2Shape&&"number"===typeof e&&o instanceof box2d.b2Shape&&"number"===typeof i&&a instanceof box2d.b2Transform&&r instanceof box2d.b2Transform)return box2d.b2TestOverlap_Shape(t,e,o,i,a,r);throw Error()};goog.exportSymbol("box2d.b2TestOverlap",box2d.b2TestOverlap);box2d.b2CollideCircle={};box2d.b2CollideCircles=function(t,e,o,i,a){t.pointCount=0;o=box2d.b2Mul_X_V2(o,e.m_p,box2d.b2CollideCircles.s_pA);a=box2d.b2Mul_X_V2(a,i.m_p,box2d.b2CollideCircles.s_pB);a=box2d.b2DistanceSquared(o,a);o=e.m_radius+i.m_radius;a>o*o||(t.type=box2d.b2ManifoldType.e_circles,t.localPoint.Copy(e.m_p),t.localNormal.SetZero(),t.pointCount=1,t.points[0].localPoint.Copy(i.m_p),t.points[0].id.key=0)};goog.exportSymbol("box2d.b2CollideCircles",box2d.b2CollideCircles);box2d.b2CollideCircles.s_pA=new box2d.b2Vec2;box2d.b2CollideCircles.s_pB=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle=function(t,e,o,i,a){t.pointCount=0;a=box2d.b2Mul_X_V2(a,i.m_p,box2d.b2CollidePolygonAndCircle.s_c);o=box2d.b2MulT_X_V2(o,a,box2d.b2CollidePolygonAndCircle.s_cLocal);var r=0,s=-box2d.b2_maxFloat;a=e.m_radius+i.m_radius;var n=e.m_count,b=e.m_vertices;e=e.m_normals;for(var x=0;x<n;++x){var l=box2d.b2Dot_V2_V2(e[x],box2d.b2Sub_V2_V2(o,b[x],box2d.b2Vec2.s_t0));if(l>a)return;l>s&&(s=l,r=x)}x=r;l=b[x];n=b[(x+1)%n];s<box2d.b2_epsilon?(t.pointCount=1,t.type=box2d.b2ManifoldType.e_faceA,t.localNormal.Copy(e[r]),box2d.b2Mid_V2_V2(l,n,t.localPoint),t.points[0].localPoint.Copy(i.m_p),t.points[0].id.key=0):(s=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(o,l,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(n,l,box2d.b2Vec2.s_t1)),r=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(o,n,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(l,n,box2d.b2Vec2.s_t1)),0>=s?box2d.b2DistanceSquared(o,l)>a*a||(t.pointCount=1,t.type=box2d.b2ManifoldType.e_faceA,box2d.b2Sub_V2_V2(o,l,t.localNormal).SelfNormalize(),t.localPoint.Copy(l),t.points[0].localPoint.Copy(i.m_p),t.points[0].id.key=0):0>=r?box2d.b2DistanceSquared(o,n)>a*a||(t.pointCount=1,t.type=box2d.b2ManifoldType.e_faceA,box2d.b2Sub_V2_V2(o,n,t.localNormal).SelfNormalize(),t.localPoint.Copy(n),t.points[0].localPoint.Copy(i.m_p),t.points[0].id.key=0):(r=box2d.b2Mid_V2_V2(l,n,box2d.b2CollidePolygonAndCircle.s_faceCenter),s=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(o,r,box2d.b2Vec2.s_t1),e[x]),s>a||(t.pointCount=1,t.type=box2d.b2ManifoldType.e_faceA,t.localNormal.Copy(e[x]).SelfNormalize(),t.localPoint.Copy(r),t.points[0].localPoint.Copy(i.m_p),t.points[0].id.key=0)))};goog.exportSymbol("box2d.b2CollidePolygonAndCircle",box2d.b2CollidePolygonAndCircle);box2d.b2CollidePolygonAndCircle.s_c=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_cLocal=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_faceCenter=new box2d.b2Vec2;box2d.b2CollideEdge={};box2d.b2CollideEdgeAndCircle=function(t,e,o,i,a){t.pointCount=0;o=box2d.b2MulT_X_V2(o,box2d.b2Mul_X_V2(a,i.m_p,box2d.b2Vec2.s_t0),box2d.b2CollideEdgeAndCircle.s_Q);var r=e.m_vertex1,s=e.m_vertex2,n=box2d.b2Sub_V2_V2(s,r,box2d.b2CollideEdgeAndCircle.s_e),b=box2d.b2Dot_V2_V2(n,box2d.b2Sub_V2_V2(s,o,box2d.b2Vec2.s_t0)),x=box2d.b2Dot_V2_V2(n,box2d.b2Sub_V2_V2(o,r,box2d.b2Vec2.s_t0)),l=e.m_radius+i.m_radius;a=box2d.b2CollideEdgeAndCircle.s_id;a.cf.indexB=0;a.cf.typeB=box2d.b2ContactFeatureType.e_vertex;if(0>=x){var _=r,b=box2d.b2Sub_V2_V2(o,_,box2d.b2CollideEdgeAndCircle.s_d),b=box2d.b2Dot_V2_V2(b,b);if(!(b>l*l)){if(e.m_hasVertex0&&(e=box2d.b2Sub_V2_V2(r,e.m_vertex0,box2d.b2CollideEdgeAndCircle.s_e1),0<box2d.b2Dot_V2_V2(e,box2d.b2Sub_V2_V2(r,o,box2d.b2Vec2.s_t0))))return;a.cf.indexA=0;a.cf.typeA=box2d.b2ContactFeatureType.e_vertex;t.pointCount=1;t.type=box2d.b2ManifoldType.e_circles;t.localNormal.SetZero();t.localPoint.Copy(_);t.points[0].id.Copy(a);t.points[0].localPoint.Copy(i.m_p)}}else if(0>=b){if(_=s,b=box2d.b2Sub_V2_V2(o,_,box2d.b2CollideEdgeAndCircle.s_d),b=box2d.b2Dot_V2_V2(b,b),!(b>l*l)){if(e.m_hasVertex3&&(r=box2d.b2Sub_V2_V2(e.m_vertex3,s,box2d.b2CollideEdgeAndCircle.s_e2),0<box2d.b2Dot_V2_V2(r,box2d.b2Sub_V2_V2(o,s,box2d.b2Vec2.s_t0))))return;a.cf.indexA=1;a.cf.typeA=box2d.b2ContactFeatureType.e_vertex;t.pointCount=1;t.type=box2d.b2ManifoldType.e_circles;t.localNormal.SetZero();t.localPoint.Copy(_);t.points[0].id.Copy(a);t.points[0].localPoint.Copy(i.m_p)}}else e=box2d.b2Dot_V2_V2(n,n),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<e),_=box2d.b2CollideEdgeAndCircle.s_P,_.x=1/e*(b*r.x+x*s.x),_.y=1/e*(b*r.y+x*s.y),b=box2d.b2Sub_V2_V2(o,_,box2d.b2CollideEdgeAndCircle.s_d),b=box2d.b2Dot_V2_V2(b,b),b>l*l||(_=box2d.b2CollideEdgeAndCircle.s_n.Set(-n.y,n.x),0>box2d.b2Dot_V2_V2(_,box2d.b2Sub_V2_V2(o,r,box2d.b2Vec2.s_t0))&&_.Set(-_.x,-_.y),_.Normalize(),a.cf.indexA=0,a.cf.typeA=box2d.b2ContactFeatureType.e_face,t.pointCount=1,t.type=box2d.b2ManifoldType.e_faceA,t.localNormal.Copy(_),t.localPoint.Copy(r),t.points[0].id.Copy(a),t.points[0].localPoint.Copy(i.m_p))};goog.exportSymbol("box2d.b2CollideEdgeAndCircle",box2d.b2CollideEdgeAndCircle);box2d.b2CollideEdgeAndCircle.s_Q=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_d=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e1=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e2=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_P=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_n=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_id=new box2d.b2ContactID;box2d.b2EPAxisType={e_unknown:0,e_edgeA:1,e_edgeB:2};goog.exportSymbol("box2d.b2EPAxisType",box2d.b2EPAxisType);goog.exportProperty(box2d.b2EPAxisType,"e_unknown",box2d.b2EPAxisType.e_unknown);goog.exportProperty(box2d.b2EPAxisType,"e_edgeA",box2d.b2EPAxisType.e_edgeA);goog.exportProperty(box2d.b2EPAxisType,"e_edgeB",box2d.b2EPAxisType.e_edgeB);box2d.b2EPAxis=function(){};goog.exportSymbol("box2d.b2EPAxis",box2d.b2EPAxis);box2d.b2EPAxis.prototype.type=box2d.b2EPAxisType.e_unknown;goog.exportProperty(box2d.b2EPAxis.prototype,"type",box2d.b2EPAxis.prototype.type);box2d.b2EPAxis.prototype.index=0;goog.exportProperty(box2d.b2EPAxis.prototype,"index",box2d.b2EPAxis.prototype.index);box2d.b2EPAxis.prototype.separation=0;goog.exportProperty(box2d.b2EPAxis.prototype,"separation",box2d.b2EPAxis.prototype.separation);box2d.b2TempPolygon=function(){this.vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.count=0};goog.exportSymbol("box2d.b2TempPolygon",box2d.b2TempPolygon);box2d.b2TempPolygon.prototype.vertices=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"vertices",box2d.b2TempPolygon.prototype.vertices);box2d.b2TempPolygon.prototype.normals=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"normals",box2d.b2TempPolygon.prototype.normals);box2d.b2TempPolygon.prototype.count=0;goog.exportProperty(box2d.b2TempPolygon.prototype,"count",box2d.b2TempPolygon.prototype.count);box2d.b2ReferenceFace=function(){this.i2=this.i1=0;this.v1=new box2d.b2Vec2;this.v2=new box2d.b2Vec2;this.normal=new box2d.b2Vec2;this.sideNormal1=new box2d.b2Vec2;this.sideOffset1=0;this.sideNormal2=new box2d.b2Vec2;this.sideOffset2=0};goog.exportSymbol("box2d.b2ReferenceFace",box2d.b2ReferenceFace);box2d.b2ReferenceFace.prototype.i1=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"i1",box2d.b2ReferenceFace.prototype.i1);box2d.b2ReferenceFace.prototype.i2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"i2",box2d.b2ReferenceFace.prototype.i2);box2d.b2ReferenceFace.prototype.v1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v1",box2d.b2ReferenceFace.prototype.v1);box2d.b2ReferenceFace.prototype.v2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v2",box2d.b2ReferenceFace.prototype.v2);box2d.b2ReferenceFace.prototype.normal=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"normal",box2d.b2ReferenceFace.prototype.normal);box2d.b2ReferenceFace.prototype.sideNormal1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal1",box2d.b2ReferenceFace.prototype.sideNormal1);box2d.b2ReferenceFace.prototype.sideOffset1=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset1",box2d.b2ReferenceFace.prototype.sideOffset1);box2d.b2ReferenceFace.prototype.sideNormal2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal2",box2d.b2ReferenceFace.prototype.sideNormal2);box2d.b2ReferenceFace.prototype.sideOffset2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset2",box2d.b2ReferenceFace.prototype.sideOffset2);box2d.b2EPColliderVertexType={e_isolated:0,e_concave:1,e_convex:2};goog.exportSymbol("box2d.b2EPColliderVertexType",box2d.b2EPColliderVertexType);goog.exportProperty(box2d.b2EPColliderVertexType,"e_isolated",box2d.b2EPColliderVertexType.e_isolated);goog.exportProperty(box2d.b2EPColliderVertexType,"e_concave",box2d.b2EPColliderVertexType.e_concave);goog.exportProperty(box2d.b2EPColliderVertexType,"e_convex",box2d.b2EPColliderVertexType.e_convex);box2d.b2EPCollider=function(){this.m_polygonB=new box2d.b2TempPolygon;this.m_xf=new box2d.b2Transform;this.m_centroidB=new box2d.b2Vec2;this.m_v0=new box2d.b2Vec2;this.m_v1=new box2d.b2Vec2;this.m_v2=new box2d.b2Vec2;this.m_v3=new box2d.b2Vec2;this.m_normal0=new box2d.b2Vec2;this.m_normal1=new box2d.b2Vec2;this.m_normal2=new box2d.b2Vec2;this.m_normal=new box2d.b2Vec2;this.m_type2=this.m_type1=box2d.b2EPColliderVertexType.e_isolated;this.m_lowerLimit=new box2d.b2Vec2;this.m_upperLimit=new box2d.b2Vec2;this.m_radius=0;this.m_front=!1};goog.exportSymbol("box2d.b2EPCollider",box2d.b2EPCollider);box2d.b2EPCollider.prototype.m_polygonB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_polygonB",box2d.b2EPCollider.prototype.m_polygonB);box2d.b2EPCollider.prototype.m_xf=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_xf",box2d.b2EPCollider.prototype.m_xf);box2d.b2EPCollider.prototype.m_centroidB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_centroidB",box2d.b2EPCollider.prototype.m_centroidB);box2d.b2EPCollider.prototype.m_v0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v0",box2d.b2EPCollider.prototype.m_v0);box2d.b2EPCollider.prototype.m_v1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v1",box2d.b2EPCollider.prototype.m_v1);box2d.b2EPCollider.prototype.m_v2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v2",box2d.b2EPCollider.prototype.m_v2);box2d.b2EPCollider.prototype.m_v3=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v3",box2d.b2EPCollider.prototype.m_v3);box2d.b2EPCollider.prototype.m_normal0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal0",box2d.b2EPCollider.prototype.m_normal0);box2d.b2EPCollider.prototype.m_normal1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal1",box2d.b2EPCollider.prototype.m_normal1);box2d.b2EPCollider.prototype.m_normal2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal2",box2d.b2EPCollider.prototype.m_normal2);box2d.b2EPCollider.prototype.m_normal=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal",box2d.b2EPCollider.prototype.m_normal);box2d.b2EPCollider.prototype.m_type1=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type1",box2d.b2EPCollider.prototype.m_type1);box2d.b2EPCollider.prototype.m_type2=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type2",box2d.b2EPCollider.prototype.m_type2);box2d.b2EPCollider.prototype.m_lowerLimit=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_lowerLimit",box2d.b2EPCollider.prototype.m_lowerLimit);box2d.b2EPCollider.prototype.m_upperLimit=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_upperLimit",box2d.b2EPCollider.prototype.m_upperLimit);box2d.b2EPCollider.prototype.m_radius=0;goog.exportProperty(box2d.b2EPCollider.prototype,"m_radius",box2d.b2EPCollider.prototype.m_radius);box2d.b2EPCollider.prototype.m_front=!1;goog.exportProperty(box2d.b2EPCollider.prototype,"m_front",box2d.b2EPCollider.prototype.m_front);box2d.b2EPCollider.prototype.Collide=function(t,e,o,i,a){box2d.b2MulT_X_X(o,a,this.m_xf);box2d.b2Mul_X_V2(this.m_xf,i.m_centroid,this.m_centroidB);this.m_v0.Copy(e.m_vertex0);this.m_v1.Copy(e.m_vertex1);this.m_v2.Copy(e.m_vertex2);this.m_v3.Copy(e.m_vertex3);o=e.m_hasVertex0;e=e.m_hasVertex3;a=box2d.b2Sub_V2_V2(this.m_v2,this.m_v1,box2d.b2EPCollider.s_edge1);a.Normalize();this.m_normal1.Set(a.y,-a.x);var r=box2d.b2Dot_V2_V2(this.m_normal1,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v1,box2d.b2Vec2.s_t0)),s=0,n=0,b=!1,x=!1;o&&(s=box2d.b2Sub_V2_V2(this.m_v1,this.m_v0,box2d.b2EPCollider.s_edge0),s.Normalize(),this.m_normal0.Set(s.y,-s.x),b=0<=box2d.b2Cross_V2_V2(s,a),s=box2d.b2Dot_V2_V2(this.m_normal0,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v0,box2d.b2Vec2.s_t0)));e&&(n=box2d.b2Sub_V2_V2(this.m_v3,this.m_v2,box2d.b2EPCollider.s_edge2),n.Normalize(),this.m_normal2.Set(n.y,-n.x),x=0<box2d.b2Cross_V2_V2(a,n),n=box2d.b2Dot_V2_V2(this.m_normal2,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v2,box2d.b2Vec2.s_t0)));o&&e?b&&x?(this.m_front=0<=s||0<=r||0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):b?(this.m_front=0<=s||0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):x?(this.m_front=0<=n||0<=s&&0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):(this.m_front=0<=s&&0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):o?b?((this.m_front=0<=s||0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1)),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_front=0<=s&&0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):e?x?(this.m_front=0<=r||0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):((this.m_front=0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg()),this.m_upperLimit.Copy(this.m_normal1)):(this.m_front=0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1));this.m_polygonB.count=i.m_count;r=0;for(s=i.m_count;r<s;++r)box2d.b2Mul_X_V2(this.m_xf,i.m_vertices[r],this.m_polygonB.vertices[r]),box2d.b2Mul_R_V2(this.m_xf.q,i.m_normals[r],this.m_polygonB.normals[r]);this.m_radius=2*box2d.b2_polygonRadius;t.pointCount=0;o=this.ComputeEdgeSeparation(box2d.b2EPCollider.s_edgeAxis);if(!(o.type===box2d.b2EPAxisType.e_unknown||o.separation>this.m_radius||(e=this.ComputePolygonSeparation(box2d.b2EPCollider.s_polygonAxis),e.type!==box2d.b2EPAxisType.e_unknown&&e.separation>this.m_radius))){o=e.type===box2d.b2EPAxisType.e_unknown?o:e.separation>.98*o.separation+.001?e:o;a=box2d.b2EPCollider.s_ie;e=box2d.b2EPCollider.s_rf;if(o.type===box2d.b2EPAxisType.e_edgeA){t.type=box2d.b2ManifoldType.e_faceA;n=0;b=box2d.b2Dot_V2_V2(this.m_normal,this.m_polygonB.normals[0]);r=1;for(s=this.m_polygonB.count;r<s;++r)x=box2d.b2Dot_V2_V2(this.m_normal,this.m_polygonB.normals[r]),x<b&&(b=x,n=r);s=n;r=(s+1)%this.m_polygonB.count;n=a[0];n.v.Copy(this.m_polygonB.vertices[s]);n.id.cf.indexA=0;n.id.cf.indexB=s;n.id.cf.typeA=box2d.b2ContactFeatureType.e_face;n.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;s=a[1];s.v.Copy(this.m_polygonB.vertices[r]);s.id.cf.indexA=0;s.id.cf.indexB=r;s.id.cf.typeA=box2d.b2ContactFeatureType.e_face;s.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;this.m_front?(e.i1=0,e.i2=1,e.v1.Copy(this.m_v1),e.v2.Copy(this.m_v2),e.normal.Copy(this.m_normal1)):(e.i1=1,e.i2=0,e.v1.Copy(this.m_v2),e.v2.Copy(this.m_v1),e.normal.Copy(this.m_normal1).SelfNeg())}else t.type=box2d.b2ManifoldType.e_faceB,n=a[0],n.v.Copy(this.m_v1),n.id.cf.indexA=0,n.id.cf.indexB=o.index,n.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,n.id.cf.typeB=box2d.b2ContactFeatureType.e_face,s=a[1],s.v.Copy(this.m_v2),s.id.cf.indexA=0,s.id.cf.indexB=o.index,s.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,s.id.cf.typeB=box2d.b2ContactFeatureType.e_face,e.i1=o.index,e.i2=(e.i1+1)%this.m_polygonB.count,e.v1.Copy(this.m_polygonB.vertices[e.i1]),e.v2.Copy(this.m_polygonB.vertices[e.i2]),e.normal.Copy(this.m_polygonB.normals[e.i1]);e.sideNormal1.Set(e.normal.y,-e.normal.x);e.sideNormal2.Copy(e.sideNormal1).SelfNeg();e.sideOffset1=box2d.b2Dot_V2_V2(e.sideNormal1,e.v1);e.sideOffset2=box2d.b2Dot_V2_V2(e.sideNormal2,e.v2);r=box2d.b2EPCollider.s_clipPoints1;n=box2d.b2EPCollider.s_clipPoints2;s=0;s=box2d.b2ClipSegmentToLine(r,a,e.sideNormal1,e.sideOffset1,e.i1);if(!(s<box2d.b2_maxManifoldPoints||(s=box2d.b2ClipSegmentToLine(n,r,e.sideNormal2,e.sideOffset2,e.i2),s<box2d.b2_maxManifoldPoints))){o.type===box2d.b2EPAxisType.e_edgeA?(t.localNormal.Copy(e.normal),t.localPoint.Copy(e.v1)):(t.localNormal.Copy(i.m_normals[e.i1]),t.localPoint.Copy(i.m_vertices[e.i1]));r=i=0;for(s=box2d.b2_maxManifoldPoints;r<s;++r)box2d.b2Dot_V2_V2(e.normal,box2d.b2Sub_V2_V2(n[r].v,e.v1,box2d.b2Vec2.s_t0))<=this.m_radius&&(a=t.points[i],o.type===box2d.b2EPAxisType.e_edgeA?(box2d.b2MulT_X_V2(this.m_xf,n[r].v,a.localPoint),a.id=n[r].id):(a.localPoint.Copy(n[r].v),a.id.cf.typeA=n[r].id.cf.typeB,a.id.cf.typeB=n[r].id.cf.typeA,a.id.cf.indexA=n[r].id.cf.indexB,a.id.cf.indexB=n[r].id.cf.indexA),++i);t.pointCount=i}}};goog.exportProperty(box2d.b2EPCollider.prototype,"Collide",box2d.b2EPCollider.prototype.Collide);box2d.b2EPCollider.s_edge1=new box2d.b2Vec2;box2d.b2EPCollider.s_edge0=new box2d.b2Vec2;box2d.b2EPCollider.s_edge2=new box2d.b2Vec2;box2d.b2EPCollider.s_ie=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_rf=new box2d.b2ReferenceFace;box2d.b2EPCollider.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_edgeAxis=new box2d.b2EPAxis;box2d.b2EPCollider.s_polygonAxis=new box2d.b2EPAxis;box2d.b2EPCollider.prototype.ComputeEdgeSeparation=function(t){t.type=box2d.b2EPAxisType.e_edgeA;t.index=this.m_front?0:1;t.separation=box2d.b2_maxFloat;for(var e=0,o=this.m_polygonB.count;e<o;++e){var i=box2d.b2Dot_V2_V2(this.m_normal,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[e],this.m_v1,box2d.b2Vec2.s_t0));i<t.separation&&(t.separation=i)}return t};goog.exportProperty(box2d.b2EPCollider.prototype,"ComputeEdgeSeparation",box2d.b2EPCollider.prototype.ComputeEdgeSeparation);box2d.b2EPCollider.prototype.ComputePolygonSeparation=function(t){t.type=box2d.b2EPAxisType.e_unknown;t.index=-1;t.separation=-box2d.b2_maxFloat;for(var e=box2d.b2EPCollider.s_perp.Set(-this.m_normal.y,this.m_normal.x),o=0,i=this.m_polygonB.count;o<i;++o){var a=box2d.b2EPCollider.s_n.Copy(this.m_polygonB.normals[o]).SelfNeg(),r=box2d.b2Dot_V2_V2(a,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[o],this.m_v1,box2d.b2Vec2.s_t0)),s=box2d.b2Dot_V2_V2(a,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[o],this.m_v2,box2d.b2Vec2.s_t0)),r=box2d.b2Min(r,s);if(r>this.m_radius){t.type=box2d.b2EPAxisType.e_edgeB;t.index=o;t.separation=r;break}if(0<=box2d.b2Dot_V2_V2(a,e)){if(box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,this.m_upperLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue}else if(box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,this.m_lowerLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue;r>t.separation&&(t.type=box2d.b2EPAxisType.e_edgeB,t.index=o,t.separation=r)}return t};goog.exportProperty(box2d.b2EPCollider.prototype,"ComputePolygonSeparation",box2d.b2EPCollider.prototype.ComputePolygonSeparation);box2d.b2EPCollider.s_n=new box2d.b2Vec2;box2d.b2EPCollider.s_perp=new box2d.b2Vec2;box2d.b2CollideEdgeAndPolygon=function(t,e,o,i,a){box2d.b2CollideEdgeAndPolygon.s_collider.Collide(t,e,o,i,a)};goog.exportSymbol("box2d.b2CollideEdgeAndPolygon",box2d.b2CollideEdgeAndPolygon);box2d.b2CollideEdgeAndPolygon.s_collider=new box2d.b2EPCollider;box2d.b2CollidePolygon={};box2d.b2FindMaxSeparation=function(t,e,o,i,a){var r=e.m_count,s=i.m_count,n=e.m_normals;e=e.m_vertices;i=i.m_vertices;o=box2d.b2MulT_X_X(a,o,box2d.b2FindMaxSeparation.s_xf);a=0;for(var b=-box2d.b2_maxFloat,x=0;x<r;++x){for(var l=box2d.b2Mul_R_V2(o.q,n[x],box2d.b2FindMaxSeparation.s_n),_=box2d.b2Mul_X_V2(o,e[x],box2d.b2FindMaxSeparation.s_v1),h=box2d.b2_maxFloat,d=0;d<s;++d){var p=box2d.b2Dot_V2_V2(l,box2d.b2Sub_V2_V2(i[d],_,box2d.b2Vec2.s_t0));p<h&&(h=p)}h>b&&(b=h,a=x)}t[0]=a;return b};goog.exportSymbol("box2d.b2FindMaxSeparation",box2d.b2FindMaxSeparation);box2d.b2FindMaxSeparation.s_xf=new box2d.b2Transform;box2d.b2FindMaxSeparation.s_n=new box2d.b2Vec2;box2d.b2FindMaxSeparation.s_v1=new box2d.b2Vec2;box2d.b2FindIncidentEdge=function(t,e,o,i,a,r){var s=e.m_count,n=e.m_normals,b=a.m_count;e=a.m_vertices;a=a.m_normals;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=i&&i<s);o=box2d.b2MulT_R_V2(r.q,box2d.b2Mul_R_V2(o.q,n[i],box2d.b2Vec2.s_t0),box2d.b2FindIncidentEdge.s_normal1);for(var s=0,n=box2d.b2_maxFloat,x=0;x<b;++x){var l=box2d.b2Dot_V2_V2(o,a[x]);l<n&&(n=l,s=x)}a=s;b=(a+1)%b;o=t[0];box2d.b2Mul_X_V2(r,e[a],o.v);o=o.id.cf;o.indexA=i;o.indexB=a;o.typeA=box2d.b2ContactFeatureType.e_face;o.typeB=box2d.b2ContactFeatureType.e_vertex;t=t[1];box2d.b2Mul_X_V2(r,e[b],t.v);r=t.id.cf;r.indexA=i;r.indexB=b;r.typeA=box2d.b2ContactFeatureType.e_face;r.typeB=box2d.b2ContactFeatureType.e_vertex};goog.exportSymbol("box2d.b2FindIncidentEdge",box2d.b2FindIncidentEdge);box2d.b2FindIncidentEdge.s_normal1=new box2d.b2Vec2;box2d.b2CollidePolygons=function(t,e,o,i,a){t.pointCount=0;var r=e.m_radius+i.m_radius,s=box2d.b2CollidePolygons.s_edgeA;s[0]=0;var n=box2d.b2FindMaxSeparation(s,e,o,i,a);if(!(n>r)){var b=box2d.b2CollidePolygons.s_edgeB;b[0]=0;var x=box2d.b2FindMaxSeparation(b,i,a,e,o);if(!(x>r)){var l=0,_=0;x>.98*n+.001?(n=i,i=e,e=a,l=b[0],t.type=box2d.b2ManifoldType.e_faceB,_=1):(n=e,e=o,o=a,l=s[0],t.type=box2d.b2ManifoldType.e_faceA,_=0);s=box2d.b2CollidePolygons.s_incidentEdge;box2d.b2FindIncidentEdge(s,n,e,l,i,o);a=n.m_vertices;var b=l,n=(l+1)%n.m_count,h=a[b],d=a[n],l=box2d.b2Sub_V2_V2(d,h,box2d.b2CollidePolygons.s_localTangent);l.Normalize();a=box2d.b2Cross_V2_S(l,1,box2d.b2CollidePolygons.s_localNormal);i=box2d.b2Mid_V2_V2(h,d,box2d.b2CollidePolygons.s_planePoint);var x=box2d.b2Mul_R_V2(e.q,l,box2d.b2CollidePolygons.s_tangent),l=box2d.b2Cross_V2_S(x,1,box2d.b2CollidePolygons.s_normal),h=box2d.b2Mul_X_V2(e,h,box2d.b2CollidePolygons.s_v11),p=box2d.b2Mul_X_V2(e,d,box2d.b2CollidePolygons.s_v12);e=box2d.b2Dot_V2_V2(l,h);var d=-box2d.b2Dot_V2_V2(x,h)+r,p=box2d.b2Dot_V2_V2(x,p)+r,c=box2d.b2CollidePolygons.s_clipPoints1,h=box2d.b2CollidePolygons.s_clipPoints2,u=box2d.b2CollidePolygons.s_ntangent.Copy(x).SelfNeg(),s=box2d.b2ClipSegmentToLine(c,s,u,d,b);if(!(2>s||(s=box2d.b2ClipSegmentToLine(h,c,x,p,n),2>s))){t.localNormal.Copy(a);t.localPoint.Copy(i);for(b=s=0;b<box2d.b2_maxManifoldPoints;++b)a=h[b],box2d.b2Dot_V2_V2(l,a.v)-e<=r&&(n=t.points[s],box2d.b2MulT_X_V2(o,a.v,n.localPoint),n.id.Copy(a.id),_&&(a=n.id.cf,n.id.cf.indexA=a.indexB,n.id.cf.indexB=a.indexA,n.id.cf.typeA=a.typeB,n.id.cf.typeB=a.typeA),++s);t.pointCount=s}}}};goog.exportSymbol("box2d.b2CollidePolygons",box2d.b2CollidePolygons);box2d.b2CollidePolygons.s_incidentEdge=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_edgeA=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_edgeB=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_localTangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_localNormal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_planePoint=new box2d.b2Vec2;box2d.b2CollidePolygons.s_normal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_tangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_ntangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v11=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v12=new box2d.b2Vec2;box2d.b2TreeNode=function(t){this.m_id=t||0;this.aabb=new box2d.b2AABB};goog.exportSymbol("box2d.b2TreeNode",box2d.b2TreeNode);box2d.b2TreeNode.prototype.m_id=0;goog.exportProperty(box2d.b2TreeNode.prototype,"m_id",box2d.b2TreeNode.prototype.m_id);box2d.b2TreeNode.prototype.aabb=null;goog.exportProperty(box2d.b2TreeNode.prototype,"aabb",box2d.b2TreeNode.prototype.aabb);box2d.b2TreeNode.prototype.userData=null;goog.exportProperty(box2d.b2TreeNode.prototype,"userData",box2d.b2TreeNode.prototype.userData);box2d.b2TreeNode.prototype.parent=null;goog.exportProperty(box2d.b2TreeNode.prototype,"parent",box2d.b2TreeNode.prototype.parent);box2d.b2TreeNode.prototype.child1=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child1",box2d.b2TreeNode.prototype.child1);box2d.b2TreeNode.prototype.child2=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child2",box2d.b2TreeNode.prototype.child2);box2d.b2TreeNode.prototype.height=0;goog.exportProperty(box2d.b2TreeNode.prototype,"height",box2d.b2TreeNode.prototype.height);box2d.b2TreeNode.prototype.IsLeaf=function(){return null===this.child1};goog.exportProperty(box2d.b2TreeNode.prototype,"IsLeaf",box2d.b2TreeNode.prototype.IsLeaf);box2d.b2DynamicTree=function(){};goog.exportSymbol("box2d.b2DynamicTree",box2d.b2DynamicTree);box2d.b2DynamicTree.prototype.m_root=null;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_root",box2d.b2DynamicTree.prototype.m_root);box2d.b2DynamicTree.prototype.m_freeList=null;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_freeList",box2d.b2DynamicTree.prototype.m_freeList);box2d.b2DynamicTree.prototype.m_path=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_path",box2d.b2DynamicTree.prototype.m_path);box2d.b2DynamicTree.prototype.m_insertionCount=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_insertionCount",box2d.b2DynamicTree.prototype.m_insertionCount);box2d.b2DynamicTree.s_stack=new box2d.b2GrowableStack(256);box2d.b2DynamicTree.s_r=new box2d.b2Vec2;box2d.b2DynamicTree.s_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_abs_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_segmentAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_subInput=new box2d.b2RayCastInput;box2d.b2DynamicTree.s_combinedAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_aabb=new box2d.b2AABB;box2d.b2DynamicTree.prototype.GetUserData=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==t);return t.userData};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetUserData",box2d.b2DynamicTree.prototype.GetUserData);box2d.b2DynamicTree.prototype.GetFatAABB=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==t);return t.aabb};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetFatAABB",box2d.b2DynamicTree.prototype.GetFatAABB);box2d.b2DynamicTree.prototype.Query=function(t,e){if(null!==this.m_root){var o=box2d.b2DynamicTree.s_stack.Reset();for(o.Push(this.m_root);0<o.GetCount();){var i=o.Pop();if(null!==i&&i.aabb.TestOverlap(e))if(i.IsLeaf()){if(!t(i))break}else o.Push(i.child1),o.Push(i.child2)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"Query",box2d.b2DynamicTree.prototype.Query);box2d.b2DynamicTree.prototype.RayCast=function(t,e){if(null!==this.m_root){var o=e.p1,i=e.p2,a=box2d.b2Sub_V2_V2(i,o,box2d.b2DynamicTree.s_r);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<a.LengthSquared());a.Normalize();var a=box2d.b2Cross_S_V2(1,a,box2d.b2DynamicTree.s_v),r=box2d.b2Abs_V2(a,box2d.b2DynamicTree.s_abs_v),s=e.maxFraction,n=box2d.b2DynamicTree.s_segmentAABB,b=o.x+s*(i.x-o.x),x=o.y+s*(i.y-o.y);n.lowerBound.x=box2d.b2Min(o.x,b);n.lowerBound.y=box2d.b2Min(o.y,x);n.upperBound.x=box2d.b2Max(o.x,b);n.upperBound.y=box2d.b2Max(o.y,x);var l=box2d.b2DynamicTree.s_stack.Reset();for(l.Push(this.m_root);0<l.GetCount();)if(b=l.Pop(),null!==b&&box2d.b2TestOverlap_AABB(b.aabb,n)){var x=b.aabb.GetCenter(),_=b.aabb.GetExtents();if(!(0<box2d.b2Abs(box2d.b2Dot_V2_V2(a,box2d.b2Sub_V2_V2(o,x,box2d.b2Vec2.s_t0)))-box2d.b2Dot_V2_V2(r,_)))if(b.IsLeaf()){x=box2d.b2DynamicTree.s_subInput;x.p1.Copy(e.p1);x.p2.Copy(e.p2);x.maxFraction=s;b=t(x,b);if(0===b)break;0<b&&(s=b,b=o.x+s*(i.x-o.x),x=o.y+s*(i.y-o.y),n.lowerBound.x=box2d.b2Min(o.x,b),n.lowerBound.y=box2d.b2Min(o.y,x),n.upperBound.x=box2d.b2Max(o.x,b),n.upperBound.y=box2d.b2Max(o.y,x))}else l.Push(b.child1),l.Push(b.child2)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RayCast",box2d.b2DynamicTree.prototype.RayCast);box2d.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;this.m_freeList=t.parent;t.parent=null;t.child1=null;t.child2=null;t.height=0;t.userData=null;return t}return new box2d.b2TreeNode(box2d.b2DynamicTree.prototype.s_node_id++)};goog.exportProperty(box2d.b2DynamicTree.prototype,"AllocateNode",box2d.b2DynamicTree.prototype.AllocateNode);box2d.b2DynamicTree.prototype.s_node_id=0;box2d.b2DynamicTree.prototype.FreeNode=function(t){t.parent=this.m_freeList;t.height=-1;this.m_freeList=t};goog.exportProperty(box2d.b2DynamicTree.prototype,"FreeNode",box2d.b2DynamicTree.prototype.FreeNode);box2d.b2DynamicTree.prototype.CreateProxy=function(t,e){var o=this.AllocateNode(),i=box2d.b2_aabbExtension,a=box2d.b2_aabbExtension;o.aabb.lowerBound.x=t.lowerBound.x-i;o.aabb.lowerBound.y=t.lowerBound.y-a;o.aabb.upperBound.x=t.upperBound.x+i;o.aabb.upperBound.y=t.upperBound.y+a;o.userData=e;o.height=0;this.InsertLeaf(o);return o};goog.exportProperty(box2d.b2DynamicTree.prototype,"CreateProxy",box2d.b2DynamicTree.prototype.CreateProxy);box2d.b2DynamicTree.prototype.DestroyProxy=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.IsLeaf());this.RemoveLeaf(t);this.FreeNode(t)};goog.exportProperty(box2d.b2DynamicTree.prototype,"DestroyProxy",box2d.b2DynamicTree.prototype.DestroyProxy);box2d.b2DynamicTree.prototype.MoveProxy=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.IsLeaf());if(t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var i=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<o.x?o.x:-o.x);o=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<o.y?o.y:-o.y);t.aabb.lowerBound.x=e.lowerBound.x-i;t.aabb.lowerBound.y=e.lowerBound.y-o;t.aabb.upperBound.x=e.upperBound.x+i;t.aabb.upperBound.y=e.upperBound.y+o;this.InsertLeaf(t);return!0};goog.exportProperty(box2d.b2DynamicTree.prototype,"MoveProxy",box2d.b2DynamicTree.prototype.MoveProxy);box2d.b2DynamicTree.prototype.InsertLeaf=function(t){++this.m_insertionCount;if(null===this.m_root)this.m_root=t,this.m_root.parent=null;else{var e=t.aabb;e.GetCenter();for(var o=this.m_root,i,a;!o.IsLeaf();){i=o.child1;a=o.child2;var r=o.aabb.GetPerimeter(),s=box2d.b2DynamicTree.s_combinedAABB;s.Combine2(o.aabb,e);var n=s.GetPerimeter(),s=2*n,n=2*(n-r),b=box2d.b2DynamicTree.s_aabb,x,l;i.IsLeaf()?(b.Combine2(e,i.aabb),r=b.GetPerimeter()+n):(b.Combine2(e,i.aabb),x=i.aabb.GetPerimeter(),l=b.GetPerimeter(),r=l-x+n);a.IsLeaf()?(b.Combine2(e,a.aabb),n=b.GetPerimeter()+n):(b.Combine2(e,a.aabb),x=a.aabb.GetPerimeter(),l=b.GetPerimeter(),n=l-x+n);if(s<r&&s<n)break;o=r<n?i:a}i=o.parent;a=this.AllocateNode();a.parent=i;a.userData=null;a.aabb.Combine2(e,o.aabb);a.height=o.height+1;i?(i.child1===o?i.child1=a:i.child2=a,a.child1=o,a.child2=t,o.parent=a,t.parent=a):(a.child1=o,a.child2=t,o.parent=a,this.m_root=t.parent=a);for(o=t.parent;null!==o;)o=this.Balance(o),i=o.child1,a=o.child2,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==i),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a),o.height=1+box2d.b2Max(i.height,a.height),o.aabb.Combine2(i.aabb,a.aabb),o=o.parent}};goog.exportProperty(box2d.b2DynamicTree.prototype,"InsertLeaf",box2d.b2DynamicTree.prototype.InsertLeaf);box2d.b2DynamicTree.prototype.RemoveLeaf=function(t){if(t===this.m_root)this.m_root=null;else{var e=t.parent,o=e.parent;t=e.child1===t?e.child2:e.child1;if(o)for(o.child1===e?o.child1=t:o.child2=t,t.parent=o,this.FreeNode(e),e=o;e;)e=this.Balance(e),o=e.child1,t=e.child2,e.aabb.Combine2(o.aabb,t.aabb),e.height=1+box2d.b2Max(o.height,t.height),e=e.parent;else this.m_root=t,t.parent=null,this.FreeNode(e)}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RemoveLeaf",box2d.b2DynamicTree.prototype.RemoveLeaf);box2d.b2DynamicTree.prototype.Balance=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==t);if(t.IsLeaf()||2>t.height)return t;var e=t.child1,o=t.child2,i=o.height-e.height;if(1<i){var i=o.child1,a=o.child2;o.child1=t;o.parent=t.parent;t.parent=o;null!==o.parent?o.parent.child1===t?o.parent.child1=o:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(o.parent.child2===t),o.parent.child2=o):this.m_root=o;i.height>a.height?(o.child2=i,t.child2=a,a.parent=t,t.aabb.Combine2(e.aabb,a.aabb),o.aabb.Combine2(t.aabb,i.aabb),t.height=1+box2d.b2Max(e.height,a.height),o.height=1+box2d.b2Max(t.height,i.height)):(o.child2=a,t.child2=i,i.parent=t,t.aabb.Combine2(e.aabb,i.aabb),o.aabb.Combine2(t.aabb,a.aabb),t.height=1+box2d.b2Max(e.height,i.height),o.height=1+box2d.b2Max(t.height,a.height));return o}return-1>i?(i=e.child1,a=e.child2,e.child1=t,e.parent=t.parent,t.parent=e,null!==e.parent?e.parent.child1===t?e.parent.child1=e:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.parent.child2===t),e.parent.child2=e):this.m_root=e,i.height>a.height?(e.child2=i,t.child1=a,a.parent=t,t.aabb.Combine2(o.aabb,a.aabb),e.aabb.Combine2(t.aabb,i.aabb),t.height=1+box2d.b2Max(o.height,a.height),e.height=1+box2d.b2Max(t.height,i.height)):(e.child2=a,t.child1=i,i.parent=t,t.aabb.Combine2(o.aabb,i.aabb),e.aabb.Combine2(t.aabb,a.aabb),t.height=1+box2d.b2Max(o.height,i.height),e.height=1+box2d.b2Max(t.height,a.height)),e):t};goog.exportProperty(box2d.b2DynamicTree.prototype,"Balance",box2d.b2DynamicTree.prototype.Balance);box2d.b2DynamicTree.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetHeight",box2d.b2DynamicTree.prototype.GetHeight);box2d.b2DynamicTree.prototype.GetAreaRatio=function(){if(null===this.m_root)return 0;var t=this.m_root.aabb.GetPerimeter(),o=function(t){if(null===t||t.IsLeaf())return 0;var e=t.aabb.GetPerimeter(),e=e+o(t.child1);return e+=o(t.child2)};return o(this.m_root)/t};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetAreaRatio",box2d.b2DynamicTree.prototype.GetAreaRatio);box2d.b2DynamicTree.prototype.ComputeHeightNode=function(t){if(t.IsLeaf())return 0;var e=this.ComputeHeightNode(t.child1);t=this.ComputeHeightNode(t.child2);return 1+box2d.b2Max(e,t)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeightNode",box2d.b2DynamicTree.prototype.ComputeHeightNode);box2d.b2DynamicTree.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeight",box2d.b2DynamicTree.prototype.ComputeHeight);box2d.b2DynamicTree.prototype.ValidateStructure=function(t){if(null!==t){t===this.m_root&&box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===t.parent);var e=t.child1,o=t.child2;t.IsLeaf()?(box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===o),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===t.height)):(box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.parent===t),box2d.ENABLE_ASSERTS&&box2d.b2Assert(o.parent===t),this.ValidateStructure(e),this.ValidateStructure(o))}};goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateStructure",box2d.b2DynamicTree.prototype.ValidateStructure);box2d.b2DynamicTree.prototype.ValidateMetrics=function(t){if(null!==t){var e=t.child1,o=t.child2;if(t.IsLeaf())box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===o),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===t.height);else{var i;i=1+box2d.b2Max(e.height,o.height);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.height===i);i=box2d.b2DynamicTree.s_aabb;i.Combine2(e.aabb,o.aabb);box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.lowerBound===t.aabb.lowerBound);box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.upperBound===t.aabb.upperBound);this.ValidateMetrics(e);this.ValidateMetrics(o)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateMetrics",box2d.b2DynamicTree.prototype.ValidateMetrics);box2d.b2DynamicTree.prototype.Validate=function(){this.ValidateStructure(this.m_root);this.ValidateMetrics(this.m_root);for(var t=0,e=this.m_freeList;null!==e;)e=e.parent,++t;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.GetHeight()===this.ComputeHeight())};goog.exportProperty(box2d.b2DynamicTree.prototype,"Validate",box2d.b2DynamicTree.prototype.Validate);box2d.b2DynamicTree.prototype.GetMaxBalance=function(){var t;t=this.m_root;null===t?t=0:1>=t.height?t=0:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!t.IsLeaf()),t=box2d.b2Abs(t.child2.height-t.child1.height),t=box2d.b2Max(0,t));return t};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetMaxBalance",box2d.b2DynamicTree.prototype.GetMaxBalance);box2d.b2DynamicTree.prototype.RebuildBottomUp=function(){this.Validate()};goog.exportProperty(box2d.b2DynamicTree.prototype,"RebuildBottomUp",box2d.b2DynamicTree.prototype.RebuildBottomUp);box2d.b2DynamicTree.prototype.ShiftOrigin=function(t){var i=function(t,e){if(null!==t&&!(1>=t.height)){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!t.IsLeaf());var o=t.child2;i(t.child1,e);i(o,e);t.aabb.lowerBound.SelfSub(e);t.aabb.upperBound.SelfSub(e)}};i(this.m_root,t)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ShiftOrigin",box2d.b2DynamicTree.prototype.ShiftOrigin);box2d.b2Pair=function(){};goog.exportSymbol("box2d.b2Pair",box2d.b2Pair);box2d.b2Pair.prototype.proxyA=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyA",box2d.b2Pair.prototype.proxyA);box2d.b2Pair.prototype.proxyB=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyB",box2d.b2Pair.prototype.proxyB);box2d.b2BroadPhase=function(){this.m_tree=new box2d.b2DynamicTree;this.m_moveBuffer=[];this.m_pairBuffer=[]};goog.exportSymbol("box2d.b2BroadPhase",box2d.b2BroadPhase);box2d.b2BroadPhase.prototype.m_tree=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_tree",box2d.b2BroadPhase.prototype.m_tree);box2d.b2BroadPhase.prototype.m_proxyCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_proxyCount",box2d.b2BroadPhase.prototype.m_proxyCount);box2d.b2BroadPhase.prototype.m_moveCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveCount",box2d.b2BroadPhase.prototype.m_moveCount);box2d.b2BroadPhase.prototype.m_moveBuffer=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveBuffer",box2d.b2BroadPhase.prototype.m_moveBuffer);box2d.b2BroadPhase.prototype.m_pairCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairCount",box2d.b2BroadPhase.prototype.m_pairCount);box2d.b2BroadPhase.prototype.m_pairBuffer=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairBuffer",box2d.b2BroadPhase.prototype.m_pairBuffer);box2d.b2BroadPhase.prototype.CreateProxy=function(t,e){var o=this.m_tree.CreateProxy(t,e);++this.m_proxyCount;this.BufferMove(o);return o};goog.exportProperty(box2d.b2BroadPhase.prototype,"CreateProxy",box2d.b2BroadPhase.prototype.CreateProxy);box2d.b2BroadPhase.prototype.DestroyProxy=function(t){this.UnBufferMove(t);--this.m_proxyCount;this.m_tree.DestroyProxy(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"DestroyProxy",box2d.b2BroadPhase.prototype.DestroyProxy);box2d.b2BroadPhase.prototype.MoveProxy=function(t,e,o){this.m_tree.MoveProxy(t,e,o)&&this.BufferMove(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"MoveProxy",box2d.b2BroadPhase.prototype.MoveProxy);box2d.b2BroadPhase.prototype.TouchProxy=function(t){this.BufferMove(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"TouchProxy",box2d.b2BroadPhase.prototype.TouchProxy);box2d.b2BroadPhase.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetFatAABB",box2d.b2BroadPhase.prototype.GetFatAABB);box2d.b2BroadPhase.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetUserData",box2d.b2BroadPhase.prototype.GetUserData);box2d.b2BroadPhase.prototype.TestOverlap=function(t,e){var o=this.m_tree.GetFatAABB(t),i=this.m_tree.GetFatAABB(e);return box2d.b2TestOverlap_AABB(o,i)};goog.exportProperty(box2d.b2BroadPhase.prototype,"TestOverlap",box2d.b2BroadPhase.prototype.TestOverlap);box2d.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetProxyCount",box2d.b2BroadPhase.prototype.GetProxyCount);box2d.b2BroadPhase.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeHeight",box2d.b2BroadPhase.prototype.GetTreeHeight);box2d.b2BroadPhase.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeBalance",box2d.b2BroadPhase.prototype.GetTreeBalance);box2d.b2BroadPhase.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeQuality",box2d.b2BroadPhase.prototype.GetTreeQuality);box2d.b2BroadPhase.prototype.ShiftOrigin=function(t){this.m_tree.ShiftOrigin(t)};goog.exportProperty(box2d.b2BroadPhase.prototype,"ShiftOrigin",box2d.b2BroadPhase.prototype.ShiftOrigin);box2d.b2BroadPhase.prototype.UpdatePairs=function(t){for(var e=this.m_pairCount=0;e<this.m_moveCount;++e){var o=this.m_moveBuffer[e];if(null!==o){var i=this,a=this.m_tree.GetFatAABB(o);this.m_tree.Query(function(t){if(t.m_id===o.m_id)return!0;i.m_pairCount===i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new box2d.b2Pair);var e=i.m_pairBuffer[i.m_pairCount];t.m_id<o.m_id?(e.proxyA=t,e.proxyB=o):(e.proxyA=o,e.proxyB=t);++i.m_pairCount;return!0},a)}}this.m_moveCount=0;this.m_pairBuffer.length=this.m_pairCount;this.m_pairBuffer.sort(box2d.b2PairLessThan);for(e=0;e<this.m_pairCount;){var a=this.m_pairBuffer[e],r=this.m_tree.GetUserData(a.proxyA),s=this.m_tree.GetUserData(a.proxyB);t.AddPair(r,s);for(++e;e<this.m_pairCount;){r=this.m_pairBuffer[e];if(r.proxyA.m_id!==a.proxyA.m_id||r.proxyB.m_id!==a.proxyB.m_id)break;++e}}};goog.exportProperty(box2d.b2BroadPhase.prototype,"UpdatePairs",box2d.b2BroadPhase.prototype.UpdatePairs);box2d.b2BroadPhase.prototype.Query=function(t,e){this.m_tree.Query(t,e)};goog.exportProperty(box2d.b2BroadPhase.prototype,"Query",box2d.b2BroadPhase.prototype.Query);box2d.b2BroadPhase.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)};goog.exportProperty(box2d.b2BroadPhase.prototype,"RayCast",box2d.b2BroadPhase.prototype.RayCast);box2d.b2BroadPhase.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveCount]=t;++this.m_moveCount};goog.exportProperty(box2d.b2BroadPhase.prototype,"BufferMove",box2d.b2BroadPhase.prototype.BufferMove);box2d.b2BroadPhase.prototype.UnBufferMove=function(t){t=this.m_moveBuffer.indexOf(t);this.m_moveBuffer[t]=null};goog.exportProperty(box2d.b2BroadPhase.prototype,"UnBufferMove",box2d.b2BroadPhase.prototype.UnBufferMove);box2d.b2PairLessThan=function(t,e){return t.proxyA.m_id===e.proxyA.m_id?t.proxyB.m_id-e.proxyB.m_id:t.proxyA.m_id-e.proxyA.m_id};box2d.b2MassData=function(){this.center=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2MassData",box2d.b2MassData);box2d.b2MassData.prototype.mass=0;goog.exportProperty(box2d.b2MassData.prototype,"mass",box2d.b2MassData.prototype.mass);box2d.b2MassData.prototype.center=null;goog.exportProperty(box2d.b2MassData.prototype,"center",box2d.b2MassData.prototype.center);box2d.b2MassData.prototype.I=0;goog.exportProperty(box2d.b2MassData.prototype,"I",box2d.b2MassData.prototype.I);box2d.b2ShapeType={e_unknown:-1,e_circleShape:0,e_edgeShape:1,e_polygonShape:2,e_chainShape:3,e_shapeTypeCount:4};goog.exportSymbol("box2d.b2ShapeType",box2d.b2ShapeType);goog.exportProperty(box2d.b2ShapeType,"e_unknown",box2d.b2ShapeType.e_unknown);goog.exportProperty(box2d.b2ShapeType,"e_circleShape",box2d.b2ShapeType.e_circleShape);goog.exportProperty(box2d.b2ShapeType,"e_edgeShape",box2d.b2ShapeType.e_edgeShape);goog.exportProperty(box2d.b2ShapeType,"e_polygonShape",box2d.b2ShapeType.e_polygonShape);goog.exportProperty(box2d.b2ShapeType,"e_chainShape",box2d.b2ShapeType.e_chainShape);goog.exportProperty(box2d.b2ShapeType,"e_shapeTypeCount",box2d.b2ShapeType.e_shapeTypeCount);box2d.b2Shape=function(t,e){this.m_type=t;this.m_radius=e};goog.exportSymbol("box2d.b2Shape",box2d.b2Shape);box2d.b2Shape.prototype.m_type=box2d.b2ShapeType.e_unknown;goog.exportProperty(box2d.b2Shape.prototype,"m_type",box2d.b2Shape.prototype.m_type);box2d.b2Shape.prototype.m_radius=0;goog.exportProperty(box2d.b2Shape.prototype,"m_radius",box2d.b2Shape.prototype.m_radius);box2d.b2Shape.prototype.Clone=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return null};goog.exportProperty(box2d.b2Shape.prototype,"Clone",box2d.b2Shape.prototype.Clone);box2d.b2Shape.prototype.Copy=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===t.m_type);this.m_radius=t.m_radius;return this};goog.exportProperty(box2d.b2Shape.prototype,"Copy",box2d.b2Shape.prototype.Copy);box2d.b2Shape.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Shape.prototype,"GetType",box2d.b2Shape.prototype.GetType);box2d.b2Shape.prototype.GetChildCount=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"GetChildCount",box2d.b2Shape.prototype.GetChildCount);box2d.b2Shape.prototype.TestPoint=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};goog.exportProperty(box2d.b2Shape.prototype,"TestPoint",box2d.b2Shape.prototype.TestPoint);box2d.b2Shape.prototype.ComputeDistance=function(t,e,o,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"ComputeDistance",box2d.b2Shape.prototype.ComputeDistance);box2d.b2Shape.prototype.RayCast=function(t,e,o,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};goog.exportProperty(box2d.b2Shape.prototype,"RayCast",box2d.b2Shape.prototype.RayCast);box2d.b2Shape.prototype.ComputeAABB=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeAABB",box2d.b2Shape.prototype.ComputeAABB);box2d.b2Shape.prototype.ComputeMass=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeMass",box2d.b2Shape.prototype.ComputeMass);box2d.b2Shape.prototype.SetupDistanceProxy=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2Shape.prototype.ComputeSubmergedArea=function(t,e,o,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"ComputeSubmergedArea",box2d.b2Shape.prototype.ComputeSubmergedArea);box2d.b2Shape.prototype.Dump=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"Dump",box2d.b2Shape.prototype.Dump);box2d.b2CircleShape=function(t){box2d.b2Shape.call(this,box2d.b2ShapeType.e_circleShape,t||0);this.m_p=new box2d.b2Vec2};goog.inherits(box2d.b2CircleShape,box2d.b2Shape);goog.exportSymbol("box2d.b2CircleShape",box2d.b2CircleShape);box2d.b2CircleShape.prototype.m_p=null;goog.exportProperty(box2d.b2CircleShape.prototype,"m_p",box2d.b2CircleShape.prototype.m_p);box2d.b2CircleShape.prototype.Clone=function(){return(new box2d.b2CircleShape).Copy(this)};goog.exportProperty(box2d.b2CircleShape.prototype,"Clone",box2d.b2CircleShape.prototype.Clone);box2d.b2CircleShape.prototype.Copy=function(t){box2d.b2Shape.prototype.Copy.call(this,t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2CircleShape);this.m_p.Copy(t.m_p);return this};goog.exportProperty(box2d.b2CircleShape.prototype,"Copy",box2d.b2CircleShape.prototype.Copy);box2d.b2CircleShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2CircleShape.prototype,"GetChildCount",box2d.b2CircleShape.prototype.GetChildCount);box2d.b2CircleShape.prototype.TestPoint=function(t,e){var o=box2d.b2Mul_X_V2(t,this.m_p,box2d.b2CircleShape.prototype.TestPoint.s_center),o=box2d.b2Sub_V2_V2(e,o,box2d.b2CircleShape.prototype.TestPoint.s_d);return box2d.b2Dot_V2_V2(o,o)<=box2d.b2Sq(this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"TestPoint",box2d.b2CircleShape.prototype.TestPoint);box2d.b2CircleShape.prototype.TestPoint.s_center=new box2d.b2Vec2;box2d.b2CircleShape.prototype.TestPoint.s_d=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeDistance=function(t,e,o,i){t=box2d.b2Mul_X_V2(t,this.m_p,box2d.b2CircleShape.prototype.ComputeDistance.s_center);box2d.b2Sub_V2_V2(e,t,o);return o.Normalize()-this.m_radius};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeDistance",box2d.b2CircleShape.prototype.ComputeDistance);box2d.b2CircleShape.prototype.ComputeDistance.s_center=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast=function(t,e,o,i){o=box2d.b2Mul_X_V2(o,this.m_p,box2d.b2CircleShape.prototype.RayCast.s_position);o=box2d.b2Sub_V2_V2(e.p1,o,box2d.b2CircleShape.prototype.RayCast.s_s);var a=box2d.b2Dot_V2_V2(o,o)-box2d.b2Sq(this.m_radius);i=box2d.b2Sub_V2_V2(e.p2,e.p1,box2d.b2CircleShape.prototype.RayCast.s_r);var r=box2d.b2Dot_V2_V2(o,i),s=box2d.b2Dot_V2_V2(i,i),a=r*r-s*a;if(0>a||s<box2d.b2_epsilon)return!1;r=-(r+box2d.b2Sqrt(a));return 0<=r&&r<=e.maxFraction*s?(r/=s,t.fraction=r,box2d.b2AddMul_V2_S_V2(o,r,i,t.normal).SelfNormalize(),!0):!1};goog.exportProperty(box2d.b2CircleShape.prototype,"RayCast",box2d.b2CircleShape.prototype.RayCast);box2d.b2CircleShape.prototype.RayCast.s_position=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_s=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_r=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeAABB=function(t,e,o){e=box2d.b2Mul_X_V2(e,this.m_p,box2d.b2CircleShape.prototype.ComputeAABB.s_p);t.lowerBound.Set(e.x-this.m_radius,e.y-this.m_radius);t.upperBound.Set(e.x+this.m_radius,e.y+this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeAABB",box2d.b2CircleShape.prototype.ComputeAABB);box2d.b2CircleShape.prototype.ComputeAABB.s_p=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeMass=function(t,e){var o=box2d.b2Sq(this.m_radius);t.mass=e*box2d.b2_pi*o;t.center.Copy(this.m_p);t.I=t.mass*(.5*o+box2d.b2Dot_V2_V2(this.m_p,this.m_p))};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeMass",box2d.b2CircleShape.prototype.ComputeMass);box2d.b2CircleShape.prototype.SetupDistanceProxy=function(t,e){t.m_vertices=t.m_buffer;t.m_vertices[0].Copy(this.m_p);t.m_count=1;t.m_radius=this.m_radius};box2d.b2CircleShape.prototype.ComputeSubmergedArea=function(t,e,o,i){o=box2d.b2Mul_X_V2(o,this.m_p,new box2d.b2Vec2);var a=-(box2d.b2Dot_V2_V2(t,o)-e);if(a<-this.m_radius+box2d.b2_epsilon)return 0;if(a>this.m_radius)return i.Copy(o),box2d.b2_pi*this.m_radius*this.m_radius;e=this.m_radius*this.m_radius;var r=a*a,a=e*(box2d.b2Asin(a/this.m_radius)+box2d.b2_pi/2)+a*box2d.b2Sqrt(e-r);e=-2/3*box2d.b2Pow(e-r,1.5)/a;i.x=o.x+t.x*e;i.y=o.y+t.y*e;return a};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeSubmergedArea",box2d.b2CircleShape.prototype.ComputeSubmergedArea);box2d.b2CircleShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2CircleShape*/ var shape = new box2d.b2CircleShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)};goog.exportProperty(box2d.b2CircleShape.prototype,"Dump",box2d.b2CircleShape.prototype.Dump);box2d.b2EdgeShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_edgeShape,box2d.b2_polygonRadius);this.m_vertex1=new box2d.b2Vec2;this.m_vertex2=new box2d.b2Vec2;this.m_vertex0=new box2d.b2Vec2;this.m_vertex3=new box2d.b2Vec2};goog.inherits(box2d.b2EdgeShape,box2d.b2Shape);goog.exportSymbol("box2d.b2EdgeShape",box2d.b2EdgeShape);box2d.b2EdgeShape.prototype.m_vertex1=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex1",box2d.b2EdgeShape.prototype.m_vertex1);box2d.b2EdgeShape.prototype.m_vertex2=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex2",box2d.b2EdgeShape.prototype.m_vertex2);box2d.b2EdgeShape.prototype.m_vertex0=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex0",box2d.b2EdgeShape.prototype.m_vertex0);box2d.b2EdgeShape.prototype.m_vertex3=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex3",box2d.b2EdgeShape.prototype.m_vertex3);box2d.b2EdgeShape.prototype.m_hasVertex0=!1;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex0",box2d.b2EdgeShape.prototype.m_hasVertex0);box2d.b2EdgeShape.prototype.m_hasVertex3=!1;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex3",box2d.b2EdgeShape.prototype.m_hasVertex3);box2d.b2EdgeShape.prototype.Set=function(t,e){this.m_vertex1.Copy(t);this.m_vertex2.Copy(e);this.m_hasVertex3=this.m_hasVertex0=!1;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Set",box2d.b2EdgeShape.prototype.Set);box2d.b2EdgeShape.prototype.SetAsEdge=box2d.b2EdgeShape.prototype.Set;box2d.b2EdgeShape.prototype.Clone=function(){return(new box2d.b2EdgeShape).Copy(this)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Clone",box2d.b2EdgeShape.prototype.Clone);box2d.b2EdgeShape.prototype.Copy=function(t){box2d.b2Shape.prototype.Copy.call(this,t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2EdgeShape);this.m_vertex1.Copy(t.m_vertex1);this.m_vertex2.Copy(t.m_vertex2);this.m_vertex0.Copy(t.m_vertex0);this.m_vertex3.Copy(t.m_vertex3);this.m_hasVertex0=t.m_hasVertex0;this.m_hasVertex3=t.m_hasVertex3;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Copy",box2d.b2EdgeShape.prototype.Copy);box2d.b2EdgeShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2EdgeShape.prototype,"GetChildCount",box2d.b2EdgeShape.prototype.GetChildCount);box2d.b2EdgeShape.prototype.TestPoint=function(t,e){return!1};goog.exportProperty(box2d.b2EdgeShape.prototype,"TestPoint",box2d.b2EdgeShape.prototype.TestPoint);box2d.b2EdgeShape.prototype.ComputeDistance=function(t,e,o,i){var a=box2d.b2Mul_X_V2(t,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeDistance.s_v1);t=box2d.b2Mul_X_V2(t,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeDistance.s_v2);i=box2d.b2Sub_V2_V2(e,a,box2d.b2EdgeShape.prototype.ComputeDistance.s_d);var a=box2d.b2Sub_V2_V2(t,a,box2d.b2EdgeShape.prototype.ComputeDistance.s_s),r=box2d.b2Dot_V2_V2(i,a);if(0<r){var s=box2d.b2Dot_V2_V2(a,a);r>s?box2d.b2Sub_V2_V2(e,t,i):i.SelfMulSub(r/s,a)}o.Copy(i);return o.Normalize()};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeDistance",box2d.b2EdgeShape.prototype.ComputeDistance);box2d.b2EdgeShape.prototype.ComputeDistance.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_v2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_s=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast=function(t,e,o,i){var a=box2d.b2MulT_X_V2(o,e.p1,box2d.b2EdgeShape.prototype.RayCast.s_p1);i=box2d.b2MulT_X_V2(o,e.p2,box2d.b2EdgeShape.prototype.RayCast.s_p2);var r=box2d.b2Sub_V2_V2(i,a,box2d.b2EdgeShape.prototype.RayCast.s_d);i=this.m_vertex1;var s=this.m_vertex2,n=box2d.b2Sub_V2_V2(s,i,box2d.b2EdgeShape.prototype.RayCast.s_e),b=t.normal.Set(n.y,-n.x).SelfNormalize(),n=box2d.b2Dot_V2_V2(b,box2d.b2Sub_V2_V2(i,a,box2d.b2Vec2.s_t0)),b=box2d.b2Dot_V2_V2(b,r);if(0===b)return!1;b=n/b;if(0>b||e.maxFraction<b)return!1;e=box2d.b2AddMul_V2_S_V2(a,b,r,box2d.b2EdgeShape.prototype.RayCast.s_q);a=box2d.b2Sub_V2_V2(s,i,box2d.b2EdgeShape.prototype.RayCast.s_r);s=box2d.b2Dot_V2_V2(a,a);if(0===s)return!1;i=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(e,i,box2d.b2Vec2.s_t0),a)/s;if(0>i||1<i)return!1;t.fraction=b;box2d.b2Mul_R_V2(o.q,t.normal,t.normal);0<n&&t.normal.SelfNeg();return!0};goog.exportProperty(box2d.b2EdgeShape.prototype,"RayCast",box2d.b2EdgeShape.prototype.RayCast);box2d.b2EdgeShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_e=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_q=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_r=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB=function(t,e,o){o=box2d.b2Mul_X_V2(e,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeAABB.s_v1);e=box2d.b2Mul_X_V2(e,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2);box2d.b2Min_V2_V2(o,e,t.lowerBound);box2d.b2Max_V2_V2(o,e,t.upperBound);e=this.m_radius;t.lowerBound.SelfSubXY(e,e);t.upperBound.SelfAddXY(e,e)};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeAABB",box2d.b2EdgeShape.prototype.ComputeAABB);box2d.b2EdgeShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeMass=function(t,e){t.mass=0;box2d.b2Mid_V2_V2(this.m_vertex1,this.m_vertex2,t.center);t.I=0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeMass",box2d.b2EdgeShape.prototype.ComputeMass);box2d.b2EdgeShape.prototype.SetupDistanceProxy=function(t,e){t.m_vertices=t.m_buffer;t.m_vertices[0].Copy(this.m_vertex1);t.m_vertices[1].Copy(this.m_vertex2);t.m_count=2;t.m_radius=this.m_radius};box2d.b2EdgeShape.prototype.ComputeSubmergedArea=function(t,e,o,i){i.SetZero();return 0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeSubmergedArea",box2d.b2EdgeShape.prototype.ComputeSubmergedArea);box2d.b2EdgeShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2EdgeShape*/ var shape = new box2d.b2EdgeShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y);box2d.b2Log("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y);box2d.b2Log("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y);box2d.b2Log("    shape.m_vertex3.Set(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y);box2d.b2Log("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0);box2d.b2Log("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Dump",box2d.b2EdgeShape.prototype.Dump);box2d.b2ChainShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_chainShape,box2d.b2_polygonRadius);this.m_prevVertex=new box2d.b2Vec2;this.m_nextVertex=new box2d.b2Vec2};goog.inherits(box2d.b2ChainShape,box2d.b2Shape);goog.exportSymbol("box2d.b2ChainShape",box2d.b2ChainShape);box2d.b2ChainShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_vertices",box2d.b2ChainShape.prototype.m_vertices);box2d.b2ChainShape.prototype.m_count=0;goog.exportProperty(box2d.b2ChainShape.prototype,"m_count",box2d.b2ChainShape.prototype.m_count);box2d.b2ChainShape.prototype.m_prevVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_prevVertex",box2d.b2ChainShape.prototype.m_prevVertex);box2d.b2ChainShape.prototype.m_nextVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_nextVertex",box2d.b2ChainShape.prototype.m_nextVertex);box2d.b2ChainShape.prototype.m_hasPrevVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasPrevVertex",box2d.b2ChainShape.prototype.m_hasPrevVertex);box2d.b2ChainShape.prototype.m_hasNextVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasNextVertex",box2d.b2ChainShape.prototype.m_hasNextVertex);box2d.b2ChainShape.prototype.Clear=function(){this.m_vertices=null;this.m_count=0};goog.exportProperty(box2d.b2ChainShape.prototype,"Clear",box2d.b2ChainShape.prototype.Clear);box2d.b2ChainShape.prototype.CreateLoop=function(t,e){e=e||t.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=e);if(box2d.ENABLE_ASSERTS)for(var o=1;o<e;++o)box2d.b2Assert(box2d.b2DistanceSquared(t[o-1],t[o])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=e+1;this.m_vertices=box2d.b2Vec2.MakeArray(this.m_count);for(o=0;o<e;++o)this.m_vertices[o].Copy(t[o]);this.m_vertices[e].Copy(this.m_vertices[0]);this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]);this.m_nextVertex.Copy(this.m_vertices[1]);this.m_hasNextVertex=this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateLoop",box2d.b2ChainShape.prototype.CreateLoop);box2d.b2ChainShape.prototype.CreateChain=function(t,e){e=e||t.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(2<=e);if(box2d.ENABLE_ASSERTS)for(var o=1;o<e;++o)box2d.b2Assert(box2d.b2DistanceSquared(t[o-1],t[o])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=e;this.m_vertices=box2d.b2Vec2.MakeArray(e);for(o=0;o<e;++o)this.m_vertices[o].Copy(t[o]);this.m_hasNextVertex=this.m_hasPrevVertex=!1;this.m_prevVertex.SetZero();this.m_nextVertex.SetZero();return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateChain",box2d.b2ChainShape.prototype.CreateChain);box2d.b2ChainShape.prototype.SetPrevVertex=function(t){this.m_prevVertex.Copy(t);this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"SetPrevVertex",box2d.b2ChainShape.prototype.SetPrevVertex);box2d.b2ChainShape.prototype.SetNextVertex=function(t){this.m_nextVertex.Copy(t);this.m_hasNextVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"SetNextVertex",box2d.b2ChainShape.prototype.SetNextVertex);box2d.b2ChainShape.prototype.Clone=function(){return(new box2d.b2ChainShape).Copy(this)};goog.exportProperty(box2d.b2ChainShape.prototype,"Clone",box2d.b2ChainShape.prototype.Clone);box2d.b2ChainShape.prototype.Copy=function(t){box2d.b2Shape.prototype.Copy.call(this,t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2ChainShape);this.CreateChain(t.m_vertices,t.m_count);this.m_prevVertex.Copy(t.m_prevVertex);this.m_nextVertex.Copy(t.m_nextVertex);this.m_hasPrevVertex=t.m_hasPrevVertex;this.m_hasNextVertex=t.m_hasNextVertex;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"Copy",box2d.b2ChainShape.prototype.Copy);box2d.b2ChainShape.prototype.GetChildCount=function(){return this.m_count-1};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildCount",box2d.b2ChainShape.prototype.GetChildCount);box2d.b2ChainShape.prototype.GetChildEdge=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&e<this.m_count-1);t.m_type=box2d.b2ShapeType.e_edgeShape;t.m_radius=this.m_radius;t.m_vertex1.Copy(this.m_vertices[e]);t.m_vertex2.Copy(this.m_vertices[e+1]);0<e?(t.m_vertex0.Copy(this.m_vertices[e-1]),t.m_hasVertex0=!0):(t.m_vertex0.Copy(this.m_prevVertex),t.m_hasVertex0=this.m_hasPrevVertex);e<this.m_count-2?(t.m_vertex3.Copy(this.m_vertices[e+2]),t.m_hasVertex3=!0):(t.m_vertex3.Copy(this.m_nextVertex),t.m_hasVertex3=this.m_hasNextVertex)};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildEdge",box2d.b2ChainShape.prototype.GetChildEdge);box2d.b2ChainShape.prototype.TestPoint=function(t,e){return!1};goog.exportProperty(box2d.b2ChainShape.prototype,"TestPoint",box2d.b2ChainShape.prototype.TestPoint);box2d.b2ChainShape.prototype.ComputeDistance=function(t,e,o,i){var a=box2d.b2ChainShape.prototype.ComputeDistance.s_edgeShape;this.GetChildEdge(a,i);return a.ComputeDistance(t,e,o,0)};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeDistance",box2d.b2ChainShape.prototype.ComputeDistance);box2d.b2ChainShape.prototype.ComputeDistance.s_edgeShape=new box2d.b2EdgeShape;box2d.b2ChainShape.prototype.RayCast=function(t,e,o,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(i<this.m_count);var a=box2d.b2ChainShape.prototype.RayCast.s_edgeShape;a.m_vertex1.Copy(this.m_vertices[i]);a.m_vertex2.Copy(this.m_vertices[(i+1)%this.m_count]);return a.RayCast(t,e,o,0)};goog.exportProperty(box2d.b2ChainShape.prototype,"RayCast",box2d.b2ChainShape.prototype.RayCast);box2d.b2ChainShape.prototype.RayCast.s_edgeShape=new box2d.b2EdgeShape;box2d.b2ChainShape.prototype.ComputeAABB=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(o<this.m_count);var i=this.m_vertices[(o+1)%this.m_count];o=box2d.b2Mul_X_V2(e,this.m_vertices[o],box2d.b2ChainShape.prototype.ComputeAABB.s_v1);e=box2d.b2Mul_X_V2(e,i,box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2Min_V2_V2(o,e,t.lowerBound);box2d.b2Max_V2_V2(o,e,t.upperBound)};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeAABB",box2d.b2ChainShape.prototype.ComputeAABB);box2d.b2ChainShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v1",box2d.b2ChainShape.prototype.ComputeAABB.s_v1);box2d.b2ChainShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v2",box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2ChainShape.prototype.ComputeMass=function(t,e){t.mass=0;t.center.SetZero();t.I=0};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeMass",box2d.b2ChainShape.prototype.ComputeMass);box2d.b2ChainShape.prototype.SetupDistanceProxy=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&e<this.m_count);t.m_buffer[0].Copy(this.m_vertices[e]);e+1<this.m_count?t.m_buffer[1].Copy(this.m_vertices[e+1]):t.m_buffer[1].Copy(this.m_vertices[0]);t.m_vertices=t.m_buffer;t.m_count=2;t.m_radius=this.m_radius};box2d.b2ChainShape.prototype.ComputeSubmergedArea=function(t,e,o,i){i.SetZero();return 0};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeSubmergedArea",box2d.b2ChainShape.prototype.ComputeSubmergedArea);box2d.b2ChainShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2ChainShape*/ var shape = new box2d.b2ChainShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var t=0;t<this.m_count;++t)box2d.b2Log("    vs[%d].Set(%.15f, %.15f);\n",t,this.m_vertices[t].x,this.m_vertices[t].y);box2d.b2Log("    shape.CreateChain(vs, %d);\n",this.m_count);box2d.b2Log("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y);box2d.b2Log("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y);box2d.b2Log("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false");box2d.b2Log("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")};goog.exportProperty(box2d.b2ChainShape.prototype,"Dump",box2d.b2ChainShape.prototype.Dump);box2d.b2PolygonShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_polygonShape,box2d.b2_polygonRadius);this.m_centroid=new box2d.b2Vec2(0,0);this.m_vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.m_normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices)};goog.inherits(box2d.b2PolygonShape,box2d.b2Shape);goog.exportSymbol("box2d.b2PolygonShape",box2d.b2PolygonShape);box2d.b2PolygonShape.prototype.m_centroid=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_centroid",box2d.b2PolygonShape.prototype.m_centroid);box2d.b2PolygonShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_vertices",box2d.b2PolygonShape.prototype.m_vertices);box2d.b2PolygonShape.prototype.m_normals=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_normals",box2d.b2PolygonShape.prototype.m_normals);box2d.b2PolygonShape.prototype.m_count=0;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_count",box2d.b2PolygonShape.prototype.m_count);box2d.b2PolygonShape.prototype.Clone=function(){return(new box2d.b2PolygonShape).Copy(this)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Clone",box2d.b2PolygonShape.prototype.Clone);box2d.b2PolygonShape.prototype.Copy=function(t){box2d.b2Shape.prototype.Copy.call(this,t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2PolygonShape);this.m_centroid.Copy(t.m_centroid);this.m_count=t.m_count;for(var e=0,o=this.m_count;e<o;++e)this.m_vertices[e].Copy(t.m_vertices[e]),this.m_normals[e].Copy(t.m_normals[e]);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Copy",box2d.b2PolygonShape.prototype.Copy);box2d.b2PolygonShape.prototype.SetAsBox=function(t,e,o,i){this.m_count=4;this.m_vertices[0].Set(-t,-e);this.m_vertices[1].Set(t,-e);this.m_vertices[2].Set(t,e);this.m_vertices[3].Set(-t,e);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid.SetZero();if(o instanceof box2d.b2Vec2)for(i="number"===typeof i?i:0,this.m_centroid.Copy(o),t=new box2d.b2Transform,t.SetPosition(o),t.SetRotationAngle(i),o=0,i=this.m_count;o<i;++o)box2d.b2Mul_X_V2(t,this.m_vertices[o],this.m_vertices[o]),box2d.b2Mul_R_V2(t.q,this.m_normals[o],this.m_normals[o]);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsBox",box2d.b2PolygonShape.prototype.SetAsBox);box2d.b2PolygonShape.prototype.Set=function(t,e,o){e="number"===typeof e?e:t.length;o="number"===typeof o?o:0;box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=e&&e<=box2d.b2_maxPolygonVertices);if(3>e)return this.SetAsBox(1,1);e=box2d.b2Min(e,box2d.b2_maxPolygonVertices);for(var i=box2d.b2PolygonShape.prototype.Set.s_ps,a=0,r=0;r<e;++r){for(var s=t[o+r],n=!0,b=0;b<a;++b)if(box2d.b2DistanceSquared(s,i[b])<.25*box2d.b2_linearSlop*box2d.b2_linearSlop){n=!1;break}n&&i[a++].Copy(s)}e=a;if(3>e)return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1);t=0;s=i[0].x;for(r=1;r<e;++r)if(b=i[r].x,b>s||b===s&&i[r].y<i[t].y)t=r,s=b;a=box2d.b2PolygonShape.prototype.Set.s_hull;o=0;for(r=t;;){a[o]=r;n=0;for(b=1;b<e;++b)if(n===r)n=b;else{var x=box2d.b2Sub_V2_V2(i[n],i[a[o]],box2d.b2PolygonShape.prototype.Set.s_r),s=box2d.b2Sub_V2_V2(i[b],i[a[o]],box2d.b2PolygonShape.prototype.Set.s_v),l=box2d.b2Cross_V2_V2(x,s);0>l&&(n=b);0===l&&s.LengthSquared()>x.LengthSquared()&&(n=b)}++o;r=n;if(n===t)break}if(3>o)return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1);this.m_count=o;for(r=0;r<o;++r)this.m_vertices[r].Copy(i[a[r]]);r=0;for(e=o;r<e;++r)i=box2d.b2Sub_V2_V2(this.m_vertices[(r+1)%e],this.m_vertices[r],box2d.b2Vec2.s_t0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.LengthSquared()>box2d.b2_epsilon_sq),box2d.b2Cross_V2_S(i,1,this.m_normals[r]).SelfNormalize();box2d.b2PolygonShape.ComputeCentroid(this.m_vertices,o,this.m_centroid);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Set",box2d.b2PolygonShape.prototype.Set);box2d.b2PolygonShape.prototype.Set.s_ps=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_hull=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_r=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Set.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2PolygonShape.prototype,"GetChildCount",box2d.b2PolygonShape.prototype.GetChildCount);box2d.b2PolygonShape.prototype.TestPoint=function(t,e){for(var o=box2d.b2MulT_X_V2(t,e,box2d.b2PolygonShape.prototype.TestPoint.s_pLocal),i=0,a=this.m_count;i<a;++i)if(0<box2d.b2Dot_V2_V2(this.m_normals[i],box2d.b2Sub_V2_V2(o,this.m_vertices[i],box2d.b2Vec2.s_t0)))return!1;return!0};goog.exportProperty(box2d.b2PolygonShape.prototype,"TestPoint",box2d.b2PolygonShape.prototype.TestPoint);box2d.b2PolygonShape.prototype.TestPoint.s_pLocal=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance=function(t,e,o,i){e=box2d.b2MulT_X_V2(t,e,box2d.b2PolygonShape.prototype.ComputeDistance.s_pLocal);var a=-box2d.b2_maxFloat,r=box2d.b2PolygonShape.prototype.ComputeDistance.s_normalForMaxDistance.Copy(e);for(i=0;i<this.m_count;++i){var s=box2d.b2Dot_V2_V2(this.m_normals[i],box2d.b2Sub_V2_V2(e,this.m_vertices[i],box2d.b2Vec2.s_t0));s>a&&(a=s,r.Copy(this.m_normals[i]))}if(0<a){r=box2d.b2PolygonShape.prototype.ComputeDistance.s_minDistance.Copy(r);a*=a;for(i=0;i<this.m_count;++i){var s=box2d.b2Sub_V2_V2(e,this.m_vertices[i],box2d.b2PolygonShape.prototype.ComputeDistance.s_distance),n=s.LengthSquared();a>n&&(r.Copy(s),a=n)}box2d.b2Mul_R_V2(t.q,r,o);o.Normalize();return Math.sqrt(a)}box2d.b2Mul_R_V2(t.q,r,o);return a};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeDistance",box2d.b2PolygonShape.prototype.ComputeDistance);box2d.b2PolygonShape.prototype.ComputeDistance.s_pLocal=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance.s_normalForMaxDistance=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance.s_minDistance=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance.s_distance=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast=function(t,e,o,i){i=box2d.b2MulT_X_V2(o,e.p1,box2d.b2PolygonShape.prototype.RayCast.s_p1);for(var a=box2d.b2MulT_X_V2(o,e.p2,box2d.b2PolygonShape.prototype.RayCast.s_p2),a=box2d.b2Sub_V2_V2(a,i,box2d.b2PolygonShape.prototype.RayCast.s_d),r=0,s=e.maxFraction,n=-1,b=0,x=this.m_count;b<x;++b){var l=box2d.b2Dot_V2_V2(this.m_normals[b],box2d.b2Sub_V2_V2(this.m_vertices[b],i,box2d.b2Vec2.s_t0)),_=box2d.b2Dot_V2_V2(this.m_normals[b],a);if(0===_){if(0>l)return!1}else 0>_&&l<r*_?(r=l/_,n=b):0<_&&l<s*_&&(s=l/_);if(s<r)return!1}box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=r&&r<=e.maxFraction);return 0<=n?(t.fraction=r,box2d.b2Mul_R_V2(o.q,this.m_normals[n],t.normal),!0):!1};goog.exportProperty(box2d.b2PolygonShape.prototype,"RayCast",box2d.b2PolygonShape.prototype.RayCast);box2d.b2PolygonShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeAABB=function(t,e,o){o=box2d.b2Mul_X_V2(e,this.m_vertices[0],t.lowerBound);t=t.upperBound.Copy(o);for(var i=0,a=this.m_count;i<a;++i){var r=box2d.b2Mul_X_V2(e,this.m_vertices[i],box2d.b2PolygonShape.prototype.ComputeAABB.s_v);box2d.b2Min_V2_V2(r,o,o);box2d.b2Max_V2_V2(r,t,t)}e=this.m_radius;o.SelfSubXY(e,e);t.SelfAddXY(e,e)};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeAABB",box2d.b2PolygonShape.prototype.ComputeAABB);box2d.b2PolygonShape.prototype.ComputeAABB.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=this.m_count);for(var o=box2d.b2PolygonShape.prototype.ComputeMass.s_center.SetZero(),i=0,a=0,r=box2d.b2PolygonShape.prototype.ComputeMass.s_s.SetZero(),s=0,n=this.m_count;s<n;++s)r.SelfAdd(this.m_vertices[s]);r.SelfMul(1/this.m_count);for(var b=1/3,s=0,n=this.m_count;s<n;++s){var x=box2d.b2Sub_V2_V2(this.m_vertices[s],r,box2d.b2PolygonShape.prototype.ComputeMass.s_e1),l=box2d.b2Sub_V2_V2(this.m_vertices[(s+1)%n],r,box2d.b2PolygonShape.prototype.ComputeMass.s_e2),_=box2d.b2Cross_V2_V2(x,l),h=.5*_,i=i+h;o.SelfAdd(box2d.b2Mul_S_V2(h*b,box2d.b2Add_V2_V2(x,l,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1));var h=x.x,x=x.y,d=l.x,l=l.y,a=a+.25*b*_*(h*h+d*h+d*d+(x*x+l*x+l*l))}t.mass=e*i;box2d.ENABLE_ASSERTS&&box2d.b2Assert(i>box2d.b2_epsilon);o.SelfMul(1/i);box2d.b2Add_V2_V2(o,r,t.center);t.I=e*a;t.I+=t.mass*(box2d.b2Dot_V2_V2(t.center,t.center)-box2d.b2Dot_V2_V2(o,o))};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeMass",box2d.b2PolygonShape.prototype.ComputeMass);box2d.b2PolygonShape.prototype.ComputeMass.s_center=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_s=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,o=(t+1)%this.m_count,i=this.m_vertices[e],a=box2d.b2Sub_V2_V2(this.m_vertices[o],i,box2d.b2PolygonShape.prototype.Validate.s_e),r=0;r<this.m_count;++r)if(r!==e&&r!==o){var s=box2d.b2Sub_V2_V2(this.m_vertices[r],i,box2d.b2PolygonShape.prototype.Validate.s_v);if(0>box2d.b2Cross_V2_V2(a,s))return!1}return!0};goog.exportProperty(box2d.b2PolygonShape.prototype,"Validate",box2d.b2PolygonShape.prototype.Validate);box2d.b2PolygonShape.prototype.Validate.s_e=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.SetupDistanceProxy=function(t,e){t.m_vertices=this.m_vertices;t.m_count=this.m_count;t.m_radius=this.m_radius};box2d.b2PolygonShape.prototype.ComputeSubmergedArea=function(t,e,o,i){var a=box2d.b2MulT_R_V2(o.q,t,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL),r=e-box2d.b2Dot_V2_V2(t,o.p),s=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths,n=0,b=-1;e=-1;var x=!1;t=0;for(var l=this.m_count;t<l;++t){s[t]=box2d.b2Dot_V2_V2(a,this.m_vertices[t])-r;var _=s[t]<-box2d.b2_epsilon;0<t&&(_?x||(b=t-1,n++):x&&(e=t-1,n++));x=_}switch(n){case 0:return x?(t=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md,this.ComputeMass(t,1),box2d.b2Mul_X_V2(o,t.center,i),t.mass):0;case 1:-1===b?b=this.m_count-1:e=this.m_count-1}t=(b+1)%this.m_count;a=(e+1)%this.m_count;r=(0-s[b])/(s[t]-s[b]);s=(0-s[e])/(s[a]-s[e]);b=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec.Set(this.m_vertices[b].x*(1-r)+this.m_vertices[t].x*r,this.m_vertices[b].y*(1-r)+this.m_vertices[t].y*r);e=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec.Set(this.m_vertices[e].x*(1-s)+this.m_vertices[a].x*s,this.m_vertices[e].y*(1-s)+this.m_vertices[a].y*s);s=0;r=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center.SetZero();n=this.m_vertices[t];for(x=null;t!==a;)t=(t+1)%this.m_count,x=t===a?e:this.m_vertices[t],l=.5*((n.x-b.x)*(x.y-b.y)-(n.y-b.y)*(x.x-b.x)),s+=l,r.x+=l*(b.x+n.x+x.x)/3,r.y+=l*(b.y+n.y+x.y)/3,n=x;r.SelfMul(1/s);box2d.b2Mul_X_V2(o,r,i);return s};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeSubmergedArea",box2d.b2PolygonShape.prototype.ComputeSubmergedArea);box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md=new box2d.b2MassData;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2PolygonShape*/ var shape = new box2d.b2PolygonShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var t=0;t<this.m_count;++t)box2d.b2Log("    vs[%d].Set(%.15f, %.15f);\n",t,this.m_vertices[t].x,this.m_vertices[t].y);box2d.b2Log("    shape.Set(vs, %d);\n",this.m_count)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Dump",box2d.b2PolygonShape.prototype.Dump);box2d.b2PolygonShape.ComputeCentroid=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=e);o.SetZero();for(var i=0,a=box2d.b2PolygonShape.ComputeCentroid.s_pRef.SetZero(),r=1/3,s=0;s<e;++s){var n=a,b=t[s],x=t[(s+1)%e],l=box2d.b2Sub_V2_V2(b,n,box2d.b2PolygonShape.ComputeCentroid.s_e1),_=box2d.b2Sub_V2_V2(x,n,box2d.b2PolygonShape.ComputeCentroid.s_e2),l=.5*box2d.b2Cross_V2_V2(l,_),i=i+l;o.x+=l*r*(n.x+b.x+x.x);o.y+=l*r*(n.y+b.y+x.y)}box2d.ENABLE_ASSERTS&&box2d.b2Assert(i>box2d.b2_epsilon);o.SelfMul(1/i);return o};goog.exportProperty(box2d.b2PolygonShape,"ComputeCentroid",box2d.b2PolygonShape.ComputeCentroid);box2d.b2PolygonShape.ComputeCentroid.s_pRef=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e2=new box2d.b2Vec2;box2d.b2Timer=function(){this.m_start=(new Date).getTime()};goog.exportSymbol("box2d.b2Timer",box2d.b2Timer);box2d.b2Timer.prototype.m_start=0;goog.exportProperty(box2d.b2Timer.prototype,"m_start",box2d.b2Timer.prototype.m_start);box2d.b2Timer.prototype.Reset=function(){this.m_start=(new Date).getTime();return this};goog.exportProperty(box2d.b2Timer.prototype,"Reset",box2d.b2Timer.prototype.Reset);box2d.b2Timer.prototype.GetMilliseconds=function(){return(new Date).getTime()-this.m_start};goog.exportProperty(box2d.b2Timer.prototype,"GetMilliseconds",box2d.b2Timer.prototype.GetMilliseconds);box2d.b2Counter=function(){};goog.exportSymbol("box2d.b2Counter",box2d.b2Counter);box2d.b2Counter.prototype.m_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_count",box2d.b2Counter.prototype.m_count);box2d.b2Counter.prototype.m_min_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_min_count",box2d.b2Counter.prototype.m_min_count);box2d.b2Counter.prototype.m_max_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_max_count",box2d.b2Counter.prototype.m_max_count);box2d.b2Counter.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2Counter.prototype,"GetCount",box2d.b2Counter.prototype.GetCount);box2d.b2Counter.prototype.GetMinCount=function(){return this.m_min_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMinCount",box2d.b2Counter.prototype.GetMinCount);box2d.b2Counter.prototype.GetMaxCount=function(){return this.m_max_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMaxCount",box2d.b2Counter.prototype.GetMaxCount);box2d.b2Counter.prototype.ResetCount=function(){var t=this.m_count;this.m_count=0;return t};goog.exportProperty(box2d.b2Counter.prototype,"ResetCount",box2d.b2Counter.prototype.ResetCount);box2d.b2Counter.prototype.ResetMinCount=function(){this.m_min_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMinCount",box2d.b2Counter.prototype.ResetMinCount);box2d.b2Counter.prototype.ResetMaxCount=function(){this.m_max_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMaxCount",box2d.b2Counter.prototype.ResetMaxCount);box2d.b2Counter.prototype.Increment=function(){this.m_count++;this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)};goog.exportProperty(box2d.b2Counter.prototype,"Increment",box2d.b2Counter.prototype.Increment);box2d.b2Counter.prototype.Decrement=function(){this.m_count--;this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)};goog.exportProperty(box2d.b2Counter.prototype,"Decrement",box2d.b2Counter.prototype.Decrement);box2d.b2_toiTime=0;goog.exportSymbol("box2d.b2_toiTime",box2d.b2_toiTime);box2d.b2_toiMaxTime=0;goog.exportSymbol("box2d.b2_toiMaxTime",box2d.b2_toiMaxTime);box2d.b2_toiCalls=0;goog.exportSymbol("box2d.b2_toiCalls",box2d.b2_toiCalls);box2d.b2_toiIters=0;goog.exportSymbol("box2d.b2_toiIters",box2d.b2_toiIters);box2d.b2_toiMaxIters=0;goog.exportSymbol("box2d.b2_toiMaxIters",box2d.b2_toiMaxIters);box2d.b2_toiRootIters=0;goog.exportSymbol("box2d.b2_toiRootIters",box2d.b2_toiRootIters);box2d.b2_toiMaxRootIters=0;goog.exportSymbol("box2d.b2_toiMaxRootIters",box2d.b2_toiMaxRootIters);box2d.b2TOIInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.sweepA=new box2d.b2Sweep;this.sweepB=new box2d.b2Sweep};goog.exportSymbol("box2d.b2TOIInput",box2d.b2TOIInput);box2d.b2TOIInput.prototype.proxyA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyA",box2d.b2TOIInput.prototype.proxyA);box2d.b2TOIInput.prototype.proxyB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyB",box2d.b2TOIInput.prototype.proxyB);box2d.b2TOIInput.prototype.sweepA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepA",box2d.b2TOIInput.prototype.sweepA);box2d.b2TOIInput.prototype.sweepB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepB",box2d.b2TOIInput.prototype.sweepB);box2d.b2TOIInput.prototype.tMax=0;goog.exportProperty(box2d.b2TOIInput.prototype,"tMax",box2d.b2TOIInput.prototype.tMax);box2d.b2TOIOutputState={e_unknown:0,e_failed:1,e_overlapped:2,e_touching:3,e_separated:4};goog.exportSymbol("box2d.b2TOIOutputState",box2d.b2TOIOutputState);goog.exportProperty(box2d.b2TOIOutputState,"e_unknown",box2d.b2TOIOutputState.e_unknown);goog.exportProperty(box2d.b2TOIOutputState,"e_failed",box2d.b2TOIOutputState.e_failed);goog.exportProperty(box2d.b2TOIOutputState,"e_overlapped",box2d.b2TOIOutputState.e_overlapped);goog.exportProperty(box2d.b2TOIOutputState,"e_touching",box2d.b2TOIOutputState.e_touching);goog.exportProperty(box2d.b2TOIOutputState,"e_separated",box2d.b2TOIOutputState.e_separated);box2d.b2TOIOutput=function(){};goog.exportSymbol("box2d.b2TOIOutput",box2d.b2TOIOutput);box2d.b2TOIOutput.prototype.state=box2d.b2TOIOutputState.e_unknown;goog.exportProperty(box2d.b2TOIOutput.prototype,"state",box2d.b2TOIOutput.prototype.state);box2d.b2TOIOutput.prototype.t=0;goog.exportProperty(box2d.b2TOIOutput.prototype,"t",box2d.b2TOIOutput.prototype.t);box2d.b2SeparationFunctionType={e_unknown:-1,e_points:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2SeparationFunctionType",box2d.b2SeparationFunctionType);goog.exportProperty(box2d.b2SeparationFunctionType,"e_unknown",box2d.b2SeparationFunctionType.e_unknown);goog.exportProperty(box2d.b2SeparationFunctionType,"e_points",box2d.b2SeparationFunctionType.e_points);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceA",box2d.b2SeparationFunctionType.e_faceA);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceB",box2d.b2SeparationFunctionType.e_faceB);box2d.b2SeparationFunction=function(){this.m_sweepA=new box2d.b2Sweep;this.m_sweepB=new box2d.b2Sweep;this.m_localPoint=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SeparationFunction",box2d.b2SeparationFunction);box2d.b2SeparationFunction.prototype.m_proxyA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyA",box2d.b2SeparationFunction.prototype.m_proxyA);box2d.b2SeparationFunction.prototype.m_proxyB=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyB",box2d.b2SeparationFunction.prototype.m_proxyB);box2d.b2SeparationFunction.prototype.m_sweepA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepA",box2d.b2SeparationFunction.prototype.m_sweepA);box2d.b2SeparationFunction.prototype.m_sweepB=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepB",box2d.b2SeparationFunction.prototype.m_sweepB);box2d.b2SeparationFunction.prototype.m_type=box2d.b2SeparationFunctionType.e_unknown;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_type",box2d.b2SeparationFunction.prototype.m_type);box2d.b2SeparationFunction.prototype.m_localPoint=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_localPoint",box2d.b2SeparationFunction.prototype.m_localPoint);box2d.b2SeparationFunction.prototype.m_axis=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_axis",box2d.b2SeparationFunction.prototype.m_axis);box2d.b2SeparationFunction.prototype.Initialize=function(t,e,o,i,a,r){this.m_proxyA=e;this.m_proxyB=i;e=t.count;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<e&&3>e);this.m_sweepA.Copy(o);this.m_sweepB.Copy(a);o=box2d.b2TimeOfImpact.s_xfA;a=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(o,r);this.m_sweepB.GetTransform(a,r);1===e?(this.m_type=box2d.b2SeparationFunctionType.e_points,e=this.m_proxyA.GetVertex(t.indexA[0]),t=this.m_proxyB.GetVertex(t.indexB[0]),o=box2d.b2Mul_X_V2(o,e,box2d.b2TimeOfImpact.s_pointA),a=box2d.b2Mul_X_V2(a,t,box2d.b2TimeOfImpact.s_pointB),box2d.b2Sub_V2_V2(a,o,this.m_axis),t=this.m_axis.Normalize(),this.m_localPoint.SetZero()):(t.indexA[0]===t.indexA[1]?(this.m_type=box2d.b2SeparationFunctionType.e_faceB,e=this.m_proxyB.GetVertex(t.indexB[0]),i=this.m_proxyB.GetVertex(t.indexB[1]),box2d.b2Cross_V2_S(box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0),1,this.m_axis).SelfNormalize(),r=box2d.b2Mul_R_V2(a.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2Mid_V2_V2(e,i,this.m_localPoint),a=box2d.b2Mul_X_V2(a,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),e=this.m_proxyA.GetVertex(t.indexA[0]),o=box2d.b2Mul_X_V2(o,e,box2d.b2TimeOfImpact.s_pointA),t=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(o,a,box2d.b2Vec2.s_t0),r)):(this.m_type=box2d.b2SeparationFunctionType.e_faceA,e=this.m_proxyA.GetVertex(t.indexA[0]),i=this.m_proxyA.GetVertex(t.indexA[1]),box2d.b2Cross_V2_S(box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0),1,this.m_axis).SelfNormalize(),r=box2d.b2Mul_R_V2(o.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2Mid_V2_V2(e,i,this.m_localPoint),o=box2d.b2Mul_X_V2(o,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),t=this.m_proxyB.GetVertex(t.indexB[0]),a=box2d.b2Mul_X_V2(a,t,box2d.b2TimeOfImpact.s_pointB),t=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,o,box2d.b2Vec2.s_t0),r)),0>t&&(this.m_axis.SelfNeg(),t=-t));return t};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Initialize",box2d.b2SeparationFunction.prototype.Initialize);box2d.b2SeparationFunction.prototype.FindMinSeparation=function(t,e,o){var i=box2d.b2TimeOfImpact.s_xfA,a=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(i,o);this.m_sweepB.GetTransform(a,o);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:var r=box2d.b2MulT_R_V2(i.q,this.m_axis,box2d.b2TimeOfImpact.s_axisA),s=box2d.b2MulT_R_V2(a.q,box2d.b2Vec2.s_t0.Copy(this.m_axis).SelfNeg(),box2d.b2TimeOfImpact.s_axisB);t[0]=this.m_proxyA.GetSupport(r);e[0]=this.m_proxyB.GetSupport(s);t=this.m_proxyA.GetVertex(t[0]);e=this.m_proxyB.GetVertex(e[0]);i=box2d.b2Mul_X_V2(i,t,box2d.b2TimeOfImpact.s_pointA);a=box2d.b2Mul_X_V2(a,e,box2d.b2TimeOfImpact.s_pointB);return e=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,i,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return o=box2d.b2Mul_R_V2(i.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),i=box2d.b2Mul_X_V2(i,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),s=box2d.b2MulT_R_V2(a.q,box2d.b2Vec2.s_t0.Copy(o).SelfNeg(),box2d.b2TimeOfImpact.s_axisB),t[0]=-1,e[0]=this.m_proxyB.GetSupport(s),e=this.m_proxyB.GetVertex(e[0]),a=box2d.b2Mul_X_V2(a,e,box2d.b2TimeOfImpact.s_pointB),e=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,i,box2d.b2Vec2.s_t0),o);case box2d.b2SeparationFunctionType.e_faceB:return o=box2d.b2Mul_R_V2(a.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),a=box2d.b2Mul_X_V2(a,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),r=box2d.b2MulT_R_V2(i.q,box2d.b2Vec2.s_t0.Copy(o).SelfNeg(),box2d.b2TimeOfImpact.s_axisA),e[0]=-1,t[0]=this.m_proxyA.GetSupport(r),t=this.m_proxyA.GetVertex(t[0]),i=box2d.b2Mul_X_V2(i,t,box2d.b2TimeOfImpact.s_pointA),e=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(i,a,box2d.b2Vec2.s_t0),o);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),t[0]=-1,e[0]=-1,0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"FindMinSeparation",box2d.b2SeparationFunction.prototype.FindMinSeparation);box2d.b2SeparationFunction.prototype.Evaluate=function(t,e,o){var i=box2d.b2TimeOfImpact.s_xfA,a=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(i,o);this.m_sweepB.GetTransform(a,o);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:return t=this.m_proxyA.GetVertex(t),e=this.m_proxyB.GetVertex(e),i=box2d.b2Mul_X_V2(i,t,box2d.b2TimeOfImpact.s_pointA),a=box2d.b2Mul_X_V2(a,e,box2d.b2TimeOfImpact.s_pointB),i=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,i,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return o=box2d.b2Mul_R_V2(i.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),i=box2d.b2Mul_X_V2(i,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),e=this.m_proxyB.GetVertex(e),a=box2d.b2Mul_X_V2(a,e,box2d.b2TimeOfImpact.s_pointB),i=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(a,i,box2d.b2Vec2.s_t0),o);case box2d.b2SeparationFunctionType.e_faceB:return o=box2d.b2Mul_R_V2(a.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),a=box2d.b2Mul_X_V2(a,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),t=this.m_proxyA.GetVertex(t),i=box2d.b2Mul_X_V2(i,t,box2d.b2TimeOfImpact.s_pointA),i=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(i,a,box2d.b2Vec2.s_t0),o);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Evaluate",box2d.b2SeparationFunction.prototype.Evaluate);box2d.b2TimeOfImpact=function(t,e){var o=box2d.b2TimeOfImpact.s_timer.Reset();++box2d.b2_toiCalls;t.state=box2d.b2TOIOutputState.e_unknown;t.t=e.tMax;var i=e.proxyA,a=e.proxyB,r=box2d.b2TimeOfImpact.s_sweepA.Copy(e.sweepA),s=box2d.b2TimeOfImpact.s_sweepB.Copy(e.sweepB);r.Normalize();s.Normalize();var n=e.tMax,b=box2d.b2Max(box2d.b2_linearSlop,i.m_radius+a.m_radius-3*box2d.b2_linearSlop),x=.25*box2d.b2_linearSlop;box2d.ENABLE_ASSERTS&&box2d.b2Assert(b>x);var l=0,_=0,h=box2d.b2TimeOfImpact.s_cache;h.count=0;var d=box2d.b2TimeOfImpact.s_distanceInput;d.proxyA=e.proxyA;d.proxyB=e.proxyB;for(d.useRadii=!1;;){var p=box2d.b2TimeOfImpact.s_xfA,c=box2d.b2TimeOfImpact.s_xfB;r.GetTransform(p,l);s.GetTransform(c,l);d.transformA.Copy(p);d.transformB.Copy(c);p=box2d.b2TimeOfImpact.s_distanceOutput;box2d.b2ShapeDistance(p,h,d);if(0>=p.distance){t.state=box2d.b2TOIOutputState.e_overlapped;t.t=0;break}if(p.distance<b+x){t.state=box2d.b2TOIOutputState.e_touching;t.t=l;break}p=box2d.b2TimeOfImpact.s_fcn;p.Initialize(h,i,r,a,s,l);for(var c=!1,u=n,y=0;;){var m=box2d.b2TimeOfImpact.s_indexA,f=box2d.b2TimeOfImpact.s_indexB,g=p.FindMinSeparation(m,f,u);if(g>b+x){t.state=box2d.b2TOIOutputState.e_separated;t.t=n;c=!0;break}if(g>b-x){l=u;break}var v=p.Evaluate(m[0],f[0],l);if(v<b-x){t.state=box2d.b2TOIOutputState.e_failed;t.t=l;c=!0;break}if(v<=b+x){t.state=box2d.b2TOIOutputState.e_touching;t.t=l;c=!0;break}for(var S=0,C=l,P=u;;){var A=0,A=S&1?C+(b-v)*(P-C)/(g-v):.5*(C+P);++S;++box2d.b2_toiRootIters;var B=p.Evaluate(m[0],f[0],A);if(box2d.b2Abs(B-b)<x){u=A;break}B>b?(C=A,v=B):(P=A,g=B);if(50===S)break}box2d.b2_toiMaxRootIters=box2d.b2Max(box2d.b2_toiMaxRootIters,S);++y;if(y===box2d.b2_maxPolygonVertices)break}++_;++box2d.b2_toiIters;if(c)break;if(20===_){t.state=box2d.b2TOIOutputState.e_failed;t.t=l;break}}box2d.b2_toiMaxIters=box2d.b2Max(box2d.b2_toiMaxIters,_);o=o.GetMilliseconds();box2d.b2_toiMaxTime=box2d.b2Max(box2d.b2_toiMaxTime,o);box2d.b2_toiTime+=o};goog.exportSymbol("box2d.b2TimeOfImpact",box2d.b2TimeOfImpact);box2d.b2TimeOfImpact.s_timer=new box2d.b2Timer;box2d.b2TimeOfImpact.s_cache=new box2d.b2SimplexCache;box2d.b2TimeOfImpact.s_distanceInput=new box2d.b2DistanceInput;box2d.b2TimeOfImpact.s_distanceOutput=new box2d.b2DistanceOutput;box2d.b2TimeOfImpact.s_xfA=new box2d.b2Transform;box2d.b2TimeOfImpact.s_xfB=new box2d.b2Transform;box2d.b2TimeOfImpact.s_indexA=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_indexB=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_fcn=new box2d.b2SeparationFunction;box2d.b2TimeOfImpact.s_sweepA=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_sweepB=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_pointA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_pointB=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_normal=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisB=new box2d.b2Vec2;box2d.b2Filter=function(){};goog.exportSymbol("box2d.b2Filter",box2d.b2Filter);box2d.b2Filter.prototype.categoryBits=1;goog.exportProperty(box2d.b2Filter.prototype,"categoryBits",box2d.b2Filter.prototype.categoryBits);box2d.b2Filter.prototype.maskBits=65535;goog.exportProperty(box2d.b2Filter.prototype,"maskBits",box2d.b2Filter.prototype.maskBits);box2d.b2Filter.prototype.groupIndex=0;goog.exportProperty(box2d.b2Filter.prototype,"groupIndex",box2d.b2Filter.prototype.groupIndex);box2d.b2Filter.prototype.Clone=function(){return(new box2d.b2Filter).Copy(this)};goog.exportProperty(box2d.b2Filter.prototype,"Clone",box2d.b2Filter.prototype.Clone);box2d.b2Filter.prototype.Copy=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this!==t);this.categoryBits=t.categoryBits;this.maskBits=t.maskBits;this.groupIndex=t.groupIndex;return this};goog.exportProperty(box2d.b2Filter.prototype,"Copy",box2d.b2Filter.prototype.Copy);box2d.b2FixtureDef=function(){this.filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2FixtureDef",box2d.b2FixtureDef);box2d.b2FixtureDef.prototype.shape=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"shape",box2d.b2FixtureDef.prototype.shape);box2d.b2FixtureDef.prototype.userData=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"userData",box2d.b2FixtureDef.prototype.userData);box2d.b2FixtureDef.prototype.friction=.2;goog.exportProperty(box2d.b2FixtureDef.prototype,"friction",box2d.b2FixtureDef.prototype.friction);box2d.b2FixtureDef.prototype.restitution=0;goog.exportProperty(box2d.b2FixtureDef.prototype,"restitution",box2d.b2FixtureDef.prototype.restitution);box2d.b2FixtureDef.prototype.density=0;goog.exportProperty(box2d.b2FixtureDef.prototype,"density",box2d.b2FixtureDef.prototype.density);box2d.b2FixtureDef.prototype.isSensor=!1;goog.exportProperty(box2d.b2FixtureDef.prototype,"isSensor",box2d.b2FixtureDef.prototype.isSensor);box2d.b2FixtureDef.prototype.filter=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"filter",box2d.b2FixtureDef.prototype.filter);box2d.b2FixtureProxy=function(){this.aabb=new box2d.b2AABB};goog.exportSymbol("box2d.b2FixtureProxy",box2d.b2FixtureProxy);box2d.b2FixtureProxy.prototype.aabb=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"aabb",box2d.b2FixtureProxy.prototype.aabb);box2d.b2FixtureProxy.prototype.fixture=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"fixture",box2d.b2FixtureProxy.prototype.fixture);box2d.b2FixtureProxy.prototype.childIndex=0;goog.exportProperty(box2d.b2FixtureProxy.prototype,"childIndex",box2d.b2FixtureProxy.prototype.childIndex);box2d.b2FixtureProxy.prototype.proxy=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"proxy",box2d.b2FixtureProxy.prototype.proxy);box2d.b2FixtureProxy.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2FixtureProxy})};goog.exportProperty(box2d.b2FixtureProxy,"MakeArray",box2d.b2FixtureProxy.MakeArray);box2d.b2Fixture=function(){this.m_proxyCount=0;this.m_filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2Fixture",box2d.b2Fixture);box2d.b2Fixture.prototype.m_density=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_density",box2d.b2Fixture.prototype.m_density);box2d.b2Fixture.prototype.m_next=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_next",box2d.b2Fixture.prototype.m_next);box2d.b2Fixture.prototype.m_body=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_body",box2d.b2Fixture.prototype.m_body);box2d.b2Fixture.prototype.m_shape=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_shape",box2d.b2Fixture.prototype.m_shape);box2d.b2Fixture.prototype.m_friction=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_friction",box2d.b2Fixture.prototype.m_friction);box2d.b2Fixture.prototype.m_restitution=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_restitution",box2d.b2Fixture.prototype.m_restitution);box2d.b2Fixture.prototype.m_proxies=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_proxies",box2d.b2Fixture.prototype.m_proxies);box2d.b2Fixture.prototype.m_proxyCount=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_proxyCount",box2d.b2Fixture.prototype.m_proxyCount);box2d.b2Fixture.prototype.m_filter=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_filter",box2d.b2Fixture.prototype.m_filter);box2d.b2Fixture.prototype.m_isSensor=!1;goog.exportProperty(box2d.b2Fixture.prototype,"m_isSensor",box2d.b2Fixture.prototype.m_isSensor);box2d.b2Fixture.prototype.m_userData=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_userData",box2d.b2Fixture.prototype.m_userData);box2d.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()};goog.exportProperty(box2d.b2Fixture.prototype,"GetType",box2d.b2Fixture.prototype.GetType);box2d.b2Fixture.prototype.GetShape=function(){return this.m_shape};goog.exportProperty(box2d.b2Fixture.prototype,"GetShape",box2d.b2Fixture.prototype.GetShape);box2d.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor};goog.exportProperty(box2d.b2Fixture.prototype,"IsSensor",box2d.b2Fixture.prototype.IsSensor);box2d.b2Fixture.prototype.GetFilterData=function(t){t=t||new box2d.b2Filter;return t.Copy(this.m_filter)};goog.exportProperty(box2d.b2Fixture.prototype,"GetFilterData",box2d.b2Fixture.prototype.GetFilterData);box2d.b2Fixture.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Fixture.prototype,"GetUserData",box2d.b2Fixture.prototype.GetUserData);box2d.b2Fixture.prototype.SetUserData=function(t){this.m_userData=t};goog.exportProperty(box2d.b2Fixture.prototype,"SetUserData",box2d.b2Fixture.prototype.SetUserData);box2d.b2Fixture.prototype.GetBody=function(){return this.m_body};goog.exportProperty(box2d.b2Fixture.prototype,"GetBody",box2d.b2Fixture.prototype.GetBody);box2d.b2Fixture.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Fixture.prototype,"GetNext",box2d.b2Fixture.prototype.GetNext);box2d.b2Fixture.prototype.SetDensity=function(t){this.m_density=t};goog.exportProperty(box2d.b2Fixture.prototype,"SetDensity",box2d.b2Fixture.prototype.SetDensity);box2d.b2Fixture.prototype.GetDensity=function(){return this.m_density};goog.exportProperty(box2d.b2Fixture.prototype,"GetDensity",box2d.b2Fixture.prototype.GetDensity);box2d.b2Fixture.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Fixture.prototype,"GetFriction",box2d.b2Fixture.prototype.GetFriction);box2d.b2Fixture.prototype.SetFriction=function(t){this.m_friction=t};goog.exportProperty(box2d.b2Fixture.prototype,"SetFriction",box2d.b2Fixture.prototype.SetFriction);box2d.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution};goog.exportProperty(box2d.b2Fixture.prototype,"GetRestitution",box2d.b2Fixture.prototype.GetRestitution);box2d.b2Fixture.prototype.SetRestitution=function(t){this.m_restitution=t};goog.exportProperty(box2d.b2Fixture.prototype,"SetRestitution",box2d.b2Fixture.prototype.SetRestitution);box2d.b2Fixture.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)};goog.exportProperty(box2d.b2Fixture.prototype,"TestPoint",box2d.b2Fixture.prototype.TestPoint);box2d.b2Fixture.prototype.ComputeDistance=function(t,e,o){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),t,e,o)};goog.exportProperty(box2d.b2Fixture.prototype,"ComputeDistance",box2d.b2Fixture.prototype.ComputeDistance);box2d.b2Fixture.prototype.RayCast=function(t,e,o){return this.m_shape.RayCast(t,e,this.m_body.GetTransform(),o)};goog.exportProperty(box2d.b2Fixture.prototype,"RayCast",box2d.b2Fixture.prototype.RayCast);box2d.b2Fixture.prototype.GetMassData=function(t){t=t||new box2d.b2MassData;this.m_shape.ComputeMass(t,this.m_density);return t};goog.exportProperty(box2d.b2Fixture.prototype,"GetMassData",box2d.b2Fixture.prototype.GetMassData);box2d.b2Fixture.prototype.GetAABB=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=t&&t<this.m_proxyCount);return this.m_proxies[t].aabb};goog.exportProperty(box2d.b2Fixture.prototype,"GetAABB",box2d.b2Fixture.prototype.GetAABB);box2d.b2Fixture.prototype.Create=function(t,e){this.m_userData=e.userData;this.m_friction=e.friction;this.m_restitution=e.restitution;this.m_body=t;this.m_next=null;this.m_filter.Copy(e.filter);this.m_isSensor=e.isSensor;this.m_shape=e.shape.Clone();this.m_proxies=box2d.b2FixtureProxy.MakeArray(this.m_shape.GetChildCount());this.m_proxyCount=0;this.m_density=e.density};goog.exportProperty(box2d.b2Fixture.prototype,"Create",box2d.b2Fixture.prototype.Create);box2d.b2Fixture.prototype.Destroy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_shape=null};goog.exportProperty(box2d.b2Fixture.prototype,"Destroy",box2d.b2Fixture.prototype.Destroy);box2d.b2Fixture.prototype.CreateProxies=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_proxyCount=this.m_shape.GetChildCount();for(var o=0;o<this.m_proxyCount;++o){var i=this.m_proxies[o];this.m_shape.ComputeAABB(i.aabb,e,o);i.proxy=t.CreateProxy(i.aabb,i);i.fixture=this;i.childIndex=o}};goog.exportProperty(box2d.b2Fixture.prototype,"CreateProxies",box2d.b2Fixture.prototype.CreateProxies);box2d.b2Fixture.prototype.DestroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var o=this.m_proxies[e];t.DestroyProxy(o.proxy);o.proxy=null}this.m_proxyCount=0};goog.exportProperty(box2d.b2Fixture.prototype,"DestroyProxies",box2d.b2Fixture.prototype.DestroyProxies);box2d.b2Fixture.prototype.Synchronize=function(t,e,o){if(0!==this.m_proxyCount)for(var i=0;i<this.m_proxyCount;++i){var a=this.m_proxies[i],r=box2d.b2Fixture.prototype.Synchronize.s_aabb1,s=box2d.b2Fixture.prototype.Synchronize.s_aabb2;this.m_shape.ComputeAABB(r,e,i);this.m_shape.ComputeAABB(s,o,i);a.aabb.Combine2(r,s);r=box2d.b2Sub_V2_V2(o.p,e.p,box2d.b2Fixture.prototype.Synchronize.s_displacement);t.MoveProxy(a.proxy,a.aabb,r)}};goog.exportProperty(box2d.b2Fixture.prototype,"Synchronize",box2d.b2Fixture.prototype.Synchronize);box2d.b2Fixture.prototype.Synchronize.s_aabb1=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_aabb2=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_displacement=new box2d.b2Vec2;box2d.b2Fixture.prototype.SetFilterData=function(t){this.m_filter.Copy(t);this.Refilter()};goog.exportProperty(box2d.b2Fixture.prototype,"SetFilterData",box2d.b2Fixture.prototype.SetFilterData);box2d.b2Fixture.prototype.Refilter=function(){if(null!==this.m_body){for(var t=this.m_body.GetContactList();t;){var e=t.contact,o=e.GetFixtureA(),i=e.GetFixtureB();o!==this&&i!==this||e.FlagForFiltering();t=t.next}t=this.m_body.GetWorld();if(null!==t)for(t=t.m_contactManager.m_broadPhase,e=0;e<this.m_proxyCount;++e)t.TouchProxy(this.m_proxies[e].proxy)}};goog.exportProperty(box2d.b2Fixture.prototype,"Refilter",box2d.b2Fixture.prototype.Refilter);box2d.b2Fixture.prototype.SetSensor=function(t){t!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)};goog.exportProperty(box2d.b2Fixture.prototype,"SetSensor",box2d.b2Fixture.prototype.SetSensor);box2d.b2Fixture.prototype.Dump=function(t){box2d.DEBUG&&(box2d.b2Log("    /*box2d.b2FixtureDef*/ var fd = new box2d.b2FixtureDef();\n"),box2d.b2Log("    fd.friction = %.15f;\n",this.m_friction),box2d.b2Log("    fd.restitution = %.15f;\n",this.m_restitution),box2d.b2Log("    fd.density = %.15f;\n",this.m_density),box2d.b2Log("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),box2d.b2Log("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),box2d.b2Log("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),box2d.b2Log("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(),box2d.b2Log("\n"),box2d.b2Log("    fd.shape = shape;\n"),box2d.b2Log("\n"),box2d.b2Log("    bodies[%d].CreateFixture(fd);\n",t))};goog.exportProperty(box2d.b2Fixture.prototype,"Dump",box2d.b2Fixture.prototype.Dump);box2d.b2BodyType={b2_unknown:-1,b2_staticBody:0,b2_kinematicBody:1,b2_dynamicBody:2,b2_bulletBody:3};goog.exportSymbol("box2d.b2BodyType",box2d.b2BodyType);goog.exportProperty(box2d.b2BodyType,"b2_unknown",box2d.b2BodyType.b2_unknown);goog.exportProperty(box2d.b2BodyType,"b2_staticBody",box2d.b2BodyType.b2_staticBody);goog.exportProperty(box2d.b2BodyType,"b2_kinematicBody",box2d.b2BodyType.b2_kinematicBody);goog.exportProperty(box2d.b2BodyType,"b2_dynamicBody",box2d.b2BodyType.b2_dynamicBody);goog.exportProperty(box2d.b2BodyType,"b2_bulletBody",box2d.b2BodyType.b2_bulletBody);box2d.b2BodyDef=function(){this.position=new box2d.b2Vec2(0,0);this.linearVelocity=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2BodyDef",box2d.b2BodyDef);box2d.b2BodyDef.prototype.type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2BodyDef.prototype,"type",box2d.b2BodyDef.prototype.type);box2d.b2BodyDef.prototype.position=null;goog.exportProperty(box2d.b2BodyDef.prototype,"position",box2d.b2BodyDef.prototype.position);box2d.b2BodyDef.prototype.angle=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angle",box2d.b2BodyDef.prototype.angle);box2d.b2BodyDef.prototype.linearVelocity=null;goog.exportProperty(box2d.b2BodyDef.prototype,"linearVelocity",box2d.b2BodyDef.prototype.linearVelocity);box2d.b2BodyDef.prototype.angularVelocity=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularVelocity",box2d.b2BodyDef.prototype.angularVelocity);box2d.b2BodyDef.prototype.linearDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"linearDamping",box2d.b2BodyDef.prototype.linearDamping);box2d.b2BodyDef.prototype.angularDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularDamping",box2d.b2BodyDef.prototype.angularDamping);box2d.b2BodyDef.prototype.allowSleep=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"allowSleep",box2d.b2BodyDef.prototype.allowSleep);box2d.b2BodyDef.prototype.awake=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"awake",box2d.b2BodyDef.prototype.awake);box2d.b2BodyDef.prototype.fixedRotation=!1;goog.exportProperty(box2d.b2BodyDef.prototype,"fixedRotation",box2d.b2BodyDef.prototype.fixedRotation);box2d.b2BodyDef.prototype.bullet=!1;goog.exportProperty(box2d.b2BodyDef.prototype,"bullet",box2d.b2BodyDef.prototype.bullet);box2d.b2BodyDef.prototype.active=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"active",box2d.b2BodyDef.prototype.active);box2d.b2BodyDef.prototype.userData=null;goog.exportProperty(box2d.b2BodyDef.prototype,"userData",box2d.b2BodyDef.prototype.userData);box2d.b2BodyDef.prototype.gravityScale=1;goog.exportProperty(box2d.b2BodyDef.prototype,"gravityScale",box2d.b2BodyDef.prototype.gravityScale);box2d.b2Body=function(t,e){this.m_xf=new box2d.b2Transform;this.m_out_xf=new box2d.b2Transform;this.m_xf0=new box2d.b2Transform;this.m_sweep=new box2d.b2Sweep;this.m_out_sweep=new box2d.b2Sweep;this.m_linearVelocity=new box2d.b2Vec2;this.m_out_linearVelocity=new box2d.b2Vec2;this.m_force=new box2d.b2Vec2;box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.position.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.linearVelocity.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.angle));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.angularVelocity));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.gravityScale)&&0<=t.gravityScale);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.angularDamping)&&0<=t.angularDamping);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.linearDamping)&&0<=t.linearDamping);t.bullet&&(this.m_flag_bulletFlag=!0);t.fixedRotation&&(this.m_flag_fixedRotationFlag=!0);t.allowSleep&&(this.m_flag_autoSleepFlag=!0);t.awake&&(this.m_flag_awakeFlag=!0);t.active&&(this.m_flag_activeFlag=!0);this.m_world=e;this.m_xf.p.Copy(t.position);this.m_xf.q.SetAngle(t.angle);this.m_xf0.Copy(this.m_xf);this.m_sweep.localCenter.SetZero();this.m_sweep.c0.Copy(this.m_xf.p);this.m_sweep.c.Copy(this.m_xf.p);this.m_sweep.a0=t.angle;this.m_sweep.a=t.angle;this.m_sweep.alpha0=0;this.m_linearVelocity.Copy(t.linearVelocity);this.m_angularVelocity=t.angularVelocity;this.m_linearDamping=t.linearDamping;this.m_angularDamping=t.angularDamping;this.m_gravityScale=t.gravityScale;this.m_force.SetZero();this.m_sleepTime=this.m_torque=0;this.m_type=t.type;this.m_invMass=t.type===box2d.b2BodyType.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_userData=t.userData;this.m_fixtureList=null;this.m_fixtureCount=0;this.m_controllerList=null;this.m_controllerCount=0};goog.exportSymbol("box2d.b2Body",box2d.b2Body);box2d.b2Body.prototype.m_flag_islandFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_islandFlag",box2d.b2Body.prototype.m_flag_islandFlag);box2d.b2Body.prototype.m_flag_awakeFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_awakeFlag",box2d.b2Body.prototype.m_flag_awakeFlag);box2d.b2Body.prototype.m_flag_autoSleepFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_autoSleepFlag",box2d.b2Body.prototype.m_flag_autoSleepFlag);box2d.b2Body.prototype.m_flag_bulletFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_bulletFlag",box2d.b2Body.prototype.m_flag_bulletFlag);box2d.b2Body.prototype.m_flag_fixedRotationFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_fixedRotationFlag",box2d.b2Body.prototype.m_flag_fixedRotationFlag);box2d.b2Body.prototype.m_flag_activeFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_activeFlag",box2d.b2Body.prototype.m_flag_activeFlag);box2d.b2Body.prototype.m_flag_toiFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_toiFlag",box2d.b2Body.prototype.m_flag_toiFlag);box2d.b2Body.prototype.m_islandIndex=0;goog.exportProperty(box2d.b2Body.prototype,"m_islandIndex",box2d.b2Body.prototype.m_islandIndex);box2d.b2Body.prototype.m_world=null;goog.exportProperty(box2d.b2Body.prototype,"m_world",box2d.b2Body.prototype.m_world);box2d.b2Body.prototype.m_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_xf",box2d.b2Body.prototype.m_xf);box2d.b2Body.prototype.m_out_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_xf",box2d.b2Body.prototype.m_out_xf);box2d.b2Body.prototype.m_xf0=null;goog.exportProperty(box2d.b2Body.prototype,"m_xf0",box2d.b2Body.prototype.m_xf0);box2d.b2Body.prototype.m_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_sweep",box2d.b2Body.prototype.m_sweep);box2d.b2Body.prototype.m_out_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_sweep",box2d.b2Body.prototype.m_out_sweep);box2d.b2Body.prototype.m_jointList=null;goog.exportProperty(box2d.b2Body.prototype,"m_jointList",box2d.b2Body.prototype.m_jointList);box2d.b2Body.prototype.m_contactList=null;goog.exportProperty(box2d.b2Body.prototype,"m_contactList",box2d.b2Body.prototype.m_contactList);box2d.b2Body.prototype.m_prev=null;goog.exportProperty(box2d.b2Body.prototype,"m_prev",box2d.b2Body.prototype.m_prev);box2d.b2Body.prototype.m_next=null;goog.exportProperty(box2d.b2Body.prototype,"m_next",box2d.b2Body.prototype.m_next);box2d.b2Body.prototype.m_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_linearVelocity",box2d.b2Body.prototype.m_linearVelocity);box2d.b2Body.prototype.m_out_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_linearVelocity",box2d.b2Body.prototype.m_out_linearVelocity);box2d.b2Body.prototype.m_angularVelocity=0;goog.exportProperty(box2d.b2Body.prototype,"m_angularVelocity",box2d.b2Body.prototype.m_angularVelocity);box2d.b2Body.prototype.m_linearDamping=0;goog.exportProperty(box2d.b2Body.prototype,"m_linearDamping",box2d.b2Body.prototype.m_linearDamping);box2d.b2Body.prototype.m_angularDamping=0;goog.exportProperty(box2d.b2Body.prototype,"m_angularDamping",box2d.b2Body.prototype.m_angularDamping);box2d.b2Body.prototype.m_gravityScale=1;goog.exportProperty(box2d.b2Body.prototype,"m_gravityScale",box2d.b2Body.prototype.m_gravityScale);box2d.b2Body.prototype.m_force=null;goog.exportProperty(box2d.b2Body.prototype,"m_force",box2d.b2Body.prototype.m_force);box2d.b2Body.prototype.m_torque=0;goog.exportProperty(box2d.b2Body.prototype,"m_torque",box2d.b2Body.prototype.m_torque);box2d.b2Body.prototype.m_sleepTime=0;goog.exportProperty(box2d.b2Body.prototype,"m_sleepTime",box2d.b2Body.prototype.m_sleepTime);box2d.b2Body.prototype.m_type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2Body.prototype,"m_type",box2d.b2Body.prototype.m_type);box2d.b2Body.prototype.m_mass=1;goog.exportProperty(box2d.b2Body.prototype,"m_mass",box2d.b2Body.prototype.m_mass);box2d.b2Body.prototype.m_invMass=1;goog.exportProperty(box2d.b2Body.prototype,"m_invMass",box2d.b2Body.prototype.m_invMass);box2d.b2Body.prototype.m_I=0;goog.exportProperty(box2d.b2Body.prototype,"m_I",box2d.b2Body.prototype.m_I);box2d.b2Body.prototype.m_invI=0;goog.exportProperty(box2d.b2Body.prototype,"m_invI",box2d.b2Body.prototype.m_invI);box2d.b2Body.prototype.m_userData=null;goog.exportProperty(box2d.b2Body.prototype,"m_userData",box2d.b2Body.prototype.m_userData);box2d.b2Body.prototype.m_fixtureList=null;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureList",box2d.b2Body.prototype.m_fixtureList);box2d.b2Body.prototype.m_fixtureCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureCount",box2d.b2Body.prototype.m_fixtureCount);box2d.b2Body.prototype.m_controllerList=null;goog.exportProperty(box2d.b2Body.prototype,"m_controllerList",box2d.b2Body.prototype.m_controllerList);box2d.b2Body.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_controllerCount",box2d.b2Body.prototype.m_controllerCount);box2d.b2Body.prototype.CreateFixture=function(t,e){if(t instanceof box2d.b2FixtureDef)return this.CreateFixture_Def(t);if(t instanceof box2d.b2Shape&&"number"===typeof e)return this.CreateFixture_Shape_Density(t,e);throw Error()};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture",box2d.b2Body.prototype.CreateFixture);box2d.b2Body.prototype.CreateFixture_Def=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(this.m_world.IsLocked())return null;var e=new box2d.b2Fixture;e.Create(this,t);this.m_flag_activeFlag&&e.CreateProxies(this.m_world.m_contactManager.m_broadPhase,this.m_xf);e.m_next=this.m_fixtureList;this.m_fixtureList=e;++this.m_fixtureCount;e.m_body=this;0<e.m_density&&this.ResetMassData();this.m_world.m_flag_newFixture=!0;return e};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture_Def",box2d.b2Body.prototype.CreateFixture_Def);box2d.b2Body.prototype.CreateFixture_Shape_Density=function(t,e){var o=box2d.b2Body.prototype.CreateFixture_Shape_Density.s_def;o.shape=t;o.density="number"===typeof e?e:0;return this.CreateFixture_Def(o)};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture_Shape_Density",box2d.b2Body.prototype.CreateFixture_Shape_Density);box2d.b2Body.prototype.CreateFixture_Shape_Density.s_def=new box2d.b2FixtureDef;box2d.b2Body.prototype.DestroyFixture=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.m_body===this);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_fixtureCount);for(var e=this.m_fixtureList,o=null,i=!1;null!==e;){if(e===t){o?o.m_next=t.m_next:this.m_fixtureList=t.m_next;i=!0;break}o=e;e=e.m_next}box2d.ENABLE_ASSERTS&&box2d.b2Assert(i);for(e=this.m_contactList;e;){var o=e.contact,e=e.next,i=o.GetFixtureA(),a=o.GetFixtureB();t!==i&&t!==a||this.m_world.m_contactManager.Destroy(o)}this.m_flag_activeFlag&&t.DestroyProxies(this.m_world.m_contactManager.m_broadPhase);t.Destroy();t.m_body=null;t.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};goog.exportProperty(box2d.b2Body.prototype,"DestroyFixture",box2d.b2Body.prototype.DestroyFixture);box2d.b2Body.prototype.SetTransform=function(t,e,o){if(t instanceof box2d.b2Vec2&&"number"===typeof e)this.SetTransform_X_Y_A(t.x,t.y,e);else if(t instanceof box2d.b2Transform)this.SetTransform_X_Y_A(t.p.x,t.p.y,t.GetAngle());else if("number"===typeof t&&"number"===typeof e&&"number"===typeof o)this.SetTransform_X_Y_A(t,e,o);else throw Error()};goog.exportProperty(box2d.b2Body.prototype,"SetTransform",box2d.b2Body.prototype.SetTransform);box2d.b2Body.prototype.SetTransform_V2_A=function(t,e){this.SetTransform_X_Y_A(t.x,t.y,e)};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_V2_A",box2d.b2Body.prototype.SetTransform_V2_A);box2d.b2Body.prototype.SetTransform_X_Y_A=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&(this.m_xf.p.x!==t||this.m_xf.p.y!==e||this.m_xf.q.GetAngle()!==o))for(this.m_xf.q.SetAngle(o),this.m_xf.p.Set(t,e),this.m_xf0.Copy(this.m_xf),box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=o,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=o,t=this.m_world.m_contactManager.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.Synchronize(t,this.m_xf,this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_X_Y_A",box2d.b2Body.prototype.SetTransform_X_Y_A);box2d.b2Body.prototype.SetTransform_X=function(t){this.SetTransform_X_Y_A(t.p.x,t.p.y,t.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_X",box2d.b2Body.prototype.SetTransform_X);box2d.b2Body.prototype.GetTransform=function(t){t=t||this.m_out_xf;return t.Copy(this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"GetTransform",box2d.b2Body.prototype.GetTransform);box2d.b2Body.prototype.GetPosition=function(t){t=t||this.m_out_xf.p;return t.Copy(this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"GetPosition",box2d.b2Body.prototype.GetPosition);box2d.b2Body.prototype.SetPosition=function(t){this.SetTransform_V2_A(t,this.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetPosition",box2d.b2Body.prototype.SetPosition);box2d.b2Body.prototype.SetPositionXY=function(t,e){this.SetTransform_X_Y_A(t,e,this.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetPositionXY",box2d.b2Body.prototype.SetPositionXY);box2d.b2Body.prototype.GetRotation=function(t){t=t||this.m_out_xf.q;return t.Copy(this.m_xf.q)};goog.exportProperty(box2d.b2Body.prototype,"GetRotation",box2d.b2Body.prototype.GetRotation);box2d.b2Body.prototype.SetRotation=function(t){this.SetTransform_V2_A(this.GetPosition(),t.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetRotation",box2d.b2Body.prototype.SetRotation);box2d.b2Body.prototype.GetAngle=function(){return this.m_sweep.a};goog.exportProperty(box2d.b2Body.prototype,"GetAngle",box2d.b2Body.prototype.GetAngle);box2d.b2Body.prototype.SetAngle=function(t){this.SetTransform_V2_A(this.GetPosition(),t)};goog.exportProperty(box2d.b2Body.prototype,"SetAngle",box2d.b2Body.prototype.SetAngle);box2d.b2Body.prototype.GetWorldCenter=function(t){t=t||this.m_out_sweep.c;return t.Copy(this.m_sweep.c)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldCenter",box2d.b2Body.prototype.GetWorldCenter);box2d.b2Body.prototype.GetLocalCenter=function(t){t=t||this.m_out_sweep.localCenter;return t.Copy(this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalCenter",box2d.b2Body.prototype.GetLocalCenter);box2d.b2Body.prototype.SetLinearVelocity=function(t){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<box2d.b2Dot_V2_V2(t,t)&&this.SetAwake(!0),this.m_linearVelocity.Copy(t))};goog.exportProperty(box2d.b2Body.prototype,"SetLinearVelocity",box2d.b2Body.prototype.SetLinearVelocity);box2d.b2Body.prototype.GetLinearVelocity=function(t){t=t||this.m_out_linearVelocity;return t.Copy(this.m_linearVelocity)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocity",box2d.b2Body.prototype.GetLinearVelocity);box2d.b2Body.prototype.SetAngularVelocity=function(t){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<t*t&&this.SetAwake(!0),this.m_angularVelocity=t)};goog.exportProperty(box2d.b2Body.prototype,"SetAngularVelocity",box2d.b2Body.prototype.SetAngularVelocity);box2d.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};goog.exportProperty(box2d.b2Body.prototype,"GetAngularVelocity",box2d.b2Body.prototype.GetAngularVelocity);box2d.b2Body.prototype.GetDefinition=function(t){t.type=this.GetType();t.allowSleep=this.m_flag_autoSleepFlag;t.angle=this.GetAngle();t.angularDamping=this.m_angularDamping;t.gravityScale=this.m_gravityScale;t.angularVelocity=this.m_angularVelocity;t.fixedRotation=this.m_flag_fixedRotationFlag;t.bullet=this.m_flag_bulletFlag;t.awake=this.m_flag_awakeFlag;t.linearDamping=this.m_linearDamping;t.linearVelocity.Copy(this.GetLinearVelocity());t.position.Copy(this.GetPosition());t.userData=this.GetUserData();return t};goog.exportProperty(box2d.b2Body.prototype,"GetDefinition",box2d.b2Body.prototype.GetDefinition);box2d.b2Body.prototype.ApplyForce=function(t,e,o){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForce",box2d.b2Body.prototype.ApplyForce);box2d.b2Body.prototype.ApplyForceToCenter=function(t,e){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof e?e:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForceToCenter",box2d.b2Body.prototype.ApplyForceToCenter);box2d.b2Body.prototype.ApplyTorque=function(t,e){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof e?e:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_torque+=t))};goog.exportProperty(box2d.b2Body.prototype,"ApplyTorque",box2d.b2Body.prototype.ApplyTorque);box2d.b2Body.prototype.ApplyLinearImpulse=function(t,e,o){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof o?o:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)))};goog.exportProperty(box2d.b2Body.prototype,"ApplyLinearImpulse",box2d.b2Body.prototype.ApplyLinearImpulse);box2d.b2Body.prototype.ApplyLinearImpulseToCenter=function(t,e){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof e?e:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y))};goog.exportProperty(box2d.b2Body.prototype,"ApplyLinearImpulseToCenter",box2d.b2Body.prototype.ApplyLinearImpulseToCenter);box2d.b2Body.prototype.ApplyAngularImpulse=function(t,e){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof e?e:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))};goog.exportProperty(box2d.b2Body.prototype,"ApplyAngularImpulse",box2d.b2Body.prototype.ApplyAngularImpulse);box2d.b2Body.prototype.GetMass=function(){return this.m_mass};goog.exportProperty(box2d.b2Body.prototype,"GetMass",box2d.b2Body.prototype.GetMass);box2d.b2Body.prototype.GetInertia=function(){return this.m_I+this.m_mass*box2d.b2Dot_V2_V2(this.m_sweep.localCenter,this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetInertia",box2d.b2Body.prototype.GetInertia);box2d.b2Body.prototype.GetMassData=function(t){t.mass=this.m_mass;t.I=this.m_I+this.m_mass*box2d.b2Dot_V2_V2(this.m_sweep.localCenter,this.m_sweep.localCenter);t.center.Copy(this.m_sweep.localCenter);return t};goog.exportProperty(box2d.b2Body.prototype,"GetMassData",box2d.b2Body.prototype.GetMassData);box2d.b2Body.prototype.SetMassData=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&this.m_type===box2d.b2BodyType.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=t.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<t.I&&!this.m_flag_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*box2d.b2Dot_V2_V2(t.center,t.center),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I);var e=box2d.b2Body.prototype.SetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(t.center);box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(this.m_sweep.c,e,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"SetMassData",box2d.b2Body.prototype.SetMassData);box2d.b2Body.prototype.SetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(this.m_type===box2d.b2BodyType.b2_staticBody||this.m_type===box2d.b2BodyType.b2_kinematicBody)this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;else{box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===box2d.b2BodyType.b2_dynamicBody);for(var t=box2d.b2Body.prototype.ResetMassData.s_localCenter.SetZero(),e=this.m_fixtureList;e;e=e.m_next)if(0!==e.m_density){var o=e.GetMassData(box2d.b2Body.prototype.ResetMassData.s_massData);this.m_mass+=o.mass;t.x+=o.center.x*o.mass;t.y+=o.center.y*o.mass;this.m_I+=o.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,t.x*=this.m_invMass,t.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&!this.m_flag_fixedRotationFlag?(this.m_I-=this.m_mass*box2d.b2Dot_V2_V2(t,t),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;e=box2d.b2Body.prototype.ResetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(t);box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(this.m_sweep.c,e,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"ResetMassData",box2d.b2Body.prototype.ResetMassData);box2d.b2Body.prototype.ResetMassData.s_localCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_massData=new box2d.b2MassData;box2d.b2Body.prototype.GetWorldPoint=function(t,e){return box2d.b2Mul_X_V2(this.m_xf,t,e)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldPoint",box2d.b2Body.prototype.GetWorldPoint);box2d.b2Body.prototype.GetWorldVector=function(t,e){return box2d.b2Mul_R_V2(this.m_xf.q,t,e)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldVector",box2d.b2Body.prototype.GetWorldVector);box2d.b2Body.prototype.GetLocalPoint=function(t,e){return box2d.b2MulT_X_V2(this.m_xf,t,e)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalPoint",box2d.b2Body.prototype.GetLocalPoint);box2d.b2Body.prototype.GetLocalVector=function(t,e){return box2d.b2MulT_R_V2(this.m_xf.q,t,e)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalVector",box2d.b2Body.prototype.GetLocalVector);box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(t,e){return box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(t,this.m_sweep.c,box2d.b2Vec2.s_t0),e)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromWorldPoint",box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint);box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(t,e){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t,e),e)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromLocalPoint",box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint);box2d.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping};goog.exportProperty(box2d.b2Body.prototype,"GetLinearDamping",box2d.b2Body.prototype.GetLinearDamping);box2d.b2Body.prototype.SetLinearDamping=function(t){this.m_linearDamping=t};goog.exportProperty(box2d.b2Body.prototype,"SetLinearDamping",box2d.b2Body.prototype.SetLinearDamping);box2d.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping};goog.exportProperty(box2d.b2Body.prototype,"GetAngularDamping",box2d.b2Body.prototype.GetAngularDamping);box2d.b2Body.prototype.SetAngularDamping=function(t){this.m_angularDamping=t};goog.exportProperty(box2d.b2Body.prototype,"SetAngularDamping",box2d.b2Body.prototype.SetAngularDamping);box2d.b2Body.prototype.GetGravityScale=function(){return this.m_gravityScale};goog.exportProperty(box2d.b2Body.prototype,"GetGravityScale",box2d.b2Body.prototype.GetGravityScale);box2d.b2Body.prototype.SetGravityScale=function(t){this.m_gravityScale=t};goog.exportProperty(box2d.b2Body.prototype,"SetGravityScale",box2d.b2Body.prototype.SetGravityScale);box2d.b2Body.prototype.SetType=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&this.m_type!==t){this.m_type=t;this.ResetMassData();this.m_type===box2d.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures());this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(t=this.m_contactList;t;){var e=t;t=t.next;this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null;t=this.m_world.m_contactManager.m_broadPhase;for(e=this.m_fixtureList;e;e=e.m_next)for(var o=e.m_proxyCount,i=0;i<o;++i)t.TouchProxy(e.m_proxies[i].proxy)}};goog.exportProperty(box2d.b2Body.prototype,"SetType",box2d.b2Body.prototype.SetType);box2d.b2Body.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Body.prototype,"GetType",box2d.b2Body.prototype.GetType);box2d.b2Body.prototype.SetBullet=function(t){this.m_flag_bulletFlag=t};goog.exportProperty(box2d.b2Body.prototype,"SetBullet",box2d.b2Body.prototype.SetBullet);box2d.b2Body.prototype.IsBullet=function(){return this.m_flag_bulletFlag};goog.exportProperty(box2d.b2Body.prototype,"IsBullet",box2d.b2Body.prototype.IsBullet);box2d.b2Body.prototype.SetSleepingAllowed=function(t){t?this.m_flag_autoSleepFlag=!0:(this.m_flag_autoSleepFlag=!1,this.SetAwake(!0))};goog.exportProperty(box2d.b2Body.prototype,"SetSleepingAllowed",box2d.b2Body.prototype.SetSleepingAllowed);box2d.b2Body.prototype.IsSleepingAllowed=function(){return this.m_flag_autoSleepFlag};goog.exportProperty(box2d.b2Body.prototype,"IsSleepingAllowed",box2d.b2Body.prototype.IsSleepingAllowed);box2d.b2Body.prototype.SetAwake=function(t){t?this.m_flag_awakeFlag||(this.m_flag_awakeFlag=!0,this.m_sleepTime=0):(this.m_flag_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};goog.exportProperty(box2d.b2Body.prototype,"SetAwake",box2d.b2Body.prototype.SetAwake);box2d.b2Body.prototype.IsAwake=function(){return this.m_flag_awakeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsAwake",box2d.b2Body.prototype.IsAwake);box2d.b2Body.prototype.SetActive=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(t!==this.IsActive())if(t){this.m_flag_activeFlag=!0;t=this.m_world.m_contactManager.m_broadPhase;for(var e=this.m_fixtureList;e;e=e.m_next)e.CreateProxies(t,this.m_xf)}else{this.m_flag_activeFlag=!1;t=this.m_world.m_contactManager.m_broadPhase;for(e=this.m_fixtureList;e;e=e.m_next)e.DestroyProxies(t);for(t=this.m_contactList;t;)e=t,t=t.next,this.m_world.m_contactManager.Destroy(e.contact);this.m_contactList=null}};goog.exportProperty(box2d.b2Body.prototype,"SetActive",box2d.b2Body.prototype.SetActive);box2d.b2Body.prototype.IsActive=function(){return this.m_flag_activeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsActive",box2d.b2Body.prototype.IsActive);box2d.b2Body.prototype.SetFixedRotation=function(t){this.m_flag_fixedRotationFlag!==t&&(this.m_flag_fixedRotationFlag=t,this.m_angularVelocity=0,this.ResetMassData())};goog.exportProperty(box2d.b2Body.prototype,"SetFixedRotation",box2d.b2Body.prototype.SetFixedRotation);box2d.b2Body.prototype.IsFixedRotation=function(){return this.m_flag_fixedRotationFlag};goog.exportProperty(box2d.b2Body.prototype,"IsFixedRotation",box2d.b2Body.prototype.IsFixedRotation);box2d.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList};goog.exportProperty(box2d.b2Body.prototype,"GetFixtureList",box2d.b2Body.prototype.GetFixtureList);box2d.b2Body.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2Body.prototype,"GetJointList",box2d.b2Body.prototype.GetJointList);box2d.b2Body.prototype.GetContactList=function(){return this.m_contactList};goog.exportProperty(box2d.b2Body.prototype,"GetContactList",box2d.b2Body.prototype.GetContactList);box2d.b2Body.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Body.prototype,"GetNext",box2d.b2Body.prototype.GetNext);box2d.b2Body.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Body.prototype,"GetUserData",box2d.b2Body.prototype.GetUserData);box2d.b2Body.prototype.SetUserData=function(t){this.m_userData=t};goog.exportProperty(box2d.b2Body.prototype,"SetUserData",box2d.b2Body.prototype.SetUserData);box2d.b2Body.prototype.GetWorld=function(){return this.m_world};goog.exportProperty(box2d.b2Body.prototype,"GetWorld",box2d.b2Body.prototype.GetWorld);box2d.b2Body.prototype.SynchronizeFixtures=function(){var t=box2d.b2Body.prototype.SynchronizeFixtures.s_xf1;t.q.SetAngle(this.m_sweep.a0);box2d.b2Mul_R_V2(t.q,this.m_sweep.localCenter,t.p);box2d.b2Sub_V2_V2(this.m_sweep.c0,t.p,t.p);for(var e=this.m_world.m_contactManager.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)o.Synchronize(e,t,this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeFixtures",box2d.b2Body.prototype.SynchronizeFixtures);box2d.b2Body.prototype.SynchronizeFixtures.s_xf1=new box2d.b2Transform;box2d.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngle(this.m_sweep.a);box2d.b2Mul_R_V2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2Sub_V2_V2(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeTransform",box2d.b2Body.prototype.SynchronizeTransform);box2d.b2Body.prototype.ShouldCollide=function(t){return this.m_type===box2d.b2BodyType.b2_staticBody&&t.m_type===box2d.b2BodyType.b2_staticBody?!1:this.ShouldCollideConnected(t)};goog.exportProperty(box2d.b2Body.prototype,"ShouldCollide",box2d.b2Body.prototype.ShouldCollide);box2d.b2Body.prototype.ShouldCollideConnected=function(t){for(var e=this.m_jointList;e;e=e.next)if(e.other===t&&!e.joint.m_collideConnected)return!1;return!0};goog.exportProperty(box2d.b2Body.prototype,"ShouldCollideConnected",box2d.b2Body.prototype.ShouldCollideConnected);box2d.b2Body.prototype.Advance=function(t){this.m_sweep.Advance(t);this.m_sweep.c.Copy(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.m_xf.q.SetAngle(this.m_sweep.a);box2d.b2Mul_R_V2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2Sub_V2_V2(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"Advance",box2d.b2Body.prototype.Advance);box2d.b2Body.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_islandIndex;box2d.b2Log("{\n");box2d.b2Log("  /*box2d.b2BodyDef*/ var bd = new box2d.b2BodyDef();\n");var e="";switch(this.m_type){case box2d.b2BodyType.b2_staticBody:e="box2d.b2BodyType.b2_staticBody";break;case box2d.b2BodyType.b2_kinematicBody:e="box2d.b2BodyType.b2_kinematicBody";break;case box2d.b2BodyType.b2_dynamicBody:e="box2d.b2BodyType.b2_dynamicBody";break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}box2d.b2Log("  bd.type = %s;\n",e);box2d.b2Log("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y);box2d.b2Log("  bd.angle = %.15f;\n",this.m_sweep.a);box2d.b2Log("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y);box2d.b2Log("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity);box2d.b2Log("  bd.linearDamping = %.15f;\n",this.m_linearDamping);box2d.b2Log("  bd.angularDamping = %.15f;\n",this.m_angularDamping);box2d.b2Log("  bd.allowSleep = %s;\n",this.m_flag_autoSleepFlag?"true":"false");box2d.b2Log("  bd.awake = %s;\n",this.m_flag_awakeFlag?"true":"false");box2d.b2Log("  bd.fixedRotation = %s;\n",this.m_flag_fixedRotationFlag?"true":"false");box2d.b2Log("  bd.bullet = %s;\n",this.m_flag_bulletFlag?"true":"false");box2d.b2Log("  bd.active = %s;\n",this.m_flag_activeFlag?"true":"false");box2d.b2Log("  bd.gravityScale = %.15f;\n",this.m_gravityScale);box2d.b2Log("\n");box2d.b2Log("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex);box2d.b2Log("\n");for(e=this.m_fixtureList;e;e=e.m_next)box2d.b2Log("  {\n"),e.Dump(t),box2d.b2Log("  }\n");box2d.b2Log("}\n")}};goog.exportProperty(box2d.b2Body.prototype,"Dump",box2d.b2Body.prototype.Dump);box2d.b2Body.prototype.GetControllerList=function(){return this.m_controllerList};goog.exportProperty(box2d.b2Body.prototype,"GetControllerList",box2d.b2Body.prototype.GetControllerList);box2d.b2Body.prototype.GetControllerCount=function(){return this.m_controllerCount};goog.exportProperty(box2d.b2Body.prototype,"GetControllerCount",box2d.b2Body.prototype.GetControllerCount);box2d.b2Profile=function(){};goog.exportSymbol("box2d.b2Profile",box2d.b2Profile);box2d.b2Profile.prototype.step=0;goog.exportProperty(box2d.b2Profile.prototype,"step",box2d.b2Profile.prototype.step);box2d.b2Profile.prototype.collide=0;goog.exportProperty(box2d.b2Profile.prototype,"collide",box2d.b2Profile.prototype.collide);box2d.b2Profile.prototype.solve=0;goog.exportProperty(box2d.b2Profile.prototype,"solve",box2d.b2Profile.prototype.solve);box2d.b2Profile.prototype.solveInit=0;goog.exportProperty(box2d.b2Profile.prototype,"solveInit",box2d.b2Profile.prototype.solveInit);box2d.b2Profile.prototype.solveVelocity=0;goog.exportProperty(box2d.b2Profile.prototype,"solveVelocity",box2d.b2Profile.prototype.solveVelocity);box2d.b2Profile.prototype.solvePosition=0;goog.exportProperty(box2d.b2Profile.prototype,"solvePosition",box2d.b2Profile.prototype.solvePosition);box2d.b2Profile.prototype.broadphase=0;goog.exportProperty(box2d.b2Profile.prototype,"broadphase",box2d.b2Profile.prototype.broadphase);box2d.b2Profile.prototype.solveTOI=0;goog.exportProperty(box2d.b2Profile.prototype,"solveTOI",box2d.b2Profile.prototype.solveTOI);box2d.b2Profile.prototype.Reset=function(){this.solveTOI=this.broadphase=this.solvePosition=this.solveVelocity=this.solveInit=this.solve=this.collide=this.step=0;return this};goog.exportProperty(box2d.b2Profile.prototype,"Reset",box2d.b2Profile.prototype.Reset);box2d.b2TimeStep=function(){};goog.exportSymbol("box2d.b2TimeStep",box2d.b2TimeStep);box2d.b2TimeStep.prototype.dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dt",box2d.b2TimeStep.prototype.dt);box2d.b2TimeStep.prototype.inv_dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"inv_dt",box2d.b2TimeStep.prototype.inv_dt);box2d.b2TimeStep.prototype.dtRatio=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dtRatio",box2d.b2TimeStep.prototype.dtRatio);box2d.b2TimeStep.prototype.velocityIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"velocityIterations",box2d.b2TimeStep.prototype.velocityIterations);box2d.b2TimeStep.prototype.positionIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"positionIterations",box2d.b2TimeStep.prototype.positionIterations);box2d.b2TimeStep.prototype.particleIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"particleIterations",box2d.b2TimeStep.prototype.particleIterations);box2d.b2TimeStep.prototype.warmStarting=!1;goog.exportProperty(box2d.b2TimeStep.prototype,"warmStarting",box2d.b2TimeStep.prototype.warmStarting);box2d.b2TimeStep.prototype.Copy=function(t){this.dt=t.dt;this.inv_dt=t.inv_dt;this.dtRatio=t.dtRatio;this.positionIterations=t.positionIterations;this.velocityIterations=t.velocityIterations;this.particleIterations=t.particleIterations;this.warmStarting=t.warmStarting;return this};goog.exportProperty(box2d.b2TimeStep.prototype,"Copy",box2d.b2TimeStep.prototype.Copy);box2d.b2Position=function(){this.c=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Position",box2d.b2Position);box2d.b2Position.prototype.c=null;goog.exportProperty(box2d.b2Position.prototype,"c",box2d.b2Position.prototype.c);box2d.b2Position.prototype.a=0;goog.exportProperty(box2d.b2Position.prototype,"a",box2d.b2Position.prototype.a);box2d.b2Position.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2Position})};goog.exportProperty(box2d.b2Position,"MakeArray",box2d.b2Position.MakeArray);box2d.b2Velocity=function(){this.v=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Velocity",box2d.b2Velocity);box2d.b2Velocity.prototype.v=null;goog.exportProperty(box2d.b2Velocity.prototype,"v",box2d.b2Velocity.prototype.v);box2d.b2Velocity.prototype.w=0;goog.exportProperty(box2d.b2Velocity.prototype,"w",box2d.b2Velocity.prototype.w);box2d.b2Velocity.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2Velocity})};goog.exportProperty(box2d.b2Velocity,"MakeArray",box2d.b2Velocity.MakeArray);box2d.b2SolverData=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2SolverData",box2d.b2SolverData);box2d.b2SolverData.prototype.step=null;goog.exportProperty(box2d.b2SolverData.prototype,"step",box2d.b2SolverData.prototype.step);box2d.b2SolverData.prototype.positions=null;goog.exportProperty(box2d.b2SolverData.prototype,"positions",box2d.b2SolverData.prototype.positions);box2d.b2SolverData.prototype.velocities=null;goog.exportProperty(box2d.b2SolverData.prototype,"velocities",box2d.b2SolverData.prototype.velocities);box2d.b2WorldCallbacks={};box2d.b2DestructionListener=function(){};goog.exportSymbol("box2d.b2DestructionListener",box2d.b2DestructionListener);box2d.b2DestructionListener.prototype.SayGoodbyeJoint=function(t){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeJoint",box2d.b2DestructionListener.prototype.SayGoodbyeJoint);box2d.b2DestructionListener.prototype.SayGoodbyeFixture=function(t){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeFixture",box2d.b2DestructionListener.prototype.SayGoodbyeFixture);box2d.b2DestructionListener.prototype.SayGoodbyeParticleGroup=function(t){};box2d.b2DestructionListener.prototype.SayGoodbyeParticle=function(t,e){};box2d.b2ContactFilter=function(){};goog.exportSymbol("box2d.b2ContactFilter",box2d.b2ContactFilter);box2d.b2ContactFilter.prototype.ShouldCollide=function(t,e){var o=t.GetBody(),i=e.GetBody();if(i.GetType()===box2d.b2BodyType.b2_staticBody&&o.GetType()===box2d.b2BodyType.b2_staticBody||!1===i.ShouldCollideConnected(o))return!1;o=t.GetFilterData();i=e.GetFilterData();return o.groupIndex===i.groupIndex&&0!==o.groupIndex?0<o.groupIndex:0!==(o.maskBits&i.categoryBits)&&0!==(o.categoryBits&i.maskBits)};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollide",box2d.b2ContactFilter.prototype.ShouldCollide);box2d.b2ContactFilter.prototype.ShouldCollideFixtureParticle=function(t,e,o){return!0};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollideFixtureParticle",box2d.b2ContactFilter.prototype.ShouldCollideFixtureParticle);box2d.b2ContactFilter.prototype.ShouldCollideParticleParticle=function(t,e,o){return!0};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollideParticleParticle",box2d.b2ContactFilter.prototype.ShouldCollideParticleParticle);box2d.b2ContactFilter.b2_defaultFilter=new box2d.b2ContactFilter;box2d.b2ContactImpulse=function(){this.normalImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints);this.tangentImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2ContactImpulse",box2d.b2ContactImpulse);box2d.b2ContactImpulse.prototype.normalImpulses=null;goog.exportProperty(box2d.b2ContactImpulse.prototype,"normalImpulses",box2d.b2ContactImpulse.prototype.normalImpulses);box2d.b2ContactImpulse.prototype.tangentImpulses=null;goog.exportProperty(box2d.b2ContactImpulse.prototype,"tangentImpulses",box2d.b2ContactImpulse.prototype.tangentImpulses);box2d.b2ContactImpulse.prototype.count=0;goog.exportProperty(box2d.b2ContactImpulse.prototype,"count",box2d.b2ContactImpulse.prototype.count);box2d.b2ContactListener=function(){};goog.exportSymbol("box2d.b2ContactListener",box2d.b2ContactListener);box2d.b2ContactListener.prototype.BeginContact=function(t){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContact",box2d.b2ContactListener.prototype.BeginContact);box2d.b2ContactListener.prototype.EndContact=function(t){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContact",box2d.b2ContactListener.prototype.EndContact);box2d.b2ContactListener.prototype.BeginContactFixtureParticle=function(t,e){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContactFixtureParticle",box2d.b2ContactListener.prototype.BeginContactFixtureParticle);box2d.b2ContactListener.prototype.EndContactFixtureParticle=function(t,e,o){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContactFixtureParticle",box2d.b2ContactListener.prototype.EndContactFixtureParticle);box2d.b2ContactListener.prototype.BeginContactParticleParticle=function(t,e){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContactParticleParticle",box2d.b2ContactListener.prototype.BeginContactParticleParticle);box2d.b2ContactListener.prototype.EndContactParticleParticle=function(t,e,o){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContactParticleParticle",box2d.b2ContactListener.prototype.EndContactParticleParticle);box2d.b2ContactListener.prototype.PreSolve=function(t,e){};goog.exportProperty(box2d.b2ContactListener.prototype,"PreSolve",box2d.b2ContactListener.prototype.PreSolve);box2d.b2ContactListener.prototype.PostSolve=function(t,e){};goog.exportProperty(box2d.b2ContactListener.prototype,"PostSolve",box2d.b2ContactListener.prototype.PostSolve);box2d.b2ContactListener.b2_defaultListener=new box2d.b2ContactListener;goog.exportProperty(box2d.b2ContactListener,"b2_defaultListener",box2d.b2ContactListener.b2_defaultListener);box2d.b2QueryCallback=function(){};goog.exportSymbol("box2d.b2QueryCallback",box2d.b2QueryCallback);box2d.b2QueryCallback.prototype.ReportFixture=function(t){return!0};goog.exportProperty(box2d.b2QueryCallback.prototype,"ReportFixture",box2d.b2QueryCallback.prototype.ReportFixture);box2d.b2QueryCallback.prototype.ReportParticle=function(t,e){return!1};goog.exportProperty(box2d.b2QueryCallback.prototype,"ReportParticle",box2d.b2QueryCallback.prototype.ReportParticle);box2d.b2QueryCallback.prototype.ShouldQueryParticleSystem=function(t){return!0};goog.exportProperty(box2d.b2QueryCallback.prototype,"ShouldQueryParticleSystem",box2d.b2QueryCallback.prototype.ShouldQueryParticleSystem);box2d.b2RayCastCallback=function(){};goog.exportSymbol("box2d.b2RayCastCallback",box2d.b2RayCastCallback);box2d.b2RayCastCallback.prototype.ReportFixture=function(t,e,o,i){return i};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ReportFixture",box2d.b2RayCastCallback.prototype.ReportFixture);box2d.b2RayCastCallback.prototype.ReportParticle=function(t,e,o,i,a){return 0};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ReportParticle",box2d.b2RayCastCallback.prototype.ReportParticle);box2d.b2RayCastCallback.prototype.ShouldQueryParticleSystem=function(t){return!0};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ShouldQueryParticleSystem",box2d.b2RayCastCallback.prototype.ShouldQueryParticleSystem);box2d.b2MixFriction=function(t,e){return box2d.b2Sqrt(t*e)};goog.exportSymbol("box2d.b2MixFriction",box2d.b2MixFriction);box2d.b2MixRestitution=function(t,e){return t>e?t:e};goog.exportSymbol("box2d.b2MixRestitution",box2d.b2MixRestitution);box2d.b2ContactEdge=function(){};goog.exportSymbol("box2d.b2ContactEdge",box2d.b2ContactEdge);box2d.b2ContactEdge.prototype.other=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"other",box2d.b2ContactEdge.prototype.other);box2d.b2ContactEdge.prototype.contact=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"contact",box2d.b2ContactEdge.prototype.contact);box2d.b2ContactEdge.prototype.prev=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"prev",box2d.b2ContactEdge.prototype.prev);box2d.b2ContactEdge.prototype.next=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"next",box2d.b2ContactEdge.prototype.next);box2d.b2Contact=function(){this.m_nodeA=new box2d.b2ContactEdge;this.m_nodeB=new box2d.b2ContactEdge;this.m_manifold=new box2d.b2Manifold;this.m_oldManifold=new box2d.b2Manifold};goog.exportSymbol("box2d.b2Contact",box2d.b2Contact);box2d.b2Contact.prototype.m_flag_islandFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_islandFlag",box2d.b2Contact.prototype.m_flag_islandFlag);box2d.b2Contact.prototype.m_flag_touchingFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_touchingFlag",box2d.b2Contact.prototype.m_flag_touchingFlag);box2d.b2Contact.prototype.m_flag_enabledFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_enabledFlag",box2d.b2Contact.prototype.m_flag_enabledFlag);box2d.b2Contact.prototype.m_flag_filterFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_filterFlag",box2d.b2Contact.prototype.m_flag_filterFlag);box2d.b2Contact.prototype.m_flag_bulletHitFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_bulletHitFlag",box2d.b2Contact.prototype.m_flag_bulletHitFlag);box2d.b2Contact.prototype.m_flag_toiFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_toiFlag",box2d.b2Contact.prototype.m_flag_toiFlag);box2d.b2Contact.prototype.m_prev=null;goog.exportProperty(box2d.b2Contact.prototype,"m_prev",box2d.b2Contact.prototype.m_prev);box2d.b2Contact.prototype.m_next=null;goog.exportProperty(box2d.b2Contact.prototype,"m_next",box2d.b2Contact.prototype.m_next);box2d.b2Contact.prototype.m_nodeA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeA",box2d.b2Contact.prototype.m_nodeA);box2d.b2Contact.prototype.m_nodeB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeB",box2d.b2Contact.prototype.m_nodeB);box2d.b2Contact.prototype.m_fixtureA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureA",box2d.b2Contact.prototype.m_fixtureA);box2d.b2Contact.prototype.m_fixtureB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureB",box2d.b2Contact.prototype.m_fixtureB);box2d.b2Contact.prototype.m_indexA=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexA",box2d.b2Contact.prototype.m_indexA);box2d.b2Contact.prototype.m_indexB=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexB",box2d.b2Contact.prototype.m_indexB);box2d.b2Contact.prototype.m_manifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_manifold",box2d.b2Contact.prototype.m_manifold);box2d.b2Contact.prototype.m_toiCount=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toiCount",box2d.b2Contact.prototype.m_toiCount);box2d.b2Contact.prototype.m_toi=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toi",box2d.b2Contact.prototype.m_toi);box2d.b2Contact.prototype.m_friction=0;goog.exportProperty(box2d.b2Contact.prototype,"m_friction",box2d.b2Contact.prototype.m_friction);box2d.b2Contact.prototype.m_restitution=0;goog.exportProperty(box2d.b2Contact.prototype,"m_restitution",box2d.b2Contact.prototype.m_restitution);box2d.b2Contact.prototype.m_tangentSpeed=0;goog.exportProperty(box2d.b2Contact.prototype,"m_tangentSpeed",box2d.b2Contact.prototype.m_tangentSpeed);box2d.b2Contact.prototype.m_oldManifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_oldManifold",box2d.b2Contact.prototype.m_oldManifold);box2d.b2Contact.prototype.GetManifold=function(){return this.m_manifold};goog.exportProperty(box2d.b2Contact.prototype,"GetManifold",box2d.b2Contact.prototype.GetManifold);box2d.b2Contact.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),o=this.m_fixtureB.GetBody(),i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),i.m_radius,o.GetTransform(),a.m_radius)};goog.exportProperty(box2d.b2Contact.prototype,"GetWorldManifold",box2d.b2Contact.prototype.GetWorldManifold);box2d.b2Contact.prototype.IsTouching=function(){return this.m_flag_touchingFlag};goog.exportProperty(box2d.b2Contact.prototype,"IsTouching",box2d.b2Contact.prototype.IsTouching);box2d.b2Contact.prototype.SetEnabled=function(t){this.m_flag_enabledFlag=t};goog.exportProperty(box2d.b2Contact.prototype,"SetEnabled",box2d.b2Contact.prototype.SetEnabled);box2d.b2Contact.prototype.IsEnabled=function(){return this.m_flag_enabledFlag};goog.exportProperty(box2d.b2Contact.prototype,"IsEnabled",box2d.b2Contact.prototype.IsEnabled);box2d.b2Contact.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Contact.prototype,"GetNext",box2d.b2Contact.prototype.GetNext);box2d.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA};goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureA",box2d.b2Contact.prototype.GetFixtureA);box2d.b2Contact.prototype.GetChildIndexA=function(){return this.m_indexA};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexA",box2d.b2Contact.prototype.GetChildIndexA);box2d.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB};goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureB",box2d.b2Contact.prototype.GetFixtureB);box2d.b2Contact.prototype.GetChildIndexB=function(){return this.m_indexB};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexB",box2d.b2Contact.prototype.GetChildIndexB);box2d.b2Contact.prototype.Evaluate=function(t,e,o){};goog.exportProperty(box2d.b2Contact.prototype,"Evaluate",box2d.b2Contact.prototype.Evaluate);box2d.b2Contact.prototype.FlagForFiltering=function(){this.m_flag_filterFlag=!0};goog.exportProperty(box2d.b2Contact.prototype,"FlagForFiltering",box2d.b2Contact.prototype.FlagForFiltering);box2d.b2Contact.prototype.SetFriction=function(t){this.m_friction=t};goog.exportProperty(box2d.b2Contact.prototype,"SetFriction",box2d.b2Contact.prototype.SetFriction);box2d.b2Contact.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Contact.prototype,"GetFriction",box2d.b2Contact.prototype.GetFriction);box2d.b2Contact.prototype.ResetFriction=function(){this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)};goog.exportProperty(box2d.b2Contact.prototype,"ResetFriction",box2d.b2Contact.prototype.ResetFriction);box2d.b2Contact.prototype.SetRestitution=function(t){this.m_restitution=t};goog.exportProperty(box2d.b2Contact.prototype,"SetRestitution",box2d.b2Contact.prototype.SetRestitution);box2d.b2Contact.prototype.GetRestitution=function(){return this.m_restitution};goog.exportProperty(box2d.b2Contact.prototype,"GetRestitution",box2d.b2Contact.prototype.GetRestitution);box2d.b2Contact.prototype.ResetRestitution=function(){this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"ResetRestitution",box2d.b2Contact.prototype.ResetRestitution);box2d.b2Contact.prototype.SetTangentSpeed=function(t){this.m_tangentSpeed=t};goog.exportProperty(box2d.b2Contact.prototype,"SetTangentSpeed",box2d.b2Contact.prototype.SetTangentSpeed);box2d.b2Contact.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed};goog.exportProperty(box2d.b2Contact.prototype,"GetTangentSpeed",box2d.b2Contact.prototype.GetTangentSpeed);box2d.b2Contact.prototype.Reset=function(t,e,o,i){this.m_flag_touchingFlag=this.m_flag_islandFlag=!1;this.m_flag_enabledFlag=!0;this.m_flag_toiFlag=this.m_flag_bulletHitFlag=this.m_flag_filterFlag=!1;this.m_fixtureA=t;this.m_fixtureB=o;this.m_indexA=e;this.m_indexB=i;this.m_manifold.pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null;this.m_toiCount=0;this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction);this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"Reset",box2d.b2Contact.prototype.Reset);box2d.b2Contact.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=e;this.m_flag_enabledFlag=!0;var o=!1,e=this.m_flag_touchingFlag,i=this.m_fixtureA.IsSensor(),a=this.m_fixtureB.IsSensor(),i=i||a,a=this.m_fixtureA.GetBody(),r=this.m_fixtureB.GetBody(),o=a.GetTransform(),s=r.GetTransform();if(i)a=this.m_fixtureA.GetShape(),r=this.m_fixtureB.GetShape(),o=box2d.b2TestOverlap_Shape(a,this.m_indexA,r,this.m_indexB,o,s),this.m_manifold.pointCount=0;else{this.Evaluate(this.m_manifold,o,s);o=0<this.m_manifold.pointCount;for(s=0;s<this.m_manifold.pointCount;++s){var n=this.m_manifold.points[s];n.normalImpulse=0;n.tangentImpulse=0;for(var b=n.id,x=0;x<this.m_oldManifold.pointCount;++x){var l=this.m_oldManifold.points[x];if(l.id.key===b.key){n.normalImpulse=l.normalImpulse;n.tangentImpulse=l.tangentImpulse;break}}}o!==e&&(a.SetAwake(!0),r.SetAwake(!0))}this.m_flag_touchingFlag=o;!e&&o&&t&&t.BeginContact(this);e&&!o&&t&&t.EndContact(this);!i&&o&&t&&t.PreSolve(this,this.m_oldManifold)};goog.exportProperty(box2d.b2Contact.prototype,"Update",box2d.b2Contact.prototype.Update);box2d.b2Contact.prototype.ComputeTOI=function(t,e){var o=box2d.b2Contact.prototype.ComputeTOI.s_input;o.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA);o.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB);o.sweepA.Copy(t);o.sweepB.Copy(e);o.tMax=box2d.b2_linearSlop;var i=box2d.b2Contact.prototype.ComputeTOI.s_output;box2d.b2TimeOfImpact(i,o);return i.t};goog.exportProperty(box2d.b2Contact.prototype,"ComputeTOI",box2d.b2Contact.prototype.ComputeTOI);box2d.b2Contact.prototype.ComputeTOI.s_input=new box2d.b2TOIInput;box2d.b2Contact.prototype.ComputeTOI.s_output=new box2d.b2TOIOutput;box2d.b2ChainAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndCircleContact",box2d.b2ChainAndCircleContact);box2d.b2ChainAndCircleContact.Create=function(t){return new box2d.b2ChainAndCircleContact};goog.exportProperty(box2d.b2ChainAndCircleContact,"Create",box2d.b2ChainAndCircleContact.Create);box2d.b2ChainAndCircleContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2ChainAndCircleContact,"Destroy",box2d.b2ChainAndCircleContact.Destroy);box2d.b2ChainAndCircleContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);var r=box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge;(i instanceof box2d.b2ChainShape?i:null).GetChildEdge(r,this.m_indexA);box2d.b2CollideEdgeAndCircle(t,r,e,a instanceof box2d.b2CircleShape?a:null,o)};goog.exportProperty(box2d.b2ChainAndCircleContact.prototype,"Evaluate",box2d.b2ChainAndCircleContact.prototype.Evaluate);box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2ChainAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndPolygonContact",box2d.b2ChainAndPolygonContact);box2d.b2ChainAndPolygonContact.Create=function(t){return new box2d.b2ChainAndPolygonContact};goog.exportProperty(box2d.b2ChainAndPolygonContact,"Create",box2d.b2ChainAndPolygonContact.Create);box2d.b2ChainAndPolygonContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2ChainAndPolygonContact,"Destroy",box2d.b2ChainAndPolygonContact.Destroy);box2d.b2ChainAndPolygonContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);var r=box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge;(i instanceof box2d.b2ChainShape?i:null).GetChildEdge(r,this.m_indexA);box2d.b2CollideEdgeAndPolygon(t,r,e,a instanceof box2d.b2PolygonShape?a:null,o)};goog.exportProperty(box2d.b2ChainAndPolygonContact.prototype,"Evaluate",box2d.b2ChainAndPolygonContact.prototype.Evaluate);box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2CircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2CircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2CircleContact",box2d.b2CircleContact);box2d.b2CircleContact.Create=function(t){return new box2d.b2CircleContact};goog.exportProperty(box2d.b2CircleContact,"Create",box2d.b2CircleContact.Create);box2d.b2CircleContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2CircleContact,"Destroy",box2d.b2CircleContact.Destroy);box2d.b2CircleContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2CircleShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);box2d.b2CollideCircles(t,i instanceof box2d.b2CircleShape?i:null,e,a instanceof box2d.b2CircleShape?a:null,o)};goog.exportProperty(box2d.b2CircleContact.prototype,"Evaluate",box2d.b2CircleContact.prototype.Evaluate);box2d.b2ContactRegister=function(){};goog.exportSymbol("box2d.b2ContactRegister",box2d.b2ContactRegister);box2d.b2ContactRegister.prototype.createFcn=null;box2d.b2ContactRegister.prototype.destroyFcn=null;box2d.b2ContactRegister.prototype.primary=!1;box2d.b2ContactFactory=function(t){this.m_allocator=t;this.InitializeRegisters()};goog.exportSymbol("box2d.b2ContactFactory",box2d.b2ContactFactory);box2d.b2ContactFactory.prototype.m_allocator=null;box2d.b2ContactFactory.prototype.AddType=function(e,t,o,i){var a=box2d.b2MakeArray(256,function(t){return e()});t=function(t){return 0<a.length?a.pop():e(t)};var r=function(t,e){a.push(t)};this.m_registers[o][i].pool=a;this.m_registers[o][i].createFcn=t;this.m_registers[o][i].destroyFcn=r;this.m_registers[o][i].primary=!0;o!==i&&(this.m_registers[i][o].pool=a,this.m_registers[i][o].createFcn=t,this.m_registers[i][o].destroyFcn=r,this.m_registers[i][o].primary=!1)};goog.exportProperty(box2d.b2ContactFactory.prototype,"AddType",box2d.b2ContactFactory.prototype.AddType);box2d.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var t=0;t<box2d.b2ShapeType.e_shapeTypeCount;t++){this.m_registers[t]=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var e=0;e<box2d.b2ShapeType.e_shapeTypeCount;e++)this.m_registers[t][e]=new box2d.b2ContactRegister}this.AddType(box2d.b2CircleContact.Create,box2d.b2CircleContact.Destroy,box2d.b2ShapeType.e_circleShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonAndCircleContact.Create,box2d.b2PolygonAndCircleContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonContact.Create,box2d.b2PolygonContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2EdgeAndCircleContact.Create,box2d.b2EdgeAndCircleContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2EdgeAndPolygonContact.Create,box2d.b2EdgeAndPolygonContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2ChainAndCircleContact.Create,box2d.b2ChainAndCircleContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2ChainAndPolygonContact.Create,box2d.b2ChainAndPolygonContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_polygonShape)};goog.exportProperty(box2d.b2ContactFactory.prototype,"InitializeRegisters",box2d.b2ContactFactory.prototype.InitializeRegisters);box2d.b2ContactFactory.prototype.Create=function(t,e,o,i){var a=t.GetType(),r=o.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a&&a<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=r&&r<box2d.b2ShapeType.e_shapeTypeCount);a=this.m_registers[a][r];r=a.createFcn;return null!==r?(a.primary?(a=r(this.m_allocator),a.Reset(t,e,o,i)):(a=r(this.m_allocator),a.Reset(o,i,t,e)),a):null};goog.exportProperty(box2d.b2ContactFactory.prototype,"Create",box2d.b2ContactFactory.prototype.Create);box2d.b2ContactFactory.prototype.Destroy=function(t){var e=t.m_fixtureA,o=t.m_fixtureB;0<t.m_manifold.pointCount&&!e.IsSensor()&&!o.IsSensor()&&(e.GetBody().SetAwake(!0),o.GetBody().SetAwake(!0));e=e.GetType();o=o.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&o<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&o<box2d.b2ShapeType.e_shapeTypeCount);o=this.m_registers[e][o].destroyFcn;o(t,this.m_allocator)};goog.exportProperty(box2d.b2ContactFactory.prototype,"Destroy",box2d.b2ContactFactory.prototype.Destroy);box2d.b2ContactManager=function(){this.m_broadPhase=new box2d.b2BroadPhase;this.m_contactFactory=new box2d.b2ContactFactory(this.m_allocator)};box2d.b2ContactManager.prototype.m_broadPhase=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_broadPhase",box2d.b2ContactManager.prototype.m_broadPhase);box2d.b2ContactManager.prototype.m_contactList=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactList",box2d.b2ContactManager.prototype.m_contactList);box2d.b2ContactManager.prototype.m_contactCount=0;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactCount",box2d.b2ContactManager.prototype.m_contactCount);box2d.b2ContactManager.prototype.m_contactFilter=box2d.b2ContactFilter.b2_defaultFilter;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactFilter",box2d.b2ContactManager.prototype.m_contactFilter);box2d.b2ContactManager.prototype.m_contactListener=box2d.b2ContactListener.b2_defaultListener;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactListener",box2d.b2ContactManager.prototype.m_contactListener);box2d.b2ContactManager.prototype.m_allocator=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_allocator",box2d.b2ContactManager.prototype.m_allocator);box2d.b2ContactManager.prototype.m_contactFactory=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactFactory",box2d.b2ContactManager.prototype.m_contactFactory);box2d.b2ContactManager.prototype.Destroy=function(t){var e=t.GetFixtureA(),o=t.GetFixtureB(),e=e.GetBody(),o=o.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t);t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t===this.m_contactList&&(this.m_contactList=t.m_next);t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next);t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev);t.m_nodeA===e.m_contactList&&(e.m_contactList=t.m_nodeA.next);t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next);t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev);t.m_nodeB===o.m_contactList&&(o.m_contactList=t.m_nodeB.next);this.m_contactFactory.Destroy(t);--this.m_contactCount};goog.exportProperty(box2d.b2ContactManager.prototype,"Destroy",box2d.b2ContactManager.prototype.Destroy);box2d.b2ContactManager.prototype.Collide=function(){for(var t=this.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB(),i=t.GetChildIndexA(),a=t.GetChildIndexB(),r=e.GetBody(),s=o.GetBody();if(t.m_flag_filterFlag){if(!s.ShouldCollide(r)){e=t;t=e.m_next;this.Destroy(e);continue}if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(e,o)){e=t;t=e.m_next;this.Destroy(e);continue}t.m_flag_filterFlag=!1}r=r.IsAwake()&&r.m_type!==box2d.b2BodyType.b2_staticBody;s=s.IsAwake()&&s.m_type!==box2d.b2BodyType.b2_staticBody;r||s?this.m_broadPhase.TestOverlap(e.m_proxies[i].proxy,o.m_proxies[a].proxy)?(t.Update(this.m_contactListener),t=t.m_next):(e=t,t=e.m_next,this.Destroy(e)):t=t.m_next}};goog.exportProperty(box2d.b2ContactManager.prototype,"Collide",box2d.b2ContactManager.prototype.Collide);box2d.b2ContactManager.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this)};goog.exportProperty(box2d.b2ContactManager.prototype,"FindNewContacts",box2d.b2ContactManager.prototype.FindNewContacts);box2d.b2ContactManager.prototype.AddPair=function(t,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2FixtureProxy);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2FixtureProxy);var o=t.fixture,i=e.fixture,a=t.childIndex,r=e.childIndex,s=o.GetBody(),n=i.GetBody();if(s!==n){for(var b=n.GetContactList();b;){if(b.other===s){var x=b.contact.GetFixtureA(),l=b.contact.GetFixtureB(),_=b.contact.GetChildIndexA(),h=b.contact.GetChildIndexB();if(x===o&&l===i&&_===a&&h===r||x===i&&l===o&&_===r&&h===a)return}b=b.next}!n.ShouldCollide(s)||this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(o,i)||(a=this.m_contactFactory.Create(o,a,i,r),null!==a&&(o=a.GetFixtureA(),i=a.GetFixtureB(),s=o.m_body,n=i.m_body,a.m_prev=null,a.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=a),this.m_contactList=a,a.m_nodeA.contact=a,a.m_nodeA.other=n,a.m_nodeA.prev=null,a.m_nodeA.next=s.m_contactList,null!==s.m_contactList&&(s.m_contactList.prev=a.m_nodeA),s.m_contactList=a.m_nodeA,a.m_nodeB.contact=a,a.m_nodeB.other=s,a.m_nodeB.prev=null,a.m_nodeB.next=n.m_contactList,null!==n.m_contactList&&(n.m_contactList.prev=a.m_nodeB),n.m_contactList=a.m_nodeB,o.IsSensor()||i.IsSensor()||(s.SetAwake(!0),n.SetAwake(!0)),++this.m_contactCount))}};goog.exportProperty(box2d.b2ContactManager.prototype,"AddPair",box2d.b2ContactManager.prototype.AddPair);box2d.b2EdgeAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2EdgeAndCircleContact",box2d.b2EdgeAndCircleContact);box2d.b2EdgeAndCircleContact.Create=function(t){return new box2d.b2EdgeAndCircleContact};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Create",box2d.b2EdgeAndCircleContact.Create);box2d.b2EdgeAndCircleContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Destroy",box2d.b2EdgeAndCircleContact.Destroy);box2d.b2EdgeAndCircleContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);box2d.b2CollideEdgeAndCircle(t,i instanceof box2d.b2EdgeShape?i:null,e,a instanceof box2d.b2CircleShape?a:null,o)};goog.exportProperty(box2d.b2EdgeAndCircleContact.prototype,"Evaluate",box2d.b2EdgeAndCircleContact.prototype.Evaluate);box2d.b2EdgeAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2EdgeAndPolygonContact",box2d.b2EdgeAndPolygonContact);box2d.b2EdgeAndPolygonContact.Create=function(t){return new box2d.b2EdgeAndPolygonContact};goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Create",box2d.b2EdgeAndPolygonContact.Create);box2d.b2EdgeAndPolygonContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Destroy",box2d.b2EdgeAndPolygonContact.Destroy);box2d.b2EdgeAndPolygonContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);box2d.b2CollideEdgeAndPolygon(t,i instanceof box2d.b2EdgeShape?i:null,e,a instanceof box2d.b2PolygonShape?a:null,o)};goog.exportProperty(box2d.b2EdgeAndPolygonContact.prototype,"Evaluate",box2d.b2EdgeAndPolygonContact.prototype.Evaluate);box2d.b2PolygonAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonAndCircleContact",box2d.b2PolygonAndCircleContact);box2d.b2PolygonAndCircleContact.Create=function(t){return new box2d.b2PolygonAndCircleContact};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Create",box2d.b2PolygonAndCircleContact.Create);box2d.b2PolygonAndCircleContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Destroy",box2d.b2PolygonAndCircleContact.Destroy);box2d.b2PolygonAndCircleContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);box2d.b2CollidePolygonAndCircle(t,i instanceof box2d.b2PolygonShape?i:null,e,a instanceof box2d.b2CircleShape?a:null,o)};goog.exportProperty(box2d.b2PolygonAndCircleContact.prototype,"Evaluate",box2d.b2PolygonAndCircleContact.prototype.Evaluate);box2d.b2PolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonContact",box2d.b2PolygonContact);box2d.b2PolygonContact.Create=function(t){return new box2d.b2PolygonContact};goog.exportProperty(box2d.b2PolygonContact,"Create",box2d.b2PolygonContact.Create);box2d.b2PolygonContact.Destroy=function(t,e){};goog.exportProperty(box2d.b2PolygonContact,"Destroy",box2d.b2PolygonContact.Destroy);box2d.b2PolygonContact.prototype.Evaluate=function(t,e,o){var i=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(i instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);box2d.b2CollidePolygons(t,i instanceof box2d.b2PolygonShape?i:null,e,a instanceof box2d.b2PolygonShape?a:null,o)};goog.exportProperty(box2d.b2PolygonContact.prototype,"Evaluate",box2d.b2PolygonContact.prototype.Evaluate);box2d.g_blockSolve=!0;box2d.b2VelocityConstraintPoint=function(){this.rA=new box2d.b2Vec2;this.rB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2VelocityConstraintPoint",box2d.b2VelocityConstraintPoint);box2d.b2VelocityConstraintPoint.prototype.rA=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rA",box2d.b2VelocityConstraintPoint.prototype.rA);box2d.b2VelocityConstraintPoint.prototype.rB=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rB",box2d.b2VelocityConstraintPoint.prototype.rB);box2d.b2VelocityConstraintPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalImpulse",box2d.b2VelocityConstraintPoint.prototype.normalImpulse);box2d.b2VelocityConstraintPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentImpulse",box2d.b2VelocityConstraintPoint.prototype.tangentImpulse);box2d.b2VelocityConstraintPoint.prototype.normalMass=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalMass",box2d.b2VelocityConstraintPoint.prototype.normalMass);box2d.b2VelocityConstraintPoint.prototype.tangentMass=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentMass",box2d.b2VelocityConstraintPoint.prototype.tangentMass);box2d.b2VelocityConstraintPoint.prototype.velocityBias=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"velocityBias",box2d.b2VelocityConstraintPoint.prototype.velocityBias);box2d.b2VelocityConstraintPoint.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2VelocityConstraintPoint})};goog.exportProperty(box2d.b2VelocityConstraintPoint,"MakeArray",box2d.b2VelocityConstraintPoint.MakeArray);box2d.b2ContactVelocityConstraint=function(){this.points=box2d.b2VelocityConstraintPoint.MakeArray(box2d.b2_maxManifoldPoints);this.normal=new box2d.b2Vec2;this.tangent=new box2d.b2Vec2;this.normalMass=new box2d.b2Mat22;this.K=new box2d.b2Mat22};goog.exportSymbol("box2d.b2ContactVelocityConstraint",box2d.b2ContactVelocityConstraint);box2d.b2ContactVelocityConstraint.prototype.points=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"points",box2d.b2ContactVelocityConstraint.prototype.points);box2d.b2ContactVelocityConstraint.prototype.normal=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normal",box2d.b2ContactVelocityConstraint.prototype.normal);box2d.b2ContactVelocityConstraint.prototype.tangent=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangent",box2d.b2ContactVelocityConstraint.prototype.tangent);box2d.b2ContactVelocityConstraint.prototype.normalMass=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normalMass",box2d.b2ContactVelocityConstraint.prototype.normalMass);box2d.b2ContactVelocityConstraint.prototype.K=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"K",box2d.b2ContactVelocityConstraint.prototype.K);box2d.b2ContactVelocityConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexA",box2d.b2ContactVelocityConstraint.prototype.indexA);box2d.b2ContactVelocityConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexB",box2d.b2ContactVelocityConstraint.prototype.indexB);box2d.b2ContactVelocityConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassA",box2d.b2ContactVelocityConstraint.prototype.invMassA);box2d.b2ContactVelocityConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassB",box2d.b2ContactVelocityConstraint.prototype.invMassB);box2d.b2ContactVelocityConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIA",box2d.b2ContactVelocityConstraint.prototype.invIA);box2d.b2ContactVelocityConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIB",box2d.b2ContactVelocityConstraint.prototype.invIB);box2d.b2ContactVelocityConstraint.prototype.friction=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"friction",box2d.b2ContactVelocityConstraint.prototype.friction);box2d.b2ContactVelocityConstraint.prototype.restitution=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"restitution",box2d.b2ContactVelocityConstraint.prototype.restitution);box2d.b2ContactVelocityConstraint.prototype.tangentSpeed=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangentSpeed",box2d.b2ContactVelocityConstraint.prototype.tangentSpeed);box2d.b2ContactVelocityConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"pointCount",box2d.b2ContactVelocityConstraint.prototype.pointCount);box2d.b2ContactVelocityConstraint.prototype.contactIndex=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"contactIndex",box2d.b2ContactVelocityConstraint.prototype.contactIndex);box2d.b2ContactVelocityConstraint.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2ContactVelocityConstraint})};goog.exportProperty(box2d.b2ContactVelocityConstraint,"MakeArray",box2d.b2ContactVelocityConstraint.MakeArray);box2d.b2ContactPositionConstraint=function(){this.localPoints=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.localCenterA=new box2d.b2Vec2;this.localCenterB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ContactPositionConstraint",box2d.b2ContactPositionConstraint);box2d.b2ContactPositionConstraint.prototype.localPoints=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoints",box2d.b2ContactPositionConstraint.prototype.localPoints);box2d.b2ContactPositionConstraint.prototype.localNormal=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localNormal",box2d.b2ContactPositionConstraint.prototype.localNormal);box2d.b2ContactPositionConstraint.prototype.localPoint=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoint",box2d.b2ContactPositionConstraint.prototype.localPoint);box2d.b2ContactPositionConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexA",box2d.b2ContactPositionConstraint.prototype.indexA);box2d.b2ContactPositionConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexB",box2d.b2ContactPositionConstraint.prototype.indexB);box2d.b2ContactPositionConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassA",box2d.b2ContactPositionConstraint.prototype.invMassA);box2d.b2ContactPositionConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassB",box2d.b2ContactPositionConstraint.prototype.invMassB);box2d.b2ContactPositionConstraint.prototype.localCenterA=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterA",box2d.b2ContactPositionConstraint.prototype.localCenterA);box2d.b2ContactPositionConstraint.prototype.localCenterB=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterB",box2d.b2ContactPositionConstraint.prototype.localCenterB);box2d.b2ContactPositionConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIA",box2d.b2ContactPositionConstraint.prototype.invIA);box2d.b2ContactPositionConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIB",box2d.b2ContactPositionConstraint.prototype.invIB);box2d.b2ContactPositionConstraint.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"type",box2d.b2ContactPositionConstraint.prototype.type);box2d.b2ContactPositionConstraint.prototype.radiusA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusA",box2d.b2ContactPositionConstraint.prototype.radiusA);box2d.b2ContactPositionConstraint.prototype.radiusB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusB",box2d.b2ContactPositionConstraint.prototype.radiusB);box2d.b2ContactPositionConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"pointCount",box2d.b2ContactPositionConstraint.prototype.pointCount);box2d.b2ContactPositionConstraint.MakeArray=function(t){return box2d.b2MakeArray(t,function(t){return new box2d.b2ContactPositionConstraint})};goog.exportProperty(box2d.b2ContactPositionConstraint,"MakeArray",box2d.b2ContactPositionConstraint.MakeArray);box2d.b2ContactSolverDef=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2ContactSolverDef",box2d.b2ContactSolverDef);box2d.b2ContactSolverDef.prototype.step=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"step",box2d.b2ContactSolverDef.prototype.step);box2d.b2ContactSolverDef.prototype.contacts=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"contacts",box2d.b2ContactSolverDef.prototype.contacts);box2d.b2ContactSolverDef.prototype.count=0;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"count",box2d.b2ContactSolverDef.prototype.count);box2d.b2ContactSolverDef.prototype.positions=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"positions",box2d.b2ContactSolverDef.prototype.positions);box2d.b2ContactSolverDef.prototype.velocities=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"velocities",box2d.b2ContactSolverDef.prototype.velocities);box2d.b2ContactSolverDef.prototype.allocator=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"allocator",box2d.b2ContactSolverDef.prototype.allocator);box2d.b2ContactSolver=function(){this.m_step=new box2d.b2TimeStep;this.m_positionConstraints=box2d.b2ContactPositionConstraint.MakeArray(1024);this.m_velocityConstraints=box2d.b2ContactVelocityConstraint.MakeArray(1024)};goog.exportSymbol("box2d.b2ContactSolver",box2d.b2ContactSolver);box2d.b2ContactSolver.prototype.m_step=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_step",box2d.b2ContactSolver.prototype.m_step);box2d.b2ContactSolver.prototype.m_positions=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positions",box2d.b2ContactSolver.prototype.m_positions);box2d.b2ContactSolver.prototype.m_velocities=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocities",box2d.b2ContactSolver.prototype.m_velocities);box2d.b2ContactSolver.prototype.m_allocator=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_allocator",box2d.b2ContactSolver.prototype.m_allocator);box2d.b2ContactSolver.prototype.m_positionConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positionConstraints",box2d.b2ContactSolver.prototype.m_positionConstraints);box2d.b2ContactSolver.prototype.m_velocityConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocityConstraints",box2d.b2ContactSolver.prototype.m_velocityConstraints);box2d.b2ContactSolver.prototype.m_contacts=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_contacts",box2d.b2ContactSolver.prototype.m_contacts);box2d.b2ContactSolver.prototype.m_count=0;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_count",box2d.b2ContactSolver.prototype.m_count);box2d.b2ContactSolver.prototype.Initialize=function(t){this.m_step.Copy(t.step);this.m_allocator=t.allocator;this.m_count=t.count;if(this.m_positionConstraints.length<this.m_count){var e=box2d.b2Max(2*this.m_positionConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_positionConstraints: "+e);this.m_positionConstraints.length<e;)this.m_positionConstraints[this.m_positionConstraints.length]=new box2d.b2ContactPositionConstraint}if(this.m_velocityConstraints.length<this.m_count)for(e=box2d.b2Max(2*this.m_velocityConstraints.length,this.m_count),box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_velocityConstraints: "+e);this.m_velocityConstraints.length<e;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new box2d.b2ContactVelocityConstraint;this.m_positions=t.positions;this.m_velocities=t.velocities;this.m_contacts=t.contacts;var o,i,a,r,s,n,b,x;t=0;for(e=this.m_count;t<e;++t)for(a=this.m_contacts[t],r=a.m_fixtureA,s=a.m_fixtureB,o=r.GetShape(),i=s.GetShape(),o=o.m_radius,i=i.m_radius,n=r.GetBody(),b=s.GetBody(),s=a.GetManifold(),x=s.pointCount,box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<x),r=this.m_velocityConstraints[t],r.friction=a.m_friction,r.restitution=a.m_restitution,r.tangentSpeed=a.m_tangentSpeed,r.indexA=n.m_islandIndex,r.indexB=b.m_islandIndex,r.invMassA=n.m_invMass,r.invMassB=b.m_invMass,r.invIA=n.m_invI,r.invIB=b.m_invI,r.contactIndex=t,r.pointCount=x,r.K.SetZero(),r.normalMass.SetZero(),a=this.m_positionConstraints[t],a.indexA=n.m_islandIndex,a.indexB=b.m_islandIndex,a.invMassA=n.m_invMass,a.invMassB=b.m_invMass,a.localCenterA.Copy(n.m_sweep.localCenter),a.localCenterB.Copy(b.m_sweep.localCenter),a.invIA=n.m_invI,a.invIB=b.m_invI,a.localNormal.Copy(s.localNormal),a.localPoint.Copy(s.localPoint),a.pointCount=x,a.radiusA=o,a.radiusB=i,a.type=s.type,o=0,i=x;o<i;++o)n=s.points[o],x=r.points[o],this.m_step.warmStarting?(x.normalImpulse=this.m_step.dtRatio*n.normalImpulse,x.tangentImpulse=this.m_step.dtRatio*n.tangentImpulse):(x.normalImpulse=0,x.tangentImpulse=0),x.rA.SetZero(),x.rB.SetZero(),x.normalMass=0,x.tangentMass=0,x.velocityBias=0,a.localPoints[o].Copy(n.localPoint);return this};goog.exportProperty(box2d.b2ContactSolver.prototype,"Initialize",box2d.b2ContactSolver.prototype.Initialize);box2d.b2ContactSolver.prototype.InitializeVelocityConstraints=function(){var t,e,o,i,a,r,s,n,b,x,l,_,h,d,p,c,u,y,m,f,g=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA,v=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB,S=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold;t=0;for(e=this.m_count;t<e;++t){a=this.m_velocityConstraints[t];r=this.m_positionConstraints[t];o=r.radiusA;i=r.radiusB;s=this.m_contacts[a.contactIndex].GetManifold();n=a.indexA;b=a.indexB;x=a.invMassA;l=a.invMassB;_=a.invIA;h=a.invIB;d=r.localCenterA;p=r.localCenterB;r=this.m_positions[n].c;c=this.m_positions[n].a;u=this.m_velocities[n].v;n=this.m_velocities[n].w;y=this.m_positions[b].c;m=this.m_positions[b].a;f=this.m_velocities[b].v;b=this.m_velocities[b].w;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<s.pointCount);g.q.SetAngle(c);v.q.SetAngle(m);box2d.b2Sub_V2_V2(r,box2d.b2Mul_R_V2(g.q,d,box2d.b2Vec2.s_t0),g.p);box2d.b2Sub_V2_V2(y,box2d.b2Mul_R_V2(v.q,p,box2d.b2Vec2.s_t0),v.p);S.Initialize(s,g,o,v,i);a.normal.Copy(S.normal);box2d.b2Cross_V2_S(a.normal,1,a.tangent);i=a.pointCount;for(o=0;o<i;++o)s=a.points[o],box2d.b2Sub_V2_V2(S.points[o],r,s.rA),box2d.b2Sub_V2_V2(S.points[o],y,s.rB),d=box2d.b2Cross_V2_V2(s.rA,a.normal),p=box2d.b2Cross_V2_V2(s.rB,a.normal),d=x+l+_*d*d+h*p*p,s.normalMass=0<d?1/d:0,p=a.tangent,d=box2d.b2Cross_V2_V2(s.rA,p),p=box2d.b2Cross_V2_V2(s.rB,p),d=x+l+_*d*d+h*p*p,s.tangentMass=0<d?1/d:0,s.velocityBias=0,d=box2d.b2Dot_V2_V2(a.normal,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(f,b,s.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(u,n,s.rA,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0)),d<-box2d.b2_velocityThreshold&&(s.velocityBias+=-a.restitution*d);2===a.pointCount&&box2d.g_blockSolve&&(u=a.points[0],y=a.points[1],r=box2d.b2Cross_V2_V2(u.rA,a.normal),u=box2d.b2Cross_V2_V2(u.rB,a.normal),n=box2d.b2Cross_V2_V2(y.rA,a.normal),b=box2d.b2Cross_V2_V2(y.rB,a.normal),y=x+l+_*r*r+h*u*u,f=x+l+_*n*n+h*b*b,x=x+l+_*r*n+h*u*b,y*y<1e3*(y*f-x*x)?(a.K.ex.Set(y,x),a.K.ey.Set(x,f),a.K.GetInverse(a.normalMass)):a.pointCount=1)}};goog.exportProperty(box2d.b2ContactSolver.prototype,"InitializeVelocityConstraints",box2d.b2ContactSolver.prototype.InitializeVelocityConstraints);box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold=new box2d.b2WorldManifold;box2d.b2ContactSolver.prototype.WarmStart=function(){var t,e,o,i,a,r,s,n,b,x,l,_,h,d,p,c,u,y,m=box2d.b2ContactSolver.prototype.WarmStart.s_P;t=0;for(e=this.m_count;t<e;++t){a=this.m_velocityConstraints[t];r=a.indexA;s=a.indexB;n=a.invMassA;b=a.invIA;x=a.invMassB;l=a.invIB;i=a.pointCount;_=this.m_velocities[r].v;h=this.m_velocities[r].w;d=this.m_velocities[s].v;p=this.m_velocities[s].w;c=a.normal;u=a.tangent;for(o=0;o<i;++o)y=a.points[o],box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(y.normalImpulse,c,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(y.tangentImpulse,u,box2d.b2Vec2.s_t1),m),h-=b*box2d.b2Cross_V2_V2(y.rA,m),_.SelfMulSub(n,m),p+=l*box2d.b2Cross_V2_V2(y.rB,m),d.SelfMulAdd(x,m);this.m_velocities[r].w=h;this.m_velocities[s].w=p}};goog.exportProperty(box2d.b2ContactSolver.prototype,"WarmStart",box2d.b2ContactSolver.prototype.WarmStart);box2d.b2ContactSolver.prototype.WarmStart.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints=function(){var t,e,o,i,a,r,s,n,b,x,l,_,h,d,p,c,u,y,m,f,g=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv,v=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1,S=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2,C,P,A=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P,B=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a,w=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b,T=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x,M=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d,I=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1,D=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2,L=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2;t=0;for(e=this.m_count;t<e;++t){a=this.m_velocityConstraints[t];r=a.indexA;s=a.indexB;n=a.invMassA;b=a.invIA;x=a.invMassB;l=a.invIB;_=a.pointCount;h=this.m_velocities[r].v;d=this.m_velocities[r].w;p=this.m_velocities[s].v;c=this.m_velocities[s].w;u=a.normal;y=a.tangent;m=a.friction;box2d.ENABLE_ASSERTS&&box2d.b2Assert(1===_||2===_);o=0;for(i=_;o<i;++o)f=a.points[o],box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(p,c,f.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(h,d,f.rA,box2d.b2Vec2.s_t1),g),C=box2d.b2Dot_V2_V2(g,y)-a.tangentSpeed,C=f.tangentMass*-C,P=m*f.normalImpulse,P=box2d.b2Clamp(f.tangentImpulse+C,-P,P),C=P-f.tangentImpulse,f.tangentImpulse=P,box2d.b2Mul_S_V2(C,y,A),h.SelfMulSub(n,A),d-=b*box2d.b2Cross_V2_V2(f.rA,A),p.SelfMulAdd(x,A),c+=l*box2d.b2Cross_V2_V2(f.rB,A);if(1!==a.pointCount&&box2d.g_blockSolve)for(_=a.points[0],f=a.points[1],B.Set(_.normalImpulse,f.normalImpulse),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=B.x&&0<=B.y),box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(p,c,_.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(h,d,_.rA,box2d.b2Vec2.s_t1),v),box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(p,c,f.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(h,d,f.rA,box2d.b2Vec2.s_t1),S),o=box2d.b2Dot_V2_V2(v,u),i=box2d.b2Dot_V2_V2(S,u),w.x=o-_.velocityBias,w.y=i-f.velocityBias,w.SelfSub(box2d.b2Mul_M22_V2(a.K,B,box2d.b2Vec2.s_t0));;){box2d.b2Mul_M22_V2(a.normalMass,w,T).SelfNeg();if(0<=T.x&&0<=T.y){box2d.b2Sub_V2_V2(T,B,M);box2d.b2Mul_S_V2(M.x,u,I);box2d.b2Mul_S_V2(M.y,u,D);box2d.b2Add_V2_V2(I,D,L);h.SelfMulSub(n,L);d-=b*(box2d.b2Cross_V2_V2(_.rA,I)+box2d.b2Cross_V2_V2(f.rA,D));p.SelfMulAdd(x,L);c+=l*(box2d.b2Cross_V2_V2(_.rB,I)+box2d.b2Cross_V2_V2(f.rB,D));_.normalImpulse=T.x;f.normalImpulse=T.y;break}T.x=-_.normalMass*w.x;T.y=0;i=a.K.ex.y*T.x+w.y;if(0<=T.x&&0<=i){box2d.b2Sub_V2_V2(T,B,M);box2d.b2Mul_S_V2(M.x,u,I);box2d.b2Mul_S_V2(M.y,u,D);box2d.b2Add_V2_V2(I,D,L);h.SelfMulSub(n,L);d-=b*(box2d.b2Cross_V2_V2(_.rA,I)+box2d.b2Cross_V2_V2(f.rA,D));p.SelfMulAdd(x,L);c+=l*(box2d.b2Cross_V2_V2(_.rB,I)+box2d.b2Cross_V2_V2(f.rB,D));_.normalImpulse=T.x;f.normalImpulse=T.y;break}T.x=0;T.y=-f.normalMass*w.y;o=a.K.ey.x*T.y+w.x;if(0<=T.y&&0<=o){box2d.b2Sub_V2_V2(T,B,M);box2d.b2Mul_S_V2(M.x,u,I);box2d.b2Mul_S_V2(M.y,u,D);box2d.b2Add_V2_V2(I,D,L);h.SelfMulSub(n,L);d-=b*(box2d.b2Cross_V2_V2(_.rA,I)+box2d.b2Cross_V2_V2(f.rA,D));p.SelfMulAdd(x,L);c+=l*(box2d.b2Cross_V2_V2(_.rB,I)+box2d.b2Cross_V2_V2(f.rB,D));_.normalImpulse=T.x;f.normalImpulse=T.y;break}T.x=0;T.y=0;o=w.x;i=w.y;if(0<=o&&0<=i){box2d.b2Sub_V2_V2(T,B,M);box2d.b2Mul_S_V2(M.x,u,I);box2d.b2Mul_S_V2(M.y,u,D);box2d.b2Add_V2_V2(I,D,L);h.SelfMulSub(n,L);d-=b*(box2d.b2Cross_V2_V2(_.rA,I)+box2d.b2Cross_V2_V2(f.rA,D));p.SelfMulAdd(x,L);c+=l*(box2d.b2Cross_V2_V2(_.rB,I)+box2d.b2Cross_V2_V2(f.rB,D));_.normalImpulse=T.x;f.normalImpulse=T.y;break}break}else for(o=0;o<_;++o)f=a.points[o],box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(p,c,f.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(h,d,f.rA,box2d.b2Vec2.s_t1),g),i=box2d.b2Dot_V2_V2(g,u),C=-f.normalMass*(i-f.velocityBias),P=box2d.b2Max(f.normalImpulse+C,0),C=P-f.normalImpulse,f.normalImpulse=P,box2d.b2Mul_S_V2(C,u,A),h.SelfMulSub(n,A),d-=b*box2d.b2Cross_V2_V2(f.rA,A),p.SelfMulAdd(x,A),c+=l*box2d.b2Cross_V2_V2(f.rB,A);this.m_velocities[r].w=d;this.m_velocities[s].w=c}};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveVelocityConstraints",box2d.b2ContactSolver.prototype.SolveVelocityConstraints);box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.StoreImpulses=function(){var t,e,o,i,a,r;t=0;for(e=this.m_count;t<e;++t)for(a=this.m_velocityConstraints[t],r=this.m_contacts[a.contactIndex].GetManifold(),o=0,i=a.pointCount;o<i;++o)r.points[o].normalImpulse=a.points[o].normalImpulse,r.points[o].tangentImpulse=a.points[o].tangentImpulse};goog.exportProperty(box2d.b2ContactSolver.prototype,"StoreImpulses",box2d.b2ContactSolver.prototype.StoreImpulses);box2d.b2PositionSolverManifold=function(){this.normal=new box2d.b2Vec2;this.point=new box2d.b2Vec2};goog.exportSymbol("box2d.b2PositionSolverManifold",box2d.b2PositionSolverManifold);box2d.b2PositionSolverManifold.prototype.normal=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"normal",box2d.b2PositionSolverManifold.prototype.normal);box2d.b2PositionSolverManifold.prototype.point=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"point",box2d.b2PositionSolverManifold.prototype.point);box2d.b2PositionSolverManifold.prototype.separation=0;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"separation",box2d.b2PositionSolverManifold.prototype.separation);box2d.b2PositionSolverManifold.prototype.Initialize=function(t,e,o,i){var a=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA,r=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB,s=box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint,n=box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<t.pointCount);switch(t.type){case box2d.b2ManifoldType.e_circles:box2d.b2Mul_X_V2(e,t.localPoint,a);box2d.b2Mul_X_V2(o,t.localPoints[0],r);box2d.b2Sub_V2_V2(r,a,this.normal).SelfNormalize();box2d.b2Mid_V2_V2(a,r,this.point);this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(r,a,box2d.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB;break;case box2d.b2ManifoldType.e_faceA:box2d.b2Mul_R_V2(e.q,t.localNormal,this.normal);box2d.b2Mul_X_V2(e,t.localPoint,s);box2d.b2Mul_X_V2(o,t.localPoints[i],n);this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(n,s,box2d.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB;this.point.Copy(n);break;case box2d.b2ManifoldType.e_faceB:box2d.b2Mul_R_V2(o.q,t.localNormal,this.normal),box2d.b2Mul_X_V2(o,t.localPoint,s),box2d.b2Mul_X_V2(e,t.localPoints[i],n),this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(n,s,box2d.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB,this.point.Copy(n),this.normal.SelfNeg()}};goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"Initialize",box2d.b2PositionSolverManifold.prototype.Initialize);box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints=function(){var t,e,o,i,a,r,s,n,b,x,l,_,h,d,p,c,u,y=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA,m=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB,f=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm,g,v,S,C=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA,P=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB,A,B=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P,w=0;t=0;for(e=this.m_count;t<e;++t){a=this.m_positionConstraints[t];r=a.indexA;s=a.indexB;n=a.localCenterA;b=a.invMassA;x=a.invIA;l=a.localCenterB;_=a.invMassB;h=a.invIB;i=a.pointCount;d=this.m_positions[r].c;p=this.m_positions[r].a;c=this.m_positions[s].c;u=this.m_positions[s].a;for(o=0;o<i;++o)y.q.SetAngle(p),m.q.SetAngle(u),box2d.b2Sub_V2_V2(d,box2d.b2Mul_R_V2(y.q,n,box2d.b2Vec2.s_t0),y.p),box2d.b2Sub_V2_V2(c,box2d.b2Mul_R_V2(m.q,l,box2d.b2Vec2.s_t0),m.p),f.Initialize(a,y,m,o),g=f.normal,v=f.point,S=f.separation,box2d.b2Sub_V2_V2(v,d,C),box2d.b2Sub_V2_V2(v,c,P),w=box2d.b2Min(w,S),v=box2d.b2Clamp(box2d.b2_baumgarte*(S+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),S=box2d.b2Cross_V2_V2(C,g),A=box2d.b2Cross_V2_V2(P,g),S=b+_+x*S*S+h*A*A,v=0<S?-v/S:0,box2d.b2Mul_S_V2(v,g,B),d.SelfMulSub(b,B),p-=x*box2d.b2Cross_V2_V2(C,B),c.SelfMulAdd(_,B),u+=h*box2d.b2Cross_V2_V2(P,B);this.m_positions[r].a=p;this.m_positions[s].a=u}return w>-3*box2d.b2_linearSlop};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolvePositionConstraints",box2d.b2ContactSolver.prototype.SolvePositionConstraints);box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints=function(t,e){var o,i,a,r,s,n,b,x,l,_,h,d,p,c,u,y,m,f=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA,g=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB,v=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm,S,C,P,A=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA,B=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB,w,T=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P,M=0;o=0;for(i=this.m_count;o<i;++o){s=this.m_positionConstraints[o];n=s.indexA;b=s.indexB;x=s.localCenterA;l=s.localCenterB;r=s.pointCount;h=_=0;if(n===t||n===e)_=s.invMassA,h=s.invIA;p=d=0;if(b===t||b===e)d=s.invMassB,p=s.invIB;c=this.m_positions[n].c;u=this.m_positions[n].a;y=this.m_positions[b].c;m=this.m_positions[b].a;for(a=0;a<r;++a)f.q.SetAngle(u),g.q.SetAngle(m),box2d.b2Sub_V2_V2(c,box2d.b2Mul_R_V2(f.q,x,box2d.b2Vec2.s_t0),f.p),box2d.b2Sub_V2_V2(y,box2d.b2Mul_R_V2(g.q,l,box2d.b2Vec2.s_t0),g.p),v.Initialize(s,f,g,a),S=v.normal,C=v.point,P=v.separation,box2d.b2Sub_V2_V2(C,c,A),box2d.b2Sub_V2_V2(C,y,B),M=box2d.b2Min(M,P),C=box2d.b2Clamp(box2d.b2_toiBaumgarte*(P+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),P=box2d.b2Cross_V2_V2(A,S),w=box2d.b2Cross_V2_V2(B,S),P=_+d+h*P*P+p*w*w,C=0<P?-C/P:0,box2d.b2Mul_S_V2(C,S,T),c.SelfMulSub(_,T),u-=h*box2d.b2Cross_V2_V2(A,T),y.SelfMulAdd(d,T),m+=p*box2d.b2Cross_V2_V2(B,T);this.m_positions[n].a=u;this.m_positions[b].a=m}return M>=-1.5*box2d.b2_linearSlop};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveTOIPositionConstraints",box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints);box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P=new box2d.b2Vec2;box2d.b2Island=function(){this.m_bodies=Array(1024);this.m_contacts=Array(1024);this.m_joints=Array(1024);this.m_positions=box2d.b2Position.MakeArray(1024);this.m_velocities=box2d.b2Velocity.MakeArray(1024)};goog.exportSymbol("box2d.b2Island",box2d.b2Island);box2d.b2Island.prototype.m_allocator=null;goog.exportProperty(box2d.b2Island.prototype,"m_allocator",box2d.b2Island.prototype.m_allocator);box2d.b2Island.prototype.m_listener=null;goog.exportProperty(box2d.b2Island.prototype,"m_listener",box2d.b2Island.prototype.m_listener);box2d.b2Island.prototype.m_bodies=null;goog.exportProperty(box2d.b2Island.prototype,"m_bodies",box2d.b2Island.prototype.m_bodies);box2d.b2Island.prototype.m_contacts=null;goog.exportProperty(box2d.b2Island.prototype,"m_contacts",box2d.b2Island.prototype.m_contacts);box2d.b2Island.prototype.m_joints=null;goog.exportProperty(box2d.b2Island.prototype,"m_joints",box2d.b2Island.prototype.m_joints);box2d.b2Island.prototype.m_positions=null;goog.exportProperty(box2d.b2Island.prototype,"m_positions",box2d.b2Island.prototype.m_positions);box2d.b2Island.prototype.m_velocities=null;goog.exportProperty(box2d.b2Island.prototype,"m_velocities",box2d.b2Island.prototype.m_velocities);box2d.b2Island.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_bodyCount",box2d.b2Island.prototype.m_bodyCount);box2d.b2Island.prototype.m_jointCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCount",box2d.b2Island.prototype.m_jointCount);box2d.b2Island.prototype.m_contactCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCount",box2d.b2Island.prototype.m_contactCount);box2d.b2Island.prototype.m_bodyCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_bodyCapacity",box2d.b2Island.prototype.m_bodyCapacity);box2d.b2Island.prototype.m_contactCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCapacity",box2d.b2Island.prototype.m_contactCapacity);box2d.b2Island.prototype.m_jointCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCapacity",box2d.b2Island.prototype.m_jointCapacity);box2d.b2Island.prototype.Initialize=function(t,e,o,i,a){this.m_bodyCapacity=t;this.m_contactCapacity=e;this.m_jointCapacity=o;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=i;for(this.m_listener=a;this.m_bodies.length<t;)this.m_bodies[this.m_bodies.length]=null;for(;this.m_contacts.length<e;)this.m_contacts[this.m_contacts.length]=null;for(;this.m_joints.length<o;)this.m_joints[this.m_joints.length]=null;if(this.m_positions.length<t)for(e=box2d.b2Max(2*this.m_positions.length,t),box2d.DEBUG&&window.console.log("box2d.b2Island.m_positions: "+e);this.m_positions.length<e;)this.m_positions[this.m_positions.length]=new box2d.b2Position;if(this.m_velocities.length<t)for(e=box2d.b2Max(2*this.m_velocities.length,t),box2d.DEBUG&&window.console.log("box2d.b2Island.m_velocities: "+e);this.m_velocities.length<e;)this.m_velocities[this.m_velocities.length]=new box2d.b2Velocity};goog.exportProperty(box2d.b2Island.prototype,"Initialize",box2d.b2Island.prototype.Initialize);box2d.b2Island.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};goog.exportProperty(box2d.b2Island.prototype,"Clear",box2d.b2Island.prototype.Clear);box2d.b2Island.prototype.AddBody=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount<this.m_bodyCapacity);t.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=t};goog.exportProperty(box2d.b2Island.prototype,"AddBody",box2d.b2Island.prototype.AddBody);box2d.b2Island.prototype.AddContact=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_contactCount<this.m_contactCapacity);this.m_contacts[this.m_contactCount++]=t};goog.exportProperty(box2d.b2Island.prototype,"AddContact",box2d.b2Island.prototype.AddContact);box2d.b2Island.prototype.AddJoint=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount<this.m_jointCapacity);this.m_joints[this.m_jointCount++]=t};goog.exportProperty(box2d.b2Island.prototype,"AddJoint",box2d.b2Island.prototype.AddJoint);box2d.b2Island.prototype.Solve=function(t,e,o,i){for(var a=box2d.b2Island.s_timer.Reset(),r=e.dt,s=0;s<this.m_bodyCount;++s){var n=this.m_bodies[s],b=this.m_positions[s].c.Copy(n.m_sweep.c),x=n.m_sweep.a,l=this.m_velocities[s].v.Copy(n.m_linearVelocity),_=n.m_angularVelocity;n.m_sweep.c0.Copy(n.m_sweep.c);n.m_sweep.a0=n.m_sweep.a;n.m_type===box2d.b2BodyType.b2_dynamicBody&&(l.x+=r*(n.m_gravityScale*o.x+n.m_invMass*n.m_force.x),l.y+=r*(n.m_gravityScale*o.y+n.m_invMass*n.m_force.y),_+=r*n.m_invI*n.m_torque,l.SelfMul(1/(1+r*n.m_linearDamping)),_*=1/(1+r*n.m_angularDamping));this.m_positions[s].a=x;this.m_velocities[s].w=_}a.Reset();n=box2d.b2Island.s_solverData;n.step.Copy(e);n.positions=this.m_positions;n.velocities=this.m_velocities;s=box2d.b2Island.s_contactSolverDef;s.step.Copy(e);s.contacts=this.m_contacts;s.count=this.m_contactCount;s.positions=this.m_positions;s.velocities=this.m_velocities;s.allocator=this.m_allocator;o=box2d.b2Island.s_contactSolver.Initialize(s);o.InitializeVelocityConstraints();e.warmStarting&&o.WarmStart();for(s=0;s<this.m_jointCount;++s)this.m_joints[s].InitVelocityConstraints(n);t.solveInit=a.GetMilliseconds();a.Reset();for(s=0;s<e.velocityIterations;++s){for(x=0;x<this.m_jointCount;++x)this.m_joints[x].SolveVelocityConstraints(n);o.SolveVelocityConstraints()}o.StoreImpulses();t.solveVelocity=a.GetMilliseconds();for(s=0;s<this.m_bodyCount;++s){var b=this.m_positions[s].c,x=this.m_positions[s].a,l=this.m_velocities[s].v,_=this.m_velocities[s].w,h=box2d.b2Mul_S_V2(r,l,box2d.b2Island.s_translation);box2d.b2Dot_V2_V2(h,h)>box2d.b2_maxTranslationSquared&&(h=box2d.b2_maxTranslation/h.Length(),l.SelfMul(h));h=r*_;h*h>box2d.b2_maxRotationSquared&&(h=box2d.b2_maxRotation/box2d.b2Abs(h),_*=h);b.x+=r*l.x;b.y+=r*l.y;x+=r*_;this.m_positions[s].a=x;this.m_velocities[s].w=_}a.Reset();b=!1;for(s=0;s<e.positionIterations;++s){l=o.SolvePositionConstraints();_=!0;for(x=0;x<this.m_jointCount;++x)h=this.m_joints[x].SolvePositionConstraints(n),_=_&&h;if(l&&_){b=!0;break}}for(s=0;s<this.m_bodyCount;++s)e=this.m_bodies[s],e.m_sweep.c.Copy(this.m_positions[s].c),e.m_sweep.a=this.m_positions[s].a,e.m_linearVelocity.Copy(this.m_velocities[s].v),e.m_angularVelocity=this.m_velocities[s].w,e.SynchronizeTransform();t.solvePosition=a.GetMilliseconds();this.Report(o.m_velocityConstraints);if(i){t=box2d.b2_maxFloat;i=box2d.b2_linearSleepTolerance*box2d.b2_linearSleepTolerance;a=box2d.b2_angularSleepTolerance*box2d.b2_angularSleepTolerance;for(s=0;s<this.m_bodyCount;++s)n=this.m_bodies[s],n.GetType()!==box2d.b2BodyType.b2_staticBody&&(!n.m_flag_autoSleepFlag||n.m_angularVelocity*n.m_angularVelocity>a||box2d.b2Dot_V2_V2(n.m_linearVelocity,n.m_linearVelocity)>i?t=n.m_sleepTime=0:(n.m_sleepTime+=r,t=box2d.b2Min(t,n.m_sleepTime)));if(t>=box2d.b2_timeToSleep&&b)for(s=0;s<this.m_bodyCount;++s)n=this.m_bodies[s],n.SetAwake(!1)}};goog.exportProperty(box2d.b2Island.prototype,"Solve",box2d.b2Island.prototype.Solve);box2d.b2Island.prototype.SolveTOI=function(t,e,o){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(o<this.m_bodyCount);for(var i=0;i<this.m_bodyCount;++i){var a=this.m_bodies[i];this.m_positions[i].c.Copy(a.m_sweep.c);this.m_positions[i].a=a.m_sweep.a;this.m_velocities[i].v.Copy(a.m_linearVelocity);this.m_velocities[i].w=a.m_angularVelocity}i=box2d.b2Island.s_contactSolverDef;i.contacts=this.m_contacts;i.count=this.m_contactCount;i.allocator=this.m_allocator;i.step.Copy(t);i.positions=this.m_positions;i.velocities=this.m_velocities;a=box2d.b2Island.s_contactSolver.Initialize(i);for(i=0;i<t.positionIterations&&!a.SolveTOIPositionConstraints(e,o);++i);this.m_bodies[e].m_sweep.c0.Copy(this.m_positions[e].c);this.m_bodies[e].m_sweep.a0=this.m_positions[e].a;this.m_bodies[o].m_sweep.c0.Copy(this.m_positions[o].c);this.m_bodies[o].m_sweep.a0=this.m_positions[o].a;a.InitializeVelocityConstraints();for(i=0;i<t.velocityIterations;++i)a.SolveVelocityConstraints();t=t.dt;for(i=0;i<this.m_bodyCount;++i){e=this.m_positions[i].c;o=this.m_positions[i].a;var r=this.m_velocities[i].v,s=this.m_velocities[i].w,n=box2d.b2Mul_S_V2(t,r,box2d.b2Island.s_translation);box2d.b2Dot_V2_V2(n,n)>box2d.b2_maxTranslationSquared&&(n=box2d.b2_maxTranslation/n.Length(),r.SelfMul(n));n=t*s;n*n>box2d.b2_maxRotationSquared&&(n=box2d.b2_maxRotation/box2d.b2Abs(n),s*=n);e.SelfMulAdd(t,r);o+=t*s;this.m_positions[i].a=o;this.m_velocities[i].w=s;n=this.m_bodies[i];n.m_sweep.c.Copy(e);n.m_sweep.a=o;n.m_linearVelocity.Copy(r);n.m_angularVelocity=s;n.SynchronizeTransform()}this.Report(a.m_velocityConstraints)};goog.exportProperty(box2d.b2Island.prototype,"SolveTOI",box2d.b2Island.prototype.SolveTOI);box2d.b2Island.prototype.Report=function(t){if(null!==this.m_listener)for(var e=0;e<this.m_contactCount;++e){var o=this.m_contacts[e];if(o){var i=t[e],a=box2d.b2Island.s_impulse;a.count=i.pointCount;for(var r=0;r<i.pointCount;++r)a.normalImpulses[r]=i.points[r].normalImpulse,a.tangentImpulses[r]=i.points[r].tangentImpulse;this.m_listener.PostSolve(o,a)}}};goog.exportProperty(box2d.b2Island.prototype,"Report",box2d.b2Island.prototype.Report);box2d.b2Island.s_timer=new box2d.b2Timer;box2d.b2Island.s_solverData=new box2d.b2SolverData;box2d.b2Island.s_contactSolverDef=new box2d.b2ContactSolverDef;box2d.b2Island.s_contactSolver=new box2d.b2ContactSolver;box2d.b2Island.s_translation=new box2d.b2Vec2;box2d.b2Island.s_impulse=new box2d.b2ContactImpulse;box2d.b2JointType={e_unknownJoint:0,e_revoluteJoint:1,e_prismaticJoint:2,e_distanceJoint:3,e_pulleyJoint:4,e_mouseJoint:5,e_gearJoint:6,e_wheelJoint:7,e_weldJoint:8,e_frictionJoint:9,e_ropeJoint:10,e_motorJoint:11,e_areaJoint:12};goog.exportSymbol("box2d.b2JointType",box2d.b2JointType);goog.exportProperty(box2d.b2JointType,"e_unknownJoint",box2d.b2JointType.e_unknownJoint);goog.exportProperty(box2d.b2JointType,"e_revoluteJoint",box2d.b2JointType.e_revoluteJoint);goog.exportProperty(box2d.b2JointType,"e_prismaticJoint",box2d.b2JointType.e_prismaticJoint);goog.exportProperty(box2d.b2JointType,"e_distanceJoint",box2d.b2JointType.e_distanceJoint);goog.exportProperty(box2d.b2JointType,"e_pulleyJoint",box2d.b2JointType.e_pulleyJoint);goog.exportProperty(box2d.b2JointType,"e_mouseJoint",box2d.b2JointType.e_mouseJoint);goog.exportProperty(box2d.b2JointType,"e_gearJoint",box2d.b2JointType.e_gearJoint);goog.exportProperty(box2d.b2JointType,"e_wheelJoint",box2d.b2JointType.e_wheelJoint);goog.exportProperty(box2d.b2JointType,"e_weldJoint",box2d.b2JointType.e_weldJoint);goog.exportProperty(box2d.b2JointType,"e_frictionJoint",box2d.b2JointType.e_frictionJoint);goog.exportProperty(box2d.b2JointType,"e_ropeJoint",box2d.b2JointType.e_ropeJoint);goog.exportProperty(box2d.b2JointType,"e_motorJoint",box2d.b2JointType.e_motorJoint);goog.exportProperty(box2d.b2JointType,"e_areaJoint",box2d.b2JointType.e_areaJoint);box2d.b2LimitState={e_inactiveLimit:0,e_atLowerLimit:1,e_atUpperLimit:2,e_equalLimits:3};goog.exportSymbol("box2d.b2LimitState",box2d.b2LimitState);goog.exportProperty(box2d.b2LimitState,"e_inactiveLimit",box2d.b2LimitState.e_inactiveLimit);goog.exportProperty(box2d.b2LimitState,"e_atLowerLimit",box2d.b2LimitState.e_atLowerLimit);goog.exportProperty(box2d.b2LimitState,"e_atUpperLimit",box2d.b2LimitState.e_atUpperLimit);goog.exportProperty(box2d.b2LimitState,"e_equalLimits",box2d.b2LimitState.e_equalLimits);box2d.b2Jacobian=function(){this.linear=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Jacobian",box2d.b2Jacobian);box2d.b2Jacobian.prototype.linear=null;goog.exportProperty(box2d.b2Jacobian.prototype,"linear",box2d.b2Jacobian.prototype.linear);box2d.b2Jacobian.prototype.angularA=0;goog.exportProperty(box2d.b2Jacobian.prototype,"angularA",box2d.b2Jacobian.prototype.angularA);box2d.b2Jacobian.prototype.angularB=0;goog.exportProperty(box2d.b2Jacobian.prototype,"angularB",box2d.b2Jacobian.prototype.angularB);box2d.b2Jacobian.prototype.SetZero=function(){this.linear.SetZero();this.angularB=this.angularA=0;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"SetZero",box2d.b2Jacobian.prototype.SetZero);box2d.b2Jacobian.prototype.Set=function(t,e,o){this.linear.Copy(t);this.angularA=e;this.angularB=o;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"Set",box2d.b2Jacobian.prototype.Set);box2d.b2JointEdge=function(){};goog.exportSymbol("box2d.b2JointEdge",box2d.b2JointEdge);box2d.b2JointEdge.prototype.other=null;goog.exportProperty(box2d.b2JointEdge.prototype,"other",box2d.b2JointEdge.prototype.other);box2d.b2JointEdge.prototype.joint=null;goog.exportProperty(box2d.b2JointEdge.prototype,"joint",box2d.b2JointEdge.prototype.joint);box2d.b2JointEdge.prototype.prev=null;goog.exportProperty(box2d.b2JointEdge.prototype,"prev",box2d.b2JointEdge.prototype.prev);box2d.b2JointEdge.prototype.next=null;goog.exportProperty(box2d.b2JointEdge.prototype,"next",box2d.b2JointEdge.prototype.next);box2d.b2JointDef=function(t){this.type=t};goog.exportSymbol("box2d.b2JointDef",box2d.b2JointDef);box2d.b2JointDef.prototype.type=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2JointDef.prototype,"type",box2d.b2JointDef.prototype.type);box2d.b2JointDef.prototype.userData=null;goog.exportProperty(box2d.b2JointDef.prototype,"userData",box2d.b2JointDef.prototype.userData);box2d.b2JointDef.prototype.bodyA=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyA",box2d.b2JointDef.prototype.bodyA);box2d.b2JointDef.prototype.bodyB=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyB",box2d.b2JointDef.prototype.bodyB);box2d.b2JointDef.prototype.collideConnected=!1;goog.exportProperty(box2d.b2JointDef.prototype,"collideConnected",box2d.b2JointDef.prototype.collideConnected);box2d.b2Joint=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.bodyA!==t.bodyB);this.m_type=t.type;this.m_edgeA=new box2d.b2JointEdge;this.m_edgeB=new box2d.b2JointEdge;this.m_bodyA=t.bodyA;this.m_bodyB=t.bodyB;this.m_collideConnected=t.collideConnected;this.m_userData=t.userData};goog.exportSymbol("box2d.b2Joint",box2d.b2Joint);box2d.b2Joint.prototype.m_type=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2Joint.prototype,"m_type",box2d.b2Joint.prototype.m_type);box2d.b2Joint.prototype.m_prev=null;goog.exportProperty(box2d.b2Joint.prototype,"m_prev",box2d.b2Joint.prototype.m_prev);box2d.b2Joint.prototype.m_next=null;goog.exportProperty(box2d.b2Joint.prototype,"m_next",box2d.b2Joint.prototype.m_next);box2d.b2Joint.prototype.m_edgeA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeA",box2d.b2Joint.prototype.m_edgeA);box2d.b2Joint.prototype.m_edgeB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeB",box2d.b2Joint.prototype.m_edgeB);box2d.b2Joint.prototype.m_bodyA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyA",box2d.b2Joint.prototype.m_bodyA);box2d.b2Joint.prototype.m_bodyB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyB",box2d.b2Joint.prototype.m_bodyB);box2d.b2Joint.prototype.m_index=0;goog.exportProperty(box2d.b2Joint.prototype,"m_index",box2d.b2Joint.prototype.m_index);box2d.b2Joint.prototype.m_islandFlag=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_islandFlag",box2d.b2Joint.prototype.m_islandFlag);box2d.b2Joint.prototype.m_collideConnected=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_collideConnected",box2d.b2Joint.prototype.m_collideConnected);box2d.b2Joint.prototype.m_userData=null;goog.exportProperty(box2d.b2Joint.prototype,"m_userData",box2d.b2Joint.prototype.m_userData);box2d.b2Joint.prototype.GetAnchorA=function(t){return t.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorA",box2d.b2Joint.prototype.GetAnchorA);box2d.b2Joint.prototype.GetAnchorB=function(t){return t.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorB",box2d.b2Joint.prototype.GetAnchorB);box2d.b2Joint.prototype.GetReactionForce=function(t,e){return e.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetReactionForce",box2d.b2Joint.prototype.GetReactionForce);box2d.b2Joint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2Joint.prototype,"GetReactionTorque",box2d.b2Joint.prototype.GetReactionTorque);box2d.b2Joint.prototype.InitVelocityConstraints=function(t){};goog.exportProperty(box2d.b2Joint.prototype,"InitVelocityConstraints",box2d.b2Joint.prototype.InitVelocityConstraints);box2d.b2Joint.prototype.SolveVelocityConstraints=function(t){};goog.exportProperty(box2d.b2Joint.prototype,"SolveVelocityConstraints",box2d.b2Joint.prototype.SolveVelocityConstraints);box2d.b2Joint.prototype.SolvePositionConstraints=function(t){return!1};goog.exportProperty(box2d.b2Joint.prototype,"SolvePositionConstraints",box2d.b2Joint.prototype.SolvePositionConstraints);box2d.b2Joint.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Joint.prototype,"GetType",box2d.b2Joint.prototype.GetType);box2d.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyA",box2d.b2Joint.prototype.GetBodyA);box2d.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyB",box2d.b2Joint.prototype.GetBodyB);box2d.b2Joint.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Joint.prototype,"GetNext",box2d.b2Joint.prototype.GetNext);box2d.b2Joint.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Joint.prototype,"GetUserData",box2d.b2Joint.prototype.GetUserData);box2d.b2Joint.prototype.SetUserData=function(t){this.m_userData=t};goog.exportProperty(box2d.b2Joint.prototype,"SetUserData",box2d.b2Joint.prototype.SetUserData);box2d.b2Joint.prototype.GetCollideConnected=function(){return this.m_collideConnected};goog.exportProperty(box2d.b2Joint.prototype,"GetCollideConnected",box2d.b2Joint.prototype.GetCollideConnected);box2d.b2Joint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("// Dump is not supported for this joint type.\n")};goog.exportProperty(box2d.b2Joint.prototype,"Dump",box2d.b2Joint.prototype.Dump);box2d.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};goog.exportProperty(box2d.b2Joint.prototype,"IsActive",box2d.b2Joint.prototype.IsActive);box2d.b2Joint.prototype.ShiftOrigin=function(t){};goog.exportProperty(box2d.b2Joint.prototype,"ShiftOrigin",box2d.b2Joint.prototype.ShiftOrigin);box2d.b2AreaJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_areaJoint);this.bodies=[]};goog.inherits(box2d.b2AreaJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2AreaJointDef",box2d.b2AreaJointDef);box2d.b2AreaJointDef.prototype.world=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"world",box2d.b2AreaJointDef.prototype.world);box2d.b2AreaJointDef.prototype.bodies=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"bodies",box2d.b2AreaJointDef.prototype.bodies);box2d.b2AreaJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"frequencyHz",box2d.b2AreaJointDef.prototype.frequencyHz);box2d.b2AreaJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"dampingRatio",box2d.b2AreaJointDef.prototype.dampingRatio);box2d.b2AreaJointDef.prototype.AddBody=function(t){this.bodies.push(t);1===this.bodies.length?this.bodyA=t:2===this.bodies.length&&(this.bodyB=t)};goog.exportProperty(box2d.b2AreaJointDef.prototype,"AddBody",box2d.b2AreaJointDef.prototype.AddBody);box2d.b2AreaJoint=function(t){box2d.b2Joint.call(this,t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=t.bodies.length,"You cannot create an area joint with less than three bodies.");this.m_bodies=t.bodies;this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_targetLengths=box2d.b2MakeNumberArray(t.bodies.length);this.m_normals=box2d.b2Vec2.MakeArray(t.bodies.length);this.m_joints=Array(t.bodies.length);this.m_deltas=box2d.b2Vec2.MakeArray(t.bodies.length);this.m_delta=new box2d.b2Vec2;var e=new box2d.b2DistanceJointDef;e.frequencyHz=t.frequencyHz;e.dampingRatio=t.dampingRatio;for(var o=this.m_targetArea=0,i=this.m_bodies.length;o<i;++o){var a=this.m_bodies[o],r=this.m_bodies[(o+1)%i],s=a.GetWorldCenter(),n=r.GetWorldCenter();this.m_targetLengths[o]=box2d.b2Distance(s,n);this.m_targetArea+=box2d.b2Cross_V2_V2(s,n);e.Initialize(a,r,s,n);this.m_joints[o]=t.world.CreateJoint(e)}this.m_targetArea*=.5};goog.inherits(box2d.b2AreaJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2AreaJoint",box2d.b2AreaJoint);box2d.b2AreaJoint.prototype.m_bodies=null;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_bodies",box2d.b2AreaJoint.prototype.m_bodies);box2d.b2AreaJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_frequencyHz",box2d.b2AreaJoint.prototype.m_frequencyHz);box2d.b2AreaJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_dampingRatio",box2d.b2AreaJoint.prototype.m_dampingRatio);box2d.b2AreaJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_impulse",box2d.b2AreaJoint.prototype.m_impulse);box2d.b2AreaJoint.prototype.m_targetLengths=null;box2d.b2AreaJoint.prototype.m_targetArea=0;box2d.b2AreaJoint.prototype.m_normals=null;box2d.b2AreaJoint.prototype.m_joints=null;box2d.b2AreaJoint.prototype.m_deltas=null;box2d.b2AreaJoint.prototype.m_delta=null;box2d.b2AreaJoint.prototype.GetAnchorA=function(t){return t.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorA",box2d.b2AreaJoint.prototype.GetAnchorA);box2d.b2AreaJoint.prototype.GetAnchorB=function(t){return t.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorB",box2d.b2AreaJoint.prototype.GetAnchorB);box2d.b2AreaJoint.prototype.GetReactionForce=function(t,e){return e.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionForce",box2d.b2AreaJoint.prototype.GetReactionForce);box2d.b2AreaJoint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionTorque",box2d.b2AreaJoint.prototype.GetReactionTorque);box2d.b2AreaJoint.prototype.SetFrequency=function(t){this.m_frequencyHz=t;for(var e=0,o=this.m_joints.length;e<o;++e)this.m_joints[e].SetFrequency(t)};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetFrequency",box2d.b2AreaJoint.prototype.SetFrequency);box2d.b2AreaJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetFrequency",box2d.b2AreaJoint.prototype.GetFrequency);box2d.b2AreaJoint.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t;for(var e=0,o=this.m_joints.length;e<o;++e)this.m_joints[e].SetDampingRatio(t)};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetDampingRatio",box2d.b2AreaJoint.prototype.SetDampingRatio);box2d.b2AreaJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetDampingRatio",box2d.b2AreaJoint.prototype.GetDampingRatio);box2d.b2AreaJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Area joint dumping is not supported.\n")};goog.exportProperty(box2d.b2AreaJoint.prototype,"Dump",box2d.b2AreaJoint.prototype.Dump);box2d.b2AreaJoint.prototype.InitVelocityConstraints=function(t){for(var e=0,o=this.m_bodies.length;e<o;++e){var i=this.m_deltas[e];box2d.b2Sub_V2_V2(t.positions[this.m_bodies[(e+1)%o].m_islandIndex].c,t.positions[this.m_bodies[(e+o-1)%o].m_islandIndex].c,i)}if(t.step.warmStarting)for(this.m_impulse*=t.step.dtRatio,e=0,o=this.m_bodies.length;e<o;++e){var a=this.m_bodies[e],r=t.velocities[a.m_islandIndex].v,i=this.m_deltas[e];r.x+=a.m_invMass*i.y*.5*this.m_impulse;r.y+=a.m_invMass*-i.x*.5*this.m_impulse}else this.m_impulse=0};goog.exportProperty(box2d.b2AreaJoint.prototype,"InitVelocityConstraints",box2d.b2AreaJoint.prototype.InitVelocityConstraints);box2d.b2AreaJoint.prototype.SolveVelocityConstraints=function(t){for(var e=0,o=0,i=0,a=this.m_bodies.length;i<a;++i)var r=this.m_bodies[i],s=t.velocities[r.m_islandIndex].v,n=this.m_deltas[i],e=e+n.LengthSquared()/r.GetMass(),o=o+box2d.b2Cross_V2_V2(s,n);e=-2*o/e;this.m_impulse+=e;i=0;for(a=this.m_bodies.length;i<a;++i)r=this.m_bodies[i],s=t.velocities[r.m_islandIndex].v,n=this.m_deltas[i],s.x+=r.m_invMass*n.y*.5*e,s.y+=r.m_invMass*-n.x*.5*e};goog.exportProperty(box2d.b2AreaJoint.prototype,"SolveVelocityConstraints",box2d.b2AreaJoint.prototype.SolveVelocityConstraints);box2d.b2AreaJoint.prototype.SolvePositionConstraints=function(t){for(var e=0,o=0,i=0,a=this.m_bodies.length;i<a;++i){var r=this.m_bodies[i],r=t.positions[r.m_islandIndex].c,s=t.positions[this.m_bodies[(i+1)%a].m_islandIndex].c,n=box2d.b2Sub_V2_V2(s,r,this.m_delta),b=n.Length();b<box2d.b2_epsilon&&(b=1);this.m_normals[i].x=n.y/b;this.m_normals[i].y=-n.x/b;e+=b;o+=box2d.b2Cross_V2_V2(r,s)}e=.5*(this.m_targetArea-.5*o)/e;o=!0;i=0;for(a=this.m_bodies.length;i<a;++i)r=this.m_bodies[i],r=t.positions[r.m_islandIndex].c,n=box2d.b2Add_V2_V2(this.m_normals[i],this.m_normals[(i+1)%a],this.m_delta),n.SelfMul(e),s=n.LengthSquared(),s>box2d.b2Sq(box2d.b2_maxLinearCorrection)&&n.SelfMul(box2d.b2_maxLinearCorrection/box2d.b2Sqrt(s)),s>box2d.b2Sq(box2d.b2_linearSlop)&&(o=!1),r.x+=n.x,r.y+=n.y;return o};goog.exportProperty(box2d.b2AreaJoint.prototype,"SolvePositionConstraints",box2d.b2AreaJoint.prototype.SolvePositionConstraints);box2d.b2DistanceJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_distanceJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2DistanceJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2DistanceJointDef",box2d.b2DistanceJointDef);box2d.b2DistanceJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorA",box2d.b2DistanceJointDef.prototype.localAnchorA);box2d.b2DistanceJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorB",box2d.b2DistanceJointDef.prototype.localAnchorB);box2d.b2DistanceJointDef.prototype.length=1;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"length",box2d.b2DistanceJointDef.prototype.length);box2d.b2DistanceJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"frequencyHz",box2d.b2DistanceJointDef.prototype.frequencyHz);box2d.b2DistanceJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"dampingRatio",box2d.b2DistanceJointDef.prototype.dampingRatio);box2d.b2DistanceJointDef.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(i,this.localAnchorB);this.length=box2d.b2Distance(o,i);this.dampingRatio=this.frequencyHz=0};goog.exportProperty(box2d.b2DistanceJointDef.prototype,"Initialize",box2d.b2DistanceJointDef.prototype.Initialize);box2d.b2DistanceJoint=function(t){box2d.b2Joint.call(this,t);this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_length=t.length};goog.inherits(box2d.b2DistanceJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2DistanceJoint",box2d.b2DistanceJoint);box2d.b2DistanceJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_frequencyHz",box2d.b2DistanceJoint.prototype.m_frequencyHz);box2d.b2DistanceJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_dampingRatio",box2d.b2DistanceJoint.prototype.m_dampingRatio);box2d.b2DistanceJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_bias",box2d.b2DistanceJoint.prototype.m_bias);box2d.b2DistanceJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorA",box2d.b2DistanceJoint.prototype.m_localAnchorA);box2d.b2DistanceJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorB",box2d.b2DistanceJoint.prototype.m_localAnchorB);box2d.b2DistanceJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_gamma",box2d.b2DistanceJoint.prototype.m_gamma);box2d.b2DistanceJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_impulse",box2d.b2DistanceJoint.prototype.m_impulse);box2d.b2DistanceJoint.prototype.m_length=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_length",box2d.b2DistanceJoint.prototype.m_length);box2d.b2DistanceJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexA",box2d.b2DistanceJoint.prototype.m_indexA);box2d.b2DistanceJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexB",box2d.b2DistanceJoint.prototype.m_indexB);box2d.b2DistanceJoint.prototype.m_u=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_u",box2d.b2DistanceJoint.prototype.m_u);box2d.b2DistanceJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rA",box2d.b2DistanceJoint.prototype.m_rA);box2d.b2DistanceJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rB",box2d.b2DistanceJoint.prototype.m_rB);box2d.b2DistanceJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterA",box2d.b2DistanceJoint.prototype.m_localCenterA);box2d.b2DistanceJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterB",box2d.b2DistanceJoint.prototype.m_localCenterB);box2d.b2DistanceJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassA",box2d.b2DistanceJoint.prototype.m_invMassA);box2d.b2DistanceJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassB",box2d.b2DistanceJoint.prototype.m_invMassB);box2d.b2DistanceJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIA",box2d.b2DistanceJoint.prototype.m_invIA);box2d.b2DistanceJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIB",box2d.b2DistanceJoint.prototype.m_invIB);box2d.b2DistanceJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_mass",box2d.b2DistanceJoint.prototype.m_mass);box2d.b2DistanceJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qA",box2d.b2DistanceJoint.prototype.m_qA);box2d.b2DistanceJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qB",box2d.b2DistanceJoint.prototype.m_qB);box2d.b2DistanceJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcA",box2d.b2DistanceJoint.prototype.m_lalcA);box2d.b2DistanceJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcB",box2d.b2DistanceJoint.prototype.m_lalcB);box2d.b2DistanceJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorA",box2d.b2DistanceJoint.prototype.GetAnchorA);box2d.b2DistanceJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorB",box2d.b2DistanceJoint.prototype.GetAnchorB);box2d.b2DistanceJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionForce",box2d.b2DistanceJoint.prototype.GetReactionForce);box2d.b2DistanceJoint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionTorque",box2d.b2DistanceJoint.prototype.GetReactionTorque);box2d.b2DistanceJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorA",box2d.b2DistanceJoint.prototype.GetLocalAnchorA);box2d.b2DistanceJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorB",box2d.b2DistanceJoint.prototype.GetLocalAnchorB);box2d.b2DistanceJoint.prototype.SetLength=function(t){this.m_length=t};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetLength",box2d.b2DistanceJoint.prototype.SetLength);box2d.b2DistanceJoint.prototype.GetLength=function(){return this.m_length};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLength",box2d.b2DistanceJoint.prototype.GetLength);box2d.b2DistanceJoint.prototype.SetFrequency=function(t){this.m_frequencyHz=t};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetFrequency",box2d.b2DistanceJoint.prototype.SetFrequency);box2d.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetFrequency",box2d.b2DistanceJoint.prototype.GetFrequency);box2d.b2DistanceJoint.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetDampingRatio",box2d.b2DistanceJoint.prototype.SetDampingRatio);box2d.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetDampingRatio",box2d.b2DistanceJoint.prototype.GetDampingRatio);box2d.b2DistanceJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2DistanceJointDef*/ var jd = new box2d.b2DistanceJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.length = %.15f;\n",this.m_length);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2DistanceJoint.prototype,"Dump",box2d.b2DistanceJoint.prototype.Dump);box2d.b2DistanceJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].c,r=t.positions[this.m_indexB].a,s=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,b=this.m_qA.SetAngle(t.positions[this.m_indexA].a),r=this.m_qB.SetAngle(r);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(b,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(r,this.m_lalcB,this.m_rB);this.m_u.x=a.x+this.m_rB.x-e.x-this.m_rA.x;this.m_u.y=a.y+this.m_rB.y-e.y-this.m_rA.y;a=this.m_u.Length();a>box2d.b2_linearSlop?this.m_u.SelfMul(1/a):this.m_u.SetZero();e=box2d.b2Cross_V2_V2(this.m_rA,this.m_u);b=box2d.b2Cross_V2_V2(this.m_rB,this.m_u);e=this.m_invMassA+this.m_invIA*e*e+this.m_invMassB+this.m_invIB*b*b;this.m_mass=0!==e?1/e:0;if(0<this.m_frequencyHz){var a=a-this.m_length,b=2*box2d.b2_pi*this.m_frequencyHz,r=this.m_mass*b*b,x=t.step.dt;this.m_gamma=x*(2*this.m_mass*this.m_dampingRatio*b+x*r);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=a*x*r*this.m_gamma;e+=this.m_gamma;this.m_mass=0!==e?1/e:0}else this.m_bias=this.m_gamma=0;t.step.warmStarting?(this.m_impulse*=t.step.dtRatio,e=box2d.b2Mul_S_V2(this.m_impulse,this.m_u,box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P),o.SelfMulSub(this.m_invMassA,e),i-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,e),s.SelfMulAdd(this.m_invMassB,e),n+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,e)):this.m_impulse=0;t.velocities[this.m_indexA].w=i;t.velocities[this.m_indexB].w=n};goog.exportProperty(box2d.b2DistanceJoint.prototype,"InitVelocityConstraints",box2d.b2DistanceJoint.prototype.InitVelocityConstraints);box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA),s=box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB),r=box2d.b2Dot_V2_V2(this.m_u,box2d.b2Sub_V2_V2(s,r,box2d.b2Vec2.s_t0)),r=-this.m_mass*(r+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=r;r=box2d.b2Mul_S_V2(r,this.m_u,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P);e.SelfMulSub(this.m_invMassA,r);o-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,r);i.SelfMulAdd(this.m_invMassB,r);a+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,r);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolveVelocityConstraints",box2d.b2DistanceJoint.prototype.SolveVelocityConstraints);box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolvePositionConstraints=function(t){if(0<this.m_frequencyHz)return!0;var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a;this.m_qA.SetAngle(o);this.m_qB.SetAngle(a);var r=box2d.b2Mul_R_V2(this.m_qA,this.m_lalcA,this.m_rA),s=box2d.b2Mul_R_V2(this.m_qB,this.m_lalcB,this.m_rB),n=this.m_u;n.x=i.x+s.x-e.x-r.x;n.y=i.y+s.y-e.y-r.y;var b=this.m_u.Normalize()-this.m_length,b=box2d.b2Clamp(b,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),n=box2d.b2Mul_S_V2(-this.m_mass*b,n,box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P);e.SelfMulSub(this.m_invMassA,n);o-=this.m_invIA*box2d.b2Cross_V2_V2(r,n);i.SelfMulAdd(this.m_invMassB,n);a+=this.m_invIB*box2d.b2Cross_V2_V2(s,n);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return box2d.b2Abs(b)<box2d.b2_linearSlop};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolvePositionConstraints",box2d.b2DistanceJoint.prototype.SolvePositionConstraints);box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2FrictionJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_frictionJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2FrictionJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2FrictionJointDef",box2d.b2FrictionJointDef);box2d.b2FrictionJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorA",box2d.b2FrictionJointDef.prototype.localAnchorA);box2d.b2FrictionJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorB",box2d.b2FrictionJointDef.prototype.localAnchorB);box2d.b2FrictionJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxForce",box2d.b2FrictionJointDef.prototype.maxForce);box2d.b2FrictionJointDef.prototype.maxTorque=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxTorque",box2d.b2FrictionJointDef.prototype.maxTorque);box2d.b2FrictionJointDef.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(o,this.localAnchorB)};goog.exportProperty(box2d.b2FrictionJointDef.prototype,"Initialize",box2d.b2FrictionJointDef.prototype.Initialize);box2d.b2FrictionJoint=function(t){box2d.b2Joint.call(this,t);this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_linearImpulse=(new box2d.b2Vec2).SetZero();this.m_maxForce=t.maxForce;this.m_maxTorque=t.maxTorque;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_linearMass=(new box2d.b2Mat22).SetZero();this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2FrictionJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2FrictionJoint",box2d.b2FrictionJoint);box2d.b2FrictionJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorA",box2d.b2FrictionJoint.prototype.m_localAnchorA);box2d.b2FrictionJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorB",box2d.b2FrictionJoint.prototype.m_localAnchorB);box2d.b2FrictionJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearImpulse",box2d.b2FrictionJoint.prototype.m_linearImpulse);box2d.b2FrictionJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularImpulse",box2d.b2FrictionJoint.prototype.m_angularImpulse);box2d.b2FrictionJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxForce",box2d.b2FrictionJoint.prototype.m_maxForce);box2d.b2FrictionJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxTorque",box2d.b2FrictionJoint.prototype.m_maxTorque);box2d.b2FrictionJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexA",box2d.b2FrictionJoint.prototype.m_indexA);box2d.b2FrictionJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexB",box2d.b2FrictionJoint.prototype.m_indexB);box2d.b2FrictionJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rA",box2d.b2FrictionJoint.prototype.m_rA);box2d.b2FrictionJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rB",box2d.b2FrictionJoint.prototype.m_rB);box2d.b2FrictionJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterA",box2d.b2FrictionJoint.prototype.m_localCenterA);box2d.b2FrictionJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterB",box2d.b2FrictionJoint.prototype.m_localCenterB);box2d.b2FrictionJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassA",box2d.b2FrictionJoint.prototype.m_invMassA);box2d.b2FrictionJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassB",box2d.b2FrictionJoint.prototype.m_invMassB);box2d.b2FrictionJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIA",box2d.b2FrictionJoint.prototype.m_invIA);box2d.b2FrictionJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIB",box2d.b2FrictionJoint.prototype.m_invIB);box2d.b2FrictionJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearMass",box2d.b2FrictionJoint.prototype.m_linearMass);box2d.b2FrictionJoint.prototype.m_angularMass=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularMass",box2d.b2FrictionJoint.prototype.m_angularMass);box2d.b2FrictionJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qA",box2d.b2FrictionJoint.prototype.m_qA);box2d.b2FrictionJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qB",box2d.b2FrictionJoint.prototype.m_qB);box2d.b2FrictionJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcA",box2d.b2FrictionJoint.prototype.m_lalcA);box2d.b2FrictionJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcB",box2d.b2FrictionJoint.prototype.m_lalcB);box2d.b2FrictionJoint.prototype.m_K=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_K",box2d.b2FrictionJoint.prototype.m_K);box2d.b2FrictionJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.positions[this.m_indexB].a,a=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,s=this.m_qA.SetAngle(t.positions[this.m_indexA].a),i=this.m_qB.SetAngle(i);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);s=box2d.b2Mul_R_V2(s,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var n=box2d.b2Mul_R_V2(i,this.m_lalcB,this.m_rB),i=this.m_invMassA,b=this.m_invMassB,x=this.m_invIA,l=this.m_invIB,_=this.m_K;_.ex.x=i+b+x*s.y*s.y+l*n.y*n.y;_.ex.y=-x*s.x*s.y-l*n.x*n.y;_.ey.x=_.ex.y;_.ey.y=i+b+x*s.x*s.x+l*n.x*n.x;_.GetInverse(this.m_linearMass);this.m_angularMass=x+l;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);t.step.warmStarting?(this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio,s=this.m_linearImpulse,e.SelfMulSub(i,s),o-=x*(box2d.b2Cross_V2_V2(this.m_rA,s)+this.m_angularImpulse),a.SelfMulAdd(b,s),r+=l*(box2d.b2Cross_V2_V2(this.m_rB,s)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=r};goog.exportProperty(box2d.b2FrictionJoint.prototype,"InitVelocityConstraints",box2d.b2FrictionJoint.prototype.InitVelocityConstraints);box2d.b2FrictionJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=this.m_invMassA,s=this.m_invMassB,n=this.m_invIA,b=this.m_invIB,x=t.step.dt,l,_=-this.m_angularMass*(a-o),h=this.m_angularImpulse;l=x*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+_,-l,l);_=this.m_angularImpulse-h;o-=n*_;a+=b*_;l=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot);_=box2d.b2Mul_M22_V2(this.m_linearMass,l,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV).SelfNeg();h=box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(_);l=x*this.m_maxForce;this.m_linearImpulse.LengthSquared()>l*l&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(l));box2d.b2Sub_V2_V2(this.m_linearImpulse,h,_);e.SelfMulSub(r,_);o-=n*box2d.b2Cross_V2_V2(this.m_rA,_);i.SelfMulAdd(s,_);a+=b*box2d.b2Cross_V2_V2(this.m_rB,_);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolveVelocityConstraints",box2d.b2FrictionJoint.prototype.SolveVelocityConstraints);box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolvePositionConstraints=function(t){return!0};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolvePositionConstraints",box2d.b2FrictionJoint.prototype.SolvePositionConstraints);box2d.b2FrictionJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorA",box2d.b2FrictionJoint.prototype.GetAnchorA);box2d.b2FrictionJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorB",box2d.b2FrictionJoint.prototype.GetAnchorB);box2d.b2FrictionJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionForce",box2d.b2FrictionJoint.prototype.GetReactionForce);box2d.b2FrictionJoint.prototype.GetReactionTorque=function(t){return t*this.m_angularImpulse};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionTorque",box2d.b2FrictionJoint.prototype.GetReactionTorque);box2d.b2FrictionJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorA",box2d.b2FrictionJoint.prototype.GetLocalAnchorA);box2d.b2FrictionJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorB",box2d.b2FrictionJoint.prototype.GetLocalAnchorB);box2d.b2FrictionJoint.prototype.SetMaxForce=function(t){this.m_maxForce=t};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxForce",box2d.b2FrictionJoint.prototype.SetMaxForce);box2d.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxForce",box2d.b2FrictionJoint.prototype.GetMaxForce);box2d.b2FrictionJoint.prototype.SetMaxTorque=function(t){this.m_maxTorque=t};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxTorque",box2d.b2FrictionJoint.prototype.SetMaxTorque);box2d.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxTorque",box2d.b2FrictionJoint.prototype.GetMaxTorque);box2d.b2FrictionJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2FrictionJointDef*/ var jd = new box2d.b2FrictionJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2FrictionJoint.prototype,"Dump",box2d.b2FrictionJoint.prototype.Dump);box2d.b2JointFactory={};box2d.b2JointFactory.Create=function(t,e){var o=null;switch(t.type){case box2d.b2JointType.e_distanceJoint:o=new box2d.b2DistanceJoint(t instanceof box2d.b2DistanceJointDef?t:null);break;case box2d.b2JointType.e_mouseJoint:o=new box2d.b2MouseJoint(t instanceof box2d.b2MouseJointDef?t:null);break;case box2d.b2JointType.e_prismaticJoint:o=new box2d.b2PrismaticJoint(t instanceof box2d.b2PrismaticJointDef?t:null);break;case box2d.b2JointType.e_revoluteJoint:o=new box2d.b2RevoluteJoint(t instanceof box2d.b2RevoluteJointDef?t:null);break;case box2d.b2JointType.e_pulleyJoint:o=new box2d.b2PulleyJoint(t instanceof box2d.b2PulleyJointDef?t:null);break;case box2d.b2JointType.e_gearJoint:o=new box2d.b2GearJoint(t instanceof box2d.b2GearJointDef?t:null);break;case box2d.b2JointType.e_wheelJoint:o=new box2d.b2WheelJoint(t instanceof box2d.b2WheelJointDef?t:null);break;case box2d.b2JointType.e_weldJoint:o=new box2d.b2WeldJoint(t instanceof box2d.b2WeldJointDef?t:null);break;case box2d.b2JointType.e_frictionJoint:o=new box2d.b2FrictionJoint(t instanceof box2d.b2FrictionJointDef?t:null);break;case box2d.b2JointType.e_ropeJoint:o=new box2d.b2RopeJoint(t instanceof box2d.b2RopeJointDef?t:null);break;case box2d.b2JointType.e_motorJoint:o=new box2d.b2MotorJoint(t instanceof box2d.b2MotorJointDef?t:null);break;case box2d.b2JointType.e_areaJoint:o=new box2d.b2AreaJoint(t instanceof box2d.b2AreaJointDef?t:null);break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}return o};goog.exportSymbol("box2d.b2JointFactory.Create",box2d.b2JointFactory.Create);box2d.b2JointFactory.Destroy=function(t,e){};goog.exportSymbol("box2d.b2JointFactory.Destroy",box2d.b2JointFactory.Destroy);box2d.b2World=function(t){this.m_flag_clearForces=!0;this.m_contactManager=new box2d.b2ContactManager;this.m_gravity=t.Clone();this.m_out_gravity=new box2d.b2Vec2;this.m_allowSleep=!0;this.m_debugDraw=this.m_destructionListener=null;this.m_continuousPhysics=this.m_warmStarting=!0;this.m_subStepping=!1;this.m_stepComplete=!0;this.m_profile=new box2d.b2Profile;this.m_island=new box2d.b2Island;this.s_stack=[]};goog.exportSymbol("box2d.b2World",box2d.b2World);box2d.b2World.prototype.m_flag_newFixture=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_newFixture",box2d.b2World.prototype.m_flag_newFixture);box2d.b2World.prototype.m_flag_locked=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_locked",box2d.b2World.prototype.m_flag_locked);box2d.b2World.prototype.m_flag_clearForces=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_clearForces",box2d.b2World.prototype.m_flag_clearForces);box2d.b2World.prototype.m_contactManager=null;goog.exportProperty(box2d.b2World.prototype,"m_contactManager",box2d.b2World.prototype.m_contactManager);box2d.b2World.prototype.m_bodyList=null;goog.exportProperty(box2d.b2World.prototype,"m_bodyList",box2d.b2World.prototype.m_bodyList);box2d.b2World.prototype.m_jointList=null;goog.exportProperty(box2d.b2World.prototype,"m_jointList",box2d.b2World.prototype.m_jointList);box2d.b2World.prototype.m_particleSystemList=null;goog.exportProperty(box2d.b2World.prototype,"m_particleSystemList",box2d.b2World.prototype.m_particleSystemList);box2d.b2World.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2World.prototype,"m_bodyCount",box2d.b2World.prototype.m_bodyCount);box2d.b2World.prototype.m_jointCount=0;goog.exportProperty(box2d.b2World.prototype,"m_jointCount",box2d.b2World.prototype.m_jointCount);box2d.b2World.prototype.m_gravity=null;goog.exportProperty(box2d.b2World.prototype,"m_gravity",box2d.b2World.prototype.m_gravity);box2d.b2World.prototype.m_out_gravity=null;goog.exportProperty(box2d.b2World.prototype,"m_out_gravity",box2d.b2World.prototype.m_out_gravity);box2d.b2World.prototype.m_allowSleep=!0;goog.exportProperty(box2d.b2World.prototype,"m_allowSleep",box2d.b2World.prototype.m_allowSleep);box2d.b2World.prototype.m_destructionListener=null;goog.exportProperty(box2d.b2World.prototype,"m_destructionListener",box2d.b2World.prototype.m_destructionListener);box2d.b2World.prototype.m_debugDraw=null;goog.exportProperty(box2d.b2World.prototype,"m_debugDraw",box2d.b2World.prototype.m_debugDraw);box2d.b2World.prototype.m_inv_dt0=0;goog.exportProperty(box2d.b2World.prototype,"m_inv_dt0",box2d.b2World.prototype.m_inv_dt0);box2d.b2World.prototype.m_warmStarting=!0;goog.exportProperty(box2d.b2World.prototype,"m_warmStarting",box2d.b2World.prototype.m_warmStarting);box2d.b2World.prototype.m_continuousPhysics=!0;goog.exportProperty(box2d.b2World.prototype,"m_continuousPhysics",box2d.b2World.prototype.m_continuousPhysics);box2d.b2World.prototype.m_subStepping=!1;goog.exportProperty(box2d.b2World.prototype,"m_subStepping",box2d.b2World.prototype.m_subStepping);box2d.b2World.prototype.m_stepComplete=!0;goog.exportProperty(box2d.b2World.prototype,"m_stepComplete",box2d.b2World.prototype.m_stepComplete);box2d.b2World.prototype.m_profile=null;goog.exportProperty(box2d.b2World.prototype,"m_profile",box2d.b2World.prototype.m_profile);box2d.b2World.prototype.m_island=null;goog.exportProperty(box2d.b2World.prototype,"m_island",box2d.b2World.prototype.m_island);box2d.b2World.prototype.s_stack=null;goog.exportProperty(box2d.b2World.prototype,"s_stack",box2d.b2World.prototype.s_stack);box2d.b2World.prototype.m_controllerList=null;goog.exportProperty(box2d.b2World.prototype,"m_controllerList",box2d.b2World.prototype.m_controllerList);box2d.b2World.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2World.prototype,"m_controllerCount",box2d.b2World.prototype.m_controllerCount);box2d.b2World.prototype.SetAllowSleeping=function(t){if(t!==this.m_allowSleep&&(this.m_allowSleep=t,!this.m_allowSleep))for(t=this.m_bodyList;t;t=t.m_next)t.SetAwake(!0)};goog.exportProperty(box2d.b2World.prototype,"SetAllowSleeping",box2d.b2World.prototype.SetAllowSleeping);box2d.b2World.prototype.GetAllowSleeping=function(){return this.m_allowSleep};goog.exportProperty(box2d.b2World.prototype,"GetAllowSleeping",box2d.b2World.prototype.GetAllowSleeping);box2d.b2World.prototype.SetWarmStarting=function(t){this.m_warmStarting=t};goog.exportProperty(box2d.b2World.prototype,"SetWarmStarting",box2d.b2World.prototype.SetWarmStarting);box2d.b2World.prototype.GetWarmStarting=function(){return this.m_warmStarting};goog.exportProperty(box2d.b2World.prototype,"GetWarmStarting",box2d.b2World.prototype.GetWarmStarting);box2d.b2World.prototype.SetContinuousPhysics=function(t){this.m_continuousPhysics=t};goog.exportProperty(box2d.b2World.prototype,"SetContinuousPhysics",box2d.b2World.prototype.SetContinuousPhysics);box2d.b2World.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics};goog.exportProperty(box2d.b2World.prototype,"GetContinuousPhysics",box2d.b2World.prototype.GetContinuousPhysics);box2d.b2World.prototype.SetSubStepping=function(t){this.m_subStepping=t};goog.exportProperty(box2d.b2World.prototype,"SetSubStepping",box2d.b2World.prototype.SetSubStepping);box2d.b2World.prototype.GetSubStepping=function(){return this.m_subStepping};goog.exportProperty(box2d.b2World.prototype,"GetSubStepping",box2d.b2World.prototype.GetSubStepping);box2d.b2World.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2World.prototype,"GetBodyList",box2d.b2World.prototype.GetBodyList);box2d.b2World.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2World.prototype,"GetJointList",box2d.b2World.prototype.GetJointList);box2d.b2World.prototype.GetParticleSystemList=function(){return this.m_particleSystemList};goog.exportProperty(box2d.b2World.prototype,"GetParticleSystemList",box2d.b2World.prototype.GetParticleSystemList);box2d.b2World.prototype.GetContactList=function(){return this.m_contactManager.m_contactList};goog.exportProperty(box2d.b2World.prototype,"GetContactList",box2d.b2World.prototype.GetContactList);box2d.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount};goog.exportProperty(box2d.b2World.prototype,"GetBodyCount",box2d.b2World.prototype.GetBodyCount);box2d.b2World.prototype.GetJointCount=function(){return this.m_jointCount};goog.exportProperty(box2d.b2World.prototype,"GetJointCount",box2d.b2World.prototype.GetJointCount);box2d.b2World.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount};goog.exportProperty(box2d.b2World.prototype,"GetContactCount",box2d.b2World.prototype.GetContactCount);box2d.b2World.prototype.SetGravity=function(t,e){e=e||!0;if(this.m_gravity.x!==t.x||this.m_gravity.y!==t.y)if(this.m_gravity.Copy(t),e)for(var o=this.m_bodyList;o;o=o.m_next)o.SetAwake(!0)};goog.exportProperty(box2d.b2World.prototype,"SetGravity",box2d.b2World.prototype.SetGravity);box2d.b2World.prototype.GetGravity=function(t){t=t||this.m_out_gravity;return t.Copy(this.m_gravity)};goog.exportProperty(box2d.b2World.prototype,"GetGravity",box2d.b2World.prototype.GetGravity);box2d.b2World.prototype.IsLocked=function(){return this.m_flag_locked};goog.exportProperty(box2d.b2World.prototype,"IsLocked",box2d.b2World.prototype.IsLocked);box2d.b2World.prototype.SetAutoClearForces=function(t){this.m_flag_clearForces=t};goog.exportProperty(box2d.b2World.prototype,"SetAutoClearForces",box2d.b2World.prototype.SetAutoClearForces);box2d.b2World.prototype.GetAutoClearForces=function(){return this.m_flag_clearForces};goog.exportProperty(box2d.b2World.prototype,"GetAutoClearForces",box2d.b2World.prototype.GetAutoClearForces);box2d.b2World.prototype.GetContactManager=function(){return this.m_contactManager};goog.exportProperty(box2d.b2World.prototype,"GetContactManager",box2d.b2World.prototype.GetContactManager);box2d.b2World.prototype.GetProfile=function(){return this.m_profile};goog.exportProperty(box2d.b2World.prototype,"GetProfile",box2d.b2World.prototype.GetProfile);box2d.b2World.prototype.SetDestructionListener=function(t){this.m_destructionListener=t};goog.exportProperty(box2d.b2World.prototype,"SetDestructionListener",box2d.b2World.prototype.SetDestructionListener);box2d.b2World.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t};goog.exportProperty(box2d.b2World.prototype,"SetContactFilter",box2d.b2World.prototype.SetContactFilter);box2d.b2World.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t};goog.exportProperty(box2d.b2World.prototype,"SetContactListener",box2d.b2World.prototype.SetContactListener);box2d.b2World.prototype.SetDebugDraw=function(t){this.m_debugDraw=t};goog.exportProperty(box2d.b2World.prototype,"SetDebugDraw",box2d.b2World.prototype.SetDebugDraw);box2d.b2World.prototype.CreateBody=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;t=new box2d.b2Body(t,this);t.m_prev=null;if(t.m_next=this.m_bodyList)this.m_bodyList.m_prev=t;this.m_bodyList=t;++this.m_bodyCount;return t};goog.exportProperty(box2d.b2World.prototype,"CreateBody",box2d.b2World.prototype.CreateBody);box2d.b2World.prototype.DestroyBody=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){for(var e=t.m_jointList;e;){var o=e,e=e.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(o.joint);this.DestroyJoint(o.joint);t.m_jointList=e}t.m_jointList=null;for(e=t.m_controllerList;e;)o=e,e=e.nextController,o.controller.RemoveBody(t);for(e=t.m_contactList;e;)o=e,e=e.next,this.m_contactManager.Destroy(o.contact);t.m_contactList=null;for(e=t.m_fixtureList;e;)o=e,e=e.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(o),o.DestroyProxies(this.m_contactManager.m_broadPhase),o.Destroy(),t.m_fixtureList=e,--t.m_fixtureCount;t.m_fixtureList=null;t.m_fixtureCount=0;t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t===this.m_bodyList&&(this.m_bodyList=t.m_next);--this.m_bodyCount}};goog.exportProperty(box2d.b2World.prototype,"DestroyBody",box2d.b2World.prototype.DestroyBody);box2d.b2World.prototype.CreateJoint=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;var e=box2d.b2JointFactory.Create(t,null);e.m_prev=null;if(e.m_next=this.m_jointList)this.m_jointList.m_prev=e;this.m_jointList=e;++this.m_jointCount;e.m_edgeA.joint=e;e.m_edgeA.other=e.m_bodyB;e.m_edgeA.prev=null;if(e.m_edgeA.next=e.m_bodyA.m_jointList)e.m_bodyA.m_jointList.prev=e.m_edgeA;e.m_bodyA.m_jointList=e.m_edgeA;e.m_edgeB.joint=e;e.m_edgeB.other=e.m_bodyA;e.m_edgeB.prev=null;if(e.m_edgeB.next=e.m_bodyB.m_jointList)e.m_bodyB.m_jointList.prev=e.m_edgeB;e.m_bodyB.m_jointList=e.m_edgeB;var o=t.bodyA,i=t.bodyB;if(!t.collideConnected)for(t=i.GetContactList();t;)t.other===o&&t.contact.FlagForFiltering(),t=t.next;return e};goog.exportProperty(box2d.b2World.prototype,"CreateJoint",box2d.b2World.prototype.CreateJoint);box2d.b2World.prototype.DestroyJoint=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t===this.m_jointList&&(this.m_jointList=t.m_next);var o=t.m_bodyA,i=t.m_bodyB;o.SetAwake(!0);i.SetAwake(!0);t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next);t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev);t.m_edgeA===o.m_jointList&&(o.m_jointList=t.m_edgeA.next);t.m_edgeA.prev=null;t.m_edgeA.next=null;t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next);t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev);t.m_edgeB===i.m_jointList&&(i.m_jointList=t.m_edgeB.next);t.m_edgeB.prev=null;t.m_edgeB.next=null;box2d.b2JointFactory.Destroy(t,null);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_jointCount);--this.m_jointCount;if(!e)for(t=i.GetContactList();t;)t.other===o&&t.contact.FlagForFiltering(),t=t.next}};goog.exportProperty(box2d.b2World.prototype,"DestroyJoint",box2d.b2World.prototype.DestroyJoint);box2d.b2World.prototype.CreateParticleSystem=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;t=new box2d.b2ParticleSystem(t,this);t.m_prev=null;if(t.m_next=this.m_particleSystemList)this.m_particleSystemList.m_prev=t;return this.m_particleSystemList=t};goog.exportProperty(box2d.b2World.prototype,"CreateParticleSystem",box2d.b2World.prototype.CreateParticleSystem);box2d.b2World.prototype.DestroyParticleSystem=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());this.IsLocked()||(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_particleSystemList&&(this.m_particleSystemList=t.m_next))};goog.exportProperty(box2d.b2World.prototype,"DestroyParticleSystem",box2d.b2World.prototype.DestroyParticleSystem);box2d.b2World.prototype.Solve=function(t){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf0.Copy(e.m_xf);for(var o=this.m_controllerList;o;o=o.m_next)o.Step(t);this.m_profile.solveInit=0;this.m_profile.solveVelocity=0;this.m_profile.solvePosition=0;o=this.m_island;o.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(e=this.m_bodyList;e;e=e.m_next)e.m_flag_islandFlag=!1;for(var i=this.m_contactManager.m_contactList;i;i=i.m_next)i.m_flag_islandFlag=!1;for(i=this.m_jointList;i;i=i.m_next)i.m_islandFlag=!1;for(var i=this.m_bodyCount,a=this.s_stack,r=this.m_bodyList;r;r=r.m_next)if(!r.m_flag_islandFlag&&r.IsAwake()&&r.IsActive()&&r.GetType()!==box2d.b2BodyType.b2_staticBody){o.Clear();var s=0;a[s++]=r;for(r.m_flag_islandFlag=!0;0<s;)if(e=a[--s],box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.IsActive()),o.AddBody(e),e.SetAwake(!0),e.GetType()!==box2d.b2BodyType.b2_staticBody){for(var n=e.m_contactList;n;n=n.next){var b=n.contact;if(!b.m_flag_islandFlag&&b.IsEnabled()&&b.IsTouching()){var x=b.m_fixtureB.m_isSensor;b.m_fixtureA.m_isSensor||x||(o.AddContact(b),b.m_flag_islandFlag=!0,b=n.other,b.m_flag_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(s<i),a[s++]=b,b.m_flag_islandFlag=!0))}}for(e=e.m_jointList;e;e=e.next)e.joint.m_islandFlag||(b=e.other,b.IsActive()&&(o.AddJoint(e.joint),e.joint.m_islandFlag=!0,b.m_flag_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(s<i),a[s++]=b,b.m_flag_islandFlag=!0)))}e=new box2d.b2Profile;o.Solve(e,t,this.m_gravity,this.m_allowSleep);this.m_profile.solveInit+=e.solveInit;this.m_profile.solveVelocity+=e.solveVelocity;this.m_profile.solvePosition+=e.solvePosition;for(s=0;s<o.m_bodyCount;++s)e=o.m_bodies[s],e.GetType()===box2d.b2BodyType.b2_staticBody&&(e.m_flag_islandFlag=!1)}for(s=0;s<a.length&&a[s];++s)a[s]=null;t=new box2d.b2Timer;for(e=this.m_bodyList;e;e=e.m_next)e.m_flag_islandFlag&&e.GetType()!==box2d.b2BodyType.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts();this.m_profile.broadphase=t.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Solve",box2d.b2World.prototype.Solve);box2d.b2World.prototype.SolveTOI=function(t){var e=this.m_island;e.Initialize(2*box2d.b2_maxTOIContacts,box2d.b2_maxTOIContacts,0,null,this.m_contactManager.m_contactListener);if(this.m_stepComplete){for(var o=this.m_bodyList;o;o=o.m_next)o.m_flag_islandFlag=!1,o.m_sweep.alpha0=0;for(var i=this.m_contactManager.m_contactList;i;i=i.m_next)i.m_flag_toiFlag=i.m_flag_islandFlag=!1,i.m_toiCount=0,i.m_toi=1}for(;;){for(var a=null,o=1,i=this.m_contactManager.m_contactList;i;i=i.m_next)if(i.IsEnabled()&&!(i.m_toiCount>box2d.b2_maxSubSteps)){var r=1;if(i.m_flag_toiFlag)r=i.m_toi;else{var s=i.GetFixtureA(),n=i.GetFixtureB();if(s.IsSensor()||n.IsSensor())continue;var r=s.GetBody(),b=n.GetBody(),x=r.m_type,l=b.m_type;box2d.ENABLE_ASSERTS&&box2d.b2Assert(x!==box2d.b2BodyType.b2_staticBody||l!==box2d.b2BodyType.b2_staticBody);var _=r.IsAwake()&&x!==box2d.b2BodyType.b2_staticBody,h=b.IsAwake()&&l!==box2d.b2BodyType.b2_staticBody;if(!_&&!h)continue;x=r.IsBullet()||x!==box2d.b2BodyType.b2_dynamicBody;l=b.IsBullet()||l!==box2d.b2BodyType.b2_dynamicBody;if(!x&&!l)continue;l=r.m_sweep.alpha0;r.m_sweep.alpha0<b.m_sweep.alpha0?(l=b.m_sweep.alpha0,r.m_sweep.Advance(l)):b.m_sweep.alpha0<r.m_sweep.alpha0&&(l=r.m_sweep.alpha0,b.m_sweep.Advance(l));box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>l);_=i.GetChildIndexA();h=i.GetChildIndexB();x=box2d.b2World.prototype.SolveTOI.s_toi_input;x.proxyA.SetShape(s.GetShape(),_);x.proxyB.SetShape(n.GetShape(),h);x.sweepA.Copy(r.m_sweep);x.sweepB.Copy(b.m_sweep);x.tMax=1;r=box2d.b2World.prototype.SolveTOI.s_toi_output;box2d.b2TimeOfImpact(r,x);b=r.t;r=r.state===box2d.b2TOIOutputState.e_touching?box2d.b2Min(l+(1-l)*b,1):1;i.m_toi=r;i.m_flag_toiFlag=!0}r<o&&(a=i,o=r)}if(null===a||1-10*box2d.b2_epsilon<o){this.m_stepComplete=!0;break}s=a.GetFixtureA();n=a.GetFixtureB();r=s.GetBody();b=n.GetBody();i=box2d.b2World.prototype.SolveTOI.s_backup1.Copy(r.m_sweep);s=box2d.b2World.prototype.SolveTOI.s_backup2.Copy(b.m_sweep);r.Advance(o);b.Advance(o);a.Update(this.m_contactManager.m_contactListener);a.m_flag_toiFlag=!1;++a.m_toiCount;if(a.IsEnabled()&&a.IsTouching()){r.SetAwake(!0);b.SetAwake(!0);e.Clear();e.AddBody(r);e.AddBody(b);e.AddContact(a);r.m_flag_islandFlag=!0;b.m_flag_islandFlag=!0;a.m_flag_islandFlag=!0;for(a=0;2>a;++a)if(i=0===a?r:b,i.m_type===box2d.b2BodyType.b2_dynamicBody)for(s=i.m_contactList;s&&e.m_bodyCount!==e.m_bodyCapacity&&e.m_contactCount!==e.m_contactCapacity;s=s.next)n=s.contact,!n.m_flag_islandFlag&&(l=s.other,l.m_type!==box2d.b2BodyType.b2_dynamicBody||i.IsBullet()||l.IsBullet())&&(x=n.m_fixtureB.m_isSensor,n.m_fixtureA.m_isSensor||x||(x=box2d.b2World.prototype.SolveTOI.s_backup.Copy(l.m_sweep),l.m_flag_islandFlag||l.Advance(o),n.Update(this.m_contactManager.m_contactListener),n.IsEnabled()?n.IsTouching()?(n.m_flag_islandFlag=!0,e.AddContact(n),l.m_flag_islandFlag||(l.m_flag_islandFlag=!0,l.m_type!==box2d.b2BodyType.b2_staticBody&&l.SetAwake(!0),e.AddBody(l))):(l.m_sweep.Copy(x),l.SynchronizeTransform()):(l.m_sweep.Copy(x),l.SynchronizeTransform())));a=box2d.b2World.prototype.SolveTOI.s_subStep;a.dt=(1-o)*t.dt;a.inv_dt=1/a.dt;a.dtRatio=1;a.positionIterations=20;a.velocityIterations=t.velocityIterations;a.particleIterations=t.particleIterations;a.warmStarting=!1;e.SolveTOI(a,r.m_islandIndex,b.m_islandIndex);for(a=0;a<e.m_bodyCount;++a)if(i=e.m_bodies[a],i.m_flag_islandFlag=!1,i.m_type===box2d.b2BodyType.b2_dynamicBody)for(i.SynchronizeFixtures(),s=i.m_contactList;s;s=s.next)s.contact.m_flag_toiFlag=s.contact.m_flag_islandFlag=!1;this.m_contactManager.FindNewContacts();if(this.m_subStepping){this.m_stepComplete=!1;break}}else a.SetEnabled(!1),r.m_sweep.Copy(i),b.m_sweep.Copy(s),r.SynchronizeTransform(),b.SynchronizeTransform()}};goog.exportProperty(box2d.b2World.prototype,"SolveTOI",box2d.b2World.prototype.SolveTOI);box2d.b2World.prototype.SolveTOI.s_subStep=new box2d.b2TimeStep;box2d.b2World.prototype.SolveTOI.s_backup=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup1=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup2=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_toi_input=new box2d.b2TOIInput;box2d.b2World.prototype.SolveTOI.s_toi_output=new box2d.b2TOIOutput;box2d.b2World.prototype.Step=function(t,e,o,i){i=i||this.CalculateReasonableParticleIterations(t);var a=new box2d.b2Timer;this.m_flag_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flag_newFixture=!1);this.m_flag_locked=!0;var r=box2d.b2World.prototype.Step.s_step;r.dt=t;r.velocityIterations=e;r.positionIterations=o;r.particleIterations=i;r.inv_dt=0<t?1/t:0;r.dtRatio=this.m_inv_dt0*t;r.warmStarting=this.m_warmStarting;t=new box2d.b2Timer;this.m_contactManager.Collide();this.m_profile.collide=t.GetMilliseconds();if(this.m_stepComplete&&0<r.dt){t=new box2d.b2Timer;for(e=this.m_particleSystemList;e;e=e.m_next)e.Solve(r);this.Solve(r);this.m_profile.solve=t.GetMilliseconds()}this.m_continuousPhysics&&0<r.dt&&(t=new box2d.b2Timer,this.SolveTOI(r),this.m_profile.solveTOI=t.GetMilliseconds());0<r.dt&&(this.m_inv_dt0=r.inv_dt);this.m_flag_clearForces&&this.ClearForces();this.m_flag_locked=!1;this.m_profile.step=a.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Step",box2d.b2World.prototype.Step);box2d.b2World.prototype.Step.s_step=new box2d.b2TimeStep;box2d.b2World.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0};goog.exportProperty(box2d.b2World.prototype,"ClearForces",box2d.b2World.prototype.ClearForces);box2d.b2World.prototype.QueryAABB=function(e,t){var o=this.m_contactManager.m_broadPhase;o.Query(function(t){t=o.GetUserData(t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2FixtureProxy);t=t.fixture;return e instanceof box2d.b2QueryCallback?e.ReportFixture(t):e(t)},t);if(e instanceof box2d.b2QueryCallback)for(var i=this.m_particleSystemList;i;i=i.m_next)e.ShouldQueryParticleSystem(i)&&i.QueryAABB(e,t)};goog.exportProperty(box2d.b2World.prototype,"QueryAABB",box2d.b2World.prototype.QueryAABB);box2d.b2World.prototype.QueryShape=function(e,o,i,t){var a=this.m_contactManager.m_broadPhase,r=box2d.b2World.prototype.QueryShape.s_aabb;o.ComputeAABB(r,i,t||0);a.Query(function(t){t=a.GetUserData(t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2FixtureProxy);t=t.fixture;return box2d.b2TestOverlap_Shape(o,0,t.GetShape(),0,i,t.GetBody().GetTransform())?e instanceof box2d.b2QueryCallback?e.ReportFixture(t):e(t):!0},r);if(e instanceof box2d.b2QueryCallback)for(t=this.m_particleSystemList;t;t=t.m_next)e.ShouldQueryParticleSystem(t)&&t.QueryAABB(e,r)};goog.exportProperty(box2d.b2World.prototype,"QueryShape",box2d.b2World.prototype.QueryShape);box2d.b2World.prototype.QueryShape.s_aabb=new box2d.b2AABB;box2d.b2World.prototype.QueryPoint=function(e,o,t){var i=this.m_contactManager.m_broadPhase;t="number"===typeof t?t:box2d.b2_linearSlop;var a=box2d.b2World.prototype.QueryPoint.s_aabb;a.lowerBound.Set(o.x-t,o.y-t);a.upperBound.Set(o.x+t,o.y+t);i.Query(function(t){t=i.GetUserData(t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2FixtureProxy);t=t.fixture;return t.TestPoint(o)?e instanceof box2d.b2QueryCallback?e.ReportFixture(t):e(t):!0},a);if(e instanceof box2d.b2QueryCallback)for(t=this.m_particleSystemList;t;t=t.m_next)e.ShouldQueryParticleSystem(t)&&t.QueryAABB(e,a)};goog.exportProperty(box2d.b2World.prototype,"QueryPoint",box2d.b2World.prototype.QueryPoint);box2d.b2World.prototype.QueryPoint.s_aabb=new box2d.b2AABB;box2d.b2World.prototype.RayCast=function(s,n,b){var x=this.m_contactManager.m_broadPhase,t=box2d.b2World.prototype.RayCast.s_input;t.maxFraction=1;t.p1.Copy(n);t.p2.Copy(b);x.RayCast(function(t,e){var o=x.GetUserData(e);box2d.ENABLE_ASSERTS&&box2d.b2Assert(o instanceof box2d.b2FixtureProxy);var i=o.fixture,a=box2d.b2World.prototype.RayCast.s_output;if(i.RayCast(a,t,o.childIndex)){var o=a.fraction,r=box2d.b2World.prototype.RayCast.s_point;r.Set((1-o)*n.x+o*b.x,(1-o)*n.y+o*b.y);return s instanceof box2d.b2RayCastCallback?s.ReportFixture(i,r,a.normal,o):s(i,r,a.normal,o)}return t.maxFraction},t);if(s instanceof box2d.b2RayCastCallback)for(t=this.m_particleSystemList;t;t=t.m_next)s.ShouldQueryParticleSystem(t)&&t.RayCast(s,n,b)};goog.exportProperty(box2d.b2World.prototype,"RayCast",box2d.b2World.prototype.RayCast);box2d.b2World.prototype.RayCast.s_input=new box2d.b2RayCastInput;box2d.b2World.prototype.RayCast.s_output=new box2d.b2RayCastOutput;box2d.b2World.prototype.RayCast.s_point=new box2d.b2Vec2;box2d.b2World.prototype.RayCastOne=function(t,e){var a=null,r=1;this.RayCast(function(t,e,o,i){i<r&&(r=i,a=t);return r},t,e);return a};goog.exportProperty(box2d.b2World.prototype,"RayCastOne",box2d.b2World.prototype.RayCastOne);box2d.b2World.prototype.RayCastAll=function(t,e,a){a.length=0;this.RayCast(function(t,e,o,i){a.push(t);return 1},t,e);return a};goog.exportProperty(box2d.b2World.prototype,"RayCastAll",box2d.b2World.prototype.RayCastAll);box2d.b2World.prototype.DrawShape=function(t,e){var o=t.GetShape();switch(o.m_type){case box2d.b2ShapeType.e_circleShape:o=o instanceof box2d.b2CircleShape?o:null;this.m_debugDraw.DrawSolidCircle(o.m_p,o.m_radius,box2d.b2Vec2.UNITX,e);break;case box2d.b2ShapeType.e_edgeShape:var i=o instanceof box2d.b2EdgeShape?o:null,o=i.m_vertex1,a=i.m_vertex2;this.m_debugDraw.DrawSegment(o,a,e);break;case box2d.b2ShapeType.e_chainShape:var o=o instanceof box2d.b2ChainShape?o:null,i=o.m_count,r=o.m_vertices,o=r[0];this.m_debugDraw.DrawCircle(o,.05,e);for(var s=1;s<i;++s)a=r[s],this.m_debugDraw.DrawSegment(o,a,e),this.m_debugDraw.DrawCircle(a,.05,e),o=a;break;case box2d.b2ShapeType.e_polygonShape:i=o instanceof box2d.b2PolygonShape?o:null,o=i.m_count,r=i.m_vertices,this.m_debugDraw.DrawSolidPolygon(r,o,e)}};goog.exportProperty(box2d.b2World.prototype,"DrawShape",box2d.b2World.prototype.DrawShape);box2d.b2World.prototype.DrawJoint=function(t){var e=t.GetBodyA(),o=t.GetBodyB(),i=e.m_xf.p,a=o.m_xf.p,o=t.GetAnchorA(box2d.b2World.prototype.DrawJoint.s_p1),e=t.GetAnchorB(box2d.b2World.prototype.DrawJoint.s_p2),r=box2d.b2World.prototype.DrawJoint.s_color.SetRGB(.5,.8,.8);switch(t.m_type){case box2d.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(o,e,r);break;case box2d.b2JointType.e_pulleyJoint:i=t instanceof box2d.b2PulleyJoint?t:null;t=i.GetGroundAnchorA(box2d.b2World.prototype.DrawJoint.s_s1);i=i.GetGroundAnchorB(box2d.b2World.prototype.DrawJoint.s_s2);this.m_debugDraw.DrawSegment(t,o,r);this.m_debugDraw.DrawSegment(i,e,r);this.m_debugDraw.DrawSegment(t,i,r);break;case box2d.b2JointType.e_mouseJoint:this.m_debugDraw.DrawSegment(o,e,r);break;default:this.m_debugDraw.DrawSegment(i,o,r),this.m_debugDraw.DrawSegment(o,e,r),this.m_debugDraw.DrawSegment(a,e,r)}};goog.exportProperty(box2d.b2World.prototype,"DrawJoint",box2d.b2World.prototype.DrawJoint);box2d.b2World.prototype.DrawJoint.s_p1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_p2=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_color=new box2d.b2Color(.5,.8,.8);box2d.b2World.prototype.DrawJoint.s_s1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_s2=new box2d.b2Vec2;box2d.b2World.prototype.DrawParticleSystem=function(t){var e=t.GetParticleCount();if(e){var o=t.GetRadius(),i=t.GetPositionBuffer();t.m_colorBuffer.data?(t=t.GetColorBuffer(),this.m_debugDraw.DrawParticles(i,o,t,e)):this.m_debugDraw.DrawParticles(i,o,null,e)}};goog.exportProperty(box2d.b2World.prototype,"DrawParticleSystem",box2d.b2World.prototype.DrawParticleSystem);box2d.b2World.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var t=this.m_debugDraw.GetFlags(),e=box2d.b2World.prototype.DrawDebugData.s_color.SetRGB(0,0,0);if(t&box2d.b2DrawFlags.e_shapeBit)for(var o=this.m_bodyList;o;o=o.m_next){var i=o.m_xf;this.m_debugDraw.PushTransform(i);for(var a=o.GetFixtureList();a;a=a.m_next)o.IsActive()?o.GetType()===box2d.b2BodyType.b2_staticBody?e.SetRGB(.5,.9,.5):o.GetType()===box2d.b2BodyType.b2_kinematicBody?e.SetRGB(.5,.5,.9):o.IsAwake()?e.SetRGB(.9,.7,.7):e.SetRGB(.6,.6,.6):e.SetRGB(.5,.5,.3),this.DrawShape(a,e);this.m_debugDraw.PopTransform(i)}if(t&box2d.b2DrawFlags.e_particleBit)for(o=this.m_particleSystemList;o;o=o.m_next)this.DrawParticleSystem(o);if(t&box2d.b2DrawFlags.e_jointBit)for(o=this.m_jointList;o;o=o.m_next)this.DrawJoint(o);if(t&box2d.b2DrawFlags.e_aabbBit){e.SetRGB(.9,.3,.9);for(var i=this.m_contactManager.m_broadPhase,r=box2d.b2World.prototype.DrawDebugData.s_vs,o=this.m_bodyList;o;o=o.m_next)if(o.IsActive())for(a=o.GetFixtureList();a;a=a.m_next)for(var s=0;s<a.m_proxyCount;++s){var n=i.GetFatAABB(a.m_proxies[s].proxy);r[0].Set(n.lowerBound.x,n.lowerBound.y);r[1].Set(n.upperBound.x,n.lowerBound.y);r[2].Set(n.upperBound.x,n.upperBound.y);r[3].Set(n.lowerBound.x,n.upperBound.y);this.m_debugDraw.DrawPolygon(r,4,e)}}if(t&box2d.b2DrawFlags.e_centerOfMassBit)for(o=this.m_bodyList;o;o=o.m_next)i=box2d.b2World.prototype.DrawDebugData.s_xf,i.q.Copy(o.m_xf.q),i.p.Copy(o.GetWorldCenter()),this.m_debugDraw.DrawTransform(i);if(t&box2d.b2DrawFlags.e_controllerBit)for(t=this.m_controllerList;t;t=t.m_next)t.Draw(this.m_debugDraw)}};goog.exportProperty(box2d.b2World.prototype,"DrawDebugData",box2d.b2World.prototype.DrawDebugData);box2d.b2World.prototype.DrawDebugData.s_color=new box2d.b2Color(0,0,0);box2d.b2World.prototype.DrawDebugData.s_vs=box2d.b2Vec2.MakeArray(4);box2d.b2World.prototype.DrawDebugData.s_xf=new box2d.b2Transform;box2d.b2World.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var o=this.m_bodyList;o;o=o.m_next)for(var i=o.m_fixtureList;i;i=i.m_next)i.m_proxy=t.CreateProxy(e.GetFatAABB(i.m_proxy),i)};goog.exportProperty(box2d.b2World.prototype,"SetBroadPhase",box2d.b2World.prototype.SetBroadPhase);box2d.b2World.prototype.CalculateReasonableParticleIterations=function(t){return null===this.m_particleSystemList?1:box2d.b2CalculateParticleIterations(this.m_gravity.Length(),function(t){var e=box2d.b2_maxFloat;for(t=t.GetParticleSystemList();null!==t;t=t.m_next)e=box2d.b2Min(e,t.GetRadius());return e}(this),t)};goog.exportProperty(box2d.b2World.prototype,"CalculateReasonableParticleIterations",box2d.b2World.prototype.CalculateReasonableParticleIterations);box2d.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};goog.exportProperty(box2d.b2World.prototype,"GetProxyCount",box2d.b2World.prototype.GetProxyCount);box2d.b2World.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()};goog.exportProperty(box2d.b2World.prototype,"GetTreeHeight",box2d.b2World.prototype.GetTreeHeight);box2d.b2World.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()};goog.exportProperty(box2d.b2World.prototype,"GetTreeBalance",box2d.b2World.prototype.GetTreeBalance);box2d.b2World.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()};goog.exportProperty(box2d.b2World.prototype,"GetTreeQuality",box2d.b2World.prototype.GetTreeQuality);box2d.b2World.prototype.ShiftOrigin=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.SelfSub(t),e.m_sweep.c0.SelfSub(t),e.m_sweep.c.SelfSub(t);for(e=this.m_jointList;e;e=e.m_next)e.ShiftOrigin(t);this.m_contactManager.m_broadPhase.ShiftOrigin(t)}};goog.exportProperty(box2d.b2World.prototype,"ShiftOrigin",box2d.b2World.prototype.ShiftOrigin);box2d.b2World.prototype.Dump=function(){if(box2d.DEBUG&&!this.m_flag_locked){box2d.b2Log("/** @type {box2d.b2Vec2} */ var g = new box2d.b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y);box2d.b2Log("this.m_world.SetGravity(g);\n");box2d.b2Log("/** @type {Array.<box2d.b2Body>} */ var bodies = new Array(%d);\n",this.m_bodyCount);box2d.b2Log("/** @type {Array.<box2d.b2Joint>} */ var joints = new Array(%d);\n",this.m_jointCount);for(var t=0,e=this.m_bodyList;e;e=e.m_next)e.m_islandIndex=t,e.Dump(),++t;t=0;for(e=this.m_jointList;e;e=e.m_next)e.m_index=t,++t;for(e=this.m_jointList;e;e=e.m_next)e.m_type!==box2d.b2JointType.e_gearJoint&&(box2d.b2Log("{\n"),e.Dump(),box2d.b2Log("}\n"));for(e=this.m_jointList;e;e=e.m_next)e.m_type===box2d.b2JointType.e_gearJoint&&(box2d.b2Log("{\n"),e.Dump(),box2d.b2Log("}\n"))}};goog.exportProperty(box2d.b2World.prototype,"Dump",box2d.b2World.prototype.Dump);box2d.b2World.prototype.AddController=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===t.m_world,"Controller can only be a member of one world");t.m_world=this;t.m_next=this.m_controllerList;t.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=t);this.m_controllerList=t;++this.m_controllerCount;return t};goog.exportProperty(box2d.b2World.prototype,"AddController",box2d.b2World.prototype.AddController);box2d.b2World.prototype.RemoveController=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.m_world===this,"Controller is not a member of this world");t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);this.m_controllerList===t&&(this.m_controllerList=t.m_next);--this.m_controllerCount;t.m_prev=null;t.m_next=null;t.m_world=null};goog.exportProperty(box2d.b2World.prototype,"RemoveController",box2d.b2World.prototype.RemoveController);box2d.b2MotorJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_motorJoint);this.linearOffset=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2MotorJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MotorJointDef",box2d.b2MotorJointDef);box2d.b2MotorJointDef.prototype.linearOffset=null;goog.exportProperty(box2d.b2MotorJointDef.prototype,"linearOffset",box2d.b2MotorJointDef.prototype.linearOffset);box2d.b2MotorJointDef.prototype.angularOffset=0;goog.exportProperty(box2d.b2MotorJointDef.prototype,"angularOffset",box2d.b2MotorJointDef.prototype.angularOffset);box2d.b2MotorJointDef.prototype.maxForce=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxForce",box2d.b2MotorJointDef.prototype.maxForce);box2d.b2MotorJointDef.prototype.maxTorque=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxTorque",box2d.b2MotorJointDef.prototype.maxTorque);box2d.b2MotorJointDef.prototype.correctionFactor=.3;goog.exportProperty(box2d.b2MotorJointDef.prototype,"correctionFactor",box2d.b2MotorJointDef.prototype.correctionFactor);box2d.b2MotorJointDef.prototype.Initialize=function(t,e){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var o=this.bodyA.GetAngle();this.angularOffset=this.bodyB.GetAngle()-o};goog.exportProperty(box2d.b2MotorJointDef.prototype,"Initialize",box2d.b2MotorJointDef.prototype.Initialize);box2d.b2MotorJoint=function(t){box2d.b2Joint.call(this,t);this.m_linearOffset=t.linearOffset.Clone();this.m_linearImpulse=new box2d.b2Vec2(0,0);this.m_maxForce=t.maxForce;this.m_maxTorque=t.maxTorque;this.m_correctionFactor=t.correctionFactor;this.m_rA=new box2d.b2Vec2(0,0);this.m_rB=new box2d.b2Vec2(0,0);this.m_localCenterA=new box2d.b2Vec2(0,0);this.m_localCenterB=new box2d.b2Vec2(0,0);this.m_linearError=new box2d.b2Vec2(0,0);this.m_linearMass=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2MotorJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2MotorJoint",box2d.b2MotorJoint);box2d.b2MotorJoint.prototype.m_linearOffset=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearOffset",box2d.b2MotorJoint.prototype.m_linearOffset);box2d.b2MotorJoint.prototype.m_angularOffset=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularOffset",box2d.b2MotorJoint.prototype.m_angularOffset);box2d.b2MotorJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearImpulse",box2d.b2MotorJoint.prototype.m_linearImpulse);box2d.b2MotorJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularImpulse",box2d.b2MotorJoint.prototype.m_angularImpulse);box2d.b2MotorJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxForce",box2d.b2MotorJoint.prototype.m_maxForce);box2d.b2MotorJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxTorque",box2d.b2MotorJoint.prototype.m_maxTorque);box2d.b2MotorJoint.prototype.m_correctionFactor=.3;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_correctionFactor",box2d.b2MotorJoint.prototype.m_correctionFactor);box2d.b2MotorJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexA",box2d.b2MotorJoint.prototype.m_indexA);box2d.b2MotorJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexB",box2d.b2MotorJoint.prototype.m_indexB);box2d.b2MotorJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rA",box2d.b2MotorJoint.prototype.m_rA);box2d.b2MotorJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rB",box2d.b2MotorJoint.prototype.m_rB);box2d.b2MotorJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterA",box2d.b2MotorJoint.prototype.m_localCenterA);box2d.b2MotorJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterB",box2d.b2MotorJoint.prototype.m_localCenterB);box2d.b2MotorJoint.prototype.m_linearError=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearError",box2d.b2MotorJoint.prototype.m_linearError);box2d.b2MotorJoint.prototype.m_angularError=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularError",box2d.b2MotorJoint.prototype.m_angularError);box2d.b2MotorJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassA",box2d.b2MotorJoint.prototype.m_invMassA);box2d.b2MotorJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassB",box2d.b2MotorJoint.prototype.m_invMassB);box2d.b2MotorJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIA",box2d.b2MotorJoint.prototype.m_invIA);box2d.b2MotorJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIB",box2d.b2MotorJoint.prototype.m_invIB);box2d.b2MotorJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearMass",box2d.b2MotorJoint.prototype.m_linearMass);box2d.b2MotorJoint.prototype.m_angularMass=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularMass",box2d.b2MotorJoint.prototype.m_angularMass);box2d.b2MotorJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qA",box2d.b2MotorJoint.prototype.m_qA);box2d.b2MotorJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qB",box2d.b2MotorJoint.prototype.m_qB);box2d.b2MotorJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_K",box2d.b2MotorJoint.prototype.m_K);box2d.b2MotorJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetPosition(t)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorA",box2d.b2MotorJoint.prototype.GetAnchorA);box2d.b2MotorJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetPosition(t)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorB",box2d.b2MotorJoint.prototype.GetAnchorB);box2d.b2MotorJoint.prototype.GetReactionForce=function(t,e){return box2d.b2Mul_S_V2(t,this.m_linearImpulse,e)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionForce",box2d.b2MotorJoint.prototype.GetReactionForce);box2d.b2MotorJoint.prototype.GetReactionTorque=function(t){return t*this.m_angularImpulse};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionTorque",box2d.b2MotorJoint.prototype.GetReactionTorque);box2d.b2MotorJoint.prototype.SetCorrectionFactor=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t)&&0<=t&&1>=t);this._correctionFactor=t};box2d.b2MotorJoint.prototype.GetCorrectionFactor=function(){return this.m_correctionFactor};box2d.b2MotorJoint.prototype.SetLinearOffset=function(t){if(t.x!=this.m_linearOffset.x||t.y!=this.m_linearOffset.y)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(t)};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetLinearOffset",box2d.b2MotorJoint.prototype.SetLinearOffset);box2d.b2MotorJoint.prototype.GetLinearOffset=function(t){return t.Copy(this.m_linearOffset)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetLinearOffset",box2d.b2MotorJoint.prototype.GetLinearOffset);box2d.b2MotorJoint.prototype.SetAngularOffset=function(t){t!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetAngularOffset",box2d.b2MotorJoint.prototype.SetAngularOffset);box2d.b2MotorJoint.prototype.GetAngularOffset=function(){return this.m_angularOffset};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAngularOffset",box2d.b2MotorJoint.prototype.GetAngularOffset);box2d.b2MotorJoint.prototype.SetMaxForce=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t)&&0<=t);this.m_maxForce=t};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxForce",box2d.b2MotorJoint.prototype.SetMaxForce);box2d.b2MotorJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxForce",box2d.b2MotorJoint.prototype.GetMaxForce);box2d.b2MotorJoint.prototype.SetMaxTorque=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t)&&0<=t);this.m_maxTorque=t};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxTorque",box2d.b2MotorJoint.prototype.SetMaxTorque);box2d.b2MotorJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxTorque",box2d.b2MotorJoint.prototype.GetMaxTorque);box2d.b2MotorJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.velocities[this.m_indexA].v,a=t.velocities[this.m_indexA].w,r=t.positions[this.m_indexB].c,s=t.positions[this.m_indexB].a,n=t.velocities[this.m_indexB].v,b=t.velocities[this.m_indexB].w,x=this.m_qA.SetAngle(o),l=this.m_qB.SetAngle(s),_=box2d.b2Mul_R_V2(x,box2d.b2Vec2.s_t0.Copy(this.m_localCenterA).SelfNeg(),this.m_rA),l=box2d.b2Mul_R_V2(l,box2d.b2Vec2.s_t0.Copy(this.m_localCenterB).SelfNeg(),this.m_rB),h=this.m_invMassA,d=this.m_invMassB,p=this.m_invIA,c=this.m_invIB,u=this.m_K;u.ex.x=h+d+p*_.y*_.y+c*l.y*l.y;u.ex.y=-p*_.x*_.y-c*l.x*l.y;u.ey.x=u.ex.y;u.ey.y=h+d+p*_.x*_.x+c*l.x*l.x;u.GetInverse(this.m_linearMass);this.m_angularMass=p+c;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);box2d.b2Sub_V2_V2(box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(r,l,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,_,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2Mul_R_V2(x,this.m_linearOffset,box2d.b2Vec2.s_t3),this.m_linearError);this.m_angularError=s-o-this.m_angularOffset;t.step.warmStarting?(this.m_linearImpulse.SelfMul(t.step.dtRatio),this.m_angularImpulse*=t.step.dtRatio,e=this.m_linearImpulse,i.SelfMulSub(h,e),a-=p*(box2d.b2Cross_V2_V2(_,e)+this.m_angularImpulse),n.SelfMulAdd(d,e),b+=c*(box2d.b2Cross_V2_V2(l,e)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);t.velocities[this.m_indexA].w=a;t.velocities[this.m_indexB].w=b};goog.exportProperty(box2d.b2MotorJoint.prototype,"InitVelocityConstraints",box2d.b2MotorJoint.prototype.InitVelocityConstraints);box2d.b2MotorJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=this.m_invMassA,s=this.m_invMassB,n=this.m_invIA,b=this.m_invIB,x=t.step.dt,l=t.step.inv_dt,_=a-o+l*this.m_correctionFactor*this.m_angularError,_=-this.m_angularMass*_,h=this.m_angularImpulse,d=x*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+_,-d,d);var _=this.m_angularImpulse-h,o=o-n*_,a=a+b*_,p=this.m_rA,c=this.m_rB,_=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(i,box2d.b2Cross_S_V2(a,c,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,box2d.b2Cross_S_V2(o,p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2Mul_S_V2(l*this.m_correctionFactor,this.m_linearError,box2d.b2Vec2.s_t3),box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot),_=box2d.b2Mul_M22_V2(this.m_linearMass,_,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg(),h=box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(_);d=x*this.m_maxForce;this.m_linearImpulse.LengthSquared()>d*d&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(d));box2d.b2Sub_V2_V2(this.m_linearImpulse,h,_);e.SelfMulSub(r,_);o-=n*box2d.b2Cross_V2_V2(p,_);i.SelfMulAdd(s,_);a+=b*box2d.b2Cross_V2_V2(c,_);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2MotorJoint.prototype,"SolveVelocityConstraints",box2d.b2MotorJoint.prototype.SolveVelocityConstraints);box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolvePositionConstraints=function(t){return!0};goog.exportProperty(box2d.b2MotorJoint.prototype,"SolvePositionConstraints",box2d.b2MotorJoint.prototype.SolvePositionConstraints);box2d.b2MotorJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2MotorJointDef*/ var jd = new box2d.b2MotorJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y);box2d.b2Log("  jd.angularOffset = %.15f;\n",this.m_angularOffset);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2MotorJoint.prototype,"Dump",box2d.b2MotorJoint.prototype.Dump);box2d.b2MouseJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_mouseJoint);this.target=new box2d.b2Vec2};goog.inherits(box2d.b2MouseJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MouseJointDef",box2d.b2MouseJointDef);box2d.b2MouseJointDef.prototype.target=null;goog.exportProperty(box2d.b2MouseJointDef.prototype,"target",box2d.b2MouseJointDef.prototype.target);box2d.b2MouseJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2MouseJointDef.prototype,"maxForce",box2d.b2MouseJointDef.prototype.maxForce);box2d.b2MouseJointDef.prototype.frequencyHz=5;goog.exportProperty(box2d.b2MouseJointDef.prototype,"frequencyHz",box2d.b2MouseJointDef.prototype.frequencyHz);box2d.b2MouseJointDef.prototype.dampingRatio=.7;goog.exportProperty(box2d.b2MouseJointDef.prototype,"dampingRatio",box2d.b2MouseJointDef.prototype.dampingRatio);box2d.b2MouseJoint=function(t){box2d.b2Joint.call(this,t);this.m_localAnchorB=new box2d.b2Vec2;this.m_targetA=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat22;this.m_C=new box2d.b2Vec2;this.m_qB=new box2d.b2Rot;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.target.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.maxForce)&&0<=t.maxForce);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.frequencyHz)&&0<=t.frequencyHz);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t.dampingRatio)&&0<=t.dampingRatio);this.m_targetA.Copy(t.target);box2d.b2MulT_X_V2(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB);this.m_maxForce=t.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_gamma=this.m_beta=0};goog.inherits(box2d.b2MouseJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2MouseJoint",box2d.b2MouseJoint);box2d.b2MouseJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localAnchorB",box2d.b2MouseJoint.prototype.m_localAnchorB);box2d.b2MouseJoint.prototype.m_targetA=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_targetA",box2d.b2MouseJoint.prototype.m_targetA);box2d.b2MouseJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_frequencyHz",box2d.b2MouseJoint.prototype.m_frequencyHz);box2d.b2MouseJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_dampingRatio",box2d.b2MouseJoint.prototype.m_dampingRatio);box2d.b2MouseJoint.prototype.m_beta=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_beta",box2d.b2MouseJoint.prototype.m_beta);box2d.b2MouseJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_impulse",box2d.b2MouseJoint.prototype.m_impulse);box2d.b2MouseJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_maxForce",box2d.b2MouseJoint.prototype.m_maxForce);box2d.b2MouseJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_gamma",box2d.b2MouseJoint.prototype.m_gamma);box2d.b2MouseJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexA",box2d.b2MouseJoint.prototype.m_indexA);box2d.b2MouseJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexB",box2d.b2MouseJoint.prototype.m_indexB);box2d.b2MouseJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_rB",box2d.b2MouseJoint.prototype.m_rB);box2d.b2MouseJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localCenterB",box2d.b2MouseJoint.prototype.m_localCenterB);box2d.b2MouseJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invMassB",box2d.b2MouseJoint.prototype.m_invMassB);box2d.b2MouseJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invIB",box2d.b2MouseJoint.prototype.m_invIB);box2d.b2MouseJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_mass",box2d.b2MouseJoint.prototype.m_mass);box2d.b2MouseJoint.prototype.m_C=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_C",box2d.b2MouseJoint.prototype.m_C);box2d.b2MouseJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_qB",box2d.b2MouseJoint.prototype.m_qB);box2d.b2MouseJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_lalcB",box2d.b2MouseJoint.prototype.m_lalcB);box2d.b2MouseJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_K",box2d.b2MouseJoint.prototype.m_K);box2d.b2MouseJoint.prototype.SetTarget=function(t){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0);this.m_targetA.Copy(t)};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetTarget",box2d.b2MouseJoint.prototype.SetTarget);box2d.b2MouseJoint.prototype.GetTarget=function(t){return t.Copy(this.m_targetA)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetTarget",box2d.b2MouseJoint.prototype.GetTarget);box2d.b2MouseJoint.prototype.SetMaxForce=function(t){this.m_maxForce=t};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetMaxForce",box2d.b2MouseJoint.prototype.SetMaxForce);box2d.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetMaxForce",box2d.b2MouseJoint.prototype.GetMaxForce);box2d.b2MouseJoint.prototype.SetFrequency=function(t){this.m_frequencyHz=t};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetFrequency",box2d.b2MouseJoint.prototype.SetFrequency);box2d.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetFrequency",box2d.b2MouseJoint.prototype.GetFrequency);box2d.b2MouseJoint.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetDampingRatio",box2d.b2MouseJoint.prototype.SetDampingRatio);box2d.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetDampingRatio",box2d.b2MouseJoint.prototype.GetDampingRatio);box2d.b2MouseJoint.prototype.InitVelocityConstraints=function(t){this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexB].c,o=t.velocities[this.m_indexB].v,i=t.velocities[this.m_indexB].w,a=this.m_qB.SetAngle(t.positions[this.m_indexB].a),r=this.m_bodyB.GetMass(),s=2*box2d.b2_pi*this.m_frequencyHz,n=2*r*this.m_dampingRatio*s,r=r*s*s,s=t.step.dt;box2d.ENABLE_ASSERTS&&box2d.b2Assert(n+s*r>box2d.b2_epsilon);this.m_gamma=s*(n+s*r);0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma);this.m_beta=s*r*this.m_gamma;box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(a,this.m_lalcB,this.m_rB);a=this.m_K;a.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma;a.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y;a.ey.x=a.ex.y;a.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma;a.GetInverse(this.m_mass);this.m_C.x=e.x+this.m_rB.x-this.m_targetA.x;this.m_C.y=e.y+this.m_rB.y-this.m_targetA.y;this.m_C.SelfMul(this.m_beta);i*=.98;t.step.warmStarting?(this.m_impulse.SelfMul(t.step.dtRatio),o.x+=this.m_invMassB*this.m_impulse.x,o.y+=this.m_invMassB*this.m_impulse.y,i+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,this.m_impulse)):this.m_impulse.SetZero();t.velocities[this.m_indexB].w=i};goog.exportProperty(box2d.b2MouseJoint.prototype,"InitVelocityConstraints",box2d.b2MouseJoint.prototype.InitVelocityConstraints);box2d.b2MouseJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexB].v,o=t.velocities[this.m_indexB].w,i=box2d.b2AddCross_V2_S_V2(e,o,this.m_rB,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot),i=box2d.b2Mul_M22_V2(this.m_mass,box2d.b2Add_V2_V2(i,box2d.b2Add_V2_V2(this.m_C,box2d.b2Mul_S_V2(this.m_gamma,this.m_impulse,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0).SelfNeg(),box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse),a=box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(i);var r=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>r*r&&this.m_impulse.SelfMul(r/this.m_impulse.Length());box2d.b2Sub_V2_V2(this.m_impulse,a,i);e.SelfMulAdd(this.m_invMassB,i);o+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,i);t.velocities[this.m_indexB].w=o};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolveVelocityConstraints",box2d.b2MouseJoint.prototype.SolveVelocityConstraints);box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolvePositionConstraints=function(t){return!0};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolvePositionConstraints",box2d.b2MouseJoint.prototype.SolvePositionConstraints);box2d.b2MouseJoint.prototype.GetAnchorA=function(t){return t.Copy(this.m_targetA)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorA",box2d.b2MouseJoint.prototype.GetAnchorA);box2d.b2MouseJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorB",box2d.b2MouseJoint.prototype.GetAnchorB);box2d.b2MouseJoint.prototype.GetReactionForce=function(t,e){return box2d.b2Mul_S_V2(t,this.m_impulse,e)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionForce",box2d.b2MouseJoint.prototype.GetReactionForce);box2d.b2MouseJoint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionTorque",box2d.b2MouseJoint.prototype.GetReactionTorque);box2d.b2MouseJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Mouse joint dumping is not supported.\n")};goog.exportProperty(box2d.b2MouseJoint.prototype,"Dump",box2d.b2MouseJoint.prototype.Dump);box2d.b2MouseJoint.prototype.ShiftOrigin=function(t){this.m_targetA.SelfSub(t)};goog.exportProperty(box2d.b2MouseJoint.prototype,"ShiftOrigin",box2d.b2MouseJoint.prototype.ShiftOrigin);box2d.b2PrismaticJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_prismaticJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2;this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PrismaticJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PrismaticJointDef",box2d.b2PrismaticJointDef);box2d.b2PrismaticJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorA",box2d.b2PrismaticJointDef.prototype.localAnchorA);box2d.b2PrismaticJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorB",box2d.b2PrismaticJointDef.prototype.localAnchorB);box2d.b2PrismaticJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAxisA",box2d.b2PrismaticJointDef.prototype.localAxisA);box2d.b2PrismaticJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"referenceAngle",box2d.b2PrismaticJointDef.prototype.referenceAngle);box2d.b2PrismaticJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableLimit",box2d.b2PrismaticJointDef.prototype.enableLimit);box2d.b2PrismaticJointDef.prototype.lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"lowerTranslation",box2d.b2PrismaticJointDef.prototype.lowerTranslation);box2d.b2PrismaticJointDef.prototype.upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"upperTranslation",box2d.b2PrismaticJointDef.prototype.upperTranslation);box2d.b2PrismaticJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableMotor",box2d.b2PrismaticJointDef.prototype.enableMotor);box2d.b2PrismaticJointDef.prototype.maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"maxMotorForce",box2d.b2PrismaticJointDef.prototype.maxMotorForce);box2d.b2PrismaticJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"motorSpeed",box2d.b2PrismaticJointDef.prototype.motorSpeed);box2d.b2PrismaticJointDef.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(o,this.localAnchorB);this.bodyA.GetLocalVector(i,this.localAxisA);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"Initialize",box2d.b2PrismaticJointDef.prototype.Initialize);box2d.b2PrismaticJoint=function(t){box2d.b2Joint.call(this,t);this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_localXAxisA=t.localAxisA.Clone().SelfNormalize();this.m_localYAxisA=box2d.b2Cross_S_V2(1,this.m_localXAxisA,new box2d.b2Vec2);this.m_referenceAngle=t.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_lowerTranslation=t.lowerTranslation;this.m_upperTranslation=t.upperTranslation;this.m_maxMotorForce=t.maxMotorForce;this.m_motorSpeed=t.motorSpeed;this.m_enableLimit=t.enableLimit;this.m_enableMotor=t.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2(0,0);this.m_perp=new box2d.b2Vec2(0,0);this.m_K=new box2d.b2Mat33;this.m_K3=new box2d.b2Mat33;this.m_K2=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2};goog.inherits(box2d.b2PrismaticJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2PrismaticJoint",box2d.b2PrismaticJoint);box2d.b2PrismaticJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorA",box2d.b2PrismaticJoint.prototype.m_localAnchorA);box2d.b2PrismaticJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorB",box2d.b2PrismaticJoint.prototype.m_localAnchorB);box2d.b2PrismaticJoint.prototype.m_localXAxisA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localXAxisA",box2d.b2PrismaticJoint.prototype.m_localXAxisA);box2d.b2PrismaticJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localYAxisA",box2d.b2PrismaticJoint.prototype.m_localYAxisA);box2d.b2PrismaticJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_referenceAngle",box2d.b2PrismaticJoint.prototype.m_referenceAngle);box2d.b2PrismaticJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_impulse",box2d.b2PrismaticJoint.prototype.m_impulse);box2d.b2PrismaticJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorImpulse",box2d.b2PrismaticJoint.prototype.m_motorImpulse);box2d.b2PrismaticJoint.prototype.m_lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lowerTranslation",box2d.b2PrismaticJoint.prototype.m_lowerTranslation);box2d.b2PrismaticJoint.prototype.m_upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_upperTranslation",box2d.b2PrismaticJoint.prototype.m_upperTranslation);box2d.b2PrismaticJoint.prototype.m_maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_maxMotorForce",box2d.b2PrismaticJoint.prototype.m_maxMotorForce);box2d.b2PrismaticJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorSpeed",box2d.b2PrismaticJoint.prototype.m_motorSpeed);box2d.b2PrismaticJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableLimit",box2d.b2PrismaticJoint.prototype.m_enableLimit);box2d.b2PrismaticJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableMotor",box2d.b2PrismaticJoint.prototype.m_enableMotor);box2d.b2PrismaticJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_limitState",box2d.b2PrismaticJoint.prototype.m_limitState);box2d.b2PrismaticJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexA",box2d.b2PrismaticJoint.prototype.m_indexA);box2d.b2PrismaticJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexB",box2d.b2PrismaticJoint.prototype.m_indexB);box2d.b2PrismaticJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterA",box2d.b2PrismaticJoint.prototype.m_localCenterA);box2d.b2PrismaticJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterB",box2d.b2PrismaticJoint.prototype.m_localCenterB);box2d.b2PrismaticJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassA",box2d.b2PrismaticJoint.prototype.m_invMassA);box2d.b2PrismaticJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassB",box2d.b2PrismaticJoint.prototype.m_invMassB);box2d.b2PrismaticJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIA",box2d.b2PrismaticJoint.prototype.m_invIA);box2d.b2PrismaticJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIB",box2d.b2PrismaticJoint.prototype.m_invIB);box2d.b2PrismaticJoint.prototype.m_axis=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_axis",box2d.b2PrismaticJoint.prototype.m_axis);box2d.b2PrismaticJoint.prototype.m_perp=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_perp",box2d.b2PrismaticJoint.prototype.m_perp);box2d.b2PrismaticJoint.prototype.m_s1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s1",box2d.b2PrismaticJoint.prototype.m_s1);box2d.b2PrismaticJoint.prototype.m_s2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s2",box2d.b2PrismaticJoint.prototype.m_s2);box2d.b2PrismaticJoint.prototype.m_a1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a1",box2d.b2PrismaticJoint.prototype.m_a1);box2d.b2PrismaticJoint.prototype.m_a2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a2",box2d.b2PrismaticJoint.prototype.m_a2);box2d.b2PrismaticJoint.prototype.m_K=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K",box2d.b2PrismaticJoint.prototype.m_K);box2d.b2PrismaticJoint.prototype.m_K3=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K3",box2d.b2PrismaticJoint.prototype.m_K3);box2d.b2PrismaticJoint.prototype.m_K2=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K2",box2d.b2PrismaticJoint.prototype.m_K2);box2d.b2PrismaticJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorMass",box2d.b2PrismaticJoint.prototype.m_motorMass);box2d.b2PrismaticJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qA",box2d.b2PrismaticJoint.prototype.m_qA);box2d.b2PrismaticJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qB",box2d.b2PrismaticJoint.prototype.m_qB);box2d.b2PrismaticJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcA",box2d.b2PrismaticJoint.prototype.m_lalcA);box2d.b2PrismaticJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcB",box2d.b2PrismaticJoint.prototype.m_lalcB);box2d.b2PrismaticJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rA",box2d.b2PrismaticJoint.prototype.m_rA);box2d.b2PrismaticJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rB",box2d.b2PrismaticJoint.prototype.m_rB);box2d.b2PrismaticJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].c,r=t.positions[this.m_indexB].a,s=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,b=this.m_qA.SetAngle(t.positions[this.m_indexA].a),r=this.m_qB.SetAngle(r);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var x=box2d.b2Mul_R_V2(b,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var l=box2d.b2Mul_R_V2(r,this.m_lalcB,this.m_rB),_=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(a,e,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(l,x,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d),e=this.m_invMassA,a=this.m_invMassB,r=this.m_invIA,h=this.m_invIB;box2d.b2Mul_R_V2(b,this.m_localXAxisA,this.m_axis);this.m_a1=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(_,x,box2d.b2Vec2.s_t0),this.m_axis);this.m_a2=box2d.b2Cross_V2_V2(l,this.m_axis);this.m_motorMass=e+a+r*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);box2d.b2Mul_R_V2(b,this.m_localYAxisA,this.m_perp);this.m_s1=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(_,x,box2d.b2Vec2.s_t0),this.m_perp);this.m_s2=box2d.b2Cross_V2_V2(l,this.m_perp);this.m_K.ex.x=e+a+r*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;this.m_K.ex.y=r*this.m_s1+h*this.m_s2;this.m_K.ex.z=r*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;this.m_K.ey.x=this.m_K.ex.y;this.m_K.ey.y=r+h;0===this.m_K.ey.y&&(this.m_K.ey.y=1);this.m_K.ey.z=r*this.m_a1+h*this.m_a2;this.m_K.ez.x=this.m_K.ex.z;this.m_K.ez.y=this.m_K.ey.z;this.m_K.ez.z=e+a+r*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(b=box2d.b2Dot_V2_V2(this.m_axis,_),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:b<=this.m_lowerTranslation?this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_limitState=box2d.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):b>=this.m_upperTranslation?this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_limitState=box2d.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0);this.m_enableMotor||(this.m_motorImpulse=0);t.step.warmStarting?(this.m_impulse.SelfMulScalar(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio,b=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(this.m_impulse.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(this.m_motorImpulse+this.m_impulse.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P),x=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,l=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,o.SelfMulSub(e,b),i-=r*x,s.SelfMulAdd(a,b),n+=h*l):(this.m_impulse.SetZero(),this.m_motorImpulse=0);t.velocities[this.m_indexA].w=i;t.velocities[this.m_indexB].w=n};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"InitVelocityConstraints",box2d.b2PrismaticJoint.prototype.InitVelocityConstraints);box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=this.m_invMassA,s=this.m_invMassB,n=this.m_invIA,b=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits){var x=box2d.b2Dot_V2_V2(this.m_axis,box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0))+this.m_a2*a-this.m_a1*o,x=this.m_motorMass*(this.m_motorSpeed-x),l=this.m_motorImpulse,_=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+x,-_,_);x=this.m_motorImpulse-l;l=box2d.b2Mul_S_V2(x,this.m_axis,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P);_=x*this.m_a1;x*=this.m_a2;e.SelfMulSub(r,l);o-=n*_;i.SelfMulAdd(s,l);a+=b*x}var _=box2d.b2Dot_V2_V2(this.m_perp,box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0))+this.m_s2*a-this.m_s1*o,h=a-o;this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit?(x=box2d.b2Dot_V2_V2(this.m_axis,box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0))+this.m_a2*a-this.m_a1*o,l=box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1.Copy(this.m_impulse),x=this.m_K.Solve33(-_,-h,-x,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3),this.m_impulse.SelfAdd(x),this.m_limitState===box2d.b2LimitState.e_atLowerLimit?this.m_impulse.z=box2d.b2Max(this.m_impulse.z,0):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=box2d.b2Min(this.m_impulse.z,0)),_=this.m_K.Solve22(-_-(this.m_impulse.z-l.z)*this.m_K.ez.x,-h-(this.m_impulse.z-l.z)*this.m_K.ez.y,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r),_.x+=l.x,_.y+=l.y,this.m_impulse.x=_.x,this.m_impulse.y=_.y,x.x=this.m_impulse.x-l.x,x.y=this.m_impulse.y-l.y,x.z=this.m_impulse.z-l.z,l=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(x.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(x.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),_=x.x*this.m_s1+x.y+x.z*this.m_a1,x=x.x*this.m_s2+x.y+x.z*this.m_a2):(x=this.m_K.Solve22(-_,-h,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2),this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,l=box2d.b2Mul_S_V2(x.x,this.m_perp,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),_=x.x*this.m_s1+x.y,x=x.x*this.m_s2+x.y);e.SelfMulSub(r,l);o-=n*_;i.SelfMulAdd(s,l);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a+b*x};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolveVelocityConstraints",box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints);box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a),n=this.m_invMassA,b=this.m_invMassB,x=this.m_invIA,l=this.m_invIB,_=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA),h=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),d=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(i,h,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,_,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d),p=box2d.b2Mul_R_V2(r,this.m_localXAxisA,this.m_axis),c=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(d,_,box2d.b2Vec2.s_t0),p),s=box2d.b2Cross_V2_V2(h,p),r=box2d.b2Mul_R_V2(r,this.m_localYAxisA,this.m_perp),u=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(d,_,box2d.b2Vec2.s_t0),r),y=box2d.b2Cross_V2_V2(h,r),m=box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse,f=box2d.b2Dot_V2_V2(r,d),g=a-o-this.m_referenceAngle,_=box2d.b2Abs(f),h=box2d.b2Abs(g),v=!1,S=0;this.m_enableLimit&&(d=box2d.b2Dot_V2_V2(p,d),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?(S=box2d.b2Clamp(d,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),_=box2d.b2Max(_,box2d.b2Abs(d)),v=!0):d<=this.m_lowerTranslation?(S=box2d.b2Clamp(d-this.m_lowerTranslation+box2d.b2_linearSlop,-box2d.b2_maxLinearCorrection,0),_=box2d.b2Max(_,this.m_lowerTranslation-d),v=!0):d>=this.m_upperTranslation&&(S=box2d.b2Clamp(d-this.m_upperTranslation-box2d.b2_linearSlop,0,box2d.b2_maxLinearCorrection),_=box2d.b2Max(_,d-this.m_upperTranslation),v=!0));if(v){var d=x*u+l*y,C=x*u*c+l*y*s,v=x+l;0===v&&(v=1);var P=x*c+l*s,A=n+b+x*c*c+l*s*s,B=this.m_K3;B.ex.Set(n+b+x*u*u+l*y*y,d,C);B.ey.Set(d,v,P);B.ez.Set(C,P,A);m=B.Solve33(-f,-g,-S,m)}else d=x*u+l*y,v=x+l,0===v&&(v=1),S=this.m_K2,S.ex.Set(n+b+x*u*u+l*y*y,d),S.ey.Set(d,v),f=S.Solve(-f,-g,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1),m.x=f.x,m.y=f.y,m.z=0;p=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(m.x,r,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(m.z,p,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P);c=m.x*u+m.y+m.z*c;s=m.x*y+m.y+m.z*s;e.SelfMulSub(n,p);o-=x*c;i.SelfMulAdd(b,p);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a+l*s;return _<=box2d.b2_linearSlop&&h<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolvePositionConstraints",box2d.b2PrismaticJoint.prototype.SolvePositionConstraints);box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorA",box2d.b2PrismaticJoint.prototype.GetAnchorA);box2d.b2PrismaticJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorB",box2d.b2PrismaticJoint.prototype.GetAnchorB);box2d.b2PrismaticJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionForce",box2d.b2PrismaticJoint.prototype.GetReactionForce);box2d.b2PrismaticJoint.prototype.GetReactionTorque=function(t){return t*this.m_impulse.y};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionTorque",box2d.b2PrismaticJoint.prototype.GetReactionTorque);box2d.b2PrismaticJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorA",box2d.b2PrismaticJoint.prototype.GetLocalAnchorA);box2d.b2PrismaticJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorB",box2d.b2PrismaticJoint.prototype.GetLocalAnchorB);box2d.b2PrismaticJoint.prototype.GetLocalAxisA=function(t){return t.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAxisA",box2d.b2PrismaticJoint.prototype.GetLocalAxisA);box2d.b2PrismaticJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReferenceAngle",box2d.b2PrismaticJoint.prototype.GetReferenceAngle);box2d.b2PrismaticJoint.prototype.GetJointTranslation=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA),e=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB),t=box2d.b2Sub_V2_V2(e,t,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d),e=this.m_bodyA.GetWorldVector(this.m_localXAxisA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis);return box2d.b2Dot_V2_V2(t,e)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointTranslation",box2d.b2PrismaticJoint.prototype.GetJointTranslation);box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB;box2d.b2Sub_V2_V2(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);var o=box2d.b2Mul_R_V2(t.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);var i=box2d.b2Mul_R_V2(e.m_xf.q,this.m_lalcB,this.m_rB),a=box2d.b2Add_V2_V2(t.m_sweep.c,o,box2d.b2Vec2.s_t0),r=box2d.b2Add_V2_V2(e.m_sweep.c,i,box2d.b2Vec2.s_t1),a=box2d.b2Sub_V2_V2(r,a,box2d.b2Vec2.s_t2),r=t.GetWorldVector(this.m_localXAxisA,this.m_axis),s=t.m_linearVelocity,n=e.m_linearVelocity,t=t.m_angularVelocity,e=e.m_angularVelocity;return box2d.b2Dot_V2_V2(a,box2d.b2Cross_S_V2(t,r,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(r,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(n,e,i,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(s,t,o,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointSpeed",box2d.b2PrismaticJoint.prototype.GetJointSpeed);box2d.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsLimitEnabled",box2d.b2PrismaticJoint.prototype.IsLimitEnabled);box2d.b2PrismaticJoint.prototype.EnableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableLimit",box2d.b2PrismaticJoint.prototype.EnableLimit);box2d.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLowerLimit",box2d.b2PrismaticJoint.prototype.GetLowerLimit);box2d.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetUpperLimit",box2d.b2PrismaticJoint.prototype.GetUpperLimit);box2d.b2PrismaticJoint.prototype.SetLimits=function(t,e){if(t!==this.m_lowerTranslation||e!==this.m_upperTranslation)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetLimits",box2d.b2PrismaticJoint.prototype.SetLimits);box2d.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsMotorEnabled",box2d.b2PrismaticJoint.prototype.IsMotorEnabled);box2d.b2PrismaticJoint.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=t};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableMotor",box2d.b2PrismaticJoint.prototype.EnableMotor);box2d.b2PrismaticJoint.prototype.SetMotorSpeed=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=t};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMotorSpeed",box2d.b2PrismaticJoint.prototype.SetMotorSpeed);box2d.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorSpeed",box2d.b2PrismaticJoint.prototype.GetMotorSpeed);box2d.b2PrismaticJoint.prototype.SetMaxMotorForce=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=t};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMaxMotorForce",box2d.b2PrismaticJoint.prototype.SetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMaxMotorForce",box2d.b2PrismaticJoint.prototype.GetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMotorForce=function(t){return t*this.m_motorImpulse};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorForce",box2d.b2PrismaticJoint.prototype.GetMotorForce);box2d.b2PrismaticJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PrismaticJointDef*/ var jd = new box2d.b2PrismaticJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation);box2d.b2Log("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"Dump",box2d.b2PrismaticJoint.prototype.Dump);box2d.b2_minPulleyLength=2;goog.exportSymbol("box2d.b2_minPulleyLength",box2d.b2_minPulleyLength);box2d.b2PulleyJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_pulleyJoint);this.collideConnected=!0;this.groundAnchorA=new box2d.b2Vec2(-1,1);this.groundAnchorB=new box2d.b2Vec2(1,1);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PulleyJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PulleyJointDef",box2d.b2PulleyJointDef);box2d.b2PulleyJointDef.prototype.groundAnchorA=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorA",box2d.b2PulleyJointDef.prototype.groundAnchorA);box2d.b2PulleyJointDef.prototype.groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorB",box2d.b2PulleyJointDef.prototype.groundAnchorB);box2d.b2PulleyJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorA",box2d.b2PulleyJointDef.prototype.localAnchorA);box2d.b2PulleyJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorB",box2d.b2PulleyJointDef.prototype.localAnchorB);box2d.b2PulleyJointDef.prototype.lengthA=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthA",box2d.b2PulleyJointDef.prototype.lengthA);box2d.b2PulleyJointDef.prototype.lengthB=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthB",box2d.b2PulleyJointDef.prototype.lengthB);box2d.b2PulleyJointDef.prototype.ratio=1;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"ratio",box2d.b2PulleyJointDef.prototype.ratio);box2d.b2PulleyJointDef.prototype.Initialize=function(t,e,o,i,a,r,s){this.bodyA=t;this.bodyB=e;this.groundAnchorA.Copy(o);this.groundAnchorB.Copy(i);this.bodyA.GetLocalPoint(a,this.localAnchorA);this.bodyB.GetLocalPoint(r,this.localAnchorB);this.lengthA=box2d.b2Distance(a,o);this.lengthB=box2d.b2Distance(r,i);this.ratio=s;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.ratio>box2d.b2_epsilon)};goog.exportProperty(box2d.b2PulleyJointDef.prototype,"Initialize",box2d.b2PulleyJointDef.prototype.Initialize);box2d.b2PulleyJoint=function(t){box2d.b2Joint.call(this,t);this.m_groundAnchorA=new box2d.b2Vec2;this.m_groundAnchorB=new box2d.b2Vec2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_uA=new box2d.b2Vec2;this.m_uB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_groundAnchorA.Copy(t.groundAnchorA);this.m_groundAnchorB.Copy(t.groundAnchorB);this.m_localAnchorA.Copy(t.localAnchorA);this.m_localAnchorB.Copy(t.localAnchorB);this.m_lengthA=t.lengthA;this.m_lengthB=t.lengthB;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0!==t.ratio);this.m_ratio=t.ratio;this.m_constant=t.lengthA+this.m_ratio*t.lengthB;this.m_impulse=0};goog.inherits(box2d.b2PulleyJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2PulleyJoint",box2d.b2PulleyJoint);box2d.b2PulleyJoint.prototype.m_groundAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorA",box2d.b2PulleyJoint.prototype.m_groundAnchorA);box2d.b2PulleyJoint.prototype.m_groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorB",box2d.b2PulleyJoint.prototype.m_groundAnchorB);box2d.b2PulleyJoint.prototype.m_lengthA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthA",box2d.b2PulleyJoint.prototype.m_lengthA);box2d.b2PulleyJoint.prototype.m_lengthB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthB",box2d.b2PulleyJoint.prototype.m_lengthB);box2d.b2PulleyJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorA",box2d.b2PulleyJoint.prototype.m_localAnchorA);box2d.b2PulleyJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorB",box2d.b2PulleyJoint.prototype.m_localAnchorB);box2d.b2PulleyJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_constant",box2d.b2PulleyJoint.prototype.m_constant);box2d.b2PulleyJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_ratio",box2d.b2PulleyJoint.prototype.m_ratio);box2d.b2PulleyJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_impulse",box2d.b2PulleyJoint.prototype.m_impulse);box2d.b2PulleyJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexA",box2d.b2PulleyJoint.prototype.m_indexA);box2d.b2PulleyJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexB",box2d.b2PulleyJoint.prototype.m_indexB);box2d.b2PulleyJoint.prototype.m_uA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uA",box2d.b2PulleyJoint.prototype.m_uA);box2d.b2PulleyJoint.prototype.m_uB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uB",box2d.b2PulleyJoint.prototype.m_uB);box2d.b2PulleyJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rA",box2d.b2PulleyJoint.prototype.m_rA);box2d.b2PulleyJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rB",box2d.b2PulleyJoint.prototype.m_rB);box2d.b2PulleyJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterA",box2d.b2PulleyJoint.prototype.m_localCenterA);box2d.b2PulleyJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterB",box2d.b2PulleyJoint.prototype.m_localCenterB);box2d.b2PulleyJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassA",box2d.b2PulleyJoint.prototype.m_invMassA);box2d.b2PulleyJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassB",box2d.b2PulleyJoint.prototype.m_invMassB);box2d.b2PulleyJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIA",box2d.b2PulleyJoint.prototype.m_invIA);box2d.b2PulleyJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIB",box2d.b2PulleyJoint.prototype.m_invIB);box2d.b2PulleyJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_mass",box2d.b2PulleyJoint.prototype.m_mass);box2d.b2PulleyJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qA",box2d.b2PulleyJoint.prototype.m_qA);box2d.b2PulleyJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qB",box2d.b2PulleyJoint.prototype.m_qB);box2d.b2PulleyJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcA",box2d.b2PulleyJoint.prototype.m_lalcA);box2d.b2PulleyJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcB",box2d.b2PulleyJoint.prototype.m_lalcB);box2d.b2PulleyJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].c,r=t.positions[this.m_indexB].a,s=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,b=this.m_qA.SetAngle(t.positions[this.m_indexA].a),r=this.m_qB.SetAngle(r);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(b,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(r,this.m_lalcB,this.m_rB);this.m_uA.Copy(e).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);this.m_uB.Copy(a).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);e=this.m_uA.Length();a=this.m_uB.Length();e>10*box2d.b2_linearSlop?this.m_uA.SelfMul(1/e):this.m_uA.SetZero();a>10*box2d.b2_linearSlop?this.m_uB.SelfMul(1/a):this.m_uB.SetZero();e=box2d.b2Cross_V2_V2(this.m_rA,this.m_uA);a=box2d.b2Cross_V2_V2(this.m_rB,this.m_uB);this.m_mass=this.m_invMassA+this.m_invIA*e*e+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*a*a);0<this.m_mass&&(this.m_mass=1/this.m_mass);t.step.warmStarting?(this.m_impulse*=t.step.dtRatio,e=box2d.b2Mul_S_V2(-this.m_impulse,this.m_uA,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA),a=box2d.b2Mul_S_V2(-this.m_ratio*this.m_impulse,this.m_uB,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB),o.SelfMulAdd(this.m_invMassA,e),i+=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,e),s.SelfMulAdd(this.m_invMassB,a),n+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,a)):this.m_impulse=0;t.velocities[this.m_indexA].w=i;t.velocities[this.m_indexB].w=n};goog.exportProperty(box2d.b2PulleyJoint.prototype,"InitVelocityConstraints",box2d.b2PulleyJoint.prototype.InitVelocityConstraints);box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA),s=box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB),r=-box2d.b2Dot_V2_V2(this.m_uA,r)-this.m_ratio*box2d.b2Dot_V2_V2(this.m_uB,s),s=-this.m_mass*r;this.m_impulse+=s;r=box2d.b2Mul_S_V2(-s,this.m_uA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA);s=box2d.b2Mul_S_V2(-this.m_ratio*s,this.m_uB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB);e.SelfMulAdd(this.m_invMassA,r);o+=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,r);i.SelfMulAdd(this.m_invMassB,s);a+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,s);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolveVelocityConstraints",box2d.b2PulleyJoint.prototype.SolveVelocityConstraints);box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);r=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var s=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),n=this.m_uA.Copy(e).SelfAdd(r).SelfSub(this.m_groundAnchorA),b=this.m_uB.Copy(i).SelfAdd(s).SelfSub(this.m_groundAnchorB),x=n.Length(),l=b.Length();x>10*box2d.b2_linearSlop?n.SelfMul(1/x):n.SetZero();l>10*box2d.b2_linearSlop?b.SelfMul(1/l):b.SetZero();var _=box2d.b2Cross_V2_V2(r,n),h=box2d.b2Cross_V2_V2(s,b),_=this.m_invMassA+this.m_invIA*_*_+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*h*h);0<_&&(_=1/_);l=this.m_constant-x-this.m_ratio*l;x=box2d.b2Abs(l);l*=-_;n=box2d.b2Mul_S_V2(-l,n,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA);b=box2d.b2Mul_S_V2(-this.m_ratio*l,b,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB);e.SelfMulAdd(this.m_invMassA,n);o+=this.m_invIA*box2d.b2Cross_V2_V2(r,n);i.SelfMulAdd(this.m_invMassB,b);a+=this.m_invIB*box2d.b2Cross_V2_V2(s,b);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return x<box2d.b2_linearSlop};goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolvePositionConstraints",box2d.b2PulleyJoint.prototype.SolvePositionConstraints);box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorA",box2d.b2PulleyJoint.prototype.GetAnchorA);box2d.b2PulleyJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorB",box2d.b2PulleyJoint.prototype.GetAnchorB);box2d.b2PulleyJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*this.m_impulse*this.m_uB.x,t*this.m_impulse*this.m_uB.y)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionForce",box2d.b2PulleyJoint.prototype.GetReactionForce);box2d.b2PulleyJoint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionTorque",box2d.b2PulleyJoint.prototype.GetReactionTorque);box2d.b2PulleyJoint.prototype.GetGroundAnchorA=function(t){return t.Copy(this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorA",box2d.b2PulleyJoint.prototype.GetGroundAnchorA);box2d.b2PulleyJoint.prototype.GetGroundAnchorB=function(t){return t.Copy(this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorB",box2d.b2PulleyJoint.prototype.GetGroundAnchorB);box2d.b2PulleyJoint.prototype.GetLengthA=function(){return this.m_lengthA};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthA",box2d.b2PulleyJoint.prototype.GetLengthA);box2d.b2PulleyJoint.prototype.GetLengthB=function(){return this.m_lengthB};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthB",box2d.b2PulleyJoint.prototype.GetLengthB);box2d.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetRatio",box2d.b2PulleyJoint.prototype.GetRatio);box2d.b2PulleyJoint.prototype.GetCurrentLengthA=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p);return box2d.b2Distance(t,this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthA",box2d.b2PulleyJoint.prototype.GetCurrentLengthA);box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetCurrentLengthB=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p);return box2d.b2Distance(t,this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthB",box2d.b2PulleyJoint.prototype.GetCurrentLengthB);box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PulleyJointDef*/ var jd = new box2d.b2PulleyJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y);box2d.b2Log("  jd.groundAnchorB.Set(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y);box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.lengthA = %.15f;\n",this.m_lengthA);box2d.b2Log("  jd.lengthB = %.15f;\n",this.m_lengthB);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2PulleyJoint.prototype,"Dump",box2d.b2PulleyJoint.prototype.Dump);box2d.b2PulleyJoint.prototype.ShiftOrigin=function(t){this.m_groundAnchorA.SelfSub(t);this.m_groundAnchorB.SelfSub(t)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"ShiftOrigin",box2d.b2PulleyJoint.prototype.ShiftOrigin);box2d.b2RevoluteJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_revoluteJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2RevoluteJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RevoluteJointDef",box2d.b2RevoluteJointDef);box2d.b2RevoluteJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorA",box2d.b2RevoluteJointDef.prototype.localAnchorA);box2d.b2RevoluteJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorB",box2d.b2RevoluteJointDef.prototype.localAnchorB);box2d.b2RevoluteJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"referenceAngle",box2d.b2RevoluteJointDef.prototype.referenceAngle);box2d.b2RevoluteJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableLimit",box2d.b2RevoluteJointDef.prototype.enableLimit);box2d.b2RevoluteJointDef.prototype.lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"lowerAngle",box2d.b2RevoluteJointDef.prototype.lowerAngle);box2d.b2RevoluteJointDef.prototype.upperAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"upperAngle",box2d.b2RevoluteJointDef.prototype.upperAngle);box2d.b2RevoluteJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableMotor",box2d.b2RevoluteJointDef.prototype.enableMotor);box2d.b2RevoluteJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"motorSpeed",box2d.b2RevoluteJointDef.prototype.motorSpeed);box2d.b2RevoluteJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"maxMotorTorque",box2d.b2RevoluteJointDef.prototype.maxMotorTorque);box2d.b2RevoluteJointDef.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(o,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"Initialize",box2d.b2RevoluteJointDef.prototype.Initialize);box2d.b2RevoluteJoint=function(t){box2d.b2Joint.call(this,t);this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec3;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;this.m_localAnchorA.Copy(t.localAnchorA);this.m_localAnchorB.Copy(t.localAnchorB);this.m_referenceAngle=t.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=t.lowerAngle;this.m_upperAngle=t.upperAngle;this.m_maxMotorTorque=t.maxMotorTorque;this.m_motorSpeed=t.motorSpeed;this.m_enableLimit=t.enableLimit;this.m_enableMotor=t.enableMotor;this.m_limitState=box2d.b2LimitState.e_inactiveLimit};goog.inherits(box2d.b2RevoluteJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2RevoluteJoint",box2d.b2RevoluteJoint);box2d.b2RevoluteJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorA",box2d.b2RevoluteJoint.prototype.m_localAnchorA);box2d.b2RevoluteJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorB",box2d.b2RevoluteJoint.prototype.m_localAnchorB);box2d.b2RevoluteJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_impulse",box2d.b2RevoluteJoint.prototype.m_impulse);box2d.b2RevoluteJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorImpulse",box2d.b2RevoluteJoint.prototype.m_motorImpulse);box2d.b2RevoluteJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableMotor",box2d.b2RevoluteJoint.prototype.m_enableMotor);box2d.b2RevoluteJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_maxMotorTorque",box2d.b2RevoluteJoint.prototype.m_maxMotorTorque);box2d.b2RevoluteJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorSpeed",box2d.b2RevoluteJoint.prototype.m_motorSpeed);box2d.b2RevoluteJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableLimit",box2d.b2RevoluteJoint.prototype.m_enableLimit);box2d.b2RevoluteJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_referenceAngle",box2d.b2RevoluteJoint.prototype.m_referenceAngle);box2d.b2RevoluteJoint.prototype.m_lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lowerAngle",box2d.b2RevoluteJoint.prototype.m_lowerAngle);box2d.b2RevoluteJoint.prototype.m_upperAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_upperAngle",box2d.b2RevoluteJoint.prototype.m_upperAngle);box2d.b2RevoluteJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexA",box2d.b2RevoluteJoint.prototype.m_indexA);box2d.b2RevoluteJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexB",box2d.b2RevoluteJoint.prototype.m_indexB);box2d.b2RevoluteJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rA",box2d.b2RevoluteJoint.prototype.m_rA);box2d.b2RevoluteJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rB",box2d.b2RevoluteJoint.prototype.m_rB);box2d.b2RevoluteJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterA",box2d.b2RevoluteJoint.prototype.m_localCenterA);box2d.b2RevoluteJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterB",box2d.b2RevoluteJoint.prototype.m_localCenterB);box2d.b2RevoluteJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassA",box2d.b2RevoluteJoint.prototype.m_invMassA);box2d.b2RevoluteJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassB",box2d.b2RevoluteJoint.prototype.m_invMassB);box2d.b2RevoluteJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIA",box2d.b2RevoluteJoint.prototype.m_invIA);box2d.b2RevoluteJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIB",box2d.b2RevoluteJoint.prototype.m_invIB);box2d.b2RevoluteJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_mass",box2d.b2RevoluteJoint.prototype.m_mass);box2d.b2RevoluteJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorMass",box2d.b2RevoluteJoint.prototype.m_motorMass);box2d.b2RevoluteJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_limitState",box2d.b2RevoluteJoint.prototype.m_limitState);box2d.b2RevoluteJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qA",box2d.b2RevoluteJoint.prototype.m_qA);box2d.b2RevoluteJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qB",box2d.b2RevoluteJoint.prototype.m_qB);box2d.b2RevoluteJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcA",box2d.b2RevoluteJoint.prototype.m_lalcA);box2d.b2RevoluteJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcB",box2d.b2RevoluteJoint.prototype.m_lalcB);box2d.b2RevoluteJoint.prototype.m_K=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_K",box2d.b2RevoluteJoint.prototype.m_K);box2d.b2RevoluteJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].a,r=t.velocities[this.m_indexB].v,s=t.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(e),b=this.m_qB.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(b,this.m_lalcB,this.m_rB);var n=this.m_invMassA,b=this.m_invMassB,x=this.m_invIA,l=this.m_invIB,_=0===x+l;this.m_mass.ex.x=n+b+this.m_rA.y*this.m_rA.y*x+this.m_rB.y*this.m_rB.y*l;this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*x-this.m_rB.y*this.m_rB.x*l;this.m_mass.ez.x=-this.m_rA.y*x-this.m_rB.y*l;this.m_mass.ex.y=this.m_mass.ey.x;this.m_mass.ey.y=n+b+this.m_rA.x*this.m_rA.x*x+this.m_rB.x*this.m_rB.x*l;this.m_mass.ez.y=this.m_rA.x*x+this.m_rB.x*l;this.m_mass.ex.z=this.m_mass.ez.x;this.m_mass.ey.z=this.m_mass.ez.y;this.m_mass.ez.z=x+l;this.m_motorMass=x+l;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);if(!this.m_enableMotor||_)this.m_motorImpulse=0;this.m_enableLimit&&!_?(e=a-e-this.m_referenceAngle,box2d.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*box2d.b2_angularSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:e<=this.m_lowerAngle?(this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atLowerLimit):e>=this.m_upperAngle?(this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atUpperLimit):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)):this.m_limitState=box2d.b2LimitState.e_inactiveLimit;t.step.warmStarting?(this.m_impulse.SelfMulScalar(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio,e=box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P.Set(this.m_impulse.x,this.m_impulse.y),o.SelfMulSub(n,e),i-=x*(box2d.b2Cross_V2_V2(this.m_rA,e)+this.m_motorImpulse+this.m_impulse.z),r.SelfMulAdd(b,e),s+=l*(box2d.b2Cross_V2_V2(this.m_rB,e)+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0);t.velocities[this.m_indexA].w=i;t.velocities[this.m_indexB].w=s};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"InitVelocityConstraints",box2d.b2RevoluteJoint.prototype.InitVelocityConstraints);box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=this.m_invMassA,s=this.m_invMassB,n=this.m_invIA,b=this.m_invIB,x=0===n+b;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits&&!x){var l=a-o-this.m_motorSpeed,l=-this.m_motorMass*l,_=this.m_motorImpulse,h=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+l,-h,h);l=this.m_motorImpulse-_;o-=n*l;a+=b*l}this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!x?(x=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1),l=this.m_mass.Solve33(x.x,x.y,a-o,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3).SelfNeg(),this.m_limitState===box2d.b2LimitState.e_equalLimits?this.m_impulse.SelfAdd(l):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(_=this.m_impulse.z+l.z,0>_?(_=-x.x+this.m_impulse.z*this.m_mass.ez.x,x=-x.y+this.m_impulse.z*this.m_mass.ez.y,x=this.m_mass.Solve22(_,x,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),l.x=x.x,l.y=x.y,l.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(l)):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(_=this.m_impulse.z+l.z,0<_?(_=-x.x+this.m_impulse.z*this.m_mass.ez.x,x=-x.y+this.m_impulse.z*this.m_mass.ez.y,x=this.m_mass.Solve22(_,x,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),l.x=x.x,l.y=x.y,l.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(l)),x=box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P.Set(l.x,l.y),e.SelfMulSub(r,x),o-=n*(box2d.b2Cross_V2_V2(this.m_rA,x)+l.z),i.SelfMulAdd(s,x),a+=b*(box2d.b2Cross_V2_V2(this.m_rB,x)+l.z)):(l=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot),l=this.m_mass.Solve22(-l.x,-l.y,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2),this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,e.SelfMulSub(r,l),o-=n*box2d.b2Cross_V2_V2(this.m_rA,l),i.SelfMulAdd(s,l),a+=b*box2d.b2Cross_V2_V2(this.m_rB,l));t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolveVelocityConstraints",box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints);box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3=new box2d.b2Vec3;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a),n=0,b=0,b=0===this.m_invIA+this.m_invIB;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!b){var x=a-o-this.m_referenceAngle,b=0;this.m_limitState===box2d.b2LimitState.e_equalLimits?(x=box2d.b2Clamp(x-this.m_lowerAngle,-box2d.b2_maxAngularCorrection,box2d.b2_maxAngularCorrection),b=-this.m_motorMass*x,n=box2d.b2Abs(x)):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(x-=this.m_lowerAngle,n=-x,x=box2d.b2Clamp(x+box2d.b2_angularSlop,-box2d.b2_maxAngularCorrection,0),b=-this.m_motorMass*x):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(n=x-=this.m_upperAngle,x=box2d.b2Clamp(x-box2d.b2_angularSlop,0,box2d.b2_maxAngularCorrection),b=-this.m_motorMass*x);o-=this.m_invIA*b;a+=this.m_invIB*b}r.SetAngle(o);s.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);r=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var s=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),x=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(i,s,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,r,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C),b=x.Length(),l=this.m_invMassA,_=this.m_invMassB,h=this.m_invIA,d=this.m_invIB,p=this.m_K;p.ex.x=l+_+h*r.y*r.y+d*s.y*s.y;p.ex.y=-h*r.x*r.y-d*s.x*s.y;p.ey.x=p.ex.y;p.ey.y=l+_+h*r.x*r.x+d*s.x*s.x;x=p.Solve(x.x,x.y,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg();e.SelfMulSub(l,x);o-=h*box2d.b2Cross_V2_V2(r,x);i.SelfMulAdd(_,x);a+=d*box2d.b2Cross_V2_V2(s,x);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return b<=box2d.b2_linearSlop&&n<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolvePositionConstraints",box2d.b2RevoluteJoint.prototype.SolvePositionConstraints);box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorA",box2d.b2RevoluteJoint.prototype.GetAnchorA);box2d.b2RevoluteJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorB",box2d.b2RevoluteJoint.prototype.GetAnchorB);box2d.b2RevoluteJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*this.m_impulse.x,t*this.m_impulse.y)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionForce",box2d.b2RevoluteJoint.prototype.GetReactionForce);box2d.b2RevoluteJoint.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionTorque",box2d.b2RevoluteJoint.prototype.GetReactionTorque);box2d.b2RevoluteJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorA",box2d.b2RevoluteJoint.prototype.GetLocalAnchorA);box2d.b2RevoluteJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorB",box2d.b2RevoluteJoint.prototype.GetLocalAnchorB);box2d.b2RevoluteJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReferenceAngle",box2d.b2RevoluteJoint.prototype.GetReferenceAngle);box2d.b2RevoluteJoint.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointAngle",box2d.b2RevoluteJoint.prototype.GetJointAngle);box2d.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointSpeed",box2d.b2RevoluteJoint.prototype.GetJointSpeed);box2d.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsMotorEnabled",box2d.b2RevoluteJoint.prototype.IsMotorEnabled);box2d.b2RevoluteJoint.prototype.EnableMotor=function(t){this.m_enableMotor!==t&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableMotor",box2d.b2RevoluteJoint.prototype.EnableMotor);box2d.b2RevoluteJoint.prototype.GetMotorTorque=function(t){return t*this.m_motorImpulse};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorTorque",box2d.b2RevoluteJoint.prototype.GetMotorTorque);box2d.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorSpeed",box2d.b2RevoluteJoint.prototype.GetMotorSpeed);box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(t){this.m_maxMotorTorque=t};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque);box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque);box2d.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsLimitEnabled",box2d.b2RevoluteJoint.prototype.IsLimitEnabled);box2d.b2RevoluteJoint.prototype.EnableLimit=function(t){t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableLimit",box2d.b2RevoluteJoint.prototype.EnableLimit);box2d.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLowerLimit",box2d.b2RevoluteJoint.prototype.GetLowerLimit);box2d.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetUpperLimit",box2d.b2RevoluteJoint.prototype.GetUpperLimit);box2d.b2RevoluteJoint.prototype.SetLimits=function(t,e){if(t!==this.m_lowerAngle||e!==this.m_upperAngle)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetLimits",box2d.b2RevoluteJoint.prototype.SetLimits);box2d.b2RevoluteJoint.prototype.SetMotorSpeed=function(t){this.m_motorSpeed!==t&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMotorSpeed",box2d.b2RevoluteJoint.prototype.SetMotorSpeed);box2d.b2RevoluteJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RevoluteJointDef*/ var jd = new box2d.b2RevoluteJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle);box2d.b2Log("  jd.upperAngle = %.15f;\n",this.m_upperAngle);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"Dump",box2d.b2RevoluteJoint.prototype.Dump);box2d.b2GearJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_gearJoint)};goog.inherits(box2d.b2GearJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2GearJointDef",box2d.b2GearJointDef);box2d.b2GearJointDef.prototype.joint1=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint1",box2d.b2GearJointDef.prototype.joint1);box2d.b2GearJointDef.prototype.joint2=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint2",box2d.b2GearJointDef.prototype.joint2);box2d.b2GearJointDef.prototype.ratio=1;goog.exportProperty(box2d.b2GearJointDef.prototype,"ratio",box2d.b2GearJointDef.prototype.ratio);box2d.b2GearJoint=function(t){box2d.b2Joint.call(this,t);this.m_joint1=t.joint1;this.m_joint2=t.joint2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_localAnchorC=new box2d.b2Vec2;this.m_localAnchorD=new box2d.b2Vec2;this.m_localAxisC=new box2d.b2Vec2;this.m_localAxisD=new box2d.b2Vec2;this.m_lcA=new box2d.b2Vec2;this.m_lcB=new box2d.b2Vec2;this.m_lcC=new box2d.b2Vec2;this.m_lcD=new box2d.b2Vec2;this.m_JvAC=new box2d.b2Vec2;this.m_JvBD=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_qC=new box2d.b2Rot;this.m_qD=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_lalcC=new box2d.b2Vec2;this.m_lalcD=new box2d.b2Vec2;this.m_typeA=this.m_joint1.GetType();this.m_typeB=this.m_joint2.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeA===box2d.b2JointType.e_revoluteJoint||this.m_typeA===box2d.b2JointType.e_prismaticJoint);box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeB===box2d.b2JointType.e_revoluteJoint||this.m_typeB===box2d.b2JointType.e_prismaticJoint);var e,o;this.m_bodyC=this.m_joint1.GetBodyA();this.m_bodyA=this.m_joint1.GetBodyB();e=this.m_bodyA.m_xf;var i=this.m_bodyA.m_sweep.a;o=this.m_bodyC.m_xf;var a=this.m_bodyC.m_sweep.a;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(o=t.joint1,this.m_localAnchorC.Copy(o.m_localAnchorA),this.m_localAnchorA.Copy(o.m_localAnchorB),this.m_referenceAngleA=o.m_referenceAngle,this.m_localAxisC.SetZero(),e=i-a-this.m_referenceAngleA):(a=t.joint1,this.m_localAnchorC.Copy(a.m_localAnchorA),this.m_localAnchorA.Copy(a.m_localAnchorB),this.m_referenceAngleA=a.m_referenceAngle,this.m_localAxisC.Copy(a.m_localXAxisA),i=this.m_localAnchorC,e=box2d.b2MulT_R_V2(o.q,box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(e.q,this.m_localAnchorA,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(e.p,o.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),e=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(e,i,box2d.b2Vec2.s_t0),this.m_localAxisC));this.m_bodyD=this.m_joint2.GetBodyA();this.m_bodyB=this.m_joint2.GetBodyB();o=this.m_bodyB.m_xf;var a=this.m_bodyB.m_sweep.a,i=this.m_bodyD.m_xf,r=this.m_bodyD.m_sweep.a;this.m_typeB===box2d.b2JointType.e_revoluteJoint?(o=t.joint2,this.m_localAnchorD.Copy(o.m_localAnchorA),this.m_localAnchorB.Copy(o.m_localAnchorB),this.m_referenceAngleB=o.m_referenceAngle,this.m_localAxisD.SetZero(),o=a-r-this.m_referenceAngleB):(a=t.joint2,this.m_localAnchorD.Copy(a.m_localAnchorA),this.m_localAnchorB.Copy(a.m_localAnchorB),this.m_referenceAngleB=a.m_referenceAngle,this.m_localAxisD.Copy(a.m_localXAxisA),a=this.m_localAnchorD,o=box2d.b2MulT_R_V2(i.q,box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(o.q,this.m_localAnchorB,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(o.p,i.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),o=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(o,a,box2d.b2Vec2.s_t0),this.m_localAxisD));this.m_ratio=t.ratio;this.m_constant=e+this.m_ratio*o;this.m_impulse=0};goog.inherits(box2d.b2GearJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2GearJoint",box2d.b2GearJoint);box2d.b2GearJoint.prototype.m_joint1=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint1",box2d.b2GearJoint.prototype.m_joint1);box2d.b2GearJoint.prototype.m_joint2=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint2",box2d.b2GearJoint.prototype.m_joint2);box2d.b2GearJoint.prototype.m_typeA=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeA",box2d.b2GearJoint.prototype.m_typeA);box2d.b2GearJoint.prototype.m_typeB=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeB",box2d.b2GearJoint.prototype.m_typeB);box2d.b2GearJoint.prototype.m_bodyC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyC",box2d.b2GearJoint.prototype.m_bodyC);box2d.b2GearJoint.prototype.m_bodyD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyD",box2d.b2GearJoint.prototype.m_bodyD);box2d.b2GearJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorA",box2d.b2GearJoint.prototype.m_localAnchorA);box2d.b2GearJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorB",box2d.b2GearJoint.prototype.m_localAnchorB);box2d.b2GearJoint.prototype.m_localAnchorC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorC",box2d.b2GearJoint.prototype.m_localAnchorC);box2d.b2GearJoint.prototype.m_localAnchorD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorD",box2d.b2GearJoint.prototype.m_localAnchorD);box2d.b2GearJoint.prototype.m_localAxisC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisC",box2d.b2GearJoint.prototype.m_localAxisC);box2d.b2GearJoint.prototype.m_localAxisD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisD",box2d.b2GearJoint.prototype.m_localAxisD);box2d.b2GearJoint.prototype.m_referenceAngleA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleA",box2d.b2GearJoint.prototype.m_referenceAngleA);box2d.b2GearJoint.prototype.m_referenceAngleB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleB",box2d.b2GearJoint.prototype.m_referenceAngleB);box2d.b2GearJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_constant",box2d.b2GearJoint.prototype.m_constant);box2d.b2GearJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_ratio",box2d.b2GearJoint.prototype.m_ratio);box2d.b2GearJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_impulse",box2d.b2GearJoint.prototype.m_impulse);box2d.b2GearJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexA",box2d.b2GearJoint.prototype.m_indexA);box2d.b2GearJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexB",box2d.b2GearJoint.prototype.m_indexB);box2d.b2GearJoint.prototype.m_indexC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexC",box2d.b2GearJoint.prototype.m_indexC);box2d.b2GearJoint.prototype.m_indexD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexD",box2d.b2GearJoint.prototype.m_indexD);box2d.b2GearJoint.prototype.m_lcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcA",box2d.b2GearJoint.prototype.m_lcA);box2d.b2GearJoint.prototype.m_lcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcB",box2d.b2GearJoint.prototype.m_lcB);box2d.b2GearJoint.prototype.m_lcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcC",box2d.b2GearJoint.prototype.m_lcC);box2d.b2GearJoint.prototype.m_lcD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcD",box2d.b2GearJoint.prototype.m_lcD);box2d.b2GearJoint.prototype.m_mA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mA",box2d.b2GearJoint.prototype.m_mA);box2d.b2GearJoint.prototype.m_mB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mB",box2d.b2GearJoint.prototype.m_mB);box2d.b2GearJoint.prototype.m_mC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mC",box2d.b2GearJoint.prototype.m_mC);box2d.b2GearJoint.prototype.m_mD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mD",box2d.b2GearJoint.prototype.m_mD);box2d.b2GearJoint.prototype.m_iA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iA",box2d.b2GearJoint.prototype.m_iA);box2d.b2GearJoint.prototype.m_iB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iB",box2d.b2GearJoint.prototype.m_iB);box2d.b2GearJoint.prototype.m_iC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iC",box2d.b2GearJoint.prototype.m_iC);box2d.b2GearJoint.prototype.m_iD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iD",box2d.b2GearJoint.prototype.m_iD);box2d.b2GearJoint.prototype.m_JvAC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvAC",box2d.b2GearJoint.prototype.m_JvAC);box2d.b2GearJoint.prototype.m_JvBD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvBD",box2d.b2GearJoint.prototype.m_JvBD);box2d.b2GearJoint.prototype.m_JwA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwA",box2d.b2GearJoint.prototype.m_JwA);box2d.b2GearJoint.prototype.m_JwB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwB",box2d.b2GearJoint.prototype.m_JwB);box2d.b2GearJoint.prototype.m_JwC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwC",box2d.b2GearJoint.prototype.m_JwC);box2d.b2GearJoint.prototype.m_JwD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwD",box2d.b2GearJoint.prototype.m_JwD);box2d.b2GearJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mass",box2d.b2GearJoint.prototype.m_mass);box2d.b2GearJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qA",box2d.b2GearJoint.prototype.m_qA);box2d.b2GearJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qB",box2d.b2GearJoint.prototype.m_qB);box2d.b2GearJoint.prototype.m_qC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qC",box2d.b2GearJoint.prototype.m_qC);box2d.b2GearJoint.prototype.m_qD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qD",box2d.b2GearJoint.prototype.m_qD);box2d.b2GearJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcA",box2d.b2GearJoint.prototype.m_lalcA);box2d.b2GearJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcB",box2d.b2GearJoint.prototype.m_lalcB);box2d.b2GearJoint.prototype.m_lalcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcC",box2d.b2GearJoint.prototype.m_lalcC);box2d.b2GearJoint.prototype.m_lalcD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcD",box2d.b2GearJoint.prototype.m_lalcD);box2d.b2GearJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_indexC=this.m_bodyC.m_islandIndex;this.m_indexD=this.m_bodyD.m_islandIndex;this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter);this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter);this.m_mA=this.m_bodyA.m_invMass;this.m_mB=this.m_bodyB.m_invMass;this.m_mC=this.m_bodyC.m_invMass;this.m_mD=this.m_bodyD.m_invMass;this.m_iA=this.m_bodyA.m_invI;this.m_iB=this.m_bodyB.m_invI;this.m_iC=this.m_bodyC.m_invI;this.m_iD=this.m_bodyD.m_invI;var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.positions[this.m_indexB].a,a=t.velocities[this.m_indexB].v,r=t.velocities[this.m_indexB].w,s=t.positions[this.m_indexC].a,n=t.velocities[this.m_indexC].v,b=t.velocities[this.m_indexC].w,x=t.positions[this.m_indexD].a,l=t.velocities[this.m_indexD].v,_=t.velocities[this.m_indexD].w,h=this.m_qA.SetAngle(t.positions[this.m_indexA].a),i=this.m_qB.SetAngle(i),d=this.m_qC.SetAngle(s),s=this.m_qD.SetAngle(x);this.m_mass=0;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(this.m_JvAC.SetZero(),this.m_JwC=this.m_JwA=1,this.m_mass+=this.m_iA+this.m_iC):(x=box2d.b2Mul_R_V2(d,this.m_localAxisC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2Sub_V2_V2(this.m_localAnchorC,this.m_lcC,this.m_lalcC),d=box2d.b2Mul_R_V2(d,this.m_lalcC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC),box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_lcA,this.m_lalcA),h=box2d.b2Mul_R_V2(h,this.m_lalcA,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA),this.m_JvAC.Copy(x),this.m_JwC=box2d.b2Cross_V2_V2(d,x),this.m_JwA=box2d.b2Cross_V2_V2(h,x),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA);this.m_typeB===box2d.b2JointType.e_revoluteJoint?(this.m_JvBD.SetZero(),this.m_JwD=this.m_JwB=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD)):(x=box2d.b2Mul_R_V2(s,this.m_localAxisD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2Sub_V2_V2(this.m_localAnchorD,this.m_lcD,this.m_lalcD),h=box2d.b2Mul_R_V2(s,this.m_lalcD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD),box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_lcB,this.m_lalcB),i=box2d.b2Mul_R_V2(i,this.m_lalcB,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB),box2d.b2Mul_S_V2(this.m_ratio,x,this.m_JvBD),this.m_JwD=this.m_ratio*box2d.b2Cross_V2_V2(h,x),this.m_JwB=this.m_ratio*box2d.b2Cross_V2_V2(i,x),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB);this.m_mass=0<this.m_mass?1/this.m_mass:0;t.step.warmStarting?(e.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,a.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),r+=this.m_iB*this.m_impulse*this.m_JwB,n.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),b-=this.m_iC*this.m_impulse*this.m_JwC,l.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),_-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0;t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=r;t.velocities[this.m_indexC].w=b;t.velocities[this.m_indexD].w=_};box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=t.velocities[this.m_indexC].v,s=t.velocities[this.m_indexC].w,n=t.velocities[this.m_indexD].v,b=t.velocities[this.m_indexD].w,x=box2d.b2Dot_V2_V2(this.m_JvAC,box2d.b2Sub_V2_V2(e,r,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(this.m_JvBD,box2d.b2Sub_V2_V2(i,n,box2d.b2Vec2.s_t0)),x=x+(this.m_JwA*o-this.m_JwC*s+(this.m_JwB*a-this.m_JwD*b)),x=-this.m_mass*x;this.m_impulse+=x;e.SelfMulAdd(this.m_mA*x,this.m_JvAC);o+=this.m_iA*x*this.m_JwA;i.SelfMulAdd(this.m_mB*x,this.m_JvBD);a+=this.m_iB*x*this.m_JwB;r.SelfMulSub(this.m_mC*x,this.m_JvAC);s-=this.m_iC*x*this.m_JwC;n.SelfMulSub(this.m_mD*x,this.m_JvBD);b-=this.m_iD*x*this.m_JwD;t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a;t.velocities[this.m_indexC].w=s;t.velocities[this.m_indexD].w=b};box2d.b2GearJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=t.positions[this.m_indexC].c,s=t.positions[this.m_indexC].a,n=t.positions[this.m_indexD].c,b=t.positions[this.m_indexD].a,x=this.m_qA.SetAngle(o),l=this.m_qB.SetAngle(a),_=this.m_qC.SetAngle(s),h=this.m_qD.SetAngle(b),d=this.m_JvAC,p=this.m_JvBD,c,u,y=0;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint)d.SetZero(),x=c=1,y+=this.m_iA+this.m_iC,_=o-s-this.m_referenceAngleA;else{u=box2d.b2Mul_R_V2(_,this.m_localAxisC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);c=box2d.b2Mul_R_V2(_,this.m_lalcC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC);var m=box2d.b2Mul_R_V2(x,this.m_lalcA,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA);d.Copy(u);x=box2d.b2Cross_V2_V2(c,u);c=box2d.b2Cross_V2_V2(m,u);y+=this.m_mC+this.m_mA+this.m_iC*x*x+this.m_iA*c*c;u=this.m_lalcC;_=box2d.b2MulT_R_V2(_,box2d.b2Add_V2_V2(m,box2d.b2Sub_V2_V2(e,r,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);_=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(_,u,box2d.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint)p.SetZero(),l=u=this.m_ratio,y+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),h=a-b-this.m_referenceAngleB;else{u=box2d.b2Mul_R_V2(h,this.m_localAxisD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);var f=box2d.b2Mul_R_V2(h,this.m_lalcD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD),m=box2d.b2Mul_R_V2(l,this.m_lalcB,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB);box2d.b2Mul_S_V2(this.m_ratio,u,p);l=this.m_ratio*box2d.b2Cross_V2_V2(f,u);u=this.m_ratio*box2d.b2Cross_V2_V2(m,u);y+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*l*l+this.m_iB*u*u;f=this.m_lalcD;h=box2d.b2MulT_R_V2(h,box2d.b2Add_V2_V2(m,box2d.b2Sub_V2_V2(i,n,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);h=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(h,f,box2d.b2Vec2.s_t0),this.m_localAxisD)}h=_+this.m_ratio*h-this.m_constant;_=0;0<y&&(_=-h/y);e.SelfMulAdd(this.m_mA*_,d);o+=this.m_iA*_*c;i.SelfMulAdd(this.m_mB*_,p);a+=this.m_iB*_*u;r.SelfMulSub(this.m_mC*_,d);s-=this.m_iC*_*x;n.SelfMulSub(this.m_mD*_,p);b-=this.m_iD*_*l;t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;t.positions[this.m_indexC].a=s;t.positions[this.m_indexD].a=b;return 0<box2d.b2_linearSlop};goog.exportProperty(box2d.b2GearJoint.prototype,"SolvePositionConstraints",box2d.b2GearJoint.prototype.SolvePositionConstraints);box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorA",box2d.b2GearJoint.prototype.GetAnchorA);box2d.b2GearJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorB",box2d.b2GearJoint.prototype.GetAnchorB);box2d.b2GearJoint.prototype.GetReactionForce=function(t,e){return box2d.b2Mul_S_V2(t*this.m_impulse,this.m_JvAC,e)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionForce",box2d.b2GearJoint.prototype.GetReactionForce);box2d.b2GearJoint.prototype.GetReactionTorque=function(t){return t*this.m_impulse*this.m_JwA};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionTorque",box2d.b2GearJoint.prototype.GetReactionTorque);box2d.b2GearJoint.prototype.GetJoint1=function(){return this.m_joint1};goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint1",box2d.b2GearJoint.prototype.GetJoint1);box2d.b2GearJoint.prototype.GetJoint2=function(){return this.m_joint2};goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint2",box2d.b2GearJoint.prototype.GetJoint2);box2d.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2GearJoint.prototype,"GetRatio",box2d.b2GearJoint.prototype.GetRatio);box2d.b2GearJoint.prototype.SetRatio=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(t));this.m_ratio=t};goog.exportProperty(box2d.b2GearJoint.prototype,"SetRatio",box2d.b2GearJoint.prototype.SetRatio);box2d.b2GearJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex,o=this.m_joint1.m_index,i=this.m_joint2.m_index;box2d.b2Log("  /*box2d.b2GearJointDef*/ var jd = new box2d.b2GearJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.joint1 = joints[%d];\n",o);box2d.b2Log("  jd.joint2 = joints[%d];\n",i);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2GearJoint.prototype,"Dump",box2d.b2GearJoint.prototype.Dump);box2d.b2RopeJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_ropeJoint);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2RopeJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RopeJointDef",box2d.b2RopeJointDef);box2d.b2RopeJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorA",box2d.b2RopeJointDef.prototype.localAnchorA);box2d.b2RopeJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorB",box2d.b2RopeJointDef.prototype.localAnchorB);box2d.b2RopeJointDef.prototype.maxLength=0;goog.exportProperty(box2d.b2RopeJointDef.prototype,"maxLength",box2d.b2RopeJointDef.prototype.maxLength);box2d.b2RopeJoint=function(t){box2d.b2Joint.call(this,t);this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_maxLength=t.maxLength;this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2};goog.inherits(box2d.b2RopeJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2RopeJoint",box2d.b2RopeJoint);box2d.b2RopeJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorA",box2d.b2RopeJoint.prototype.m_localAnchorA);box2d.b2RopeJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorB",box2d.b2RopeJoint.prototype.m_localAnchorB);box2d.b2RopeJoint.prototype.m_maxLength=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_maxLength",box2d.b2RopeJoint.prototype.m_maxLength);box2d.b2RopeJoint.prototype.m_length=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_length",box2d.b2RopeJoint.prototype.m_length);box2d.b2RopeJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_impulse",box2d.b2RopeJoint.prototype.m_impulse);box2d.b2RopeJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexA",box2d.b2RopeJoint.prototype.m_indexA);box2d.b2RopeJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexB",box2d.b2RopeJoint.prototype.m_indexB);box2d.b2RopeJoint.prototype.m_u=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_u",box2d.b2RopeJoint.prototype.m_u);box2d.b2RopeJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rA",box2d.b2RopeJoint.prototype.m_rA);box2d.b2RopeJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rB",box2d.b2RopeJoint.prototype.m_rB);box2d.b2RopeJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterA",box2d.b2RopeJoint.prototype.m_localCenterA);box2d.b2RopeJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterB",box2d.b2RopeJoint.prototype.m_localCenterB);box2d.b2RopeJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassA",box2d.b2RopeJoint.prototype.m_invMassA);box2d.b2RopeJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassB",box2d.b2RopeJoint.prototype.m_invMassB);box2d.b2RopeJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIA",box2d.b2RopeJoint.prototype.m_invIA);box2d.b2RopeJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIB",box2d.b2RopeJoint.prototype.m_invIB);box2d.b2RopeJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_mass",box2d.b2RopeJoint.prototype.m_mass);box2d.b2RopeJoint.prototype.m_state=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_state",box2d.b2RopeJoint.prototype.m_state);box2d.b2RopeJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qA",box2d.b2RopeJoint.prototype.m_qA);box2d.b2RopeJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qB",box2d.b2RopeJoint.prototype.m_qB);box2d.b2RopeJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcA",box2d.b2RopeJoint.prototype.m_lalcA);box2d.b2RopeJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcB",box2d.b2RopeJoint.prototype.m_lalcB);box2d.b2RopeJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].c,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].c,r=t.positions[this.m_indexB].a,s=t.velocities[this.m_indexB].v,n=t.velocities[this.m_indexB].w,b=this.m_qA.SetAngle(t.positions[this.m_indexA].a),r=this.m_qB.SetAngle(r);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(b,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(r,this.m_lalcB,this.m_rB);this.m_u.Copy(a).SelfAdd(this.m_rB).SelfSub(e).SelfSub(this.m_rA);this.m_length=this.m_u.Length();this.m_state=0<this.m_length-this.m_maxLength?box2d.b2LimitState.e_atUpperLimit:box2d.b2LimitState.e_inactiveLimit;this.m_length>box2d.b2_linearSlop?(this.m_u.SelfMul(1/this.m_length),e=box2d.b2Cross_V2_V2(this.m_rA,this.m_u),a=box2d.b2Cross_V2_V2(this.m_rB,this.m_u),e=this.m_invMassA+this.m_invIA*e*e+this.m_invMassB+this.m_invIB*a*a,this.m_mass=0!==e?1/e:0,t.step.warmStarting?(this.m_impulse*=t.step.dtRatio,e=box2d.b2Mul_S_V2(this.m_impulse,this.m_u,box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P),o.SelfMulSub(this.m_invMassA,e),i-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,e),s.SelfMulAdd(this.m_invMassB,e),n+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,e)):this.m_impulse=0,t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=n):(this.m_u.SetZero(),this.m_impulse=this.m_mass=0)};goog.exportProperty(box2d.b2RopeJoint.prototype,"InitVelocityConstraints",box2d.b2RopeJoint.prototype.InitVelocityConstraints);box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA),s=box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB),n=this.m_length-this.m_maxLength,r=box2d.b2Dot_V2_V2(this.m_u,box2d.b2Sub_V2_V2(s,r,box2d.b2Vec2.s_t0));0>n&&(r+=t.step.inv_dt*n);n=-this.m_mass*r;r=this.m_impulse;this.m_impulse=box2d.b2Min(0,this.m_impulse+n);n=this.m_impulse-r;n=box2d.b2Mul_S_V2(n,this.m_u,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P);e.SelfMulSub(this.m_invMassA,n);o-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,n);i.SelfMulAdd(this.m_invMassB,n);a+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,n);t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2RopeJoint.prototype,"SolveVelocityConstraints",box2d.b2RopeJoint.prototype.SolveVelocityConstraints);box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);r=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var s=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),n=this.m_u.Copy(i).SelfAdd(s).SelfSub(e).SelfSub(r),b=n.Normalize(),x=b-this.m_maxLength,x=box2d.b2Clamp(x,0,box2d.b2_maxLinearCorrection),n=box2d.b2Mul_S_V2(-this.m_mass*x,n,box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P);e.SelfMulSub(this.m_invMassA,n);o-=this.m_invIA*box2d.b2Cross_V2_V2(r,n);i.SelfMulAdd(this.m_invMassB,n);a+=this.m_invIB*box2d.b2Cross_V2_V2(s,n);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return b-this.m_maxLength<box2d.b2_linearSlop};goog.exportProperty(box2d.b2RopeJoint.prototype,"SolvePositionConstraints",box2d.b2RopeJoint.prototype.SolvePositionConstraints);box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorA",box2d.b2RopeJoint.prototype.GetAnchorA);box2d.b2RopeJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorB",box2d.b2RopeJoint.prototype.GetAnchorB);box2d.b2RopeJoint.prototype.GetReactionForce=function(t,e){return box2d.b2Mul_S_V2(t*this.m_impulse,this.m_u,e)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionForce",box2d.b2RopeJoint.prototype.GetReactionForce);box2d.b2RopeJoint.prototype.GetReactionTorque=function(t){return 0};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionTorque",box2d.b2RopeJoint.prototype.GetReactionTorque);box2d.b2RopeJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorA",box2d.b2RopeJoint.prototype.GetLocalAnchorA);box2d.b2RopeJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorB",box2d.b2RopeJoint.prototype.GetLocalAnchorB);box2d.b2RopeJoint.prototype.SetMaxLength=function(t){this.m_maxLength=t};goog.exportProperty(box2d.b2RopeJoint.prototype,"SetMaxLength",box2d.b2RopeJoint.prototype.SetMaxLength);box2d.b2RopeJoint.prototype.GetMaxLength=function(){return this.m_maxLength};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetMaxLength",box2d.b2RopeJoint.prototype.GetMaxLength);box2d.b2RopeJoint.prototype.GetLimitState=function(){return this.m_state};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLimitState",box2d.b2RopeJoint.prototype.GetLimitState);box2d.b2RopeJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RopeJointDef*/ var jd = new box2d.b2RopeJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxLength = %.15f;\n",this.m_maxLength);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RopeJoint.prototype,"Dump",box2d.b2RopeJoint.prototype.Dump);box2d.b2WeldJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_weldJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2WeldJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2WeldJointDef",box2d.b2WeldJointDef);box2d.b2WeldJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorA",box2d.b2WeldJointDef.prototype.localAnchorA);box2d.b2WeldJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorB",box2d.b2WeldJointDef.prototype.localAnchorB);box2d.b2WeldJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"referenceAngle",box2d.b2WeldJointDef.prototype.referenceAngle);box2d.b2WeldJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"frequencyHz",box2d.b2WeldJointDef.prototype.frequencyHz);box2d.b2WeldJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"dampingRatio",box2d.b2WeldJointDef.prototype.dampingRatio);box2d.b2WeldJointDef.prototype.Initialize=function(t,e,o){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(o,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};goog.exportProperty(box2d.b2WeldJointDef.prototype,"Initialize",box2d.b2WeldJointDef.prototype.Initialize);box2d.b2WeldJoint=function(t){box2d.b2Joint.call(this,t);this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_referenceAngle=t.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat33};goog.inherits(box2d.b2WeldJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WeldJoint",box2d.b2WeldJoint);box2d.b2WeldJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_frequencyHz",box2d.b2WeldJoint.prototype.m_frequencyHz);box2d.b2WeldJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_dampingRatio",box2d.b2WeldJoint.prototype.m_dampingRatio);box2d.b2WeldJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_bias",box2d.b2WeldJoint.prototype.m_bias);box2d.b2WeldJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorA",box2d.b2WeldJoint.prototype.m_localAnchorA);box2d.b2WeldJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorB",box2d.b2WeldJoint.prototype.m_localAnchorB);box2d.b2WeldJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_referenceAngle",box2d.b2WeldJoint.prototype.m_referenceAngle);box2d.b2WeldJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_gamma",box2d.b2WeldJoint.prototype.m_gamma);box2d.b2WeldJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_impulse",box2d.b2WeldJoint.prototype.m_impulse);box2d.b2WeldJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexA",box2d.b2WeldJoint.prototype.m_indexA);box2d.b2WeldJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexB",box2d.b2WeldJoint.prototype.m_indexB);box2d.b2WeldJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rA",box2d.b2WeldJoint.prototype.m_rA);box2d.b2WeldJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rB",box2d.b2WeldJoint.prototype.m_rB);box2d.b2WeldJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterA",box2d.b2WeldJoint.prototype.m_localCenterA);box2d.b2WeldJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterB",box2d.b2WeldJoint.prototype.m_localCenterB);box2d.b2WeldJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassA",box2d.b2WeldJoint.prototype.m_invMassA);box2d.b2WeldJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassB",box2d.b2WeldJoint.prototype.m_invMassB);box2d.b2WeldJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIA",box2d.b2WeldJoint.prototype.m_invIA);box2d.b2WeldJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIB",box2d.b2WeldJoint.prototype.m_invIB);box2d.b2WeldJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_mass",box2d.b2WeldJoint.prototype.m_mass);box2d.b2WeldJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qA",box2d.b2WeldJoint.prototype.m_qA);box2d.b2WeldJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qB",box2d.b2WeldJoint.prototype.m_qB);box2d.b2WeldJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcA",box2d.b2WeldJoint.prototype.m_lalcA);box2d.b2WeldJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcB",box2d.b2WeldJoint.prototype.m_lalcB);box2d.b2WeldJoint.prototype.m_K=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_K",box2d.b2WeldJoint.prototype.m_K);box2d.b2WeldJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=t.positions[this.m_indexA].a,o=t.velocities[this.m_indexA].v,i=t.velocities[this.m_indexA].w,a=t.positions[this.m_indexB].a,r=t.velocities[this.m_indexB].v,s=t.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(e),b=this.m_qB.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(b,this.m_lalcB,this.m_rB);var n=this.m_invMassA,b=this.m_invMassB,x=this.m_invIA,l=this.m_invIB,_=this.m_K;_.ex.x=n+b+this.m_rA.y*this.m_rA.y*x+this.m_rB.y*this.m_rB.y*l;_.ey.x=-this.m_rA.y*this.m_rA.x*x-this.m_rB.y*this.m_rB.x*l;_.ez.x=-this.m_rA.y*x-this.m_rB.y*l;_.ex.y=_.ey.x;_.ey.y=n+b+this.m_rA.x*this.m_rA.x*x+this.m_rB.x*this.m_rB.x*l;_.ez.y=this.m_rA.x*x+this.m_rB.x*l;_.ex.z=_.ez.x;_.ey.z=_.ez.y;_.ez.z=x+l;if(0<this.m_frequencyHz){_.GetInverse22(this.m_mass);var _=x+l,h=0<_?1/_:0,e=a-e-this.m_referenceAngle,a=2*box2d.b2_pi*this.m_frequencyHz,d=h*a*a,p=t.step.dt;this.m_gamma=p*(2*h*this.m_dampingRatio*a+p*d);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=e*p*d*this.m_gamma;_+=this.m_gamma;this.m_mass.ez.z=0!==_?1/_:0}else 0===_.ez.z?_.GetInverse22(this.m_mass):_.GetSymInverse33(this.m_mass),this.m_bias=this.m_gamma=0;t.step.warmStarting?(this.m_impulse.SelfMulScalar(t.step.dtRatio),_=box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P.Set(this.m_impulse.x,this.m_impulse.y),o.SelfMulSub(n,_),i-=x*(box2d.b2Cross_V2_V2(this.m_rA,_)+this.m_impulse.z),r.SelfMulAdd(b,_),s+=l*(box2d.b2Cross_V2_V2(this.m_rB,_)+this.m_impulse.z)):this.m_impulse.SetZero();t.velocities[this.m_indexA].w=i;t.velocities[this.m_indexB].w=s};box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints=function(t){var e=t.velocities[this.m_indexA].v,o=t.velocities[this.m_indexA].w,i=t.velocities[this.m_indexB].v,a=t.velocities[this.m_indexB].w,r=this.m_invMassA,s=this.m_invMassB,n=this.m_invIA,b=this.m_invIB;if(0<this.m_frequencyHz){var x=-this.m_mass.ez.z*(a-o+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=x;o-=n*x;a+=b*x;x=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1);x=box2d.b2Mul_M33_X_Y(this.m_mass,x.x,x.y,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1).SelfNeg();this.m_impulse.x+=x.x;this.m_impulse.y+=x.y;e.SelfMulSub(r,x);o-=n*box2d.b2Cross_V2_V2(this.m_rA,x);i.SelfMulAdd(s,x);a+=b*box2d.b2Cross_V2_V2(this.m_rB,x)}else{var x=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(i,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(e,o,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1),l=box2d.b2Mul_M33_X_Y_Z(this.m_mass,x.x,x.y,a-o,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();this.m_impulse.SelfAdd(l);x=box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P.Set(l.x,l.y);e.SelfMulSub(r,x);o-=n*(box2d.b2Cross_V2_V2(this.m_rA,x)+l.z);i.SelfMulAdd(s,x);a+=b*(box2d.b2Cross_V2_V2(this.m_rB,x)+l.z)}t.velocities[this.m_indexA].w=o;t.velocities[this.m_indexB].w=a};goog.exportProperty(box2d.b2WeldJoint.prototype,"SolveVelocityConstraints",box2d.b2WeldJoint.prototype.SolveVelocityConstraints);box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a),n=this.m_invMassA,b=this.m_invMassB,x=this.m_invIA,l=this.m_invIB;box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var _=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var h=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),d=this.m_K;d.ex.x=n+b+_.y*_.y*x+h.y*h.y*l;d.ey.x=-_.y*_.x*x-h.y*h.x*l;d.ez.x=-_.y*x-h.y*l;d.ex.y=d.ey.x;d.ey.y=n+b+_.x*_.x*x+h.x*h.x*l;d.ez.y=_.x*x+h.x*l;d.ex.z=d.ez.x;d.ey.z=d.ez.y;d.ez.z=x+l;if(0<this.m_frequencyHz){var p=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(i,h,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,_,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),s=p.Length(),r=0,d=d.Solve22(p.x,p.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P).SelfNeg();e.SelfMulSub(n,d);o-=x*box2d.b2Cross_V2_V2(_,d);i.SelfMulAdd(b,d);a+=l*box2d.b2Cross_V2_V2(h,d)}else p=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(i,h,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(e,_,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),h=a-o-this.m_referenceAngle,s=p.Length(),r=box2d.b2Abs(h),_=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse,0<d.ez.z?d.Solve33(p.x,p.y,h,_).SelfNeg():(d=d.Solve22(p.x,p.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2).SelfNeg(),_.x=d.x,_.y=d.y,_.z=0),d=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P.Set(_.x,_.y),e.SelfMulSub(n,d),o-=x*(box2d.b2Cross_V2_V2(this.m_rA,d)+_.z),i.SelfMulAdd(b,d),a+=l*(box2d.b2Cross_V2_V2(this.m_rB,d)+_.z);t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return s<=box2d.b2_linearSlop&&r<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2WeldJoint.prototype,"SolvePositionConstraints",box2d.b2WeldJoint.prototype.SolvePositionConstraints);box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorA",box2d.b2WeldJoint.prototype.GetAnchorA);box2d.b2WeldJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorB",box2d.b2WeldJoint.prototype.GetAnchorB);box2d.b2WeldJoint.prototype.GetReactionForce=function(t,e){return e.Set(t*this.m_impulse.x,t*this.m_impulse.y)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionForce",box2d.b2WeldJoint.prototype.GetReactionForce);box2d.b2WeldJoint.prototype.GetReactionTorque=function(t){return t*this.m_impulse.z};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionTorque",box2d.b2WeldJoint.prototype.GetReactionTorque);box2d.b2WeldJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorA",box2d.b2WeldJoint.prototype.GetLocalAnchorA);box2d.b2WeldJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorB",box2d.b2WeldJoint.prototype.GetLocalAnchorB);box2d.b2WeldJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReferenceAngle",box2d.b2WeldJoint.prototype.GetReferenceAngle);box2d.b2WeldJoint.prototype.SetFrequency=function(t){this.m_frequencyHz=t};box2d.b2WeldJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetFrequency",box2d.b2WeldJoint.prototype.GetFrequency);box2d.b2WeldJoint.prototype.SetDampingRatio=function(t){this.m_dampingRatio=t};box2d.b2WeldJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetDampingRatio",box2d.b2WeldJoint.prototype.GetDampingRatio);box2d.b2WeldJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WeldJointDef*/ var jd = new box2d.b2WeldJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2WeldJoint.prototype,"Dump",box2d.b2WeldJoint.prototype.Dump);box2d.b2WheelJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_wheelJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0);this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2WheelJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2WheelJointDef",box2d.b2WheelJointDef);box2d.b2WheelJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorA",box2d.b2WheelJointDef.prototype.localAnchorA);box2d.b2WheelJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorB",box2d.b2WheelJointDef.prototype.localAnchorB);box2d.b2WheelJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAxisA",box2d.b2WheelJointDef.prototype.localAxisA);box2d.b2WheelJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2WheelJointDef.prototype,"enableMotor",box2d.b2WheelJointDef.prototype.enableMotor);box2d.b2WheelJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"maxMotorTorque",box2d.b2WheelJointDef.prototype.maxMotorTorque);box2d.b2WheelJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"motorSpeed",box2d.b2WheelJointDef.prototype.motorSpeed);box2d.b2WheelJointDef.prototype.frequencyHz=2;goog.exportProperty(box2d.b2WheelJointDef.prototype,"frequencyHz",box2d.b2WheelJointDef.prototype.frequencyHz);box2d.b2WheelJointDef.prototype.dampingRatio=.7;goog.exportProperty(box2d.b2WheelJointDef.prototype,"dampingRatio",box2d.b2WheelJointDef.prototype.dampingRatio);box2d.b2WheelJointDef.prototype.Initialize=function(t,e,o,i){this.bodyA=t;this.bodyB=e;this.bodyA.GetLocalPoint(o,this.localAnchorA);this.bodyB.GetLocalPoint(o,this.localAnchorB);this.bodyA.GetLocalVector(i,this.localAxisA)};goog.exportProperty(box2d.b2WheelJointDef.prototype,"Initialize",box2d.b2WheelJointDef.prototype.Initialize);box2d.b2WheelJoint=function(t){box2d.b2Joint.call(this,t);this.m_frequencyHz=t.frequencyHz;this.m_dampingRatio=t.dampingRatio;this.m_localAnchorA=t.localAnchorA.Clone();this.m_localAnchorB=t.localAnchorB.Clone();this.m_localXAxisA=t.localAxisA.Clone();this.m_localYAxisA=box2d.b2Cross_S_V2(1,this.m_localXAxisA,new box2d.b2Vec2);this.m_maxMotorTorque=t.maxMotorTorque;this.m_motorSpeed=t.motorSpeed;this.m_enableMotor=t.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_ax=new box2d.b2Vec2;this.m_ay=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_ax.SetZero();this.m_ay.SetZero()};goog.inherits(box2d.b2WheelJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WheelJoint",box2d.b2WheelJoint);box2d.b2WheelJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_frequencyHz",box2d.b2WheelJoint.prototype.m_frequencyHz);box2d.b2WheelJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_dampingRatio",box2d.b2WheelJoint.prototype.m_dampingRatio);box2d.b2WheelJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorA",box2d.b2WheelJoint.prototype.m_localAnchorA);box2d.b2WheelJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorB",box2d.b2WheelJoint.prototype.m_localAnchorB);box2d.b2WheelJoint.prototype.m_localXAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localXAxisA",box2d.b2WheelJoint.prototype.m_localXAxisA);box2d.b2WheelJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localYAxisA",box2d.b2WheelJoint.prototype.m_localYAxisA);box2d.b2WheelJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_impulse",box2d.b2WheelJoint.prototype.m_impulse);box2d.b2WheelJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorImpulse",box2d.b2WheelJoint.prototype.m_motorImpulse);box2d.b2WheelJoint.prototype.m_springImpulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springImpulse",box2d.b2WheelJoint.prototype.m_springImpulse);box2d.b2WheelJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_maxMotorTorque",box2d.b2WheelJoint.prototype.m_maxMotorTorque);box2d.b2WheelJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorSpeed",box2d.b2WheelJoint.prototype.m_motorSpeed);box2d.b2WheelJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_enableMotor",box2d.b2WheelJoint.prototype.m_enableMotor);box2d.b2WheelJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexA",box2d.b2WheelJoint.prototype.m_indexA);box2d.b2WheelJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexB",box2d.b2WheelJoint.prototype.m_indexB);box2d.b2WheelJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterA",box2d.b2WheelJoint.prototype.m_localCenterA);box2d.b2WheelJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterB",box2d.b2WheelJoint.prototype.m_localCenterB);box2d.b2WheelJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassA",box2d.b2WheelJoint.prototype.m_invMassA);box2d.b2WheelJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassB",box2d.b2WheelJoint.prototype.m_invMassB);box2d.b2WheelJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIA",box2d.b2WheelJoint.prototype.m_invIA);box2d.b2WheelJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIB",box2d.b2WheelJoint.prototype.m_invIB);box2d.b2WheelJoint.prototype.m_ax=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ax",box2d.b2WheelJoint.prototype.m_ax);box2d.b2WheelJoint.prototype.m_ay=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ay",box2d.b2WheelJoint.prototype.m_ay);box2d.b2WheelJoint.prototype.m_sAx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAx",box2d.b2WheelJoint.prototype.m_sAx);box2d.b2WheelJoint.prototype.m_sBx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBx",box2d.b2WheelJoint.prototype.m_sBx);box2d.b2WheelJoint.prototype.m_sAy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAy",box2d.b2WheelJoint.prototype.m_sAy);box2d.b2WheelJoint.prototype.m_sBy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBy",box2d.b2WheelJoint.prototype.m_sBy);box2d.b2WheelJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_mass",box2d.b2WheelJoint.prototype.m_mass);box2d.b2WheelJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorMass",box2d.b2WheelJoint.prototype.m_motorMass);box2d.b2WheelJoint.prototype.m_springMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springMass",box2d.b2WheelJoint.prototype.m_springMass);box2d.b2WheelJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_bias",box2d.b2WheelJoint.prototype.m_bias);box2d.b2WheelJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_gamma",box2d.b2WheelJoint.prototype.m_gamma);box2d.b2WheelJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qA",box2d.b2WheelJoint.prototype.m_qA);box2d.b2WheelJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qB",box2d.b2WheelJoint.prototype.m_qB);box2d.b2WheelJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcA",box2d.b2WheelJoint.prototype.m_lalcA);box2d.b2WheelJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcB",box2d.b2WheelJoint.prototype.m_lalcB);box2d.b2WheelJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rA",box2d.b2WheelJoint.prototype.m_rA);box2d.b2WheelJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rB",box2d.b2WheelJoint.prototype.m_rB);box2d.b2WheelJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorSpeed",box2d.b2WheelJoint.prototype.GetMotorSpeed);box2d.b2WheelJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMaxMotorTorque",box2d.b2WheelJoint.prototype.GetMaxMotorTorque);box2d.b2WheelJoint.prototype.SetSpringFrequencyHz=function(t){this.m_frequencyHz=t};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringFrequencyHz",box2d.b2WheelJoint.prototype.SetSpringFrequencyHz);box2d.b2WheelJoint.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringFrequencyHz",box2d.b2WheelJoint.prototype.GetSpringFrequencyHz);box2d.b2WheelJoint.prototype.SetSpringDampingRatio=function(t){this.m_dampingRatio=t};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringDampingRatio",box2d.b2WheelJoint.prototype.SetSpringDampingRatio);box2d.b2WheelJoint.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringDampingRatio",box2d.b2WheelJoint.prototype.GetSpringDampingRatio);box2d.b2WheelJoint.prototype.InitVelocityConstraints=function(t){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,o=this.m_invMassB,i=this.m_invIA,a=this.m_invIB,r=t.positions[this.m_indexA].c,s=t.velocities[this.m_indexA].v,n=t.velocities[this.m_indexA].w,b=t.positions[this.m_indexB].c,x=t.positions[this.m_indexB].a,l=t.velocities[this.m_indexB].v,_=t.velocities[this.m_indexB].w,h=this.m_qA.SetAngle(t.positions[this.m_indexA].a),d=this.m_qB.SetAngle(x);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);x=box2d.b2Mul_R_V2(h,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);d=box2d.b2Mul_R_V2(d,this.m_lalcB,this.m_rB);r=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(b,d,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(r,x,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d);box2d.b2Mul_R_V2(h,this.m_localYAxisA,this.m_ay);this.m_sAy=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(r,x,box2d.b2Vec2.s_t0),this.m_ay);this.m_sBy=box2d.b2Cross_V2_V2(d,this.m_ay);this.m_mass=e+o+i*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy;0<this.m_mass&&(this.m_mass=1/this.m_mass);this.m_gamma=this.m_bias=this.m_springMass=0;0<this.m_frequencyHz?(box2d.b2Mul_R_V2(h,this.m_localXAxisA,this.m_ax),this.m_sAx=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(r,x,box2d.b2Vec2.s_t0),this.m_ax),this.m_sBx=box2d.b2Cross_V2_V2(d,this.m_ax),e=e+o+i*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx,0<e&&(this.m_springMass=1/e,o=box2d.b2Dot_V2_V2(r,this.m_ax),h=2*box2d.b2_pi*this.m_frequencyHz,r=this.m_springMass*h*h,b=t.step.dt,this.m_gamma=b*(2*this.m_springMass*this.m_dampingRatio*h+b*r),0<this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_bias=o*b*r*this.m_gamma,this.m_springMass=e+this.m_gamma,0<this.m_springMass&&(this.m_springMass=1/this.m_springMass))):this.m_springImpulse=0;this.m_enableMotor?(this.m_motorMass=i+a,0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass)):this.m_motorImpulse=this.m_motorMass=0;t.step.warmStarting?(this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio,i=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(this.m_impulse,this.m_ay,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(this.m_springImpulse,this.m_ax,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P),a=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,e=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse,s.SelfMulSub(this.m_invMassA,i),n-=this.m_invIA*a,l.SelfMulAdd(this.m_invMassB,i),_+=this.m_invIB*e):this.m_motorImpulse=this.m_springImpulse=this.m_impulse=0;t.velocities[this.m_indexA].w=n;t.velocities[this.m_indexB].w=_};goog.exportProperty(box2d.b2WheelJoint.prototype,"InitVelocityConstraints",box2d.b2WheelJoint.prototype.InitVelocityConstraints);box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolveVelocityConstraints=function(t){var e=this.m_invMassA,o=this.m_invMassB,i=this.m_invIA,a=this.m_invIB,r=t.velocities[this.m_indexA].v,s=t.velocities[this.m_indexA].w,n=t.velocities[this.m_indexB].v,b=t.velocities[this.m_indexB].w,x=box2d.b2Dot_V2_V2(this.m_ax,box2d.b2Sub_V2_V2(n,r,box2d.b2Vec2.s_t0))+this.m_sBx*b-this.m_sAx*s,x=-this.m_springMass*(x+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=x;var l=box2d.b2Mul_S_V2(x,this.m_ax,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),_=x*this.m_sAx,x=x*this.m_sBx;r.SelfMulSub(e,l);s-=i*_;n.SelfMulAdd(o,l);b+=a*x;x=b-s-this.m_motorSpeed;x*=-this.m_motorMass;l=this.m_motorImpulse;_=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+x,-_,_);x=this.m_motorImpulse-l;s-=i*x;b+=a*x;x=box2d.b2Dot_V2_V2(this.m_ay,box2d.b2Sub_V2_V2(n,r,box2d.b2Vec2.s_t0))+this.m_sBy*b-this.m_sAy*s;x*=-this.m_mass;this.m_impulse+=x;l=box2d.b2Mul_S_V2(x,this.m_ay,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P);_=x*this.m_sAy;x*=this.m_sBy;r.SelfMulSub(e,l);s-=i*_;n.SelfMulAdd(o,l);t.velocities[this.m_indexA].w=s;t.velocities[this.m_indexB].w=b+a*x};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolveVelocityConstraints",box2d.b2WheelJoint.prototype.SolveVelocityConstraints);box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints=function(t){var e=t.positions[this.m_indexA].c,o=t.positions[this.m_indexA].a,i=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,r=this.m_qA.SetAngle(o),s=this.m_qB.SetAngle(a);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var n=box2d.b2Mul_R_V2(r,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var s=box2d.b2Mul_R_V2(s,this.m_lalcB,this.m_rB),b=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(i,e,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(s,n,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d),r=box2d.b2Mul_R_V2(r,this.m_localYAxisA,this.m_ay),n=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(b,n,box2d.b2Vec2.s_t0),r),s=box2d.b2Cross_V2_V2(s,r),b=box2d.b2Dot_V2_V2(b,this.m_ay),x=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,x=0!==x?-b/x:0,r=box2d.b2Mul_S_V2(x,r,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P),n=x*n,s=x*s;e.SelfMulSub(this.m_invMassA,r);o-=this.m_invIA*n;i.SelfMulAdd(this.m_invMassB,r);a+=this.m_invIB*s;t.positions[this.m_indexA].a=o;t.positions[this.m_indexB].a=a;return box2d.b2Abs(b)<=box2d.b2_linearSlop};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolvePositionConstraints",box2d.b2WheelJoint.prototype.SolvePositionConstraints);box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.GetDefinition=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return t};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetDefinition",box2d.b2WheelJoint.prototype.GetDefinition);box2d.b2WheelJoint.prototype.GetAnchorA=function(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorA",box2d.b2WheelJoint.prototype.GetAnchorA);box2d.b2WheelJoint.prototype.GetAnchorB=function(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorB",box2d.b2WheelJoint.prototype.GetAnchorB);box2d.b2WheelJoint.prototype.GetReactionForce=function(t,e){e.x=t*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x);e.y=t*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y);return e};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionForce",box2d.b2WheelJoint.prototype.GetReactionForce);box2d.b2WheelJoint.prototype.GetReactionTorque=function(t){return t*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionTorque",box2d.b2WheelJoint.prototype.GetReactionTorque);box2d.b2WheelJoint.prototype.GetLocalAnchorA=function(t){return t.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorA",box2d.b2WheelJoint.prototype.GetLocalAnchorA);box2d.b2WheelJoint.prototype.GetLocalAnchorB=function(t){return t.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorB",box2d.b2WheelJoint.prototype.GetLocalAnchorB);box2d.b2WheelJoint.prototype.GetLocalAxisA=function(t){return t.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAxisA",box2d.b2WheelJoint.prototype.GetLocalAxisA);box2d.b2WheelJoint.prototype.GetJointTranslation=function(){return this.GetPrismaticJointTranslation()};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointTranslation",box2d.b2WheelJoint.prototype.GetJointTranslation);box2d.b2WheelJoint.prototype.GetJointSpeed=function(){return this.GetRevoluteJointSpeed()};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointSpeed",box2d.b2WheelJoint.prototype.GetJointSpeed);box2d.b2WheelJoint.prototype.GetPrismaticJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,o=t.GetWorldPoint(this.m_localAnchorA,new box2d.b2Vec2),e=e.GetWorldPoint(this.m_localAnchorB,new box2d.b2Vec2),o=box2d.b2Sub_V2_V2(e,o,new box2d.b2Vec2),t=t.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2);return box2d.b2Dot_V2_V2(o,t)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetPrismaticJointTranslation",box2d.b2WheelJoint.prototype.GetPrismaticJointTranslation);box2d.b2WheelJoint.prototype.GetPrismaticJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB;box2d.b2Sub_V2_V2(this.m_localAnchorA,t.m_sweep.localCenter,this.m_lalcA);var o=box2d.b2Mul_R_V2(t.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,e.m_sweep.localCenter,this.m_lalcB);var i=box2d.b2Mul_R_V2(e.m_xf.q,this.m_lalcB,this.m_rB),a=box2d.b2Add_V2_V2(t.m_sweep.c,o,box2d.b2Vec2.s_t0),r=box2d.b2Add_V2_V2(e.m_sweep.c,i,box2d.b2Vec2.s_t1),a=box2d.b2Sub_V2_V2(r,a,box2d.b2Vec2.s_t2),r=t.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2),s=t.m_linearVelocity,n=e.m_linearVelocity,t=t.m_angularVelocity,e=e.m_angularVelocity;return box2d.b2Dot_V2_V2(a,box2d.b2Cross_S_V2(t,r,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(r,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(n,e,i,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(s,t,o,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetPrismaticJointSpeed",box2d.b2WheelJoint.prototype.GetPrismaticJointSpeed);box2d.b2WheelJoint.prototype.GetRevoluteJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetRevoluteJointAngle",box2d.b2WheelJoint.prototype.GetRevoluteJointAngle);box2d.b2WheelJoint.prototype.GetRevoluteJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetRevoluteJointSpeed",box2d.b2WheelJoint.prototype.GetRevoluteJointSpeed);box2d.b2WheelJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2WheelJoint.prototype,"IsMotorEnabled",box2d.b2WheelJoint.prototype.IsMotorEnabled);box2d.b2WheelJoint.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=t};goog.exportProperty(box2d.b2WheelJoint.prototype,"EnableMotor",box2d.b2WheelJoint.prototype.EnableMotor);box2d.b2WheelJoint.prototype.SetMotorSpeed=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=t};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMotorSpeed",box2d.b2WheelJoint.prototype.SetMotorSpeed);box2d.b2WheelJoint.prototype.SetMaxMotorTorque=function(t){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorTorque=t};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMaxMotorTorque",box2d.b2WheelJoint.prototype.SetMaxMotorTorque);box2d.b2WheelJoint.prototype.GetMotorTorque=function(t){return t*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorTorque",box2d.b2WheelJoint.prototype.GetMotorTorque);box2d.b2WheelJoint.prototype.Dump=function(){if(box2d.DEBUG){var t=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WheelJointDef*/ var jd = new box2d.b2WheelJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",t);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2WheelJoint.prototype,"Dump",box2d.b2WheelJoint.prototype.Dump);box2d.b2Particle={};box2d.b2ParticleFlag={b2_waterParticle:0,b2_zombieParticle:2,b2_wallParticle:4,b2_springParticle:8,b2_elasticParticle:16,b2_viscousParticle:32,b2_powderParticle:64,b2_tensileParticle:128,b2_colorMixingParticle:256,b2_destructionListenerParticle:512,b2_barrierParticle:1024,b2_staticPressureParticle:2048,b2_reactiveParticle:4096,b2_repulsiveParticle:8192,b2_fixtureContactListenerParticle:16384,b2_particleContactListenerParticle:32768,b2_fixtureContactFilterParticle:65536,b2_particleContactFilterParticle:131072};goog.exportSymbol("box2d.b2ParticleFlag",box2d.b2ParticleFlag);goog.exportProperty(box2d.b2ParticleFlag,"b2_waterParticle",box2d.b2ParticleFlag.b2_waterParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_zombieParticle",box2d.b2ParticleFlag.b2_zombieParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_wallParticle",box2d.b2ParticleFlag.b2_wallParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_springParticle",box2d.b2ParticleFlag.b2_springParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_elasticParticle",box2d.b2ParticleFlag.b2_elasticParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_viscousParticle",box2d.b2ParticleFlag.b2_viscousParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_powderParticle",box2d.b2ParticleFlag.b2_powderParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_tensileParticle",box2d.b2ParticleFlag.b2_tensileParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_colorMixingParticle",box2d.b2ParticleFlag.b2_colorMixingParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_destructionListenerParticle",box2d.b2ParticleFlag.b2_destructionListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_barrierParticle",box2d.b2ParticleFlag.b2_barrierParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_staticPressureParticle",box2d.b2ParticleFlag.b2_staticPressureParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_reactiveParticle",box2d.b2ParticleFlag.b2_reactiveParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_repulsiveParticle",box2d.b2ParticleFlag.b2_repulsiveParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_fixtureContactListenerParticle",box2d.b2ParticleFlag.b2_fixtureContactListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_particleContactListenerParticle",box2d.b2ParticleFlag.b2_particleContactListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_fixtureContactFilterParticle",box2d.b2ParticleFlag.b2_fixtureContactFilterParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_particleContactFilterParticle",box2d.b2ParticleFlag.b2_particleContactFilterParticle);box2d.b2ParticleColor=function(t,e,o,i){if(0!==arguments.length)if(t instanceof box2d.b2Color)this.r=0|255*t.r,this.g=0|255*t.g,this.b=0|255*t.b,this.a=0|255*t.a;else if(3<=arguments.length)this.r=0|t||0,this.g=0|e||0,this.b=0|o||0,this.a=0|i||0;else throw Error()};goog.exportSymbol("box2d.b2ParticleColor",box2d.b2ParticleColor);box2d.b2ParticleColor.prototype.r=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"r",box2d.b2ParticleColor.prototype.r);box2d.b2ParticleColor.prototype.g=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"g",box2d.b2ParticleColor.prototype.g);box2d.b2ParticleColor.prototype.b=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"b",box2d.b2ParticleColor.prototype.b);box2d.b2ParticleColor.prototype.a=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"a",box2d.b2ParticleColor.prototype.a);box2d.b2ParticleColor.prototype.IsZero=function(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"IsZero",box2d.b2ParticleColor.prototype.IsZero);box2d.b2ParticleColor.prototype.GetColor=function(t){t.r=this.r/255;t.g=this.g/255;t.b=this.b/255;t.a=this.a/255;return t};goog.exportProperty(box2d.b2ParticleColor.prototype,"GetColor",box2d.b2ParticleColor.prototype.GetColor);box2d.b2ParticleColor.prototype.Set=function(t,e,o,i){if(t instanceof box2d.b2Color)this.SetColor(t);else if(3<=arguments.length)this.SetRGBA(t||0,e||0,o||0,i);else throw Error()};goog.exportProperty(box2d.b2ParticleColor.prototype,"Set",box2d.b2ParticleColor.prototype.Set);box2d.b2ParticleColor.prototype.SetRGBA=function(t,e,o,i){this.r=t;this.g=e;this.b=o;this.a="number"===typeof i?i:255};goog.exportProperty(box2d.b2ParticleColor.prototype,"SetRGBA",box2d.b2ParticleColor.prototype.SetRGBA);box2d.b2ParticleColor.prototype.SetColor=function(t){this.r=255*t.r;this.g=255*t.g;this.b=255*t.b;this.a=255*t.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"SetColor",box2d.b2ParticleColor.prototype.SetColor);box2d.b2ParticleColor.prototype.Copy=function(t){this.r=t.r;this.g=t.g;this.b=t.b;this.a=t.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"Copy",box2d.b2ParticleColor.prototype.Copy);box2d.b2ParticleColor.prototype.Clone=function(){return new box2d.b2ParticleColor(this.r,this.g,this.b,this.a)};box2d.b2ParticleColor.prototype.SelfMul_0_1=function(t){this.r*=t;this.g*=t;this.b*=t;this.a*=t;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfMul_0_1",box2d.b2ParticleColor.prototype.SelfMul_0_1);box2d.b2ParticleColor.prototype.SelfMul_0_255=function(t){t+=1;this.r=this.r*t>>box2d.b2ParticleColor.k_bitsPerComponent;this.g=this.g*t>>box2d.b2ParticleColor.k_bitsPerComponent;this.b=this.b*t>>box2d.b2ParticleColor.k_bitsPerComponent;this.a=this.a*t>>box2d.b2ParticleColor.k_bitsPerComponent;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfMul_0_255",box2d.b2ParticleColor.prototype.SelfMul_0_255);box2d.b2ParticleColor.prototype.Mul_0_1=function(t,e){return e.Copy(this).SelfMul_0_1(t)};goog.exportProperty(box2d.b2ParticleColor.prototype,"Mul_0_1",box2d.b2ParticleColor.prototype.Mul_0_1);box2d.b2ParticleColor.prototype.Mul_0_255=function(t,e){return e.Copy(this).SelfMul_0_255(t)};goog.exportProperty(box2d.b2ParticleColor.prototype,"Mul_0_255",box2d.b2ParticleColor.prototype.Mul_0_255);box2d.b2ParticleColor.prototype.SelfAdd=function(t){this.r+=t.r;this.g+=t.g;this.b+=t.b;this.a+=t.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfAdd",box2d.b2ParticleColor.prototype.SelfAdd);box2d.b2ParticleColor.prototype.Add=function(t,e){e.r=this.r+t.r;e.g=this.g+t.g;e.b=this.b+t.b;e.a=this.a+t.a;return e};goog.exportProperty(box2d.b2ParticleColor.prototype,"Add",box2d.b2ParticleColor.prototype.Add);box2d.b2ParticleColor.prototype.SelfSub=function(t){this.r-=t.r;this.g-=t.g;this.b-=t.b;this.a-=t.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfSub",box2d.b2ParticleColor.prototype.SelfSub);box2d.b2ParticleColor.prototype.Sub=function(t,e){e.r=this.r-t.r;e.g=this.g-t.g;e.b=this.b-t.b;e.a=this.a-t.a;return e};goog.exportProperty(box2d.b2ParticleColor.prototype,"Sub",box2d.b2ParticleColor.prototype.Sub);box2d.b2ParticleColor.prototype.IsEqual=function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"IsEqual",box2d.b2ParticleColor.prototype.IsEqual);box2d.b2ParticleColor.prototype.Mix=function(t,e){box2d.b2ParticleColor.MixColors(this,t,e)};goog.exportProperty(box2d.b2ParticleColor.prototype,"Mix",box2d.b2ParticleColor.prototype.Mix);box2d.b2ParticleColor.MixColors=function(t,e,o){var i=o*(e.r-t.r)>>box2d.b2ParticleColor.k_bitsPerComponent,a=o*(e.g-t.g)>>box2d.b2ParticleColor.k_bitsPerComponent,r=o*(e.b-t.b)>>box2d.b2ParticleColor.k_bitsPerComponent;o=o*(e.a-t.a)>>box2d.b2ParticleColor.k_bitsPerComponent;t.r+=i;t.g+=a;t.b+=r;t.a+=o;e.r-=i;e.g-=a;e.b-=r;e.a-=o};goog.exportProperty(box2d.b2ParticleColor,"MixColors",box2d.b2ParticleColor.MixColors);box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT=8;box2d.B2PARTICLECOLOR_MAX_VALUE=(1<<box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT)-1;box2d.b2ParticleColor.k_maxValue=+box2d.B2PARTICLECOLOR_MAX_VALUE;goog.exportProperty(box2d.b2ParticleColor,"k_maxValue",box2d.b2ParticleColor.k_maxValue);box2d.b2ParticleColor.k_inverseMaxValue=1/+box2d.B2PARTICLECOLOR_MAX_VALUE;goog.exportProperty(box2d.b2ParticleColor,"k_inverseMaxValue",box2d.b2ParticleColor.k_inverseMaxValue);box2d.b2ParticleColor.k_bitsPerComponent=box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT;goog.exportProperty(box2d.b2ParticleColor,"k_bitsPerComponent",box2d.b2ParticleColor.k_bitsPerComponent);box2d.b2ParticleColor_zero=new box2d.b2ParticleColor;box2d.b2ParticleDef=function(){this.position=box2d.b2Vec2_zero.Clone();this.velocity=box2d.b2Vec2_zero.Clone();this.color=box2d.b2ParticleColor_zero.Clone()};goog.exportSymbol("box2d.b2ParticleDef",box2d.b2ParticleDef);box2d.b2ParticleDef.prototype.flags=0;goog.exportProperty(box2d.b2ParticleDef.prototype,"flags",box2d.b2ParticleDef.prototype.flags);box2d.b2ParticleDef.prototype.position=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"position",box2d.b2ParticleDef.prototype.position);box2d.b2ParticleDef.prototype.velocity=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"velocity",box2d.b2ParticleDef.prototype.velocity);box2d.b2ParticleDef.prototype.color=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"color",box2d.b2ParticleDef.prototype.color);box2d.b2ParticleDef.prototype.lifetime=0;goog.exportProperty(box2d.b2ParticleDef.prototype,"lifetime",box2d.b2ParticleDef.prototype.lifetime);box2d.b2ParticleDef.prototype.userData=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"userData",box2d.b2ParticleDef.prototype.userData);box2d.b2ParticleDef.prototype.group=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"group",box2d.b2ParticleDef.prototype.group);box2d.b2CalculateParticleIterations=function(t,e,o){return box2d.b2Clamp(Math.ceil(Math.sqrt(t/(.01*e))*o),1,8)};goog.exportSymbol("box2d.b2CalculateParticleIterations",box2d.b2CalculateParticleIterations);box2d.b2ParticleHandle=function(){};goog.exportSymbol("box2d.b2ParticleHandle",box2d.b2ParticleHandle);box2d.b2ParticleHandle.prototype.m_index=box2d.b2_invalidParticleIndex;box2d.b2ParticleHandle.prototype.GetIndex=function(){return this.m_index};goog.exportProperty(box2d.b2ParticleHandle.prototype,"GetIndex",box2d.b2ParticleHandle.prototype.GetIndex);box2d.b2ParticleHandle.prototype.SetIndex=function(t){this.m_index=t};box2d.b2ParticleGroupFlag={b2_solidParticleGroup:1,b2_rigidParticleGroup:2,b2_particleGroupCanBeEmpty:4,b2_particleGroupWillBeDestroyed:8,b2_particleGroupNeedsUpdateDepth:16};goog.exportSymbol("box2d.b2ParticleGroupFlag",box2d.b2ParticleGroupFlag);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_solidParticleGroup",box2d.b2ParticleGroupFlag.b2_solidParticleGroup);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_rigidParticleGroup",box2d.b2ParticleGroupFlag.b2_rigidParticleGroup);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupCanBeEmpty",box2d.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupWillBeDestroyed",box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupNeedsUpdateDepth",box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask=box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed|box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth;box2d.b2ParticleGroupDef=function(){this.position=box2d.b2Vec2_zero.Clone();this.linearVelocity=box2d.b2Vec2_zero.Clone();this.color=box2d.b2ParticleColor_zero.Clone()};goog.exportSymbol("box2d.b2ParticleGroupDef",box2d.b2ParticleGroupDef);box2d.b2ParticleGroupDef.prototype.flags=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"flags",box2d.b2ParticleGroupDef.prototype.flags);box2d.b2ParticleGroupDef.prototype.groupFlags=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"groupFlags",box2d.b2ParticleGroupDef.prototype.groupFlags);box2d.b2ParticleGroupDef.prototype.position=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"position",box2d.b2ParticleGroupDef.prototype.position);box2d.b2ParticleGroupDef.prototype.angle=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"angle",box2d.b2ParticleGroupDef.prototype.angle);box2d.b2ParticleGroupDef.prototype.linearVelocity=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"linearVelocity",box2d.b2ParticleGroupDef.prototype.linearVelocity);box2d.b2ParticleGroupDef.prototype.angularVelocity=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"angularVelocity",box2d.b2ParticleGroupDef.prototype.angularVelocity);box2d.b2ParticleGroupDef.prototype.color=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"color",box2d.b2ParticleGroupDef.prototype.color);box2d.b2ParticleGroupDef.prototype.strength=1;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"strength",box2d.b2ParticleGroupDef.prototype.strength);box2d.b2ParticleGroupDef.prototype.shape=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shape",box2d.b2ParticleGroupDef.prototype.shape);box2d.b2ParticleGroupDef.prototype.shapes=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shapes",box2d.b2ParticleGroupDef.prototype.shapes);box2d.b2ParticleGroupDef.prototype.shapeCount=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shapeCount",box2d.b2ParticleGroupDef.prototype.shapeCount);box2d.b2ParticleGroupDef.prototype.stride=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"stride",box2d.b2ParticleGroupDef.prototype.stride);box2d.b2ParticleGroupDef.prototype.particleCount=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"particleCount",box2d.b2ParticleGroupDef.prototype.particleCount);box2d.b2ParticleGroupDef.prototype.positionData=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"positionData",box2d.b2ParticleGroupDef.prototype.positionData);box2d.b2ParticleGroupDef.prototype.lifetime=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"lifetime",box2d.b2ParticleGroupDef.prototype.lifetime);box2d.b2ParticleGroupDef.prototype.userData=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"userData",box2d.b2ParticleGroupDef.prototype.userData);box2d.b2ParticleGroupDef.prototype.group=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"group",box2d.b2ParticleGroupDef.prototype.group);box2d.b2ParticleGroup=function(){this.m_center=new box2d.b2Vec2;this.m_linearVelocity=new box2d.b2Vec2;this.m_transform=new box2d.b2Transform;this.m_transform.SetIdentity()};goog.exportSymbol("box2d.b2ParticleGroup",box2d.b2ParticleGroup);box2d.b2ParticleGroup.prototype.m_system=null;box2d.b2ParticleGroup.prototype.m_firstIndex=0;box2d.b2ParticleGroup.prototype.m_lastIndex=0;box2d.b2ParticleGroup.prototype.m_groupFlags=0;box2d.b2ParticleGroup.prototype.m_strength=1;box2d.b2ParticleGroup.prototype.m_prev=null;box2d.b2ParticleGroup.prototype.m_next=null;box2d.b2ParticleGroup.prototype.m_timestamp=-1;box2d.b2ParticleGroup.prototype.m_mass=0;box2d.b2ParticleGroup.prototype.m_inertia=0;box2d.b2ParticleGroup.prototype.m_center=null;box2d.b2ParticleGroup.prototype.m_linearVelocity=null;box2d.b2ParticleGroup.prototype.m_angularVelocity=0;box2d.b2ParticleGroup.prototype.m_transform=null;box2d.b2ParticleGroup.prototype.m_userData=null;box2d.b2ParticleGroup.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetNext",box2d.b2ParticleGroup.prototype.GetNext);box2d.b2ParticleGroup.prototype.GetParticleSystem=function(){return this.m_system};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetParticleSystem",box2d.b2ParticleGroup.prototype.GetParticleSystem);box2d.b2ParticleGroup.prototype.GetParticleCount=function(){return this.m_lastIndex-this.m_firstIndex};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetParticleCount",box2d.b2ParticleGroup.prototype.GetParticleCount);box2d.b2ParticleGroup.prototype.GetBufferIndex=function(){return this.m_firstIndex};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetBufferIndex",box2d.b2ParticleGroup.prototype.GetBufferIndex);box2d.b2ParticleGroup.prototype.ContainsParticle=function(t){return this.m_firstIndex<=t&&t<this.m_lastIndex};box2d.b2ParticleGroup.prototype.GetAllParticleFlags=function(){for(var t=0,e=this.m_firstIndex;e<this.m_lastIndex;e++)t|=this.m_system.m_flagsBuffer.data[e];return t};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAllParticleFlags",box2d.b2ParticleGroup.prototype.GetAllParticleFlags);box2d.b2ParticleGroup.prototype.GetGroupFlags=function(){return this.m_groupFlags};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetGroupFlags",box2d.b2ParticleGroup.prototype.GetGroupFlags);box2d.b2ParticleGroup.prototype.SetGroupFlags=function(t){box2d.b2Assert(0===(t&box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask));t|=this.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask;this.m_system.SetGroupFlags(this,t)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"SetGroupFlags",box2d.b2ParticleGroup.prototype.SetGroupFlags);box2d.b2ParticleGroup.prototype.GetMass=function(){this.UpdateStatistics();return this.m_mass};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetMass",box2d.b2ParticleGroup.prototype.GetMass);box2d.b2ParticleGroup.prototype.GetInertia=function(){this.UpdateStatistics();return this.m_inertia};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetInertia",box2d.b2ParticleGroup.prototype.GetInertia);box2d.b2ParticleGroup.prototype.GetCenter=function(){this.UpdateStatistics();return this.m_center};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetCenter",box2d.b2ParticleGroup.prototype.GetCenter);box2d.b2ParticleGroup.prototype.GetLinearVelocity=function(){this.UpdateStatistics();return this.m_linearVelocity};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetLinearVelocity",box2d.b2ParticleGroup.prototype.GetLinearVelocity);box2d.b2ParticleGroup.prototype.GetAngularVelocity=function(){this.UpdateStatistics();return this.m_angularVelocity};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAngularVelocity",box2d.b2ParticleGroup.prototype.GetAngularVelocity);box2d.b2ParticleGroup.prototype.GetTransform=function(){return this.m_transform};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetTransform",box2d.b2ParticleGroup.prototype.GetTransform);box2d.b2ParticleGroup.prototype.GetPosition=function(){return this.m_transform.p};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetPosition",box2d.b2ParticleGroup.prototype.GetPosition);box2d.b2ParticleGroup.prototype.GetAngle=function(){return this.m_transform.q.GetAngle()};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAngle",box2d.b2ParticleGroup.prototype.GetAngle);box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint=function(t,e){var o=box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint.s_t0;this.UpdateStatistics();return box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(t,this.m_center,o),e)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetLinearVelocityFromWorldPoint",box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint);box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint.s_t0=new box2d.b2Vec2;box2d.b2ParticleGroup.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetUserData",box2d.b2ParticleGroup.prototype.GetUserData);box2d.b2ParticleGroup.prototype.SetUserData=function(t){this.m_userData=t};goog.exportProperty(box2d.b2ParticleGroup.prototype,"SetUserData",box2d.b2ParticleGroup.prototype.SetUserData);box2d.b2ParticleGroup.prototype.ApplyForce=function(t){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,t)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"ApplyForce",box2d.b2ParticleGroup.prototype.ApplyForce);box2d.b2ParticleGroup.prototype.ApplyLinearImpulse=function(t){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,t)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"ApplyLinearImpulse",box2d.b2ParticleGroup.prototype.ApplyLinearImpulse);box2d.b2ParticleGroup.prototype.DestroyParticles=function(t){box2d.b2Assert(!1===this.m_system.m_world.IsLocked());if(!this.m_system.m_world.IsLocked())for(var e=this.m_firstIndex;e<this.m_lastIndex;e++)this.m_system.DestroyParticle(e,t)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"DestroyParticles",box2d.b2ParticleGroup.prototype.DestroyParticles);box2d.b2ParticleGroup.prototype.UpdateStatistics=function(){var t=new box2d.b2Vec2,e=new box2d.b2Vec2;if(this.m_timestamp!=this.m_system.m_timestamp){var o=this.m_system.GetParticleMass();this.m_mass=o*(this.m_lastIndex-this.m_firstIndex);this.m_center.SetZero();this.m_linearVelocity.SetZero();for(var i=this.m_firstIndex;i<this.m_lastIndex;i++)this.m_center.SelfMulAdd(o,this.m_system.m_positionBuffer.data[i]),this.m_linearVelocity.SelfMulAdd(o,this.m_system.m_velocityBuffer.data[i]);0<this.m_mass&&(i=1/this.m_mass,this.m_center.SelfMul(i),this.m_linearVelocity.SelfMul(i));this.m_angularVelocity=this.m_inertia=0;for(i=this.m_firstIndex;i<this.m_lastIndex;i++)box2d.b2Sub_V2_V2(this.m_system.m_positionBuffer.data[i],this.m_center,t),box2d.b2Sub_V2_V2(this.m_system.m_velocityBuffer.data[i],this.m_linearVelocity,e),this.m_inertia+=o*box2d.b2Dot_V2_V2(t,t),this.m_angularVelocity+=o*box2d.b2Cross_V2_V2(t,e);0<this.m_inertia&&(this.m_angularVelocity*=1/this.m_inertia);this.m_timestamp=this.m_system.m_timestamp}};goog.exportProperty(box2d.b2ParticleGroup.prototype,"UpdateStatistics",box2d.b2ParticleGroup.prototype.UpdateStatistics);box2d.std_iter_swap=function(t,e,o){var i=t[e];t[e]=t[o];t[o]=i};box2d.std_sort=function(t,e,o,i){"number"!==typeof e&&(e=0);"number"!==typeof o&&(o=t.length-e);"function"!==typeof i&&(i=function(t,e){return t<e});for(var a=[],r=0;;){for(;e+1<o;o++){var s=t[e+Math.floor(Math.random()*(o-e))];a[r++]=o;for(var n=e-1;;){for(;i(t[++n],s););for(;i(s,t[--o]););if(n>=o)break;box2d.std_iter_swap(t,n,o)}}if(0===r)break;e=o;o=a[--r]}return t};box2d.std_stable_sort=function(t,e,o,i){return box2d.std_sort(t,e,o,i)};box2d.std_remove_if=function(t,e,o){"number"!==typeof o&&(o=t.length);for(var i=0,a=0;a<o;++a)e(t[a])||(a===i?++i:box2d.std_iter_swap(t,i++,a));return i};box2d.std_lower_bound=function(t,e,o,i,a){"function"!==typeof a&&(a=function(t,e){return t<e});for(o-=e;0<o;){var r=Math.floor(o/2),s=e+r;a(t[s],i)?(e=++s,o-=r+1):o=r}return e};box2d.std_upper_bound=function(t,e,o,i,a){"function"!==typeof a&&(a=function(t,e){return t<e});for(o-=e;0<o;){var r=Math.floor(o/2),s=e+r;a(i,t[s])?o=r:(e=++s,o-=r+1)}return e};box2d.std_rotate=function(t,e,o,i){for(var a=o;e!==a;)box2d.std_iter_swap(t,e++,a++),a===i?a=o:e===o&&(o=a)};box2d.std_unique=function(t,e,o,i){if(e===o)return o;for(var a=e;++e!==o;)i(t[a],t[e])||box2d.std_iter_swap(t,++a,e);return++a};box2d.b2GrowableBuffer=function(t){this.data=[];this.capacity=this.count=0;this.allocator=t};box2d.b2GrowableBuffer.prototype.data=null;box2d.b2GrowableBuffer.prototype.count=0;box2d.b2GrowableBuffer.prototype.capacity=0;box2d.b2GrowableBuffer.prototype.allocator=function(){return null};box2d.b2GrowableBuffer.prototype.Append=function(){this.count>=this.capacity&&this.Grow();return this.count++};box2d.b2GrowableBuffer.prototype.Reserve=function(t){if(!(this.capacity>=t)){box2d.b2Assert(this.capacity===this.data.length);for(var e=this.capacity;e<t;++e)this.data[e]=this.allocator();this.capacity=t}};box2d.b2GrowableBuffer.prototype.Grow=function(){var t=this.capacity?2*this.capacity:box2d.b2_minParticleSystemBufferCapacity;box2d.b2Assert(t>this.capacity);this.Reserve(t)};box2d.b2GrowableBuffer.prototype.Free=function(){0!==this.data.length&&(this.data=[],this.count=this.capacity=0)};box2d.b2GrowableBuffer.prototype.Shorten=function(t){box2d.b2Assert(!1)};box2d.b2GrowableBuffer.prototype.Data=function(){return this.data};box2d.b2GrowableBuffer.prototype.GetCount=function(){return this.count};box2d.b2GrowableBuffer.prototype.SetCount=function(t){box2d.b2Assert(0<=t&&t<=this.capacity);this.count=t};box2d.b2GrowableBuffer.prototype.GetCapacity=function(){return this.capacity};box2d.b2GrowableBuffer.prototype.RemoveIf=function(t){for(var e=0,o=0;o<this.count;++o)t(this.data[o])||e++;this.count=box2d.std_remove_if(this.data,t,this.count);box2d.b2Assert(e===this.count)};box2d.b2GrowableBuffer.prototype.Unique=function(t){this.count=box2d.std_unique(this.data,0,this.count,t)};box2d.b2FixtureParticleQueryCallback=function(t){this.m_system=t};goog.inherits(box2d.b2FixtureParticleQueryCallback,box2d.b2QueryCallback);box2d.b2FixtureParticleQueryCallback.prototype.m_system=null;box2d.b2FixtureParticleQueryCallback.prototype.ShouldQueryParticleSystem=function(t){return!1};box2d.b2FixtureParticleQueryCallback.prototype.ReportFixture=function(t){if(t.IsSensor())return!0;for(var e=t.GetShape().GetChildCount(),o=0;o<e;o++)for(var i=t.GetAABB(o),i=this.m_system.GetInsideBoundsEnumerator(i),a;0<=(a=i.GetNext());)this.ReportFixtureAndParticle(t,o,a);return!0};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportFixture",box2d.b2FixtureParticleQueryCallback.prototype.ReportFixture);box2d.b2FixtureParticleQueryCallback.prototype.ReportParticle=function(t,e){return!1};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportParticle",box2d.b2FixtureParticleQueryCallback.prototype.ReportParticle);box2d.b2FixtureParticleQueryCallback.prototype.ReportFixtureAndParticle=function(t,e,o){box2d.b2Assert(!1)};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportFixtureAndParticle",box2d.b2FixtureParticleQueryCallback.prototype.ReportFixtureAndParticle);box2d.b2ParticleContact=function(){this.normal=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ParticleContact",box2d.b2ParticleContact);box2d.b2ParticleContact.prototype.indexA=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"indexA",box2d.b2ParticleContact.prototype.indexA);box2d.b2ParticleContact.prototype.indexB=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"indexB",box2d.b2ParticleContact.prototype.indexB);box2d.b2ParticleContact.prototype.weight=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"weight",box2d.b2ParticleContact.prototype.weight);box2d.b2ParticleContact.prototype.normal=null;goog.exportProperty(box2d.b2ParticleContact.prototype,"normal",box2d.b2ParticleContact.prototype.normal);box2d.b2ParticleContact.prototype.flags=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"flags",box2d.b2ParticleContact.prototype.flags);box2d.b2ParticleContact.prototype.SetIndices=function(t,e){box2d.b2Assert(t<=box2d.b2_maxParticleIndex&&e<=box2d.b2_maxParticleIndex);this.indexA=t;this.indexB=e};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetIndices",box2d.b2ParticleContact.prototype.SetIndices);box2d.b2ParticleContact.prototype.SetWeight=function(t){this.weight=t};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetWeight",box2d.b2ParticleContact.prototype.SetWeight);box2d.b2ParticleContact.prototype.SetNormal=function(t){this.normal.Copy(t)};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetNormal",box2d.b2ParticleContact.prototype.SetNormal);box2d.b2ParticleContact.prototype.SetFlags=function(t){this.flags=t};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetFlags",box2d.b2ParticleContact.prototype.SetFlags);box2d.b2ParticleContact.prototype.GetIndexA=function(){return this.indexA};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetIndexA",box2d.b2ParticleContact.prototype.GetIndexA);box2d.b2ParticleContact.prototype.GetIndexB=function(){return this.indexB};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetIndexB",box2d.b2ParticleContact.prototype.GetIndexB);box2d.b2ParticleContact.prototype.GetWeight=function(){return this.weight};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetWeight",box2d.b2ParticleContact.prototype.GetWeight);box2d.b2ParticleContact.prototype.GetNormal=function(){return this.normal};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetNormal",box2d.b2ParticleContact.prototype.GetNormal);box2d.b2ParticleContact.prototype.GetFlags=function(){return this.flags};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetFlags",box2d.b2ParticleContact.prototype.GetFlags);box2d.b2ParticleContact.prototype.IsEqual=function(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&this.weight===t.weight&&this.normal.x===t.normal.x&&this.normal.y===t.normal.y};goog.exportProperty(box2d.b2ParticleContact.prototype,"IsEqual",box2d.b2ParticleContact.prototype.IsEqual);box2d.b2ParticleContact.prototype.IsNotEqual=function(t){return!this.IsEqual(t)};goog.exportProperty(box2d.b2ParticleContact.prototype,"IsNotEqual",box2d.b2ParticleContact.prototype.IsNotEqual);box2d.b2ParticleContact.prototype.ApproximatelyEqual=function(t){return this.indexA===t.indexA&&this.indexB===t.indexB&&this.flags===t.flags&&.01>box2d.b2Abs(this.weight-t.weight)&&1e-4>box2d.b2DistanceSquared(this.normal,t.normal)};goog.exportProperty(box2d.b2ParticleContact.prototype,"ApproximatelyEqual",box2d.b2ParticleContact.prototype.ApproximatelyEqual);box2d.b2ParticleBodyContact=function(){this.normal=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ParticleBodyContact",box2d.b2ParticleBodyContact);box2d.b2ParticleBodyContact.prototype.index=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"index",box2d.b2ParticleBodyContact.prototype.index);box2d.b2ParticleBodyContact.prototype.body=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"body",box2d.b2ParticleBodyContact.prototype.body);box2d.b2ParticleBodyContact.prototype.fixture=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"fixture",box2d.b2ParticleBodyContact.prototype.fixture);box2d.b2ParticleBodyContact.prototype.weight=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"weight",box2d.b2ParticleBodyContact.prototype.weight);box2d.b2ParticleBodyContact.prototype.normal=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"normal",box2d.b2ParticleBodyContact.prototype.normal);box2d.b2ParticleBodyContact.prototype.mass=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"mass",box2d.b2ParticleBodyContact.prototype.mass);box2d.b2ParticlePair=function(){};goog.exportSymbol("box2d.b2ParticlePair",box2d.b2ParticlePair);box2d.b2ParticlePair.prototype.indexA=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"indexA",box2d.b2ParticlePair.prototype.indexA);box2d.b2ParticlePair.prototype.indexB=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"indexB",box2d.b2ParticlePair.prototype.indexB);box2d.b2ParticlePair.prototype.flags=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"flags",box2d.b2ParticlePair.prototype.flags);box2d.b2ParticlePair.prototype.strength=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"strength",box2d.b2ParticlePair.prototype.strength);box2d.b2ParticlePair.prototype.distance=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"distance",box2d.b2ParticlePair.prototype.distance);box2d.b2ParticleTriad=function(){this.pa=new box2d.b2Vec2(0,0);this.pb=new box2d.b2Vec2(0,0);this.pc=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2ParticleTriad",box2d.b2ParticleTriad);box2d.b2ParticleTriad.prototype.indexA=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexA",box2d.b2ParticleTriad.prototype.indexA);box2d.b2ParticleTriad.prototype.indexB=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexB",box2d.b2ParticleTriad.prototype.indexB);box2d.b2ParticleTriad.prototype.indexC=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexC",box2d.b2ParticleTriad.prototype.indexC);box2d.b2ParticleTriad.prototype.flags=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"flags",box2d.b2ParticleTriad.prototype.flags);box2d.b2ParticleTriad.prototype.strength=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"strength",box2d.b2ParticleTriad.prototype.strength);box2d.b2ParticleTriad.prototype.pa=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pa",box2d.b2ParticleTriad.prototype.pa);box2d.b2ParticleTriad.prototype.pb=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pb",box2d.b2ParticleTriad.prototype.pb);box2d.b2ParticleTriad.prototype.pc=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pc",box2d.b2ParticleTriad.prototype.pc);box2d.b2ParticleTriad.prototype.ka=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"ka",box2d.b2ParticleTriad.prototype.ka);box2d.b2ParticleTriad.prototype.kb=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"kb",box2d.b2ParticleTriad.prototype.kb);box2d.b2ParticleTriad.prototype.kc=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"kc",box2d.b2ParticleTriad.prototype.kc);box2d.b2ParticleTriad.prototype.s=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"s",box2d.b2ParticleTriad.prototype.s);box2d.b2ParticleSystemDef=function(){};goog.exportSymbol("box2d.b2ParticleSystemDef",box2d.b2ParticleSystemDef);box2d.b2ParticleSystemDef.prototype.strictContactCheck=!1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"strictContactCheck",box2d.b2ParticleSystemDef.prototype.strictContactCheck);box2d.b2ParticleSystemDef.prototype.density=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"density",box2d.b2ParticleSystemDef.prototype.density);box2d.b2ParticleSystemDef.prototype.gravityScale=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"gravityScale",box2d.b2ParticleSystemDef.prototype.gravityScale);box2d.b2ParticleSystemDef.prototype.radius=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"radius",box2d.b2ParticleSystemDef.prototype.radius);box2d.b2ParticleSystemDef.prototype.maxCount=0;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"maxCount",box2d.b2ParticleSystemDef.prototype.maxCount);box2d.b2ParticleSystemDef.prototype.pressureStrength=.005;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"pressureStrength",box2d.b2ParticleSystemDef.prototype.pressureStrength);box2d.b2ParticleSystemDef.prototype.dampingStrength=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"dampingStrength",box2d.b2ParticleSystemDef.prototype.dampingStrength);box2d.b2ParticleSystemDef.prototype.elasticStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"elasticStrength",box2d.b2ParticleSystemDef.prototype.elasticStrength);box2d.b2ParticleSystemDef.prototype.springStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"springStrength",box2d.b2ParticleSystemDef.prototype.springStrength);box2d.b2ParticleSystemDef.prototype.viscousStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"viscousStrength",box2d.b2ParticleSystemDef.prototype.viscousStrength);box2d.b2ParticleSystemDef.prototype.surfaceTensionPressureStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"surfaceTensionPressureStrength",box2d.b2ParticleSystemDef.prototype.surfaceTensionPressureStrength);box2d.b2ParticleSystemDef.prototype.surfaceTensionNormalStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"surfaceTensionNormalStrength",box2d.b2ParticleSystemDef.prototype.surfaceTensionNormalStrength);box2d.b2ParticleSystemDef.prototype.repulsiveStrength=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"repulsiveStrength",box2d.b2ParticleSystemDef.prototype.repulsiveStrength);box2d.b2ParticleSystemDef.prototype.powderStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"powderStrength",box2d.b2ParticleSystemDef.prototype.powderStrength);box2d.b2ParticleSystemDef.prototype.ejectionStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"ejectionStrength",box2d.b2ParticleSystemDef.prototype.ejectionStrength);box2d.b2ParticleSystemDef.prototype.staticPressureStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureStrength",box2d.b2ParticleSystemDef.prototype.staticPressureStrength);box2d.b2ParticleSystemDef.prototype.staticPressureRelaxation=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureRelaxation",box2d.b2ParticleSystemDef.prototype.staticPressureRelaxation);box2d.b2ParticleSystemDef.prototype.staticPressureIterations=8;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureIterations",box2d.b2ParticleSystemDef.prototype.staticPressureIterations);box2d.b2ParticleSystemDef.prototype.colorMixingStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"colorMixingStrength",box2d.b2ParticleSystemDef.prototype.colorMixingStrength);box2d.b2ParticleSystemDef.prototype.destroyByAge=!0;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"destroyByAge",box2d.b2ParticleSystemDef.prototype.destroyByAge);box2d.b2ParticleSystemDef.prototype.lifetimeGranularity=1/60;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"lifetimeGranularity",box2d.b2ParticleSystemDef.prototype.lifetimeGranularity);box2d.b2ParticleSystemDef.prototype.Copy=function(t){this.strictContactCheck=t.strictContactCheck;this.density=t.density;this.gravityScale=t.gravityScale;this.radius=t.radius;this.maxCount=t.maxCount;this.pressureStrength=t.pressureStrength;this.dampingStrength=t.dampingStrength;this.elasticStrength=t.elasticStrength;this.springStrength=t.springStrength;this.viscousStrength=t.viscousStrength;this.surfaceTensionPressureStrength=t.surfaceTensionPressureStrength;this.surfaceTensionNormalStrength=t.surfaceTensionNormalStrength;this.repulsiveStrength=t.repulsiveStrength;this.powderStrength=t.powderStrength;this.ejectionStrength=t.ejectionStrength;this.staticPressureStrength=t.staticPressureStrength;this.staticPressureRelaxation=t.staticPressureRelaxation;this.staticPressureIterations=t.staticPressureIterations;this.colorMixingStrength=t.colorMixingStrength;this.destroyByAge=t.destroyByAge;this.lifetimeGranularity=t.lifetimeGranularity;return this};box2d.b2ParticleSystemDef.prototype.Clone=function(){return(new box2d.b2ParticleSystemDef).Copy(this)};box2d.b2ParticleSystem=function(t,e){this._ctor_(t,e)};goog.exportSymbol("box2d.b2ParticleSystem",box2d.b2ParticleSystem);box2d.b2ParticleSystem.prototype.m_paused=!1;box2d.b2ParticleSystem.prototype.m_timestamp=0;box2d.b2ParticleSystem.prototype.m_allParticleFlags=0;box2d.b2ParticleSystem.prototype.m_needsUpdateAllParticleFlags=!1;box2d.b2ParticleSystem.prototype.m_allGroupFlags=0;box2d.b2ParticleSystem.prototype.m_needsUpdateAllGroupFlags=!1;box2d.b2ParticleSystem.prototype.m_hasForce=!1;box2d.b2ParticleSystem.prototype.m_iterationIndex=0;box2d.b2ParticleSystem.prototype.m_inverseDensity=0;box2d.b2ParticleSystem.prototype.m_particleDiameter=0;box2d.b2ParticleSystem.prototype.m_inverseDiameter=0;box2d.b2ParticleSystem.prototype.m_squaredDiameter=0;box2d.b2ParticleSystem.prototype.m_count=0;box2d.b2ParticleSystem.prototype.m_internalAllocatedCapacity=0;box2d.b2ParticleSystem.prototype.m_handleAllocator=null;box2d.b2ParticleSystem.prototype.m_handleIndexBuffer=null;box2d.b2ParticleSystem.prototype.m_flagsBuffer=null;box2d.b2ParticleSystem.prototype.m_positionBuffer=null;box2d.b2ParticleSystem.prototype.m_velocityBuffer=null;box2d.b2ParticleSystem.prototype.m_forceBuffer=null;box2d.b2ParticleSystem.prototype.m_weightBuffer=null;box2d.b2ParticleSystem.prototype.m_staticPressureBuffer=null;box2d.b2ParticleSystem.prototype.m_accumulationBuffer=null;box2d.b2ParticleSystem.prototype.m_accumulation2Buffer=null;box2d.b2ParticleSystem.prototype.m_depthBuffer=null;box2d.b2ParticleSystem.prototype.m_colorBuffer=null;box2d.b2ParticleSystem.prototype.m_groupBuffer=null;box2d.b2ParticleSystem.prototype.m_userDataBuffer=null;box2d.b2ParticleSystem.prototype.m_stuckThreshold=0;box2d.b2ParticleSystem.prototype.m_lastBodyContactStepBuffer=null;box2d.b2ParticleSystem.prototype.m_bodyContactCountBuffer=null;box2d.b2ParticleSystem.prototype.m_consecutiveContactStepsBuffer=null;box2d.b2ParticleSystem.prototype.m_stuckParticleBuffer=null;box2d.b2ParticleSystem.prototype.m_proxyBuffer=null;box2d.b2ParticleSystem.prototype.m_contactBuffer=null;box2d.b2ParticleSystem.prototype.m_bodyContactBuffer=null;box2d.b2ParticleSystem.prototype.m_pairBuffer=null;box2d.b2ParticleSystem.prototype.m_triadBuffer=null;box2d.b2ParticleSystem.prototype.m_expirationTimeBuffer=null;box2d.b2ParticleSystem.prototype.m_indexByExpirationTimeBuffer=null;box2d.b2ParticleSystem.prototype.m_timeElapsed=0;box2d.b2ParticleSystem.prototype.m_expirationTimeBufferRequiresSorting=!1;box2d.b2ParticleSystem.prototype.m_groupCount=0;box2d.b2ParticleSystem.prototype.m_groupList=null;box2d.b2ParticleSystem.prototype.m_def=null;box2d.b2ParticleSystem.prototype.m_world=null;box2d.b2ParticleSystem.prototype.m_prev=null;box2d.b2ParticleSystem.prototype.m_next=null;box2d.b2ParticleSystem.xTruncBits=12;box2d.b2ParticleSystem.yTruncBits=12;box2d.b2ParticleSystem.tagBits=32;box2d.b2ParticleSystem.yOffset=1<<box2d.b2ParticleSystem.yTruncBits-1;box2d.b2ParticleSystem.yShift=box2d.b2ParticleSystem.tagBits-box2d.b2ParticleSystem.yTruncBits;box2d.b2ParticleSystem.xShift=box2d.b2ParticleSystem.tagBits-box2d.b2ParticleSystem.yTruncBits-box2d.b2ParticleSystem.xTruncBits;box2d.b2ParticleSystem.xScale=1<<box2d.b2ParticleSystem.xShift;box2d.b2ParticleSystem.xOffset=box2d.b2ParticleSystem.xScale*(1<<box2d.b2ParticleSystem.xTruncBits-1);box2d.b2ParticleSystem.yMask=(1<<box2d.b2ParticleSystem.yTruncBits)-1<<box2d.b2ParticleSystem.yShift;box2d.b2ParticleSystem.xMask=~box2d.b2ParticleSystem.yMask;box2d.b2ParticleSystem.computeTag=function(t,e){return(e+box2d.b2ParticleSystem.yOffset>>>0<<box2d.b2ParticleSystem.yShift)+(box2d.b2ParticleSystem.xScale*t+box2d.b2ParticleSystem.xOffset>>>0)>>>0};box2d.b2ParticleSystem.computeRelativeTag=function(t,e,o){return t+(o<<box2d.b2ParticleSystem.yShift)+(e<<box2d.b2ParticleSystem.xShift)>>>0};box2d.b2ParticleSystem.FixedSetAllocator=function(){};box2d.b2ParticleSystem.FixedSetAllocator.prototype.Invalidate=function(t){};box2d.b2ParticleSystem.FixtureParticle=function(t,e){this.first=t;this.second=e};box2d.b2ParticleSystem.FixtureParticle.prototype.first=null;box2d.b2ParticleSystem.FixtureParticle.prototype.second=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.FixtureParticleSet=function(){};goog.inherits(box2d.b2ParticleSystem.FixtureParticleSet,box2d.b2ParticleSystem.FixedSetAllocator);box2d.b2ParticleSystem.FixtureParticleSet.prototype.Initialize=function(t,e){};box2d.b2ParticleSystem.FixtureParticleSet.prototype.Find=function(t){};box2d.b2ParticleSystem.ParticlePair=function(t,e){};box2d.b2ParticleSystem.ParticlePair.prototype.first=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.ParticlePair.prototype.second=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.b2ParticlePairSet=function(){};goog.inherits(box2d.b2ParticleSystem.b2ParticlePairSet,box2d.b2ParticleSystem.FixedSetAllocator);box2d.b2ParticleSystem.b2ParticlePairSet.prototype.Initialize=function(t,e){};box2d.b2ParticleSystem.b2ParticlePairSet.prototype.Find=function(t){};box2d.b2ParticleSystem.ConnectionFilter=function(){};box2d.b2ParticleSystem.ConnectionFilter.prototype.IsNecessary=function(t){return!0};box2d.b2ParticleSystem.ConnectionFilter.prototype.ShouldCreatePair=function(t,e){return!0};box2d.b2ParticleSystem.ConnectionFilter.prototype.ShouldCreateTriad=function(t,e,o){return!0};box2d.b2ParticleSystem.prototype._ctor_=function(t,e){this.m_handleIndexBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_flagsBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_positionBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_velocityBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_forceBuffer=[];this.m_weightBuffer=[];this.m_staticPressureBuffer=[];this.m_accumulationBuffer=[];this.m_accumulation2Buffer=[];this.m_depthBuffer=[];this.m_colorBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_groupBuffer=[];this.m_userDataBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_lastBodyContactStepBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_bodyContactCountBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_consecutiveContactStepsBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_stuckParticleBuffer=new box2d.b2GrowableBuffer(function(){return 0});this.m_proxyBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleSystem.Proxy});this.m_contactBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleContact});this.m_bodyContactBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleBodyContact});this.m_pairBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticlePair});this.m_triadBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleTriad});this.m_expirationTimeBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_indexByExpirationTimeBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_def=new box2d.b2ParticleSystemDef;box2d.b2Assert(null!==t);this.SetStrictContactCheck(t.strictContactCheck);this.SetDensity(t.density);this.SetGravityScale(t.gravityScale);this.SetRadius(t.radius);this.SetMaxParticleCount(t.maxCount);box2d.b2Assert(0<t.lifetimeGranularity);this.m_def=t.Clone();this.m_world=e;this.SetDestructionByAge(this.m_def.destroyByAge)};box2d.b2ParticleSystem.prototype._dtor_=function(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer);this.FreeUserOverridableBuffer(this.m_flagsBuffer);this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer);this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer);this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer);this.FreeUserOverridableBuffer(this.m_positionBuffer);this.FreeUserOverridableBuffer(this.m_velocityBuffer);this.FreeUserOverridableBuffer(this.m_colorBuffer);this.FreeUserOverridableBuffer(this.m_userDataBuffer);this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer);this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer);this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)};box2d.b2ParticleSystem.prototype.Drop=function(){this._dtor_()};box2d.b2ParticleSystem.prototype.CreateParticle=function(t){box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return 0;this.m_count>=this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(this.m_count?2*this.m_count:box2d.b2_minParticleSystemBufferCapacity);if(this.m_count>=this.m_internalAllocatedCapacity)if(this.m_def.destroyByAge)this.DestroyOldestParticle(0,!1),this.SolveZombie();else return box2d.b2_invalidParticleIndex;var e=this.m_count++;this.m_flagsBuffer.data[e]=0;this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[e]=0);this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[e]=0);this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[e]=0);this.m_positionBuffer.data[e]=(this.m_positionBuffer.data[e]||new box2d.b2Vec2).Copy(t.position);this.m_velocityBuffer.data[e]=(this.m_velocityBuffer.data[e]||new box2d.b2Vec2).Copy(t.velocity);this.m_weightBuffer[e]=0;this.m_forceBuffer[e]=(this.m_forceBuffer[e]||new box2d.b2Vec2).SetZero();this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[e]=0);this.m_depthBuffer&&(this.m_depthBuffer[e]=0);if(this.m_colorBuffer.data||!t.color.IsZero())this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[e]=(this.m_colorBuffer.data[e]||new box2d.b2ParticleColor).Copy(t.color);if(this.m_userDataBuffer.data||t.userData)this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[e]=t.userData;this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[e]=null);var o=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],i=0<t.lifetime;if(this.m_expirationTimeBuffer.data||i)this.SetParticleLifetime(e,i?t.lifetime:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),this.m_indexByExpirationTimeBuffer.data[e]=e;o.index=e;o=t.group;if(this.m_groupBuffer[e]=o)o.m_firstIndex<o.m_lastIndex?(this.RotateBuffer(o.m_firstIndex,o.m_lastIndex,e),box2d.b2Assert(o.m_lastIndex===e)):o.m_firstIndex=e,o.m_lastIndex=e+1;this.SetParticleFlags(e,t.flags);return e};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticle",box2d.b2ParticleSystem.prototype.CreateParticle);box2d.b2ParticleSystem.prototype.GetParticleHandleFromIndex=function(t){box2d.b2Assert(0<=t&&t<this.GetParticleCount()&&t!==box2d.b2_invalidParticleIndex);this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);var e=this.m_handleIndexBuffer.data[t];if(e)return e;e=new box2d.b2ParticleHandle;box2d.b2Assert(null!==e);e.SetIndex(t);return this.m_handleIndexBuffer.data[t]=e};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleHandleFromIndex",box2d.b2ParticleSystem.prototype.GetParticleHandleFromIndex);box2d.b2ParticleSystem.prototype.DestroyParticle=function(t,e){var o=box2d.b2ParticleFlag.b2_zombieParticle;e&&(o|=box2d.b2ParticleFlag.b2_destructionListenerParticle);this.SetParticleFlags(t,this.m_flagsBuffer.data[t]|o)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticle",box2d.b2ParticleSystem.prototype.DestroyParticle);box2d.b2ParticleSystem.prototype.DestroyOldestParticle=function(t,e){var o=this.GetParticleCount();box2d.b2Assert(0<=t&&t<o);box2d.b2Assert(null!==this.m_indexByExpirationTimeBuffer.data);var o=this.m_indexByExpirationTimeBuffer.data[o-(t+1)],i=this.m_indexByExpirationTimeBuffer.data[t];this.DestroyParticle(0<this.m_expirationTimeBuffer.data[o]?o:i,e)};box2d.b2ParticleSystem.DestroyParticlesInShapeCallback=function(t,e,o,i){this.m_system=t;this.m_shape=e;this.m_xf=o;this.m_callDestructionListener=i;this.m_destroyed=0};goog.inherits(box2d.b2ParticleSystem.DestroyParticlesInShapeCallback,box2d.b2QueryCallback);box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_system=null;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_shape=null;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_xf=null;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_callDestructionListener=!1;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_destroyed=0;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.ReportFixture=function(t){return!1};box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.ReportParticle=function(t,e){if(t!==this.m_system)return!1;box2d.b2Assert(0<=e&&e<this.m_system.m_count);this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[e])&&(this.m_system.DestroyParticle(e,this.m_callDestructionListener),this.m_destroyed++);return!0};box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.Destroyed=function(){return this.m_destroyed};box2d.b2ParticleSystem.prototype.DestroyParticlesInShape=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.DestroyParticlesInShape.s_aabb;box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return 0;o=new box2d.b2ParticleSystem.DestroyParticlesInShapeCallback(this,t,e,o);t.ComputeAABB(i,e,0);this.m_world.QueryAABB(o,i);return o.Destroyed()};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticlesInShape",box2d.b2ParticleSystem.prototype.DestroyParticlesInShape);box2d.b2ParticleSystem.prototype.DestroyParticlesInShape.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.CreateParticleGroup=function(t){var e=box2d.b2ParticleSystem.prototype.CreateParticleGroup.s_transform;box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return null;e.Set(t.position,t.angle);var o=this.m_count;t.shape&&this.CreateParticlesWithShapeForGroup(t.shape,t,e);t.shapes&&this.CreateParticlesWithShapesForGroup(t.shapes,t.shapeCount,t,e);if(t.particleCount){box2d.b2Assert(null!==t.positionData);for(var i=0;i<t.particleCount;i++)this.CreateParticleForGroup(t,e,t.positionData[i])}var a=this.m_count,r=new box2d.b2ParticleGroup;r.m_system=this;r.m_firstIndex=o;r.m_lastIndex=a;r.m_strength=t.strength;r.m_userData=t.userData;r.m_transform.Copy(e);r.m_prev=null;if(r.m_next=this.m_groupList)this.m_groupList.m_prev=r;this.m_groupList=r;++this.m_groupCount;for(i=o;i<a;i++)this.m_groupBuffer[i]=r;this.SetGroupFlags(r,t.groupFlags);e=new box2d.b2ParticleSystem.ConnectionFilter;this.UpdateContacts(!0);this.UpdatePairsAndTriads(o,a,e);t.group&&(this.JoinParticleGroups(t.group,r),r=t.group);return r};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticleGroup",box2d.b2ParticleSystem.prototype.CreateParticleGroup);box2d.b2ParticleSystem.prototype.CreateParticleGroup.s_transform=new box2d.b2Transform;box2d.b2ParticleSystem.JoinParticleGroupsFilter=function(t){this.m_threshold=t};goog.inherits(box2d.b2ParticleSystem.JoinParticleGroupsFilter,box2d.b2ParticleSystem.ConnectionFilter);box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.m_threshold=0;box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.ShouldCreatePair=function(t,e){return t<this.m_threshold&&this.m_threshold<=e||e<this.m_threshold&&this.m_threshold<=t};box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.ShouldCreateTriad=function(t,e,o){return(t<this.m_threshold||e<this.m_threshold||o<this.m_threshold)&&(this.m_threshold<=t||this.m_threshold<=e||this.m_threshold<=o)};box2d.b2ParticleSystem.prototype.JoinParticleGroups=function(t,e){box2d.b2Assert(!1===this.m_world.IsLocked());if(!this.m_world.IsLocked()){box2d.b2Assert(t!==e);this.RotateBuffer(e.m_firstIndex,e.m_lastIndex,this.m_count);box2d.b2Assert(e.m_lastIndex===this.m_count);this.RotateBuffer(t.m_firstIndex,t.m_lastIndex,e.m_firstIndex);box2d.b2Assert(t.m_lastIndex===e.m_firstIndex);var o=new box2d.b2ParticleSystem.JoinParticleGroupsFilter(e.m_firstIndex);this.UpdateContacts(!0);this.UpdatePairsAndTriads(t.m_firstIndex,e.m_lastIndex,o);for(o=e.m_firstIndex;o<e.m_lastIndex;o++)this.m_groupBuffer[o]=t;this.SetGroupFlags(t,t.m_groupFlags|e.m_groupFlags);t.m_lastIndex=e.m_lastIndex;e.m_firstIndex=e.m_lastIndex;this.DestroyParticleGroup(e)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"JoinParticleGroups",box2d.b2ParticleSystem.prototype.JoinParticleGroups);box2d.b2ParticleSystem.prototype.SplitParticleGroup=function(t){this.UpdateContacts(!0);var e=t.GetParticleCount(),e=box2d.b2MakeArray(e,function(t){return new box2d.b2ParticleSystem.ParticleListNode});box2d.b2ParticleSystem.InitializeParticleLists(t,e);this.MergeParticleListsInContact(t,e);var o=box2d.b2ParticleSystem.FindLongestParticleList(t,e);this.MergeZombieParticleListNodes(t,e,o);this.CreateParticleGroupsFromParticleList(t,e,o);this.UpdatePairsAndTriadsWithParticleList(t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SplitParticleGroup",box2d.b2ParticleSystem.prototype.SplitParticleGroup);box2d.b2ParticleSystem.prototype.GetParticleGroupList=function(){return this.m_groupList};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleGroupList",box2d.b2ParticleSystem.prototype.GetParticleGroupList);box2d.b2ParticleSystem.prototype.GetParticleGroupCount=function(){return this.m_groupCount};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleGroupCount",box2d.b2ParticleSystem.prototype.GetParticleGroupCount);box2d.b2ParticleSystem.prototype.GetParticleCount=function(){return this.m_count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleCount",box2d.b2ParticleSystem.prototype.GetParticleCount);box2d.b2ParticleSystem.prototype.GetMaxParticleCount=function(){return this.m_def.maxCount};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetMaxParticleCount",box2d.b2ParticleSystem.prototype.GetMaxParticleCount);box2d.b2ParticleSystem.prototype.SetMaxParticleCount=function(t){box2d.b2Assert(this.m_count<=t);this.m_def.maxCount=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetMaxParticleCount",box2d.b2ParticleSystem.prototype.SetMaxParticleCount);box2d.b2ParticleSystem.prototype.GetAllParticleFlags=function(){return this.m_allParticleFlags};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetAllParticleFlags",box2d.b2ParticleSystem.prototype.GetAllParticleFlags);box2d.b2ParticleSystem.prototype.GetAllGroupFlags=function(){return this.m_allGroupFlags};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetAllGroupFlags",box2d.b2ParticleSystem.prototype.GetAllGroupFlags);box2d.b2ParticleSystem.prototype.SetPaused=function(t){this.m_paused=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetPaused",box2d.b2ParticleSystem.prototype.SetPaused);box2d.b2ParticleSystem.prototype.GetPaused=function(){return this.m_paused};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPaused",box2d.b2ParticleSystem.prototype.GetPaused);box2d.b2ParticleSystem.prototype.SetDensity=function(t){this.m_def.density=t;this.m_inverseDensity=1/this.m_def.density};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDensity",box2d.b2ParticleSystem.prototype.SetDensity);box2d.b2ParticleSystem.prototype.GetDensity=function(){return this.m_def.density};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDensity",box2d.b2ParticleSystem.prototype.GetDensity);box2d.b2ParticleSystem.prototype.SetGravityScale=function(t){this.m_def.gravityScale=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetGravityScale",box2d.b2ParticleSystem.prototype.SetGravityScale);box2d.b2ParticleSystem.prototype.GetGravityScale=function(){return this.m_def.gravityScale};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetGravityScale",box2d.b2ParticleSystem.prototype.GetGravityScale);box2d.b2ParticleSystem.prototype.SetDamping=function(t){this.m_def.dampingStrength=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDamping",box2d.b2ParticleSystem.prototype.SetDamping);box2d.b2ParticleSystem.prototype.GetDamping=function(){return this.m_def.dampingStrength};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDamping",box2d.b2ParticleSystem.prototype.GetDamping);box2d.b2ParticleSystem.prototype.SetStaticPressureIterations=function(t){this.m_def.staticPressureIterations=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetStaticPressureIterations",box2d.b2ParticleSystem.prototype.SetStaticPressureIterations);box2d.b2ParticleSystem.prototype.GetStaticPressureIterations=function(){return this.m_def.staticPressureIterations};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStaticPressureIterations",box2d.b2ParticleSystem.prototype.GetStaticPressureIterations);box2d.b2ParticleSystem.prototype.SetRadius=function(t){this.m_particleDiameter=2*t;this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter;this.m_inverseDiameter=1/this.m_particleDiameter};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetRadius",box2d.b2ParticleSystem.prototype.SetRadius);box2d.b2ParticleSystem.prototype.GetRadius=function(){return this.m_particleDiameter/2};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetRadius",box2d.b2ParticleSystem.prototype.GetRadius);box2d.b2ParticleSystem.prototype.GetPositionBuffer=function(){return this.m_positionBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPositionBuffer",box2d.b2ParticleSystem.prototype.GetPositionBuffer);box2d.b2ParticleSystem.prototype.GetVelocityBuffer=function(){return this.m_velocityBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetVelocityBuffer",box2d.b2ParticleSystem.prototype.GetVelocityBuffer);box2d.b2ParticleSystem.prototype.GetColorBuffer=function(){this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data);return this.m_colorBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetColorBuffer",box2d.b2ParticleSystem.prototype.GetColorBuffer);box2d.b2ParticleSystem.prototype.GetGroupBuffer=function(){return this.m_groupBuffer};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetGroupBuffer",box2d.b2ParticleSystem.prototype.GetGroupBuffer);box2d.b2ParticleSystem.prototype.GetWeightBuffer=function(){return this.m_weightBuffer};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetWeightBuffer",box2d.b2ParticleSystem.prototype.GetWeightBuffer);box2d.b2ParticleSystem.prototype.GetUserDataBuffer=function(){this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data);return this.m_userDataBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetUserDataBuffer",box2d.b2ParticleSystem.prototype.GetUserDataBuffer);box2d.b2ParticleSystem.prototype.GetFlagsBuffer=function(){return this.m_flagsBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetFlagsBuffer",box2d.b2ParticleSystem.prototype.GetFlagsBuffer);box2d.b2ParticleSystem.prototype.SetParticleFlags=function(t,e){this.m_flagsBuffer.data[t]&~e&&(this.m_needsUpdateAllParticleFlags=!0);~this.m_allParticleFlags&e&&(e&box2d.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),e&box2d.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=e);this.m_flagsBuffer.data[t]=e};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetParticleFlags",box2d.b2ParticleSystem.prototype.SetParticleFlags);box2d.b2ParticleSystem.prototype.GetParticleFlags=function(t){return this.m_flagsBuffer.data[t]};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleFlags",box2d.b2ParticleSystem.prototype.GetParticleFlags);box2d.b2ParticleSystem.prototype.SetFlagsBuffer=function(t,e){this.SetUserOverridableBuffer(this.m_flagsBuffer,t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetFlagsBuffer",box2d.b2ParticleSystem.prototype.SetFlagsBuffer);box2d.b2ParticleSystem.prototype.SetPositionBuffer=function(t,e){this.SetUserOverridableBuffer(this.m_positionBuffer,t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetPositionBuffer",box2d.b2ParticleSystem.prototype.SetPositionBuffer);box2d.b2ParticleSystem.prototype.SetVelocityBuffer=function(t,e){this.SetUserOverridableBuffer(this.m_velocityBuffer,t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetVelocityBuffer",box2d.b2ParticleSystem.prototype.SetVelocityBuffer);box2d.b2ParticleSystem.prototype.SetColorBuffer=function(t,e){this.SetUserOverridableBuffer(this.m_colorBuffer,t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetColorBuffer",box2d.b2ParticleSystem.prototype.SetColorBuffer);box2d.b2ParticleSystem.prototype.SetUserDataBuffer=function(t,e){this.SetUserOverridableBuffer(this.m_userDataBuffer,t,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetUserDataBuffer",box2d.b2ParticleSystem.prototype.SetUserDataBuffer);box2d.b2ParticleSystem.prototype.GetContacts=function(){return this.m_contactBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetContacts",box2d.b2ParticleSystem.prototype.GetContacts);box2d.b2ParticleSystem.prototype.GetContactCount=function(){return this.m_contactBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetContactCount",box2d.b2ParticleSystem.prototype.GetContactCount);box2d.b2ParticleSystem.prototype.GetBodyContacts=function(){return this.m_bodyContactBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetBodyContacts",box2d.b2ParticleSystem.prototype.GetBodyContacts);box2d.b2ParticleSystem.prototype.GetBodyContactCount=function(){return this.m_bodyContactBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetBodyContactCount",box2d.b2ParticleSystem.prototype.GetBodyContactCount);box2d.b2ParticleSystem.prototype.GetPairs=function(){return this.m_pairBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPairs",box2d.b2ParticleSystem.prototype.GetPairs);box2d.b2ParticleSystem.prototype.GetPairCount=function(){return this.m_pairBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPairCount",box2d.b2ParticleSystem.prototype.GetPairCount);box2d.b2ParticleSystem.prototype.GetTriads=function(){return this.m_triadBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetTriads",box2d.b2ParticleSystem.prototype.GetTriads);box2d.b2ParticleSystem.prototype.GetTriadCount=function(){return this.m_triadBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetTriadCount",box2d.b2ParticleSystem.prototype.GetTriadCount);box2d.b2ParticleSystem.prototype.SetStuckThreshold=function(t){this.m_stuckThreshold=t;0<t&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))};box2d.b2ParticleSystem.prototype.GetStuckCandidates=function(){return this.m_stuckParticleBuffer.Data()};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStuckCandidates",box2d.b2ParticleSystem.prototype.GetStuckCandidates);box2d.b2ParticleSystem.prototype.GetStuckCandidateCount=function(){return this.m_stuckParticleBuffer.GetCount()};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStuckCandidateCount",box2d.b2ParticleSystem.prototype.GetStuckCandidateCount);box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy=function(){for(var t=box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy.s_v,e=this.m_velocityBuffer.data,o=0,i=0;i<this.m_contactBuffer.count;i++){var a=this.m_contactBuffer.data[i],r=a.normal,a=box2d.b2Sub_V2_V2(e[a.indexB],e[a.indexA],t),r=box2d.b2Dot_V2_V2(a,r);0>r&&(o+=r*r)}return.5*this.GetParticleMass()*o};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ComputeCollisionEnergy",box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy);box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SetStrictContactCheck=function(t){this.m_def.strictContactCheck=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetStrictContactCheck",box2d.b2ParticleSystem.prototype.SetStrictContactCheck);box2d.b2ParticleSystem.prototype.GetStrictContactCheck=function(){return this.m_def.strictContactCheck};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStrictContactCheck",box2d.b2ParticleSystem.prototype.GetStrictContactCheck);box2d.b2ParticleSystem.prototype.SetParticleLifetime=function(t,e){box2d.b2Assert(this.ValidateParticleIndex(t));var o=null===this.m_indexByExpirationTimeBuffer.data;this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data);this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);if(o)for(var o=this.GetParticleCount(),i=0;i<o;++i)this.m_indexByExpirationTimeBuffer.data[i]=i;o=e/this.m_def.lifetimeGranularity;o=0<o?this.GetQuantizedTimeElapsed()+o:o;o!==this.m_expirationTimeBuffer.data[t]&&(this.m_expirationTimeBuffer.data[t]=o,this.m_expirationTimeBufferRequiresSorting=!0)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetParticleLifetime",box2d.b2ParticleSystem.prototype.SetParticleLifetime);box2d.b2ParticleSystem.prototype.GetParticleLifetime=function(t){box2d.b2Assert(this.ValidateParticleIndex(t));return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[t])};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleLifetime",box2d.b2ParticleSystem.prototype.GetParticleLifetime);box2d.b2ParticleSystem.prototype.SetDestructionByAge=function(t){t&&this.GetExpirationTimeBuffer();this.m_def.destroyByAge=t};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDestructionByAge",box2d.b2ParticleSystem.prototype.SetDestructionByAge);box2d.b2ParticleSystem.prototype.GetDestructionByAge=function(){return this.m_def.destroyByAge};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDestructionByAge",box2d.b2ParticleSystem.prototype.GetDestructionByAge);box2d.b2ParticleSystem.prototype.GetExpirationTimeBuffer=function(){this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data);return this.m_expirationTimeBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetExpirationTimeBuffer",box2d.b2ParticleSystem.prototype.GetExpirationTimeBuffer);box2d.b2ParticleSystem.prototype.ExpirationTimeToLifetime=function(t){return(0<t?t-this.GetQuantizedTimeElapsed():t)*this.m_def.lifetimeGranularity};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ExpirationTimeToLifetime",box2d.b2ParticleSystem.prototype.ExpirationTimeToLifetime);box2d.b2ParticleSystem.prototype.GetIndexByExpirationTimeBuffer=function(){this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);return this.m_indexByExpirationTimeBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetIndexByExpirationTimeBuffer",box2d.b2ParticleSystem.prototype.GetIndexByExpirationTimeBuffer);box2d.b2ParticleSystem.prototype.ParticleApplyLinearImpulse=function(t,e){this.ApplyLinearImpulse(t,t+1,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ParticleApplyLinearImpulse",box2d.b2ParticleSystem.prototype.ParticleApplyLinearImpulse);box2d.b2ParticleSystem.prototype.ApplyLinearImpulse=function(t,e,o){var i=this.m_velocityBuffer.data,a=(e-t)*this.GetParticleMass();for(o=o.Clone().SelfMul(1/a);t<e;t++)i[t].SelfAdd(o)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ApplyLinearImpulse",box2d.b2ParticleSystem.prototype.ApplyLinearImpulse);box2d.b2ParticleSystem.IsSignificantForce=function(t){return 0!==t.x||0!==t.y};box2d.b2ParticleSystem.prototype.ParticleApplyForce=function(t,e){box2d.b2ParticleSystem.IsSignificantForce(e)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[t])&&(this.PrepareForceBuffer(),this.m_forceBuffer[t].SelfAdd(e))};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ParticleApplyForce",box2d.b2ParticleSystem.prototype.ParticleApplyForce);box2d.b2ParticleSystem.prototype.ApplyForce=function(t,e,o){for(var i=0,a=t;a<e;a++)i|=this.m_flagsBuffer.data[a];box2d.b2Assert(this.ForceCanBeApplied(i));o=o.Clone().SelfMul(1/(e-t));if(box2d.b2ParticleSystem.IsSignificantForce(o))for(this.PrepareForceBuffer(),a=t;a<e;a++)this.m_forceBuffer[a].SelfAdd(o)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ApplyForce",box2d.b2ParticleSystem.prototype.ApplyForce);box2d.b2ParticleSystem.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetNext",box2d.b2ParticleSystem.prototype.GetNext);box2d.b2ParticleSystem.prototype.QueryAABB=function(t,e){if(0!==this.m_proxyBuffer.count)for(var o=this.m_proxyBuffer.count,i=box2d.std_lower_bound(this.m_proxyBuffer.data,0,o,box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*e.lowerBound.x,this.m_inverseDiameter*e.lowerBound.y),box2d.b2ParticleSystem.Proxy.CompareProxyTag),o=box2d.std_upper_bound(this.m_proxyBuffer.data,i,o,box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*e.upperBound.x,this.m_inverseDiameter*e.upperBound.y),box2d.b2ParticleSystem.Proxy.CompareTagProxy),a=this.m_positionBuffer.data;i<o;++i){var r=this.m_proxyBuffer.data[i].index,s=a[r];if(e.lowerBound.x<s.x&&s.x<e.upperBound.x&&e.lowerBound.y<s.y&&s.y<e.upperBound.y&&!t.ReportParticle(this,r))break}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryAABB",box2d.b2ParticleSystem.prototype.QueryAABB);box2d.b2ParticleSystem.prototype.QueryShapeAABB=function(t,e,o,i){var a=box2d.b2ParticleSystem.prototype.QueryShapeAABB.s_aabb;e.ComputeAABB(a,o,i||0);this.QueryAABB(t,a)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryShapeAABB",box2d.b2ParticleSystem.prototype.QueryShapeAABB);box2d.b2ParticleSystem.prototype.QueryShapeAABB.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.QueryPointAABB=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.QueryPointAABB.s_aabb;o="number"===typeof o?o:box2d.b2_linearSlop;i.lowerBound.Set(e.x-o,e.y-o);i.upperBound.Set(e.x+o,e.y+o);this.QueryAABB(t,i)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryPointAABB",box2d.b2ParticleSystem.prototype.QueryPointAABB);box2d.b2ParticleSystem.prototype.QueryPointAABB.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.RayCast=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.RayCast.s_aabb,a=box2d.b2ParticleSystem.prototype.RayCast.s_p,r=box2d.b2ParticleSystem.prototype.RayCast.s_v,s=box2d.b2ParticleSystem.prototype.RayCast.s_n,n=box2d.b2ParticleSystem.prototype.RayCast.s_point;if(0!==this.m_proxyBuffer.count){var b=this.m_positionBuffer.data;box2d.b2Min_V2_V2(e,o,i.lowerBound);box2d.b2Max_V2_V2(e,o,i.upperBound);var x=1;o=box2d.b2Sub_V2_V2(o,e,r);for(var r=box2d.b2Dot_V2_V2(o,o),i=this.GetInsideBoundsEnumerator(i),l;0<=(l=i.GetNext());){var _=box2d.b2Sub_V2_V2(e,b[l],a),h=box2d.b2Dot_V2_V2(_,o),d=box2d.b2Dot_V2_V2(_,_),d=h*h-r*(d-this.m_squaredDiameter);if(0<=d){var p=box2d.b2Sqrt(d),d=(-h-p)/r;if(!(d>x)){if(0>d&&(d=(-h+p)/r,0>d||d>x))continue;_=box2d.b2AddMul_V2_S_V2(_,d,o,s);_.Normalize();l=t.ReportParticle(this,l,box2d.b2AddMul_V2_S_V2(e,d,o,n),_,d);x=box2d.b2Min(x,l);if(0>=x)break}}}}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"RayCast",box2d.b2ParticleSystem.prototype.RayCast);box2d.b2ParticleSystem.prototype.RayCast.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.RayCast.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_n=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_point=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.ComputeAABB=function(t){var e=this.GetParticleCount();box2d.b2Assert(null!==t);t.lowerBound.x=+box2d.b2_maxFloat;t.lowerBound.y=+box2d.b2_maxFloat;t.upperBound.x=-box2d.b2_maxFloat;t.upperBound.y=-box2d.b2_maxFloat;for(var o=this.m_positionBuffer.data,i=0;i<e;i++){var a=o[i];box2d.b2Min_V2_V2(t.lowerBound,a,t.lowerBound);box2d.b2Max_V2_V2(t.upperBound,a,t.upperBound)}t.lowerBound.x-=this.m_particleDiameter;t.lowerBound.y-=this.m_particleDiameter;t.upperBound.x+=this.m_particleDiameter;t.upperBound.y+=this.m_particleDiameter};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ComputeAABB",box2d.b2ParticleSystem.prototype.ComputeAABB);box2d.b2ParticleSystem.UserOverridableBuffer=function(){};box2d.b2ParticleSystem.UserOverridableBuffer.prototype.data=null;box2d.b2ParticleSystem.UserOverridableBuffer.prototype.userSuppliedCapacity=0;box2d.b2ParticleSystem.Proxy=function(){};box2d.b2ParticleSystem.Proxy.prototype.index=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.Proxy.prototype.tag=0;box2d.b2ParticleSystem.Proxy.CompareProxyProxy=function(t,e){return t.tag<e.tag};box2d.b2ParticleSystem.Proxy.CompareTagProxy=function(t,e){return t<e.tag};box2d.b2ParticleSystem.Proxy.CompareProxyTag=function(t,e){return t.tag<e};box2d.b2ParticleSystem.InsideBoundsEnumerator=function(t,e,o,i,a){this.m_system=t;this.m_xLower=(e&box2d.b2ParticleSystem.xMask)>>>0;this.m_xUpper=(o&box2d.b2ParticleSystem.xMask)>>>0;this.m_yLower=(e&box2d.b2ParticleSystem.yMask)>>>0;this.m_yUpper=(o&box2d.b2ParticleSystem.yMask)>>>0;this.m_first=i;this.m_last=a;box2d.b2Assert(this.m_first<=this.m_last)};box2d.b2ParticleSystem.InsideBoundsEnumerator.prototype.GetNext=function(){for(;this.m_first<this.m_last;){var t=(this.m_system.m_proxyBuffer.data[this.m_first].tag&box2d.b2ParticleSystem.xMask)>>>0,e=(this.m_system.m_proxyBuffer.data[this.m_first].tag&box2d.b2ParticleSystem.yMask)>>>0;box2d.b2Assert(e>=this.m_yLower);box2d.b2Assert(e<=this.m_yUpper);if(t>=this.m_xLower&&t<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return box2d.b2_invalidParticleIndex};box2d.b2ParticleSystem.ParticleListNode=function(){};box2d.b2ParticleSystem.ParticleListNode.prototype.list=null;box2d.b2ParticleSystem.ParticleListNode.prototype.next=null;box2d.b2ParticleSystem.ParticleListNode.prototype.count=0;box2d.b2ParticleSystem.ParticleListNode.prototype.index=0;box2d.b2ParticleSystem.k_pairFlags=box2d.b2ParticleFlag.b2_springParticle;box2d.b2ParticleSystem.k_triadFlags=box2d.b2ParticleFlag.b2_elasticParticle;box2d.b2ParticleSystem.k_noPressureFlags=box2d.b2ParticleFlag.b2_powderParticle|box2d.b2ParticleFlag.b2_tensileParticle;box2d.b2ParticleSystem.k_extraDampingFlags=box2d.b2ParticleFlag.b2_staticPressureParticle;box2d.b2ParticleSystem.k_barrierWallFlags=box2d.b2ParticleFlag.b2_barrierParticle|box2d.b2ParticleFlag.b2_wallParticle;box2d.b2ParticleSystem.prototype.FreeBuffer=function(t,e){null!==t&&(t.length=0)};box2d.b2ParticleSystem.prototype.FreeUserOverridableBuffer=function(t){0==t.userSuppliedCapacity&&this.FreeBuffer(t.data,this.m_internalAllocatedCapacity)};box2d.b2ParticleSystem.prototype.ReallocateBuffer3=function(t,e,o){box2d.b2Assert(o>e);t=t?t.slice():[];t.length=o;return t};box2d.b2ParticleSystem.prototype.ReallocateBuffer5=function(t,e,o,i,a){box2d.b2Assert(i>o);box2d.b2Assert(!e||i<=e);a&&!t||e||(t=this.ReallocateBuffer3(t,o,i));return t};box2d.b2ParticleSystem.prototype.ReallocateBuffer4=function(t,e,o,i){box2d.b2Assert(o>e);return this.ReallocateBuffer5(t.data,t.userSuppliedCapacity,e,o,i)};box2d.b2ParticleSystem.prototype.RequestBuffer=function(t){t||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(box2d.b2_minParticleSystemBufferCapacity),t=[],t.length=this.m_internalAllocatedCapacity);return t};box2d.b2ParticleSystem.prototype.ReallocateHandleBuffers=function(t){box2d.b2Assert(t>this.m_internalAllocatedCapacity);this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,t,!0)};box2d.b2ParticleSystem.prototype.ReallocateInternalAllocatedBuffers=function(t){function e(t,e){return e&&t>e?e:t}t=e(t,this.m_def.maxCount);t=e(t,this.m_flagsBuffer.userSuppliedCapacity);t=e(t,this.m_positionBuffer.userSuppliedCapacity);t=e(t,this.m_velocityBuffer.userSuppliedCapacity);t=e(t,this.m_colorBuffer.userSuppliedCapacity);t=e(t,this.m_userDataBuffer.userSuppliedCapacity);if(this.m_internalAllocatedCapacity<t){this.ReallocateHandleBuffers(t);this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,this.m_internalAllocatedCapacity,t,!1);var o=0<this.m_stuckThreshold;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,t,o);this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,t,o);this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,t,o);this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,this.m_internalAllocatedCapacity,t,!1);this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,t,!1);this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,t,!1);this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,t,!1);this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,t,!0);this.m_accumulationBuffer=this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,t,!1);this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,t,!0);this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,t,!0);this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,t,!0);this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,t,!1);this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,t,!0);this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,t,!0);this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,t,!1);this.m_internalAllocatedCapacity=t}};box2d.b2ParticleSystem.prototype.CreateParticleForGroup=function(t,e,o){var i=new box2d.b2ParticleDef;i.flags=t.flags;box2d.b2Mul_X_V2(e,o,i.position);box2d.b2Add_V2_V2(t.linearVelocity,box2d.b2Cross_S_V2(t.angularVelocity,box2d.b2Sub_V2_V2(i.position,t.position,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),i.velocity);i.color.Copy(t.color);i.lifetime=t.lifetime;i.userData=t.userData;this.CreateParticle(i)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticleForGroup",box2d.b2ParticleSystem.prototype.CreateParticleForGroup);box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_edge,a=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_d,r=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_p,s=e.stride;0===s&&(s=this.GetParticleStride());for(var n=0,b=t.GetChildCount(),x=0;x<b;x++){var l=null;t.GetType()===box2d.b2ShapeType.e_edgeShape?l=t:(box2d.b2Assert(t.GetType()===box2d.b2ShapeType.e_chainShape),l=i,t.GetChildEdge(l,x));for(var _=box2d.b2Sub_V2_V2(l.m_vertex2,l.m_vertex1,a),h=_.Length();n<h;){var d=box2d.b2AddMul_V2_S_V2(l.m_vertex1,n/h,_,r);this.CreateParticleForGroup(e,o,d);n+=s}n-=h}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesStrokeShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup);box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_edge=new box2d.b2EdgeShape;box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_d=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_aabb,a=box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_p,r=e.stride;0===r&&(r=this.GetParticleStride());var s=box2d.b2Transform.IDENTITY;box2d.b2Assert(1===t.GetChildCount());t.ComputeAABB(i,s,0);for(var n=Math.floor(i.lowerBound.y/r)*r;n<i.upperBound.y;n+=r)for(var b=Math.floor(i.lowerBound.x/r)*r;b<i.upperBound.x;b+=r){var x=a.Set(b,n);t.TestPoint(s,x)&&this.CreateParticleForGroup(e,o,x)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesFillShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup);box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.CreateParticlesWithShapeForGroup=function(t,e,o){switch(t.GetType()){case box2d.b2ShapeType.e_edgeShape:case box2d.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(t,e,o);break;case box2d.b2ShapeType.e_polygonShape:case box2d.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(t,e,o);break;default:box2d.b2Assert(!1)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesWithShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesWithShapeForGroup);box2d.b2ParticleSystem.CompositeShape=function(t,e){this.m_shapes=t;this.m_shapeCount=e};goog.inherits(box2d.b2ParticleSystem.CompositeShape,box2d.b2Shape);box2d.b2ParticleSystem.CompositeShape.prototype.m_shapes=null;box2d.b2ParticleSystem.CompositeShape.prototype.m_shapeCount=0;box2d.b2ParticleSystem.CompositeShape.prototype.Clone=function(){box2d.b2Assert(!1);return null};box2d.b2ParticleSystem.CompositeShape.prototype.GetChildCount=function(){return 1};box2d.b2ParticleSystem.CompositeShape.prototype.TestPoint=function(t,e){for(var o=0;o<this.m_shapeCount;o++)if(this.m_shapes[o].TestPoint(t,e))return!0;return!1};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"TestPoint",box2d.b2ParticleSystem.CompositeShape.prototype.TestPoint);box2d.b2ParticleSystem.CompositeShape.prototype.ComputeDistance=function(t,e,o,i){box2d.b2Assert(!1);return 0};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeDistance",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeDistance);box2d.b2ParticleSystem.CompositeShape.prototype.RayCast=function(t,e,o,i){box2d.b2Assert(!1);return!1};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"RayCast",box2d.b2ParticleSystem.CompositeShape.prototype.RayCast);box2d.b2ParticleSystem.CompositeShape.prototype.ComputeAABB=function(t,e,o){var i=new box2d.b2AABB;t.lowerBound.x=+box2d.b2_maxFloat;t.lowerBound.y=+box2d.b2_maxFloat;t.upperBound.x=-box2d.b2_maxFloat;t.upperBound.y=-box2d.b2_maxFloat;box2d.b2Assert(0===o);for(o=0;o<this.m_shapeCount;o++)for(var a=this.m_shapes[o].GetChildCount(),r=0;r<a;r++){var s=i;this.m_shapes[o].ComputeAABB(s,e,r);t.Combine1(s)}};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeAABB",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeAABB);box2d.b2ParticleSystem.CompositeShape.prototype.ComputeMass=function(t,e){box2d.b2Assert(!1)};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeMass",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeMass);box2d.b2ParticleSystem.prototype.CreateParticlesWithShapesForGroup=function(t,e,o,i){t=new box2d.b2ParticleSystem.CompositeShape(t,e);this.CreateParticlesFillShapeForGroup(t,o,i)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesWithShapesForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesWithShapesForGroup);box2d.b2ParticleSystem.prototype.CloneParticle=function(t,e){var o=new box2d.b2ParticleDef;o.flags=this.m_flagsBuffer.data[t];o.position.Copy(this.m_positionBuffer.data[t]);o.velocity.Copy(this.m_velocityBuffer.data[t]);this.m_colorBuffer.data&&o.color.Copy(this.m_colorBuffer.data[t]);this.m_userDataBuffer.data&&(o.userData=this.m_userDataBuffer.data[t]);o.group=e;o=this.CreateParticle(o);if(this.m_handleIndexBuffer.data){var i=this.m_handleIndexBuffer.data[t];i&&i.SetIndex(o);this.m_handleIndexBuffer.data[o]=i;this.m_handleIndexBuffer.data[t]=null}this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[o]=this.m_lastBodyContactStepBuffer.data[t]);this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[o]=this.m_bodyContactCountBuffer.data[t]);this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[o]=this.m_consecutiveContactStepsBuffer.data[t]);this.m_hasForce&&this.m_forceBuffer[o].Copy(this.m_forceBuffer[t]);this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[o]=this.m_staticPressureBuffer[t]);this.m_depthBuffer&&(this.m_depthBuffer[o]=this.m_depthBuffer[t]);this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[o]=this.m_expirationTimeBuffer.data[t]);return o};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CloneParticle",box2d.b2ParticleSystem.prototype.CloneParticle);box2d.b2ParticleSystem.prototype.DestroyParticlesInGroup=function(t,e){for(var o=t.m_firstIndex;o<t.m_lastIndex;o++)this.DestroyParticle(o,e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticlesInGroup",box2d.b2ParticleSystem.prototype.DestroyParticlesInGroup);box2d.b2ParticleSystem.prototype.DestroyParticleGroup=function(t){box2d.b2Assert(0<this.m_groupCount);box2d.b2Assert(null!==t);this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(t);this.SetGroupFlags(t,0);for(var e=t.m_firstIndex;e<t.m_lastIndex;e++)this.m_groupBuffer[e]=null;t.m_prev&&(t.m_prev.m_next=t.m_next);t.m_next&&(t.m_next.m_prev=t.m_prev);t===this.m_groupList&&(this.m_groupList=t.m_next);--this.m_groupCount};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticleGroup",box2d.b2ParticleSystem.prototype.DestroyParticleGroup);box2d.b2ParticleSystem.ParticleCanBeConnected=function(t,e){return 0!==(t&(box2d.b2ParticleFlag.b2_wallParticle|box2d.b2ParticleFlag.b2_springParticle|box2d.b2ParticleFlag.b2_elasticParticle))||null!==e&&0!==(e.GetGroupFlags()&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup)};box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads=function(t,e,u){var y=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dab,m=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dbc,f=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dca,g=this.m_positionBuffer.data;box2d.b2Assert(t<=e);for(var o=0,i=t;i<e;i++)o|=this.m_flagsBuffer.data[i];if(o&box2d.b2ParticleSystem.k_pairFlags)for(i=0;i<this.m_contactBuffer.count;i++){var a=this.m_contactBuffer.data[i],r=a.indexA,s=a.indexB,n=this.m_flagsBuffer.data[r],b=this.m_flagsBuffer.data[s],x=this.m_groupBuffer[r],l=this.m_groupBuffer[s];r>=t&&r<e&&s>=t&&s<e&&!((n|b)&box2d.b2ParticleFlag.b2_zombieParticle)&&(n|b)&box2d.b2ParticleSystem.k_pairFlags&&(u.IsNecessary(r)||u.IsNecessary(s))&&box2d.b2ParticleSystem.ParticleCanBeConnected(n,x)&&box2d.b2ParticleSystem.ParticleCanBeConnected(b,l)&&u.ShouldCreatePair(r,s)&&(n=this.m_pairBuffer.data[this.m_pairBuffer.Append()],n.indexA=r,n.indexB=s,n.flags=a.flags,n.strength=box2d.b2Min(x?x.m_strength:1,l?l.m_strength:1),n.distance=box2d.b2Distance(g[r],g[s]));box2d.std_stable_sort(this.m_pairBuffer.data,0,this.m_pairBuffer.count,box2d.b2ParticleSystem.ComparePairIndices);this.m_pairBuffer.Unique(box2d.b2ParticleSystem.MatchPairIndices)}if(o&box2d.b2ParticleSystem.k_triadFlags){o=new box2d.b2VoronoiDiagram(e-t);a=0;for(i=t;i<e;i++)r=this.m_flagsBuffer.data[i],s=this.m_groupBuffer[i],r&box2d.b2ParticleFlag.b2_zombieParticle||!box2d.b2ParticleSystem.ParticleCanBeConnected(r,s)||(u.IsNecessary(i)&&++a,o.AddGenerator(g[i],i,u.IsNecessary(i)));if(0===a)for(i=t;i<e;i++)u.IsNecessary(i);t=this.GetParticleStride();o.Generate(t/2,2*t);var v=this;o.GetNodes(function(t,e,o){var i=v.m_flagsBuffer.data[t],a=v.m_flagsBuffer.data[e],r=v.m_flagsBuffer.data[o];if((i|a|r)&box2d.b2ParticleSystem.k_triadFlags&&u.ShouldCreateTriad(t,e,o)){var s=g[t],n=g[e],b=g[o],x=box2d.b2Sub_V2_V2(s,n,y),l=box2d.b2Sub_V2_V2(n,b,m),_=box2d.b2Sub_V2_V2(b,s,f),h=box2d.b2_maxTriadDistanceSquared*v.m_squaredDiameter;if(!(box2d.b2Dot_V2_V2(x,x)>h||box2d.b2Dot_V2_V2(l,l)>h||box2d.b2Dot_V2_V2(_,_)>h)){var d=v.m_groupBuffer[t],p=v.m_groupBuffer[e],c=v.m_groupBuffer[o],h=v.m_triadBuffer.data[v.m_triadBuffer.Append()];h.indexA=t;h.indexB=e;h.indexC=o;h.flags=i|a|r;h.strength=box2d.b2Min(box2d.b2Min(d?d.m_strength:1,p?p.m_strength:1),c?c.m_strength:1);t=(s.x+n.x+b.x)/3;e=(s.y+n.y+b.y)/3;h.pa.x=s.x-t;h.pa.y=s.y-e;h.pb.x=n.x-t;h.pb.y=n.y-e;h.pc.x=b.x-t;h.pc.y=b.y-e;h.ka=-box2d.b2Dot_V2_V2(_,x);h.kb=-box2d.b2Dot_V2_V2(x,l);h.kc=-box2d.b2Dot_V2_V2(l,_);h.s=box2d.b2Cross_V2_V2(s,n)+box2d.b2Cross_V2_V2(n,b)+box2d.b2Cross_V2_V2(b,s)}}});box2d.std_stable_sort(this.m_triadBuffer.data,0,this.m_triadBuffer.count,box2d.b2ParticleSystem.CompareTriadIndices);this.m_triadBuffer.Unique(box2d.b2ParticleSystem.MatchTriadIndices)}};box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dab=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dbc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dca=new box2d.b2Vec2;box2d.b2ParticleSystem.ReactiveFilter=function(t){this.m_flagsBuffer=t};goog.inherits(box2d.b2ParticleSystem.ReactiveFilter,box2d.b2ParticleSystem.ConnectionFilter);box2d.b2ParticleSystem.ReactiveFilter.prototype.m_flagsBuffer=null;box2d.b2ParticleSystem.ReactiveFilter.prototype.IsNecessary=function(t){return 0!==(this.m_flagsBuffer[t]&box2d.b2ParticleFlag.b2_reactiveParticle)};box2d.b2ParticleSystem.prototype.UpdatePairsAndTriadsWithReactiveParticles=function(){var t=new box2d.b2ParticleSystem.ReactiveFilter(this.m_flagsBuffer);this.UpdatePairsAndTriads(0,this.m_count,t);for(t=0;t<this.m_count;t++)this.m_flagsBuffer.data[t]&=~box2d.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~box2d.b2ParticleFlag.b2_reactiveParticle};box2d.b2ParticleSystem.ComparePairIndices=function(t,e){var o=t.indexA-e.indexA;return 0!==o?0>o:t.indexB<e.indexB};box2d.b2ParticleSystem.MatchPairIndices=function(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB};box2d.b2ParticleSystem.CompareTriadIndices=function(t,e){var o=t.indexA-e.indexA;if(0!==o)return 0>o;o=t.indexB-e.indexB;return 0!==o?0>o:t.indexC<e.indexC};box2d.b2ParticleSystem.MatchTriadIndices=function(t,e){return t.indexA===e.indexA&&t.indexB===e.indexB&&t.indexC===e.indexC};box2d.b2ParticleSystem.InitializeParticleLists=function(t,e){for(var o=t.GetBufferIndex(),i=t.GetParticleCount(),a=0;a<i;a++){var r=e[a];r.list=r;r.next=null;r.count=1;r.index=a+o}};box2d.b2ParticleSystem.prototype.MergeParticleListsInContact=function(t,e){for(var o=t.GetBufferIndex(),i=0;i<this.m_contactBuffer.count;i++){var a=this.m_contactBuffer.data[i],r=a.indexA,a=a.indexB;if(t.ContainsParticle(r)&&t.ContainsParticle(a)&&(r=e[r-o].list,a=e[a-o].list,r!==a)){if(r.count<a.count)var s=r,r=a,a=s;box2d.b2Assert(r.count>=a.count);box2d.b2ParticleSystem.MergeParticleLists(r,a)}}};box2d.b2ParticleSystem.MergeParticleLists=function(t,e){box2d.b2Assert(t!==e);for(var o=e;;){o.list=t;var i=o.next;if(i)o=i;else{o.next=t.next;break}}t.next=e;t.count+=e.count;e.count=0};box2d.b2ParticleSystem.FindLongestParticleList=function(t,e){for(var o=t.GetParticleCount(),i=e[0],a=0;a<o;a++){var r=e[a];i.count<r.count&&(i=r)}return i};box2d.b2ParticleSystem.prototype.MergeZombieParticleListNodes=function(t,e,o){t=t.GetParticleCount();for(var i=0;i<t;i++){var a=e[i];a!==o&&this.m_flagsBuffer.data[a.index]&box2d.b2ParticleFlag.b2_zombieParticle&&box2d.b2ParticleSystem.MergeParticleListAndNode(o,a)}};box2d.b2ParticleSystem.MergeParticleListAndNode=function(t,e){box2d.b2Assert(e!==t);box2d.b2Assert(e.list===e);box2d.b2Assert(1===e.count);e.list=t;e.next=t.next;t.next=e;t.count++;e.count=0};box2d.b2ParticleSystem.prototype.CreateParticleGroupsFromParticleList=function(t,e,o){var i=t.GetParticleCount(),a=new box2d.b2ParticleGroupDef;a.groupFlags=t.GetGroupFlags();a.userData=t.GetUserData();for(t=0;t<i;t++){var r=e[t];if(r.count&&r!==o){box2d.b2Assert(r.list===r);for(var s=this.CreateParticleGroup(a);r;r=r.next){var n=r.index;box2d.b2Assert(!(this.m_flagsBuffer.data[n]&box2d.b2ParticleFlag.b2_zombieParticle));var b=this.CloneParticle(n,s);this.m_flagsBuffer.data[n]|=box2d.b2ParticleFlag.b2_zombieParticle;r.index=b}}}};box2d.b2ParticleSystem.prototype.UpdatePairsAndTriadsWithParticleList=function(t,e){for(var o=t.GetBufferIndex(),i=0;i<this.m_pairBuffer.count;i++){var a=this.m_pairBuffer.data[i],r=a.indexA,s=a.indexB;t.ContainsParticle(r)&&(a.indexA=e[r-o].index);t.ContainsParticle(s)&&(a.indexB=e[s-o].index)}for(i=0;i<this.m_triadBuffer.count;i++){var a=this.m_triadBuffer.data[i],r=a.indexA,s=a.indexB,n=a.indexC;t.ContainsParticle(r)&&(a.indexA=e[r-o].index);t.ContainsParticle(s)&&(a.indexB=e[s-o].index);t.ContainsParticle(n)&&(a.indexC=e[n-o].index)}};box2d.b2ParticleSystem.prototype.ComputeDepth=function(){for(var t=[],e=0,o=0;o<this.m_contactBuffer.count;o++){var i=this.m_contactBuffer.data[o],a=i.indexA,r=i.indexB,s=this.m_groupBuffer[a],n=this.m_groupBuffer[r];s&&s===n&&s.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(t[e++]=i)}s=[];n=0;for(o=this.m_groupList;o;o=o.GetNext())if(o.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)for(s[n++]=o,this.SetGroupFlags(o,o.m_groupFlags&~box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),r=o.m_firstIndex;r<o.m_lastIndex;r++)this.m_accumulationBuffer[r]=0;for(o=0;o<e;o++){var i=t[o],a=i.indexA,r=i.indexB,b=i.weight;this.m_accumulationBuffer[a]+=b;this.m_accumulationBuffer[r]+=b}box2d.b2Assert(null!==this.m_depthBuffer);for(r=0;r<n;r++)for(o=s[r],r=o.m_firstIndex;r<o.m_lastIndex;r++)b=this.m_accumulationBuffer[r],this.m_depthBuffer[r]=.8>b?0:box2d.b2_maxFloat;for(var b=box2d.b2Sqrt(this.m_count)>>0,x=0;x<b;x++){for(var l=!1,o=0;o<e;o++){var i=t[o],a=i.indexA,r=i.indexB,_=1-i.weight,i=this.m_depthBuffer[a],h=this.m_depthBuffer[r],d=h+_,_=i+_;i>d&&(this.m_depthBuffer[a]=d,l=!0);h>_&&(this.m_depthBuffer[r]=_,l=!0)}if(!l)break}for(r=0;r<n;r++)for(o=s[r],r=o.m_firstIndex;r<o.m_lastIndex;r++)this.m_depthBuffer[r]=this.m_depthBuffer[r]<box2d.b2_maxFloat?this.m_depthBuffer[r]*this.m_particleDiameter:0};box2d.b2ParticleSystem.prototype.GetInsideBoundsEnumerator=function(t){var e=box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*t.lowerBound.x-1,this.m_inverseDiameter*t.lowerBound.y-1);t=box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*t.upperBound.x+1,this.m_inverseDiameter*t.upperBound.y+1);var o=this.m_proxyBuffer.count,i=box2d.std_lower_bound(this.m_proxyBuffer.data,0,o,e,box2d.b2ParticleSystem.Proxy.CompareProxyTag),a=box2d.std_upper_bound(this.m_proxyBuffer.data,0,o,t,box2d.b2ParticleSystem.Proxy.CompareTagProxy);box2d.b2Assert(0<=i);box2d.b2Assert(i<=a);box2d.b2Assert(a<=o);return new box2d.b2ParticleSystem.InsideBoundsEnumerator(this,e,t,i,a)};box2d.b2ParticleSystem.prototype.UpdateAllParticleFlags=function(){for(var t=this.m_allParticleFlags=0;t<this.m_count;t++)this.m_allParticleFlags|=this.m_flagsBuffer.data[t];this.m_needsUpdateAllParticleFlags=!1};box2d.b2ParticleSystem.prototype.UpdateAllGroupFlags=function(){this.m_allGroupFlags=0;for(var t=this.m_groupList;t;t=t.GetNext())this.m_allGroupFlags|=t.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1};box2d.b2ParticleSystem.prototype.AddContact=function(t,e,o){var i=box2d.b2ParticleSystem.prototype.AddContact.s_d,a=this.m_positionBuffer.data;box2d.b2Assert(o===this.m_contactBuffer);o=box2d.b2Sub_V2_V2(a[e],a[t],i);i=box2d.b2Dot_V2_V2(o,o);if(i<this.m_squaredDiameter){a=box2d.b2InvSqrt(i);isFinite(a)||(a=198177537e11);var r=this.m_contactBuffer.data[this.m_contactBuffer.Append()];r.indexA=t;r.indexB=e;r.flags=this.m_flagsBuffer.data[t]|this.m_flagsBuffer.data[e];r.weight=1-i*a*this.m_inverseDiameter;box2d.b2Mul_S_V2(a,o,r.normal)}};box2d.b2ParticleSystem.prototype.AddContact.s_d=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.FindContacts_Reference=function(t){box2d.b2Assert(t===this.m_contactBuffer);t=this.m_proxyBuffer.count;for(var e=this.m_contactBuffer.count=0,o=0;e<t;e++){for(var i=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[e].tag,1,0),a=e+1;a<t&&!(i<this.m_proxyBuffer.data[a].tag);a++)this.AddContact(this.m_proxyBuffer.data[e].index,this.m_proxyBuffer.data[a].index,this.m_contactBuffer);for(a=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[e].tag,-1,1);o<t&&!(a<=this.m_proxyBuffer.data[o].tag);o++);i=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[e].tag,1,1);for(a=o;a<t&&!(i<this.m_proxyBuffer.data[a].tag);a++)this.AddContact(this.m_proxyBuffer.data[e].index,this.m_proxyBuffer.data[a].index,this.m_contactBuffer)}};box2d.b2ParticleSystem.prototype.FindContacts=function(t){this.FindContacts_Reference(t)};box2d.b2ParticleSystem.prototype.UpdateProxies_Reference=function(t){box2d.b2Assert(t===this.m_proxyBuffer);t=this.m_positionBuffer.data;for(var e=this.m_inverseDiameter,o=0;o<this.m_proxyBuffer.count;++o){var i=this.m_proxyBuffer.data[o],a=t[i.index];i.tag=box2d.b2ParticleSystem.computeTag(e*a.x,e*a.y)}};box2d.b2ParticleSystem.prototype.UpdateProxies=function(t){this.UpdateProxies_Reference(t)};box2d.b2ParticleSystem.prototype.SortProxies=function(t){box2d.b2Assert(t===this.m_proxyBuffer);box2d.std_sort(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,box2d.b2ParticleSystem.Proxy.CompareProxyProxy)};box2d.b2ParticleSystem.prototype.FilterContacts=function(t){var e=this.GetParticleContactFilter();if(null!==e){box2d.b2Assert(t===this.m_contactBuffer);var o=this;this.m_contactBuffer.RemoveIf(function(t){return t.flags&box2d.b2ParticleFlag.b2_particleContactFilterParticle&&!e.ShouldCollideParticleParticle(o,t.indexA,t.indexB)})}};box2d.b2ParticleSystem.prototype.NotifyContactListenerPreContact=function(t){if(null!==this.GetParticleContactListener())throw t.Initialize(this.m_contactBuffer,this.m_flagsBuffer),Error()};box2d.b2ParticleSystem.prototype.NotifyContactListenerPostContact=function(t){t=this.GetParticleContactListener();if(null!==t){for(var e=0;e<this.m_contactBuffer.count;++e)t.BeginContactParticleParticle(this,this.m_contactBuffer.data[e]);throw Error()}};box2d.b2ParticleSystem.b2ParticleContactIsZombie=function(t){return(t.flags&box2d.b2ParticleFlag.b2_zombieParticle)===box2d.b2ParticleFlag.b2_zombieParticle};box2d.b2ParticleSystem.prototype.UpdateContacts=function(t){this.UpdateProxies(this.m_proxyBuffer);this.SortProxies(this.m_proxyBuffer);var e=new box2d.b2ParticleSystem.b2ParticlePairSet;this.NotifyContactListenerPreContact(e);this.FindContacts(this.m_contactBuffer);this.FilterContacts(this.m_contactBuffer);this.NotifyContactListenerPostContact(e);t&&this.m_contactBuffer.RemoveIf(box2d.b2ParticleSystem.b2ParticleContactIsZombie)};box2d.b2ParticleSystem.prototype.NotifyBodyContactListenerPreContact=function(t){if(null!==this.GetFixtureContactListener())throw t.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer),Error()};box2d.b2ParticleSystem.prototype.NotifyBodyContactListenerPostContact=function(t){t=this.GetFixtureContactListener();if(null!==t){for(var e=0;e<this.m_bodyContactBuffer.count;e++){var o=this.m_bodyContactBuffer.data[e];box2d.b2Assert(null!==o);t.BeginContactFixtureParticle(this,o)}throw Error()}};box2d.b2ParticleSystem.UpdateBodyContactsCallback=function(t,e){box2d.b2FixtureParticleQueryCallback.call(this,t);this.m_contactFilter=e};goog.inherits(box2d.b2ParticleSystem.UpdateBodyContactsCallback,box2d.b2FixtureParticleQueryCallback);box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ShouldCollideFixtureParticle=function(t,e,o){return this.m_contactFilter&&this.m_system.GetFlagsBuffer()[o]&box2d.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_contactFilter.ShouldCollideFixtureParticle(t,this.m_system,o):!0};goog.exportProperty(box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype,"ShouldCollideFixtureParticle",box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ShouldCollideFixtureParticle);box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle=function(t,e,o){var i=box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_rp,a=this.m_system.m_positionBuffer.data[o],r=box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_n;e=t.ComputeDistance(a,r,e);if(e<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(t,this.m_system,o)){var s=t.GetBody(),n=s.GetWorldCenter(),b=s.GetMass(),x=s.GetInertia()-b*s.GetLocalCenter().LengthSquared(),b=0<b?1/b:0,x=0<x?1/x:0,l=this.m_system.m_flagsBuffer.data[o]&box2d.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),i=box2d.b2Sub_V2_V2(a,n,i),i=box2d.b2Cross_V2_V2(i,r),i=l+b+x*i*i,a=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];a.index=o;a.body=s;a.fixture=t;a.weight=1-e*this.m_system.m_inverseDiameter;a.normal.Copy(r.SelfNeg());a.mass=0<i?1/i:0;this.m_system.DetectStuckParticle(o)}};goog.exportProperty(box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype,"ReportFixtureAndParticle",box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle);box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_n=new box2d.b2Vec2;box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_rp=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.UpdateBodyContacts=function(){var t=box2d.b2ParticleSystem.prototype.UpdateBodyContacts.s_aabb,e=new box2d.b2ParticleSystem.FixtureParticleSet;this.NotifyBodyContactListenerPreContact(e);if(0<this.m_stuckThreshold)for(var o=this.GetParticleCount(),i=0;i<o;i++)this.m_bodyContactCountBuffer.data[i]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[i]+1&&(this.m_consecutiveContactStepsBuffer.data[i]=0);this.m_bodyContactBuffer.SetCount(0);this.m_stuckParticleBuffer.SetCount(0);this.ComputeAABB(t);o=new box2d.b2ParticleSystem.UpdateBodyContactsCallback(this,this.GetFixtureContactFilter());this.m_world.QueryAABB(o,t);this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts();this.NotifyBodyContactListenerPostContact(e)};box2d.b2ParticleSystem.prototype.UpdateBodyContacts.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.Solve=function(t){var e=box2d.b2ParticleSystem.prototype.Solve.s_subStep;if(0!==this.m_count&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(t),this.m_allParticleFlags&box2d.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<t.particleIterations;this.m_iterationIndex++){++this.m_timestamp;var o=e.Copy(t);o.dt/=t.particleIterations;o.inv_dt*=t.particleIterations;this.UpdateContacts(!1);this.UpdateBodyContacts();this.ComputeWeight();this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles();this.m_hasForce&&this.SolveForce(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(o);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing();this.SolveGravity(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_staticPressureParticle&&this.SolveStaticPressure(o);this.SolvePressure(o);this.SolveDamping(o);this.m_allParticleFlags&box2d.b2ParticleSystem.k_extraDampingFlags&&this.SolveExtraDamping();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_springParticle&&this.SolveSpring(o);this.LimitVelocity(o);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_barrierParticle&&this.SolveBarrier(o);this.SolveCollision(o);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(o);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_wallParticle&&this.SolveWall();for(var i=0;i<this.m_count;i++)this.m_positionBuffer.data[i].SelfMulAdd(o.dt,this.m_velocityBuffer.data[i])}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"Solve",box2d.b2ParticleSystem.prototype.Solve);box2d.b2ParticleSystem.prototype.Solve.s_subStep=new box2d.b2TimeStep;box2d.b2ParticleSystem.SolveCollisionCallback=function(t,e){box2d.b2FixtureParticleQueryCallback.call(this,t);this.m_step=e};goog.inherits(box2d.b2ParticleSystem.SolveCollisionCallback,box2d.b2FixtureParticleQueryCallback);box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle=function(t,e,o){var i=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p1,a=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_output,r=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_input,s=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p,n=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_v,b=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_f,x=t.GetBody(),l=this.m_system.m_positionBuffer.data[o],_=this.m_system.m_velocityBuffer.data[o];0===this.m_system.m_iterationIndex?(i=box2d.b2MulT_X_V2(x.m_xf0,l,i),t.GetShape().GetType()===box2d.b2ShapeType.e_circleShape&&(i.SelfSub(x.GetLocalCenter()),box2d.b2Mul_R_V2(x.m_xf0.q,i,i),box2d.b2MulT_R_V2(x.m_xf.q,i,i),i.SelfAdd(x.GetLocalCenter())),box2d.b2Mul_X_V2(x.m_xf,i,r.p1)):r.p1.Copy(l);box2d.b2AddMul_V2_S_V2(l,this.m_step.dt,_,r.p2);r.maxFraction=1;t.RayCast(a,r,e)&&(t=a.normal,s.x=(1-a.fraction)*r.p1.x+a.fraction*r.p2.x+box2d.b2_linearSlop*t.x,s.y=(1-a.fraction)*r.p1.y+a.fraction*r.p2.y+box2d.b2_linearSlop*t.y,n.x=this.m_step.inv_dt*(s.x-l.x),n.y=this.m_step.inv_dt*(s.y-l.y),this.m_system.m_velocityBuffer.data[o].Copy(n),b.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(_.x-n.x),b.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(_.y-n.y),this.m_system.ParticleApplyForce(o,b))};goog.exportProperty(box2d.b2ParticleSystem.SolveCollisionCallback.prototype,"ReportFixtureAndParticle",box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle);box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p1=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_output=new box2d.b2RayCastOutput;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_input=new box2d.b2RayCastInput;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportParticle=function(t,e){return!1};goog.exportProperty(box2d.b2ParticleSystem.SolveCollisionCallback.prototype,"ReportParticle",box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportParticle);box2d.b2ParticleSystem.prototype.SolveCollision=function(t){var e=this.m_positionBuffer.data,o=this.m_velocityBuffer.data,i=box2d.b2ParticleSystem.prototype.SolveCollision.s_aabb;i.lowerBound.x=+box2d.b2_maxFloat;i.lowerBound.y=+box2d.b2_maxFloat;i.upperBound.x=-box2d.b2_maxFloat;i.upperBound.y=-box2d.b2_maxFloat;for(var a=0;a<this.m_count;a++){var r=o[a],s=e[a],n=s.x+t.dt*r.x,r=s.y+t.dt*r.y;i.lowerBound.x=box2d.b2Min(i.lowerBound.x,box2d.b2Min(s.x,n));i.lowerBound.y=box2d.b2Min(i.lowerBound.y,box2d.b2Min(s.y,r));i.upperBound.x=box2d.b2Max(i.upperBound.x,box2d.b2Max(s.x,n));i.upperBound.y=box2d.b2Max(i.upperBound.y,box2d.b2Max(s.y,r))}t=new box2d.b2ParticleSystem.SolveCollisionCallback(this,t);this.m_world.QueryAABB(t,i)};box2d.b2ParticleSystem.prototype.SolveCollision.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.LimitVelocity=function(t){var e=this.m_velocityBuffer.data;t=this.GetCriticalVelocitySquared(t);for(var o=0;o<this.m_count;o++){var i=e[o],a=box2d.b2Dot_V2_V2(i,i);a>t&&i.SelfMul(box2d.b2Sqrt(t/a))}};box2d.b2ParticleSystem.prototype.SolveGravity=function(t){var e=box2d.b2ParticleSystem.prototype.SolveGravity.s_gravity,o=this.m_velocityBuffer.data;t=box2d.b2Mul_S_V2(t.dt*this.m_def.gravityScale,this.m_world.GetGravity(),e);for(e=0;e<this.m_count;e++)o[e].SelfAdd(t)};box2d.b2ParticleSystem.prototype.SolveGravity.s_gravity=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier=function(t){for(var e=box2d.b2ParticleSystem.prototype.SolveBarrier.s_aabb,o=box2d.b2ParticleSystem.prototype.SolveBarrier.s_va,i=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vb,a=box2d.b2ParticleSystem.prototype.SolveBarrier.s_pba,r=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vba,s=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vc,n=box2d.b2ParticleSystem.prototype.SolveBarrier.s_pca,b=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vca,x=box2d.b2ParticleSystem.prototype.SolveBarrier.s_qba,l=box2d.b2ParticleSystem.prototype.SolveBarrier.s_qca,_=box2d.b2ParticleSystem.prototype.SolveBarrier.s_dv,G=box2d.b2ParticleSystem.prototype.SolveBarrier.s_f,h=this.m_positionBuffer.data,d=this.m_velocityBuffer.data,p=0;p<this.m_count;p++)0!==(this.m_flagsBuffer.data[p]&box2d.b2ParticleSystem.k_barrierWallFlags)&&d[p].SetZero();for(var p=box2d.b2_barrierCollisionTime*t.dt,c=this.GetParticleMass(),u=0;u<this.m_pairBuffer.count;u++){var y=this.m_pairBuffer.data[u];if(y.flags&box2d.b2ParticleFlag.b2_barrierParticle){var m=y.indexA,f=y.indexB,y=h[m],g=h[f],v=e;box2d.b2Min_V2_V2(y,g,v.lowerBound);box2d.b2Max_V2_V2(y,g,v.upperBound);for(var S=this.m_groupBuffer[m],C=this.m_groupBuffer[f],m=this.GetLinearVelocity(S,m,y,o),f=this.GetLinearVelocity(C,f,g,i),g=box2d.b2Sub_V2_V2(g,y,a),f=box2d.b2Sub_V2_V2(f,m,r),v=this.GetInsideBoundsEnumerator(v),P;0<=(P=v.GetNext());){var A=h[P],B=this.m_groupBuffer[P];if(S!==B&&C!==B){var w=this.GetLinearVelocity(B,P,A,s),T=box2d.b2Sub_V2_V2(A,y,n),M=box2d.b2Sub_V2_V2(w,m,b),I=box2d.b2Cross_V2_V2(f,M),D=box2d.b2Cross_V2_V2(g,M)-box2d.b2Cross_V2_V2(T,f),L=box2d.b2Cross_V2_V2(g,T),E=x,V=l;if(0===I){if(0===D)continue;L=-L/D;if(!(0<=L&&L<p))continue;box2d.b2AddMul_V2_S_V2(g,L,f,E);box2d.b2AddMul_V2_S_V2(T,L,M,V);D=box2d.b2Dot_V2_V2(E,V)/box2d.b2Dot_V2_V2(E,E);if(!(0<=D&&1>=D))continue}else{L=D*D-4*L*I;if(0>L)continue;var R=box2d.b2Sqrt(L),L=(-D-R)/(2*I),I=(-D+R)/(2*I);L>I&&(D=L,L=I,I=D);box2d.b2AddMul_V2_S_V2(g,L,f,E);box2d.b2AddMul_V2_S_V2(T,L,M,V);D=box2d.b2Dot_V2_V2(E,V)/box2d.b2Dot_V2_V2(E,E);if(!(0<=L&&L<p&&0<=D&&1>=D)){L=I;if(!(0<=L&&L<p))continue;box2d.b2AddMul_V2_S_V2(g,L,f,E);box2d.b2AddMul_V2_S_V2(T,L,M,V);D=box2d.b2Dot_V2_V2(E,V)/box2d.b2Dot_V2_V2(E,E);if(!(0<=D&&1>=D))continue}}T=_;T.x=m.x+D*f.x-w.x;T.y=m.y+D*f.y-w.y;w=box2d.b2Mul_S_V2(c,T,G);this.IsRigidGroup(B)?(c=B.GetMass(),T=B.GetInertia(),0<c&&B.m_linearVelocity.SelfMulAdd(1/c,w),0<T&&(B.m_angularVelocity+=box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(A,B.GetCenter(),box2d.b2Vec2.s_t0),w)/T)):d[P].SelfAdd(T);this.ParticleApplyForce(P,w.SelfMul(-t.inv_dt))}}}}};box2d.b2ParticleSystem.prototype.SolveBarrier.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.SolveBarrier.s_va=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vb=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_pba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_pca=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vca=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_qba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_qca=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_dv=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveStaticPressure=function(t){this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);var e=this.GetCriticalPressure(t);t=this.m_def.staticPressureStrength*e;for(var e=box2d.b2_maxParticlePressure*e,o=this.m_def.staticPressureRelaxation,i=0;i<this.m_def.staticPressureIterations;i++){for(var a=0;a<this.m_count;a++)this.m_accumulationBuffer[a]=0;for(a=0;a<this.m_contactBuffer.count;a++){var r=this.m_contactBuffer.data[a];if(r.flags&box2d.b2ParticleFlag.b2_staticPressureParticle){var s=r.indexA,n=r.indexB,r=r.weight;this.m_accumulationBuffer[s]+=r*this.m_staticPressureBuffer[n];this.m_accumulationBuffer[n]+=r*this.m_staticPressureBuffer[s]}}for(a=0;a<this.m_count;a++)r=this.m_weightBuffer[a],this.m_staticPressureBuffer[a]=this.m_flagsBuffer.data[a]&box2d.b2ParticleFlag.b2_staticPressureParticle?box2d.b2Clamp((this.m_accumulationBuffer[a]+t*(r-box2d.b2_minParticleWeight))/(r+o),0,e):0}};box2d.b2ParticleSystem.prototype.ComputeWeight=function(){for(var t=0;t<this.m_count;t++)this.m_weightBuffer[t]=0;for(t=0;t<this.m_bodyContactBuffer.count;t++){var e=this.m_bodyContactBuffer.data[t],o=e.index,e=e.weight;this.m_weightBuffer[o]+=e}for(t=0;t<this.m_contactBuffer.count;t++){var e=this.m_contactBuffer.data[t],o=e.indexA,i=e.indexB,e=e.weight;this.m_weightBuffer[o]+=e;this.m_weightBuffer[i]+=e}};box2d.b2ParticleSystem.prototype.SolvePressure=function(t){for(var e=box2d.b2ParticleSystem.prototype.SolvePressure.s_f,o=this.m_positionBuffer.data,i=this.m_velocityBuffer.data,a=this.GetCriticalPressure(t),r=this.m_def.pressureStrength*a,s=box2d.b2_maxParticlePressure*a,n=0;n<this.m_count;n++){var a=this.m_weightBuffer[n],b=r*box2d.b2Max(0,a-box2d.b2_minParticleWeight);this.m_accumulationBuffer[n]=box2d.b2Min(b,s)}if(this.m_allParticleFlags&box2d.b2ParticleSystem.k_noPressureFlags)for(n=0;n<this.m_count;n++)this.m_flagsBuffer.data[n]&box2d.b2ParticleSystem.k_noPressureFlags&&(this.m_accumulationBuffer[n]=0);if(this.m_allParticleFlags&box2d.b2ParticleFlag.b2_staticPressureParticle)for(box2d.b2Assert(null!==this.m_staticPressureBuffer),n=0;n<this.m_count;n++)this.m_flagsBuffer.data[n]&box2d.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[n]+=this.m_staticPressureBuffer[n]);t=t.dt/(this.m_def.density*this.m_particleDiameter);s=this.GetParticleInvMass();for(n=0;n<this.m_bodyContactBuffer.count;n++){var b=this.m_bodyContactBuffer.data[n],x=b.index,l=b.body,a=b.weight,_=b.mass,h=b.normal,d=o[x],b=this.m_accumulationBuffer[x]+r*a,a=box2d.b2Mul_S_V2(t*a*_*b,h,e);i[x].SelfMulSub(s,a);l.ApplyLinearImpulse(a,d,!0)}for(n=0;n<this.m_contactBuffer.count;n++)b=this.m_contactBuffer.data[n],x=b.indexA,l=b.indexB,a=b.weight,h=b.normal,b=this.m_accumulationBuffer[x]+this.m_accumulationBuffer[l],a=box2d.b2Mul_S_V2(t*a*b,h,e),i[x].SelfSub(a),i[l].SelfAdd(a)};box2d.b2ParticleSystem.prototype.SolvePressure.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveDamping=function(t){var e=box2d.b2ParticleSystem.prototype.SolveDamping.s_v,o=box2d.b2ParticleSystem.prototype.SolveDamping.s_f,i=this.m_positionBuffer.data,a=this.m_velocityBuffer.data,r=this.m_def.dampingStrength;t=1/this.GetCriticalVelocity(t);for(var s=this.GetParticleInvMass(),n=0;n<this.m_bodyContactBuffer.count;n++){var b=this.m_bodyContactBuffer.data[n],x=b.index,l=b.body,_=b.weight,h=b.mass,d=b.normal,b=i[x],p=box2d.b2Sub_V2_V2(l.GetLinearVelocityFromWorldPoint(b,box2d.b2Vec2.s_t0),a[x],e),p=box2d.b2Dot_V2_V2(p,d);0>p&&(_=box2d.b2Max(r*_,box2d.b2Min(-t*p,.5)),h=box2d.b2Mul_S_V2(_*h*p,d,o),a[x].SelfMulAdd(s,h),l.ApplyLinearImpulse(h.SelfNeg(),b,!0))}for(n=0;n<this.m_contactBuffer.count;n++)b=this.m_contactBuffer.data[n],x=b.indexA,l=b.indexB,_=b.weight,d=b.normal,p=box2d.b2Sub_V2_V2(a[l],a[x],e),p=box2d.b2Dot_V2_V2(p,d),0>p&&(_=box2d.b2Max(r*_,box2d.b2Min(-t*p,.5)),h=box2d.b2Mul_S_V2(_*p,d,o),a[x].SelfAdd(h),a[l].SelfSub(h))};box2d.b2ParticleSystem.prototype.SolveDamping.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveDamping.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping=function(){for(var t=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t0,e=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t1,o=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_p,i=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_v,a=[0],r=[0],s=[0],n=[0],b=[0],x=[0],l=this.m_positionBuffer.data,_=this.m_def.dampingStrength,h=0;h<this.m_bodyContactBuffer.count;h++){var d=this.m_bodyContactBuffer.data[h],p=d.index,c=this.m_groupBuffer[p];if(this.IsRigidGroup(c)){var u=d.body,y=d.normal,m=d.weight,d=l[p],f=box2d.b2Sub_V2_V2(u.GetLinearVelocityFromWorldPoint(d,t),c.GetLinearVelocityFromWorldPoint(d,e),i),f=box2d.b2Dot_V2_V2(f,y);0>f&&(this.InitDampingParameterWithRigidGroupOrParticle(a,r,s,!0,c,p,d,y),this.InitDampingParameter(n,b,x,u.GetMass(),u.GetInertia()-u.GetMass()*u.GetLocalCenter().LengthSquared(),u.GetWorldCenter(),d,y),m=_*box2d.b2Min(m,1)*this.ComputeDampingImpulse(a[0],r[0],s[0],n[0],b[0],x[0],f),this.ApplyDamping(a[0],r[0],s[0],!0,c,p,m,y),u.ApplyLinearImpulse(box2d.b2Mul_S_V2(-m,y,box2d.b2Vec2.s_t0),d,!0))}}for(h=0;h<this.m_contactBuffer.count;h++){var d=this.m_contactBuffer.data[h],p=d.indexA,u=d.indexB,y=d.normal,m=d.weight,c=this.m_groupBuffer[p],g=this.m_groupBuffer[u],v=this.IsRigidGroup(c),S=this.IsRigidGroup(g);c!==g&&(v||S)&&(d=box2d.b2Mid_V2_V2(l[p],l[u],o),f=box2d.b2Sub_V2_V2(this.GetLinearVelocity(g,u,d,t),this.GetLinearVelocity(c,p,d,e),i),f=box2d.b2Dot_V2_V2(f,y),0>f&&(this.InitDampingParameterWithRigidGroupOrParticle(a,r,s,v,c,p,d,y),this.InitDampingParameterWithRigidGroupOrParticle(n,b,x,S,g,u,d,y),m=_*m*this.ComputeDampingImpulse(a[0],r[0],s[0],n[0],b[0],x[0],f),this.ApplyDamping(a[0],r[0],s[0],v,c,p,m,y),this.ApplyDamping(n[0],b[0],x[0],S,g,u,-m,y)))}};box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t0=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t1=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveExtraDamping=function(){for(var t=box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_v,e=box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_f,o=this.m_velocityBuffer.data,i=this.m_positionBuffer.data,a=this.GetParticleInvMass(),r=0;r<this.m_bodyContactBuffer.count;r++){var s=this.m_bodyContactBuffer.data[r],n=s.index;if(this.m_flagsBuffer.data[n]&box2d.b2ParticleSystem.k_extraDampingFlags){var b=s.body,x=s.mass,l=s.normal,s=i[n],_=box2d.b2Sub_V2_V2(b.GetLinearVelocityFromWorldPoint(s,box2d.b2Vec2.s_t0),o[n],t),_=box2d.b2Dot_V2_V2(_,l);0>_&&(x=box2d.b2Mul_S_V2(.5*x*_,l,e),o[n].SelfMulAdd(a,x),b.ApplyLinearImpulse(x.SelfNeg(),s,!0))}}};box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveWall=function(){for(var t=this.m_velocityBuffer.data,e=0;e<this.m_count;e++)this.m_flagsBuffer.data[e]&box2d.b2ParticleFlag.b2_wallParticle&&t[e].SetZero()};box2d.b2ParticleSystem.prototype.SolveRigid=function(t){for(var e=box2d.b2ParticleSystem.prototype.SolveRigid.s_position,o=box2d.b2ParticleSystem.prototype.SolveRigid.s_rotation,i=box2d.b2ParticleSystem.prototype.SolveRigid.s_transform,a=box2d.b2ParticleSystem.prototype.SolveRigid.s_velocityTransform,r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,n=this.m_groupList;n;n=n.GetNext())if(n.m_groupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup){n.UpdateStatistics();var b=o;b.SetAngle(t.dt*n.m_angularVelocity);var x=box2d.b2Add_V2_V2(n.m_center,box2d.b2Sub_V2_V2(box2d.b2Mul_S_V2(t.dt,n.m_linearVelocity,box2d.b2Vec2.s_t0),box2d.b2Mul_R_V2(b,n.m_center,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),e),l=i;l.SetPositionRotation(x,b);box2d.b2Mul_X_X(l,n.m_transform,n.m_transform);b=a;b.p.x=t.inv_dt*l.p.x;b.p.y=t.inv_dt*l.p.y;b.q.s=t.inv_dt*l.q.s;b.q.c=t.inv_dt*(l.q.c-1);for(l=n.m_firstIndex;l<n.m_lastIndex;l++)box2d.b2Mul_X_V2(b,r[l],s[l])}};box2d.b2ParticleSystem.prototype.SolveRigid.s_position=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigid.s_rotation=new box2d.b2Rot;box2d.b2ParticleSystem.prototype.SolveRigid.s_transform=new box2d.b2Transform;box2d.b2ParticleSystem.prototype.SolveRigid.s_velocityTransform=new box2d.b2Transform;box2d.b2ParticleSystem.prototype.SolveElastic=function(t){for(var e=box2d.b2ParticleSystem.prototype.SolveElastic.s_pa,o=box2d.b2ParticleSystem.prototype.SolveElastic.s_pb,i=box2d.b2ParticleSystem.prototype.SolveElastic.s_pc,a=box2d.b2ParticleSystem.prototype.SolveElastic.s_r,r=box2d.b2ParticleSystem.prototype.SolveElastic.s_t0,s=this.m_positionBuffer.data,n=this.m_velocityBuffer.data,b=t.inv_dt*this.m_def.elasticStrength,x=0;x<this.m_triadBuffer.count;x++){var l=this.m_triadBuffer.data[x];if(l.flags&box2d.b2ParticleFlag.b2_elasticParticle){var _=l.indexA,h=l.indexB,d=l.indexC,p=l.pa,c=l.pb,u=l.pc,y=e.Copy(s[_]),m=o.Copy(s[h]),f=i.Copy(s[d]),_=n[_],h=n[h],d=n[d];y.SelfMulAdd(t.dt,_);m.SelfMulAdd(t.dt,h);f.SelfMulAdd(t.dt,d);var g=(y.x+m.x+f.x)/3,v=(y.y+m.y+f.y)/3;y.x-=g;y.y-=v;m.x-=g;m.y-=v;f.x-=g;f.y-=v;g=a;g.s=box2d.b2Cross_V2_V2(p,y)+box2d.b2Cross_V2_V2(c,m)+box2d.b2Cross_V2_V2(u,f);g.c=box2d.b2Dot_V2_V2(p,y)+box2d.b2Dot_V2_V2(c,m)+box2d.b2Dot_V2_V2(u,f);v=box2d.b2InvSqrt(g.s*g.s+g.c*g.c);isFinite(v)||(v=198177537e11);g.s*=v;g.c*=v;g.angle=Math.atan2(g.s,g.c);l=b*l.strength;box2d.b2Mul_R_V2(g,p,r);box2d.b2Sub_V2_V2(r,y,r);box2d.b2Mul_S_V2(l,r,r);_.SelfAdd(r);box2d.b2Mul_R_V2(g,c,r);box2d.b2Sub_V2_V2(r,m,r);box2d.b2Mul_S_V2(l,r,r);h.SelfAdd(r);box2d.b2Mul_R_V2(g,u,r);box2d.b2Sub_V2_V2(r,f,r);box2d.b2Mul_S_V2(l,r,r);d.SelfAdd(r)}}};box2d.b2ParticleSystem.prototype.SolveElastic.s_pa=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveElastic.s_pb=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveElastic.s_pc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveElastic.s_r=new box2d.b2Rot;box2d.b2ParticleSystem.prototype.SolveElastic.s_t0=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring=function(t){for(var e=box2d.b2ParticleSystem.prototype.SolveSpring.s_pa,o=box2d.b2ParticleSystem.prototype.SolveSpring.s_pb,i=box2d.b2ParticleSystem.prototype.SolveSpring.s_d,a=box2d.b2ParticleSystem.prototype.SolveSpring.s_f,r=this.m_positionBuffer.data,s=this.m_velocityBuffer.data,n=t.inv_dt*this.m_def.springStrength,b=0;b<this.m_pairBuffer.count;b++){var x=this.m_pairBuffer.data[b];if(x.flags&box2d.b2ParticleFlag.b2_springParticle){var l=x.indexA,_=x.indexB,h=e.Copy(r[l]),d=o.Copy(r[_]),l=s[l],_=s[_];h.SelfMulAdd(t.dt,l);d.SelfMulAdd(t.dt,_);var h=box2d.b2Sub_V2_V2(d,h,i),d=x.distance,p=h.Length(),x=box2d.b2Mul_S_V2(n*x.strength*(d-p)/p,h,a);l.SelfSub(x);_.SelfAdd(x)}}};box2d.b2ParticleSystem.prototype.SolveSpring.s_pa=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_pb=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_d=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveTensile=function(t){var e=box2d.b2ParticleSystem.prototype.SolveTensile.s_weightedNormal,o=box2d.b2ParticleSystem.prototype.SolveTensile.s_s,i=box2d.b2ParticleSystem.prototype.SolveTensile.s_f,a=this.m_velocityBuffer.data;box2d.b2Assert(null!==this.m_accumulation2Buffer);for(var r=0;r<this.m_count;r++)this.m_accumulation2Buffer[r]=box2d.b2Vec2_zero.Clone(),this.m_accumulation2Buffer[r].SetZero();for(r=0;r<this.m_contactBuffer.count;r++){var s=this.m_contactBuffer.data[r];if(s.flags&box2d.b2ParticleFlag.b2_tensileParticle){var n=s.indexA,b=s.indexB,x=s.weight,s=s.normal,x=box2d.b2Mul_S_V2((1-x)*x,s,e);this.m_accumulation2Buffer[n].SelfSub(x);this.m_accumulation2Buffer[b].SelfAdd(x)}}r=this.GetCriticalVelocity(t);t=this.m_def.surfaceTensionPressureStrength*r;for(var e=this.m_def.surfaceTensionNormalStrength*r,l=box2d.b2_maxParticleForce*r,r=0;r<this.m_contactBuffer.count;r++)if(s=this.m_contactBuffer.data[r],s.flags&box2d.b2ParticleFlag.b2_tensileParticle){var n=s.indexA,b=s.indexB,x=s.weight,s=s.normal,_=this.m_weightBuffer[n]+this.m_weightBuffer[b],h=box2d.b2Sub_V2_V2(this.m_accumulation2Buffer[b],this.m_accumulation2Buffer[n],o),x=box2d.b2Min(t*(_-2)+e*box2d.b2Dot_V2_V2(h,s),l)*x,x=box2d.b2Mul_S_V2(x,s,i);a[n].SelfSub(x);a[b].SelfAdd(x)}};box2d.b2ParticleSystem.prototype.SolveTensile.s_weightedNormal=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveTensile.s_s=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveTensile.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveViscous=function(){for(var t=box2d.b2ParticleSystem.prototype.SolveViscous.s_v,e=box2d.b2ParticleSystem.prototype.SolveViscous.s_f,o=this.m_positionBuffer.data,i=this.m_velocityBuffer.data,a=this.m_def.viscousStrength,r=this.GetParticleInvMass(),s=0;s<this.m_bodyContactBuffer.count;s++){var n=this.m_bodyContactBuffer.data[s],b=n.index;if(this.m_flagsBuffer.data[b]&box2d.b2ParticleFlag.b2_viscousParticle){var x=n.body,l=n.weight,_=n.mass,n=o[b],h=box2d.b2Sub_V2_V2(x.GetLinearVelocityFromWorldPoint(n,box2d.b2Vec2.s_t0),i[b],t),l=box2d.b2Mul_S_V2(a*_*l,h,e);i[b].SelfMulAdd(r,l);x.ApplyLinearImpulse(l.SelfNeg(),n,!0)}}for(s=0;s<this.m_contactBuffer.count;s++)n=this.m_contactBuffer.data[s],n.flags&box2d.b2ParticleFlag.b2_viscousParticle&&(b=n.indexA,x=n.indexB,l=n.weight,h=box2d.b2Sub_V2_V2(i[x],i[b],t),l=box2d.b2Mul_S_V2(a*l,h,e),i[b].SelfAdd(l),i[x].SelfSub(l))};box2d.b2ParticleSystem.prototype.SolveViscous.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveViscous.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRepulsive=function(t){var e=box2d.b2ParticleSystem.prototype.SolveRepulsive.s_f,o=this.m_velocityBuffer.data;t=this.m_def.repulsiveStrength*this.GetCriticalVelocity(t);for(var i=0;i<this.m_contactBuffer.count;i++){var a=this.m_contactBuffer.data[i];if(a.flags&box2d.b2ParticleFlag.b2_repulsiveParticle){var r=a.indexA,s=a.indexB;this.m_groupBuffer[r]!==this.m_groupBuffer[s]&&(a=box2d.b2Mul_S_V2(t*a.weight,a.normal,e),o[r].SelfSub(a),o[s].SelfAdd(a))}}};box2d.b2ParticleSystem.prototype.SolveRepulsive.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolvePowder=function(t){var e=box2d.b2ParticleSystem.prototype.SolvePowder.s_f,o=this.m_positionBuffer.data,i=this.m_velocityBuffer.data;t=this.m_def.powderStrength*this.GetCriticalVelocity(t);for(var a=1-box2d.b2_particleStride,r=this.GetParticleInvMass(),s=0;s<this.m_bodyContactBuffer.count;s++){var n=this.m_bodyContactBuffer.data[s],b=n.index;if(this.m_flagsBuffer.data[b]&box2d.b2ParticleFlag.b2_powderParticle){var x=n.weight;if(x>a){var l=n.body,_=o[b],h=n.normal,n=box2d.b2Mul_S_V2(t*n.mass*(x-a),h,e);i[b].SelfMulSub(r,n);l.ApplyLinearImpulse(n,_,!0)}}}for(s=0;s<this.m_contactBuffer.count;s++)n=this.m_contactBuffer.data[s],n.flags&box2d.b2ParticleFlag.b2_powderParticle&&(x=n.weight,x>a&&(b=n.indexA,l=n.indexB,h=n.normal,n=box2d.b2Mul_S_V2(t*(x-a),h,e),i[b].SelfSub(n),i[l].SelfAdd(n)))};box2d.b2ParticleSystem.prototype.SolvePowder.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSolid=function(t){var e=box2d.b2ParticleSystem.prototype.SolveSolid.s_f,o=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);t=t.inv_dt*this.m_def.ejectionStrength;for(var i=0;i<this.m_contactBuffer.count;i++){var a=this.m_contactBuffer.data[i],r=a.indexA,s=a.indexB;this.m_groupBuffer[r]!==this.m_groupBuffer[s]&&(a=box2d.b2Mul_S_V2(t*(this.m_depthBuffer[r]+this.m_depthBuffer[s])*a.weight,a.normal,e),o[r].SelfSub(a),o[s].SelfAdd(a))}};box2d.b2ParticleSystem.prototype.SolveSolid.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveForce=function(t){var e=this.m_velocityBuffer.data;t=t.dt*this.GetParticleInvMass();for(var o=0;o<this.m_count;o++)e[o].SelfMulAdd(t,this.m_forceBuffer[o]);this.m_hasForce=!1};box2d.b2ParticleSystem.prototype.SolveColorMixing=function(){box2d.b2Assert(null!==this.m_colorBuffer.data);var t=Math.floor(128*this.m_def.colorMixingStrength);if(t)for(var e=0;e<this.m_contactBuffer.count;e++){var o=this.m_contactBuffer.data[e],i=o.indexA,o=o.indexB;this.m_flagsBuffer.data[i]&this.m_flagsBuffer.data[o]&box2d.b2ParticleFlag.b2_colorMixingParticle&&box2d.b2ParticleColor.MixColors(this.m_colorBuffer.data[i],this.m_colorBuffer.data[o],t)}};box2d.b2ParticleSystem.prototype.SolveZombie=function(){for(var t=0,e=[],o=0;o<this.m_count;o++)e[o]=box2d.b2_invalidParticleIndex;box2d.b2Assert(e.length===this.m_count);for(var i=0,o=0;o<this.m_count;o++){var a=this.m_flagsBuffer.data[o];if(a&box2d.b2ParticleFlag.b2_zombieParticle){var r=this.m_world.m_destructionListener;a&box2d.b2ParticleFlag.b2_destructionListenerParticle&&r&&r.SayGoodbyeParticle(this,o);this.m_handleIndexBuffer.data&&(r=this.m_handleIndexBuffer.data[o])&&(r.SetIndex(box2d.b2_invalidParticleIndex),this.m_handleIndexBuffer.data[o]=null);e[o]=box2d.b2_invalidParticleIndex}else e[o]=t,o!==t&&(this.m_handleIndexBuffer.data&&((r=this.m_handleIndexBuffer.data[o])&&r.SetIndex(t),this.m_handleIndexBuffer.data[t]=r),this.m_flagsBuffer.data[t]=this.m_flagsBuffer.data[o],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[t]=this.m_lastBodyContactStepBuffer.data[o]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[t]=this.m_bodyContactCountBuffer.data[o]),this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[t]=this.m_consecutiveContactStepsBuffer.data[o]),this.m_positionBuffer.data[t].Copy(this.m_positionBuffer.data[o]),this.m_velocityBuffer.data[t].Copy(this.m_velocityBuffer.data[o]),this.m_groupBuffer[t]=this.m_groupBuffer[o],this.m_hasForce&&this.m_forceBuffer[t].Copy(this.m_forceBuffer[o]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[t]=this.m_staticPressureBuffer[o]),this.m_depthBuffer&&(this.m_depthBuffer[t]=this.m_depthBuffer[o]),this.m_colorBuffer.data&&this.m_colorBuffer.data[t].Copy(this.m_colorBuffer.data[o]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[t]=this.m_userDataBuffer.data[o]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[t]=this.m_expirationTimeBuffer.data[o])),t++,i|=a}for(o=0;o<this.m_proxyBuffer.count;o++)a=this.m_proxyBuffer.data[o],a.index=e[a.index];this.m_proxyBuffer.RemoveIf(function(t){return 0>t.index});for(o=0;o<this.m_contactBuffer.count;o++)a=this.m_contactBuffer.data[o],a.indexA=e[a.indexA],a.indexB=e[a.indexB];this.m_contactBuffer.RemoveIf(function(t){return 0>t.indexA||0>t.indexB});for(o=0;o<this.m_bodyContactBuffer.count;o++)a=this.m_bodyContactBuffer.data[o],a.index=e[a.index];this.m_bodyContactBuffer.RemoveIf(function(t){return 0>t.index});for(o=0;o<this.m_pairBuffer.count;o++)a=this.m_pairBuffer.data[o],a.indexA=e[a.indexA],a.indexB=e[a.indexB];this.m_pairBuffer.RemoveIf(function(t){return 0>t.indexA||0>t.indexB});for(o=0;o<this.m_triadBuffer.count;o++)a=this.m_triadBuffer.data[o],a.indexA=e[a.indexA],a.indexB=e[a.indexB],a.indexC=e[a.indexC];this.m_triadBuffer.RemoveIf(function(t){return 0>t.indexA||0>t.indexB||0>t.indexC});if(this.m_indexByExpirationTimeBuffer.data)for(a=o=0;a<this.m_count;a++)r=e[this.m_indexByExpirationTimeBuffer.data[a]],r!==box2d.b2_invalidParticleIndex&&(this.m_indexByExpirationTimeBuffer.data[o++]=r);for(a=this.m_groupList;a;a=a.GetNext()){for(var r=t,s=0,n=!1,o=a.m_firstIndex;o<a.m_lastIndex;o++){var b=e[o];0<=b?(r=box2d.b2Min(r,b),s=box2d.b2Max(s,b+1)):n=!0}r<s?(a.m_firstIndex=r,a.m_lastIndex=s,n&&a.m_groupFlags&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(a,a.m_groupFlags|box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(a.m_firstIndex=0,a.m_lastIndex=0,a.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(a,a.m_groupFlags|box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}this.m_count=t;this.m_allParticleFlags=i;this.m_needsUpdateAllParticleFlags=!1;for(a=this.m_groupList;a;)t=a.GetNext(),a.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(a),a=t};box2d.b2ParticleSystem.prototype.SolveLifetimes=function(t){box2d.b2Assert(null!==this.m_expirationTimeBuffer.data);box2d.b2Assert(null!==this.m_indexByExpirationTimeBuffer.data);this.m_timeElapsed=this.LifetimeToExpirationTime(t.dt);t=this.GetQuantizedTimeElapsed();var r=this.m_expirationTimeBuffer.data,e=this.m_indexByExpirationTimeBuffer.data,o=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(box2d.std_sort(e,0,o,function(t,e){var o=r[t],i=r[e],a=0>=o;return a===0>=i?o>i:a}),this.m_expirationTimeBufferRequiresSorting=!1);for(--o;0<=o;--o){var i=e[o],a=r[i];if(t<a||0>=a)break;this.DestroyParticle(i)}};box2d.b2ParticleSystem.prototype.RotateBuffer=function(e,o,i){function t(t){return t<e?t:t<o?t+i-o:t<i?t+e-o:t}if(e!==o&&o!==i){box2d.b2Assert(o>=e&&o<=i);box2d.std_rotate(this.m_flagsBuffer.data,e,o,i);this.m_lastBodyContactStepBuffer.data&&box2d.std_rotate(this.m_lastBodyContactStepBuffer.data,e,o,i);this.m_bodyContactCountBuffer.data&&box2d.std_rotate(this.m_bodyContactCountBuffer.data,e,o,i);this.m_consecutiveContactStepsBuffer.data&&box2d.std_rotate(this.m_consecutiveContactStepsBuffer.data,e,o,i);box2d.std_rotate(this.m_positionBuffer.data,e,o,i);box2d.std_rotate(this.m_velocityBuffer.data,e,o,i);box2d.std_rotate(this.m_groupBuffer,e,o,i);this.m_hasForce&&box2d.std_rotate(this.m_forceBuffer,e,o,i);this.m_staticPressureBuffer&&box2d.std_rotate(this.m_staticPressureBuffer,e,o,i);this.m_depthBuffer&&box2d.std_rotate(this.m_depthBuffer,e,o,i);this.m_colorBuffer.data&&box2d.std_rotate(this.m_colorBuffer.data,e,o,i);this.m_userDataBuffer.data&&box2d.std_rotate(this.m_userDataBuffer.data,e,o,i);if(this.m_handleIndexBuffer.data){box2d.std_rotate(this.m_handleIndexBuffer.data,e,o,i);for(var a=e;a<i;++a){var r=this.m_handleIndexBuffer.data[a];r&&r.SetIndex(t(r.GetIndex()))}}if(this.m_expirationTimeBuffer.data){box2d.std_rotate(this.m_expirationTimeBuffer.data,e,o,i);for(var r=this.GetParticleCount(),s=this.m_indexByExpirationTimeBuffer.data,a=0;a<r;++a)s[a]=t(s[a])}for(a=0;a<this.m_proxyBuffer.count;a++)r=this.m_proxyBuffer.data[a],r.index=t(r.index);for(a=0;a<this.m_contactBuffer.count;a++)r=this.m_contactBuffer.data[a],r.indexA=t(r.indexA),r.indexB=t(r.indexB);for(a=0;a<this.m_bodyContactBuffer.count;a++)r=this.m_bodyContactBuffer.data[a],r.index=t(r.index);for(a=0;a<this.m_pairBuffer.count;a++)r=this.m_pairBuffer.data[a],r.indexA=t(r.indexA),r.indexB=t(r.indexB);for(a=0;a<this.m_triadBuffer.count;a++)r=this.m_triadBuffer.data[a],r.indexA=t(r.indexA),r.indexB=t(r.indexB),r.indexC=t(r.indexC);for(a=this.m_groupList;a;a=a.GetNext())a.m_firstIndex=t(a.m_firstIndex),a.m_lastIndex=t(a.m_lastIndex-1)+1}};box2d.b2ParticleSystem.prototype.GetCriticalVelocity=function(t){return this.m_particleDiameter*t.inv_dt};box2d.b2ParticleSystem.prototype.GetCriticalVelocitySquared=function(t){t=this.GetCriticalVelocity(t);return t*t};box2d.b2ParticleSystem.prototype.GetCriticalPressure=function(t){return this.m_def.density*this.GetCriticalVelocitySquared(t)};box2d.b2ParticleSystem.prototype.GetParticleStride=function(){return box2d.b2_particleStride*this.m_particleDiameter};box2d.b2ParticleSystem.prototype.GetParticleMass=function(){var t=this.GetParticleStride();return this.m_def.density*t*t};box2d.b2ParticleSystem.prototype.GetParticleInvMass=function(){var t=1/box2d.b2_particleStride*this.m_inverseDiameter;return this.m_inverseDensity*t*t};box2d.b2ParticleSystem.prototype.GetFixtureContactFilter=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null};box2d.b2ParticleSystem.prototype.GetParticleContactFilter=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null};box2d.b2ParticleSystem.prototype.GetFixtureContactListener=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null};box2d.b2ParticleSystem.prototype.GetParticleContactListener=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null};box2d.b2ParticleSystem.prototype.SetUserOverridableBuffer=function(t,e,o){box2d.b2Assert(null!==e&&0<o||null===e&&0===o);t.data=e;t.userSuppliedCapacity=o};box2d.b2ParticleSystem.prototype.SetGroupFlags=function(t,e){var o=t.m_groupFlags;(o^e)&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&(e|=box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);o&~e&&(this.m_needsUpdateAllGroupFlags=!0);~this.m_allGroupFlags&e&&(e&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=e);t.m_groupFlags=e};box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts=function(){box2d.std_sort(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,box2d.b2ParticleSystem.BodyContactCompare);var a=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_n,r=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_pos,s=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_normal,n=this,b=-1,x=0,l=0;this.m_bodyContactBuffer.count=box2d.std_remove_if(this.m_bodyContactBuffer.data,function(t){t.index!==b&&(x=0,b=t.index);if(3<x++)return++l,!0;var e=a.Copy(t.normal);e.SelfMul(n.m_particleDiameter*(1-t.weight));e=box2d.b2Add_V2_V2(n.m_positionBuffer.data[t.index],e,r);if(!t.fixture.TestPoint(e)){for(var o=t.fixture.GetShape().GetChildCount(),i=0;i<o;i++)if(t.fixture.ComputeDistance(e,s,i)<box2d.b2_linearSlop)return!1;++l;return!0}return!1},this.m_bodyContactBuffer.count)};box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_n=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_pos=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_normal=new box2d.b2Vec2;box2d.b2ParticleSystem.BodyContactCompare=function(t,e){return t.index===e.index?t.weight>e.weight:t.index<e.index};box2d.b2ParticleSystem.prototype.DetectStuckParticle=function(t){0>=this.m_stuckThreshold||(++this.m_bodyContactCountBuffer.data[t],2===this.m_bodyContactCountBuffer.data[t]&&(++this.m_consecutiveContactStepsBuffer.data[t],this.m_consecutiveContactStepsBuffer.data[t]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=t)),this.m_lastBodyContactStepBuffer.data[t]=this.m_timestamp)};box2d.b2ParticleSystem.prototype.ValidateParticleIndex=function(t){return 0<=t&&t<this.GetParticleCount()&&t!==box2d.b2_invalidParticleIndex};box2d.b2ParticleSystem.prototype.GetQuantizedTimeElapsed=function(){return Math.floor(this.m_timeElapsed/4294967296)};box2d.b2ParticleSystem.prototype.LifetimeToExpirationTime=function(t){return this.m_timeElapsed+Math.floor(t/this.m_def.lifetimeGranularity*4294967296)};box2d.b2ParticleSystem.prototype.ForceCanBeApplied=function(t){return!(t&box2d.b2ParticleFlag.b2_wallParticle)};box2d.b2ParticleSystem.prototype.PrepareForceBuffer=function(){if(!this.m_hasForce){for(var t=0;t<this.m_count;t++)this.m_forceBuffer[t].SetZero();this.m_hasForce=!0}};box2d.b2ParticleSystem.prototype.IsRigidGroup=function(t){return null!==t&&0!==(t.m_groupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup)};box2d.b2ParticleSystem.prototype.GetLinearVelocity=function(t,e,o,i){return this.IsRigidGroup(t)?t.GetLinearVelocityFromWorldPoint(o,i):i.Copy(this.m_velocityBuffer.data[e])};box2d.b2ParticleSystem.prototype.InitDampingParameter=function(t,e,o,i,a,r,s,n){t[0]=0<i?1/i:0;e[0]=0<a?1/a:0;o[0]=box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(s,r,box2d.b2Vec2.s_t0),n)};box2d.b2ParticleSystem.prototype.InitDampingParameterWithRigidGroupOrParticle=function(t,e,o,i,a,r,s,n){i?this.InitDampingParameter(t,e,o,a.GetMass(),a.GetInertia(),a.GetCenter(),s,n):this.InitDampingParameter(t,e,o,this.m_flagsBuffer.data[r]&box2d.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,s,s,n)};box2d.b2ParticleSystem.prototype.ComputeDampingImpulse=function(t,e,o,i,a,r,s){t=t+e*o*o+i+a*r*r;return 0<t?s/t:0};box2d.b2ParticleSystem.prototype.ApplyDamping=function(t,e,o,i,a,r,s,n){i?(a.m_linearVelocity.SelfMulAdd(s*t,n),a.m_angularVelocity+=s*o*e):this.m_velocityBuffer.data[r].SelfMulAdd(s*t,n)};box2d.b2StackQueue=function(t){this.m_buffer=box2d.b2MakeArray(t);this.m_end=t};box2d.b2StackQueue.prototype.m_buffer=null;box2d.b2StackQueue.prototype.m_front=0;box2d.b2StackQueue.prototype.m_back=0;box2d.b2StackQueue.prototype.m_capacity=0;box2d.b2StackQueue.prototype.Push=function(t){if(this.m_back>=this.m_capacity){for(var e=this.m_front;e<this.m_back;e++)this.m_buffer[e-this.m_front]=this.m_buffer[e];this.m_back-=this.m_front;this.m_front=0;this.m_back>=this.m_capacity&&(0<this.m_capacity?(this.m_buffer.concat(box2d.b2MakeArray(this.m_capacity)),this.m_capacity*=2):(this.m_buffer.concat(box2d.b2MakeArray(1)),this.m_capacity=1))}this.m_buffer[this.m_back]=t;this.m_back++};box2d.b2StackQueue.prototype.Pop=function(){box2d.b2Assert(this.m_front<this.m_back);this.m_buffer[this.m_front]=null;this.m_front++};box2d.b2StackQueue.prototype.Empty=function(){box2d.b2Assert(this.m_front<=this.m_back);return this.m_front===this.m_back};box2d.b2StackQueue.prototype.Front=function(){return this.m_buffer[this.m_front]};box2d.b2VoronoiDiagram=function(t){this.m_generatorBuffer=box2d.b2MakeArray(t,function(t){return new box2d.b2VoronoiDiagram.Generator});this.m_generatorCapacity=t};goog.exportSymbol("box2d.b2VoronoiDiagram",box2d.b2VoronoiDiagram);box2d.b2VoronoiDiagram.prototype.m_generatorBuffer=null;goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"m_generatorBuffer",box2d.b2VoronoiDiagram.prototype.m_generatorBuffer);box2d.b2VoronoiDiagram.prototype.m_generatorCapacity=0;box2d.b2VoronoiDiagram.prototype.m_generatorCount=0;box2d.b2VoronoiDiagram.prototype.m_countX=0;box2d.b2VoronoiDiagram.prototype.m_countY=0;box2d.b2VoronoiDiagram.prototype.m_diagram=null;box2d.b2VoronoiDiagram.Generator=function(){this.center=new box2d.b2Vec2};box2d.b2VoronoiDiagram.Generator.prototype.center=null;box2d.b2VoronoiDiagram.Generator.prototype.tag=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask=function(t,e,o,i){this.m_x=t;this.m_y=e;this.m_i=o;this.m_generator=i};box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_x=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_y=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_i=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_generator=null;box2d.b2VoronoiDiagram.prototype.AddGenerator=function(t,e,o){box2d.b2Assert(this.m_generatorCount<this.m_generatorCapacity);var i=this.m_generatorBuffer[this.m_generatorCount++];i.center.Copy(t);i.tag=e;i.necessary=o};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"AddGenerator",box2d.b2VoronoiDiagram.prototype.AddGenerator);box2d.b2VoronoiDiagram.prototype.Generate=function(t,e){box2d.b2Assert(null===this.m_diagram);for(var o=1/t,i=new box2d.b2Vec2(+box2d.b2_maxFloat,+box2d.b2_maxFloat),a=new box2d.b2Vec2(-box2d.b2_maxFloat,-box2d.b2_maxFloat),r=0,s=0;s<this.m_generatorCount;s++){var n=this.m_generatorBuffer[s];n.necessary&&(box2d.b2Min_V2_V2(i,n.center,i),box2d.b2Max_V2_V2(a,n.center,a),++r)}if(0===r)this.m_countY=this.m_countX=0;else{i.x-=e;i.y-=e;a.x+=e;a.y+=e;this.m_countX=1+Math.floor(o*(a.x-i.x));this.m_countY=1+Math.floor(o*(a.y-i.y));this.m_diagram=box2d.b2MakeArray(this.m_countX*this.m_countY);a=new box2d.b2StackQueue(4*this.m_countX*this.m_countY);for(s=0;s<this.m_generatorCount;s++){n=this.m_generatorBuffer[s];n.center.SelfSub(i).SelfMul(o);var r=Math.floor(n.center.x),b=Math.floor(n.center.y);0<=r&&0<=b&&r<this.m_countX&&b<this.m_countY&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b,r+b*this.m_countX,n))}for(;!a.Empty();)s=a.Front(),r=s.m_x,b=s.m_y,o=s.m_i,n=s.m_generator,a.Pop(),this.m_diagram[o]||(this.m_diagram[o]=n,0<r&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r-1,b,o-1,n)),0<b&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b-1,o-this.m_countX,n)),r<this.m_countX-1&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r+1,b,o+1,n)),b<this.m_countY-1&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b+1,o+this.m_countX,n)));for(b=0;b<this.m_countY;b++)for(r=0;r<this.m_countX-1;r++)o=r+b*this.m_countX,i=this.m_diagram[o],s=this.m_diagram[o+1],i!==s&&(a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b,o,s)),a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r+1,b,o+1,i)));for(b=0;b<this.m_countY-1;b++)for(r=0;r<this.m_countX;r++)o=r+b*this.m_countX,i=this.m_diagram[o],s=this.m_diagram[o+this.m_countX],i!==s&&(a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b,o,s)),a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b+1,o+this.m_countX,i)));for(;!a.Empty();)if(s=a.Front(),r=s.m_x,b=s.m_y,o=s.m_i,s=s.m_generator,a.Pop(),i=this.m_diagram[o],i!==s){var n=i.center.x-r,i=i.center.y-b,x=s.center.x-r,l=s.center.y-b;n*n+i*i>x*x+l*l&&(this.m_diagram[o]=s,0<r&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r-1,b,o-1,s)),0<b&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b-1,o-this.m_countX,s)),r<this.m_countX-1&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r+1,b,o+1,s)),b<this.m_countY-1&&a.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(r,b+1,o+this.m_countX,s)))}}};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"Generate",box2d.b2VoronoiDiagram.prototype.Generate);box2d.b2VoronoiDiagram.prototype.GetNodes=function(t){for(var e=0;e<this.m_countY-1;e++)for(var o=0;o<this.m_countX-1;o++){var i=o+e*this.m_countX,a=this.m_diagram[i],r=this.m_diagram[i+1],s=this.m_diagram[i+this.m_countX],i=this.m_diagram[i+1+this.m_countX];r!==s&&(a!==r&&a!==s&&(a.necessary||r.necessary||s.necessary)&&t(a.tag,r.tag,s.tag),i!==r&&i!==s&&(a.necessary||r.necessary||s.necessary)&&t(r.tag,i.tag,s.tag))}};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"GetNodes",box2d.b2VoronoiDiagram.prototype.GetNodes);box2d.b2RopeDef=function(){this.vertices=[];this.masses=[];this.gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2RopeDef",box2d.b2RopeDef);box2d.b2RopeDef.prototype.vertices=null;box2d.b2RopeDef.prototype.count=0;box2d.b2RopeDef.prototype.masses=null;box2d.b2RopeDef.prototype.gravity=null;box2d.b2RopeDef.prototype.damping=.1;box2d.b2RopeDef.prototype.k2=.9;box2d.b2RopeDef.prototype.k3=.1;box2d.b2Rope=function(){this.m_gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Rope",box2d.b2Rope);box2d.b2Rope.prototype.m_count=0;box2d.b2Rope.prototype.m_ps=null;box2d.b2Rope.prototype.m_p0s=null;box2d.b2Rope.prototype.m_vs=null;box2d.b2Rope.prototype.m_ims=null;box2d.b2Rope.prototype.m_Ls=null;box2d.b2Rope.prototype.m_as=null;box2d.b2Rope.prototype.m_gravity=null;box2d.b2Rope.prototype.m_damping=0;box2d.b2Rope.prototype.m_k2=1;box2d.b2Rope.prototype.m_k3=.1;box2d.b2Rope.prototype.GetVertexCount=function(){return this.m_count};goog.exportProperty(box2d.b2Rope.prototype,"GetVertexCount",box2d.b2Rope.prototype.GetVertexCount);box2d.b2Rope.prototype.GetVertices=function(){return this.m_ps};goog.exportProperty(box2d.b2Rope.prototype,"GetVertices",box2d.b2Rope.prototype.GetVertices);box2d.b2Rope.prototype.Initialize=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=t.count);this.m_count=t.count;this.m_ps=box2d.b2Vec2.MakeArray(this.m_count);this.m_p0s=box2d.b2Vec2.MakeArray(this.m_count);this.m_vs=box2d.b2Vec2.MakeArray(this.m_count);this.m_ims=box2d.b2MakeNumberArray(this.m_count);for(var e=0;e<this.m_count;++e){this.m_ps[e].Copy(t.vertices[e]);this.m_p0s[e].Copy(t.vertices[e]);this.m_vs[e].SetZero();var o=t.masses[e];this.m_ims[e]=0<o?1/o:0}var i=this.m_count-1,o=this.m_count-2;this.m_Ls=box2d.b2MakeNumberArray(i);this.m_as=box2d.b2MakeNumberArray(o);for(e=0;e<i;++e){var a=this.m_ps[e],r=this.m_ps[e+1];this.m_Ls[e]=box2d.b2Distance(a,r)}for(e=0;e<o;++e)a=this.m_ps[e],r=this.m_ps[e+1],i=this.m_ps[e+2],a=box2d.b2Sub_V2_V2(r,a,box2d.b2Vec2.s_t0),i=box2d.b2Sub_V2_V2(i,r,box2d.b2Vec2.s_t1),r=box2d.b2Cross_V2_V2(a,i),a=box2d.b2Dot_V2_V2(a,i),this.m_as[e]=box2d.b2Atan2(r,a);this.m_gravity.Copy(t.gravity);this.m_damping=t.damping;this.m_k2=t.k2;this.m_k3=t.k3};goog.exportProperty(box2d.b2Rope.prototype,"Initialize",box2d.b2Rope.prototype.Initialize);box2d.b2Rope.prototype.Step=function(t,e){if(0!==t){for(var o=Math.exp(-t*this.m_damping),i=0;i<this.m_count;++i)this.m_p0s[i].Copy(this.m_ps[i]),0<this.m_ims[i]&&this.m_vs[i].SelfMulAdd(t,this.m_gravity),this.m_vs[i].SelfMul(o),this.m_ps[i].SelfMulAdd(t,this.m_vs[i]);for(i=0;i<e;++i)this.SolveC2(),this.SolveC3(),this.SolveC2();o=1/t;for(i=0;i<this.m_count;++i)box2d.b2Mul_S_V2(o,box2d.b2Sub_V2_V2(this.m_ps[i],this.m_p0s[i],box2d.b2Vec2.s_t0),this.m_vs[i])}};goog.exportProperty(box2d.b2Rope.prototype,"Step",box2d.b2Rope.prototype.Step);box2d.b2Rope.prototype.SolveC2=function(){for(var t=this.m_count-1,e=0;e<t;++e){var o=this.m_ps[e],i=this.m_ps[e+1],a=box2d.b2Sub_V2_V2(i,o,box2d.b2Rope.s_d),r=a.Normalize(),s=this.m_ims[e],n=this.m_ims[e+1];if(0!==s+n){var b=n/(s+n);o.SelfMulSub(s/(s+n)*this.m_k2*(this.m_Ls[e]-r),a);i.SelfMulAdd(this.m_k2*b*(this.m_Ls[e]-r),a)}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC2",box2d.b2Rope.prototype.SolveC2);box2d.b2Rope.s_d=new box2d.b2Vec2;box2d.b2Rope.prototype.SetAngle=function(t){for(var e=this.m_count-2,o=0;o<e;++o)this.m_as[o]=t};goog.exportProperty(box2d.b2Rope.prototype,"SetAngle",box2d.b2Rope.prototype.SetAngle);box2d.b2Rope.prototype.SolveC3=function(){for(var t=this.m_count-2,e=0;e<t;++e){var o=this.m_ps[e],i=this.m_ps[e+1],a=this.m_ps[e+2],r=this.m_ims[e],s=this.m_ims[e+1],n=this.m_ims[e+2],b=box2d.b2Sub_V2_V2(i,o,box2d.b2Rope.s_d1),x=box2d.b2Sub_V2_V2(a,i,box2d.b2Rope.s_d2),l=b.LengthSquared(),_=x.LengthSquared();if(0!==l*_){var h=box2d.b2Cross_V2_V2(b,x),d=box2d.b2Dot_V2_V2(b,x),h=box2d.b2Atan2(h,d),b=box2d.b2Mul_S_V2(-1/l,b.SelfSkew(),box2d.b2Rope.s_Jd1),l=box2d.b2Mul_S_V2(1/_,x.SelfSkew(),box2d.b2Rope.s_Jd2),x=box2d.b2Rope.s_J1.Copy(b).SelfNeg(),_=box2d.b2Sub_V2_V2(b,l,box2d.b2Rope.s_J2),b=l,l=r*box2d.b2Dot_V2_V2(x,x)+s*box2d.b2Dot_V2_V2(_,_)+n*box2d.b2Dot_V2_V2(b,b);if(0!==l){l=1/l;for(d=h-this.m_as[e];d>box2d.b2_pi;)h-=2*box2d.b2_pi,d=h-this.m_as[e];for(;d<-box2d.b2_pi;)h+=2*box2d.b2_pi,d=h-this.m_as[e];h=-this.m_k3*l*d;o.SelfMulAdd(r*h,x);i.SelfMulAdd(s*h,_);a.SelfMulAdd(n*h,b)}}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC3",box2d.b2Rope.prototype.SolveC3);box2d.b2Rope.s_d1=new box2d.b2Vec2;box2d.b2Rope.s_d2=new box2d.b2Vec2;box2d.b2Rope.s_Jd1=new box2d.b2Vec2;box2d.b2Rope.s_Jd2=new box2d.b2Vec2;box2d.b2Rope.s_J1=new box2d.b2Vec2;box2d.b2Rope.s_J2=new box2d.b2Vec2;box2d.b2Rope.prototype.Draw=function(t){for(var e=new box2d.b2Color(.4,.5,.7),o=0;o<this.m_count-1;++o)t.DrawSegment(this.m_ps[o],this.m_ps[o+1],e)};goog.exportProperty(box2d.b2Rope.prototype,"Draw",box2d.b2Rope.prototype.Draw);box2d.b2ControllerEdge=function(){};goog.exportSymbol("box2d.b2ControllerEdge",box2d.b2ControllerEdge);box2d.b2ControllerEdge.prototype.controller=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"controller",box2d.b2ControllerEdge.prototype.controller);box2d.b2ControllerEdge.prototype.body=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"body",box2d.b2ControllerEdge.prototype.body);box2d.b2ControllerEdge.prototype.prevBody=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevBody",box2d.b2ControllerEdge.prototype.prevBody);box2d.b2ControllerEdge.prototype.nextBody=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextBody",box2d.b2ControllerEdge.prototype.nextBody);box2d.b2ControllerEdge.prototype.prevController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevController",box2d.b2ControllerEdge.prototype.prevController);box2d.b2ControllerEdge.prototype.nextController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextController",box2d.b2ControllerEdge.prototype.nextController);box2d.b2Controller=function(){};goog.exportSymbol("box2d.b2Controller",box2d.b2Controller);box2d.b2Controller.prototype.m_world=null;goog.exportProperty(box2d.b2Controller.prototype,"m_world",box2d.b2Controller.prototype.m_world);box2d.b2Controller.prototype.m_bodyList=null;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyList",box2d.b2Controller.prototype.m_bodyList);box2d.b2Controller.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyCount",box2d.b2Controller.prototype.m_bodyCount);box2d.b2Controller.prototype.m_prev=null;goog.exportProperty(box2d.b2Controller.prototype,"m_prev",box2d.b2Controller.prototype.m_prev);box2d.b2Controller.prototype.m_next=null;goog.exportProperty(box2d.b2Controller.prototype,"m_next",box2d.b2Controller.prototype.m_next);box2d.b2Controller.prototype.Step=function(t){};goog.exportProperty(box2d.b2Controller.prototype,"Step",box2d.b2Controller.prototype.Step);box2d.b2Controller.prototype.Draw=function(t){};goog.exportProperty(box2d.b2Controller.prototype,"Draw",box2d.b2Controller.prototype.Draw);box2d.b2Controller.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Controller.prototype,"GetNext",box2d.b2Controller.prototype.GetNext);box2d.b2Controller.prototype.GetPrev=function(){return this.m_prev};goog.exportProperty(box2d.b2Controller.prototype,"GetPrev",box2d.b2Controller.prototype.GetPrev);box2d.b2Controller.prototype.GetWorld=function(){return this.m_world};goog.exportProperty(box2d.b2Controller.prototype,"GetWorld",box2d.b2Controller.prototype.GetWorld);box2d.b2Controller.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2Controller.prototype,"GetBodyList",box2d.b2Controller.prototype.GetBodyList);box2d.b2Controller.prototype.AddBody=function(t){var e=new box2d.b2ControllerEdge;e.body=t;e.controller=this;e.nextBody=this.m_bodyList;e.prevBody=null;this.m_bodyList&&(this.m_bodyList.prevBody=e);this.m_bodyList=e;++this.m_bodyCount;e.nextController=t.m_controllerList;e.prevController=null;t.m_controllerList&&(t.m_controllerList.prevController=e);t.m_controllerList=e;++t.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"AddBody",box2d.b2Controller.prototype.AddBody);box2d.b2Controller.prototype.RemoveBody=function(t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);for(var e=this.m_bodyList;e&&e.body!==t;)e=e.nextBody;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==e);e.prevBody&&(e.prevBody.nextBody=e.nextBody);e.nextBody&&(e.nextBody.prevBody=e.prevBody);this.m_bodyList===e&&(this.m_bodyList=e.nextBody);--this.m_bodyCount;e.nextController&&(e.nextController.prevController=e.prevController);e.prevController&&(e.prevController.nextController=e.nextController);t.m_controllerList===e&&(t.m_controllerList=e.nextController);--t.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"RemoveBody",box2d.b2Controller.prototype.RemoveBody);box2d.b2Controller.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0};goog.exportProperty(box2d.b2Controller.prototype,"Clear",box2d.b2Controller.prototype.Clear);box2d.b2BuoyancyController=function(){box2d.b2Controller.call(this);this.normal=new box2d.b2Vec2(0,1);this.velocity=new box2d.b2Vec2(0,0);this.gravity=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2BuoyancyController,box2d.b2Controller);goog.exportSymbol("box2d.b2BuoyancyController",box2d.b2BuoyancyController);box2d.b2BuoyancyController.prototype.normal=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"normal",box2d.b2BuoyancyController.prototype.normal);box2d.b2BuoyancyController.prototype.offset=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"offset",box2d.b2BuoyancyController.prototype.offset);box2d.b2BuoyancyController.prototype.density=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"density",box2d.b2BuoyancyController.prototype.density);box2d.b2BuoyancyController.prototype.velocity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"velocity",box2d.b2BuoyancyController.prototype.velocity);box2d.b2BuoyancyController.prototype.linearDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"linearDrag",box2d.b2BuoyancyController.prototype.linearDrag);box2d.b2BuoyancyController.prototype.angularDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"angularDrag",box2d.b2BuoyancyController.prototype.angularDrag);box2d.b2BuoyancyController.prototype.useDensity=!1;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useDensity",box2d.b2BuoyancyController.prototype.useDensity);box2d.b2BuoyancyController.prototype.useWorldGravity=!0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useWorldGravity",box2d.b2BuoyancyController.prototype.useWorldGravity);box2d.b2BuoyancyController.prototype.gravity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"gravity",box2d.b2BuoyancyController.prototype.gravity);box2d.b2BuoyancyController.prototype.Step=function(t){if(this.m_bodyList)for(this.useWorldGravity&&this.gravity.Copy(this.GetWorld().GetGravity()),t=this.m_bodyList;t;t=t.nextBody){var e=t.body;if(e.IsAwake()){for(var o=new box2d.b2Vec2,i=new box2d.b2Vec2,a=0,r=0,s=e.GetFixtureList();s;s=s.m_next){var n=new box2d.b2Vec2,b=s.GetShape().ComputeSubmergedArea(this.normal,this.offset,e.GetTransform(),n),a=a+b;o.x+=b*n.x;o.y+=b*n.y;var x=0,x=this.useDensity?s.GetDensity():1,r=r+b*x;i.x+=b*n.x*x;i.y+=b*n.y*x}o.x/=a;o.y/=a;i.x/=r;i.y/=r;a<box2d.b2_epsilon||(r=this.gravity.Clone().SelfNeg(),r.SelfMul(this.density*a),e.ApplyForce(r,i),i=e.GetLinearVelocityFromWorldPoint(o,new box2d.b2Vec2),i.SelfSub(this.velocity),i.SelfMul(-this.linearDrag*a),e.ApplyForce(i,o),e.ApplyTorque(-e.GetInertia()/e.GetMass()*a*e.GetAngularVelocity()*this.angularDrag))}}};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Step",box2d.b2BuoyancyController.prototype.Step);box2d.b2BuoyancyController.prototype.Draw=function(t){var e=new box2d.b2Vec2,o=new box2d.b2Vec2;e.x=this.normal.x*this.offset+100*this.normal.y;e.y=this.normal.y*this.offset-100*this.normal.x;o.x=this.normal.x*this.offset-100*this.normal.y;o.y=this.normal.y*this.offset+100*this.normal.x;var i=new box2d.b2Color(0,0,.8);t.DrawSegment(e,o,i)};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Draw",box2d.b2BuoyancyController.prototype.Draw);box2d.b2ConstantAccelController=function(){box2d.b2Controller.call(this);this.A=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantAccelController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantAccelController",box2d.b2ConstantAccelController);box2d.b2ConstantAccelController.prototype.A=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"A",box2d.b2ConstantAccelController.prototype.A);box2d.b2ConstantAccelController.prototype.Step=function(t){t=box2d.b2Mul_S_V2(t.dt,this.A,box2d.b2ConstantAccelController.prototype.Step.s_dtA);for(var e=this.m_bodyList;e;e=e.nextBody){var o=e.body;o.IsAwake()&&o.SetLinearVelocity(box2d.b2Add_V2_V2(o.GetLinearVelocity(),t,box2d.b2Vec2.s_t0))}};goog.exportProperty(box2d.b2ConstantAccelController.prototype,"Step",box2d.b2ConstantAccelController.prototype.Step);box2d.b2ConstantAccelController.prototype.Step.s_dtA=new box2d.b2Vec2;box2d.b2ConstantForceController=function(){box2d.b2Controller.call(this);this.F=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantForceController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantForceController",box2d.b2ConstantForceController);box2d.b2ConstantAccelController.prototype.F=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"F",box2d.b2ConstantAccelController.prototype.F);box2d.b2ConstantForceController.prototype.Step=function(t){for(t=this.m_bodyList;t;t=t.nextBody){var e=t.body;e.IsAwake()&&e.ApplyForce(this.F,e.GetWorldCenter())}};goog.exportProperty(box2d.b2ConstantForceController.prototype,"Step",box2d.b2ConstantForceController.prototype.Step);box2d.b2GravityController=function(){box2d.b2Controller.call(this)};goog.inherits(box2d.b2GravityController,box2d.b2Controller);goog.exportSymbol("box2d.b2GravityController",box2d.b2GravityController);box2d.b2GravityController.prototype.G=1;goog.exportProperty(box2d.b2GravityController.prototype,"G",box2d.b2GravityController.prototype.G);box2d.b2GravityController.prototype.invSqr=!0;goog.exportProperty(box2d.b2GravityController.prototype,"invSqr",box2d.b2GravityController.prototype.invSqr);box2d.b2GravityController.prototype.Step=function(t){if(this.invSqr)for(t=this.m_bodyList;t;t=t.nextBody)for(var e=t.body,o=e.GetWorldCenter(),i=e.GetMass(),a=this.m_bodyList;a!==t;a=a.nextBody){var r=a.body,s=r.GetWorldCenter(),n=r.GetMass(),b=s.x-o.x,x=s.y-o.y,l=b*b+x*x;l<box2d.b2_epsilon||(b=box2d.b2GravityController.prototype.Step.s_f.Set(b,x),b.SelfMul(this.G/l/box2d.b2Sqrt(l)*i*n),e.IsAwake()&&e.ApplyForce(b,o),r.IsAwake()&&r.ApplyForce(b.SelfMul(-1),s))}else for(t=this.m_bodyList;t;t=t.nextBody)for(e=t.body,o=e.GetWorldCenter(),i=e.GetMass(),a=this.m_bodyList;a!==t;a=a.nextBody)r=a.body,s=r.GetWorldCenter(),n=r.GetMass(),b=s.x-o.x,x=s.y-o.y,l=b*b+x*x,l<box2d.b2_epsilon||(b=box2d.b2GravityController.prototype.Step.s_f.Set(b,x),b.SelfMul(this.G/l*i*n),e.IsAwake()&&e.ApplyForce(b,o),r.IsAwake()&&r.ApplyForce(b.SelfMul(-1),s))};goog.exportProperty(box2d.b2GravityController.prototype,"Step",box2d.b2GravityController.prototype.Step);box2d.b2GravityController.prototype.Step.s_f=new box2d.b2Vec2;box2d.b2TensorDampingController=function(){box2d.b2Controller.call(this);this.T=new box2d.b2Mat22;this.maxTimestep=0};goog.inherits(box2d.b2TensorDampingController,box2d.b2Controller);goog.exportSymbol("box2d.b2TensorDampingController",box2d.b2TensorDampingController);box2d.b2TensorDampingController.prototype.T=new box2d.b2Mat22;goog.exportProperty(box2d.b2TensorDampingController.prototype,"T",box2d.b2TensorDampingController.prototype.T);box2d.b2TensorDampingController.prototype.maxTimestep=0;goog.exportProperty(box2d.b2TensorDampingController.prototype,"maxTimestep",box2d.b2TensorDampingController.prototype.maxTimestep);box2d.b2TensorDampingController.prototype.Step=function(t){t=t.dt;if(!(t<=box2d.b2_epsilon)){t>this.maxTimestep&&0<this.maxTimestep&&(t=this.maxTimestep);for(var e=this.m_bodyList;e;e=e.nextBody){var o=e.body;if(o.IsAwake()){var i=o.GetWorldVector(box2d.b2Mul_M22_V2(this.T,o.GetLocalVector(o.GetLinearVelocity(),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1),box2d.b2TensorDampingController.prototype.Step.s_damping);o.SetLinearVelocity(box2d.b2Add_V2_V2(o.GetLinearVelocity(),box2d.b2Mul_S_V2(t,i,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1))}}}};box2d.b2TensorDampingController.prototype.Step.s_damping=new box2d.b2Vec2;box2d.b2TensorDampingController.prototype.SetAxisAligned=function(t,e){this.T.ex.x=-t;this.T.ex.y=0;this.T.ey.x=0;this.T.ey.y=-e;this.maxTimestep=0<t||0<e?1/box2d.b2Max(t,e):0};box2d.b2Vec2.SubVV=function(t,e,o){o.x=t.x-e.x;o.y=t.y-e.y;return o};window.box2d=box2d;(function(t,l){"use strict";class r{}r.RigidBody=null;r.Physics=null;class s extends l.Component{constructor(){super(...arguments);this._isSensor=false;this._density=10;this._friction=.2;this._restitution=0}getDef(){if(!this._def){var t=new window.box2d.b2FixtureDef;t.density=this.density;t.friction=this.friction;t.isSensor=this.isSensor;t.restitution=this.restitution;t.shape=this._shape;this._def=t}return this._def}_onEnable(){this.rigidBody||l.Laya.systemTimer.callLater(this,this._checkRigidBody)}_checkRigidBody(){if(!this.rigidBody){var t=this.owner.getComponent(r.RigidBody);if(t){this.rigidBody=t;this.refresh()}}}_onDestroy(){if(this.rigidBody){if(this.fixture){if(this.fixture.GetBody()==this.rigidBody.body){this.rigidBody.body.DestroyFixture(this.fixture)}this.fixture=null}this.rigidBody=null;this._shape=null;this._def=null}}get isSensor(){return this._isSensor}set isSensor(t){this._isSensor=t;if(this._def){this._def.isSensor=t;this.refresh()}}get density(){return this._density}set density(t){this._density=t;if(this._def){this._def.density=t;this.refresh()}}get friction(){return this._friction}set friction(t){this._friction=t;if(this._def){this._def.friction=t;this.refresh()}}get restitution(){return this._restitution}set restitution(t){this._restitution=t;if(this._def){this._def.restitution=t;this.refresh()}}refresh(){if(this.enabled&&this.rigidBody){var t=this.rigidBody.body;if(this.fixture){if(this.fixture.GetBody()==this.rigidBody.body){this.rigidBody.body.DestroyFixture(this.fixture)}this.fixture.Destroy();this.fixture=null}var e=this.getDef();e.filter.groupIndex=this.rigidBody.group;e.filter.categoryBits=this.rigidBody.category;e.filter.maskBits=this.rigidBody.mask;this.fixture=t.CreateFixture(e);this.fixture.collider=this}}resetShape(t=true){}get isSingleton(){return false}}l.ClassUtils.regClass("laya.physics.ColliderBase",s);l.ClassUtils.regClass("Laya.ColliderBase",s);class _ extends l.Component{constructor(){super(...arguments);this._type="dynamic";this._allowSleep=true;this._angularVelocity=0;this._angularDamping=0;this._linearVelocity={x:0,y:0};this._linearDamping=0;this._bullet=false;this._allowRotation=true;this._gravityScale=1;this.group=0;this.category=1;this.mask=-1;this.label="RigidBody"}_createBody(){if(this._body)return;var t=this.owner;var e=window.box2d;var o=new e.b2BodyDef;var i=this.owner.localToGlobal(l.Point.TEMP.setTo(0,0),false,r.Physics.I.worldRoot);o.position.Set(i.x/r.Physics.PIXEL_RATIO,i.y/r.Physics.PIXEL_RATIO);o.angle=l.Utils.toRadian(t.rotation);o.allowSleep=this._allowSleep;o.angularDamping=this._angularDamping;o.angularVelocity=this._angularVelocity;o.bullet=this._bullet;o.fixedRotation=!this._allowRotation;o.gravityScale=this._gravityScale;o.linearDamping=this._linearDamping;var a=this._linearVelocity;if(a&&a.x!=0||a.y!=0){o.linearVelocity=new e.b2Vec2(a.x,a.y)}o.type=e.b2BodyType["b2_"+this._type+"Body"];this._body=r.Physics.I._createBody(o);this.resetCollider(false)}_onAwake(){this._createBody()}_onEnable(){var e=this;this._createBody();l.Laya.physicsTimer.frameLoop(1,this,this._sysPhysicToNode);var o=this.owner;if(this.accessGetSetFunc(o,"x","set")&&!o._changeByRigidBody){o._changeByRigidBody=true;function t(t){e.accessGetSetFunc(o,"x","set")(t);e._sysPosToPhysic()}this._overSet(o,"x",t);function i(t){e.accessGetSetFunc(o,"y","set")(t);e._sysPosToPhysic()}this._overSet(o,"y",i);function a(t){e.accessGetSetFunc(o,"rotation","set")(t);e._sysNodeToPhysic()}this._overSet(o,"rotation",a);function r(t){e.accessGetSetFunc(o,"scaleX","set")(t);e.resetCollider(true)}this._overSet(o,"scaleX",r);function s(t){e.accessGetSetFunc(o,"scaleY","set")(t);e.resetCollider(true)}this._overSet(o,"scaleY",s)}}accessGetSetFunc(t,e,o){if(["get","set"].indexOf(o)===-1){return}let i=`_$${o}_${e}`;if(t[i]){return t[i]}let a=t.constructor;let r;while(a){r=Object.getOwnPropertyDescriptor(a.prototype,e);if(r&&r[o]){t[i]=r[o].bind(t);break}a=Object.getPrototypeOf(a)}return t[i]}resetCollider(t){var e=this.owner.getComponents(s);if(e){for(var o=0,i=e.length;o<i;o++){var a=e[o];a.rigidBody=this;if(t)a.resetShape();else a.refresh()}}}_sysPhysicToNode(){if(this.type!="static"&&this._body.IsAwake()){var t=this._body.GetPosition();var e=this._body.GetAngle();var o=this.owner;this.accessGetSetFunc(o,"rotation","set")(l.Utils.toAngle(e)-o.parent.globalRotation);if(e==0){var i=o.parent.globalToLocal(l.Point.TEMP.setTo(t.x*r.Physics.PIXEL_RATIO+o.pivotX,t.y*r.Physics.PIXEL_RATIO+o.pivotY),false,r.Physics.I.worldRoot);this.accessGetSetFunc(o,"x","set")(i.x);this.accessGetSetFunc(o,"y","set")(i.y)}else{i=o.globalToLocal(l.Point.TEMP.setTo(t.x*r.Physics.PIXEL_RATIO,t.y*r.Physics.PIXEL_RATIO),false,r.Physics.I.worldRoot);i.x+=o.pivotX;i.y+=o.pivotY;i=o.toParentPoint(i);this.accessGetSetFunc(o,"x","set")(i.x);this.accessGetSetFunc(o,"y","set")(i.y)}}}_sysNodeToPhysic(){var t=this.owner;this._body.SetAngle(l.Utils.toRadian(t.rotation));var e=t.localToGlobal(l.Point.TEMP.setTo(0,0),false,r.Physics.I.worldRoot);this._body.SetPositionXY(e.x/r.Physics.PIXEL_RATIO,e.y/r.Physics.PIXEL_RATIO)}_sysPosToPhysic(){var t=this.owner;var e=t.localToGlobal(l.Point.TEMP.setTo(0,0),false,r.Physics.I.worldRoot);this._body.SetPositionXY(e.x/r.Physics.PIXEL_RATIO,e.y/r.Physics.PIXEL_RATIO)}_overSet(t,e,o){Object.defineProperty(t,e,{get:this.accessGetSetFunc(t,e,"get"),set:o,enumerable:false,configurable:true})}_onDisable(){l.Laya.physicsTimer.clear(this,this._sysPhysicToNode);r.Physics.I._removeBody(this._body);this._body=null;var t=this.owner;if(t._changeByRigidBody){this._overSet(t,"x",this.accessGetSetFunc(t,"x","set"));this._overSet(t,"y",this.accessGetSetFunc(t,"y","set"));this._overSet(t,"rotation",this.accessGetSetFunc(t,"rotation","set"));this._overSet(t,"scaleX",this.accessGetSetFunc(t,"scaleX","set"));this._overSet(t,"scaleY",this.accessGetSetFunc(t,"scaleY","set"));t._changeByRigidBody=false}}getBody(){if(!this._body)this._onAwake();return this._body}get body(){if(!this._body)this._onAwake();return this._body}applyForce(t,e){if(!this._body)this._onAwake();this._body.ApplyForce(e,t)}applyForceToCenter(t){if(!this._body)this._onAwake();this._body.ApplyForceToCenter(t)}applyLinearImpulse(t,e){if(!this._body)this._onAwake();this._body.ApplyLinearImpulse(e,t)}applyLinearImpulseToCenter(t){if(!this._body)this._onAwake();this._body.ApplyLinearImpulseToCenter(t)}applyTorque(t){if(!this._body)this._onAwake();this._body.ApplyTorque(t)}setVelocity(t){if(!this._body)this._onAwake();this._body.SetLinearVelocity(t)}setAngle(t){if(!this._body)this._onAwake();this._body.SetAngle(t);this._body.SetAwake(true)}getMass(){return this._body?this._body.GetMass():0}getCenter(){if(!this._body)this._onAwake();var t=this._body.GetLocalCenter();t.x=t.x*r.Physics.PIXEL_RATIO;t.y=t.y*r.Physics.PIXEL_RATIO;return t}getWorldCenter(){if(!this._body)this._onAwake();var t=this._body.GetWorldCenter();t.x=t.x*r.Physics.PIXEL_RATIO;t.y=t.y*r.Physics.PIXEL_RATIO;return t}get type(){return this._type}set type(t){this._type=t;if(this._body)this._body.SetType(window.box2d.b2BodyType["b2_"+this._type+"Body"])}get gravityScale(){return this._gravityScale}set gravityScale(t){this._gravityScale=t;if(this._body)this._body.SetGravityScale(t)}get allowRotation(){return this._allowRotation}set allowRotation(t){this._allowRotation=t;if(this._body)this._body.SetFixedRotation(!t)}get allowSleep(){return this._allowSleep}set allowSleep(t){this._allowSleep=t;if(this._body)this._body.SetSleepingAllowed(t)}get angularDamping(){return this._angularDamping}set angularDamping(t){this._angularDamping=t;if(this._body)this._body.SetAngularDamping(t)}get angularVelocity(){if(this._body)return this._body.GetAngularVelocity();return this._angularVelocity}set angularVelocity(t){this._angularVelocity=t;if(this._body)this._body.SetAngularVelocity(t)}get linearDamping(){return this._linearDamping}set linearDamping(t){this._linearDamping=t;if(this._body)this._body.SetLinearDamping(t)}get linearVelocity(){if(this._body){var t=this._body.GetLinearVelocity();return{x:t.x,y:t.y}}return this._linearVelocity}set linearVelocity(t){if(!t)return;if(t instanceof Array){t={x:t[0],y:t[1]}}this._linearVelocity=t;if(this._body)this._body.SetLinearVelocity(new window.box2d.b2Vec2(t.x,t.y))}get bullet(){return this._bullet}set bullet(t){this._bullet=t;if(this._body)this._body.SetBullet(t)}}l.ClassUtils.regClass("laya.physics.RigidBody",_);l.ClassUtils.regClass("Laya.RigidBody",_);class h extends l.EventDispatcher{constructor(){super();this.box2d=window.box2d;this.velocityIterations=8;this.positionIterations=3;this._eventList=[]}static get I(){return h._I||(h._I=new h)}static enable(t=null){h.I.start(t);r.RigidBody=_;r.Physics=this}start(t=null){if(!this._enabled){this._enabled=true;t||(t={});var e=window.box2d;if(e==null){console.error("Can not find box2d libs, you should reuqest box2d.js first.");return}var o=new e.b2Vec2(0,t.gravity||500/h.PIXEL_RATIO);this.world=new e.b2World(o);this.world.SetContactListener(new i);this.allowSleeping=t.allowSleeping==null?true:t.allowSleeping;if(!t.customUpdate)l.Laya.physicsTimer.frameLoop(1,this,this._update);this._emptyBody=this._createBody(new window.box2d.b2BodyDef)}}_update(){this.world.Step(1/60,this.velocityIterations,this.positionIterations,3);var t=this._eventList.length;if(t>0){for(var e=0;e<t;e+=2){this._sendEvent(this._eventList[e],this._eventList[e+1])}this._eventList.length=0}}_sendEvent(t,e){var o=e.GetFixtureA().collider;var i=e.GetFixtureB().collider;var a=o.owner;var r=i.owner;e.getHitInfo=function(){var t=new this.box2d.b2WorldManifold;this.GetWorldManifold(t);var e=t.points[0];e.x*=h.PIXEL_RATIO;e.y*=h.PIXEL_RATIO;return t};if(a){var s=[i,o,e];if(t===0){a.event(l.Event.TRIGGER_ENTER,s);if(!a["_triggered"]){a["_triggered"]=true}else{a.event(l.Event.TRIGGER_STAY,s)}}else{a["_triggered"]=false;a.event(l.Event.TRIGGER_EXIT,s)}}if(r){s=[o,i,e];if(t===0){r.event(l.Event.TRIGGER_ENTER,s);if(!r["_triggered"]){r["_triggered"]=true}else{r.event(l.Event.TRIGGER_STAY,s)}}else{r["_triggered"]=false;r.event(l.Event.TRIGGER_EXIT,s)}}}_createBody(t){if(this.world){return this.world.CreateBody(t)}else{console.error('The physical engine should be initialized first.use "Physics.enable()"');return null}}_removeBody(t){if(this.world){this.world.DestroyBody(t)}else{console.error('The physical engine should be initialized first.use "Physics.enable()"')}}_createJoint(t){if(this.world){return this.world.CreateJoint(t)}else{console.error('The physical engine should be initialized first.use "Physics.enable()"');return null}}_removeJoint(t){if(this.world){this.world.DestroyJoint(t)}else{console.error('The physical engine should be initialized first.use "Physics.enable()"')}}stop(){l.Laya.physicsTimer.clear(this,this._update)}get allowSleeping(){return this.world.GetAllowSleeping()}set allowSleeping(t){this.world.SetAllowSleeping(t)}get gravity(){return this.world.GetGravity()}set gravity(t){this.world.SetGravity(t)}getBodyCount(){return this.world.GetBodyCount()}getContactCount(){return this.world.GetContactCount()}getJointCount(){return this.world.GetJointCount()}get worldRoot(){return this._worldRoot||l.Laya.stage}set worldRoot(t){this._worldRoot=t;if(t){var e=t.localToGlobal(l.Point.TEMP.setTo(0,0));this.world.ShiftOrigin({x:e.x/h.PIXEL_RATIO,y:e.y/h.PIXEL_RATIO})}}}h.PIXEL_RATIO=50;l.ClassUtils.regClass("laya.physics.Physics",h);l.ClassUtils.regClass("Laya.Physics",h);class i{BeginContact(t){h.I._eventList.push(0,t)}EndContact(t){h.I._eventList.push(1,t)}PreSolve(t,e){}PostSolve(t,e){}}class e extends s{constructor(){super(...arguments);this._x=0;this._y=0;this._width=100;this._height=100}getDef(){if(!this._shape){this._shape=new window.box2d.b2PolygonShape;this._setShape(false)}this.label=this.label||"BoxCollider";return super.getDef()}_setShape(t=true){var e=this.owner["scaleX"]||1;var o=this.owner["scaleY"]||1;this._shape.SetAsBox(this._width/2/h.PIXEL_RATIO*e,this._height/2/h.PIXEL_RATIO*o,new window.box2d.b2Vec2((this._width/2+this._x)/h.PIXEL_RATIO*e,(this._height/2+this._y)/h.PIXEL_RATIO*o));if(t)this.refresh()}get x(){return this._x}set x(t){this._x=t;if(this._shape)this._setShape()}get y(){return this._y}set y(t){this._y=t;if(this._shape)this._setShape()}get width(){return this._width}set width(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._width=t;if(this._shape)this._setShape()}get height(){return this._height}set height(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._height=t;if(this._shape)this._setShape()}resetShape(t=true){this._setShape()}}l.ClassUtils.regClass("laya.physics.BoxCollider",e);l.ClassUtils.regClass("Laya.BoxCollider",e);class o extends s{constructor(){super(...arguments);this._x=0;this._y=0;this._points="0,0,100,0";this._loop=false}getDef(){if(!this._shape){this._shape=new window.box2d.b2ChainShape;this._setShape(false)}this.label=this.label||"ChainCollider";return super.getDef()}_setShape(t=true){var e=this._points.split(",");var o=e.length;if(o%2==1)throw"ChainCollider points lenth must a multiplier of 2";var i=[];for(var a=0,r=o;a<r;a+=2){i.push(new window.box2d.b2Vec2((this._x+parseInt(e[a]))/h.PIXEL_RATIO,(this._y+parseInt(e[a+1]))/h.PIXEL_RATIO))}this._loop?this._shape.CreateLoop(i,o/2):this._shape.CreateChain(i,o/2);if(t)this.refresh()}get x(){return this._x}set x(t){this._x=t;if(this._shape)this._setShape()}get y(){return this._y}set y(t){this._y=t;if(this._shape)this._setShape()}get points(){return this._points}set points(t){if(!t)throw"ChainCollider points cannot be empty";this._points=t;if(this._shape)this._setShape()}get loop(){return this._loop}set loop(t){this._loop=t;if(this._shape)this._setShape()}}l.ClassUtils.regClass("laya.physics.ChainCollider",o);l.ClassUtils.regClass("Laya.ChainCollider",o);class a extends s{constructor(){super(...arguments);this._x=0;this._y=0;this._radius=50}getDef(){if(!this._shape){this._shape=new window.box2d.b2CircleShape;this._setShape(false)}this.label=this.label||"CircleCollider";return super.getDef()}_setShape(t=true){var e=this.owner["scaleX"]||1;this._shape.m_radius=this._radius/h.PIXEL_RATIO*e;this._shape.m_p.Set((this._radius+this._x)/h.PIXEL_RATIO*e,(this._radius+this._y)/h.PIXEL_RATIO*e);if(t)this.refresh()}get x(){return this._x}set x(t){this._x=t;if(this._shape)this._setShape()}get y(){return this._y}set y(t){this._y=t;if(this._shape)this._setShape()}get radius(){return this._radius}set radius(t){if(t<=0)throw"CircleCollider radius cannot be less than 0";this._radius=t;if(this._shape)this._setShape()}resetShape(t=true){this._setShape()}}l.ClassUtils.regClass("laya.physics.CircleCollider",a);l.ClassUtils.regClass("Laya.CircleCollider",a);class n extends l.Sprite{constructor(){super();this.m_drawFlags=99;if(!n._inited){n._inited=true;n.init()}this._camera={};this._camera.m_center=new n.box2d.b2Vec2(0,0);this._camera.m_extent=25;this._camera.m_zoom=1;this._camera.m_width=1280;this._camera.m_height=800;this._mG=new l.Graphics;this.graphics=this._mG;this._textSp=new l.Sprite;this._textG=this._textSp.graphics;this.addChild(this._textSp)}static init(){n.box2d=l.Browser.window.box2d;n.DrawString_s_color=new n.box2d.b2Color(.9,.6,.6);n.DrawStringWorld_s_p=new n.box2d.b2Vec2;n.DrawStringWorld_s_cc=new n.box2d.b2Vec2;n.DrawStringWorld_s_color=new n.box2d.b2Color(.5,.9,.5)}render(t,e,o){this._renderToGraphic();super.render(t,e,o)}_renderToGraphic(){if(this.world){this._textG.clear();this._mG.clear();this._mG.save();this._mG.scale(h.PIXEL_RATIO,h.PIXEL_RATIO);this.lineWidth=1/h.PIXEL_RATIO;this.world.DrawDebugData();this._mG.restore()}}SetFlags(t){this.m_drawFlags=t}GetFlags(){return this.m_drawFlags}AppendFlags(t){this.m_drawFlags|=t}ClearFlags(t){this.m_drawFlags&=~t}PushTransform(t){this._mG.save();this._mG.translate(t.p.x,t.p.y);this._mG.rotate(t.q.GetAngle())}PopTransform(t){this._mG.restore()}DrawPolygon(t,e,o){var i,a;a=t.length;var r;r=[];for(i=0;i<e;i++){r.push(t[i].x,t[i].y)}this._mG.drawPoly(0,0,r,null,o.MakeStyleString(1),this.lineWidth)}DrawSolidPolygon(t,e,o){var i,a;a=t.length;var r;r=[];for(i=0;i<e;i++){r.push(t[i].x,t[i].y)}this._mG.drawPoly(0,0,r,o.MakeStyleString(.5),o.MakeStyleString(1),this.lineWidth)}DrawCircle(t,e,o){this._mG.drawCircle(t.x,t.y,e,null,o.MakeStyleString(1),this.lineWidth)}DrawSolidCircle(t,e,o,i){var a=t.x;var r=t.y;this._mG.drawCircle(a,r,e,i.MakeStyleString(.5),i.MakeStyleString(1),this.lineWidth);this._mG.drawLine(a,r,a+o.x*e,r+o.y*e,i.MakeStyleString(1),this.lineWidth)}DrawParticles(t,e,o,i){if(o!==null){for(var a=0;a<i;++a){var r=t[a];var s=o[a];this._mG.drawCircle(r.x,r.y,e,s.MakeStyleString(),null,this.lineWidth)}}else{for(a=0;a<i;++a){r=t[a];this._mG.drawCircle(r.x,r.y,e,"#ffff00",null,this.lineWidth)}}}DrawSegment(t,e,o){this._mG.drawLine(t.x,t.y,e.x,e.y,o.MakeStyleString(1),this.lineWidth)}DrawTransform(t){this.PushTransform(t);this._mG.drawLine(0,0,1,0,n.box2d.b2Color.RED.MakeStyleString(1),this.lineWidth);this._mG.drawLine(0,0,0,1,n.box2d.b2Color.GREEN.MakeStyleString(1),this.lineWidth);this.PopTransform(t)}DrawPoint(t,e,o){e*=this._camera.m_zoom;e/=this._camera.m_extent;var i=e/2;this._mG.drawRect(t.x-i,t.y-i,e,e,o.MakeStyleString(),null)}DrawString(t,e,o){this._textG.fillText(o,t,e,"15px DroidSans",n.DrawString_s_color.MakeStyleString(),"left")}DrawStringWorld(t,e,o){this.DrawString(t,e,o)}DrawAABB(t,e){var o=t.lowerBound.x;var i=t.lowerBound.y;var a=t.upperBound.x-t.lowerBound.x;var r=t.upperBound.y-t.lowerBound.y;this._mG.drawRect(o,i,a,r,null,e.MakeStyleString(),this.lineWidth)}static enable(t=99){if(!n.I){var e=new n;e.world=h.I.world;e.world.SetDebugDraw(e);e.zOrder=1e3;e.m_drawFlags=t;l.Laya.stage.addChild(e);n.I=e}return e}}n._inited=false;l.ClassUtils.regClass("laya.physics.PhysicsDebugDraw",n);l.ClassUtils.regClass("Laya.PhysicsDebugDraw",n);class b extends s{constructor(){super(...arguments);this._x=0;this._y=0;this._points="50,0,100,100,0,100"}getDef(){if(!this._shape){this._shape=new window.box2d.b2PolygonShape;this._setShape(false)}this.label=this.label||"PolygonCollider";return super.getDef()}_setShape(t=true){var e=this._points.split(",");var o=e.length;if(o<6)throw"PolygonCollider points must be greater than 3";if(o%2==1)throw"PolygonCollider points lenth must a multiplier of 2";var i=[];for(var a=0,r=o;a<r;a+=2){i.push(new window.box2d.b2Vec2((this._x+parseInt(e[a]))/h.PIXEL_RATIO,(this._y+parseInt(e[a+1]))/h.PIXEL_RATIO))}this._shape.Set(i,o/2);if(t)this.refresh()}get x(){return this._x}set x(t){this._x=t;if(this._shape)this._setShape()}get y(){return this._y}set y(t){this._y=t;if(this._shape)this._setShape()}get points(){return this._points}set points(t){if(!t)throw"PolygonCollider points cannot be empty";this._points=t;if(this._shape)this._setShape()}}l.ClassUtils.regClass("laya.physics.PolygonCollider",b);l.ClassUtils.regClass("Laya.PolygonCollider",b);class x extends l.Component{get joint(){if(!this._joint)this._createJoint();return this._joint}_onEnable(){this._createJoint()}_onAwake(){this._createJoint()}_createJoint(){}_onDisable(){if(this._joint){h.I._removeJoint(this._joint);this._joint=null}}}l.ClassUtils.regClass("laya.physics.joint.JointBase",x);l.ClassUtils.regClass("Laya.JointBase",x);class d extends x{constructor(){super(...arguments);this.selfAnchor=[0,0];this.otherAnchor=[0,0];this.collideConnected=false;this._length=0;this._frequency=0;this._damping=0}_createJoint(){if(!this._joint){this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=d._temp||(d._temp=new t.b2DistanceJointDef);e.bodyA=this.otherBody?this.otherBody.getBody():h.I._emptyBody;e.bodyB=this.selfBody.getBody();e.localAnchorA.Set(this.otherAnchor[0]/h.PIXEL_RATIO,this.otherAnchor[1]/h.PIXEL_RATIO);e.localAnchorB.Set(this.selfAnchor[0]/h.PIXEL_RATIO,this.selfAnchor[1]/h.PIXEL_RATIO);e.frequencyHz=this._frequency;e.dampingRatio=this._damping;e.collideConnected=this.collideConnected;var o=e.bodyA.GetWorldPoint(e.localAnchorA,new t.b2Vec2);var i=e.bodyB.GetWorldPoint(e.localAnchorB,new t.b2Vec2);e.length=this._length/h.PIXEL_RATIO||t.b2Vec2.SubVV(i,o,new t.b2Vec2).Length();this._joint=h.I._createJoint(e)}}get length(){return this._length}set length(t){this._length=t;if(this._joint)this._joint.SetLength(t/h.PIXEL_RATIO)}get frequency(){return this._frequency}set frequency(t){this._frequency=t;if(this._joint)this._joint.SetFrequency(t)}get damping(){return this._damping}set damping(t){this._damping=t;if(this._joint)this._joint.SetDampingRatio(t)}}l.ClassUtils.regClass("laya.physics.joint.DistanceJoint",d);l.ClassUtils.regClass("Laya.DistanceJoint",d);class p extends x{constructor(){super(...arguments);this.collideConnected=false;this._ratio=1}_createJoint(){if(!this._joint){if(!this.joint1)throw"Joint1 can not be empty";if(!this.joint2)throw"Joint2 can not be empty";var t=window.box2d;var e=p._temp||(p._temp=new t.b2GearJointDef);e.bodyA=this.joint1.owner.getComponent(_).getBody();e.bodyB=this.joint2.owner.getComponent(_).getBody();e.joint1=this.joint1.joint;e.joint2=this.joint2.joint;e.ratio=this._ratio;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get ratio(){return this._ratio}set ratio(t){this._ratio=t;if(this._joint)this._joint.SetRatio(t)}}l.ClassUtils.regClass("laya.physics.joint.GearJoint",p);l.ClassUtils.regClass("Laya.GearJoint",p);class c extends x{constructor(){super(...arguments);this.collideConnected=false;this._linearOffset=[0,0];this._angularOffset=0;this._maxForce=1e3;this._maxTorque=1e3;this._correctionFactor=.3}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=c._temp||(c._temp=new t.b2MotorJointDef);e.Initialize(this.otherBody.getBody(),this.selfBody.getBody());e.linearOffset=new t.b2Vec2(this._linearOffset[0]/h.PIXEL_RATIO,this._linearOffset[1]/h.PIXEL_RATIO);e.angularOffset=this._angularOffset;e.maxForce=this._maxForce;e.maxTorque=this._maxTorque;e.correctionFactor=this._correctionFactor;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get linearOffset(){return this._linearOffset}set linearOffset(t){this._linearOffset=t;if(this._joint)this._joint.SetLinearOffset(new window.box2d.b2Vec2(t[0]/h.PIXEL_RATIO,t[1]/h.PIXEL_RATIO))}get angularOffset(){return this._angularOffset}set angularOffset(t){this._angularOffset=t;if(this._joint)this._joint.SetAngularOffset(t)}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t;if(this._joint)this._joint.SetMaxForce(t)}get maxTorque(){return this._maxTorque}set maxTorque(t){this._maxTorque=t;if(this._joint)this._joint.SetMaxTorque(t)}get correctionFactor(){return this._correctionFactor}set correctionFactor(t){this._correctionFactor=t;if(this._joint)this._joint.SetCorrectionFactor(t)}}l.ClassUtils.regClass("laya.physics.joint.MotorJoint",c);l.ClassUtils.regClass("Laya.MotorJoint",c);class u extends x{constructor(){super(...arguments);this._maxForce=1e4;this._frequency=5;this._damping=.7}_onEnable(){this.owner.on(l.Event.MOUSE_DOWN,this,this.onMouseDown)}_onAwake(){}onMouseDown(){this._createJoint();l.Laya.stage.on(l.Event.MOUSE_MOVE,this,this.onMouseMove);l.Laya.stage.once(l.Event.MOUSE_UP,this,this.onStageMouseUp)}_createJoint(){if(!this._joint){this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=u._temp||(u._temp=new t.b2MouseJointDef);if(this.anchor){var o=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),false,h.I.worldRoot)}else{o=h.I.worldRoot.globalToLocal(l.Point.TEMP.setTo(l.Laya.stage.mouseX,l.Laya.stage.mouseY))}var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);e.bodyA=h.I._emptyBody;e.bodyB=this.selfBody.getBody();e.target=i;e.frequencyHz=this._frequency;e.damping=this._damping;e.maxForce=this._maxForce;this._joint=h.I._createJoint(e)}}onStageMouseUp(){l.Laya.stage.off(l.Event.MOUSE_MOVE,this,this.onMouseMove);super._onDisable()}onMouseMove(){this._joint.SetTarget(new window.box2d.b2Vec2(h.I.worldRoot.mouseX/h.PIXEL_RATIO,h.I.worldRoot.mouseY/h.PIXEL_RATIO))}_onDisable(){this.owner.off(l.Event.MOUSE_DOWN,this,this.onMouseDown);super._onDisable()}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t;if(this._joint)this._joint.SetMaxForce(t)}get frequency(){return this._frequency}set frequency(t){this._frequency=t;if(this._joint)this._joint.SetFrequency(t)}get damping(){return this._damping}set damping(t){this._damping=t;if(this._joint)this._joint.SetDampingRatio(t)}}l.ClassUtils.regClass("laya.physics.joint.MouseJoint",u);l.ClassUtils.regClass("Laya.MouseJoint",u);class y extends x{constructor(){super(...arguments);this.anchor=[0,0];this.axis=[1,0];this.collideConnected=false;this._enableMotor=false;this._motorSpeed=0;this._maxMotorForce=1e4;this._enableLimit=false;this._lowerTranslation=0;this._upperTranslation=0}_createJoint(){if(!this._joint){this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=y._temp||(y._temp=new t.b2PrismaticJointDef);var o=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),false,h.I.worldRoot);var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);e.Initialize(this.otherBody?this.otherBody.getBody():h.I._emptyBody,this.selfBody.getBody(),i,new t.b2Vec2(this.axis[0],this.axis[1]));e.enableMotor=this._enableMotor;e.motorSpeed=this._motorSpeed;e.maxMotorForce=this._maxMotorForce;e.enableLimit=this._enableLimit;e.lowerTranslation=this._lowerTranslation/h.PIXEL_RATIO;e.upperTranslation=this._upperTranslation/h.PIXEL_RATIO;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t;if(this._joint)this._joint.EnableMotor(t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t;if(this._joint)this._joint.SetMotorSpeed(t)}get maxMotorForce(){return this._maxMotorForce}set maxMotorForce(t){this._maxMotorForce=t;if(this._joint)this._joint.SetMaxMotorForce(t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t;if(this._joint)this._joint.EnableLimit(t)}get lowerTranslation(){return this._lowerTranslation}set lowerTranslation(t){this._lowerTranslation=t;if(this._joint)this._joint.SetLimits(t,this._upperTranslation)}get upperTranslation(){return this._upperTranslation}set upperTranslation(t){this._upperTranslation=t;if(this._joint)this._joint.SetLimits(this._lowerTranslation,t)}}l.ClassUtils.regClass("laya.physics.joint.PrismaticJoint",y);l.ClassUtils.regClass("Laya.PrismaticJoint",y);class m extends x{constructor(){super(...arguments);this.selfAnchor=[0,0];this.otherAnchor=[0,0];this.selfGroundPoint=[0,0];this.otherGroundPoint=[0,0];this.ratio=1.5;this.collideConnected=false}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=m._temp||(m._temp=new t.b2PulleyJointDef);var o=this.otherBody.owner.localToGlobal(l.Point.TEMP.setTo(this.otherAnchor[0],this.otherAnchor[1]),false,h.I.worldRoot);var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);var a=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.selfAnchor[0],this.selfAnchor[1]),false,h.I.worldRoot);var r=new t.b2Vec2(a.x/h.PIXEL_RATIO,a.y/h.PIXEL_RATIO);var s=this.otherBody.owner.localToGlobal(l.Point.TEMP.setTo(this.otherGroundPoint[0],this.otherGroundPoint[1]),false,h.I.worldRoot);var n=new t.b2Vec2(s.x/h.PIXEL_RATIO,s.y/h.PIXEL_RATIO);var b=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.selfGroundPoint[0],this.selfGroundPoint[1]),false,h.I.worldRoot);var x=new t.b2Vec2(b.x/h.PIXEL_RATIO,b.y/h.PIXEL_RATIO);e.Initialize(this.otherBody.getBody(),this.selfBody.getBody(),n,x,i,r,this.ratio);e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}}l.ClassUtils.regClass("laya.physics.joint.PulleyJoint",m);l.ClassUtils.regClass("Laya.PulleyJoint",m);class f extends x{constructor(){super(...arguments);this.anchor=[0,0];this.collideConnected=false;this._enableMotor=false;this._motorSpeed=0;this._maxMotorTorque=1e4;this._enableLimit=false;this._lowerAngle=0;this._upperAngle=0}_createJoint(){if(!this._joint){this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=f._temp||(f._temp=new t.b2RevoluteJointDef);var o=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),false,h.I.worldRoot);var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);e.Initialize(this.otherBody?this.otherBody.getBody():h.I._emptyBody,this.selfBody.getBody(),i);e.enableMotor=this._enableMotor;e.motorSpeed=this._motorSpeed;e.maxMotorTorque=this._maxMotorTorque;e.enableLimit=this._enableLimit;e.lowerAngle=this._lowerAngle;e.upperAngle=this._upperAngle;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t;if(this._joint)this._joint.EnableMotor(t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t;if(this._joint)this._joint.SetMotorSpeed(t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t;if(this._joint)this._joint.SetMaxMotorTorque(t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t;if(this._joint)this._joint.EnableLimit(t)}get lowerAngle(){return this._lowerAngle}set lowerAngle(t){this._lowerAngle=t;if(this._joint)this._joint.SetLimits(t,this._upperAngle)}get upperAngle(){return this._upperAngle}set upperAngle(t){this._upperAngle=t;if(this._joint)this._joint.SetLimits(this._lowerAngle,t)}}l.ClassUtils.regClass("laya.physics.joint.RevoluteJoint",f);l.ClassUtils.regClass("Laya.RevoluteJoint",f);class g extends x{constructor(){super(...arguments);this.selfAnchor=[0,0];this.otherAnchor=[0,0];this.collideConnected=false;this._maxLength=1}_createJoint(){if(!this._joint){this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=g._temp||(g._temp=new t.b2RopeJointDef);e.bodyA=this.otherBody?this.otherBody.getBody():h.I._emptyBody;e.bodyB=this.selfBody.getBody();e.localAnchorA.Set(this.otherAnchor[0]/h.PIXEL_RATIO,this.otherAnchor[1]/h.PIXEL_RATIO);e.localAnchorB.Set(this.selfAnchor[0]/h.PIXEL_RATIO,this.selfAnchor[1]/h.PIXEL_RATIO);e.maxLength=this._maxLength/h.PIXEL_RATIO;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get maxLength(){return this._maxLength}set maxLength(t){this._maxLength=t;if(this._joint)this._joint.SetMaxLength(t/h.PIXEL_RATIO)}}l.ClassUtils.regClass("laya.physics.joint.RopeJoint",g);l.ClassUtils.regClass("Laya.RopeJoint",g);class v extends x{constructor(){super(...arguments);this.anchor=[0,0];this.collideConnected=false;this._frequency=5;this._damping=.7}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=v._temp||(v._temp=new t.b2WeldJointDef);var o=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),false,h.I.worldRoot);var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);e.Initialize(this.otherBody.getBody(),this.selfBody.getBody(),i);e.frequencyHz=this._frequency;e.dampingRatio=this._damping;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get frequency(){return this._frequency}set frequency(t){this._frequency=t;if(this._joint)this._joint.SetFrequency(t)}get damping(){return this._damping}set damping(t){this._damping=t;if(this._joint)this._joint.SetDampingRatio(t)}}l.ClassUtils.regClass("laya.physics.joint.WeldJoint",v);l.ClassUtils.regClass("Laya.WeldJoint",v);class S extends x{constructor(){super(...arguments);this.anchor=[0,0];this.collideConnected=false;this.axis=[1,0];this._frequency=5;this._damping=.7;this._enableMotor=false;this._motorSpeed=0;this._maxMotorTorque=1e4}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";this.selfBody=this.selfBody||this.owner.getComponent(_);if(!this.selfBody)throw"selfBody can not be empty";var t=window.box2d;var e=S._temp||(S._temp=new t.b2WheelJointDef);var o=this.selfBody.owner.localToGlobal(l.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),false,h.I.worldRoot);var i=new t.b2Vec2(o.x/h.PIXEL_RATIO,o.y/h.PIXEL_RATIO);e.Initialize(this.otherBody.getBody(),this.selfBody.getBody(),i,new t.b2Vec2(this.axis[0],this.axis[1]));e.enableMotor=this._enableMotor;e.motorSpeed=this._motorSpeed;e.maxMotorTorque=this._maxMotorTorque;e.frequencyHz=this._frequency;e.dampingRatio=this._damping;e.collideConnected=this.collideConnected;this._joint=h.I._createJoint(e)}}get frequency(){return this._frequency}set frequency(t){this._frequency=t;if(this._joint)this._joint.SetSpringFrequencyHz(t)}get damping(){return this._damping}set damping(t){this._damping=t;if(this._joint)this._joint.SetSpringDampingRatio(t)}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t;if(this._joint)this._joint.EnableMotor(t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t;if(this._joint)this._joint.SetMotorSpeed(t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t;if(this._joint)this._joint.SetMaxMotorTorque(t)}}l.ClassUtils.regClass("laya.physics.joint.WheelJoint",S);l.ClassUtils.regClass("Laya.WheelJoint",S);t.BoxCollider=e;t.ChainCollider=o;t.CircleCollider=a;t.ColliderBase=s;t.DistanceJoint=d;t.GearJoint=p;t.IPhysics=r;t.JointBase=x;t.MotorJoint=c;t.MouseJoint=u;t.Physics=h;t.PhysicsDebugDraw=n;t.PolygonCollider=b;t.PrismaticJoint=y;t.PulleyJoint=m;t.RevoluteJoint=f;t.RigidBody=_;t.RopeJoint=g;t.WeldJoint=v;t.WheelJoint=S})(window.Laya=window.Laya||{},Laya);const a0_0x1d0a=["fontSize","onClickItem","HitAllMonster","_build_bg","_prop2","getUnlock","onClickMap","checkDir","ADRes/native_5.png","ClearTempMapData","AddTip","_get_item1","StartPointID","_ani_list","img_luck_1","image/ui/select1.png","getInstance","_ShowPath","buf","GetDevelopCD","tables/level.json","_close_fuhuo","----onClickLuckys----","ResetArray","type5_id","_content_tips_2","_count","createNativeAd","PlayBG","getJewels","_hpMax","gold","GameOver","videoID","GetAnimationByName","_newlevel_","animationName","ViewArray","_path","catch","getTowerFristId","_pool_hurt","SetMoney","RewardIndex","onClickSell","sign","key","_tab_animation","_dir","isLive","tower2_range3","createRewardedVideoAd","checkDirHanbing","_sp","onClickRankTab","_loading","_newlevel_lock_","yinsiUI","default","tables/around_map_1.json","btn_signx2","enableDebugPanel","maxLevel","----onClickOpenSign----","UpdateItemNum","kuaishou","SignRound","timer","updatePos","OpenWorldRank_around","_lucky_cur","image/ui/select_bg.png","#ffd018","LoadUserInfoData","touches","0f34cec710c74de781f667d54136d0c6","image/ui/guide_line.png","towerprice","btn_damage_timeline","fail","updateRank","closeSign","image/main/52.png","AddHp","_waveID","Difficult","tables/item.json","resType","GetUrl","_tower","expandT","_item_clampYmax","GetMap","keys","int","视频广告 load ad error:","initDiamondGifUI","load","getHp","mainLeves","image/effect/lose.png","nativeBannerUI","image/Ice/ice","tower2_range2","windowHeight","ADRes/native_2.png","_main_tips","lab_money","collection","onVVMiniGame","color","MapData","ResourceVersion","btn_develop_cd","stageY","-----------ShowRewardVideo--------","_newlevel_mask_","ATK SpeedX","SaveUserInfoData","_mesh","_content_tips_1","---showLuckyTips----","mouseThrough","_tabl_supply","GetTowerDevelopLevel","initMainLevelsEvents","rotation","onClickRankOpen","res/atlas/image/door.atlas","#3dff00","indexOf","sign6","FOCUS","checkTarget","setSign","round","GridX","GetLevelInfo","onVersionLoaded","publishVideo","lab_lucky_8","7520268","AddAllWorldInfo","Move","LevelData","_guideLine","SetWave","getSign","SendEvent","stat","stringify","updateItem","initArray","showVideoAdFail","当前关卡","getQueryString","#B9B8B5","tables/sign.json","firefire","onClickModel","SetMonsterMove","btn_develop_damage","InterstitialMaxCount","Hittedanim","base","FormateData","sub_blood","image/main/31_1.png","selectHandler","exportSceneToJson","Money","createInterstitialAd","wwwwwwwwwwwwwww","_GuideCount","alignH","removeChildAt","info","_GK3","initList","image/Ice/ice_7.png","_cur_tower_id","LoadLocalData","RadiantX","yinsi","coust1","_tick","COMPLETE","loading","image/bg.png","Develop","---onClickLevelup----","onLoad","bCanPath","_list_bullet","hideGuide","_tabl_luckyper","SelfMap","240","ShowInterstitialAd","itemVideoAd","content","getDifficult","floor","_cd","startMove","debug","bloodTick","bannerId","GetLevelUnlock","_car","ClassUtils","视频广告成功: loadAndShowVideoAd createRewardedVideoAd: success","towerlock","onConfigLoaded","onViewDofuhuo","fireindex","_hp","_mainzz","LoadAroundData","top","isCdn","release","speed","_pool_hit","alignV","lostfont","插屏广告","sound_death","GetBullet","_nextcd","scaleX","btn_diamondgift","onBuild","Button","sign_mask3","Start","SetAroundMapID","_luck_times","image/Ice/ice_19.png","----onWait----","zuanshi","tables/resource.json","_play","_timer","btn_item1","GetAroundReward","tipText","_lab","_ty","DiamondAdv","tip_unlock_tower","battle","----onClickModel----","Script","攻击力:","插屏广告展示完成","AddTower","_red2","luck8","_sign_obj","ProgressBar","level","_bg","_prop_ng2","Sign","newMainui","OpenState","obj","_left.png","AroundSelect","_tabl_level","openTowerTips","img_luck_5","vertical","add success","ShareVideoSetting","nextLevel","_1.png","fire","image/ui/pause.png","_tips_get","ice","createView","length","cost","thisObj","closeBoxPortalAd","Physics","GetGridPos","AddTipToPool","_tips_2","attack","Played","banner 广告加载成功","mapdata_","MapIdx","-------------ShowInterstitialAd--------------------","onClickSpeedup","AroundMaxSaveCount","failedSuccess","sign_mask6","onLoadAdTime","platform","PlayEf1","SetUnlock","mask","image/ui/game_pricebg_1.png","error","FrozenX","initData","interstitialAd","image/32.png","destroy","power","onLevelClick","GetTower","FailSaveDataFromTemp","onBuffTowerDown","GetTowerGridPos","cdnUrl","_guide","Loading.scene","showBoxPortalAd","res/atlas/image/effect.atlas","tower2_range1","btn_levelup","_num_item3","_winfont","_newlevel_label_","广告条发生错误，错误信息为：","imn_4","pos","onCloseFuhuo","muted","tick","OpenFriendRank_normal","next","tables/tower.json","aroundReward","Laya3D","onClickContinueGame","btn_giftclose","next_id","-------------ShowRewardVideo---viov----init---------","tczz","摩托2","onClickShareBtn","_isWait","onClickDiamondgiftHave","moreGame","tower2_range4","image/effect/success.png","ShowRewardVideo","NowMapID","get_view_name","onAroundBack","插屏 interstitialAd clicked","setDifficult","close_view","170","SetHP","damage","reward_first","image/main/a1.png","toFixed","setTowerOrderList","onClickGuide","imgUrlList","setMoney","HideGrid","_GK1","btn_back","点击广告。。。","GetMinLevel","_fuhuo","image/ui/speed.png","sign2_name","SetAttackPower","_diamond","LoadEventVideo","_lab_reward","label","moreGameId","createBoxPortalAd","daily","tipBg","image/Ice/ice_20.png","AddDiamondToPool","showToast","image/d2.png","bufflg","btn_gameover2","Box","GetFormatPos","getCloud","toString","sign4","AddGold","utilsE","hpbar","onClickGetItem","setVolume","ShowGrid","onClickSign","AroundRestart","relife","android","toweritem1","Animation","initDoor","_tab_resource","f8541db959b9418fa9c75c313c8fbc42","getLevelNumer","close_view2","GetDistance","image/d1.png","Script3D","Distance","ShowNoDiamond","_lable_num_item1","Item激励视频 广告加载成功","AddMapItem","_red","range","price","MaxLevel","_guideFrame","bold","showShareMenu",".png","left","getRandom","Point","ArrDir","全屏减速道具X","frame","_lable_num_item3","_level","testLabel","CheckTower","onClickRankOpen2","image/main/sevenPic.png","image/Ice/ice_32.png","onViewCreated","-------BattleUIControl----1111------","Release","Free x1","HidePath","Init","atack2_fire3","GetAroundMapData","choose","where","OpenRank","get","canbuild","game_towerui","SignDays","skin","ClearMonster","_towerdata","sign2","_bottom","视频广告 loaded.","DelDiamond","upanimindex","MapMonster","btn_start_lucky","AddZhuoMian","u7m3hc4gvm","isEnded","机枪塔","show","AroundGameOver","飞机1","image/Ice/ice_16.png","SetPlayed","sign_mask7","_tips_diamond","GetMoney","hitEffect","setListener","---onClickSetting----","Helvetica","FILENAME_VERSION","sqrt","_prop0","close","onClick","list","Share","getChildAt","buildTower","onOpenLuckyAdv","----------onClickDiamondGift---------------","_win","Spin Left:","btn_gifthave","ebad2f194ea649e8b27f941d08f1c3b4","_tab_effect","AddDiamond","_time","run","get_view","parent","img_luck_2","log","setSeltfMap","LoadItemVideo","导弹车","_attack_per_timer","SoundManager","Main","canBuildTowerMode",".json","image/ui/bar.png","gift_label","DelHp","onStart","getListTower","DebugPanel","success","_dstPos","GridY","openid","max","_bNeedUpdatePath","checkGuide","rank_open","getChildByName","playSound","xsi","Guide","插屏广告加载成功","supplyId","hScrollBarSkin","Browser","ShowResult","DelPropNumber","OnMonsterPass","icon_sign3","createTmp","AddEffect","#263b66","SaveMapData","onOpenCR","BuffTime","image/main/_lab","_pool_bullet","arounddiamond","onFail","_tab_item","^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    RewardVideo Success, index = ","GetAnimation","sign_mask1","icon_sign5","onInitSigeSeven","right","_guideList","---111---KuaiShou----SdkInit----","lab_lucky_2","screenMode","image/21.png","ShowNaticeBanner","a30d59b8","get_view2","_prop_bg1","onSelect","stroke","onClickParachute","updateHit","激励视频 广告显示","飞机2","---------------ShowNaticeBanner:","_img","GetMapID","bg_y","text","3_1","imn_1","push","removeSelf","AroundData","ATLAS","_down","onClickTower","View","image/Ice/ice_29.png","onClickRankSub","ad click","fixedwidth","close_view3","RecorderStop","calcTower4","guideUI","getMapTowerData","GemX","image/Ice/ice_1.png","GetItem","ui.AD.NativeBannerUI","battleUI","----------StartGame----33333----------","title","lucky","OpenFriendRank_around","onBuffTowerMove","btn_item3","adList","Death","LoadGridAd","closeGameOver","update","sceneRoot","then","luck_icon","ReCalcPath","InfoData","_tab_animationEx","res/atlas/image/monster/2.atlas","string","image/bg2.png","calcPath","_item_clampXmin","Arr","warn","around","_effect_id","image/main/35_1.png","_winlight","---initDiamondGifUI----","_list","_get_item3","canfire","onClickLevelup","baidu","PopAroundMaoData","all2","mediaRecorder","PlayWaring","buff_text","huawei","onItemAdv","录频过程中发生错误 ","_version","btn_lucky","loadScene","#858277","name","------结束录屏-----RecorderStop-------------","btn_buff","Image","_buff_tick_time","onClickOpenSign","Tween","towerTempId","btn_speed","AddBullet","ShareRand","全屏轰炸X","heidi","isGuide","videId","_choose_item","stage","_title_tips_2","JewelsAdv","main_level_view","_grid_x","_now_per","---222---KuaiShou----SdkInit----","tables/around_map_","atack_fire2","luck5","nativeAd","GetTowerData","-------BattleUIControl----3333------","setSelfMap","---onClickMap----","valign","score = ","4399","BuffCD","_red1","img_luck_4","gameover_count","^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    RewardVideo Failed","times","globalToLocal","btn_closeSign","----onClickPause----","onOpenClosefuhuo","LoadMonster","_right.png","sdtd","Stop","BrigeClassViVo SdkInit = ","closeBtnScale","#ffeda4","_name_item2","image/main/Jewels3.png","viewSelect","data","visible","中途退出不发放奖励","AtlasInfoManager","isGetLucky","setGuide","getPathPos","PARAM","_time_lab","btn_sell","HideBanner","supply","canSign","image/Ice/ice_18.png","buff_bg","canSkill","_buff_time","_pause","RandomLucky","t3u4pks711","isDestroyed","onClose","_choose_back","createChildren","SetTowerMap","btn_closeGuide","MapWave","vivo","bottom","ShowItemVideo","height","hide","mapHeight","激励视频广告显示成功","image/main/AdvTimes.png","autoStopMusic","SetLoadingProcess","image/ui/point_skule.png","count1","getRes","image/boom/plane.png","PhysicsDebugDraw","loop","JSON","MapDataInfo","视频加载完成","createUserButton","_monster","激励视频已加载","RankTabSelect","value","UIRes/heidikuang.png","boxPortalAd","plane","request","IMAGE","_guideAnim","UpdateGameTowerList","gametowers","delete","_SceneName","GetTargets","tips2_icon","Utils","sign_mask5","AddSkillCd","image/Ice/ice_8.png","_Point","_anim","lab_lucky_3","image/main/tip_bg_2.png","isPlayWarn","targetType","lucky_tips","startScene","_ui_tower","激光塔","initMainLevels","TemplateData","buffanim","SetLevelUnlock","sign_bg","numChildren","_speeda","tower_range1","GetPropNumber","tower_range3","_monsterMove","_list_hurt","acceleration","anyThis","#000000","disabled","_ice","_item_clampYmin","ADRes/native_showclose.png","bomb","btn_pause","ShowEventVideo","_lucky_obj","InterstitialID","onClickRestart2","atack2_fire1","Event","Grid2Pos",", r = ","fps","-----------------Guide:","录屏停止，录制失败","---onClickBackMenu----","image/ui/game_pricebg_2.png","kwaigameSDK","Instance","cacheAs","losefont0","_item","onClickStartLucky","DevelopMaxLevel","GetAllWorldInfo","onStop","GetBattleControl","BuffTimer","nameV","buff_id","DelMoney","SaveLocalData","MAX","image/main/Jewels2.png","kwaigame","image/ui/game_levelup_icon.png","image/main/ss.png","AdData","random","RewardID","checkNode2","tables/supply.json","hasOwnProperty","onClickBack","image/Ice/ice_6.png","LuckyFree","image/redbg.png","分享录屏成功","#ffffff","clear","Dangerous","火焰塔","ArrayAnimation","_target","addTower","first_once","广告显示发生异常","_mapID","ModeSelect","Handler","sign_mask4","_reward_type","_build_ui_2","zOrder","atack_fire1","ADRes/native_3.png","_lose","onClickBuffBtn","gridY","_timerWait","version.json","onEffect","_tab_tower","image/main/samll_round.png","level_bg","set","closeBuildUI","luck2","onClickNextMap","GetDevelopDamage","loader","code","banner广告展示完成","setGetLucky","image/37.png","_pool_gold","des","AddPropNumber","#69150e","sound/","Lucky","image/mesh.png","TempMapData","UpdateDiamond","setSize","2300001915_02","--------g.EVENT--------:","initMoney","_tabResource","_GGTS","_pool_diamond","MapID","RankSubSelect","getListMonster","image/Ice/ice_25.png","typeid","centerX","banner广告展示失败","getMoney","_item_list","login","image/ui/speedup.png","_luck_icon","Tick","onClickLucky","AddMonsterToPool","_name_item3","mapWidth","image/ui/game_tower_","PlayEf3","image/tower/","SetMapID","autoSize","_rewardimg","updatelogin","getIconRes","skewY","激励视频广告加载成功","onClickUnlockTower","SetMapIdx","Unlock","AddHurt","_tabData","attack_bloodstroke","nativeCurrentId","startPos","Loader","-------BattleUIControl----6666------","Model","_spd"," Level","formatTable","quicken_time","Label","-------BattleUIControl----2222------","huoyan","initMainUI","tables/map.json","ang",", name = image/tower/","钻石不足","img_luck_6","sound","start","----ShowNoDiamond----","bRelease","GetMapItem","scaleMode","onClickGameover, idx = ","---------onClickGetReward----------","Scene","ShowBanner","split","initHp","SetPath","create","_tab_map","tables/effect.json","_tab_bullet","SetMap","_lucy_mask","open","_lucky","errCode","pop","_mainui","image/ui/levelup1.png","image/main/4_1.png","GetMaxLevel","onClickSetting","btn_get_reward","ShowSkillCd",", id = ","index","onError","image/Ice/ice_24.png","CanAttack","initGuide","_close_get_item","_click_tower","PlaySubHp","initAnimationSignle","_list_get","spd","_game_diamond_label","lab_levelup","ADRes/native_1.png","GetDevelopMaxLevel","fushe","_buff_bg2","DelTower","image/ui/levelup.png","errMsg","off","scale","lab_level","_viewSelect","image/ui/select2.png","_buff_mask_sprite","onClickBackMenu","lab_maxLevel","image/main/4.png","nativeInterstitialUI","_mainBG","initAroundGameover","_item_speedy","setIce","_rotation","physicsDebug","onCloseGetReward","MainUI","BrigeClassViVo SdkInit fail ","blendMode","gridX","stageX","eventVideoAd","onLoadAd","GetTargetByDir","swan","onComplete","ResetPath","normal","width","onLoadLoading","btn_cd_timeline","_btn_close_tips_1","attack_bloodcolor","refresh","offset","cells","item","_grid_y","alpha","get_obj_view","getWroldUserInfo","res/atlas/image/boom.atlas","sign7","clearTemp","GetMonster","userbills","icon","anchorY","onClickGameover","nowidx",", no data update","插屏 interstitialAd closed","png","middle","openIBn","_get_item2","playMusic","image/ui/play.png","adId","TemplateAroundData","setSpeed","激励视频广告加载失败","stroke_color","pivotX","pricebg","SetPropNumber","_pool_tower","_PointID","-----AddZhuoMian-------","onClickGetLucky","onClickStartGame","onEvent","---onItemAdv----","SetTmp","AddHitToPool","buff_time_lable","tips_price","resume","GetSign","tower_range4",".mp3","maingift","byteLength","image/Ice/ice_23.png","LocalStorage","原生广告错误load ad error:","image/main/sevenPic2.png","-------BattleUIControl----7777------","luck1","res","show success","towerpricebg","luck7","isBoss","move","reportAdClick","createFrames","_plane","_buffCanClick","ClearMap","splice","videoCallbackSuccess","RecorderStart","clickMap","ShowPath","once","GetLucky","getSelfMap","_map","image/round_back.png","endPos","AddMonster","GetDiamond","coust2","---onClickRestart----","ids","---ShowResult----","type","MinLevel","time","setLucky","towerpriceicon","showGuide","CopyMapData","CLICK","videoAD","_logo","image/Ice/ice_4.png","_size","startPoint","Slimeanim","icon_sign6","banner ------22----------------广告加载成功show","_GK2","openAroundGameover","image/main/tip_bg_1.png","getItemAdv","array","pause","AddMoney","setHp","getItem","AroundCanDiamond","-------------ShowRewardVideo---show---1---------","_around","getPath","SkillCdLoad","GetTarget","showLuckyTips","GetEffect","SetMonsterMap","_diamondgift","alertGlobalError","_tabl_develop","OpenlockTower","sign_mask2","androidSdk","_id","developLevel","resetSign","GetData","setItem","attack_cd","onClickRestart","DiamondGiftCount","_p_tips_1","WebGL","musicMuted","regClass","clickTower","_btn_get_diamond","btn_gameover1","AllPath","_pool_tip","_sign","font","float","setMusicVolume","image/Ice/ice_11.png","Restart","_battle","_map_data","BombX","normal_title_container","stopMonster","initAnimation","TimeLine","AroundCanDiamond, last mapid = ","offAll","img","getLucky","image/main/33_1.png","----setLuckyTimes----","reLoadMapData","onBuffTowerUp","shift","onOpenJJ","checkNode","imn_2","image/Ice/ice_21.png","GetSupplyInfo","res/atlas/image/main.atlas","30a1727887314d7cbcd51f10aabd5e20","sell","setBar","most_level1","_close_fuhuo2","addChild","StartLoad","ClearMonsterMove","bind","RewardSuccess","_bullet","clearAll","_damage","_item_clamp","startEx","atan2","tmp","play","_type","sign3_name","----------StartGame----22222----------","buff","image/Ice/ice_28.png","_monsterID","onWait","checkCost","image/main/a2.png","rewardedVideoAd","GetMonsterMove","sdsj","tips_icon","image/loading.png","type1","anim","_ui_guide","parse","Diamond","award","--OpenFuhuo----","image/Ice/ice_12.png","checkItemTower","Data","radius","_tab_lucky","initLogin","_up.png","GetOpenId","BrigeClassViVo.closeBtnScale:","all","rankkey","LoadMapData","ShowComplete","angle","Levelup","ad data loaded: ","grideTemp","tip_share_cancel","image/main/55.png","gridAd","----onClickGetLucky----","PlayEx","score","_right","onLoadComplete","onCloseChoose","close2","click","ItemAdv","---onClickRankOpen----","videoSuccess","id2","image/Ice/ice_13.png","_tx","guide","isRelease","towerOrderList","_btn_close_diamond","videoCallbackFail","返回 null 时表示当前 APP 版本不支持录屏","ArrPos","#4f4f4f","5ab3c861b01a47b7ae7822198934df62","targetEffect","reward","luck6","onClickContinue","checkBuildUI","ShowVideo","image/ui/load","getPrice","NormalIndex","setSkin","_bar","center","_tabl_aroundmap","SdkInit","_reward_count","InterstitialCount","-------------ShowRewardVideo---show------------","cos","GetTargers2","setSoundVolume","anchorX","abs","_tab_sign","----onClickSpeedup----","_item_speedx","激励视频广告显示失败","mapData","CheckLevelup","7520270","createBannerAd","getLevelKey","window","selectnow","DebugMode","doc","Play","_title_tips_1","SetAttackSpeed","AnimationComplete","_build_ui","getModel","btn_continue","_backMain","drawPie","AddGoldToPool","_loadingNumber","2300001915_01","---checkBuildUI----","onKeyUp","AddMinLevel","animation","StartGame","scaleY","add","updateTowerList","image/main/55_1.png","backOut","_list_tower","img_luck_7","_curGuideIdx","_status","_bInit","image/main/31.png","soundMuted","Loading","atack_fire3","_idx","分享录屏失败: ","enable","ggmgr","centerY","sign6_name","_tab_monster","_dstGrid","_normal","stop","door2","showLine","GetNormaMaxlLevel","loadNativeAd loadNativeAd : complete","LevelUnlock","loadNativeAd loadNativeAd : success","sound_move","_drop_timer","image/Ice/ice_9.png","_p_tips_2","SaveAroundData","_icon_item3","_distance","OpenFuhuo","_bottom_bg2","ADRes/native_6.png","Item","build","_attack_power","btn_close_lucky","lab_lucky_5","BannerAd 广告  onload success","number","xsv","soundmanager","updateMainLevels","tower_range2","COUNT","视频播放发生错误，错误信息为：","getSystemInfoSync","LoadInterstitialAd","Prop","mainBG","_air","setLuckyTimes","AppID","type5","Stat","getDir","RewardFailed","闪电塔","暂无视频","timeline","bannerAd","towerTemp","tables/monster.json","插屏广告加载失败","update success","testx9dtjwj8hp","isDebug","tables/turntable.json","image/ui/hpbar.png","IsShowVideo","image/Ice/ice_17.png","_prop_diamond_0","sign1","nativeCurrentIndex","calcTower1","------------onLoadAd----------VivoSdk.nativeCurrentIndex---","most_level2","image/effect/3_","addUnlock","reset","LuckyClickTest","around_gameover","AddTowerDevelopDamageLevel","---------onEvent------------","_btn_fuhuo","----------StartGame----11111----------","ui.LoadingUI","checkDir2","onClickGetReward","MOUSE_DOWN","d35cc851964f4e07b6c4a38232c2fdcf","icon_sign1","size","viewsize","image/main/tower_sign.png","ShowNaticeInterstitial","graphics","getMonsters","_waveCD","shareBtn","unlock","--------onClickDiamondgiftHave----------","UpdateWorldInfo","lab_lucky_1","GetResource","_user","_setting","_pool_effect","_main_locktip","application/json","CheckChange","sign4_name","_data","onClickRankClose","initGameTowerList","----------StartGame---44444----------","_tmpPos","Unknow","selectEnable","tables/bullet.json","onShow","_close_tips","bgres","diamond","count","LastLoginTimer","image/tower/buildtower_","_btn_close_tips_2","AddHit","_item_clampXmax","---ShowSkillCd----","image/Ice/ice_30.png","LoadBannerAd","substr","toweriicon","lock","safeArea","res/atlas/image/monster/8.atlas","onHit","MapTower","-------BattleUIControl----5555------","avatarUrl","GetTimeString","btn_restart","---GetOpenId----","btn_signx1","TowerSelect","image/ui/game_itembg_2.png","gray","onClickPause","_cd_time","GaiLv","_nextMap","tables/animation.json","getTime","fileconfig.json","_prop_diamond_1","image/main/33.png","uiView","_attack_cd_per","towerDamage","_tipContainer","Event激励视频 广告加载成功","onOpenAdvNo","resList","------onClickShareBtn----:","bannerAd广告错误:","TempNormalMapData","normal#","around_title_container","SignClickTest","TemplateMapData","icon_sign4","ReleaseEx","btn_item2","Sprite","down","sort","---onOpenCR----","effect","CopyNomarlMapData","LoadRewardVideo","image/ui/point_kuang.png","onShareAppMessage","插屏onLoad data ","atack2_fire2","插屏 interstitialAd onError ","changeMap","btn_setting","setNeedUpdatePath","addChildAt","_pathTmp","RecorderShare","getDate","boss","image/effect/fire_","levelup","init","calcDir","strokeColor","_ani","interval","_sprite","onBuffTowerOut","AddMaxLevel","URL","dic","BannerID","#fee47e","unshift","url","death","ceil","luck3","lab_lucky_4","_list_monster","_index","lucky_loop","EVENT","none","MOUSE_MOVE","_speed","_pool_monster","updateTip","pivotY","ani"];(function(e,t){const o=function(t){while(--t){e["push"](e["shift"]())}};o(++t)})(a0_0x1d0a,172);const a0_0x1b8a=function(t,e){t=t-0;let o=a0_0x1d0a[t];return o};console[a0_0x1b8a("0x14e")]=console["info"]=console[a0_0x1b8a("0x1c4")]=console[a0_0x1b8a("0x87")]=function(){};window[a0_0x1b8a("0x5ce")]=Laya[a0_0x1b8a("0xf4")];window[a0_0x1b8a("0xe2")]=Laya[a0_0x1b8a("0x51")];window["Laya2"]=Laya["Pool"];!function(){"use strict";class t{constructor(){}static[a0_0x1b8a("0x557")](){Laya["ClassUtils"][a0_0x1b8a("0x3e3")]}}t[a0_0x1b8a("0x357")]=640,t[a0_0x1b8a("0x22f")]=1136,t[a0_0x1b8a("0x30c")]=a0_0x1b8a("0x1a2"),t[a0_0x1b8a("0x185")]=a0_0x1b8a("0x65"),t["alignV"]=a0_0x1b8a("0x370"),t[a0_0x1b8a("0x2")]=a0_0x1b8a("0x462"),t[a0_0x1b8a("0x25b")]=a0_0x1b8a("0x95"),t[a0_0x1b8a("0x1b8")]="",t["debug"]=!1,t[a0_0x1b8a("0x609")]=!1,t[a0_0x1b8a("0x349")]=!1,t[a0_0x1b8a("0x61d")]=!0,t[a0_0x1b8a("0x557")]();var e,r=Laya[a0_0x1b8a("0x26")][a0_0x1b8a("0x3e3")];!function(t){!function(t){class e extends Laya[a0_0x1b8a("0x19e")]{constructor(){super()}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")](),this[a0_0x1b8a("0x6e")](e[a0_0x1b8a("0x530")])}}e[a0_0x1b8a("0x530")]={type:a0_0x1b8a("0x19e"),props:{width:640,top:0,right:0,mouseThrough:!0,left:0,height:1130,bottom:0},compId:2,child:[{type:"Box",props:{x:0,width:638,height:170,bottom:0},compId:4,child:[{type:a0_0x1b8a("0x1de"),props:{width:640,var:"bj",top:1,skin:"ADRes/native_2.png",left:-2,height:168},compId:3},{type:a0_0x1b8a("0x1de"),props:{var:"ad",skin:a0_0x1b8a("0x333"),right:0,bottom:0},compId:5},{type:a0_0x1b8a("0x1de"),props:{y:18.5,x:37,width:89,var:a0_0x1b8a("0x369"),height:89},compId:6},{type:"Label",props:{y:18.5,x:176,width:384,var:"title",text:a0_0x1b8a("0x0"),height:35,fontSize:30,align:a0_0x1b8a("0x102")},compId:8},{type:a0_0x1b8a("0x2fe"),props:{y:52.5,x:176,width:422,var:a0_0x1b8a("0x2c5"),valign:a0_0x1b8a("0x370"),text:a0_0x1b8a("0xd1"),height:71,fontSize:20,color:a0_0x1b8a("0x455")},compId:9},{type:a0_0x1b8a("0x541"),props:{y:1,x:596.5,texture:a0_0x1b8a("0x270")},compId:11},{type:a0_0x1b8a("0x3d"),props:{y:21,x:615,width:33,var:a0_0x1b8a("0x446"),stateNum:1,skin:a0_0x1b8a("0x2b0"),pivotY:17,pivotX:17,height:33},compId:10}]}],loadList:["ADRes/native_2.png",a0_0x1b8a("0x333"),a0_0x1b8a("0x270"),a0_0x1b8a("0x2b0")],loadList3D:[]},t["NativeBannerUI"]=e,r(a0_0x1b8a("0x1ab"),e);class o extends Laya[a0_0x1b8a("0x19e")]{constructor(){super()}["createChildren"](){super[a0_0x1b8a("0x228")](),this[a0_0x1b8a("0x6e")](o[a0_0x1b8a("0x530")])}}o["uiView"]={type:a0_0x1b8a("0x19e"),props:{width:640,top:0,right:0,left:0,height:1130,bottom:0},compId:2,child:[{type:a0_0x1b8a("0x1de"),props:{width:640,var:a0_0x1b8a("0x1e7"),top:0,skin:a0_0x1b8a("0x244"),left:0,height:1130},compId:13},{type:"Box",props:{y:354,x:40,width:560,height:400},compId:4,child:[{type:a0_0x1b8a("0x1de"),props:{var:"bj",top:0,skin:a0_0x1b8a("0x5dd"),right:0,left:0,bottom:0},compId:3},{type:a0_0x1b8a("0x1de"),props:{var:"ad",skin:a0_0x1b8a("0x333"),right:0,bottom:0},compId:5},{type:a0_0x1b8a("0x1de"),props:{y:188,x:27,width:120,var:"icon",height:120},compId:6},{type:"Sprite",props:{y:8,x:513,texture:"ADRes/native_showclose.png"},compId:14},{type:a0_0x1b8a("0x3d"),props:{y:27,x:533,width:35,var:a0_0x1b8a("0x446"),stateNum:1,skin:"ADRes/native_3.png",pivotY:18,pivotX:18,height:35},compId:10},{type:a0_0x1b8a("0x1de"),props:{y:308,x:0,width:638,visible:!1,skin:a0_0x1b8a("0x4b2"),height:92},compId:11},{type:"Image",props:{y:271,x:447,skin:a0_0x1b8a("0x57c")},compId:12},{type:a0_0x1b8a("0x2fe"),props:{y:353,x:27,width:529,var:a0_0x1b8a("0x2c5"),valign:"middle",height:43,fontSize:20,color:a0_0x1b8a("0x26c")},compId:9},{type:"Label",props:{y:311,x:27,width:516,var:a0_0x1b8a("0x1ae"),valign:a0_0x1b8a("0x370"),height:35,fontSize:20,color:"#696969",align:"left"},compId:8}]}],loadList:["UIRes/heidikuang.png","ADRes/native_2.png",a0_0x1b8a("0x333"),a0_0x1b8a("0x270"),a0_0x1b8a("0x2b0"),a0_0x1b8a("0x4b2"),a0_0x1b8a("0x57c")],loadList3D:[]},t["NativeInsertUI"]=o,r("ui.AD.NativeInsertUI",o)}(t["AD"]||(t["AD"]={}))}(e||(e={})),function(t){class e extends Laya[a0_0x1b8a("0x30f")]{constructor(){super()}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")]();setTimeout(()=>{this["loadScene"](a0_0x1b8a("0x4f"))},100)}}t[a0_0x1b8a("0x1ac")]=e,r("ui.battleUI",e);class o extends Laya["Scene"]{constructor(){super()}[a0_0x1b8a("0x228")](){super["createChildren"](),this[a0_0x1b8a("0x1d9")](a0_0x1b8a("0x497"))}}t["LoadingUI"]=o,r(a0_0x1b8a("0x4e8"),o);class i extends Laya[a0_0x1b8a("0x30f")]{constructor(){super()}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")](),this[a0_0x1b8a("0x1d9")](a0_0x1b8a("0x154"))}}t[a0_0x1b8a("0x34b")]=i,r("ui.MainUI",i);class a extends Laya[a0_0x1b8a("0x30f")]{constructor(){super()}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")](),this[a0_0x1b8a("0x1d9")](a0_0x1b8a("0xb"))}}t[a0_0x1b8a("0x5ad")]=a,r("ui.yinsiUI",a)}(e||(e={}));class _{constructor(){this[a0_0x1b8a("0x315")]={},this["_tab_monster"]={},this[a0_0x1b8a("0xee")]={},this[a0_0x1b8a("0x2b7")]={},this[a0_0x1b8a("0x317")]={},this[a0_0x1b8a("0x147")]={},this["_tab_animation"]={},this[a0_0x1b8a("0x1bd")]={},this[a0_0x1b8a("0x430")]={},this[a0_0x1b8a("0x46d")]={},this[a0_0x1b8a("0x17b")]={},this["_tabl_luckyper"]=[],this[a0_0x1b8a("0x62")]={},this["_tabl_develop"]={},this[a0_0x1b8a("0x5ef")]={},this[a0_0x1b8a("0x463")]=[]}[a0_0x1b8a("0x389")](t){return this[a0_0x1b8a("0x46d")][t]?this["_tab_sign"][t]:null}[a0_0x1b8a("0x367")](t){return this[a0_0x1b8a("0x49f")][t]?this[a0_0x1b8a("0x49f")][t]:null}[a0_0x1b8a("0x4fa")](t){return this[a0_0x1b8a("0xee")][t]?this[a0_0x1b8a("0xee")][t]:null}[a0_0x1b8a("0x8f")](t){return this[a0_0x1b8a("0x2b7")][t]?this[a0_0x1b8a("0x2b7")][t]:null}[a0_0x1b8a("0x1f6")](){return this[a0_0x1b8a("0x2b7")]}[a0_0x1b8a("0x3d0")](t){return this[a0_0x1b8a("0x147")][t]?this[a0_0x1b8a("0x147")][t]:null}[a0_0x1b8a("0x38")](t){return this[a0_0x1b8a("0x317")][t]?this[a0_0x1b8a("0x317")][t]:null}[a0_0x1b8a("0x17d")](t){return this[a0_0x1b8a("0x5a3")][t]?this["_tab_animation"][t]:null}[a0_0x1b8a("0x596")](t){return this[a0_0x1b8a("0x1bd")][t]?this[a0_0x1b8a("0x1bd")][t]:null}[a0_0x1b8a("0x3a5")](t){return this[a0_0x1b8a("0x430")][t]?this[a0_0x1b8a("0x430")][t]:null}[a0_0x1b8a("0x1aa")](t){return this["_tab_item"][t]?this["_tab_item"][t]:null}["GetLuckyPer"](){if(0==this["_tabl_luckyper"][a0_0x1b8a("0x6f")]){var e=0;for(let t=1;t<9;t++)e+=this[a0_0x1b8a("0x430")][t]["probability"],this[a0_0x1b8a("0x17")][a0_0x1b8a("0x198")]({key:t,value:e})}return this[a0_0x1b8a("0x17")]}["GetLevelInfo"](t){return this["_tabl_level"][t]?this[a0_0x1b8a("0x62")][t]:null}["GetDevelopDamage"](e,o){if(0==o)return{value:0,price:0};if(o>d[a0_0x1b8a("0x286")])return{value:-1,price:-1};for(let t in this[a0_0x1b8a("0x3d4")])if(this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x44b")]==e&&this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x59")]==o)return{value:this["_tabl_develop"][t]["power"]?this["_tabl_develop"][t]["power"]:0,price:this["_tabl_develop"][t]["coust1"]?this["_tabl_develop"][t][a0_0x1b8a("0xc")]:0};return null}[a0_0x1b8a("0x587")](e,o){if(0==o)return{value:0,price:0};if(o>d[a0_0x1b8a("0x286")])return{value:-1,price:-1};for(let t in this[a0_0x1b8a("0x3d4")])if(this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x44b")]==e&&this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x59")]==o)return{value:this["_tabl_develop"][t][a0_0x1b8a("0x3dd")],price:this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x3ac")]?this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x3ac")]:0};return null}[a0_0x1b8a("0x334")](e){for(let t in this["_tabl_develop"])if(this["_tabl_develop"][t]["id2"]==e&&this["_tabl_develop"][t][a0_0x1b8a("0x44b")]==e)return{damage:this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x408")],cd:this[a0_0x1b8a("0x3d4")][t][a0_0x1b8a("0x4de")]};return null}["GetSupplyInfo"](){return{reward:this["_tabl_supply"][1][a0_0x1b8a("0x42a")],time:this[a0_0x1b8a("0x5ef")][1][a0_0x1b8a("0x202")]}}[a0_0x1b8a("0x114")](){this[a0_0x1b8a("0x315")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x302")),this[a0_0x1b8a("0x49f")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x4d0")),this[a0_0x1b8a("0xee")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x45")),this[a0_0x1b8a("0x317")]=this["formatTable"](a0_0x1b8a("0x509")),this["_tab_tower"]=this[a0_0x1b8a("0x2fc")]("tables/tower.json"),this[a0_0x1b8a("0x147")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x316")),this[a0_0x1b8a("0x5a3")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x52b")),this[a0_0x1b8a("0x430")]=this["formatTable"]("tables/turntable.json"),this[a0_0x1b8a("0x46d")]=this["formatTable"](a0_0x1b8a("0x611")),this["_tab_item"]=this[a0_0x1b8a("0x2fc")]("tables/item.json"),this[a0_0x1b8a("0x62")]=this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x588")),this["_tabl_supply"]=this[a0_0x1b8a("0x2fc")]("tables/supply.json");for(var t=0;t<1;++t)this[a0_0x1b8a("0x463")][a0_0x1b8a("0x198")](this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x1f2")+(t+1)[a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x156")));this[a0_0x1b8a("0x171")]()}[a0_0x1b8a("0x171")](){for(let e in this[a0_0x1b8a("0x5a3")]){let t=this["_tab_animation"][e];this[a0_0x1b8a("0x1bd")][t[a0_0x1b8a("0x1db")]]=t}}[a0_0x1b8a("0x2fc")](t){for(var e=Laya[a0_0x1b8a("0x2bf")][a0_0x1b8a("0x238")](t),o=e[0],i={},a=2;a<e["length"];a++){let r=e[a],s={};for(var n in r){if(a0_0x1b8a("0x5d2")!=o[n]&&a0_0x1b8a("0x3eb")!=o[n]||(s[n]=Number(r[n])),a0_0x1b8a("0x1bf")==o[n]&&(s[n]=r[n]),"array"==o[n]){s[n]=[];let t=r[n][a0_0x1b8a("0x311")]("|");for(var b=0;b<t[a0_0x1b8a("0x6f")];b++){let o=t[b][a0_0x1b8a("0x311")](",");{let e=[];for(let t=0;t<o[a0_0x1b8a("0x6f")];t++)e[a0_0x1b8a("0x198")](Number(o[t]));s[n][a0_0x1b8a("0x198")](e)}}}if(a0_0x1b8a("0x13d")==o[n]){s[n]=[];let e,o,t=r[n][a0_0x1b8a("0x311")]("&"),i=[],a=[];for(b=0;b<t[a0_0x1b8a("0x6f")];b++){e=t[b][a0_0x1b8a("0x311")]("|"),a=[];for(let t=0;t<e[a0_0x1b8a("0x6f")];t++){o=e[t][a0_0x1b8a("0x311")](","),i=[];for(let t=0;t<o[a0_0x1b8a("0x6f")];t++)i[a0_0x1b8a("0x198")](Number(o[t]));a[a0_0x1b8a("0x198")](i)}s[n][a0_0x1b8a("0x198")](a)}}}i[s["id"]]=s}return i}[a0_0x1b8a("0x5d0")](t){if(d[a0_0x1b8a("0x4d4")]&&t>=d["maxLevel"])return null;if(0==d[a0_0x1b8a("0x2a9")]){if(this[a0_0x1b8a("0x315")][t])return this[a0_0x1b8a("0x2fc")](a0_0x1b8a("0x302"))[t]}else{var e=t%(Object["keys"](this["_tabl_aroundmap"][d["AroundSelect"]])[a0_0x1b8a("0x6f")]+1);if(this["_tabl_aroundmap"][d[a0_0x1b8a("0x61")]][e])return this[a0_0x1b8a("0x463")][d["AroundSelect"]][e]}return null}["GetAroundReward"](t,e){this[a0_0x1b8a("0x463")][d[a0_0x1b8a("0x61")]];for(var o=0,i=t;i<e;++i)2==this[a0_0x1b8a("0x463")][d[a0_0x1b8a("0x61")]][i]["reward_first"][0][0]&&(o+=this["_tabl_aroundmap"][d[a0_0x1b8a("0x61")]][i][a0_0x1b8a("0xbe")][0][1]);return o}}_[a0_0x1b8a("0x281")]=new _;class o{["Play"](t=1){let e=new Laya[a0_0x1b8a("0xdc")],o=new Laya[a0_0x1b8a("0x1de")],i=new Laya[a0_0x1b8a("0x2fe")];e[a0_0x1b8a("0x572")]=o[a0_0x1b8a("0x572")]=i["pivotY"]=.5,e["pivotX"]=o[a0_0x1b8a("0x37a")]=i[a0_0x1b8a("0x37a")]=.5,o[a0_0x1b8a("0x11e")]="image/ui/blood.png",i["align"]=a0_0x1b8a("0x462"),i[a0_0x1b8a("0x1fa")]=a0_0x1b8a("0x370"),i[a0_0x1b8a("0x574")]=30,i[a0_0x1b8a("0x195")]="-"+t,i["color"]=a0_0x1b8a("0x29f"),e[a0_0x1b8a("0x40a")](o),e[a0_0x1b8a("0x40a")](i),o[a0_0x1b8a("0x2d9")]=-30,o[a0_0x1b8a("0x49d")]=0,i[a0_0x1b8a("0x2d9")]=30,i[a0_0x1b8a("0x49d")]=0,e["centerY"]=0,e[a0_0x1b8a("0x2d9")]=0,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](e),Laya[a0_0x1b8a("0x1e1")]["to"](e,{centerY:-30},500,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya["Tween"]["to"](e,{alpha:0},300,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){e["removeSelf"]()}))}))}}o[a0_0x1b8a("0x281")]=new o;class h{constructor(){this[a0_0x1b8a("0x25f")]={LastLoginTimer:{type:1,default:0,delete:!1,daily:!1},Sound:{type:1,default:1,delete:!1,daily:!1},LastTimer:{type:1,default:0,delete:!1,daily:!1},Guide:{type:1,default:0,delete:!1,daily:!1},Diamond:{type:1,default:0,delete:!1,daily:!1},Model:{type:1,default:1,delete:!1,daily:!1},Lucky:{type:1,default:0,delete:!1,daily:!0},GetLucky:{type:1,default:4,delete:!1,daily:!0},canSign:{type:1,default:1,delete:!1,daily:!0},SignDays:{type:1,default:0,delete:!1,daily:!1},SignRound:{type:1,default:0,delete:!1,daily:!1},Difficult:{type:1,default:1,delete:!1,daily:!1},SelfMap:{type:1,default:0,delete:!1,daily:!1},Unlock:{type:4,default:{},delete:!1,daily:!1},Prop:{type:1,default:{},delete:!1,daily:!1},Item:{type:3,default:{},delete:!1,daily:!1},ItemAdv:{type:1,default:3,delete:!1,daily:!0},JewelsAdv:{type:1,default:5,delete:!1,daily:!0},BuffTimer:{type:1,default:0,delete:!1,daily:!1},DiamondAdv:{type:1,default:0,delete:!1,daily:!0},LevelUnlock:{type:1,default:{0:"1"},delete:!1,daily:!1},LuckyFree:{type:1,default:1,delete:!1,daily:!0}},this[a0_0x1b8a("0x53d")]={ID:{type:1,default:1,delete:!1,daily:!1},MapTower:{type:3,default:{},delete:!1,daily:!1},MapMonster:{type:3,default:[],delete:!1,daily:!1},Hp:{type:1,default:-1,delete:!1,daily:!1},MapID:{type:1,default:1,delete:!1,daily:!1},MapWave:{type:1,default:0,delete:!1,daily:!1},MapIdx:{type:1,default:0,delete:!1,daily:!1},Money:{type:1,default:-1,delete:!1,daily:!1}},this[a0_0x1b8a("0x376")]={ModeUnlock:{type:0,default:0,delete:!1,daily:!1},Unlock:{type:3,default:{},delete:!1,daily:!1},Develop:{type:1,default:{},delete:!1,daily:!1},MaxLevel:{type:3,default:{},delete:!1,daily:!1},MinLevel:{type:3,default:{},delete:!1,daily:!1},MapData:{type:3,default:[],delete:!1,daily:!1},Played:{type:3,default:{},delete:!1,daily:!1}},this[a0_0x1b8a("0x42e")]={},this["LevelData"]=[],this[a0_0x1b8a("0x471")]={},this[a0_0x1b8a("0x1bc")]={},this[a0_0x1b8a("0x19a")]={},this[a0_0x1b8a("0x2cb")]=null,this[a0_0x1b8a("0x539")]=null}[a0_0x1b8a("0x57d")](){this[a0_0x1b8a("0x2cb")]=null}["GetPropNumber"](t){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4c2")][""+t]?this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4c2")][""+t]:0}[a0_0x1b8a("0x2c6")](t,e,o){let i=this[a0_0x1b8a("0x266")](t);i+=e,null!=_["Instance"][a0_0x1b8a("0x1aa")](o)[a0_0x1b8a("0x161")]&&i>=_[a0_0x1b8a("0x281")]["GetItem"](o)["max"]&&(i=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x1aa")](o)[a0_0x1b8a("0x161")]),this[a0_0x1b8a("0x37c")](t,i),this["SaveLocalData"]()}[a0_0x1b8a("0x16e")](t){let e=this[a0_0x1b8a("0x266")](t);return e<=0?!!d[a0_0x1b8a("0x4d4")]&&(this[a0_0x1b8a("0x2c6")](1,5,4),this[a0_0x1b8a("0x2c6")](2,5,2),this["AddPropNumber"](3,5,3),e=this[a0_0x1b8a("0x266")](t),!1):(this[a0_0x1b8a("0x37c")](t,e-1),!0)}[a0_0x1b8a("0x37c")](t,e){this["Data"][a0_0x1b8a("0x4c2")][""+t]=e,I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x5b4")](t),this["SaveLocalData"]()}[a0_0x1b8a("0x3ab")](){return null==this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x429")]&&(this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x429")]=0),this[a0_0x1b8a("0x42e")]["Diamond"]}[a0_0x1b8a("0x124")](t){return this[a0_0x1b8a("0x42e")]["Diamond"]<t?(I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["ShowNoDiamond"](),!1):(this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x429")]-=t,I["Instance"][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x2cc")](),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x48d")](),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x5b4")](),this[a0_0x1b8a("0x28e")](),!0)}[a0_0x1b8a("0x148")](t){this["Data"][a0_0x1b8a("0x429")]+=t,I[a0_0x1b8a("0x281")]["GetBattleControl"]()[a0_0x1b8a("0x2cc")](),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x48d")](),I[a0_0x1b8a("0x281")]["GetBattleControl"]()["UpdateItemNum"](),this["SaveLocalData"]()}["addUnlock"](t){this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x2f1")][t+""]=1,this["SaveLocalData"]()}[a0_0x1b8a("0x579")](t){return!!this["Data"]["Unlock"][t+""]}[a0_0x1b8a("0x3c3")](){return!0}[a0_0x1b8a("0x591")](){return this[a0_0x1b8a("0x42e")]["JewelsAdv"]>0&&(this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x1ed")]--,this[a0_0x1b8a("0x28e")](),!0)}["getDiamondAdv"](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4d")]<d[a0_0x1b8a("0x3df")]}[a0_0x1b8a("0x1d")](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x5c9")]}[a0_0x1b8a("0xb9")](){this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x5c9")]<3&&this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x5c9")]++}[a0_0x1b8a("0x1a7")](){return 0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")]:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this["AroundData"]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["MapTower"]}["isNewGame"](){return 1==this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapID"]&&0==this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapWave"]&&0==this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x7b")]}[a0_0x1b8a("0x3a6")](){return d[a0_0x1b8a("0x45f")]}[a0_0x1b8a("0x1f8")](t){0==d[a0_0x1b8a("0x2a9")]&&(d["NormalIndex"]=t)}[a0_0x1b8a("0xf9")](t,e){this[a0_0x1b8a("0x42e")]["Item"][t+""]?this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4b3")][t+""]+=e:this["Data"]["Item"][t+""]=e,this[a0_0x1b8a("0x28e")]()}[a0_0x1b8a("0x30b")](t){return this[a0_0x1b8a("0x42e")]["Item"][t+""]?this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4b3")][t+""]:0}["SetUnlock"](){let o=_["Instance"]["GetTowerData"]();for(let e in o){let t=o[e];1==t[a0_0x1b8a("0x618")]&&null!=t["icon"]&&(t[a0_0x1b8a("0x4f6")]>=0&&this["GetNormaMaxlLevel"]()>t[a0_0x1b8a("0x4f6")]&&(this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x2f1")][""+e]=1))}}[a0_0x1b8a("0x261")](t){this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4a7")][t]||(this["Data"]["LevelUnlock"][t]=1,this["SaveLocalData"]())}[a0_0x1b8a("0x24")](t){return this["Data"]["LevelUnlock"][t]||(this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4a7")][t]=0,this[a0_0x1b8a("0x28e")]()),this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x4a7")][t]}[a0_0x1b8a("0x4a5")](){for(var t=this[a0_0x1b8a("0x604")][0]["MapID"],e=1;e<4;++e)this[a0_0x1b8a("0x24")](e)&&this[a0_0x1b8a("0x604")][e]["MapID"]>t&&(t=this[a0_0x1b8a("0x604")][e][a0_0x1b8a("0x2d4")]);return t}[a0_0x1b8a("0x546")](){this["TempNormalMapData"]=this[a0_0x1b8a("0x3b6")]({data:this["LevelData"][d[a0_0x1b8a("0x45f")]]})}[a0_0x1b8a("0x2e8")](t){0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]=t:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]]["length"]-1][a0_0x1b8a("0x211")]["MapID"]=t,this["SetUnlock"]()}[a0_0x1b8a("0x193")](){return 0==d[a0_0x1b8a("0x2a9")]?this["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x2d4")]}[a0_0x1b8a("0x606")](t){0==d[a0_0x1b8a("0x2a9")]?this["LevelData"][d["NormalIndex"]][a0_0x1b8a("0x22b")]=t:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]]["length"]-1][a0_0x1b8a("0x211")]["MapWave"]=t}[a0_0x1b8a("0x2f0")](t){0==d["ModeSelect"]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x7b")]=t:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x7b")]=t}[a0_0x1b8a("0x5d6")](){return 0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["Hp"]:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["Hp"]}[a0_0x1b8a("0x3c7")](t){0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["Hp"]=t:this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1]["data"]["Hp"]=t}[a0_0x1b8a("0x159")](t){return 0==d[a0_0x1b8a("0x2a9")]?(this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["Hp"]-=t,o[a0_0x1b8a("0x281")][a0_0x1b8a("0x47a")](t),this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["Hp"]):(this["AroundData"]["MapData"][d["AroundSelect"]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["Hp"]-=t,o[a0_0x1b8a("0x281")][a0_0x1b8a("0x47a")](t),this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["Hp"])}[a0_0x1b8a("0x5c7")](t){return 0==d[a0_0x1b8a("0x2a9")]?(this["LevelData"][d["NormalIndex"]]["Hp"]+=t,this["LevelData"][d["NormalIndex"]]["Hp"]):(this[a0_0x1b8a("0x19a")]["MapData"][d["AroundSelect"]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["Hp"]+=t,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")]["Hp"])}[a0_0x1b8a("0xc4")](t){d[a0_0x1b8a("0x4d4")]&&t>0&&(t*=10),0==d[a0_0x1b8a("0x2a9")]?(this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x61e")]+=t,this[a0_0x1b8a("0x174")]()):(this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]]["length"]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x61e")]+=t,this["SaveAroundData"]())}[a0_0x1b8a("0x2db")](){return 0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x61e")]:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this["AroundData"][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x61e")]}[a0_0x1b8a("0x114")](){this[a0_0x1b8a("0x9")](),this[a0_0x1b8a("0x437")](this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x2f9")]),this[a0_0x1b8a("0x5bd")](),this[a0_0x1b8a("0x2e")]()}[a0_0x1b8a("0x3fc")](){this[a0_0x1b8a("0x437")](this[a0_0x1b8a("0x42e")]["Model"])}[a0_0x1b8a("0x39e")](){0==d["ModeSelect"]?(this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapMonster"]=[],this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")]={}):(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d["AroundSelect"]]["length"]-1][a0_0x1b8a("0x211")]["MapMonster"]=[],this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this["AroundData"]["MapData"][d[a0_0x1b8a("0x61")]]["length"]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")]={})}[a0_0x1b8a("0x229")](t,e,o){0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")][t+"_"+e]=o:this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")][t+"_"+e]=o}[a0_0x1b8a("0x3d1")](t,e,o,i){0==d["ModeSelect"]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapMonster"][a0_0x1b8a("0x198")]({x:t,y:e,id:o,hp:i}):this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x126")]["push"]({x:t,y:e,id:o,hp:i})}["ClearMonster"](){0==d[a0_0x1b8a("0x2a9")]?this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x126")]=[]:this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x126")]=[]}[a0_0x1b8a("0x2e")](){var t=Laya["LocalStorage"][a0_0x1b8a("0x3c8")](d["key"]+a0_0x1b8a("0x3cb"));for(var e in null!=t&&t[a0_0x1b8a("0x6f")]>0&&(this["AroundData"]=JSON["parse"](t)),this[a0_0x1b8a("0x376")]){var o=this[a0_0x1b8a("0x376")][e];1==o[a0_0x1b8a("0x24c")]?delete this["AroundData"][e]:0==this["AroundData"][a0_0x1b8a("0x299")](e)&&(this["AroundData"][e]=o[a0_0x1b8a("0x5ae")])}if(0==this["AroundData"][a0_0x1b8a("0x5e3")]["length"])for(var i=0;i<3;++i)this[a0_0x1b8a("0x19a")]["MapData"][i]||(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][i]=[],this["AroundData"][a0_0x1b8a("0x5e3")][i][a0_0x1b8a("0x198")]({id:1,data:{ID:0,MapTower:{},MapMonster:[],Hp:_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](100+i)["hp"],MapID:1,MapWave:1,Money:20}}))}[a0_0x1b8a("0x4ad")](){var t=JSON[a0_0x1b8a("0x60a")](this[a0_0x1b8a("0x19a")]),e=d[a0_0x1b8a("0x5a2")]+a0_0x1b8a("0x3cb");Laya[a0_0x1b8a("0x38f")][a0_0x1b8a("0x3dc")](e,t)}[a0_0x1b8a("0x5f0")](t){var e=d[a0_0x1b8a("0x59c")](t);return this[a0_0x1b8a("0x19a")]["Develop"][e]||(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x11")][e]={damage:0,cd:0},this[a0_0x1b8a("0x4ad")]()),this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x11")][e]}[a0_0x1b8a("0x4e4")](t,e){this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x11")][t][a0_0x1b8a("0xbd")]=e,this[a0_0x1b8a("0x4ad")]()}["AddTowerDevelopCDLevel"](t,e){this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x11")][t]["cd"]=e,this[a0_0x1b8a("0x4ad")]()}[a0_0x1b8a("0x55e")](t,e){this[a0_0x1b8a("0x19a")][a0_0x1b8a("0xfd")][t]<e&&(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0xfd")][t]=e)}["GetMaxLevel"](t){return this[a0_0x1b8a("0x19a")]["MaxLevel"][t]||(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0xfd")][t]=1),this[a0_0x1b8a("0x19a")][a0_0x1b8a("0xfd")][t]}[a0_0x1b8a("0x488")](t,e){this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x3b1")][t]<e&&(this["AroundData"]["MinLevel"][t]=e)}[a0_0x1b8a("0xc9")](t){return this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x3b1")][t]||(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x3b1")][t]=1),this["AroundData"][a0_0x1b8a("0x3b1")][t]}["GetPlayed"](t){return this[a0_0x1b8a("0x19a")]["Played"][t]||(this["AroundData"][a0_0x1b8a("0x78")][t]=0),this["AroundData"][a0_0x1b8a("0x78")][t]}[a0_0x1b8a("0x130")](t,e){this["AroundData"][a0_0x1b8a("0x78")][t]=e,this[a0_0x1b8a("0x4ad")]()}[a0_0x1b8a("0x116")](){return this[a0_0x1b8a("0x2cb")]=this[a0_0x1b8a("0x3b6")](this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1]),this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this["AroundData"][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1]}[a0_0x1b8a("0x3b6")](t){var e={};e["Hp"]=t[a0_0x1b8a("0x211")]["Hp"],e["ID"]=t[a0_0x1b8a("0x211")]["ID"],e[a0_0x1b8a("0x2d4")]=t["data"][a0_0x1b8a("0x2d4")],e[a0_0x1b8a("0x61e")]=t[a0_0x1b8a("0x211")][a0_0x1b8a("0x61e")],e[a0_0x1b8a("0x22b")]=t[a0_0x1b8a("0x211")][a0_0x1b8a("0x22b")],e["MapMonster"]=[],e[a0_0x1b8a("0x51d")]={};for(var o=0;o<t["data"][a0_0x1b8a("0x126")][a0_0x1b8a("0x6f")];++o)e["MapMonster"][a0_0x1b8a("0x198")](t[a0_0x1b8a("0x211")][a0_0x1b8a("0x126")][o]);const i=Object[a0_0x1b8a("0x5d1")](t[a0_0x1b8a("0x211")]["MapTower"]);for(const a of i)e["MapTower"][a]||(e[a0_0x1b8a("0x51d")][a]=t[a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")][a]);return{id:e[a0_0x1b8a("0x2d4")],data:e}}[a0_0x1b8a("0x40")](t){var e=this[a0_0x1b8a("0x3b6")](this[a0_0x1b8a("0x19a")]["MapData"][d["AroundSelect"]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1]);e["id"]=t,e[a0_0x1b8a("0x211")][a0_0x1b8a("0x2d4")]=t,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]]["push"](e),this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]>d["AroundMaxSaveCount"]+1&&this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]]["shift"](),this[a0_0x1b8a("0x55e")](d[a0_0x1b8a("0x61")],t),this[a0_0x1b8a("0x4ad")]()}[a0_0x1b8a("0x3c9")](){return console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x3f6")+this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x2d4")]),console["log"]("AroundCanDiamond, max level = "+this[a0_0x1b8a("0x321")](d[a0_0x1b8a("0x61")])),console[a0_0x1b8a("0x14e")]("AroundCanDiamond, min level = "+this[a0_0x1b8a("0xc9")](d[a0_0x1b8a("0x61")])),this[a0_0x1b8a("0x321")](d["AroundSelect"])>this["GetMinLevel"](d["AroundSelect"])}[a0_0x1b8a("0x1cf")](){this[a0_0x1b8a("0x19a")]["MapData"][d["AroundSelect"]][a0_0x1b8a("0x6f")]>2&&(this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x39f")](1,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1),this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][0]["data"][a0_0x1b8a("0x22b")]=0,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][0]["data"][a0_0x1b8a("0x7b")]=0,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][0]["data"][a0_0x1b8a("0x126")]=[],this["TempMapData"]=this["CopyMapData"](this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1]),this[a0_0x1b8a("0x4ad")]())}["GetMaxAroundLevel"](){return this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][0][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x2d4")]}[a0_0x1b8a("0x5bd")](){var t=Laya["LocalStorage"][a0_0x1b8a("0x3c8")](d[a0_0x1b8a("0x5a2")]+a0_0x1b8a("0x4fb"));null!=t&&t[a0_0x1b8a("0x6f")]>0?this[a0_0x1b8a("0x1bc")]=JSON["parse"](t):this[a0_0x1b8a("0x1bc")]={id:["","","",""],url:"",name:"",openid:""}}[a0_0x1b8a("0x5ea")](){var t=JSON[a0_0x1b8a("0x60a")](this[a0_0x1b8a("0x1bc")]),e=d[a0_0x1b8a("0x5a2")]+a0_0x1b8a("0x4fb");Laya[a0_0x1b8a("0x38f")]["setItem"](e,t)}["LoadLocalData"](){var t;null!=(t=Laya["LocalStorage"]["getItem"](d[a0_0x1b8a("0x5a2")]))&&t[a0_0x1b8a("0x6f")]>0&&(this[a0_0x1b8a("0x42e")]=JSON[a0_0x1b8a("0x428")](t));var e=new Date,o=e[a0_0x1b8a("0x52c")](),i=e[a0_0x1b8a("0x52c")]();this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x299")](a0_0x1b8a("0x50f"))&&(i=this[a0_0x1b8a("0x42e")]["LastLoginTimer"]);var a=new Date(i),r=e[a0_0x1b8a("0x553")]()==a["getDate"]();for(var s in this[a0_0x1b8a("0x25f")]){var n=this[a0_0x1b8a("0x25f")][s];1==n[a0_0x1b8a("0x24c")]?delete this[a0_0x1b8a("0x42e")][s]:(0==this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x299")](s)||0==r&&1==n[a0_0x1b8a("0xd4")])&&(this[a0_0x1b8a("0x42e")][s]=n[a0_0x1b8a("0x5ae")])}this["Data"][a0_0x1b8a("0x50f")]=o,this[a0_0x1b8a("0x42e")]["Guide"]>0&&(d["isGuide"]=!1)}["SaveLocalData"](){var t=JSON[a0_0x1b8a("0x60a")](this[a0_0x1b8a("0x42e")]),e=d["key"];Laya["LocalStorage"][a0_0x1b8a("0x3dc")](e,t)}[a0_0x1b8a("0x437")](t){this[a0_0x1b8a("0x604")]=[];for(var e=0;e<4;++e){var o=Laya[a0_0x1b8a("0x38f")][a0_0x1b8a("0x3c8")]("mapdata_"+d[a0_0x1b8a("0x5a2")]+"_"+e[a0_0x1b8a("0xdf")]()),i=null;if(null!=o&&o[a0_0x1b8a("0x6f")]>0)i=JSON[a0_0x1b8a("0x428")](o);else{i={};var a=0;a=0==e?1:1==e?31:2==e?101:171,this[a0_0x1b8a("0x53d")]={ID:{type:1,default:1,delete:!1,daily:!1},MapTower:{type:3,default:{},delete:!1,daily:!1},MapMonster:{type:3,default:[],delete:!1,daily:!1},Hp:{type:1,default:-1,delete:!1,daily:!1},MapID:{type:1,default:a,delete:!1,daily:!1},MapWave:{type:1,default:0,delete:!1,daily:!1},MapIdx:{type:1,default:0,delete:!1,daily:!1},Money:{type:1,default:-1,delete:!1,daily:!1}}}for(var r in this[a0_0x1b8a("0x53d")]){var s=this[a0_0x1b8a("0x53d")][r];1==s[a0_0x1b8a("0x24c")]?delete i[r]:0==i[a0_0x1b8a("0x299")](r)&&(i[r]=s[a0_0x1b8a("0x5ae")])}-1==i["Hp"]&&(i["Hp"]=d[a0_0x1b8a("0x312")][this[a0_0x1b8a("0x3a6")]()],i[a0_0x1b8a("0x61e")]=d[a0_0x1b8a("0x2d0")][this[a0_0x1b8a("0x3a6")]()]),i["ID"],this[a0_0x1b8a("0x604")][a0_0x1b8a("0x198")](i)}}[a0_0x1b8a("0x90")](){this[a0_0x1b8a("0x471")][a0_0x1b8a("0x61e")]=null!=this[a0_0x1b8a("0x539")]?this[a0_0x1b8a("0x539")][a0_0x1b8a("0x211")][a0_0x1b8a("0x61e")]:_[a0_0x1b8a("0x281")]["GetLevelInfo"](d[a0_0x1b8a("0x61")])[a0_0x1b8a("0x593")],this[a0_0x1b8a("0x471")]["Hp"]=null!=this[a0_0x1b8a("0x539")]?this["TempNormalMapData"][a0_0x1b8a("0x211")]["Hp"]:_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](d[a0_0x1b8a("0x61")])["hp"],this["mapData"][a0_0x1b8a("0x22b")]=0,this["mapData"][a0_0x1b8a("0x7b")]=0,this[a0_0x1b8a("0x471")][a0_0x1b8a("0x51d")]=null!=this[a0_0x1b8a("0x539")]?JSON[a0_0x1b8a("0x428")](JSON["stringify"](this[a0_0x1b8a("0x539")]["data"][a0_0x1b8a("0x51d")])):{},this[a0_0x1b8a("0x471")][a0_0x1b8a("0x126")]=[]}[a0_0x1b8a("0x174")](){if(0==d[a0_0x1b8a("0x2a9")])for(var t=0;t<this["LevelData"][a0_0x1b8a("0x6f")];++t){var e=JSON[a0_0x1b8a("0x60a")](this[a0_0x1b8a("0x604")][t]),o=a0_0x1b8a("0x7a")+d["key"]+"_"+t[a0_0x1b8a("0xdf")]();Laya["LocalStorage"]["setItem"](o,e)}else this[a0_0x1b8a("0x4ad")]()}["SaveMapDataTick"](){this["SaveMapData"]()}[a0_0x1b8a("0x520")](t){let e=t%60,o=Math[a0_0x1b8a("0x1e")](t/60);return(o>=10?""+o:"0"+o)+":"+(e>=10?""+e:"0"+e)}[a0_0x1b8a("0x3ee")](t=0){if(0==d["ModeSelect"]){if(1==t){switch(this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x61e")]=d[a0_0x1b8a("0x2d0")][this[a0_0x1b8a("0x3a6")]()],this[a0_0x1b8a("0x604")][d["NormalIndex"]]["Hp"]=d[a0_0x1b8a("0x312")][this[a0_0x1b8a("0x3a6")]()],this["getSelfMap"]()){case 0:this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]=1;break;case 1:this[a0_0x1b8a("0x604")][d["NormalIndex"]][a0_0x1b8a("0x2d4")]=31;break;case 2:this[a0_0x1b8a("0x604")][d["NormalIndex"]]["MapID"]=101;break;case 3:this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]=171}this[a0_0x1b8a("0x604")][d["NormalIndex"]]["MapWave"]=0,this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x7b")]=0,this["LevelData"][d["NormalIndex"]][a0_0x1b8a("0x51d")]={},this["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x126")]=[]}else this["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x61e")]=null!=this[a0_0x1b8a("0x539")]?this[a0_0x1b8a("0x539")][a0_0x1b8a("0x211")]["Money"]:d[a0_0x1b8a("0x2d0")][this[a0_0x1b8a("0x3a6")]()],this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["Hp"]=d["initHp"][this["getSelfMap"]()],this[a0_0x1b8a("0x604")][d["NormalIndex"]][a0_0x1b8a("0x22b")]=0,this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapIdx"]=0,this[a0_0x1b8a("0x604")][d["NormalIndex"]][a0_0x1b8a("0x51d")]=null!=this[a0_0x1b8a("0x539")]?JSON[a0_0x1b8a("0x428")](JSON[a0_0x1b8a("0x60a")](this["TempNormalMapData"][a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")])):{},this[a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x126")]=[];h["Instance"][a0_0x1b8a("0x174")]()}else 2==t&&(this["PopAroundMaoData"](),this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]]["length"]-1][a0_0x1b8a("0x211")]["MapWave"]=0,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x7b")]=0,this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x126")]=[],this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1][a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")]=null!=this["TempMapData"]?JSON[a0_0x1b8a("0x428")](JSON["stringify"](this["TempMapData"][a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")])):{},this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d["AroundSelect"]][a0_0x1b8a("0x6f")]-1]["data"]["Hp"]=_["Instance"][a0_0x1b8a("0x5fd")](d["AroundSelect"]+100)["hp"],this["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][this[a0_0x1b8a("0x19a")]["MapData"][d[a0_0x1b8a("0x61")]][a0_0x1b8a("0x6f")]-1]["data"][a0_0x1b8a("0x61e")]=null!=this[a0_0x1b8a("0x2cb")]?this[a0_0x1b8a("0x2cb")][a0_0x1b8a("0x211")][a0_0x1b8a("0x61e")]:d["initMoney"][d[a0_0x1b8a("0x61")]]);p[a0_0x1b8a("0x281")][a0_0x1b8a("0x114")]()}["setModel"](t){this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x2f9")]=t,this["SaveLocalData"](),this[a0_0x1b8a("0x437")](t)}[a0_0x1b8a("0x47f")](){return this["Data"][a0_0x1b8a("0x2f9")]}[a0_0x1b8a("0x3f9")](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x2c9")]}[a0_0x1b8a("0x3b3")](t,e){this["Data"][a0_0x1b8a("0x2c9")]={key:t,value:e}}[a0_0x1b8a("0x215")](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x3a5")]}[a0_0x1b8a("0x2c2")](t){this["Data"][a0_0x1b8a("0x3a5")]+=t,this[a0_0x1b8a("0x28e")]()}[a0_0x1b8a("0x21d")](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x21d")]}[a0_0x1b8a("0x3da")](){d[a0_0x1b8a("0x4d4")]&&(this[a0_0x1b8a("0x42e")]["canSign"]=1)}[a0_0x1b8a("0x5fa")](){this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x21d")]=0,this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x11d")]++}[a0_0x1b8a("0x607")](){return this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x11d")]>=7&&1==this["Data"]["canSign"]&&(this[a0_0x1b8a("0x42e")]["SignDays"]=0,this["Data"][a0_0x1b8a("0x5b6")]=1,this[a0_0x1b8a("0x28e")]()),this[a0_0x1b8a("0x42e")][a0_0x1b8a("0x11d")]}}h[a0_0x1b8a("0x281")]=new h;class d{static[a0_0x1b8a("0xf2")](t,e,o,i){let a=t-o,r=e-i;return Math[a0_0x1b8a("0x139")](a*a+r*r)}static[a0_0x1b8a("0x223")](){var e=Math[a0_0x1b8a("0x1e")](100*Math["random"]()),o=_["Instance"]["GetLuckyPer"]();for(let t=0;t<o["length"];t++)if(o[t][a0_0x1b8a("0x243")]>=e)return{key:t+1,value:_["Instance"][a0_0x1b8a("0x3a5")](t+1)[a0_0x1b8a("0x50e")]};return{key:0,value:0}}static[a0_0x1b8a("0x103")](t,e){return Math["floor"](Math[a0_0x1b8a("0x295")]()*(e-t))+t}static["getIconRes"](t,e){switch(t){case 7:return{icon:"image/main/Jewels3.png",name:a0_0x1b8a("0x1a8")+e};case 4:return{icon:a0_0x1b8a("0x48e"),name:a0_0x1b8a("0x3f1")+e};case 2:return{icon:a0_0x1b8a("0x61b"),name:a0_0x1b8a("0x88")+e};case 3:return{icon:a0_0x1b8a("0x3fa"),name:a0_0x1b8a("0x5e9")+e};case 8:return{icon:a0_0x1b8a("0x4f0"),name:a0_0x1b8a("0xa")+e}}return{icon:"image/main/35.png",name:a0_0x1b8a("0x507")}}static["getLevelNumer"](){switch(h["Instance"]["getSelfMap"]()){case 0:return 1;case 1:return 31;case 2:return 101;case 3:return 171}return 1}static[a0_0x1b8a("0x59c")](t){if(t<10)return t=1;var e=t[a0_0x1b8a("0xdf")]();return e=e[a0_0x1b8a("0x517")](0,e[a0_0x1b8a("0x6f")]-1),parseInt(e+"1")}}d[a0_0x1b8a("0x357")]=68,d["height"]=68,d[a0_0x1b8a("0x34e")]=7,d["gridY"]=11,d["startPos"]=[],d["endPos"]=[],d["tick"]=50,d[a0_0x1b8a("0x330")]=1,d[a0_0x1b8a("0x5a2")]="56",d[a0_0x1b8a("0xfd")]=[30,100,170,240],d[a0_0x1b8a("0x1e8")]=!0,d[a0_0x1b8a("0x2d0")]=[20,20,20,20],d[a0_0x1b8a("0x312")]=[20,20,20,20],d[a0_0x1b8a("0x4d4")]=!1,d[a0_0x1b8a("0x5b2")]=3,d[a0_0x1b8a("0x220")]=[!1,!1,!1],d[a0_0x1b8a("0x2e4")]=478,d[a0_0x1b8a("0x231")]=752,d[a0_0x1b8a("0xb5")]=-1,d[a0_0x1b8a("0x176")]=30,d[a0_0x1b8a("0x1fd")]=30,d["ShareVideoPro"]=20,d[a0_0x1b8a("0x2a9")]=0,d[a0_0x1b8a("0x61")]=0,d["DiamondGiftCount"]=0,d[a0_0x1b8a("0x7e")]=10,d[a0_0x1b8a("0x286")]=20,d[a0_0x1b8a("0x45f")]=0,d[a0_0x1b8a("0x23d")]=null,d["InterstitialCount"]=0,d[a0_0x1b8a("0x616")]=10,d[a0_0x1b8a("0x436")]="2";class p{constructor(){this[a0_0x1b8a("0x3a7")]=[],this["_sprite"]=[],this[a0_0x1b8a("0x435")]={},this[a0_0x1b8a("0x1d0")]={},this[a0_0x1b8a("0x59a")]=[],this[a0_0x1b8a("0x3e7")]=[],this[a0_0x1b8a("0x415")]={},this[a0_0x1b8a("0x551")]=[],this[a0_0x1b8a("0x506")]={x:-1,y:-1},this[a0_0x1b8a("0x585")]=[],this[a0_0x1b8a("0x268")]={}}[a0_0x1b8a("0x614")](t,e,o,i){let a=this["GetGridPos"](t,e);null!=a&&(this[a0_0x1b8a("0x268")][a["x"]+":"+a["y"]]=1,h["Instance"][a0_0x1b8a("0x3d1")](t,e,o,i))}[a0_0x1b8a("0x40c")](){this[a0_0x1b8a("0x268")]={},h[a0_0x1b8a("0x281")][a0_0x1b8a("0x11f")]()}[a0_0x1b8a("0x421")](t,e){let o=this[a0_0x1b8a("0x74")](t,e);return null!=o&&!this[a0_0x1b8a("0x268")][o["x"]+":"+o["y"]]}[a0_0x1b8a("0x384")](t,e,o){let i=this[a0_0x1b8a("0x74")](t,e);if(null==i||-1==o)return this["_tmpPos"]["x"]=-1,void(this["_tmpPos"]["y"]=-1);this[a0_0x1b8a("0x506")]["x"]=i["x"],this["_tmpPos"]["y"]=i["y"]}[a0_0x1b8a("0x366")](){this[a0_0x1b8a("0x435")]={},this[a0_0x1b8a("0x1d0")]={},this[a0_0x1b8a("0x415")]={},this[a0_0x1b8a("0x551")]=[]}[a0_0x1b8a("0x114")](){for(let e=0;e<d[a0_0x1b8a("0x2b3")];e++){this[a0_0x1b8a("0x3a7")][e]=[];for(let t=0;t<d["gridX"];t++)this[a0_0x1b8a("0x3a7")][e][t]=0}}["SetPath"](){0==this[a0_0x1b8a("0x3a7")]["length"]&&this[a0_0x1b8a("0x114")](),this[a0_0x1b8a("0x506")]["x"]=-1,this["_tmpPos"]["y"]=-1;for(let t=0;t<d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x6f")];t++)this[a0_0x1b8a("0x59a")]=this[a0_0x1b8a("0x1c1")](t),this[a0_0x1b8a("0x3e7")][t]?this[a0_0x1b8a("0x3e7")][t]=this[a0_0x1b8a("0x59a")]:this[a0_0x1b8a("0x3e7")][a0_0x1b8a("0x198")](this["_path"])}[a0_0x1b8a("0x74")](t,e){return t<0||e<0||t>d[a0_0x1b8a("0x357")]*d[a0_0x1b8a("0x34e")]||e>d[a0_0x1b8a("0x22f")]*d[a0_0x1b8a("0x2b3")]?null:{x:Math[a0_0x1b8a("0x1e")](t/d["width"]),y:Math[a0_0x1b8a("0x1e")](e/d[a0_0x1b8a("0x22f")])}}[a0_0x1b8a("0x92")](t,e){return t>d[a0_0x1b8a("0x357")]*d[a0_0x1b8a("0x34e")]||e>d[a0_0x1b8a("0x22f")]*d[a0_0x1b8a("0x2b3")]?null:{x:Math["floor"](t/d[a0_0x1b8a("0x357")]),y:Math[a0_0x1b8a("0x1e")](e/d["height"])}}[a0_0x1b8a("0xdd")](t,e){let o=this[a0_0x1b8a("0x74")](t,e);return null==o?{x:-50,y:-50}:{x:o["x"]*d[a0_0x1b8a("0x357")]+.5*d["width"],y:o["y"]*d[a0_0x1b8a("0x22f")]+.5*d["height"]}}[a0_0x1b8a("0x279")](t,e){return{x:t*d[a0_0x1b8a("0x357")]+.5*d[a0_0x1b8a("0x357")],y:e*d[a0_0x1b8a("0x22f")]+.5*d[a0_0x1b8a("0x22f")]}}[a0_0x1b8a("0x318")](t,e,o){if(this["_map"][e][t]=o,h[a0_0x1b8a("0x281")]["SetTowerMap"](t,e,o),0==o||this[a0_0x1b8a("0x500")](t,e)){for(let t=0;t<d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x6f")];t++)this[a0_0x1b8a("0x59a")]=this[a0_0x1b8a("0x1c1")](t),this[a0_0x1b8a("0x3e7")][t]?this[a0_0x1b8a("0x3e7")][t]=this[a0_0x1b8a("0x59a")]:this[a0_0x1b8a("0x3e7")][a0_0x1b8a("0x198")](this[a0_0x1b8a("0x59a")]);return!0}return!1}[a0_0x1b8a("0x500")](t,e){for(var o=0;o<this["AllPath"][a0_0x1b8a("0x6f")];o++)for(var i=0;i<this[a0_0x1b8a("0x3e7")][o]["length"];i++){if(this[a0_0x1b8a("0x3e7")][o][i]["x"]==t&&this[a0_0x1b8a("0x3e7")][o][i]["y"]==e)return!0;if(this["AllPath"][o][i]["x"]==this[a0_0x1b8a("0x506")]["x"]&&this[a0_0x1b8a("0x3e7")][o][i]["y"]==this[a0_0x1b8a("0x506")]["y"])return!0}return!1}[a0_0x1b8a("0x3a3")](t,e){this[a0_0x1b8a("0x585")]=[];for(var o=0;o<this[a0_0x1b8a("0x3e7")][a0_0x1b8a("0x6f")];o++){var i;this["_sprite"][o]?i=this["_sprite"][o]:(i=new Laya["Sprite"],this["_sprite"][a0_0x1b8a("0x198")](i),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x240")][a0_0x1b8a("0x40a")](i)),i[a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x585")][a0_0x1b8a("0x198")](!1);var a=this[a0_0x1b8a("0x74")](t,e),r=this["AllPath"][o];a&&o<d[a0_0x1b8a("0x2f6")]["length"]&&(this["SetTmp"](t,e,1),r=this[a0_0x1b8a("0x1c1")](o)),r["length"]>0?(i["graphics"]["clear"](),this[a0_0x1b8a("0x585")][o]=!0):this["_ShowPath"][o]=!1}var s=!0;for(o=0;o<this[a0_0x1b8a("0x585")][a0_0x1b8a("0x6f")];o++)if(0==this[a0_0x1b8a("0x585")][o]){s=!1;break}for(let t=0;t<this[a0_0x1b8a("0x55c")][a0_0x1b8a("0x6f")];t++)this["_sprite"][t][a0_0x1b8a("0x212")]=s;return 0==d["ModeSelect"]?h["Instance"]["getSelfMap"]()>2&&0==a["x"]&&5==a["y"]&&(s=!1):d["AroundSelect"]>1&&0==a["x"]&&5==a["y"]&&(s=!1),s}[a0_0x1b8a("0x217")](i){if(0==i[a0_0x1b8a("0x6f")])return[];var a=[],r=i[0];for(let o=0;o<i["length"];o++){var s=i[o];let t=(s["x"]-r["x"])*d[a0_0x1b8a("0x357")],e=(s["y"]-r["y"])*d[a0_0x1b8a("0x22f")];a["push"](t+d[a0_0x1b8a("0x357")]/2),a[a0_0x1b8a("0x198")](e+d[a0_0x1b8a("0x22f")]/2)}return a}[a0_0x1b8a("0x113")](){for(var t=0;t<this[a0_0x1b8a("0x55c")][a0_0x1b8a("0x6f")];t++)null!=this[a0_0x1b8a("0x55c")][t]&&(this[a0_0x1b8a("0x55c")][t][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x506")]["x"]=-1,this["_tmpPos"]["y"]=-1)}["getPath"](t){if(0==this[a0_0x1b8a("0x3e7")][a0_0x1b8a("0x6f")])for(let t=0;t<d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x6f")];t++)this["_path"]=this[a0_0x1b8a("0x1c1")](t),this[a0_0x1b8a("0x3e7")][t]?this[a0_0x1b8a("0x3e7")][t]=this[a0_0x1b8a("0x59a")]:this[a0_0x1b8a("0x3e7")][a0_0x1b8a("0x198")](this[a0_0x1b8a("0x59a")]);return this["AllPath"][t]}[a0_0x1b8a("0x1c1")](t,e=null){var o;this[a0_0x1b8a("0x366")](),null!=e&&(o=this[a0_0x1b8a("0x74")](e["x"],e["y"])),null==o&&(0==(o=d[a0_0x1b8a("0x2f6")][t])[1]&&(o[1]=-1),6==o[0]&&(o[0]=7),o["x"]=o[0],o["y"]=o[1]);var i=d[a0_0x1b8a("0x3a9")][t];if(6==i[0]?i[0]=7:0==i[0]&&(i[0]=-1),i["x"]=i[0],10==i[1]&&(i[1]=11),i["y"]=i[1],o["x"]==i["x"]&&o["y"]==i["y"])return[{x:i["x"],y:i["y"]}];var a=new Array,r={x:o["x"],y:o["y"],fx:-1,fy:-1};a[a0_0x1b8a("0x198")](r),this[a0_0x1b8a("0x1d0")][r["x"]+":"+r["y"]]=1,this[a0_0x1b8a("0x435")][r["x"]+":"+r["y"]]=r;for(var s=null;a[a0_0x1b8a("0x6f")]>0;){let e=a[a0_0x1b8a("0x3fe")](),o=this[a0_0x1b8a("0x4c9")](e["x"]);for(let t=0;t<4;t++)if(this["insertNode"](e["x"]+o[t]["x"],e["y"]+o[t]["y"],e["x"],e["y"],i["x"],i["y"])){s={x:i["x"],y:i["y"],fx:e["x"],fy:e["y"]};break}if(s)break;for(let t=0;t<4;t++){var n={x:e["x"]+o[t]["x"],y:e["y"]+o[t]["y"],fx:e["x"],fy:e["y"]};this[a0_0x1b8a("0x297")](n["x"],n["y"])&&(this[a0_0x1b8a("0x1d0")][n["x"]+":"+n["y"]]=1,a[a0_0x1b8a("0x198")](n))}}for(var b=[];s&&s["x"]>=-1&&s["y"]>=0;)b[a0_0x1b8a("0x563")]({x:s["x"],y:s["y"]}),s=this[a0_0x1b8a("0x435")][s["fx"]+":"+s["fy"]];return b}["insertNode"](t,e,o,i,a,r){return this[a0_0x1b8a("0x400")](t,e)&&(this[a0_0x1b8a("0x435")][t+":"+e]={x:t,y:e,fx:o,fy:i}),t==a&&e==r}[a0_0x1b8a("0x297")](t,e){return!(t<0||t>=d[a0_0x1b8a("0x34e")]||e<0||e>=d["gridY"])&&(!this[a0_0x1b8a("0x1d0")][t+":"+e]&&(!(this[a0_0x1b8a("0x3a7")][e][t]>0)&&(t!=this[a0_0x1b8a("0x506")]["x"]||e!=this[a0_0x1b8a("0x506")]["y"])))}[a0_0x1b8a("0x400")](t,e){return!(t<0||t>=d[a0_0x1b8a("0x34e")]||e<0||e>=d[a0_0x1b8a("0x2b3")])&&(!this[a0_0x1b8a("0x435")][t+":"+e]&&(!(this[a0_0x1b8a("0x3a7")][e][t]>0)&&(t!=this[a0_0x1b8a("0x506")]["x"]||e!=this["_tmpPos"]["y"])))}[a0_0x1b8a("0x4c9")](t){return t>3?[{x:-1,y:0},{x:0,y:1},{x:1,y:0},{x:0,y:-1}]:t<3?[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}]:[{x:0,y:1},{x:-1,y:0},{x:1,y:0},{x:0,y:-1}]}}p[a0_0x1b8a("0x281")]=new p;class c{constructor(){this["wx"]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")]["wx"]}static["Init"](){Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](1),Laya["SoundManager"][a0_0x1b8a("0x46a")](1),Laya["SoundManager"][a0_0x1b8a("0xa1")]=!1,Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x234")]=!0,Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x496")]=!1,Laya["SoundManager"][a0_0x1b8a("0x3e2")]=!1,c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd")),Laya[a0_0x1b8a("0x1eb")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x5f8")],this,function(){for(let t in this["dic"])this[a0_0x1b8a("0x560")][t]=0})}static[a0_0x1b8a("0xe5")](t){Laya["SoundManager"][a0_0x1b8a("0x3ec")](t),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](t)}static["PlayBG"](t){Laya["SoundManager"][a0_0x1b8a("0x373")](I[a0_0x1b8a("0x281")][a0_0x1b8a("0x93")]+a0_0x1b8a("0x2c8")+t+a0_0x1b8a("0x38b"))}static[a0_0x1b8a("0x441")](t){c[a0_0x1b8a("0x560")][t]||(c[a0_0x1b8a("0x560")][t]=0),0==c[a0_0x1b8a("0x560")][t]&&(c[a0_0x1b8a("0x560")][t]=1,Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x166")](I[a0_0x1b8a("0x281")]["cdnUrl"]+a0_0x1b8a("0x2c8")+t+a0_0x1b8a("0x38b"),1,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){c["dic"][t]=0},null,!1)))}static[a0_0x1b8a("0x47a")](t){c[a0_0x1b8a("0x560")][t]||(c[a0_0x1b8a("0x560")][t]=0),0==c[a0_0x1b8a("0x560")][t]&&(c[a0_0x1b8a("0x560")][t]=1,Laya["SoundManager"][a0_0x1b8a("0x166")](I[a0_0x1b8a("0x281")]["cdnUrl"]+"sound/"+t+a0_0x1b8a("0x38b"),0))}static[a0_0x1b8a("0x20a")](t){1==c["dic"][t]&&(c["dic"][t]=0,Laya[a0_0x1b8a("0x153")]["stopSound"](I[a0_0x1b8a("0x281")][a0_0x1b8a("0x93")]+a0_0x1b8a("0x2c8")+t+a0_0x1b8a("0x38b")))}}c[a0_0x1b8a("0x560")]={},c[a0_0x1b8a("0x4bb")]=[];class s{constructor(){this[a0_0x1b8a("0x5f")]=null,this["img"]=null,this["bg"]=null,this["hp"]=null,this[a0_0x1b8a("0x6a")]=null,this[a0_0x1b8a("0x489")]=null,this[a0_0x1b8a("0x586")]=null,this["td"]=null,this[a0_0x1b8a("0x556")]=null,this[a0_0x1b8a("0x3d8")]=0,this["_x"]=0,this["_y"]=0,this[a0_0x1b8a("0x1ef")]=0,this["_grid_y"]=0,this[a0_0x1b8a("0x2a4")]=null,this["_distance"]=500,this[a0_0x1b8a("0x5a9")]=null,this[a0_0x1b8a("0x134")]=null,this[a0_0x1b8a("0x1f")]=300,this[a0_0x1b8a("0x528")]=0,this[a0_0x1b8a("0x531")]=1,this[a0_0x1b8a("0x152")]=0,this[a0_0x1b8a("0x1f0")]=1,this[a0_0x1b8a("0x348")]=0,this[a0_0x1b8a("0x2f3")]=null,this[a0_0x1b8a("0x109")]=0,this["_status"]=0,this[a0_0x1b8a("0x329")]=!0,this[a0_0x1b8a("0x612")]=null,this[a0_0x1b8a("0x2b")]=0,this["canfire"]=!1,this[a0_0x1b8a("0x532")]=0,this[a0_0x1b8a("0x125")]=0,this["_attack_power"]=1,this[a0_0x1b8a("0x326")]=0}[a0_0x1b8a("0x111")](){this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x199")](),this[a0_0x1b8a("0x493")]=0,this[a0_0x1b8a("0x348")]=0,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x5f2")]=0,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x5f2")]=0,this["CanAttack"]=!0}[a0_0x1b8a("0x3db")](){return this["_tabData"]}[a0_0x1b8a("0xf5")](){return this["_distance"]}[a0_0x1b8a("0x5fc")](){return this[a0_0x1b8a("0x1ef")]}[a0_0x1b8a("0x15f")](){return this[a0_0x1b8a("0x360")]}[a0_0x1b8a("0x43a")](){this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0xaa")]>0&&(this[a0_0x1b8a("0x2f3")]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0xaa")]),this["_id"]=this[a0_0x1b8a("0x2f3")]["id"],this[a0_0x1b8a("0x532")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x8d")]+_[a0_0x1b8a("0x281")][a0_0x1b8a("0x2be")](this[a0_0x1b8a("0x3d8")],this[a0_0x1b8a("0x3d9")][a0_0x1b8a("0xbd")])[a0_0x1b8a("0x243")],this["_cd"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x3dd")]-_[a0_0x1b8a("0x281")][a0_0x1b8a("0x587")](this["_id"],this[a0_0x1b8a("0x3d9")]["cd"])[a0_0x1b8a("0x243")],this[a0_0x1b8a("0x472")](),this[a0_0x1b8a("0x4e1")]())}["CheckLevelup"](){if(this["_tabData"]["next_id"]>0){var t=_["Instance"]["GetTower"](this["_tabData"][a0_0x1b8a("0xaa")]);if(h[a0_0x1b8a("0x281")]["getMoney"]()>=t["cost"])return void(this["levelup"][a0_0x1b8a("0x212")]=!0)}this["levelup"][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x114")](t,e,o){if(this["_tabData"]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](t),this[a0_0x1b8a("0x3d9")]=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5f0")](t),null==this[a0_0x1b8a("0x3f8")]){this["obj"]=new Laya[a0_0x1b8a("0xdc")],this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x46b")]=.5,this[a0_0x1b8a("0x5f")]["anchorY"]=.5,this[a0_0x1b8a("0x5f")]["width"]=70,this[a0_0x1b8a("0x5f")]["height"]=70,this["bg"]=new Laya[a0_0x1b8a("0x1de")],this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this["bg"]),this["bg"][a0_0x1b8a("0x2d9")]=0,this["bg"][a0_0x1b8a("0x49d")]=0,this[a0_0x1b8a("0x3f8")]=new Laya["Image"],this[a0_0x1b8a("0x3f8")]["anchorX"]=.5,this["img"][a0_0x1b8a("0x36a")]=.5,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x3f8")]),this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x2d9")]=0,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x49d")]=0,this[a0_0x1b8a("0x6a")]=new Laya[a0_0x1b8a("0xdc")],this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x6a")]),this["fire"][a0_0x1b8a("0x46b")]=.5,this["fire"]["anchorY"]=.5;for(let t=0;t<3;t++){let t=new Laya[a0_0x1b8a("0x1de")];t[a0_0x1b8a("0x212")]=!1,t[a0_0x1b8a("0x46b")]=.5,t[a0_0x1b8a("0x36a")]=.5,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x40a")](t)}this[a0_0x1b8a("0x489")]=new Laya[a0_0x1b8a("0xec")],this["buf"]=new Laya[a0_0x1b8a("0xec")],this["td"]=new Laya[a0_0x1b8a("0xec")],this["td"]["x"]=-12,this["td"]["y"]=-40,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x586")]),this["img"][a0_0x1b8a("0x40a")](this["td"]),this[a0_0x1b8a("0x612")]=new Laya[a0_0x1b8a("0x1de")],this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x612")]),this[a0_0x1b8a("0x612")]["visible"]=!1,this[a0_0x1b8a("0x556")]=new Laya["Image"],this[a0_0x1b8a("0x556")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x292"),this["levelup"]["x"]=2,this["levelup"]["y"]=30,this[a0_0x1b8a("0x556")][a0_0x1b8a("0x3a")]=.65,this[a0_0x1b8a("0x556")][a0_0x1b8a("0x48b")]=.65,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this["levelup"])}else for(var i=0;i<3;i++){let t=this["fire"][a0_0x1b8a("0x13f")](i);t[a0_0x1b8a("0x11e")]="",t["height"]=0}this["_id"]=t,this["_x"]=e,this["_y"]=o,this[a0_0x1b8a("0x489")][a0_0x1b8a("0x199")](),this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x457")]&&(this[a0_0x1b8a("0x134")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x457")]),this["fireindex"]=0,this[a0_0x1b8a("0x1cc")]=!1,this[a0_0x1b8a("0x472")](),this[a0_0x1b8a("0x4e1")]()}["onClickTower"](){}[a0_0x1b8a("0x4e1")](){this["animation"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]&&-1==this["_tabData"]["effect"][a0_0x1b8a("0x5f6")](a0_0x1b8a("0x36f"))&&(this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x489")]),this[a0_0x1b8a("0x489")]["x"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][0][0],this[a0_0x1b8a("0x489")]["y"]=this[a0_0x1b8a("0x2f3")]["offset"][0][1],a0_0x1b8a("0x335")==this[a0_0x1b8a("0x2f3")]["effect"]?this[a0_0x1b8a("0x489")][a0_0x1b8a("0x33b")](1.2,1.2):a0_0x1b8a("0x300")==this["_tabData"][a0_0x1b8a("0x545")]?this[a0_0x1b8a("0x489")][a0_0x1b8a("0x33b")](1.2,1.2):this[a0_0x1b8a("0x489")]["scale"](1,1)),this[a0_0x1b8a("0x4af")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x42f")],this[a0_0x1b8a("0x531")]=1,this[a0_0x1b8a("0x152")]=0,this["CanAttack"]=!0,this[a0_0x1b8a("0x1f0")]=1,this[a0_0x1b8a("0x532")]=this["_tabData"][a0_0x1b8a("0x8d")]+_[a0_0x1b8a("0x281")][a0_0x1b8a("0x2be")](this["_id"],this[a0_0x1b8a("0x3d9")][a0_0x1b8a("0xbd")])[a0_0x1b8a("0x243")],this[a0_0x1b8a("0x1f")]=this[a0_0x1b8a("0x2f3")]["attack_cd"]-_[a0_0x1b8a("0x281")][a0_0x1b8a("0x587")](this[a0_0x1b8a("0x3d8")],this[a0_0x1b8a("0x3d9")]["cd"])[a0_0x1b8a("0x243")],this[a0_0x1b8a("0x528")]=this[a0_0x1b8a("0x1f")],this[a0_0x1b8a("0x348")]=0,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x49d")]=0,this[a0_0x1b8a("0x3d8")]>20&&this[a0_0x1b8a("0x3d8")]<30?this["bg"][a0_0x1b8a("0x212")]=!1:this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x50c")]?(this["bg"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2f3")]["bgres"],this["_tabData"][a0_0x1b8a("0x194")]&&(this[a0_0x1b8a("0x3f8")]["centerY"]=this["_tabData"]["bg_y"]),this["bg"][a0_0x1b8a("0x212")]=!0):this["bg"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3d8")]>20&&this["_id"]<30?(this["img"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x2e7")+this["_id"]+a0_0x1b8a("0x69"),this[a0_0x1b8a("0x3f8")]["centerY"]=-5):this[a0_0x1b8a("0x3f8")]["skin"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x394")],this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x357")]=80,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x22f")]=80,this[a0_0x1b8a("0x612")][a0_0x1b8a("0x212")]=!1;let t=this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x357")]/120;this[a0_0x1b8a("0x586")]["scale"](t,t),this[a0_0x1b8a("0x586")]["x"]=-11,this[a0_0x1b8a("0x586")]["y"]=-10,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x2d9")]=0,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x49d")]=this["_id"]>30?-40:0,this["buf"][a0_0x1b8a("0x212")]=!1,this["obj"][a0_0x1b8a("0x212")]=!0,this["td"]["visible"]=!1,this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x457")]?this[a0_0x1b8a("0x134")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x457")]:this["hitEffect"]=null,null==this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x14c")]&&I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["_tower"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x5f")]),this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x9f")](this["_x"],this["_y"]);let e=p[a0_0x1b8a("0x281")]["GetGridPos"](this["_x"],this["_y"]);if(this[a0_0x1b8a("0x1ef")]=e["x"],this["_grid_y"]=e["y"],this[a0_0x1b8a("0x6a")]["alpha"]=0,this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")]&&this[a0_0x1b8a("0x2f3")]["offset"][a0_0x1b8a("0x6f")]>0){this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x212")]=!0;for(var o=0;o<3;o++){let t=this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x13f")](o);o<this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][a0_0x1b8a("0x6f")]?(this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]&&-1!=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")][a0_0x1b8a("0x5f6")](a0_0x1b8a("0x36f"))&&(t[a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]),this["_id"]<30?(t[a0_0x1b8a("0x357")]=96,t[a0_0x1b8a("0x22f")]=128,t[a0_0x1b8a("0x46b")]=.5,t[a0_0x1b8a("0x36a")]=.5,t["centerX"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][o][0],t[a0_0x1b8a("0x49d")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][o][1]):(t[a0_0x1b8a("0x46b")]=.5,t[a0_0x1b8a("0x36a")]=1,t[a0_0x1b8a("0x2d9")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][o][0],t[a0_0x1b8a("0x22d")]=this[a0_0x1b8a("0x2f3")]["offset"][o][1]),t[a0_0x1b8a("0x212")]=!0):t[a0_0x1b8a("0x212")]=!1}}else this[a0_0x1b8a("0x6a")]["visible"]=!1;this[a0_0x1b8a("0x493")]=1,this["index"]=0,this[a0_0x1b8a("0x556")]["y"]=30,this[a0_0x1b8a("0x125")]=0}[a0_0x1b8a("0x47c")](e,o){if(this[a0_0x1b8a("0x1f0")]<=e){this[a0_0x1b8a("0x1f0")]=e,this[a0_0x1b8a("0x531")]/=e,this["_cd"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x3dd")]*this["_attack_cd_per"],this[a0_0x1b8a("0x152")]=o,this[a0_0x1b8a("0x586")][a0_0x1b8a("0x212")]=!0;let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x596")]("js");this[a0_0x1b8a("0x586")]["play"](0,!0,"js"),this[a0_0x1b8a("0x586")]["interval"]=t["fps"]}}["SetAttackPower"](e,o){if(this[a0_0x1b8a("0x4b5")]<=e){this["_attack_power"]=e,this[a0_0x1b8a("0x152")]=o,this["buf"]["visible"]=!0;let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x596")]("js");this[a0_0x1b8a("0x586")]["play"](0,!0,"js"),this[a0_0x1b8a("0x586")][a0_0x1b8a("0x55b")]=t["fps"]}}[a0_0x1b8a("0xa2")](){if(0!=this[a0_0x1b8a("0x493")]){if(this["fire"][a0_0x1b8a("0x361")]>0&&0==this["index"]&&(this["fire"][a0_0x1b8a("0x361")]-=.2),this["levelup"]["visible"]&&(0==this[a0_0x1b8a("0x125")]?(this["levelup"]["y"]-=d[a0_0x1b8a("0xa2")]/40,this[a0_0x1b8a("0x556")]["y"]<25&&(this[a0_0x1b8a("0x556")]["y"]=25,this[a0_0x1b8a("0x125")]=1)):(this[a0_0x1b8a("0x556")]["y"]+=d[a0_0x1b8a("0xa2")]/40,this[a0_0x1b8a("0x556")]["y"]>35&&(this["levelup"]["y"]=35,this["upanimindex"]=0))),this[a0_0x1b8a("0x5f9")](),"火焰塔"==this["_tabData"]["name"]&&this[a0_0x1b8a("0x1cc")]&&(this["firefire"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x555")+this[a0_0x1b8a("0x2b")]+a0_0x1b8a("0x101"),this[a0_0x1b8a("0x2b")]++,this[a0_0x1b8a("0x2b")]>9&&(this[a0_0x1b8a("0x2b")]=5),null==this[a0_0x1b8a("0x2a4")]&&(this["firefire"]["visible"]=!1,this["canfire"]=!1,this[a0_0x1b8a("0x2b")]=0)),this["_attack_per_timer"]>0&&(this[a0_0x1b8a("0x152")]-=d[a0_0x1b8a("0xa2")],this[a0_0x1b8a("0x152")]<=0&&(this[a0_0x1b8a("0x152")]=0,this["_attack_cd_per"]=1,this[a0_0x1b8a("0x1f0")]=1,this[a0_0x1b8a("0x1f")]=this["_tabData"][a0_0x1b8a("0x3dd")]*this["_attack_cd_per"],this[a0_0x1b8a("0x4b5")]=1,this[a0_0x1b8a("0x586")][a0_0x1b8a("0x212")]=!1)),4==this["_tabData"]["targetType"])return this[a0_0x1b8a("0x528")]>0&&(this[a0_0x1b8a("0x528")]-=d[a0_0x1b8a("0xa2")]),void(this[a0_0x1b8a("0x528")]<=0&&(this[a0_0x1b8a("0x77")](),this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]=1));this[a0_0x1b8a("0x329")]||(this[a0_0x1b8a("0x528")]<this[a0_0x1b8a("0x1f")]?this[a0_0x1b8a("0x528")]+=d["tick"]:this[a0_0x1b8a("0x329")]=!0),null!=this[a0_0x1b8a("0x2a4")]&&this["CanAttack"]&&(this[a0_0x1b8a("0x329")]=!1,this[a0_0x1b8a("0x528")]=0,this["attack"](),this[a0_0x1b8a("0x3d8")]>30&&this[a0_0x1b8a("0x3d8")]<40&&this[a0_0x1b8a("0x1a5")](),a0_0x1b8a("0x12b")==this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x1db")]&&this[a0_0x1b8a("0x4dc")](),this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]=1)}}[a0_0x1b8a("0x4dc")](){0==this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]&&(this["td"][a0_0x1b8a("0x212")]||(this["td"][a0_0x1b8a("0x212")]=!0),this["index"]=1,this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x83")]())}["PlayEf1"](){if(this[a0_0x1b8a("0x326")]>=7)this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]=0;else{for(let e=0;e<3;e++){let t=this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x13f")](e);t[a0_0x1b8a("0x212")]&&(t[a0_0x1b8a("0x11e")]="image/effect/qiangkou_"+this[a0_0x1b8a("0x326")]+a0_0x1b8a("0x101"))}Laya["timer"][a0_0x1b8a("0x3a4")](.005*d[a0_0x1b8a("0xa2")],this,function(){this["index"]++,this[a0_0x1b8a("0x83")]()})}}[a0_0x1b8a("0x1a5")](){let o=d[a0_0x1b8a("0xf2")](this["_x"],this["_y"]-40,this["_target"]["x"](),this[a0_0x1b8a("0x2a4")]["y"]());for(let e=0;e<3;e++){let t=this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x13f")](e);t[a0_0x1b8a("0x212")]&&(t[a0_0x1b8a("0x22f")]=o,0==this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x361")]&&(this["td"][a0_0x1b8a("0x212")]||(this["td"][a0_0x1b8a("0x212")]=!0),this["td"][a0_0x1b8a("0x416")](0,!1,a0_0x1b8a("0x209")),this[a0_0x1b8a("0x326")]=1,this[a0_0x1b8a("0x6a")]["alpha"]=1,this["PlayEf3"](t)))}}[a0_0x1b8a("0x2e6")](t){this["index"]>=11?this["fire"][a0_0x1b8a("0x361")]=0:(t[a0_0x1b8a("0x11e")]=a0_0x1b8a("0x4df")+this[a0_0x1b8a("0x326")]+".png",Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](.005*d["tick"],this,function(){this[a0_0x1b8a("0x326")]++,this["PlayEf3"](t)}))}[a0_0x1b8a("0x77")](){if(4!=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x259")]){if(this[a0_0x1b8a("0x2f3")]["bullet_id"]>0){this["_x"],this["_y"];A[a0_0x1b8a("0x281")][a0_0x1b8a("0x1e4")](this[a0_0x1b8a("0x2f3")]["bullet_id"],this["_x"],this["_y"],this[a0_0x1b8a("0x348")],this[a0_0x1b8a("0x2a4")],this[a0_0x1b8a("0x532")],this[a0_0x1b8a("0x2f3")])}else{if(this[a0_0x1b8a("0x489")]["parent"]){let t=_["Instance"]["GetAnimationByName"](this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]);this[a0_0x1b8a("0x489")][a0_0x1b8a("0x55b")]=t[a0_0x1b8a("0x27b")],a0_0x1b8a("0x2a2")!=this[a0_0x1b8a("0x2f3")]["name"]?(this["animation"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x489")]["play"](0,!1,this["_tabData"]["effect"]),Laya["timer"][a0_0x1b8a("0x3a4")](t[a0_0x1b8a("0x5b7")],this,function(){this[a0_0x1b8a("0x489")][a0_0x1b8a("0x212")]=!1})):this[a0_0x1b8a("0x1cc")]||(this[a0_0x1b8a("0x612")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x1cc")]=!0,this[a0_0x1b8a("0x2b")]=1,this["firefire"]["x"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][0][0]+10,this[a0_0x1b8a("0x612")]["y"]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35d")][0][1]+10)}if(3==this[a0_0x1b8a("0x2f3")]["targetType"]){let e=A[a0_0x1b8a("0x281")][a0_0x1b8a("0x24e")](this["_x"],this["_y"],this[a0_0x1b8a("0x2f3")]["radius"]);for(let t=0;t<e[a0_0x1b8a("0x6f")];t++){e[t][a0_0x1b8a("0x51c")](this["towerDamage"]*this["_attack_power"],this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35b")],this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x2f4")],this[a0_0x1b8a("0x134")])}}else if(2==this["_tabData"][a0_0x1b8a("0x259")]){let e=A[a0_0x1b8a("0x281")]["GetTargers2"](this["_x"],this["_y"],this[a0_0x1b8a("0x2a4")]["x"](),this[a0_0x1b8a("0x2a4")]["y"](),this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x42f")],this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x5f2")],this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x439")]);for(let t=0;t<e[a0_0x1b8a("0x6f")];t++){e[t][a0_0x1b8a("0x51c")](this[a0_0x1b8a("0x532")]*this[a0_0x1b8a("0x4b5")],this[a0_0x1b8a("0x2f3")]["attack_bloodcolor"],this[a0_0x1b8a("0x2f3")]["attack_bloodstroke"],this[a0_0x1b8a("0x134")])}}else this[a0_0x1b8a("0x2a4")]["onHit"](this[a0_0x1b8a("0x532")]*this["_attack_power"],this["_tabData"][a0_0x1b8a("0x35b")],this["_tabData"][a0_0x1b8a("0x2f4")],this[a0_0x1b8a("0x134")])}this[a0_0x1b8a("0x2f3")]["sound"]&&c[a0_0x1b8a("0x441")](this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x307")])}else{let t=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x42f")]/68,e=A[a0_0x1b8a("0x281")][a0_0x1b8a("0x352")](this[a0_0x1b8a("0x5fc")](),this[a0_0x1b8a("0x15f")](),t,this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x1db")]);if(0==e)return;this["_cd_time"]=this[a0_0x1b8a("0x1f")];let o=0;if(e>=1e6?(this[a0_0x1b8a("0x3f8")]["rotation"]=180,o=1):e>=1e4?(o=2,this["img"][a0_0x1b8a("0x5f2")]=90):e>=100?(o=3,this[a0_0x1b8a("0x3f8")]["rotation"]=270):(o=4,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x5f2")]=0),this[a0_0x1b8a("0x489")][a0_0x1b8a("0x14c")]){let t=_[a0_0x1b8a("0x281")]["GetAnimationByName"](this[a0_0x1b8a("0x2f3")]["effect"]);this[a0_0x1b8a("0x489")][a0_0x1b8a("0x416")](0,!1,this[a0_0x1b8a("0x2f3")]["effect"]),this["animation"][a0_0x1b8a("0x55b")]=t[a0_0x1b8a("0x27b")],this[a0_0x1b8a("0x489")][a0_0x1b8a("0x212")]=!0,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](t[a0_0x1b8a("0x5b7")],this,function(){this[a0_0x1b8a("0x489")][a0_0x1b8a("0x212")]=!1})}let i=A[a0_0x1b8a("0x281")]["GetTargetsByDir"](this[a0_0x1b8a("0x5fc")](),this["GridY"](),o,this[a0_0x1b8a("0x2f3")]["name"]);for(let t=0;t<i[a0_0x1b8a("0x6f")];t++){i[t][a0_0x1b8a("0x51c")](this[a0_0x1b8a("0x532")]*this[a0_0x1b8a("0x4b5")],this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x35b")],this["_tabData"][a0_0x1b8a("0x2f4")],this["hitEffect"])}this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x307")]&&c[a0_0x1b8a("0x441")](this["_tabData"][a0_0x1b8a("0x307")])}}[a0_0x1b8a("0x4e9")](){if(2==this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x1c5")])return void this["checkDir"]();let t=this[a0_0x1b8a("0x2a4")]["x"]()-this["_x"],e=-(this[a0_0x1b8a("0x2a4")]["y"]()-this["_y"]);var o=Math[a0_0x1b8a("0x414")](t,e)/(Math["PI"]/180);this["_rotation"]=o,1==this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x1c5")]?this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x5f2")]=o:(a0_0x1b8a("0x4cb")==this[a0_0x1b8a("0x2f3")]["name"]&&(o<0?o-=10:o>0&&(o+=10)),this[a0_0x1b8a("0x6a")][a0_0x1b8a("0x5f2")]=o)}[a0_0x1b8a("0x5a8")](){let t=this[a0_0x1b8a("0x2a4")]["x"]()-this["_x"],e=-(this[a0_0x1b8a("0x2a4")]["y"]()-this["_y"]);var o=Math[a0_0x1b8a("0x414")](t,e)/(Math["PI"]/180);if(this["_rotation"]=o,4!=this["_id"]){let t=Math[a0_0x1b8a("0x1e")](this[a0_0x1b8a("0x348")]/15);0==t&&(t=1),this[a0_0x1b8a("0x3f8")]["skewY"]=t<0?180:0,this["img"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x2e7")+this[a0_0x1b8a("0x3d8")]+"_"+Math["abs"](t)+a0_0x1b8a("0x101"),console[a0_0x1b8a("0x14e")]("degree = "+o+a0_0x1b8a("0x27a")+t+a0_0x1b8a("0x304")+this["_id"]+"_"+Math[a0_0x1b8a("0x46c")](t))}}[a0_0x1b8a("0x57b")](){let t=this[a0_0x1b8a("0x2a4")]["x"]()-this["_x"],e=-(this[a0_0x1b8a("0x2a4")]["y"]()-this["_y"]);var o=Math["atan2"](t,e)/(Math["PI"]/180);if(this[a0_0x1b8a("0x348")]=o,4!=this[a0_0x1b8a("0x3d8")]){let t=Math[a0_0x1b8a("0x1e")](this[a0_0x1b8a("0x348")]/9)+1;0==t&&(t=1),t>=20&&(t=19),this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x2ed")]=t<0?180:0,this["img"]["skin"]=a0_0x1b8a("0x2e7")+this["_id"]+"_"+Math[a0_0x1b8a("0x46c")](t)+a0_0x1b8a("0x101")}}["checkTarget"](){if(4==this[a0_0x1b8a("0x2f3")]["targetType"])return;if(null!=this[a0_0x1b8a("0x2a4")]&&0!=this[a0_0x1b8a("0x2a4")][a0_0x1b8a("0x5a5")]()||(this[a0_0x1b8a("0x2a4")]=A["Instance"][a0_0x1b8a("0x3ce")](this["_x"],this["_y"],this[a0_0x1b8a("0x4af")])),null==this[a0_0x1b8a("0x2a4")])return;let t=this["_x"]-this[a0_0x1b8a("0x2a4")]["x"](),e=this["_y"]-this[a0_0x1b8a("0x2a4")]["y"]();Math[a0_0x1b8a("0x139")](t*t+e*e)>this[a0_0x1b8a("0x4af")]?this["_target"]=null:this["checkDir2"]()}}class x{static[a0_0x1b8a("0x464")](e){console[a0_0x1b8a("0x14e")]("BrigeClassViVo SdkInit this.qg= "),this["qg"]&&this["qg"][a0_0x1b8a("0x247")]({url:"",data:{},header:{"content-type":a0_0x1b8a("0x4ff")},success(t){t[a0_0x1b8a("0x211")]&&(console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x20b")+JSON["stringify"](t["data"])),x[a0_0x1b8a("0x371")]=t["data"][a0_0x1b8a("0x371")],x[a0_0x1b8a("0x20c")]=t["data"][a0_0x1b8a("0x4ee")],e({open:x["openIBn"]}))},fail(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x34c")+JSON[a0_0x1b8a("0x60a")](t)),x["openIBn"]=!0,x[a0_0x1b8a("0x20c")]=.8},complete(t){console[a0_0x1b8a("0x14e")]("BrigeClassViVo SdkInit complete "+JSON[a0_0x1b8a("0x60a")](t))}}),this[a0_0x1b8a("0x351")](),setInterval(function(){x[a0_0x1b8a("0x351")]()}[a0_0x1b8a("0x40d")](this),2e4)}static[a0_0x1b8a("0x128")](){console["log"](a0_0x1b8a("0x37f"))}static[a0_0x1b8a("0x351")](){Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x5e1")]&&(this[a0_0x1b8a("0x4db")]=this[a0_0x1b8a("0x4db")]+1,this[a0_0x1b8a("0x4db")]=this[a0_0x1b8a("0x4db")]%this[a0_0x1b8a("0x2f5")][a0_0x1b8a("0x6f")],console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4dd")+this[a0_0x1b8a("0x4db")]),this["nativeAd"]=this["qg"][a0_0x1b8a("0x58f")]({posId:this[a0_0x1b8a("0x2f5")][this[a0_0x1b8a("0x4db")]]}),this[a0_0x1b8a("0x1f5")][a0_0x1b8a("0x5d5")](),this[a0_0x1b8a("0x1f5")][a0_0x1b8a("0x13")](function(t){if(console[a0_0x1b8a("0x14e")]("---------onLoadAd---11-------:"+JSON["stringify"](t)),t&&t[a0_0x1b8a("0x1b3")]&&t[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){this[a0_0x1b8a("0x294")]=t;var e=this["AdData"]["adList"][0];this[a0_0x1b8a("0x1f5")]["reportAdShow"]({adId:e[a0_0x1b8a("0x375")]})}}["bind"](this)),this["nativeAd"][a0_0x1b8a("0x327")](function(t){this[a0_0x1b8a("0x1f5")]=null,console[a0_0x1b8a("0x14e")]("原生广告加载错误",JSON[a0_0x1b8a("0x60a")](t))}),this[a0_0x1b8a("0x81")]=(new Date)["getTime"]())}static[a0_0x1b8a("0x187")](){var s=this["AdData"];if(console["log"](a0_0x1b8a("0x191")+JSON[a0_0x1b8a("0x60a")](s)),this["nativeBannerUI"]&&(this[a0_0x1b8a("0x5d9")]["destroy"](),this[a0_0x1b8a("0x5d9")]=null),null!=s&&null!=s[a0_0x1b8a("0x1b3")])if(s["adList"]&&this[a0_0x1b8a("0x1f5")]&&s[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){let a=(Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")]-50)/320,r=new Laya[a0_0x1b8a("0xdc")];if(r[a0_0x1b8a("0x102")]=0,r[a0_0x1b8a("0x181")]=0,r[a0_0x1b8a("0x2f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]-50*a,r["bottom"]=0,r[a0_0x1b8a("0x2ae")]=1e4,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](r),s[a0_0x1b8a("0x1b3")]&&s[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){var n=s[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x31d")]();let t=new Laya[a0_0x1b8a("0x1de")](n["imgUrlList"][0]);t[a0_0x1b8a("0x2d9")]=0,t[a0_0x1b8a("0x22d")]=0,t[a0_0x1b8a("0x357")]=320,t[a0_0x1b8a("0x22f")]=80,t["scaleX"]=a,t[a0_0x1b8a("0x48b")]=a,r[a0_0x1b8a("0x40a")](t);let e=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x333"));e["anchorX"]=1,e[a0_0x1b8a("0x36a")]=1,e[a0_0x1b8a("0x2d9")]=138*a,e[a0_0x1b8a("0x22d")]=0,r[a0_0x1b8a("0x40a")](e);let o=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x2b0"));o[a0_0x1b8a("0x2d9")]=150*a,o[a0_0x1b8a("0x22d")]=60*a,r[a0_0x1b8a("0x40a")](o);let i=new Laya[a0_0x1b8a("0x1de")]("ADRes/native_showclose.png");i[a0_0x1b8a("0x2d9")]=150*a,i[a0_0x1b8a("0x22d")]=60*a,r[a0_0x1b8a("0x40a")](i),i[a0_0x1b8a("0x361")]=.1,i[a0_0x1b8a("0x3a")]=x[a0_0x1b8a("0x20c")],i["scaleY"]=x[a0_0x1b8a("0x20c")],i["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){r[a0_0x1b8a("0x8c")](),r=null,x["nativeAd"]=null,x["nativeBannerUI"]=null,x[a0_0x1b8a("0x294")]=null}),t["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,function(){console["log"](a0_0x1b8a("0xc8")),x[a0_0x1b8a("0x1f5")][a0_0x1b8a("0x39a")]({adId:n["adId"]})}),r["alpha"]=0,(new Laya[a0_0x1b8a("0x1e1")])["to"](r,{alpha:1},500,Laya["Ease"][a0_0x1b8a("0x48f")]),this[a0_0x1b8a("0x5d9")]=r}}else this[a0_0x1b8a("0x310")]();else this[a0_0x1b8a("0x310")]()}static[a0_0x1b8a("0xb1")](){this["showBoxPortalAd"]()}static[a0_0x1b8a("0x96")](){this["qg"]["createBoxPortalAd"]?(this[a0_0x1b8a("0x245")]=this["qg"][a0_0x1b8a("0xd3")]({posId:this[a0_0x1b8a("0xd2")],marginTop:200}),this[a0_0x1b8a("0x245")]["onError"](function(t){console[a0_0x1b8a("0x14e")]("盒子九宫格广告加载失败",t)}),this["boxPortalAd"][a0_0x1b8a("0x226")](function(){console["log"](a0_0x1b8a("0x13b")),this[a0_0x1b8a("0x245")][a0_0x1b8a("0x225")]||this[a0_0x1b8a("0x245")]["show"]()}),this[a0_0x1b8a("0x245")][a0_0x1b8a("0x12c")]()["then"](function(){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x395"))})):console["log"]("暂不支持互推盒子相关 API")}static[a0_0x1b8a("0x72")](){null!=this[a0_0x1b8a("0x245")]&&(this[a0_0x1b8a("0x245")]["isDestroyed"]=!0,this["boxPortalAd"][a0_0x1b8a("0x8c")]())}static[a0_0x1b8a("0x529")](t){return 1+Math[a0_0x1b8a("0x1e")](100*Math[a0_0x1b8a("0x295")]())<=t}static[a0_0x1b8a("0x4f1")](){var n=this[a0_0x1b8a("0x294")];if(console[a0_0x1b8a("0x14e")]("--------------ShowNaticeInterstitial:"+JSON["stringify"](n)),this["nativeBannerUI"]&&(this[a0_0x1b8a("0x5d9")][a0_0x1b8a("0x8c")](),this[a0_0x1b8a("0x5d9")]=null),null!=n&&null!=n["adList"])if(x[a0_0x1b8a("0x371")]||!this[a0_0x1b8a("0x529")](50)){if(this["nativeAd"]&&n[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){let s=new Laya[a0_0x1b8a("0xdc")];s[a0_0x1b8a("0x102")]=-10,s[a0_0x1b8a("0x181")]=-10,s["top"]=-10,s["bottom"]=-10,s[a0_0x1b8a("0x2ae")]=1e4,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](s);let t=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x5dd"));if(t[a0_0x1b8a("0x102")]=-10,t[a0_0x1b8a("0x181")]=-10,t["top"]=-10,t[a0_0x1b8a("0x22d")]=-10,t["alpha"]=.1,s[a0_0x1b8a("0x40a")](t),t["on"](a0_0x1b8a("0x447"),this,function(){}),n[a0_0x1b8a("0x1b3")]&&n[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){var b=n["adList"]["pop"]();let t=(Laya[a0_0x1b8a("0x1eb")]["width"]-50)/320,e=new Laya[a0_0x1b8a("0x1de")](b[a0_0x1b8a("0xc3")][0]);e[a0_0x1b8a("0x2d9")]=0,e[a0_0x1b8a("0x49d")]=0,e["width"]=320,e[a0_0x1b8a("0x22f")]=240,e["scaleX"]=t,e["scaleY"]=t,s[a0_0x1b8a("0x40a")](e);let o=function(){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1a1")),this[a0_0x1b8a("0x1f5")][a0_0x1b8a("0x39a")]({adId:b[a0_0x1b8a("0x375")]}),s[a0_0x1b8a("0x8c")]()}["bind"](this),i=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x333"));i[a0_0x1b8a("0x2d9")]=150*t-21,i[a0_0x1b8a("0x49d")]=110*t,s[a0_0x1b8a("0x40a")](i),e["on"](a0_0x1b8a("0x447"),this,o);let a=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x2b0"));a[a0_0x1b8a("0x2d9")]=150*t,a[a0_0x1b8a("0x49d")]=-110*t,s[a0_0x1b8a("0x40a")](a);let r=new Laya["Image"]("ADRes/native_showclose.png");r["centerX"]=150*t,r[a0_0x1b8a("0x49d")]=-110*t,r[a0_0x1b8a("0x361")]=.1,r["scaleX"]=x[a0_0x1b8a("0x20c")],r[a0_0x1b8a("0x48b")]=x["closeBtnScale"],console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x434")+x[a0_0x1b8a("0x20c")]),s[a0_0x1b8a("0x40a")](r),r["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,function(){s["destroy"](),s=null,this[a0_0x1b8a("0x1f5")]=null,this[a0_0x1b8a("0x343")]=null,this[a0_0x1b8a("0x294")]=null}[a0_0x1b8a("0x40d")](this))}}}else this[a0_0x1b8a("0x1a")]();else this[a0_0x1b8a("0x1a")]()}static["DebugMode"](){this[a0_0x1b8a("0x4d4")]?(h[a0_0x1b8a("0x281")]["Data"][a0_0x1b8a("0x29c")]=1,h["Instance"]["SaveLocalData"](),d[a0_0x1b8a("0x312")]=[_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](1)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](2)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](3)["hp"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](4)["hp"]],d[a0_0x1b8a("0x2d0")]=[_[a0_0x1b8a("0x281")]["GetLevelInfo"](1)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](2)["gold"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](3)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)[a0_0x1b8a("0x593")]]):(d[a0_0x1b8a("0x312")]=[20,20,20,20],d[a0_0x1b8a("0x2d0")]=[20,20,20,20])}static["SendEvent"](t,e=""){}static[a0_0x1b8a("0x13e")](t,e,o,i,a,r){}static["ShareInitiative"](t,e,o,i,a,r){}static[a0_0x1b8a("0x516")](){}static[a0_0x1b8a("0x310")](){if(Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x5e1")]){if(null!=this[a0_0x1b8a("0x4ce")])return this[a0_0x1b8a("0x4ce")]["destroy"](),void(this[a0_0x1b8a("0x4ce")]=null);if(""!=this[a0_0x1b8a("0x561")]){var t=this["qg"]["createBannerAd"]({posId:this[a0_0x1b8a("0x561")],style:{}});t["onLoad"](function(){}),t[a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x1b9")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2c1"))})[a0_0x1b8a("0x59b")](t=>{console["log"](a0_0x1b8a("0x2da"),JSON[a0_0x1b8a("0x60a")](t))}),this[a0_0x1b8a("0x4ce")]=t}}}static[a0_0x1b8a("0x21b")](){null!=this[a0_0x1b8a("0x4ce")]&&(this[a0_0x1b8a("0x4ce")]["destroy"](),this[a0_0x1b8a("0x4ce")]=null),this[a0_0x1b8a("0x5d9")]&&(this[a0_0x1b8a("0x5d9")][a0_0x1b8a("0x8c")](),this[a0_0x1b8a("0x5d9")]=null)}static[a0_0x1b8a("0x1b5")](){}static[a0_0x1b8a("0xe6")](){}static[a0_0x1b8a("0xc5")](){}static[a0_0x1b8a("0x4c1")](){}static[a0_0x1b8a("0x1a")](){if(this["qg"]&&""!=this[a0_0x1b8a("0x275")]){var t=this["qg"][a0_0x1b8a("0x61f")]({posId:this["InterstitialID"]});t[a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4d1"),t)}),t[a0_0x1b8a("0x13")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x169"))}),t[a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x1b9")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x53"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")]("插屏广告展示失败",JSON["stringify"](t))})}}static[a0_0x1b8a("0xcf")](e,o,i){null==this[a0_0x1b8a("0x350")]&&(this[a0_0x1b8a("0x350")]=this["qg"][a0_0x1b8a("0x5a7")]({adUnitId:this["RewardID"]}),this[a0_0x1b8a("0x350")]["onLoad"](()=>{this[a0_0x1b8a("0x350")][a0_0x1b8a("0x12c")]()["then"](()=>{Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3c5")](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](0),Laya["SoundManager"][a0_0x1b8a("0x46a")](0),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x534"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")]("激励视频广告显示失败",t)})}),this[a0_0x1b8a("0x350")]["onError"](t=>{console[a0_0x1b8a("0x14e")](t),e(this[a0_0x1b8a("0x59f")],i)}),this[a0_0x1b8a("0x350")][a0_0x1b8a("0x226")](t=>{Laya[a0_0x1b8a("0x5b7")]["resume"](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](.5),Laya[a0_0x1b8a("0x153")]["setSoundVolume"](.5),t&&t[a0_0x1b8a("0x12a")]||void 0===t?(e(this["RewardIndex"],i),c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd"))):(o(this[a0_0x1b8a("0x59f")],i),c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd")))}))}static[a0_0x1b8a("0x273")](t){this[a0_0x1b8a("0x59f")]=t,this[a0_0x1b8a("0x350")]["load"]()["then"](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2ee"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x378"),t)})}static["LoadItemVideo"](e,o,i){null==this["itemVideoAd"]&&(this["itemVideoAd"]=this["qg"]["createRewardedVideoAd"]({adUnitId:this[a0_0x1b8a("0x296")]}),this[a0_0x1b8a("0x1b")]["onLoad"](()=>{this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x12c")]()["then"](()=>{Laya["timer"][a0_0x1b8a("0x3c5")](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](0),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](0),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0xf8"))})["catch"](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x470"),t)})}),this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x14e")](t),e(this[a0_0x1b8a("0x59f")],i)}),this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x226")](t=>{Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x388")](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](.5),t&&t[a0_0x1b8a("0x12a")]||void 0===t?(e(this[a0_0x1b8a("0x59f")],i),c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd"))):(o(this[a0_0x1b8a("0x59f")],i),c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd")))}))}static[a0_0x1b8a("0x22e")](t){this[a0_0x1b8a("0x59f")]=t,this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x5d5")]()[a0_0x1b8a("0x1b9")](()=>{console[a0_0x1b8a("0x14e")]("激励视频广告加载成功")})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")]("激励视频广告加载失败",t)})}static[a0_0x1b8a("0x547")](t,e,o){}static[a0_0x1b8a("0xb4")](t,e,o,i){if(this[a0_0x1b8a("0x59f")]=t,this["qg"][a0_0x1b8a("0x5a7")]){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0xab"));var a=this["qg"][a0_0x1b8a("0x5a7")]({adUnitId:this["RewardID"]});a[a0_0x1b8a("0x226")](t=>{c[a0_0x1b8a("0xe5")](.5),Laya["timer"]["resume"](),Laya["SoundManager"][a0_0x1b8a("0x3ec")](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](.5),t&&t["isEnded"]?e(this["RewardIndex"],i):o(this["RewardIndex"],i)}),a[a0_0x1b8a("0x327")](t=>{o(this[a0_0x1b8a("0x59f")],i),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x467")+JSON[a0_0x1b8a("0x60a")](t)),console[a0_0x1b8a("0x14e")]("激励视频异常",t)}),a[a0_0x1b8a("0x13")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x241")),a[a0_0x1b8a("0x12c")]()["then"](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x3ca")),c[a0_0x1b8a("0xe5")](0),Laya[a0_0x1b8a("0x153")]["setMusicVolume"](0),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](0),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3c5")](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x232"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x470"),t)})}),a[a0_0x1b8a("0x5d5")]()["then"](()=>{c[a0_0x1b8a("0xe5")](0),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](0),Laya[a0_0x1b8a("0x153")]["setSoundVolume"](0),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2ee"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x378"),t)})}}static["ShowVideo"](t){}}x["qg"]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")]["qg"],x["isDebug"]=!0,x[a0_0x1b8a("0x561")]=a0_0x1b8a("0x4ec"),x[a0_0x1b8a("0x275")]=a0_0x1b8a("0x5bf"),x["RewardID"]=a0_0x1b8a("0x456"),x["openIBn"]=!1,x[a0_0x1b8a("0x4db")]=0,x[a0_0x1b8a("0x81")]=0,x["closeBtnScale"]=1,x["boxPortalAd"]=null,x[a0_0x1b8a("0xd2")]=a0_0x1b8a("0xef"),x[a0_0x1b8a("0x2f5")]=[a0_0x1b8a("0x405"),a0_0x1b8a("0x146"),"1e073b50bf9847d08b1fef1df3e13305"],x[a0_0x1b8a("0x1f5")]=null,x[a0_0x1b8a("0x294")]=null,x["nativeBannerUI"]=null,x["bannerAd"]=null,x[a0_0x1b8a("0x8a")]=null,x["eventVideoAd"]=null,x[a0_0x1b8a("0x1b")]=null,x[a0_0x1b8a("0x420")]=null,x["gridAd"]=null,x[a0_0x1b8a("0x59f")]="";class a{static[a0_0x1b8a("0x464")](){if(a["qg"]){var t=a["qg"][a0_0x1b8a("0x4c0")]();a[a0_0x1b8a("0x4ce")]=qg[a0_0x1b8a("0x474")]({adUnitId:a[a0_0x1b8a("0x23")],style:{top:t[a0_0x1b8a("0x51a")][a0_0x1b8a("0x22f")]-57,left:t[a0_0x1b8a("0x51a")][a0_0x1b8a("0x357")]/2-180,height:57,width:360},adIntervals:60}),a[a0_0x1b8a("0x4ce")][a0_0x1b8a("0x4ce")][a0_0x1b8a("0x13")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4b8"))}),a[a0_0x1b8a("0x4ce")][a0_0x1b8a("0x4ce")]["onError"](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x538")+JSON["stringify"](t))}),a["rewardedVideoAd"]=qg[a0_0x1b8a("0x5a7")]({adUnitId:a[a0_0x1b8a("0x4ce")][a0_0x1b8a("0x1e9")],success:t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x27"))},fail:(t,e)=>{console[a0_0x1b8a("0x14e")]("视频广告错误: loadAndShowVideoAd createRewardedVideoAd fail: "+t+","+e)},complete:()=>{console["log"]("视频广告完成 : loadAndShowVideoAd createRewardedVideoAd complete")}}),a[a0_0x1b8a("0x420")][a0_0x1b8a("0x13")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x123"))}),a[a0_0x1b8a("0x420")]["load"](),a[a0_0x1b8a("0x420")][a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x87")](a0_0x1b8a("0x5d3")+JSON["stringify"](t));t[a0_0x1b8a("0x31c")],t[a0_0x1b8a("0x339")]})}}static["ShowNaticeBanner"](){this[a0_0x1b8a("0x310")]()}static[a0_0x1b8a("0x4f1")](){let t=qg[a0_0x1b8a("0x58f")]({adUnitId:a["nativeCurrentId"][0],success:t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4a8"))},fail:(t,e)=>{console[a0_0x1b8a("0x14e")]("loadNativeAd loadNativeAd fail: "+t+","+e)},complete:()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4a6"))}});t["load"](),t["onError"](t=>{console[a0_0x1b8a("0x87")](a0_0x1b8a("0x390")+JSON[a0_0x1b8a("0x60a")](t));t[a0_0x1b8a("0x31c")],t["errMsg"]}),t[a0_0x1b8a("0x13")](t=>{console[a0_0x1b8a("0x4")](a0_0x1b8a("0x43b")+JSON[a0_0x1b8a("0x60a")](t));var s=t[a0_0x1b8a("0x1b3")][0];if(console["log"]("--------------ShowNaticeInterstitial:"+JSON[a0_0x1b8a("0x60a")](s)),this[a0_0x1b8a("0x5d9")]&&(this[a0_0x1b8a("0x5d9")]["destroy"](),this[a0_0x1b8a("0x5d9")]=null),null!=s)if(this[a0_0x1b8a("0x1f5")]&&s["adList"]["length"]>0){let r=new Laya["Box"];r[a0_0x1b8a("0x102")]=-10,r[a0_0x1b8a("0x181")]=-10,r[a0_0x1b8a("0x2f")]=-10,r[a0_0x1b8a("0x22d")]=-10,r["zOrder"]=1e4,Laya[a0_0x1b8a("0x1eb")]["addChild"](r);let t=new Laya[a0_0x1b8a("0x1de")]("ADRes/native_2.png");if(t[a0_0x1b8a("0x102")]=-10,t[a0_0x1b8a("0x181")]=-10,t[a0_0x1b8a("0x2f")]=-10,t[a0_0x1b8a("0x22d")]=-10,t[a0_0x1b8a("0x361")]=.1,r["addChild"](t),t["on"](a0_0x1b8a("0x447"),this,function(){}),s[a0_0x1b8a("0x1b3")]&&s[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x6f")]>0){var n=s[a0_0x1b8a("0x1b3")][a0_0x1b8a("0x31d")]();let t=(Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")]-50)/320,e=new Laya[a0_0x1b8a("0x1de")](n[a0_0x1b8a("0xc3")][0]);e["centerX"]=0,e[a0_0x1b8a("0x49d")]=0,e[a0_0x1b8a("0x357")]=320,e[a0_0x1b8a("0x22f")]=240,e[a0_0x1b8a("0x3a")]=t,e[a0_0x1b8a("0x48b")]=t,r[a0_0x1b8a("0x40a")](e);let o=function(){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1a1")),this[a0_0x1b8a("0x1f5")][a0_0x1b8a("0x39a")]({adId:n[a0_0x1b8a("0x375")]}),r["destroy"](),r=null,this[a0_0x1b8a("0x1f5")]=null,this[a0_0x1b8a("0x343")]=null}[a0_0x1b8a("0x40d")](this);e["on"](a0_0x1b8a("0x447"),this,o);let i=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x2b0"));i[a0_0x1b8a("0x2d9")]=150*t,i["centerY"]=-110*t,r[a0_0x1b8a("0x40a")](i);let a=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x2b0"));a["centerX"]=150*t,a[a0_0x1b8a("0x49d")]=-110*t,a[a0_0x1b8a("0x361")]=.1,a[a0_0x1b8a("0x3a")]=this[a0_0x1b8a("0x20c")],a[a0_0x1b8a("0x48b")]=this["closeBtnScale"],r["addChild"](a),a["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){r[a0_0x1b8a("0x8c")](),r=null,this[a0_0x1b8a("0x1f5")]=null,this[a0_0x1b8a("0x343")]=null}[a0_0x1b8a("0x40d")](this))}}else this[a0_0x1b8a("0x1a")]();else this[a0_0x1b8a("0x1a")]()})}static["DebugMode"](){this[a0_0x1b8a("0x4d4")]?(h["Instance"][a0_0x1b8a("0x42e")][a0_0x1b8a("0x29c")]=1,h[a0_0x1b8a("0x281")]["SaveLocalData"](),d[a0_0x1b8a("0x312")]=[_[a0_0x1b8a("0x281")]["GetLevelInfo"](1)["hp"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](2)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](3)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)["hp"]],d["initMoney"]=[_[a0_0x1b8a("0x281")]["GetLevelInfo"](1)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](2)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](3)["gold"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)[a0_0x1b8a("0x593")]]):(d["initHp"]=[20,20,20,20],d[a0_0x1b8a("0x2d0")]=[20,20,20,20])}static[a0_0x1b8a("0x608")](t,e=""){}static[a0_0x1b8a("0x13e")](t,e,o,i,a,r){}static["ShareInitiative"](t,e,o,i,a,r){}static["LoadBannerAd"](){}static[a0_0x1b8a("0x310")](){a[a0_0x1b8a("0x4ce")]["show"]()}static[a0_0x1b8a("0x21b")](){a[a0_0x1b8a("0x4ce")][a0_0x1b8a("0x230")]()}static[a0_0x1b8a("0x1b5")](){}static[a0_0x1b8a("0xe6")](){}static[a0_0x1b8a("0xc5")](){}static[a0_0x1b8a("0x4c1")](){}static[a0_0x1b8a("0x1a")](){let e=qg["createInterstitialAd"]({adUnitId:a[a0_0x1b8a("0x275")]});e[a0_0x1b8a("0x5d5")](),e[a0_0x1b8a("0x13")](function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x54a")+JSON[a0_0x1b8a("0x60a")](t)),e[a0_0x1b8a("0x12c")]()}),e["onError"](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x54c")+JSON["stringify"](t))}),e[a0_0x1b8a("0x226")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x36e")),e[a0_0x1b8a("0x8c")]()}),e[a0_0x1b8a("0x13c")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0xb8"))})}static[a0_0x1b8a("0x273")](t){this[a0_0x1b8a("0x59f")]=t,this[a0_0x1b8a("0x350")][a0_0x1b8a("0x5d5")]()[a0_0x1b8a("0x1b9")](()=>{console[a0_0x1b8a("0x14e")]("激励视频广告加载成功")})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x378"),t)})}static[a0_0x1b8a("0x150")](e,o,i){null==this["itemVideoAd"]&&(this[a0_0x1b8a("0x1b")]=this["qg"][a0_0x1b8a("0x5a7")]({adUnitId:this["RewardID"]}),this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x13")](()=>{this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x1b9")](()=>{Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3c5")](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](0),Laya["SoundManager"][a0_0x1b8a("0x46a")](0),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0xf8"))})[a0_0x1b8a("0x59b")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x470"),t)})}),this[a0_0x1b8a("0x1b")][a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x14e")](t),e(this["RewardIndex"],i)}),this[a0_0x1b8a("0x1b")]["onClose"](t=>{Laya["timer"]["resume"](),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](.5),t&&t[a0_0x1b8a("0x12a")]||void 0===t?(e(this["RewardIndex"],i),c[a0_0x1b8a("0x590")]("login")):(o(this[a0_0x1b8a("0x59f")],i),c[a0_0x1b8a("0x590")](a0_0x1b8a("0x2dd")))}))}static[a0_0x1b8a("0x22e")](t){this[a0_0x1b8a("0x59f")]=t,this["itemVideoAd"][a0_0x1b8a("0x5d5")]()[a0_0x1b8a("0x1b9")](()=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2ee"))})["catch"](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x378"),t)})}static["LoadRewardVideo"](t,e,o){}static[a0_0x1b8a("0xb4")](t,e,o,i){this[a0_0x1b8a("0x59f")]=t,a[a0_0x1b8a("0x420")][a0_0x1b8a("0x12c")](),a[a0_0x1b8a("0x420")][a0_0x1b8a("0x226")](t=>{console[a0_0x1b8a("0x14e")]("ad onClose: "+t["isEnded"]),t[a0_0x1b8a("0x12a")]?e(this[a0_0x1b8a("0x59f")],i):o(this["RewardIndex"],i),a[a0_0x1b8a("0x420")]["load"]()})}static["ShowVideo"](t){}}a["qg"]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")]["qg"],a["isDebug"]=!0,a[a0_0x1b8a("0x23")]="j1pcnpx5tu",a[a0_0x1b8a("0x275")]=a0_0x1b8a("0x224"),a[a0_0x1b8a("0x296")]=a0_0x1b8a("0x4d3"),a[a0_0x1b8a("0x2f5")]=[a0_0x1b8a("0x129"),a0_0x1b8a("0x129")],a["openIBn"]=!1,a[a0_0x1b8a("0x4db")]=0,a[a0_0x1b8a("0x81")]=0,a[a0_0x1b8a("0x20c")]=1,a[a0_0x1b8a("0x1f5")]=null,a[a0_0x1b8a("0x294")]=null,a[a0_0x1b8a("0x5d9")]=null,a[a0_0x1b8a("0x4ce")]=null,a[a0_0x1b8a("0x8a")]=null,a[a0_0x1b8a("0x350")]=null,a["itemVideoAd"]=null,a[a0_0x1b8a("0x420")]=null,a[a0_0x1b8a("0x43f")]=null,a["RewardIndex"]="";class n{static[a0_0x1b8a("0x464")](){this[a0_0x1b8a("0x353")][a0_0x1b8a("0x100")]({showShareItems:[a0_0x1b8a("0x353"),"qzone"]}),this[a0_0x1b8a("0x353")][a0_0x1b8a("0x549")](()=>({title:"",imageUrl:"./share.png"})),this[a0_0x1b8a("0x353")][a0_0x1b8a("0x50a")](function(t){})}static[a0_0x1b8a("0x478")](){this["isDebug"]?(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x29c")]=1,h[a0_0x1b8a("0x281")]["SaveLocalData"](),d[a0_0x1b8a("0x312")]=[_["Instance"][a0_0x1b8a("0x5fd")](1)["hp"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](2)["hp"],_["Instance"][a0_0x1b8a("0x5fd")](3)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)["hp"]],d[a0_0x1b8a("0x2d0")]=[_["Instance"]["GetLevelInfo"](1)["gold"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](2)["gold"],_["Instance"]["GetLevelInfo"](3)["gold"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)["gold"]]):(d[a0_0x1b8a("0x312")]=[20,20,20,20],d["initMoney"]=[20,20,20,20])}static[a0_0x1b8a("0x608")](t,e=""){}static[a0_0x1b8a("0x13e")](t,e,o,i,a,r){}static["ShareInitiative"](t,e,o,i,a,r){}static["LoadBannerAd"](){}static[a0_0x1b8a("0x310")](){var t=this[a0_0x1b8a("0x353")][a0_0x1b8a("0x4c0")](),e=t[a0_0x1b8a("0x5dc")],o=t["windowWidth"];if(console[a0_0x1b8a("0x14e")]("-----SDK---------BannerAD  baiduSdkad"),""!=n[a0_0x1b8a("0x561")]){var i=null;this[a0_0x1b8a("0x4ce")]?this["bannerAd"]["show"]():(i=this[a0_0x1b8a("0x353")]["createBannerAd"]({adUnitId:n["BannerID"],appSid:n[a0_0x1b8a("0x4c6")],style:{width:300,top:e-110,left:(o-300)/2}}),n["bannerAd"]=i,i[a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x9d"),t),n[a0_0x1b8a("0x4ce")]=null}),i["onLoad"](()=>{console["log"](a0_0x1b8a("0x79"),0,0,100),i[a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x59b")](t=>console["log"](a0_0x1b8a("0x2a7"),t)),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x3bf"),0,0,100)}))}}static[a0_0x1b8a("0x21b")](){null!=this[a0_0x1b8a("0x4ce")]&&(this[a0_0x1b8a("0x4ce")][a0_0x1b8a("0x230")](),this[a0_0x1b8a("0x4ce")]=null)}static["LoadGridAd"](){}static[a0_0x1b8a("0xe6")](){}static[a0_0x1b8a("0xc5")](){null!=this[a0_0x1b8a("0x43f")]&&this[a0_0x1b8a("0x43f")]["hide"]()}static[a0_0x1b8a("0x4c1")](){}static["ShowInterstitialAd"](){}static[a0_0x1b8a("0xcf")](t,e,o){}static[a0_0x1b8a("0x273")](t){this["RewardIndex"]=t,this[a0_0x1b8a("0x350")]["show"]()[a0_0x1b8a("0x59b")](t=>{this["eventVideoAd"]["load"]()[a0_0x1b8a("0x1b9")](()=>this[a0_0x1b8a("0x350")]["show"]())})}static[a0_0x1b8a("0x150")](t,e,o){}static[a0_0x1b8a("0x22e")](t){}static["LoadRewardVideo"](t,e,o){}static[a0_0x1b8a("0xb4")](t,e,o,i){if(console[a0_0x1b8a("0x14e")]("---------------baidu---------"+t),this["RewardIndex"]=t,""==n[a0_0x1b8a("0x296")])return void this[a0_0x1b8a("0x353")]["showToast"]({title:a0_0x1b8a("0x4cc"),icon:"none",duration:1e3,mask:!1});if(n[a0_0x1b8a("0x4d7")])return;n[a0_0x1b8a("0x4d7")]=!0;let a=this[a0_0x1b8a("0x353")]["createRewardedVideoAd"]({adUnitId:n[a0_0x1b8a("0x296")],appSid:n[a0_0x1b8a("0x4c6")]});a[a0_0x1b8a("0x13")](()=>{c[a0_0x1b8a("0xe5")](0),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x3ec")](0),Laya[a0_0x1b8a("0x153")]["setSoundVolume"](0),console["log"](a0_0x1b8a("0x23e"))}),a[a0_0x1b8a("0x226")](t=>{c["setVolume"](.5),Laya[a0_0x1b8a("0x153")]["setMusicVolume"](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](.5),t&&t[a0_0x1b8a("0x12a")]||void 0===t?e&&e(this[a0_0x1b8a("0x59f")],i):(n[a0_0x1b8a("0x353")][a0_0x1b8a("0xd8")]({title:a0_0x1b8a("0x213"),icon:a0_0x1b8a("0x56d"),duration:1e3,mask:!1}),o(this[a0_0x1b8a("0x59f")],i)),n[a0_0x1b8a("0x4d7")]=!1}),a[a0_0x1b8a("0x327")](t=>{console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4bf"),t)}),a[a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x59b")](t=>{a[a0_0x1b8a("0x5d5")]()[a0_0x1b8a("0x1b9")](()=>a[a0_0x1b8a("0x12c")]())})}static[a0_0x1b8a("0x45c")](t){}}n[a0_0x1b8a("0x353")]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")][a0_0x1b8a("0x353")],n[a0_0x1b8a("0x4d4")]=!0,n[a0_0x1b8a("0x4c6")]=a0_0x1b8a("0x188"),n[a0_0x1b8a("0x561")]=a0_0x1b8a("0x601"),n[a0_0x1b8a("0x296")]=a0_0x1b8a("0x473"),n[a0_0x1b8a("0x4d7")]=!1,n[a0_0x1b8a("0x4ce")]=null,n["interstitialAd"]=null,n[a0_0x1b8a("0x350")]=null,n[a0_0x1b8a("0x1b")]=null,n["rewardedVideoAd"]=null,n[a0_0x1b8a("0x43f")]=null,n[a0_0x1b8a("0x59f")]="";class b{static[a0_0x1b8a("0x464")](){}static[a0_0x1b8a("0x478")](){this[a0_0x1b8a("0x4d4")]?(h["Instance"]["Data"]["LuckyFree"]=1,h["Instance"][a0_0x1b8a("0x28e")](),d[a0_0x1b8a("0x312")]=[_["Instance"][a0_0x1b8a("0x5fd")](1)["hp"],_[a0_0x1b8a("0x281")]["GetLevelInfo"](2)["hp"],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](3)["hp"],_["Instance"][a0_0x1b8a("0x5fd")](4)["hp"]],d[a0_0x1b8a("0x2d0")]=[_[a0_0x1b8a("0x281")]["GetLevelInfo"](1)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](2)[a0_0x1b8a("0x593")],_["Instance"]["GetLevelInfo"](3)[a0_0x1b8a("0x593")],_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fd")](4)[a0_0x1b8a("0x593")]]):(d["initHp"]=[20,20,20,20],d[a0_0x1b8a("0x2d0")]=[20,20,20,20])}static[a0_0x1b8a("0x608")](t,e=""){}static[a0_0x1b8a("0x13e")](t,e,o,i,a,r){}static["ShareInitiative"](t,e,o,i,a,r){}static[a0_0x1b8a("0x516")](){}static[a0_0x1b8a("0x310")](){}static["HideBanner"](){}static["LoadGridAd"](){}static["ShowGrid"](){}static[a0_0x1b8a("0xc5")](){}static[a0_0x1b8a("0x4c1")](){}static[a0_0x1b8a("0x1a")](){Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")][a0_0x1b8a("0xea")]["showInterstitialId"]()}static[a0_0x1b8a("0xcf")](t,e,o){}static[a0_0x1b8a("0x273")](t){}static[a0_0x1b8a("0x150")](t,e,o){}static["ShowItemVideo"](t){}static[a0_0x1b8a("0x547")](t,e,o){}static[a0_0x1b8a("0xb4")](t,e,o,i){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x5e7")+t),this[a0_0x1b8a("0x59f")]=t,this["thisObj"]=i,b["videoCallbackSuccess"]=e,b[a0_0x1b8a("0x452")]=o,Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")][a0_0x1b8a("0xea")][a0_0x1b8a("0x3b8")]()}static["showVideoAdSuccess"](){b[a0_0x1b8a("0x3a0")](this["RewardIndex"],this["thisObj"])}static[a0_0x1b8a("0x60d")](){b[a0_0x1b8a("0x452")](this["RewardIndex"],this[a0_0x1b8a("0x71")])}static[a0_0x1b8a("0x45c")](t){}}b["isDebug"]=!0,b[a0_0x1b8a("0x59f")]="",b[a0_0x1b8a("0x3a0")]=null,b[a0_0x1b8a("0x452")]=null,b[a0_0x1b8a("0x71")]=null,Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")]&&(Laya["Browser"]["window"][a0_0x1b8a("0x3d7")]=b);class i{static["SdkInit"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x183")),this[a0_0x1b8a("0x8a")]=this[a0_0x1b8a("0x291")][a0_0x1b8a("0x61f")]({adUnitId:this[a0_0x1b8a("0x275")]}),this["rewardedVideoAd"]=this[a0_0x1b8a("0x291")]["createRewardedVideoAd"]({adUnitId:this[a0_0x1b8a("0x296")]}),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1f1"));var e=this;this[a0_0x1b8a("0x420")]["onClose"](t=>{t&&t["isEnded"]||void 0===t?e["videoSuccess"](e[a0_0x1b8a("0x59f")],e[a0_0x1b8a("0x26b")]):e[a0_0x1b8a("0x7f")](e["RewardIndex"],e[a0_0x1b8a("0x26b")])}),this[a0_0x1b8a("0x1d1")]=this[a0_0x1b8a("0x280")]["createMediaRecorder"](),null!==this["mediaRecorder"]?(this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x15a")](function(){console[a0_0x1b8a("0x14e")]("录频开始成功")}),this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x288")](function(t){t&&t[a0_0x1b8a("0x595")]?console[a0_0x1b8a("0x14e")]("录屏停止，录制成功"):console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x27d"))}),this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x327")](function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1d6")+JSON[a0_0x1b8a("0x60a")](t)+" ")})):console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x453"))}static["RecorderStart"](){console[a0_0x1b8a("0x14e")]("------开始录屏-----RecorderStart-------------"),this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x308")]()}static["RecorderStop"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1dc")),this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x4a2")]()}static[a0_0x1b8a("0x552")](e){this[a0_0x1b8a("0x1d1")][a0_0x1b8a("0x5ff")]({callback:t=>{if(null!=t&&null!=t)return console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x49a")+JSON[a0_0x1b8a("0x60a")](t)),void e({code:0});e({code:1}),console["log"](a0_0x1b8a("0x29e"))}})}static["ShowInterstitialAd"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x7c")),this[a0_0x1b8a("0x8a")]["show"]()["then"](function(t){console["log"]("show interstitial ad success, result is "+t)})[a0_0x1b8a("0x59b")](function(t){console[a0_0x1b8a("0x14e")]("插屏错误："+JSON[a0_0x1b8a("0x60a")](t)),t[a0_0x1b8a("0x2c0")]})}static[a0_0x1b8a("0xb4")](t,e,o,i){this["RewardIndex"]=t,this[a0_0x1b8a("0x26b")]=i,this[a0_0x1b8a("0x44a")]=e,this[a0_0x1b8a("0x7f")]=o,this[a0_0x1b8a("0x420")][a0_0x1b8a("0x12c")]()[a0_0x1b8a("0x1b9")](()=>console["log"](a0_0x1b8a("0x18f")))}}i[a0_0x1b8a("0x291")]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")]["ks"],i[a0_0x1b8a("0x280")]=Laya[a0_0x1b8a("0x16c")][a0_0x1b8a("0x476")][a0_0x1b8a("0x291")],i[a0_0x1b8a("0x4d4")]=!0,i[a0_0x1b8a("0x275")]=a0_0x1b8a("0x2ce"),i[a0_0x1b8a("0x296")]=a0_0x1b8a("0x485"),i[a0_0x1b8a("0x8a")]=null,i[a0_0x1b8a("0x420")]=null,i["mediaRecorder"]=null,i["videoSuccess"]=null,i[a0_0x1b8a("0x7f")]=null,i[a0_0x1b8a("0x26b")]=null,i[a0_0x1b8a("0x59f")]="";class l{static["SdkInit"](){}static[a0_0x1b8a("0xb4")](o,i,a,r){r["_pause"]=1;ADManageLaya[a0_0x1b8a("0x584")]()[a0_0x1b8a("0x4ba")](t=>{if(t){this[a0_0x1b8a("0x59f")]=o,this["anyThis"]=r,this[a0_0x1b8a("0x44a")]=i,this[a0_0x1b8a("0x7f")]=a,this[a0_0x1b8a("0x44a")](this[a0_0x1b8a("0x59f")],this[a0_0x1b8a("0x26b")]);var e=this;r[a0_0x1b8a("0x222")]=!1;e[a0_0x1b8a("0x44a")](e[a0_0x1b8a("0x59f")],e["anyThis"])}else{r[a0_0x1b8a("0x222")]=!1}})}}l["window"]=Laya["Browser"][a0_0x1b8a("0x476")],l[a0_0x1b8a("0x8a")]=null,l[a0_0x1b8a("0x420")]=null,l[a0_0x1b8a("0x44a")]=null,l["failedSuccess"]=null,l[a0_0x1b8a("0x26b")]=null,l["RewardIndex"]="";class u{static[a0_0x1b8a("0x464")](){a0_0x1b8a("0x22c")==u["platform"]?x[a0_0x1b8a("0x464")](function(t){u[a0_0x1b8a("0x33a")]=t[a0_0x1b8a("0x31a")]}):"huawei"==u[a0_0x1b8a("0x82")]?a[a0_0x1b8a("0x464")]():a0_0x1b8a("0x1ce")==u["platform"]?n["SdkInit"]():a0_0x1b8a("0x5b5")==u[a0_0x1b8a("0x82")]?i["SdkInit"]():a0_0x1b8a("0xea")==u[a0_0x1b8a("0x82")]?b[a0_0x1b8a("0x464")]():a0_0x1b8a("0x1fc")==u[a0_0x1b8a("0x82")]&&l[a0_0x1b8a("0x464")]()}static[a0_0x1b8a("0x187")](){a0_0x1b8a("0x22c")==u[a0_0x1b8a("0x82")]?x[a0_0x1b8a("0x187")]():a0_0x1b8a("0x1d4")==u[a0_0x1b8a("0x82")]&&a[a0_0x1b8a("0x187")]()}static[a0_0x1b8a("0x4f1")](){a0_0x1b8a("0x22c")==u[a0_0x1b8a("0x82")]?x["ShowNaticeInterstitial"]():a0_0x1b8a("0x1d4")==u[a0_0x1b8a("0x82")]?a[a0_0x1b8a("0x4f1")]():a0_0x1b8a("0xea")==u[a0_0x1b8a("0x82")]||a0_0x1b8a("0xea")==u["platform"]||a0_0x1b8a("0x5b5")==u[a0_0x1b8a("0x82")]&&i[a0_0x1b8a("0x1a")]()}static[a0_0x1b8a("0xb1")](){"vivo"==u[a0_0x1b8a("0x82")]&&x["moreGame"]()}static[a0_0x1b8a("0x1a")](){"android"==u[a0_0x1b8a("0x82")]&&b[a0_0x1b8a("0x1a")]()}static[a0_0x1b8a("0xb4")](t,e,o,i){l["ShowRewardVideo"](t,e,o,i)}static["ShowBanner"](){a0_0x1b8a("0x22c")==u["platform"]?x["ShowBanner"]():"huawei"==u[a0_0x1b8a("0x82")]?a[a0_0x1b8a("0x310")]():a0_0x1b8a("0x1ce")==u[a0_0x1b8a("0x82")]&&n[a0_0x1b8a("0x310")]()}static[a0_0x1b8a("0x21b")](){a0_0x1b8a("0x22c")==u["platform"]?x["HideBanner"]():a0_0x1b8a("0x1d4")==u[a0_0x1b8a("0x82")]?a["HideBanner"]():"baidu"==u[a0_0x1b8a("0x82")]&&n[a0_0x1b8a("0x21b")]()}static[a0_0x1b8a("0x3a1")](){a0_0x1b8a("0x5b5")==u[a0_0x1b8a("0x82")]&&i["RecorderStart"]()}static[a0_0x1b8a("0x1a4")](){a0_0x1b8a("0x5b5")==u["platform"]&&i["RecorderStop"]()}static[a0_0x1b8a("0x552")](t){"kuaishou"==u[a0_0x1b8a("0x82")]&&i[a0_0x1b8a("0x552")](t)}}u[a0_0x1b8a("0x82")]="4399",u[a0_0x1b8a("0x33a")]=!1;class y{constructor(){this[a0_0x1b8a("0x2a8")]=1,this[a0_0x1b8a("0x3f0")]=null,this[a0_0x1b8a("0x222")]=!1,this[a0_0x1b8a("0x47")]=[],this[a0_0x1b8a("0x2b4")]=[],this[a0_0x1b8a("0x41c")]=[],this[a0_0x1b8a("0x37e")]=[],this[a0_0x1b8a("0x58e")]=[],this[a0_0x1b8a("0x4f4")]=[],this[a0_0x1b8a("0x39")]=[],this[a0_0x1b8a("0xaf")]=!1,this["_money"]=0,this[a0_0x1b8a("0x5c8")]=0,this[a0_0x1b8a("0x499")]=0,this[a0_0x1b8a("0x258")]=!1,this["Arr"]=[],this["ArrDir"]=[0,0],this["ArrPos"]=[],this[a0_0x1b8a("0x56a")]=0}[a0_0x1b8a("0x308")](t=0,e=!1){t<=0&&(t=d["getLevelNumer"]()),this[a0_0x1b8a("0xaf")]=!1,this[a0_0x1b8a("0x258")]=!0;let o=_["Instance"][a0_0x1b8a("0x5d0")](t);if(0==d[a0_0x1b8a("0x2a9")]){if(null==o||t>d[a0_0x1b8a("0xfd")][h[a0_0x1b8a("0x281")]["getSelfMap"]()])return void this["GameOver"](!0)}else if(null==o||t>999)return void this[a0_0x1b8a("0x594")](!0);this[a0_0x1b8a("0x2a8")]=t,this["_count"]=[],this[a0_0x1b8a("0x499")]=0,this[a0_0x1b8a("0x5c8")]=0,this[a0_0x1b8a("0x4f4")]=[];let i=[],a=[];this[a0_0x1b8a("0x39")]=[],this["_timer"]=[],this[a0_0x1b8a("0x2b4")]=[],this[a0_0x1b8a("0x41c")]=[],this["_count"]=[],this["_PointID"]=[];for(let e=1;e<5;e++)if(i=[],a=[],o["ids"+e]){for(let t=0;t<o["cd"+e]["length"];t++)i[a0_0x1b8a("0x198")](1e3*o["cd"+e][t][0]),a[a0_0x1b8a("0x198")](1e3*o["cd"+e][t][1]);this[a0_0x1b8a("0x4f4")][a0_0x1b8a("0x198")](i),this["_nextcd"]["push"](a),this[a0_0x1b8a("0x58e")][a0_0x1b8a("0x198")](JSON[a0_0x1b8a("0x428")](JSON[a0_0x1b8a("0x60a")](o[a0_0x1b8a("0x3ae")+e]))),this["_timer"][a0_0x1b8a("0x198")](0),this[a0_0x1b8a("0x2b4")][a0_0x1b8a("0x198")](0),this[a0_0x1b8a("0x37e")]["push"](e-1)}for(let t=0;t<this[a0_0x1b8a("0x58e")]["length"];t++)this[a0_0x1b8a("0x41c")][a0_0x1b8a("0x198")](this[a0_0x1b8a("0x58e")][t][0][0][0]);this[a0_0x1b8a("0x60c")](),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["ShowLabel"](e)}["initArray"](){this[a0_0x1b8a("0x1c3")][a0_0x1b8a("0x6f")]=0;for(var t=0;t<3;++t){var e=new Laya[a0_0x1b8a("0x1de")];e[a0_0x1b8a("0x11e")]=a0_0x1b8a("0x548"),e[a0_0x1b8a("0x46b")]=.5,e[a0_0x1b8a("0x36a")]=.5;var o=new Laya["Image"];o[a0_0x1b8a("0x11e")]=a0_0x1b8a("0x236"),o["anchorX"]=.5,o[a0_0x1b8a("0x36a")]=.5,o[a0_0x1b8a("0x357")]=32,o[a0_0x1b8a("0x22f")]=36,o["x"]=34,o["y"]=51,e["addChild"](o),this["Arr"][a0_0x1b8a("0x198")](e),I["Instance"][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x254")][a0_0x1b8a("0x40a")](e)}this[a0_0x1b8a("0x58b")]()}[a0_0x1b8a("0x58b")](){this[a0_0x1b8a("0x1c3")][0][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1c3")][1][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1c3")][2][a0_0x1b8a("0x212")]=!1,this["Arr"][0]["alpha"]=1,this[a0_0x1b8a("0x1c3")][1]["alpha"]=1,this["Arr"][2][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x105")]=[0,0,0]}[a0_0x1b8a("0x599")](t){if(null!=t){this[a0_0x1b8a("0x1c3")][this[a0_0x1b8a("0x56a")]][a0_0x1b8a("0x5f2")]=0;var e=this[a0_0x1b8a("0x1c3")][this["_index"]]["getChildAt"](0);t["x"]>=6?(t["x"]=6,this["Arr"][this[a0_0x1b8a("0x56a")]]["rotation"]=90,e["rotation"]=-90,e["x"]=36,e["y"]=49):t["x"]<=0?(t["x"]=0,this["Arr"][this["_index"]]["rotation"]=-90,e["rotation"]=90,e["x"]=34,e["y"]=48):(this["Arr"][this[a0_0x1b8a("0x56a")]][a0_0x1b8a("0x5f2")]=0,e["rotation"]=0,e["x"]=34,e["y"]=51),this["Arr"][this["_index"]]["x"]=t["x"]*d[a0_0x1b8a("0x357")]+d[a0_0x1b8a("0x357")]/2,this["Arr"][this[a0_0x1b8a("0x56a")]]["y"]=t["y"]*d[a0_0x1b8a("0x22f")]+d["height"]/2,0==this["Arr"][this[a0_0x1b8a("0x56a")]][a0_0x1b8a("0x5f2")]?this[a0_0x1b8a("0x1c3")][this[a0_0x1b8a("0x56a")]]["y"]-=d[a0_0x1b8a("0x22f")]:90==this["Arr"][this[a0_0x1b8a("0x56a")]][a0_0x1b8a("0x5f2")]?this["Arr"][this[a0_0x1b8a("0x56a")]]["x"]+=d["width"]:this[a0_0x1b8a("0x1c3")][this[a0_0x1b8a("0x56a")]]["x"]-=d[a0_0x1b8a("0x357")],this[a0_0x1b8a("0x1c3")][this["_index"]][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x105")][0]=0,this[a0_0x1b8a("0x105")][1]=0,this[a0_0x1b8a("0x105")][2]=0,this[a0_0x1b8a("0x454")][0]={x:this[a0_0x1b8a("0x1c3")][0]["x"],y:this["Arr"][0]["y"]},this[a0_0x1b8a("0x454")][1]={x:this[a0_0x1b8a("0x1c3")][1]["x"],y:this[a0_0x1b8a("0x1c3")][1]["y"]},this[a0_0x1b8a("0x454")][2]={x:this[a0_0x1b8a("0x1c3")][2]["x"],y:this[a0_0x1b8a("0x1c3")][2]["y"]},Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x1c3")][this[a0_0x1b8a("0x56a")]],{alpha:0},500,null,null,3e3),this[a0_0x1b8a("0x56a")]++,this[a0_0x1b8a("0x56a")]>2&&(this[a0_0x1b8a("0x56a")]=0)}}[a0_0x1b8a("0x2a3")](t,e){t["visible"]&&(0==t[a0_0x1b8a("0x5f2")]?0==this[a0_0x1b8a("0x105")][e]?(t["y"]-=1,Math[a0_0x1b8a("0x46c")](t["y"]-this[a0_0x1b8a("0x454")][e]["y"])>5&&(this["ArrDir"][e]=1)):(t["y"]+=1,Math[a0_0x1b8a("0x46c")](t["y"]-this[a0_0x1b8a("0x454")][e]["y"])>5&&(this["ArrDir"][e]=0)):90==t[a0_0x1b8a("0x5f2")]?0==this[a0_0x1b8a("0x105")][e]?(t["x"]-=1,Math[a0_0x1b8a("0x46c")](t["x"]-this[a0_0x1b8a("0x454")][e]["x"])>5&&(this[a0_0x1b8a("0x105")][e]=1)):(t["x"]+=1,Math[a0_0x1b8a("0x46c")](t["x"]-this[a0_0x1b8a("0x454")][e]["x"])>5&&(this["ArrDir"][e]=0)):0==this["ArrDir"][e]?(t["x"]+=1,Math[a0_0x1b8a("0x46c")](t["x"]-this["ArrPos"][e]["x"])>5&&(this[a0_0x1b8a("0x105")][e]=1)):(t["x"]-=1,Math[a0_0x1b8a("0x46c")](t["x"]-this["ArrPos"][e]["x"])>5&&(this[a0_0x1b8a("0x105")][e]=0)))}[a0_0x1b8a("0x413")](t=-1,e=-1,o=-1){-1==t&&(t=this[a0_0x1b8a("0x2a8")]),0==t&&(t=this[a0_0x1b8a("0x2a8")]),this[a0_0x1b8a("0x3f0")]=_[a0_0x1b8a("0x281")]["GetMap"](t),this[a0_0x1b8a("0x3f0")]?(this[a0_0x1b8a("0x2a8")]=t,this[a0_0x1b8a("0xaf")]=!1,-1!=o&&(this[a0_0x1b8a("0x41c")][o]=e),this[a0_0x1b8a("0x222")]=!1):this["GameOver"](!0)}[a0_0x1b8a("0xa4")](t,e){this["startEx"](this["_mapID"],e,t)}[a0_0x1b8a("0x41d")](){if(0!=this["_isWait"]&&!(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5d6")]()<=0)){if(0==d[a0_0x1b8a("0x2a9")]&&this[a0_0x1b8a("0x3f0")]){let t=h[a0_0x1b8a("0x281")]["getModel"]();this[a0_0x1b8a("0x3f0")][a0_0x1b8a("0xbe")][t-1][0]>0&&0==h["Instance"]["getUnlock"]("r"+this["_mapID"])?(I["Instance"]["GetBattleControl"]()["ShowGetTips"](this[a0_0x1b8a("0x3f0")][a0_0x1b8a("0xbe")][t-1][0],this[a0_0x1b8a("0x3f0")][a0_0x1b8a("0xbe")][t-1][1],!0),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x4e0")]("r"+this[a0_0x1b8a("0x2a8")])):this["_map_data"][a0_0x1b8a("0x458")][t-1][0]>0&&I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["ShowGetTips"](this[a0_0x1b8a("0x3f0")][a0_0x1b8a("0x458")][t-1][0],this[a0_0x1b8a("0x3f0")][a0_0x1b8a("0x458")][t-1][1],!1)}d[a0_0x1b8a("0x466")]++,d[a0_0x1b8a("0x466")]>=d["InterstitialMaxCount"]&&(d[a0_0x1b8a("0x466")]=0,console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x36"))),this["_mapID"]%3==0&&u[a0_0x1b8a("0x1a")](),console["log"](a0_0x1b8a("0x43")),this[a0_0x1b8a("0x308")](this[a0_0x1b8a("0x2a8")]+1,!0)}}["tick"](){if(!this[a0_0x1b8a("0x222")]&&!this[a0_0x1b8a("0xaf")]){for(let t=0;t<this[a0_0x1b8a("0x2b4")][a0_0x1b8a("0x6f")];t++)if(this["_timerWait"][t]<=this[a0_0x1b8a("0x4f4")][t][0])this[a0_0x1b8a("0x2b4")][t]+=d[a0_0x1b8a("0xa2")],this["_timerWait"][t]>=this[a0_0x1b8a("0x4f4")][t][0]&&this[a0_0x1b8a("0x599")](d[a0_0x1b8a("0x2f6")][this[a0_0x1b8a("0x37e")][t]]);else if(this[a0_0x1b8a("0x47")][t]<=this[a0_0x1b8a("0x39")][t][0])this[a0_0x1b8a("0x47")][t]+=d[a0_0x1b8a("0xa2")];else if(this["_timer"][t]=0,this["_count"][t][0][0][1]--,this[a0_0x1b8a("0x58e")][t][0][0][1]<0)if(this[a0_0x1b8a("0x58e")][t][0]["shift"](),0==this[a0_0x1b8a("0x58e")][t][0][a0_0x1b8a("0x6f")])if(this[a0_0x1b8a("0x58e")][t][a0_0x1b8a("0x3fe")](),this["_waveCD"][t]["shift"](),this[a0_0x1b8a("0x39")][t]["shift"](),0==this[a0_0x1b8a("0x58e")][t][a0_0x1b8a("0x6f")]){if(this[a0_0x1b8a("0x58e")]["splice"](t,1),this[a0_0x1b8a("0x2b4")][a0_0x1b8a("0x39f")](t,1),this[a0_0x1b8a("0x4f4")]["splice"](t,1),this[a0_0x1b8a("0x39")][a0_0x1b8a("0x39f")](t,1),this[a0_0x1b8a("0x47")][a0_0x1b8a("0x39f")](t,1),this[a0_0x1b8a("0x41c")][a0_0x1b8a("0x39f")](t,1),this[a0_0x1b8a("0x37e")][a0_0x1b8a("0x39f")](t,1),0==this[a0_0x1b8a("0x2b4")][a0_0x1b8a("0x6f")])return this[a0_0x1b8a("0xaf")]=!0,this[a0_0x1b8a("0x222")]=!0,void this[a0_0x1b8a("0x58b")]()}else this[a0_0x1b8a("0x2b4")][t]=0,this[a0_0x1b8a("0xa4")](t,this[a0_0x1b8a("0x58e")][t][0][0][0]);else this["next"](t,this[a0_0x1b8a("0x58e")][t][0][0][0]);else A["Instance"][a0_0x1b8a("0x3aa")](this["_monsterID"][t],this["_PointID"][t]);this[a0_0x1b8a("0x2a3")](this[a0_0x1b8a("0x1c3")][0],0),this[a0_0x1b8a("0x2a3")](this[a0_0x1b8a("0x1c3")][1],1),this[a0_0x1b8a("0x2a3")](this[a0_0x1b8a("0x1c3")][2],2)}}[a0_0x1b8a("0x3c6")](t){h[a0_0x1b8a("0x281")][a0_0x1b8a("0xc4")](t),I[a0_0x1b8a("0x281")]["GetBattleControl"]()[a0_0x1b8a("0x59e")](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x472")]()}[a0_0x1b8a("0x28d")](t){return!(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2db")]()<t)&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0xc4")](-t),I[a0_0x1b8a("0x281")]["GetBattleControl"]()["SetMoney"](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x472")](),!0)}[a0_0x1b8a("0x133")](){return h[a0_0x1b8a("0x281")]["getMoney"]()}[a0_0x1b8a("0x16f")](){if(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5d6")]()>0){h[a0_0x1b8a("0x281")]["DelHp"](1);if(I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x32d")](),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["SetHP"](),0==h[a0_0x1b8a("0x281")]["getHp"]())return void I["Instance"][a0_0x1b8a("0x289")]()["onCloseFuhuo"]()}}["GameOver"](t){this["Pause"](!0),c[a0_0x1b8a("0x441")](t?a0_0x1b8a("0x15d"):a0_0x1b8a("0x5c3")),d[a0_0x1b8a("0x466")]++,d[a0_0x1b8a("0x466")]>=d[a0_0x1b8a("0x616")]&&(d["InterstitialCount"]=0,u["ShowNaticeInterstitial"]()),console["log"](a0_0x1b8a("0x36")),u[a0_0x1b8a("0x1a")](),0==d[a0_0x1b8a("0x2a9")]?I[a0_0x1b8a("0x281")]["GetBattleControl"]()[a0_0x1b8a("0x438")](t):I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x12d")](t);ADManageLaya[a0_0x1b8a("0x584")]()[a0_0x1b8a("0x167")]()}["Pause"](t){this["_pause"]=t}}y[a0_0x1b8a("0x281")]=new y;class m{constructor(){this[a0_0x1b8a("0x5f")]=null,this[a0_0x1b8a("0x3f8")]=null,this[a0_0x1b8a("0xe3")]=null,this[a0_0x1b8a("0x426")]=null,this[a0_0x1b8a("0x3bd")]=null,this[a0_0x1b8a("0x617")]=null,this[a0_0x1b8a("0x3d8")]=0,this["_x"]=0,this["_y"]=0,this["_path"]=[],this["_bNeedUpdatePath"]=!1,this[a0_0x1b8a("0x493")]=0,this[a0_0x1b8a("0x2c")]=100,this["_hpMax"]=100,this[a0_0x1b8a("0x56f")]=100,this[a0_0x1b8a("0x15e")]={x:0,y:0},this[a0_0x1b8a("0x4a0")]={x:0,y:0},this[a0_0x1b8a("0x26e")]={v:1,t:0},this[a0_0x1b8a("0x1c6")]=0,this[a0_0x1b8a("0x2f3")]=null,this["_tabResource"]=null,this[a0_0x1b8a("0x5a4")]=a0_0x1b8a("0x542"),this[a0_0x1b8a("0x255")]="",this[a0_0x1b8a("0x580")]=0,this[a0_0x1b8a("0x30a")]=!1}[a0_0x1b8a("0x1b4")](){this[a0_0x1b8a("0x493")]=0}[a0_0x1b8a("0x5a5")](){return this[a0_0x1b8a("0x493")]>0}[a0_0x1b8a("0x1bb")](t=!1){(t||this[a0_0x1b8a("0x162")]&&2!=this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x3b0")])&&(this[a0_0x1b8a("0x59a")]=p[a0_0x1b8a("0x281")]["calcPath"](this[a0_0x1b8a("0x580")],{x:this[a0_0x1b8a("0x5f")]["x"],y:this["obj"]["y"]}),this["_path"][a0_0x1b8a("0x3fe")](),this[a0_0x1b8a("0x162")]=!1)}[a0_0x1b8a("0x54f")](){let t=p[a0_0x1b8a("0x281")]["GetGridPos"](this["x"](),this["y"]());null!=t&&(3==t["x"]&&t["y"]>=8||(this[a0_0x1b8a("0x162")]=!0))}[a0_0x1b8a("0x114")](t,e,o,i,a=-1){null==this[a0_0x1b8a("0x3f8")]&&(this[a0_0x1b8a("0x5f")]=new Laya[a0_0x1b8a("0xdc")],this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x46b")]=.5,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x36a")]=.5,this["obj"][a0_0x1b8a("0x357")]=50,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x22f")]=50,this[a0_0x1b8a("0x3f8")]=new Laya[a0_0x1b8a("0x1de")],this[a0_0x1b8a("0x3f8")]["anchorX"]=.5,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x36a")]=.5,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this["img"]),this["img"][a0_0x1b8a("0x2d9")]=0,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x49d")]=0,this["hpbar"]=new Laya[a0_0x1b8a("0x58")],this[a0_0x1b8a("0xe3")]["skin"]=a0_0x1b8a("0x4d6"),this["hpbar"][a0_0x1b8a("0x357")]=45,this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x22f")]=10,this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x361")]=.8,this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x2d9")]=0,this[a0_0x1b8a("0x426")]=new Laya[a0_0x1b8a("0xec")],this[a0_0x1b8a("0xe3")]["y"]=-20,this[a0_0x1b8a("0x5f")]["addChild"](this["anim"]),this[a0_0x1b8a("0x426")]["x"]=0,this[a0_0x1b8a("0x426")]["y"]=0,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x2e9")]=!0,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0xe3")]),this["hpbar"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3bd")]=new Laya[a0_0x1b8a("0xec")],this["obj"]["addChild"](this[a0_0x1b8a("0x3bd")]),this["Slimeanim"]["x"]=0,this[a0_0x1b8a("0x3bd")]["y"]=0,this[a0_0x1b8a("0x617")]=new Laya[a0_0x1b8a("0xec")],this[a0_0x1b8a("0x617")][a0_0x1b8a("0x2e9")]=!0,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x617")]),this["Hittedanim"]["x"]=0,this["Hittedanim"]["y"]=0),this[a0_0x1b8a("0x3d8")]=e,this["_x"]=o,this["_y"]=i,this[a0_0x1b8a("0x580")]=t,this[a0_0x1b8a("0x4e1")](a)}["reset"](t=-1){this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x212")]=!1,this["_tabData"]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x367")](this[a0_0x1b8a("0x3d8")]),this["_tabResource"]=_["Instance"]["GetResource"](this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x3b0")]),this[a0_0x1b8a("0x56f")]=this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x32")]*(d["tick"]/1e3),"重兵"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]?this[a0_0x1b8a("0xe3")]["centerX"]=-5:this[a0_0x1b8a("0xe3")]["centerX"]=0,1==parseInt(this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x398")])&&I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x1d2")]();let e=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x3cc")](this["StartPointID"]);if(-1==t)if(this[a0_0x1b8a("0x59a")]=[],2==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x3b0")])this[a0_0x1b8a("0x59a")][a0_0x1b8a("0x198")]({x:e[0]["x"],y:e[0]["y"]}),this["_path"][a0_0x1b8a("0x198")]({x:e[e["length"]-1]["x"],y:e[e[a0_0x1b8a("0x6f")]-1]["y"]});else for(var o=0;o<e[a0_0x1b8a("0x6f")];o++)this["_path"][a0_0x1b8a("0x198")]({x:e[o]["x"],y:e[o]["y"]});else this["_bNeedUpdatePath"]=!0,this["ReCalcPath"](!0);if(this["img"][a0_0x1b8a("0x212")]=2!=this["_tabResource"][a0_0x1b8a("0x5cb")],this["anim"][a0_0x1b8a("0x212")]=2==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x5cb")],this[a0_0x1b8a("0x426")]["x"]=0,this["anim"]["y"]=0,this[a0_0x1b8a("0x3f8")]["visible"]&&(2==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x3b0")]&&this[a0_0x1b8a("0x59a")][0]["y"]==this[a0_0x1b8a("0x59a")][1]["y"]?this[a0_0x1b8a("0x59a")][0]["x"]<this[a0_0x1b8a("0x59a")][1]["x"]?this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+a0_0x1b8a("0x208"):this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2d1")]["res"]+a0_0x1b8a("0x60"):this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+"_down.png",this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x33b")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4ef")],this[a0_0x1b8a("0x2d1")]["viewsize"]),this[a0_0x1b8a("0x3bb")]={x:this["img"][a0_0x1b8a("0x357")]*this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4ef")],y:this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x22f")]*this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4ef")]}),this[a0_0x1b8a("0x426")]["visible"]){this[a0_0x1b8a("0x426")][a0_0x1b8a("0x33b")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4ef")],this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4ef")]),"monster_8"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x489")]?(this[a0_0x1b8a("0x426")]["x"]=-20,this[a0_0x1b8a("0x426")]["y"]=-20):(this["anim"]["x"]=0,this[a0_0x1b8a("0x426")]["y"]=0);let t=this[a0_0x1b8a("0x2d1")]["animation"]+a0_0x1b8a("0x19c");this[a0_0x1b8a("0x426")][a0_0x1b8a("0x416")](0,!0,t),this["anim"][a0_0x1b8a("0x55b")]=80,this[a0_0x1b8a("0x255")]=t,this["_size"]={x:this["anim"][a0_0x1b8a("0x357")]*this["_tabResource"]["viewsize"],y:this[a0_0x1b8a("0x426")]["height"]*this["_tabResource"][a0_0x1b8a("0x4ef")]}}let i=this[a0_0x1b8a("0x3bb")]["x"]/150;this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x33b")](i,i),this["Slimeanim"]["x"]=this["anim"]["x"]+5,this[a0_0x1b8a("0x3bd")]["y"]=this[a0_0x1b8a("0x426")]["y"]+this[a0_0x1b8a("0x3bb")]["y"]/2,"摩托"==this["_tabResource"][a0_0x1b8a("0x1db")]||a0_0x1b8a("0xad")==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]?(this["Slimeanim"]["x"]-=20,this[a0_0x1b8a("0x3bd")]["y"]-=20):a0_0x1b8a("0x12e")==this[a0_0x1b8a("0x2d1")]["name"]||"飞机2"==this["_tabResource"][a0_0x1b8a("0x1db")]?(this["Slimeanim"]["x"]-=35,this["Slimeanim"]["y"]-=50):a0_0x1b8a("0x151")==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]?(this["Slimeanim"]["x"]-=23,this["Slimeanim"]["y"]-=20):"坦克"==this["_tabResource"]["name"]?(this[a0_0x1b8a("0x3bd")]["x"]-=15,this[a0_0x1b8a("0x3bd")]["y"]-=15):"飞艇"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]&&(this[a0_0x1b8a("0x3bd")]["x"]-=25,this["Slimeanim"]["y"]-=50),this["Slimeanim"][a0_0x1b8a("0x212")]=!1,this["Hittedanim"]["visible"]=!1,this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x243")]=1,this[a0_0x1b8a("0x592")]=this[a0_0x1b8a("0x2f3")]["hp"],this[a0_0x1b8a("0x2c")]=t>0?t:this[a0_0x1b8a("0x592")],this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x212")]=!0,1==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x3b0")]?I[a0_0x1b8a("0x281")]["GetBattleControl"]()["_monster"][a0_0x1b8a("0x40a")](this["obj"]):I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x4c4")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x5f")]),this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x9f")](this["_x"],this["_y"]),this["_status"]=1,this["run"](),this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]&&c[a0_0x1b8a("0x47a")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]),this["bRelease"]=!1}["x"](){return this["obj"]["x"]}["y"](){return this[a0_0x1b8a("0x5f")]["y"]}[a0_0x1b8a("0x51c")](t,e,o,i){if(this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x212")]||(this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x212")]=!0),null!=i){"摩托"==this["_tabResource"][a0_0x1b8a("0x1db")]||a0_0x1b8a("0xad")==this["_tabResource"][a0_0x1b8a("0x1db")]?a0_0x1b8a("0x422")==i?(this[a0_0x1b8a("0x617")]["x"]=-25,this[a0_0x1b8a("0x617")]["y"]=-20):(this["Hittedanim"]["x"]=-25,this[a0_0x1b8a("0x617")]["y"]=-30):a0_0x1b8a("0x12e")==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]||a0_0x1b8a("0x190")==this[a0_0x1b8a("0x2d1")]["name"]?"sdsj"==i?(this[a0_0x1b8a("0x617")]["x"]=-55,this[a0_0x1b8a("0x617")]["y"]=-50):(this[a0_0x1b8a("0x617")]["x"]=-55,this[a0_0x1b8a("0x617")]["y"]=-70):"导弹车"==this["_tabResource"][a0_0x1b8a("0x1db")]?a0_0x1b8a("0x422")==i?(this["Hittedanim"]["x"]=-30,this[a0_0x1b8a("0x617")]["y"]=-40):(this[a0_0x1b8a("0x617")]["x"]=-30,this[a0_0x1b8a("0x617")]["y"]=-50):"坦克"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]?a0_0x1b8a("0x422")==i?(this[a0_0x1b8a("0x617")]["x"]=-20,this["Hittedanim"]["y"]=-30):(this[a0_0x1b8a("0x617")]["x"]=-20,this[a0_0x1b8a("0x617")]["y"]=-40):"飞艇"==this["_tabResource"][a0_0x1b8a("0x1db")]?"sdsj"==i?(this[a0_0x1b8a("0x617")]["x"]=-40,this[a0_0x1b8a("0x617")]["y"]=-50):(this[a0_0x1b8a("0x617")]["x"]=-30,this[a0_0x1b8a("0x617")]["y"]=-60):"重兵"==this["_tabResource"]["name"]?a0_0x1b8a("0x422")==i?(this[a0_0x1b8a("0x617")]["x"]=-25,this[a0_0x1b8a("0x617")]["y"]=-25):(this[a0_0x1b8a("0x617")]["x"]=-25,this[a0_0x1b8a("0x617")]["y"]=-45):a0_0x1b8a("0x422")==i?(this[a0_0x1b8a("0x617")]["x"]=0,this[a0_0x1b8a("0x617")]["y"]=0):(this[a0_0x1b8a("0x617")]["x"]=3,this["Hittedanim"]["y"]=0),this["Hittedanim"][a0_0x1b8a("0x212")]||(this["Hittedanim"][a0_0x1b8a("0x212")]=!0),this[a0_0x1b8a("0x617")]["play"](0,!1,i);let t=this[a0_0x1b8a("0x3bb")]["x"]/this[a0_0x1b8a("0x617")][a0_0x1b8a("0x357")];this[a0_0x1b8a("0x617")]["scale"](t,t)}if(t=Math[a0_0x1b8a("0x566")](t),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x512")](t,this[a0_0x1b8a("0x5f")]["x"],this[a0_0x1b8a("0x5f")]["y"]-this["obj"]["height"]/2,this["obj"][a0_0x1b8a("0x22f")],e,o),this[a0_0x1b8a("0x2c")]-=t,this["hpbar"][a0_0x1b8a("0x243")]=this["_hp"]/this[a0_0x1b8a("0x592")],this[a0_0x1b8a("0x2c")]<=0){if(this[a0_0x1b8a("0xe3")][a0_0x1b8a("0x212")]=!1,this["_status"]=0,this[a0_0x1b8a("0x2d1")]["money"]){1==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x168")]&&I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x382")](a0_0x1b8a("0x68"),11);for(let t=0;t<this[a0_0x1b8a("0x2d1")]["money"];t++)A["Instance"]["AddGold"](this[a0_0x1b8a("0x5f")]["x"],this["obj"]["y"])}if(this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x565")])return a0_0x1b8a("0x271")==this[a0_0x1b8a("0x2d1")]["death"]?(this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x212")]=!1,this["anim"]["visible"]=!0,a0_0x1b8a("0x12e")==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]||a0_0x1b8a("0x190")==this["_tabResource"][a0_0x1b8a("0x1db")]?(this["anim"]["x"]-=60,this[a0_0x1b8a("0x426")]["y"]-=55):a0_0x1b8a("0x151")==this["_tabResource"][a0_0x1b8a("0x1db")]?(this[a0_0x1b8a("0x426")]["x"]-=60,this[a0_0x1b8a("0x426")]["y"]-=65):"坦克"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]?(this[a0_0x1b8a("0x426")]["x"]-=60,this[a0_0x1b8a("0x426")]["y"]-=50):"飞艇"==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x1db")]&&(this[a0_0x1b8a("0x426")]["x"]-=70,this[a0_0x1b8a("0x426")]["y"]-=75),this["anim"][a0_0x1b8a("0x416")](0,!1,a0_0x1b8a("0x271")),Laya[a0_0x1b8a("0x5b7")]["once"](1440,this,this[a0_0x1b8a("0x31")])):(this[a0_0x1b8a("0x3f8")]["visible"]=!1,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x212")]=!0,this["anim"]["play"](0,!1,this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x565")]+"_"+this["_dir"]),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1e3,this,this[a0_0x1b8a("0x31")])),this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x37")]&&c[a0_0x1b8a("0x441")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x37")]),void(this["_tabResource"][a0_0x1b8a("0x4a9")]&&c[a0_0x1b8a("0x20a")](this["_tabResource"][a0_0x1b8a("0x4a9")]));this["_tabResource"][a0_0x1b8a("0x37")]&&c[a0_0x1b8a("0x47a")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x37")]),this["release"]()}}["stop"](t){this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]&&(t?c["Stop"](this[a0_0x1b8a("0x2d1")]["sound_move"]):c[a0_0x1b8a("0x47a")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")])),0!=this[a0_0x1b8a("0x426")][a0_0x1b8a("0x212")]&&(t?this[a0_0x1b8a("0x426")][a0_0x1b8a("0x4a2")]():this[a0_0x1b8a("0x426")][a0_0x1b8a("0x416")]())}["calcDir"](){let t=p["Instance"][a0_0x1b8a("0x74")](this["x"](),this["y"]());var i={x:0,y:0};if(null==t){let t=this[a0_0x1b8a("0x15e")]["x"]-this["x"](),e=this[a0_0x1b8a("0x15e")]["y"]-this["y"]();i["x"]=t<0?this[a0_0x1b8a("0x4a0")]["x"]+1:t>0?this[a0_0x1b8a("0x4a0")]["x"]-1:this["_dstGrid"]["x"],i["y"]=e<0?this[a0_0x1b8a("0x4a0")]["y"]+1:e>0?this[a0_0x1b8a("0x4a0")]["y"]-1:this[a0_0x1b8a("0x4a0")]["y"]}else i=t;if(3!=this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x5cb")])if(this[a0_0x1b8a("0x4a0")]["x"]==i["x"]?this["_dir"]=this[a0_0x1b8a("0x4a0")]["y"]>i["y"]?a0_0x1b8a("0x542"):"up":this[a0_0x1b8a("0x4a0")]["y"]==i["y"]&&(this[a0_0x1b8a("0x5a4")]=this[a0_0x1b8a("0x4a0")]["x"]>i["x"]?"right":a0_0x1b8a("0x102")),1==this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x5cb")])this[a0_0x1b8a("0x4a0")]["x"]==i["x"]?this["img"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x4a0")]["y"]>i["y"]?this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+"_down.png":this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+a0_0x1b8a("0x432"):this[a0_0x1b8a("0x4a0")]["y"]==i["y"]&&(this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x11e")]=this["_dstGrid"]["x"]>i["x"]?this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+"_right.png":this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x394")]+"_left.png");else{let t=this["_anim"];if(this["_dstGrid"]["x"]==i["x"]?t=this[a0_0x1b8a("0x4a0")]["y"]>i["y"]?this["_tabResource"][a0_0x1b8a("0x489")]+a0_0x1b8a("0x19c"):this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x489")]+"_up":this["_dstGrid"]["y"]==i["y"]&&(t=this[a0_0x1b8a("0x4a0")]["x"]>i["x"]?this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x489")]+a0_0x1b8a("0x443"):this["_tabResource"]["animation"]+"_left"),t==this[a0_0x1b8a("0x255")])return;this[a0_0x1b8a("0x426")][a0_0x1b8a("0x416")](0,!0,t),this[a0_0x1b8a("0x255")]=t;let e={x:this["anim"]["width"]*this["_tabResource"][a0_0x1b8a("0x4ef")],y:this[a0_0x1b8a("0x426")][a0_0x1b8a("0x22f")]*this[a0_0x1b8a("0x2d1")]["viewsize"]},o=e["x"]/150;this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x33b")](o,o),this[a0_0x1b8a("0x3bd")]["x"]=this[a0_0x1b8a("0x426")]["x"]+5,this[a0_0x1b8a("0x3bd")]["y"]=this["anim"]["y"]+e["y"]/2}}[a0_0x1b8a("0x14a")](){if(this[a0_0x1b8a("0x1bb")](),this["_path"]["length"]>0){let t=this[a0_0x1b8a("0x59a")][a0_0x1b8a("0x3fe")]();this[a0_0x1b8a("0x15e")]=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](t["x"],t["y"]),this["_dstGrid"]=t,this[a0_0x1b8a("0x558")]()}else this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]&&c["Stop"](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]),this["release"](),y[a0_0x1b8a("0x281")][a0_0x1b8a("0x16f")]()}[a0_0x1b8a("0x31")](){this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x199")](),this[a0_0x1b8a("0x493")]=-20,this["_ice"]["t"]=0,this[a0_0x1b8a("0x26e")]["v"]=1,this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x53f")](){0!=this[a0_0x1b8a("0x493")]&&(this["bRelease"]=!0,this[a0_0x1b8a("0x5f")][a0_0x1b8a("0x199")](),this[a0_0x1b8a("0x2d1")]["sound_move"]&&c[a0_0x1b8a("0x20a")](this[a0_0x1b8a("0x2d1")][a0_0x1b8a("0x4a9")]),this["_status"]=0,this[a0_0x1b8a("0x26e")]["t"]=0,this[a0_0x1b8a("0x26e")]["v"]=1,this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x212")]=!1,A[a0_0x1b8a("0x281")][a0_0x1b8a("0x2e2")](this),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x410")](this))}[a0_0x1b8a("0x57b")](){}[a0_0x1b8a("0x347")](t,e){this[a0_0x1b8a("0x26e")]["t"]=t,this[a0_0x1b8a("0x26e")]["v"]=e}[a0_0x1b8a("0x44f")](){return this[a0_0x1b8a("0x30a")]}["tick"](){if(this["_status"]<0)return this[a0_0x1b8a("0x493")]++,void(0==this[a0_0x1b8a("0x493")]&&(this[a0_0x1b8a("0x30a")]=!0));0!=this[a0_0x1b8a("0x5a5")]()&&(this["_ice"]["t"]>0&&(this[a0_0x1b8a("0x26e")]["t"]-=d[a0_0x1b8a("0xa2")],this[a0_0x1b8a("0x26e")]["t"]<=0&&(this[a0_0x1b8a("0x26e")]["t"]=0,this["_ice"]["v"]=1,this[a0_0x1b8a("0x3bd")]["visible"]=!1)),1==this[a0_0x1b8a("0x399")]()&&this["run"]())}[a0_0x1b8a("0x32")](){return this[a0_0x1b8a("0x56f")]*this[a0_0x1b8a("0x26e")]["v"]}[a0_0x1b8a("0x399")](){let o=this["speed"](),i=this[a0_0x1b8a("0x15e")]["x"]-this["x"](),a=this[a0_0x1b8a("0x15e")]["y"]-this["y"](),r=d["GetDistance"](this["_dstPos"]["x"],this["_dstPos"]["y"],this["x"](),this["y"]());if(r>0){let t=a*o/r,e=i*o/r;this["obj"]["x"]+=e,this["obj"]["y"]+=t}return p[a0_0x1b8a("0x281")][a0_0x1b8a("0x614")](this["x"](),this["y"](),this["_id"],this["_hp"]),r<o}[a0_0x1b8a("0x2b6")](t,e=0,o=0){if(t["ice"]&&t["ice"]>0&&1-t[a0_0x1b8a("0x6d")]/100<=this["_ice"]["v"])if(this[a0_0x1b8a("0x347")](t["ice_time"],1-t[a0_0x1b8a("0x6d")]/100),this["_effect_id"]=t[a0_0x1b8a("0x28c")],2==t[a0_0x1b8a("0x28c")]){let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x596")]("bd");this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x416")](0,!0,"bd"),this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x55b")]=t["fps"],this[a0_0x1b8a("0x3bd")]["visible"]=!0}else if(1==t[a0_0x1b8a("0x28c")]){let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x596")]("ny");this[a0_0x1b8a("0x3bd")][a0_0x1b8a("0x416")](0,!0,"ny"),this[a0_0x1b8a("0x3bd")]["interval"]=t[a0_0x1b8a("0x27b")],this["Slimeanim"]["visible"]=!0}else 3==t[a0_0x1b8a("0x28c")]&&this[a0_0x1b8a("0x426")][a0_0x1b8a("0x4a2")]();t[a0_0x1b8a("0xbd")]&&t["damage"]>0?t[a0_0x1b8a("0xbd")]<1?this[a0_0x1b8a("0x51c")](t["damage"]*this[a0_0x1b8a("0x592")],t["color"],t[a0_0x1b8a("0x379")],null):this[a0_0x1b8a("0x51c")](e,t[a0_0x1b8a("0x5e2")],t[a0_0x1b8a("0x379")],null):e>0&&this[a0_0x1b8a("0x51c")](e,t[a0_0x1b8a("0x5e2")],t[a0_0x1b8a("0x379")],null)}}class f{constructor(){this[a0_0x1b8a("0x192")]=null,this[a0_0x1b8a("0x2a4")]=null,this[a0_0x1b8a("0x56f")]=500,this[a0_0x1b8a("0x2f3")]=null,this[a0_0x1b8a("0x264")]=0,this[a0_0x1b8a("0x411")]=0,this[a0_0x1b8a("0x417")]=0,this[a0_0x1b8a("0x44d")]=0,this[a0_0x1b8a("0x4c")]=0}[a0_0x1b8a("0x114")](t,e,o,i,a,r,s){null==this[a0_0x1b8a("0x192")]&&(this["_img"]=new Laya[a0_0x1b8a("0x1de")]),this["_damage"]=r,this[a0_0x1b8a("0x2a4")]=o,this[a0_0x1b8a("0x120")]=s,this[a0_0x1b8a("0x2f3")]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x38")](t),this[a0_0x1b8a("0x2f3")]["offset"]&&(i+=this["_tabData"][a0_0x1b8a("0x35d")][0][0],a+=this["_tabData"]["offset"][0][1]),this[a0_0x1b8a("0x4e1")](e,i,a)}[a0_0x1b8a("0x4e1")](t,e,o){this["_img"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x394")],this[a0_0x1b8a("0x192")]["anchorX"]=.5,this[a0_0x1b8a("0x192")][a0_0x1b8a("0x36a")]=0,this[a0_0x1b8a("0x56f")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x32")]*d[a0_0x1b8a("0xa2")]/1e3,this[a0_0x1b8a("0x192")]["rotation"]=t,this[a0_0x1b8a("0x44d")]=this[a0_0x1b8a("0x2a4")]["x"](),this[a0_0x1b8a("0x4c")]=this[a0_0x1b8a("0x2a4")]["y"](),this[a0_0x1b8a("0x2f3")]["quicken_time"]&&Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x2fd")],this,this["setSpeed"]),this[a0_0x1b8a("0x192")][a0_0x1b8a("0x9f")](e,o+10),0==this["move"](3)&&I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x40f")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x192")])}[a0_0x1b8a("0x377")](){this[a0_0x1b8a("0x264")]=this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x26a")]}["tick"](){return!(null!=this[a0_0x1b8a("0x2a4")]&&0!=this["_target"]["isLive"]()&&!this[a0_0x1b8a("0x399")](1))&&(this["Release"](),!0)}[a0_0x1b8a("0x399")](t){2==this[a0_0x1b8a("0x120")][a0_0x1b8a("0x259")]?this["_tx"]:this[a0_0x1b8a("0x2a4")]["x"](),2==this[a0_0x1b8a("0x120")]["targetType"]?this["_ty"]:this[a0_0x1b8a("0x2a4")]["y"]();let e=(2==this[a0_0x1b8a("0x120")][a0_0x1b8a("0x259")]?this[a0_0x1b8a("0x44d")]:this[a0_0x1b8a("0x2a4")]["x"]())-this[a0_0x1b8a("0x192")]["x"],o=-((2==this[a0_0x1b8a("0x120")][a0_0x1b8a("0x259")]?this[a0_0x1b8a("0x4c")]:this[a0_0x1b8a("0x2a4")]["y"]())-this[a0_0x1b8a("0x192")]["y"]),i=Math[a0_0x1b8a("0x139")](e*e+o*o);if(i<this[a0_0x1b8a("0x56f")])return this[a0_0x1b8a("0x51c")](),!0;0!=this[a0_0x1b8a("0x264")]&&(this[a0_0x1b8a("0x56f")]+=this[a0_0x1b8a("0x264")]);var a=Math[a0_0x1b8a("0x414")](e,o)/(Math["PI"]/180);return this[a0_0x1b8a("0x192")]["rotation"]=a,this[a0_0x1b8a("0x192")]["x"]+=e/(i/(this[a0_0x1b8a("0x56f")]*t)),this[a0_0x1b8a("0x192")]["y"]+=-o/(i/(this["_speed"]*t)),!1}[a0_0x1b8a("0x51c")](){if(this[a0_0x1b8a("0x111")](),2==this["_towerdata"][a0_0x1b8a("0x259")]){var t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x3d0")](this[a0_0x1b8a("0x2f3")]["effect"]);let e=A[a0_0x1b8a("0x281")][a0_0x1b8a("0x24e")](2==this[a0_0x1b8a("0x120")][a0_0x1b8a("0x259")]?this[a0_0x1b8a("0x44d")]:this[a0_0x1b8a("0x2a4")]["x"](),2==this["_towerdata"][a0_0x1b8a("0x259")]?this[a0_0x1b8a("0x4c")]:this[a0_0x1b8a("0x2a4")]["y"](),t[a0_0x1b8a("0x42f")]);for(let t=0;t<e[a0_0x1b8a("0x6f")];t++){e[t][a0_0x1b8a("0x51c")](this[a0_0x1b8a("0x411")],this[a0_0x1b8a("0x120")][a0_0x1b8a("0x35b")],this["_towerdata"][a0_0x1b8a("0x2f4")],this[a0_0x1b8a("0x120")]["targetEffect"])}}this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]&&this[a0_0x1b8a("0x2f3")][a0_0x1b8a("0x545")]>0&&A[a0_0x1b8a("0x281")][a0_0x1b8a("0x172")](this["_tabData"][a0_0x1b8a("0x545")],this[a0_0x1b8a("0x2a4")],this[a0_0x1b8a("0x411")],this[a0_0x1b8a("0x120")]["targetType"])}[a0_0x1b8a("0x111")](){this[a0_0x1b8a("0x264")]=0,this[a0_0x1b8a("0x192")][a0_0x1b8a("0x199")](),Laya[a0_0x1b8a("0x5b7")]["clear"](this,this["tick"])}}class g{constructor(){this[a0_0x1b8a("0x426")]=new Laya[a0_0x1b8a("0xec")],this["_target"]=null,this[a0_0x1b8a("0x411")]=0,this[a0_0x1b8a("0x417")]=0}[a0_0x1b8a("0x557")](t,e,o,i){this[a0_0x1b8a("0x502")]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x3d0")](t),null!=this[a0_0x1b8a("0x502")]&&(this[a0_0x1b8a("0x3d8")]=t,this["_x"]=e["x"](),this["_y"]=e["y"](),this[a0_0x1b8a("0x2a4")]=e,this[a0_0x1b8a("0x411")]=o,this["_type"]=i,this["_data"][a0_0x1b8a("0x598")]?this["play"]():A[a0_0x1b8a("0x281")][a0_0x1b8a("0x2b6")](this["_id"],e,this[a0_0x1b8a("0x411")],this[a0_0x1b8a("0x417")]))}[a0_0x1b8a("0x416")](){if(this["anim"][a0_0x1b8a("0x34d")],this[a0_0x1b8a("0x426")][a0_0x1b8a("0x416")](0,!1,this[a0_0x1b8a("0x502")]["animationName"]),this[a0_0x1b8a("0x426")][a0_0x1b8a("0x55b")]=this[a0_0x1b8a("0x502")][a0_0x1b8a("0x330")]*d["spd"],this[a0_0x1b8a("0x426")][a0_0x1b8a("0x212")]=!0,I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["_effect"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x426")]),5==this["_id"]||6==this[a0_0x1b8a("0x3d8")]||7==this["_id"])this[a0_0x1b8a("0x426")][a0_0x1b8a("0x3a")]=1,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x48b")]=1,this["anim"]["x"]=this["_x"]-75,this[a0_0x1b8a("0x426")]["y"]=this["_y"]-75;else if(10==this[a0_0x1b8a("0x3d8")]){this["_data"][a0_0x1b8a("0x42f")],d[a0_0x1b8a("0x357")];this[a0_0x1b8a("0x426")]["scaleX"]=2,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x48b")]=2,this[a0_0x1b8a("0x426")]["x"]=this["_x"]-100,this[a0_0x1b8a("0x426")]["y"]=this["_y"]-100}else 11==this[a0_0x1b8a("0x3d8")]||12==this[a0_0x1b8a("0x3d8")]?(this[a0_0x1b8a("0x426")][a0_0x1b8a("0x3a")]=1.3,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x48b")]=1.3,this[a0_0x1b8a("0x426")]["x"]=this["_x"]-90,this[a0_0x1b8a("0x426")]["y"]=this["_y"]-90):(this[a0_0x1b8a("0x426")]["scaleX"]=1,this[a0_0x1b8a("0x426")][a0_0x1b8a("0x48b")]=1,this[a0_0x1b8a("0x426")]["x"]=this["_x"]-40,this[a0_0x1b8a("0x426")]["y"]=this["_y"]-40);A[a0_0x1b8a("0x281")][a0_0x1b8a("0x2b6")](this[a0_0x1b8a("0x3d8")],this[a0_0x1b8a("0x2a4")],this[a0_0x1b8a("0x411")],this[a0_0x1b8a("0x417")]),Laya["timer"][a0_0x1b8a("0x3a4")](this[a0_0x1b8a("0x502")][a0_0x1b8a("0x5b7")],this,this["onceReles"])}["onceReles"](){this[a0_0x1b8a("0x426")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x426")]["removeSelf"](),A["Instance"]["AddEffectToPool"](this)}}class v{constructor(){this["_ani"]=new Laya[a0_0x1b8a("0xec")]}[a0_0x1b8a("0x557")](){}[a0_0x1b8a("0x9f")](t,e){this[a0_0x1b8a("0x55a")]=new Laya[a0_0x1b8a("0xec")],I[a0_0x1b8a("0x281")]["GetBattleControl"]()["_path"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x55a")]),this[a0_0x1b8a("0x55a")]["x"]=t-90,this["_ani"]["y"]=e-110,this["_ani"][a0_0x1b8a("0x3a")]=1.5,this[a0_0x1b8a("0x55a")][a0_0x1b8a("0x48b")]=1.5,this[a0_0x1b8a("0x55a")]["play"](0,!1,"gold"),this[a0_0x1b8a("0x55a")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0xe")],this,function(){this[a0_0x1b8a("0x20")]()})}[a0_0x1b8a("0x20")](){let t=this,e=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x59a")][a0_0x1b8a("0x203")](new Laya[a0_0x1b8a("0x104")](20,20));Laya[a0_0x1b8a("0x1e1")]["to"](this["_ani"],{x:e["x"],y:e["y"]-20},200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){I["Instance"][a0_0x1b8a("0x289")]()["_mainui"][a0_0x1b8a("0x212")]||y[a0_0x1b8a("0x281")]["AddMoney"](1),t[a0_0x1b8a("0x55a")][a0_0x1b8a("0x199")](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x483")](t)}))}}class S{constructor(){this[a0_0x1b8a("0x3f8")]=new Array,this["ang"]=0,this["count"]=0,this[a0_0x1b8a("0x50d")]=0}[a0_0x1b8a("0x557")](){for(var t=0;t<10;++t){var e=new Laya[a0_0x1b8a("0xec")];e[a0_0x1b8a("0x3a")]=1.5,e[a0_0x1b8a("0x48b")]=1.5,e[a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x198")](e)}}[a0_0x1b8a("0x5b8")](t,e,o){this[a0_0x1b8a("0x50e")]=Math[a0_0x1b8a("0x5fb")](o/3),this["diamond"]=o;for(var i=0;i<this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x6f")];++i)I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["_path"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x3f8")][i]);for(i=0;i<this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x6f")];++i)i<this[a0_0x1b8a("0x50e")]?(this[a0_0x1b8a("0x303")]=360*Math[a0_0x1b8a("0x295")](),this["img"][i][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x3f8")][i]["x"]=t+35*Math[a0_0x1b8a("0x468")](this[a0_0x1b8a("0x303")])-50,this[a0_0x1b8a("0x3f8")][i]["y"]=e+35*Math["sin"](this["ang"])-80,this[a0_0x1b8a("0x3f8")][i][a0_0x1b8a("0x416")](0,!1,a0_0x1b8a("0x44")),this[a0_0x1b8a("0x3f8")][i]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0xe")],this,this[a0_0x1b8a("0x47d")],[i])):this[a0_0x1b8a("0x3f8")][i][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x47d")](t){t==(this["count"]>this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x6f")]?this[a0_0x1b8a("0x3f8")][a0_0x1b8a("0x6f")]:this[a0_0x1b8a("0x50e")])-1&&this[a0_0x1b8a("0x603")]()}[a0_0x1b8a("0x31")](){Laya["timer"][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0x1b7")])}[a0_0x1b8a("0x1b7")](){}["Move"](){let t=I["Instance"][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x59a")][a0_0x1b8a("0x203")](new Laya["Point"](50,-20));for(var e=this,o=0;o<this["img"][a0_0x1b8a("0x6f")];++o)o<this["count"]&&Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x3f8")][o],{x:t["x"],y:t["y"]},350,null,Laya["Handler"][a0_0x1b8a("0x314")](this,function(t){if(e[a0_0x1b8a("0x3f8")][t]["x"]=0,e[a0_0x1b8a("0x3f8")][t]["y"]=0,e[a0_0x1b8a("0x3f8")][t]["off"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0xe")],this,this[a0_0x1b8a("0x47d")]),e[a0_0x1b8a("0x3f8")][t][a0_0x1b8a("0x199")](),t==this[a0_0x1b8a("0x50e")]-1)return h[a0_0x1b8a("0x281")]["AddDiamond"](e[a0_0x1b8a("0x50d")]),void A[a0_0x1b8a("0x281")][a0_0x1b8a("0xd7")](e)},[o]),750)}}class C{[a0_0x1b8a("0x557")](t,e){this[a0_0x1b8a("0xd5")]=new Laya["Image"],this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x357")]=639,this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x22f")]=59,this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x11e")]=0==t?a0_0x1b8a("0x3c2"):a0_0x1b8a("0x257"),this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x46b")]=.5,this["tipBg"][a0_0x1b8a("0x36a")]=.5,this[a0_0x1b8a("0x4a")]=new Laya[a0_0x1b8a("0x2fe")],this["tipText"][a0_0x1b8a("0x46b")]=.5,this[a0_0x1b8a("0x4a")]["anchorY"]=.5,this["tipText"]["x"]=this["tipBg"][a0_0x1b8a("0x357")]/2,this[a0_0x1b8a("0x4a")]["y"]=this[a0_0x1b8a("0xd5")]["height"]/2,this[a0_0x1b8a("0x4a")][a0_0x1b8a("0x574")]=30,this[a0_0x1b8a("0x4a")][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x20d"),this[a0_0x1b8a("0x4a")]["bold"]=!0,this["tipText"]["stroke"]=3,this[a0_0x1b8a("0x4a")]["strokeColor"]=0==t?"#263b66":a0_0x1b8a("0x2c7"),this["tipBg"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x4a")]),this[a0_0x1b8a("0x4a")][a0_0x1b8a("0x195")]=e}[a0_0x1b8a("0x571")](t,e){this[a0_0x1b8a("0xd5")]["x"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")]/2,this[a0_0x1b8a("0xd5")]["y"]=Laya["stage"][a0_0x1b8a("0x22f")]/2,this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x11e")]=0==t?a0_0x1b8a("0x3c2"):a0_0x1b8a("0x257"),this[a0_0x1b8a("0x4a")][a0_0x1b8a("0x559")]=0==t?a0_0x1b8a("0x173"):a0_0x1b8a("0x2c7"),this[a0_0x1b8a("0x4a")][a0_0x1b8a("0x195")]=e,this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x361")]=1,I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x533")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0xd5")]),Laya[a0_0x1b8a("0x1e1")]["to"](this["tipBg"],{y:this[a0_0x1b8a("0xd5")]["y"]-100,alpha:.25},200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0xd5")][a0_0x1b8a("0x199")](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x75")](this)}),1500)}}class P{[a0_0x1b8a("0x557")](){this["label"]=new Laya[a0_0x1b8a("0x2fe")],this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x574")]=24,this[a0_0x1b8a("0xd1")][a0_0x1b8a("0xff")]=!0,this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x18c")]=2,this[a0_0x1b8a("0xd1")]["anchorX"]=.5,this["label"][a0_0x1b8a("0x36a")]=.5}[a0_0x1b8a("0x18e")](t,e,o,i,a,r){this["label"][a0_0x1b8a("0x559")]=r,this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x195")]=t[a0_0x1b8a("0xdf")](),I["Instance"]["GetBattleControl"]()[a0_0x1b8a("0x59a")]["addChild"](this["label"]),this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x5e2")]=a,this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x3a")]=1,this[a0_0x1b8a("0xd1")][a0_0x1b8a("0x48b")]=1,this[a0_0x1b8a("0xd1")]["alpha"]=1,this[a0_0x1b8a("0xd1")]["x"]=e,this[a0_0x1b8a("0xd1")]["y"]=o,this[a0_0x1b8a("0x4cd")]=new Laya[a0_0x1b8a("0x3f5")],this[a0_0x1b8a("0x4cd")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0xe")],this,this[a0_0x1b8a("0x354")]),this[a0_0x1b8a("0x4cd")]["to"](this[a0_0x1b8a("0xd1")],{scaleX:1.5,scaleY:1.5},100*d[a0_0x1b8a("0x330")],null,0)["to"](this[a0_0x1b8a("0xd1")],{scaleX:1,scaleY:1},100*d[a0_0x1b8a("0x330")],null,0)["to"](this[a0_0x1b8a("0xd1")],{y:this[a0_0x1b8a("0xd1")]["y"]-50,scaleX:.85,scaleY:.85,alpha:.5},300*d[a0_0x1b8a("0x330")],null,250*d[a0_0x1b8a("0x330")]),this[a0_0x1b8a("0x4cd")][a0_0x1b8a("0x416")](0,!1)}[a0_0x1b8a("0x354")](){this[a0_0x1b8a("0x4cd")][a0_0x1b8a("0x3f7")](),this[a0_0x1b8a("0x4cd")]=null,this["label"]["removeSelf"](),A[a0_0x1b8a("0x281")]["AddHitToPool"](this)}}class A{constructor(){this[a0_0x1b8a("0x490")]=new Array,this[a0_0x1b8a("0x37d")]=new Array,this[a0_0x1b8a("0x569")]=new Array,this[a0_0x1b8a("0x570")]=new Array,this[a0_0x1b8a("0x178")]=new Array,this[a0_0x1b8a("0x15")]=new Array,this[a0_0x1b8a("0x4fd")]=new Array,this[a0_0x1b8a("0x59d")]=new Array,this[a0_0x1b8a("0x269")]=new Array,this[a0_0x1b8a("0x2c4")]=new Array,this[a0_0x1b8a("0x2d3")]=new Array,this[a0_0x1b8a("0x33")]=new Array,this[a0_0x1b8a("0x3e8")]=new Array}[a0_0x1b8a("0x57e")](t,e){console[a0_0x1b8a("0x14e")](this["_pool_tip"][a0_0x1b8a("0x6f")]);let o=null;this[a0_0x1b8a("0x3e8")]["length"]>0?o=this[a0_0x1b8a("0x3e8")][a0_0x1b8a("0x31d")]():(o=new C)["init"](t,e),o[a0_0x1b8a("0x571")](t,e)}[a0_0x1b8a("0x75")](t){this["_pool_tip"][a0_0x1b8a("0x198")](t)}[a0_0x1b8a("0x172")](t,e,o,i){let a=null;(a=this[a0_0x1b8a("0x4fd")][a0_0x1b8a("0x6f")]>0?this[a0_0x1b8a("0x4fd")][a0_0x1b8a("0x31d")]():new g)[a0_0x1b8a("0x557")](t,e,o,i)}["AddEffectToPool"](t){this[a0_0x1b8a("0x4fd")]["push"](t)}["AddBullet"](t,e,o,i,a,r,s){let n=null;(n=this[a0_0x1b8a("0x178")]["length"]>0?this[a0_0x1b8a("0x178")]["pop"]():new f)[a0_0x1b8a("0x114")](t,i,a,e,o,r,s),this[a0_0x1b8a("0x15")][a0_0x1b8a("0x198")](n)}[a0_0x1b8a("0x54")](t,e,o){let i=null;(i=this[a0_0x1b8a("0x37d")]["length"]>0?this["_pool_tower"]["pop"]():new s)[a0_0x1b8a("0x114")](t,e,o),this[a0_0x1b8a("0x490")]["push"](i);let a=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](e,o);p[a0_0x1b8a("0x281")][a0_0x1b8a("0x318")](a["x"],a["y"],t)&&this[a0_0x1b8a("0x355")]()}[a0_0x1b8a("0x337")](o,i){for(let e=0;e<this["_list_tower"][a0_0x1b8a("0x6f")];e++){let t=this[a0_0x1b8a("0x490")][e];if(t[a0_0x1b8a("0x5fc")]()==o&&t[a0_0x1b8a("0x15f")]()==i)return t[a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x37d")]["push"](t),this[a0_0x1b8a("0x490")][a0_0x1b8a("0x39f")](e,1),void(p[a0_0x1b8a("0x281")][a0_0x1b8a("0x318")](t[a0_0x1b8a("0x5fc")](),t[a0_0x1b8a("0x15f")](),0)&&this[a0_0x1b8a("0x355")]())}}[a0_0x1b8a("0x355")](){for(var e=0;e<this["_list_monster"]["length"];e++){let t=this[a0_0x1b8a("0x569")][e];t["isLive"]()&&t[a0_0x1b8a("0x54f")]()}}[a0_0x1b8a("0x2e2")](t){this["_pool_monster"][a0_0x1b8a("0x198")](t)}[a0_0x1b8a("0x2d6")](){return this[a0_0x1b8a("0x569")]}[a0_0x1b8a("0x15b")](){return this["_list_tower"]}[a0_0x1b8a("0x3aa")](t,e){let o=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](d[a0_0x1b8a("0x2f6")][e]["x"],d[a0_0x1b8a("0x2f6")][e]["y"]),i=null;i=this[a0_0x1b8a("0x570")]["length"]>0?this[a0_0x1b8a("0x570")][a0_0x1b8a("0x31d")]():new m,this["_list_monster"]["push"](i),o["y"]==d[a0_0x1b8a("0x22f")]/2?o["y"]-=200:o["x"]==d[a0_0x1b8a("0x357")]/2?o["x"]-=100:o["x"]==6.5*d[a0_0x1b8a("0x357")]&&(o["x"]+=100),0==e&&(o["y"]-=200),i[a0_0x1b8a("0x114")](e,t,o["x"],o["y"])}[a0_0x1b8a("0x207")](t,e,o,i){}[a0_0x1b8a("0x2e0")](){for(var t=0;t<this[a0_0x1b8a("0x490")][a0_0x1b8a("0x6f")];t++)this[a0_0x1b8a("0x490")][t]["tick"]();let e=!1;for(t=this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")]-1;t>=0;t--)this[a0_0x1b8a("0x569")][t]["tick"](),e=e||0==this[a0_0x1b8a("0x569")][t][a0_0x1b8a("0x44f")](),this["_list_monster"][t][a0_0x1b8a("0x44f")]()&&(this[a0_0x1b8a("0x570")][a0_0x1b8a("0x198")](this["_list_monster"][t]),this["_list_monster"][a0_0x1b8a("0x39f")](t,1));0==e&&y["Instance"][a0_0x1b8a("0x41d")]();for(let t=this[a0_0x1b8a("0x15")][a0_0x1b8a("0x6f")]-1;t>=0;t--)this[a0_0x1b8a("0x15")][t]["tick"]()&&this[a0_0x1b8a("0x15")][a0_0x1b8a("0x39f")](t,1);for(let e=this[a0_0x1b8a("0x269")]["length"]-1;e>=0;e--){let t=this[a0_0x1b8a("0x269")][e][a0_0x1b8a("0xd1")];this["_list_hurt"][e]["t"]<=0?(this[a0_0x1b8a("0x59d")][a0_0x1b8a("0x198")](this["_list_hurt"][e]),t[a0_0x1b8a("0x199")](),this[a0_0x1b8a("0x269")][a0_0x1b8a("0x39f")](e,1)):(this[a0_0x1b8a("0x269")][e]["t"]--,t["y"]--,t[a0_0x1b8a("0x3a")]+=this[a0_0x1b8a("0x269")][e]["s"],t["scaleY"]+=this[a0_0x1b8a("0x269")][e]["s"],this[a0_0x1b8a("0x269")][e]["s"]-=.1)}}[a0_0x1b8a("0x352")](o,i,a,r){let s=0;for(var n=0;n<this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")];n++){let t=this[a0_0x1b8a("0x569")][n];if(0==t[a0_0x1b8a("0x5a5")]())continue;let e=null;null!=(e=a0_0x1b8a("0x25d")==r?p[a0_0x1b8a("0x281")][a0_0x1b8a("0x92")](t["x"](),t["y"]()):p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](t["x"](),t["y"]()))&&(e["x"]!=o&&e["y"]!=i||Math[a0_0x1b8a("0x46c")](i-e["y"])+Math[a0_0x1b8a("0x46c")](o-e["x"])>a||(o==e["x"]?i<e["y"]?s+=1e6:s+=1:o<e["x"]?s+=1e4:s+=100))}return s}[a0_0x1b8a("0x3ce")](a,r,s){for(var n=null,b=999,x=0;x<this["_list_monster"]["length"];x++){let t=this[a0_0x1b8a("0x569")][x];if(0==t[a0_0x1b8a("0x5a5")]())continue;let e=a-t["x"](),o=r-t["y"](),i=Math[a0_0x1b8a("0x139")](e*e+o*o);i<b&&i<=s&&(b=i,n=t)}return n}["GetTargetsByDir"](o,i,a,r){for(var s=[],n=0;n<this["_list_monster"][a0_0x1b8a("0x6f")];n++){let t=this[a0_0x1b8a("0x569")][n];if(0==t[a0_0x1b8a("0x5a5")]())continue;let e=null;if(null!=(e=a0_0x1b8a("0x25d")==r?p[a0_0x1b8a("0x281")][a0_0x1b8a("0x92")](t["x"](),t["y"]()):p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](t["x"](),t["y"]()))&&(e["x"]==o||e["y"]==i))switch(a){case 1:e["y"]>i&&(a0_0x1b8a("0x25d")==r&&Math[a0_0x1b8a("0x46c")](e["y"]-i)<=7?s[a0_0x1b8a("0x198")](t):e["y"]<11&&s[a0_0x1b8a("0x198")](t));break;case 2:e["x"]>o&&(a0_0x1b8a("0x25d")==r&&Math[a0_0x1b8a("0x46c")](e["x"]-o)<=7?s[a0_0x1b8a("0x198")](t):e["x"]<7&&s[a0_0x1b8a("0x198")](t));break;case 3:e["x"]<o&&(a0_0x1b8a("0x25d")==r&&Math[a0_0x1b8a("0x46c")](e["x"]-o)<=7?s[a0_0x1b8a("0x198")](t):e["x"]>=0&&s[a0_0x1b8a("0x198")](t));break;case 4:e["y"]<i&&(a0_0x1b8a("0x25d")==r&&Math["abs"](e["y"]-i)<=7?s[a0_0x1b8a("0x198")](t):e["y"]>=0&&s[a0_0x1b8a("0x198")](t))}}return s}[a0_0x1b8a("0x24e")](i,a,r){for(var s=[],n=0;n<this["_list_monster"][a0_0x1b8a("0x6f")];n++){let t=this["_list_monster"][n];if(0==t[a0_0x1b8a("0x5a5")]())continue;let e=i-t["x"](),o=a-t["y"]();Math["sqrt"](e*e+o*o)<=r&&s[a0_0x1b8a("0x198")](t)}return s}[a0_0x1b8a("0x469")](t,e,o,i,a,r,s){let n,b=Math[a0_0x1b8a("0x414")](i-e,o-t)*(180/Math["PI"])+180;var x=[];let l,_=0,h=0,d=0;for(var p=0;p<this["_list_monster"]["length"];p++)0!=(l=this[a0_0x1b8a("0x569")][p])[a0_0x1b8a("0x5a5")]()&&(_=t-l["x"](),h=e-l["y"](),(d=Math[a0_0x1b8a("0x139")](_*_+h*h))<=a&&(n=Math["atan2"](l["y"]()-e,l["x"]()-t)*(180/Math["PI"])+180,0==b?r>0&&r<180?l["y"]()>=e&&x[a0_0x1b8a("0x198")](l):l["y"]()<e&&x["push"](l):Math[a0_0x1b8a("0x46c")]((n-b)%360)<=s/2&&x["push"](l)));return x}[a0_0x1b8a("0x576")](t){let e=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x3d0")](t);if(null!=e)for(var o=0;o<this["_list_monster"][a0_0x1b8a("0x6f")];o++){let t=this[a0_0x1b8a("0x569")][o];0!=t[a0_0x1b8a("0x5a5")]()&&t[a0_0x1b8a("0x2b6")](e)}}[a0_0x1b8a("0x10b")](t,e){for(var o=0;o<this[a0_0x1b8a("0x490")][a0_0x1b8a("0x6f")];o++)if(this[a0_0x1b8a("0x490")][o]["GridX"]()==t&&this[a0_0x1b8a("0x490")][o][a0_0x1b8a("0x15f")]()==e)return this["_list_tower"][o];return null}["CheckMonster"](o,i){for(var a=0;a<this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")];a++){let t=this[a0_0x1b8a("0x569")][a];if(0==t["isLive"]())continue;let e=p[a0_0x1b8a("0x281")]["GetGridPos"](t["x"](),t["y"]());if(null!=e&&(e["x"]==o&&e["y"]==i))return!0}return!1}[a0_0x1b8a("0x3f3")](o){for(let e=0;e<this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")];e++){let t=this[a0_0x1b8a("0x569")][e];0!=t[a0_0x1b8a("0x5a5")]()&&t[a0_0x1b8a("0x4a2")](o)}}[a0_0x1b8a("0x2b6")](t,e,o,i){let a=_["Instance"]["GetEffect"](t);if(null==a)return;let r=this[a0_0x1b8a("0x4f3")](e["x"](),e["y"](),a[a0_0x1b8a("0x42f")]);for(let t=0;t<r["length"];t++)r[t][a0_0x1b8a("0x2b6")](a,o,i)}[a0_0x1b8a("0x4f3")](o,i,a){let r=[];for(let e=0;e<this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")];e++){let t=this[a0_0x1b8a("0x569")][e];0!=t[a0_0x1b8a("0x5a5")]()&&(d[a0_0x1b8a("0xf2")](o,i,t["x"](),t["y"]())<=a&&r["push"](t))}return r}[a0_0x1b8a("0x2f2")](t,e,o,i,a){let r=null;this["_pool_hurt"]["length"]>0?r=this["_pool_hurt"]["pop"]():((r={t:0,label:new Laya["Label"],s:5})[a0_0x1b8a("0xd1")][a0_0x1b8a("0x574")]=20,r[a0_0x1b8a("0xd1")][a0_0x1b8a("0xff")]=!0,r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x18c")]=2,r[a0_0x1b8a("0x3ea")]=a0_0x1b8a("0x137")),r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x559")]=a,r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x195")]="-"+t,I["Instance"][a0_0x1b8a("0x289")]()["_path"][a0_0x1b8a("0x40a")](r["label"]),r[a0_0x1b8a("0xd1")]["color"]=i,r[a0_0x1b8a("0xd1")]["x"]=e,r[a0_0x1b8a("0xd1")]["y"]=o,r["t"]=10,r["s"]=.5,a0_0x1b8a("0x5f5")==i?(r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x3a")]=.35,r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x48b")]=.35):(r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x3a")]=1,r[a0_0x1b8a("0xd1")][a0_0x1b8a("0x48b")]=1),this[a0_0x1b8a("0x269")][a0_0x1b8a("0x198")](r)}[a0_0x1b8a("0x512")](t,e,o,i,a,r){let s=null;this["_pool_hit"]["length"]>0?s=this[a0_0x1b8a("0x33")][a0_0x1b8a("0x31d")]():(s=new P)[a0_0x1b8a("0x557")](),s[a0_0x1b8a("0x18e")](t,e,o,i,a,r)}[a0_0x1b8a("0x385")](t){this[a0_0x1b8a("0x33")][a0_0x1b8a("0x198")](t)}[a0_0x1b8a("0xe1")](t,e){let o=null;this[a0_0x1b8a("0x2c4")][a0_0x1b8a("0x6f")]>0?o=this[a0_0x1b8a("0x2c4")][a0_0x1b8a("0x31d")]():(o=new v)[a0_0x1b8a("0x557")](),t+=d[a0_0x1b8a("0x103")](-20,20),o[a0_0x1b8a("0x9f")](t,e),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x593"))}["AddGoldToPool"](t){this[a0_0x1b8a("0x2c4")][a0_0x1b8a("0x198")](t)}[a0_0x1b8a("0x148")](t,e,o){let i=null;this["_pool_diamond"][a0_0x1b8a("0x6f")]>0?i=this[a0_0x1b8a("0x2d3")][a0_0x1b8a("0x31d")]():(i=new S)["init"](),t+=d[a0_0x1b8a("0x103")](-20,20),i[a0_0x1b8a("0x5b8")](t,e,o),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x593"))}[a0_0x1b8a("0xd7")](t){this["_pool_diamond"][a0_0x1b8a("0x198")](t)}["Release"](){for(;this[a0_0x1b8a("0x490")]["length"]>0;){let t=this[a0_0x1b8a("0x490")]["pop"]();t[a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x37d")]["push"](t)}for(;this[a0_0x1b8a("0x569")][a0_0x1b8a("0x6f")]>0;){this[a0_0x1b8a("0x569")]["pop"]()[a0_0x1b8a("0x53f")]()}for(;this[a0_0x1b8a("0x15")]["length"]>0;){let t=this[a0_0x1b8a("0x15")][a0_0x1b8a("0x31d")]();t["Release"](),this["_pool_bullet"][a0_0x1b8a("0x198")](t)}for(let e=this[a0_0x1b8a("0x269")][a0_0x1b8a("0x6f")]-1;e>=0;e--){let t=this[a0_0x1b8a("0x269")][e][a0_0x1b8a("0xd1")];this[a0_0x1b8a("0x59d")][a0_0x1b8a("0x198")](this[a0_0x1b8a("0x269")][e]),t["removeSelf"](),this[a0_0x1b8a("0x269")][a0_0x1b8a("0x39f")](e,1)}}[a0_0x1b8a("0x472")](){for(var t=0;t<this[a0_0x1b8a("0x490")][a0_0x1b8a("0x6f")];++t)this["_list_tower"][t][a0_0x1b8a("0x472")]()}}A[a0_0x1b8a("0x281")]=new A;class B{constructor(){this[a0_0x1b8a("0x46")]=!1,this["_ani_list"]=[],this[a0_0x1b8a("0x39c")]=null,this["_idx"]=0}[a0_0x1b8a("0x47a")](){if(d[a0_0x1b8a("0x220")][0]=!1,this[a0_0x1b8a("0x46")])return!1;if(null==this[a0_0x1b8a("0x39c")]&&(this[a0_0x1b8a("0x39c")]=new Laya[a0_0x1b8a("0x1de")],this[a0_0x1b8a("0x39c")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x239")),0==this["_ani_list"]["length"])for(let e=0;e<10;e++){let t=new Laya[a0_0x1b8a("0xec")];this[a0_0x1b8a("0x581")]["push"]({ani:t,x:0,y:100+100*e,t:0})}for(let t=0;t<10;t++)this[a0_0x1b8a("0x581")][t]["x"]=50*d[a0_0x1b8a("0x103")](1,5);return this[a0_0x1b8a("0x499")]=0,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x39c")]),this[a0_0x1b8a("0x39c")][a0_0x1b8a("0x2d9")]=0,this[a0_0x1b8a("0x39c")]["y"]=0,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](500,this,function(){Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x23b")](100,this,this[a0_0x1b8a("0xa2")])}),Laya["Tween"]["to"](this[a0_0x1b8a("0x39c")],{y:Laya[a0_0x1b8a("0x1eb")]["height"]},1e3,null,Laya["Handler"][a0_0x1b8a("0x314")](this,this[a0_0x1b8a("0x354")])),this[a0_0x1b8a("0x46")]=!0,Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x373")](I[a0_0x1b8a("0x281")]["cdnUrl"]+"sound/bomb_effect.mp3",1,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x46a")](1)}),0),!0}[a0_0x1b8a("0xa2")](){let t=this["_ani_list"][this[a0_0x1b8a("0x499")]];Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](t[a0_0x1b8a("0x573")]),t[a0_0x1b8a("0x573")]["x"]=t["x"],t[a0_0x1b8a("0x573")]["y"]=t["y"],t[a0_0x1b8a("0x573")]["play"](0,!1,a0_0x1b8a("0x246")),this[a0_0x1b8a("0x499")]++,4==this[a0_0x1b8a("0x499")]&&this[a0_0x1b8a("0x545")](),this[a0_0x1b8a("0x499")]>=this[a0_0x1b8a("0x581")][a0_0x1b8a("0x6f")]&&(Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0xa2")]),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1e3,this,this[a0_0x1b8a("0x31")]))}[a0_0x1b8a("0x545")](){A[a0_0x1b8a("0x281")][a0_0x1b8a("0x576")](99)}[a0_0x1b8a("0x31")](){d[a0_0x1b8a("0x220")][0]=!0,this[a0_0x1b8a("0x46")]=!1;for(let t=0;t<this[a0_0x1b8a("0x581")][a0_0x1b8a("0x6f")];t++)this[a0_0x1b8a("0x581")][t][a0_0x1b8a("0x573")][a0_0x1b8a("0x199")]()}[a0_0x1b8a("0x354")](){this[a0_0x1b8a("0x39c")][a0_0x1b8a("0x199")]()}}B["Instance"]=new B;class w{constructor(){this[a0_0x1b8a("0x5a")]=null,this[a0_0x1b8a("0x55a")]=null}[a0_0x1b8a("0x416")](){d[a0_0x1b8a("0x220")][1]=!1,this[a0_0x1b8a("0x55a")]=new Laya["Animation"],Laya["stage"]["addChild"](this["_ani"]),this[a0_0x1b8a("0x55a")]["x"]=0,this[a0_0x1b8a("0x55a")]["y"]=0,this["_ani"][a0_0x1b8a("0x3a")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")]/320,this[a0_0x1b8a("0x55a")][a0_0x1b8a("0x48b")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]/568;for(var e=0;e<A[a0_0x1b8a("0x281")]["getListMonster"]()[a0_0x1b8a("0x6f")];e++){let t=A[a0_0x1b8a("0x281")]["getListMonster"]()[e];0!=t[a0_0x1b8a("0x5a5")]()&&A[a0_0x1b8a("0x281")][a0_0x1b8a("0x2b6")](98,t,0,0)}this[a0_0x1b8a("0x55a")][a0_0x1b8a("0x416")](0,!1,a0_0x1b8a("0x6d")),Laya["SoundManager"][a0_0x1b8a("0x46a")](.5),Laya[a0_0x1b8a("0x153")][a0_0x1b8a("0x373")](I[a0_0x1b8a("0x281")][a0_0x1b8a("0x93")]+"sound/ice_effect.mp3",1,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x153")]["setSoundVolume"](1)}),0);let t=this;this[a0_0x1b8a("0x55a")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0xe")],this,function(){d[a0_0x1b8a("0x220")][1]=!0,t[a0_0x1b8a("0x55a")][a0_0x1b8a("0x199")]()})}}w[a0_0x1b8a("0x281")]=new w;class T extends e["battleUI"]{constructor(){super(...arguments),this[a0_0x1b8a("0x2fa")]=!1,this[a0_0x1b8a("0x222")]=!1,this[a0_0x1b8a("0x519")]=[!1,!1,!1],this[a0_0x1b8a("0x5e")]=0,this[a0_0x1b8a("0x524")]=0,this[a0_0x1b8a("0x242")]=0,this[a0_0x1b8a("0x2d5")]=0,this["towerOrderList"]=[],this[a0_0x1b8a("0x5c2")]=new Laya["TimeLine"],this[a0_0x1b8a("0x359")]=new Laya[a0_0x1b8a("0x3f5")],this["_lucky_obj"]=[],this[a0_0x1b8a("0x57")]=[],this[a0_0x1b8a("0x46f")]=0,this[a0_0x1b8a("0x346")]=0,this["_item_clampXmin"]=0,this[a0_0x1b8a("0x26f")]=0,this[a0_0x1b8a("0x513")]=0,this[a0_0x1b8a("0x5cf")]=0,this[a0_0x1b8a("0x5ba")]=0,this[a0_0x1b8a("0x8")]=0,this[a0_0x1b8a("0x160")]="",this[a0_0x1b8a("0x36c")]=0,this["canBuildTowerMode"]=!1,this["_bInit"]=!1,this["_t"]=!1,this[a0_0x1b8a("0x4aa")]=0,this["_time"]=0,this["_time_lab"]=4,this[a0_0x1b8a("0x32c")]=null,this[a0_0x1b8a("0x14")]=!1,this["_guideAnim"]=null,this["_guide"]=null,this[a0_0x1b8a("0xfe")]=null,this[a0_0x1b8a("0x605")]=null,this[a0_0x1b8a("0x492")]=0,this[a0_0x1b8a("0x1")]=0,this[a0_0x1b8a("0x182")]=[{EVENT:"closeSign",PARAM:0,COUNT:0},{EVENT:a0_0x1b8a("0x68"),PARAM:11,COUNT:0},{EVENT:a0_0x1b8a("0x3e4"),PARAM:10,COUNT:0},{EVENT:"levelup",PARAM:0,COUNT:0}],this[a0_0x1b8a("0x43c")]=!1,this[a0_0x1b8a("0x2ac")]=0,this["_reward_count"]=100,this[a0_0x1b8a("0x2dc")]=[0,0,0],this[a0_0x1b8a("0x16a")]=0,this["_buffCanClick"]=!0,this[a0_0x1b8a("0x221")]=0,this[a0_0x1b8a("0x1df")]=1e3,this["ShareRand"]=0,this["aroundReward"]=0,this[a0_0x1b8a("0x24b")]=[],this["mainLeves"]=[]}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1ad")),this["on"](a0_0x1b8a("0x10f"),this,this["onViewCreated"]),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x505"))}[a0_0x1b8a("0x10f")](){this[a0_0x1b8a("0x557")]()}[a0_0x1b8a("0x2cd")](){this["height"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x344")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this["_mainBG"]["height"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x31e")]["height"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this["mainBG"]["width"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x4c3")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]+80,this["mainBG"]["x"]=0,this["mainBG"]["y"]=-10,this[a0_0x1b8a("0x122")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x122")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x1ea")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")]["width"],this[a0_0x1b8a("0x1ea")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x227")]["width"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x227")]["height"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0xac")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0xac")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]+50,this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x357")]=Laya["stage"]["width"],this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x1fe")][a0_0x1b8a("0x357")]=Laya["stage"]["width"],this["_red1"][a0_0x1b8a("0x22f")]=Laya["stage"][a0_0x1b8a("0x22f")]+50,this[a0_0x1b8a("0x1fe")]["y"]=-20,this[a0_0x1b8a("0x55")]["width"]=Laya["stage"]["width"],this[a0_0x1b8a("0x55")]["height"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]+50,this["_red2"]["y"]=-20,this["_red"][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")]["width"],this[a0_0x1b8a("0xfa")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]+50,this[a0_0x1b8a("0xfa")]["y"]=-20,this[a0_0x1b8a("0x2a6")][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x2a6")][a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x22f")]+100,this[a0_0x1b8a("0x2a6")]["y"]-=20,this[a0_0x1b8a("0x4cf")]=new Laya[a0_0x1b8a("0x1de")],this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x11e")]="image/tower/4_1.png",this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x361")]=.5,this[a0_0x1b8a("0x4cf")]["anchorX"]=.5,this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x36a")]=.5,this[a0_0x1b8a("0x59a")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x4cf")]),this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1e2")]=0,this[a0_0x1b8a("0x5c2")]["to"](this[a0_0x1b8a("0x615")],{scaleX:.9,scaleY:.9},50,null,0)["to"](this[a0_0x1b8a("0x615")],{scaleX:1,scaleY:1},50,null,0),this[a0_0x1b8a("0x359")]["to"](this["btn_develop_cd"],{scaleX:.9,scaleY:.9},50,null,0)["to"](this[a0_0x1b8a("0x5e5")],{scaleX:1,scaleY:1},50,null,0),this["InitSkillCd"](),this[a0_0x1b8a("0x5d4")](),this["initLogin"]()}[a0_0x1b8a("0x54d")](t){0==d[a0_0x1b8a("0x2a9")]?0==t?this[a0_0x1b8a("0x2b9")]["skin"]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+"image/main/4.png":1==t?this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x342"):2==t?this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I["Instance"]["GetUrl"]()+"image/main/4_1.png":3==t&&(this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x320")):0==d[a0_0x1b8a("0x61")]?this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")]["GetUrl"]()+a0_0x1b8a("0x342"):1==d[a0_0x1b8a("0x61")]?this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x320"):2==d[a0_0x1b8a("0x61")]&&(this[a0_0x1b8a("0x2b9")][a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+"image/main/4_1.png")}[a0_0x1b8a("0x14f")](t){if(0==d["ModeSelect"]){switch(d["NowMapID"]=t,h["Instance"][a0_0x1b8a("0x1f8")](t),d[a0_0x1b8a("0xb5")]){case 0:case 1:this[a0_0x1b8a("0x24d")]["text"]="草地",this["_bg"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x10");break;case 2:case 3:this["_SceneName"][a0_0x1b8a("0x195")]="沙漠",this["_bg"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")]["GetUrl"]()+a0_0x1b8a("0x1c0")}var o=0;0==t?o=1:1==t?o=31:2==t?o=101:3==t&&(o=171);let e=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x5d0")](o);d[a0_0x1b8a("0x23d")]=e,d["startPos"]=[],d[a0_0x1b8a("0x3a9")]=[];for(let t=1;t<10&&e[a0_0x1b8a("0x3bc")+t];t++)d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x198")](e[a0_0x1b8a("0x3bc")+t][0]),d[a0_0x1b8a("0x3a9")][a0_0x1b8a("0x198")](e[a0_0x1b8a("0x3bc")+t][1]);p["Instance"][a0_0x1b8a("0x313")](),this[a0_0x1b8a("0xed")]()}else{d[a0_0x1b8a("0xb5")]=t,h[a0_0x1b8a("0x281")]["setSelfMap"](t),this[a0_0x1b8a("0x24d")][a0_0x1b8a("0x195")]="草地",this[a0_0x1b8a("0x5a")][a0_0x1b8a("0x11e")]=I["Instance"]["GetUrl"]()+a0_0x1b8a("0x10");let e=_[a0_0x1b8a("0x281")]["GetMap"](1);d[a0_0x1b8a("0x23d")]=e,d[a0_0x1b8a("0x2f6")]=[],d[a0_0x1b8a("0x3a9")]=[];for(let t=1;t<10&&e["startPoint"+t];t++)d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x198")](e["startPoint"+t][0]),d["endPos"]["push"](e[a0_0x1b8a("0x3bc")+t][1]);p["Instance"][a0_0x1b8a("0x313")](),this[a0_0x1b8a("0xed")]()}}[a0_0x1b8a("0x460")](){this[a0_0x1b8a("0x5eb")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")]["GetUrl"]()+a0_0x1b8a("0x2ca"),this[a0_0x1b8a("0x4c3")]["skin"]=I["Instance"][a0_0x1b8a("0x5cc")]()+"image/main.png",this[a0_0x1b8a("0x5a")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+"image/bg.png",this[a0_0x1b8a("0x262")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x2c3"),this["lucky_bg"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x8b"),this[a0_0x1b8a("0x4b1")]["skin"]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x186"),this["level_bg"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x342"),this[a0_0x1b8a("0x2ad")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+"image/ui/select_bg2.png",this["_GGTS"]["skin"]=a0_0x1b8a("0x233"),this[a0_0x1b8a("0x1fe")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x29d"),this["_red"][a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x29d"),this["_red2"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")]["GetUrl"]()+a0_0x1b8a("0x29d");var t=this["_red2"][a0_0x1b8a("0x13f")](0);t[a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+"image/d1.png",(t=this[a0_0x1b8a("0x55")][a0_0x1b8a("0x13f")](1))[a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0xd9"),this[a0_0x1b8a("0x319")]["skin"]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x3a8"),this[a0_0x1b8a("0x143")][a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0xb3"),this["_win"]["centerX"]=Laya["stage"][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x2b1")]["skin"]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x5d8"),this[a0_0x1b8a("0x2b1")]["centerX"]=Laya["stage"][a0_0x1b8a("0x357")]}["setListener"](){this["btn_levelup"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x1cd")]),this[a0_0x1b8a("0x21a")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this["onClickSell"]),this[a0_0x1b8a("0x577")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x57a")]),this[a0_0x1b8a("0x54e")]["on"](Laya["Event"]["CLICK"],this,this[a0_0x1b8a("0x322")]),this[a0_0x1b8a("0x480")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x45a")]),this[a0_0x1b8a("0x521")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x3de")]),this[a0_0x1b8a("0xc7")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x340")]),this[a0_0x1b8a("0x1e3")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x7d")]),this[a0_0x1b8a("0x272")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x527")]),this[a0_0x1b8a("0x22a")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xc2")]),this["btn_item1"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this["onClickItem"],[1]),this[a0_0x1b8a("0x540")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this["onClickItem"],[2]),this[a0_0x1b8a("0x3e6")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x36b")],[1]),this[a0_0x1b8a("0xdb")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x36b")],[2]),this[a0_0x1b8a("0x1d8")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x2e1")]),this["btn_sign"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x1e0")]),this[a0_0x1b8a("0x164")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x5f3")]),this[a0_0x1b8a("0x3b")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this["onClickDiamondGift"]),this[a0_0x1b8a("0x4b6")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c["PlayEx"]("click"),0==this[a0_0x1b8a("0x5ba")]&&(this["_lucky"][a0_0x1b8a("0x212")]=!1,this["_mainzz"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x25a")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")]["visible"]=!1,h[a0_0x1b8a("0x281")]["isGetLucky"]()<=0?(this["btn_start_lucky"][a0_0x1b8a("0x26d")]=!0,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!0):(this["btn_start_lucky"][a0_0x1b8a("0x26d")]=!1,this[a0_0x1b8a("0x2df")]["disabled"]=!1)),u["HideBanner"]()}),this[a0_0x1b8a("0x589")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this["onCloseFuhuo"]),this[a0_0x1b8a("0x409")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this[a0_0x1b8a("0xa0")]),this[a0_0x1b8a("0x4e6")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this["onViewDofuhuo"]),this[a0_0x1b8a("0x204")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x523")]["visible"]=!1,this["_sign"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x14b")][a0_0x1b8a("0x212")]=!1,this["get_view2"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x27c")+h[a0_0x1b8a("0x281")]["Data"][a0_0x1b8a("0x168")]),0==h["Instance"]["Data"]["Guide"]&&this[a0_0x1b8a("0x382")]("closeSign",0),u[a0_0x1b8a("0x21b")]()}),this[a0_0x1b8a("0x127")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x285")]),this["btn_lucky_get"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x380")],[1]),this[a0_0x1b8a("0x523")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xe7")],[1]),this["btn_signx2"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xe7")],[2]),this[a0_0x1b8a("0xba")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")]("click"),this[a0_0x1b8a("0x14b")][a0_0x1b8a("0x212")]=!1,this["tczz"]["visible"]=!1}),this[a0_0x1b8a("0xf1")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x189")]["visible"]=!1,this["tczz"][a0_0x1b8a("0x212")]=!1}),this[a0_0x1b8a("0x1a3")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this["get_view2"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1}),this[a0_0x1b8a("0x35a")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x5de")][a0_0x1b8a("0x212")]=!1}),this[a0_0x1b8a("0x511")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")]("click"),this[a0_0x1b8a("0x76")][a0_0x1b8a("0x212")]=!1}),this[a0_0x1b8a("0x50b")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x4ea")],[1]),this["_close_tips2"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x34a")]),this["btn_help"]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x63")],[2]),this[a0_0x1b8a("0x451")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x132")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")]["visible"]=!1,u[a0_0x1b8a("0x21b")]()}),this[a0_0x1b8a("0x3e5")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,function(){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x591")]()&&this[a0_0x1b8a("0x67")](a0_0x1b8a("0x50d"),this),this[a0_0x1b8a("0x132")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1}),this[a0_0x1b8a("0x52a")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this["onClickNextMap"]),this[a0_0x1b8a("0x481")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x29a")]),this[a0_0x1b8a("0x284")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x18d")]),this[a0_0x1b8a("0x323")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x4ea")],[2]),this[a0_0x1b8a("0x4f5")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xae")]),this[a0_0x1b8a("0x32b")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xe4")],[-1]),this[a0_0x1b8a("0x57f")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this["onClickGetItem"],[0]),this[a0_0x1b8a("0x372")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0xe4")],[1]),this[a0_0x1b8a("0x1cb")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this["onClickGetItem"],[2]),this[a0_0x1b8a("0x274")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x582")],name:this[a0_0x1b8a("0x4f9")],bg:this[a0_0x1b8a("0x393")],nb:this[a0_0x1b8a("0x197")]}),this["_lucky_obj"]["push"]({icon:this[a0_0x1b8a("0x14d")],name:this[a0_0x1b8a("0x184")],bg:this[a0_0x1b8a("0x2bc")],nb:this[a0_0x1b8a("0x401")]}),this["_lucky_obj"][a0_0x1b8a("0x198")]({icon:this["img_luck_3"],name:this[a0_0x1b8a("0x256")],bg:this[a0_0x1b8a("0x567")],nb:this["imn_3"]}),this[a0_0x1b8a("0x274")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x1ff")],name:this[a0_0x1b8a("0x568")],bg:this["luck4"],nb:this[a0_0x1b8a("0x9e")]}),this[a0_0x1b8a("0x274")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x64")],name:this[a0_0x1b8a("0x4b7")],bg:this[a0_0x1b8a("0x1f4")],nb:this["imn_5"]}),this[a0_0x1b8a("0x274")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x306")],name:this["lab_lucky_6"],bg:this[a0_0x1b8a("0x459")],nb:this["imn_6"]}),this[a0_0x1b8a("0x274")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x491")],name:this["lab_lucky_7"],bg:this[a0_0x1b8a("0x397")],nb:this["imn_7"]}),this[a0_0x1b8a("0x274")]["push"]({icon:this["img_luck_8"],name:this[a0_0x1b8a("0x600")],bg:this[a0_0x1b8a("0x56")],nb:this["imn_8"]}),this[a0_0x1b8a("0x57")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x4ed")],bg:this["sign1"],mask:this[a0_0x1b8a("0x17e")],nameV:this["sign1_name"]}),this[a0_0x1b8a("0x57")][a0_0x1b8a("0x198")]({icon:this["icon_sign2"],bg:this[a0_0x1b8a("0x121")],mask:this[a0_0x1b8a("0x3d6")],nameV:this[a0_0x1b8a("0xcc")]}),this[a0_0x1b8a("0x57")]["push"]({icon:this[a0_0x1b8a("0x170")],bg:this["sign3"],mask:this[a0_0x1b8a("0x3e")],nameV:this[a0_0x1b8a("0x418")]}),this[a0_0x1b8a("0x57")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x53e")],bg:this[a0_0x1b8a("0xe0")],mask:this[a0_0x1b8a("0x2ab")],nameV:this[a0_0x1b8a("0x501")]}),this[a0_0x1b8a("0x57")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x17f")],bg:this["sign5"],mask:this[a0_0x1b8a("0x251")],nameV:this["sign5_name"]}),this[a0_0x1b8a("0x57")][a0_0x1b8a("0x198")]({icon:this[a0_0x1b8a("0x3be")],bg:this[a0_0x1b8a("0x5f7")],mask:this[a0_0x1b8a("0x80")],nameV:this[a0_0x1b8a("0x49e")]}),this["_sign_obj"][a0_0x1b8a("0x198")]({icon:null,bg:this[a0_0x1b8a("0x4da")],mask:this[a0_0x1b8a("0x131")]}),this[a0_0x1b8a("0x1dd")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x2b2")]),this[a0_0x1b8a("0x577")]["on"](Laya["Event"][a0_0x1b8a("0x4eb")],this,this["onBuffTowerDown"]),this[a0_0x1b8a("0x577")]["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x56e")],this,this[a0_0x1b8a("0x1b1")]),this[a0_0x1b8a("0x577")]["on"](Laya[a0_0x1b8a("0x278")]["MOUSE_UP"],this,this[a0_0x1b8a("0x3fd")]),this[a0_0x1b8a("0x5f1")]()}[a0_0x1b8a("0x301")](){d[a0_0x1b8a("0x2a9")]=0,d[a0_0x1b8a("0x61")]=0,d[a0_0x1b8a("0x45f")]=0,this[a0_0x1b8a("0x524")]=0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x84")](),this[a0_0x1b8a("0x14f")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()),this[a0_0x1b8a("0x25e")](),this[a0_0x1b8a("0x8")]=1,this[a0_0x1b8a("0x1c2")]=this[a0_0x1b8a("0x284")]["width"]/2,this["_item_clampXmax"]=this[a0_0x1b8a("0x412")]["width"]-this[a0_0x1b8a("0x284")]["width"]/2,this["_item_clampYmin"]=0,this[a0_0x1b8a("0x5cf")]=this[a0_0x1b8a("0x412")][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x412")][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x63")](t){let e=_["Instance"][a0_0x1b8a("0x8f")](this[a0_0x1b8a("0x8")]);if(null==e)return;h["Instance"][a0_0x1b8a("0x579")](this[a0_0x1b8a("0x8")])||e[a0_0x1b8a("0x4f6")];var o=d[a0_0x1b8a("0x59c")](e["id"]),i=e["power"]+_[a0_0x1b8a("0x281")][a0_0x1b8a("0x2be")](e["id"],h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5f0")](parseInt(o))["damage"])["value"];if(1==t){switch(this[a0_0x1b8a("0x47b")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x1db")],this[a0_0x1b8a("0x5ec")]["text"]=e["content"],e[a0_0x1b8a("0xfb")]){case"一格":this["tower_range1"][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x4bd")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x267")]["alpha"]=0,this[a0_0x1b8a("0x38a")][a0_0x1b8a("0x361")]=0;break;case"两格":this[a0_0x1b8a("0x265")]["alpha"]=1,this["tower_range2"][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x267")][a0_0x1b8a("0x361")]=0,this["tower_range4"][a0_0x1b8a("0x361")]=0;break;case"三格":this["tower_range1"][a0_0x1b8a("0x361")]=1,this["tower_range2"][a0_0x1b8a("0x361")]=1,this["tower_range3"]["alpha"]=1,this[a0_0x1b8a("0x38a")][a0_0x1b8a("0x361")]=0;break;default:this[a0_0x1b8a("0x265")]["alpha"]=1,this[a0_0x1b8a("0x4bd")]["alpha"]=1,this[a0_0x1b8a("0x267")]["alpha"]=1,this[a0_0x1b8a("0x38a")]["alpha"]=1}this[a0_0x1b8a("0x423")][a0_0x1b8a("0x11e")]=e["icon"],this[a0_0x1b8a("0x387")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x70")],this[a0_0x1b8a("0x3e0")][a0_0x1b8a("0x195")]=a0_0x1b8a("0x52")+i,parseInt(i)<=0?(this[a0_0x1b8a("0x2af")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x1f3")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x498")]["alpha"]=0):parseInt(i)<250?(this[a0_0x1b8a("0x2af")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x1f3")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x498")][a0_0x1b8a("0x361")]=0):parseInt(i)<450?(this[a0_0x1b8a("0x2af")]["alpha"]=1,this[a0_0x1b8a("0x1f3")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x498")][a0_0x1b8a("0x361")]=0):(this[a0_0x1b8a("0x2af")]["alpha"]=1,this[a0_0x1b8a("0x1f3")]["alpha"]=1,this["atack_fire3"][a0_0x1b8a("0x361")]=1),this["_main_tips"][a0_0x1b8a("0x212")]=!0}else{switch(this[a0_0x1b8a("0x1ec")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x1db")],this[a0_0x1b8a("0x58d")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x1c")],e[a0_0x1b8a("0xfb")]){case"一格":this[a0_0x1b8a("0x98")][a0_0x1b8a("0x361")]=1,this["tower2_range2"][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x5a6")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0xb2")][a0_0x1b8a("0x361")]=0;break;case"两格":this["tower2_range1"][a0_0x1b8a("0x361")]=1,this["tower2_range2"][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x5a6")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0xb2")]["alpha"]=0;break;case"三格":this[a0_0x1b8a("0x98")][a0_0x1b8a("0x361")]=1,this["tower2_range2"]["alpha"]=1,this[a0_0x1b8a("0x5a6")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0xb2")][a0_0x1b8a("0x361")]=0;break;default:this["tower2_range1"]["alpha"]=1,this[a0_0x1b8a("0x5db")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x5a6")]["alpha"]=1,this[a0_0x1b8a("0xb2")][a0_0x1b8a("0x361")]=1}this[a0_0x1b8a("0x24f")][a0_0x1b8a("0x11e")]=e[a0_0x1b8a("0x369")],this["tips2_price"][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x70")],this[a0_0x1b8a("0x4ac")]["text"]=a0_0x1b8a("0x52")+i,parseInt(i)<=0?(this[a0_0x1b8a("0x277")]["alpha"]=0,this[a0_0x1b8a("0x54b")][a0_0x1b8a("0x361")]=0,this["atack2_fire3"][a0_0x1b8a("0x361")]=0):parseInt(i)<250?(this[a0_0x1b8a("0x277")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x54b")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x115")][a0_0x1b8a("0x361")]=0):parseInt(i)<450?(this[a0_0x1b8a("0x277")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x54b")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x115")][a0_0x1b8a("0x361")]=0):(this["atack2_fire1"][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x54b")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x115")][a0_0x1b8a("0x361")]=1),this[a0_0x1b8a("0x4ac")][a0_0x1b8a("0x195")]=a0_0x1b8a("0x52")+i,this[a0_0x1b8a("0x76")][a0_0x1b8a("0x212")]=!0}}["setCloud"](){}[a0_0x1b8a("0x363")](){}[a0_0x1b8a("0xde")](){this["db"]["collection"](a0_0x1b8a("0x368"))[a0_0x1b8a("0x11a")]({success:function(e){for(let t=0;t<e[a0_0x1b8a("0x211")][a0_0x1b8a("0x6f")];t++);},fail:function(t){},complete:function(){}})}[a0_0x1b8a("0x557")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x110")),this[a0_0x1b8a("0x2cd")](),console["log"](a0_0x1b8a("0x2ff")),this[a0_0x1b8a("0x460")](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1f7")),this[a0_0x1b8a("0x54d")](h[a0_0x1b8a("0x281")]["getSelfMap"]()),console[a0_0x1b8a("0x14e")]("-------BattleUIControl----4444------"),this[a0_0x1b8a("0x135")](),console["log"](a0_0x1b8a("0x51e")),this["initMainUI"](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2f8")),p[a0_0x1b8a("0x281")][a0_0x1b8a("0x114")](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x392")),this[a0_0x1b8a("0x2cc")](),console[a0_0x1b8a("0x14e")]("-------BattleUIControl----8888------"),Laya["timer"][a0_0x1b8a("0x23b")](.5*d["tick"],this,this[a0_0x1b8a("0xd")]),Laya[a0_0x1b8a("0x5b7")]["loop"](10*d[a0_0x1b8a("0xa2")],this,this[a0_0x1b8a("0x22")]),console[a0_0x1b8a("0x14e")]("-------BattleUIControl----9999------"),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x21d")]()&&this[a0_0x1b8a("0x1e0")](),this[a0_0x1b8a("0x5b4")](),this[a0_0x1b8a("0x4c5")](0),this[a0_0x1b8a("0x492")]=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["Guide"],this[a0_0x1b8a("0x492")]>=2&&(this[a0_0x1b8a("0x492")]=999,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x168")]=100),this[a0_0x1b8a("0x32a")](),this["initGameTowerList"](),this["setCloud"]()}[a0_0x1b8a("0xf6")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x309")),h[a0_0x1b8a("0x281")]["Data"][a0_0x1b8a("0x1ed")]>0?(this["_tips_diamond"]["visible"]=!0,this[a0_0x1b8a("0xac")]["visible"]=!0,u[a0_0x1b8a("0x187")]()):this[a0_0x1b8a("0x535")](),u[a0_0x1b8a("0x4f1")]()}["lucky_loop"](t){c["PlayEx"](a0_0x1b8a("0x117")),this[a0_0x1b8a("0x5ba")]++;let e=this["_lucky_cur"]%9;for(let t=0;t<8;t++)t+1==e?(this["_lucky_obj"][t]["nb"][a0_0x1b8a("0x361")]=0,this["_lucky_obj"][t]["bg"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x41f")):(this["_lucky_obj"][t]["nb"]["alpha"]=1,this[a0_0x1b8a("0x274")][t]["bg"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0xbf"));this[a0_0x1b8a("0x5ba")]<50||e==t&&this[a0_0x1b8a("0x3cf")]()}[a0_0x1b8a("0x3cf")](){console["log"](a0_0x1b8a("0x5ed")),u[a0_0x1b8a("0x4f1")](),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0x56b")]),this[a0_0x1b8a("0x5ba")]=0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x215")]()<=0?(this[a0_0x1b8a("0x2df")]["disabled"]=!0,this["btn_start_lucky"][a0_0x1b8a("0x26d")]=!0):(this["_luck_icon"][a0_0x1b8a("0x26d")]=!1,this[a0_0x1b8a("0x127")][a0_0x1b8a("0x26d")]=!1);let t=d["getIconRes"](h[a0_0x1b8a("0x281")]["getLucky"]()[a0_0x1b8a("0x5a2")],h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3f9")]()[a0_0x1b8a("0x243")]);this[a0_0x1b8a("0x1ba")]["skin"]=t[a0_0x1b8a("0x369")],this["luck_num"][a0_0x1b8a("0x195")]=t[a0_0x1b8a("0x1db")],this["lucky_tips"][a0_0x1b8a("0x212")]=!0,this["tczz"]["visible"]=!0}[a0_0x1b8a("0x2cc")](){this["_diamond"][a0_0x1b8a("0x195")]=h[a0_0x1b8a("0x281")]["GetDiamond"]()[a0_0x1b8a("0xdf")](),this[a0_0x1b8a("0x331")][a0_0x1b8a("0x195")]=h["Instance"][a0_0x1b8a("0x3ab")]()[a0_0x1b8a("0xdf")]()}[a0_0x1b8a("0x2ef")](t){if(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),0==this[a0_0x1b8a("0x8")])return;let e=_[a0_0x1b8a("0x281")]["GetTower"](this[a0_0x1b8a("0x8")]);null!=e&&0!=h["Instance"][a0_0x1b8a("0x124")](e[a0_0x1b8a("0x4f6")])&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](this["_cur_tower_id"])||(h["Instance"][a0_0x1b8a("0x4e0")](this[a0_0x1b8a("0x8")]),this[a0_0x1b8a("0x63")](t),this[a0_0x1b8a("0x48d")]()))}[a0_0x1b8a("0x3d5")](){if(0==this[a0_0x1b8a("0x8")])return;if(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](this["_cur_tower_id"]))return;let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](this[a0_0x1b8a("0x8")]);null!=t&&0!=h["Instance"]["DelDiamond"](t["unlock"])&&(h["Instance"][a0_0x1b8a("0x4e0")](this["_cur_tower_id"]),this[a0_0x1b8a("0x48d")](),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")))}[a0_0x1b8a("0x48d")](){this[a0_0x1b8a("0xc1")]()}[a0_0x1b8a("0x141")](){this[a0_0x1b8a("0x4c5")](1),this["onClickStartLucky"]()}[a0_0x1b8a("0x285")](){if(h[a0_0x1b8a("0x281")]["isGetLucky"]()<=0)c[a0_0x1b8a("0x441")](a0_0x1b8a("0x87"));else if(c["PlayEx"](a0_0x1b8a("0x447")),h["Instance"]["Data"]["LuckyFree"]>0){h[a0_0x1b8a("0x281")]["Data"]["LuckyFree"]=0,h["Instance"][a0_0x1b8a("0x28e")]();let t=d[a0_0x1b8a("0x223")]();h[a0_0x1b8a("0x281")]["setLucky"](_["Instance"][a0_0x1b8a("0x3a5")](t[a0_0x1b8a("0x5a2")])["typeid"],t["value"]),this[a0_0x1b8a("0x4c5")](-1),this[a0_0x1b8a("0x127")][a0_0x1b8a("0x26d")]=!0,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!1,this[a0_0x1b8a("0x5ba")]=0,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x23b")](100,this,this[a0_0x1b8a("0x56b")],[t[a0_0x1b8a("0x5a2")]])}else this[a0_0x1b8a("0x67")]("lucky",this)}[a0_0x1b8a("0x503")](){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x242")]=0,this[a0_0x1b8a("0x2d5")]=0}[a0_0x1b8a("0x5f3")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x449")),u[a0_0x1b8a("0xb1")]()}[a0_0x1b8a("0x10c")](){switch(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x5e")]){case 1:break;case 2:return}}[a0_0x1b8a("0x180")](e=1){this[a0_0x1b8a("0x32f")][a0_0x1b8a("0x16b")]="",this["_sign_obj"][6][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=!0;var o=[];_[a0_0x1b8a("0x281")][a0_0x1b8a("0x1f6")]();let i=_[a0_0x1b8a("0x281")]["GetSign"](7),a="";var r=0;for(let t=1;t<6;t++)switch(Number(i[a0_0x1b8a("0x3b0")+t])){case 7:r=Number(i[a0_0x1b8a("0x50e")+t])*e,h[a0_0x1b8a("0x281")]["AddDiamond"](r),a="钻石X"+r,o[a0_0x1b8a("0x198")]({vname:{text:a},icon:{skin:a0_0x1b8a("0x290")}});break;case 4:r=Number(i[a0_0x1b8a("0x50e")+t])*e,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](1,r,4),a=a0_0x1b8a("0x1e6")+r,o[a0_0x1b8a("0x198")]({vname:{text:a},icon:{skin:a0_0x1b8a("0x43e")}});break;case 2:r=Number(i[a0_0x1b8a("0x50e")+t])*e,h["Instance"]["AddPropNumber"](2,r,2),a=a0_0x1b8a("0x106")+r,o[a0_0x1b8a("0x198")]({vname:{text:a},icon:{skin:a0_0x1b8a("0x495")}});break;case 3:r=Number(i[a0_0x1b8a("0x50e")+t])*e,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](3,r,3),a="群体攻速X"+r,o[a0_0x1b8a("0x198")]({vname:{text:a},icon:{skin:a0_0x1b8a("0x52f")}});break;case 8:if(r=Number(i["type5_id"]),!h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](r)){h[a0_0x1b8a("0x281")]["addUnlock"](r);let t=_["Instance"][a0_0x1b8a("0x8f")](r);a=a0_0x1b8a("0x2f1")+t[a0_0x1b8a("0x1db")],o[a0_0x1b8a("0x198")]({vname:{text:a},icon:{skin:t[a0_0x1b8a("0x369")]}}),this[a0_0x1b8a("0x48d")]()}}this[a0_0x1b8a("0x32f")][a0_0x1b8a("0x3c4")]=o,this[a0_0x1b8a("0x32f")][a0_0x1b8a("0x35c")](),this[a0_0x1b8a("0x189")][a0_0x1b8a("0x212")]=!0,this["tczz"]["visible"]=!0}["onClickSign"](t){if(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),!d[a0_0x1b8a("0x4d4")]&&0==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x21d")]())return;h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5fa")]();let e=h[a0_0x1b8a("0x281")]["getSign"](),o=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x389")](e);if(this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!0,2==t)this[a0_0x1b8a("0x67")](a0_0x1b8a("0x5a1"),this);else{if(7==e)this["onInitSigeSeven"]();else{let t;var i;switch(2!=e||h["Instance"][a0_0x1b8a("0x579")](o[a0_0x1b8a("0x58c")])?(t=d[a0_0x1b8a("0x2ec")](o["type1"],o[a0_0x1b8a("0x237")]),i=o[a0_0x1b8a("0x425")]):(t=d[a0_0x1b8a("0x2ec")](o["type5"],1),i=o[a0_0x1b8a("0x4c7")]),this[a0_0x1b8a("0x57")][e-1]["mask"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x362")][a0_0x1b8a("0x11e")]=t[a0_0x1b8a("0x369")],this[a0_0x1b8a("0xb6")][a0_0x1b8a("0x195")]=t[a0_0x1b8a("0x1db")],this[a0_0x1b8a("0x14b")][a0_0x1b8a("0x212")]=!0,Number(i)){case 7:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x148")](Number(o["count1"]));break;case 4:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](1,Number(o[a0_0x1b8a("0x237")]),4);break;case 2:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](2,Number(o[a0_0x1b8a("0x237")]),2);break;case 3:h[a0_0x1b8a("0x281")]["AddPropNumber"](3,Number(o["count1"]),3);break;case 8:h[a0_0x1b8a("0x281")]["addUnlock"](o[a0_0x1b8a("0x58c")]),this[a0_0x1b8a("0x48d")]()}}7==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x11d")]&&0==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x5b6")]&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x5b6")]=1,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x28e")]())}this[a0_0x1b8a("0x523")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3e9")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x14b")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x189")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,0==h["Instance"][a0_0x1b8a("0x42e")][a0_0x1b8a("0x168")]&&this[a0_0x1b8a("0x382")](a0_0x1b8a("0x5c5"),0)}["onClickOpenSign"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x5b3")),c["PlayEx"]("click"),this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!0,h[a0_0x1b8a("0x281")]["resetSign"]();let i=h["Instance"][a0_0x1b8a("0x607")](),a=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x21d")]();Laya[a0_0x1b8a("0x5b7")]["once"](100,this,function(){this["btn_signx1"]["visible"]=!0}),d[a0_0x1b8a("0x4d4")]||(this["btn_signx1"][a0_0x1b8a("0x26d")]=0==a,this[a0_0x1b8a("0x5b0")][a0_0x1b8a("0x26d")]=0==a);for(let o=1;o<7;o++){let t,e=_["Instance"][a0_0x1b8a("0x389")](o);t=2==o&&0==h[a0_0x1b8a("0x281")]["Data"]["SignRound"]?d[a0_0x1b8a("0x2ec")](e["type5"],1):d[a0_0x1b8a("0x2ec")](e[a0_0x1b8a("0x425")],e["count1"]),this[a0_0x1b8a("0x57")][o-1][a0_0x1b8a("0x369")][a0_0x1b8a("0x11e")]=t[a0_0x1b8a("0x369")],this["_sign_obj"][o-1][a0_0x1b8a("0x28b")][a0_0x1b8a("0x195")]=t[a0_0x1b8a("0x1db")],this["_sign_obj"][o-1][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=o<=i,o<i+a?this[a0_0x1b8a("0x57")][o-1]["bg"]["skin"]=a0_0x1b8a("0x5c6"):o==i+a?(this[a0_0x1b8a("0x477")]["x"]=this["_sign_obj"][o-1]["bg"]["x"],this[a0_0x1b8a("0x477")]["y"]=this["_sign_obj"][o-1]["bg"]["y"],this[a0_0x1b8a("0x57")][o-1]["bg"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x5c6"),this[a0_0x1b8a("0x477")]["alpha"]=1):this["_sign_obj"][o-1]["bg"][a0_0x1b8a("0x11e")]="image/main/51.png"}1==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x5b6")]?this[a0_0x1b8a("0x365")][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x391"):this["sign7"][a0_0x1b8a("0x11e")]=I["Instance"][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x10d"),this[a0_0x1b8a("0x57")][6]["mask"][a0_0x1b8a("0x212")]=i>=7,this["_sign"][a0_0x1b8a("0x212")]=!0,u[a0_0x1b8a("0x4f1")](),u[a0_0x1b8a("0x187")]();ADManageLaya[a0_0x1b8a("0x584")]()["xsi"]()}[a0_0x1b8a("0x4c5")](t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x3fb")),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c2")](t),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x29c")]>0?(this[a0_0x1b8a("0x41")][a0_0x1b8a("0x195")]=a0_0x1b8a("0x112"),this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x212")]=!1):(this[a0_0x1b8a("0x41")][a0_0x1b8a("0x195")]=a0_0x1b8a("0x144")+h[a0_0x1b8a("0x281")][a0_0x1b8a("0x215")](),this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x212")]=!0)}[a0_0x1b8a("0x2e1")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x58a")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!0;let i=h[a0_0x1b8a("0x281")]["getLucky"]();d[a0_0x1b8a("0x4d4")]&&h[a0_0x1b8a("0x281")]["isGetLucky"]()<=0&&this[a0_0x1b8a("0x4c5")](3),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x215")]()<=0?(this["btn_start_lucky"][a0_0x1b8a("0x26d")]=!0,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!0):(this[a0_0x1b8a("0x127")]["disabled"]=!1,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!1);for(let o=1;o<9;o++){let t=_[a0_0x1b8a("0x281")]["GetLucky"](o);if(null==t)continue;let e=d[a0_0x1b8a("0x2ec")](t[a0_0x1b8a("0x2d8")],t["count"]);this["_lucky_obj"][o-1][a0_0x1b8a("0x369")]["skin"]=e["icon"],this[a0_0x1b8a("0x274")][o-1][a0_0x1b8a("0x1db")]["text"]=e[a0_0x1b8a("0x1db")],this[a0_0x1b8a("0x274")][o-1]["bg"][a0_0x1b8a("0x11e")]=o==i?"image/main/a2.png":a0_0x1b8a("0xbf")}this[a0_0x1b8a("0x31b")][a0_0x1b8a("0x212")]=!0,u["ShowNaticeInterstitial"](),u[a0_0x1b8a("0x187")]();ADManageLaya[a0_0x1b8a("0x584")]()[a0_0x1b8a("0x167")]()}[a0_0x1b8a("0x380")](t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x440")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x25a")][a0_0x1b8a("0x212")]=!1,h[a0_0x1b8a("0x281")]["isGetLucky"]()<=0?(this[a0_0x1b8a("0x127")][a0_0x1b8a("0x26d")]=!0,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!0):(this[a0_0x1b8a("0x127")][a0_0x1b8a("0x26d")]=!1,this[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!1),this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1;var e=h[a0_0x1b8a("0x281")]["getLucky"]();if(2!=t)switch(e["key"]){case 2:h["Instance"][a0_0x1b8a("0x2c6")](2,e[a0_0x1b8a("0x243")],2);break;case 3:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](3,e[a0_0x1b8a("0x243")],3);break;case 4:h["Instance"][a0_0x1b8a("0x2c6")](1,e[a0_0x1b8a("0x243")],4);break;case 7:h["Instance"][a0_0x1b8a("0x148")](e[a0_0x1b8a("0x243")]),this[a0_0x1b8a("0xce")][a0_0x1b8a("0x195")]=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ab")]()}else switch(e[a0_0x1b8a("0x5a2")]){case 2:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](2,2*e[a0_0x1b8a("0x243")],2);break;case 3:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](3,2*e[a0_0x1b8a("0x243")],3);break;case 4:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](1,2*e[a0_0x1b8a("0x243")],4);break;case 7:h[a0_0x1b8a("0x281")]["AddDiamond"](2*e[a0_0x1b8a("0x243")]),this[a0_0x1b8a("0xce")][a0_0x1b8a("0x195")]=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ab")]()}}[a0_0x1b8a("0x613")](t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x50")),console[a0_0x1b8a("0x14e")](h["Instance"][a0_0x1b8a("0x3a6")]()),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()>=t-1?c[a0_0x1b8a("0x441")](a0_0x1b8a("0x117")):(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x87")),this["_main_locktip"]["visible"]||(this["_main_locktip"]["visible"]=!0,this[a0_0x1b8a("0x4fe")][a0_0x1b8a("0x11e")]=2==t?"image/main/locktips_1.png":"image/main/locktips.png",Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1500,this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x4fe")],{alpha:0},500,null,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x4fe")][a0_0x1b8a("0x212")]=!1,this["_main_locktip"][a0_0x1b8a("0x361")]=1}))})))}[a0_0x1b8a("0xc2")](){console[a0_0x1b8a("0x14e")]("----onClickGuide----"),c[a0_0x1b8a("0x441")]("click"),this[a0_0x1b8a("0x382")](a0_0x1b8a("0x1a6"),0)}[a0_0x1b8a("0x527")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x205")),c[a0_0x1b8a("0x441")]("click"),0!=this[a0_0x1b8a("0x163")]()&&(this[a0_0x1b8a("0x222")]=!this[a0_0x1b8a("0x222")],this[a0_0x1b8a("0x272")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x222")]?a0_0x1b8a("0x374"):a0_0x1b8a("0x6b"),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x3f3")](this["_pause"]))}[a0_0x1b8a("0x45a")](){console[a0_0x1b8a("0x14e")]("----onClickContinue----"),c["PlayEx"]("click"),this[a0_0x1b8a("0x4fc")]["visible"]=!1,u[a0_0x1b8a("0x21b")]()}[a0_0x1b8a("0xa8")](){console[a0_0x1b8a("0x14e")]("----onClickContinueGame----"),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!1,h["Instance"]["LoadMapData"](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x2f9")]),this[a0_0x1b8a("0x48a")]()}[a0_0x1b8a("0x7d")](){console["log"](a0_0x1b8a("0x46e")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),0!=this["checkGuide"]()&&(this[a0_0x1b8a("0x2fa")],this[a0_0x1b8a("0x2fa")]=!this[a0_0x1b8a("0x2fa")],this[a0_0x1b8a("0x2fa")]?d[a0_0x1b8a("0x330")]=.5:d[a0_0x1b8a("0x330")]=1,this["btn_speed"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2fa")]?a0_0x1b8a("0x2de"):a0_0x1b8a("0xcb"))}[a0_0x1b8a("0x3de")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x3ad")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x4fc")]["visible"]=!1,this[a0_0x1b8a("0x14")]=!0,this[a0_0x1b8a("0x2fa")]=!1,d[a0_0x1b8a("0x330")]=1,this[a0_0x1b8a("0x1e3")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0xcb"),h[a0_0x1b8a("0x281")]["Restart"](1),A[a0_0x1b8a("0x281")]["Release"](),u["HideBanner"](),this[a0_0x1b8a("0x48a")]()}[a0_0x1b8a("0x276")](){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x14")]=!0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](1),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x48a")]()}["onClickBackMenu"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x27e")),c[a0_0x1b8a("0x441")]("click"),this[a0_0x1b8a("0x4fc")][a0_0x1b8a("0x212")]=!1,p["Instance"][a0_0x1b8a("0x114")](),A["Instance"][a0_0x1b8a("0x111")](),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](0),this["_mainui"][a0_0x1b8a("0x212")]=!0,this["_ui_tower"][a0_0x1b8a("0x212")]=!1,this["_build_ui"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2ad")]["visible"]=!1,this["bCanPath"]=!0,this[a0_0x1b8a("0x222")]=!1,this["btn_pause"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x222")]?a0_0x1b8a("0x374"):a0_0x1b8a("0x6b"),this["_spd"]=!1,d["spd"]=1,this[a0_0x1b8a("0x1e3")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2fa")]?"image/ui/speedup.png":a0_0x1b8a("0xcb"),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3fc")](),Laya[a0_0x1b8a("0x5b7")]["once"](250,this,function(){console["log"](this["first_once"][a0_0x1b8a("0x212")]),console[a0_0x1b8a("0x14e")](this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]),console[a0_0x1b8a("0x14e")](this[a0_0x1b8a("0xac")]["visible"]),this["initMainUI"]()}),u["HideBanner"]();ADManageLaya["getInstance"]()[a0_0x1b8a("0x167")]()}[a0_0x1b8a("0x322")](){console["log"](a0_0x1b8a("0x136")),d["isGuide"]||(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x4fc")]["visible"]=!0,u[a0_0x1b8a("0x4f1")](),u["ShowNaticeBanner"]());ADManageLaya[a0_0x1b8a("0x584")]()[a0_0x1b8a("0x167")]()}[a0_0x1b8a("0x1cd")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x12"));let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](this["_click_tower"][a0_0x1b8a("0x3db")]()[a0_0x1b8a("0xaa")]);t&&0!=y["Instance"][a0_0x1b8a("0x28d")](t["cost"])&&(this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x43a")](),c[a0_0x1b8a("0x441")]("levelup"),this["closeBuildUI"](),this[a0_0x1b8a("0x382")]("levelup",0),p["Instance"][a0_0x1b8a("0x318")](this["_click_tower"]["GridX"](),this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x15f")](),this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x3db")]()["id"]))}[a0_0x1b8a("0x5a0")](){console[a0_0x1b8a("0x14e")]("---onClickSell----"),this["grideTemp"]&&d[a0_0x1b8a("0x1e8")]||(this[a0_0x1b8a("0x2bb")](),y[a0_0x1b8a("0x281")][a0_0x1b8a("0x3c6")](this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x3db")]()[a0_0x1b8a("0x406")]),p[a0_0x1b8a("0x281")]["SetMap"](this["_click_tower"][a0_0x1b8a("0x5fc")](),this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x15f")](),0),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x337")](this[a0_0x1b8a("0x32c")][a0_0x1b8a("0x5fc")](),this[a0_0x1b8a("0x32c")]["GridY"]()),this["_click_tower"]=null,c["PlayEx"](a0_0x1b8a("0x406")))}[a0_0x1b8a("0x381")](){c[a0_0x1b8a("0x441")]("click"),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!1,this["first_once"]["visible"]=!1,this[a0_0x1b8a("0x48a")]()}[a0_0x1b8a("0x5b4")](t=0){let o=[null,this[a0_0x1b8a("0xf7")],this["_lable_num_item2"],this[a0_0x1b8a("0x108")]],i=[null,this[a0_0x1b8a("0x13a")],this["_prop1"],this[a0_0x1b8a("0x578")]],a=[null,this[a0_0x1b8a("0x48")],this["btn_item2"],this[a0_0x1b8a("0x1b2")]],r=[null,this[a0_0x1b8a("0xc6")],this[a0_0x1b8a("0x3c0")],this[a0_0x1b8a("0x5")]],s=[null,this[a0_0x1b8a("0x4d9")],this[a0_0x1b8a("0x52e")],null],n=[null,this[a0_0x1b8a("0x18a")],this[a0_0x1b8a("0x5b")],null];for(let e=1;e<3;e++){let t=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x266")](e);0==parseInt(t)?h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x448")]>0?(o[e]["text"]="",i[e][a0_0x1b8a("0x11e")]="image/main/ss.png",a[e][a0_0x1b8a("0x526")]=!1,r[e][a0_0x1b8a("0x212")]=!0,s[e]["visible"]=!1,n[e][a0_0x1b8a("0x212")]=!1):h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ab")]()>=100?(o[e]["text"]="100",i[e][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x293"),a[e][a0_0x1b8a("0x526")]=!1,r[e][a0_0x1b8a("0x212")]=!1,s[e][a0_0x1b8a("0x212")]=!0,n[e][a0_0x1b8a("0x212")]=!0):(o[e][a0_0x1b8a("0x195")]="100",i[e][a0_0x1b8a("0x11e")]="image/main/skill2.png",a[e][a0_0x1b8a("0x526")]=!0,r[e][a0_0x1b8a("0x212")]=!1,s[e][a0_0x1b8a("0x212")]=!0,n[e][a0_0x1b8a("0x212")]=!0):(o[e]["text"]=""+t,i[e][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x293"),a[e]["gray"]=!1,r[e]["visible"]=!1,s[e][a0_0x1b8a("0x212")]=!1,n[e][a0_0x1b8a("0x212")]=!0)}}["onItemAdv"](){console["log"](a0_0x1b8a("0x383")),this[a0_0x1b8a("0x222")]=!0,this["ShareVideoSetting"](a0_0x1b8a("0x35f"),this)}[a0_0x1b8a("0x535")](){this[a0_0x1b8a("0x2d2")][a0_0x1b8a("0x212")]||(this[a0_0x1b8a("0x2d2")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x2d2")][a0_0x1b8a("0x361")]=1,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1e3,this,function(){Laya["Tween"]["to"](this[a0_0x1b8a("0x2d2")],{alpha:0},500,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x2d2")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2d2")]["alpha"]=0}))}))}["onClickItem"](t){if(console[a0_0x1b8a("0x14e")]("---onClickItem----"),!d[a0_0x1b8a("0x1e8")]&&(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),d[a0_0x1b8a("0x220")][t-1]))if(0!=h["Instance"][a0_0x1b8a("0x16e")](t))switch(t){case 1:B[a0_0x1b8a("0x281")][a0_0x1b8a("0x47a")]();break;case 2:w[a0_0x1b8a("0x281")][a0_0x1b8a("0x416")]();break;case 3:this["canBuildTowerMode"]=!0;break;default:B[a0_0x1b8a("0x281")]["Play"]()}else if(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3c3")]())this["nowidx"]=t,this[a0_0x1b8a("0x1d5")]();else if(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ab")]()>=100)switch(h[a0_0x1b8a("0x281")]["DelDiamond"](100),t){case 1:B[a0_0x1b8a("0x281")][a0_0x1b8a("0x47a")]();break;case 2:w[a0_0x1b8a("0x281")][a0_0x1b8a("0x416")]();break;case 3:this["canBuildTowerMode"]=!0;break;default:B[a0_0x1b8a("0x281")][a0_0x1b8a("0x47a")]()}else A[a0_0x1b8a("0x281")][a0_0x1b8a("0x57e")](0,a0_0x1b8a("0x305"))}[a0_0x1b8a("0x48a")](){0==d[a0_0x1b8a("0x2a9")]?(h["Instance"][a0_0x1b8a("0x604")][d["NormalIndex"]]["Hp"]<=0&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](),A["Instance"][a0_0x1b8a("0x111")]()),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d["NormalIndex"]][a0_0x1b8a("0x2d4")]>d[a0_0x1b8a("0xfd")][d[a0_0x1b8a("0x45f")]]&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](1),A[a0_0x1b8a("0x281")]["Release"]()),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x84")]()):1==h["Instance"][a0_0x1b8a("0x321")](d[a0_0x1b8a("0x61")])&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x111")]()),this["initList"](),this[a0_0x1b8a("0x89")](),this["checkCost"](),this["initAroundGameover"](),p["Instance"]["SetPath"](),u["HideBanner"]()}["initData"](){if(0==d[a0_0x1b8a("0x2a9")]&&h["Instance"][a0_0x1b8a("0x546")](),this[a0_0x1b8a("0x59e")](),this[a0_0x1b8a("0xbc")](),this[a0_0x1b8a("0x318")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()),this[a0_0x1b8a("0x492")]=h["Instance"][a0_0x1b8a("0x42e")]["Guide"],this[a0_0x1b8a("0x492")]<=1){this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x14")]=!0;for(let i in h[a0_0x1b8a("0x281")]["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")]){let t=i[a0_0x1b8a("0x311")]("_"),e=h["Instance"]["LevelData"][d[a0_0x1b8a("0x45f")]]["MapTower"][i],o=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](Number(t[0]),Number(t[1]));this[a0_0x1b8a("0x2a5")](e,o["x"],o["y"],!1)}y[a0_0x1b8a("0x281")][a0_0x1b8a("0x308")](d[a0_0x1b8a("0xf0")]())}else{if(this["bCanPath"]=!0,0==d["ModeSelect"])for(let i in h["Instance"][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")]){let t=i["split"]("_"),e=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")][i],o=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](Number(t[0]),Number(t[1]));this["addTower"](e,o["x"],o["y"],!1)}else{var a=h["Instance"][a0_0x1b8a("0x116")]();for(let i in a[a0_0x1b8a("0x211")][a0_0x1b8a("0x51d")]){let t=i[a0_0x1b8a("0x311")]("_"),e=a["data"]["MapTower"][i],o=p["Instance"][a0_0x1b8a("0x279")](Number(t[0]),Number(t[1]));this[a0_0x1b8a("0x2a5")](e,o["x"],o["y"],!1)}}if(0==d[a0_0x1b8a("0x2a9")])for(let e=0;e<h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d["NormalIndex"]][a0_0x1b8a("0x126")]["length"];e++){let t=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x126")][e];A["Instance"][a0_0x1b8a("0x207")](Number(t["id"]),Number(t["x"]),Number(t["y"]),Number(t["hp"]))}0==d[a0_0x1b8a("0x2a9")]?y[a0_0x1b8a("0x281")][a0_0x1b8a("0x308")](Number(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]),!1):y[a0_0x1b8a("0x281")][a0_0x1b8a("0x308")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")](),!1),this["UpdateItemNum"]()}}["initDoor"](){for(;this["_mesh"][a0_0x1b8a("0x263")];)this[a0_0x1b8a("0x5eb")][a0_0x1b8a("0x3")](0);if((0==d[a0_0x1b8a("0x2a9")]?2==d[a0_0x1b8a("0x45f")]:d["AroundSelect"]>=1)&&d[a0_0x1b8a("0x2f6")][a0_0x1b8a("0x6f")]<3){let t=new Laya[a0_0x1b8a("0xec")];t[a0_0x1b8a("0x416")](0,!0,"door2"),this[a0_0x1b8a("0x5eb")]["addChild"](t),-1==d["endPos"][1]["x"]?t["x"]=-80:7==d[a0_0x1b8a("0x3a9")][1]["x"]&&(t["x"]=d[a0_0x1b8a("0x3a9")][1]["x"]*d["width"]+80),t["y"]=d[a0_0x1b8a("0x3a9")][1]["y"]*d["height"]}let t=new Laya[a0_0x1b8a("0xec")];t[a0_0x1b8a("0x416")](0,!0,a0_0x1b8a("0x4a3")),this[a0_0x1b8a("0x5eb")][a0_0x1b8a("0x40a")](t),t["x"]=d[a0_0x1b8a("0x3a9")][0]["x"]*d["width"],t["y"]=d[a0_0x1b8a("0x3a9")][0]["y"]*d[a0_0x1b8a("0x22f")]}[a0_0x1b8a("0x6")](){console[a0_0x1b8a("0x14e")]("---------initList--------------"),this[a0_0x1b8a("0x1ca")][a0_0x1b8a("0x16b")]="",this["_list"][a0_0x1b8a("0x508")]=!0,this[a0_0x1b8a("0x1ca")][a0_0x1b8a("0x61c")]=new Laya[a0_0x1b8a("0x2aa")](this,this[a0_0x1b8a("0x18b")]),this[a0_0x1b8a("0x1ca")]["renderHandler"]=new Laya["Handler"](this,this["updateItem"]),u["RecorderStart"]()}[a0_0x1b8a("0xc1")](){this["towerOrderList"]=[];let o=_[a0_0x1b8a("0x281")]["GetTowerData"]();for(let e in o){let t=o[e];1==t[a0_0x1b8a("0x618")]&&null!=t[a0_0x1b8a("0x369")]&&(71==t["id"]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["Unlock"][t["id"]]?this[a0_0x1b8a("0x450")][a0_0x1b8a("0x39f")](3,0,t):61==t["id"]&&h[a0_0x1b8a("0x281")]["Data"][a0_0x1b8a("0x2f1")][t["id"]]?this["towerOrderList"][a0_0x1b8a("0x39f")](3,0,t):this[a0_0x1b8a("0x450")][a0_0x1b8a("0x198")](t))}for(var t=[],e=0;e<this[a0_0x1b8a("0x450")][a0_0x1b8a("0x6f")];++e)t["push"]({name:this["towerOrderList"][e]["id"],TMessage:{icon:{skin:this[a0_0x1b8a("0x450")][e][a0_0x1b8a("0x369")]},TowerName:{text:this[a0_0x1b8a("0x450")][e]["name"]},price:{text:this[a0_0x1b8a("0x450")][e][a0_0x1b8a("0x70")]},lockicon:{visible:!h["Instance"][a0_0x1b8a("0x579")](this[a0_0x1b8a("0x450")][e]["id"])}}});this["_list"]["array"]=t}["onSelect"](t){console["log"]("当前选择的索引："+t)}[a0_0x1b8a("0x60b")](t,e){let o=Number(t[a0_0x1b8a("0x1db")]),i=t;i[a0_0x1b8a("0x3f7")](Laya["Event"][a0_0x1b8a("0x3b7")]);let a=this;i["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,function(){a[a0_0x1b8a("0x8")]=o,a[a0_0x1b8a("0x3c")](o)})}[a0_0x1b8a("0xd")](){this[a0_0x1b8a("0x4fc")][a0_0x1b8a("0x212")]||this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]||(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][0]["MapID"]>1&&(this[a0_0x1b8a("0x4aa")]+=.5*d["tick"],this[a0_0x1b8a("0x4aa")]>45e3&&(this[a0_0x1b8a("0x4aa")]=0,this[a0_0x1b8a("0x284")][a0_0x1b8a("0x212")]||this["ShowParachute"]())),this[a0_0x1b8a("0x2fa")]?this[a0_0x1b8a("0x2e0")]():(this["_t"]=!this["_t"],this["_t"]&&this[a0_0x1b8a("0x2e0")]()))}["viewSelect"](){this["tczz"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x33d")][a0_0x1b8a("0x212")]=!0,0==d["ModeSelect"]&&(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2e8")](h["Instance"]["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x2d4")]+1),d[a0_0x1b8a("0x45f")]<3&&h["Instance"][a0_0x1b8a("0x261")](d[a0_0x1b8a("0x45f")]+1),h[a0_0x1b8a("0x281")]["GetNormaMaxlLevel"]()>d["MaxLevel"][0]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x261")](4))}[a0_0x1b8a("0x2bd")](){c["PlayEx"]("click"),this[a0_0x1b8a("0x33d")][a0_0x1b8a("0x212")]=!1,this["setSeltfMap"](h["Instance"][a0_0x1b8a("0x3a6")]()+1),Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x143")],{alpha:0},800,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){this[a0_0x1b8a("0x143")][a0_0x1b8a("0x2d9")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x9b")][a0_0x1b8a("0x33b")](1.5,1.5),this[a0_0x1b8a("0x9b")]["alpha"]=0,this[a0_0x1b8a("0x1c8")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3de")]()}))}[a0_0x1b8a("0x29a")](){this[a0_0x1b8a("0x14f")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()+1),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this["_viewSelect"]["visible"]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,Laya["Tween"]["to"](this[a0_0x1b8a("0x143")],{alpha:0},800,null,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x143")]["centerX"]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x9b")][a0_0x1b8a("0x33b")](1.5,1.5),this["_winfont"][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x1c8")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x354")]()}))}[a0_0x1b8a("0xb7")](){c["PlayEx"](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x33d")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x143")],{alpha:0},800,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x143")][a0_0x1b8a("0x2d9")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x9b")][a0_0x1b8a("0x33b")](1.5,1.5),this["_winfont"][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x1c8")]["alpha"]=0,this[a0_0x1b8a("0x354")]()}))}["tishi"](t){this[a0_0x1b8a("0x10a")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x10a")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x10a")]["y"]=379,this[a0_0x1b8a("0x10a")]["text"]=t,Laya[a0_0x1b8a("0x1e1")]["to"](this["testLabel"],{alpha:0,y:200},1200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this["testLabel"][a0_0x1b8a("0x212")]=!1}))}[a0_0x1b8a("0x438")](t){this[a0_0x1b8a("0x284")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1ea")][a0_0x1b8a("0x212")]=!1,this["_drop_timer"]=0,this[a0_0x1b8a("0x32b")][a0_0x1b8a("0x212")]=!1,t?Laya["Tween"]["to"](this[a0_0x1b8a("0x143")],{alpha:1,centerX:0},400,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){this[a0_0x1b8a("0x9b")][a0_0x1b8a("0x361")]=1,Laya["Tween"]["to"](this[a0_0x1b8a("0x9b")],{scaleX:1,scaleY:1},400,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this["_winlight"],{alpha:1},400,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x1c8")],{alpha:0},400,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x1c8")],{alpha:1},400,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){0==d[a0_0x1b8a("0x2a9")]?3==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()?Laya[a0_0x1b8a("0x1e1")]["to"](this["_win"],{alpha:0},800,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x143")][a0_0x1b8a("0x2d9")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x9b")][a0_0x1b8a("0x33b")](1.5,1.5),this["_winfont"][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x1c8")][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x354")]()})):this[a0_0x1b8a("0x210")]():this[a0_0x1b8a("0xb7")]()}))}))}))}))})):(0==d[a0_0x1b8a("0x2a9")]&&(h[a0_0x1b8a("0x281")]["FailSaveDataFromTemp"](),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x174")]()),Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x2b1")],{alpha:1,centerX:0},400,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){this["lostfont"][a0_0x1b8a("0x361")]=1,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x35")],{scaleX:1,scaleY:1},400,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya["Tween"]["to"](this["losefont0"],{rotation:-20},200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x283")],{rotation:-15},200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x283")],{rotation:-20},200,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](500,this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this["_lose"],{alpha:0},500,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){this[a0_0x1b8a("0x2b1")][a0_0x1b8a("0x2d9")]=Laya[a0_0x1b8a("0x1eb")]["width"],this["lostfont"][a0_0x1b8a("0x361")]=0,this[a0_0x1b8a("0x35")][a0_0x1b8a("0x33b")](1.5,1.5),this[a0_0x1b8a("0x283")][a0_0x1b8a("0x5f2")]=0,this[a0_0x1b8a("0x17a")]()}))})}))}))}))}))})))}[a0_0x1b8a("0x17a")](){0==d[a0_0x1b8a("0x2a9")]?(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x301")](),this["_mainui"]["visible"]=!0,this["bCanPath"]=!0,this["_pause"]=!1,this[a0_0x1b8a("0x2fa")]=!1,d["spd"]=1,this[a0_0x1b8a("0x1e3")][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2fa")]?a0_0x1b8a("0x2de"):a0_0x1b8a("0xcb")):(this[a0_0x1b8a("0xe8")](),this["bCanPath"]=!0,this[a0_0x1b8a("0x222")]=!1,this["_spd"]=!1,d[a0_0x1b8a("0x330")]=1,this["btn_speed"][a0_0x1b8a("0x11e")]=this[a0_0x1b8a("0x2fa")]?"image/ui/speedup.png":a0_0x1b8a("0xcb"))}[a0_0x1b8a("0x354")](){console["log"]("---------onComplete------------"),h[a0_0x1b8a("0x281")]["Restart"](1),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x301")](),this[a0_0x1b8a("0x54d")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x18")]),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x14")]=!0,this[a0_0x1b8a("0x222")]=!1}["ShowLabel"](t){if(t){let t=this;h[a0_0x1b8a("0x281")][a0_0x1b8a("0x47f")]();h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()>=d[a0_0x1b8a("0xfd")][h["Instance"][a0_0x1b8a("0x3a6")]()]?Laya["Tween"]["to"](this[a0_0x1b8a("0x143")],{scaleX:1,scaleY:1},1e3,null,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){t[a0_0x1b8a("0x219")]=2,t[a0_0x1b8a("0x4b")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x177")+this[a0_0x1b8a("0x219")][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x101"),1==h["Instance"][a0_0x1b8a("0x193")]()||31==h["Instance"][a0_0x1b8a("0x193")]()||101==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()?t[a0_0x1b8a("0x4b")]["visible"]=!0:t["_lab"][a0_0x1b8a("0x212")]=!1,d[a0_0x1b8a("0x220")]=[!1,!1,!1],t[a0_0x1b8a("0x149")]=0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2e8")](h["Instance"][a0_0x1b8a("0x193")]()+1),I["Instance"][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x318")](h[a0_0x1b8a("0x281")]["GetMapID"]()),0==d["ModeSelect"]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x546")](),h[a0_0x1b8a("0x281")]["SaveMapData"]()})):(t[a0_0x1b8a("0x219")]=4,t[a0_0x1b8a("0x4b")]["skin"]="image/main/_lab"+this["_time_lab"][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x101"),d[a0_0x1b8a("0x220")]=[!1,!1,!1],t[a0_0x1b8a("0x149")]=0,0==d[a0_0x1b8a("0x2a9")]?h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2e8")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()+1):h[a0_0x1b8a("0x281")][a0_0x1b8a("0x40")](h["Instance"][a0_0x1b8a("0x193")]()+1),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x318")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()),0==d["ModeSelect"]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x546")](),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x174")](),0==d[a0_0x1b8a("0x2a9")]?1!=h[a0_0x1b8a("0x281")]["GetMapID"]()&&31!=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()&&101!=h["Instance"][a0_0x1b8a("0x193")]()&&171!=h["Instance"]["GetMapID"]()||d["isGuide"]?(t[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!1,t[a0_0x1b8a("0x219")]=2):(t[a0_0x1b8a("0x4b")]["visible"]=!0,t[a0_0x1b8a("0x219")]=4):1==h[a0_0x1b8a("0x281")]["AroundData"][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]][h[a0_0x1b8a("0x281")][a0_0x1b8a("0x19a")][a0_0x1b8a("0x5e3")][d[a0_0x1b8a("0x61")]]["length"]-1]["data"][a0_0x1b8a("0x2d4")]&&1==h["Instance"]["GetMaxLevel"](d[a0_0x1b8a("0x61")])?(t["_lab"][a0_0x1b8a("0x212")]=!0,t[a0_0x1b8a("0x219")]=4):(t["_lab"][a0_0x1b8a("0x212")]=!1,t[a0_0x1b8a("0x219")]=2))}else this[a0_0x1b8a("0x219")]=4,this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x177")+this[a0_0x1b8a("0x219")][a0_0x1b8a("0xdf")]()+".png",0==d[a0_0x1b8a("0x2a9")]?1==h[a0_0x1b8a("0x281")]["GetMapID"]()||31==h["Instance"]["GetMapID"]()||101==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()||171==h["Instance"][a0_0x1b8a("0x193")]()?(d[a0_0x1b8a("0x1e8")]?this["_lab"]["visible"]=!1:this[a0_0x1b8a("0x4b")]["visible"]=!0,this[a0_0x1b8a("0x219")]=4):(this["_lab"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x219")]=2):1==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()?(this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x219")]=4):(this[a0_0x1b8a("0x4b")]["visible"]=!1,this["_time_lab"]=2),d[a0_0x1b8a("0x220")]=[!1,!1,!1],this[a0_0x1b8a("0x149")]=0}["Tick"](){if(!this["_pause"]){if(p[a0_0x1b8a("0x281")][a0_0x1b8a("0x40c")](),0!=this["_time_lab"]){if((this[a0_0x1b8a("0x149")]+=d["tick"])&&this[a0_0x1b8a("0x149")]>=1e3){if(this[a0_0x1b8a("0x149")]-=1e3,this["_time_lab"]--,this[a0_0x1b8a("0x219")]<=0)return this[a0_0x1b8a("0x219")]=0,this["_bInit"]=!0,d[a0_0x1b8a("0x220")]=[!0,!0,!0],this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!1,void y[a0_0x1b8a("0x281")][a0_0x1b8a("0x413")]();this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x177")+this["_time_lab"][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x101"),Laya[a0_0x1b8a("0x1e1")]["to"](this["_lab"],{scaleX:1.2,scaleY:1.2},100,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x3a")]=1,this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x48b")]=1})),1!=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x193")]()&&31!=h[a0_0x1b8a("0x281")]["GetMapID"]()&&101!=h["Instance"][a0_0x1b8a("0x193")]()||c["PlayEx"]("S"+this[a0_0x1b8a("0x219")][a0_0x1b8a("0xdf")]())}}else y[a0_0x1b8a("0x281")][a0_0x1b8a("0xa2")]();this["_bInit"]&&A[a0_0x1b8a("0x281")][a0_0x1b8a("0x2e0")](),this[a0_0x1b8a("0x47e")]["visible"]&&this[a0_0x1b8a("0x45b")](),this["_item"][a0_0x1b8a("0x212")]&&((this[a0_0x1b8a("0x284")]["x"]>=this["_item_clampXmax"]||this[a0_0x1b8a("0x284")]["x"]<=this["_item_clampXmin"])&&(this["_item_speedx"]=-this[a0_0x1b8a("0x46f")]),this[a0_0x1b8a("0x284")]["y"]<=this[a0_0x1b8a("0x26f")]&&this[a0_0x1b8a("0x346")]<0&&(this[a0_0x1b8a("0x346")]=-this["_item_speedy"]),this[a0_0x1b8a("0x284")]["y"]>=this[a0_0x1b8a("0x5cf")]&&(this["_item_speedy"]=-this[a0_0x1b8a("0x346")]),this[a0_0x1b8a("0x284")]["x"]+=this["_item_speedx"],this[a0_0x1b8a("0x284")]["y"]+=this[a0_0x1b8a("0x346")])}}[a0_0x1b8a("0x16d")](t){console["log"](a0_0x1b8a("0x3af")),this[a0_0x1b8a("0x4fc")][a0_0x1b8a("0x212")]=!0}[a0_0x1b8a("0x45b")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x486"));let t=this["_build_ui"]["x"],e=this["_build_ui"]["y"];0!=p["Instance"][a0_0x1b8a("0x421")](t,e)&&this["bCanPath"]?this[a0_0x1b8a("0x47e")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x583"):this[a0_0x1b8a("0x47e")]["skin"]=a0_0x1b8a("0x33e")}[a0_0x1b8a("0x57a")](t){if(console["log"](a0_0x1b8a("0x1f9")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this["_tips_2"][a0_0x1b8a("0x212")]=!1,t[a0_0x1b8a("0x5be")]&&t[a0_0x1b8a("0x5be")][a0_0x1b8a("0x6f")]>1)return;let e=t[a0_0x1b8a("0x34f")]-(this[a0_0x1b8a("0x59a")]["x"]-d[a0_0x1b8a("0x2e4")]/2),o=t[a0_0x1b8a("0x5e6")]-(this[a0_0x1b8a("0x59a")]["y"]-d[a0_0x1b8a("0x231")]/2),i=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](e,o);if(null==i)return;if(this[a0_0x1b8a("0x47e")]["visible"]||this[a0_0x1b8a("0x25c")][a0_0x1b8a("0x212")])return void this[a0_0x1b8a("0x2bb")]();let a=A[a0_0x1b8a("0x281")][a0_0x1b8a("0x10b")](i["x"],i["y"]);a&&this[a0_0x1b8a("0x19d")](e,o,a)}["setBuildItem"](){for(let e=0;e<this["_list"]["cells"][a0_0x1b8a("0x6f")];e++){let t=this[a0_0x1b8a("0x1ca")][a0_0x1b8a("0x35e")][e];(t=t["getChildByName"]("TMessage"))["scale"](0,0),Laya["Tween"]["to"](t,{scaleX:1,scaleY:1},100,null)}}[a0_0x1b8a("0x19d")](t,e,o){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x117")),this[a0_0x1b8a("0x8")]=o[a0_0x1b8a("0x3db")]()["id"],this[a0_0x1b8a("0x32c")]=o,this[a0_0x1b8a("0x25c")][a0_0x1b8a("0x212")]=!0,o["GetData"]()[a0_0x1b8a("0xaa")]<=0&&(this["btn_levelup"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x338")),this["lab_sell"][a0_0x1b8a("0x195")]="$"+o[a0_0x1b8a("0x3db")]()[a0_0x1b8a("0x406")];let i=_["Instance"]["GetTower"](this["_click_tower"][a0_0x1b8a("0x3db")]()[a0_0x1b8a("0xaa")]);i?(this["lab_levelup"][a0_0x1b8a("0x195")]="$"+i[a0_0x1b8a("0x70")],h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2db")]()<i[a0_0x1b8a("0x70")]?(this[a0_0x1b8a("0x332")]["color"]="#FC665E",this[a0_0x1b8a("0x99")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x31f")):(this["lab_levelup"][a0_0x1b8a("0x5e2")]="#FEE47E",this[a0_0x1b8a("0x99")][a0_0x1b8a("0x11e")]="image/ui/levelup.png")):(this[a0_0x1b8a("0x332")][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x610"),this["lab_levelup"]["text"]=a0_0x1b8a("0x28f"),this[a0_0x1b8a("0x99")][a0_0x1b8a("0x11e")]="image/ui/levelup0.png");let a=p[a0_0x1b8a("0x281")][a0_0x1b8a("0xdd")](t,e);this["_ui_tower"]["x"]=a["x"],this[a0_0x1b8a("0x25c")]["y"]=a["y"],this[a0_0x1b8a("0x5a9")]["width"]=2*o["Distance"](),this["_sp"][a0_0x1b8a("0x22f")]=2*o[a0_0x1b8a("0xf5")](),2==this[a0_0x1b8a("0x492")]&&this[a0_0x1b8a("0x382")](a0_0x1b8a("0x3e4"),10)}[a0_0x1b8a("0x487")](){}[a0_0x1b8a("0x2bb")](){this[a0_0x1b8a("0x47e")]["visible"]=!1,this[a0_0x1b8a("0x2ad")][a0_0x1b8a("0x212")]=!1,this["_ui_tower"][a0_0x1b8a("0x212")]=!1,p["Instance"]["HidePath"]()}["onBuild"](t){if(console[a0_0x1b8a("0x14e")]("---onBuild----"),null==_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](t))return;if(0==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](t))return void(0==this[a0_0x1b8a("0x4e")]["visible"]&&(this["tip_unlock_tower"][a0_0x1b8a("0x212")]=!0,Laya[a0_0x1b8a("0x5b7")]["once"](1e3,this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x4e")],{alpha:0},500,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x4e")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x4e")][a0_0x1b8a("0x361")]=1}))})));let e=this[a0_0x1b8a("0x47e")]["x"],o=this[a0_0x1b8a("0x47e")]["y"],i=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](e,o);A[a0_0x1b8a("0x281")]["CheckMonster"](i["x"],i["y"])||(this[a0_0x1b8a("0x2bb")](),this[a0_0x1b8a("0x2a5")](t,e,o),this[a0_0x1b8a("0x382")]("buildTower",t))}[a0_0x1b8a("0x2a5")](o,t,i,a=!0){if(console[a0_0x1b8a("0x14e")]("---addTower----"),this[a0_0x1b8a("0x14")]){let e=p[a0_0x1b8a("0x281")][a0_0x1b8a("0xdd")](t,i);if(e["x"]>0&&e["y"]>0){let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](o);if(!t)return void c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447"));if(a&&0==y[a0_0x1b8a("0x281")][a0_0x1b8a("0x28d")](t[a0_0x1b8a("0x70")]))return void c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447"));c["PlayEx"](a0_0x1b8a("0x4b4")),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x54")](o,e["x"],e["y"])}}}["checkCost"](){this[a0_0x1b8a("0x24a")]()}[a0_0x1b8a("0x22")](){this[a0_0x1b8a("0x222")]||this[a0_0x1b8a("0x4fc")]["visible"]||this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]||h["Instance"]["getHp"]()<=5&&this[a0_0x1b8a("0x2a1")]()}[a0_0x1b8a("0x2a1")](){this[a0_0x1b8a("0xfa")][a0_0x1b8a("0x212")]||(this[a0_0x1b8a("0xfa")]["visible"]=!0,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0xfa")],{alpha:1},300,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0xfa")],{},300,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya["Tween"]["to"](this[a0_0x1b8a("0xfa")],{alpha:0},300,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this["_red"]["visible"]=!1}))}))})))}[a0_0x1b8a("0x32d")](){this["sub_blood"][a0_0x1b8a("0x212")]||(this[a0_0x1b8a("0x61a")][a0_0x1b8a("0x212")]=!0,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x61a")],{alpha:1,scaleX:1.2,scaleY:1.2},100,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x61a")],{alpha:0,scaleX:1,scaleY:1},100,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x61a")][a0_0x1b8a("0x212")]=!1}))})),this["_red1"][a0_0x1b8a("0x212")]=!0,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x1fe")],{alpha:1},100,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x1fe")],{alpha:0},100,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){this["_red1"][a0_0x1b8a("0x212")]=!1}))})))}[a0_0x1b8a("0x4b0")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x42b")),this[a0_0x1b8a("0xca")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0xac")]["visible"]=!0,this["_pause"]=!0,Laya[a0_0x1b8a("0x5b7")]["once"](3e3,this,this["onOpenClosefuhuo"])}["onCloseFuhuo"](){this[a0_0x1b8a("0xca")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,Laya["timer"]["clear"](this,this["onOpenClosefuhuo"]),this[a0_0x1b8a("0x409")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x222")]=!0,y[a0_0x1b8a("0x281")][a0_0x1b8a("0x594")](!1)}[a0_0x1b8a("0x2a")](){this[a0_0x1b8a("0x67")](a0_0x1b8a("0xe9"),this)}[a0_0x1b8a("0x1d2")](){y[a0_0x1b8a("0x281")]["isPlayWarn"]&&(y["Instance"][a0_0x1b8a("0x258")]=!1,this["_red2"][a0_0x1b8a("0x212")]||(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x554")),this[a0_0x1b8a("0x55")][a0_0x1b8a("0x212")]=!0,Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x55")],{alpha:1},400,null,Laya[a0_0x1b8a("0x2aa")]["create"](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x55")],{alpha:.3},400,null,Laya["Handler"]["create"](this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x55")],{alpha:1},400,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){Laya["Tween"]["to"](this[a0_0x1b8a("0x55")],{alpha:0},400,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x55")]["visible"]=!1}))}))}))}))))}[a0_0x1b8a("0xbc")](){this["lab_hp"][a0_0x1b8a("0x195")]=""+h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5d6")]()}[a0_0x1b8a("0x59e")](){this[a0_0x1b8a("0x5df")]["text"]=""+h["Instance"]["getMoney"](),this[a0_0x1b8a("0x41e")]()}[a0_0x1b8a("0x475")](){var t=a0_0x1b8a("0x59");return 0==d["ModeSelect"]?t+=a0_0x1b8a("0x4a1"):t+="_around"+(d[a0_0x1b8a("0x61")]+1)[a0_0x1b8a("0xdf")](),t+="#"+d[a0_0x1b8a("0x436")]}[a0_0x1b8a("0x318")](t){0==d[a0_0x1b8a("0x2a9")]?(this["normal_title_container"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x53b")][a0_0x1b8a("0x212")]=!1,0==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()?this[a0_0x1b8a("0x341")][a0_0x1b8a("0x195")]="30":1==h["Instance"][a0_0x1b8a("0x3a6")]()?this["lab_maxLevel"]["text"]="100":2==h["Instance"]["getSelfMap"]()?this["lab_maxLevel"][a0_0x1b8a("0x195")]=a0_0x1b8a("0xbb"):3==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a6")]()&&(this[a0_0x1b8a("0x341")]["text"]=a0_0x1b8a("0x19")),this[a0_0x1b8a("0x1ee")][a0_0x1b8a("0x195")]=a0_0x1b8a("0x60e")+t,this[a0_0x1b8a("0x33c")][a0_0x1b8a("0x195")]=t):(this[a0_0x1b8a("0x3f2")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x53b")][a0_0x1b8a("0x212")]=!0,this["_around_title_label"]["text"]=t)}[a0_0x1b8a("0x32a")](){this[a0_0x1b8a("0x16")](),this[a0_0x1b8a("0xfe")]||(this["_guideLine"]=new Laya["Image"](a0_0x1b8a("0x5c0")),this[a0_0x1b8a("0x605")][a0_0x1b8a("0x5f2")]=-70,this[a0_0x1b8a("0x605")]["x"]=-5,this[a0_0x1b8a("0x605")]["y"]=-20,this[a0_0x1b8a("0xfe")]=new Laya[a0_0x1b8a("0x1de")](a0_0x1b8a("0x583")),this["_guideFrame"][a0_0x1b8a("0x46b")]=.5,this["_guideFrame"]["anchorY"]=.5,this[a0_0x1b8a("0x249")]=new Laya[a0_0x1b8a("0xec")],this[a0_0x1b8a("0x249")]["play"](0,!0,a0_0x1b8a("0x44e")),this[a0_0x1b8a("0x249")]["x"]=0,this[a0_0x1b8a("0x249")]["y"]=0,this[a0_0x1b8a("0x249")][a0_0x1b8a("0x55b")]=200,this[a0_0x1b8a("0x94")]=new Laya[a0_0x1b8a("0xdc")],this["_guide"][a0_0x1b8a("0x5ee")]=!1,this[a0_0x1b8a("0x94")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x605")]),this[a0_0x1b8a("0x94")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0xfe")]),this[a0_0x1b8a("0x94")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x249")]),this[a0_0x1b8a("0x249")]["x"]=-70,this[a0_0x1b8a("0x249")]["y"]=-70)}[a0_0x1b8a("0x4a4")](){if(this["_guide"][a0_0x1b8a("0x212")]){var t=this;this[a0_0x1b8a("0x249")]["x"]=0,this[a0_0x1b8a("0x249")]["y"]=0,console[a0_0x1b8a("0x14e")](this[a0_0x1b8a("0x492")]),Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x249")],{x:200,y:-580},850,null,Laya["Handler"][a0_0x1b8a("0x314")](this,function(){Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1e3,this,function(){t["_curGuideIdx"]<2&&t[a0_0x1b8a("0x4a4")]()})}))}}[a0_0x1b8a("0x216")](){this[a0_0x1b8a("0x492")]++,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x168")]++,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x28e")]()}[a0_0x1b8a("0x3b5")](t,e,o,i=!0){console[a0_0x1b8a("0x14e")]("this._curGuideIdx = "+this[a0_0x1b8a("0x492")]),0==this[a0_0x1b8a("0x492")]?(this[a0_0x1b8a("0x605")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x249")][a0_0x1b8a("0x4a2")](),this[a0_0x1b8a("0x4a4")]()):(Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x410")](this["_guideAnim"]),Laya["Tween"][a0_0x1b8a("0x410")](this[a0_0x1b8a("0x249")]),this[a0_0x1b8a("0x249")]["x"]=-70,this[a0_0x1b8a("0x249")]["y"]=-70,this["_guideAnim"][a0_0x1b8a("0x416")](0,!0,"guide"),this[a0_0x1b8a("0x605")][a0_0x1b8a("0x212")]=!1),t[a0_0x1b8a("0x550")](this[a0_0x1b8a("0x94")],t[a0_0x1b8a("0x263")]-1),this["_guide"]["x"]=e,this[a0_0x1b8a("0x94")]["y"]=o,this["_guideFrame"]["visible"]=i}[a0_0x1b8a("0x16")](){this[a0_0x1b8a("0x94")]&&this[a0_0x1b8a("0x94")]["removeSelf"](),this[a0_0x1b8a("0x427")][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x382")](t,e){if(console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4e5")),this[a0_0x1b8a("0x222")]&&!d[a0_0x1b8a("0x1e8")])return;if(this[a0_0x1b8a("0x492")]<0||this[a0_0x1b8a("0x492")]>=this[a0_0x1b8a("0x182")][a0_0x1b8a("0x6f")])return void(d["isGuide"]=!1);let o=this[a0_0x1b8a("0x182")][this[a0_0x1b8a("0x492")]];if(t==o[a0_0x1b8a("0x56c")]&&!(e!=o[a0_0x1b8a("0x218")]&&o[a0_0x1b8a("0x218")]>=0||o["PARAM"]<0&&this[a0_0x1b8a("0x1")]<o[a0_0x1b8a("0x4be")]&&(this[a0_0x1b8a("0x1")]+=e,this[a0_0x1b8a("0x1")]<o["COUNT"]))){switch(this[a0_0x1b8a("0x16")](),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x2cf")+o["EVENT"]),o["EVENT"]){case a0_0x1b8a("0x5c5"):this[a0_0x1b8a("0x222")]=!0,this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x8e")](0);var i=this[a0_0x1b8a("0x11c")][a0_0x1b8a("0x165")](a0_0x1b8a("0xeb"));this[a0_0x1b8a("0x3b5")](this["game_towerui"],i["x"]+50,i["y"]+50,!1);break;case a0_0x1b8a("0x308"):this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x222")]=!0;let t=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](4,1);this[a0_0x1b8a("0x3b5")](this[a0_0x1b8a("0x5cd")],t["x"],t["y"]),this[a0_0x1b8a("0x2a6")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x43c")]=!0;break;case a0_0x1b8a("0x3a2"):2==this[a0_0x1b8a("0x492")]?this[a0_0x1b8a("0x3b5")](this[a0_0x1b8a("0x2ad")],185,50,!1):4==this["_curGuideIdx"]&&this[a0_0x1b8a("0x3b5")](this[a0_0x1b8a("0x2ad")],60,50,!1);break;case a0_0x1b8a("0x140"):if(3==this[a0_0x1b8a("0x492")]){let t=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](3,1);this[a0_0x1b8a("0x3b5")](this[a0_0x1b8a("0x5cd")],t["x"],t["y"])}else if(5==this[a0_0x1b8a("0x492")]){let t=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](3,1);this["showGuide"](this[a0_0x1b8a("0x5cd")],t["x"],t["y"])}else 7==this[a0_0x1b8a("0x492")]&&(this["_pause"]=!1,this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!0);break;case a0_0x1b8a("0x68"):var a=A[a0_0x1b8a("0x281")][a0_0x1b8a("0x15b")]()[0],r=this[a0_0x1b8a("0x5cd")]["getChildAt"](0);p["Instance"][a0_0x1b8a("0x279")](a[a0_0x1b8a("0x5fc")](),a["GridY"]());this[a0_0x1b8a("0x3b5")](r,34,34);break;case a0_0x1b8a("0x1a6"):this[a0_0x1b8a("0x427")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x222")]=!1;break;case"addMoney":break;case a0_0x1b8a("0x3e4"):this[a0_0x1b8a("0x3b5")](this[a0_0x1b8a("0x99")],40,40,!1),this[a0_0x1b8a("0x43c")]=!0;break;case a0_0x1b8a("0x556"):this[a0_0x1b8a("0x222")]=!1,this["grideTemp"]=!1,this[a0_0x1b8a("0x4b")][a0_0x1b8a("0x212")]=!0,h["Instance"][a0_0x1b8a("0x42e")][a0_0x1b8a("0x168")],d[a0_0x1b8a("0x1e8")]=!1,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x28e")]()}this[a0_0x1b8a("0x216")]()}}["getGuideTowerId"](){return!!h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")][a0_0x1b8a("0x196")]&&(!(1==h["Instance"][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]]["MapTower"][a0_0x1b8a("0x196")]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2db")]()<5)&&(!(2==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")][a0_0x1b8a("0x196")]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2db")]()<10)&&3!=h["Instance"]["LevelData"][d[a0_0x1b8a("0x45f")]][a0_0x1b8a("0x51d")][a0_0x1b8a("0x196")]))}[a0_0x1b8a("0x163")](t="",e=-1){if(0==d["isGuide"])return!0;if(this[a0_0x1b8a("0x492")]<0||this["_curGuideIdx"]>=this["_guideList"]["length"])return!0;let o=this[a0_0x1b8a("0x182")][this["_curGuideIdx"]];return t==o["EVENT"]&&e==o[a0_0x1b8a("0x218")]}["ShowGetTips"](t,e,o){this[a0_0x1b8a("0x2ac")]=t,this[a0_0x1b8a("0x465")]=e,this[a0_0x1b8a("0xd0")][a0_0x1b8a("0x195")]="   Get                X"+e,1==t?(this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x1c7"),this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x33b")](1,1)):2==t?(this[a0_0x1b8a("0x2ea")]["skin"]=a0_0x1b8a("0x20f"),this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x33b")](1,1)):3==t?(this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x2b8"),this["_rewardimg"]["scale"](1,1)):4==t?(this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x11e")]="image/main/31_1.png",this[a0_0x1b8a("0x2ea")]["scale"](.8,.8)):5==t?(this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x3fa"),this[a0_0x1b8a("0x2ea")]["scale"](.8,.8)):6==t&&(this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x48e"),this[a0_0x1b8a("0x2ea")][a0_0x1b8a("0x33b")](.8,.8)),this["_tips_get"][a0_0x1b8a("0x212")]=!0,a0_0x1b8a("0x5b5")==u[a0_0x1b8a("0x82")]&&(this[a0_0x1b8a("0x4f5")][a0_0x1b8a("0x212")]=!0),this[a0_0x1b8a("0x222")]=!0,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x50b")][a0_0x1b8a("0x212")]=!0,u[a0_0x1b8a("0x1a4")](),u["ShowNaticeInterstitial"]();ADManageLaya["getInstance"]()[a0_0x1b8a("0x167")]()}["onOpenJJ"](){this[a0_0x1b8a("0x50b")][a0_0x1b8a("0x212")]=!0}["onCloseGetReward"](){c["PlayEx"](a0_0x1b8a("0x447")),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0x3ff")]),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0x34a")]),this[a0_0x1b8a("0x6c")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x222")]=!1,this["_close_tips"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0xae")](){var e=this;u[a0_0x1b8a("0x552")](function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x537")+JSON[a0_0x1b8a("0x60a")](t)),1==t[a0_0x1b8a("0x2c0")]&&(e["shareBtn"]["visible"]=!1)})}["onClickGetReward"](t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x30e")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),1==t?1==this[a0_0x1b8a("0x2ac")]?(h[a0_0x1b8a("0x281")][a0_0x1b8a("0xc4")](this[a0_0x1b8a("0x465")]),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()["SetMoney"](),A["Instance"][a0_0x1b8a("0x472")]()):2==this["_reward_type"]?h[a0_0x1b8a("0x281")][a0_0x1b8a("0x148")](this["_reward_count"]):3==this["_reward_type"]?this[a0_0x1b8a("0x4c5")](this[a0_0x1b8a("0x465")]):4==this["_reward_type"]?h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](2,this[a0_0x1b8a("0x465")],2):5==this[a0_0x1b8a("0x2ac")]?h[a0_0x1b8a("0x281")]["AddPropNumber"](3,this[a0_0x1b8a("0x465")],3):6==this[a0_0x1b8a("0x2ac")]&&h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](1,this["_reward_count"],4):(this[a0_0x1b8a("0x222")]=!0,this[a0_0x1b8a("0x67")]("levelup",this)),Laya[a0_0x1b8a("0x5b7")]["clear"](this,this[a0_0x1b8a("0x3ff")]),Laya["timer"][a0_0x1b8a("0x2a0")](this,this["onCloseGetReward"]),this["_close_tips"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x6c")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x222")]=!1,this["tczz"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x6")]()}["ShowParachute"](){console[a0_0x1b8a("0x14e")]("---ShowParachute----");let t=d[a0_0x1b8a("0x103")](1,6),e=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](t,-2),o=d[a0_0x1b8a("0x103")](1,8),i=d[a0_0x1b8a("0x103")](1,6);p[a0_0x1b8a("0x281")][a0_0x1b8a("0x279")](i,o);this["_item"]["x"]=e["x"],this[a0_0x1b8a("0x284")]["y"]=e["y"],this[a0_0x1b8a("0x284")]["visible"]=!0,this[a0_0x1b8a("0x284")][a0_0x1b8a("0x361")]=1,this[a0_0x1b8a("0x46f")]=d[a0_0x1b8a("0x103")](3,5),this[a0_0x1b8a("0x346")]=d[a0_0x1b8a("0x103")](1,3)}["onClickParachute"](){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x284")][a0_0x1b8a("0x361")]=0;let o=[1,2,4,5,6];for(let e=0;e<3;e++){let t=d[a0_0x1b8a("0x103")](0,o["length"]-1);this[a0_0x1b8a("0x2dc")][e]=o[t],o[a0_0x1b8a("0x39f")](t,1)}{let t=this[a0_0x1b8a("0x2dc")][0],e=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x1aa")](t);this["_icon_item1"][a0_0x1b8a("0x11e")]=e[a0_0x1b8a("0x369")],this["_num_item1"][a0_0x1b8a("0x195")]=e["number"]+"",this["_name_item1"]["text"]=e[a0_0x1b8a("0x1db")]}{let t=this[a0_0x1b8a("0x2dc")][1],e=_["Instance"][a0_0x1b8a("0x1aa")](t);this["_icon_item2"][a0_0x1b8a("0x11e")]=e["icon"],this["_num_item2"][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x4b9")]+"",this[a0_0x1b8a("0x20e")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x1db")]}{let t=this["_item_list"][2],e=_["Instance"][a0_0x1b8a("0x1aa")](t);this[a0_0x1b8a("0x4ae")][a0_0x1b8a("0x11e")]=e["icon"],this[a0_0x1b8a("0x9a")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x4b9")]+"",this[a0_0x1b8a("0x2e3")]["text"]=e[a0_0x1b8a("0x1db")]}this[a0_0x1b8a("0x1ea")]["visible"]=!0,Laya["timer"][a0_0x1b8a("0x3a4")](3e3,this,this[a0_0x1b8a("0x175")]),u[a0_0x1b8a("0x21b")]()}[a0_0x1b8a("0x175")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x544")),this["_close_get_item"][a0_0x1b8a("0x212")]=!0}[a0_0x1b8a("0x206")](){this["_close_fuhuo2"][a0_0x1b8a("0x212")]=!0}[a0_0x1b8a("0x445")](){c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x1ea")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x4aa")]=0,this["_item"]["visible"]=!1,Laya["timer"][a0_0x1b8a("0x2a0")](this,this[a0_0x1b8a("0x175")]),this[a0_0x1b8a("0x32b")]["visible"]=!1,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this["onCloseChoose"])}[a0_0x1b8a("0xe4")](t){if(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),t<0)return void this[a0_0x1b8a("0x445")]();this["supplyId"]=this[a0_0x1b8a("0x2dc")][t],null!=_[a0_0x1b8a("0x281")]["GetItem"](this[a0_0x1b8a("0x16a")])&&(t<0&&(this[a0_0x1b8a("0x222")]=!1),this["_pause"]=!0,this[a0_0x1b8a("0x67")](a0_0x1b8a("0x21c"),this))}["ShareCancel"](){0==this[a0_0x1b8a("0x43d")][a0_0x1b8a("0x212")]&&(this[a0_0x1b8a("0x43d")]["visible"]=!0,Laya[a0_0x1b8a("0x5b7")]["once"](1e3,this,function(){Laya[a0_0x1b8a("0x1e1")]["to"](this[a0_0x1b8a("0x43d")],{alpha:0},500,null,Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,function(){this[a0_0x1b8a("0x43d")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x43d")]["alpha"]=1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1}))}))}["onClickBuffBtn"](){d[a0_0x1b8a("0x1e8")]||!this[a0_0x1b8a("0x39d")]||this[a0_0x1b8a("0x222")]||(c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x222")]=!0,this[a0_0x1b8a("0x67")](a0_0x1b8a("0x41a"),this))}["InitSkillCd"](){this["_buff_mask_sprite"]=new Laya[a0_0x1b8a("0x541")],this[a0_0x1b8a("0x336")]["gray"]=!0,this["buff_bg"][a0_0x1b8a("0x85")]=this[a0_0x1b8a("0x33f")],this[a0_0x1b8a("0x33f")]["x"]=0,this["_buff_mask_sprite"]["y"]=0,this["_buff_bg2"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x21f")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x386")][a0_0x1b8a("0x212")]=!1,this["_buff_mask_sprite"][a0_0x1b8a("0x212")]=!1,this["buffanim"]=new Laya[a0_0x1b8a("0xec")],this["btn_buff"][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x260")]),this[a0_0x1b8a("0x260")]["x"]=-22,this[a0_0x1b8a("0x260")]["y"]=-25,this[a0_0x1b8a("0x260")][a0_0x1b8a("0x55b")]=60,this[a0_0x1b8a("0x260")][a0_0x1b8a("0x416")](0,!0,"bufflg");var t=(new Date)[a0_0x1b8a("0x52c")]();t-h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["BuffTimer"]<1e3*d[a0_0x1b8a("0x1fd")]&&(this["_buff_time"]=1e3*d[a0_0x1b8a("0x1fd")]-(t-h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["BuffTimer"]),this[a0_0x1b8a("0x39d")]=!1,this["AddSkillCd"]())}[a0_0x1b8a("0x252")](){this[a0_0x1b8a("0x39d")]||(this[a0_0x1b8a("0x336")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x21f")]["visible"]=!0,this["_buff_mask_sprite"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x386")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x386")][a0_0x1b8a("0x195")]=Math[a0_0x1b8a("0x1e")](this[a0_0x1b8a("0x221")]/1e3)[a0_0x1b8a("0xdf")](),this[a0_0x1b8a("0x1d3")][a0_0x1b8a("0x526")]=!0,this[a0_0x1b8a("0x260")][a0_0x1b8a("0x4a2")](),this[a0_0x1b8a("0x260")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x33f")]["graphics"][a0_0x1b8a("0x482")](this[a0_0x1b8a("0x21f")]["width"]/2,this[a0_0x1b8a("0x21f")][a0_0x1b8a("0x22f")]/2,this[a0_0x1b8a("0x21f")][a0_0x1b8a("0x357")]/2+10,-90,-90,a0_0x1b8a("0x29f")),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x23b")](this["_buff_tick_time"],this,this["SkillCdLoad"]))}[a0_0x1b8a("0x324")](){console["log"](a0_0x1b8a("0x514")),this[a0_0x1b8a("0x386")][a0_0x1b8a("0x195")]=Math[a0_0x1b8a("0x1e")](this["_buff_time"]/1e3)[a0_0x1b8a("0xdf")](),this[a0_0x1b8a("0x33f")]["graphics"][a0_0x1b8a("0x482")](this["buff_bg"]["width"]/2,this[a0_0x1b8a("0x21f")][a0_0x1b8a("0x22f")]/2,this["buff_bg"]["width"]/2+10,-90,360*(d[a0_0x1b8a("0x1fd")]-this[a0_0x1b8a("0x221")]/1e3)/d["BuffCD"]-90,a0_0x1b8a("0x29f"))}[a0_0x1b8a("0x3cd")](){this[a0_0x1b8a("0x222")]||this[a0_0x1b8a("0x221")]>0&&(this[a0_0x1b8a("0x221")]-=this[a0_0x1b8a("0x1df")],this["ShowSkillCd"](),this[a0_0x1b8a("0x221")]<=0&&(this["_buff_time"]=0,this[a0_0x1b8a("0x39d")]=!0,this[a0_0x1b8a("0x336")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x21f")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x33f")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x386")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1d3")][a0_0x1b8a("0x526")]=!1,this["buffanim"][a0_0x1b8a("0x416")](0,!0,a0_0x1b8a("0xda")),this[a0_0x1b8a("0x260")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x33f")][a0_0x1b8a("0x4f2")]["clear"](),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](this,this["SkillCdLoad"])))}[a0_0x1b8a("0x91")](o){if(0==this[a0_0x1b8a("0x31e")]["visible"]&&0==this[a0_0x1b8a("0x155")]){let t=o[a0_0x1b8a("0x34f")]-(this[a0_0x1b8a("0x59a")]["x"]-d[a0_0x1b8a("0x2e4")]/2),e=o["stageY"]-(this[a0_0x1b8a("0x59a")]["y"]-d[a0_0x1b8a("0x231")]/2);for(var i=0;i<this[a0_0x1b8a("0x24b")][a0_0x1b8a("0x6f")];++i)if(t>this[a0_0x1b8a("0x24b")][i]["bg"]["x"]&&t<=this[a0_0x1b8a("0x24b")][i]["bg"]["x"]+this[a0_0x1b8a("0x24b")][i]["bg"]["width"]&&e>this["gametowers"][i]["bg"]["y"]&&e<=this[a0_0x1b8a("0x24b")][i]["bg"]["y"]+this[a0_0x1b8a("0x24b")][i]["bg"][a0_0x1b8a("0x22f")]&&this[a0_0x1b8a("0x24b")][i]["canbuild"]){if(this[a0_0x1b8a("0x1e2")]=this[a0_0x1b8a("0x24b")][i]["id"],d[a0_0x1b8a("0x1e8")]&&(1!=this["towerTempId"]||0!=A["Instance"][a0_0x1b8a("0x15b")]()[a0_0x1b8a("0x6f")]))continue;this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x510")+this["towerTempId"][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x101"),this["canBuildTowerMode"]=!0,this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x47e")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x2ad")][a0_0x1b8a("0x212")]=!1,this["_ui_tower"][a0_0x1b8a("0x212")]=!1,this["towerTemp"]["x"]=o[a0_0x1b8a("0x34f")],this["towerTemp"]["y"]=o[a0_0x1b8a("0x5e6")];break}}}[a0_0x1b8a("0x1b1")](t){this[a0_0x1b8a("0x155")]&&this[a0_0x1b8a("0x42d")](t)}[a0_0x1b8a("0x3fd")](t){if(this[a0_0x1b8a("0x155")]){if(this[a0_0x1b8a("0x14")]){let e=t[a0_0x1b8a("0x34f")]-(this[a0_0x1b8a("0x59a")]["x"]-d[a0_0x1b8a("0x2e4")]/2),o=t[a0_0x1b8a("0x5e6")]-(this["_path"]["y"]-d[a0_0x1b8a("0x231")]/2);if(null!=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](e,o)){let t=p[a0_0x1b8a("0x281")]["GetFormatPos"](e,o);A[a0_0x1b8a("0x281")][a0_0x1b8a("0x54")](this[a0_0x1b8a("0x1e2")],t["x"],t["y"]);var i=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](this[a0_0x1b8a("0x1e2")]);y[a0_0x1b8a("0x281")][a0_0x1b8a("0x28d")](i[a0_0x1b8a("0x70")]),this[a0_0x1b8a("0x24a")](),d["isGuide"]&&this["onEvent"]("nextLevel",11)}else this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x155")]=!1}this[a0_0x1b8a("0x4cf")]["visible"]=!1,this["canBuildTowerMode"]=!1}}[a0_0x1b8a("0x55d")](t){}[a0_0x1b8a("0x42d")](t){let e=t[a0_0x1b8a("0x34f")]-(this[a0_0x1b8a("0x59a")]["x"]-d[a0_0x1b8a("0x2e4")]/2),o=t[a0_0x1b8a("0x5e6")]-(this[a0_0x1b8a("0x59a")]["y"]-d[a0_0x1b8a("0x231")]/2),i=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x74")](e,o);if(null==i)return;let a=p[a0_0x1b8a("0x281")]["GetFormatPos"](e,o);this[a0_0x1b8a("0x14")]=p[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a3")](a["x"],a["y"]),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x10b")](i["x"],i["y"])&&(this[a0_0x1b8a("0x14")]=!1),this[a0_0x1b8a("0x47e")][a0_0x1b8a("0x212")]=!0,this["_build_ui"]["x"]=a["x"],this["_build_ui"]["y"]=a["y"],this["towerTemp"]["x"]=a["x"],this["towerTemp"]["y"]=a["y"],this[a0_0x1b8a("0x14")]?this["_build_ui"][a0_0x1b8a("0x11e")]="image/ui/select1.png":this["_build_ui"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x33e")}["OutTowerBuild"](){this[a0_0x1b8a("0x47e")][a0_0x1b8a("0x212")]=!1,this["_build_ui_2"]["visible"]=!1,this[a0_0x1b8a("0x25c")]["visible"]=!1,this[a0_0x1b8a("0x4cf")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x155")]=!1}[a0_0x1b8a("0x67")](t,e){u[a0_0x1b8a("0xb4")](t,this[a0_0x1b8a("0x40e")],this[a0_0x1b8a("0x4ca")],this)}[a0_0x1b8a("0x40e")](r,s){switch(console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x17c")+r),s["_pause"]=!1,s[a0_0x1b8a("0x1e5")]=0,r){case a0_0x1b8a("0x1af"):let t=d[a0_0x1b8a("0x223")]();h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3b3")](_[a0_0x1b8a("0x281")][a0_0x1b8a("0x3a5")](t[a0_0x1b8a("0x5a2")])[a0_0x1b8a("0x2d8")],t[a0_0x1b8a("0x243")]),s[a0_0x1b8a("0x4c5")](-1),s[a0_0x1b8a("0x127")][a0_0x1b8a("0x26d")]=!0,s[a0_0x1b8a("0x2df")][a0_0x1b8a("0x26d")]=!0,s[a0_0x1b8a("0x5ba")]=0,Laya["timer"][a0_0x1b8a("0x23b")](100,s,s[a0_0x1b8a("0x56b")],[t["key"]]);break;case a0_0x1b8a("0x5a1"):s[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1;let e=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x607")](),o=_[a0_0x1b8a("0x281")]["GetSign"](e);if(s[a0_0x1b8a("0x57")][e-1][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=!0,d[a0_0x1b8a("0x4d4")]||(s["btn_signx1"][a0_0x1b8a("0x26d")]=!0,s[a0_0x1b8a("0x5b0")][a0_0x1b8a("0x26d")]=!0),7==e)s[a0_0x1b8a("0x180")](2);else{let t;var n;switch(2!=e||h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](o[a0_0x1b8a("0x58c")])?(t=d[a0_0x1b8a("0x2ec")](o[a0_0x1b8a("0x425")],2*o[a0_0x1b8a("0x237")]),n=o[a0_0x1b8a("0x425")]):(t=d[a0_0x1b8a("0x2ec")](o["type5"],1),n=o[a0_0x1b8a("0x4c7")]),s["_sign_obj"][e-1][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=!0,s[a0_0x1b8a("0x362")]["skin"]=t["icon"],s[a0_0x1b8a("0xb6")][a0_0x1b8a("0x195")]=t[a0_0x1b8a("0x1db")],s[a0_0x1b8a("0x14b")][a0_0x1b8a("0x212")]=!0,Number(n)){case 7:h[a0_0x1b8a("0x281")]["AddDiamond"](2*Number(o["count1"]));break;case 4:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](1,2*Number(o[a0_0x1b8a("0x237")]),4);break;case 2:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](2,2*Number(o[a0_0x1b8a("0x237")]),2);break;case 3:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](3,2*Number(o[a0_0x1b8a("0x237")]),3);break;case 8:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x4e0")](o["type5_id"]),s["updateTowerList"]()}}break;case a0_0x1b8a("0x50d"):u["HideBanner"](),h["Instance"][a0_0x1b8a("0x148")](50);break;case"supply":let i=_["Instance"][a0_0x1b8a("0x1aa")](s[a0_0x1b8a("0x16a")]);switch(s[a0_0x1b8a("0x16a")]){case 1:h[a0_0x1b8a("0x281")]["setMoney"](i[a0_0x1b8a("0x4b9")]),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x472")](),s["SetMoney"]();break;case 2:h["Instance"]["AddPropNumber"](2,i[a0_0x1b8a("0x4b9")],2);break;case 3:h[a0_0x1b8a("0x281")]["AddPropNumber"](3,i[a0_0x1b8a("0x4b9")],3);break;case 4:h["Instance"][a0_0x1b8a("0x2c6")](1,i["number"],4);break;case 6:h[a0_0x1b8a("0x281")][a0_0x1b8a("0xf9")](s["supplyId"],i[a0_0x1b8a("0x4b9")]);break;case 5:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5c7")](i["number"]);s[a0_0x1b8a("0xbc")]()}s[a0_0x1b8a("0x445")]();break;case"relife":s[a0_0x1b8a("0x494")]=!1,s["_fuhuo"][a0_0x1b8a("0x212")]=!1,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](s,s[a0_0x1b8a("0x206")]),s[a0_0x1b8a("0x222")]=!1,A["Instance"][a0_0x1b8a("0x111")](),h[a0_0x1b8a("0x281")]["reLoadMapData"](),s[a0_0x1b8a("0x409")][a0_0x1b8a("0x212")]=!1,Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](1e3,s,function(){s[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,p["Instance"][a0_0x1b8a("0x114")](),s[a0_0x1b8a("0x6")](),s["initData"](),s[a0_0x1b8a("0x41e")](),s[a0_0x1b8a("0x32a")](),s[a0_0x1b8a("0x382")](a0_0x1b8a("0x308"),0)});break;case"buff":s[a0_0x1b8a("0x39d")]=!1,s["_buff_time"]=1e3*d[a0_0x1b8a("0x1fd")];let a=A["Instance"]["getListTower"]();c["PlayEx"]("js");for(var b=0;b<a["length"];b++)a[b][a0_0x1b8a("0xcd")](2,1e3*d[a0_0x1b8a("0x176")]);h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x28a")]=(new Date)[a0_0x1b8a("0x52c")](),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x28e")](),s[a0_0x1b8a("0x252")]();break;case"speed":s[a0_0x1b8a("0x2fa")]=!0,d[a0_0x1b8a("0x330")]=.5,s[a0_0x1b8a("0x1e3")][a0_0x1b8a("0x11e")]=s[a0_0x1b8a("0x2fa")]?a0_0x1b8a("0x2de"):a0_0x1b8a("0xcb");break;case"item":switch(s[a0_0x1b8a("0x36c")]){case 1:h[a0_0x1b8a("0x281")]["AddPropNumber"](1,1,4);break;case 2:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x2c6")](2,1,2);break;case 3:h["Instance"][a0_0x1b8a("0x2c6")](3,1,3)}s[a0_0x1b8a("0x575")](s["nowidx"]);break;case a0_0x1b8a("0x179"):var x=h[a0_0x1b8a("0x281")]["GetMaxLevel"](d[a0_0x1b8a("0x61")]);h[a0_0x1b8a("0x281")]["AddMinLevel"](d[a0_0x1b8a("0x61")],x),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x148")](2*s[a0_0x1b8a("0xa6")]),s[a0_0x1b8a("0xe8")]();break;case a0_0x1b8a("0x38c"):var l=_[a0_0x1b8a("0x281")]["GetSupplyInfo"]();h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x4d")]++,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x148")](l[a0_0x1b8a("0x458")]),h[a0_0x1b8a("0x281")]["SaveLocalData"](),s[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!1,s[a0_0x1b8a("0x3d2")][a0_0x1b8a("0x212")]=!1;break;case a0_0x1b8a("0x556"):1==s[a0_0x1b8a("0x2ac")]?(h["Instance"][a0_0x1b8a("0xc4")](2*s[a0_0x1b8a("0x465")]),I[a0_0x1b8a("0x281")][a0_0x1b8a("0x289")]()[a0_0x1b8a("0x59e")](),A["Instance"][a0_0x1b8a("0x472")]()):2==s[a0_0x1b8a("0x2ac")]?h[a0_0x1b8a("0x281")]["AddDiamond"](2*s[a0_0x1b8a("0x465")]):3==s["_reward_type"]?s[a0_0x1b8a("0x4c5")](2*s[a0_0x1b8a("0x465")]):4==s[a0_0x1b8a("0x2ac")]?h[a0_0x1b8a("0x281")]["AddPropNumber"](2,2*s["_reward_count"],2):5==s[a0_0x1b8a("0x2ac")]?h["Instance"][a0_0x1b8a("0x2c6")](3,2*s[a0_0x1b8a("0x465")],3):6==s[a0_0x1b8a("0x2ac")]&&h["Instance"]["AddPropNumber"](1,2*s[a0_0x1b8a("0x465")],4),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x2a0")](s,s["onOpenJJ"]),Laya["timer"][a0_0x1b8a("0x2a0")](s,s[a0_0x1b8a("0x34a")]),s[a0_0x1b8a("0x50b")]["visible"]=!1,s["_tips_get"][a0_0x1b8a("0x212")]=!1,s[a0_0x1b8a("0x222")]=!1,s[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,s[a0_0x1b8a("0x6")]()}}[a0_0x1b8a("0x4ca")](t,e,o=!0){switch(console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x201")),e[a0_0x1b8a("0x222")]=!1,t){case a0_0x1b8a("0x1af"):break;case a0_0x1b8a("0x5a1"):e[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["canSign"]=1,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x11d")]--,h[a0_0x1b8a("0x281")]["SaveLocalData"]();break;case"diamond":e[a0_0x1b8a("0x132")][a0_0x1b8a("0x212")]=!1,e["tczz"][a0_0x1b8a("0x212")]=!1,u[a0_0x1b8a("0x21b")]();break;case a0_0x1b8a("0x21c"):break;case a0_0x1b8a("0xe9"):e["tczz"][a0_0x1b8a("0x212")]=!1}e[a0_0x1b8a("0x1e5")]<=d["ShareVideoPro"]&&(e[a0_0x1b8a("0x1e5")]=0)}[a0_0x1b8a("0x5d4")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1c9"));var t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x403")]();this[a0_0x1b8a("0x158")][a0_0x1b8a("0x195")]="x"+t[a0_0x1b8a("0x458")],d[a0_0x1b8a("0x3df")]=t[a0_0x1b8a("0x3b2")],this[a0_0x1b8a("0x145")]["on"](Laya[a0_0x1b8a("0x278")]["CLICK"],this,this[a0_0x1b8a("0xb0")]),this[a0_0x1b8a("0xa9")]["on"](Laya["Event"][a0_0x1b8a("0x3b7")],this,this["onClickDiamondgiftClose"]),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")][a0_0x1b8a("0x4d")]>=d[a0_0x1b8a("0x3df")]?this["btn_gifthave"][a0_0x1b8a("0x26d")]=!0:this[a0_0x1b8a("0x145")][a0_0x1b8a("0x26d")]=!1,u[a0_0x1b8a("0x4f1")]()}["onClickDiamondgiftHave"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4f7")),c[a0_0x1b8a("0x441")](a0_0x1b8a("0x447")),this["ShareVideoSetting"]("maingift",this)}["onClickDiamondgiftClose"](){c["PlayEx"](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x2d")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x3d2")][a0_0x1b8a("0x212")]=!1}["onClickDiamondGift"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x142")),c["PlayEx"](a0_0x1b8a("0x447")),this[a0_0x1b8a("0x2d")]["visible"]=!0,this[a0_0x1b8a("0x3d2")][a0_0x1b8a("0x212")]=!0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x42e")]["DiamondAdv"]>=d[a0_0x1b8a("0x3df")]?this[a0_0x1b8a("0x145")]["disabled"]=!0:this[a0_0x1b8a("0x145")]["disabled"]=!1,u[a0_0x1b8a("0x4f1")]();ADManageLaya[a0_0x1b8a("0x584")]()[a0_0x1b8a("0x167")]()}[a0_0x1b8a("0x45e")](t){return t<1e3?t[a0_0x1b8a("0xdf")]():(t/1e3)[a0_0x1b8a("0xc0")](2)+"K"}[a0_0x1b8a("0x345")](){this[a0_0x1b8a("0x4e3")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1}[a0_0x1b8a("0x3c1")](){this["_pause"]=!0,this["tczz"][a0_0x1b8a("0x212")]=!0,this["around_gameover"][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x3e6")]["visible"]=!1,this[a0_0x1b8a("0xa6")]=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x49")](h[a0_0x1b8a("0x281")]["GetMinLevel"](d[a0_0x1b8a("0x61")]),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x321")](d[a0_0x1b8a("0x61")])),this[a0_0x1b8a("0x200")]["text"]="x"+this[a0_0x1b8a("0xa6")][a0_0x1b8a("0xdf")]();var t=this;Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x3a4")](3e3,this,()=>{t["btn_gameover1"][a0_0x1b8a("0x212")]=!0})}[a0_0x1b8a("0x36b")](t){if(console["log"](a0_0x1b8a("0x30d")+t[a0_0x1b8a("0xdf")]()),1==t){var e=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x321")](d[a0_0x1b8a("0x61")]);h["Instance"][a0_0x1b8a("0x488")](d[a0_0x1b8a("0x61")],e),h["Instance"][a0_0x1b8a("0x148")](this[a0_0x1b8a("0xa6")]),this[a0_0x1b8a("0xe8")]()}else this["ShareVideoSetting"](a0_0x1b8a("0x179"),this)}[a0_0x1b8a("0x1b6")](){this[a0_0x1b8a("0x222")]=!1,this[a0_0x1b8a("0xac")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x4e3")]["visible"]=!1}[a0_0x1b8a("0xe8")](){this[a0_0x1b8a("0x222")]=!0,h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3ee")](2),A[a0_0x1b8a("0x281")][a0_0x1b8a("0x111")](),this[a0_0x1b8a("0x1b6")](),this[a0_0x1b8a("0x48a")]()}[a0_0x1b8a("0x12d")](t){this[a0_0x1b8a("0x284")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x1ea")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x4aa")]=0,this["_close_get_item"][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x47e")]["visible"]=!1,this[a0_0x1b8a("0x2ad")][a0_0x1b8a("0x212")]=!1,t?this[a0_0x1b8a("0x438")](t):h[a0_0x1b8a("0x281")][a0_0x1b8a("0x3c9")]()?this[a0_0x1b8a("0x3c1")]():I[a0_0x1b8a("0x281")]["GetBattleControl"]()[a0_0x1b8a("0x438")](t)}[a0_0x1b8a("0x431")](){}[a0_0x1b8a("0x2eb")](){}["GetOpenId"](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x522")),console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x433"))}[a0_0x1b8a("0x5c4")](){0!=this[a0_0x1b8a("0x242")]&&2!=this[a0_0x1b8a("0x242")]||(this[a0_0x1b8a("0x2d5")]=0),0==this["RankTabSelect"]||1==this[a0_0x1b8a("0x242")]?this["OpenRank"]():""!=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x564")]&&this[a0_0x1b8a("0x287")]()}[a0_0x1b8a("0x5aa")](t){this["RankTabSelect"]!=t&&(this["RankTabSelect"]=t,this["RankSubSelect"]=0,this[a0_0x1b8a("0x5c4")](),this[a0_0x1b8a("0x2eb")]())}[a0_0x1b8a("0x1a0")](t){this[a0_0x1b8a("0x2d5")]!=t&&(this[a0_0x1b8a("0x2d5")]=t,this["updateRank"]())}["getRankKey"](){var t="";return t=0==this[a0_0x1b8a("0x242")]?a0_0x1b8a("0xa3"):1==this[a0_0x1b8a("0x242")]?a0_0x1b8a("0x1b0")+(this[a0_0x1b8a("0x2d5")]+1)["toString"]():2==this[a0_0x1b8a("0x242")]?"OpenWorldRank_normal":a0_0x1b8a("0x5b9")+(this[a0_0x1b8a("0x2d5")]+1)[a0_0x1b8a("0xdf")](),t+="#"+d[a0_0x1b8a("0x436")]}[a0_0x1b8a("0x119")](){}[a0_0x1b8a("0x602")](t){}["UpdateWorldNormalInfo"](e,o){if(""!=h["Instance"]["InfoData"][a0_0x1b8a("0x564")]){var i=this;this["db"][a0_0x1b8a("0x5e0")](e)[a0_0x1b8a("0x118")]({_openid:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x160")]})[a0_0x1b8a("0x11a")]({success(t){if(0==t[a0_0x1b8a("0x211")][a0_0x1b8a("0x6f")])i["db"][a0_0x1b8a("0x5e0")](e)["add"]({data:{name:h["Instance"][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x1db")],url:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x564")],key:a0_0x1b8a("0x53a")+d[a0_0x1b8a("0x436")],score:o},success:function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x66")),console["log"](t)},fail:function(t){console[a0_0x1b8a("0x14e")](t)}});else{if(t["data"][0][a0_0x1b8a("0x442")]>=o)return void console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x1fb")+t[a0_0x1b8a("0x211")][0]["score"]+a0_0x1b8a("0x325")+o+a0_0x1b8a("0x36d"));i["db"]["collection"](e)[a0_0x1b8a("0x118")]({_openid:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x160")]})["update"]({data:{score:i["_"][a0_0x1b8a("0x2ba")](o)},success:function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4d2")),console[a0_0x1b8a("0x14e")](t)},fail:function(t){console["log"](t)}})}}})}}[a0_0x1b8a("0x4f8")](){if(console[a0_0x1b8a("0x14e")]("id = "+h[a0_0x1b8a("0x281")]["InfoData"]["id"][d["AroundSelect"]+1]),""!=h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x564")]){var t="Around"+(d[a0_0x1b8a("0x61")]+1)[a0_0x1b8a("0xdf")](),e=a0_0x1b8a("0x1c5")+(d["AroundSelect"]+1)[a0_0x1b8a("0xdf")]()+"#"+d[a0_0x1b8a("0x436")],o=h["Instance"][a0_0x1b8a("0x321")](d[a0_0x1b8a("0x61")])-1;""==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")]["id"][d["AroundSelect"]+1]?this["db"][a0_0x1b8a("0x5e0")](t)[a0_0x1b8a("0x48c")]({data:{name:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")]["name"],url:h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")][a0_0x1b8a("0x564")],key:e,score:o},success:function(t){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x66")),console[a0_0x1b8a("0x14e")](t),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")]["id"][d[a0_0x1b8a("0x61")]+1]=t[a0_0x1b8a("0x3d8")],h[a0_0x1b8a("0x281")][a0_0x1b8a("0x5ea")]()},fail:function(t){console[a0_0x1b8a("0x14e")](t)}}):this["db"][a0_0x1b8a("0x5e0")](t)[a0_0x1b8a("0x479")](h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")]["id"][d[a0_0x1b8a("0x61")]+1])[a0_0x1b8a("0x1b7")]({data:{score:o},success:function(t){console[a0_0x1b8a("0x14e")]("update success"),console["log"](t)},fail:function(t){console[a0_0x1b8a("0x14e")](t)}})}}["GetAllWorldInfo"](){}[a0_0x1b8a("0x619")](t){if(2==this[a0_0x1b8a("0x242")]?"normal":a0_0x1b8a("0x1c5")+(this["RankSubSelect"]+1)["toString"](),null!=t){var e=[],o=0;for(o=0;o<t[a0_0x1b8a("0x6f")];++o){var i={index:0,mc:0,avatarUrl:"",nickname:"",value:0};i[a0_0x1b8a("0x51f")]=t[o]["url"],i["nickname"]=t[o]["name"],i["value"]=t[o][a0_0x1b8a("0x442")],e[a0_0x1b8a("0x198")](i)}for(e=e[a0_0x1b8a("0x543")](function(t,e){return e[a0_0x1b8a("0x243")]-t[a0_0x1b8a("0x243")]}),o=0;o<e["length"];o++)e[o][a0_0x1b8a("0x326")]=o+1,e[o]["mc"]=o+1,e[o][a0_0x1b8a("0x51f")],h[a0_0x1b8a("0x281")][a0_0x1b8a("0x1bc")]["url"];e[a0_0x1b8a("0x6f")]>100&&(e=e["slice"](0,100))}}[a0_0x1b8a("0x504")](){for(var t=0;t<this[a0_0x1b8a("0x11c")]["numChildren"];++t){var e=this["game_towerui"][a0_0x1b8a("0x13f")](t),o=e["getChildByName"](a0_0x1b8a("0x518")),i=e[a0_0x1b8a("0x165")](a0_0x1b8a("0x396")),a=i[a0_0x1b8a("0x165")](a0_0x1b8a("0x3b4")),r=i[a0_0x1b8a("0x165")](a0_0x1b8a("0x5c1")),s=e[a0_0x1b8a("0x165")](a0_0x1b8a("0x28"));e["y"]=750,this[a0_0x1b8a("0x24b")]["push"]({id:0,canbuild:!1,bg:e,icon:o,gold:a,pricebg:i,price:r,lock:s})}var n=0;let b=_["Instance"][a0_0x1b8a("0x1f6")]();for(let e in b){let t=b[e];if(1==t["base"]&&41!=t["id"]&&61!=t["id"]&&71!=t["id"]&&null!=t[a0_0x1b8a("0x369")]){_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](e);var x=a0_0x1b8a("0x2e5")+t["id"][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x101");this[a0_0x1b8a("0x24b")][n]["id"]=t["id"],this["gametowers"][n][a0_0x1b8a("0x369")][a0_0x1b8a("0x11e")]=x,n++}}this[a0_0x1b8a("0x24a")]()}[a0_0x1b8a("0x24a")](){for(var t=0;t<this[a0_0x1b8a("0x24b")][a0_0x1b8a("0x6f")];++t){var e=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x8f")](this[a0_0x1b8a("0x24b")][t]["id"]);h[a0_0x1b8a("0x281")][a0_0x1b8a("0x579")](this[a0_0x1b8a("0x24b")][t]["id"])?(null!=e&&(h[a0_0x1b8a("0x281")]["getMoney"]()>=e[a0_0x1b8a("0x70")]?(this[a0_0x1b8a("0x24b")][t]["bg"]["skin"]="image/ui/game_itembg_1.png",this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x369")]["gray"]=!1,this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x37b")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x86"),this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0xfc")][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x562"),this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x11b")]=!0):(this[a0_0x1b8a("0x24b")][t]["bg"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x525"),this[a0_0x1b8a("0x24b")][t]["icon"][a0_0x1b8a("0x526")]=!0,this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x37b")][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x27f"),this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0xfc")][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x1da"),this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x11b")]=!1)),this["gametowers"][t][a0_0x1b8a("0x519")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x593")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x24b")][t]["price"][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x5bc"),this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0xfc")][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x70")][a0_0x1b8a("0xdf")]()):(this["gametowers"][t]["bg"][a0_0x1b8a("0x11e")]=a0_0x1b8a("0x525"),this["gametowers"][t][a0_0x1b8a("0x369")][a0_0x1b8a("0x526")]=!0,this[a0_0x1b8a("0x24b")][t]["pricebg"][a0_0x1b8a("0x11e")]="image/ui/game_pricebg_2.png",this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0xfc")][a0_0x1b8a("0x5e2")]=a0_0x1b8a("0x1da"),this["gametowers"][t][a0_0x1b8a("0x519")][a0_0x1b8a("0x212")]=!0,this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x593")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0x11b")]=!1,e[a0_0x1b8a("0x4f6")]>0?(this["gametowers"][t][a0_0x1b8a("0xfc")]["color"]="#ff4949",this[a0_0x1b8a("0x24b")][t]["price"][a0_0x1b8a("0x195")]=e[a0_0x1b8a("0x4f6")][a0_0x1b8a("0xdf")]()+a0_0x1b8a("0x2fb")):(this["gametowers"][t]["price"]["color"]="#ffd018",this[a0_0x1b8a("0x24b")][t][a0_0x1b8a("0xfc")]["text"]=a0_0x1b8a("0x5c")))}}[a0_0x1b8a("0x25e")](){this["mainLeves"]=[];for(var t=0;t<this["newMainui"]["numChildren"];++t){var e=this[a0_0x1b8a("0x5d")]["getChildByName"]("_newlevel_"+(t+1)[a0_0x1b8a("0xdf")]()),o=e[a0_0x1b8a("0x165")](a0_0x1b8a("0x5e8")+(t+1)[a0_0x1b8a("0xdf")]()),i=e[a0_0x1b8a("0x165")](a0_0x1b8a("0x9c")+(t+1)[a0_0x1b8a("0xdf")]()),a=e["getChildByName"](a0_0x1b8a("0x5ac")+(t+1)[a0_0x1b8a("0xdf")]());this[a0_0x1b8a("0x5d7")][a0_0x1b8a("0x198")]({label:i,mask:o||null,lock:a||null})}this[a0_0x1b8a("0x4bc")]()}["initMainLevelsEvents"](){for(var t=0;t<this[a0_0x1b8a("0x5d")][a0_0x1b8a("0x263")];++t){this[a0_0x1b8a("0x5d")][a0_0x1b8a("0x165")](a0_0x1b8a("0x597")+(t+1)[a0_0x1b8a("0xdf")]())["on"](Laya[a0_0x1b8a("0x278")][a0_0x1b8a("0x3b7")],this,this[a0_0x1b8a("0x8e")],[t])}}["updateMainLevels"](){for(var t=0;t<this[a0_0x1b8a("0x5d7")][a0_0x1b8a("0x6f")];++t)1==h[a0_0x1b8a("0x281")][a0_0x1b8a("0x24")](t)?(this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x85")]&&(this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=!1),this[a0_0x1b8a("0x5d7")][t]["lock"]&&(this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x519")][a0_0x1b8a("0x212")]=!1),this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0xd1")][a0_0x1b8a("0x195")]=t<4?"Progress: "+(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x604")][t]["MapID"]-1)[a0_0x1b8a("0xdf")]()+"/"+d[a0_0x1b8a("0xfd")][t]["toString"]():"Progress: "+(h[a0_0x1b8a("0x281")][a0_0x1b8a("0x321")](0)-1)[a0_0x1b8a("0xdf")]()):(this["mainLeves"][t]["mask"]&&(this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x85")][a0_0x1b8a("0x212")]=!0),this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x519")]&&(this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0x519")][a0_0x1b8a("0x212")]=!0),this[a0_0x1b8a("0x5d7")][t][a0_0x1b8a("0xd1")]["text"]="")}[a0_0x1b8a("0x8e")](t){c[a0_0x1b8a("0x441")]("click"),h[a0_0x1b8a("0x281")][a0_0x1b8a("0x24")](t)&&(t<4?(d[a0_0x1b8a("0x2a9")]=0,d[a0_0x1b8a("0x45f")]=t,this[a0_0x1b8a("0x14f")](d["NormalIndex"]),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x48a")]()):(d[a0_0x1b8a("0x2a9")]=1,d[a0_0x1b8a("0x61")]=0,d[a0_0x1b8a("0x45f")]=t,this[a0_0x1b8a("0x14f")](d["NormalIndex"]),this[a0_0x1b8a("0x31e")][a0_0x1b8a("0x212")]=!1,this[a0_0x1b8a("0x48a")]()))}["RankClickTest"](){}[a0_0x1b8a("0x53c")](){}[a0_0x1b8a("0x4e2")](){this[a0_0x1b8a("0x287")]()}[a0_0x1b8a("0x23f")](){}}class M extends e["LoadingUI"]{constructor(){super(...arguments),this["_w"]=0}[a0_0x1b8a("0x228")](){super[a0_0x1b8a("0x228")](),this["on"]("onViewCreated",this,this[a0_0x1b8a("0x10f")])}[a0_0x1b8a("0x10f")](){this["init"]()}["init"](){this[a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this["_bg"][a0_0x1b8a("0x357")]=Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x5a")]["height"]=Laya["stage"][a0_0x1b8a("0x22f")],this[a0_0x1b8a("0x22f")]=Laya[a0_0x1b8a("0x1eb")]["height"],this["_bar_bg"][a0_0x1b8a("0x11e")]=I[a0_0x1b8a("0x281")][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x157"),this[a0_0x1b8a("0x5a")]["skin"]=I["Instance"][a0_0x1b8a("0x5cc")]()+a0_0x1b8a("0x424"),this["_logo"]["skin"]=I[a0_0x1b8a("0x281")]["GetUrl"]()+"image/logo.png",this[a0_0x1b8a("0x3b9")]["width"]=443,this[a0_0x1b8a("0x3b9")][a0_0x1b8a("0x22f")]=258,this[a0_0x1b8a("0x3b9")]["x"]=(this["width"]-this[a0_0x1b8a("0x3b9")][a0_0x1b8a("0x357")])/2,this["_w"]=this[a0_0x1b8a("0x461")][a0_0x1b8a("0x357")],this[a0_0x1b8a("0x461")][a0_0x1b8a("0x357")]=0;let t=new Laya[a0_0x1b8a("0xec")];t["play"](0,!0,a0_0x1b8a("0xf")),this["_anim"][a0_0x1b8a("0x40a")](t),I["Instance"][a0_0x1b8a("0x3f")](),u[a0_0x1b8a("0x464")]()}[a0_0x1b8a("0x407")](t){this[a0_0x1b8a("0x25")]["x"]=this["_w"]*t,this["_bar"][a0_0x1b8a("0x357")]=this["_w"]*t,this[a0_0x1b8a("0x484")][a0_0x1b8a("0x195")]=new Uint8Array(100*t)[a0_0x1b8a("0x38d")]+"%"}}class I{constructor(){this["_battle"]=null,this[a0_0x1b8a("0x5ab")]=null,this["isCdn"]=!1,this["_version"]="0.3.6",this[a0_0x1b8a("0x93")]="",this[a0_0x1b8a("0x536")]=[{url:a0_0x1b8a("0x302"),type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x4d0"),type:Laya["Loader"]["JSON"]},{url:"tables/resource.json",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0xa5"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x509"),type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x316"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x52b"),type:Laya["Loader"]["JSON"]},{url:a0_0x1b8a("0x4d5"),type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x611"),type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x5ca"),type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:"tables/level.json",type:Laya["Loader"][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x298"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x23c")]},{url:a0_0x1b8a("0x5af"),type:Laya["Loader"][a0_0x1b8a("0x23c")]}]}[a0_0x1b8a("0x5cc")](){return this[a0_0x1b8a("0x93")]}[a0_0x1b8a("0x40b")](){0==this[a0_0x1b8a("0x30")]?this["cdnUrl"]="":this["cdnUrl"]=this[a0_0x1b8a("0x93")]+"/"+this[a0_0x1b8a("0x1d7")]+"/";let t=[];t[a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"res/atlas/image/ui.atlas",type:Laya["Loader"]["ATLAS"]}),t[a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"res/atlas/image/loading.atlas",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),t[a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x424"),type:Laya[a0_0x1b8a("0x2f7")]["IMAGE"]}),t[a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x157"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),t["push"]({url:this[a0_0x1b8a("0x93")]+"image/logo.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),Laya[a0_0x1b8a("0x2bf")][a0_0x1b8a("0x5d5")](t,Laya[a0_0x1b8a("0x2aa")]["create"](this,this["onLoadLoading"],null,!1))}[a0_0x1b8a("0x358")](){this[a0_0x1b8a("0x32e")](a0_0x1b8a("0x45d"),7,a0_0x1b8a("0xf")),this[a0_0x1b8a("0x5ab")]=new M,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x40a")](this[a0_0x1b8a("0x5ab")])}["Start"](){this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x186"),type:Laya["Loader"]["IMAGE"]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x2ca"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x10"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x1c0"),type:Laya["Loader"]["IMAGE"]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"image/main/4.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x320"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x5bb"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this["cdnUrl"]+a0_0x1b8a("0x10d"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0x391"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0xf3"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"image/d2.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this["cdnUrl"]+"image/redbg.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x3a8"),type:Laya["Loader"][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0x1a9"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_2.png",type:Laya["Loader"][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+"image/Ice/ice_3.png",type:Laya["Loader"]["IMAGE"]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x3ba"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_5.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x29b"),type:Laya["Loader"][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x7"),type:Laya["Loader"]["IMAGE"]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x253"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x4ab"),type:Laya["Loader"]["IMAGE"]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_10.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x3ed"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x42c"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x44c"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_14.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_15.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0x12f"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x4d8"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x21e"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x42"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0xd6"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x402"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_22.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x38e"),type:Laya["Loader"][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x328"),type:Laya["Loader"][a0_0x1b8a("0x248")]}),this["resList"]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x2d7"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_26.png",type:Laya[a0_0x1b8a("0x2f7")]["IMAGE"]}),this[a0_0x1b8a("0x536")]["push"]({url:this["cdnUrl"]+"image/Ice/ice_27.png",type:Laya[a0_0x1b8a("0x2f7")]["IMAGE"]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0x41b"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x19f"),type:Laya[a0_0x1b8a("0x2f7")]["IMAGE"]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x515"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"image/Ice/ice_31.png",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x10e"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x248")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x5f4"),type:Laya[a0_0x1b8a("0x2f7")]["ATLAS"]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x97"),type:Laya["Loader"][a0_0x1b8a("0x19b")]}),this["resList"][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+"res/atlas/image/effect2.atlas",type:Laya[a0_0x1b8a("0x2f7")]["ATLAS"]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+"res/atlas/image/tower.atlas",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),this[a0_0x1b8a("0x536")]["push"]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x1be"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x404"),type:Laya["Loader"][a0_0x1b8a("0x19b")]}),this[a0_0x1b8a("0x536")]["push"]({url:this["cdnUrl"]+a0_0x1b8a("0x51b"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),this["resList"]["push"]({url:this[a0_0x1b8a("0x93")]+"res/atlas/image/monster/all.atlas",type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),this[a0_0x1b8a("0x536")][a0_0x1b8a("0x198")]({url:this["cdnUrl"]+a0_0x1b8a("0x364"),type:Laya[a0_0x1b8a("0x2f7")][a0_0x1b8a("0x19b")]}),Laya[a0_0x1b8a("0x2bf")][a0_0x1b8a("0x5d5")](this["resList"],Laya["Handler"][a0_0x1b8a("0x314")](this,this[a0_0x1b8a("0x444")],null,!1),Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,this[a0_0x1b8a("0x235")],null,!1))}[a0_0x1b8a("0x235")](t){this["_loading"][a0_0x1b8a("0x407")](t)}[a0_0x1b8a("0x3f4")](){for(let e=1;;e++){let t=_[a0_0x1b8a("0x281")][a0_0x1b8a("0x17d")](e);if(null==t)break;this[a0_0x1b8a("0x32e")](t["res"],t[a0_0x1b8a("0x107")],t[a0_0x1b8a("0x1db")])}this[a0_0x1b8a("0x32e")](this[a0_0x1b8a("0x93")]+a0_0x1b8a("0x5da"),32,a0_0x1b8a("0x6d"))}[a0_0x1b8a("0x32e")](e,o,t){var i=[];for(let t=1;t<=o;t++)i[a0_0x1b8a("0x198")](e+"_"+t+a0_0x1b8a("0x101"));Laya["Animation"][a0_0x1b8a("0x39b")](i,t)}[a0_0x1b8a("0x444")](){try{window[a0_0x1b8a("0x49c")]["glc"]()}catch(t){}_[a0_0x1b8a("0x281")]["Init"](),this[a0_0x1b8a("0x3f4")](),this[a0_0x1b8a("0x48a")]()}[a0_0x1b8a("0x48a")](){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x4e7")),null==this[a0_0x1b8a("0x3ef")]?(c["Init"](),h[a0_0x1b8a("0x281")]["Init"](),Laya["timer"][a0_0x1b8a("0x3a4")](2e3,this,function(){console[a0_0x1b8a("0x14e")](a0_0x1b8a("0x419")),this["_battle"]=new T,Laya["stage"][a0_0x1b8a("0x40a")](this["_battle"]),Laya[a0_0x1b8a("0x5b7")][a0_0x1b8a("0x410")](this)})):h[a0_0x1b8a("0x281")][a0_0x1b8a("0x114")]()}[a0_0x1b8a("0x289")](){return this[a0_0x1b8a("0x3ef")]}}I[a0_0x1b8a("0x281")]=new I;new class{constructor(){window[a0_0x1b8a("0xa7")]?Laya3D["init"](t[a0_0x1b8a("0x357")],t[a0_0x1b8a("0x22f")]):Laya[a0_0x1b8a("0x557")](t["width"],t[a0_0x1b8a("0x22f")],Laya[a0_0x1b8a("0x3e1")]),Laya[a0_0x1b8a("0x73")]&&Laya[a0_0x1b8a("0x73")][a0_0x1b8a("0x49b")](),Laya[a0_0x1b8a("0x15c")]&&Laya[a0_0x1b8a("0x15c")]["enable"](),Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x30c")]=t[a0_0x1b8a("0x30c")],Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x185")]=t[a0_0x1b8a("0x185")],Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x34")]=t[a0_0x1b8a("0x34")],Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x2")]=t[a0_0x1b8a("0x2")],Laya[a0_0x1b8a("0x55f")][a0_0x1b8a("0x61d")]=t[a0_0x1b8a("0x61d")],(t[a0_0x1b8a("0x21")]||"true"==Laya[a0_0x1b8a("0x250")][a0_0x1b8a("0x60f")]("debug"))&&Laya[a0_0x1b8a("0x5b1")](),t[a0_0x1b8a("0x349")]&&Laya[a0_0x1b8a("0x23a")]&&Laya[a0_0x1b8a("0x23a")][a0_0x1b8a("0x49b")](),t["stat"]&&Laya[a0_0x1b8a("0x4c8")][a0_0x1b8a("0x12c")](0,0),Laya[a0_0x1b8a("0x3d3")]=!0,Laya[a0_0x1b8a("0x1eb")][a0_0x1b8a("0x282")]=a0_0x1b8a("0x356"),Laya[a0_0x1b8a("0x5e4")][a0_0x1b8a("0x49b")](a0_0x1b8a("0x2b5"),Laya["Handler"]["create"](this,this[a0_0x1b8a("0x5fe")]),Laya[a0_0x1b8a("0x5e4")][a0_0x1b8a("0x138")])}[a0_0x1b8a("0x5fe")](){Laya[a0_0x1b8a("0x214")][a0_0x1b8a("0x49b")](a0_0x1b8a("0x52d"),Laya[a0_0x1b8a("0x2aa")][a0_0x1b8a("0x314")](this,this["onConfigLoaded"]))}[a0_0x1b8a("0x29")](){I[a0_0x1b8a("0x281")]["StartLoad"]()}}}();