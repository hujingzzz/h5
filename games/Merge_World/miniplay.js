(function(C,h){typeof exports=="object"&&typeof module<"u"?module.exports=h():typeof define=="function"&&define.amd?define(h):(C=typeof globalThis<"u"?globalThis:C||self,C.miniplay=h())})(this,function(){"use strict";let C=null;const h={gameBottomBanner:"miniplay-game-banner",indexOpenBanner:"miniplay-index-open-banner",customInterstitial:"creative_inner"},T={value:null},D={value:0},_={gtag:"gtag",ad:"ad",states:"states"},c={preroll:"preroll",start:"start",pause:"pause",next:"next",browse:"browse",reward:"reward",banner:"banner"},R={isReady:!1},y={beforeAd:"beforeAd",afterAd:"afterAd",adBreakDone:"adBreakDone",beforeReward:"beforeReward",adDismissed:"adDismissed",adViewed:"adViewed"},E={transsion:"transsion",inapp:"inapp",adx:"adx",xiaomi:"xiaomi",pubguru:"pubguru"};function M(){return C==null&&(C=function(t){return new Promise((n,i)=>{let r=new XMLHttpRequest;r.open("GET",t,!0),r.onload=function(){n(JSON.parse(r.responseText))},r.onerror=function(){i("xhr.status: "+r.status)},r.send()})}("miniplay.json").then(t=>t)),C}const l={pixelEventInfo:{_isReportaddPaymentInfo:!1,_isAdsGroupFive:!1,_isAdsGroupSix:!1,_hasClick:!1},_initPixel:function(e,t,n){e.TiktokAnalyticsObject=n;var i=e[n]=e[n]||[];i.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],i.setAndDefer=function(p,k){p[k]=function(){p.push([k].concat(Array.prototype.slice.call(arguments,0)))}};for(var r=0;r<i.methods.length;r++)i.setAndDefer(i,i.methods[r]);i.instance=function(p){for(var k=i._i[p]||[],A=0;A<i.methods.length;A++)i.setAndDefer(k,i.methods[A]);return k},i.load=function(p,k){var A="https://analytics.tiktok.com/i18n/pixel/events.js";i._i=i._i||{},i._i[p]=[],i._i[p]._u=A,i._t=i._t||{},i._t[p]=+new Date,i._o=i._o||{},i._o[p]=k||{};var x=document.createElement("script");x.type="text/javascript",x.async=!0,x.src=A+"?sdkid="+p+"&lib="+n;var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(x,b)},i.load(l.getPixelId()),i.page()},isPixelInit:function(){return typeof ttq<"u"},isPixelEnbale:function(){return o.adPlatform&&o.adPlatform.baseConfig&&o.adPlatform.baseConfig.config.target==="newbyear-gmf"&&o.adPlatform.baseConfig.track&&o.adPlatform.baseConfig.track.pixel.enable&&o.adPlatform.baseConfig.track.pixel.id},getPixelId:function(){return l.isPixelEnbale()?o.adPlatform.baseConfig.track.pixel.id:null},pixelTrackEvent:function(e){console.log("trackEvent: "+e),window.ttq&&window.ttq.instance(l.getPixelId()).track(e)},initPixel:function(){if(!l.isPixelInit()){l._initPixel(window,document,"ttq");const e=d.getRecordAdTimes();setInterval(function(){e._intervalTimes===65&&(l.pixelTrackEvent("ViewContent"),l.pixelTrackEvent("GameDepthOver65s")),e._intervalTimes>=65&&e.count()>=4&&l.pixelEventInfo._isReportaddPaymentInfo===!1&&(l.pixelTrackEvent("AddPaymentInfo"),l.pixelTrackEvent("AdsImpressionAndOve65s"),l.pixelEventInfo._isReportaddPaymentInfo=!0),e._intervalTimes<=30*60&&e.count()>=5&&l.pixelEventInfo._isAdsGroupFive===!1&&(l.pixelTrackEvent("AdsGroupFiveImpression"),l.pixelEventInfo._isAdsGroupFive=!0),e._intervalTimes<=30*60&&e.count()>=6&&l.pixelEventInfo._isAdsGroupSix===!1&&(l.pixelTrackEvent("AdsGroupSixImpression"),l.pixelEventInfo._isAdsGroupSix=!0),d.setRecordAdTimes("_intervalTimes",e._intervalTimes+1)},1e3)}},pixelRecordShowAd:function(e){const t=d.getRecordAdTimes();if(l.isPixelEnbale()&&l.isPixelInit()){let n=0;(e==="banner"&&t[e]===0||e!=="banner")&&(n+=t[e]+1,d.setRecordAdTimes(e,t[e]+1)),e==="reward"&&t[e]===2?(l.pixelTrackEvent("AddToWishlist"),l.pixelTrackEvent("RewAdsImpression")):e==="interstitial"&&t[e]===2?(l.pixelTrackEvent("PlaceAnOrder"),l.pixelTrackEvent("InterAdsImpression")):e==="banner"&&t[e]===1&&(l.pixelTrackEvent("ClickButton"),l.pixelTrackEvent("DisAdsImpression")),t.count()===3?(l.pixelTrackEvent("InitiateCheckout"),l.pixelTrackEvent("AdsGroupImpression")):t.count()===4&&l.pixelTrackEvent("AdsGroupFourImpression"),t._clickCount===1&&l.pixelEventInfo._hasClick===!1?(l.pixelTrackEvent("AdsOneClick"),l.pixelTrackEvent("Search"),l.pixelEventInfo._hasClick=!0):t._clickCount===2&&l.pixelEventInfo._hasClick===!0?(l.pixelTrackEvent("AdsTwoClick"),l.pixelTrackEvent("Contact"),l.pixelEventInfo._hasClick=!1):t._clickCount===3&&l.pixelEventInfo._hasClick===!1&&(l.pixelTrackEvent("AdsThreeClick"),l.pixelTrackEvent("Download"),l.pixelEventInfo._hasClick=!0),t._clickCount===1&&n===1?l.pixelTrackEvent("AdsOneImpressionAndOneClick"):t._clickCount===1&&n===2?l.pixelTrackEvent("AdsTwoImpressionAndOneClick"):t._clickCount===1&&n===3?l.pixelTrackEvent("AdsThreeImpressionAndOneClick"):t._clickCount===1&&n===4?l.pixelTrackEvent("AdsFourImpressionAndOneClick"):t._clickCount===1&&n===1&&t._intervalTimes>=45&&l.pixelTrackEvent("AdsOneImpressionAndOneClickAndOver60s")}}},v={isH5apkEnbale:function(){return o.adPlatform&&o.adPlatform.baseConfig&&o.adPlatform.baseConfig.config.target==="h5apk"},h5apkTrackShowEvent:function(e){console.log("h5apkTrackEvent: "+e),window.location.href=`chuanyou://trackevent?eventname=show_${e}`},h5apkTrackClickEvent:function(e){console.log("h5apkTrackEvent: "+e),window.location.href=`chuanyou://trackevent?eventname=click_${e}`}},d={_isClickBanner:!1,_isTabSwitched:!1,_currentAdType:null,_recordAdTimes:{reward:0,interstitial:0,banner:0,preroll:0,_clickCount:0,_intervalTimes:0,count:function(){return d._recordAdTimes.banner+d._recordAdTimes.interstitial+d._recordAdTimes.reward+d._recordAdTimes.preroll}},getRecordAdTimes:function(){return d._recordAdTimes},setRecordAdTimes:function(e,t){d._recordAdTimes[e]=t},initTrack:function(){d.registerAdClickEventListener(),l.isPixelEnbale()&&l.initPixel();var e=setInterval(function(){d._recordAdTimes.banner===0&&d.findBannerShow()===!0&&(l.pixelRecordShowAd("banner"),clearInterval(e))},1e3)},trackEvent:function(e){l.isPixelEnbale()&&l.pixelTrackEvent(e)},findBannerShow:function(){let e=document.querySelector("#miniplay-game-banner > ins");return e&&e.getAttribute("data-ad-status")==="filled"},enbale:function(){return!0},registerAdClickEventListener:function(){var e=document.getElementById("miniplay-game-banner"),t=null;window.onload=function(){d.findBannerShow()&&(t=e.querySelector("iframe"))},document.addEventListener("visibilitychange",async function(){document.visibilityState==="hidden"&&document.activeElement.tagName.toLowerCase()==="iframe"?(console.log("visibilitychange-hidden"),d._isTabSwitched=!0,document.activeElement==t&&(d._isClickBanner=!0),document.activeElement.blur()):document.visibilityState==="visible"&&(console.log("visibilitychange-visible"),console.log("TrackTools._isClickBanner  "+d._isClickBanner),d._isTabSwitched&&(d._recordAdTimes._clickCount++,console.log(d._recordAdTimes._clickCount),console.log("TrackTools._currentAdType  "+d._currentAdType),d._isClickBanner===!0?(l.pixelRecordShowAd("banner"),v.isH5apkEnbale()&&d.checkWebViewInterface()&&v.h5apkTrackClickEvent("banner")):v.isH5apkEnbale()&&d.checkWebViewInterface()&&v.h5apkTrackClickEvent(d._currentAdType||"other")),d._isTabSwitched=!1,d._isClickBanner=!1)})},recordShowAd:function(e){l.isPixelEnbale()&&l.pixelRecordShowAd(e),v.isH5apkEnbale()&&d.checkWebViewInterface()&&v.h5apkTrackShowEvent(e)},backButtonClick:function(){d.trackEvent("AddToCart"),d.trackEvent("ClickBackButton"),d._recordAdTimes.count()===2&&d.trackEvent("AdsTwoImpressionAndClickBack"),d._recordAdTimes.count()===3&&d.trackEvent("AdsThreeImpressionAndClickBack")},checkWebViewInterface:function(){return typeof CyWebview<"u"}},S={_showBanner:function(e,t,n,i){if(t)e.innerText="Test Banner:"+n["data-ad-slot"];else if(i["data-ad-client"]&&n["data-ad-slot"]){const r=document.createElement("ins");r.style="display:inline-block;width:100%;height:100%",r.setAttribute("class","adsbygoogle"),r.setAttribute("data-ad-client",i["data-ad-client"]),r.setAttribute("data-ad-channel",i["data-ad-channel"]),r.setAttribute("data-ad-slot",n["data-ad-slot"]),r.setAttribute("data-ad-format","format"),r.setAttribute("data-full-width-responsive","true"),e.appendChild(r);const p=document.createElement("script");p.text="(adsbygoogle = window.adsbygoogle || []).push({});",e.appendChild(p);let k=setInterval(()=>{e.querySelector("ins").getAttribute("data-ad-status")==="filled"&&(D.value++,document.getElementById("miniplay-game-info").style.display="none",clearInterval(k))},500)}},generateAdBreakParams:function(e){let t={type:e.type,name:e.name,adBreakDone:n=>{e.adBreakDone!==void 0&&e.adBreakDone!=null&&(e.adBreakDone(n),(n.breakStatus==="viewed"||n.breakStatus==="dismissed")&&(e.type===c.reward?d.recordShowAd("reward"):e.type===c.preroll?d.recordShowAd("preroll"):e.type===c.next?d.recordShowAd("interstitial"):e.type===c.banner&&d.recordShowAd("banner")))}};return d._currentAdType=e.type,e.type===c.preroll||(e.type===c.reward?(t.beforeReward=function(n){n(),e.beforeReward!==void 0&&e.beforeReward!=null&&e.beforeReward(n)},t.adDismissed=function(){e.adDismissed!==void 0&&e.adDismissed!=null&&e.adDismissed()},t.adViewed=function(){e.adViewed!==void 0&&e.adViewed!=null&&e.adViewed()}):(t.beforeAd=()=>{e.beforeAd!==void 0&&e.beforeAd!=null&&e.beforeAd()},t.afterAd=()=>{e.afterAd!==void 0&&e.afterAd!=null&&e.afterAd()})),t},showOpenBanner:function(e,t,n){const i=document.getElementById("miniplay-index-open-banner");i?(S._showBanner(i,e,t,n),i.style="margin-left:0 !important",console.log("_showOpenBanner success")):console.log("can't find id: miniplay_open_banner,  skip _showOpenBanner")}},L="msg_type",j="msg_callback_params",g={IFrameAdCallbackCache:null,registerService(){o.isModeStand()||(o.isModeGame()?window.addEventListener("message",e=>{console.log("game accept message: "+e.data.toString());try{if(e.data.toString().startsWith("{")){const t=JSON.parse(e.data);L in t&&g.handleParentMsg(t)}}catch(t){console.log("game receiver message error: "+t)}}):o.isModeIndex()&&(document.getElementById("miniplay-game-iframe")?(console.log("configPostMessage direct"),g.configPostMessage()):window.addEventListener("DOMContentLoaded",function(){console.log("configPostMessage wait DOMContentLoaded"),g.configPostMessage(),w.isReady()&&g.notifyToIFrameReady()})))},notifyToIFrameReady(){let e=document.getElementById("miniplay-game-iframe"),t=["complete","interactive","loaded"];e&&(t.includes(e.contentDocument.readyState)?g.postMessageToIframe({msg_type:_.states,msg_callback_params:{isReady:!0}}):e.contentWindow.addEventListener("readystatechange",function(){t.includes(e.contentDocument.readyState)&&g.postMessageToIframe({msg_type:_.states,msg_callback_params:{isReady:!0}})}))},handleParentMsg(e){console.log(`handleParentMsg: ${JSON.stringify(e)}`);let t=e.msg_type;if(t===_.states)R.isReady=e.msg_callback_params.isReady;else if(t===_.ad)if(g.IFrameAdCallbackCache!=null){let n=e.msg_callback_function,i=e.msg_callback_params;switch(n){case y.beforeAd:o.isNotNull(g.IFrameAdCallbackCache.beforeAd)&&g.IFrameAdCallbackCache.beforeAd();break;case y.afterAd:o.isNotNull(g.IFrameAdCallbackCache.afterAd)&&g.IFrameAdCallbackCache.afterAd();break;case y.adBreakDone:o.isNotNull(g.IFrameAdCallbackCache.adBreakDone)&&(g.IFrameAdCallbackCache.adBreakDone(i),g.IFrameAdCallbackCache=null);break;case y.adViewed:o.isNotNull(g.IFrameAdCallbackCache.adViewed)&&g.IFrameAdCallbackCache.adViewed();break;case y.adDismissed:o.isNotNull(g.IFrameAdCallbackCache.adDismissed)&&g.IFrameAdCallbackCache.adDismissed();break;case y.beforeReward:if(o.isNotNull(g.IFrameAdCallbackCache.beforeReward)){let r=function(){console.log("beforeReward call with empty")};g.IFrameAdCallbackCache.beforeReward(r)}break;default:console.log("can't handle this method: "+n);break}}else console.log("IFrameCallbackCache is null")},configPostMessage(){document.getElementById("miniplay-game-iframe")&&(console.log("miniplay_game_iframe loaded"),window.addEventListener("message",t=>{try{if(t.data.toString().startsWith("{")){const n=JSON.parse(t.data);L in n&&g.handleIframeMsg(n)}}catch(n){console.log("index receiver message error: "+n)}}))},postMessageToIframe(e){let t=document.getElementById("miniplay-game-iframe"),n=JSON.stringify(e);t.contentWindow.postMessage(n),console.log("postMessageToIframe: "+n)},postMessageToParent(e){function t(i){return i&&typeof i=="object"&&"window"in i&&i.window===i}let n=window.parent;t(n)||(n=window.top),n.postMessage(JSON.stringify(e))},handleIframeMsg(e){let t=e[L];if(t===_.gtag){let n=e[j];w.gtag(...n)}else if(t===_.ad)if(e.msg_ad_type===c.banner)w.showBanner();else{let n={type:e.msg_ad_type,name:e.msg_ad_name,adBreakDone:i=>{g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.adBreakDone,msg_callback_params:i})}};e.msg_ad_type===c.preroll?console.log("preroll"):e.msg_ad_type===c.reward?(n[y.beforeReward]=function(i){i(),g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.beforeReward})},n[y.adDismissed]=function(){g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.adDismissed})},n[y.adViewed]=function(){g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.adViewed})}):(n[y.beforeAd]=()=>{g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.beforeAd})},n[y.afterAd]=()=>{g.postMessageToIframe({msg_type:_.ad,msg_ad_type:e.msg_ad_type,msg_ad_name:e.msg_ad_name,msg_callback_function:y.afterAd})}),w.adBreak(n)}}},m={gaId:null,_scriptUrl:"https://www.googletagmanager.com/gtag/js",_loadScriptInstance:null,loadScript:function(e){return m._loadScriptInstance==null&&(m._loadScriptInstance=new Promise((t,n)=>{console.log("Init Ga4: "+e);const i=document.createElement("script");i.src=this._scriptUrl+"?id="+e,i.async=!0,i.onload=t,i.onerror=n,document.head.appendChild(i),console.log("end load ga sdk")})),m._loadScriptInstance},isInit:()=>m._dataLayer!=null,_dataLayer:null,gtag:function(...e){m.isInit()?(m._dataLayer.push(arguments),console.log(`GA4 push params: ${JSON.stringify(e)}`)):console.log("_dataLayer is null , skip gtag: "+JSON.stringify(e))},_initInstance:null,_initAsync:async function(){if(m._initInstance==null){let e=function(t){return m.loadScript(t).then(()=>(m._dataLayer=window.dataLayer=window.dataLayer||[],console.log("GA4 script load success"),m.gtag("js",new Date),m.gtag("config",t),Promise.resolve()))};m._initInstance=M().then(t=>(m.gaId=t.track.ga.enable?t.track.ga.config.gid:"",e(m.gaId)))}return m._initInstance},initAsync:async function(){return m._initAsync()}},s={_scriptUrl:"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",baseConfig:null,adConfig:null,_loadScriptInstance:null,_googleAdBreak:null,_googleAdConfig:null,isReady:!1,loadScript:function(){if(s._loadScriptInstance==null)s._loadScriptInstance=new Promise((e,t)=>{const n=document.createElement("script");n.src=s._scriptUrl,n.async=!0;for(let i in s.adConfig.attr)if(s.adConfig.attr.hasOwnProperty(i)){let r=s.adConfig.attr[i];n.setAttribute(i,r)}s.baseConfig.config.test&&n.setAttribute("data-adbreak-test","on"),n.onload=e,n.onerror=t,document.head.appendChild(n),console.log("end load google sdk")});else return s._loadScriptInstance},isInit:function(){return s.baseConfig!=null?s._afgEnable()?s._googleAdBreak!=null&&s._googleAdConfig!=null:window.adsbygoogle!=null:!1},_afgEnable:function(){return!(s.baseConfig.ad.type&&s.baseConfig.ad.type==="disable")},initAsync:async function(){if(!s._afgEnable()||s.isInit())return Promise.resolve();try{return await s.loadScript(),window.adsbygoogle=window.adsbygoogle||[],s._googleAdBreak=s._googleAdConfig=function(e){console.log("call adsbygoogle.push(): "+JSON.stringify(e)),window.adsbygoogle.push(e)},Promise.resolve()}catch{return Promise.reject(new Error("load js error"))}},startAsync:async function(){return new Promise((e,t)=>{if(d.initTrack(),s._afgEnable()){let n={...s.adConfig.config};s.adConfig.config.onReady&&(n.onReady=()=>{s.isReady=!0,console.log("onReady: true"),s.adConfig.virtualBox&&s.adConfig.virtualBox.enable&&s.createVirtualBox(),g.notifyToIFrameReady(),e()}),s._googleAdConfig(n)}else setTimeout(()=>{s.isReady=!0,g.notifyToIFrameReady(),e()},500);s.baseConfig.config.test===!1?m.initAsync().catch(n=>{console.log("GA4 init fail: "+n)}):console.log("skip ga on test")})},adBreak:function(e){let t=e.type;s._afgEnable()&&s.adConfig.virtualBox&&s.adConfig.virtualBox.enable&&(e.type==="reward"&&!o.checkAdsStatus("rewarded")&&(e.type=e.name="next"),e.type==="next"&&!o.checkAdsStatus("interstitial")&&(e.type=e.name="virtual"),e.type==="virtual"&&!o.checkAdsStatus("virtual")&&(e.type=e.name=t));let n=S.generateAdBreakParams(e);if(s._afgEnable()){if(e.type==="virtual")return s.showVirtualBox(()=>{n.adBreakDone({breakType:t,breakName:t,breakFormat:t==="reward"?"reward":"interstitial",breakStatus:"viewed"})});s.isInit()?s._googleAdBreak(n):s.initAsync().then(()=>{s._googleAdBreak(n)})}else n.adBreakDone({breakType:n.type,breakName:n.type,breakFormat:"unknown",breakStatus:"viewed"})},_showAdsenseBanner:function(e,t){s.isInit()&&s.adConfig?(document.getElementById("miniplay-game-info").style.display="flex",document.getElementById(e).innerHTML="",S._showBanner(document.getElementById(e),s.baseConfig.config.test,t,s.adConfig.attr),console.log("callbackShowBanner: "+e)):console.log("showBanner is not init or channelConfig is null: "+e)},showBanner:function(){if(s.adConfig)if(s.adConfig.banner.enable){let e=s.adConfig.banner["data-ad-slot"][0]||"",t=s.adConfig.banner.refreshInterval||0,n=s.adConfig.banner.refreshLimit||0,i={...s.adConfig.banner};if(i["data-ad-slot"]=e,s._showAdsenseBanner(h.gameBottomBanner,i),s.adConfig.banner.bannerRefresh){let r=0,p=setInterval(()=>{(D.value>=n||++r>n*3)&&clearInterval(p),e=o.getNextId(s.adConfig.banner["data-ad-slot"],e),i["data-ad-slot"]=e,s._showAdsenseBanner(h.gameBottomBanner,i)},t*1e3)}}else console.log("config banner is false")},showOpenBanner:function(){s.adConfig.openBanner&&s.adConfig.openBanner.enable&&s._showAdsenseBanner(h.indexOpenBanner,s.adConfig.openBanner)},createVirtualBox(){o.createAdBox();let e={...s.adConfig.virtualBox};e["data-ad-slot"]=s.adConfig.virtualBox["data-ad-slot"][0],s.adConfig&&s.adConfig.virtualBox.enable&&S._showBanner(document.getElementById("creative_inner"),s.baseConfig.config.test,e,s.adConfig.attr)},showVirtualBox(e){document.getElementById("ad_box").style.display="block",o.adBoxCallback=()=>{let t=document.getElementById("ad_box");document.body.removeChild(t),e(),s.createVirtualBox()}},gtag:function(...e){s.baseConfig.config.test===!1?m.initAsync().then(()=>{m.gtag(...e)}).catch(t=>{console.log("gtag error",t)}):console.log("skip gtag on test")}},u={_scriptUrl:"",baseConfig:null,adConfig:null,_loadScriptInstance:null,loadScript:function(){return this._loadScriptInstance==null&&(this._loadScriptInstance=new Promise((e,t)=>{const n=document.createElement("script");n.src=this._scriptUrl,n.onload=e,n.onerror=t,n.async=!0,document.head.appendChild(n),console.log("end load transsion sdk")})),this._loadScriptInstance},_transsionAdBreak:null,_transsionAdConfig:null,_h5sdk:null,isInit:function(){return this._h5sdk!=null&&this.baseConfig!=null},initAsync:async function(){if(this.isInit())return Promise.resolve();try{await u.loadScript();let e={env:u.baseConfig.config.test?"pre":""},t={id:u.baseConfig.track.ga.enable?u.baseConfig.track.ga.config.gid:""},n=i=>{let r={client:u.adConfig.attr["data-ad-client"],"data-ad-frequency-hint":u.adConfig.attr["data-ad-frequency-hint"],"data-ad-channel":u.adConfig.attr["data-ad-channel"],callback:i};return u.baseConfig.config.test&&(r["data-adbreak-test"]="on"),r};return new Promise((i,r)=>{let p=u.baseConfig.game.appKey;window.h5sdk.init(p,"10vw","10vw","","",{float:e,ga:t,adsense:n(()=>{u._h5sdk=window.h5sdk=window.h5sdk||[],u._transsionAdBreak=u._h5sdk.adBreak,u._transsionAdConfig=u._h5sdk.adConfig,window.adsbygoogle=window.adsbygoogle||[],i(),window.h5sdk.athenaSend("game_start",u.baseConfig.game.gameName);try{window.h5sdk.gameLoadingCompleted()}catch(k){print("调用h5sdk.gameLoadingCompleted失败"+k)}})})})}catch(e){return Promise.reject(new Error("load js error:"+e))}},isReady:!1,startAsync:async function(){return new Promise((e,t)=>{let n={...u.adConfig.config};u.adConfig.config.onReady&&(n.onReady=()=>{u.isReady=!0,console.log("onReady: true"),g.notifyToIFrameReady(),e()}),u._transsionAdConfig(n)})},adBreak:function(e){let t=S.generateAdBreakParams(e);this.isInit()?this._transsionAdBreak(t):this.initAsync().then(()=>{this._transsionAdBreak(t)})},showBanner:function(){if(u.isInit()&&u.adConfig){if(console.log(u),u.adConfig)if(u.adConfig.banner.enable===!0){let e=document.getElementById(h.gameBottomBanner);S._showBanner(e,u.baseConfig.config.test,u.adConfig.banner,u.adConfig.attr)}else console.log("config banner is false")}else console.log("showBanner is not init or channelConfig is null")},showOpenBanner:function(){console.log("TranssionAd is not support open Banner")},gtag:function(...e){u._h5sdk.athenaSend(...e)}},a={_scriptUrl:"https://securepubads.g.doubleclick.net/tag/js/gpt.js",_loadScriptInstance:null,loadScript:function(){if(this._loadScriptInstance==null)this._loadScriptInstance=new Promise((e,t)=>{const n=document.createElement("script");n.src=this._scriptUrl,n.async=!0,n.onload=e,n.onerror=t,document.head.appendChild(n),console.log("end load google sdk")});else return this._loadScriptInstance},adBreak:function(e){let t=e.type;switch(t){case c.preroll:case c.next:case c.start:case c.pause:case c.browse:a._showCustomInterstitial().then(()=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"interstitial",breakStatus:"viewed"}),a._rewardSlotShowEvent===null&&a._loadReward(),t===c.preroll&&a._loadOriginInterstitial()}).catch(n=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"interstitial",breakStatus:"other"})});break;case c.reward:a._showReward().then(()=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"reward",breakStatus:"viewed"})}).catch(n=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"reward",breakStatus:"other"})});break;case c.banner:console.log("Adx show banner nothing to do");break}},adConfig:null,baseConfig:null,gtag:function(...e){a.baseConfig.config.test===!1?m.initAsync().then(()=>{m.gtag(...e)}).catch(()=>{console.log("gtag error")}):console.log("skip gtag on test")},_googleAdxTag:null,initAsync:async function(){if(a.isInit())return Promise.resolve();try{return await this.loadScript(),a._googleAdxTag=window.googletag=window.googletag||{cmd:[]},Promise.resolve()}catch{return Promise.reject(new Error("load js error"))}},isInit:function(){return a._googleAdxTag!=null},isReady:!1,showBanner:function(){},showOpenBanner:function(){a._loadOpenBannerSlots()},_ensureElementsCreate:function(){o.createAdBox(a._onCustomInterstitialCloseListener)},_rewardSlotShowEvent:null,_onRewardCloserListenerInner:null,_onCustomInterstitialCloseListenerInner:null,_customInterstitialIsLoaded:!1,_onCustomInterstitialLoadedListener:null,_onCustomInterstitialCloseListener:function(){a.customInterstitialSlot&&(a._onCustomInterstitialCloseListenerInner&&a._onCustomInterstitialCloseListenerInner(),a._googleAdxTag.cmd.push(function(){a._googleAdxTag.pubads().refresh([a.customInterstitialSlot])}),a._customInterstitialIsLoad=!1)},_dismissReward:function(){a.rewardSlot&&(a._googleAdxTag.destroySlots([a.rewardSlot]),a._rewardSlotShowEvent=null,a._onRewardCloserListenerInner&&(a._onRewardCloserListenerInner(),a._onRewardCloserListenerInner=null),a._loadReward())},_cmdReward:function(){let e=a.adConfig.reward;a.rewardSlot=a._googleAdxTag.defineOutOfPageSlot(e.id,a._googleAdxTag.enums.OutOfPageFormat.REWARDED),a.rewardSlot&&(console.log("rewardSlot add to service"),a.rewardSlot.addService(a._googleAdxTag.pubads())),a._googleAdxTag.pubads().addEventListener("rewardedSlotReady",t=>{a._rewardSlotShowEvent=t,console.log("rewardedSlotReady",t.slot.getSlotElementId())}),a._googleAdxTag.pubads().addEventListener("rewardedSlotGranted",t=>{console.log("rewardedSlotGranted",t.slot.getSlotElementId())}),a._googleAdxTag.pubads().addEventListener("rewardedSlotClosed",t=>{console.log("rewardedSlotClosed",t.slot.getSlotElementId()),a._dismissReward()}),a._googleAdxTag.display(a.rewardSlot)},_cmdOriginInterstitial:function(){a.originInterstitial=a._googleAdxTag.defineOutOfPageSlot(a.adConfig.originInterstitial.id,a._googleAdxTag.enums.OutOfPageFormat.INTERSTITIAL),a.originInterstitial&&(console.log("interstitial create"),a.originInterstitial.addService(a._googleAdxTag.pubads()).setConfig({interstitial:{triggers:{unhideWindow:!0}}}),a._googleAdxTag.display(a.originInterstitial))},_cmdOpenBanner:function(){a.baseConfig.config.autoStart!=="autoStart"&&(a.openBanner=a._googleAdxTag.defineSlot(a.adConfig.openBanner.id,a.adConfig.openBanner.size,h.indexOpenBanner),a.openBanner&&(console.log("openBanner add to service"),a.openBanner.addService(a._googleAdxTag.pubads())),a._googleAdxTag.pubads().enableSingleRequest(),a._googleAdxTag.enableServices(),a._googleAdxTag.display(a.openBanner))},_cmdGameSlots:function(){a.baseConfig.banner===!0&&(a.bannerSlot=a._googleAdxTag.defineSlot(a.adConfig.banner.id,a.adConfig.banner.size,h.gameBottomBanner),a.bannerSlot&&(console.log("bannerSlot add to service"),a.bannerSlot.addService(a._googleAdxTag.pubads()))),a.customInterstitialSlot=a._googleAdxTag.defineSlot(a.adConfig.customInterstitial.id,a.adConfig.customInterstitial.size,h.customInterstitial),a.customInterstitialSlot&&(console.log("customInterstitialSlot add to service"),a.customInterstitialSlot.addService(a._googleAdxTag.pubads())),a._googleAdxTag.pubads().addEventListener("slotOnload",function(t){let n=t.slot.getSlotElementId();console.log("Slot",n,"has been slotOnload.")}),a._googleAdxTag.pubads().addEventListener("slotResponseReceived",function(t){let n=t.slot.getSlotElementId();console.log("Slot",n,"has been slotResponseReceived.")}),a._googleAdxTag.pubads().addEventListener("slotRequested",function(t){let n=t.slot.getSlotElementId();console.log("Slot",n,"has been slotRequested.")}),a._googleAdxTag.pubads().addEventListener("impressionViewable",function(t){let n=t.slot.getSlotElementId();console.log("Slot",n,"has been impressionViewable."),a.gtag("event","ad_m_impression",{ad_m_slot:n})}),a._googleAdxTag.pubads().addEventListener("slotRenderEnded",function(t){let n=t.slot.getSlotElementId();if(console.log("Slot",t.slot.getSlotElementId(),"has been slotRenderEnded.","empty: ",t.isEmpty),n===h.customInterstitial){let i=t.isEmpty;a.isReady=!0,i===!1&&(a._customInterstitialIsLoaded=!0),a._onCustomInterstitialLoadedListener&&(a._onCustomInterstitialLoadedListener(),a._onCustomInterstitialLoadedListener(),a._onCustomInterstitialLoadedListener=null)}else n===h.gameBottomBanner&&(console.log("adx banner ready"),t.isEmpty===!1&&(document.getElementById("miniplay-game-info").style.display="none"))}),a.baseConfig.loadType==="autoStart"&&(console.log("enableServices"),a._googleAdxTag.pubads().enableSingleRequest(),a._googleAdxTag.enableServices(),a._googleAdxTag.display(a.customInterstitialSlot))},_loadReward:function(){a._googleAdxTag.cmd.push(a._cmdReward)},_loadGameSlots:function(){a._googleAdxTag.cmd.push(a._cmdGameSlots)},_loadOpenBannerSlots:function(){a._googleAdxTag.cmd.push(a._cmdOpenBanner)},_loadOriginInterstitial:function(){a._googleAdxTag.cmd.push(a._cmdOriginInterstitial)},_showReward:async function(){return new Promise((e,t)=>{a._rewardSlotShowEvent!=null?(a._rewardSlotShowEvent.makeRewardedVisible(),a._onRewardCloserListenerInner=function(){e()}):t("Reward is not loaded")})},_showCustomInterstitial:async function(){return new Promise((e,t)=>{if(a._customInterstitialIsLoaded===!0){let n=document.getElementById("ad_box");const i=document.getElementById("creative_inner");n&&(n.style.display="flex",i.style="margin: 0 !important"),a._onCustomInterstitialCloseListenerInner=function(){a._customInterstitialIsLoaded=!1,e()}}else t("Interstitial is not loaded")})},startAsync:async function(){return a._ensureElementsCreate(),new Promise((e,t)=>{a._onCustomInterstitialLoadedListener=function(){g.notifyToIFrameReady(),e()},a._loadGameSlots(),a._loadReward(),a.adConfig.afgConfig.preroll===!1&&setTimeout(()=>{a._loadOriginInterstitial()},2e3),a.baseConfig.test===!1?m.initAsync().catch(n=>{console.log("GA4 init fail: "+n)}):console.log("skip ga on test")})}},I={_call_cache:null,adBreak:function(e){function t(){window.nativeCallback=function(i,r){console.log("nativeCallback",i,r),e.adBreakDone({breakType:I._call_cache,breakName:I._call_cache,breakFormat:"unknown",breakStatus:i===!0?"viewed":"other"}),I._call_cache=null}}let n=e.type;switch(I._call_cache=n,n){case c.preroll:case c.next:case c.start:case c.pause:case c.browse:t(),window.location.href="chuanyou://showad?type=interstitial&callback_js_method=nativeCallback&origin_type="+n;break;case c.reward:t(),window.location.href="chuanyou://showad?type=reward&callback_js_method=nativeCallback&origin_type="+n;break;case c.banner:console.log("InApp show banner nothing to do");break}},adConfig:null,config:null,gtag:function(...e){console.log("inapp gtag")},initAsync:async function(){return console.log("inapp initAsync"),I.isReady=!0,Promise.resolve()},isInit:function(){return I.isReady},isReady:!1,showBanner:function(){console.log("inapp showBanner Nothing to do")},showOpenBanner:function(){console.log("inapp showOpenBanner Nothing to do")},startAsync:async function(){return console.log("inapp startAsync"),new Promise((e,t)=>{setTimeout(()=>{e(),g.notifyToIFrameReady()},200)})}},f={_scriptUrl:"//c.pubguru.net/pg.fuhaosi.xyz.js",_loadScriptInstance:null,_googlePubguruTag:null,_rewardSlotShowEvent:null,adConfig:null,baseConfig:null,_createPubguruAd:function(e,t){const n=document.createElement("pubguru");n.setAttribute("data-pg-ad",t),e&&document.querySelector(e).appendChild(n)},_loadOpenBanner:function(){f.adConfig&&f.adConfig.openBanner.enable&&f._createPubguruAd("#"+h.indexOpenBanner,f.adConfig.openBanner.id)},_loadBanner:function(){f.adConfig&&f.adConfig.banner.enable&&f._createPubguruAd("#"+h.gameBottomBanner,f.adConfig.banner.id)},_loadOriginInterstitial:function(){f._createPubguruAd("body",f.adConfig.originInterstitial.id)},_loadCustomInterstitial:function(){f._createPubguruAd("#"+h.customInterstitial,f.adConfig.customInterstitial.id)},_showCustomInterstitial:async()=>{document.getElementById("ad_box").style.display="block",f._loadCustomInterstitial()},_closeCustomInterstitial:()=>{document.getElementById("creative_inner").innerHTML=""},isInit:function(){return f._googlePubguruTag!=null},initAsync:async function(){if(f.isInit())return Promise.resolve();try{return await this.loadScript(),f._googlePubguruTag=window.pg=window.pg||{},f._googlePubguruTag.drq=pg.drq||[],f._googlePubguruTag.aiq=window.pg.aiq=window.pg.aiq||[],f._googlePubguruTag.aiq.push(function(){f._googlePubguruTag.publisher.spa=!0}),Promise.resolve()}catch{return Promise.reject(new Error("load js error"))}},loadScript:function(){if(this._loadScriptInstance==null)this._loadScriptInstance=new Promise((e,t)=>{const n=document.createElement("script");n.src=this._scriptUrl,n.async=!0,n.onload=e,n.onerror=t,document.head.appendChild(n),console.log("end load google sdk")});else return this._loadScriptInstance},gtag:function(...e){f.baseConfig.config.test===!1?m.initAsync().then(()=>{m.gtag(...e)}).catch(()=>{console.log("gtag error")}):console.log("skip gtag on test")},showOpenBanner:()=>{f._loadOpenBanner()},showBanner:()=>{f._loadBanner()},adBreak:function(e){let t=e.type;switch(t){case c.preroll:case c.next:case c.start:case c.pause:case c.browse:f._showCustomInterstitial().then(()=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"interstitial",breakStatus:"viewed"}),t===c.preroll&&f._loadOriginInterstitial()}).catch(n=>{e.adBreakDone({breakType:t,breakName:t,breakFormat:"interstitial",breakStatus:"other"})});break;case c.reward:break;case c.banner:console.log("Adx show banner nothing to do");break}},startAsync:async function(){return o.createAdBox(f._closeCustomInterstitial),console.log(document.getElementById("ad_box").style),f._loadOriginInterstitial(),new Promise((e,t)=>{f.adConfig.config.preroll===!1&&setTimeout(()=>{},2e3),f.baseConfig.test===!1?m.initAsync().catch(n=>{console.log("GA4 init fail: "+n)}):console.log("skip ga on test")})}},o={adPlatform:null,adPlatformLoadingObj:null,adBoxCallback:null,inIframe(){try{return window.self!==window.top}catch{return!0}},isModeGame(){return T.value==="game"},isModeIndex(){return T.value==="index"},isModeStand(){return T.value==null||o.isModeGame()&&!o.inIframe()},isNotNull(e){return e!==void 0&&e!=null},isLandscape:function(){return window.innerWidth>window.innerHeight},isFullScreen:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||!1},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen()},getNextId:function(e,t){let n=e.indexOf(t);return n===-1||n===e.length-1?e[0]:e[n+1]},requestFullScreen:function(){var e=document.documentElement;return e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.requestFullscreen()},requestLandscape:function(e){let t=()=>screen.orientation.lock(e?"landscape-primary":"portrait-primary");if(o.isFullScreen())return t();o.requestFullScreen().then(()=>t())},showDialog:async function(){let e=window.document.getElementById("miniplay-dialog");return e?(e.style.display="block",new Promise((t,n)=>{window.miniPlayCancel=function(){e.style.display="none",t()},window.miniPlayConfirm=function(){e.style.display="none",o.requestLandscape(!0),t()}})):Promise.resolve()},prompt:function(e,t){window._prompt||(window._prompt=window.document.createElement("div"),window._prompt.style.cssText="font-family:siyuan;max-width:80%;min-width:320px;padding:10px 10px 10px 10px;min-height:40px;color: rgb(255, 255, 255);line-height: 20px;text-align:center;border-radius: 4px;position: fixed;top: 40%;left: 50%;transform: translate(-50%, -50%);z-index: 999999;background: rgba(0, 0, 0,.7);font-size: 16px;",window.document.body.appendChild(window._prompt)),window._prompt.innerHTML=e,t=isNaN(t)?2e3:t,window._prompt.style.display="inline",window._prompt.style.opacity="1",setTimeout((function(){var n=.5;window._prompt.style.webkitTransition="-webkit-transform "+n+"s ease-in, opacity "+n+"s ease-in",window._prompt.style.opacity="0",window._prompt.style.display="none"}).bind(window),t)},configBackButton:function(){o.getAdPlatform().then(e=>{if(console.log("platform.baseConfig.backButton: "+e.baseConfig.config.backButton),o.isModeIndex()&&e.baseConfig.config.backButton){let t=document.createElement("div");t.style="max-width: 52px; max-height: 40px; position: fixed; padding: 0; top: 15%; right: 0%;transition: left 0.3s ease-out; opacity: 0.7",t.id="backButton",t.innerHTML='<img style="max-width: 52px; max-height: 40px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAsCAYAAAA0NKuuAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARBSURBVHgB5ZpLbA1fHMe/50yrdflTkfxjIdWIxkaDhHhHV9gQK68NNjYWSCREiIqEWJF4RGJhbdV4hGChG+IRURZCImhJ7Khqr7aXjt9vzjzOzJ07zybuvb7NL+fOmXN6z2d+5/c7586MQA6ZptlCRSfZWrI2skVkLbZVlQQyiAA7qTgOD6zqlQqUADdTcRbKezWlRKAE2EbFVahpWpOScQ0Ich8VL1DDkKxIjxIkx2EX6kAVQesJkhUKWm+QrDJQOybPoc7kA7WzKyeemlgb0yiYdbtRh5AsF5S8uQtqp1MVOv9mBP9f+4r27m84+aqIvHKnLoF+QJXseA4+L+L825++uqMdBRzrmIysskDtrV03/rIGSib2PBnC9c8lt05PIhtnT8KVZVPQ0ph+i+5M3Z3Iqf7iOLY9/YlTb0eRRX3D41jf8wM3v/yCNASEZrDt1pcSlt8fRB99V1oJ+6fWN+QQQ254VLRK1tCmaWm649XAb2x5PIz+YQ/ApD9rgELwjCPPel5sLUjcXTsVcwqxO1hX3LITORSEPDK/KU138mAJGx4O49MIwRhUYZs0pGWCRqi86p3rHx3HigdDVt+kygUaBpkG9OL7MWx7VsT336YaiRSQtqljr05wadjnqRykPtupb9JQaSBbiAzKC3no9QgufhizBu3I1M4H043Uzgut/al3o9bJI+3R382gqTcIeSEPvxnFpb6S5SVdwjZTK4Pnw45PvxtDP039yx3NqCRORpyIEsPmhWRNuzeEcpzwJaMc2Ay09Y4H101FJaXy6ERAstR0VdlUH7SVYXngAVdyPdz6Sn6NVgNSaCIgLdmrgr5k8GeG9Nfp/pZlS04aMegAEno10y3DsP/DHtWcaQGZtufKvGl/MP0XhrNvGla+tgNJG99eWXAXaU7rWXdBvDbKBrVkWAmJSwPumunYnCkSrZOlamf4z8Ft69XHgfYioRhyImCFlJYbFYBQ4NbmQG0Q+P/f6GhC75JmvFzajF6yHbMa3QtjXRDpbCakWxcH2ocUmghYzwueF5WH1OcL7Y1YPd0beWsT1c2juhnS39fdOSGRR3uQUnlh3SnoeMjwl6v+C3fP6ulGoA98faPkgCaOU0d5YL3BogwycsBCmw0SZbBRkpTpGDJxnOrKCqtiTGjx5bfKHZ3YFKo0hBerMt6jrBPIqDDYOHlT1/GQ3yr2C7YPZOkoWaMjr/ZQ8REZ5cCumdmAMwuaY9uHxZcet5U7ipA+cMMgSnrUH0AOMeydVQXsnTsptu2emdLOtMIrZXyMCt+SpPWj460zoteX4H3dB6jxh0mV9G/ewKZY/YgciamaVTaxCZafu9QdbNRjwy6o9xTqQnEPgrtQJ7CxPzEJdj8UbE0nqDQva/Aji6p5CJVWiW51czYmW0wfdyPHDupvKusLVfxQip/XbEaNKNdtIO0VOTa+Ec7HbajCeP4DgC94CcCVCKYAAAAASUVORK5CYII=" alt="drag-icon" />',document.body.appendChild(t);let n=!1,i,r,p=!1;const k=(b,P)=>{n=!0,i=b,r=P,t.style.transition="none",t.style.opacity=1,console.log("startDrag")},A=(b,P)=>{if(console.log("doDrag isDragging: "+n),n){const N=b-i,F=P-r;(N!==0||F!==0)&&(p=!0),t.style.left=`${t.offsetLeft+N}px`;let B=t.offsetTop+F;B<=0?B=0:B>=window.innerHeight-t.offsetHeight&&(B=window.innerHeight-t.offsetHeight),t.style.top=`${B}px`,i=b,r=P}},x=()=>{console.log("endDrag isDragging: "+n),n&&(n=!1,p=!1,t.offsetLeft+t.offsetWidth/2<window.innerWidth/2,t.style.left=`${window.innerWidth-t.offsetWidth}px`,t.style.transition="left 0.3s ease-out",setTimeout(()=>{p||(t.style.opacity=.7)},3e3))};t.addEventListener("mousedown",b=>k(b.clientX,b.clientY)),document.addEventListener("mousemove",b=>A(b.clientX,b.clientY)),document.addEventListener("mouseup",x),t.addEventListener("touchstart",b=>k(b.touches[0].clientX,b.touches[0].clientY)),document.addEventListener("touchmove",b=>A(b.touches[0].clientX,b.touches[0].clientY)),document.addEventListener("touchend",x),t.addEventListener("click",()=>{if(!p){let b=function(){window.history.length>1?window.history.back():o.prompt("Cant't go back.")};w.gtag("event","action_back_btn"),d.backButtonClick(),l.isPixelEnbale()&&w.isReady()?w.showInterstitialAsync().finally(()=>{b()}):b()}p=!1}),document.referrer===""&&(document.getElementById("backButton").style.display="none")}})},checkAdsStatus(e){if(e==="virtual"){let r=document.getElementById("ad_box").querySelector("ins");return r&&r.getAttribute("data-ad-status")==="filled"}const t=document.querySelectorAll("ins"),n="data-slotcar-"+e;let i=!1;return t.forEach(r=>{r.hasAttribute(n)&&(i=r.getAttribute("data-ad-status")==="filled")}),i},createAdBox:function(e){let t=document.documentElement.clientHeight;o.adBoxCallback=e,console.log("createAdBox");let n=document.createElement("div");n.id="ad_box",n.innerHTML='<div class="ad_toprow"> <div id="dismiss_btn" class="ad_btn" aria-label="Close ad" role="button" tabindex="0" > <div> <svg viewBox="0 0 48 48" fill="#FFF" style="width: 1.3em; height: 1.3em; margin-left: -0.3em; margin-right: -0.3em; vertical-align: middle; padding-bottom: 1px;"> <path d="M38 12.83L35.17 10 24 21.17 12.83 10 10 12.83 21.17 24 10 35.17 12.83 38 24 26.83 35.17 38 38 35.17 26.83 24z" ></path> <path d="M0 0h48v48H0z" fill="none"></path> </svg> </div> </div> <div id="report_btn" class="ad_btn"> <div> <img src="https://www.gstatic.cn/images/icons/material/system/2x/more_vert_white_48dp.png" alt="" style="width: 1.5em; height: 1.5em;" /> </div> </div> <div id="ad_heading" class="ad_btn"> <div>Ad</div> </div> </div> <div id="ad_creative"> <div id="creative_inner"></div> </div>';const i=document.createElement("style");i.innerHTML=` #ad_box { display: none; flex-direction: column; position: fixed; min-height: ${t}px; inset: 0px; background: rgba(52, 58, 65, 0.6); backdrop-filter: blur(5px); z-index: 2147483647; } .ad_toprow { display: table; width: 100%; height: 30px; font-family: "Roboto", arial, sans-serif; font-size: 18px; background-color: #424242; } #dismiss_btn { padding-left: 0.5em; padding-right: 0.5em; opacity: 0.95; float: right; } .ad_btn { display: table; transition: opacity 1s, background 0.75s; -webkit-transition: opacity 1s, background 0.75s; -moz-transition: opacity 1s, background 0.75s; -o-transition: opacity 1s, background 0.75s; height: 30px; padding-top: 15px; padding-bottom: 15px; background: transparent; padding-right: 0.25em; color: #fff; } .ad_btn > div { display: table-cell; vertical-align: middle; padding: 0 0.25em; } #report_btn { top: 0; border: 0; opacity: 0.55; float: left; visibility: hidden; } #ad_heading { margin: auto; } #ad_creative { display: flex; position: relative; height: calc(100% - 62px); min-height: calc(100% - 62px); max-height: calc(100% - 62px); justify-content: center; align-items: center; transition: opacity 1s; } #creative_inner{ display: flex; position: absolute; width: 100%; height: 100%; max-width: 100%; max-height: 100%; justify-content: center; align-items: center; } `,document.body.appendChild(i),document.body.appendChild(n);var r=document.getElementById("dismiss_btn");r.addEventListener("click",function(){n.style.display="none",typeof o.adBoxCallback=="function"&&o.adBoxCallback()})},configGameBottomBannerDiv:function(e){if(e&&e.enable){let t=document.createElement("div");if(t.id="miniplay-game-banner",t.style="position: fixed;bottom: 0;left: 0;width: 100%;height: 70px;color: red; text-align: center;",document.body.appendChild(t),console.log("configGameBottomBannerDiv show: true"),e.bannerTitle){let n=document.getElementById("miniplay-game-iframe");n.style.height="calc(100% - 84px)";let i=document.createElement("p");i.textContent="AD",i.style.cssText="width:100%;height:14px;text-align:center;position:absolute;bottom:70px;left:0;margin:0;font-size:10px;line-height:14px;background-color:#eee",document.body.appendChild(i)}if(o.adPlatform.baseConfig.ad.type==="AdSense"){let n=document.createElement("div");n.id="miniplay-game-info",n.style="display: flex;background:#fff;position: fixed;bottom: 0;left: 0;width: 100%;height: 50px;padding:10px;",n.innerHTML='<div class="game-icon" style="width: 50px;height:50px;border-radius: 10px;background-image: url(./miniplay_resource/icon.png);background-size: 100% 100%;background-color: #efefef;"></div><div style="padding:12px">'+o.adPlatform.baseConfig.game.gameName+"</div>",document.body.appendChild(n)}}else{let t=document.getElementById("miniplay-game-iframe");console.log("_showBanner enable: false"),t!==void 0&&t!=null?(t.style.cssText="height:100%;bottom:0px",console.log("configGameBottomBannerDiv set game iframe height 100%")):console.log("configGameBottomBannerDiv skip set game iframe height 100% "),console.log("configGameBottomBannerDiv show: false")}},async getAdPlatform(){return o.adPlatformLoadingObj==null&&(o.adPlatform!=null?o.adPlatformLoadingObj=Promise.resolve(adPlatform):o.adPlatformLoadingObj=M().then(e=>(console.log("miniplay.json:",e),e.game.landscape&&!o.isLandscape()&&e.config.target!=="xiaomi-aws"?o.showDialog().then(()=>Promise.resolve(e)):Promise.resolve(e))).then(e=>(e.config.platform===E.transsion?(console.log("platform: TranssionAd"),o.adPlatform=u):e.config.platform===E.inapp?(console.log("platform: InApp"),o.adPlatform=I):e.config.platform===E.adx?(console.log("platform: Adx"),o.adPlatform=a):e.config.platform===E.pubguru?(console.log("platform: Pubguru"),o.adPlatform=f):(console.log("platform: GoogleAd"),o.adPlatform=s),o.adPlatform.baseConfig=e,o.adPlatform.adConfig=e.ad.type!=="disable"?e.ad[e.ad.type]:null,Promise.resolve(o.adPlatform)))),o.adPlatformLoadingObj},log(){let e=[];return document.querySelectorAll("ins").forEach(n=>{let i=n.outerHTML,r="";i.includes("data-slotcar-")?r=i.match(/data-slotcar-[^\s=]+/g)[0]||"":n.hasAttribute("data-vignette-loaded")?r="data-vignette-loaded":n.hasAttribute("data-ad-slot")?r="ad-slot:"+n.getAttribute("data-ad-slot"):i.includes("adsbygoogle-noablate")?r="noablate":r="",e.push({key:r,status:n.getAttribute("data-ad-status"),raw:i})}),e}},O={loadStart(){if(typeof funmax>"u"){console.log("funmax undefined");return}funmax.loadStart(),console.log("funmax loadStart......")},registerGamePageLoadReady(){console.log("funmax loadReady......");let e=document.getElementById("miniplay-game-iframe");e.contentWindow.document.readyState==="complete"?funmax.loadReady():e.onload=function(){funmax.loadReady()}}};T.value=window.name||"index",g.registerService();const w={async startAsync(){let e=o.adPlatform.startAsync();return o.adPlatform.adConfig&&o.adPlatform.adConfig.config.preroll?e.then(()=>{w.adBreak({type:c.preroll,name:c.preroll,adBreakDone:t=>{console.log("adBreakDone placementInfo: "+JSON.stringify(t))}})}):console.log("Skip preroll"),o.adPlatform.showBanner(),o.configBackButton(),Promise.resolve()},async initAsync(){return o.isModeStand()||o.isModeIndex()?o.getAdPlatform().then(()=>{let e=o.adPlatform.adConfig&&o.adPlatform.adConfig.banner||null;return o.configGameBottomBannerDiv(e),o.adPlatform.baseConfig.config.target==="xiaomi-aws"&&O.loadStart(),o.adPlatform.isInit()?Promise.resolve():o.adPlatform.initAsync().then(()=>(console.log("init sdk success"),o.adPlatform.baseConfig.config.loadType==="autoStart"?w.startAsync():o.adPlatform.baseConfig.ad.type!=="disable"&&o.adPlatform.showOpenBanner(),Promise.resolve()))}):Promise.resolve()},isReady(){if(o.isModeStand()||o.isModeIndex()){const e=o.adPlatform!=null?o.adPlatform.isReady:!1;return console.log("call isReady index: "+(o.adPlatform&&o.adPlatform.isReady)),e}else return console.log("call isReady game: "+R.isReady),R.isReady},adBreak(e){console.log("adBreak run in isModeStand() || isModeIFrameIndex(): ",o.isModeStand()||o.isModeIndex(),JSON.stringify(e)),o.isModeStand()||o.isModeIndex()?o.getAdPlatform().then(()=>{o.adPlatform.isInit()?o.adPlatform.adBreak(e):o.adPlatform.initAsync().then(()=>{o.adPlatform.adBreak(e)})}).catch(t=>{e.adBreakDone({breakStatus:"unknown"})}):o.isModeGame()&&(g.postMessageToParent({msg_type:_.ad,msg_ad_type:e.type,msg_ad_name:e.name}),g.IFrameAdCallbackCache=e)},showReward(e,t){w.adBreak({type:c.reward,name:c.reward,adBreakDone:n=>{n.breakStatus==="viewed"||n.breakStatus==="dismissed"?e(n.breakStatus):t(n.breakStatus)}})},async showRewardAsync(){return new Promise((e,t)=>{w.showReward(n=>{e(n)},n=>{t(n)})})},showNext(e,t){w.adBreak({type:c.next,name:c.next,adBreakDone:n=>{n.breakStatus==="viewed"?e():t(n.breakStatus)}})},async showNextAsync(){return new Promise((e,t)=>{w.showNext(()=>{e()},n=>{t(n)})})},async showInterstitialAsync(){return w.showNextAsync()},gtag(...e){o.isModeStand()||o.isModeIndex()?o.getAdPlatform().then(()=>{o.adPlatform.gtag(...e)}):o.isModeGame()&&g.postMessageToParent({msg_type:_.gtag,msg_callback_params:e})},prompt(e,t){o.prompt(e,t)},showBanner(){o.isModeIndex()?o.getAdPlatform().then(()=>{console.log(123),o.adPlatform.isInit()?o.adPlatform.showBanner():o.adPlatform.initAsync().then(()=>{o.adPlatform.showBanner()})}).catch(e=>{console.log("show banner error")}):o.isModeGame()&&g.postMessageToParent({msg_type:_.ad,msg_ad_type:c.banner})},setLoadingProgress(e){o.isModeStand()||o.isModeIndex()?typeof miniplayLoadingAnimation=="function"&&miniplayLoadingAnimation(e):o.isModeGame()&&window.parent.miniplay.setLoadingProgress&&window.parent.miniplay.setLoadingProgress(e)},loadIntervalTimes:0,onLoadComplete:function(){if(o.isModeStand()||o.isModeIndex()){const e=setInterval(()=>{typeof indexBannerStatus=="function"&&(indexBannerStatus()?(setTimeout(()=>{typeof hideLoader=="function"&&hideLoader()},3e3),clearInterval(e)):window.parent.miniplay.loadIntervalTimes&&window.parent.miniplay.loadIntervalTimes>10&&(typeof hideLoader=="function"&&hideLoader(),clearInterval(e))),window.parent.miniplay.loadIntervalTimes++},1e3);console.log("is_xiaomi-aws",!!(o.adPlatform.baseConfig&&o.adPlatform.baseConfig.config.target==="xiaomi-aws")),console.log("is_funmax",typeof funmax<"u"),o.adPlatform.baseConfig.config.target==="xiaomi-aws"&&typeof funmax<"u"&&(window.parent.document.getElementById("miniplay-game-iframe")?O.registerGamePageLoadReady():window.parent.addEventListener("DOMContentLoaded",function(){O.registerGamePageLoadReady()}))}else o.isModeGame()&&window.parent.miniplay.onLoadComplete&&window.parent.miniplay.onLoadComplete()},log(){console.table(o.log())}};return w});
